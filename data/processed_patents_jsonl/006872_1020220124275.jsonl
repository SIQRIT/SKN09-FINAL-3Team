{"patent_id": "10-2022-0124275", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2024-0044810", "출원번호": "10-2022-0124275", "발명의 명칭": "직관적 강화학습을 이용한 진단 영상의 특징점 검출 장치 및 방법", "출원인": "한국기계연구원", "발명자": "주수빈"}}
{"patent_id": "10-2022-0124275", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "2차원 또는 3차원 진단 영상의 이미지가 입력되는 입력부;이미지 상에 미리정해진 크기의 상하좌우 및 대각선의 이진화된 8개 방향으로 이동가능한 특징점 탐색용 에이전트를 랜덤하게 위치시킨 에이전트 이미지 데이터와 상기 랜덤하게 위치된 에이전트 이미지로부터 미리정해진 특징점까지 최단거리로 이동하기 위한 이진화된 방향 데이터를 포함하는 복수의 에이전트 학습데이터 세트가 수집되어 저장된 데이터베이스부;상기 복수의 에이전트 학습데이터 세트에 기초하여 딥러닝 모델을 학습시켜 상기 에이전트가 최단 거리로 특징점으로 이동하기 위한 에이전트 이동 모델을 생성하는, 에이전트 이동모델 생성부;상기 에이전트 이동 모델에 상기 입력부에서 입력된 진단 영상의 이미지를 적용하고 미리정해진 종료 조건에 따라 상기 진단 영상의 이미지 상에서 상기 에이전트 이동 모델의 에이전트의 이동이 정지하는 지점의 데이터를진단 특징점으로 정의하여 도출하는 특징점 도출부를 포함하는, 직관적 강화학습을 이용한 진단 영상의 특징점검출 장치."}
{"patent_id": "10-2022-0124275", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 입력부와 연결되고, 상기 2차원 또는 3차원의 진단 영상을 촬영하여 획득하는 영상 획득부를 더 포함하는것을 특징으로 하는, 장치."}
{"patent_id": "10-2022-0124275", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1항에 있어서,상기 특징점 도출부에서 상기 진단 특징점 도출 후에 상기 진단 특징점의 데이터와 상기 진단 대상 이미지 상의위치를 표시하여 출력하는 출력부를 더 포함하는, 장치."}
{"patent_id": "10-2022-0124275", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제1항에 있어서,상기 진단영상은 신체의 일부 또는 전부에 관한 2차원 또는 3차원의 의료 영상을 촬영하여 획득된 것임을 특징으로 하는, 장치."}
{"patent_id": "10-2022-0124275", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제4항에 있어서,상기 특징점 도출부에서 도출된 상기 진단 특징점에 기초하여 환자의 신체 구조적 특징을 안내하거나 질병 여부를 진단하는 진단부를 더 포함하는 것을 특징으로 하는. 장치."}
{"patent_id": "10-2022-0124275", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제1항에 있어서,상기 딥러닝 모델은 합성곱 신경망 모델이고, 상기 에이전트는 상기 합성곱 신경망 모델에 3개의 시그모이드(sigmoid) 함수를 결합하여 3개의 이진화된 에이전트 출력값으로 8개의 에이전트 이동 방향 표시를 구현하는 것을 특징으로 하는, 장치."}
{"patent_id": "10-2022-0124275", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "공개특허 10-2024-0044810-3-제1항에 있어서,상기 미리정해진 종료 조건은, 상기 에이전트가 상기 진단 대상 이미지 상에서 진동을 반복하는 경우 종료하는것이며,상기 진단 특징점의 좌표는 상기 미리정해진 종료 조건이 만족시 상기 에이전트의 중심 좌표로 정의하는 것을특징으로 하는, 방법."}
{"patent_id": "10-2022-0124275", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제1항에 있어서,상기 진단 특징점이 N개 (N은 2 이상의 정수)의 다중 특징점들을 가지는 경우,상기 데이터베이스부가, 각 에이전트 이미지 입력이 N개의 특징점들까지의 최단거리로 이동하기 위한 N개의 이동방향의 다중 출력을 가지는 복수의 학습데이터 세트를 수집하여 저장되어 있는 것을 특징으로 하는, 장치."}
{"patent_id": "10-2022-0124275", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제8항에 있어서,상기 특징점 도출부는, 상기 N개의 다중 특징점 중 지정된 특징점을 도출하도록 요청되는 경우, 상기 진단영상의 이미지 상에 상기 에이전트 이동 모델을 적용시켜서 획득된 N개의 방향 결과 중 상기 지정된 특징점의 방향결과만을 따라 상기 에이전트를 이동시키는 것에 의해 상기 지정된 특징점의 좌표를 도출하는 것을 특징으로 하는, 장치."}
{"patent_id": "10-2022-0124275", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "진단 이미지 상에 미리정해진 크기의 상하좌우 및 대각선의 이진화된 8개 방향으로 이동가능한 특징점 탐색용에이전트를 랜덤하게 위치시킨 에이전트 이미지 데이터와 상기 랜덤하게 위치된 에이전트 이미지로부터 미리정해진 특징점까지 최단거리로 이동하기 위한 이진화된 방향 데이터를 포함하는 복수의 에이전트 학습데이터 세트를 수집하는 학습데이터 수집 단계;상기 복수의 에이전트 학습데이터 세트에 기초하여 딥러닝 모델을 학습시켜 상기 에이전트가 최단 거리로 특징점으로 이동하기 위한 에이전트 이동 모델을 생성하는, 에이전트 이동모델 생성단계; 2차원 또는 3차원 진단 영상의 이미지가 입력되는 이미지 입력 단계;상기 에이전트 이동 모델에 상기 입력된 진단 영상의 이미지를 적용하고 미리정해진 종료 조건에 따라 상기 진단 영상의 이미지 상에서 상기 에이전트 이동 모델의 에이전트의 이동이 정지하는 지점의 데이터를 진단 특징점으로 정의하여 도출하는 특징점 도출 단계를 포함하는, 직관적 강화학습을 이용한 진단 영상의 특징점 검출 방법."}
{"patent_id": "10-2022-0124275", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "제10항에 있어서,상기 특징점 도출 단계 후에, 상기 진단 특징점의 데이터와 상기 진단 대상 이미지 상의 위치를 표시하여 출력하는 특징점 출력 단계를 더 포함하는, 방법."}
{"patent_id": "10-2022-0124275", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제10항에 있어서,상기 진단영상은 신체의 일부 또는 전부에 관한 2차원 또는 3차원의 의료 영상을 촬영하여 획득된 것임을 특징으로 하는, 방법."}
{"patent_id": "10-2022-0124275", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "제10항에 있어서, 상기 딥러닝 모델은 합성곱 신경망 모델이고, 공개특허 10-2024-0044810-4-상기 에이전트는 상기 합성곱 신경망 모델에 3개의 시그모이드(sigmoid) 함수를 결합하여 3개의 이진화된 에이전트 출력값으로 8개의 에이전트 이동 방향 표시를 구현하는 것을 특징으로 하는, 방법."}
{"patent_id": "10-2022-0124275", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_14", "content": "제10항에 있어서,상기 미리정해진 종료 조건은, 상기 에이전트가 상기 진단 대상 이미지 상에서 진동을 반복하는 경우 종료하는것이며,상기 진단 특징점의 좌표는 상기 미리정해진 종료 조건이 만족시 상기 에이전트의 중심 좌표로 정의하는 것을특징으로 하는, 방법."}
{"patent_id": "10-2022-0124275", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_15", "content": "제10항에 있어서,상기 진단 특징점이 N개 (N은 2 이상의 정수)의 다중 특징점들을 가지는 경우,상기 학습데이터 세트 수집 단계는, 각 에이전트 이미지 입력이 N개의 특징점들까지의 최단거리로 이동하기 위한 N개의 이동방향의 다중 출력을 가지는 복수의 학습데이터 세트를 수집하는 단계를 포함하는 것을 특징으로하는, 방법."}
{"patent_id": "10-2022-0124275", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_16", "content": "제15항에 있어서,상기 특징점 도출 단계는, 상기 N개의 다중 특징점 중 지정된 특징점을 도출하도록 요청되는 경우, 상기 진단영상의 이미지 상에 상기 에이전트 이동 모델을 적용시켜서 획득된 N개의 방향 결과 중 상기 지정된 특징점의 방향 결과만을 따라 상기 에이전트를 이동시키는 것에 의해 상기 지정된 특징점의 좌표를 도출하는 단계를 포함하는 것을 특징으로 하는, 방법."}
{"patent_id": "10-2022-0124275", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명의 일실시예에 따른 직관적 강화학습을 이용한 진단 영상의 특징점 검출 장치는, 2차원 또는 3차원 진단 영상의 이미지가 입력되는 입력부; 이미지 상에 미리정해진 크기의 상하좌우 및 대각선의 이진화된 8개 방향으로 이동가능한 특징점 탐색용 에이전 (뒷면에 계속)"}
{"patent_id": "10-2022-0124275", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 진단 영상의 특징점을 자동으로 검출하는 장치 및 방법에 관한 것으로, 더욱 상세하게는 진단 영상의 이미지에 특징점 탐색용 에이전트를 배치하고 도출하고자 하는 특징점까지의 최단거리로의 그 에이전트의 이동 방향을 직관적 강화학습을 이용하여 학습하여 에이전트 이동 모델을 생성하며 그 에이전트 이동 모델의 적용하 여 진단 영상의 이미지 상의 특징점을 도출함으로서 고해상도의 원본 진단 영상 이미지인 경우에도 그 용량을 줄이지 않고도 고효율성 및 고정확성으로 특징점을 자동으로 도출할 수 있는 장치 및 방법에 관한 것이다."}
{"patent_id": "10-2022-0124275", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "이미지를 규정하기 위한 특징점을 찾기 위해서 통계적 기법 기반의 패턴 인식 알고리즘을 사용하여 사전에 학습 된 특징점 패턴과 유사한 패턴을 찾는 기술들이 개발되었는데 대표적으로는 Active Shape Model (ASM)과 Active Appearance Model이 있다. 이러한 알고리즘은 사전에 최대한 정확하게 설정된 모델이 필요하며 인공지능 기반이 아닌 통계적 기법을 기반으로 하고 있기 때문에 범용성과 정확도가 낮은 문제가 있다. 최근 다양하거나 복잡한 이미지, 또는 흑백의 그레이스케일(grayscale) 의 이미지에서도 높은 정확도 및 신뢰도 와 범용성을 가지는 특징점 검출(landmark detection) 알고리즘을 개발하기 위해 다양한 인공지능 기반 알고리 즘에 대한 개발이 진행되고 있다. 인공지능 알고리즘은 크게 지도학습, 비지도학습, 강화학습으로 분류할 수 있다. 이미지 인식에 널리 사용되고 있는 일종의 지도학습 모델로 합성곱 신경망(Convolutional Neural Network: CNN) 기반의 특징점 검출 방법이 사용되고 있는 바, 이미지 전체 또는 이미지의 일부분을 CNN 알고리즘을 사용하여 특징점의 좌표 또는 특징점 영역에 대한 시각적 표시를 얻도록 구성된다. 도 1은 종래에 CNN 의 대칭구조의 일종인 U-net알고리즘을 이미지에 적용하여 해당 이미지의 특징점이 점 이미지로 표시되도록 하는 알고리즘의 예시적인 구성을 나타내고 있다. 이와 관련하여 등록특허공보 제2373500호의 “딥러닝을 이용한 3차원 의료 영상 데이터의 특징점 자동 검출 방 법 및 장치”에서는 제1합성곱 신경망을 초기 특징점을 검출하는데 적용하고 제2합성곱 신경망을 세부 특징점을 검출하는데 사용하는 구성을 개시하고 있다. 그러나, 이와 같이 CNN 또는 U-net 기반의 특징점 검출 방법의 가장 큰 문제점은 원본 이미지의 정보가 특정점 검출을 위한 프로세싱 과정에서 상당 부분 훼손될 수 있기 때문에 정밀한 특징점 검출에 한계가 있다는 점이다. CNN방식의 경우 원본 이미지의 크기를 여러 차례 압축하는 단계를 거쳐 특징점을 추출하는 방식이기 때문에 원 본이미지를 지속적으로 절반으로 줄여나가는 단계를 거치게 되면 원본 이미지에 있던 매우 작은 정보는 상대적 으로 사라져서 검출하기 힘들다는 단점이 발생하기 때문이다. CNN방식은 이미지의 메모리(GPU 그래픽 카드 메모 리 등)의 용량을 많이 차지하기 때문에 의료영상과 같이 수천 픽셀 X 수천 픽셀과 같은 초고해상도 이미지를 원 본 그대로 사용할 수 없고 비용을 급격히 상승시키는 문제점이 발생한다. 한편, 등록특허공보 제2211481호의 “객체 랜드마크 검출 장치 및 시멘틱 정합 장치의 공동 학습 장치 및 방법 ”에서는 학습용 데이터를 요구하지 않으며, 학습 시에 시멘틱 정합 장치와 객체 랜드마크 검출 장치가 상호 보 완되도록 함으로써, 비지도 학습 방식으로도 학습 성능을 개선할 수 있는 객체 랜드마크 검출 장치 및 시멘틱 정합 장치의 공동 학습 방법을 개시하고 있다. 그러나, 이러한 비지도 학습 기반에서도 특징점의 검출 정확도가 상당히 떨어지는 문제점이 있다. 강화 학습의 경우에는 에이전트(agent)라는 특정 크기의 가상 박스가 게임 배경에서 목적지를 찾아가듯이 특정 이미지 상에 배치되어 특징점을 찾아가도록 하는 방식이며, 강화학습의 에이전트를 CNN 구조를 적용하는 경우 일정 크기의 이미지를 입력으로 받는 것은 기존의 CNN 방식의 특징점 검출 방법론과 일부 유사하나, 기존의 CNN 기반의 알고리즘 대비 작은 사이즈의 CNN 만을 가지고 특징점을 찾을 수 있어 프로세싱에 GPU의 메모리 용량을 상대적으로 적게 소요되어 이러한 문제점은 해결할 수 있다. 그러나, 강화 학습은 에이전트가 랜덤하게 이동하 면서 보상을 최대화하도록 이동하는 방식이라는 특징을 가지고 있으며, 강화학습을 위한 “보상”이라는 개념을 정의하기 어려워 특징점 검출을 위한 정확도와 효율성 및 범용성을 높이기 위해서는 아직까지 학습 방식 및 모 델 개발이 어렵다는 단점이 있어 널리 사용되지 못하고 있다. (특허문헌 1) 대한민국 등록특허공보 제2373500호 (특허문헌 2) 대한민국 등록특허공보 제2211481호"}
{"patent_id": "10-2022-0124275", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명이 이루고자 하는 기술적 과제는 강화학습의 장점을 그대로 보유하면서 직관적이고 신뢰성 및 신속성이 높은 직관적 강화학습을 사용하여 고해상도의 진단 영상 이미지인 경우에도 그 용량을 줄이지 않고도 고효율성 및 고정확성으로 특징점을 자동으로 도출할 수 있는 장치 및 방법을 제공하는 것이다. 본 발명이 이루고자 하는 또다른 기술적 과제는 의료 영상과 같이 고해상도 이미지에 아주 작은 픽셀 크기의 특 징점을 갖는 영상을 우수한 정확성 및 효율성으로 자동으로 도출할 수 있는 장치 및 방법을 제공하는 것이다. 본 발명이 이루고자 하는 기술적 과제는 이상에서 언급한 기술적 과제로 제한되지 않으며, 언급되지 않은 또 다 른 기술적 과제들은 아래의 기재로부터 본 발명이 속하는 기술 분야에서 통상의 지식을 가진 자에게 명확하게 이해될 수 있을 것이다."}
{"patent_id": "10-2022-0124275", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "상기 기술적 과제를 달성하기 위하여, 본 발명의 일실시예에 따른 직관적 강화학습을 이용한 진단 영상의 특징 점 검출 장치는, 2차원 또는 3차원 진단 영상의 이미지가 입력되는 입력부; 이미지 상에 미리정해진 크기의 상하좌우 및 대각선의 이진화된 8개 방향으로 이동가능한 특징점 탐색용 에이전 트를 랜덤하게 위치시킨 에이전트 이미지 데이터와 상기 랜덤하게 위치된 에이전트 이미지로부터 미리정해진 특 징점까지 최단거리로 이동하기 위한 이진화된 방향 데이터를 포함하는 복수의 에이전트 학습데이터 세트가 수집되어 저장된 데이터베이스부; 상기 복수의 에이전트 학습데이터 세트에 기초하여 딥러닝 모델을 학습시켜 상기 에이전트가 최단 거리로 특징 점으로 이동하기 위한 에이전트 이동 모델을 생성하는, 에이전트 이동모델 생성부; 상기 에이전트 이동 모델에 상기 입력부에서 입력된 진단 영상의 이미지를 적용하고 미리정해진 종료 조건에 따 라 상기 진단 영상의 이미지 상에서 상기 에이전트 이동 모델의 에이전트의 이동이 정지하는 지점의 데이터를 진단 특징점으로 정의하여 도출하는 특징점 도출부를 포함할 수 있다. 본 발명의 실시예에 있어서, 상기 입력부와 연결되고, 상기 2차원 또는 3차원의 진단 영상을 촬영하여 획득하는 영상 획득부를 더 포함할 수 있다. 본 발명의 실시예에 있어서, 상기 특징점 도출부에서 상기 진단 특징점 도출 후에 상기 진단 특징점의 데이터와 상기 진단 대상 이미지 상의 위치를 표시하여 출력하는 출력부를 더 포함할 수 있다. 본 발명의 실시예에 있어서, 상기 진단영상은 신체의 일부 또는 전부에 관한 2차원 또는 3차원의 의료 영상을 촬영하여 획득될 수 있다. 본 발명의 실시예에 있어서, 상기 특징점 도출부에서 도출된 상기 진단 특징점에 기초하여 환자의 신체 구조적 특징을 안내하거나 질병 여부를 진단하는 진단부를 더 포함할 수 있다. 본 발명의 실시예에 있어서, 상기 딥러닝 모델은 합성곱 신경망 모델이고, 상기 에이전트는 상기 합성곱 신경망 모델에 3개의 시그모이드(sigmoid) 함수를 결합하여 3개의 이진화된 에이 전트 출력값으로 8개의 에이전트 이동 방향 표시를 구현할 수 있다. 본 발명의 실시예에 있어서, 상기 미리정해진 종료 조건은, 상기 에이전트가 상기 진단 대상 이미지 상에서 진 동을 반복하는 경우 종료하는 것이며, 상기 진단 특징점의 좌표는 상기 미리정해진 종료 조건이 만족시 상기 에 이전트의 중심 좌표로 정의할 수 있다. 본 발명의 실시예에 있어서, 상기 진단 특징점이 N개 (N은 2 이상의 정수)의 다중 특징점들을 가지는 경우, 상 기 데이터베이스부가, 각 에이전트 이미지 입력이 N개의 특징점들까지의 최단거리로 이동하기 위한 N개의 이동 방향의 다중 출력을 가지는 복수의 학습데이터 세트를 수집하여 저장되어 있을 수 있다. 본 발명의 실시예에 있어서, 상기 특징점 도출부는, 상기 N개의 다중 특징점 중 지정된 특징점을 도출하도록 요 청되는 경우, 상기 진단영상의 이미지 상에 상기 에이전트 이동 모델을 적용시켜서 획득된 N개의 방향 결과 중 상기 지정된 특징점의 방향 결과만을 따라 상기 에이전트를 이동시키는 것에 의해 상기 지정된 특징점의 좌표를 도출할 수 있다. 상기 기술적 과제를 달성하기 위하여, 본 발명의 또 다른 실시예에 따른 직관적 강화학습을 이용한 진단 영상 의 특징점 검출 방법은, 진단 이미지 상에 미리정해진 크기의 상하좌우 및 대각선의 이진화된 8개 방향으로 이동가능한 특징점 탐색용 에이전트를 랜덤하게 위치시킨 에이전트 이미지 데이터와 상기 랜덤하게 위치된 에이전트 이미지로부터 미리정 해진 특징점까지 최단거리로 이동하기 위한 이진화된 방향 데이터를 포함하는 복수의 에이전트 학습데이터 세트 를 수집하는 학습데이터 수집 단계; 상기 복수의 에이전트 학습데이터 세트에 기초하여 딥러닝 모델을 학습시켜 상기 에이전트가 최단 거리로 특징 점으로 이동하기 위한 에이전트 이동 모델을 생성하는, 에이전트 이동모델 생성단계; 2차원 또는 3차원 진단 영상의 이미지가 입력되는 이미지 입력 단계; 상기 에이전트 이동 모델에 상기 입력된 진단 영상의 이미지를 적용하고 미리정해진 종료 조건에 따라 상기 진 단 영상의 이미지 상에서 상기 에이전트 이동 모델의 에이전트의 이동이 정지하는 지점의 데이터를 진단 특징점 으로 정의하여 도출하는 특징점 도출 단계를 포함할 수 있다. 본 발명의 실시예에 있어서, 상기 특징점 도출 단계 후에, 상기 진단 특징점의 데이터와 상기 진단 대상 이미지 상의 위치를 표시하여 출력하는 특징점 출력 단계를 더 포함할 수 있다. 본 발명의 실시예에 있어서, 상기 진단영상은 신체의 일부 또는 전부에 관한 2차원 또는 3차원의 의료 영상을 촬영하여 획득될 수 있다. 본 발명의 실시예에 있어서, 상기 딥러닝 모델은 합성곱 신경망 모델이고, 상기 에이전트는 상기 합성곱 신경망 모델에 3개의 시그모이드(sigmoid) 함수를 결합하여 3개의 이진화된 에이 전트 출력값으로 8개의 에이전트 이동 방향 표시를 구현하는 것을 특징으로 할 수 있다. 본 발명의 실시예에 있어서, 상기 미리정해진 종료 조건은, 상기 에이전트가 상기 진단 대상 이미지 상에서 진 동을 반복하는 경우 종료하는 것이며, 상기 진단 특징점의 좌표는 상기 미리정해진 종료 조건이 만족시 상기 에 이전트의 중심 좌표로 정의할 수 있다. 본 발명의 실시예에 있어서, 상기 진단 특징점이 N개 (N은 2 이상의 정수)의 다중 특징점들을 가지는 경우, 상 기 학습데이터 세트 수집 단계는, 각 에이전트 이미지 입력이 N개의 특징점들까지의 최단거리로 이동하기 위한 N개의 이동방향의 다중 출력을 가지는 복수의 학습데이터 세트를 수집하는 단계를 포함할 수 있다. 본 발명의 실시예에 있어서, 상기 특징점 도출 단계는, 상기 N개의 다중 특징점 중 지정된 특징점을 도출하도록 요청되는 경우, 상기 진단영상의 이미지 상에 상기 에이전트 이동 모델을 적용시켜서 획득된 N개의 방향 결과 중 상기 지정된 특징점의 방향 결과만을 따라 상기 에이전트를 이동시키는 것에 의해 상기 지정된 특징점의 좌 표를 도출하는 단계를 포함할 수 있다."}
{"patent_id": "10-2022-0124275", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명의 실시예에 따르면, 강화학습의 장점을 그대로 보유하면서 직관적이고 신뢰성 및 신속성이 높은 직관적 강화학습을 사용하여 고해상도의 진단 영상 이미지인 경우에도 그 용량을 줄이지 않고도 고효율성 및 고정확성 으로 특징점을 자동으로 도출할 수 있는 장치 및 방법을 제공할 수 있다. 본 발명의 실시예에 따르면, 2차원 또는 3차원 의료 영상의 이미지에서 해부학적인 특징점(anatomical landmark)을 우수한 정확도과 효율성을 가지고 도출할 수 있으며, 신규 진단 대상인 영상 이미지에서도 2mm 이 내의 높은 정확도로 특징점을 도출할 수 있기 때문에 의료 영상의 아주 작은 픽셀 크기의 병변이나 특징점을 도 출할 수 있어서, 수술/시술의 계획 시간 또는 수술/시술 자체의 시간을 현저히 단축할 수 있다. 본 발명의 실시예에 따르면, 의료 진단 영상뿐 아니라, 산업 진단 영상, 또는 사람이나 동물의 안면에서 특징을 찾아내어 인식하는 데 높은 정확성을 가지고 활용될 수도 있으며, 얼굴 피부의 작은 특징점을 찾을 수 있게 되 어 안면 인식률을 현저히 개선할 수 있다."}
{"patent_id": "10-2022-0124275", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 2, "content": "본 발명의 효과는 상기한 효과로 한정되는 것은 아니며, 본 발명의 상세한 설명 또는 특허청구범위에 기재된 발 명의 구성으로부터 추론 가능한 모든 효과를 포함하는 것으로 이해되어야 한다."}
{"patent_id": "10-2022-0124275", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하에서는 첨부한 도면을 참조하여 본 발명을 설명하기로 한다. 그러나 본 발명은 여러 가지 상이한 형태로 구 현될 수 있으며, 따라서 여기에서 설명하는 실시예로 한정되는 것은 아니다. 그리고 도면에서 본 발명을 명확하 게 설명하기 위해서 설명과 관계없는 부분은 생략하였으며, 명세서 전체를 통하여 유사한 부분에 대해서는 유사 한 도면 부호를 붙였다. 명세서 전체에서, 어떤 부분이 다른 부분과 \"연결(접속, 접촉, 결합)\"되어 있다고 할 때, 이는 \"직접적으로 연 결\"되어 있는 경우뿐 아니라, 그 중간에 다른 부재를 사이에 두고 \"간접적으로 연결\"되어 있는 경우도 포함한다. 또한 어떤 부분이 어떤 구성요소를 \"포함\"한다고 할 때, 이는 특별히 반대되는 기재가 없는 한 다른 구성요소를 제외하는 것이 아니라 다른 구성요소를 더 구비할 수 있다는 것을 의미한다. 본 명세서에서 사용한 용어는 단지 특정한 실시예를 설명하기 위해 사용된 것으로, 본 발명을 한정하려는 의도 가 아니다. 단수의 표현은 문맥상 명백하게 다르게 뜻하지 않는 한, 복수의 표현을 포함한다. 본 명세서에서, \"포함하다\" 또는 \"가지다\" 등의 용어는 명세서상에 기재된 특징, 숫자, 단계, 동작, 구성요소, 부품 또는 이들 을 조합한 것이 존재함을 지정하려는 것이지, 하나 또는 그 이상의 다른 특징들이나 숫자, 단계, 동작, 구성요 소, 부품 또는 이들을 조합한 것들의 존재 또는 부가 가능성을 미리 배제하지 않는 것으로 이해되어야 한다. 이하에서 본 발명의 일 실시예에 따른 직관적 강화학습을 이용한 진단 영상의 특징점 검출 장치 및 방법을 도면 을 참조하여 설명한다. 도 2는 본 발명의 일 실시예에 따른 직관적 강화학습을 이용한 진단 영상의 특징점 검출 장치의 개략적인 블록 도를 도시하며, 도 3은 본 발명의 일 실시예에 따라 직관적 강화학습을 이용하여 진단 영상의 이미지 상의 특징 점을 검출시 에이전트의 이동 방향 및 타겟 특징점까지의 최단 이동 경로를 도시한다. 도 2를 참조하면, 본 발명의 일실시예에 따른 직관적 강화학습을 이용한 진단 영상의 특징점 검출 장치는 진단 영상 이미지의 입력부, 데이터베이스부, 에이전트 이동모델 생성부, 특징점 도출부를 포함하며, 특징점 관련 데이터의 출력부, 진단부, 영상 획득부를 더 포함할 수도 있다. 본 발명 의 특징점 검출 장치는 상기 입력부, 데이터베이스부, 에이전트 이동모델 생성부, 특징점 도출부, 출력부, 진단부, 영상 획득부의 일부 또는 전부를 제어하는 제어부를 더 포 함할 수도 있다. 본 발명의 일실시예에 따르면, 상기 직관적인 강화학습으로 직관적 모방학습, 강화학습의 장점 을 차용한 지도학습을 사용할 수도 있으나, 이에 한정되지는 않는다. 상기 입력부는 2차원 또는 3차원 진단 영상의 이미지가 입력될 수 있다. 상기 진단 영상은 신체의 일부 또 는 전부에 관한 2차원 또는 3차원의 의료 영상을 촬영하여 획득된 것일 수도 있고 산업적 객체의 일부 또는 전 부에 관한 2차원 또는 3차원 영상을 촬영하여 획득된 것일 수도 있다. 상기 데이터베이스부는 진단 영상의 이미지 상에 미리정해진 크기의 상하좌우 및 대각선의 이진화된 8개 방향으로 이동가능한 특징점 탐색용 에이전트(agent)를 랜덤하게 위치시킨 에이전트 이미지 데이터와 상기 랜덤 하게 위치된 에이전트 이미지로부터 미리정해진 특징점까지 최단거리로 이동하기 위한 이진화된 방향 데이터를 포함하는 복수의 에이전트 학습데이터 세트가 수집되어 저장될 수 있다. 여기에서 “에이전트”는, 도 3에서 볼 수 있는 바와 같이, 상기 진단 영상의 원본 이미지 상에 배치되는 미리 정해진 크기의 가상 영역 (예컨대 가상의 사각 박스 형태일 수도 있으나 이에 한정되지는 않음)의 이미지를 규정하는 일종의 윈도우가 될 수 있으며. 최초에는 상기 진단 영상의 원본 이미지 상에 랜덤하게 배치될 수 있다. 에이전트는 상하좌우 4개 방향 및 그 사이의 대각선 4개 방향을 포함하는 이진화로 표시된 8개 방향으로 미리정 해진 거리 만큼씩 타겟 특징점을 향하여 이동가능하도록 형성될 수 있다. 에이전트 이미지의 데이터는 에이전트 의 좌표일 수 있으며, 이는 도 3에서 볼 수 있는 바와 같이 에이전트가 규정하는 윈도우 영역의 중심 좌표로 나 타낼 수도 있으나 이에 한정되지는 않는다. 본 발명의 일실시예에 따른 복수의 에이전트 학습데이터 세트에서 상기 에이전트 이미지 데이터는 입력이고 상 기 랜덤하게 위치된 에이전트 이미지로부터 미리정해진 특징점까지 최단거리로 이동하기 위한 이진화된 방향 데 이터는 그에 대응하는 출력이 될 수 있으나, 필요에 따라 입력과 출력 데이터가 반대로 되도록 학습데이터 세트 가 사용될 수도 있다. 본 발명의 일실시예에 따른 진단 영상의 검출 장치에서는 데이터베이스부를 장치 내부에 포함하고 있으나, 필요시 데이터베이스부가 상기 진단 영상의 검출 장치의 외부에 위치 되고 상기 입력부에 연결되어 데이터를 제공할 수도 있다. 상기 에이전트 이동모델 생성부는 상기 복수의 에이전트 학습데이터 세트에 기초하여 딥러닝 모델을 학습 시켜 상기 에이전트가 최단 거리로 특징점으로 이동하기 위한 에이전트 이동 모델을 생성할 수 있다. 에이전트 이동 모델에서는 에이전트가 선택한 방향으로 일정 단위 거리만큼 에이전트를 이동시킨 다음 새롭게 이동한 위 치에서 다시 다음 이동 방향을 선택하는 과정을 지속적으로 반복하게 된다. 본 발명의 일실시예에서 상기 딥러닝 모델은 합성곱 신경망 모델이고, 상기 에이전트는 상기 합성곱 신경망 모 델에 3개의 시그모이드(sigmoid) 함수를 결합하여 3개의 이진화된 에이전트 출력값으로 8개의 에이전트 이동 방 향 표시를 구현할 수 있다. 그러나, 본 발명의 다른 실시예에서 상기 딥러닝 모델은 합성곱 신경망 모델 이외의 다른 딥러닝 모델이 사용될 수도 있다. 상기 특징점 도출부 는, 상기 에이전트 이동 모델에 상기 입력부에서 입력된 진단 영상의 이미지를 적용하 고 미리정해진 종료 조건에 따라 상기 진단 영상의 이미지 상에서 상기 에이전트 이동 모델의 에이전트의 이동 이 정지하는 지점의 데이터를 진단 특징점으로 정의하여 도출할 수 있다. 상기 미리정해진 종료 조건은, 상기 에이전트가 상기 진단 대상 이미지 상에서 특정 지점에서 진동을 반복하는 경우 종료하는 것일 수 있으나, 종료 조건이 그에 한정되지는 않는다. 또한, 상기 진단 특징점의 좌표는 상기 미리정해진 종료 조건이 만족시 상기 에이전트의 영역의 중심 좌표로 정의할 수 있으나, 그에 한정되지는 않는다. 상기 진단 특징점은 단일 특징점일 수도 있고 복수의 특징점(이하 “다중 특징점”)을 포함할 수도 있다. 상기 출력부는 상기 특징점 도출부에서 상기 진단 특징점을 도출한 후에 상기 진단 특징점에 관한 데 이터 및/또는 상기 진단 영상의 이미지 상의 진단 특징점의 위치를 표시하여 출력할 수 있다. 상기 진단부는 상기 진단 영상이 의료 영상인 경우에는, 상기 특징점 도출부에서 도출된 상기 진단 특징점에 관한 데이터에 기초하여 환자 신체의 해부학적 특징을 안내하거나 질병 여부를 진단할 수 있다. 상기 진단 영상이 산업 영상이나 사람 또는 동물의 안면인 경우에는, 상기 진단 특징점에 관한 데이터에 기초하여 해 당 진단 영상의 대상 객체의 구조적 특징이나 결함 등에 관한 데이터를 안내하거나 진단할 수 있다. 상기 영상 획득부는 상기 입력부와 연결되고, 상기 2차원 또는 3차원의 진단 영상을 촬영하여 획득할 수 있다. 상기 영상 획득부는 상기 특징점 도출 장치에 포함될 수도 있고, 외부 기기로서 입력부 에 접속되도록 할 수도 있다. 상기 진단 특징점이 N개 (N은 2 이상의 정수)의 다중 특징점을 가지는 경우, 상기 데이터베이스부에 각 에 이전트 이미지 입력이 N개의 특징점들까지의 최단거리로 이동하기 위한 N개의 이동방향의 다중 출력을 가지는 복수의 학습데이터 세트를 수집하여 저장된다. 이 경우, 상기 특징점 도출부는, 상기 N개의 다중 특징점 중 지정된 특징점을 도출하도록 요청되어, 상기 진단영상의 이미지 상에 상기 에이전트 이동 모델을 적용시켜서 획득된 N개의 방향 결과 중 상기 지정된 특징점의 방향 결과만을 따라 상기 에이전트를 이동시키는 것에 의해 상기 지정된 특징점의 좌표를 도출할 수도 있다. 도 4는 본 발명의 일 실시예에 따른 직관적 강화학습을 이용한 진단 영상의 특징점 검출 방법의 개략적인 흐름 도를 도시한다. 도 4를 참조하면, 본 발명의 일 실시예에 따른 직관적 강화학습을 이용한 진단 영상의 특징점 검출 방법에서는, 우선 진단 영상의 이미지 상에 미리정해진 크기의 상하좌우 및 대각선의 이진화된 8개 방향으로 이동가능한 특징점 탐색용 에이전트를 랜덤하게 위치시킨 에이전트 이미지 데이터와 상기 랜덤하게 위치된 에이전트 이미지로 부터 미리정해진 특징점까지 최단거리로 이동하기 위한 이진화된 방향 데이터를 포함하는 복수의 에이전트 학습 데이터 세트를 수집하고 (단계 S410), 상기 복수의 에이전트 학습데이터 세트에 기초하여 딥러닝 모델을 학습시 켜 상기 에이전트가 최단 거리로 특징점으로 이동하기 위한 에이전트 이동 모델을 생성한다 (단계 S420). 에이 전트 이동 모델이 생성된 후에, 진단이 필요한 2차원 또는 3차원 진단 영상의 이미지가 입력부를 통해 입 력된다 (단계 S430). 그 후, 상기 에이전트 이동 모델에 상기 입력된 진단 영상의 이미지를 적용하고 미리정해 진 종료 조건에 따라 상기 진단 영상의 이미지 상에서 상기 에이전트 이동 모델의 에이전트의 이동이 정지하는 지점의 데이터를 진단 특징점으로 정의하여 도출한다 (단계 S440). 상기 특징점 도출 단계 후에, 상기 진단 특 징점의 데이터와 상기 진단 대상 이미지 상의 위치를 표시하여 출력하는 단계(단계 S450)를 더 포함할 수도 있 다. 상기 진단 영상은 신체의 일부 또는 전부에 관한 2차원 또는 3차원의 의료 영상을 촬영하여 획득된 것일 수도 있고 산업적 객체의 일부 또는 전부에 관한 2차원 또는 3차원 영상을 촬영하여 획득된 것일 수도 있다. 상기 딥 러닝 모델은 합성곱 신경망 모델일 수 있으나, 그에 한정되지는 않는다. 상기 딥러닝 모델이 합성곱 신경망 모 델인 경우, 상기 에이전트는 상기 합성곱 신경망 모델에 3개의 시그모이드(sigmoid) 함수를 결합하여 3개의 이 진화된 에이전트 출력값으로 8개의 에이전트 이동 방향 표시를 구현할 수도 있다. 상기 미리정해진 종료 조건은, 상기 에이전트가 상기 진단 대상 이미지 상에서 진동을 반복하는 경우 종료하는 것일 수 있으나, 그에 한정되지는 않는다. 상기 진단 특징점의 좌표는 상기 미리정해진 종료 조건이 만족시 상기 에이전트의 중심 좌표로 정의될 수 있다. 상기 진단 특징점은 단일 특징점일 수도 있고 다중 특징점을 포함할 수도 있다. 상기 진단 특징점이 N개 (N은 2 이상의 정수)의 다중 특징점들을 가지는 경우, 상기 학습데이터 세트 수집 단계(S310)는, 각 에이전트 이미지 입력이 N개의 특징점들까지의 최단거리로 이동하기 위한 N개의 이동방향의 다중 출력을 가지는 복수의 학습데이 터 세트를 수집할 수도 있다. 그러한 경우, 상기 특징점 도출 단계(S340)에서는, 상기 N개의 다중 특징점 중 지 정된 특징점을 도출하도록 요청시, 상기 진단영상의 이미지 상에 상기 에이전트 이동 모델을 적용시켜서 획득된 N개의 방향 결과 중 상기 지정된 특징점의 방향 결과만을 따라 상기 에이전트를 이동시키는 것에 의해 상기 지 정된 특징점의 좌표를 도출할 수도 있다. 도 5는 본 발명의 일 실시예에 따른 직관적 강화학습과 CNN모델을 이용한 의료 진단 영상의 특징점 검출 방법의 개략적인 흐름도를 도시하며, 도 6은 본 발명의 일 실시예에 따른 직관적 강화학습과 CNN 모델을 이용한 진단 영상의 특징점 검출 방법에서 에이전트의 이동 방향에 대한 정의와 결과적으로 이동한 에이전트의 이동 전 및 이동 후 이미지를 도시한다, 도 5를 참조하면, 우선 의료 영상의 이미지 상에 미리정해진 크기의 상하좌우 및 대각선의 이진화된 8개 방향으 로 이동가능한 특징점 탐색용 에이전트를 랜덤하게 위치시킨 에이전트 이미지 데이터와 상기 랜덤하게 위치된 에이전트 이미지로부터 미리정해진 특징점까지 최단거리로 이동하기 위한 이진화된 방향 데이터를 포함하는 복 수의 에이전트 학습데이터 세트를 수집한다 (단계 S510). 그 후, 상기 복수의 에이전트 학습데이터 세트에 기초하여 합성곱 신경망(CNN) 모델을 학습시켜 상기 에이전트 가 최단 거리로 특징점으로 이동하기 위한 에이전트 이동 모델을 생성한다 (단계 S520). 이러한 학습은 에이전 트 이동 모델이 생성된 후에도, 에이전트를 학습용 이미지 상에 무작위 좌표에 배치한 뒤 수 회 반복적으로 수 행될 수도 있다. 도 6은 본 발명의 일 실시예에 따른 직관적 강화학습과 CNN을 이용한 진단 영상의 특징점 검출 방법에서 에이전 트의 이동 방향에 대한 정의와 결과적으로 이동한 에이전트의 이동 전 및 이동 후 이미지를 도시한다. 도 6을 참조하면, 에이전트의 입력 이미지로부터 CNN모델에서 최종적으로 출력되는 결과는 3개의 시그모이드 (sigmoid) 함수로 정의하며 입력으로 어떤 이미지가 들어가든지 CNN의 내부 구조가 어떠하든지 결과적으로 3개 의 0 또는 1의 결과 값이 출력되고 이를 이진법으로 변환하면 총 8가지 경우의 수를 갖게 되어 3개의 시그모이 드에서 출력되는 0 또는 1 값을 8개 방향에 대입하여 표시하게 된다. 예를 들어, 도 6에서는 [0 0 0]을 위로 (Up) 이동, [0 0 1]을 오른쪽으로(Right) 이동, [0 1 0]을 왼쪽으로(Left) 이동, [0 1 1]을 아래로(Down) 이동, [1 0 0]을 대각선 오른쪽 위로(Diagonal up right) 이동, [1 0 1]을 대각선 오른쪽 아래로(Diagonal down right) 이동, [1 1 0]을 대각선 왼쪽 위로(Diagonal up left) 이동, [1 1 1]을 대각선 왼쪽 아래로(Diagonal down left) 이동하는 것으로 이동 방향 표시를 정의하였다. 예를 들어, [0 0 1] 이라는 출력 값은 오 른쪽 방향에 대응되기 때문에, 상기 에이전트 이동 모델에 적용하여 [0 0 1] 이라는 선택 방향 결과가 도출되면 에이전트를 나타내는 윈도우는 단위 거리만큼 오른쪽으로 이동한다. 이러한 방향 표시에 따라 에이전트를 나타 내는 윈도우는 미리정해진 단위 거리만큼 선택된 방향으로 이동하여 다음 입력 이미지를 CNN 모델, 즉 에이전트 이동 모델에 입력한다. 이렇게 학습된 에이전트 이동 모델은 신규의 진단 대상이 되는 이미지가 입력될 때 특징점(landmark)에 도달하 기 위한 최단 거리의 다음 이동 방향을 계산하여 이동하게 할 수 있다. 도 7은 도 5에서와 같은 직관적 강화학습과 CNN모델을 이용한 진단 영상의 특징점 검출 방법에 있어서 (a) 및 (b)가 에이전트를 진단 영상의 이미지 상에 랜덤한 위치에 배치하여 수집된 이미지로부터 미리정해진 특징점까 지 최단 거리로 이동하기 위한 방향을 수집하는 과정과 순차적인 이동 방향 좌표들을 나타낸다. 예를 들어, 도 7의 랜덤하게 배치된 에이전트는 에이전트 이동 모델에 의해 타겟 특징점까지의 최단 거리 이동 경로가 (a)에서와 같이 우선 오른쪽으로 ([0 0 1]) 이동하고 다시 (b)에서와 같이 아래로 ([0 1 1]) 이동하여 도달하여 타겟 특징점을 도출할 수 있을 것이다. 종래의 강화학습을 사용한 방법들에서는 CNN 기반으로 하는 경우 에이전트를 n개의 방향으로 이동하기 위해서는 n개의 출력을 가지는 CNN 출력이 필요하게 되어, 본원과 같이 정확도를 높이기 위해 에이전트를 8개 방향으로 이동시키기 위해서는 8개의 별개 출력 값을 가져야 한다. 그러나, 본 발명에 따르면 직관적인 강화학습에 기반 하여 3개의 출력 값만으로 8개의 방향을 표현할 수 있기 때문에, 종래의 방법들에 비교하여 훨씬 감소된 메모리 용량을 사용하고도 8개 방향을 표현하여 감소된 리소스로 효율적으로 더 높은 정확도를 나타낼 수 있다는 차별 화된 효과를 나타낸다. 도 5를 다시 참조하면, 에이전트 이동 모델이 생성된 후에는, 해부학적 특징점 또는 특정 병변의 탐색이 필요한 2차원 또는 3차원의 의료 영상의 이미지가 입력부를 통해 입력된다 (단계 S530). 상기 에이전트 이동 모델에 상기 입력된 진단 영상의 이미지를 적용하고 미리정해진 종료 조건에 따라 상기 진 단 영상의 이미지 상에서 상기 에이전트 이동 모델의 에이전트의 이동이 정지하는 지점의 데이터를 진단 특징점 으로 정의하여 도출한다 (단계 S540). 상기 특징점 도출 단계 후에, 상기 진단 특징점의 데이터와 상기 진단 대상 이미지 상의 위치를 표시하여 출력 하는 단계(단계 S550)를 더 포함할 수도 있다. 도 8은 본 발명의 일 실시예에 따른 직관적 강화학습과 CNN을 이용한 진단 영상의 특징점 검출 방법에서 (a)는 에이전트를 계속 랜덤한 위치에 놓고 학습데이터를 수집하는 방식을 나타내며, (b)는 에이전트를 최초에는 랜덤 한 위치에 배치하고 그 이후에는 특징점까지 최단거리로 이동시키며 이동시키는 경로에 따라 학습데이터를 수집 하는 방식을 나타낸다. (b)에서는 (a)에서와 달리, 이동시키는 동안 연속적으로 에이전트 크기의 이미지 세트를 수집하고 연속적으로 이동 방향을 수집한다. 이 두 방식은 초기 위치에 랜덤하게 에이전트를 배치하는 것은 동 일하지만, (a) 방식에서는 에이전트를 학습시키는 학습데이터 세트가 전부 독립적이며 서로 상관관계가 없는 반 면에, (b) 방식에서는 에이전트를 학습시키는 학습데이터 세트의 연속성이 보장되기 때문에 (a) 방식에서 보다 누락되는 이미지 영역을 줄일 수 있으므로 특징점 탐색의 정확도를 더욱 증가시킬 수 있다. 도 9의 (a)는 본 발명의 일 실시예에 따른 직관적 강화학습을 이용한 진단 영상의 특징점 검출 방법에서 에이전 트가 타겟 특징점에 + x 만큼의 거리를 남겨두고 도달하기 직전의 상태를 나타내며, 도 9의 (b)는 에이전트가 타겟 특징점에 도달하여 + x 과 - x 만큼의 영역 내에서 진동을 반복함으로서 에이전트의 이동의 종료 조건이 완결되는 것을 나타낸다. 신규 진단 대상이 되는 영상 이미지의 특징점 도출시, 학습이 완료된 에이전트 이동 모델을 적용하여 에이전트 를 상기 신규 진단 대상이 되는 영상 이미지 상에 배치한 후, 에이전트가 특징점에 도달하였을 때 이동의 종료 조건에 따라 특징점의 좌표를 결장하는 과정이 필요하다. 이는 에이전트 이동 모델에서 에이전트는 단순히 입력 된 이미지를 CNN을 이용하여 분석하고, 다음 이동 방향을 결정하는 기능만을 구비하고 있기 때문에 별도의 종료 조건이 없으면 특징점 근처에서 무한대로 진동하게 되기 때문이다. 따라서, 본 발명의 일 실시예에서는 에이전트가 이동하다가 일정 지점에서 진동을 반복하는 시점을 에이전트의 이동 종료 시점으로 하여 특징점에 도달한 것으로 정의하였으며, 이와 같이 에이전트의 이동이 종료된 순간의 에이전트의 중심 좌표를 특징점 좌표로 정의하였다. 그러나 종료 조건은 이에 한정되는 것은 아니다. 도 10은 본 발명의 일 실시예에 따른 직관적 강화학습을 이용한 진단 영상의 특징점 검출 방법에서 다중 특징점 의 경우에 처리 방법을 나타낸다. 본 발명의 일실시예에 따른 직관적 강화학습을 이용한 진단 영상의 특징점 검출 방법은 단일 에이전트를 이용하 여 단일 진단 특징점 또는 다중 진단 특징점을 도출하는 데 모두 사용할 수 있다. 본 발명의 일 실시예에 따른 에이전트 모델은 도 10에서 볼 수 있는 바와 같이 하나의 CNN과 특징점의 개수만큼의 완전 연결 계층(fully connected layer)을 가지는 구조일 수 있다. 기존의 CNN 방식에서는 많은 GPU 메모리 용량을 차지하는 반면에, 본 발명의 구조를 사용하면 CNN 모델 하나만을 이용하여 복수의 특징점을 동시에 찾을 수 있다는 장점이 있다. 도 10에서 같이 상기 진단 특징점이 L1, L2, L3, L4와 같이 N개 (N은 2 이상의 정수)의 다중 특징점들을 가지는 경우, 한 개의 에이전트로, 즉 하나의 CNN 모델로부터 생성된 에이전트 이동 모델로 다중 특징점을 도출하는 다 중 특징점 모델을 생성할 수 있다. 우선, 복수의 학습 영상 이미지들에 대하여, 에이전트가 다중 특징점을 가지는 학습데이터 이미지 상에 랜덤으 로 배치되며, 에이전트가 배치된 위치에서 수집된 이미지와 해당 이미지 상에서 N개의 특징점 각각까지의 최단 거리로 이동하기 위한 N개의 방향을 수집하여 학습데이터 세트를 생성한다. 수집된 복수의 이미지를 입력으로 하고 각각의 이미지에 해당하는 이진화 한 N개의 이동방향 (예를 들어, [0 0 0] 형식의 방향표시를 가질 수 있 음)을 출력으로 하는 학습데이터 세트를 이용하여 단일 agent의 CNN 모델을 학습하고 다중 특징점용 에이전트 이동 모델을 생성한다. 또한, 다중 특징점용 에이전트 이동 모델이 생성된 후에 에이전트를 다시 학습용 이미지 상의 무작위 좌표에 배치하여 위의 학습을 복수회 추가 반복하여 에이전트 이동 모델의 정확도를 높일 수도 있 다. 이와 같이 생성된 다중 특징점용 에이전트 이동 모델을 사용하여 다중 특징점 중 어느 하나를 도출하려는 경우, 예를 들어, 도 10에서 도시된 4개의 특징점 중 L1의 특징점을 도출하기 원한다면, 에이전트를 진단 대상의 이미 지 상에 랜덤하게 배치한 후, 그 위치에서 획득된 이미지로부터 얻어진 4개의 방향결과 중 L1의 방향에 해당하 는 1번 방향 결과만을 따라 에이전트를 이동시키며 L2 내지 L4에 해당하는 2 내지 4 번 결과는 무시함으로서 L1 의 특징점을 도출할 수 있다. 이상에서 설명된 특징점 도출 장치 및 특징점 도출 방법은 하드웨어 구성 요소, 소프트웨어 구성 요소, 및/또는 하드웨어 구성 요소 및 소프트웨어 구성 요소의 조합으로 구현될 수 있다. 예를 들어, 실시예들에서 설명된 시 스템, 장치, 방법 및 구성 요소는, 예를 들어, 프로세서, 콘트롤러, 중앙 처리 장치(Central Processing Unit; CPU), 그래픽 프로세싱 유닛(Graphics Processing Unit; GPU), ALU(arithmetic logic unit), 디지털 신호 프로 세서(digital signal processor), 마이크로컴퓨터, FPGA(field programmable gate array), PLU(programmable logic unit), 마이크로프로세서, 주문형 집적 회로(Application Specific Integrated Circuits; ASICS), 서버, 또는 명령(instruction)을 실행하고 응답할 수 있는 기타 다른 어떠한 컴퓨팅 장치와 같이, 하나 이상의 범용 컴퓨터 또는 특수 목적 컴퓨터를 이용하여 구현될 수 있다. 본 발명의 실시예에 따른 생존 정보 예측 방법은 다양한 컴퓨터 수단을 통하여 수행될 수 있는 프로그램 명령 형태로 구현되어 컴퓨터 판독 가능 매체에 기록될 수 있다. 상기 컴퓨터 판독 가능 매체는 프로그램 명령, 데이 터 파일, 데이터 구조 등을 단독으로 또는 조합하여 포함할 수 있다. 상기 매체에 기록되는 프로그램 명령은 실 시예를 위하여 특별히 설계되고 구성된 것들이거나 컴퓨터 소프트웨어 당업자에게 공지되어 사용 가능한 것일 수도 있다. 상기 하드웨어 장치는 실시예의 동작을 수행하기 위해 하나 이상의 소프트웨어 모듈로서 작동하도록 구성될 수 있으며, 그 역도 마찬가지이다."}
{"patent_id": "10-2022-0124275", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "이상과 같이 비록 한정된 도면에 의해 실시예들이 설명되었으나, 해당 기술분야에서 통상의 지식을 가진 자라면 상기의 기재로부터 다양한 수정 및 변형이 가능하다. 예를 들어, 설명된 기술들이 설명된 방법과 다른 순서로 수행되거나, 및/또는 설명된 시스템, 구조, 장치, 회로 등의 구성 요소들이 설명된 방법과 다른 형태로 결합 또 는 조합되거나, 다른 구성 요소 또는 균등물에 의하여 대치되거나 치환되더라도 적절한 결과가 달성될 수 있다. 본 발명의 범위는 후술하는 특허청구범위에 의하여 나타내어지며, 특허청구범위의 의미 및 범위 그리고 그 균등 개념으로부터 도출되는 모든 변경 또는 변형된 형태가 본 발명의 범위에 포함되는 것으로 해석되어야 한다."}
{"patent_id": "10-2022-0124275", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 종래기술에 따라 이미지에 U-net 알고리즘을 적용하여 특징점을 도출하는 구성의 개략도를 도시한다. 도 2는 본 발명의 일 실시예에 따른 직관적 강화학습을 이용한 진단 영상의 특징점 검출 장치의 개략적인 블록 도를 도시한다. 도 3은 본 발명의 일 실시예에 따라 직관적 강화학습을 이용하여 진단 영상의 이미지 상의 특징점을 검출시 에 이전트의 이동 방향 및 타겟 특징점까지의 최단 이동 경로를 도시한다. 도 4는 본 발명의 일 실시예에 따른 직관적 강화학습을 이용한 진단 영상의 특징점 검출 방법의 개략적인 흐름 도를 도시한다. 도 5는 본 발명의 일 실시예에 따른 직관적 강화학습을 이용한 의료 진단 영상의 특징점 검출 방법의 개략적인 흐름도를 도시한다. 도 6은 본 발명의 일 실시예에 따른 직관적 강화학습과 CNN을 이용한 진단 영상의 특징점 검출 방법에서 에이전 트의 이동 방향에 대한 정의와 결과적으로 이동한 에이전트의 이동 전 및 이동 후 이미지를 도시한다, 도 7은 본 발명의 일 실시예에 따른 직관적 강화학습과 CNN을 이용한 진단 영상의 특징점 검출 방법에 있어서 (a) 및 (b)가 에이전트를 진단 영상의 이미지 상에 랜덤한 위치에 배치하여 수집된 이미지로부터 미리정해진 특 징점까지 최단 거리로 이동하기 위한 방향을 수집하는 과정과 순차적인 이동 방향 좌표들을 나타낸다. 도 8은 본 발명의 일 실시예에 따른 직관적 강화학습과 CNN을 이용한 진단 영상의 특징점 검출 방법에서 (a)는에이전트를 계속 랜덤한 위치에 놓고 학습데이터를 수집하는 방식을 나타내며 (b)는 에이전트를 최초에는 랜덤 한 위치에 배치하고 그 이후에는 연속적으로 특징점까지 최단거리로 이동시키며 이동시키는 경로에 따라 학습데 이터를 수집하는 방식을 나타낸다. 도 9의 (a)는 본 발명의 일 실시예에 따른 직관적 강화학습을 이용한 진단 영상의 특징점 검출 방법에서 에이전 트가 타겟 특징점에 + x 만큼의 거리를 남겨두고 도달하기 직전의 상태를 나타내며, 도 9의 (b)는 에이전트가 타겟 특징점에 도달하여 + x 과 - x 만큼의 영역 내에서 진동을 반복함으로서 에이전트의 이동의 종료 조건이 완결되는 것을 나타낸다. 도 10은 본 발명의 일 실시예에 따른 직관적 강화학습을 이용한 진단 영상의 특징점 검출 방법에서 다중 특징점 의 경우에 처리 방법을 나타낸다."}
