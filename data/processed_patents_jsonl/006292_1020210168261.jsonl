{"patent_id": "10-2021-0168261", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2023-0080786", "출원번호": "10-2021-0168261", "발명의 명칭": "의상 코디 시스템 및 그것의 제어 방법", "출원인": "주식회사 카카오엔터프라이즈", "발명자": "홍은빈"}}
{"patent_id": "10-2021-0168261", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "입력된 의상 아이템에 대한 코디 정보를 출력하는 인공지능 신경망(Artificial neural network, ANN) 기반 의상코디 시스템에 있어서,적어도 하나의 합성곱 레이어(Convolution layer)를 포함하는 백본 구조(Backbone structure);상기 입력된 의상 아이템을 구성하는 적어도 두 개의 속성 각각에 대한 적어도 두 개의 특징 벡터를 각각 출력하는 적어도 두 개의 브랜치;제 1 의상 아이템에 대한 상기 적어도 두 개의 특징 벡터와 제 2 의상 아이템에 대한 상기 적어도 두 개의 특징벡터 간의 거리를 산출하는 거리 산출부; 및상기 산출된 거리에 기초하여, 상기 제 1 및 제 2 의상 아이템 간에 어울리는 정도를 판단하는 판단부를 포함하는,의상 코디 시스템."}
{"patent_id": "10-2021-0168261", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제 1 항에 있어서, 상기 적어도 두 개의 브랜치는,상기 입력된 의상 아이템의 콘텐츠 속성과 관련된 제 1 특징 벡터를 출력하는 제 1 브랜치; 및상기 입력된 의상 아이템의 스타일 속성과 관련된 제 2 특징 벡터를 출력하는 제 2 브랜치를 포함하는,의상 코디 시스템."}
{"patent_id": "10-2021-0168261", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제 2 항에 있어서,상기 콘텐츠 속성은, 상기 입력된 의상 아이템의 카테고리, 길이 및 핏 중 적어도 하나를 포함하고,상기 스타일 속성은, 상기 입력된 의상 아이템의 색상, 패턴 및 소재 중 적어도 하나를 포함하는,의상 코디 시스템."}
{"patent_id": "10-2021-0168261", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제 1 항에 있어서, 상기 적어도 두 개의 브랜치 각각은,관련 속성에 대한 분류를 수행하는 정방향 분류기(forward classifier);반대 속성에 대한 분류를 수행하는 역방향 분류기(reverse classifier);상기 정방향 분류기의 출력과 GT(Ground Truth) 간의 손실인 정방향 손실을 산출하는 정방향 손실 산출부; 및상기 역방향 분류기의 출력과 GT 간의 손실인 역방향 손실을 산출하는 역방향 손실 산출부를 포함하는,의상 코디 시스템.공개특허 10-2023-0080786-3-청구항 5 제 4 항에 있어서, 상기 적어도 두 개의 브랜치 각각은,적어도 하나의 합성곱 레이어를 포함하는,의상 코디 시스템."}
{"patent_id": "10-2021-0168261", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제 5 항에 있어서,상기 적어도 하나의 합성곱 레이어의 파라미터 학습을 수행하는 학습 제어부를 더 포함하되,상기 학습 제어부는, 상기 정방향 손실은 최소화시키고 상기 역방향 손실은 최대화시키는 방향으로 학습을 수행하는,의상 코디 시스템."}
{"patent_id": "10-2021-0168261", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제 6 항에 있어서,상기 학습 제어부는, 상기 역방향 손실에 대한 그레디언트에 음의 소정값을 곱하는 그레디언트 반전 레이어(gradient reversal layer)를 더 포함하는,의상 코디 시스템."}
{"patent_id": "10-2021-0168261", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제 7 항에 있어서,상기 음의 소정값은, '-1'인,의상 코디 시스템."}
{"patent_id": "10-2021-0168261", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제 8 항에 있어서, 상기 학습 제어부는,상기 음의 소정값이 곱해진 역방향 손실에 대한 그레디언트와 상기 정방향 손실에 대한 그레디언트의 합에 기초하여 상기 파라미터 학습을 수행하는,의상 코디 시스템."}
{"patent_id": "10-2021-0168261", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제 1 항 내지 제 9 항 중 어느 한 항에 있어서,상기 백본 구조 및 상기 적어도 두 개의 브랜치 중 적어도 하나는, 풀링 레이어(Pooling layer)를 더 포함하는,의상 코디 시스템."}
{"patent_id": "10-2021-0168261", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "공개특허 10-2023-0080786-4-입력된 의상 아이템에 대한 코디 정보를 출력하는 인공지능 신경망(Artificial neural network, ANN) 기반 의상코디 시스템의 제어 방법에 있어서,제 1 브랜치가 제 1 및 제 2 의상 아이템의 제 1 속성에 대한 적어도 두 개의 제 1 특징 벡터를 산출하는 단계;제 2 브랜치가 제 1 및 제 2 의상 아이템의 제 2 속성에 대한 적어도 두 개의 제 2 특징 벡터를 산출하는 단계;거리 산출부가 상기 적어도 두 개의 제 1 특징 벡터와 상기 적어도 두 개의 제 2 특징 벡터 간의 거리를 산출하는 단계; 및판단부가 상기 산출된 거리에 기초하여, 상기 제 1 및 제 2 의상 아이템 간에 어울리는 정도를 판단하는 단계를포함하는,의상 코디 시스템의 제어 방법."}
{"patent_id": "10-2021-0168261", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제 11 항에 있어서,상기 제 1 브랜치는, 상기 입력된 의상 아이템의 콘텐츠 속성과 관련된 제 1 특징 벡터를 출력하고,상기 제 2 브랜치는, 상기 입력된 의상 아이템의 스타일 속성과 관련된 제 2 특징 벡터를 출력하는,의상 코디 시스템의 제어 방법."}
{"patent_id": "10-2021-0168261", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "제 12 항에 있어서,상기 콘텐츠 속성은, 상기 입력된 의상 아이템의 카테고리, 길이 및 핏 중 적어도 하나를 포함하고,상기 스타일 속성은, 상기 입력된 의상 아이템의 색상, 패턴 및 소재 중 적어도 하나를 포함하는,의상 코디 시스템의 제어 방법."}
{"patent_id": "10-2021-0168261", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_14", "content": "제 11 항에 있어서,정방향 분류기가 관련 속성에 대한 분류를 수행하는 단계;역방향 분류기가 반대 속성에 대한 분류를 수행하는 단계;정방향 손실 산출부가 상기 정방향 분류기의 출력과 GT(Ground Truth) 간의 손실인 정방향 손실을 산출하는 단계; 및역방향 손실 산출부가 상기 역방향 분류기의 출력과 GT 간의 손실인 역방향 손실을 산출하는 단계를 포함하는,의상 코디 시스템의 제어 방법."}
{"patent_id": "10-2021-0168261", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_15", "content": "제 14 항에 있어서, 상기 제 1 및 제 2 브랜치 각각은,적어도 하나의 합성곱 레이어를 포함하는,의상 코디 시스템의 제어 방법.공개특허 10-2023-0080786-5-청구항 16 제 15 항에 있어서,학습 제어부가 상기 정방향 손실은 최소화시키고 상기 역방향 손실은 최대화시키는 방향으로 학습을 수행하는단계를 더 포함하는,의상 코디 시스템의 제어 방법."}
{"patent_id": "10-2021-0168261", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_17", "content": "제 16 항에 있어서, 상기 학습 제어부가 학습을 수행하는 단계는,그레디언트 반전 레이어(gradient reversal layer)가 상기 역방향 손실에 대한 그레디언트에 음의 소정값을 곱하는 단계를 더 포함하는,의상 코디 시스템의 제어 방법."}
{"patent_id": "10-2021-0168261", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_18", "content": "제 17 항에 있어서,상기 음의 소정값은, '-1'인,의상 코디 시스템의 제어 방법."}
{"patent_id": "10-2021-0168261", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_19", "content": "제 18 항에 있어서, 상기 학습 제어부가 학습을 수행하는 단계는,상기 음의 소정값이 곱해진 역방향 손실에 대한 그레디언트와 상기 정방향 손실에 대한 그레디언트의 합에 기초하여 상기 파라미터 학습을 수행하는,의상 코디 시스템의 제어 방법."}
{"patent_id": "10-2021-0168261", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_20", "content": "제 11 항 내지 제 19 항 중 어느 한 항에 있어서,상기 제 1 및 제 2 브랜치 중 적어도 하나는, 풀링 레이어(Pooling layer)를 더 포함하는,의상 코디 시스템의 제어 방법."}
{"patent_id": "10-2021-0168261", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은, 어울리는 의상에 대한 코디 정보를 출력해주는 코디 시스템에 관한 것이다. 보다 구체적으로 본 발명 은, 입력된 의상 아이템에 대한 코디 정보를 출력하는 인공지능 신경망(Artificial neural network, ANN) 기반 의상 코디 시스템에 있어서, 적어도 하나의 합성곱 레이어(Convolution layer)를 포함하는 백본 구조(Backbone structure), 상기 입력된 의상 아이템을 구성하는 적어도 두 개의 속성 각각에 대한 적어도 두 개의 특징 벡터를 각각 출력하는 적어도 두 개의 브랜치, 제 1 의상 아이템에 대한 상기 적어도 두 개의 특징 벡터와 제 2 의상 아 이템에 대한 상기 적어도 두 개의 특징 벡터 간의 거리를 산출하는 거리 산출부, 및 상기 산출된 거리에 기초하 여, 상기 제 1 및 제 2 의상 아이템의 어울림 정도를 판단하는 판단부를 포함하는, 의상 코디 시스템에 관한 것 이다."}
{"patent_id": "10-2021-0168261", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 의상을 코디해주기 위한 시스템 및 그것의 제어 방법에 관한 것으로, 보다 구체적으로는 특정 의상 아이템과 어울리는 다른 의상 아이템을 추천해주기 위한 시스템에 관한 것이다."}
{"patent_id": "10-2021-0168261", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "의상 코디 시스템이란, 일반적으로 많은 사람들에게 잘 어울리는 조합이라고 인정되는 상의, 하의 또는 모자 등 의 악세서리들의 조합을 추천해 주는 시스템을 말한다.기존 의상 코디 시스템의 경우, 단순히 입력된 아이템과 통일성 있는(유사한) 아이템을 추천해 주는 정도에 그 친다. 예를 들어, 일반적인 코디 시스템은 정장 바지라는 아이템이 입력되었을 때, 정장 자켓과의 조합을 추천 해 줄 수 있다. 하지만, 일반적으로 사람들에게 잘 어울리는 조합이라고 인정 받을 수 있는 코디는, 상의와 하의가 유사한 스타 일인 경우 보다는 서로 다른 경우가 더 많다. 예를 들어, 일반적으로 청바지(데님 재질)라는 하의는 흰색 티셔 츠라는 상의가 잘 어울린다고 인정된다. 하지만, 기존 의상 코디 시스템의 경우에는, 입력된 의류 아이템과 어울리는 아이템을 제안하는데 있어서 통일 성을 기준으로 하기 때문에, 청바지라는 아이템에 대해서 유사한 스타일인 청(데님)셔츠를 추천해 줄 수 있다. 이와 같이 기존 의류 시스템의 경우에는, 단순히 얼마나 유사한지 위주로 코디해 주기 때문에, 적절한 결과를 제공해 주지 못한다는 문제점이 존재한다. 이에 따라서, 코디 정보를 제공해 주는데 있어서, 아이템 간의 유사 도 뿐만 아니라 실제 어울리는 코디 정보를 제공해 줄 수 있는 기술에 대한 연구가 요구되는 실정이다."}
{"patent_id": "10-2021-0168261", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명이 해결하고자 하는 과제는 단순히 유사도가 높은 의상이 아닌, 실제 매칭이 잘 되는 의상을 코디해 줄 수 있는 시스템을 제공하는 것이다. 본 발명이 해결하고자 하는 다른 과제는 의상을 구성하는 복수 개의 속성들을 서로 구분 학습하여, 개별 속성에 대응되는 특성 벡터를 학습할 수 있는 시스템을 제공하는 것이다. 본 발명에서 이루고자 하는 기술적 과제들은 이상에서 언급한 기술적 과제들로 제한되지 않으며, 언급하지 않은"}
{"patent_id": "10-2021-0168261", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 2, "content": "또 다른 기술적 과제들은 아래의 기재로부터 본 발명이 속하는 기술분야에서 통상의 지식을 가진 자에게 명확하 게 이해될 수 있을 것이다."}
{"patent_id": "10-2021-0168261", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "상기 또는 다른 과제를 해결하기 위해 본 발명의 일 측면에 따르면, 입력된 의상 아이템에 대한 코디 정보를 출 력하는 인공지능 신경망(Artificial neural network, ANN) 기반 의상 코디 시스템에 있어서, 적어도 하나의 합 성곱 레이어(Convolution layer)를 포함하는 백본 구조(Backbone structure); 상기 입력된 의상 아이템을 구성 하는 적어도 두 개의 속성 각각에 대한 적어도 두 개의 특징 벡터를 각각 출력하는 적어도 두 개의 브랜치; 제 1 의상 아이템에 대한 상기 적어도 두 개의 특징 벡터와 제 2 의상 아이템에 대한 상기 적어도 두 개의 특징 벡 터 간의 거리를 산출하는 거리 산출부; 및 상기 산출된 거리에 기초하여, 상기 제 1 및 제 2 의상 아이템 간에 어울리는 정도를 판단하는 판단부를 포함하는, 의상 코디 시스템을 제공한다. 상기 적어도 두 개의 브랜치는, 상기 입력된 의상 아이템의 콘텐츠 속성과 관련된 제 1 특징 벡터를 출력하는 제 1 브랜치; 및 상기 입력된 의상 아이템의 스타일 속성과 관련된 제 2 특징 벡터를 출력하는 제 2 브랜치를 포함할 수 있다. 상기 콘텐츠 속성은, 상기 입력된 의상 아이템의 카테고리, 길이 및 핏 중 적어도 하나를 포함하고, 상기 스타 일 속성은, 상기 입력된 의상 아이템의 색상, 패턴 및 소재 중 적어도 하나를 포함할 수 있다. 상기 적어도 두 개의 브랜치 각각은, 관련 속성에 대한 분류를 수행하는 정방향 분류기(forward classifier); 반대 속성에 대한 분류를 수행하는 역방향 분류기(reverse classifier); 상기 정방향 분류기의 출력과 GT(Ground Truth) 간의 손실인 정방향 손실을 산출하는 정방향 손실 산출부; 및 상기 역방향 분류기의 출력과 GT 간의 손실인 역방향 손실을 산출하는 역방향 손실 산출부를 포함할 수 있다. 상기 적어도 두 개의 브랜치 각각은, 적어도 하나의 합성곱 레이어를 포함할 수 있다. 상기 적어도 하나의 합성곱 레이어의 파라미터 학습을 수행하는 학습 제어부를 더 포함하되, 상기 학습 제어부 는, 상기 정방향 손실은 최소화시키고 상기 역방향 손실은 최대화시키는 방향으로 학습을 수행할 수 있다.상기 학습 제어부는, 상기 역방향 손실에 대한 그레디언트에 음의 소정값을 곱하는 그레디언트 반전 레이어 (gradient reversal layer)를 더 포함할 수 있다. 상기 음의 소정값은, '-1'일 수 있다. 상기 학습 제어부는, 상기 음의 소정값이 곱해진 역방향 손실에 대한 그레디언트와 상기 정방향 손실에 대한 그레디언트의 합에 기초하여 상기 파라미터 학습을 수행할 수 있다. 상기 백본 구조 및 상기 적어도 두 개의 브랜치 중 적어도 하나는, 풀링 레이어(Pooling layer)를 더 포함할 수 있다. 상기 또는 다른 과제를 해결하기 위해 본 발명의 다른 측면에 따르면, 입력된 의상 아이템에 대한 코디 정보를 출력하는 인공지능 신경망(Artificial neural network, ANN) 기반 의상 코디 시스템의 제어 방법에 있어서, 제 1 브랜치가 제 1 및 제 2 의상 아이템의 제 1 속성에 대한 상기 적어도 두 개의 제 1 특징 벡터를 산출하는 단 계; 제 2 브랜치가 제 1 및 제 2 의상 아이템의 제 2 속성에 대한 상기 적어도 두 개의 제 2 특징 벡터를 산출 하는 단계; 대조 손실 산출부가 상기 적어도 두 개의 제 1 특징 벡터와 상기 적어도 두 개의 제 2 특징 벡터 간 의 거리를 산출하는 단계; 및 판단부가 상기 산출된 거리에 기초하여, 상기 제 1 및 제 2 의상 아이템 간에 어 울리는 정도를 판단하는 단계를 포함하는, 의상 코디 시스템의 제어 방법을 제공한다. 상기 적어도 두 개의 브랜치는, 상기 입력된 의상 아이템의 콘텐츠 속성과 관련된 제 1 특징 벡터를 출력하는 제 1 브랜치; 및 상기 입력된 의상 아이템의 스타일 속성과 관련된 제 2 특징 벡터를 출력하는 제 2 브랜치를 포함할 수 있다. 상기 콘텐츠 속성은, 상기 입력된 의상 아이템의 카테고리, 길이 및 핏 중 적어도 하나를 포함하고, 상기 스타 일 속성은, 상기 입력된 의상 아이템의 색상, 패턴 및 소재 중 적어도 하나를 포함할 수 있다. 정방향 분류기가 관련 속성에 대한 분류를 수행하는 단계; 역방향 분류기가 반대 속성에 대한 분류를 수행하는 단계; 정방향 손실 산출부가 상기 정방향 분류기의 출력과 GT(Ground Truth) 간의 손실인 정방향 손실을 산출하 는 단계; 및 역방향 손실 산출부가 상기 역방향 분류기의 출력과 GT 간의 손실인 역방향 손실을 산출하는 단계 를 포함할 수 있다. 상기 제 1 및 제 2 브랜치 각각은, 적어도 하나의 합성곱 레이어를 포함할 수 있다. 상기 학습 제어부가 상기 정방향 손실은 최소화시키고 상기 역방향 손실은 최대화시키는 방향으로 학습을 수행 하는 단계를 더 포함할 수 있다. 상기 학습 제어부가 학습을 수행하는 단계는, 그레디언트 반전 레이어(gradient reversal layer)가 상기 역방향 손실에 대한 그레디언트에 음의 소정값을 곱하는 단계를 더 포함할 수 있다. 상기 음의 소정값은, '-1'일 수 있다. 상기 학습 제어부가 학습을 수행하는 단계는, 상기 음의 소정값이 곱해진 역방향 손실에 대한 그레디언트와 상 기 정방향 손실에 대한 그레디언트의 합에 기초하여 상기 파라미터 학습을 수행할 수 있다. 상기 제 1 및 제 2 브랜치 중 적어도 하나는, 풀링 레이어(Pooling layer)를 더 포함할 수 있다."}
{"patent_id": "10-2021-0168261", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명에 따른 의상 코디 시스템 및 그것의 제어 방법의 효과에 대해 설명하면 다음과 같다. 본 발명의 실시 예들 중 적어도 하나에 의하면, 서로 다른 카테고리에 속한 의상들 간에 어울림 정도를 정확하 게 판단할 수 있는 의상 코디 시스템을 제공할 수 있다는 장점이 있다. 본 발명의 실시 예들 중 적어도 하나에 의하면, 의상을 구성하는 복수 개의속성이 서로 혼재되지 않고 구분시켜 학습함으로써, 서로 다른 속성 간에 관계를 고려하여 어울리는 정도의 판단이 가능한 시스템을 제공할 수 있다 는 장점이 있다. 본 발명의 적용 가능성의 추가적인 범위는 이하의 상세한 설명으로부터 명백해질 것이다. 그러나 본 발명의 사 상 및 범위 내에서 다양한 변경 및 수정은 당업자에게 명확하게 이해될 수 있으므로, 상세한 설명 및 본 발명의 바람직한 실시 예와 같은 특정 실시 예는 단지 예시로 주어진 것으로 이해되어야 한다."}
{"patent_id": "10-2021-0168261", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하, 첨부된 도면을 참조하여 본 명세서에 개시된 실시 예를 상세히 설명하되, 도면 부호에 관계없이 동일하거 나 유사한 구성요소는 동일한 참조 번호를 부여하고 이에 대한 중복되는 설명은 생략하기로 한다. 이하의 설명 에서 사용되는 구성요소에 대한 접미사 \"모듈\" 및 \"부\"는 명세서 작성의 용이함만이 고려되어 부여되거나 혼용 되는 것으로서, 그 자체로 서로 구별되는 의미 또는 역할을 갖는 것은 아니다. 또한, 본 명세서에 개시된 실시 예를 설명함에 있어서 관련된 공지 기술에 대한 구체적인 설명이 본 명세서에 개시된 실시 예의 요지를 흐릴 수 있다고 판단되는 경우 그 상세한 설명을 생략한다. 또한, 첨부된 도면은 본 명세서에 개시된 실시 예를 쉽게 이 해할 수 있도록 하기 위한 것일 뿐, 첨부된 도면에 의해 본 명세서에 개시된 기술적 사상이 제한되지 않으며, 본 발명의 사상 및 기술 범위에 포함되는 모든 변경, 균등물 내지 대체물을 포함하는 것으로 이해되어야 한다. 제1, 제2 등과 같이 서수를 포함하는 용어는 다양한 구성요소들을 설명하는데 사용될 수 있지만, 상기 구성요소 들은 상기 용어들에 의해 한정되지는 않는다. 상기 용어들은 하나의 구성요소를 다른 구성요소로부터 구별하는 목적으로만 사용된다. 어떤 구성요소가 다른 구성요소에 \"연결되어\" 있다거나 \"접속되어\" 있다고 언급된 때에는, 그 다른 구성요소에 직접적으로 연결되어 있거나 또는 접속되어 있을 수도 있지만, 중간에 다른 구성요소가 존재할 수도 있다고 이 해되어야 할 것이다. 반면에, 어떤 구성요소가 다른 구성요소에 \"직접 연결되어\" 있다거나 \"직접 접속되어\" 있 다고 언급된 때에는, 중간에 다른 구성요소가 존재하지 않는 것으로 이해되어야 할 것이다. 단수의 표현은 문맥상 명백하게 다르게 뜻하지 않는 한, 복수의 표현을 포함한다. 본 출원에서, \"포함한다\" 또는 \"가지다\" 등의 용어는 명세서상에 기재된 특징, 숫자, 단계, 동작, 구성요소, 부 품 또는 이들을 조합한 것이 존재함을 지정하려는 것이지, 하나 또는 그 이상의 다른 특징들이나 숫자, 단계, 동작, 구성요소, 부품 또는 이들을 조합한 것들의 존재 또는 부가 가능성을 미리 배제하지 않는 것으로 이해되 어야 한다. 어울리는 의상 찾기(fashion compatibility) 기술이란, 상품(의상 아이템)을 포함하는 이미지를 입력으로 넣고, 입력으로 주어진 상품과 가장 잘 어울리면서 다른 카테고리에 속하는 상품(예를 들면, 흰 티셔츠에는 청바지)을 추천해주는 기술을 말한다. 즉, 특정 상품과 어울리는 다른 상품을 골라주는 코디를 해주는 기술을 의미하며, 어울리는 의상 찾기 기술이 구현된 시스템을 코디 시스템이라 한다. 어울리는 의상 찾기와 관련된 기술 분야는 유사 상품 찾기와는 달리 서로 다른 카테고리(예를 들면, 상의 상품 vs 하의 상품)의 상품을 비교해야 하기 때문에 \"모양이 유사하다\"는 개념과 \"색상이나 패턴이 어울린다\"의 개념 이 상충된다. 즉, 모양은 유사하지 않으면서(상의나 하의의 모양은 상이함) 색상이나 패턴이 잘 어울리는(예를 들어 빨간 정장 치마에 어울리는 흰 블라우스) 상품을 찾는 것이 어울리는 의상 찾기 기술의 목적이라 할 수 있 다.종래의 코디 시스템에서는, 후보 상품 이미지들 각각에서 추출한 특징 벡터를 데이터베이스에 기저장해 두고, 입력된 상품 이미지에서 추출한 특징 벡터와 데이터베이스에 기저장된 후보 상품들의 특징 벡터 사이의 유사도 를 측정하며, 유사도가 높은(추출된 특징 벡터 간에 가까운) 상품들을 입력된 상품과 어울리는 의상 아이템으로 추천한다. 이 때, 후보 상품들은 입력 상품과 다른 (예를 들면 입력 상품이 상의이면 후보 상품은 하의) 카테고 리에 속할 것이다. 이와 같은 종래의 코디 시스템은, 특징 벡터 추출을 위한 딥러닝 모델의 학습 시 단순히 최종 특징 벡터들 간의 유사도 만을 손실 함수(Loss function)로 이용하기 때문에 색상, 모양, 텍스쳐 등 여러 패션 요소들이 서로 혼 재되어 반영된 특징 벡터가 학습 된다. 이러한 종래 코디 시스템의 경우, 색상 측면에서는 잘 어울리는 옷이라 도 모양이 서로 어울리지 않는 옷이 결과로 나올 수 있다는 단점이 있다. 상품이 특정 모양일 때는 특정 색상이 어울리고, 반대로 특정 색상일 때는 특정 모양이 더 어울린다는 고차원 정보를 특징 벡터에 학습시키기 위해서는 여러 패션 요소를 분리하여 해당 요소 정보만을 담고 있는 개별 특징 벡터를 학습하는 과정이 요구된다. 이에 따라, 이하에서 설명되는 본 발명의 일실시예에서는 분리된 속성 특징(disentangled Attribute Feature)을 활용하여 의상 아이템(들) 간에 어울리는 정도를 판단하도록 제안한다. 도 1은 본 발명의 일실시예에 따른 코디 시스템의 개념도를 도시하는 도면이다. 도 1을 참조하면, 본 발명의 일실시예에 따른 코디 시스템은 의상 분석 모델, 데이터베이스, 거 리 산출부, 판단부 및 학습 제어부를 포함하도록 구성될 수 있다. 도 1에 도시된 구성요소들은 코디 시스템을 구현하는데 있어서 필수적인 것은 아니어서, 본 명세서 상에서 설명되는 코디 시스템은 위에서 열거된 구성요소들 보다 많거나, 또는 적은 구성요소들을 가질 수 있다. 의상 분석 모델은 상품 이미지를 입력으로 받으면, 상품 이미지에 대한 특징 벡터를 출력한다. 본 발명의 일실시예에 따른 의상 분석 모델은 인공지능 신경망(artificial neural network, ANN) 모델일 수 있으며, 예를 들면 합성곱 신경망(Convolutional Neural Network, CNN) 또는 비젼 트렌스포머(Vision Transfomer, ViT)에 기초한 모델일 수 있다. 특징 벡터란, 상품 이미지의 특징을 분석하여 벡터화 시킨 결과를 의미할 수 있다. 따라서, 유사한 상품 이미지들 간에는 유사한 벡터가 출력되며, 유사하지 않은 상품 이미지 간에 특징 벡터는 서로 거리가 멀게 출력 될 수 있을 것이다. 반대로 말하면, 서로 다른 특징 벡터가 가깝다면 서로 유사한 상품에 대한 이미지이고, 서 로 다른 특징 벡터가 멀다면 서로 비유사한 상품에 대한 이미지일 것이다. 이하에서 설명되는 본 발명의 일실시예에서는, 서로 가까운 특징 벡터들이 단순히 유사한 상품이 되도록 하는 것이 아니라, 서로 가까운 특징 벡터들이 서로 어울리는 상품이 될 수 있는 의상 분석 모델을 제안한다. 즉, 본 발명의 실시예에 따른 의상 분석 모델은, 단순하게 상품 이미지 만을 이용하여 학습을 수행하는 것 이 아니라, 상품을 구성하는 다양한 속성들을 분리시켜 학습을 수행함으로써, 상품 간에 어울리는 정도를 보다 정확하게 판단할 수 있는 특징 벡터를 산출시키도록 제안하는 것이다. 예를 들어, 본 발명의 일실시예에서는, 콘텐츠 속성(카테고리, 길이, 핏)과 스타일 속성(색상, 패턴, 소재)을 분리하도록 학습된 특징 벡터를 이용함으로써, 각 요소들이 모두 섞여있는 특징 벡터를 이용하는 기존 방법보다 입력 상품과 더 잘 어울리는 상품 추천 결과를 얻도록 제안한다. 데이터베이스는, 후보 상품 이미지들에 대하여 미리 추출된 특징 벡터들이 저장될 수 있다. 이때 특징 벡 터들은 각각의 상품 이미지에 대응되어 저장되어 있을 수 있다. 본 발명의 일실시예에 따른 코디 시스템은, 상품 이미지가 입력되면, 의상 분석 모델에 의해서 특징 벡터가 추출(산출)된다. 거리 산출부는 추출된 특징 벡터를 데이터베이스에 저장되어 있는 다른 특징 벡터들과 비교하여, 거 리를 산출한다. 즉 입력된 상품 이미지의 특징 벡터와 데이터베이스에 저장되어 있는 특징 벡터들 사 이에 거리를 산출한다.판단부는, 상기 산출된 거리에 기초하여, 복수 개의 의상 아이템 간에 어울리는 정도를 판단하기 위한 구 성이다. 입력된 상품 이미지와 잘 어울리는 상품에 대한 결과를 출력할 수 있다. 예를 들어 결과 는, 입력된 상품 이미지와 잘 어울리는 상품들의 이미지를 포함할 수 있다. 입력된 상품 이미지(19 0)가 도시된 도면에서와 같이 하의일 경우, 출력되는 결과는 입력된 하의와 어울리는 상의의 추천 결과일 것이다. 도 1에서의 코디 시스템은, 데이터베이스에 저장되어 있는 복수 개의 상품들 각각과 특징 벡터 간의 거리를 산출하고 결과를 출력하고 있으나, 이에 한정되지 않고 두 개의 상품에 대한 이미지를 대상으로 특징 벡 터 간의 거리를 산출하고, 두 개의 상품이 얼마나 어울리는 정도를 판단하여 출력해 줄 수도 있을 것이다. 학습 제어부는, 산출된 손실(loss)에 기초하여 의상 분석 모델을 구성하는 합성곱 레이어, 풀링 레이 어 중 적어도 하나에 대한 파라미터를 업데이트한다. 즉, 학습 제어부는 손실을 최소화시키는 방향으로 의 상 분석 모델의 파라미터를 업데이트할 수 있다. 파라미터의 업데이트는, 지도 학습(Supervised Learnin g)에 기초하여 수행될 수 있다. 도 2는 본 발명의 일실시예에 따른 코디 시스템을 구성하는 의상 분석 모델의 내부 블록도를 도시하 는 도면이다. 도 2를 참조하면, 본 발명의 일실시예에 따른 의상 분석 모델은 백본 구조 및 적어도 두 개의 브랜치 (120-1 ~ 120-N)를 포함하도록 구성될 수 있다. 도 2에 도시된 구성요소들은 의상 분석 모델을 구현하는데 있어서 필수적인 것은 아니어서, 본 명세서 상 에서 설명되는 의상 분석 모델은 위에서 열거된 구성요소들 보다 많거나, 또는 적은 구성요소들을 가질 수 있다. 백본 구조(110, Backbone structure)는 합성곱 레이어(convolution layer)와 풀링 레이어(pooling layer) 중 적어도 하나를 포함하도록 구성될 수 있다. 합성곱 레이어란, 합성곱 연산을 통해서 이미지의 특징을 추출하는 계층을 말하며, 합성곱 신경망에서 기본이 되는 추출 유닛이다. 일반적으로 합성곱 연산과 활성화 함수 ReLU를 거치는 과정이 합성곱 레이어에서 이루어진 다. 합성곱 레이어를 거친 데이터는, 특성 맵이라고 부른다. 풀링 레이어란, 풀링 연산이 수행되는 계층을 말한다. 일반적으로 합성곱 레이어 다음에는 풀링 레이어가 추가 된다. 풀링 레이어에서는 특성 맵을 다운샘플링하여 특성 맵의 크기를 줄이기 위하여 풀링 연산이 이루어진다. 풀링 연산에는 일반적으로 최대 풀링(max pooling)과 평균 풀링(average pooling)이 사용될 수 있다. 상기 합성곱 레이어와 풀링 레이어는, 복수 개가 조합되어 백본 구조를 형성할 수 있다. 합성곱 레이어와 풀링 레이어는 백본 구조에 포함되어 있지만, 이하에서 후술되는 복수 개의 브랜치(120-1 ~ 120-N) 내부의 합성곱 블록(301-1, 301-2, ...)에도 마찬가지로 포함되어 있을 수 있다. 학습 제어부가 파라미터를 업데이트하는 대상은 백본 구조의 합성곱 레이어 및 풀링 레이어의 파라미 터뿐만 아니라, 각 브랜치에 속해 있는 합성곱 블록의 합성곱 레이어 및 풀링 레이어의 파라미터도 포함될 수 있다. 본 발명의 일실시예에 따른 코디 시스템은, 상품의 분리된 속성을 이용하여 특징 벡터를 산출하도록 제안 한다. 이를 위해서 본 발명의 일실시예에 따른 코디 시스템은, 분리된 속성들 각각에 대해서 구분된 학습 을 수행할 수 있도록 복수 개의 브랜치(120-1 ~ 120-N)를 구비하도록 제안한다. 복수 개의 브랜치(120-1 ~ 120- N)는 분리된 속성들이 구분되어 학습을 수행할 수 있도록 한다. 복수 개의 브랜치(120-1 ~ 120-N) 내부의 세부 구조에 대해서는 이하 도 3 내지 도 5를 참조하여 설명한다. 이하, 도 3 내지 도 5를 참조하여 브랜치 내부 구조에 대해서 설명한다. 도 3은 본 발명의 일실시예에 따른 브랜치 내부 구조를 도시하는 도면이다. 이하에서는 복수 개의 브랜치 (120-1, 120-2, ...)를 통칭하여 브랜치로 부른다. 이하 도면에서는, 설명의 편의를 위하여 제 1 및 제 2 브랜치(120-1, 120-2)만을 도시하지만, 상술한 바와 같이 본 발명이 두 개의 브랜치에 한정되지 않고 복수 개의 브랜치로 구성될 수 있음은 자명하다. 도시된 구조에 의하면, 각 브랜치는, 합성곱 블록(301-1, 301-2, ...), 풀링 레이어(302-1, 302-2, ...), 분류기(303-1, 303-2, ...) 및 손실 산출부(304-1, 304-2, ...)를 포함하도록 구성될 수 있다. 이하 본 발명의 상세한 설명에서는 설명의 편의를 위해, 의상의 속성을 콘텐츠 속성(카테고리, 길이, 핏)과 스 타일 속성(색상, 패턴, 소재)으로 분리하고, 콘텐츠 속성 관련된 특성 벡터는 제 1 브랜치(120-1)에서 학습하고, 스타일 속성에 관련된 특성 벡터는 제 2 브랜치(120-2)에서 학습하는 것을 예시로 설명한다. 도 3에 도시된 구성요소들은 브랜치를 구현하는데 있어서 필수적인 것은 아니어서, 본 명세서 상에서 설명 되는 브랜치는 위에서 열거된 구성요소들 보다 많거나, 또는 적은 구성요소들을 가질 수 있다. 합성곱 블록(301-1, 301-2, ...)은, 상술한 적어도 하나의 합성곱 레이어를 포함하도록 구성된다. 경우에 따라 서, 합성곱 블록에 풀링 레이어가 합성곱 레이어와 조합되는 방식으로 포함할 수도 있다. 풀링 레이어(302-1, 302-2, ...)는, 상기 합성곱 블록의 출력에 대해서 풀링을 수행하기 위한 계층이다. 풀링 레이어에서는, 앞서 설명한 바와 같이, 특성 맵을 다운샘플링하여 특성 맵의 크기를 줄이기 위하여 풀링 연산이 이루어진다. 풀링 연산에는 일반적으로 최대 풀링과 평균 풀링이 사용될 수 있다. 분류기(303-1, 303-2, ..., classifier)는, 평탄화 작업을 통해 이미지를 분류하는데 사용되는 계층이다. 본 발 명의 일실시예에 따른 분류기는 완전 연결 레이어(FC layer, Fully Connected layer)로 구성되어 2차원 이상의 배열 형태 이미지를 1차원의 벡터로 변환시킨다. 손실 산출부(304-1, 304-2, ...)는, 손실 함수(Loss function)에 기초하여 분류기의 출력과 GT(Ground Truth) 간에 손실(Loss)을 계산한다. GT란, 지도 학습 데이터에 포함되어 있는 정답 데이터를 의미한다. 상술한 학습 제어부는, 상기 손실 산출부가 산출한 손실을 최소화 시키는 방향으로 파라미터를 업데 이트할 수 있을 것이다. 파라미터를 업데이트 하기 위한 경로는 도시된 도면에서 'back propagation' 화살표(점 선 화살표) 경로를 따라서 합성곱 블록의 파라미터 및 백본 구조의 파라미터를 업데이트 할 수 있다. 도 3의 제 1 브랜치(120-1)의 손실 산출부에 의해서 산출된 손실을 그리고 제 2 브랜치(120-2)의 손실 산출부에 의해서 산출된 손실을 라고 하였을 때, 전체 손실 은 아래 수학식 1에서와 같이 표 현될 수 있다. 수학식 1"}
{"patent_id": "10-2021-0168261", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "만약, 백본 구조의 파라미터를 라고 했을 때, 'back propagation'에 의해서 업데이트 되는 파라미터 는 아래 수학식 2로 표현될 수 있다. 수학식 2 이때 λ는, 학습률(learning rate) 또는 학습 보폭(step size)이다. 도 3의 실시예를 참조하면, 제 1 및 제 2 브랜치(120-1, 120-2)로 의상의 속성을 구분하여 학습을 수행하고 있 지만, 반대 속성이 충분히 배제되어 학습이 이루어지는 것은 아니다. 예를 들어, 제 1 브랜치(120-1)는 콘텐츠 속성에 관련한 학습을 수행하고 제 2 브랜치(120-2)는 스타일 속성에 관련된 학습을 수행한다고 가정하였을 때, 제 1 브랜치(120-1)에서 스타일 속성이 충분히 배제되거나 제 2 브랜 치(120-2)에서 콘텐츠 속성이 충분히 배제되지 않은 채로 학습이 진행된다. 이하 본 발명의 일실시예에서는, 각 브랜치에서 자신이 다루고 있는 속성을 '관련 속성'이라 하고, 자신 이외에 다른 브랜치들이 다루고 있는 속성을 '반대 속성'이라고 부른다. 도 4에서는 각 브랜치에서 관련 속성만을 좀 더 충분히 다루고, 반대 속성은 보다 효과적으로 배제시킬 수 있는 학습 방법 및 구조에 대해 제안한다. 도 4는 본 발명의 일실시예에 따라 반대 속성을 효과적으로 배제시킨 상태에서 학습을 수행하기 위한 코디 시스 템의 브랜치 구조를 도시하는 도면이다. 도시된 구조에 의하면, 각 브랜치는, 합성곱 블록(301-1, 301-2, ...), 풀링 레이어(302-1, 302-2, ...), 그레디언트 반전 레이어(401-1, 401-2, ...), 역방향 분류기(402-1, 402-2, ...), 정방향 분류기(403-1, 403- 2, ...), 역방향 손실 산출부(404-1, 404-2, ...) 및 정방향 손실 산출부(405-1, 405-2, ...)를 포함하도록 구 성될 수 있다. 도 4에서는 제 1 및 제 2 브랜치(120-1)의 구성만을 설명하지만, 제 3 브랜치(120-3) 내지 나머 지 브랜치의 구성은 제 1 및 제 2 브랜치(120-1)와 동일할 것이다. 도 4에 도시된 구성요소들은 브랜치를 구현하는데 있어서 필수적인 것은 아니어서, 본 명세서 상에서 설명 되는 브랜치는 위에서 열거된 구성요소들 보다 많거나, 또는 적은 구성요소들을 가질 수 있다. 또한, 도 3에서 이미 설명한 구성에 대해서는 설명을 생략한다. 이하 본 발명의 상세한 설명에서는 설명의 편의를 위해, 의상의 속성을 콘텐츠 속성(카테고리, 길이, 핏)과 스 타일 속성(색상, 패턴, 소재)으로 분리하고, 콘텐츠 속성 관련된 특성 벡터는 제 1 브랜치(120-1)에서 학습하고, 스타일 속성에 관련된 특성 벡터는 제 2 브랜치(120-2)에서 학습하는 것을 예시로 설명한다. 즉 제 1 브랜치(120-1)는 콘텐츠 브랜치이고, 제 2 브랜치(120-2)는 스타일 브렌치인 경우를 예시로 설명한다. 제 1 그레디언트 반전 레이어(401-1, gradient reversal layer)는, 제 1 역방향 손실 산출부(404-1)가 산출한 역방향 손실에 대한 그레디언트에 음의 소정값을 곱하는 구성이다. 본 발명의 일실시예에 따른 음의 소정값은 '-1'일 수 있다. 즉, 제 1 그레디언트 반전 레이어(401-1)를 통해 그레디언트 값에 '-1'를 곱해 줌으로써 그 반대 속성을 잘 맞 추지 못하는 방향으로 브랜치의 파라미터 , 가 최적화 되도록 유도된다. 제 1 정방향 분류기(403-1)는, 해당 브랜치와 관련되는 속성인 '관련 속성'을 분류하기 위한 계층이다. 그리고 제 1 역방향 분류기(402-1) 해당 브랜치와 관련이 없는 속성인 '반대 속성'을 분류하기 위한 계층이다. 본 발명 의 일실시예에 따른 정방향 및 역방향 분류기(403-1, 402-1)는 완전 연결 레이어(FC layer, Fully Connected layer)로 구성되어 2차원 이상의 배열 형태 이미지를 1차원의 벡터로 변환시킬 수 있다. 제 1 정방향 손실 산출부(405-1)는, 상기 정방향 분류기의 출력과 GT 간의 손실인 '정방향 손실'을 산출하기 위 한 구성이다. 제 1 역방향 손실 산출부(404-1)는, 상기 역방향 분류기의 출력과 GT 간의 손실인 '역방향 손실' 을 산출하기 위한 구성이다. 본 발명의 일실시예에 따른 제 1 정방향 및 역방향 손실 산출부(405-1, 404-1)는 BCE 손실(Binary Cross Entropy Loss)에 기초하여 정방향 손실 및 역방향 손실을 각각 산출할 수 있다. 제 1 브랜치(120-1)의 정방향 손실을 , 역방향 손실을 , 제 2 브랜치(120-2)의 정방향 손실을 그리 고 역방향 손실을 라고 하였을 때, 본 발명의 일실시예에서 제안하는 전체 손실 을 아래 수학식 3으로 표현할 수 있다. 수학식 3"}
{"patent_id": "10-2021-0168261", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "제 1 및 제 2 그레디언트 반전 레이어(401-1, 401-2)의 음의 소정값을 '-1'이라 하고, 백본 구조의 파라미 터를 , 업데이트되는 파라미터를 라고 하면, 학습 제어부는 아래 수학식 4에서와 같이 파라미 터를 업데이트할 수 있다. 수학식 4"}
{"patent_id": "10-2021-0168261", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "이때 λ는, 학습률(learning rate) 또는 학습 보폭(step size)이다. 그리고 제 1 합성곱 블록(301-1)의 파라미터를 , 업데이트된 파라미터를 라고 했을 때, 학습 제어부 는 아래 수학식 5에서와 같이 파라미터를 업데이트할 수 있다. 수학식 5"}
{"patent_id": "10-2021-0168261", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 5, "content": "이때 λ는, 학습률(learning rate) 또는 학습 보폭(step size)이다. 마찬가지로 제 2 합성곱 블록(301-2)의 파라미터를 , 업데이트된 파라미터를 라고 했을 때, 학습 제어 부는 아래 수학식 6에서와 같이 파라미터를 업데이트할 수 있다. 수학식 6"}
{"patent_id": "10-2021-0168261", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 6, "content": "이때 λ는, 학습률(learning rate) 또는 학습 보폭(step size)이다. 도 4와 함께 설명된 학습 절차에 의해서 파라미터 , 및 를 업데이트한 후, 본 발명의 일실시예에 서는, 추가 레이어를 통하여 어울리는 의상 찾기를 위한 학습을 진행할 수 있다. 이러한 학습을 진행하기 위한 구조에 대해서 이하 도 5를 참조하여 설명한다. 이하 본 발명의 상세한 설명에서는, 도 4에서 파라미터 , 및 를 업데이트하는 학습을 제 1 단계 학습이라 하고, 이하에서 후술되는 도 5에서 네트워크 파라미터 중 적어도 하나를 최적화시키는 학 습을 제 2 단계 학습이라 부른다. 도 5는 본 발명의 일실시예에 따른 코디 시스템의 어울림 정도를 학습하기 위한 블록도를 도시하는 도면이 다. 도 5에서 설명하는 제 2 단계 학습은, 도 4에서 제 1 단계 학습한 백본 구조의 파라미터 , 제 1 합성 곱 블록(301-1)의 파라미터 및 제 2 합성곱 블록(301-2)의 파라미터 를 고정시킨 상태에서, 제 1 및 제 2 어텐션 블록(501-1, 501-2) 및 제 3 및 제 4 합성곱 블록(502-1, 502-2)의 파라미터 중 적어도 하나를 변경 하는 방식으로 수행될 수 있다. 501-1 ~ 505-1 구성은 도 4의 콘텐츠 브랜치인 제 1 브랜치로부터 확장되는 구성으로써, 콘텐츠 속성에 관 련되는 구성이다. 그리고 501-2 ~ 505-2 구성은 스타일 브랜치인 제 2 브랜치로부터 확장되는 구성으로써, 스타일 속성에 관련되는 구성이다. 만약 브랜치의 개수가 늘어나면, 각 브랜치로부터 확장되는 구성 역시 추가될 수 있다. 제 1 및 제 2 어텐션 레이어(501-1, 501-2)는, 각 속성에 대한 어텐션(attention)을 적용하기 위한 계층이다. 예를 들어서 특정 콘텐츠 속성에 대해서 특정 스타일을 어텐션 시키기 위한 구성일 수 있다. 이는, 특정 콘텐츠 속성이 특정 스타일과 어울리는 경우가 존재한다면, 이를 반영하기 위한 프로세스를 마련하기 위함이다. 제 1 및 제 2 어텐션 레이어(501-1, 501-2)의 파라미터인 , 는 이하에서 설명되는 도 6 순서도에서의 학습 프로세스에 의해서 업데이트될 수 있다. 제 3 및 제 4 합성곱 블록(502-1, 502-2)은, 적어도 하나의 합성곱 레이어를 포함하도록 구성될 수 있으며, 제 3 및 제 4 합성곱 블록(502-1, 502-2)의 파라미터인 , 이하에서 설명되는 도 6 순서도에서의 학습 프 로세스에 의해서 업데이트될 수 있다. 제 1 및 제 2 풀링 레이어(503-1, 503-2)는, 상기 합성곱 블록의 출력에 대해서 풀링을 수행하기 위한 계 층이다. 풀링 레이어(503-1, 503-2)에서는, 앞서 설명한 바와 같이, 특성 맵을 다운샘플링하여 특성 맵의 크기 를 줄이기 위하여 풀링 연산이 이루어진다. 풀링 연산에는 일반적으로 최대 풀링과 평균 풀링이 사용될 수 있다. 제 3 및 제 4 분류기(504-1, 504-2)는, 평탄화 작업을 통해 이미지를 분류하는데 사용되는 계층이다. 본 발명의 일실시예에 따른 분류기(504-1, 504-2)는 완전 연결 레이어(FC layer)로 구성되어 2차원 이상의 배열 형태 이미 지를 1차원의 벡터로 변환시킨다. 제 1 및 제 2 대조 손실 산출부(505-1, 505-2) 각각은 제 1 및 제 2 분류기(504-1, 504-2) 출력에 대조 손실 함수(Contrastive loss function)을 적용하기 위한 구성이다. 대조 손실 함수란, 학습을 위한 배치(batch) 내에 포함되어 있는 특정 상품 A와, 특정 상품 A 자신을 제외한 모 든 상품들 간의 관계에서 어울리는 상품과의 거리(Positive 거리)는 0에 가까워지고, 어울리지 않는 상품과의 거리(Negative 거리)는 멀어질 수록 손실 값이 낮아지도록 설계한 손실 함수이다. 대조 손실 함수의 구체적인 내용은 이하 도 6의 순서도와 함께 설명한다. 제 1 및 제 2 대조 손실 산출부(505-1, 505-2)에 의해서 제 1 및 제 2 합성곱 블록(301-1, 301-2)에서 추출되 는 특징 벡터(콘텐츠/스타일 compatibility representation)에 대해 제 1 및 제 2 대조 손실이 각각 계산된 후, 학습 제어부는 그 합이 최소화되도록 네트워크 파라미터 중 적어도 하나를 최적화한다. 이하 도 6을 참조하여, 본 발명의 일실시예에 따른 코디 시스템의 학습 제어 방법 순서도를 설명한다. 도 6은 본 발명의 일실시예에 따른 코디 시스템의 학습 제어 순서도를 도시하는 도면이다. S601 단계에서 학습 제어부는 도 4에서 상술한 과정을 따라 파라미터 , 및 를 결정할 수 있 다. 즉 S601 단계는 상술한 제 1 단계 학습일 수 있다. S602 단계에서 코디 시스템은, 배치(batch)에 포함되어 있는 상품 각각에 대해서 특징 벡터를 산출한다. 이때, 각 상품 이미지가 백본 구조를 통하여 입력되며, 제 1 및 제 2 합성곱 블록(301-1), 제 1 및 제 2 어텐션 레이어(501-1, 501-2), 제 3 및 제 4 합성곱 블록(502-1, 502-2), 제 3 및 제 4 풀링 레이어(503-1, 503-2) 및 제 3 및 제 4 분류기(504-1, 504-2)를 거쳐서 산출될 수 있다. 이렇게 산출된 제 1 및 제 2 특징 벡 터 각각을 및 이라 한다. 하나의 상품 이미지 당 제 1 및 제 2 특징 벡터가 각각 제 3 및 제 4 분류 기(504-1, 504-2)를 통하여 출력되는 것이다. 만약, 제 1 상품에 대하여 획득한 벡터 각각을 제 1 콘텐츠 벡터와 제 1 스타일 벡터라고 하고, 제 2 상품에 대 하여 획득한 벡터 각각을 제 2 콘텐츠 벡터 및 제 2 스타일 벡터라고 할 경우, 어울리는지 여부에 따라 대조 손 실은 아래 표 1과 같이 정리될 수 있을 것이다. 표 1 제 1 상품에 대한 특징 벡터 제 1 콘텐츠 벡터 제 1 스타일 벡터 제 2 상품에 대한 특징 벡터제 2 콘텐츠 벡 터어울릴 경우: 대조 손실 → 0 어울리지 않을 경우: 대조 손실 → 1비교 X 제 2 스타일 벡 터비교 X 어울릴 경우: 대조 손실 → 0 어울리지 않을 경우: 대조 손실 → 1 즉, 콘텐츠 벡터는 콘텐츠 벡터끼리, 스타일 벡터는 스타일 벡터끼리 대조 손실을 산출할 뿐, 콘텐츠 벡터와 스 타일 벡터 간에는 비교가 이루어지지 않는다. 상술한 비교는 제 1 및 제 2 상품 간에만 이루어졌으나, S603 단계에 의하면, 배치에 포함되어 있는 모든 상품 들 간에 서로 표 1에서와 같은 대조 손실이 산출될 것이다. 대조 손실을 산출하기 위한 과정을 수학식을 이용하여 좀 더 상세히 설명하면 아래와 같다. 제 1 대조 손실을 라 하고, 제 2 대조 손실을 라 할 경우, 전체 대 조 손실 은 아래 수학식 7와 같이 표현될 수 있다. 수학식 7"}
{"patent_id": "10-2021-0168261", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 7, "content": "배치의 사이즈가 N일 때, i 및 j는 인 자연수이고, 및 는 각각 i, j 번째 이미지를 의미 한다. 그리고 는 두 이미지 및 사이에 어울림 정도를 나타내는 GT값으로, 아래 수학식 8에서와 같이 표현될 수 있다.수학식 8"}
{"patent_id": "10-2021-0168261", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 8, "content": "그리고 , 는, 유클리디언 거리를 나타내며 아래 수학식 9 및 10로 나타낼 수 있다. 수학식 9"}
{"patent_id": "10-2021-0168261", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 9, "content": "수학식 10"}
{"patent_id": "10-2021-0168261", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 10, "content": "그리고 각각의 대조 손실은 아래 수학식 11 및 12에 의해서 산출될 수 있다. 수학식 11"}
{"patent_id": "10-2021-0168261", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 11, "content": "수학식 12"}
{"patent_id": "10-2021-0168261", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 12, "content": "수학식 11 및 12에서 m은 대조 손실에서 어울리지 않는 상품 사이의( ) 특징 벡터의 유사도가 커질수록 ( 가 작아질 수록) 뒷 항의 전체 크기가 커지도록 유도하는 마진(margin)값을 의미한다. 예를 들어 m이 0.3일 경우 는 0.3 이상이 되면 (일정 수치 이상 유사하지 않으면) 뒷 항이 0이 되고, 그 이하이면 (유사할수록) 뒷 항이 0보다 커져서 손실 함수가 증가하게 된다. 보통 m=0.3 정도의 값을 사 용한다. 두 상품이 어울리는 경우 에 의해 뒷 항이 0이 되어 두 상품의 특징 벡터가 유사( 가 감 소)할 수록 손실 함수가 줄어든다.두 상품이 어울리지 않는 경우 에 의해 앞 항이 0이 되어, 특징 벡터가 유사하지 않을 수록 ( 가 증가) 손실 함수가 줄어들게 된다. 이를 배치 내의 모든 상품 조합에 대해 합한 값이 전체 대조 손실 이 되며, 이를 최소화하는 방향으로 네 트워크가 학습(S604 단계)된다. S604는 제 2 단계 학습일 수 있다. 이상으로 본 발명에 따른 의상 코디 시스템 및 그것의 제어 방법의 실시예를 설시하였으나 이는 적어도 하나의 실시예로서 설명되는 것이며, 이에 의하여 본 발명의 기술적 사상과 그 구성 및 작용이 제한되지는 아니하는 것으로, 본 발명의 기술적 사상의 범위가 도면 또는 도면을 참조한 설명에 의해 한정／제한되지는 아니하는 것이다. 또한 본 발명에서 제시된 발명의 개념과 실시예가 본 발명의 동일 목적을 수행하기 위하여 다른 구조로 수"}
{"patent_id": "10-2021-0168261", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 13, "content": "정하거나 설계하기 위한 기초로써 본 발명이 속하는 기술분야의 통상의 지식을 가진 자에 의해 사용되어질 수"}
{"patent_id": "10-2021-0168261", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 14, "content": "있을 것인데, 본 발명이 속하는 기술분야의 통상의 지식을 가진 자에 의한 수정 또는 변경된 등가 구조는 청구 범위에서 기술되는 본 발명의 기술적 범위에 구속되는 것으로서, 청구범위에서 기술한 발명의 사상이나 범위를 벗어나지 않는 한도 내에서 다양한 변화, 치환 및 변경이 가능한 것이다."}
{"patent_id": "10-2021-0168261", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 일실시예에 따른 코디 시스템의 개념도를 도시하는 도면이다. 도 2는 본 발명의 일실시예에 따른 코디 시스템을 구성하는 의상 분석 모델의 내부 블록도를 도시하 는 도면이다. 도 3은 본 발명의 일실시예에 따른 브랜치 내부 구조를 도시하는 도면이다. 도 4는 본 발명의 일실시예에 따라 반대 속성을 효과적으로 배제시킨 상태에서 학습을 수행하기 위한 코디 시스 템의 브랜치 구조를 도시하는 도면이다. 도 5는 본 발명의 일실시예에 따른 코디 시스템의 어울림 정도를 학습하기 위한 블록도를 도시하는 도면이 다. 도 6은 본 발명의 일실시예에 따른 코디 시스템의 학습 제어 순서도를 도시하는 도면이다."}
