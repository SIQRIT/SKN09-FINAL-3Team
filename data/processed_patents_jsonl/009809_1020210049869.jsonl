{"patent_id": "10-2021-0049869", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2022-0143400", "출원번호": "10-2021-0049869", "발명의 명칭": "인공 신경망을 이용하여 표준 12리드 심전도 신호로부터 심장 부정맥을 분류하는 방법 및 이", "출원인": "금오공과대학교 산학협력단", "발명자": "임기무"}}
{"patent_id": "10-2021-0049869", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "표준 12리드 심전계를 통해 얻어진 12개의 각 채널의 심전도 신호를 소정의 범위의 대역통과 필터를 통과시킨후, R 피크를 검출하고 검출된 R 피크를 기준으로 3개의 QRS 복합파가 포함되도록 심전도 신호를 그룹화하여 각채널의 심전도 시퀀스를 생성하는 R-R peak 기반 심전도 시퀀스 생성단계;단발성 심장 부정맥의 이상 징후가 포함된 심전도 시퀀스를 추출하기 위해 전체 심전도 시퀀스를 K-평균 클러스터링을 통해 소정의 개수의 그룹으로 분할하면서 각 채널의 대표신호를 추출하는 K-평균 클러스터링 단계;상기 K-평균 클러스터링 단계를 통해 생성된 각 채널의 대표신호를 STFT(Short time fourier transform)를 이용하여 표준 12리드 심전도 신호의 시간에 따른 주파수 변화 정보를 포함하는 2차원 주파수 맵 형태를 추출하는STFT(Short time fourier transform)를 통한 2차원 이미지 추출단계; 및상기 2차원 이미지 추출단계를 통해 추출된 2차원 주파수 특징 이미지를 심방세동, 1형 방실차단,심방조기수축, 심실조기수축, 좌각차단, 우각차단, ST분절 상승, ST분절 하강의 8가지 심장 부정맥 질환을 분류하기 위한 인공신경망 모델의 입력으로 사용하여 심장 부정맥을 분류하는 인공신경망 모델을 사용한 심장 부정맥 분류단계;를 포함하는 표준 12리드 심전도 신호로부터 심장 부정맥을 분류하는 방법 ."}
{"patent_id": "10-2021-0049869", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 R-R peak 기반 심전도 시퀀스 생성단계에서,각 심전도 신호의 R 피크는 Pan and Tomkins 알고리즘과 Robust thresholding 알고리즘을 결합하여 추출하는것을 특징으로 하는 표준 12리드 심전도 신호로부터 심장 부정맥을 분류하는 방법 ."}
{"patent_id": "10-2021-0049869", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1항에 있어서,상기 인공신경망 모델을 사용한 심장 부정맥 분류단계의 인공신경망 모델에서는 2차원 특징 이미지가 2차원 합성곱(2D Convolutional Neural Network) 레이어를 통과하면서 인공지능 특징(feature)으로 추출된 후 최종적으로 심장 부정맥 질환으로 분류되는 것을 특징으로 하는 표준 12리드 심전도 신호로부터 심장 부정맥을 분류하는방법 ."}
{"patent_id": "10-2021-0049869", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제1항 내지 제3항 중 어느 하나의 방법을 사용하는 심장 부정맥 분류장치."}
{"patent_id": "10-2021-0049869", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "표준 12리드 심전도 신호로부터 심장 부정맥을 분류하는 방법은 표준 12리드 심전계를 통해 얻어진 12개의 각 채 널의 심전도 신호를 소정의 범위의 대역통과 필터를 통과시킨 후, R 피크를 검출하고 검출된 R 피크를 기준으로 3개의 QRS 복합파가 포함되도록 심전도 신호를 그룹화하여 각 채널의 심전도 시퀀스를 생성하는 R-R peak 기반 (뒷면에 계속)"}
{"patent_id": "10-2021-0049869", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 심전도 신호로부터 심장 부정맥을 분류하는 방법에 관한 것으로서, 더 상세하게는 인공 신경망을 이 용하여 표준 12리드 심전도 신호로부터 심장 부정맥을 분류하는 방법 및 이를 이용한 분류장치에 관한 것이다."}
{"patent_id": "10-2021-0049869", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "심전도 신호로부터 심장 부정맥을 진단하기 위한 알고리즘이 제안되어 있다. 이러한 종래의 알고리즘들은 싱글 리드(single lead) 심전도 신호로부터 시간-주파수 특징들을 추출하여 심장 부정맥을 분류하였으나, 몇몇 심장 부정맥은 특정한 심전도 채널에서만 관찰되기 때문에 분류하고자하는 심장 부정맥의 종류에 따라 분류 정확도가 감소될 수 있다. 따라서 정확한 심장 부정맥의 진단을 위해서는 12개의 채널에서 습득된 심전도 신호를 통합적이고 면밀하게 확 인할 필요가 있다. 즉, 표준 12리드 심전도 신호는 다양한 심장 질환으로 인한 전기, 기계적 활동의 변화에 의 해 그 신호의 형태가 변하는 특징이 있어 심장 부정맥을 진단하는 지표로 사용된다. 하지만, 심장 부정맥의 종 류에 따라 심전도 신호에서 관찰되는 징후가 다르며, 지속적으로 증상이 발생하여 심전도 신호에서 연속적으로 이상 징후를 관찰할 수 있는 지속성 심장 부정맥과 달리, 간헐적으로 증상이 발생하는 단발성 심장 부정맥의 경 우 정상적인 심전도 신호 사이에 이상 징후가 섞여서 관찰되기 때문에 심전도 신호로부터 육안으로 심장 부정맥 의 여부를 판단하기 어렵다. 또한, 부정맥의 종류에 따라 표준 12리드를 통해 측정되는 심전도 신호가 다르기 때문에, 환자의 심장 부정맥을 정확하게 판단하기 위해서는 12개의 채널에서 얻어진 심전도 신호를 통합적으로 분석할 필요가 있다. 또한, 종래 연구들은 지속성 심장 부정맥과 단발성 심장 부정맥을 구분하지 않고 심전도 자체의 특성에 초점을 두거나 특정한 부정맥의 진단을 위한 특징 엔지니어링(feature engineering) 과정을 통해 부정맥을 분류하였다. 지속성 심장 부정맥과 단발성 심장 부정맥은 심전도 신호에서 나타나는 각각의 특징이 서로 다르기 때문에 정확 한 심장 부정맥의 진단을 위해서는 각각의 특성을 고려한 특징을 추출할 필요가 있다. 선행기술문헌 비특허문헌 (비특허문헌 0001) S. Datta et al., \"Identifying normal, AF and other abnormal ECG rhythms using a cascaded binary classifier,\" Comput. Cardiol. ., vol. 44, pp. 1-4, 2017, doi: 10.22489/CinC.2017.173-154."}
{"patent_id": "10-2021-0049869", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은 상기와 같은 기술적 과제를 해결하기 위해 제안된 것으로, 인공 신경망을 이용하여 12개의 채널에서 얻어진 심전도 신호(표준 12리드 심전도 신호)로부터 심방세동, 1형 방실차단, 심방조기수축, 심실조기수축, 좌 각차단, 우각차단, ST분절 상승, ST분절 하강의 8가지 심장 부정맥 질환을 분류하기 위한 방법 및 이를 이용한 분류장치를 제공한다."}
{"patent_id": "10-2021-0049869", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "상기 문제점을 해결하기 위한 본 발명의 일 실시예에 따르면, 표준 12리드 심전계를 통해 얻어진 12개의 각 채 널의 심전도 신호를 소정의 범위의 대역통과 필터를 통과시킨 후, R 피크를 검출하고 검출된 R 피크를 기준으로 3개의 QRS 복합파가 포함되도록 심전도 신호를 그룹화하여 각 채널의 심전도 시퀀스를 생성하는 R-R peak 기반 심전도 시퀀스 생성단계와, 단발성 심장 부정맥의 이상 징후가 포함된 심전도 시퀀스를 추출하기 위해 전체 심 전도 시퀀스를 K-평균 클러스터링을 통해 소정의 개수의 그룹으로 분할하면서 각 채널의 대표신호를 추출하는K-평균 클러스터링 단계와, K-평균 클러스터링 단계를 통해 생성된 각 채널의 대표신호를 STFT(Short time fourier transform)를 이용하여 표준 12리드 심전도 신호의 시간에 따른 주파수 변화 정보를 포함하는 2차원 주 파수 맵 형태를 추출하는 STFT(Short time fourier transform)를 통한 2차원 이미지 추출단계와, 2차원 이미지 추출단계를 통해 추출된 2차원 주파수 특징 이미지를 심방세동, 1형 방실차단, 심방조기수축, 심실조기수축, 좌 각차단, 우각차단, ST분절 상승, ST분절 하강의 8가지 심장 부정맥 질환을 분류하기 위한 인공신경망 모델의 입 력으로 사용하여 심장 부정맥을 분류하는 인공신경망 모델을 사용한 심장 부정맥 분류단계를 포함하는 표준 12 리드 심전도 신호로부터 심장 부정맥을 분류하는 방법이 제공된다. 또한, 본 발명에 포함되는 R-R peak 기반 심전도 시퀀스 생성단계에서, 각 심전도 신호의 R 피크는 Pan and Tomkins 알고리즘과 Robust thresholding 알고리즘을 결합하여 추출하는 것을 특징으로 한다. 또한, 본 발명에 포함되는 인공신경망 모델을 사용한 심장 부정맥 분류단계의 인공신경망 모델에서는 2차원 특 징 이미지가 2차원 합성곱(2D Convolutional Neural Network) 레이어를 통과하면서 인공지능 특징(feature)으 로 추출된 후 최종적으로 심장 부정맥 질환으로 분류되는 것을 특징으로 한다."}
{"patent_id": "10-2021-0049869", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "상술한 바와 같이, 본 발명을 통해 표준 12유도 심전도 신호로부터 심장 부정맥 질환을 분류하는 것이 가능하며 지속적으로 발생하는 것이 아니라 단발적으로 발생하여 육안으로 판단하기 어려운 일부 부정맥 징후들을 인공신 경망 모델을 통해 정확하게 분류하는 것이 가능하다. 또한, 심장 부정맥을 앓고 있을 것이라 예상되는 환자들의 표준 12유도 심전도 신호를 본 발명의 알고리즘을 사용해 분석함으로써 정밀 검사를 받기 전 조기 진단의 과정 으로써 이용할 수 있을 것이다. 본 발명은 표준 12유도 심전계를 사용하는 의료센터에서 심장 질환의 유무를 확 인하고 의사 및 전문가들의 정밀 진단을 받기 전 조기 진단의 과정으로써 사용될 수 있다."}
{"patent_id": "10-2021-0049869", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하, 본 발명이 속하는 기술 분야에서 통상의 지식을 가진 자가 본 발명의 기술적 사상을 용이하게 실시할 수 있을 정도로 상세히 설명하기 위하여, 본 발명의 실시예를 첨부한 도면을 참조하여 설명하기로 한다. - 표준 12리드 심전도에서 관찰되는 8가지 심장 부정맥의 형태 심전도는 다양한 심장 질환으로 인한 심장의 전기적 및 기계적 활동의 변화에 의해 그 신호의 형태가 변하는 특 징이 있어 심장 부정맥을 진단하는데 널리 사용된다. 표준 12리드 심전도는 크게 Inferior (lead II, III, aVF), Anterior (lead I, aVL, V1, V2), Septal (V3, V4), Lateral (V5, V6)의 4가지 방향에서 심장의 전기적 활동을 기록한 것으로 심장 부정맥의 종류에 따라 각 채널에서의 신호 형태가 달라지며 12개의 채널 중에서 특 정 채널에서만 이상 징후가 관찰되기도 한다. 이러한 심장 부정맥 중에는 지속적인 증상으로 심전도에서 연속적 으로 이상 징후가 관찰되는 것과 간헐적으로 증상이 발생하여 정상적인 심전도 신호사이에 이상 징후가 섞여서 관찰되는 것들도 있다. 따라서 심전도 신호를 육안으로 보고 심장 부정맥을 판단하기 쉽지 않으며 정확한 심장 부정맥의 진단을 위해서는 12개의 채널에서 습득된 심전도 신호를 면밀하고 통합적으로 관찰할 필요가 있다.- 지속형 심장 부정맥으로 인한 심전도 신호; AF, IAV-B, LBBB, RBBB 본 발명에서는 심전도 신호에서 지속적으로 그 이상 징후가 관찰되는 심장 부정맥들을 '지속성(persistent) 심 장 부정맥' 으로 정의하였다. 대표적 지속성 심장 부정맥으로는 심방 세동(AF)과, Fisrt-degree 방실 차단(I- AVB), left bundle branch block (LBBB)과 right bundle branch block (RBBB)이 있다. AF 환자의 심전도 신호 에서는 온전한 QRS 파의 형태는 관찰되지만 심방에서 발생한 다중의 불규칙한 전기적 자극으로 인해 P 파가 나 타나지 않고 불규칙하게 진동하는 세동파(fibrillatory waves)가 관찰된다. 또한 I-AVB의 경우 심전도의 PR간격 이 정상 심장에 비해 200ms 이상으로 길어진 형태가 지속적으로 관찰된다. LBBB와 RBBB의 경우에서도 이상징후 가 지속적으로 관찰되지만, 12개의 채널 모두에서 그 징후가 관찰되는 것은 아니다. LBBB의 경우 V6채널에서 M 자 형태의 신호가 관찰되는 경우가 많으며, RBBB의 경우 V1채널에서 이상 징후가 관찰된다. 하지만, 심전도 신 호의 습득과정에서 동잡음이나, 전극의 접촉으로 인한 잡음 및 측정기기 자체의 잡음 등에 의해 이러한 지속성 심장 부정맥의 이상 징후를 구분하는 것은 쉽지 않다. - 단발성 심장 부정맥으로 인한 심전도 신호; STD, STE, PAC, PVC 한편, 지속형 심장 부정맥과 달리 정상신호 사이에 간헐적으로 발생하는 심장 부정맥을 '단발성(episodic) 심장 부정맥'으로 정의하였다. Myocardial ischemia또는 Infarction에 의해 주로 발생하는 ST segment elevation (STE)와 depression(STD)은 심전도의 S peak와 PR segment 사이의 높이 차이(ST segment의 기울기)가 ±0.5mm 이상으로 나는 경우에 진단되며 정상적인 심전도 파형 사이에 단발적으로 관찰되는 특징이 있다. S peak가 PR segment보다 3mm 정도의 낮은 상태인 STD는 일반적으로 lead I, V5, V6, aVL에서 관찰되며, V2-V3에서는 정상 적인 심전도 신호가 나타나기도 한다. 반면, STE의 경우 PR segment보다 4mm 정도 올라간 S peak가 관찰되며, 허혈성 ST segment는 V2-V4에서의 심전도 신호는 거의 정상신호의 형태가 관찰되지만, 비허혈성 ST segment의 경우에는 V2-V3에서 이상징후가 관찰되기도 한다. 심방 조기수축(Premature atrial contraction, PAC)은 sinus node보다 심방의 조직이 일시적으로 빠르게 역치 이상으로 흥분하게 되어 발생하는 것으로, 80%의 사람들이 일 상생활을 하는 중 단발적으로 흔히 격는 증상이다. 심실 조기수축(Premature ventricular contraction, PVC) 환자의 심전도 신호에서는 P wave가 관찰되지않으며 정상 심장에 비해 heart rate가 증가하는 특징이 있으며 QRS width가 120~210ms 정도로 길어질 수 있다 (정상 심장의 QRS width는 60~80ms이다). 하지만, 이러한 단발 성 심장 부정맥은 정상적인 심전도와 함께 간헐적으로 측정되기 때문에 정확하게 진단하기 쉽지 않다. 본 발명은 환자의 심장 부정맥을 정확하게 판단하기 위해 표준 12리드 심전계로부터 얻어진 심전도 신호로부터 지속성 심장 부정맥을 비롯해 단발성 심장 부정맥으로 인한 이상 징후를 자동으로 추출하기 위한 알고리즘 및 이를 이용한 심장 부정맥 분류장치를 제안하였다. 즉, 심장 부정맥 분류장치는 표준 12리드 심전계로부터 심전 도 신호를 수신한 후 제안된 알고리즘으로 신호를 처리하고 부정맥을 분류한다. 또한, 이로부터 8가지 심장 부정맥 - 심방세동(AF), 1형 방실 차단(First-degree atrioventricular block, I- AVB), 좌각 차단(Left bundle branch block, LBBB)과 우각 차단(Right bundle branch block, RBBB), 심방 조기 수축(Premature atrial complex, PAC), 심실 조기 수축(Premature ventricular complex, PVC), ST 분절 하강 (ST-segment depression, STD) 및 ST분절 상승(ST-segment elevation, STE)- 을 분류하기 위한 인공신경망 모 델을 제안하였다. 도 1은 본 발명의 실시예에 따른 표준 12리드 심전도 신호로부터 심장 부정맥을 분류하는 방법에 대한 순서도 및 클러스터링 알고리즘에 대한 순서도를 나타낸 도면이다. 도 1을 참조하면, 다음과 같은 단계를 통해 8가지 심장 부정맥 질환을 분류한다. 우선 표준 12리드 심전계를 통 해 얻어진 심전도 신호를 대역통과 필터를 사용해 8 ~ 16Hz 사이의 주파수 신호들을 추출한 후 2개의 온전한 심 전도 신호를 가지도록 샘플링한다. 실시예에 따라 변동잡음을 제거하고 데이터 손실을 최소화하기 위해 0.5에서 20Hz 사이의 대역통과 필터를 적용할 수도 있다. 이를 위해 “Robust thresholding” 알고리즘을 기반으로 R peak를 검출한 후 첫 번째 검출된 R peak에서부터 네 번째 검출된 R peak까지(3 주기의 PQRST 신호) 추출한다. 추출된 신호 중에서 심장 부정맥의 징후가 있다고 판단되는 대표적인 신호를 찾아내기 위해 K-평균 클러스터링 알고리즘을 사용한다. K-평균 클러스터링 알고리즘을 통해 추출된 n개의 신호들을 2개 파티션으로 그룹화하는 작업을 반복하여 대표적인 하나의 신호를 추출한다. 각 12개의 채널에서 최종적으로 검출된 12개의 신호들은 short time Fourier transform (STFT)를 통해 2차원 이미지로 변환된다. 변환된 2차원 이미지에는 표준 12유도 심전도 신호의 시간에 따른 주파수 변화 정보를 포함 하고 있으며, 특정 심장 부정맥의 정보도 함께 포함되어 있어 인공 신경망 모델을 통해 8가지의 심장 부정맥 중 하나로 분류된다. 이하, 인공 신경망을 이용하여 표준 12리드 심전도 신호로부터 심장 부정맥을 분류하는 방법 및 이를 이용한 심 장 부정맥 분류장치에 대해서 상세히 살펴보면 다음과 같다. 우선, 사용된 데이터는 Computing in Cardiology 2020 Physionet challenge에서 공개된 6,877명(남성: 3,699명, 여성: 3,178명)의 표준 12리드 심전도 신호를 사용하였다. 사용된 심전도 신호 데이터는 어떠한 심장 부정맥 질환을 앓고 있지 않은 정상의 심전도 신호(Normal sinus rhythm)를 포함해 AF 환자의 심전도 신호, I- AVB 환자의 심전도, LBBB과 RBBB의 환자 심전도, PAC와 PVC 환자 심전도, STD 및 STE 환자 심전도를 포함한다. 각 신호들은 500Hz 마다 샘플링 되었으며, 각 심전도 신호는 최소 6초에서 최대 60초 간 측정되었다. 동작음과 심전도 기기를 사용한 측정 시의 신호 잡음이 포함되어 있는 원 심전도 신호에서 이러한 신호 잡음과 기저선 변동 잡음을 제거하기 위해 대역통과 필터를 적용하였다. 본 발명에서는 변동잡음을 제거하고 데이터의 손실을 최소화하기 위해 8 ~ 16Hz 또는 0.5에서 20Hz 사이의 대역통과 필터를 적용하였다. - R-R peak 기반 샘플링 단계(S10) R-R peak 기반 샘플링 단계(S10), 즉 R-R peak 기반 심전도 시퀀스 생성단계를 자세히 살펴본다. 본 발명에서는 지속성 심장 부정맥으로 인한 심박수의 변화와 ECG 신호의 형상적 정보가 모두 포함된 시퀀스 신 호의 특징을 추출하여 8가지 심장 부정맥을 분류하기 위해 R피크를 검출한 후 검출된 R 피크를 기준으로 3개의 QRS 복합파가 포함되도록 심전도 신호를 그룹화(심전도 시퀀스 생성) 하였다. 각 심전도 신호의 R 피크는 Pan and Tomkins 알고리즘과 Robust thresholding 알고리즘을 결합하여 추출하였다. 즉, 대역통과 필터를 통해 추출된 8 ~ 16Hz의 신호로부터 R peak를 추출하기 위해 Pan and Tompkins 알고리즘을 사용한다. 필터된 신호를 미분하여 신호의 기울기 정보를 추출한 후 정규화(Normalize) 과정을 거친다(d[n]). R peak 신호의 크기(amplitude)를 키우기 위해 정규화된 신호를 제곱한 후(d2[n]), “Robust thresholding” 알고 리즘을 기반으로 R peak를 검출한다."}
{"patent_id": "10-2021-0049869", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "“Robust thresholding” 알고리즘은 신호의 에너지가 threshold 파라미터(η)보다 작은 경우 0으로 치환함으로 써 R peak를 검출한다. 이때, threshold 값은 각 ECG 세그먼트에 따라 조절된다."}
{"patent_id": "10-2021-0049869", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "이때, 제곱된 신호는 심전도의 QS interval을 길이를 왜곡하는 문제가 발생하는데, 이를 방지하기 위해 Shannon energy transformation을 사용하여 QRS 파의 검출 정확도를 향상시킨다. Shannon energy는 앞서 구한 threshold energy 신호를 정규화시킴으로써 계산된다. Shannon energy 신호는 moving average filter를 통해 신호를 다듬어진 후 1차 가우시안 필터(First-order Gaussian filter)를 통해 positive R peak와 negative R peak를 검출한다. 전체 신호에서 검출된 R peak를 기반으로 하여 2개의 심전도 주기가 온전히 유지되도록 첫 번째 검출된 R peak(r1)에서 네 번째 검출된 R peak(r4)까지 심전도 신호를 샘플링(심전도 시퀀스 신호 생성)한다. 이에 따라 심전도 시퀀스 신호는 심전도의 PQRST 파형의 형태 정보를 포함해 R-R interval의 역수로 계산되는 심박 수 (heart rate)의 정보를 포함하게 된다. 도 2는 RR peak 기반 시퀀스 신호의 예시도인데, 이러한 알고리즘을 통해 샘플링 된 심전도 신호의 예시이다. 심실 부정맥의 종류와 환자의 특성에 따라 샘플링 된 심전도 신호들이 모두 같은 샘플 수를 갖지는 않는다. 따 라서 각각의 샘플들이 같은 수의 샘플 데이터를 갖도록 만들기 위해 선형보간(linear interpolation)을 사용해 가장 긴 샘플 데이터를 기준으로 짧은 샘플 데이터를 확대(augmentation) 한다. - K-평균 클러스터링(군집 분석) 단계(S20) 심장 부정맥으로 인한 심전도 신호의 징후는 연속적으로 그 징후가 관찰될 수도 있으나 정상적인 심전도 신호 사이에 일시적으로 관찰될 수도 있다. 따라서 심장 부정맥으로 인한 이상 징후가 포함된 샘플 데이터를 추출하 기 위해 K-평균 클러스터링을 통해 심전도 데이터를 몇 개의 그룹으로 분할한다. 이때, 전체 신호를 2개의 그룹 으로 분할하고 더 적은 군집에서 다시 2개의 그룹으로 분할하는 작업을 반복하여 최종적으로 하나의 샘플 데이 터 신호만이 남을 때까지 반복한다. K-평균 클러스터링은 12개의 채널에 대해 각각 수행하며 lead I, lead II, lead III, aVR, aVF, aVL, V1, V2, V3, V4, V5, V6 채널에서 각각 대표 신호를 추출한다. 예를 들면, 그룹화 된 신호들 중에서 단발성 심장 부정맥으로 인한 형상적 정보가 포함된 대표 신호를 추출하기 위한 클러스터링 알고리즘을 도 1(b)의 작업 흐름도를 통해 나타냈다. 먼저 3개의 PQRST 신호가 포함된 연속적 신호 그룹을 2개의 집단으로 그룹화한다(A and B). 단발성 심장 부정맥으로 인한 이상 징후가 있는 신호의 그룹 을 찾아내기 위해 집단의 수가 작은 그룹과 큰 그룹의 비가 0.35 이하 인 경우 작은 그룹의 신호에서 무작위로 하나의 신호를 뽑아내며, 0,35 이상인 경우 큰 그룹의 신호에서 무작위로 하나의 신호를 뽑아낸다. 만약 나뉘어 진 두 그룹의 수가 동일할 경우 각각의 그룹에서 한번 더 클러스터링을 진행하여 4개의 집단(SA1, SA2, SB1, SB2)으로 그룹화하고 4개의 집단 중 그 수가 가장 작은 그룹에서 무작위로 하나의 신호를 뽑아낸다. 뽑아낸 신 호는 단발성 심장 부정맥 및 연속성 심장 부정맥으로 인한 이상 징후가 포함된 대표 신호(S#)로 사용되었다. - STFT를 통한 2차원 이미지 추출단계(S30) 각 채널에서 추출된 신호들은 시간에 따른 주파수의 변화를 확인하기 위해 STFT(Short time fourier transform) 분석을 통해 2차원 배열(2차원의 주파수 맵(frequency map)의 형태)로서 추출된다. 이때, K-평균 클러스터링을 통해 각 채널에서 추출된 샘플 데이터 길이를 동일하게 맞추기 위해 선형 보간법(linear interpolation) 또는 제로패딩(zero padding) 알고리즘을 사용한다. 도 3은 시간-주파수 특성 맵의 다이어그램 및 제안된 알고리즘에서 생성된 시간-주파수 특성 맵의 예시도이다. 도 3을 참조하면, 각 채널에서 STFT를 통해 추출된 신호들은 심전도 신호의 주된 주파수 대역인 0 ~ 50Hz 대역 의 신호들만을 추출한 후 도 3(a)와 같이 아래에 덧붙여 하나의 이미지를 형성한다. 도 3(a), 도 3(b)는 이러한 알고리즘으로부터 얻어진 시간에 따른 주파수 특징(feature) 이미지의 예시이다. 최종적으로 추출된 주파수 특 징(feature) 이미지는 각 채널에서 시간에 따른 주파수의 변화와 특정 심장 부정맥으로 인한 신호 주파수 대역 의 변화 정보를 포함한다. 즉, 각 12개의 채널에서 추출된 대표 신호들은 국소 푸리에 변환(Short-time Fourier transform, STFT)을 통해 시간에 따른 주파수 맵으로 추출되며, 심전도 신호가 8~16Hz 사이의 주파수 신호를 포함하기 때문에 STFT 결과 에서 0에서 50Hz 사이의 주파수 대역 정보만을 사용하였으며 (AF로 인한 주파수 특성은 2.5-25Hz 범위에서 관찰 됨), 12개의 채널에서 추출된 시간-주파수 맵을 차례로 이어 붙여 사용하였다 (도 3a). 본 발명에서는 1.667Hz 의 주파수 해상도로 시간에 따른 주파수 변화를 관찰하기 위해 frequency window를 300Hz로 설정하였으며, 주파 수 해상도의 증가로 인한 시간 해상도의 감소를 최소화하기 위해 overlap ratio를 270Hz로 설정하였다. 심장 부 정맥의 종류에 따라 R-R 그룹화된 신호의 길이가 다르기 때문에, STFT 결과로 추출된 시간-주파수 맵은 선형 보 간법을 사용해 일괄적으로 120×120의 시간-주파수 맵 형태로 변환되었다. 본 발명에서 사용된 알고리즘을 통해 추출된 시간-주파수 맵의 예시를 도 3(b) 및 도 3(c)에 나타냈으며, 이는 2차원 합성곱(convolution) 인공지능 모델의 입력으로 사용되었다. - 인공신경망 모델을 사용한 심장 부정맥 분류단계(S40) 상술한 단계를 통해 추출된 주파수 특징(feature) 이미지는 심방세동, 1형 방실차단, 심방조기수축, 심실조기수 축, 좌각차단, 우각차단, ST분절 상승, ST분절 하강의 8가지 심장 부정맥 질환을 분류하기 위한 인공신경망 모 델의 입력으로 사용된다. 인공신경망 모델에서는 2차원 특징(feature) 이미지가 2차원 합성곱(2D Convolutional Neural Network) 레이어를 통과하면서 인공지능 특징(feature)으로 추출된 후 최종적으로 심장 부정맥 질환으로 분류되며 이러한 일련의 과정들이 여러 번의 학습을 거치면서 더 정확하게 심장 부정맥을 분류하는 것이 가능하 며, 눈으로 12개의 채널 심전도를 비교하여 심장 부정맥을 확인하는 것보다 상대적으로 더 빠르게 분류결과를 확인할 수 있다. 즉, 심장 부정맥을 분류하기 위한 CNN 모델은 3개의 2차원 CNN 레이어와 BatchNormaliza-tion (BN)층 및 2차원 Maxpooling (2DMaxP)레이어 (2DCNN-BN-2DMaxP)로 구성되었다. 첫 번째와 두 번째 2DCNN-BN-2DMaxP층에는 각각 0.5의 dropout rate을 적용하였으며, 마지막 2DCNN-BN-2DMaxP층에는 0.3의 dropout rate이 적용되었다. 각각의 2D CNN층에는 모델이 학습데이터에 과적합(overfitting)되는 것을 방지하기 위해 loss_lambda가 0.00015인 커 널 정규화와 bias 정규화를 적용하였다. 각 층의 활성화 함수는 ReLU를 사용하였으며, 출력 층의 활성화 함수는 softmax를 사용하였다. 모델의 학습을 위해 전체 데이터의 80%는 학습데이터(5,484개)로 20%는 테스트 데이터(1,372개)로 사용하였다. 모델은 sparse categorical crossentropy 손실함수와 학습률 0.01의 Adam 최적화 함수를 사용하여 500회 학습 되었으며, 5-fold 교차 검증을 사용해 최적의 모델을 검증하였다. 최종 모델의 분류 성능은 accuracy를 비롯해 recall, precision과 F1 score 및 Confusion matrix와 ROC curve 및 Precision-recall curve를 통해 평가되었 다. 도 4는 제안된 모델에 대한 혼동행렬을 나타낸 도면이고, 도 5는 제안된 모델에 대한 성능곡선을 나타낸 도면이 다. 도 4 및 도 5를 참조하면, 제안된 알고리즘을 통한 8가지 심장 부정맥의 분류 결과가 나타나 있다. 제안된 모델 은 AF와 I-AVB, LBBB, RBBB와 같은 지속성 심장 부정맥의 분류에서 0.8 이상의 F1 score를 보여주었다. F1 score는 LBBB에서 0.89로 가장 높았으며, AF와 RBBB의 분류 F1 score는 각각 0.86과 0.85였다. I-AVB의 F1 score는 0.80 이었다. 반면, PAC와 PVC, STE와 같은 단발성 심장 부정맥의 분류 성능은 상대적으로 낮았으며 특 히, 데이터 클래스의 수가 가장 적었던 STE의 분류에서 F1 score가 0.52로 가장 낮았다 (PAC와 PVC의 F1 score 는 각각 0.53과 0.64 이다). 또한, Normal과 STD의 분류에서는 0.77과 0.76의 F1 score로 중간 정도(Moderat e)의 분류 성능을 보여주었다. 각 클래스에 따라 사용된 데이터 수에 차이가 있었다. 그에 따라 제안된 모델의최종 macro F1 score는 0.74 이었지만, 클래스별 데이터 수 차이를 고려한 weighted F1 score는 0.78이었다. 제안된 모델의 분류 성능을 정량적으로 평가하기 위해 2가지 성능 곡선을 사용해 비교하였다 (도 5). Receiver operating characteristics (ROC) curves는 분류된 데이터의 False positive rate에 따른 True positive rate 을 보여주며, 각 클래스의 분류 정확도는 curve의 아랫면적(area under the curve, AUC)을 통해 확인할 수 있다. AF, I-AVB, LBBB, RBBB와 같은 지속성 심장 부정맥 군의 AUC는 각각 0.90, 0.90, 0.91, 0.90 이었으며, Normal과 STD의 AUC는 0.87과 0.89이었다. 하지만, PAC, PVC, STE와 같은 단발성 심장 부정맥 군의 AUC는 0.72, 0.79, 0.78로 중간정도의 정확도를 보여주었다(도 5a - Receiver operating characteristics (ROC) curves -). 모델의 학습과 분류에서 사용된 심장 부정맥 데이터는 각 클래스에 따라 데이터 수의 차이가 있었다. 그에 따라 각 클래스 별 데이터 수 차이를 고려하여 모델의 분류 성능을 Precision-Recall curve를 통해 평가하였다. 그에 따른 분류 정확도는 지속성 심장 부정맥군 중에서 AF, LBBB, RBBB의 AUC가 0.90 이상으로 우수한 성능을 보여주 었으며(AUCs; 0.93 for AF, 0.94 for I-AVB, and 0.93 for RBBB), I-AVB와 Normal, STD에서는 0.80이상의 분류 정확도를 보여주었다(AUCs; 0.88 for I-AVB, 0.85 for Normal, and 0.82 for STD). 하지만, ROC curve에서와 마찬가지로 PAC, PVC, STE의 AUC는 각각 0.52와 0.68, 0.55로 낮은 분류 정확도를 보여주었다(도 5b - Precision-recall curves - ). 상술한 바와 같이, 제안된 표준 12리드 심전도 신호로부터 심장 부정맥을 분류하는 방법은, 먼저 표준 12리드 심전계를 통해 측정된 심전도 신호로부터 무의미한 잡신호와 심전도 신호의 기저선 변동 잡음 (Baseline wandering)을 제거하고 유의미한 심전도 신호만을 추출하기 위해 8-16Hz의 대역통과 필터를 적용한 다. 필터된 시계열 신호는 짧은 기간의 심전도 신호를 사용해 인공지능 알고리즘을 학습하고 심장 부정맥 분류 결과를 도출하기 위해 일정한 데이터 길이로 나누는 과정을 거친다. 이때, 나누어진 심전도 신호에 온전한 심 전도의 PQRST 파형 정보와 심박 수(heart rate)의 정보가 포함되도록 Pan and Tompkins 알고리즘과 Robust thres holding 알고리즘을 사용해 R peak를 검출하고, 첫 번째로 검출된 R peak에서부터 네 번째로 검출 된 R peak까지 신호를 나눠 여러 개의 심전도 시퀀스(sequence) 신호를 생성한다. 한편, 앞서 언급한 것과 같이 심장 부정맥 질환의 종류에 따라 심전도 신호에서 관찰되는 형태가 달라지는데 특히, 단발적으로 증상이 발생하 는 event성 심장 부정맥 질환의 경우에는 전체 시계열 신호 중에서 일부분에서만 비정상적 신호가 관찰된다. 따 라서 심전도 신호에서 연속적으로 증상을 관찰할 수 있는 지속성 심장 부정맥 질환의 이상 징후를 포함해 단발 성 심장 부정맥 질환의 이상 징후가 있는 심전도 신호 시퀀스만을 추출하기 위해 K-평균 알고리즘을 사용해 이 상 징후가 있는 시퀀스 신호와 정상 시퀀스 신호를 분할하고 이상 징후가 있을 것으로 판단되는 심전도 시퀀스 를 특정 심전도 채널의 대표 신호로써 선택된다. 각 12개의 채널에서 최종적으로 선발된 12개의 신호들은 short rune Fourier transform(STFI) 분석을 통해 시간에 따른 주파수 변화정보가 포함된 2차원 이미지 형태로 변환된 다. 변환된 2차원 이미지는 2차원 합성곱 인공지능 모델을 통해 8가지의 심장 부정맥 중의 하나로 분류된다. 본 발명을 통해 표준 12유도 심전도 신호로부터 심장 부정맥 질환을 분류하는 것이 가능하며 지속적으로 발생하 는 것이 아니라 단발적으로 발생하여 육안으로 판단하기 어려운 일부 부정맥 징후들을 인공신경망 모델을 통해 정확하게 분류하는 것이 가능하다. 또한, 심장 부정맥을 앓고 있을 것이라 예상되는 환자들의 표준 12유도 심전 도 신호를 본 발명의 알고리즘을 사용해 분석함으로써 정밀 검사를 받기 전 조기 진단의 과정으로써 이용할 수 있을 것이다. 본 발명은 표준 12유도 심전계를 사용하는 의료센터에서 심장 질환의 유무를 확인하고 의사 및 전 문가들의 정밀 진단을 받기 전 조기 진단의 과정으로써 사용될 수 있다."}
{"patent_id": "10-2021-0049869", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "이와 같이, 본 발명이 속하는 기술분야의 당업자는 본 발명이 그 기술적 사상이나 필수적 특징을 변경하지 않고 서 다른 구체적인 형태로 실시될 수 있다는 것을 이해할 수 있을 것이다. 그러므로 이상에서 기술한 실시예들은 모든 면에서 예시적인 것이며 한정적인 것이 아닌 것으로서 이해해야만 한다. 본 발명의 범위는 상기 상세한 설 명보다는 후술하는 특허청구범위에 의하여 나타내어지며, 특허청구범위의 의미 및 범위 그리고 그 등가개념으로 부터 도출되는 모든 변경 또는 변형된 형태가 본 발명의 범위에 포함되는 것으로 해석되어야 한다.도면 도면1 도면2 도면3 도면4 도면5"}
{"patent_id": "10-2021-0049869", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 실시예에 따른 표준 12리드 심전도 신호로부터 심장 부정맥을 분류하는 방법에 대한 순서도 및 클러스터링 알고리즘에 대한 순서도를 나타낸 도면 도 2는 RR peak 기반 시퀀스 신호의 예시도 도 3은 시간-주파수 특성 맵의 다이어그램 및 제안된 알고리즘에서 생성된 시간-주파수 특성 맵의 예시도 도 4는 제안된 모델에 대한 혼동행렬을 나타낸 도면 도 5는 제안된 모델에 대한 성능곡선을 나타낸 도면"}
