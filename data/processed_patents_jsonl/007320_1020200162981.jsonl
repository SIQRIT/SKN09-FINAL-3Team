{"patent_id": "10-2020-0162981", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2022-0074452", "출원번호": "10-2020-0162981", "발명의 명칭": "CCTV 영상을 활용한 Feature 매칭가능한 이상행동 검출 방법", "출원인": "한국전자기술연구원", "발명자": "장수현"}}
{"patent_id": "10-2020-0162981", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "영상 스트림을 입력받는 단계;영상 스트림으로부터 공간적 스트림과 시간적 스트림을 추출하는 단계;시간적 스트림으로부터 모션 정보를 추출하는 단계;공간적 스트림과 시간적 스트림 및 모션 정보를 이상행동을 검출하기 위한 인공지능 모델에 입력하여, 이상행동을 검출하는 단계;를 포함하는 것을 특징으로하는 이상행동 검출 방법."}
{"patent_id": "10-2020-0162981", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "청구항 1에 있어서,검출 단계는,공간적 스트림과 시간적 스트림에 모션 정보를 매칭하여, 인공지능 모델에 입력하는 것을 특징으로하는 이상행동 검출 방법."}
{"patent_id": "10-2020-0162981", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "청구항 2에 있어서,공간적 스트림은,RGB 영상 스트림이고,시간적 스트림은,Optical Flow 스트림인 것을 특징으로하는 이상행동 검출 방법."}
{"patent_id": "10-2020-0162981", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "청구항 2에 있어서,배경이 아닌 행동에 특징들이 포커싱 되도록, 인공지능 모델에 입력하는 공간적 스트림과 시간적 스트림에 모션정보를 매칭하는 것을 특징으로하는 이상행동 검출 방법."}
{"patent_id": "10-2020-0162981", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "청구항 1에 있어서,검출 단계는,이상행동이 검출된 영역에 대한 정보를 출력하는 것을 특징으로하는 이상행동 검출 방법."}
{"patent_id": "10-2020-0162981", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "청구항 1에 있어서,공개특허 10-2022-0074452-3-학습용 영상 스트림과 이상행동 라벨링 정보를 입력받는 단계;학습용 영상 스트림으로부터 공간적 스트림과 시간적 스트림을 추출하는 단계;시간적 스트림으로부터 모션 정보를 추출하는 단계;공간적 스트림과 시간적 스트림 및 모션 정보를 인공지능 모델의 입력에 인가하고, 이상행동 라벨링 정보를 인공지능 모델의 출력에 인가하여, 인공지능 모델을 학습시시는 단계;를 더 포함하는 것을 특징으로하는 이상행동검출 방법."}
{"patent_id": "10-2020-0162981", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "청구항 5에 있어서,학습용 영상 스트림은,배우가 연출하는 이상행동을 촬영하여 생성한 것이며,배경이 특정 장소로 제한적인 것을 특징으로하는 이상행동 검출 방법."}
{"patent_id": "10-2020-0162981", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "영상 스트림을 입력받는 입력부;영상 스트림으로부터 공간적 스트림과 시간적 스트림을 추출하고, 시간적 스트림으로부터 모션 정보를 추출하는신호 처리부; 및공간적 스트림과 시간적 스트림 및 모션 정보를 이상행동을 검출하기 위한 인공지능 모델에 입력하여, 이상행동을 검출하는 프로세서;를 포함하는 것을 특징으로 하는 이상행동 검출 시스템."}
{"patent_id": "10-2020-0162981", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "CCTV 영상을 활용한 Feature 매칭가능한 이상행동 검출 방법이 제공된다. 본 발명의 실시예에 따른 이상행동 검 출 방법은, 영상 스트림을 입력받아 공간적 스트림과 시간적 스트림을 추출하고, 시간적 스트림으로부터 모션 정 보를 추출하며, 공간적 스트림과 시간적 스트림 및 모션 정보를 이상행동을 검출하기 위한 인공지능 모델에 입력 하여 이상행동을 검출한다. 이에 의해, 제한된 환경에서 배우가 연출을 통해 생성한 학습 영상임에도 불구하고, CCTV 영상에서 시공간 정보를 추출하고 여기에 optical flow를 활용하여 모션 정보를 반영함으로써, 배경이 아닌 실제 행동에 Feature들이 매칭되게 하여, 이상행동 검출 인식률을 향상시킬 수 있게 된다."}
{"patent_id": "10-2020-0162981", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 인공지능 관련 기술에 관한 것으로, 더욱 상세하게는 CCTV 영상에서 이상행동 검출하기 위한 인공지 능 모델에 관한 것이다."}
{"patent_id": "10-2020-0162981", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "현재 공공기관에서 설치 운영 중인 CCTV는 2017년 기준 954,261대이며, 공공기관 CCTV 증가율은 연평균 13.5%씩 증가한다. 이를 통해, 2019년에는 120만대가 넘는 것으로 보고 있다. 특히, 사회문제(아동학대, 이상행동, 범죄예방 등) 해결을 위한 지능형 영상감시 분야에 인공지능기반 지능형 CCTV 보급이 확산되고 있으며, 이를 통한 이상행동(쓰러짐, 침입, 배회, 폭행/싸움, 공연음란 등) 관찰, 감시 관제 기능은 필수 서비스로 요구되고 있다. 행동인식을 위한 인공지능 모델로 가장 대표적인 방법이 Two stream 기반의 RGB 스트림과 optical flow 스트림 으로 모델의 입력을 나누어 구성하고 각 스트림에서 추출된 특징 값을 통합하여 하나의 이상행동 또는 복합적인 이상행동으로 분류하는 것이다. 도 1은 기존 Two stream 기반 행동 검출 모델이다. 이와 같은 이상행동 검출모델의 인식 성능을 보장하기 위해 서는 다양한 환경에서 수집된 이상행동 영상이 필요하나, 실제 지자체 CCTV에 수집된 영상에는 대부분 정상행동 만 포함되어 있어, 별도의 이상행동 영상을 제작하여 이상행동 검출 모델을 학습하고 있는 실정이다. 그러나 제한되고 반복되는 환경에서 수집된 이상행동 영상으로 학습된 모델은 도 2에 나타난 바와 같이 행동보 다 배경에 Feature들이 포커싱 되어, 이상행동 검출 인식률을 높이는데 한계가 있다."}
{"patent_id": "10-2020-0162981", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은 상기와 같은 문제점을 해결하기 위하여 안출된 것으로서, 본 발명의 목적은, 공공기관(어린이집, 병 원, 학교 등)에 설치가 급증하고 있는 CCTV 영상을 대상으로 행동인식 검출 네트워크에서, Feature들이 배경이 아닌 행동에 포커싱되게 조정하여, 이상행동 검출 인식률을 향상 시킬 수 있는 방법을 제공함에 있다."}
{"patent_id": "10-2020-0162981", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "상기 목적을 달성하기 위한 본 발명의 일 실시예에 따른, 이상행동 검출 방법은, 영상 스트림을 입력받는 단계; 영상 스트림으로부터 공간적 스트림과 시간적 스트림을 추출하는 단계; 시간적 스트림으로부터 모션 정보를 추 출하는 단계; 공간적 스트림과 시간적 스트림 및 모션 정보를 이상행동을 검출하기 위한 인공지능 모델에 입력 하여, 이상행동을 검출하는 단계;를 포함한다. 검출 단계는, 공간적 스트림과 시간적 스트림에 모션 정보를 매칭하여, 인공지능 모델에 입력할 수 있다. 공간적 스트림은, RGB 영상 스트림이고, 시간적 스트림은, Optical Flow 스트림일 수 있다. 배경이 아닌 행동에 특징들이 포커싱 되도록, 인공지능 모델에 입력하는 공간적 스트림과 시간적 스트림에 모션 정보를 매칭할 수 있다. 그리고, 검출 단계는, 이상행동이 검출된 영역에 대한 정보를 출력할 수 있다. 본 발명의 실시예에 따른 이상행동 검출 방법은, 학습용 영상 스트림과 이상행동 라벨링 정보를 입력받는 단계; 학습용 영상 스트림으로부터 공간적 스트림과 시간적 스트림을 추출하는 단계; 시간적 스트림으로부터 모션 정 보를 추출하는 단계; 공간적 스트림과 시간적 스트림 및 모션 정보를 인공지능 모델의 입력에 인가하고, 이상행 동 라벨링 정보를 인공지능 모델의 출력에 인가하여, 인공지능 모델을 학습시시는 단계;를 더 포함할 수 있다. 학습용 영상 스트림은, 배우가 연출하는 이상행동을 촬영하여 생성한 것이며, 배경이 특정 장소로 제한적일 수 있다. 한편, 본 발명의 다른 실시예에 따른, 이상행동 검출 시스템은, 영상 스트림을 입력받는 입력부; 영상 스트림으 로부터 공간적 스트림과 시간적 스트림을 추출하고, 시간적 스트림으로부터 모션 정보를 추출하는 신호 처리부; 및 공간적 스트림과 시간적 스트림 및 모션 정보를 이상행동을 검출하기 위한 인공지능 모델에 입력하여, 이상 행동을 검출하는 프로세서;를 포함한다."}
{"patent_id": "10-2020-0162981", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "이상 설명한 바와 같이, 본 발명의 실시예들에 따르면, 제한된 환경에서 배우가 연출을 통해 생성한 학습 영상 임에도 불구하고, CCTV 영상에서 시공간 정보를 추출하고 여기에 optical flow를 활용하여 모션 정보를 반영함 으로써, 배경이 아닌 실제 행동에 Feature들이 매칭되게 하여, 이상행동 검출 인식률을 향상시킬 수 있게 된다."}
{"patent_id": "10-2020-0162981", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하에서는 도면을 참조하여 본 발명을 보다 상세하게 설명한다. 본 발명의 실시예에서는 제한되고 반복되는 환경에서 생성된 영상으로 이상행동 검출 네트워크를 학습시키고, 학습된 이상행동 검출 네트워크로 이상행동을 추론하는 방법을 제시한다. 도 3은 본 발명의 일 실시예에 따른 이상행동 검출 네트워크 학습 방법의 설명에 제공되는 흐름도이다. 도시된 바와 같이, 먼저 학습용 영상 스트림과 이상행동 라벨링 정보를 획득한다(S110). 학습용 영상 스트림은 공공기관(어린이집, 병원, 학교 등)에 설치된 CCTV를 통해 촬영된 영상 스트림으로 이상 행동이 나타나는 장면이 포함되어 있다. 실제 이상행동이 촬영된 영상 스트림은 많지 않다. 따라서, 학습용 영 상 스트림 생성을 위해 배우들이 이상행동을 연출하고, 이를 CCTV로 촬영하여 학습용 영상 스트림을 추가할 수 있다. 한편, 학습용 영상 스트림은 공공기관에서 촬영되었다는 점에서, 배경/환경이 매우 제한적이라는 특성이 있다. 이상행동 라벨링 정보는 학습용 영상 스트림에 담겨 있는 이상행동에 대한 정보이다. 이상행동에는, 쓰러짐, 침 입, 배회, 폭행/싸움, 공연음란 등이 포함된다. 다음, 학습용 영상 스트림에서 공간적 스트림(Spatial Stream)과 시간적 스트림(Temporal Stream)을 추출한다 (S120). 공간적 스트림은 RGB 영상 스트림을 의미하고, 시간적 스트림은 Optical Flow(광류) 스트림이다. 그리고, S120단계에서 획득한 Optical Flow 스트림으로부터 모션 정보를 추출한다(S130). 모션 정보는 움직임이 발생한 영역들에 대한 정보를 의미하며, 움직임 크기에 대한 정보가 더 포함될 수 있다. 이후, S120단계에서 획득한 RGB 영상 스트림, Optical Flow 스트림에 S130단계에서 획득한 모션 정보를 매칭하 여 이상행동 검출 네트워크에 입력시키고, 출력에는 S110단계에서 획득한 이상행동 라벨링 정보를 인가하여, 이 상행동 검출 네트워크를 학습시킨다(S140). 도 4에는 이상행동 검출 네트워크의 세부 구조를 예시하였다. 네트워크 구조는 도 4에 예시된 바와 다르게 구현 가능하다. 네트워크로 입력되는 공간적/시간적 스트림(RGB 영상/Optical Flow 스트림)에 모션 정보가 매칭되어, 배경이 아 닌 행동에 Feature들이 포커싱된다. 도 5에는 이상행동 검출 네트워크에 입력되는 공간적/시간적 스트림와 모션 정보를 예시하였고, 이 경우 이상행동 검출 네트워크에서 생성되는 Feature Map을 예시하였다. 도 5에 예시된 바와 같이, 모션 정보가 공간적/시간적 스트림에 매칭되어 입력됨으로써, 특징이 배경 부분이 아 닌 이상행동 부분에 포커싱되는 것을 확인할 수 있다. 도 6은 본 발명의 다른 실시예에 따른 이상행동 검출 네트워크를 이용한 이상행동 추론 방법의 설명에 제공되는 흐름도이다. 도시된 바와 같이, 먼저 공공기관에 설치된 CCTV를 통해 촬영된 영상 스트림을 획득한다(S210). 다음, S210단계 에서 획득한 영상 스트림으로부터 RGB 영상 스트림과 Optical Flow 스트림을 추출한다(S220). 그리고, S220단계에서 획득한 Optical Flow 스트림으로부터 모션 정보를 추출한다(S230). 이후, S220단계에서 획득한 RGB 영상 스트림, Optical Flow 스트림에 S230단계에서 획득한 모션 정보를 매칭하여 이상행동 검출 네 트워크에 입력시킨다(S240). S240단계에서 활용되는 이상행동 검출 네트워크는, 도 3에서 학습된 네트워크이다. 이에, 이상행동 검출 네트워크는 RGB 영상/Optical Flow 스트림, 모션 정보로부터 이상행동을 검출하여, 결과를 출력한다(S250). S250단계에서는 이상행동이 검출된 영역에 대한 정보를 출력한다.지금까지, CCTV 영상을 활용한 Feature 매칭가능한 이상행동 검출 방법에 대해 바람직한 실시예를 들어 상세히 설명하였다. 위 실시예에서는, 공공기관에 설치가 급증하고 있는 CCTV 영상을 대상으로 이상행동 검출 네트워크에서 발생되 는 Feature들이 행동에 포커싱되게 조정하여, 이상행동 검출 인식률을 향상시킬 수 있도록 하였다. 제한된 환경에서 수집된 학습 영상임에도 불구하고, CCTV 영상에서 시공간 정보를 추출하고 여기에 optical flow를 활용하여 모션 정보를 반영함으로써, 실제 행동에 Feature들이 매칭하는 기술이다. 도 7은 본 발명의 다른 실시예에 따른 이상행동 검출 시스템의 블럭도이다. 본 발명의 실시예에 따른 이상행동 검출 시스템은, 도시된 바와 같이, 입력부, 신호 처리부, 프로세서 및 출력부를 포함하여 구성된다. 입력부는 학습 단계에서는 학습용 영상 스트림과 이상행동 라벨링 정보를 입력받고, 추론 단계에서는 CCTV 를 통해 촬영된 영상 스트림을 입력받는다. 신호 처리부는 영상 스트림으로부터 RGB 영상 스트림과 Optical Flow 스트림으로 추출하고, Optical Flow 스트림으로부터 모션 정보를 추출한다. 프로세서는 이상행동 검출 네트워크 모델을 구동하고, 학습시키기 위한 CPU와 GPU들의 집합이다. 학습 단계에서, 프로세서는 신호 처리부에서 생성된 RGB 영상 스트림, Optical Flow 스트림에 모션 정보를 매칭하여 이상행동 검출 네트워크에 입력시키고, 출력에는 이상행동 라벨링 정보를 인가하여, 이상행동 검출 네트워크를 학습시킨다. 추론 단계에서 프로세서는 신호 처리부에서 생성된 RGB 영상 스트림, Optical Flow 스트림에 모션 정 보를 매칭하여 이상행동 검출 네트워크에 입력시켜 이상행동을 검출하도록 한다. 출력부는 이상행동 검출 네트워크에 의한 추론 결과를 출력하는 수단이다. 한편, 본 실시예에 따른 장치와 방법의 기능을 수행하게 하는 컴퓨터 프로그램을 수록한 컴퓨터로 읽을 수 있는 기록매체에도 본 발명의 기술적 사상이 적용될 수 있음은 물론이다. 또한, 본 발명의 다양한 실시예에 따른 기 술적 사상은 컴퓨터로 읽을 수 있는 기록매체에 기록된 컴퓨터로 읽을 수 있는 코드 형태로 구현될 수도 있다. 컴퓨터로 읽을 수 있는 기록매체는 컴퓨터에 의해 읽을 수 있고 데이터를 저장할 수 있는 어떤 데이터 저장 장 치이더라도 가능하다. 예를 들어, 컴퓨터로 읽을 수 있는 기록매체는 ROM, RAM, CD-ROM, 자기 테이프, 플로피 디스크, 광디스크, 하드 디스크 드라이브, 등이 될 수 있음은 물론이다. 또한, 컴퓨터로 읽을 수 있는 기록매체 에 저장된 컴퓨터로 읽을 수 있는 코드 또는 프로그램은 컴퓨터간에 연결된 네트워크를 통해 전송될 수도 있다. 또한, 이상에서는 본 발명의 바람직한 실시예에 대하여 도시하고 설명하였지만, 본 발명은 상술한 특정의 실시"}
{"patent_id": "10-2020-0162981", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "예에 한정되지 아니하며, 청구범위에서 청구하는 본 발명의 요지를 벗어남이 없이 당해 발명이 속하는 기술분야 에서 통상의 지식을 가진자에 의해 다양한 변형실시가 가능한 것은 물론이고, 이러한 변형실시들은 본 발명의 기술적 사상이나 전망으로부터 개별적으로 이해되어져서는 안될 것이다."}
{"patent_id": "10-2020-0162981", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 기존 Two stream 기반 행동 검출 모델을 나타낸 도면, 도 2는 배경에 Feature들이 포커싱되는 현상을 나타낸 도면, 도 3은 본 발명의 일 실시예에 따른 이상행동 검출 네트워크 학습 방법의 설명에 제공되는 흐름도, 도 4는 이상행동 검출 네트워크의 세부 구조를 예시한 도면,도 5는 이상행동 검출 네트워크에 입력되는 공간적/시간적 스트림에 모션 정보를 매칭하여, 특징을 추출한 결과 를 예시한 도면, 도 6은 본 발명의 다른 실시예에 따른 이상행동 검출 네트워크를 이용한 이상행동 추론 방법의 설명에 제공되는 흐름도이다."}
