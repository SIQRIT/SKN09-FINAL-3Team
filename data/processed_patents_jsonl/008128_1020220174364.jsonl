{"patent_id": "10-2022-0174364", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2024-0091454", "출원번호": "10-2022-0174364", "발명의 명칭": "의료영상 등급 추정을 위한 비교학습 장치 및 방법", "출원인": "한국외국어대학교 연구산학협력단", "발명자": "윤일동"}}
{"patent_id": "10-2022-0174364", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "이미지의 등급을 추정하기 위한 비교학습 방법에 있어서, 상대적인 등급이 서로 다른 제1 이미지와 제2 이미지를 선택하여 학습 데이터 쌍으로 결정하는 학습 데이터 쌍준비 단계; 이미지에서 특징벡터를 추출하고 이미지 등급을 판별하는 등급기와, 이미지에서 특징벡터를 추출하는 추출기와,특징벡터를 입력 받아 이미지간 상대 등급을 산출하는 비교기를 포함하는 인공신경망을 준비하는 인공신경망 준비 단계; 등급기에 제1 이미지를 입력하여 제1 특징벡터를 추출하고, 제1 이미지에 대한 절대 등급을 산출하는 절대 등급산출 단계; 추출기에 제2 이미지를 입력하여 제2 특징벡터를 추출하는 특징 벡터 추출 단계; 비교기에 제1 특징벡터와 제2 특징벡터를 입력하여, 비교기에서 제1 이미지와 제2 이미지의 상대 등급을 비교하는 상대 등급 비교 단계; 및 등급기에서 산출된 등급과, 비교기에서 산출된 비교 결과를 이용하여 등급기와 비교기의 파라미터를 업데이트하는 파라미터 업데이트 단계; 를 포함하는, 비교 학습 방법."}
{"patent_id": "10-2022-0174364", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "청구항 1에 있어서, 상기 학습데이터 쌍 준비 단계는 : 절대 등급이 레이블링된 학습 이미지 집합에서 제1 이미지와 제2 이미지를 선택하여 학습 데이터 쌍을 결정하는단계; 및 동일한 학습 데이터 쌍에 속하는 제1 이미지와 제2 이미지 간의 상대적인 등급을 레이블링하는 단계; 를 포함하는, 비교 학습 방법."}
{"patent_id": "10-2022-0174364", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "에 있어서, 상기 추출기를 준비하는 단계는 : 등급기의 제1 심층신경망 구조를 복사하고 신경망의 파라미터를 고정시켜서 제2 심층신경망을 생성하는 단계; 를 포함하는, 비교 학습 방법."}
{"patent_id": "10-2022-0174364", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "청구항 3에 있어서, 상기 등급기 준비 단계는 : 합성곱 신경망(CNN)을 이용하여 제1 심층신경망을 생성하는 단계; 를 포함하는, 비교 학습 방법. 공개특허 10-2024-0091454-3-청구항 5"}
{"patent_id": "10-2022-0174364", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "청구항 1에 있어서, 상기 파라미터 업데이트 단계는 : 등급기의 출력과 등급 레이블의 차이를 제곱한 값을 이용하여 등급기의 손실함수를 구하는 단계; 및 비교기의 하나의 입력에 대한 다른 입력의 등급이 높을 확률과 낮을 확률의 엔트로피를 이용하여 비교기의 손실함수를 구하는 단계; 를 포함하는, 비교 학습 방법."}
{"patent_id": "10-2022-0174364", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "청구항 3에 있어서, 상기 방법은 : 에포크가 종료된 경우, 등급기의 제1 심층신경망 구조를 복사하고 신경망의 파라미터를 고정시켜서, 추출기의제2 심층신경망을 생성하는 단계; 를 더 포함하는, 비교 학습 방법."}
{"patent_id": "10-2022-0174364", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "이미지의 등급을 추정하기 위한 비교학습 장치에 있어서, 상대적인 등급이 서로 다른 제1 이미지와 제2 이미지를 선택하여 학습 데이터 쌍으로 결정하는 학습 데이터 쌍입력부; 제1 이미지를 입력받아 제1 특징벡터를 추출하는 제1 심층신경망을 포함하고 제1 이미지의 절대 등급을 분류하는 등급기; 제2 이미지를 입력받아 제2 특징벡터를 추출하는 제2 심층신경망을 포함하는 추출기; 제1 특징벡터와 제2 특징벡터를 입력 받아 제1 이미지와 제2 이미지 사이의 상대 등급을 비교하는 비교기; 및 등급기에서 산출된 절대 등급과, 비교기에서 산출된 상대 등급 비교 결과를 이용하여 등급기와 비교기의 파라미터를 업데이트하는 제어부; 를 포함하는, 비교 학습 장치."}
{"patent_id": "10-2022-0174364", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "청구항 8에 있어서, 상기 제어부는, 등급기의 제1 심층신경망 구조를 복사하고 신경망의 파라미터를 고정시켜서 추출기의 제2 심층신경망을 생성하는, 비교 학습 장치."}
{"patent_id": "10-2022-0174364", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "청구항 8에 있어서, 상기 제어부는, 공개특허 10-2024-0091454-4-등급기의 출력과 등급 레이블의 차이를 제곱한 값을 이용하여 등급기의 손실함수를 구하고, 비교기의 하나의 입력에 대한 다른 입력의 등급이 높을 확률과 낮을 확률의 엔트로피를 이용하여 비교기의 손실함수를 구하는, 비교 학습 장치."}
{"patent_id": "10-2022-0174364", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "청구항 8에 있어서, 상기 제어부는, 에포크가 종료된 경우, 등급기의 제1 심층신경망 구조를 복사하고 신경망의 파라미터를 고정시켜서, 추출기의제2 심층신경망을 생성하는, 비교 학습 장치."}
{"patent_id": "10-2022-0174364", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "이미지의 등급을 추정하기 위한 비교학습 방법에 관한 기술이 개시된다. 비교학습 방법은, 등급기에 제1 이미지 를 입력하여 제1 특징벡터를 추출하고, 제1 이미지에 대한 절대 등급을 산출하는 단계와, 추출기에 제2 이미지를 입력하여 제2 특징벡터를 추출하는 단계와, 비교기에 제1 특징벡터와 제2 특징벡터를 입력하여, 비교기에서 제1 이미지와 제2 이미지의 상대 등급을 비교하는 단계와, 등급기에서 산출된 등급과 비교기에서 산출된 비교 결과를 이용하여 등급기와 비교기의 파라미터를 업데이트하는 단계를 포함한다. 정확한 상대 등급이 레이블링된 이미지 데이터 쌍을 많이 생성할 수 있고, 절대 등급과 상대 등급을 동시에 학습시켜서 정확한 등급비교가 가능한 인공 신경망 모델을 생성할 수 있다."}
{"patent_id": "10-2022-0174364", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "데이터 처리 기술, 특히 의료 영상의 등급 추정을 위한 인공신경망에 비교학습을 적용하는 방법에 관한 기술이 개시된다."}
{"patent_id": "10-2022-0174364", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "영상 또는 이미지에서 등급을 추정하는 것, 예를 들어 얼굴 영상에서 나이를 추정하거나, 환자 영상에서 질환의 정도를 추정하는 것은 매우 중요한 문제이다. 다만, 전문가라 할 지라도 절대적인 등급을 추정하는 것은 어려운 작업이며, 정확한 등급을 가진 학습 데이터를 많이 생성하는 것도 곤란하다. 따라서 기계 학습 또는 딥 러닝으 로 영상을 학습시키는 경우에 절대적인 등급을 이용한 회귀분석(regression)의 결과는 좋은 성능을 나타내기 어 렵다. 종래 기술에서도 인공지능을 이용하여 의료 영상에서 나이, 질환의 정도를 추정하는 다양한 방법들이 개시되고 있다. 2021년 03월 09일에 공고된 등록특허 제10-2,225,775호는 의료 영상으로부터 뇌혈관 나이를 추정하는 방법에 관 한 것으로, 의료 영상의 형태적 변화를 컨볼루션 신경망(CNN)을 이용한 기계학습을 통해 정량화하여, 뇌 혈관의 전반적인 노화 상태를 뇌 혈관 나이 지표로 예측하는 방법을 개시하고 있다. 이를 위해 뇌 혈관 영상들을 수집 하는 단계와, 중간대뇌동맥의 위치를 검출하는 전처리를 수행하는 단계와, 콘볼루션 신경망을 통해 기계학습하 는 단계와, 뇌혈관 나이를 추정하는 단계를 포함한다. 이때 콘볼루션 신경망은 뇌혈관의 나이를 회귀분석을 통 해 추정한다. 2018년 11월 08일에 공고된 등록특허 제10-1916347호는 딥러닝 기반 이미지 비교 장치 및 방법에 관한 것으로, 제1 서브 네트워크와 제2 서브 네트워크 그리고 비교 모듈이 샴 네트워크 구조로 구현된 이미지 비교 장치가 개 시된다. 제1 서브 네트워크와 제2 서브 네트워크는 동일한 가중치를 가지도록 링크를 공유할 수 있다. 정상 데 이터인 제1 이미지 데이터를 제1 서브 네트워크에 입력하고, 판단 대상인 제2 이미지 데이터를 제2 서브 네트워 크에 입력하여, 제2 이미지 데이터의 비정상 여부를 결정할 수 있다. 2020년 07월 09일에 공고된 등록특허 제10-2132275호는 딥러닝 기반 주름 평가 장치에 관한 것으로, 입력되는 주름 영상을 N+1의 등급 범위에서 평가하기 위해 딥러닝 기반으로 학습된 등급평가 모델을 포함하는 주름 평가 장치를 개시한다. 여기에서 등급 평가 모델은 캐스케이드되는 N개의 이진 분류부들을 포함할 수 있고, 각각의 이진 분류부는 각각의 등급 이하인지 여부를 판단한다. 2022년 07월 28일에 공개된 공개특허 제10-2022-0105723호는 인공 신경망 기반의 의료 영상 분석 장치 및 학습 방법에 관한 것으로, 동일 진단 대상자에 대해 획득된 의료 영상 간의 변화를 판별하기 위한 것이다. 이를 위한 의료 영상 분석모델은 의료 영상 간의 유사도 값을 반환하는 제1 네트워크와, 특징 맵이 서로 같은 형태를 가지 도록 하는 어텐션 모듈로 구현되어 특징맵 유사도 값이 최대값이 되도록 학습되는 제2 네트워크를 포함한다. 다만, 등급 추정과 더불어 상대적인 등급의 정도를 학습시켜서, 학습 레이블을 쉽게 생성할 수 있으며, 보다 정 확한 등급 판정이 가능한 비교학습 방법에 대해서는 아직 구체적으로 개시되어 있지 않다."}
{"patent_id": "10-2022-0174364", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "제안된 발명은 등급 비교를 위해 레이블된 학습 데이터를 생성하기 용이한 학습 방법 및 장치를 제공하는 것을 목적으로 한다. 나아가 제안된 발명은 의료 영상으로부터 질환의 정도, 병변의 등급을 정확히 결정할 수 있도록 인공신경망을 학습시키는 장치 및 방법을 제공하는 것을 목적으로 한다."}
{"patent_id": "10-2022-0174364", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "제안된 발명의 일 양상에 따르면, 이미지의 등급을 추정하기 위한 비교학습 방법은, 학습 데이터 쌍 준비 단계 와, 인공신경망 준비 단계와, 절대 등급 산출 단계와, 특징 벡터 추출 단계와, 상대 등급 비교 단계와, 파라미 터 업데이트 단계를 포함한다. 학습 데이터 쌍 준비 단계에서는 상대적인 등급이 서로 다른 제1 이미지와 제2 이미지를 선택하여 학습 데이터 쌍으로 결정한다. 인공신경망 준비 단계에서는 이미지에서 특징벡터를 추출하고 이미지 등급을 판별하는 등급기와, 이미지에서 특 징벡터를 추출하는 추출기와, 특징벡터를 입력 받아 이미지간 상대 등급을 산출하는 비교기를 포함하는 인공신 경망을 준비한다. 절대 등급 산출 단계에서는 등급기에 제1 이미지를 입력하여 제1 특징벡터를 추출하고, 제1 이미지에 대한 절대 등급을 산출한다. 특징 벡터 추출 단계에서는 추출기에 제2 이미지를 입력하여 제2 특징벡터를 추출한다. 상대 등급 비교 단계에서는 비교기에 제1 특징벡터와 제2 특징벡터를 입력하여, 비교기에서 제1 이미지와 제2 이미지의 상대 등급을 비교한다. 파라미터 업데이트 단계에서는 등급기에서 산출된 등급과, 비교기에서 산출된 비교 결과를 이용하여 등급기와 비교기의 파라미터를 업데이트한다. 추가적인 양상에 따르면, 상기 학습데이터 쌍 준비 단계는, 절대 등급이 레이블링된 학습 이미지 집합에서 제1 이미지와 제2 이미지를 선택하여 학습 데이터 쌍을 결정하는 단계와, 동일한 학습 데이터 쌍에 속하는 제1 이미 지와 제2 이미지 간의 상대적인 등급을 레이블링하는 단계를 포함한다. 추가적인 양상에 따르면, 상기 인공신경망 준비 단계는, 이미지에서 특징벡터를 추출하는 제1 심층신경망과 이 미지 등급을 판별하는 분류기를 포함하는 등급기를 준비하는 등급기 준비 단계와, 이미지에서 특징벡터를 추출 하는 제2 심층신경망을 포함하는 추출기를 준비하는 추출기 준비 단계를 포함한다. 추가적인 양상에 따르면, 상기 등급기 준비 단계는, 합성곱 신경망(CNN)을 이용하여 제1 심층신경망을 생성하는 단계를 포함한다. 추가적인 양상에 따르면, 상기 추출기를 준비하는 단계는, 등급기의 제1 심층신경망 구조를 복사하고 신경망의 파라미터를 고정시켜서 제2 심층신경망을 생성하는 단계를 포함한다. 추가적인 양상에 따르면, 상기 파라미터 업데이트 단계는, 등급기의 출력과 등급 레이블의 차이를 제곱한 값을 이용하여 등급기의 손실함수를 구하는 단계와, 비교기의 하나의 입력에 대한 다른 입력의 등급이 높을 확률과 낮을 확률의 엔트로피를 이용하여 비교기의 손실함수를 구하는 단계를 포함한다. 추가적인 양상에 따르면, 상기 방법은, 에포크가 종료된 경우, 등급기의 제1 심층신경망 구조를 복사하고 신경 망의 파라미터를 고정시켜서, 추출기의 제2 심층신경망을 생성하는 단계를 더 포함한다. 제안된 발명의 다른 일 양상에 따르면, 이미지의 등급을 추정하기 위한 비교학습 장치는, 학습 데이터 쌍 입력 부와, 등급기와, 추출기와, 비교기와, 제어부를 포함한다. 학습 데이터 쌍 입력부는 상대적인 등급이 서로 다른 제1 이미지와 제2 이미지를 선택하여 학습 데이터 쌍으로 결정한다. 등급기는 제1 이미지를 입력받아 제1 특징벡터를 추출하는 제1 심층신경망을 포함하고 제1 이미지의 절대 등급 을 분류한다. 추출기는 제2 이미지를 입력받아 제2 특징벡터를 추출하는 제2 심층신경망을 포함한다. 비교기는 제1 특징벡터와 제2 특징벡터를 입력 받아 제1 이미지와 제2 이미지 사이의 상대 등급을 비교한다. 제어부는 등급기에서 산출된 절대 등급과, 비교기에서 산출된 상대 등급 비교 결과를 이용하여 등급기와 비교기 의 파라미터를 업데이트한다. 추가적인 양상에 따르면, 상기 제어부는, 등급기의 제1 심층신경망 구조를 복사하고 신경망의 파라미터를 고정 시켜서 추출기의 제2 심층신경망을 생성한다. 추가적인 양상에 따르면, 상기 제어부는, 등급기의 출력과 등급 레이블의 차이를 제곱한 값을 이용하여 등급기 의 손실함수를 구하고, 비교기의 하나의 입력에 대한 다른 입력의 등급이 높을 확률과 낮을 확률의 엔트로피를 이용하여 비교기의 손실함수를 구한다. 추가적인 양상에 따르면, 상기 제어부는, 에포크가 종료된 경우, 등급기의 제1 심층신경망 구조를 복사하고 신 경망의 파라미터를 고정시켜서, 추출기의 제2 심층신경망을 생성한다."}
{"patent_id": "10-2022-0174364", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "제안된 발명에 따라, 등급 비교가 용이한 학습 데이터 쌍을 이용하여 학습할 수 있으므로 많은 학습데이터로 학 습할 수 있어서 정확한 등급 결정이 가능하도록 인공신경망을 학습시킬 수 있다. 나아가 제안된 발명은 등급기와 비교기를 이용하여 절대 등급과 상대 등급을 동시에 학습시킬 수 있어서, 등급 을 정확히 결정할 수 있는 인공신경망 모델을 제공할 수 있다."}
{"patent_id": "10-2022-0174364", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "전술한, 그리고 추가적인 양상들은 첨부된 도면을 참조하여 설명하는 실시예들을 통해 구체화된다. 각 실시예 들의 구성 요소들은 다른 언급이나 상호간에 모순이 없는 한 실시예 내에서 또는 타 실시예의 구성 요소들과 다 양한 조합이 가능한 것으로 이해된다. 발명자는 그 자신의 발명을 가장 최선의 방법으로 설명하기 위해 용어의 개념을 적절하게 정의할 수 있다는 원칙에 입각하여 본 명세서 및 청구범위에 사용된 용어는 기재 내용 혹은 제 안된 기술적 사상에 부합하는 의미와 개념으로 해석되어야만 한다. 본 명세서에서 모듈 또는 부분은, 컴퓨터 또 는 프로세서에서 실행가능하도록 메모리에 저장된 프로그램 명령어의 집합이거나, 이러한 명령들을 수행할 수 있도록 ASIC, FPGA 등의 전자 부품 또는 회로의 집합을 이용하여 구현할 수 있다. 또한, 각 모듈 또는 부분의 동작은 하나 또는 복수의 프로세서 또는 장치에 의해 수행될 수 있다. 이하 첨부된 도면을 참조하여 본 발명의 바람직한 실시예를 상세히 설명하기로 한다. 도 1은 일 실시예에 따른 이미지의 등급을 추정하기 위한 비교학습 장치의 개략적인 구성을 나타내는 구성도이 다. 제안된 발명의 일 양상에 따르면, 이미지의 등급을 추정하기 위한 비교학습 장치는, 학습 데이터 쌍 입력 부와, 등급기와, 추출기와, 비교기와, 제어부를 포함한다. 비교학습 장치는 프 로세서와 메모리를 포함하는 컴퓨터 시스템에 의해 구현될 수 있다. 메모리에는 입력된 이미지가 저장될 수 있 고, 프로세서에 의해 수행되는 명령어가 저장될 수 있다. 프로세서는 인공지능 모델을 구동시키는 제어부 역할 을 할 수 있다. 등급기, 추출기, 비교기 등의 인공신경망은 소프트웨어 또는 하드웨어 모듈로 구성되고, 프로세 서에 의해 구동될 수 있다. 학습 데이터 쌍 입력부는 상대적인 등급이 서로 다른 제1 이미지와 제2 이미지를 선택하여 학습 데이터 쌍 으로 결정한다. 기계 학습 또는 딥 러닝으로 영상 또는 이미지를 학습시키는 경우, 나이 또는 질환의 정도의 절대적인 값을 추 정하기 위하여 회귀분석(regression)을 사용할 수 있다. 다만, 회귀 분석의 정확도를 높이기 위해서는 각 등급 에 대해 정확히 레이블링된 충분한 학습데이터가 필요하다. 그러나 일반적으로 의료 영상에서 병변 진행도 등급 이 정확히 레이블링된 이미지들을 충분히 확보하는 것은 어렵다. 반면에 두 이미지에서 상대적인 등급, 예를 들어 어느 이미지가 나이 들어 보이는지, 또는 어느 영상의 질환 정 도가 심한지 등은 상대적으로 쉽게 판단할 수 있으므로, 상대적인 등급 비교에 사용되는 학습 레이블을 비교적 쉽게 생성할 수 있다. 그 결과 상대적으로 많은 학습 레이블을 쉽게 생성할 수 있다. 상대적인 등급 비교를 위 해서 학습 데이터에 사용되는 이미지는 2개씩 선택되어 쌍을 이루도록 선택한다. 등급기는 제1 이미지를 입력받아 제1 특징벡터를 추출하는 제1 심층신경망을 포함하고 제1 이미지의 절대 등급을 분류한다. 등급기(regressor)는 회귀분석(regression)을 위한 인공신경망을 포함한다. 인공신경망으로는 심층신경망 (deep neural network; DNN)을 사용할 수 있으며, 그 중에서 특히 영상분야 분류에 높은 성능을 보이는 합성곱 신경망(convolutional neural network; CNN)을 사용하는 것이 바람직하다. 등급기에 사용되는 제1 심층신 경망은 이미지를 입력받아 그 이미지의 특징벡터를 추출한다. 등급기는 제1 심층신경망 외에도 분류기를 더 포함한다. 분류기는 추출된 특징벡터를 입력받아 입력된 이 미지의 절대적인 등급별 확률을 출력할 수 있다. 회귀분석에서는 학습이 진행됨에 따라, 등급별 확률을 반영하 여 제1 심층신경망과 분류기의 가중치 등의 파라미터를 갱신(update)한다. 추출기는 제2 이미지를 입력받아 제2 특징벡터를 추출하는 제2 심층신경망을 포함한다. 추출기의 제2 심층신경망은 등급기의 제1 심층신경망을 복사하여 사용할 수 있다. 즉, 제2 심층신경 망은 제1 심층신경망과 구조가 동일하다. 그리고, 가중치 등의 파라미터도 제2 심층신경망과 제1 심층신경망은 동일하다. 다만, 학습의 복잡도를 줄이기 위해, 추출기의 파라미터들은 학습동안 수시로 갱신되지 않는 것이 바람직 하다. 즉, 추출기의 제2 심층신경망은 일정 주기마다 학습된 등급기의 제1 심층신경망을 복사하여 사용한 다. 일정 주기마다 예를 들어 각 에포크(epoch) 종료시마다 신경망을 복사하면, 학습의 복잡도를 증가시키지 않 고 추출기를 최적화시키도록 학습시키는 효과가 있다. 비교기 는 제1 특징벡터와 제2 특징벡터를 입력 받아 제1 이미지와 제2 이미지 사이의 상대 등급을 비교한 다. 비교기(comparer)는 제1 이미지에 레이블링된 등급이 제2 이미지에 레이블링된 등급보다 클 확률과, 작을 확률을 출력할 수 있다. 제어부는, 등급기의 제1 심층신경망 구조를 복사하고 신경망의 파라미터를 고정시켜서 추출기의 제2 심층신경망을 생성한다. 제어부는, 에포크(epoch)가 종료된 경우, 등급기의 제1 심층신경망 구조를 복사하고 신경망의 파라미터를 고정시켜서, 추출기의 제2 심층신경망을 생성한다. 제어부는 등급기에서 산출된 절대 등급과, 비교기에서 산출된 상대 등급 비교 결과를 이용하여 등급기와 비교기의 파라미터를 업데이트한다. 이때, 추출기의 파라미터는 업데이트 시키지 않고 고정시킨채 사용하는 것이 바람직하다. 상기 제어부는, 등급기의 출력과 등급 레이블의 차이를 제곱한 값을 이용하여 등급기의 손실함수를 구하고, 비교기의 하나의 입력에 대한 다른 입력의 등급이 높을 확률과 낮을 확률의 엔트로피를 이용하여 비교 기의 손실함수를 구한다. 즉, 학습의 목적함수는 다음 수학식 1의 손실함수(loss function)을 최소화하도록 설 정할 수 있다. 여기서 첫번째 항은 입력된 제1 이미지(x)의 레이블링된 절대 등급(y)과 등급기에서 출력되는 등급(f(x))의 L2 손실에 해당한다. 두번째 항은 입력된 제1 이미지(x)의 등급(y)이 제2 이미지(xref)의 등급(yref)보다 높을 확률 (P y>yref)과 낮을 확률(P y≤yref)의 엔트로피에 관계된 것이다. 확률 P < 1 이므로 log P < 0, 즉 음수가 되어 두번째 항은 양수가 된다. 첫번째 항도 제곱꼴이므로 손실은 양수이며, 최소값을 구하는 문제가 된다. [수학식 1]"}
{"patent_id": "10-2022-0174364", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "여기에서, E 는 기대값을 나타내고, y 는 제1 이미지(x)에 레이블링된 절대 등급이고, f(x)는 등급기에서 산출된 절대 등급이며, yref 는 제2 이미지(xref)에 레이블링된 절대 등급이다. P y>yref 는 비교기에서 출력하는 제1 이미지(x)의 절대 등급이 제2 이미지(xref)의 절대값보다 크다고 비교기에서 판정하는 확률이고, P y≤yref 는 비교기에서 출력하는 제1 이미지(x)의 절대 등급이 제2 이미지(xref)의 절대값보다 작다고 비교기에서 판정하는 확률이다. γ 는 비례 상수이다. 도 2는 일 실시예에 따른 이미지의 등급을 추정하기 위한 비교학습 방법을 개략적으로 나타내는 순서도이다. 제안된 발명의 다른 일 양상에 따르면, 이미지의 등급을 추정하기 위한 비교학습 방법은, 학습 데이터 쌍 준비 단계(S210)와, 인공신경망 준비 단계(S220)와, 등급기와 비교기 학습 단계(S230)를 포함한다. 비교학습 방법은 비교학습 장치에 의해 수행될 수 있다. 학습 데이터 쌍 준비 단계(S210)에서는 상대적인 등급이 서로 다른 제1 이미지와 제2 이미지를 선택하여 학습 데이터 쌍으로 결정한다. 인공신경망 준비 단계(S220)에서는 이미지에서 특징벡터를 추출하고 이미지 등급을 판별하는 등급기와, 이미지 에서 특징벡터를 추출하는 추출기와, 특징벡터를 입력 받아 이미지간 상대 등급을 산출하는 비교기를 포함하는인공신경망을 준비한다. 등급기와 비교기 학습 단계(S230)에서는 학습 데이터 쌍을 이용하여 등급기와 비교기를 학습시킨다. 이하에서 각 단계별로 좀더 구체적인 내용을 살펴본다. 도 3은 일 실시예에 따른 이미지의 등급을 추정하기 위한 비교학습 방법 중 학습 데이터 쌍을 준비하는 방법을 나타내는 순서도이다. 학습데이터 쌍 준비 단계(S210)는, 절대 등급이 레이블링된 학습 이미지 집합에서 제1 이미지와 제2 이미지를 선택하여 학습 데이터 쌍을 결정하는 단계(S313)와, 동일한 학습 데이터 쌍에 속하는 제1 이미지와 제2 이미지 간의 상대적인 등급을 레이블링하는 단계(S315)를 포함한다. 학습 이미지에 레이블링된 절대 등급은 등급기의 학습에 활용할 수 있다. 다만, 학습 이미지에 레이블링된 절대 등급이 부정확하거나, 레이블링된 학습 이미지가 적은 경우, 학습된 등급기로 이미지의 등급을 정확히 분류하기 어렵다. 제1 이미지와 제2 이미지 간에 어느 이미지의 등급이 높은지 또는 낮은지 결정하는 상대적인 등급은 판 별하기 쉬운 경우가 많으며, 따라서 보다 정확하게 보다 많은 학습 데이터 쌍을 결정할 수 있다. 상대적인 등급 이 레이블링된 학습 데이터 쌍을 비교기에 입력하여 학습시키면, 상대 등급을 구분하는데 우수한 성능을 가진 비교기를 학습시킬 수 있다. 특히, 제2 이미지에 기준 영상(xref)을 입력시켜 학습시키는 경우, 기준 영상(xref) 대비 등급이 높은 이미지와 낮은 이미지를 명확히 구분할 수 있다. 도 4는 일 실시예에 따른 이미지의 등급을 추정하기 위한 비교학습 방법 중 인공신경망을 준비하는 방법을 나타 내는 순서도이다. 인공신경망 준비 단계(S220)는, 등급기 준비 단계(S423)와, 추출기 준비 단계(S425)와, 비교기 준비 단계(S42 7)를 포함한다. 등급기 준비 단계(S423)에서는 이미지에서 특징벡터를 추출하는 제1 심층신경망과 이미지 등급을 판별하는 분류 기를 포함하는 등급기를 준비한다. 등급기 준비 단계(S423)에서는, 합성곱 신경망(CNN)을 이용하여 제1 심층신 경망을 생성할 수 있다. 추출기 준비 단계(S425)에서는 이미지에서 특징벡터를 추출하는 제2 심층신경망을 포함하는 추출기를 준비한다. 추출기 준비 단계(S425)에서는, 등급기의 제1 심층신경망 구조를 복사하고 신경망의 파라미터를 고정시켜서 제2 심층신경망을 생성할 수 있다. 등급기의 제1 심층신경망에 합성곱 신경망(CNN)을 사용하는 경우, 추출기의 제2 심층신경망도 합성곱 신경망(CNN)을 사용한다. 비교기 준비 단계(S427)에서는 인공신경망을 포함하는 비교기를 준비한다. 비교기는 등급기에서 제1 심층신경망 으로 추출한 특징벡터와 추출기의 제2 심층신경망으로 추출한 특징벡터를 입력받을 수 있도록 구성한다. 비교기 는 입력되는 특징벡터들을 이용하여 등급기에 입력된 이미지와 추출기에 입력된 이미지의 상대 등급을 비교할 수 있다. 도 5는 일 실시예에 따른 이미지의 등급을 추정하기 위한 비교학습 방법 중 학습 데이터 쌍을 이용하여 등급기 와 비교기를 학습하는 방법을 나타내는 순서도이다. 등급기와 비교기 학습 단계(S230)는 절대 등급 산출 단계(S525)와, 특징 벡터 추출 단계(S540)와, 상대 등급 비 교 단계(S560)와, 파라미터 업데이트 단계(S565)를 포함한다. 추출기의 제2 심층신경망은 가중치 등 파라미터를 고정시켜서, 등급기의 제1 심층신경망의 파라미터를 복사하는 경우가 아닌한, 학습 과정에서 변화하지 않도록 한다(S510). 학습 데이터 쌍을 선택하여, 제1 이미지는 등급기로, 제2 이미지는 추출기로 입력한다(S520). 절대 등급 산출 단계(S525)에서는 등급기에 제1 이미지를 입력하여(S520) 제1 특징벡터를 추출하고(S530), 제1 이미지에 대한 절대 등급을 산출한다(S550). 특징 벡터 추출 단계(S540)에서는 추출기에 제2 이미지를 입력하여(S520) 제2 특징벡터를 추출한다(S540). 상대 등급 비교 단계(S560)에서는 비교기에 제1 특징벡터와 제2 특징벡터를 입력하여, 비교기에서 제1 이미지와 제2 이미지의 상대 등급을 비교한다(S560). 파라미터 업데이트 단계(S565)에서는 등급기에서 산출된 등급과, 비교기에서 산출된 비교 결과를 이용하여 등급 기와 비교기의 파라미터를 업데이트한다(S575). 에포크(epoch)가 종료하지 않은 경우(S580) 학습 데이터 쌍을 입력하는 단계(S520)로 돌아가서 반복한다. 파라미터 업데이트 단계는, 등급기의 출력과 등급 레이블의 차이를 제곱한 값을 이용하여 등급기의 손실함수를 구하는 단계와, 비교기의 하나의 입력에 대한 다른 입력의 등급이 높을 확률과 낮을 확률의 엔트로피를 이용하 여 비교기의 손실함수를 구하는 단계(S570)를 포함한다. 손실함수는 상기 수학식 1을 이용하여 구할 수 있다. 비교학습 방법은, 에포크가 종료된 경우(S580), 등급기의 제1 심층신경망 구조를 복사한다(S590). 학습이 종료 되지 않은 경우, 신경망의 파라미터를 고정시키는 단계(S510)로 돌아가서, 새로이 생성된 추출기의 제2 심층신 경망을 이용하여 반복하여 학습을 진행한다. 도 6은 일 실시예에 따른 이미지의 등급을 추정하기 위한 비교학습 장치의 인공신경망 구조를 개략적으로 나타 내는 개념도이다. 비교학습 장치는 등급기와, 추출기와, 비교기를 포함한다. 등급기는 제1 심층신경망을 포함한다. 제1 이미지를 제1 심층신경망에 입력하면, 제1 특징 벡터를 산출할 수 있다. 산출된 제1 특징벡터로부터 분류기를 거쳐서 등급이 분류된다. 추출기는 제2 심층신경망을 포함한다. 제2 이미지를 제2 심층신경망에 입력하면, 제2 특징 벡터를 산출할 수 있다. 제1 심층신경망에서 제2 심층신경망으로 연결되는 점선 화살표는 제2 심층신경망이 제1 심층신경망으로부터 복사된 것임을 나타낸다. 비교기는 제1 특징벡터와 제2 특징벡터를 입력받는다. 도면에서 등급기의 제1 특징벡터에 서 비교기의 제1 특징벡터로 연결되는 점선 화살표는 비교기의 제1 특징벡터가 등급기의 제1 특징벡 터를 복사 또는 전달 받은 것을 나타낸다. 이는 추출기의 제2 특징벡터와 비교기의 제2 특징벡터 에서도 마찬가지이다. 도 7은 일 실시예의 변형에 따른 이미지의 등급을 추정하기 위한 비교학습 장치의 인공신경망 구조를 개략적으 로 나타내는 개념도이다. 도 7에서는 학습 데이터로 제2 이미지 대신에, 기준 이미지를 이용한다. 나머지 구성은 도 6과 동일 하거나 유사하므로, 도 6을 참조한다. 이하의 도면에서도 앞에서 설명한 도면과 유사한 도면의 경우, 중복을 피 하기 위해 설명을 생략할 수 있다. 이 경우, 앞에서 설명한 유사한 도면의 설명을 참조할 수 있다. 도 7에서 특정한 기준 이미지에서 추출한 기준 이미지의 특징벡터를 이용하여 학습하는 경우, 특정한 기준 이미지에 대한 이미지들의 상대 등급을 보다 명확하게 비교하도록 비교기를 학습시킬 수 있다. 도 8은 일 실시예에 따른 비교 학습을 이용한 병변 등급 진단 장치의 개략적인 구성을 나타내는 구성도이다. 제안된 발명의 또 다른 일 양상에 따르면, 병변 부위를 촬영한 의료 영상으로부터 병변의 등급을 진단하는, 비 교 학습을 이용한 병변 등급 진단 장치는, 평가대상 이미지 입력부와, 등급기와, 비교기와, 등급 결정부를 포함한다. 평가대상 이미지 입력부는 평가대상 이미지를 입력받는다. 등급기는 평가대상 이미지에서 제1 특징벡터를 추출하는 제1 심층신경망을 포함한다. 비교기는 평가대상 이미지의 제1 특징벡터를 기준 이미지의 제2 특징벡터와 비교하여, 기준 이미지에 대한 평가 대상 이미지의 상대 등급을 결정한다. 등급 결정부는 평가 대상 이미지에 대해 서로 다른 기준 이미지를 이용하여 구한 상대 등급을 이용하여 평 가 대상 이미지의 절대 등급을 결정한다. 추가적인 양상에 따르면, 상기 비교기는, 학습이미지에 대해 상기 제1 심층신경망을 포함하는 등급기에서 산출 된 등급과, 상대 등급이 결정된 학습이미지 쌍을 비교기로 비교한 결과를 이용하여, 학습된다. 비교기의 학습에 대해서는 앞에서 설명한 비교학습 방법을 참조할 수 있다. 추가적인 양상에 따르면, 상기 장치는, 기준 이미지를 입력받는 기준 이미지 입력부와, 제1 심층신경망을 포함하여 기준 이미지에서 특징벡터를 추출하는 기준 벡터 추출기와 병변 등급 진단 장치를 제어하는 제어 부를 더 포함한다. 제어부는 서로 다른 기준 이미지를 입력받아 특징벡터를 추출하고, 비교기를 이용하여 평가 대상 이미지의 특징벡터와 비교하여, 평가 대상 이미지의 등급을 결정할 수 있다. 예를 들어, 3등급 기준 이미지와 비교하였을 때, 평가 대상 이미지의 등급이 더 높게 결정된 경우, 제어부(89 0)는 평가 대상 이미지를 4등급 기준 이미지와 비교하도록 할 수 있다. 만약, 평가 대상 이미지가 4등급 기준 이미지보다 등급이 낮게 결정된 경우, 등급 결정부는 평가 대상 이미지를 3.5 등급으로 결정할 수 있다. 도 9는 일 실시예의 변형에 따른 비교 학습을 이용한 병변 등급 진단 장치의 개략적인 구성을 나타내는 구성도 이다. 충분한 학습 데이터로 학습하지 않은 경우, 등급기의 성능이 좋지 않으므로, 병변 등급 진단 장치에서도 등급기를 이용하여 절대 등급을 구할 필요가 없다. 따라서, 등급기 중에서 분류기를 제외한, 특징벡터를 추출하 는 심층신경망 부분만을 포함하는 평가 벡터 추출기를 사용하는 것이 바람직하다. 평가 벡터 추출기 는 평가대상 이미지에서 제1 특징벡터를 추출하는 제1 심층신경망을 포함한다. 추가적인 양상에 따르면, 비교 학습을 이용한 병변 등급 진단 장치는, 평가대상 이미지 입력부와, 평 가 벡터 추출기와, 비교기와, 등급 결정부, 제어부를 포함한다. 추가적인 양상에 따르면, 병변 등급 진단 장치는, 평가 벡터 추출기를 이용하여 기준 이미지에서 추 출된 특징벡터를 저장하는 기준 벡터 저장부와, 저장된 기준 이미지에서 추출된 특징벡터를 비교기로 입력 하는 기준 벡터 설정부를 더 포함한다. 기준 이미지의 특징벡터를 미리 추출하는 경우, 평가 대상 이미지 에서 특징벡터를 추출하면 신속하게 비교기에 입력할 수 있고, 기준 이미지를 변경하는 경우에도, 미리 추출된 특징벡터를 이용할 수 있어서, 신속한 평가가 가능하다. 도 10은 일 실시예의 변형에 따른 비교 학습을 이용한 병변 등급 진단 장치의 인공신경망 구조를 개략적으로 나 타내는 개념도이다. 평가대상 이미지는 평가 벡터 추출기에 입력된다. 제1 심층신경망은 입력된 평가대상 이미지 에서 제1 특징벡터를 추출한다. 추출된 제1 특징벡터는 비교기로 입력된다. 기준 벡터 설정부에서 기준 이미지의 특징벡터가 선택되어 비교기로 입력된다. 비교기에서 기준 이미지의 특징벡터와 평 가대상 이미지의 특징벡터를 비교하여 두 이미지의 상대 등급을 평가한다. 도 11은 일 실시예의 다른 변형에 따른 비교 학습을 이용한 병변 등급 진단 장치의 개략적인 구성을 나타내는 구성도이다. 추가적인 양상에 따르면, 병변 등급 진단 장치는, 상기 제1 비교기에 입력되는 기준 이미지의 특징 벡터와 다른 기준 이미지의 특징벡터를 입력받는 제2 비교기를 더 포함한다. 추출기에서 추출된 평 가대상 이미지의 특징벡터는 제1 비교기와 제2 비교기로 동시에 분배되어, 동시에 서로 다른 기준 이미지의 특징벡터와 비교될 수 있다. 그 결과 보다 신속하게 등급 판정이 가능하다. 도면에는 비교기가 2개만 도시되었으나, 등급 개수에 맞추어 복수개 준비하는 것이 가능하다. 도 12는 일 실시예의 다른 변형에 따른 비교 학습을 이용한 병변 등급 진단 장치의 인공신경망 구조를 개략적으 로 나타내는 개념도이다. 평가 벡터 추출기에서 추출된 평가대상 이미지의 특징벡터(1273, 1274)는 제1 비교기와 제2 비교기 에 입력되고, 서로 다른 기준 이미지의 특징벡터들(1275, 1276)과 상대 등급(1277, 1278)을 결정할 수 있 다. 등급결정부는 상대 등급들을 이용하여 평가대상 이미지의 절대 등급을 결정할 수 있다. 도 13은 일 실시예의 또 다른 변형에 따른 비교 학습을 이용한 병변 등급 진단 장치의 개략적인 구성을 나타내 는 구성도이다. 추가적인 양상에 따르면, 병변 등급 진단 장치는, 상기 제2 비교기에 입력되는 기준 이미지를 이용 하여 학습된 등급기의 심층신경망을 이용하는 제2 추출기를 더 포함한다. 도 7에서 설명한 바와 같이, 특정한 기준 이미지에서 추출한 기준 이미지의 특징벡터를 이용하여 학습한, 등급 기의 심층신경망과 비교기를 이용하는 경우 하는 경우, 특정한 기준 이미지에 대한 이미지들의 상 대 등급을 보다 명확하게 비교할 수 있다. 도 14는 일 실시예에 따른 비교 학습을 이용한 병변 등급 진단 방법을 개략적으로 나타내는 순서도이다. 제안된 발명의 또 다른 일 양상에 따르면, 병변 부위를 촬영한 의료 영상으로부터 병변의 등급을 진단하는, 비 교 학습을 이용한 병변 등급 진단 방법은, 평가대상 이미지 입력 단계와, 평가 벡터 추출 단계와, 상대 등급 비 교 단계와, 절대 등급 결정 단계를 포함한다. 평가대상 이미지 입력 단계(S1410)에서는 평가대상 이미지를 입력받는다. 평가 벡터 추출 단계(S1440)에서는 학습된 평가 벡터 추출기를 이용하여 평가대상 이미지에서 제1 특징벡터를 추출한다. 상대 등급 비교 단계(S1470)에서는 평가대상 이미지의 제1 특징벡터를 기준 이미지의 제2 특징벡터와 비교하여, 기준 이미지에 대한 평가 대상 이미지의 상대 등급을 결정한다. 등급이 결정될 때까지(S1480), 기준 이미지의 특징벡터를 바꾸며 평가대상 이미지의 제1 특징벡터에 대한 상대 등급을 산출한다. 절대 등급 결정 단계(S1490)에서는 평가 대상 이미지에 대해 서로 다른 기준 이미지를 이용하여 구한 상대 등급 을 이용하여 평가 대상 이미지의 절대 등급을 결정한다. 두 인접한 등급의 기준 이미지의 사이 등급에 속하거나, 가장 높은 기준 이미지의 등급보다 높거나, 가장 낮은 기준이미지의 등급보다 낮은 등급에 해당하면, 절대 등급을 결정할 수 있다. 추가적인 양상에 따르면, 상기 방법은, 기준 이미지를 입력받는 기준 이미지 입력 단계와, 기준 이미지에서 특 징벡터를 추출하는 기준 벡터 추출 단계(S1460)를 더 포함한다. 추가적인 양상에 따르면, 상기 방법은, 기준 이미지에서 추출된 특징벡터를 저장하는 기준 벡터 저장 단계와, 저장된 기준 이미지에서 추출된 특징벡터를 비교기로 입력하는 기준 벡터 설정 단계를 더 포함한다. 추가적인 양상에 따르면, 상기 상대 등급 비교 단계에서는, 서로 다른 기준 이미지의 특징벡터를 이용하여 평가 대상 이미지에 대해 동시에 복수의 상대등급을 결정한다. 추가적인 양상에 따르면, 상기 평가 벡터 추출 단계에서는, 서로 다른 기준 이미지를 추출하는 복수의 추출기를 이용하여 평가대상 이미지에서 복수의 특징벡터를 추출한다. 이상에서 본 발명을 첨부된 도면을 참조하는 실시예들을 통해 설명하였지만 이에 한정되는 것은 아니며, 이들로 부터 당업자라면 자명하게 도출할 수 있는 다양한 변형예들을 포괄하도록 해석되어야 한다. 특허청구범위는 이 러한 변형예들을 포괄하도록 의도되었다."}
{"patent_id": "10-2022-0174364", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 일 실시예에 따른 이미지의 등급을 추정하기 위한 비교학습 장치의 개략적인 구성을 나타내는 구성도이 다. 도 2는 일 실시예에 따른 이미지의 등급을 추정하기 위한 비교학습 방법을 개략적으로 나타내는 순서도이다. 도 3은 일 실시예에 따른 이미지의 등급을 추정하기 위한 비교학습 방법 중 학습 데이터 쌍을 준비하는 방법을 나타내는 순서도이다. 도 4는 일 실시예에 따른 이미지의 등급을 추정하기 위한 비교학습 방법 중 인공신경망을 준비하는 방법을 나타 내는 순서도이다. 도 5는 일 실시예에 따른 이미지의 등급을 추정하기 위한 비교학습 방법 중 학습 데이터 쌍을 이용하여 등급기 와 비교기를 학습하는 방법을 나타내는 순서도이다. 도 6은 일 실시예에 따른 이미지의 등급을 추정하기 위한 비교학습 장치의 인공신경망 구조를 개략적으로 나타 내는 개념도이다. 도 7은 일 실시예의 변형에 따른 이미지의 등급을 추정하기 위한 비교학습 장치의 인공신경망 구조를 개략적으 로 나타내는 개념도이다. 도 8은 일 실시예에 따른 비교 학습을 이용한 병변 등급 진단 장치의 개략적인 구성을 나타내는 구성도이다. 도 9는 일 실시예의 변형에 따른 비교 학습을 이용한 병변 등급 진단 장치의 개략적인 구성을 나타내는 구성도 이다. 도 10은 일 실시예의 변형에 따른 비교 학습을 이용한 병변 등급 진단 장치의 인공신경망 구조를 개략적으로 나 타내는 개념도이다. 도 11은 일 실시예의 다른 변형에 따른 비교 학습을 이용한 병변 등급 진단 장치의 개략적인 구성을 나타내는 구성도이다. 도 12는 일 실시예의 다른 변형에 따른 비교 학습을 이용한 병변 등급 진단 장치의 인공신경망 구조를 개략적으 로 나타내는 개념도이다. 도 13은 일 실시예의 또 다른 변형에 따른 비교 학습을 이용한 병변 등급 진단 장치의 개략적인 구성을 나타내 는 구성도이다. 도 14는 일 실시예에 따른 비교 학습을 이용한 병변 등급 진단 방법을 개략적으로 나타내는 순서도이다."}
