{"patent_id": "10-2022-0113547", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2023-0049546", "출원번호": "10-2022-0113547", "발명의 명칭": "피처 맵 인코딩/디코딩을 위한 방법, 장치 및 기록매체", "출원인": "한국전자통신연구원", "발명자": "김연희"}}
{"patent_id": "10-2022-0113547", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "입력 영상을 사용하여 복수의 피처 맵을 생성하는 단계;변환 벡터를 이용하여 상기 피처 맵을 변환하는 단계; 및상기 피처 맵, 상기 피처 맵의 변환 계수 또는 상기 변환 벡터 중 적어도 어느 하나에 대한 인코딩을 수행함으로써 비트스트림을 생성하는 단계;를 포함하는 인코딩 방법."}
{"patent_id": "10-2022-0113547", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "청구항 1에 있어서,상기 비트스트림을 생성하는 단계는상기 피처 맵, 상기 피처 맵의 변환 계수 또는 상기 변환 벡터 중 적어도 어느 하나를 패킹하는 단계를 포함하는 것을 특징으로 하는 인코딩 방법."}
{"patent_id": "10-2022-0113547", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "청구항 1에 있어서,상기 복수의 피처 맵을 생성하는 단계는복수의 레이어로 구성된 인공 신경망 구조를 이용하는 것을 특징으로 하는 인코딩 방법."}
{"patent_id": "10-2022-0113547", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "청구항 3에 있어서,상기 복수의 피처 맵을 생성하는 단계는상기 복수의 레이어에 상응하는 피처 맵 중 일부 피처 맵을 추출하는 것을 특징으로 하는 인코딩 방법."}
{"patent_id": "10-2022-0113547", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "청구항 1에 있어서,상기 복수의 피처 맵을 생성하는 단계는예측 피처 맵과 원본 피처 맵의 차분 피처 맵을 생성하는 것을 특징으로 하는 인코딩 방법."}
{"patent_id": "10-2022-0113547", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "청구항 1에 있어서,상기 피처 맵을 변환하는 단계는하나 이상의 변환 단위를 포함하는 변환 단위 그룹을 구성하는 단계를 포함하고,상기 변환 단위는 상기 피처 맵의 서브 피처 맵에 상응하는 것을 특징으로 하는 인코딩 방법."}
{"patent_id": "10-2022-0113547", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "청구항 6에 있어서,상기 변환 벡터는공개특허 10-2023-0049546-3-변환 단위 그룹에 상응하도록 설정되는 것을 특징으로 하는 인코딩 방법."}
{"patent_id": "10-2022-0113547", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "청구항 7에 있어서,상기 피처 맵을 변환하는 단계는상기 변환 벡터와 상기 변환 단위의 크기가 다른 경우 상기 변환 단위를 다운 샘플링 또는 업샘플링하는 단계를포함하는 것을 특징으로 하는 인코딩 방법."}
{"patent_id": "10-2022-0113547", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "비트스트림에 대한 디코딩을 수행함으로써 피처 맵, 상기 피처 맵의 변환 계수 또는 변환 벡터 중 적어도 어느하나에 대한 정보를 복원하는 단계;상기 복원된 변환 벡터를 이용하여 상기 변환 계수를 역변환하는 단계; 및역변환된 피처 맵을 이용하여 복수의 피처 맵을 복원하는 단계;를 포함하는 것을 특징으로 하는 디코딩 방법."}
{"patent_id": "10-2022-0113547", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "청구항 9에 있어서,상기 정보를 복원하는 단계는상기 비트스트림 내 데이터 그룹을 분리 및 역정렬하는 단계를 포함하는 것을 특징으로 하는 디코딩 방법."}
{"patent_id": "10-2022-0113547", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "청구항 9에 있어서,상기 복수의 피처 맵을 복원하는 단계는복수의 레이어로 구성된 인공 신경망 구조를 이용하는 것을 특징으로 하는 디코딩 방법."}
{"patent_id": "10-2022-0113547", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "청구항 11에 있어서,상기 복수의 피처 맵을 복원하는 단계는상기 역변환된 피처 맵을 이용하여 다른 피처 맵을 복원하는 것을 특징으로 하는 디코딩 방법."}
{"patent_id": "10-2022-0113547", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "청구항 9에 있어서,상기 피처 맵은예측 피처 맵과 원본 피처 맵의 차분 피처 맵에 상응하는 것을 특징으로 하는 디코딩 방법."}
{"patent_id": "10-2022-0113547", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_14", "content": "청구항 9에 있어서,상기 변환 계수를 역변환하는 단계는하나 이상의 변환 단위를 포함하는 변환 단위 그룹을 각각 역변환하고, 상기 변환 단위는 상기 피처 맵의 서브 피처 맵에 상응하는 것을 특징으로 하는 디코딩 방법."}
{"patent_id": "10-2022-0113547", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_15", "content": "청구항 14에 있어서,공개특허 10-2023-0049546-4-상기 변환 벡터는변환 단위 그룹에 상응하도록 설정되는 것을 특징으로 하는 디코딩 방법."}
{"patent_id": "10-2022-0113547", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_16", "content": "청구항 12에 있어서,상기 복수의 피처 맵을 복원하는 단계는 상기 역변환된 피처 맵을 업샘플링 또는 다운샘플링하여 다른 피처 맵을 복원하는 것을 특징으로 하는 디코딩방법."}
{"patent_id": "10-2022-0113547", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_17", "content": "청구항 12에 있어서,상기 복수의 피처 맵을 복원하는 단계는 상기 역변환된 피처 맵에 합성곱 연산을 수행한 결과와 잔차 피처 맵을 이용하여 다른 피처 맵을 복원하는 것을특징으로 하는 디코딩 방법."}
{"patent_id": "10-2022-0113547", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_18", "content": "비트스트림을 저장하는 컴퓨터 판독 가능한 기록매체에 있어서, 상기 비트스트림은,피처 맵의 변환 계수 및 변환 벡터를 포함하고,상기 변환 벡터를 이용하여 상기 변환 계수를 역변환하고,역변환된 피처 맵을 이용하여 다른 피처 맵을 복원하고,상기 변환 벡터는 변환 단위 그룹에 상응하도록 설정되고,상기 변환 단위 그룹은 하나 이상의 변환 단위를 포함하는 것을 특징으로 하는 컴퓨터 판독 가능한 기록매체."}
{"patent_id": "10-2022-0113547", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명의 일 실시예에 따른 인코딩 방법은 입력 영상을 사용하여 복수의 피처 맵을 생성하는 단계, 변환 벡터를 이용하여 상기 피처 맵을 변환하는 단계 및 상기 피처 맵, 상기 피처 맵의 변환 계수 또는 상기 변환 벡터 중 적 어도 어느 하나에 대한 엔트로피 인코딩을 수행함으로써 비트스트림을 생성하는 단계를 포함한다."}
{"patent_id": "10-2022-0113547", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 영상 인코딩/디코딩을 위한 방법, 장치 및 기록 매체에 관한 것이다. 구체적으로, 본 발명은 머신 태 스크 수행을 위한 피처 맵 인코딩/디코딩을 위한 방법, 장치 및 기록 매체에 관한 것이다."}
{"patent_id": "10-2022-0113547", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "기계를 위한 비디오 코딩(Video Coding for Machine; VCM)의 부호화기는 입력 영상 정보 또는 입력 영상 정보로 부터 추출된 피처 맵 정보를 부호화하고, 부호화된 입력 영상 정보 또는 부호화된 피처 맵 정보를 전송한다. VCM의 복호화기는 영상 정보 또는 피처 맵 정보에 대한 비트스트림을 입력으로서 수신하고, 입력된 비트스트림 을 사용하여 복원된 영상 정보를 출력한다. 또한, 복호화기는 입력된 비트스트림을 사용하여 복원된 피처 맵 정 보를 이용하여 응용(application)에 따른 한 개 또는 다수 개의 태스크(task)들을 수행한다. 선행기술문헌 특허문헌 (특허문헌 0001) 국내 공개특허공보 제10-2021-0062346호(발명의 명칭: 인공지능노드 및 그것의 특징맵 압축 방"}
{"patent_id": "10-2022-0113547", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 2, "content": "법) 발명의 내용"}
{"patent_id": "10-2022-0113547", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명의 목적은 머신 태스크 수행을 위한 피처 맵 인코딩/디코딩을 위한 방법, 장치 및 기록 매체를 제공하는 것이다. 또한, 본 발명의 목적은 피처 맵의 전송량 또는 기저 벡터의 전송량을 줄여 부호화 및 복호화 효율을 향상하는 것이다."}
{"patent_id": "10-2022-0113547", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "상기한 목적을 달성하기 위한 본 발명의 일 실시예에 따른 인코딩 방법은 입력 영상을 사용하여 복수의 피처 맵 을 생성하는 단계, 변환 벡터를 이용하여 상기 피처 맵을 변환하는 단계 및 상기 피처 맵, 상기 피처 맵의 변환 계수 또는 상기 변환 벡터 중 적어도 어느 하나에 대한 엔트로피 인코딩을 수행함으로써 비트스트림을 생성하는 단계를 포함한다. 이때, 상기 비트스트림을 생성하는 단계는 상기 피처 맵, 상기 피처 맵의 변환 계수 또는 상기 변환 벡터 중 적 어도 어느 하나를 패킹하는 단계를 포함할 수 있다. 이때, 상기 복수의 피처 맵을 생성하는 단계는 복수의 레이어로 구성된 인공 신경망 구조를 이용할 수 있다. 이때, 상기 복수의 피처 맵을 생성하는 단계는 상기 복수의 레이어에 상응하는 피처 맵 중 일부 피처 맵을 추출 할 수 있다. 이때, 상기 복수의 피처 맵을 생성하는 단계는 예측 피처 맵과 원본 피처 맵의 차분 피처 맵을 생성할 수 있다. 이때, 상기 피처 맵을 변환하는 단계는 하나 이상의 변환 단위를 포함하는 변환 단위 그룹을 구성하는 단계를 포함하고, 상기 변환 단위는 상기 피처 맵의 서브 피처 맵에 상응할 수 있다. 이때, 상기 변환 벡터는 변환 단위 그룹에 상응하도록 설정될 수 있다. 이때, 상기 피처 맵을 변환하는 단계는 상기 변환 벡터와 상기 변환 단위의 크기가 다른 경우 상기 변환 단위를 다운 샘플링 또는 업샘플링하는 단계를 포함할 수 있다. 또한, 상기한 목적을 달성하기 위한 본 발명의 일 실시예에 따른 디코딩 방법은 비트스트림에 대한 엔트로피 디 코딩을 수행함으로써 피처 맵, 상기 피처 맵의 변환 계수 또는 변환 벡터 중 적어도 어느 하나에 대한 정보를 복원하는 단계, 상기 복원된 변환 벡터를 이용하여 상기 변환 계수를 역변환하는 단계 및 역변환된 피처 맵을 이용하여 복수의 피처 맵을 복원하는 단계를 포함한다. 이때, 상기 정보를 복원하는 단계는 상기 비트스트림 내 데이터 그룹을 분리 및 역정렬하는 단계를 포함할 수 있다. 이때, 상기 복수의 피처 맵을 복원하는 단계는 복수의 레이어로 구성된 인공 신경망 구조를 이용할 수 있다. 이때, 상기 복수의 피처 맵을 복원하는 단계는 상기 역변환된 피처 맵을 이용하여 다른 피처 맵을 복원할 수 있 다. 이때, 상기 피처 맵은 예측 피처 맵과 원본 피처 맵의 차분 피처 맵에 상응할 수 있다. 이때, 상기 변환 계수를 역변환하는 단계는 하나 이상의 변환 단위를 포함하는 변환 단위 그룹을 각각 역변환하 고, 상기 변환 단위는 상기 피처 맵의 서브 피처 맵에 상응할 수 있다. 이때, 상기 변환 벡터는 변환 단위 그룹에 상응하도록 설정될 수 있다. 이때, 상기 복수의 피처 맵을 복원하는 단계는 상기 역변환된 피처 맵을 업샘플링 또는 다운샘플링하여 다른 피 처 맵을 복원할 수 있다. 이때, 상기 복수의 피처 맵을 복원하는 단계는 상기 역변환된 피처 맵에 합성곱 연산을 수행한 결과와 잔차 피 처 맵을 이용하여 다른 피처 맵을 복원할 수 있다. 또한, 상기한 목적을 달성하기 위한 본 발명의 일 실시예에 따른 비트스트림을 저장하는 컴퓨터 판독 가능한 기 록매체에 있어서, 상기 비트스트림은 피처 맵의 변환 계수 및 변환 벡터를 포함하고, 상기 변환 벡터를 이용하 여 상기 변환 계수를 역변환하고, 역변환된 피처 맵을 이용하여 다른 피처 맵을 복원하고, 상기 변환 벡터는 변 환 단위 그룹에 상응하도록 설정되고, 상기 변환 단위 그룹은 하나 이상의 변환 단위를 포함한다."}
{"patent_id": "10-2022-0113547", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명에 따르면, 머신 태스크 수행을 위한 피처 맵 인코딩/디코딩을 위한 방법, 장치 및 기록 매체를 제공할 수 있다. 또한, 본 발명은 피처 맵의 전송량 또는 기저 벡터의 전송량을 줄여 부호화 및 복호화 효율을 향상할 수 있다."}
{"patent_id": "10-2022-0113547", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "본 발명의 이점 및 특징, 그리고 그것들을 달성하는 방법은 첨부되는 도면과 함께 상세하게 후술되어 있는 실시 예들을 참조하면 명확해질 것이다. 그러나 본 발명은 이하에서 개시되는 실시예들에 한정되는 것이 아니라 서로 다른 다양한 형태로 구현될 것이며, 단지 본 실시예들은 본 발명의 개시가 완전하도록 하며, 본 발명이 속하는"}
{"patent_id": "10-2022-0113547", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "기술분야에서 통상의 지식을 가진 자에게 발명의 범주를 완전하게 알려주기 위해 제공되는 것이며, 본 발명은 청구항의 범주에 의해 정의될 뿐이다. 명세서 전체에 걸쳐 동일 참조 부호는 동일 구성 요소를 지칭한다. 비록 \"제1\" 또는 \"제2\" 등이 다양한 구성요소를 서술하기 위해서 사용되나, 이러한 구성요소는 상기와 같은 용 어에 의해 제한되지 않는다. 상기와 같은 용어는 단지 하나의 구성요소를 다른 구성요소와 구별하기 위하여 사 용될 수 있다. 따라서, 이하에서 언급되는 제1 구성요소는 본 발명의 기술적 사상 내에서 제2 구성요소일 수도 있다. 본 명세서에서 사용된 용어는 실시예를 설명하기 위한 것이며 본 발명을 제한하고자 하는 것은 아니다. 본 명세 서에서, 단수형은 문구에서 특별히 언급하지 않는 한 복수형도 포함한다. 명세서에서 사용되는 \"포함한다 (comprises)\" 또는 \"포함하는(comprising)\"은 언급된 구성요소 또는 단계가 하나 이상의 다른 구성요소 또는 단 계의 존재 또는 추가를 배제하지 않는다는 의미를 내포한다. 본 명세서에서, \"A 또는 B\", \"A 및 B 중 적어도 하나\", \"A 또는 B 중 적어도 하나\", \"A, B 또는 C\", \"A, B 및 C 중 적어도 하나\", 및 \"A, B, 또는 C 중 적어도 하나\"와 같은 문구들 각각은 그 문구들 중 해당하는 문구에 함 께 나열된 항목들 중 어느 하나, 또는 그들의 모든 가능한 조합을 포함할 수 있다."}
{"patent_id": "10-2022-0113547", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "다른 정의가 없다면, 본 명세서에서 사용되는 모든 용어는 본 발명이 속하는 기술분야에서 통상의 지식을 가진 자에게 공통적으로 이해될 수 있는 의미로 해석될 수 있다. 또한, 일반적으로 사용되는 사전에 정의되어 있는 용어들은 명백하게 특별히 정의되어 있지 않는 한 이상적으로 또는 과도하게 해석되지 않는다. 이하, 첨부된 도면을 참조하여 본 발명의 실시예들을 상세히 설명하기로 하며, 도면을 참조하여 설명할 때 동일 하거나 대응하는 구성 요소는 동일한 도면 부호를 부여하고 이에 대한 중복되는 설명은 생략하기로 한다. 본 발명의 일 실시예에 따른 피처 맵 부호화 시스템은 피처 맵에 변환, 양자화, 패킹 등의 전처리 과정과 부호 화를 수행하여 비트스트림을 출력할 수 있다. 또한, 실시예에 따른 피처 맵 복호화 시스템은 비트스트림에 복호 화, 역패킹, 역양자화, 역변환 등을 수행하여 피처 맵을 복원할 수 있다. 피처 맵 변환 및 역변환 과정에서, 크기가 서로 다른 다수 개의 변환 단위들이 하나의 기저 벡터 셋을 공유할 수 있다. 부호화/복호화 과정에서, 피처 맵 정보를 그룹핑한 데이터 그룹 단위로 서로 다른 종류의 부/복호화기가 수행될 수 있다. 피처 맵 복원 과정이 완료된 후, 복원된 피처 맵을 사용하여 동일한 또는 이전 레이어의 피처 맵을 예측할 수 있다. 본 발명은 기존의 피처 맵 압축 기술들 대비 피처 맵의 전송량, 또는 변환을 수행할 경우 기저 벡터의 전송량을 효과적으로 감축시키되 머신 태스크 성능은 유지하여 압축 성능을 향상시키는 것을 목적으로 한다. 본 발명은 아래와 같은 효과가 있다. 본 발명의 일 실시예에 따른 방법의 변환 단계에서, 목표하는 변환 성능과 변환 벡터 데이터량의 측면에서 최적 인 변환 벡터 공유 단위를 입력 이미지마다 조정할 수 있다. 본 발명의 일 실시예에 따른 방법은 피처 맵 또는 변환된 도메인에서 부호화를 수행할 수 있고, 서로 다른 종류 의 데이터의 특성에 최적인 부호화기를 암시적 또는 명시적으로 선택하여 부호화 효율을 향상시킬 수 있다. 본 발명의 일 실시예에 따른 방법은 부호화기 측에서 목표하는 성능 및 비트율에 최적인 피처 맵을 선택하여 부 호화할 수 있다. 또한 복호화 이후 피처 맵 분석 과정을 수행하기 위해 필요한 피처 맵들 중 일부를 전송하지 않고 복호화된 피처 맵들로 예측함으로써, 피처 맵의 전송량을 감축할 수 있다. 도 1은 본 발명의 일 실시예에 따른 인코딩 방법을 나타낸 흐름도이다. 본 발명의 일 실시예에 따른 인코딩 방법은 컴퓨팅 디바이스와 같은 인코딩 장치에서 수행될 수 있다. 도 1을 참조하면, 본 발명의 일 실시예에 따른 인코딩 방법은 입력 영상을 사용하여 복수의 피처 맵을 생성하는 단계(S110), 변환 벡터를 이용하여 상기 피처 맵을 변환하는 단계(S120) 및 상기 피처 맵, 상기 피처 맵의 변환 계수 또는 상기 변환 벡터 중 적어도 어느 하나에 대한 엔트로피 인코딩을 수행함으로써 비트스트림을 생성하는 단계(S130)를 포함한다. 이때, 상기 비트스트림을 생성하는 단계(S130)는 상기 피처 맵, 상기 피처 맵의 변환 계수 또는 상기 변환 벡터 중 적어도 어느 하나를 패킹하는 단계를 포함할 수 있다. 이때, 상기 복수의 피처 맵을 생성하는 단계(S110)는 복수의 레이어로 구성된 인공 신경망 구조를 이용할 수 있 다. 이때, 상기 복수의 피처 맵을 생성하는 단계(S110)는 상기 복수의 레이어에 상응하는 피처 맵 중 일부 피처 맵 을 추출할 수 있다. 이때, 상기 복수의 피처 맵을 생성하는 단계(S110)는 예측 피처 맵과 원본 피처 맵의 차분 피처 맵을 생성할 수 있다. 이때, 상기 피처 맵을 변환하는 단계(S120)는 하나 이상의 변환 단위를 포함하는 변환 단위 그룹을 구성하는 단 계를 포함하고, 상기 변환 단위는 상기 피처 맵의 서브 피처 맵에 상응할 수 있다. 이때, 상기 변환 벡터는 변환 단위 그룹에 상응하도록 설정될 수 있다. 이때, 상기 피처 맵을 변환하는 단계(S120)는 상기 변환 벡터와 상기 변환 단위의 크기가 다른 경우 상기 변환 단위를 다운 샘플링 또는 업샘플링하는 단계를 포함할 수 있다. 도 2는 본 발명의 일 실시예에 따른 디코딩 방법을 나타낸 흐름도이다. 본 발명의 일 실시예에 따른 디코딩 방법은 컴퓨팅 디바이스와 같은 디코딩 장치에서 수행될 수 있다. 도 2를 참조하면, 본 발명의 일 실시예에 따른 디코딩 방법은 비트스트림에 대한 엔트로피 디코딩을 수행함으로 써 피처 맵, 상기 피처 맵의 변환 계수 또는 변환 벡터 중 적어도 어느 하나에 대한 정보를 복원하는 단계 (S210), 상기 복원된 변환 벡터를 이용하여 상기 변환 계수를 역변환하는 단계(S220) 및 역변환된 피처 맵을 이 용하여 복수의 피처 맵을 복원하는 단계(S230)를 포함한다. 이때, 상기 정보를 복원하는 단계(S210)는 상기 비트스트림 내 데이터 그룹을 분리 및 역정렬하는 단계를 포함 할 수 있다. 이때, 상기 복수의 피처 맵을 복원하는 단계(S210)는 복수의 레이어로 구성된 인공 신경망 구조를 이용할 수 있 다. 이때, 상기 복수의 피처 맵을 복원하는 단계(S210)는 상기 역변환된 피처 맵을 이용하여 다른 피처 맵을 복원할 수 있다. 이때, 상기 피처 맵은 예측 피처 맵과 원본 피처 맵의 차분 피처 맵에 상응할 수 있다. 이때, 상기 변환 계수를 역변환하는 단계(S220)는 하나 이상의 변환 단위를 포함하는 변환 단위 그룹을 각각 역 변환하고, 상기 변환 단위는 상기 피처 맵의 서브 피처 맵에 상응할 수 있다. 이때, 상기 변환 벡터는 변환 단위 그룹에 상응하도록 설정될 수 있다. 이때, 상기 복수의 피처 맵을 복원하는 단계(S130)는 상기 역변환된 피처 맵을 업샘플링 또는 다운샘플링하여 다른 피처 맵을 복원할 수 있다. 이때, 상기 복수의 피처 맵을 복원하는 단계(S130)는 상기 역변환된 피처 맵에 합성곱 연산을 수행한 결과와 잔 차 피처 맵을 이용하여 다른 피처 맵을 복원할 수 있다. 이하, 도 3 내지 도 13을 참조하여, 본 발명의 일 실시예에 따른 부호화 방법에 대하여 상세히 설명한다. 도 3은 본 발명의 일 실시예에 따른 부호화 과정을 개념적으로 나타낸 도면이다. 도 3을 참조하면, 영상 또는 이미지로부터 피처 맵을 추출하고 압축하여 한 개 또는 다수 개의 비트스트림을 생 성하는 과정을 확인할 수 있다. 실시예에 따른 부호화 장치는 피처 맵 추출기, 피처 맵 차분기, 피처 맵 변환기(S130), 피처 맵 정보 양자화기, 피처 맵 정보 패킹 수행기, 피처 맵 정보 부호화기 등의 모듈(단계)로 구성될 수 있고, 각 단계는 생략되거나 순서가 서로 변경될 수 있다. 후술하겠지만, 복호화 기에서는 부호화된 피처 맵 (또는 이미지/비디오) 비트스트림을 전송받아, 피처 맵 데이터를 복호화 과정을 통 해 복원될 수 있으며, 상기 복원된 피처 맵(또는 이미지/비디오)이 도 14의 피처 맵 분석기로 입력되어 최 종 분석 결과가 도출될 수 있다. 도 3의 피처 맵 추출기는, 이미지 또는 비디오를 입력받아 뉴럴 네트워크의 일부를 수행하여 한 개 또는 다수 개의 피처 맵을 출력할 수 있다. 이때, 상기 뉴럴 네트워크는 피처 맵 추출부와 피처 맵 분석부로 구성될 수 있다. 피처 맵 추출부는 한 개 또는 다수 개의 레이어로 구성되어 한 개 또는 다수 개의 피처 맵이 출력될 수 있고 동일한 뉴럴 네트워크를 사용하 더라도 실시 예에 따라 다르게 결정될 수 있다. 도 4는 피처 맵 추출부의 구조를 예시적으로 나타낸 도면이다. 도 4를 참조하면, 피처 맵 추출부는 다수 개의 레이어로 구성될 수 있다. 예를 들어, 피처 맵 추출부는 피처 피 라미드 네트워크 구조 또는 다수 개의 합성곱 레이어가 결합된 구조에 상응할 수 있다. 도 4에서 피처 맵 이름의 앞 문자(알파벳)는 피라미드 구조에서의 레이어를 나타내며, 문자 뒤의 숫자는 피라미 드 구조의 레벨을 나타낼 수 있다. 예를 들어, R2, R3, R4, R5는 피라미드 구조의 동일한 레이어에서 서로 다른 레벨의 피처 맵들에 상응할 수 있다. 예를 들어, R2, C2, M2, P2는 피라미드 구조의 동일한 레벨에서 서로 다른 레이어의 피처 맵들에 상응할 수 있다. 뉴럴 네트워크의 피처 맵 추출부의 최종 출력 피처 맵 또는 중간 출력 피처 맵을 한 개 또는 다수 개를 선택하여 피처 맵 추출기에서 출력할 수 있다. 피처 맵 추출부의 특정 한 레이 어의 모든 레벨의 피처 맵들을 출력할 수 있고, 또는 다수 개의 레이어에서 중복되지 않는 레벨의 피처 맵들을 출력할 수 있다. 예를 들어, 피처 맵 추출부가 도 4와 같은 경우 (P2, P3, P4, P5), (C2, C3, C4, P5), (C2, C3, C4) 등의 조합으로 피처 맵이 피처 맵 추출기에서 출력될 수 있다. 이때, 한 개의 입력 이미지에 대하여 추출된 피처 맵의 개수(number_of_coded_FM)와 피처 맵 인덱스(FM_idx)가 피처 맵 파라미터 셋(featuremap_parameter_set)에서 전송될 수 있다. 상기 피처 맵 파라미터 셋은 도 3의 입력 이미지 또는 영상 단위로 전송될 수 있다. 도 5는 피처 맵 차분기의 구조를 예시적으로 나타낸 도면이다. 도 5를 참조하면, 피처 맵 차분기는 피처 맵 예측부 및 피처 맵 차분부를 포함할 수 있다. 피처 맵 차분기는 피처 맵 추출기에서 추출된 피처 맵의 차분 피처 맵을 도출할 수 있다. 차분 피처 맵이 도출된 피처 맵은 이후 단계에서 원본 피처 맵이 아닌 차분 피처 맵이 부호화되어 전송될 수 있다. 피처 맵에 대하여 원본 피처 맵이 전송되는지 차분 피처 맵이 전송되는지를 의미하는 플래그(is_residual_coded)가 피처 맵 헤더(featuremap_header)에서 전송될 수 있다. 피처 맵 예측부에서는 피처 맵 추출부에서 추출된 피처 맵의 예측 피처 맵을 생성할 수 있다. 실시 예에 따라 상기 순서는 변경될 수 있으며, 일부 과정이 생략될 수 있다. 예측 피처 맵을 생성하기 위하여 한 개 이상 의 합성곱 레이어를 통해 합성곱 연산을 수행할 수 있다. 도 6은 차분 피처 맵 생성 과정을 예시적으로 나타낸다. 도 6을 참조하면, 피처 맵 추출기에서 추출된 피처 맵들 중에서 임의의 피처 맵에 대하여 차분 피처 맵을 생성 하는 것을 볼 수 있다. 도 6의 예시에서는 복원된 피처 맵 P5를 이용하여 피처 맵 M5의 예측 피처 맵을 생성할 수 있다. 피처 맵 차분부에서는, 피처 맵과 예측 피처 맵을 이용하여 차분 피처 맵을 도출할 수 있고, 차분 피처 맵 은 이후에 부호화되어 전송될 수 있다. 예를 들어, 도 6과 같이 M5와 M5의 예측 피처 맵의 차분 피처 맵을 도 출할 수 있고, 이는 이후의 과정들을 통해 부호화된 후 전송될 수 있다. 도 7은 피처 맵 변환기의 구조를 예시적으로 나타낸 도면이다. 피처 맵 변환기는, 피처 맵 추출기에서 추출된 피처 맵 또는 피처 맵 차분기에서 생성된 잔차 피처 맵에 대하여 변환을 수행할 수 있다. 도 7을 참조하면, 피처 맵 변환기는 변환 벡터 도출부 및 변환부를 포함할 수 있다. 즉, 피처 맵 변 환기는 변환 단위에 대하여 변환 벡터 도출이 수행된 후 변환 단위에 대한 변환이 수행될 수 있다. 실시예 에 따라 상기 순서는 변경될 수 있으며, 일부 과정이 생략될 수 있다. 이때, 상기 변환 단위는 피처 맵의 한 채널 (W×H) 또는 1이상 정수 n, m에 대하여 (W/n×H/m)의 크기를 갖는 서브 피처 맵일 수 있다. 상기 서브 피처 맵은 피처 맵을 분할한 것일 수 있다. 도 8은 일 실시예에 따른 변환 단위와 변환 단위 그룹을 나타낸다. 변환 단위와 변환 단위 그룹은 도 8과 같을 수 있다. 변환 단위 그룹 내 모든 변환 단위는 동일한 변환 벡터 셋 (다수 개의 변환 벡터)을 이용하여 변환이 수행될 수 있다. 변환 단위 그룹은 한 개 또는 다수 개의 피처 맵에 포함된 변환 단위들로 구성될 수 있다. 변환을 수행하는 피처 맵에 대하여 변환 벡터 도출과 변환이 수행될 수있다. 피처 맵 단위로 변환 수행 여부를 선택할 수 있고 해당 플래그(is_transformed)가 피처 맵 헤더 (featuremap_header)에서 전송될 수 있다. 각 변환 단위 그룹에 대하여 변환 단위 그룹 헤더(TUG_header)와 변환 벡터 셋 정보가 전송될 수 있다. 변환 단 위 그룹 헤더에는 그룹 인덱스(TUG_idx)와, 변환 벡터의 크기(basis_vector_size_idx)와 개수 (num_of_basis_vector)가 전송될 수 있다. 변환 단위 그룹에 속한 피처 맵의 개수(num_of_belongedFM)와 각 인 덱스(FM_idx)가 전송될 수 있다. 각 피처 맵에 대하여 변환이 수행된 경우, 피처 맵 헤더(featuremap_header)에서 변환 유닛의 크기 (feature_TU_size_idx)와 피처 맵이 속한 변환 유닛 그룹의 인덱스(TUG_idx)를 전송할 수 있다. 변환 계수가 전 송되는지 여부(has_coefficient)가 전송될 수 있고, 플래그에 따라서 변환 계수가 부호화되고 전송될 수 있다. 변환 벡터 도출부는 아래와 같은 동작을 수행할 수 있다. 변환 벡터 도출부는 하나의 변환 단위 그룹에 대하여 하나의 변환 벡터 셋(다수 개의 변환 벡터)을 도출할 수 있다. 변환 벡터 셋은 부/복호화기에서 동일하게 약속으로 결정한 다수 개의 변환 벡터 셋에서 선택하거나 또는 현재 변환 단위 그룹 내 변환 단위들에 최적인 변환 벡터 셋을 계산하여 도출할 수 있다. 부/복호화기에서 동일하게 약속으로 결정한 변환 벡터 셋에서 변환 벡터 셋을 선택하며 하나 또는 다수 개의 변 환 단위에 대하여 변환 벡터 셋이 다수 개인 경우, 변환 벡터 셋에 대한 인덱스와 변환 벡터 셋 내의 변환 벡터 에 대한 인덱스를 부호화기에서 시그널링할 수 있다. 부/복호화기에서 동일하게 약속으로 결정한 변환 벡터 셋에서 변환 벡터 셋을 선택하며 하나 또는 다수 개의 변 환 단위에 대하여 변환 벡터 셋이 고정된 경우, 변환 벡터 셋 내의 변환 벡터에 대한 인덱스를 부호화기에서 시 그널링할 수 있다. 부/복호화기에서 동일하게 약속으로 결정한 변환 벡터 셋에서 변환 벡터 셋을 선택한 경우, 파싱한 인덱스를 통 해 변환 벡터 셋을 선택하여 변환부에 사용할 수 있다. 현재 변환 단위의 변환 벡터를 도출하는 경우, 일 실시예에 따라 PCA 등의 방법을 이용하여 변환 단위 그룹 내 일부 또는 모든 변환 단위를 이용하여 변환 단위 그룹에 대한 최적의 변환 벡터를 도출할 수 있다 이때, 변환 단위 그룹 내 서로 다른 크기의 변환 단위가 존재하는 경우, 크기가 큰 또는 작은 변환 단위의 크기 로 다운샘플링 또는 업샘플링을 수행하여 모든 변환 단위의 크기를 동일하게 설정한 후, 이를 이용하여 변환 벡 터를 도출할 수 있다. 변환부는 아래와 같은 동작을 수행할 수 있다. 변환부는 변환 벡터 도출부에서 도출된 변환 벡터를 이용하여 변환 단위에 대하여 변환을 수행할 수 있다. 실시 예에 따라, 변환 단위 그룹 내 모든 변환 단위는 동일한 변환 벡터를 이용하여 변환이 수행될 수 있 다. 도출된 변환 벡터의 크기와 변환 단위의 크기가 다를 경우 변환 벡터의 크기를 변환 단위 크기와 동일하게 설정 하기 위하여 업샘플링 또는 다운샘플링을 수행할 수 있다. 도 9 내지 도 12는 변환 단위와 변환 단위 그룹에 따른 변환 벡터 도출부 및 변환부의 입출력 예시이다. 도 9는 서로 다른 해상도를 갖는 각 피처 맵의 채널이 변환 단위이고, 각 피처 맵이 독립적인 변환 단위 그룹을 사용하는 예시이다. 이때, 각 피처 맵이 변환 벡터 도출부로 입력되어 다수 개의 변환 벡터가 도출될 수 있다. 변환부에서는 각 채널에 대하여 동일한 변환 벡터 셋을 이용하여 변환을 수행하여 변환 계수를 출력할 수 있다. 도 10은 서로 다른 해상도를 갖는 각 피처 맵의 채널이 변환 단위이고, 각 변환 단위 그룹에 서로 다른 해상도 를 갖는 한 개 또는 다수 개의 피처 맵의 채널이 포함될 수 있는 예시이다. 예를 들어, P2는 전송되지 않는 피 처 맵이지만 (P2, P3)가 변환 단위 그룹일 수 있고, P3의 변환 벡터를 도출하기 위하여 P2 내 변환 단위가 함께 사용될 수 있다. 변환 벡터 도출 이전에 P2에 대하여 P3 크기로 다운샘플링을 수행할 수 있다. 도 11은 도 10과 같이 서로 다른 해상도를 갖는 각 피처 맵의 채널이 변환 단위이고, 변환 단위 그룹에 한 개 또는 다수 개의 피처 맵의 채널이 포함될 수 있는 예시이다. (P2, P3)가 변환 단위 그룹이고, P2가 P3의 크기로 다운샘플링되어 변환 벡터가 유도된다. P3 내 채널들에 대해서는 유도된 변환 벡터를 이용하여 변환을수행하고, P2 내 채널들에 대해서는 유도된 변환 벡터를 P2의 채널 크기로 업샘플링한 후 변환을 수행한다. 도 11는 도 10과 같이 서로 다른 해상도를 갖는 각 피처 맵의 채널이 변환단위이고, 변환 단위 그룹에 한 개 또 는 다수 개의 피처 맵의 채널이 포함될 수 있는 예시이다. (P2, P3)가 변환 단위 그룹이고, P3 내 변환 단위만 을 이용하여 변환 벡터를 도출될 수 있다. 도출된 변환 벡터를 그대로 이용하여 P3 내 변환 단위를 변환할 수 있고, 변환 벡터를 업샘플링하여 P2 내 변환 단위를 변환할 수 있다. 피처 맵 양자화기는, 피처 맵, 변환 벡터, 변환 계수 등에 균등 또는 비균등 양자화를 수행할 수 있다. 서 로 다른 종류의 데이터에 대하여 각각 양자화를 수행할 수 있다. 도 13은 피처 맵 정보 패킹 수행기의 구조를 예시적으로 나타낸 도면이다. 도 13을 참조하면, 피처 맵 정보 패킹 수행기는 그룹핑 수행부 및 정렬 수행부를 포함할 수 있 다. 피처 맵 정보 패킹 수행기는, 이미지 또는 영상으로부터 추출된 한 개 이상의 피처 맵 또는 변환 벡터 또 는 변환 계수를 다수 개의 데이터그룹으로 그룹핑하고, 데이터그룹 내에서 정렬 과정을 수행할 수 있다. 이후 단계인 피처 맵 정보 부호화기에서 상기 데이터그룹마다 부호화기 종류를 선택하여 부호화할 수 있고, 데 이터그룹마다 하나의 비트스트림을 생성할 수 있다. 그룹핑 수행부는 다음과 같은 역할을 수행할 수 있다. 한 개 이상의 피처 맵에서 도출된 같은 종류(예를 들어, 피처 맵 또는 기저 벡터 셋 또는 변환 계수)의 데이터를 한 개 이상의 데이터그룹으로 그룹핑할 수 있다. 예를 들어, P2, P3, P4, P5의 변환 계수가 하나의 데이터그룹으로 그룹핑 될 수 있고, TUG0, TUG1, TUG2의 변환 계수가 하나의 데이터그룹으로 그룹핑 될 수 있다. 정렬 수행부는 각 데이터그룹 내의 데이터에 정렬을 수행할 수 있다. 한 개 이상의 피처 맵을 그룹핑 한 데이터그룹의 경우, 특정 피처 맵 순서로 채널 단위로 한 열에 특정 개수만큼 2차원으로 정렬할 수 있다. 한 개 이상의 변환 단위 그룹의 기저 벡터들을 그룹핑 한 데이터그룹의 경우, 특정 변환 단위 그룹의 인덱스 순서대로 기저 벡터를 한 열에 특정 개수만큼 2차원으로 정렬할 수 있다. 한 개 이상의 피처 맵의 변환 계수를 그룹핑 한 데이터 그룹의 경우, 특정 피처 맵의 순서대로 변환 계수를 1차원으로 나열하는 방법으로 정렬을 수행할 수 있 다. 상기 패킹 과정에서의 부가 정보가 데이터그룹 헤더(data_group_header)에서 전송될 수 있다. 한 피처 맵에서 도출된 데이터(피처 맵 또는 변환 계수 또는 기저 벡터 셋) 내에서 정렬을 수행했는지 여부(is_arranged)가 전 송될 수 있다. 정렬을 수행했을 경우 정렬 방법(arranging_method_idx)이 전송될 수 있다. 한 데이터그룹에 그 룹핑된 데이터의 종류(data_type_idx)가 전송될 수 있다. 데이터의 종류가 피처 맵 또는 변환 계수인 경우, 데이터가 도출된 피처 맵의 가짓수 (num_of_data_in_data_group_minus1) 및 각 피처 맵의 인덱스(FM_idx)가 전송될 수 있다. 데이터의 종류가 기 저 벡터 셋일 경우, 기저 벡터 셋이 속한 변환 단위 그룹의 가짓수(num_of_data_in_data_group_minus1) 및 변 환 단위 그룹의 인덱스(TUG_idx)가 전송될 수 있다. 그룹핑 및 정렬된 데이터그룹은 피처 맵 정보 부호화기에 입력될 수 있다. 피처 맵 정보 부호화기는 피처 맵 또는 변환 벡터 또는 변환 계수 등에 대하여 부호화를 수행하여 비트스 트림을 출력할 수 있다. 피처 맵 정보 부호화기는 입력으로 피처 맵 추출기에서 추출된 피처 맵 또는 피처 맵 차분기에서 추출된 차분 피처 맵을 입력 받을 수 있다. 또는 피처 맵 정보 부호화기는 입력으로 피처 맵 또는 차분 피처 맵의 변환 정보인 변환 벡터 또는 변환 계수를 입력 받을 수 있다. 입력된 피처 맵 또는 변환 벡터 또는 변환 계수는 부호화기 종류를 선택할 수 있다. 데이터의 종류(피처 맵, 변 환 벡터, 변환 계수) 또는 피처 맵이 추출된 레이어 또는 레벨의 위치에 따라서 송/수신 기기에서 약속된 부호 화 방법으로 선택되거나, 또는 부호화기에서 데이터의 특성을 분석한 결과를 기반으로 부호화기가 선택되거나, 또는 다수 개의 부호화기를 수행하고 비트-성능 측면에서 최적인 부호화 방법이 선택될 수 있다. 선택된 부호화 기의 종류(codec_type_idx)가 데이터그룹 헤더(data_group_header)에서 전송될 수 있다. 부호화기의 종류에는 뉴럴 네트워크 기반의 부호화기(End-to-End NN), 예측 및 변환 결합구조 부호화기(실시 예 로 VVC, HEVC), 엔트로피 코딩 기반의 부호화기(실시 예로, DeepCABAC) 등이 존재할 수 있다. 뉴럴 네트워크 기 반의 부호화기는 다수 개의 합성곱 레이어 수행부로 구성될 수 있다. 예측 및 변환 결합구조 부호화기는 블록단위의 예측부, 변환부, 양자화부, 엔트로피 코딩부 등의 단계로 구성될 수 있다. 엔트로피 코딩 기반의 부호화 기는 양자화부, 엔트로피 코딩부 등의 단계로 구성될 수 있다. 이하, 도 14 내지 도 18을 참조하여, 본 발명의 일 실시예에 따른 복호화 방법에 대하여 상세히 설명한다. 도 14는 본 발명의 일 실시예에 따른 복호화 과정을 개념적으로 나타낸 도면이다. 도 14를 참조하면, 실시예에 따른 복호화 장치는 피처 맵 정보 복호화기, 피처 맵 정보 분리기, 피처 맵 정보 역양자화기, 피처 맵 역변환기, 피처 맵 생성기, 피처 맵 분석기 등으로 구성될 수 있 으며, 각 단계가 수행되지 않거나 수행 순서가 변경될 수 있다. 이때, 상기 복호화 장치는 수신한 한 개 또는 다수 개의 비트스트림을 복호화하여 피처 맵을 복원하고, 복원된 피처 맵을 이용하여 피처 맵을 분석하여 머신 태스크 분석 결과를 도출할 수 있다. 피처 맵 정보 복호화기는, 전송받은 각 비트스트림에 대하여 복호화를 수행하여 복원된 데이터그룹을 출력 할 수 있다. 데이터그룹 헤더(data_group_header)에서 복호화기 종류의 인덱스(codec_type_idx)를 파싱하고 인 덱스에 대응되는 복호화기를 이용하여 비트스트림 복호화를 수행할 수 있다. 복호화기 종류는 뉴럴 네트워크 기 반의 복호화기(End-to-End NN), 예측 및 변환 결합구조 복호화기(VVC, HEVC), 엔트로피 코딩 기반의 복호화기 (DeepCABAC)일 수 있다. 피처 맵 정보 분리기는, 피처 맵 정보 복호화기에서 복원된 데이터그룹을 패킹되기 전의 형태로 분리 및 역정렬할 수 있다. 피처 맵 정보 복호화기에서 한 비트스트림으로부터 복원된 데이터그룹은 한 개 이상 의 피처 맵 또는 피처 맵에서 추출된 종류가 같은 데이터가 포함되어 있을 수 있다. 예를 들어, P2, P3의 복원된 변환 계수가 하나의 복원된 데이터그룹에 포함될 수 있다. 복호화기의 종류에 따라 서 복원된 데이터그룹은 2차원의 프레임 형태, 또는 1차원의 데이터가 나열된 형태일 수 있다. 데이터그룹 헤더(data_group_header)에서 복원된 데이터그룹을 구성하는 데이터의 종류(data_type_idx), 복원된 데이터그룹이 몇 개의 피처 맵으로부터의 데이터로 구성되었는지를 나타내는 개수 (num_of_data_in_data_group_minus1)를 파싱할 수 있다. 데이터의 종류가 피처 맵 또는 변환 계수일 경우, 복 원된 데이터에 포함된 피처 맵의 인덱스(FM_idx)를 파싱할 수 있다. 복원된 데이터의 종류가 기저 벡터일 경우, 복원된 데이터에 포함된 변환 유닛 그룹의 인덱스(TUG_idx)를 파싱할 수 있다. 복원된 데이터그룹 내 다수 개의 피처 맵으로부터의 데이터가 존재할 경우, 피처 맵의 인덱스 순서대로 데이터 가 존재할 수 있다. 상기 파싱한 정보들, 피처 맵 헤더에서 피처 맵의 채널 크기와 개수, 변환 유닛 그룹 헤더 에서 기저 벡터의 크기와 개수 정보를 이용하여 복원된 데이터그룹을 피처 맵 단위의 데이터로 분리할 수 있다. 예를 들어 P2, P3의 복원된 변환 계수로 구성된 복원된 데이터그룹이 P2, P3 각각의 복원된 변환 계수로 분리될 수 있다. 분리된 각 피처 맵 단위의 복원된 데이터에 역정렬을 수행할 수 있다. 상기 분리된 각 피처 맵 단위의 복원된 데이터는 예를 들어, P2의 변환 계수, TUG1의 기저 벡터 셋, C3 피처 맵 등일 수 있다. 복원된 데이터에 역정렬 이 수행되는지 여부(is_arranged)를 데이터그룹 헤더에서 파싱할 수 있고, 수행될 경우 역정렬 방법 (arranging_method_idx)을 파싱할 수 있다. 파싱된 역정렬 방법에 따라서 복원된 데이터에 역정렬이 수행될 수 있다. 피처 맵 정보 역양자화기는, 피처 맵 정보 복호화기 또는 피처 맵 정보 분리기에서 출력된 복원 된 데이터에 대하여 역양자화를 수행할 수 있다. 피처 맵 역변환기는 복원된 변환 벡터와 복원된 변환 계수를 이용하여 역변환을 수행하여 피처 맵을 복원 할 수 있다. 각 피처 맵의 역변환에 사용할 복원된 변환 벡터는, 피처 맵 헤더(featuremap_header)에서 파싱한 변환 유닛 그 룹 인덱스(TUG_idx)와 동일한 인덱스를 갖는 변환 벡터 셋일 수 있다. 또는 변환 유닛 그룹 헤더(TUG_header)에 서 파싱한 변환 유닛 그룹에 포함된 피처 맵 인덱스(FM_idx)를 통해, 현재 피처 맵이 포함된 변환 유닛 그룹 인 덱스를 유도할 수 있다. 유도한 인덱스를 갖는 변환 유닛 그룹의 변환 벡터 셋을 역변환에 사용할 수 있다. 변환 유닛 그룹 헤더(TUG_header)에서 파싱한 변환 벡터 크기(basis_vector_size_idx)와 피처 맵 헤더 (featuremap_header)에서 파싱한 변환 유닛 크기(feature_TU_size_idx)가 다른 경우, 변환 유닛 크기와 동일하게 변환 벡터를 업샘플링 또는 다운샘플링을 수행한 뒤 역변환을 수행할 수 있다. 도 15 내지 도 16은 서로 다른 입력에 따른 피처 맵 역변환기의 동작 예시이다. 도 15의 예시와 같이, 서로 다른 해상도를 갖는 네 가지의 각 피처 맵이 변환 유닛 그룹인 경우일 수 있다. 각 피처 맵의 피처 맵 역변환기에 해당 피처 맵의 복원된 변환 계수가 입력될 수 있다. 또한, P2, P3, P4, P5 피처 맵이 서로 다른 변환 단위 그룹에 포함되기 때문에, 각 피처 맵 역변환기에 서로 다른 변환 벡터 셋이 입력될 수 있다. 도 16의 예시와 같이, 서로 다른 해상도를 갖는 다수 개의 피처 맵이 하나의 변환 유닛 그룹에 포함된 경우일 수 있다. P2와 P3가 하나의 변환 유닛 그룹에 포함되어 있으므로, 동일한 변환 벡터 셋이 각각 P2와 P3의 피처 맵 역변환기에 입력될 수 있다. 피처 맵 생성기는, 뉴럴 네트워크의 피처 맵 추출부 구조 내의 피처 맵들 중에서 복호화기로 전송되지 않 은 임의의 한 개 또는 다수 개의 피처 맵을 생성할 수 있으며, 생성 과정에서 복원된 피처 맵을 사용할 수 있다. 실시 예에 따라, 피처 맵 생성기에서 생성할 전송받지 않은 피처 맵은 복원된 피처 맵과 동일한, 이전의, 또는 이후의 레이어의 피처 맵일 수 있다. 실시 예에 따라, 임의의 복원된 피처 맵과 동일 레이어의 피처 맵은 복원된 피처 맵을 업샘플링 또는 다운샘플 링하여 생성될 수 있다. 실시 예에 따라, 임의의 복원된 피처 맵의 이전 레이어의 피처 맵은, 복원된 피처 맵으로 이전 레이어의 피처 맵을 예측한 예측 피처 맵과, 전송받은 잔차 피처 맵을 합산하여 생성될 수 있다. 실시 예에 따라, 임의의 복원된 피처 맵의 이후 레이어의 피처 맵은, 복원된 피처 맵 또는 피처 맵 생성기에서 생성한 이전 레이어 피처 맵을 함께 이용하여 부호화기 측 뉴럴 네트워크의 피처 맵 추출부의 남은 추출 과정과 동일한 과정을 수행하여 생성될 수 있다. 도 17 및 도 18은 복호화기에서 복원된 피처 맵을 이용한 다른 피처 맵 생성 예시이다. 도 17의 예시와 같이, 복원한 피처 맵을 이용하여 동일한 레이어의 다른 레벨의 전송받지 않은 피처 맵을 생성 할 수 있다. 실시 예에 따라, 복원된 P3 피처 맵을 업샘플링 또는 다운샘플링하여 P2 피처 맵을 생성할 수 있다. 도 18의 예시와 같이, 복원된 피처 맵의 이전 레이어의 피처 맵을 생성할 수 있다. 실시 예에 따라, 복원된 P5 에 한 개 또는 다수 개의 레이어의 합성곱 연산을 수행하여 직전 레이어인 M5 예측 피처 맵을 생성하고 M5의 복 원된 잔차 피처 맵과 합하여 복원된 M5를 생성할 수 있다. 생성된 M5와 복원된 C4, C3, C2 피처 맵을 이용하여 피처 맵 추출부의 나머지 전송받지 않은 피처 맵들(M4, M3, M2, P4, P3, P2)을 생성할 수 있다. 피처 맵 분석기는, 복원된 피처 맵 또는 복원된 피처 맵으로부터 생성된 피처 맵을 이용하여 뉴럴 네트워 크의 피처 맵 분석을 수행하여 머신 태스크 분석 결과를 출력할 수 있다. 상기 피처 맵 분석부는 과정은 한 개 이상의 합성곱 레이어로 구성될 수 있다. 이하, 도 19 및 표들을 참조하여 본 발명의 일 실시예에 따른 복호화 과정을 보다 상세히 설명한다. 도 19는 본 발명의 일 실시예에 따른 복호화 과정을 개념적으로 나타낸 도면이다. 이때, 도 19의 복호화 과정, 데이터그룹 분리 및 역정렬 과정에서 데이터그룹 헤더(data_group_header)의 정보 를 이용할 수 있으며, 데이터 그룹 분리 및 역정렬 과정, 역변환 과정에서 변환 단위 그룹 헤더(TUG_header)와 피처 맵 헤더(featuremap_header)정보를 이용할 수 있다. 하기의 [표 1]은 데이터그룹 헤더의 신택스 구성을 나타낸다. 송신 엣지는 입력받은 이미지 또는 동영상으로부터 한 개 이상의 피처 맵을 추출할 수 있다. 상기 한 개 이상의 피처 맵은 변환, 양자화, 부호화 등의 과정을 거쳐서 한 개 이상의 비트스트림이 출력될 수 있다. 하나의 비트 스트림은 한 개 또는 다수 개의 피처 맵으로부터 생성된 같은 종류의 데이터가 패킹된 하나의 데이터그룹이 부 호화된 것을 포함할 수 있다. 예를 들어, 하나의 비트스트림에 P2, P3, P4의 coefficients가 패킹된 데이터그룹 이 부호화되어 있을 수 있다. 또는, 예를 들어, 하나의 비트스트림에 TUG0, TUG1의 각 기저 벡터 셋이 패킹된 데이터그룹이 부호화되어 있을 수 있다. data_group_header는 상기 비트스트림 단위로 전송될 수 있다. 표 1 data_group_header() { Descriptor codec_type_idx ue(v) is_arranged u if(is_arranged) arranging_method_idx ue(v) data_type_idx ue(v) num_of_data_in_data_group_minus1 for(num_of_data_in_data_group_minus1 + 1) { if(data_type_idx == FEATURE MAP) FM_idx[ i ] ue(v) else if(data_type_idx == COEFFICIENT) FM_idx[ i ] ue(v) else if(data_type_idx == BASIS VECTOR) TUG_idx[ i ] ue(v) } } 상기 [표 1]의 신택스 구성에 대한 설명은 아래와 같다. codec_type_idx 해당 복호화하기 위한 코덱 종류 인덱스 0 = 예측 및 변환 기반 코덱, 1 = End-to-End 딥러닝 기반 코덱, 2 = 엔트로피 코딩 기반 코덱 is_arranged 해당 비트스트림에 '피처 맵 정보 복호화기'를 수행하여 복원한 데이터그룹 내 데이터에 역정렬 을 수행하는지 여부를 의미 0 = 역정렬을 수행하지 않음, 1 = 역정렬을 수행함 arranging_method_idx 데이터 역정렬 방법의 인덱스 data_type_idx 해당 비트스트림으로부터 복원된 데이터의 종류 인덱스 0 = 피처 맵, 1 = 변환 계수, 2 = 기저 벡터 num_of_data_in_data_group_minus1 해당 비트스트림으로부터 복원된 데이터그룹에 포함된 데이터가 도출된 피 처 맵 또는 TUG의 개수 예를 들어, 데이터그룹에 3개의 피처 맵 P2, P3, P4의 변환 계수가 포함되었을 경우, 신택스의 값은 2에 상응할 수 있다. 예를 들어, 데이터그룹에 TUG1, TUG2의 각 기저 벡터 셋이 포함되었을 경우, 신택스의 값은 1에 상응할 수 있다. FM_idx 해당 비트스트림에 피처 맵 또는 변환 계수가 포함되었을 경우, 각 피처 맵 인덱스 TUG_idx 해당 비트스트림에 변환 벡터 셋이 포함되었을 경우, 각 TUG 인덱스 하기의 [표 2]은 피처 맵 파라미터 셋의 신택스 구성을 나타낸다. 피처 맵 파라미터 셋(featuremap_parameter_set)은 송신 엣지에 입력된 이미지 또는 동영상 단위로 전송될 수 있고, 이미지 또는 동영상에서 추출되고 부호화된 피처 맵의 개수 및 각 인덱스가 전송될 수 있다. 표 2 featuremap_parameter_set() Descriptor { number_of_coded_FM ue(v) for(number_of_coded_FM) FM_idx[ i ] ue(v) . . . } 상기 [표 2]의 신택스 구성에 대한 설명은 아래와 같다. number_of_coded_FM 이미지 또는 동영상 단위로 부호화 및 전송된 피처 맵의 개수 FM_idx 피처 맵의 인덱스 하기의 [표 3]은 변환 유닛 그룹 헤더의 신택스 구성을 나타낸다. 변환 유닛 그룹 헤더(TUG_header)는 변환 유닛 그룹 단위로 전송되는 헤더 정보이다. 변환 유닛 그룹당 하나의 변환 벡터 셋이 전송될 수 있고, 변환 벡터 셋은 다수 개의 변환 벡터로 구성될 수 있다. 표 3 TUG_header() Descriptor { TUG_idx ue(v) basis_vector_size_idx ue(v) num_of_basis_vector ue(v) num_of_belongedFM ue(v) for(num_of_belongedFM) FM_idx[ i ] ue(v) . . . } 상기 [표 3]의 신택스 구성에 대한 설명은 아래와 같다. TUG_idx 해당 변환 유닛 그룹의 인덱스 basis_vector_size_idx 해당 변환 유닛 그룹의 하나의 변환 벡터의 크기 하기의 [표 4]는 basis_vector_size_idx의 일 예시이다. 표 4 basis_vector_size_idx Name of feature map 0 Same with TU size of the first feature map belonging to TUG 1 Same with TU size of the second feature map belonging to TUG 2 Same with TU size of the third feature map belonging to TUG . . . . . . num_of_basis_vector 해당 변환 유닛 그룹의 변환 벡터 셋에 포함된 변환 벡터 개수 num_of_belongedFM 해당 변환 유닛 그룹에 포함된 피처 맵의 개수 FM_idx 해당 변환 유닛 그룹에 포함된 피처 맵의 인덱스 하기의 [표 5]는 피처 맵 헤더의 신택스 구성을 나타낸다. 피처 맵 헤더(featuremap_header)는 피처 맵 단위로 전송되는 헤더 정보이다. 표 5 featuremap_header() Descriptor { FM_idx ue(v) channel_size_idx ue(v) number_of_channel ue(v) is_residual_coded u is_transformed u if(is_transformed) feature_TU_size_idx ue(v) TUG_idx ue(v) has_coefficient u . . . } 상기 [표 5]의 신택스 구성에 대한 설명은 아래와 같다. FM_idx 해당 피처 맵의 인덱스 하기의 [표 6]은 FM_idx의 일 예시이다. 표 6 FM_idx Name of feature map 0 C2 1 C3 2 C4 . . . . . . channel_size_idx 해당 피처 맵의 채널 사이즈 하기의 [표 7]은 channel_size_idx 의 일 예시이다. 표 7 channel_size_idx Size of channel 0 64 x 64 1 128 x 128 2 256 x 256 . . . . . . number_of_channel 해당 피처 맵의 채널 개수 is_residual_coded 해당 피처 맵의 잔차 피처 맵이 부호화되었는지 여부 0 = 피처 맵이 부호화됨, 1 = 잔차 피처 맵이 부호화됨 is_transformed 해당 피처 맵에 변환이 수행되었는지 여부 0 = 피처 맵에 변환이 수행되지 않음, 1 = 피처 맵에 변환이 수행됨 feature_TU_size_idx 해당 피처 맵에 변환에 변환이 수행되었을 경우, 변환 단위 크기 하기의 [표 8]은 feature_TU_size_idx의 일 예시이다. 표 8 feature_TU_size_idx Size of TU 0 channel size 1 1/4 of channel size 2 1/16 of channel size . . . . . . TUG_idx 해당 피처 맵에 변환에 변환이 수행되었을 경우, 피처 맵이 속한 TUG의 인덱스 has_coefficient 해당 피처 맵에 변환에 변환이 수행되었을 경우, 변환 계수가 부호화되어 전송되었는지 여부 도 20은 실시예에 따른 컴퓨터 시스템의 구성을 나타낸 도면이다. 실시예에 따른 피처 맵 인코딩/디코딩을 위한 장치는 컴퓨터로 읽을 수 있는 기록매체와 같은 컴퓨터 시스템 에서 구현될 수 있다. 컴퓨터 시스템은 버스를 통하여 서로 통신하는 하나 이상의 프로세서, 메모리, 사용자 인터페이스 입력 장치, 사용자 인터페이스 출력 장치 및 스토리지를 포함할 수 있다. 또한, 컴퓨터 시스템은 네트워크에 연결되는 네트워크 인터페이스를 더 포함할 수 있다. 프로세서 는 중앙 처리 장치 또는 메모리나 스토리지에 저장된 프로그램 또는 프로세싱 인스트럭션들 을 실행하는 반도체 장치일 수 있다. 메모리 및 스토리지는 휘발성 매체, 비휘발성 매체, 분리형 매체, 비분리형 매체, 통신 매체, 또는 정보 전달 매체 중에서 적어도 하나 이상을 포함하는 저장 매체일 수 있 다. 예를 들어, 메모리는 ROM이나 RAM을 포함할 수 있다. 본 발명에서 설명하는 특정 실행들은 실시예들로서, 어떠한 방법으로도 본 발명의 범위를 한정하는 것은 아니다. 명세서의 간결함을 위하여, 종래 전자적인 구성들, 제어시스템들, 소프트웨어, 상기 시스템들의 다른 기능적인 측면들의 기재는 생략될 수 있다. 또한, 도면에 도시된 구성 요소들 간의 선들의 연결 또는 연결 부재 들은 기능적인 연결 및/또는 물리적 또는 회로적 연결들을 예시적으로 나타낸 것으로서, 실제 장치에서는 대체 가능하거나 추가의 다양한 기능적인 연결, 물리적인 연결, 또는 회로 연결들로서 나타내어질 수 있다. 또한, “ 필수적인”, “중요하게” 등과 같이 구체적인 언급이 없다면 본 발명의 적용을 위하여 반드시 필요한 구성 요 소가 아닐 수 있다. 따라서, 본 발명의 사상은 상기 설명된 실시예에 국한되어 정해져서는 아니되며, 후술하는 특허청구범위뿐만 아 니라 이 특허청구범위와 균등한 또는 이로부터 등가적으로 변경된 모든 범위는 본 발명의 사상의 범주에 속한다 고 할 것이다."}
{"patent_id": "10-2022-0113547", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 일 실시예에 따른 인코딩 방법을 나타낸 흐름도이다. 도 2는 본 발명의 일 실시예에 따른 디코딩 방법을 나타낸 흐름도이다. 도 3은 본 발명의 일 실시예에 따른 부호화 과정을 개념적으로 나타낸 도면이다. 도 4는 피처 맵 추출부의 구조를 예시적으로 나타낸 도면이다. 도 5는 피처 맵 차분기의 구조를 예시적으로 나타낸 도면이다. 도 6은 차분 피처 맵 생성 과정을 예시적으로 나타낸다. 도 7은 피처 맵 변환기의 구조를 예시적으로 나타낸 도면이다. 도 8은 일 실시예에 따른 변환 단위와 변환 단위 그룹을 나타낸다. 도 9 내지 도 12는 변환 단위와 변환 단위 그룹에 따른 변환 벡터 도출부 및 변환부의 입출력 예시이다. 도 13은 피처 맵 정보 패킹 수행기의 구조를 예시적으로 나타낸 도면이다. 도 14는 본 발명의 일 실시예에 따른 복호화 과정을 개념적으로 나타낸 도면이다. 도 15 내지 도 16은 서로 다른 입력에 따른 피처 맵 역변환기의 동작 예시이다. 도 17 및 도 18은 복호화기에서 복원된 피처 맵을 이용한 다른 피처 맵 생성 예시이다. 도 19는 본 발명의 일 실시예에 따른 복호화 과정을 개념적으로 나타낸 도면이다. 도 20은 실시예에 따른 컴퓨터 시스템의 구성을 나타낸 도면이다."}
