{"patent_id": "10-2020-0009018", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2021-0095323", "출원번호": "10-2020-0009018", "발명의 명칭": "인공지능을 이용한 불꽃 감지 장치 및 방법", "출원인": "강원대학교산학협력단", "발명자": "곽동걸"}}
{"patent_id": "10-2020-0009018", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "불꽃 감지를 위한 불꽃 감지 장치에서의 불꽃 감지 방법에서, 카메라에서 촬영된 이미지가 입력되면, 입력된 이미지에 대해 불꽃 감지를 위한 관심영역을 추출하는 이미지 어피어런스 알고리즘(image appearance algorithm)을 수행하는 단계; 및추출된 관심영역에 대해 딥러닝(deep learning)을 이용하여 불꽃 객체인지 여부를 추론하는 단계를 포함하는 불꽃 감지 방법."}
{"patent_id": "10-2020-0009018", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "청구항 1에 있어서, 상기 이미지 어피어런스 알고리즘을 수행하는 단계에서, 입력된 이미지에서 가우시안 혼합 모델 기반 영상 차분을 통해 움직임이 발생한 영역을 검출하는 단계;상기 움직임이 발생한 영역을 그레이 스케일로 색상을 변환하되, 미리 설정된 임계값 이하의 픽셀들을 흰색으로변환하고, 상기 임계값을 초과하는 픽셀들을 검정색으로 변환하여 이진화하고, 흰색 영역들 중에서 미리 설정된크기 이하의 면적에 해당하는 영역들을 필터링하는 단계; 필터링된 객체의 윤곽선과 중심점을 구하여 윤곽선의 면적에 따른 무게 중심점을 구하고, 상기 중심점을 기준으로 상단 부분에 대해서 윤곽선을 다시 지정하는 단계; 상기 상단 부분의 윤곽선을 다각형으로 근사화하고, 근사화된 다각형의 꼭짓점의 갯수를 확인하는 단계; 및꼭짓점의 갯수를 확인하여 삼각형으로 판별된 경우, 이를 포함하는 영역을 관심 영역으로 지정하는 단계를 포함하여 이루어지는 것을 특징으로 하는 불꽃 감지 방법."}
{"patent_id": "10-2020-0009018", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "청구항 1에 있어서, 상기 불꽃 객체인지 여부를 추론하는 단계에서, Faster R-CNN(Region-based Convolutional Network) 알고리즘을 이용하여 불꽃 객체인지 여부를 추론하는 것을특징으로 하는 불꽃 감지 방법."}
{"patent_id": "10-2020-0009018", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "카메라에서 촬영된 이미지가 입력되면, 입력된 이미지에 대해 불꽃 감지를 위한 관심영역을 추출하는 이미지 어피어런스 알고리즘(image appearance algorithm)을 수행하는 이미지 어피어런스부; 및추출된 관심영역에 대해 딥러닝(deep learning)을 이용하여 불꽃 객체인지 여부를 추론하는 추론부를 포함하는 불꽃 감지 장치."}
{"patent_id": "10-2020-0009018", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "공개특허 10-2021-0095323-3-청구항 4에 있어서, 상기 이미지 어피어런스부는 입력된 이미지에서 가우시안 혼합 모델 기반 영상 차분을 통해 움직임이 발생한 영역을 검출하고, 상기 움직임이 발생한 영역을 그레이 스케일로 색상을 변환하되, 미리 설정된 임계값 이하의 픽셀들을 흰색으로 변환하고, 상기 임계값을 초과하는 픽셀들을 검정색으로 변환하여 이진화하고, 흰색 영역들 중에서 미리 설정된 크기 이하의 면적에 해당하는 영역들을 필터링하고, 필터링된 객체의 윤곽선과 중심점을 구하여 윤곽선의 면적에 따른 무게 중심점을 구하고, 상기 중심점을 기준으로 상단 부분에 대해서 윤곽선을 다시 지정하고, 상기 상단 부분의 윤곽선을 다각형으로 근사화하고, 근사화된 다각형의 꼭짓점의 갯수를 확인하고, 꼭짓점의 갯수를 확인하여 삼각형으로 판별된 경우, 이를 포함하는 영역을 관심 영역으로 지정하는 방식으로 이미지 어피어런스 알고리즘을 수행하는 것을 특징으로 하는 불꽃 감지 장치."}
{"patent_id": "10-2020-0009018", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "청구항 4에 있어서, 상기 추론부는 Faster R-CNN(Region-based Convolutional Network) 알고리즘을 이용하여 불꽃 객체인지 여부를추론하는 것을 특징으로 하는 불꽃 감지 장치."}
{"patent_id": "10-2020-0009018", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 불꽃 감지 방법에 관한 것으로서, 카메라에서 촬영된 이미지가 입력되면, 입력된 이미지에 대해 불꽃 감지를 위한 관심영역을 추출하는 이미지 어피어런스 알고리즘(image appearance algorithm)을 수행하는 단계 및 추출된 관심영역에 대해 딥러닝(deep learning)을 이용하여 불꽃 객체인지 여부를 추론하는 단계를 포함한다. 본 발명에 의하면, 이미지 어피어런스 알고리즘과 Faster R-CNN 알고리즘을 이용하여 불꽃을 감지함으로써, 불꽃 감지의 속응성이 우수하고, 정확도를 향상시킬 수 있는 효과가 있다. 따라서, 화재 위험을 조기에 방지하고 예방 할 수 있는 효과가 있다."}
{"patent_id": "10-2020-0009018", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 화재 감지의 일종인 불꽃 감지 기술에 관한 것으로서, 더욱 상세하게는 인공지능을 이용한 불꽃 감지 장치 및 방법에 관한 것이다."}
{"patent_id": "10-2020-0009018", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "지난 2018년 11월 서울시 종로구에 위치한 고시원의 전기히터에서 발생한 화재로 인해 7명이 사망하고 12명이 부상하는 사고가 있었다. 해당 고시원은 스프링클러 설치 의무규정에 해당하지 않아 스프링클러가 없었고, 설치 되어 있던 화재감지기 또한 제대로 작동하지 않아 화재 초기에 주민들이 신속히 대피하지 못하여 피해가 커졌다. 또한 2017년 발생했던 제천 스포츠센터 화재 당시에도 방화셔터의 작동불량 및 화재감지기가 작동하지 않는 등 총체적 문제로 29명이 사망하는 대형참사로 이어졌다. 이처럼 관리자의 안전에 대한 의식 부족, 잦은 화재감지기의 오작동과 더불어 화재감지기를 꺼놓는 사례가 많은 것으로 지적되고 있다. 그러므로 화재감지기의 오작동을 줄이고 화재 시 화재감지기의 기능을 정상적으로 발휘 하도록 유지관리와 점검이 정확하게 이루어져야 하지만, 실제 화재발생 시 연기감지기 및 화재감지기의 작동지 연 및 부작동 등 신뢰성 저하로 인하여 인명 및 재산 피해가 줄어들지 않는 실정이다. 현재 대표적으로 사용하는 화재감지를 위한 불꽃감지기는 자외선(UV, ultra violet) 감지기와 적외선(IR, infra red) 감지기로 나누어진다. 자외선 감지기는 자외선 즉, 0.09~0.38 ㎛의 방사에너지를 검출하는 감지기로서, 물체에 빛이 조사될 때 여기전 자(excitation electron)를 진공 중으로 방출시키는 광전자 방사원리를 이용하는 방식이다. 하지만 자외선 방식 의 불꽃감지기는 파장이 짧은 자외선을 감지하기 때문에 연기나 공기 중 부유물에 의해서도 자외선이 흡수되므 로 감도에 대한 신뢰성이 떨어지는 문제점이 있다. 또한 아크, 스파크 등 단파장에 대해 비화재보가 발생할 수 있고, 연기 농도가 높을수록 동작에 어려움이 주어진다. 적외선 감지기는 0.78~5.0 ㎛의 복사에너지를 감지하여 동작하는 방식으로 초전체를 감지센서로 많이 사용한다. 광학 필터를 사용하는 경우 연소생성물의 이산화탄소에서 발생하는 4.4 ㎛ 부근의 이산화탄소 공명 방사를 이용 한다. 따라서 긴 파장대를 이용하는 특성으로 인하여 공기 중 부유물에 대해 거의 영향을 받지 않는ㅤ장점이 있 다. 하지만 반대로 이산화탄소가 발생하지 않는 화재 시에는 비 적응성을 갖는 문제점이 있다. 이외에도 오보를 줄이기 위한 UV/IR 혼합형 불꽃감지기가 존재하나 자외선감지기의 단점인 오염으로부터 약하다 는 문제가 있다.최근 컴퓨터 비전분야의 발달로 인하여 인공지능을 이용한 불꽃감지기들이 연구개발되고 있다. 이들은 카메라에 서 캡처된 이미지들을 각종 불꽃 이미지들이 수집된 데이터 베이스를 통하여 딥러닝(deep learning) 즉, 심층 학습이라는 인공지능 프로그램을 이용하여 불꽃인지 아닌지를 검출하는 원리를 가진다. 이러한 인공지능형 불꽃감지기는 매초 단위로 캡처되는 각종 이미지들을 컴퓨터에 내장된 방대한 화재 이미지 데이트들과 비교분석하고 학습을 하면서 불꽃 여부를 감지하는데 시간이 많이 걸린다는 단점이 있다. 선행기술문헌 특허문헌 (특허문헌 0001) 대한민국 공개특허 10-2010-0050920"}
{"patent_id": "10-2020-0009018", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은 상기와 같은 문제점을 해결하기 위하여 안출된 것으로서, 기존의 인공지능형 불꽃감지기의 시간적 응 답 속응성을 보완하기 위하여, 이미지 어피어런스 알고리즘(image appearance algorithm)이 접목된 속응성이 빠 른 인공지능형 불꽃 감지 장치 및 방법을 제공하는데 그 목적이 있다. 본 발명의 목적은 이상에서 언급한 목적으로 제한되지 않으며, 언급되지 않은 또 다른 목적들은 아래의 기재로 부터 통상의 기술자에게 명확하게 이해될 수 있을 것이다."}
{"patent_id": "10-2020-0009018", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "이와 같은 목적을 달성하기 위한 본 발명의 불꽃 감지를 위한 불꽃 감지 장치에서의 불꽃 감지 방법에서, 카메 라에서 촬영된 이미지가 입력되면, 입력된 이미지에 대해 불꽃 감지를 위한 관심영역을 추출하는 이미지 어피어 런스 알고리즘(image appearance algorithm)을 수행하는 단계 및 추출된 관심영역에 대해 딥러닝(deep learning)을 이용하여 불꽃 객체인지 여부를 추론하는 단계를 포함한다. 상기 이미지 어피어런스 알고리즘을 수행하는 단계에서, 입력된 이미지에서 가우시안 혼합 모델 기반 영상 차분 을 통해 움직임이 발생한 영역을 검출하는 단계, 상기 움직임이 발생한 영역을 그레이 스케일로 색상을 변환하 되, 미리 설정된 임계값 이하의 픽셀들을 흰색으로 변환하고, 상기 임계값을 초과하는 픽셀들을 검정색으로 변 환하여 이진화하고, 흰색 영역들 중에서 미리 설정된 크기 이하의 면적에 해당하는 영역들을 필터링하는 단계, 필터링된 객체의 윤곽선과 중심점을 구하여 윤곽선의 면적에 따른 무게 중심점을 구하고, 상기 중심점을 기준으 로 상단 부분에 대해서 윤곽선을 다시 지정하는 단계, 상기 상단 부분의 윤곽선을 다각형으로 근사화하고, 근사 화된 다각형의 꼭짓점의 갯수를 확인하는 단계 및 꼭짓점의 갯수를 확인하여 삼각형으로 판별된 경우, 이를 포 함하는 영역을 관심 영역으로 지정하는 단계를 포함하여 이루어질 수 있다. 상기 불꽃 객체인지 여부를 추론하는 단계에서, Faster R-CNN(Region-based Convolutional Network) 알고리즘 을 이용하여 불꽃 객체인지 여부를 추론할 수 있다. 본 발명의 불꽃 감지 장치는 카메라에서 촬영된 이미지가 입력되면, 입력된 이미지에 대해 불꽃 감지를 위한 관 심영역을 추출하는 이미지 어피어런스 알고리즘(image appearance algorithm)을 수행하는 이미지 어피어런스부 및 추출된 관심영역에 대해 딥러닝(deep learning)을 이용하여 불꽃 객체인지 여부를 추론하는 추론부를 포함한 다. 상기 이미지 어피어런스부는 입력된 이미지에서 가우시안 혼합 모델 기반 영상 차분을 통해 움직임이 발생한 영 역을 검출하고, 상기 움직임이 발생한 영역을 그레이 스케일로 색상을 변환하되, 미리 설정된 임계값 이하의 픽 셀들을 흰색으로 변환하고, 상기 임계값을 초과하는 픽셀들을 검정색으로 변환하여 이진화하고, 흰색 영역들 중 에서 미리 설정된 크기 이하의 면적에 해당하는 영역들을 필터링하고, 필터링된 객체의 윤곽선과 중심점을 구하 여 윤곽선의 면적에 따른 무게 중심점을 구하고, 상기 중심점을 기준으로 상단 부분에 대해서 윤곽선을 다시 지 정하고, 상기 상단 부분의 윤곽선을 다각형으로 근사화하고, 근사화된 다각형의 꼭짓점의 갯수를 확인하고, 꼭 짓점의 갯수를 확인하여 삼각형으로 판별된 경우, 이를 포함하는 영역을 관심 영역으로 지정하는 방식으로 이미지 어피어런스 알고리즘을 수행할 수 있다. 상기 추론부는 Faster R-CNN(Region-based Convolutional Network) 알고리즘을 이용하여 불꽃 객체인지 여부를 추론할 수 있다."}
{"patent_id": "10-2020-0009018", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명에 의하면, 이미지 어피어런스 알고리즘과 Faster R-CNN 알고리즘을 이용하여 불꽃을 감지함으로써, 불 꽃 감지의 속응성이 우수하고, 정확도를 향상시킬 수 있는 효과가 있다. 따라서, 화재 위험을 조기에 방지하고 예방할 수 있는 효과가 있다. 또한, 본 발명은 기존의 인공지능형 불꽃감지기가 가지는 불꽃의 추론단계에서 발생하는 불꽃이 아닌 객체로 인 한 빈번한 연산을 줄여 속응성을 높일 수 있으므로, 신속한 화재의 대응과 불꽃감지 시스템 구축에 필요한 하드 웨어를 줄일 수 있는 효과가 있다."}
{"patent_id": "10-2020-0009018", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "본 발명은 다양한 변경을 가할 수 있고 여러 가지 실시예를 가질 수 있는 바, 특정 실시예들을 도면에 예시하고 상세하게 설명하고자 한다. 그러나, 이는 본 발명을 특정한 실시 형태에 대해 한정하려는 것이 아니며, 본 발명 의 사상 및 기술 범위에 포함되는 모든 변경, 균등물 내지 대체물을 포함하는 것으로 이해되어야 한다. 본 출원에서 사용한 용어는 단지 특정한 실시예를 설명하기 위해 사용된 것으로, 본 발명을 한정하려는 의도가 아니다. 단수의 표현은 문맥상 명백하게 다르게 뜻하지 않는 한, 복수의 표현을 포함한다. 본 출원에서, \"포함 하다\" 또는 \"가지다\" 등의 용어는 명세서 상에 기재된 특징, 숫자, 단계, 동작, 구성요소, 부품 또는 이들을 조 합한 것이 존재함을 지정하려는 것이지, 하나 또는 그 이상의 다른 특징들이나 숫자, 단계, 동작, 구성요소, 부 품 또는 이들을 조합한 것들의 존재 또는 부가 가능성을 미리 배제하지 않는 것으로 이해되어야 한다. 다르게 정의되지 않는 한, 기술적이거나 과학적인 용어를 포함해서 여기서 사용되는 모든 용어들은 본 발명이 속하는 기술 분야에서 통상의 지식을 가진 자에 의해 일반적으로 이해되는 것과 동일한 의미를 갖고 있다. 일반 적으로 사용되는 사전에 정의되어 있는 것과 같은 용어들은 관련 기술의 문맥 상 갖는 의미와 일치하는 의미를 갖는 것으로 해석되어야 하며, 본 출원에서 명백하게 정의하지 않는 한, 이상적이거나 과도하게 형식적인 의미 로 해석되지 않는다.또한, 첨부 도면을 참조하여 설명함에 있어, 도면 부호에 관계없이 동일한 구성 요소는 동일한 참조 부호를 부 여하고 이에 대한 중복되는 설명은 생략하기로 한다. 본 발명을 설명함에 있어서 관련된 공지 기술에 대한 구체 적인 설명이 본 발명의 요지를 불필요하게 흐릴 수 있다고 판단되는 경우 그 상세한 설명을 생략한다. 본 발명은 이미지 어피어런스 알고리즘(image appearance algorithm)과 딥러닝(deep learning)을 이용한 카메 라 영상기반의 화재감지에 관한 기술로서, 모든 불꽃은 상단 부분이 삼각형 모양으로 첨예한 부분이 존재하고, 나머지 부분은 부드러운 곡선 모양을 취한다는 특징을 이용한다. 먼저 입력 이미지(image)로부터 이미지 어피어런스 알고리즘을 사용하여 이진화 및 영상차분을 수행하고, 전경 영상의 객체들에 대해 윤곽을 검출한 후, 객체 중앙을 기준으로 상단 부분이 삼각형으로 감지될 경우, 해당 객 체 영역을 관심영역(region of interest, ROI)으로 지정한다. 그리고, 지정된 관심영역은 딥러닝 모델인 Faster R-CNN 알고리즘을 통해 불꽃 여부를 추론한다. 도 1은 본 발명의 일 실 실시예에 따른 이미지 어피어런스 알고리즘을 나타낸 흐름도이다. 도 1을 참조하면, 본 발명에서 제안하는 이미지 어피어런스 알고리즘(image appearance algorithm)은 하나의 프 로그램 플랫폼(program platform) 또는 독립적인 프레임워크(framework)로 설계되고 제공될 수 있다. 그리고, 본 발명에서 이미지 어피어런스 알고리즘은 인공지능이 객체인식(object recognition)을 위한 학습 (learning)을 수행하기 전단계에서, 먼저 검출객체의 이미지 겉모양을 분류하고 이미지가 가지는 특정적인 외형 이나 윤곽만을 이미지 모멘트(image moment) 기술을 이용하여 부분 추출한 후, 관심영역(Region of Interest)으 로 선정하는, 즉 객체인식 학습 전처리기(Pre-processing)로 동작하는 알고리즘이다. 먼저, 객체분류를 위한 필터링 단계(S110)에서는 입력 이미지로부터 움직임 검출을 위한 이진화 및 영상차분을 수행하거나 HSV 컬러 채널 변환 등을 이용하여 전체 영상으로부터 배경영상과 객체를 분리한다. 그리고, 이미지 모멘트를 이용한 특정 이미지 부분 추출 단계(S120)에서는 이미지 모멘트(image moments)를 이 용하여 공간 모멘트(spatial moments), 중심 모멘트(central moments), 정규화된 중심 모멘트(central normalized moments)를 계산하고, 이를 통해 객체의 윤곽선, 면적을 구하거나 불규칙한 모양의 객체로부터 무게 중심점을 구할 수 있다. 또한 무게 중심점을 기준으로 가장 먼 곳이나 가까운 부분의 모양만을 추출할 수 있다. 마지막으로 후처리를 통한 관심영역 선정 단계(S130)에서는 특정 이미지 부분 추출 단계(S120)에서 계산한 무게 중심점을 기준으로 객체의 상단, 하단, 좌측 또는 우측 면적만 다시 윤곽선을 지정하고, 지정된 윤곽선을 바운 딩 박스 형태로 관심영역으로 선정한다. 이를 통해 객체 전체가 아닌 객체에서 필요한 특정 부분만을 선택적으 로 이용할 수 있다. 이러한 이미지 어피어런스 알고리즘은 인공지능이 객체인식을 위한 학습에 소요되는 시간을 줄이고 정밀도와 정 확도를 높일 수 있도록 한다. 그리고, 이미지 어피어런스 알고리즘은 본 발명에서 제안하는 고유의 알고리즘으로서, 하나의 프로그램 라이브 러리나 프레임워크로 제공되어 사용자들이 쉽게 구현하고 응용할 수 있으므로, 인공지능을 이용한 시스템 개발 에 있어서, 시간적, 경제적 이점을 기대할 수 있다. 도 2는 본 발명의 일 실시예에 따른 인공지능을 이용한 불꽃 감지 방법을 보여주는 흐름도이다. 도 2를 참조하면, 본 발명의 불꽃 감지 방법은 획득된 카메라 영상의 이미지로부터 관심영역 추출을 위한 이미 지 어피어런스 과정이 포함되어 있고, 최종적으로 추출된 관심영역에 대해 불꽃 객체인지 또는 불꽃이 아닌 객 체인지 추론하는 딥러닝 모델의 일종인 Faster R-CNN을 이용한 불꽃 추론 과정을 포함하여 이루어진다. 본 발명의 불꽃 감지를 위한 불꽃 감지 장치에서의 불꽃 감지 방법에서, 카메라에서 촬영된 이미지가 입력되면 (S210), 입력된 이미지에 대해 불꽃 감지를 위한 관심영역을 추출하는 이미지 어피어런스 알고리즘(image appearance algorithm)을 수행한다(S220). 그리고, 추출된 관심영역에 대해 딥러닝(deep learning)을 이용하여 불꽃 객체인지 여부를 추론하여, 불꽃 객체 인지 여부를 결정한다(S230, S240). 본 발명에서 Faster R-CNN(Region-based Convolutional Network) 알고리즘 을 이용하여 불꽃 객체인지 여부를 추론할 수 있다. 본 발명에서 이미지 어피어런스 알고리즘을 수행하는 단계(S220)는 다음과 같은 세부 단계를 포함한다. 먼저, 입력된 이미지에서 가우시안 혼합 모델 기반 영상 차분을 통해 움직임이 발생한 영역을 검출한다. 그리고, 움직임이 발생한 영역을 그레이 스케일로 색상을 변환하되, 미리 설정된 임계값 이하의 픽셀들을 흰색 으로 변환하고, 임계값을 초과하는 픽셀들을 검정색으로 변환하여 이진화하고, 흰색 영역들 중에서 미리 설정된 크기 이하의 면적에 해당하는 영역들을 필터링한다(S222). 그리고, 필터링된 객체의 윤곽선과 중심점을 구하여 윤곽선의 면적에 따른 무게 중심점을 구하고, 중심점을 기 준으로 상단 부분에 대해서 윤곽선을 다시 지정한다(S224). 그리고, 상단 부분의 윤곽선을 다각형으로 근사화하고, 근사화된 다각형의 꼭짓점의 갯수를 확인한다. 그리고, 꼭짓점의 갯수를 확인하여 삼각형으로 판별된 경우, 이를 포함하는 영역을 관심 영역으로 지정한다(S226). 도 3은 본 발명의 일 실시예에 따른 인공지능을 이용한 불꽃 감지 장치의 내부 구성을 보여주는 블록도이다 도 3을 참조하면 본 발명의 불꽃 감지 장치(1000는 이미지 어피어런스부 및 추론부를 포함한다. 이미지 어피어런스부는 카메라에서 촬영된 이미지가 입력되면, 입력된 이미지에 대해 불꽃 감지를 위한 관 심영역을 추출하는 이미지 어피어런스 알고리즘(image appearance algorithm)을 수행한다. 추론부는 추출된 관심영역에 대해 딥러닝(deep learning)을 이용하여 불꽃 객체인지 여부를 추론한다. 본 발명에서 이미지 어피어런스부는 입력된 이미지에서 가우시안 혼합 모델 기반 영상 차분을 통해 움직임 이 발생한 영역을 검출하고, 움직임이 발생한 영역을 그레이 스케일로 색상을 변환하되, 미리 설정된 임계값 이 하의 픽셀들을 흰색으로 변환하고, 상기 임계값을 초과하는 픽셀들을 검정색으로 변환하여 이진화한다. 그리고, 흰색 영역들 중에서 미리 설정된 크기 이하의 면적에 해당하는 영역들을 필터링하고, 필터링된 객체의 윤곽선과 중심점을 구하여 윤곽선의 면적에 따른 무게 중심점을 구하고, 상기 중심점을 기준으로 상단 부분에 대해서 윤 곽선을 다시 지정한다. 그리고, 상단 부분의 윤곽선을 다각형으로 근사화하고, 근사화된 다각형의 꼭짓점의 갯 수를 확인하고, 꼭짓점의 갯수를 확인하여 삼각형으로 판별된 경우, 이를 포함하는 영역을 관심 영역으로 지정 하는 방식으로 이미지 어피어런스 알고리즘을 수행한다. 본 발명에서 추론부는 딥러닝 모델의 일종인 Faster R-CNN(Region-based Convolutional Network) 알고리 즘을 이용하여 불꽃 객체인지 여부를 추론할 수 있다. 본 발명에서 Faster R-CNN 기법을 이용하여 학습된 딥러닝 모델을 실제 영상으로부터 불꽃을 추론하는 경우는 영상 내에 추론하고자 하는 객체 이외에 배경영상이나 불꽃이 아닌 객체들이 포함되어 있다. 이러한 이유로 매 영상 프레임을 딥러닝 기반의 모델을 통해 객체 추론을 수행할 경우 빈번한 연산으로 하드웨어의 비용과 시간적 지연, 부하가 상승하는 문제가 발생할 수 있다. 이를 해결하기 위하여 본 발명에서 제안한 이미지 어피어런스 알고리즘을 이용하여, 이미지 전체 영역에 대해 추론을 하는 것이 아닌 영상전처리를 통해 불꽃의 특징적인 모양과 윤곽만을 추론을 수행함으로써 연산량을 줄 이고, 정밀하게 불꽃을 검출할 수 있도록 한다. 도 4는 본 발명의 일 실시예에 따른 원본 입력 이미지이다. 도 4에서 보는 바와 같이, 본 발명의 불꽃 검출에 대한 이미지 어피어런스 알고리즘은 원본 입력 이미지에 대 해 불꽃이 가지는 움직임과 첨예한 특성을 검출하여 해당 영역을 딥러닝 모델의 추론을 위한 관심영역으로 사용 하도록 한다. 첫 번째로 원본 입력 이미지에서 움직임이 발생한 부분을 검출한다. 움직임이 발생한 영역은 가우시안 혼합 모 델(gaussian mixture model)에 기반한 영상차분을 통해 검출이 가능하고, 가우시안 필터를 이용한 혼합 모델링 방법은 영상의 강도 변화를 정확하게 나타낼 수 있다. K개의 가우시안분포로 모델링 되는 경우 휘도값 의 확 률은 다음 수학식 1이 적용된다.[수학식 1]"}
{"patent_id": "10-2020-0009018", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "여기서, 과 은 시간 t일 때 j번째 가우시안 분포의 가중치를 나타내며, 은 확률밀도함수를 정의하는 파라미터이다. 그리고, 는 가우시안 확률 분포함수를 나타내고 다음 수학식 2와 같이 표현된다. [수학식 2]"}
{"patent_id": "10-2020-0009018", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "K개의 가우시안 혼합을 배열하였을 때, 의 크기에 따라 다음 수학식 3을 만족하면 배경 모델로 사용한다. [수학식 3]"}
{"patent_id": "10-2020-0009018", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "여기서, 임계값 T는 배경 모델의 최소 비율에 해당된다. 이러한 입력 이미지의 영상 차분을 수행한 결과는 다음 도 5와 같다. 도 5는 본 발명의 일 실시예에 따른 입력 이미지의 영상 차분 결과를 보여주는 도면이다. 도 5를 참조하면, 입력 이미지의 영상 차분 결과, 움직임이 발생한 영역만을 필터링한 결과를 보여주고 있다. 두번째는 중심점을 구하기 위하여, 원본 이미지에서 움직임이 발생한 영역을 그레이 스케일(gray scale)로 색상 을 변환시킨다. 이때, 설정된 임계값 이하의 픽셀들은 흰색, 그 이상의 임계값을 갖는 픽셀은 검정색으로 이진 화 시킨다. 도 6은 본 발명의 일 실시예에 따른 이미지 모멘트를 구하기 위한 이진화 결과를 보여주는 도면이다. 도 6에서 보는 바와 같이, 흰색으로 이진화된 영역들 중 일정 크기 이하의 면적을 갖는 경우 필터링하여 무시되 도록 설정한다. 그 다음, 필터링된 객체의 윤곽선을 구하고 중심점을 구하는 과정을 진행하는 것으로서, 윤곽선의 면적에 따른 무게 중심점을 구한다. 중심점 좌표는 0차와 1차 공간 모멘트 요소들을 이용하여 다음 수학식 4와 같이 구할 수 있다. [수학식 4]"}
{"patent_id": "10-2020-0009018", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 5, "content": "여기서, 는 0차 모멘트로 전체 면적의 값이고, 1차 모멘트인 , 은 다음 수학식 5를 활용하여 계산 된다. [수학식 5]"}
{"patent_id": "10-2020-0009018", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 6, "content": "그 결과 도 7과 같이 무게 중심점을 구할 수 있다. 도 7은 본 발명의 일 실시예에 따른 이미지 모멘트를 이용한 객체의 중심점을 계산한 결과를 보여주는 도면이다. 그리고 y축을 기준으로 중심점 상단 부분에 대해서만 윤곽선을 다시 지정한다. 세 번째는 새로 지정된 상단 부분의 윤곽선도 완전한 다각형은 아니므로 적정량의 근사정확도를 부여하고, 꼭짓 점의 수를 줄여 원형, 삼각형 또는 사각형 등의 다각형 모양으로 결정될 수 있도록 윤곽선을 수정하는 단계를 수행한다. 그리고 꼭짓점의 수를 분석하여 삼각형으로 판별될 경우 추론을 위한 관심영역으로 지정한다. 도 8은 본 발명의 일 실시예에 따른 이미지에서 중심점 상단 부분의 근사화 및 삼각형 검출 결과를 보여주는 도 면이다. 도 8에서 삼각형을 검출한 결과를 보여주고 있다. 도 9는 본 발명의 일 실시예에 따른 최종 선정된 관심 영역을 보여주는 도면이다. 도 9는 최종적으로 선정된 관심영역을 보여주고 있으며, 해당 관심영역은 학습된 Faster R-CNN을 이 용하여 불꽃 여부를 추론하는 과정을 거치게 된다. 도 10은 Faster R-CNN의 전체 구조도이다. 도 10을 참조하면, Faster R-CNN은 컴퓨터 비전분야에서 객체 검출이나 객체 인식에 최근 많이 사용되는 인공지 능 기법으로서, 영상이 입력되면 합성곱 신경망 계층(Convolutional network layer, CNN layer)을 통하여 특징 맵(feature map)이 출력된다. 그리고, 특정맵은 RPN(Region Proposal Network)이라 불리는 뉴럴 네트워크를 거 쳐 검출 대상의 후보영역(region proposal)을 생성하고 관심영역(RoI)을 추출한다. 추출된 영역들은 RoI 풀링 계층(RoI pooling layer)을 거쳐 고정된 크기의 단일벡터로 변환되고, 완전 연결계층(Fully connected layer, FCs)을 통하여 정확한 라벨 예측을 위한 가중치가 적용되고, 각 라벨에 대한 최종 확률을 제공한다. 그리고 소 프트맥스 분류기(Softmax classifier)와 바운딩박스 복호기(Bounding box regressor) 등을 통하여 객체를 최종 분류하는 알고리즘을 수행한다. 도 11은 본 발명의 일 실시예에 따른 이미지 어피어런스 알고리즘을 적용한 Faster R-CNN의 구조도이다. 도 11에서 보는 바와 같이, 본 발명에서는 전술한 Faster R-CNN의 전 과정을 수행하여 불꽃을 감지하는 기존의 인공지능형 불꽃감지기와는 달리, 이미지 어피어런스 네트워크를 통하여 불꽃에 대한 특징맵과 관심영역(RoI)을 미리 추출하여 Faster R-CNN의 상위 알고리즘에 적용되므로, 화재감지에 대한 응답 속응성이 우수하고 영상 전 처리를 통한 신뢰성이 확보된다. 도 12는 본 발명에 의해 실제 제작된 인공지능형 불꽃 감지 장치의 시제품을 보여주는 도면이다. 도 12는 본 발명에서 제안한 인공지능형 불꽃감지기를 CCTV 모형으로 제작한 것을 보여주고 있다. 도 13은 본 발명의 작동 실험 결과를 보여주는 동작특성 파형도이다. 도 13에서 (a)는 720p(progressive) 해상도에서 속응성 시험을 한 결과이고, (b)는 1080p 해상도에서 속응성 시 험을 한 결과로서, 실제 화재로부터 영상을 입력받아 최종적으로 화재 발생을 알리는 시점을 보여주는 동작특성 파형이다. 도 13의 (a), (b)에서 A 지점은 화재영상 입력 시점이고 B는 인공지능을 통해 화재를 감지하여 신호를 발생시키 는 시점으로, 영상 전처리와 합성곱 신경망 모델의 추론까지 720p 해상도에서 1.1초가 소요되고, 1080p 해상도 에서 1.9초가 소요되는 양호한 결과를 나타낸 것을 확인할 수 있다. 이상 본 발명을 몇 가지 바람직한 실시예를 사용하여 설명하였으나, 이들 실시예는 예시적인 것이며 한정적인"}
{"patent_id": "10-2020-0009018", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 7, "content": "것이 아니다. 본 발명이 속하는 기술분야에서 통상의 지식을 지닌 자라면 본 발명의 사상과 첨부된 특허청구범 위에 제시된 권리범위에서 벗어나지 않으면서 다양한 변화와 수정을 가할 수 있음을 이해할 것이다.부호의 설명 100 불꽃 감지 장치 110 이미지 어피어런스부 120 추론부"}
{"patent_id": "10-2020-0009018", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 일 실 실시예에 따른 이미지 어피어런스 알고리즘을 나타낸 흐름도이다. 도 2는 본 발명의 일 실시예에 따른 인공지능을 이용한 불꽃 감지 방법을 보여주는 흐름도이다. 도 3은 본 발명의 일 실시예에 따른 인공지능을 이용한 불꽃 감지 장치의 내부 구성을 보여주는 블록도이다. 도 4는 본 발명의 일 실시예에 따른 원본 입력 이미지이다. 도 5는 본 발명의 일 실시예에 따른 입력 이미지의 영상 차분 결과를 보여주는 도면이다. 도 6은 본 발명의 일 실시예에 따른 이미지 모멘트를 구하기 위한 이진화 결과를 보여주는 도면이다. 도 7은 본 발명의 일 실시예에 따른 이미지 모멘트를 이용한 객체의 중심점을 계산한 결과를 보여주는 도면이다. 도 8은 본 발명의 일 실시예에 따른 이미지에서 중심점 상단 부분의 근사화 및 삼각형 검출 결과를 보여주는 도 면이다. 도 9는 본 발명의 일 실시예에 따른 최종 선정된 관심 영역을 보여주는 도면이다. 도 10은 Faster R-CNN의 전체 구조도이다. 도 11은 본 발명의 일 실시예에 따른 이미지 어피어런스 알고리즘을 적용한 Faster R-CNN의 구조도이다. 도 12는 본 발명에 의해 실제 제작된 인공지능형 불꽃 감지 장치의 시제품을 보여주는 도면이다. 도 13은 본 발명의 작동 실험 결과를 보여주는 동작특성 파형도이다."}
