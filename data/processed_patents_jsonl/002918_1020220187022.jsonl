{"patent_id": "10-2022-0187022", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2023-0100692", "출원번호": "10-2022-0187022", "발명의 명칭": "이미지 분류용 인공지능 모델의 학습 방법 및 이를 컴퓨터에서 실행시키기 위한 프로그램이", "출원인": "한국과학기술원", "발명자": "최호진"}}
{"patent_id": "10-2022-0187022", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "각각의 학습 이미지들을 샘플링(sampling)하여 제1 패치들을 생성하는 단계;상기 제1 패치들을 사용하여 인공지능 모델을 학습시키는 단계; 및테스트 이미지를 사용하여 인공지능 모델을 검증하는 단계를 포함하는 이미지 분류용 인공지능 모델의 학습 방법."}
{"patent_id": "10-2022-0187022", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제 1 항에 있어서, 상기 인공지능 모델은 복수의 이미지들을 사용하여 학습된 사전 학습 모델을 기초로 생성되는 것을 특징으로 하는 이미지 분류용 인공지능 모델의 학습 방법."}
{"patent_id": "10-2022-0187022", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제 2 항에 있어서, 상기 인공지능 모델은 상기 사전 학습 모델에서 상기 사전 학습 모델의 출력 레이어를 제거하고, 상기 학습 이미지들에 상응하는 출력 레이어를 추가하여 생성되는 것을 특징으로 하는 이미지 분류용 인공지능 모델의 학습 방법."}
{"patent_id": "10-2022-0187022", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제 3 항에 있어서, 상기 학습 이미지들에 상응하는 상기 출력 레이어는 상기 학습 이미지들의 라벨(label)들의개수와 동일한 출력 크기를 갖는 것을 특징으로 하는 이미지 분류용 인공지능 모델의 학습 방법."}
{"patent_id": "10-2022-0187022", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제 1 항에 있어서, 상기 제1 패치들은 각각의 상기 학습 이미지들의 랜덤한 위치에서 샘플링되어 생성되는 것을특징으로 하는 이미지 분류용 인공지능 모델의 학습 방법."}
{"patent_id": "10-2022-0187022", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제 1 항에 있어서, 각각의 상기 제1 패치들의 크기는 상기 인공지능 모델이 요구하는 입력 이미지의 크기와 동일한 것을 특징으로 하는 이미지 분류용 인공지능 모델의 학습 방법."}
{"patent_id": "10-2022-0187022", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제 1 항에 있어서, 상기 제1 패치들 각각은 각각의 상기 학습 이미지들의 배경을 기준 비율 이하로 포함하는 것을 특징으로 하는 이미지 분류용 인공지능 모델의 학습 방법."}
{"patent_id": "10-2022-0187022", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제 1 항에 있어서, 각각의 상기 학습 이미지들의 샘플링은 상기 제1 패치들의 개수가 기준 개수가 될 때까지 반복되는 것을 특징으로 하는 이미지 분류용 인공지능 모델의 학습 방법."}
{"patent_id": "10-2022-0187022", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제 1 항에 있어서, 상기 제1 패치들의 라벨은 샘플링의 기초가 된 각각의 상기 학습 이미지들의 라벨과 동일한것을 특징으로 하는 이미지 분류용 인공지능 모델의 학습 방법."}
{"patent_id": "10-2022-0187022", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제 1 항에 있어서, 상기 인공지능 모델은 상기 제1 패치들에 이미지 증강(image augmentation) 기법을 적용하여생성된 증강 패치들을 사용하여 학습되는 것을 특징으로 하는 이미지 분류용 인공지능 모델의 학습 방법.공개특허 10-2023-0100692-3-청구항 11 제 10 항에 있어서, 상기 이미지 증강 기법은 좌우 반전(horizontal flip) 기법, 상하 반전(vertical flip) 기법, 잘라내기(crop) 기법, 확대(scale) 기법, 이동(translation) 기법, 회전(rotation) 기법, 밀림(shear) 기법, 가우시안 블러(Gaussian blur) 기법, 이미지 대비(image contrast) 기법, 가우시안 노이즈(Gaussiannoise) 기법, 이미지 밝기(image brightness) 기법, 및 탄성 변환(elastic transformation) 기법 중 적어도 하나를 포함하는 것을 특징으로 하는 이미지 분류용 인공지능 모델의 학습 방법."}
{"patent_id": "10-2022-0187022", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제 10 항에 있어서, 상기 이미지 증강 기법은 좌우 반전 기법, 상하 반전 기법, 잘라내기 기법, 확대 기법, 이동 기법, 회전 기법, 밀림 기법, 가우시안 블러 기법, 이미지 대비 기법, 가우시안 노이즈 기법, 이미지 밝기기법, 및 탄성 변환 기법을 포함하고,상기 제1 패치들은제1 확률로 상기 좌우 반전 기법이 적용되고,제2 확률로 상기 상하 반전 기법이 적용되며,제3 확률로 상기 잘라내기 기법이 적용되고,제4 확률로 확대 기법이 적용되고,제5 확률로 상기 이동 기법이 적용되며,제6 확률로 상기 회전 기법이 적용되고,제7 확률로 상기 밀림 기법이 적용되며,제8 확률로 상기 가우시안 블러 기법이 적용되고,제9 확률로 상기 이미지 대비 기법이 적용되며,제10 확률로 상기 가우시안 노이즈 기법이 적용되고,제11 확률로 상기 이미지 밝기 기법이 적용되며,제12 확률로 상기 탄성 변환 기법이 적용되는 것을 특징으로 하는 이미지 분류용 인공지능 모델의 학습 방법."}
{"patent_id": "10-2022-0187022", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "제 12 항에 있어서, 상기 제1 및 제2 확률은 동일하고, 상기 제3 내지 제12 확률은 동일한 것을 특징으로 하는이미지 분류용 인공지능 모델의 학습 방법."}
{"patent_id": "10-2022-0187022", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_14", "content": "제 13 항에 있어서, 상기 제1 및 제2 확률은 상기 제3 내지 제12 확률보다 큰 것을 특징으로 하는 이미지 분류용 인공지능 모델의 학습 방법."}
{"patent_id": "10-2022-0187022", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_15", "content": "제 1 항에 있어서, 상기 인공지능 모델을 검증하는 단계는상기 테스트 이미지를 샘플링하여 제2 패치들을 생성하는 단계; 및상기 제2 패치들을 사용하여 상기 인공지능 모델을 검증하는 단계를 포함하는 이미지 분류용 인공지능 모델의학습 방법."}
{"patent_id": "10-2022-0187022", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_16", "content": "제 15 항에 있어서, 상기 제2 패치들은 서로 겹치지 않는 것을 특징으로 하는 이미지 분류용 인공지능 모델의학습 방법.공개특허 10-2023-0100692-4-청구항 17 제 15 항에 있어서, 상기 테스트 이미지는 상기 학습 이미지들과 동일한 방식으로 샘플링되는 것을 특징으로 하는 이미지 분류용 인공지능 모델의 학습 방법."}
{"patent_id": "10-2022-0187022", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_18", "content": "제1항 내지 제17항 중 어느 한 항의 방법을 컴퓨터에서 실행시키기 위한 프로그램이 기록된 컴퓨터로 읽을 수있는 기록 매체."}
{"patent_id": "10-2022-0187022", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "이미지 분류용 인공지능 모델의 학습 방법은 각각의 학습 이미지들을 샘플링(sampling)하여 제1 패치들을 생성하 는 단계, 상기 제1 패치들을 사용하여 인공지능 모델을 학습시키는 단계, 및 테스트 이미지를 사용하여 인공지능 모델을 검증하는 단계를 포함한다."}
{"patent_id": "10-2022-0187022", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 이미지 분류용 인공지능 모델의 학습 방법 및 이를 컴퓨터에서 실행시키기 위한 프로그램이 기록된 컴퓨터로 읽을 수 있는 기록 매체에 관한 것이다. 보다 상세하게는, 병리 이미지들을 분류하는 이미지 분류용 인공지능 모델의 학습 방법 및 이를 컴퓨터에서 실행시키기 위한 프로그램이 기록된 컴퓨터로 읽을 수 있는 기 록 매체에 관한 것이다."}
{"patent_id": "10-2022-0187022", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "CNN(Convolutional Neural Network)을 활용한 최근의 딥 러닝(deep learning) 기술은 모델에 입력으로 주어진 이미지가 어떤 클래스 라벨(label)에 속하는지 예측하는 이미지 분류(image classification) 분야에서 매우 높 은 성능을 보인다. 이미지 분류를 위한 딥 러닝 모델 학습을 위해서는 이미지뿐만 아니라 그 이미지가 어떤 분 류에 속하는지를 나타내는 라벨이 모델에 함께 주어져야 한다. 이렇게 이미지와 그에 따른 라벨이 주어지면 딥 러닝 모델은 실제 정답 라벨과 유사한 예측을 내놓을 수 있도록 모델 내의 가중치를 조정하는 방식으로 학습을 진행한다. 이 때, 딥 러닝 모델의 측면에서 입력으로 주어지는 이미지는 특정 범위 내의 실수들로 이루어진 배 열이기 때문에 딥 러닝 모델의 역할은 이미지 크기의 긴 배열을 입력으로 받아 배열의 값들을 하나의 라벨로 결 정짓는 것으로 생각할 수 있다. 최근에는 이러한 CNN 기반 딥 러닝 기술을 암 세포 검출, 종양 하위유형 분류, 질병 진단 등 병리 이미지나 의 료 도메인에 활용하려는 움직임이 늘고 있다. 그러나, 딥 러닝 모델이 높은 예측 정확도를 갖기 위해서는 많은 양의 학습 이미지 및 라벨이 요구된다는 단점이 존재하며, 충분한 양의 학습 이미지를 얻기 힘든 도메인의 경우 딥 러닝 모델을 활용하기 어려울 수 있다. 그러한 점에서, 의료 도메인 데이터의 경우 충분한 양의 데이터를 얻 기 어렵다는 점과 질병 양성군, 음성군 등 데이터 라벨 측면에서 데이터가 불균형하다는 문제가 존재한다."}
{"patent_id": "10-2022-0187022", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명의 일 목적은 패치들을 사용하는 이미지 분류용 인공지능 모델의 학습 방법을 제공하는 것이다. 본 발명의 다른 목적은 이미지 분류용 인공지능 모델의 학습 방법을 컴퓨터에서 실행시키기 위한 프로그램이 기 록된 컴퓨터로 읽을 수 있는 기록 매체를 제공하는 것이다. 다만, 본 발명의 해결하고자 하는 과제는 상기 언급된 과제에 한정되는 것이 아니며, 본 발명의 사상 및 영역으 로부터 벗어나지 않는 범위에서 다양하게 확장될 수 있을 것이다."}
{"patent_id": "10-2022-0187022", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명의 일 목적을 달성하기 위하여, 본 발명의 실시예들에 따른 이미지 분류용 인공지능 모델의 학습 방법은 각각의 학습 이미지들을 샘플링(sampling)하여 제1 패치들을 생성하는 단계, 상기 제1 패치들을 사용하여 인공 지능 모델을 학습시키는 단계, 및 테스트 이미지를 사용하여 인공지능 모델을 검증하는 단계를 포함할 수 있다. 일 실시예에 있어서, 상기 인공지능 모델은 복수의 이미지들을 사용하여 학습된 사전 학습 모델을 기초로 생성 될 수 있다. 일 실시예에 있어서, 상기 인공지능 모델은 상기 사전 학습 모델에서 상기 사전 학습 모델의 출력 레이어를 제 거하고, 상기 학습 이미지들에 상응하는 출력 레이어를 추가하여 생성될 수 있다. 일 실시예에 있어서, 상기 학습 이미지들에 상응하는 상기 출력 레이어는 상기 학습 이미지들의 라벨(label)들 의 개수와 동일한 출력 크기를 가질 수 있다. 일 실시예에 있어서, 상기 제1 패치들은 각각의 상기 학습 이미지들의 랜덤한 위치에서 샘플링되어 생성될 수 있다. 일 실시예에 있어서, 각각의 상기 제1 패치들의 크기는 상기 인공지능 모델이 요구하는 입력 이미지의 크기와 동일할 수 있다. 일 실시예에 있어서, 상기 제1 패치들 각각은 각각의 상기 학습 이미지들의 배경을 기준 비율 이하로 포함할 수 있다. 일 실시예에 있어서, 각각의 상기 학습 이미지들의 샘플링은 상기 제1 패치들의 개수가 기준 개수가 될 때까지 반복될 수 있다. 일 실시예에 있어서, 상기 제1 패치들의 라벨은 샘플링의 기초가 된 각각의 상기 학습 이미지들의 라벨과 동일 할 수 있다. 일 실시예에 있어서, 상기 인공지능 모델은 상기 제1 패치들에 이미지 증강(image augmentation) 기법을 적용하 여 생성된 증강 패치들을 사용하여 학습될 수 있다. 일 실시예에 있어서, 상기 이미지 증강 기법은 좌우 반전(horizontal flip) 기법, 상하 반전(vertical flip) 기법, 잘라내기(crop) 기법, 확대(scale) 기법, 이동(translation) 기법, 회전(rotation) 기법, 밀림(shear) 기법, 가우시안 블러(Gaussian blur) 기법, 이미지 대비(image contrast) 기법, 가우시안 노이즈(Gaussian noise) 기법, 이미지 밝기(image brightness) 기법, 및 탄성 변환(elastic transformation) 기법 중 적어도 하 나를 포함할 수 있다. 일 실시예에 있어서, 상기 이미지 증강 기법은 좌우 반전 기법, 상하 반전 기법, 잘라내기 기법, 확대 기법, 이 동 기법, 회전 기법, 밀림 기법, 가우시안 블러 기법, 이미지 대비 기법, 가우시안 노이즈 기법, 이미지 밝기 기법, 및 탄성 변환 기법을 포함하고, 상기 제1 패치들은 제1 확률로 상기 좌우 반전 기법이 적용되고, 제2 확 률로 상기 상하 반전 기법이 적용되며, 제3 확률로 상기 잘라내기 기법이 적용되고, 제4 확률로 확대 기법이 적 용되고, 제5 확률로 상기 이동 기법이 적용되며, 제6 확률로 상기 회전 기법이 적용되고, 제7 확률로 상기 밀림 기법이 적용되며, 제8 확률로 상기 가우시안 블러 기법이 적용되고, 제9 확률로 상기 이미지 대비 기법이 적용 되며, 제10 확률로 상기 가우시안 노이즈 기법이 적용되고, 제11 확률로 상기 이미지 밝기 기법이 적용되며, 제 12 확률로 상기 탄성 변환 기법이 적용될 수 있다. 일 실시예에 있어서, 상기 제1 및 제2 확률은 동일하고, 상기 제3 내지 제12 확률은 동일할 수 있다. 일 실시예에 있어서, 상기 제1 및 제2 확률은 상기 제3 내지 제12 확률보다 클 수 있다. 일 실시예에 있어서, 상기 인공지능 모델을 검증하는 단계는 상기 테스트 이미지를 샘플링하여 제2 패치들을 생 성하는 단계, 및 상기 제2 패치들을 사용하여 상기 인공지능 모델을 검증하는 단계를 포함할 수 있다. 일 실시예에 있어서, 상기 제2 패치들은 서로 겹치지 않을 수 있다. 일 실시예에 있어서, 상기 테스트 이미지는 상기 학습 이미지들과 동일한 방식으로 샘플링될 수 있다. 본 발명의 다른 목적을 달성하기 위하여, 본 발명의 실시예들에 따른 이미지 분류용 인공지능 모델의 학습 방법 을 컴퓨터에서 실행시키기 위한 프로그램은 컴퓨터로 읽을 수 있는 기록 매체에 기록될 수 있다."}
{"patent_id": "10-2022-0187022", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명의 실시예들에 따른 이미지 분류용 인공지능 모델의 학습 방법은 패치들, 이미지 증강, 및/또는 전이 학 습(transfer learning)을 사용하여 인공지능 모델을 학습시킴으로써, 적은 학습 이미지로도 안정적으로 인공지 능 모델을 학습시킬 수 있다. 본 발명의 실시예들에 따른 이미지 분류용 인공지능 모델의 학습 방법은 패치들 및/또는 이미지 증강을 사용하 여 인공지능 모델을 학습시킴으로써, 불균형한 학습 이미지로도 안정적으로 인공지능 모델을 학습시킬 수 있다.본 발명의 실시예들에 따른 이미지 분류용 인공지능 모델의 학습 방법은 패치들을 사용하여 인공지능 모델을 검 증함으로써, 효과적으로 인공지능 모델을 검증할 수 있다."}
{"patent_id": "10-2022-0187022", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 2, "content": "다만, 본 발명의 효과는 상술한 효과에 한정되는 것이 아니며, 본 발명의 사상 및 영역으로부터 벗어나지 않는 범위에서 다양하게 확장될 수 있을 것이다."}
{"patent_id": "10-2022-0187022", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하, 첨부한 도면들을 참조하여, 본 발명을 보다 상세하게 설명하고자 한다. 본문에 개시되어 있는 본 발명의 실시예들에 대해서, 특정한 구조적 내지 기능적 설명들은 단지 본 발명의 실시 예를 설명하기 위한 목적으로 예시된 것으로, 본 발명의 실시예들은 다양한 형태로 실시될 수 있으며 본문에 설 명된 실시예들에 한정되는 것으로 해석되어서는 아니 된다. 본 발명은 다양한 변경을 가할 수 있고 여러 가지 형태를 가질 수 있는바, 특정 실시예들을 도면에 예시하고 본 문에 상세하게 설명하고자 한다. 그러나 이는 본 발명을 특정한 개시 형태에 대해 한정하려는 것이 아니며, 본 발명의 사상 및 기술 범위에 포함되는 모든 변경, 균등물 내지 대체물을 포함하는 것으로 이해되어야 한다. 제1, 제2 등의 용어는 다양한 구성요소들을 설명하는데 사용될 수 있지만, 상기 구성요소들은 상기 용어들에 의 해 한정되어서는 안 된다. 상기 용어들은 하나의 구성요소를 다른 구성요소로부터 구별하는 목적으로 사용될 수 있다. 예를 들어, 본 발명의 권리 범위로부터 이탈되지 않은 채 제1 구성요소는 제2 구성요소로 명명될 수 있고, 유사하게 제2 구성요소도 제1 구성요소로 명명될 수 있다. 어떤 구성요소가 다른 구성요소에 \"연결되어\" 있다거나 \"접속되어\" 있다고 언급된 때에는, 그 다른 구성요소에 직접적으로 연결되어 있거나 또는 접속되어 있을 수도 있지만, 중간에 다른 구성요소가 존재할 수도 있다고 이 해되어야 할 것이다. 반면에, 어떤 구성요소가 다른 구성요소에 \"직접 연결되어\" 있다거나 \"직접 접속되어\" 있 다고 언급된 때에는, 중간에 다른 구성요소가 존재하지 않는 것으로 이해되어야 할 것이다. 구성요소들 간의 관 계를 설명하는 다른 표현들, 즉 \"~사이에\"와 \"바로 ~사이에\" 또는 \"~에 이웃하는\"과 \"~에 직접 이웃하는\" 등도 마찬가지로 해석되어야 한다. 본 출원에서 사용한 용어는 단지 특정한 실시예를 설명하기 위해 사용된 것으로, 본 발명을 한정하려는 의도가 아니다. 단수의 표현은 문맥상 명백하게 다르게 뜻하지 않는 한, 복수의 표현을 포함한다. 본 출원에서, \"포함 하다\" 또는 \"가지다\" 등의 용어는 기재된 특징, 숫자, 단계, 동작, 구성요소, 부분품 또는 이들을 조합한 것이 존재함을 지정하려는 것이지, 하나 또는 그 이상의 다른 특징들이나 숫자, 단계, 동작, 구성요소, 부분품 또는 이들을 조합한 것들의 존재 또는 부가 가능성을 미리 배제하지 않는 것으로 이해되어야 한다. 다르게 정의되지 않는 한, 기술적이거나 과학적인 용어를 포함해서 여기서 사용되는 모든 용어들은 본 발명이 속하는 기술 분야에서 통상의 지식을 가진 자에 의해 일반적으로 이해되는 것과 동일한 의미이다. 일반적으로 사용되는 사전에 정의되어 있는 것과 같은 용어들은 관련 기술의 문맥상 가지는 의미와 일치하는 의미인 것으로 해석되어야 하며, 본 출원에서 명백하게 정의하지 않는 한, 이상적이거나 과도하게 형식적인 의미로 해석되지 않는다. 한편, 어떤 실시예가 달리 구현 가능한 경우에 특정 블록 내에 명기된 기능 또는 동작이 순서도에 명기된 순서 와 다르게 일어날 수도 있다. 예를 들어, 연속하는 두 블록이 실제로는 실질적으로 동시에 수행될 수도 있고, 관련된 기능 또는 동작에 따라서는 상기 블록들이 거꾸로 수행될 수도 있다. 이하, 첨부한 도면들을 참조하여, 본 발명의 바람직한 실시예를 보다 상세하게 설명하고자 한다. 도면상의 동일 한 구성요소에 대해서는 동일한 참조부호를 사용하고 동일한 구성요소에 대해서 중복된 설명은 생략한다. 도 1은 본 발명의 실시예들에 따른 이미지 분류용 인공지능 모델의 학습 방법을 나타내는 순서도이다. 도 1을 참조하면, 이미지 분류용 인공지능 모델의 학습 방법은 각각의 학습 이미지들을 샘플링(sampling)하여 제1 패치들을 생성(S100)하고, 제1 패치들을 사용하여 인공지능 모델을 학습(S200)시키며, 테스트 이미지를 사 용하여 인공지능 모델을 검증(S300)할 수 있다. 이하, 도 2 내지 도 6을 참조하여 구체적으로 설명한다. 도 2는 도 1의 이미지 분류용 인공지능 모델의 학습 방법에 따른 전이 학습의 일 예를 나타내는 도면이다. 도 2를 참조하면, 인공지능 모델은 복수의 이미지들을 사용하여 학습된 사전 학습 모델을 기초로 생성 될 수 있다. 인공지능 모델은 사전 학습 모델 기반의 전이 학습을 통하여 학습될 수 있다. 인공지능 모델은 딥 러닝 모델일 수 있다. 딥 러닝 모델이 높은 예측 정확도를 갖기 위해서는 많은 양의 학 습 이미지 및 라벨이 요구될 수 있다. 따라서, 충분한 양의 데이터를 얻기 힘든 도메인의 경우 딥 러닝 모델을 활용하기 어려울 수 있다. 전이학습은 이러한 문제점을 해결해줄 수 있는 방안 중 하나로, 특정 분야에서 학습된 딥 러닝 모델의 가중치를 불러와 해결하고자 하는 문제에 맞게 약간의 보정을 거치는 과정을 의미한다. 이미지 분류 학습을 위하여 전이 학습을 활용할 경우 ResNet, VGG 등의 CNN 층들이 가지는 이미지 특징 추출 능력 활용하기 위해 대용량의 이미 지로 사전 학습된 모델(즉, 사전 학습 모델) 전체의 가중치를 불러온 뒤에 마지막 출력 레이어만 새로운 가 중치로 초기화된 레이어로 교체한 뒤 학습하는 방식으로 재학습이 이루어진다. 전이학습을 활용하면 학습 이미 지의 수가 상대적으로 적은 경우에도 효과적으로 학습을 수행할 수 있으며 조정해야 할 가중치의 수가 적기 때 문에 학습 속도도 빠를 수 있다. 인공지능 모델은 사전 학습 모델에서 사전 학습 모델의 출력 레이어를 제거하고, 학습 이미지 들에 상응하는 출력 레이어를 추가하여 생성될 수 있다. 예를 들어, 사전 학습 모델은 ResNet, VGG 등 대용량 이미지 데이터로부터 학습된 모델들 중 하나일 수 있다. 예를 들어, 도 1의 이미지 분류용 인공지능 모델의 학습 방법은 전이 학습을 위하여 사전 학습 모델의 가중 치들을 모두 불러온 뒤에 사전 학습 모델의 가중치들이 변경되는 것을 방지하기 위해 인공지능 모델의 학습 동안 사전 학습 모델의 가중치들이 수정되지 않도록 설정할 수 있다. 그리고, 도 1의 이미지 분류용 인공지능 모델의 학습 방법은 사전 학습 모델의 출력 레이어를 제거하고, 학습 이미지들에 상응하는 출 력 레이어를 추가하며, 학습 이미지들에 상응하는 출력 레이어의 가중치들을 무작위로 초기화시킬 수 있다. 인공지능 모델이 학습되는 동안, 새롭게 추가된 출력 레이어(즉, 학습 이미지들에 상응하는 출력 레 이어)의 가중치만이 학습되고, 사전 학습 모델이 갖고 있는 이미지 특성 추출 능력은 그대로 활용될 수 있다. 일 실시예에서, 출력 레이어(11, 21)는 완전 연결 레이어(fully connected layer)일 수 있다. 예를 들어, 인공 지능 모델은 사전 학습 모델에서 사전 학습 모델의 완전 연결 레이어를 제거하고, 학습 이미지들에 상응하는 완전 연결 레이어를 추가하여 생성될 수 있다. 학습 이미지들에 상응하는 출력 레이어는 학습 이미지들의 라벨들의 개수와 동일한 출력 크기를 가질 수 있 다. 예를 들어, 학습 이미지들이 3 종류의 라벨들로 라벨링(labeling)된 경우, 학습 이미지들에 상응하는 출력 레이어의 출력 크기는 3일 수 있다. 예를 들어, 출력 크기는 출력의 스칼라(scalar)의 수일 수 있다. 예를 들어, 출력 크기는 출력 벡터의 길이일 수 있다. 도 3은 도 1의 이미지 분류용 인공지능 모델의 학습 방법에 따른 제1 패치들(P1)의 일 예를 나타내는 도면이다. 도 2 및 도 3을 참조하면, 도 1의 이미지 분류용 인공지능 모델의 학습 방법은 각각의 학습 이미지들을 샘 플링하여 제1 패치들(P1)을 생성할 수 있다. 예를 들어, 인공지능 모델의 학습을 위한 원본 이미지들을 학 습 이미지 및 테스트 이미지(도 6의 200)로 분류할 수 있다. 본 발명은 학습 이미지 및 테스트 이미 지(도 6의 200)의 비율에 한정되지 않는다.예를 들어, 병리 이미지들을 분류하는 이미지 분류용 인공지능 모델에서 원본 이미지들은 현미경 등으로 관찰한 조직 이미지 등 병리 이미지들일 수 있다. 일 실시예에서, 각각의 제1 패치들(P1)의 크기는 인공지능 모델이 요구하는 입력 이미지의 크기와 동일할 수 있다. 예를 들어, 현미경 등으로 관찰한 병리 이미지들은 대체로 고화질과 큰 이미지 크기를 가질 수 있다. 이와 같은 고화질의 병리 이미지들을 인공지능 모델이 요구하는 입력 이미지의 크기로 맞추기 위해 다운 표본화를 진 행한다면 고화질의 병리 이미지로부터 손실되는 정보들이 생길 수 있다. 따라서, 도 1의 이미지 분류용 인공지능 모델의 학습 방법은 학습 이미지의 크기를 조절하지 않고, 학습 이미지 로부터 모델이 요구하는 입력 이미지의 크기를 갖는 작은 이미지들을 잘라낸 패치들(즉, 제1 패치(P1))을 사용할 수 있다. 일 실시예에서, 제1 패치들(P1)은 각각의 학습 이미지들의 랜덤한 위치에서 샘플링되어 생성될 수 있다. 예를 들어, 제1 패치들(P1)은 학습 이미지들내에서 인공지능 모델의 입력 이미지의 크기로 랜덤하게 선택될 수 있다. 일 실시예에서, 제1 패치들(P1) 각각은 각각의 학습 이미지들의 배경을 기준 비율 이하로 포함할 수 있다. 즉, 도 1의 이미지 분류용 인공지능 모델의 학습 방법은 랜덤하게 선택된 패치들 중 배경을 기준 비율 이하로 포함하는 패치들만을 제1 패치들(P1)로 결정할 수 있다. 예를 들어, 기준 비율은 기 설정된 비율일 수 있다. 배경이 많이 포함된 패치는 배경이 적게 포함된 패치보다 갖고 있는 정보가 적으므로, 배경이 많이 포함된 패치 는 인공지능 모델의 학습에 방해가 될 수 있다. 따라서, 도 1의 이미지 분류용 인공지능 모델은 배경이 많 이 포함된 패치를 인공지능 모델의 학습에 사용하지 않을 수 있다. 예를 들어, 기준 비율은 50%일 수 있다. 도 3에 나타난 바와 같이, 배경을 50% 초과하여 포함하는 패치는 인공 지능 모델의 학습에 사용되지 않고, 배경을 50% 이하로 포함하는 패치들(즉, 제1 패치(P1))만이 인공지능 모델의 학습에 사용될 수 있다. 학습 이미지들의 샘플링은 제1 패치들(P1)의 개수가 기준 개수가 될 때까지 반복될 수 있다. 따라서, 제1 패치들(P1)은 인공지능 모델의 학습에 필요한 만큼 확보될 수 있다. 예를 들어, 기준 개수는 기 설정된 개 수일 수 있다. 제1 패치들(P1)의 라벨은 샘플링의 기초가 된 각각의 학습 이미지들의 라벨과 동일할 수 있다. 예를 들어, 학습 이미지들이 종양 3기의 조직 사진과 종양 4기의 조직 사진이고, 종양 4기로 라벨링된 학습 이미지 로부터 샘플링된 제1 패치(P1)의 라벨은 종양 4기가 될 수 있다. 도 4는 도 1의 이미지 분류용 인공지능 모델의 학습 방법에 따른 이미지 증강(image augmentation) 기법의 적용 확률을 나타내는 표이고, 도 5는 도 1의 이미지 분류용 인공지능 모델의 학습 방법에 따른 이미지 증강 기법이 적용된 결과의 일 예를 나타내는 도면이다. 도 2 내지 도 5를 참조하면, 인공지능 모델은 제1 패치들(P1)에 이미지 증강 기법을 적용하여 생성된 증강 패치들(AP)을 사용하여 학습될 수 있다. 제1 패치들(P1)을 학습에 그대로 적용시키는 대신 제1 패치들(P1)에 이미지 증강 기법을 적용하면, 하나의 제1 패치(P1)에 대해서도 다양한 변형 패치들이 생성될 수 있다. 이는 데이터의 양을 늘릴 뿐만 아니라, 인공지능 모델의 과대적합 가능성을 낮추고, 학습 성능을 향상시킬 수 있다. 이미지 증강 기법은 좌우 반전(horizontal flip) 기법, 상하 반전(vertical flip) 기법, 잘라내기(crop) 기법, 확대(scale) 기법, 이동(translation) 기법, 회전(rotation) 기법, 밀림(shear) 기법, 가우시안 블러(Gaussian blur) 기법, 이미지 대비(image contrast) 기법, 가우시안 노이즈(Gaussian noise) 기법, 이미지 밝기(image brightness) 기법, 및 탄성 변환(elastic transformation) 기법 중 적어도 하나일 수 있다. 일 실시예에서, 이미지 증강 기법은 좌우 반전 기법, 상하 반전 기법, 잘라내기 기법, 확대 기법, 이동 기법, 회전 기법, 밀림 기법, 가우시안 블러 기법, 이미지 대비 기법, 가우시안 노이즈 기법, 이미지 밝기 기법, 및 탄성 변환 기법을 포함하고, 이미지 증강 기법은 미리 정의된 확률에 따라 수행될 수 있다. 각각의 기법이 적용 될 확률은 독립적으로 계산되어 경우에 따라 여러 연산이 하나의 제1 패치(P1)에 적용될 수 있다.일 실시예에서, 제1 확률로 상기 좌우 반전 기법이 적용되고, 제2 확률로 상기 상하 반전 기법이 적용되며, 제3 확률로 상기 잘라내기 기법이 적용되고, 제4 확률로 확대 기법이 적용되고, 제5 확률로 상기 이동 기법이 적용 되며, 제6 확률로 상기 회전 기법이 적용되고, 제7 확률로 상기 밀림 기법이 적용되며, 제8 확률로 상기 가우시 안 블러 기법이 적용되고, 제9 확률로 상기 이미지 대비 기법이 적용되며, 제10 확률로 상기 가우시안 노이즈 기법이 적용되고, 제11 확률로 상기 이미지 밝기 기법이 적용되며, 제12 확률로 상기 탄성 변환 기법이 적용될 수 있다. 일 실시예에서, 상기 제1 및 제2 확률은 동일하고, 상기 제3 내지 제12 확률은 동일할 수 있다. 일 실시예에서, 상기 제1 및 제2 확률은 상기 제3 내지 제12 확률보다 클 수 있다. 예를 들어, 도 4에 나타난 바와 같이, 좌우 반전 기법 및 상하 반전 기법이 적용될 확률은 50%이고, 잘라내기 기법, 확대 기법, 이동 기법, 회전 기법, 밀림 기법, 가우시안 블러 기법, 이미지 대비 기법, 가우시안 노이즈 기법, 이미지 밝기 기법, 및 탄성 변환 기법이 적용될 확률은 30%일 수 있다. 일 실시예에서, 확대 기법, 이동 기법, 회전 기법, 및 밀림 기법은 동시에 적용될 수 있다. 예를 들어, 잘라내 기 기법, 확대 기법, 이동 기법, 회전 기법, 및 밀림 기법은 30% 확률로 동시에 적용될 수 있다. 예를 들어, 제1 패치들(P1)은 여러 연산이 한 패치에 적용될 수 있다. 예를 들어, 도 5에 나타난 바와 같이, 잘 라내기 기법, 이미지 밝기 기법, 및 이미지 대비 기법이 적용된 증강 패치(AP)가 생성될 수 있다. 예를 들어, 도 5에 나타난 바와 같이, 확대 기법, 이동 기법, 회전 기법, 밀림 기법, 좌우 반전 기법, 상하 반전 기법, 및 이미지 밝기 기법이 적용된 증강 패치(AP)가 생성될 수 있다. 예를 들어, 도 5에 나타난 바와 같이, 가우시안 블러 기법, 탄성 변환 기법, 상하 반전 기법, 확대 기법, 이동 기법, 회전 기법, 밀림 기법, 및 이미지 밝기 기 법이 적용된 증강 패치(AP)가 생성될 수 있다. 예를 들어, 도 5에 나타난 바와 같이, 탄성 변환 기법, 확대 기 법, 이동 기법, 회전 기법, 밀림 기법, 상하 반전 기법, 및 가우시안 블러 기법이 적용된 증강 패치(AP)가 생성 될 수 있다. 도 6은 도 1의 이미지 분류용 인공지능 모델의 학습 방법에 따른 인공지능 모델의 검증의 일 예를 나타내는 도면이다. 도 6은 배경이 기준 비율 이상인 제2 패치들(P2)을 제외한 제2 패치들(P2)이 양성의 결과 값들(즉, P)을 출력한 것을 나타낸다. 도 1 내지 도 3 및 도 6을 참조하면, 제1 패치들(P1)(또는, 증강 패치들(AP))을 사용하여 인공지능 모델이 학습될 수 있다. 인공지능 모델의 학습이 끝나면, 인공지능 모델의 검증을 진행할 수 있다. 도 1의 이미지 분류용 인공지능 모델의 학습 방법은 테스트 이미지를 샘플링하여 제2 패치들(P2)을 생성하 고, 제2 패치들(P2)을 사용하여 인공지능 모델을 검증할 수 있다. 일 실시예에서, 제2 패치들(P2)의 크기는 인공지능 모델이 요구하는 입력 이미지의 크기와 동일할 수 있다. 일 실시예에서, 제2 패치들(P2) 각각은 테스트 이미지의 배경을 기준 비율 이하로 포함할 수 있다. 일 실 시예에서, 테스트 이미지의 샘플링은 제2 패치들(P2)의 개수가 기준 개수가 될 때까지 반복될 수 있다. 일 실시예에서, 제2 패치들(P2)의 라벨은 샘플링의 기초가 된 테스트 이미지와 동일할 수 있다. 예를 들어, 기준 개수는 기 설정된 개수이고, 제1 패치들(P1)에 대한 기준 개수와 상이할 수 있다. 예를 들어, 기준 비율은 기 설정된 비율이고, 제1 패치들(P1)에 대한 기준 비율과 상이할 수 있다. 이에 대한 구체적인 내용은 제1 패치 들(P1)의 경우와 실질적으로 동일하므로, 중복되는 설명은 생략하도록 한다. 일 실시예에서, 테스트 이미지는 겹치지 않는 제2 패치들(P2)로 나누어질 수 있다. 나누어진 제2 패치들 (P2) 각각을 독립적으로 인공지능 모델에 입력하면 제2 패치들(P2)의 수와 동일한 수의 결과 값들을 얻을 수 있다. 도 1의 이미지 분류용 인공지능 모델의 학습 방법은 인공지능 모델의 타입에 따라 여러 방법으로 결과 값들이 종합하여 최종 결과 값을 결정할 수 있다. 최종 결과 값은 인공지능 모델의 검증에 사용될 수 있다. 예를 들어, 도 6에 나타난 바와 같이, 인공지능 모델이 입력되는 이미지 내의 조직이 특정 질병에 대하여 양성(positive)인지 음성(negative)인지 예측하는 모델인 경우, 인공지능 모델은 각각의 제2 패치들(P2)의 입력에 대하여 양성 또는 음성의 결과 값을 출력할 수 있다. 이 경우, 최종 결과 값은 다수결에 의하여 결정될 수 있다. 예를 들어, 인공지능 모델이 입력되는 이미지 내의 조직을 보고 종양 2기, 종양 3기, 종양 4기 중 하나를 예측하는 모델인 경우, 인공지능 모델은 각각의 제2 패치들(P2)의 입력에 대하여 3가지 종류의 결과 값들을출력할 수 있다. 이 경우, 최종 결과 값은 다수결에 의하여 결정될 수 있다. 예를 들어, 인공지능 모델이 입력되는 이미지 내의 조직이 특정 질병에 대하여 양성인지 음성인지를 0부터 1사이의 실수 값으로 예측하는 회귀 모델인 경우, 인공지능 모델은 각각의 제2 패치들(P2)의 입력에 대하여 실수 값들을 출력할 수 있다. 이 경우, 최종 결과 값은 결과 값들의 평균 값으로 결정될 수 있다. 다만, 본 발명은 최종 결과 값을 도출하는 방법에 의해 한정되지 않는다. 일 실시예에서, 제2 패치들(P2)은 테스트 이미지의 랜덤한 위치에서 샘플링되어 생성될 수 있다. 즉, 테스 트 이미지는 학습 이미지들과 동일한 방식으로 샘플링될 수 있다. 산업상 이용가능성 본 발명은 이미지 분류용 인공지능 모델의 학습 방법 및 이를 컴퓨터에서 실행시키기 위한 프로그램이 기록된 컴퓨터로 읽을 수 있는 기록 매체에 대한 것으로, 질병을 예측하거나 질병을 예측하기 위한 정보를 제공하는 인 공지능 알고리즘의 학습에 적용될 수 있다. 이상 실시예들을 참조하여 설명하였지만, 해당 기술 분야의 숙련된 당업자는 하기의 특허 청구의 범위에 기재된 본 발명의 사상 및 영역으로부터 벗어나지 않는 범위 내에서 본 발명을 다양하게 수정 및 변경시킬 수 있음을 이해할 수 있을 것이다."}
{"patent_id": "10-2022-0187022", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 실시예들에 따른 이미지 분류용 인공지능 모델의 학습 방법을 나타내는 순서도이다. 도 2는 도 1의 이미지 분류용 인공지능 모델의 학습 방법에 따른 전이 학습의 일 예를 나타내는 도면이다. 도 3은 도 1의 이미지 분류용 인공지능 모델의 학습 방법에 따른 제1 패치들의 일 예를 나타내는 도면이다. 도 4는 도 1의 이미지 분류용 인공지능 모델의 학습 방법에 따른 이미지 증강 기법의 적용 확률을 나타내는 표 이다. 도 5는 도 1의 이미지 분류용 인공지능 모델의 학습 방법에 따른 이미지 증강 기법이 적용된 결과의 일 예를 나 타내는 도면이다. 도 6은 도 1의 이미지 분류용 인공지능 모델의 학습 방법에 따른 인공지능 모델의 검증의 일 예를 나타내는 도 면이다."}
