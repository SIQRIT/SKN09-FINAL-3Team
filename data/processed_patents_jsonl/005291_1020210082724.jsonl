{"patent_id": "10-2021-0082724", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2023-0000376", "출원번호": "10-2021-0082724", "발명의 명칭": "인공지능을 이용한 보안관제 침입탐지 알람 처리 장치 및 방법", "출원인": "국민대학교산학협력단", "발명자": "윤명근"}}
{"patent_id": "10-2021-0082724", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "복수의 이벤트 패킷들을 수신하는 패킷 수신부;상기 복수의 이벤트 패킷들을 소정의 기준에 따라 분류하는 패킷 분류부;분류된 이벤트 패킷들을 각 패킷의 페이로드(payload)를 기초로 벡터화 하여 패킷 벡터들로 변환하는 패킷 벡터화부;상기 패킷 벡터들을 군집화 하여 복수의 군집들을 생성하는 패킷 군집화부;상기 복수의 군집들 각각을 검사하여 군집 특성에 따른 라벨(label)을 부여하는 군집 라벨링부; 및상기 복수의 군집들에 대한 라벨 정보를 기초로 보안관제를 위한 탐지 규칙을 생성하는 규칙 생성부;를 포함하는 인공지능을 이용한 보안관제 침입탐지 알람 처리 장치."}
{"patent_id": "10-2021-0082724", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서, 상기 복수의 이벤트 패킷들 각각은시간(t), 출발주소(sip), 도착주소(dip), 출발포트(sp), 도착포트(dp), 이벤트 네임(en) 및 상기 페이로드(p)를포함하는 것을 특징으로 하는 인공지능을 이용한 보안관제 침입탐지 알람 처리 장치."}
{"patent_id": "10-2021-0082724", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1항에 있어서, 상기 패킷 분류부는이벤트 패킷의 주소와 이벤트 네임을 기준으로 상기 복수의 이벤트 패킷들을 분류하는 것을 특징으로 하는 인공지능을 이용한 보안관제 침입탐지 알람 처리 장치."}
{"patent_id": "10-2021-0082724", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제1항에 있어서, 상기 패킷 벡터화부는상기 페이로드를 복수의 토큰(token)들 또는 복수의 청크(chunk)들로 분할하고 TF-IDF 알고리즘, 카운트(COUNT)알고리즘 및 피처해싱(FH) 알고리즘을 포함하는 벡터화 기법을 적용하여 상기 패킷 벡터들을 생성하는 것을 특징으로 하는 인공지능을 이용한 보안관제 침입탐지 알람 처리 장치."}
{"patent_id": "10-2021-0082724", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제4항에 있어서, 상기 패킷 벡터화부는상기 패킷 벡터들의 크기를 소정의 벡터 사이즈(vector size)로 제한하는 것을 특징으로 하는 인공지능을 이용한 보안관제 침입탐지 알람 처리 장치."}
{"patent_id": "10-2021-0082724", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제1항에 있어서, 상기 패킷 군집화부는공개특허 10-2023-0000376-3-상기 패킷 벡터들 간의 거리에 관한 유사성을 기초로 상기 복수의 군집들을 생성하는 것을 특징으로 하는 인공지능을 이용한 보안관제 침입탐지 알람 처리 장치."}
{"patent_id": "10-2021-0082724", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제1항에 있어서, 상기 군집 라벨링부는상기 복수의 군집들 각각에 대해 군집 내 패킷 벡터들을 샘플링하고 이상 여부를 분석한 결과에 따라 해당 군집의 군집 특성을 결정하는 것을 특징으로 하는 인공지능을 이용한 보안관제 침입탐지 알람 처리 장치."}
{"patent_id": "10-2021-0082724", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제7항에 있어서, 상기 군집 라벨링부는샘플링된 상기 패킷 벡터들에 대한 분석 결과 다수 분포에 해당하는 특성을 상기 군집 특성으로 결정하는 것을특징으로 하는 인공지능을 이용한 보안관제 침입탐지 알람 처리 장치."}
{"patent_id": "10-2021-0082724", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제1항에 있어서, 상기 규칙 생성부는상기 군집 특성이 정상인 경우 해당 특정 군집을 상기 보안관제를 위한 화이트 리스트에 추가하고, 그렇지 않은경우 상기 해당 특정 군집을 상기 보안관제를 위한 블랙 리스트에 추가하는 것을 특징으로 하는 인공지능을 이용한 보안관제 침입탐지 알람 처리 장치."}
{"patent_id": "10-2021-0082724", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제1항에 있어서,상기 탐지 규칙을 기초로 외부로부터 수신하는 이벤트 패킷에 대한 보안관제를 수행하고 침입탐지에 관한 알람을 생성하는 보안관제 수행부;를 더 포함하는 것을 특징으로 하는 인공지능을 이용한 보안관제 침입탐지 알람처리 장치."}
{"patent_id": "10-2021-0082724", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "복수의 이벤트 패킷들을 수신하는 단계;상기 복수의 이벤트 패킷들을 소정의 기준에 따라 분류하는 단계;분류된 이벤트 패킷들을 각 패킷의 페이로드(payload)를 기초로 벡터화 하여 패킷 벡터들로 변환하는 단계;상기 패킷 벡터들을 군집화 하여 복수의 군집들을 생성하는 단계;상기 복수의 군집들 각각을 검사하여 군집 특성에 따른 라벨(label)을 부여하는 단계;상기 복수의 군집들에 대한 라벨 정보를 기초로 보안관제를 위한 탐지 규칙을 생성하는 단계; 및상기 탐지 규칙을 기초로 외부로부터 수신하는 이벤트 패킷에 대한 보안관제를 수행하고 침입탐지에 관한 알람을 생성하는 단계;를 포함하는 인공지능을 이용한 보안관제 침입탐지 알람 처리 방법."}
{"patent_id": "10-2021-0082724", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제11항에 있어서, 상기 패킷 벡터들로 변환하는 단계는공개특허 10-2023-0000376-4-상기 페이로드를 복수의 토큰(token)들 또는 복수의 청크(chunk)들로 분할하고 TF-IDF 알고리즘, 카운트(COUNT)알고리즘 및 피처해싱(FH) 알고리즘을 포함하는 벡터화 기법을 적용하여 상기 패킷 벡터들을 생성하는 단계를포함하는 것을 특징으로 하는 인공지능을 이용한 보안관제 침입탐지 알람 처리 방법."}
{"patent_id": "10-2021-0082724", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "제11항에 있어서, 상기 복수의 군집들을 생성하는 단계는상기 패킷 벡터들 간의 거리에 관한 유사성을 기초로 상기 복수의 군집들을 생성하는 단계를 포함하는 것을 특징으로 하는 인공지능을 이용한 보안관제 침입탐지 알람 처리 방법."}
{"patent_id": "10-2021-0082724", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_14", "content": "제11항에 있어서, 상기 라벨(label)을 부여하는 단계는상기 복수의 군집들 각각에 대해 군집 내 패킷 벡터들을 샘플링하고 이상 여부를 분석한 결과에 따라 해당 군집의 군집 특성을 결정하는 단계를 포함하는 것을 특징으로 하는 인공지능을 이용한 보안관제 침입탐지 알람 처리방법."}
{"patent_id": "10-2021-0082724", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_15", "content": "제11항에 있어서, 상기 탐지 규칙을 생성하는 단계는상기 군집 특성이 정상인 경우 해당 특정 군집을 상기 보안관제를 위한 화이트 리스트에 추가하고, 그렇지 않은경우 상기 해당 특정 군집을 상기 보안관제를 위한 블랙 리스트에 추가하는 단계를 포함하는 것을 특징으로 하는 인공지능을 이용한 보안관제 침입탐지 알람 처리 방법."}
{"patent_id": "10-2021-0082724", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 인공지능을 이용한 보안관제 침입탐지 알람 처리 장치 및 방법에 관한 것으로, 상기 장치는 복수의 이 벤트 패킷들을 수신하는 패킷 수신부; 상기 복수의 이벤트 패킷들을 소정의 기준에 따라 분류하는 패킷 분류부; 분류된 이벤트 패킷들을 각 패킷의 페이로드(payload)를 기초로 벡터화 하여 패킷 벡터들로 변환하는 패킷 벡터 화부; 상기 패킷 벡터들을 군집화 하여 복수의 군집들을 생성하는 패킷 군집화부; 상기 복수의 군집들 각각을 검 사하여 군집 특성에 따른 라벨(label)을 부여하는 군집 라벨링부; 및 상기 복수의 군집들에 대한 라벨 정보를 기 초로 보안관제를 위한 탐지 규칙을 생성하는 규칙 생성부;를 포함한다."}
{"patent_id": "10-2021-0082724", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 인공지능 보안관제 기술에 관한 것으로, 보다 상세하게는 분할 정복 전략을 보안관제 이벤트에 적용 하여 페이로드 내용 기반으로 예외 규칙을 자동적으로 생성하는 인공지능을 이용한 보안관제 침입탐지 알람 처 리 장치 및 방법에 관한 것이다."}
{"patent_id": "10-2021-0082724", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "네트워크 보안을 위해 네트워크 트래픽을 캡처하고, 캡처한 데이터를 분석해 네트워크 트래픽 또는 발생 가능한 악의적 활동과 관련된 문제를 식별할 필요가 있다. 특히, 네트워크 트래픽을 통해 전송되는 데이터를 분석하는 방법 중 패킷 레벨에서 파일의 특정 정보를 수집하고 이를 통해 유사파일을 검출하는 방법이 사용될 수 있다. 또한, 보안장비를 통해 네트워크 트래픽에 대한 보안관제를 수행할 수도 있으며, 이를 위해 보안장비를 사용자 의 네트워크에 설치하여 전송되는 패킷의 보안성을 검사할 수 있다. 한편, IPS(Intrusion Prevention System)은 보안관제요원(전문가)의 경험에 의해 생성된 보안규칙을 통해 보안 이벤트를 발생시킬 수 있다. IPS가 설치된 네트워크마다 주기적인 네트워크 사용 패턴이 다를 수 있으므로 보안 규칙도 주관적으로 생성될 수 있다. 이때, 보안 규칙(또는 탐지 규칙, 예외 규칙)은 주로 출발지, 목적지 IP 주 소, 포트번호 정보나 실제 패킷의 근본적인 내용(페이로드, payload)에서 공격 패턴을 탐지하는 규칙에 해당할 수 있다. 또한, 보안관제에 있어 알람 피로(alert fatigue)는 오랜 기간 해결하지 못한 문제이다. 알람 피로는 정상 패킷 이라 하더라도 설정된 탐지 규칙에 따라 탐지 조건을 충족하는 경우 보안이벤트가 반복적으로 생성되는 과정에 서 발생할 수 있다. 알람 피로를 해결하는 간단한 방법은 자주 발생하는 이벤트를 예외로 두어 보안이벤트가 발 생하지 않도록 강제하는 방법이다. 다만, 이러한 방법은 향후 거짓 음성(false negative)이 발생할 가능성이 존 재하고, 새로운 IP 또는 이벤트명 등장 시 수작업이 요구되는 등의 문제점을 가질 수 있다. 선행기술문헌 특허문헌 (특허문헌 0001) 한국공개특허 제10-2017-0091989호 (2017.08.10)"}
{"patent_id": "10-2021-0082724", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명의 일 실시예는 분할 정복 전략을 보안관제 이벤트에 적용하여 페이로드 내용 기반으로 예외 규칙을 자 동적으로 생성하는 인공지능을 이용한 보안관제 침입탐지 알람 처리 장치 및 방법을 제공하고자 한다. 본 발명의 일 실시예는 IP, 이벤트명 이외에 페이로드 내용을 기준으로 동일한 또는 매우 유사한 이벤트들을 그 룹화 하여 그룹 특성에 따라 보안관제를 위한 탐지 규칙을 설정하는 인공지능을 이용한 보안관제 침입탐지 알람 처리 장치 및 방법을 제공하고자 한다."}
{"patent_id": "10-2021-0082724", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "실시예들 중에서, 인공지능을 이용한 보안관제 침입탐지 알람 처리 장치는 복수의 이벤트 패킷들을 수신하는 패 킷 수신부; 상기 복수의 이벤트 패킷들을 소정의 기준에 따라 분류하는 패킷 분류부; 분류된 이벤트 패킷들을 각 패킷의 페이로드(payload)를 기초로 벡터화 하여 패킷 벡터들로 변환하는 패킷 벡터화부; 상기 패킷 벡터들 을 군집화 하여 복수의 군집들을 생성하는 패킷 군집화부; 상기 복수의 군집들 각각을 검사하여 군집 특성에 따 른 라벨(label)을 부여하는 군집 라벨링부; 및 상기 복수의 군집들에 대한 라벨 정보를 기초로 보안관제를 위한 탐지 규칙을 생성하는 규칙 생성부;를 포함한다. 상기 복수의 이벤트 패킷들 각각은 시간(t), 출발주소(sip), 도착주소(dip), 출발포트(sp), 도착포트(dp), 이벤 트 네임(en) 및 상기 페이로드(p)를 포함할 수 있다. 상기 패킷 분류부는 이벤트 패킷의 주소와 이벤트 네임을 기준으로 상기 복수의 이벤트 패킷들을 분류할 수 있 다. 상기 패킷 벡터화부는 상기 페이로드를 복수의 토큰(token)들 또는 복수의 청크(chunk)들로 분할하고 TF-IDF 알 고리즘, 카운트(COUNT) 알고리즘 및 피처해싱(FH) 알고리즘을 포함하는 벡터화 기법을 적용하여 상기 패킷 벡터 들을 생성할 수 있다. 상기 패킷 벡터화부는 상기 패킷 벡터들의 크기를 소정의 벡터 사이즈(vector size)로 제한할 수 있다. 상기 패킷 군집화부는 상기 패킷 벡터들 간의 거리에 관한 유사성을 기초로 상기 복수의 군집들을 생성할 수 있 다. 상기 군집 라벨링부는 상기 복수의 군집들 각각에 대해 군집 내 패킷 벡터들을 샘플링하고 이상 여부를 분석한 결과에 따라 해당 군집의 군집 특성을 결정할 수 있다. 상기 군집 라벨링부는 샘플링된 상기 패킷 벡터들에 대한 분석 결과 다수 분포에 해당하는 특성을 상기 군집 특 성으로 결정할 수 있다. 상기 규칙 생성부는 상기 군집 특성이 정상인 경우 해당 특정 군집을 상기 보안관제를 위한 화이트 리스트에 추 가하고, 그렇지 않은 경우 상기 해당 특정 군집을 상기 보안관제를 위한 블랙 리스트에 추가할 수 있다.상기 장치는 상기 탐지 규칙을 기초로 외부로부터 수신하는 이벤트 패킷에 대한 보안관제를 수행하고 침입탐지 에 관한 알람을 생성하는 보안관제 수행부;를 더 포함할 수 있다. 실시예들 중에서, 인공지능을 이용한 보안관제 침입탐지 알람 처리 방법은 복수의 이벤트 패킷들을 수신하는 단 계; 상기 복수의 이벤트 패킷들을 소정의 기준에 따라 분류하는 단계; 분류된 이벤트 패킷들을 각 패킷의 페이 로드(payload)를 기초로 벡터화 하여 패킷 벡터들로 변환하는 단계; 상기 패킷 벡터들을 군집화 하여 복수의 군 집들을 생성하는 단계; 상기 복수의 군집들 각각을 검사하여 군집 특성에 따른 라벨(label)을 부여하는 단계; 상기 복수의 군집들에 대한 라벨 정보를 기초로 보안관제를 위한 탐지 규칙을 생성하는 단계; 및 상기 탐지 규 칙을 기초로 외부로부터 수신하는 이벤트 패킷에 대한 보안관제를 수행하고 침입탐지에 관한 알람을 생성하는 단계;를 포함한다. 상기 패킷 벡터들로 변환하는 단계는 상기 페이로드를 복수의 토큰(token)들 또는 복수의 청크(chunk)들로 분할 하고 TF-IDF 알고리즘, 카운트(COUNT) 알고리즘 및 피처해싱(FH) 알고리즘을 포함하는 벡터화 기법을 적용하여 상기 패킷 벡터들을 생성하는 단계를 포함할 수 있다. 상기 복수의 군집들을 생성하는 단계는 상기 패킷 벡터들 간의 거리에 관한 유사성을 기초로 상기 복수의 군집 들을 생성하는 단계를 포함할 수 있다. 상기 라벨(label)을 부여하는 단계는 상기 복수의 군집들 각각에 대해 군집 내 패킷 벡터들을 샘플링하고 이상 여부를 분석한 결과에 따라 해당 군집의 군집 특성을 결정하는 단계를 포함할 수 있다. 상기 탐지 규칙을 생성하는 단계는 상기 군집 특성이 정상인 경우 해당 특정 군집을 상기 보안관제를 위한 화이 트 리스트에 추가하고, 그렇지 않은 경우 상기 해당 특정 군집을 상기 보안관제를 위한 블랙 리스트에 추가하는 단계를 포함할 수 있다."}
{"patent_id": "10-2021-0082724", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "개시된 기술은 다음의 효과를 가질 수 있다. 다만, 특정 실시예가 다음의 효과를 전부 포함하여야 한다거나 다 음의 효과만을 포함하여야 한다는 의미는 아니므로, 개시된 기술의 권리범위는 이에 의하여 제한되는 것으로 이 해되어서는 아니 될 것이다. 본 발명의 일 실시예에 따른 인공지능을 이용한 보안관제 침입탐지 알람 처리 장치 및 방법은 분할 정복 전략을 보안관제 이벤트에 적용하여 페이로드 내용 기반으로 예외 규칙을 자동적으로 생성할 수 있다. 본 발명의 일 실시예에 따른 인공지능을 이용한 보안관제 침입탐지 알람 처리 장치 및 방법은 IP, 이벤트명 이 외에 페이로드 내용을 기준으로 동일한 또는 매우 유사한 이벤트들을 그룹화 하여 그룹 특성에 따라 보안관제를 위한 탐지 규칙을 설정할 수 있다."}
{"patent_id": "10-2021-0082724", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "본 발명에 관한 설명은 구조적 내지 기능적 설명을 위한 실시예에 불과하므로, 본 발명의 권리범위는 본문에 설 명된 실시예에 의하여 제한되는 것으로 해석되어서는 아니 된다. 즉, 실시예는 다양한 변경이 가능하고 여러 가 지 형태를 가질 수 있으므로 본 발명의 권리범위는 기술적 사상을 실현할 수 있는 균등물들을 포함하는 것으로 이해되어야 한다. 또한, 본 발명에서 제시된 목적 또는 효과는 특정 실시예가 이를 전부 포함하여야 한다거나 그러한 효과만을 포함하여야 한다는 의미는 아니므로, 본 발명의 권리범위는 이에 의하여 제한되는 것으로 이해 되어서는 아니 될 것이다. 한편, 본 출원에서 서술되는 용어의 의미는 다음과 같이 이해되어야 할 것이다. \"제1\", \"제2\" 등의 용어는 하나의 구성요소를 다른 구성요소로부터 구별하기 위한 것으로, 이들 용어들에 의해 권리범위가 한정되어서는 아니 된다. 예를 들어, 제1 구성요소는 제2 구성요소로 명명될 수 있고, 유사하게 제2 구성요소도 제1 구성요소로 명명될 수 있다. 어떤 구성요소가 다른 구성요소에 \"연결되어\"있다고 언급된 때에는, 그 다른 구성요소에 직접적으로 연결될 수 도 있지만, 중간에 다른 구성요소가 존재할 수도 있다고 이해되어야 할 것이다. 반면에, 어떤 구성요소가 다른 구성요소에 \"직접 연결되어\"있다고 언급된 때에는 중간에 다른 구성요소가 존재하지 않는 것으로 이해되어야 할 것이다. 한편, 구성요소들 간의 관계를 설명하는 다른 표현들, 즉 \"~사이에\"와 \"바로 ~사이에\" 또는 \"~에 이웃 하는\"과 \"~에 직접 이웃하는\" 등도 마찬가지로 해석되어야 한다. 단수의 표현은 문맥상 명백하게 다르게 뜻하지 않는 한 복수의 표현을 포함하는 것으로 이해되어야 하고, \"포함 하다\"또는 \"가지다\" 등의 용어는 실시된 특징, 숫자, 단계, 동작, 구성요소, 부분품 또는 이들을 조합한 것이 존재함을 지정하려는 것이며, 하나 또는 그 이상의 다른 특징이나 숫자, 단계, 동작, 구성요소, 부분품 또는 이 들을 조합한 것들의 존재 또는 부가 가능성을 미리 배제하지 않는 것으로 이해되어야 한다. 각 단계들에 있어 식별부호(예를 들어, a, b, c 등)는 설명의 편의를 위하여 사용되는 것으로 식별부호는 각 단 계들의 순서를 설명하는 것이 아니며, 각 단계들은 문맥상 명백하게 특정 순서를 기재하지 않는 이상 명기된 순 서와 다르게 일어날 수 있다. 즉, 각 단계들은 명기된 순서와 동일하게 일어날 수도 있고 실질적으로 동시에 수 행될 수도 있으며 반대의 순서대로 수행될 수도 있다. 본 발명은 컴퓨터가 읽을 수 있는 기록매체에 컴퓨터가 읽을 수 있는 코드로서 구현될 수 있고, 컴퓨터가 읽을 수 있는 기록 매체는 컴퓨터 시스템에 의하여 읽혀질 수 있는 데이터가 저장되는 모든 종류의 기록 장치를 포함 한다. 컴퓨터가 읽을 수 있는 기록 매체의 예로는 ROM, RAM, CD-ROM, 자기 테이프, 플로피 디스크, 광 데이터 저장 장치 등이 있다. 또한, 컴퓨터가 읽을 수 있는 기록 매체는 네트워크로 연결된 컴퓨터 시스템에 분산되어, 분산 방식으로 컴퓨터가 읽을 수 있는 코드가 저장되고 실행될 수 있다. 여기서 사용되는 모든 용어들은 다르게 정의되지 않는 한, 본 발명이 속하는 분야에서 통상의 지식을 가진 자에 의해 일반적으로 이해되는 것과 동일한 의미를 가진다. 일반적으로 사용되는 사전에 정의되어 있는 용어들은 관 련 기술의 문맥상 가지는 의미와 일치하는 것으로 해석되어야 하며, 본 출원에서 명백하게 정의하지 않는 한 이 상적이거나 과도하게 형식적인 의미를 지니는 것으로 해석될 수 없다. 도 1은 본 발명에 따른 알람 처리 시스템을 설명하는 도면이다. 도 1을 참조하면, 알람 처리 시스템은 사용자 단말, 알람 처리 장치 및 데이터베이스를 포 함할 수 있다. 사용자 단말은 네트워크를 이용하여 데이터 전송 및 다양한 서비스를 이용할 수 있는 컴퓨팅 장치에 해당 할 수 있고, 스마트폰, 노트북 또는 컴퓨터로 구현될 수 있으며, 반드시 이에 한정되지 않고, 태블릿 PC 등 다 양한 디바이스로도 구현될 수 있다. 사용자 단말은 알람 처리 장치와 네트워크를 통해 연결될 수 있 고, 복수의 사용자 단말들은 알람 처리 장치와 동시에 연결될 수 있다. 알람 처리 장치는 사용자 단말 간의 데이터 통신이나 외부 시스템과의 연결에 따른 네트워크 이용 과 정에서 네트워크 상태를 모니터링을 수행하고 보안이벤트, 악성코드 등의 보안침입을 탐지하며 알람 생성 및 보 안 조치를 시행할 수 있는 컴퓨터 또는 프로그램에 해당하는 서버로 구현될 수 있다. 알람 처리 장치는 사 용자 단말과 네트워크를 통해 연결될 수 있고 정보를 주고받을 수 있다. 일 실시예에서, 알람 처리 장치 는 데이터베이스와 연동하여 네트워크 모니터링 및 보안관제를 위해 필요한 데이터를 저장할 수 있다.데이터베이스는 알람 처리 장치의 동작 과정에서 필요한 다양한 정보들을 저장하는 저장장치에 해당 할 수 있다. 데이터베이스는 네트워크 모니터링 과정에서 수집된 패킷 정보를 저장할 수 있고, 침입탐지를 위한 다양한 규칙들 및 인공지능 학습에 관한 정보를 저장할 수 있으며, 반드시 이에 한정되지 않고, 알람 처리 장치가 패킷의 페이로드의 내용을 기반으로 침입탐지를 위한 탐지 규칙을 자동으로 생성하고 보안관제에 적용하는 과정에서 다양한 형태로 수집 또는 가공된 정보들을 저장할 수 있다. 도 2는 도 1의 알람 처리 장치의 시스템 구성을 설명하는 도면이다. 도 2를 참조하면, 알람 처리 장치는 알람 처리 장치는 프로세서, 메모리, 사용자 입출력부 및 네트워크 입출력부를 포함할 수 있다. 프로세서는 알람 처리 장치가 동작하는 과정에서의 각 단계들을 처리하는 프로시저를 실행할 수 있고, 그 과정 전반에서 읽혀지거나 작성되는 메모리를 관리할 수 있으며, 메모리에 있는 휘발성 메 모리와 비휘발성 메모리 간의 동기화 시간을 스케줄할 수 있다. 프로세서는 알람 처리 장치의 동작 전반을 제어할 수 있고, 메모리, 사용자 입출력부 및 네트워크 입출력부와 전기적으로 연결되어 이들 간의 데이터 흐름을 제어할 수 있다. 프로세서는 알람 처리 장치의 CPU(Central Processing Unit)로 구현될 수 있다. 메모리는 SSD(Solid State Drive) 또는 HDD(Hard Disk Drive)와 같은 비휘발성 메모리로 구현되어 알람 처리 장치에 필요한 데이터 전반을 저장하는데 사용되는 보조기억장치를 포함할 수 있고, RAM(Random Access Memory)과 같은 휘발성 메모리로 구현된 주기억장치를 포함할 수 있다. 사용자 입출력부는 사용자 입력을 수신하기 위한 환경 및 사용자에게 특정 정보를 출력하기 위한 환경을 포함할 수 있다. 예를 들어, 사용자 입출력부는 터치 패드, 터치 스크린, 화상 키보드 또는 포인팅 장치와 같은 어댑터를 포함하는 입력장치 및 모니터 또는 터치스크린과 같은 어댑터를 포함하는 출력장치를 포함할 수 있다. 일 실시예에서, 사용자 입출력부는 원격 접속을 통해 접속되는 컴퓨팅 장치에 해당할 수 있고, 그러 한 경우, 알람 처리 장치는 독립적인 서버로서 수행될 수 있다. 네트워크 입출력부은 네트워크를 통해 외부 장치 또는 시스템과 연결하기 위한 환경을 포함하고, 예를 들 어, LAN(Local Area Network), MAN(Metropolitan Area Network), WAN(Wide Area Network) 및 VAN(Value Added Network) 등의 통신을 위한 어댑터를 포함할 수 있다. 도 3은 도 1의 알람 처리 장치의 기능적 구성을 설명하는 도면이다. 도 3을 참조하면, 알람 처리 장치는 패킷 수신부, 패킷 분류부, 패킷 벡터화부, 패킷 군집 화부, 군집 라벨링부, 규칙 생성부, 보안관제 수행부 및 제어부(도 3에 미도시함)를 포함 할 수 있다. 패킷 수신부는 복수의 이벤트 패킷들을 수신할 수 있다. 여기에서, 복수의 이벤트 패킷들 각각은 시간(t), 출발주소(sip), 도착주소(dip), 출발포트(sp), 도착포트(dp), 이벤트 네임(en) 및 페이로드(p)를 포함할 수 있 다. 즉, 이벤트 패킷(packet)은 네트워크를 통해 전송되는 데이터의 형식화된 블록에 해당할 수 있으며, 패킷 헤더(header)와 페이로드(payload)를 포함할 수 있다. 패킷 헤더는 시간(t), 출발주소(sip), 도착주소(dip), 출 발포트(sp), 도착포트(dp), 이벤트 네임(en) 등을 포함할 수 있다. 복수의 이벤트 패킷들은 알람 처리 장치 의 외부로부터 네트워크를 통해 수신될 수 있으며, 알람 처리 장치는 칩입탐지 시스템 또는 보안관제 시스템 상에서 라우터(router)를 통과한 이벤트 패킷들을 복사(tap)하여 칩입탐지를 위한 이벤트 패킷을 수집할 수 있다. 패킷 분류부는 복수의 이벤트 패킷들을 소정의 기준에 따라 분류할 수 있다. 즉, 패킷 분류부는 이벤 트 패킷에 포함된 다양한 정보들 중 적어도 하나를 분류를 위한 기준으로 결정하여 패킷 분류 동작을 처리할 수 있다. 일 실시예에서, 패킷 분류부는 이벤트 패킷의 주소와 이벤트 네임을 기준으로 복수의 이벤트 패킷들 을 분류할 수 있다. 예를 들어, 패킷 분류부는 소정의 분류기를 통해 이벤트 패킷을 분류할 수 있다. IETS(Internal/External, Terminal/Server) 분류기는 이벤트 패킷의 IP주소를 기준으로 내부(Internal) 또는 외부(External), 단말(Terminal) 또는 서버(Server)로 각각 분류할 수 있다. IETS 분류기에 의해 분류된 이벤트 패킷들은 각각 내부 서버, 내부단말, 외부서버 및 외부단말로 구분된 집합들에 포함될 수 있다. 또한, 패킷 분류부는 객체 식 별기(object identifier)를 통해 이벤트 패킷을 분류할 수 있다. 객체 식별기(object identifier)는 이벤트 네 임을 기준으로 이벤트 패킷을 분류할 수 있다. 결과적으로, 패킷 분류부는 이벤트 패킷들을 IP와 네임 (name)을 기준으로 순차적으로 분류하여 복수의 이벤트 패킷 집합들을 생성할 수 있다. 패킷 벡터화부는 분류된 이벤트 패킷들을 각 패킷의 페이로드(payload)를 기초로 벡터화 하여 패킷 벡터들 로 변환할 수 있다. 패킷의 페이로드는 제어 정보와 사용자 데이터를 포함할 수 있으며, 페이로드에 저장된 정 보에 따라 다양한 길이로 형성될 수 있다. 즉, 패킷 벡터화부는 패킷의 페이로드를 벡터화 함으로써 패킷 의 주요 내용에 관한 특징 정보를 획득할 수 있다. 일 실시예에서, 패킷 벡터화부는 페이로드를 복수의 토큰(token)들 또는 복수의 청크(chunk)들로 분할하고 TF-IDF 알고리즘, 카운트(COUNT) 알고리즘 및 피처해싱(FH) 알고리즘을 포함하는 벡터화 기법을 적용하여 패킷 벡터들을 생성할 수 있다. 페이로드의 길이가 다양하기 때문에 패킷 벡터화부는 페이로드를 소정의 단위요 소들로 분할할 수 있으며, 페이로드의 분할에 따라 일련의 스트림을 형성할 수도 있다. 패킷 벡터화부는 다양한 분할 알고리즘을 이용하여 페이로드를 분할할 수 있다. 예를 들어, 패킷 벡터화부는 텍스트 기반의 토크나이저(tokenizer)를 사용하여 페이로드를 복수의 토큰들로 분할할 수 있고, 컨텐츠 기반 청킹(CBC)을 통해 복수의 청크들로 분할할 수 있다. 또한, 패킷 벡터화부는 복수의 토큰들 또는 복수의 청크들 각각을 벡터의 성분에 대응시켜 패킷 벡터를 생 성할 수 있으며, TF-IDF 알고리즘, 카운트(COUNT) 알고리즘 및 피처해싱 알고리즘 등을 이용하여 패킷 벡터를 생성할 수도 있다. 예를 들어, 패킷 p1=”a bb c”인 경우, 패킷 p1에 대응하는 패킷 벡터 v1=(a, bb, c)로 변 환될 수 있다. 또한, 패킷 p2=”%7#bb”인 경우, 패킷 p2에 대응하는 패킷 벡터 v2=(%7#, c, bb)로 변환될 수 있다. 또한, 패킷 p3=”a1bbc@c”인 경우, 패킷 p3에 대응하는 패킷 v3=(a1, bb, c@c)로 변환될 수 있다. 일 실시예에서, 패킷 벡터화부는 패킷 벡터들의 크기를 소정의 벡터 사이즈(vector size)로 제한할 수 있 다. 패킷 벡터화부는 이후 단계에서 패킷 벡터들에 관한 클러스터링 동작을 수행하기 위하여 패킷 벡터들 에 대해 소정의 벡터 사이즈를 적용할 수 있다. 즉, 각 페이로드를 기초로 생성되는 패킷 벡터들은 벡터 사이즈 이내로 제한되어 생성될 수 있다. 패킷 군집화부는 패킷 벡터들을 군집화 하여 복수의 군집들을 생성할 수 있다. 패킷 군집화부는 패킷 벡터들 중에서 유사한 특성을 가진 벡터들을 하나의 군집으로 분류하기 위하여 다양한 클러스터링(clustering) 알고리즘을 활용할 수 있다. 한편, 패킷 군집화부에 의해 사용되는 클러스터링 알고리즘에 따라 이전 단계 에서 생성되는 패킷 벡터들의 벡터 사이즈가 결정될 수 있다. 일 실시예에서, 패킷 군집화부는 패킷 벡터들 간의 거리에 관한 유사성을 기초로 복수의 군집들을 생성할 수 있다. 예를 들어, 패킷 군집화부는 dbscan 알고리즘을 활용하여 패킷 벡터들을 군집화 할 수 있다. 여 기에서, dbscan 알고리즘은 밀도 방식의 클러스터링 기법으로서 특정 중심점(core point)을 기준으로 특정 반경 (epsilon) 이내에 최소 개수(minPts) 이상의 점들이 존재하는 경우 해당 점들을 하나의 군집으로 생성하는 방식 으로 동작할 수 있다. 즉, 패킷 군집화부는 패킷 벡터들 간의 거리가 소정의 거리 이내에 존재하는 경우 해당 패킷 벡터들 사이에 유사성이 존재하는 것으로 결정하여 동일한 군집으로 묶을 수 있다. 군집 라벨링부는 복수의 군집들 각각을 검사하여 군집 특성에 따른 라벨(label)을 부여할 수 있다. 여기에 서, 군집 특성은 해당 군집 내에 존재하는 패킷 벡터들 간의 공통적인 특징 정보에 해당하거나 또는 해당 군집 내의 패킷 벡터들 중 다수에 분포되는 특징 정보에 해당할 수 있다. 군집 라벨링부는 군집 별로 군집 특성 을 도출하고 해당 군집에 대한 라벨로서 결정할 수 있다. 일 실시예에서, 군집 라벨링부는 복수의 군집들 각각에 대해 군집 내 패킷 벡터들을 샘플링하고 이상 여부 를 분석한 결과에 따라 해당 군집의 군집 특성을 결정할 수 있다. 군집 라벨링부는 군집 특성을 결정하기 위하여 특정 군집에 존재하는 모든 패킷 벡터들을 검사할 수도 있으나, 샘플링을 통해 소정의 패킷 벡터들만을 추출한 후 해당 패킷 벡터들의 공통 특성에 기초하여 군집 특성을 추정할 수 있다. 군집 라벨링부는 군집 별로 소정의 개수만큼 랜덤하게 패킷 벡터들을 샘플링할 수 있으며, 반드시 이에 한정되지 않고, 다양한 샘플링 기법이 적용될 수 있음은 물론이다. 일 실시예에서, 군집 라벨링부는 샘플링된 패킷 벡터들에 대한 분석 결과 다수 분포에 해당하는 특성을 군 집 특성으로 결정할 수 있다. 예를 들어, 군집 특성은 샘플링된 패킷 벡터들의 이상 분포 또는 정상 분포를 기초로 결정될 수 있으며, 이에 따라 정상(benign) 또는 악성(Malicious)으로 결정될 수 있다. 다른 예로서, 군집 특성은 악성코드 탐지에 관한 FP(False Positive), TP(True Positive), FN(False Negative), TN(True Negative)에 관한 분포를 기초로 결정될 수 있으며, 이에 따라 FP only, TP+FP, TP only 등으로 결정될 수 있 다. 규칙 생성부는 복수의 군집들에 대한 라벨 정보를 기초로 보안관제를 위한 탐지 규칙을 생성할 수 있다. 즉, 탐지 규칙은 군집들에 대한 정보와 군집별 라벨 정보를 기초로 생성될 수 있다. 규칙 생성부는 이벤트 패킷들에 대한 군집 분석을 통해 주기적으로 탐지 규칙을 생성하거나 또는 갱신할 수 있다. 예를 들어, 보안관 제 및 침입탐지에 있어서 탐지 규칙은 이상상황 탐지를 위한 블랙리스트(blacklist)와 화이트리스트(whitelis t)로 구성될 수 있다. 일 실시예에서, 규칙 생성부는 군집 특성이 정상인 경우 해당 특정 군집을 보안관제를 위한 화이트 리스트 (whitelist)에 추가하고, 그렇지 않은 경우 해당 특정 군집을 보안관제를 위한 블랙 리스트(blacklist)에 추가 할 수 있다. 예를 들어, 군집 특성이 악성으로 분류되는 경우 규칙 생성부는 해당 군집 및 패킷 벡터들을 화이트 리스트에 추가할 수 있다. 만약 군집 특성이 정상으로 분류되는 경우 규칙 생성부는 해당 군집 및 패킷 벡터들을 블랙 리스트에 추가할 수 있다. 보안관제 수행부는 탐지 규칙을 기초로 외부로부터 수신하는 이벤트 패킷에 대한 보안관제를 수행하고 침 입탐지에 관한 알람을 생성할 수 있다. 보다 구체적으로, 보안관제 수행부는 탐지 규칙을 이용하여 외부에 서 라우터(router)를 통과하여 들어오는 이벤트 패킷들에 대한 보안관제를 수행할 수 있다. 보안관제 수행부 는 이벤트 패킷에서 페이로드를 추출할 수 있고, 해당 페이로드에 대응하는 패킷 벡터를 생성할 수 있으며, 해당 패킷 벡터를 분류하여 기 생성된 군집들 중 어느 하나와 매칭시킬 수 있다. 만약 매칭된 군집이 블랙리스트에 포함되어 있는 경우 보안관제 수행부는 해당 이벤트 패킷에 대한 알람을 생성하여 관리자에 게 전달하거나 또는 관제 서버 등으로 전송할 수 있다. 또한, 보안관제 수행부는 패킷 벡터 자체가 블랙리 스트 또는 화이트리스트에 포함되어 있는지에 따라 보안관제 동작을 수행할 수도 있다. 제어부(도 3에 미도시함)는 알람 처리 장치의 전체적인 동작을 제어하고, 패킷 수신부, 패킷 분류부 , 패킷 벡터화부, 패킷 군집화부, 군집 라벨링부, 규칙 생성부 및 보안관제 수행부 간의 제어 흐름 또는 데이터 흐름을 관리할 수 있다. 도 4는 본 발명에 따른 알람 처리 과정을 설명하는 순서도이다. 도 4를 참조하면, 알람 처리 장치는 패킷 수신부를 통해 복수의 이벤트 패킷들을 수신할 수 있다(단 계 S410). 알람 처리 장치는 패킷 분류부를 통해 복수의 이벤트 패킷들을 소정의 기준에 따라 분류할 수 있다(단계 S420). 알람 처리 장치는 패킷 벡터화부를 통해 분류된 이벤트 패킷들을 각 패킷의 페 이로드(payload)를 기초로 벡터화 하여 패킷 벡터들로 변환할 수 있다(단계 S430). 또한, 알람 처리 장치는 패킷 군집화부를 통해 패킷 벡터들을 군집화 하여 복수의 군집들을 생성할 수 있다(단계 S440). 알람 처리 장치는 군집 라벨링부를 통해 복수의 군집들 각각을 검사하여 군집 특성에 따른 라벨(label)을 부여할 수 있다(단계 S450). 알람 처리 장치는 규칙 생성부를 통해 복수 의 군집들에 대한 라벨 정보를 기초로 보안관제를 위한 탐지 규칙을 생성할 수 있다(단계 S460). 도 5는 본 발명에 따른 알람 처리 방법과 알람 피로 문제 간의 관계를 설명하는 도면이다. 도 5를 참조하면, 알람 처리 장치는 보안 수준을 높이면서 알람 피로(alert fatigue) 문제를 해결하기 위 한 방법을 수행할 수 있다. 기존의 경우 이벤트 패킷에 관한 탐지 성능은 FALSE POSITIVE와 TRUE POSITIVE가 모 두 높게 나타났으며, 소정의 이벤트를 분석하여 탐지제외규칙을 설정하는 등의 수작업 설정을 통해 FALSE POSITIVE를 낮추는 방향으로 대응하였다. 다만, 이 경우 탐지제외규칙의 일괄적용에 따라 FALSE POSITIVE와 함 께 TRUE POSITIVE도 함께 낮아지게 되는 문제가 발생할 수 있다. 알람 처리 장치는 이를 개선하여 FALSE POSITIVE를 낮추면서도 TRUE POSITIVE는 기존보다 높게 유지되는 알람 처리 방법을 수행할 수 있다. 도 6은 본 발명에 따른 인공지능을 이용한 보안관제 침입탐지 알람 처리 방법을 설명하는 도면이다. 도 6a 및 6b를 참조하면, 알람 처리 장치는 외부로부터의 유입되는 이벤트 패킷을 검사하여 보안관제를 수 행할 수 있다. 특히, 알람 처리 장치는 이벤트 패킷을 소정의 기준에 따라 분류하여 그룹화 할 수 있으며 (Grouping), 그룹화된 이벤트 패킷들의 페이로드를 분석하여 페이로드 내용을 반영하는 패킷 벡터들을 생성할 수 있다(Vectorization). 또한, 알람 처리 장치는 패킷 벡터들을 기초로 벡터들 간의 유사성에 기초하여 클러스터링을 수행할 수 있 으며(Clustering), 클러스터링된 군집들에 대해 각각의 특성에 따른 라벨을 부여할 수 있다(Sampling & Analysis). 알람 처리 장치는 군집들에 대한 특성 정보와 라벨 정보를 기초로 보안관제 및 침입탐지를 위 한 규칙을 생성할 수 있으며, 구체적으로 화이트리스트와 블랙리스트를 생성할 수 있다(Rule generation). 알람 처리 장치는 화이트리스트와 블랙리스트를 활용하여 이벤트 패킷에 대한 감시를 통해 보안관제를 수행할 수 있다. 도 7은 본 발명에 따른 인공지능을 이용한 보안관제 침입탐지 알람 처리 방법에 관한 실험 결과를 설명하는 도 면이다. 도 7을 참조하면, KISTI 데이터와 윈스(WINS) 데이터를 기반으로 본 발명에 따른 인공지능을 이용한 보안관제 침입탐지 알람 처리 방법에 관한 실험 데이터를 획득할 수 있다. KISTI 데이터는 라벨이 존재하므로 성능 평가 가 가능하며, 각각 학습 데이터와 테스트 데이터로 활용될 수 있다. 윈스 데이터는 라벨이 존재하지 않는 데이 터에 해당할 수 있다. 본 발명에 따른 알람 처리 방법을 통해 총 8759개의 이벤트 패킷에 대해 클러스터링을 수행한 결과 24개의 군집 들과 기타 패킷 집합(Remain_25)이 생성될 수 있다. 이에 따라 본 발명에 따른 알람 처리 방법은 특정 이벤트 패킷을 대상으로 각 군집들과의 비교 및 기타 패킷 집합의 패킷들과의 비교를 수행하여 총 74번의 비교만으로 해당 특정 이벤트 패킷에 대한 탐지 동작을 완료할 수 있다. 특히, 클러스터링을 통해 생성된 24개의 군집들 각 각은 정상(Ben) 또는 악성(Mal)으로 분류되는 이벤트 패킷들을 포함할 수 있고, 각 군집에서 다수 분포를 보이 는 특징 정보는 해당 군집의 군집 특성으로 결정될 수 있다. 본 발명에 따른 알람 처리 방법은 이벤트 패킷들에 대한 분석을 통해 침입탐지를 위한 탐지 규칙을 자동으로 생 성할 수 있으며, 생성된 탐지 규칙을 적용하여 보안관제 동작을 수행할 수 있다. 특히, 이벤트 패킷의 주요 내 용이 담긴 페이로드를 분석한 결과를 기초로 이벤트 패킷에 대한 클러스터링을 수행하여 공통된 특징 정보를 사 전에 구축함으로써 침입탐지를 위한 감시 동작을 효과적으로 수행할 수 있다. 상기에서는 본 발명의 바람직한 실시예를 참조하여 설명하였지만, 해당 기술 분야의 숙련된 당업자는 하기의 특 허 청구의 범위에 기재된 본 발명의 사상 및 영역으로부터 벗어나지 않는 범위 내에서 본 발명을 다양하게 수정 및 변경시킬 수 있음을 이해할 수 있을 것이다."}
{"patent_id": "10-2021-0082724", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명에 따른 알람 처리 시스템을 설명하는 도면이다. 도 2는 도 1의 알람 처리 장치의 시스템 구성을 설명하는 도면이다. 도 3은 도 1의 알람 처리 장치의 기능적 구성을 설명하는 도면이다. 도 4는 본 발명에 따른 알람 처리 과정을 설명하는 순서도이다. 도 5는 본 발명에 따른 알람 처리 방법과 알람 피로 문제 간의 관계를 설명하는 도면이다. 도 6은 본 발명에 따른 인공지능을 이용한 보안관제 침입탐지 알람 처리 방법을 설명하는 도면이다. 도 7은 본 발명에 따른 인공지능을 이용한 보안관제 침입탐지 알람 처리 방법에 관한 실험 결과를 설명하는 도 면이다."}
