{"patent_id": "10-2022-0118766", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2022-0133834", "출원번호": "10-2022-0118766", "발명의 명칭": "학습 모델을 이용한 데이터 처리 방법", "출원인": "이화여자대학교 산학협력단", "발명자": "김진우"}}
{"patent_id": "10-2022-0118766", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "환자의 타겟 데이터를 서로 다른 모달리티(Modality)를 가지는 상기 타겟 데이터의 특징 정보 및 상기 환자의속성 정보를 융합 분석하여 복수의 패턴들 중 어느 하나의 패턴으로 분류하는 단계;상기 타겟 데이터의 패턴 분류를 수행하는 학습 모델에 적용하기 위하여 상기 복수의 패턴들에 대응하는 환자의타겟 데이터들 중 미리 설정된 기준에 따라 일부의 타겟 데이터들을 추출함으로써 훈련 데이터 셋을 결정하는단계;상기 훈련 데이터 셋에 포함된 상기 타겟 데이터들의 패턴 간 비율을 일치시키는 단계;상기 패턴 간 비율이 일치된 상기 훈련 데이터 셋 내의 타겟 데이터들을 이용하여 상기 학습 모델을 학습하는단계; 및설명 가능한 인공지능(eXplainable AI, XAI) 기법을 이용하여 상기 학습된 학습 모델의 질(Quality)을 평가하는단계를 포함하는 데이터 처리 방법."}
{"patent_id": "10-2022-0118766", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 결정하는 단계는,상기 복수의 패턴들 각각에 포함된 상기 환자의 타겟 데이터들 중 패턴 별로 동일한 개수의 타겟 데이터들을 추출하여 상기 학습 모델의 검증을 위한 유효성 검증 셋을 생성하는 단계; 및상기 복수의 패턴들 각각에 포함된 상기 환자의 타겟 데이터들 중 상기 유효성 검증 셋에 포함된 타겟 데이터들을 제외한 타겟 데이터들을 훈련 데이터 셋으로 결정하는 단계를 포함하는 데이터 처리 방법."}
{"patent_id": "10-2022-0118766", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제2항에 있어서,상기 생성하는 단계는,상기 복수의 패턴들 중 가장 적은 개수의 타겟 데이터들을 포함하는 패턴에 기초하여 상기 유효성 검증 셋을 생성하는 데이터 처리 방법."}
{"patent_id": "10-2022-0118766", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제1항에 있어서,상기 일치시키는 단계는,상기 타겟 데이터들에서 발견되는 분산을 고려하여 데이터 확장(Data Augmentation), 오버샘플링(Oversampling), 언더샘플링(Undersampling) 및 SMOTE(synthetic minority oversampling technique) 중 적어도 하나를 수행하는 데이터 처리 방법."}
{"patent_id": "10-2022-0118766", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제4항에 있어서,상기 일치시키는 단계는,공개특허 10-2022-0133834-3-상기 타겟 데이터가 이미지 데이터인 경우, 상기 이미지 데이터를 복수의 영역들로 분할하고, 분할된 영역들 각각에 대한 이미지 히스토그램의 강도를 고르게 분산시키는 히스토그램 등화(histogram equalization) 방법을 이용하는 데이터 처리 방법."}
{"patent_id": "10-2022-0118766", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제1항에 있어서,상기 학습 모델의 부하 감소와 모델 단순화를 위하여 상기 환자의 타겟 데이터에 대한 다운 샘플링을 수행하는단계를 더 포함하고,상기 분류하는 단계는,상기 다운 샘플링이 수행된 환자의 타겟 데이터에 상기 환자의 속성 데이터를 이용함으로써 상기 타겟 데이터의패턴을 분류하는 데이터 처리 방법."}
{"patent_id": "10-2022-0118766", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "학습 모델을 이용한 데이터 처리 방법이 개시된다. 데이터 처리 방법은 타겟 랜드 마크(Landmark)를 추출하고자 하는 이미지 데이터를 일정 간격에 따라 샘플링 하여 각 픽셀 위치를 중심으로 하는 이미지 배치들(image batches)을 생성하는 단계; 및 상기 타겟 랜드 마크에 대한 학습 모델에 상기 생성된 이미지 배치들을 입력하여 상기 이미지 데이터로부터 상기 타겟 랜드 마크에 대응하는 픽셀 위치를 추출하는 단계를 포함할 수 있다."}
{"patent_id": "10-2022-0118766", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 학습 모델을 이용한 데이터 처리 방법에 관한 것으로, 보다 구체적으로는 학습 모델을 이용하여 수신 된 데이터로부터 특정 정보를 추출하거나, 수신된 데이터를 분류하는 방법에 관한 것이다."}
{"patent_id": "10-2022-0118766", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "고전적인 교정에서 현대적인 교정에 이르기까지 치아, 턱 및 두개골의 공간적 관계를 분석하는 치료 방식은 세 팔로메트리(Cephalometry)에 크게 의존한다. 이와 같은 세팔로메트리는 표준화된 환자의 이미지 데이터(ex. Cephalometric x-ray)를 사용하여 사전 정의된 해부학적 랜드 마크가 표시될 수 있고, 이를 통해 진단 및 향후 치료 계획을 위한 다양한 교정 및 안면 형태 분석이 적용될 수 있다. 세팔로메트리는 비선형 확대 및 이미지 왜 곡과 같은 몇 가지 방법론적 한계에도 불구하고, 교정 및 안면 성형 수술뿐만 아니라 치열 교정에서 필수적인 역할을 수행할 수 있다. 환자의 이미지 데이터에 표시된 랜드 마크의 정확성은 임상 성능 결과 및 치료 결정에 직접적인 영향을 미칠 수 있다. 랜드 마크의 이상(Abnormalities)을 구별하는 경계가 밀리미터 또는 몇 도의 단위 범위 내에 집중되어 있 기 때문에 약간의 오차라도 심각한 오분류를 일으켜 의료과실을 유발할 수 있다. 이 문제를 더욱 어렵게 만드는 것은 인간 두개골이 매우 정교한 3D 객체인 반면, 시상면(인체를 좌우로 나눈 면)에 모델이 투영된 측면 두부 사진(Lateral cephalogram)과 같은 이미지 데이터에서는 시상면에 수직인 방향의 입방체 특성이 겹치게 된다는 점이다. 세팔로메트릭 추적(Cephalometric tracings)은 일반적으로 임상 실습에서 고도로 훈련된 교정의에 의해 수행되 지만, 앞서 언급한 한계와 시간이 많이 걸리는 특성으로 인해 교정의들 사이에서 중요한 관찰자 내 변동 및 관 찰자 간 변동이 생길 수 있다. 이로 인해 세팔로메트릭 추적의 정확성과 신뢰성을 높이기 위해 전자동 추적 소 프트웨어의 필요성이 지속적으로 증가하고 있다. 수십 년 동안 컴퓨터로 지원가능한 랜드 마크 감지 알고리즘에 대한 여러 연구가 있었다. 일례로, 템플릿 매칭, 그레이 스케일 형태소 연산자가 사용되거나 공정한 성능을 제안한 랜덤 포레스트 및 게임 이론 기법이 사용되었 다. 또는 계층 구조의 랜덤 포레스트 회귀 및 랜덤 트리의 이진 픽셀 분류와 같은 트리 기반 접근 방식이 사용 되었다. 이러한 노력에도 불구하고, 종래의 방법들은 정확도 문제에 대한 한계를 보여, 임상적으로 허용 가능한 근거 지점으로부터의 2mm 거리 내에서 약 70 %의 랜드 마크만을 추정할 수 있었다. 최근 반도체 기술의 급속한 발전으로 높은 컴퓨팅 능력에 대한 접근성이 낮아지면서 인공 지능(AI)에 대한 연구 가 번영을 누리고 있다. 특히, 실생활에 가장 잘 적용할 수 있는 이미지 처리 분야에서 성장이 눈에 띄게 증가 하고 있다. 커널 기반의 다중 계층 퍼셉트론 유형 신경망인 CNN(Convolutional Neural Network)은 광범위한 분 야에서 시각 데이터 처리에 적용될 수 있는 최고의 기술 중 하나이다. 그러나 이러한 CNN을 이용한 플랫폼조차 도 만족스럽게 개선된 정확도를 생성할 수 없었다. 더욱이, 단일 CNN 모델의 경우, 모델 계산에 대해 제공되는불확실성이 없으며, 이는 사용자가 랜드 마크 추출 알고리즘으로부터 생성된 결과를 수용하기 위한 의학적 장애 로 작용할 수 있다."}
{"patent_id": "10-2022-0118766", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은 학습 모델을 이용한 데이터 처리 방법에 관한 것으로, 보다 구체적으로는 타겟 랜드 마크에 대해 학 습된 제1 학습 모델을 이용하여 타겟 랜드 마크의 관심 영역을 설정하고, 모델 계산에 대한 불확실성이 고려된 제2 학습 모델을 이용하여 상기 설정된 관심 영역 내에서 타겟 랜드 마크에 대한 최종 픽셀 위치를 추출하는 방 법을 제공할 수 있다. 또한, 본 발명은 환자의 골격 관계를 진단하기 위하여 필요한 측면 세팔러그램 이미지의 랜드 마크를 분석하지 않고, 딥 러닝을 이용하여 측면 세팔러그램을 통해 환자의 골격을 자동으로 분류하는 방법을 제공할 수 있다. 이를 위해 본 발명은 훈련 데이터 셋에 포함된 타겟 데이터들의 클래스 간 비율을 일치시켜 딥 러닝에 대응하는 학습 모델을 학습시킴으로써 타겟 데이터들의 분류 성능을 향상시키는 방법을 제공할 수 있다. 다만, 기술적 과제는 상술한 기술적 과제들로 한정되는 것은 아니며, 또 다른 기술적 과제들이 존재할 수 있다."}
{"patent_id": "10-2022-0118766", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명의 일실시예에 따른 데이터 처리 방법은 타겟 랜드 마크(Landmark)를 추출하고자 하는 이미지 데이터를 일정 간격에 따라 샘플링 하여 각 픽셀 위치를 중심으로 하는 이미지 배치들(image batches)을 생성하는 단계; 및 상기 타겟 랜드 마크에 대한 학습 모델에 상기 생성된 이미지 배치들을 입력하여 상기 이미지 데이터로부터 상기 타겟 랜드 마크에 대응하는 픽셀 위치를 추출하는 단계를 포함할 수 있다. 상기 추출하는 단계는 상기 학습 모델을 통해 상기 입력된 이미지 배치들의 소프트 맥스 값에 대한 평균 및 불 확실성을 생성하는 단계; 및 상기 생성된 평균 및 불확실성을 이용하여 상기 이미지 데이터로부터 상기 타겟 랜 드 마크에 대응하는 픽셀 위치를 식별하는 단계를 포함할 수 있다. 상기 식별하는 단계는 상기 입력된 이미지 배치들의 소프트 맥스 값에 대한 평균 및 불확실성을 이용하여 상기 입력된 이미지 배치들의 각 픽셀 위치에 대한 가중치를 계산하는 단계; 및 상기 계산된 이미지 배치들 내의 각 픽셀 위치에 대한 가중치를 적용하여 상기 타겟 랜드 마크가 될 가능성이 가장 높은 픽셀 위치를 결정하는 단계 를 포함할 수 있다. 본 발명의 일실시예에 따른 데이터 처리 방법은 랜드 마크(Landmark)를 추출하고자 하는 이미지 데이터를 일정 간격에 따라 샘플링 하는 단계; 타겟 랜드 마크에 대해 학습된 제1 학습 모델에 상기 샘플링된 이미지 데이터의 각 픽셀 위치를 중심으로 하는 제1 이미지 배치들(image batches)을 입력하여 상기 제1 이미지 배치들의 중심 픽셀 위치와 상기 타겟 랜드 마크의 픽셀 위치 사이의 유사성을 결정하는 단계; 상기 결정된 유사성에 기초하여 상기 타겟 랜드 마크의 관심 영역을 설정하는 단계; 및 상기 타겟 랜드 마크에 대해 학습된 제2 학습 모델에 상 기 설정된 관심 영역에 대한 이미지 데이터의 각 픽셀 위치를 중심으로 하는 제2 이미지 배치들을 입력하여 상 기 설정된 관심 영역에 대한 이미지 데이터로부터 상기 타겟 랜드 마크에 대응하는 최종 픽셀 위치를 추출하는 단계를 포함할 수 있다. 상기 결정하는 단계는 상기 제1 이미지 배치들의 중심 픽셀 위치와 상기 타겟 랜드 마크의 픽셀 위치 사이가 유 사하다고 판단된 경우, 상기 제1 학습 모델로부터 1 값이 출력되고, 상기 제1 이미지 배치들의 중심 픽셀 위치 와 상기 타겟 랜드 마크의 픽셀 위치 사이가 유사하지 않다고 판단된 경우, 상기 제1 학습 모델로부터 0 값이 출력될 수 있다. 상기 설정하는 단계는 상기 제1 이미지 배치들 중 상기 중심 픽셀 위치와 상기 타겟 랜드 마크의 픽셀 위치 사 이가 유사하다고 판단된 제1 이미지 배치들을 식별하는 단계; 및 상기 식별된 제1 이미지 배치들의 중심 픽셀 위치들에 대한 평균 위치를 상기 타겟 랜드 마크의 관심 영역에 대한 중심점으로 결정하는 단계를 포함할 수 있 다. 상기 설정하는 단계는 상기 결정된 관심 영역에 대한 중심점을 기준으로 미리 설정된 기준 직경에 따라 임의 형 태의 관심 영역을 설정할 수 있다.상기 추출하는 단계는 상기 제2 학습 모델을 통해 상기 입력된 제2 이미지 배치들의 소프트 맥스 값에 대한 평 균 및 불확실성을 생성하는 단계; 및 상기 생성된 평균 및 불확실성을 이용하여 상기 설정된 관심 영역에 대한 이미지 데이터로부터 상기 타겟 랜드 마크에 대응하는 최종 픽셀 위치를 식별하는 단계를 포함할 수 있다. 상기 식별하는 단계는 상기 입력된 제2 이미지 배치들의 소프트 맥스 값에 대한 평균 및 불확실성을 이용하여 상기 관심 영역 내의 각 픽셀 위치에 대한 가중치를 계산하는 단계; 및 상기 계산된 관심 영역 내의 각 픽셀 위 치에 대한 가중치를 적용하여 상기 타겟 랜드 마크가 될 가능성이 가장 높은 최종 픽셀 위치를 결정하는 단계를 포함할 수 있다. 본 발명의 일실시예에 따른 데이터 처리 방법은 환자의 타겟 데이터를 서로 다른 모달리티(Modality)를 가지는 상기 타겟 데이터의 특징 정보 및 상기 환자의 속성 정보를 융합 분석하여 복수의 패턴들 중 어느 하나의 패턴 으로 분류하는 단계; 상기 타겟 데이터의 패턴 분류를 수행하는 학습 모델에 적용하기 위하여 상기 복수의 패턴 들에 대응하는 환자의 타겟 데이터들 중 미리 설정된 기준에 따라 일부의 타겟 데이터들을 추출함으로써 훈련 데이터 셋을 결정하는 단계; 상기 훈련 데이터 셋에 포함된 상기 타겟 데이터들의 패턴 간 비율을 일치시키는 단계; 상기 패턴 간 비율이 일치된 상기 훈련 데이터 셋 내의 타겟 데이터들을 이용하여 상기 학습 모델을 학습 하는 단계; 및 설명 가능한 인공지능(eXplainable AI, XAI) 기법을 이용하여 상기 학습된 학습 모델의 질 (Quality)을 평가하는 단계를 포함할 수 있다. 상기 결정하는 단계는 상기 복수의 패턴들 각각에 포함된 상기 환자의 타겟 데이터들 중 패턴 별로 동일한 개수 의 타겟 데이터들을 추출하여 상기 학습 모델의 검증을 위한 유효성 검증 셋을 생성하는 단계; 및 상기 복수의 패턴들 각각에 포함된 상기 환자의 타겟 데이터들 중 상기 유효성 검증 셋에 포함된 타겟 데이터들을 제외한 타 겟 데이터들을 훈련 데이터 셋으로 결정하는 단계를 포함할 수 있다. 상기 생성하는 단계는 상기 복수의 패턴들 중 가장 적은 개수의 타겟 데이터들을 포함하는 패턴에 기초하여 상 기 유효성 검증 셋을 생성할 수 있다. 상기 일치시키는 단계는 상기 타겟 데이터들의 분산을 고려하여 데이터 확장(Data Augmentation), 오버샘플링 (Oversampling), 언더샘플링(Undersampling) 및 SMOTE(synthetic minority oversampling technique) 중 적어 도 하나를 수행할 수 있다. 상기 일치시키는 단계는 상기 타겟 데이터가 이미지 데이터인 경우, 상기 이미지 데이터를 복수의 영역들로 분 할하고, 분할된 영역들 각각에 대한 이미지 히스토그램의 강도를 고르게 분산시키는 히스토그램 등화(histogram equalization) 방법을 이용할 수 있다. 상기 학습 모델의 부하 감소와 모델 단순화를 위하여 상기 환자의 타겟 데이터에 대한 다운 샘플링을 수행하는 단계를 더 포함하고, 상기 분류하는 단계는 상기 다운 샘플링이 수행된 환자의 타겟 데이터에 상기 환자의 속성 데이터를 이용함으로써 상기 타겟 데이터의 패턴을 분류할 수 있다."}
{"patent_id": "10-2022-0118766", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명은 학습 모델을 이용한 데이터 처리 방법에 관한 것으로, 보다 구체적으로는 타겟 랜드 마크에 대해 학 습된 제1 학습 모델을 이용하여 타겟 랜드 마크의 관심 영역을 설정하고, 제2 학습 모델을 이용하여 상기 설정 된 관심 영역 내에서 타겟 랜드 마크에 대한 최종 픽셀 위치를 자동으로 추출할 수 있다. 또한, 본 발명은 환자의 골격 관계를 진단하기 위하여 필요한 측면 세팔러그램 이미지의 랜드 마크를 분석하지 않고, 딥 러닝을 이용하여 측면 세팔러그램을 통해 환자의 골격을 자동으로 분류할 수 있다. 이를 위해 본 발명은 훈련 데이터 셋에 포함된 타겟 데이터들의 클래스 간 비율을 일치시켜 딥 러닝에 대응하는 학습 모델을 학습시킴으로써 타겟 데이터들의 분류 성능을 향상시킬 수 있다."}
{"patent_id": "10-2022-0118766", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "실시예들에 대한 특정한 구조적 또는 기능적 설명들은 단지 예시를 위한 목적으로 개시된 것으로서, 다양한 형 태로 변경되어 구현될 수 있다. 따라서, 실제 구현되는 형태는 개시된 특정 실시예로만 한정되는 것이 아니며, 본 명세서의 범위는 실시예들로 설명한 기술적 사상에 포함되는 변경, 균등물, 또는 대체물을 포함한다. 제1 또는 제2 등의 용어를 다양한 구성요소들을 설명하는데 사용될 수 있지만, 이런 용어들은 하나의 구성요소 를 다른 구성요소로부터 구별하는 목적으로만 해석되어야 한다. 예를 들어, 제1 구성요소는 제2 구성요소로 명 명될 수 있고, 유사하게 제2 구성요소는 제1 구성요소로도 명명될 수 있다. 어떤 구성요소가 다른 구성요소에 \"연결되어\" 있다고 언급된 때에는, 그 다른 구성요소에 직접적으로 연결되어 있거나 또는 접속되어 있을 수도 있지만, 중간에 다른 구성요소가 존재할 수도 있다고 이해되어야 할 것이다. 단수의 표현은 문맥상 명백하게 다르게 뜻하지 않는 한, 복수의 표현을 포함한다. 본 명세서에서, \"포함하다\" 또는 \"가지다\" 등의 용어는 설명된 특징, 숫자, 단계, 동작, 구성요소, 부분품 또는 이들을 조합한 것이 존재함 으로 지정하려는 것이지, 하나 또는 그 이상의 다른 특징들이나 숫자, 단계, 동작, 구성요소, 부분품 또는 이들 을 조합한 것들의 존재 또는 부가 가능성을 미리 배제하지 않는 것으로 이해되어야 한다. 다르게 정의되지 않는 한, 기술적이거나 과학적인 용어를 포함해서 여기서 사용되는 모든 용어들은 해당 기술 분야에서 통상의 지식을 가진 자에 의해 일반적으로 이해되는 것과 동일한 의미를 가진다. 일반적으로 사용되 는 사전에 정의되어 있는 것과 같은 용어들은 관련 기술의 문맥상 가지는 의미와 일치하는 의미를 갖는 것으로 해석되어야 하며, 본 명세서에서 명백하게 정의하지 않는 한, 이상적이거나 과도하게 형식적인 의미로 해석되지 않는다. 이하, 실시예들을 첨부된 도면들을 참조하여 상세하게 설명한다. 첨부 도면을 참조하여 설명함에 있어, 도면 부호에 관계없이 동일한 구성 요소는 동일한 참조 부호를 부여하고, 이에 대한 중복되는 설명은 생략하기로 한 다. 도 1은 본 발명의 일실시예에 따른 학습 모델을 이용한 데이터 처리 시스템의 개략도를 도시한 도면이다. 도 1을 참고하면, 본 발명의 데이터 처리 시스템은 데이터 처리 장치를 이용하여 다양한 교정 치료가 필요한 환자의 이미지 데이터에서 랜드 마크를 자동으로 추출할 수 있다. 이때, 데이터 처리 장치의 프로세서는 복수의 타겟 랜드 마크에 대해 학습된 학습 모델을 이용하여 환자의 이미지 데이터 에서 랜드 마크를 추출할 수 있다. 일례로, 치열 교정 수술을 수행하기 전 의사는 정해진 규정에 따라 환자를 진단할 필요가 있다. 이러한 규정은 쉽게 분석할 수 있도록 치아, 턱, 두개골 사이의 공간적 관계를 수치적 방식으로 요구할 수 있다. 세팔로메트리 (Cephalometry)는 두개골의 2D X-ray 이미지인 세팔로그램(Cephalogram)에서, 지역적인 특징에 기초하여 미리 정의된 랜드 마크들 사이의 상관 관계를 통해 이러한 규정을 제공할 수 있다. 의사들 사이에서 사용되는 랜드 마크의 수와 관련하여 일부 변동성이 있지만, 도 2에서 표시된 랜드 마크들이 가장 일반적으로 사용될 수 있다. 의사들은 환자의 이미지 데이터로부터 이러한 랜드 마크들을 찾아 랜드 마크들 간의 적절한 상관 관계를 계산함으로써 환자에게 적합한 진단을 내리고, 향후 치료 계획을 세울 수 있다. 구체적으로 데이터 처리 장치는 다양한 종류의 딥러닝(Deep Learning) 모델에 대응하는 학습 모델을 이용하여 랜드 마크를 추출할 수 있다. 본 발명에서는 일례로, 합성곱 신경망(Convolution Neural Network,CNN) 모델을 이용한 랜드 마크 추출 방법을 설명하도록 한다. 그러나 이와 같은 학습 모델은 CNN 모델에 한정되지 않고 순환 신경망(Recurrent Neural Network, RNN) 등과 같이 다양한 딥러닝 모델이 적용될 수 있다. 이후 데이터 처리 장치는 추출된 랜드 마크를 환자의 이미지 데이터에 중첩한 후 이를 별도의 디스플 레이를 통해 표시함으로써 의사가 환자의 교정 치료에 필요한 랜드 마크에 대한 정보를 쉽게 확인할 수 있 도록 도와줄 수 있다. 본 발명의 데이터 처리 장치가 제공하는 전체 프레임 워크는 LRS(Low-Resolution Screening) 및 HRS(High-Resolution Screening)의 두 가지 알고리즘으로 나뉠 수 있다. LRS 알고리즘은 환자의 이미지 데이터 에서 추출하고자 하는 타겟 랜드 마크에 대한 관심 영역(Region Of Interest, ROI)을 생성할 수 있고, HRS 알고리즘은 생성된 관심 영역 내의 모든 단일 픽셀들을 미리 학습 모델을 통해 학습된 타겟 랜드 마크와 비 교함으로써 최종적인 타겟 랜드 마크의 픽셀 위치를 추출할 수 있다. 이때, HRS 알고리즘은 타겟 랜드 마크의 픽셀 위치뿐만 아니라 불확실성에 대한 정보를 같이 제공할 수 있으며, 사용자는 제공된 불확실성에 대한 정보 를 이용하여 추출된 타겟 랜드 마크의 픽셀 위치에 대한 신뢰도를 파악할 수 있다. 이를 위해 프레임 워크는 LRS 알고리즘 및 HRS 알고리즘을 수행하기 위하여 두 개의 자체적인 학습 모델이 필요할 수 있다. 그리고, 데이터 처리 장치는 적절할 훈련 데이터를 이용하여 각각의 학습 모델을 개 별적으로 훈련함으로써 환자의 이미지 데이터에서 랜드 마크를 추출할 수 있다. 이러한 학습 모델의 훈련을 위하여 훈련 데이터 셋이 필요할 수 있는데 각각의 훈련 데이터 셋은 피험자의 이미지 데이터와 해당 이미지 데이터에 대해 전문가가 수동으로 설정한 랜드 마크의 좌표 정보를 포함할 수 있 다. 이때, 특정 랜드 마크에 대한 좌표 정보는 전문가들이 수동으로 설정한 만큼 전문가들의 숙련도에 따라 전 문가들 간 변동성이 존재할 수 있다. 따라서, 데이터 처리 장치는 이러한 전문가들 사이의 변동성을 보상 하기 위하여 전문가들 각각이 랜드 마크로 설정한 좌표들의 평균을 기준이 되는 랜드 마크(Ground Truth)로 사 용할 수 있다. 일례로, 데이터 처리 장치는 LRS 알고리즘에 대한 훈련 데이터 셋을 얻기 위해 피험자의 이미지 데이터에 대해 전문가가 설정한 각각의 랜드 마크 위치에서 18mm 떨어진 경계 내의 NT 픽셀을 무작위로 추출하여 정답 세 트로 구성하고, 마찬가지로 경계 밖의 NF 픽셀을 설정하여 오답 세트로 만들 수 있다. HRS 알고리즘에 대한 훈 련 데이터 셋의 경우, 데이터 처리 장치는 정답 영역의 반경을 0.9mm 이내로 설정하고 오답 영역을 2.1mm 에서 40mm 범위 내로 설정할 수 있다. 도 3은 본 발명의 데이터 처리 장치가 수행하는 랜드 마크 추출 방법을 플로우챠트로 도시한 도면이다. 보다 구체적으로 단계에서, 데이터 처리 장치의 프로세서는 랜드 마크를 추출하고자 하는 이미 지 데이터를 수신하여 일정 간격에 따라 샘플링 하여 각 픽셀 위치를 중심으로 하는 이미지 배치들(image batches)을 생성할 수 있다. 일례로, 데이터 처리 장치는 안면 성형 수술이나 치열 교정 등을 위하여 환자 의 측면 두부 사진(Lateral cephalogram)을 수신할 수 있다. 그러나, 이와 같은 이미지 데이터는 측면 두부 사 진에 한정되지 않고, 환자의 교정 치료를 위하여 필요한 이미지는 모두 사용될 수 있다. 이때, 상기 수신된 이미지 데이터가 고해상도의 이미지 데이터인 경우, 해당 고해상도의 이미지 데이터를 그대 로 이용하여 랜드 마크를 추출하게 되면 계산 복잡성이 매우 커질 수 있다. 따라서, 프로세서는 데이터 처 리 장치의 전체 시스템 부하를 낮추고, 보다 신속하게 랜드 마크를 추출하기 위하여, 수신된 이미지 데이 터를 폭 방향 및 높이 방향에 따라 같은 길이의 스트라이드(Stride), 즉 일정 간격에 따라 샘플링함으로써 원본 이미지 데이터 대비 적은 수의 픽셀 위치를 획득할 수 있다. 일례로, 프로세서는 수신된 이미지 데이터를 샘플링하여 폭 방향 및 높이 방향으로 3mm 간격에 따른 픽셀 위치를 획득할 수 있다. 이때, 프로세서는 단지 픽셀 값만으로 샘플링된 위치를 결정하는 것이 불가능하기 때문에, 샘플링을 통해 획득된 픽셀 위치를 중심으로 하는 제1 이미지 배치들(image batches)를 생성할 수 있다. 본 발명에서는 이와 같이 생성된 제1 이미지 배치들이 정사각형의 형태로 표현되지만, 이에 한정되지 않고 다양한 형태로 표현될 수 있다. 일례로, 샘플링을 통해 획득된 i 번째 픽셀 위치 를 중심으로 하는 제1 이미지 배치는 로 표시될 수 있다. 단계에서, 프로세서는 수신된 이미지 데이터를 통해 생성된 제1 이미지 배치들을 타겟 랜드 마크 에 대해 학습된 제1 학습 모델( 에 입력하여 제1 이미지 배치들의 중심 픽셀 위치( )가 의 관계를 만족하는지를 판단할 수 있다. 즉, 프로세서는 제1 학습 모델을 이용하여 제1 이미지 배치들의 중 심 픽셀 위치와 제1 학습 모델을 통해 미리 학습된 타겟 랜드 마크의 픽셀 위치 사이의 유사성을 결정할 수 있 다. 구체적으로 프로세서는 제1 이미지 배치들의 중심 픽셀 위치와 학습된 타겟 랜드 마크의 픽셀 위치 사 이의 물리적인 거리를 기준으로 유사성을 결정할 수 있다. 이때, 제1 학습 모델은 제1 이미지 배치들의 중심 픽셀 위치와 제1 학습 모델을 통해 학습된 타겟 랜드 마크의 픽셀 위치 사이가 유사하다고 판단된 경우, \"1\" 값을 출력하고, 제1 이미지 배치들의 중심 픽셀 위치와 제1 학 습 모델을 통해 학습된 타겟 랜드 마크의 픽셀 위치 사이가 유사하지 않다고 판단된 경우, \"0\" 값을 출력할 수 있다. 단계에서, 프로세서는 결정된 유사성에 기초하여 타겟 랜드 마크의 관심 영역을 설정할 수 있다. 보 다 구체적으로 프로세서는 제1 이미지 배치들 중 중심 픽셀 위치와 제1 학습 모델을 통해 학습된 타겟 랜 드 마크의 픽셀 위치 사이가 유사하다고 판단된 제1 이미지 배치들을 식별하고, 식별된 제1 이미지 배치들의 중 심 픽셀 위치들에 대한 평균 픽셀 위치를 해당 타겟 랜드 마크에 대한 관심 영역의 중심점으로 결정할 수 있다. 다시 말하자면, 프로세서는 제1 이미지 배치들 중 제1 학습 모델을 통해 \"1\" 값이 출력된 이미지 배치들 ( )의 픽셀 위치를 이용하여 타겟 랜드 마크의 관심 영역에 대한 중심점 을 아래의 수학식 1을 통해 결 정할 수 있다. <수학식 1>"}
{"patent_id": "10-2022-0118766", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "그리고, 프로세서는 결정된 관심 영역의 중심점 을 기준으로 미리 설정된 기준 직경(DR)에 따라 관 심 영역을 설정할 수 있다. 일례로, 기준 직경은 Ground Truth의 99%가 내부에 있는 40mm로 설정될 수 있다. 단계에서, 프로세서는 관심 영역 내의 모든 픽셀들 각각의 픽셀 위치를 중심으로 하는 제2 이미지 배 치들( )을 생성할 수 있다. 본 발명에서 제2 이미지 배치들은 제1 이미지 배치들과 마찬가지로 정사각형의 형태로 표현되지만, 이에 한정되지 않고 다양한 형태로 표현될 수 있다. 단계에서, 프로세서는 생성된 제2 이미지 배치들을 타겟 랜드 마크 에 대해 학습된 제2 학습 모델 ( 에 입력하여 설정된 관심 영역에 대한 이미지 데이터로부터 타겟 랜드 마크에 대응하는 최종 픽셀 위치를 추출할 수 있다. 이때, 제2 학습 모델은 제1 학습 모델과는 달리 불확실성을 고려하여 훈련 데이터 셋이 학습된 모델로서, 추출된 타겟 랜드 마크에 대응하는 최종 픽셀 위치의 신뢰 영역을 도출할 수 있다. 여기서 신뢰 영역 은 타겟 랜드 마크로써 추출된 복수의 최종 픽셀 위치들에 대한 평균 위치들의 분포를 통해 분산을 구하고, 이 를 타원체(Ellipsoid)의 축 간격(Axial distance)으로 취급한 영역을 의미할 수 있다. 일례로, 제2 학습 모델은 불확실성을 고려하는 베이지안 추론(Bayesian Inference)과 합성곱 신경망 모델이 융 합된 베이지안 합성곱 신경망(Bayesian Convolution Neural Network, B-CCN)일 수 있다. 그러나 베이지안 추론 은 본 발명의 일실시예일 뿐 이에 한정되지 않고, 불확실성을 고려할 수 있는 모델이면 모두 사용 가능할 수 있 다. 구체적으로 프로세서는 제2 학습 모델을 통해 입력된 제2 이미지 배치들의 소프트 맥스 값에 대한 평균 ( ) 및 불확실성( )을 생성할 수 있다. 여기서 소프트 맥스 값은 클래스(True, False) 간의 확률적 유사도를 의미하고, 불확실성은 드롭 아웃(Dropout)으로 야기되는 신경망의 확률적 모수 통계에서 반복 계산에 의한 확률 적 분산을 의미한다. 이때, 평균이 높고 불확실성이 낮은 픽셀이 타겟 랜드 마크가 될 가능성이 높기 때문에 프로세서는 아래의 수학식 2와 같이 두 가지 관계를 고려하여 제2 이미지 배치들의 중심 픽셀 위치에 대한 가중치를 나타내는 점수 ( )를 획득할 수 있는 후처리 방법을 제공할 수 있다.<수학식 2>"}
{"patent_id": "10-2022-0118766", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "즉, 프로세서는 확률에 대한 단조 증가 함수(Monotonic increasing function) 중 이계도함수(Second derivative)가 양수인 비선형 함수를 사용하여 확률이 높으면 높을수록 가중치를 많이 받되, 분산이 높으면 점 수가 떨어지도록 정규화된 분산(Normalized variance)의 역수를 취할 수 있다. 또한, 프로세서는 분산이 0 에 가까울 때 너무 큰 값을 내어놓지 못하도록 tanh 로 임계값(Threshold)를 줄 수 있다. 마지막으로 프로세서는 관심 영역 내의 모든 픽셀들 각각에 대해 상기의 수학식 2를 통해 획득한 점수 ( )를 이용하여 타겟 랜드 마크에 대응하는 최종 픽셀 위치 를 아래의 수학식 3과 같이 추출할 수 있다. <수학식 3>"}
{"patent_id": "10-2022-0118766", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "즉, 타겟 랜드 마크에 대한 최종 픽셀 위치 는 질량 중심의 계산과 유사하게 '점수 중심'으로 간주되어 추출될 수 있다. 다만, '점수 중심'을 구하는 과정에서 사용되는 수학식 1 내지 수학식 3은 해당 식에 한정되지 않고, 필요에 따라 변형될 수 있다. 도 4는 본 발명의 일실시예에 따른 랜드 마크 추출 과정을 실제 도면을 통해 나타낸 도면이다. 데이터 처리 장치는 랜드 마크를 추출하고자 하는 이미지 데이터를 수신할 수 있다. 그리고, 데이터 처리 장치는 수신된 이미지 데이터를 폭 방향 및 높이 방향에 따라 샘플링 함으로써 획득된 이미지 데이터로부터 일정 간격에 따른 픽셀 위치를 중심으로 하는 제1 이미지 배치들을 생성할 수 있다. 데이터 처리 장치은 이미지 데이터에 대해 LRS 알고리즘을 수행함으로써 타겟 랜드 마크의 관심 영역 을 설정할 수 있다. 보다 구체적으로 데이터 처리 장치는 제1 이미지 배치들을 타겟 랜드 마크에 대 해 학습된 제1 학습 모델(ex. CNN)에 입력하여 제1 이미지 배치들의 중심 픽셀 위치와 제1 학습 모델 을 통해 학습된 타겟 랜드 마크의 픽셀 위치 사이의 유사성을 결정할 수 있다. 그리고, 데이터 처리 장치 는 결정된 유사성에 기초하여 타겟 랜드 마크의 관심 영역이 설정된 이미지 데이터를 획득할 수 있다. 이후 데이터 처리 장치는 관심 영역이 설정된 이미지 데이터에 대해 HRS 알고리즘을 수행함으로써 타 겟 랜드 마크의 최종 픽셀 위치를 추출할 수 있다. 보다 구체적으로 데이터 처리 장치는 이미지 데이터 의 관심 영역을 구성하는 모든 픽셀들 각각의 픽셀 위치를 중심으로 하는 제2 이미지 배치들을 생성 할 수 있다. 이후 데이터 처리 장치는 제2 이미지 배치들을 타겟 랜드 마크에 대해 학습된 제2 학습 모델(ex. B-CNN)에 입력함으로써 타겟 랜드 마크에 대한 최종 픽셀 위치가 추출된 이미지 데이터를 획득할 수 있다. 이상의 데이터 처리 장치가 수행하는 타겟의 랜드 마크 추출 과정은 타겟 랜드 마크의 관심 영역을 설정하 는 LRS 알고리즘과 타겟 랜드 마크의 픽셀 위치를 추출하는 HRS 알고리즘을 단계적으로 수행하는 구성을 보여준 다. 그러나, 본 발명의 데이터 처리 장치는 이미지 데이터에서 획득된 픽셀 위치를 중심으로 하는 제1 이 미지 배치들들을 이용하여 HRS 알고리즘을 바로 수행함으로써 타겟 랜드 마크의 최종 픽셀 위치를 제공할 뿐만 아니라 불확실성에 대한 정보를 함께 제공하여 사용자가 타겟 랜드 마크의 최종 픽셀 위치에 대한 신뢰도 를 파악하는데 도움을 줄 수도 있다. 상기의 예에서는 본 발명의 데이터 처리 장치가 2D 형태의 세팔러그램 상에서 이차원 딥러닝 모델(EX. 2D CNN)을 통해 2D 랜드 마크를 추출하는 방법을 제공하고 있으나, 이에 한정되지 않고, 3D 형태의 콘빔전산화단층 촬영(Cone Beam Computed Tomography, CBCT) 상에서 삼차원 딥러닝(EX. 3D CNN)을 통해 3D 랜드 마크를 추출할수도 있다. 이를 위해 본 발명의 데이터 처리 장치는 랜드 마크 추출에 사용되는 이차원 딥러닝 모델을 3D 커널 (Kernel)을 사용하여 3D Convolution, 3D Pooling 등이 포함되는 삼차원 딥러닝 모델로 치환할 수 있다. 또한, 본 발명의 데이터 처리 장치는 타겟 랜드 마크에 대응하는 픽셀 위치를 추정하는 기법에 대해 간단한 변형 을 통해 3D 데이터에 적용할 수 있다. 데이터 처리 장치는 이와 같이 치환된 삼차원 딥러닝 모델과 변형된 기법을 통해 CBCT 상에서 3D 랜드 마크를 추출할 수 있다. 도 5는 본 발명의 일실시예에 따른 데이터 처리 장치가 수행하는 학습 모델의 학습 방법을 도시한 도면이다. 본 발명의 데이터 처리 장치는 환자의 타겟 데이터를 분석하여 해당 타겟 데이터가 복수의 패턴들 중 어느 패턴에 대응하는지를 도출할 수 있다. 이때, 데이터 처리 장치는 딥 러닝(Deep learning)과 같은 학습 모 델을 이용하여 환자의 타겟 데이터에 대한 패턴 분류를 수행할 수 있다. 이와 같은 데이터 처리 장치는 패턴 분류를 수행하는 학습 모델의 성능에 따라 패턴 분류의 정확도가 달라 질 수 있는데, 학습 모델의 성능은 학습에 필요한 훈련 데이터에 많은 영향을 받을 수 있다. 일례로, 데이터 처리 장치가 타겟 데이터를 패턴 A, 패턴 B 및 패턴 C 중 어느 하나의 패턴으로 분류하고 자 하면, 패턴 A 내지 패턴 C에 대응하는 각각의 훈련 데이터들로 구성된 훈련 데이터 셋을 이용하여 학습 모델 이 학습되어야 한다. 그러나 많은 경우에, 훈련 데이터 셋에 포함된 패턴 A 내지 패턴 C에 대응하는 훈련 데이 터들 간 불균형이 발생할 수 있으며, 이러한 훈련 데이터 셋을 사용하여 학습이 수행된 학습 모델은 다수의 패 턴에 대한 편향이 발생함으로써 소수의 패턴에 대한 패턴 분류 성능이 저하되는 문제가 발생될 수 있다. 이러한 문제를 해결하기 위하여 본 발명의 데이터 처리 장치는 훈련 데이터 셋에 포함된 타겟 데이터들의 패턴 간 비율을 일치시켜 학습 모델을 학습시킴으로써 타겟 데이터들의 분류 성능을 향상시킬 수 있다. 도 5를 참고하면, 데이터 처리 장치는 단계에서, 복수의 패턴들 각각에 대응하는 타겟 데이터들을 수 신할 수 있다. 이때, 수신되는 타겟 데이터들은 패턴 간 비율이 불일치할 수 있다. 단계에서, 데이터 처리 장치는 패턴 간 비율이 불일치하는 타겟 데이터들 중 미리 설정된 기준에 따 라 일부의 타겟 데이터들을 추출함으로써 학습 모델을 학습시키기 위한 훈련 데이터 셋을 결정할 수 있다. 보다 구체적으로 데이터 처리 장치는 복수의 패턴들 각각에 포함된 타겟 데이터들 중 패턴 별로 동일한 개수의 타겟 데이터들을 추출하여 학습 모델의 검증을 위한 유효성 검증 셋을 생성할 수 있다. 이때, 데이터 처리 장치는 복수의 패턴들 중 가장 적은 개수의 타겟 데이터들을 포함하는 패턴에 기초하여 유효성 검증 셋을 생성할 수 있다. 만약 패턴 A 내지 패턴 C 중 패턴 C에 포함된 타겟 데이터들의 개수가 가장 적다면, 데이터 처리 장치는 패턴 C를 기준으로 일정 퍼센트에 대응하는 개수 만큼 패턴 A 내지 패턴 C 각 각에서 무작위로 타겟 데이터들을 추출함으로써 유효성 검증 셋을 생성할 수 있다. 이후 데이터 처리 장치는 복수의 패턴들 각각에 포함된 타겟 데이터들 중 유효성 검증 셋에 포함된 타겟 데이터들을 제외한 나머지 타겟 데이터들을 훈련 데이터 셋으로 결정할 수 있다. 이때, 유효성 검증 셋이 복수 의 패턴들 각각에서 동일한 개수의 타겟 데이터들을 추출하여 생성되었으므로, 훈련 데이터 셋은 여전히 패턴 간 비율이 불일치할 수 있다. 단계에서, 데이터 처리 장치는 훈련 데이터 셋에 포함된 타겟 데이터들의 패턴 간 비율을 일치시킬 수 있다. 위에서 언급한 바와 같이 학습 모델의 성능은 학습에 필요한 훈련 데이터에 많은 영향을 받는데, 데이 터 처리 장치는 훈련 데이터 셋에 포함된 타겟 데이터들의 패턴 간 비율을 일치시켜 학습 모델을 학습시킴 으로써 타겟 데이터들의 분류 성능을 향상시킬 수 있다. 이를 위하여 데이터 처리 장치는 훈련 데이터 셋에 포함된 복수의 패턴들 각각에 대응하는 타겟 데이터들 의 분산(variation)을 고려하여 데이터 확장(Data Augmentation), 오버샘플링(Oversampling), 언더샘플링 (Undersampling) 및 SMOTE(synthetic minority oversampling technique) 중 적어도 하나를 수행할 수 있다. 그 중 데이터 확장은 실제로 존재 가능한 데이터를 생성하여 실제 데이터 공간 상의 비어 있는 공간들을 채워 넣는 것이 목적일 수 있다. 그런데 데이터 확장을 통해 생성된 확장 데이터는 실제 데이터 양에 비해서 많은 양이 만 들어지고, 실제 데이터와 함께 훈련 데이터 셋으로 사용되기 때문에 잘못된 방법으로 만들어지면 학습 자체에 오류 또는 바이어스(bias)가 생길 수 있다.따라서 데이터 처리 장치는 훈련 데이터 셋에 포함된 타겟 데이터들에서 관찰될 수 있는 분산을 식별하고, 식별된 분산 내에서 데이터 확장을 수행할 있다. 즉, 데이터 처리 장치는 복수 환자의 세팔로그램 이미지 내에서 변동이 있는 영역의 변동 정도를 식별하고, 식별된 변동 정보에 기초하여 데이터 확장을 수행할 수 있다. 일례로, 데이터 처리 장치는 모든 환자의 세팔로그램 이미지가 오른쪽을 보고 있기 때문에 버티컬 플립 (vertical flip)을 수행하지 않을 수 있다. 따라서, 모든 환자의 세팔로그램 이미지의 위치에 대한 좌우 변동은 있었으나 상하 변동은 없었기 때문에 데이터 분류 장치는 좌우 변동만 고려하여 데이터 확장을 수행할 수 있다. 이와 같은 데이터 확장을 통해 데이터 처리 장치는 훈련 데이터 셋에 포함된 복수의 패턴들 간 비율을 일 치시킬 수 있다. 일례로, 타겟 데이터가 이미지 데이터인 경우, 데이터 처리 장치는 훈련 데이터 셋에 포 함된 이미지 데이터들의 이동 및 회전을 통해 이미지 데이터들의 수를 증가시키고, 증가된 이미지 데이터들에 히스토그램 등화(histogram equalization)을 수행함으로써 품질을 향상시킬 수 있다. 또한, 데이터 처리 장치 는 증가된 이미지 데이터들에 이미지 데이터를 복수의 영역으로 분할하고, 분할된 영역들 각각에 대한 이 미지 히스토그램의 강도를 고르게 분산시키는 적응 히스토그램 등화(adaptive histogram equalization)을 이용 함으로써 국부 대비(contrast) 및 가장자리 선명도를 가지는 이미지 데이터들을 획득할 수 있다. 즉, 다양한 환자의 세팔러그램 이미지는 넓은 선명도 및 국부 대비의 분포를 갖기 때문에 데이터 처리 장치 는 히스토그램 등화 및 적응 히스토그램 등화를 통해 보다 다양한 선명도 및 콘트라스트를 가지는 데이터 를 생성하고 이를 학습시킬 수 있다. 이를 위해 데이터 분류 장치는 최대 및 최소 변형을 정하고 그 내부에서 랜덤(random)한 데이터 확장을 진행한 것이 아니라, 모든 데이터 확장에 같은 파라미터를 적용하여 비슷한 변형 이 일어나게 할 수 있다. 도 6a 내지 도 6c는 데이터 확장을 수행한 예로서 도 6a는 원본 이미지이고, 도 6b는 히스토그램 등화를 통해 생성된 이미지를 나타내며, 도 6c는 적응 히스토그램 등화를 통해 생성된 이미지를 나 타낸다. 이와 같이 데이터 처리 장치는 훈련 데이터 셋에 포함된 복수의 패턴들 각각에 대응하는 타겟 데이터들에 대해 임의의 수준으로 데이터 확장을 수행함으로써 훈련 데이터 셋 내에 복수의 패턴들 간 비율이 일치된 타겟 데이터들을 획득할 수 있다. 단계에서, 데이터 처리 장치는 복수의 패턴들 간 비율이 일치된 훈련 데이터 셋 내의 타겟 데이터들 을 이용하여 학습 모델을 학습할 수 있다. 그리고, 단계에서, 데이터 처리 장치는 단계에서 생 성된 유효성 검증 셋을 이용하여 학습 모델을 검증할 수 있다. 도 7은 본 발명의 일실시예에 따른 데이터 처리 장치가 수행하는 학습 모델을 이용한 환자의 골격 분류 방법을 도시한 도면이다. 도 7은 도 5에서 제시된 데이터 처리 장치가 수행하는 학습 모델의 학습 방법을 이용하여 측면 세팔러그램 이미지를 통해 환자의 골격을 분류하는 방법을 제공한다. 보다 구체적으로 데이터 처리 장치는 측면 세팔 러그램 이미지의 랜드 마크를 분석하지 않고, 도 5의 학습 방법을 통해 학습된 학습 모델을 이용하여 자동화된 환자의 골격 분류 방법을 제공할 수 있다. 먼저, 데이터 베이스(data base)는 복수의 환자들에 대한 측면 세팔러그램 이미지(X-ray)들을 포함할 수 있다. 그리고, 데이터 베이스는 측면 세팔러그램 이미지들 각각에 대하여 전문가에 의해 식별된 랜드 마크 정보를 포 함할 수 있다. 마지막으로, 데이터 베이스는 해당 측면 세팔러그램 이미지에 대하여 성별 정보 등과 같은 환자 의 인구 통계 정보를 포함할 수 있다. 이때, 데이터 처리 장치는 데이터 베이스에 포함된 모든 측면 세팔러그램 이미지들에 대해 중요한 정보는 잃지 않으면서도 계산 복잡성을 크게 줄이기 위하여 미리 설정된 기준에 따라 다운 샘플링을 수행할 수 있 다.(S710) 그리고, 데이터 처리 장치는 측면 세팔러그램 이미지의 랜드 마크 정보와 환자의 인구 통계 정보를 이용하 여 해당 측면 세팔러그램 이미지를 복수의 패턴 중 어느 하나의 패턴으로 분류할 수 있다.(S720) 현대의 치열 교정에서 부정 교합의 골격 분류는 시상 골격 및 수직 골격으로 결정된다. 이때, 도 8을 참고하면, Point A-Nasion-Point B(ANB)와 Wits 평가는 시상 골격 관계를 진단하는 두 가지 일반적인 방법이다. 여기서ANB는 상악과 하악의 관계를 말하고, A-Nasion-B 점의 각도로 측정될 수 있다. Wits 평가는 전후방 턱 불일치의 심각성을 나타내는 시상 골격 관계를 분류하기 위한 분석 방법이다. 이와 같은 Wits 평가는 최대 커스프 인터디지테이션(cusp interdigitation) 영역을 통해 그려진 교합 평면(Occlusal plane) 선에 A 지점과 B 지점을 수직으로 투영함으로써 식별될 수 있다. Wits 평가는 전방의 두개골 베이스 (anterior cranial base) 각도에 관계없이 기본 관계를 나타내는 점에서 ANB 측정과 다르다. 한편 도 8을 참고하면, Jarabak의 비율과 의 합은 수직 골격 관계를 결정하는 데 널리 적용되는 두 가지 일반적인 방법이다. Jarabak의 비율 (“수직 얼굴 높이 비율”)은 개인의 수직 얼굴 성장 패턴을 결정하며, 후 방 얼굴 높이(Sella-Gonion)를 전방 얼굴 높이(Nasion-Menton)로 나눈 값으로 계산될 수 있다. 그리고 의 합은 새들 각도(Saddle angle)(N-S-Ba), 관절 각도(Articular angle)(S-Ba-Go) 및 악각점 각도(gonial angle)(하악골(mandible)의 바디(body)와 하악골지(ramus)의 후방 경계가 접하는 각도)의 합으로 계산될 수 있 다. 시상 골격 진단 및 수직 골격 진단을 위해, 상기의 모든 방법들은 동일한 가중치를 갖는 것으로 간주될 수 있다. 예를 들어, 시상 골격 진단을 위해 데이터 분류 장치는 0.5 ANB + 0.5 Wits 평가의 정규화 그래프를 작성 하고, 평균(Mean) 및 표준 편차(SD)를 아래의 표 1과 같이 진단 기준으로 사용하였다. 표 1 Method Male Female Mean SD Mean SD ANB 2.166 3.167 3.421 2.838 Wits appraisal -4.310 4.707 -3.495 3.930 396.433 6.627 398.902 6.457 Jarabak's ratio 65.243 5.196 62.864 4.826 구체적으로 데이터 처리 장치는 정규화 그래프에 기초하여 시상 골격의 패턴을 클래스 I, 클래스 II 및 클 래스 III으로 구분하고, 수직 골격의 패턴을 정상, 과다 발산 및 저 발산으로 구분할 수 있다. 이때, 각 분류의 경계에 임상적 특징이 있는 환자는 불명확한 진단을 유발할 수 있고 모델 정확도에 부정적인 영향을 줄 수 있기 때문에 데이터 처리 장치는 아래의 표 2와 같이 특정 수준의 SD 환자를 제외시키기 위한 다양한 모델을 이 용할 수 있다. 일례로, 모델 I은 모든 환자 데이터가 사용되었고, 모델 II는 0.2 SD 이내의 환자 데이터를 제외 하여 사용되었으며, 모델 III은 0.3 SD 이내의 환자 데이터를 제외하여 사용되었다. 표 2 시상 골격(Sagittal) 수직 골격(Vertical) Class IClass IIClass IIITotalNormalhyperdivergenthypodivergentTotal Model I432677978558904115 835 940 5890 Model II373850458148233511 598 650 4759 Model III339841251143213120 491 548 4159 이때, 표 2에서와 같이 시상 골격 및 수직 골격의 패턴 간 비율이 불일치하는 패턴 불균형 문제가 발생될 수 있 다. 이러한 문제는 장애의 불균형과 같은 의료 기록의 특성으로 인해 많은 의료 데이터 세트에서 발생될 수 있 다. 즉, 이와 같은 패턴 불균형 문제가 해결되지 않으면, 이러한 패턴 불균형 문제를 내재한 데이터를 사용하여 학습한 학습 모델에는 다수 패턴에 대한 편향이 포함될 수 있으며, 그로 인해 소수 패턴에 대한 패턴 분류에 있 어 성능 저하가 나타날 수 있다. 일례로, 환자 데이터가 정규 분포를 따른다고 가정하면, 정규 패턴(EX. 시상 분류 - 클래스 I)와 두 개의 비정상 패턴(EX. 시상 분류 - 클래스 II 및 클래스 III)가 대략 68:16:16 비율로 분포되어 있기 때문에 패턴 불균형 문제가 있음을 알 수 있다. 따라서, 데이터 처리 장치는 패턴 불균형 문제를 해결하기 위하여 훈련 데이터 셋에 포함된 측면 세팔러그 램 이미지들의 패턴 간 비율을 일치시켜 학습 모델을 학습시킴으로써 측면 세팔러그램 이미지들의 분류 성능을향상시킬 수 있다. 데이터 처리 장치는 패턴 불균형 문제를 내재한 측면 세팔러그램 이미지들 중 미리 설정된 기준에 따라 일 부의 측면 세팔러그램 이미지들을 구분할 수 있다.(S730) 보다 구체적으로 데이터 처리 장치는 복수의 패 턴들 각각에 포함된 측면 세팔러그램 이미지들 중 패턴 별로 동일한 개수의 측면 세팔러그램 이미지들을 추출하 여 학습 모델의 검증을 위한 유효성 검증 셋을 생성할 수 있다.(S730-1) 이때, 데이터 처리 장치는 복수의 패턴들 중 가장 적은 개수의 측면 세팔러그램 이미지들을 포함하는 패턴 에 기초하여 유효성 검증 셋을 생성할 수 있다. 예를 들어, 표 2의 모델 I에서 수직 골격의 패턴 중 과다 발산 이 가장 적은 개수의 측면 세팔러그램 이미지들을 포함하고 있으므로, 데이터 처리 장치는 과다 발산에 대 응하는 측면 세팔러그램 이미지들의 일정 비율에 대응하는 개수만큼 다른 수직 골격의 패턴들 각각에서 무작위 로 측면 세팔러그램 이미지들을 동일하게 추출함으로써 유효성 검증 셋을 생성할 수 있다. 이후 데이터 처리 장치는 복수의 패턴들 각각에 포함된 측면 세팔러그램 이미지들 중 유효성 검증 셋에 포 함된 측면 세팔러그램 이미지들을 제외한 나머지 측면 세팔러그램 이미지들을 훈련 데이터 셋으로 결정할 수 있 다.(S730-2) 이때, 유효성 검증 셋이 복수의 패턴들 각각에서 동일한 개수의 측면 세팔러그램 이미지들을 추출 하여 생성되었으므로, 훈련 데이터 셋은 여전히 패턴 불균형 문제를 내재할 수 있다. 데이터 처리 장치는 훈련 데이터 셋에 포함된 측면 세팔러그램 이미지들의 패턴 불균형 문제를 해결하기 위하여 패턴 간 비율을 일치시킬 수 있다.(S740) 위에서 언급한 바와 같이 학습 모델의 성능은 학습에 필요한 훈련 데이터에 많은 영향을 받는데, 데이터 처리 장치는 훈련 데이터 셋에 포함된 측면 세팔러그램 이미지 들의 패턴 간 비율을 일치시켜 학습 모델을 학습시킴으로써 측면 세팔러그램 이미지들의 분류 성능을 향상시킬 수 있다. 이를 위하여 데이터 처리 장치는 훈련 데이터 셋에 포함된 복수의 패턴들 각각에 대응하는 측면 세팔러그 램 이미지들의 분산을 고려하여 이미지 확장(Image Augmentation)을 수행할 수 있다. 이미지 확장은 이미지 분 석을 위한 CNN 모델의 성능에 긍정적인 영향을 미칠 수 있다. 이와 같은 이미지 확장은 CNN 기반 의료용 X-ray 분석과 관련된 연구에 자주 사용될 수 있다. 의료 데이터는 고도로 구조화되어 생성되며 특정 프로세스에 의해 공식화될 수 있다. 측면 세팔러그램 이미지에 서 대상은 이미지의 중앙에 있으며 오른쪽을 똑바로 보는 구조를 가진다. 이러한 구조는 전통적인 이미지 확대 기술로 인해 불필요한 데이터 부분에 대한 분산이 증가할 수 있다. 따라서, 본 발명의 데이터 처리 장치는 의미 있는 증강 영상을 생성하기 위해 측면 세팔러그램 이미지에서 발견되는 분산을 고려하여 다음과 같은 선택적 데이터 증강 기술을 적용할 수 있다. 이때, 선택적 데이터 증강 기술은 좌우 10 % 이동, 시계 방향 및 반 시계 방향 5도 회전 및 히스토그램 등화를 포함할 수 있다. 히스토그램 등화는 이미지 히스토그램의 강도를 고르게 분산시키는 방법으로 이미지의 명암 값을 증가시키고 이 미지 특성화를 용이하게 할 수 있다. 이러한 히스토그램 등화는 치과 분야의 이미지 처리에 사용되어 이미지 품 질을 향상시키고, 딥 러닝을 통해 흉부 X- 레이 진단의 성능을 크게 향상시키기 위한 이미지 확장에 사용될 수 있다. 본 발명의 데이터 처리 장치는 이미지 확장을 위해 전통적인 히스토그램 등화와는 다른 적응 히스토그램 등화를 사용할 수 있다. 적응 히스토그램 등화는 이미지의 별개의 부분에 각각 대응하는 여러 히스토그램을 계 산한다는 점에서 전통적인 히스토그램 등화와는 차이가 있다. 따라서, 적응 히스토그램 등화는 이미지의 각 영 역에서 국부 대비(contrast) 및 가장자리 선명도를 향상시키는 데 적합할 수 있다. 즉, 데이터 처리 장치는 복수의 패턴들 각각에 대해 회전 및 이동을 통해 측면 세팔러그램 이미지들의 수 를 증가시키고, 증가된 측면 세팔러그램 이미지들에 히스토그램 등화(histogram equalization)을 수행함으로써 품질을 향상시킬 수 있다. 데이터 처리 장치는 패턴 불균형 문제가 해결되어 복수의 패턴들 간 비율이 일치된 훈련 데이터 셋 내의 측면 세팔러그램 이미지들을 이용하여 학습 모델을 학습하고, (S730-1)에서 생성된 유효성 검증 셋을 이용하여 학습 모델을 검증할 수 있다.(S750) 보다 구체적으로 데이터 처리 장치는 설명 가능한 인공지능 (eXplainable AI, XAI)의 기법 중에 하나인 CAM(Class Activation Map) 기법을 사용하여 과적합(Overfitting) 유무 및 적절한 특징(Feature) 추출 유무 등을 확인함으로써 학습 모델의 질(Quality)를 평가할 수 있다.도 9는 본 발명의 일실시예에 따른 데이터 처리 장치가 제공하는 모델의 구조를 도시한 도면이다. 도 9를 참고하면, 데이터 처리 장치가 제공하는 모델은 수정된 DenseNet 아키텍처의 멀티 모달 CNN 아키텍 처를 사용했으며, 타겟 데이터로는 X- 레이 및 환자의 인구 통계 정보로는 성별 정보를 입력으로 사용하였다. DenseNet은 데이터를 효율적으로 사용하고, 모델 복잡성을 줄이며, 과적합 문제를 완화하기 위해 소규모 데이터 세트에 효과적인 모델이다. 또한 DenseNet은 ImageNet 데이터 세트에 대해 사전 훈련된 가중치를 지원하므로 전 송 학습을 사용할 수 있다. ImageNet 데이터 세트는 본 발명에서 제공하는 측면 세팔러그램 이미지와는 크게 다 르지만 CNN 모델의 이전 계층에서 추출된 하위 수준 특징(EX. 모서리, 곡선 등)은 일반적인 특징이며 이 계층의 특징 추출 프로세스는 거의 동일할 수 있다. 따라서, 데이터 처리 장치는 이러한 ImageNet 데이터 세트를 통해 사전 훈련된 가중치를 이용함으로써 타겟 데이터의 분류 성능을 향상시킬 수 있다. 본 발명의 데이터 처리 장치가 제공하는 모델은 X- 선 및 성별 정보를 효율적으로 결합 및 분석하고 성능 을 향상시키기 위해 맞춤형 레이어 및 하이퍼 파라미터(Hyperparameter)로 최적화될 수 있다. 하이퍼 파라미터 는 넓게 보면 모델 전반이 될 수도 있지만, 본 발명에서는 image resizing size, batch size, learning rate, custom layer들의 각 노드 개수, dropout rate 등과 같이 숫자로 표현되어 조절이 가능하고, 성능에 영향을 미 치는 파라미터를 의미할 수 있다. 본 발명의 데이터 처리 장치가 제공하는 모델의 구조는 도 8과 같을 수 있으며 기본 모델에 부착된 사용자 정의 레이어로 구성되며, 이 사용자 정의 레이어를 통해 X-ray에서 추출 된 피처(feature)는 모델 중간에 성별 정보와 연결될 수 있다. 먼저, Conv layer은 convolutional layer로, 합성곱 연산을 이미지 각각의 픽셀에 따라 따로 분석하는 것이 아 닌 주변 정보를 반영하여 피처를 추출하는 기능을 수행할 수 있다. Max pool layer은 max pooling layer로, 이 미지의 크기를 줄이는데 사용될 수 있다. 이때, Max의 의미는 특정 패치(patch)(ex. 3 by 3)에서 가장 큰 픽셀 만을 남기고 나머지는 버리는 것을 나타낼 수 있다. Dense block 은 2개의 conv layer와 하나의 concatenate layer 가 연결된 형태가 복수 개 연결될 수 있다. Concatenate layer는 두가지를 붙이는 개념으로 dense block은 맨 처음 들어간 정보가 여러 conv-conv-conc을 지나서 피처가 추출되는 데 그 사이사이에 계속해서 앞쪽 정보가 추가되는 구조를 나타낼 수 있다. 즉 dense block은 최초 피처와 각 단에서 추출되는 피처가 계속해서 합쳐지는 형태를 가지고 있어서 densely connected convolutional dense block이라고 부른다. Transition layer는 conv와 2by2 max pooling으로 구성될 수 있고, Fully-connected layer는 모든 노드 사이에 연결(connection)이 있음을 의미할 수 있으며, D는 dimension으로 output vector의 크기를 나타낼 수 있다. Drop out은 학습단계에서 전체 연결에서 dropout rate만큼의 연결을 매번 새롭게 끊는 것을 의미할 수 있다. input layer에서 1번은 세팔로그램 이미지가 입력되고, 2번은 환자 성별 정보가 입력될 수 있으며, weighting layer는 성별 정보에 비중을 제공할 수 있다. 마지막으로 출력에 해당하는 diagnosis layer는 fully connected layer이며, 본 발명의 데이터 처리 장치(11 0)가 3종 classification 문제이기 때문에 dimension 은 3이고 각 class의 확률을 출력해야 되기 때문에 activation function으로 soft max가 사용될 수 있다. 이상에서 설명된 실시예들은 하드웨어 구성요소, 소프트웨어 구성요소, 및/또는 하드웨어 구성요소 및 소프트웨 어 구성요소의 조합으로 구현될 수 있다. 예를 들어, 실시예들에서 설명된 장치, 방법 및 구성요소는, 예를 들 어, 프로세서, 콘트롤러, ALU(arithmetic logic unit), 디지털 신호 프로세서(digital signal processor), 마 이크로컴퓨터, FPGA(field programmable gate array), PLU(programmable logic unit), 마이크로프로세서, 또는 명령(instruction)을 실행하고 응답할 수 있는 다른 어떠한 장치와 같이, 범용 컴퓨터 또는 특수 목적 컴퓨터를 이용하여 구현될 수 있다. 처리 장치는 운영 체제(OS) 및 상기 운영 체제 상에서 수행되는 소프트웨어 애플리 케이션을 수행할 수 있다. 또한, 처리 장치는 소프트웨어의 실행에 응답하여, 데이터를 접근, 저장, 조작, 처 리 및 생성할 수도 있다. 이해의 편의를 위하여, 처리 장치는 하나가 사용되는 것으로 설명된 경우도 있지만,"}
{"patent_id": "10-2022-0118766", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 5, "content": "해당 기술분야에서 통상의 지식을 가진 자는, 처리 장치가 복수 개의 처리 요소(processing element) 및/또는 복수 유형의 처리 요소를 포함할 수 있음을 알 수 있다. 예를 들어, 처리 장치는 복수 개의 프로세서 또는 하나의 프로세서 및 하나의 컨트롤러를 포함할 수 있다. 또한, 병렬 프로세서(parallel processor)와 같은, 다른 처리 구성(processing configuration)도 가능하다. 소프트웨어는 컴퓨터 프로그램(computer program), 코드(code), 명령(instruction), 또는 이들 중 하나 이상의 조합을 포함할 수 있으며, 원하는 대로 동작하도록 처리 장치를 구성하거나 독립적으로 또는 결합적으로 (collectively) 처리 장치를 명령할 수 있다. 소프트웨어 및/또는 데이터는, 처리 장치에 의하여 해석되거나 처리 장치에 명령 또는 데이터를 제공하기 위하여, 어떤 유형의 기계, 구성요소(component), 물리적 장치, 가상 장치(virtual equipment), 컴퓨터 저장 매체 또는 장치, 또는 전송되는 신호 파(signal wave)에 영구적으로, 또는 일시적으로 구체화(embody)될 수 있다. 소프트웨어는 네트워크로 연결된 컴퓨터 시스템 상에 분산되어서, 분산된 방법으로 저장되거나 실행될 수도 있다. 소프트웨어 및 데이터는 컴퓨터 판독 가능 기록 매체에 저장될 수 있다. 실시예에 따른 방법은 다양한 컴퓨터 수단을 통하여 수행될 수 있는 프로그램 명령 형태로 구현되어 컴퓨터 판 독 가능 매체에 기록될 수 있다. 컴퓨터 판독 가능 매체는 프로그램 명령, 데이터 파일, 데이터 구조 등을 단 독으로 또는 조합하여 포함할 수 있으며 매체에 기록되는 프로그램 명령은 실시예를 위하여 특별히 설계되고 구 성된 것들이거나 컴퓨터 소프트웨어 당업자에게 공지되어 사용 가능한 것일 수도 있다. 컴퓨터 판독 가능 기록 매체의 예에는 하드 디스크, 플로피 디스크 및 자기 테이프와 같은 자기 매체(magnetic media), CD-ROM, DVD와 같은 광기록 매체(optical media), 플롭티컬 디스크(floptical disk)와 같은 자기-광 매체(magneto-optical media), 및 롬(ROM), 램(RAM), 플래시 메모리 등과 같은 프로그램 명령을 저장하고 수행하도록 특별히 구성된 하드웨어 장치가 포함된다. 프로그램 명령의 예에는 컴파일러에 의해 만들어지는 것과 같은 기계어 코드뿐만 아니라 인터프리터 등을 사용해서 컴퓨터에 의해서 실행될 수 있는 고급 언어 코드를 포함한다. 위에서 설명한 하드웨어 장치는 실시예의 동작을 수행하기 위해 하나 또는 복수의 소프트웨어 모듈로서 작동하 도록 구성될 수 있으며, 그 역도 마찬가지이다."}
{"patent_id": "10-2022-0118766", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 6, "content": "이상과 같이 실시예들이 비록 한정된 도면에 의해 설명되었으나, 해당 기술분야에서 통상의 지식을 가진 자라면 이를 기초로 다양한 기술적 수정 및 변형을 적용할 수 있다. 예를 들어, 설명된 기술들이 설명된 방법과 다른 순서로 수행되거나, 및/또는 설명된 시스템, 구조, 장치, 회로 등의 구성요소들이 설명된 방법과 다른 형태로 결합 또는 조합되거나, 다른 구성요소 또는 균등물에 의하여 대치되거나 치환되더라도 적절한 결과가 달성될 수 있다. 그러므로, 다른 구현들, 다른 실시예들 및 특허청구범위와 균등한 것들도 후술하는 특허청구범위의 범위에 속한 다."}
{"patent_id": "10-2022-0118766", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 일실시예에 따른 학습 모델을 이용한 데이터 처리 시스템의 개략도를 도시한 도면이다. 도 2는 본 발명의 일실시예에 따른 랜드마크의 제1 예를 도시한 도면이다. 도 3은 본 발명의 데이터 처리 장치가 수행하는 랜드 마크 추출 방법을 플로우챠트로 도시한 도면이다. 도 4는 본 발명의 일실시예에 따른 랜드 마크 추출 과정을 실제 도면을 통해 나타낸 도면이다.도 5는 본 발명의 일실시예에 따른 데이터 처리 장치가 수행하는 학습 모델의 학습 방법을 도시한 도면이다. 도 6a 내지 도 6c는 본 발명의 일실시예에 따른 데이터 확장을 수행한 예를 도시한 도면이다. 도 7은 본 발명의 일실시예에 따른 데이터 처리 장치가 수행하는 학습 모델을 이용한 환자의 골격 분류 방법을 도시한 도면이다. 도 8은 본 발명의 일실시예에 따른 랜드 마크의 제2 예를 도시한 도면이다. 도 9는 본 발명의 일실시예에 따른 데이터 처리 장치가 제공하는 모델의 구조를 도시한 도면이다."}
