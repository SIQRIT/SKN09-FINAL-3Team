{"patent_id": "10-2021-0175719", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2023-0087096", "출원번호": "10-2021-0175719", "발명의 명칭": "수면 무호흡 분류를 위한 심전도 주파수 기반 단일 채널 딥러닝 방법", "출원인": "한양대학교 에리카산학협력단", "발명자": "하윤선"}}
{"patent_id": "10-2021-0175719", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "수면 무호흡 분류를 위한 심전도 주파수 기반 단일 채널 딥러닝 방법으로서, 의료 수집기기로 수집한 ECG 데이터를 전처리한 후에 필요한 시퀀스 도메인 특징 및 주파수 도메인 특징 중 하나 이상을 추출하되, 상기 시퀀스 도메인 특징은 신호 시퀀스 중 순서가 뒤바뀐 신호의 발생을 반영할 수 있는 멀티 스케일엔트로피, 연속적인 심전도 파형 주기의 평균 및 표준편차이고, 상기 주파수 도메인 특징은 0.003Hz-0.04Hz 사이의 주파수 대역폭에 해당되며, 반사-교감 신경의 보조 정보가 포함된 것을 특징으로 하는 수면 무호흡 분류를위한 심전도 주파수 기반 단일 채널 딥러닝 방법."}
{"patent_id": "10-2021-0175719", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서, 인공 신경망에 기초한 알고리즘 모델을 이용하여 특징점 매칭을 수행하되, 상기 알고리즘 모델은 입력 노드로 구성된 입력 레이어, 출력 노드로 구성된 출력 레이어 및 입력 레이어와 출력 레이어 사이에 배치되며, 은닉 노드로 구성된 하나 이상의 은닉 레이어를 포함하고, 학습을 통해 노드들을연결하는 에지의 가중치 및 노드들의 바이어스가 업데이트되는 것을 특징으로 하는 수면 무호흡 분류를 위한 심전도 주파수 기반 단일 채널 딥러닝 방법."}
{"patent_id": "10-2021-0175719", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 기술은 수면 무호흡 분류를 위한 심전도 주파수 기반 단일 채널 딥러닝 방법에 관한 것이다. 본 기술의 수면 무호흡 분류를 위한 심전도 주파수 기반 단일 채널 딥러닝 방법은 의료 수집기기로 수집한 ECG 데이터를 전처리 한 후에 필요한 시퀀스 도메인 특징 및 주파수 도메인 특징 중 하나 이상을 추출하되, 상기 시퀀스 도메인 특징 은 신호 시퀀스 중 순서가 뒤바뀐 신호의 발생을 반영할 수 있는 멀티 스케일 엔트로피, 연속적인 심전도 파형 주기의 평균 및 표준편차이고, 상기 주파수 도메인 특징은 0.003Hz-0.04Hz 사이의 주파수 대역폭에 해당되며, 반 사-교감 신경의 보조 정보가 포함된다."}
{"patent_id": "10-2021-0175719", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 수면 무호흡 분류를 위한 심전도 주파수 기반 단일 채널 딥러닝 방법에 관한 것으로, 보다 구체적으 로는 주파수 도메인 특징을 포함하는 수면 무호흡 분류를 위한 심전도 주파수 기반 단일 채널 딥러닝 방법에 관 한 것이다."}
{"patent_id": "10-2021-0175719", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "종래기술에는 다중 딥러닝 모델로 수면 무호흡 스코어링 한 연구들이 있었는데, ECG(Electrocardiogram)의 기초 시퀀스 도메인 특징이나 다중 수치 신호를 기반으로만 수행을 한다. 시퀀스 도메인 특징에 추가적으로 주파수 도메인 특징을 발췌하여 적용하여, 컨볼루션 뉴럴네트워크와 LSTM(Long Short Term Memory) 딥러닝 기법을 사용하여 분류 정확도를 높이는 기술이 대체로 적용되고 있다. 한편, 종래기술에서는 수면 무호흡 분류 정확도가 80~90%로 높은 편이나, 예측 실패에 따른 치명률이 높은 기술 이기 때문에 여전히 더 높은 분류 정확도가 요구된다. 대부분의 종래 기술은 기초적인 시퀀스에 의존적이기 때 문에 기법의 효과 또한 제한적이다. 이에 더욱 향상된 수면 무호흡 분류 정확도를 위한 딥러닝 기업에 대한 연구가 필요하다."}
{"patent_id": "10-2021-0175719", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명의 실시예는 특별히 주파수 도메인이 복합적으로 작용되어, 기존에 기초 시퀀스에 대한 보완적인 역할을 가능하도록 설계된 수면 무호흡 분류를 위한 심전도 주파수 기반 단일 채널 딥러닝 방법을 제공한다."}
{"patent_id": "10-2021-0175719", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명의 실시예에 따른 수면 무호흡 분류를 위한 심전도 주파수 기반 단일 채널 딥러닝 방법은, 의료 수집기 기로 수집한 ECG 데이터를 전처리한 후에 필요한 시퀀스 도메인 특징 및 주파수 도메인 특징 중 하나 이상을 추 출하되, 상기 시퀀스 도메인 특징은 신호 시퀀스 중 순서가 뒤바뀐 신호의 발생을 반영할 수 있는 멀티 스케일 엔트로피, 연속적인 심전도 파형 주기의 평균 및 표준편차이고, 상기 주파수 도메인 특징은 0.003Hz-0.04Hz 사 이의 주파수 대역폭에 해당되며, 반사-교감 신경의 보조 정보가 포함될 수 있다. 인공 신경망에 기초한 알고리즘 모델을 이용하여 특징점 매칭을 수행하되, 상기 알고리즘 모델은 입력 노드로 구성된 입력 레이어, 출력 노드로 구성된 출력 레이어 및 입력 레이어와 출력 레이어 사이에 배치되며, 은닉 노 드로 구성된 하나 이상의 은닉 레이어를 포함하고, 학습을 통해 노드들을 연결하는 에지의 가중치 및 노드들의 바이어스가 업데이트될 수 있다."}
{"patent_id": "10-2021-0175719", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 기술은 특별히 주파수 도메인이 복합적으로 작용되어, 기존에 기초 시퀀스에 대한 보완적인 역할을 가능하도 록 설계된 수면 무호흡 분류를 위한 심전도 주파수 기반 단일 채널 딥러닝 방법을 제공할 수 있다. 또한 본 기술은 기존 머신러닝 특징을 추출 모델보다 신규 특징을 더 추출하여 반영함으로써, MSE와 MEAN, STD, VLF등 시퀀스 도메인 특징이나 수치 신호를 수집하는 것이 아니라, 추가적으로 주파수 도메인 특징을 다 발췌하 기 때문에 채택한 딥러닝 모델(CNN→LSTM→FCL)을 사용하여 보완적인 수면 무호흡 분류 정확도를 얻을 수 있다."}
{"patent_id": "10-2021-0175719", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하에서는, 본 발명의 가장 바람직한 실시예가 설명된다. 도면에 있어서, 두께와 간격은 설명의 편의를 위하여 표현된 것이며, 실제 물리적 두께에 비해 과장되어 도시될 수 있다. 본 발명을 설명함에 있어서, 본 발명의 요 지와 무관한 공지의 구성은 생략될 수 있다. 각 도면의 구성요소들에 참조 번호를 부가함에 있어서, 동일한 구 성 요소들에 한해서는 비록 다른 도면상에 표시되더라도 가능한 한 동일한 번호를 가지도록 하고 있음에 유의하 여야 한다. 도 1은 본 발명의 실시예에 따른 수면 무호흡 분류를 위한 심전도 주파수 기반 단일 채널 딥러닝 방법의 전체적 인 흐름을 순서대로 도시한 순서도이다. 도 2는 본 발명의 실시예에 따른 수면 무호흡 분류를 위한 심전도 주파수 기반 단일 채널 딥러닝 방법을 수행하 기 위한 신경망을 도시하는 도면이다. 그리고, 도 3은 본 발명의 실시예에 따른 수면 무호흡 분류를 위한 심전도 주파수 기반 단일 채널 딥러닝 방법 을 수행하기 위한 신경망의 결과값을 나타내는 표를 도시한다. 도 1 내지 도 3을 참조하면, 수면 무호흡 분류를 위한 심전도 주파수 기반 단일 채널 딥러닝 방법은 수면 무호 흡 환자와 무증상 인원에 대해 심전도 신호 수집 데이터를 획득하는 단계, 수집한 데이터를 전처리하는 단계, 데이터에 필요한 특징을 모두 발췌하는 단계, 발췌된 특징을 뉴럴 네트워크에 입력하는 단계 및 모델을 생성하 는 단계를 포함한다. 의료 수집기기로 수집한 ECG 데이터를 전처리한 후에 필요한 시퀀스 도메인 특징이나 주파수 도메인 특징을 추 출한다. 구체적으로는 시퀀스 도메인 특징은 신호 시퀀스 중, 순서가 뒤바뀐 신호의 발생을 반영할 수 있는 멀 티 스케일 엔트로피(Multi-scale Entropy, MSE)와 연속적인 심전도 파형 주기의 평균(MEAN) 및 표준편차(STD) 이며 주파수 도메인 특징(Very Low Frequency, VLF)이다. VLF에 해당 0.003Hz-0.04Hz 사이의 주파수 대역폭에해당되며, 반사-교감 신경의 보조 정보가 포함되어 있다. 필요한 특징이 다 준비된 후 딥러닝 모델에 입력하면 된다. 검증하는 동안 지속적으로 매개변수를 수정하고 최종적으로 만족스러운 정확도의 모델을 생성한다. 이와 같은 본 발명의 실시예에 따르면, 다중 딥러닝 모델을 통해 ECG의 기초 시퀀스 도메인 특징이나 수치 신 호를 기반으로 분류하는 전반 기술에 있어서, 보다 향상된 수면 무호흡 분류 정확도를 얻을 수 있다. 본 발명의 실시예는 의료기기, 웨어러블 의료기기, 컴퓨터 지원 의료 진단, 건강 모니터링 등에 적용할 수 있을 것으로 예 상된다. 한편, 앞서 언급한 바와 같이, 인공 신경망에 기초한 알고리즘 모델을 이용하여 특징점 매칭은 다음과 같이 수 행될 수 있다. 인공 지능(AI: artificial intelligence)은 인간의 지능으로 할 수 있는 사고, 학습, 자기 계발 등을 컴퓨터가 할 수 있도록 하는 방법을 연구하는 컴퓨터 공학 및 정보 기술의 한 분야로, 컴퓨터가 인간의 지능적인 행동을 모방할 수 있도록 하는 것을 의미한다. 인공 지능은 그 자체로 존재하는 것이 아니라, 컴퓨터 과학의 다른 분야와 직간접으로 많은 관련을 맺고 있다. 특히 현대에는 정보 기술의 여러 분야에서 인공 지능적 요소를 도입하여, 그 분야의 문제 풀이에 활용하려는 시 도가 매우 활발하게 이루어지고 있다. 머신 러닝(machine learning)은 인공 지능의 한 분야로, 컴퓨터에 명시적인 프로그램 없이 배울 수 있는 능력을 부여하는 연구 분야이다. 구체적으로 머신 러닝은, 경험적 데이터를 기반으로 학습을 하고 예측을 수행하고 스스로의 성능을 향상시키는 시스템과 이를 위한 알고리즘을 연구하고 구축하는 기술이다. 머신 러닝의 알고리즘들은 엄격하게 정해진 정적 인 프로그램 명령들을 수행하는 것이라기보다, 입력 데이터를 기반으로 예측이나 결정을 이끌어내기 위해 특정 한 모델을 구축하는 방식을 취한다. 용어 '머신 러닝'은 용어 '기계 학습'과 혼용되어 사용될 수 있다. 기계 학습에서 데이터를 어떻게 분류할 것인가를 놓고, 많은 기계 학습 알고리즘이 개발되었다. 의사결정 나무 (Decision Tree), 베이지안 망(Bayesian network), 서포트 벡터 머신(SVM: support vector machine), 그리고 인공 신경망(ANN: Artificial Neural Network) 등이 대표적이다. 특히, 인공 신경망은 생물학적 뉴런의 동작 원리와 뉴런 간의 연결 관계를 모델링한 것으로 노드(node) 또는 처 리 요소(processing element)인 다수의 뉴런(neuron)들이 레이어(layer) 구조의 형태로 연결된 정보 처리 시스 템이다. 즉, 인공 신경망은 기계 학습에서 사용되는 모델로써, 기계 학습과 인지 과학에서 생물학의 신경망(동물의 중추 신경계 중 특히 뇌)에서 영감을 얻은 통계학적 학습 알고리즘이다. 구체적으로, 인공 신경망은 복수의 레이어를 포함할 수 있고, 레이어들 각각은 복수의 뉴런을 포함할 수 있다. 또한, 인공 신경망은 뉴런과 뉴런을 연결하는 시냅스(synapse)를 포함할 수 있다. 즉, 인공 신경망은 시냅스의 결합으로 네트워크를 형성한 인공 뉴런이 학습을 통해 시냅스의 결합 세기를 변화시켜 문제 해결 능력을 가지는 모델 전반을 의미할 수 있다. 용어 '인공 신경망'은 용어 '뉴럴 네트워크(Neural Network)'와 혼용되어 사용될 수 있고, 용어 '뉴런'은 용어 '노드'와 혼용되어 사용될 수 있고, 용어 '시냅스'는 용어 '에지'와 혼용되어 사용될 수 있다. 인공 신경망은 일반적으로 다음의 세가지 인자, 즉 다른 레이어의 뉴런들 사이의 연결 패턴, 시냅스의 가중치를 갱신하는 학습 과정, 이전 레이어로부터 수신되는 입력에 대한 가중 합으로부터 출력값을 생성하 는 활성화 함수에 의해 정의될 수 있다. 인공 신경망은, DNN(Deep Neural Network), RNN(Recurrent Neural Network), BRDNN(Bidirectional Recurrent Deep Neural Network), MLP(Multilayer Perceptron), CNN(Convolutional Neural Network)와 같은 방식의 네트 워크 모델들을 포함할 수 있으나, 이에 한정되지 않는다. 인공신경망은 계층 수에 따라 단층 신경망(Single-Layer Neural Networks)과 다층 신경망(Multi-Layer Neural Networks)으로 구분된다. 일반적인 단층 신경망은, 입력 레이어와 출력 레이어로 구성된다. 또한, 일반적인 다층 신경망은 입력 레이어(input layer)와, 하나 이상의 은닉 레이어(hidden layer)와, 출력층 (output layer)으로 구성된다. 입력 레이어는 외부의 자료들을 받아들이는 레이어로서, 입력 레이어의 뉴런 수는 입력되는 변수의 수와 동일하 다. 은닉 레이어는 입력 레이어와 출력 레이어 사이에 위치하며, 입력 레이어로부터 신호를 받아 특성을 추출하여 출력 레이어로 전달한다. 출력 레이어는 은닉 레이어로부터 신호를 받고, 수신한 신호에 기반한 출력 값을 출력한다. 뉴런 간의 입력 신 호는 각각의 가중치(연결 강도)와 곱해진 후 합산되며 이 합이 뉴런의 임계치보다 크면 뉴런이 활성화되어 활성 화 함수를 통하여 획득한 출력값을 출력한다. 한편, 입력 레이어와 출력 레이어 사이에 복수의 은닉 레이어를 포함하는 심층 신경망은, 기계 학습 기술의 한 종류인 딥 러닝을 구현하는 대표적인 인공 신경망일 수 있다. 한편 용어 '딥 러닝'은 용어 '심층 학습'과 혼용되어 사용될 수 있다. 인공 신경망은 훈련 데이터(training data)를 이용하여 학습(training)될 수 있다. 여기서 학습이란, 입력 데이 터를 분류(classification)하거나 회귀분석(regression)하거나 군집화(clustering)하는 등의 목적을 달성하기 위하여, 학습 데이터를 이용하여 인공 신경망의 파라미터(parameter)를 결정하는 과정을 의미할 수 있다. 시냅 스 가중치(weight)나 뉴런에 적용되는 바이어스(bias)가 인공 신경망의 파라미터의 대표적인 예이다. 훈련 데이터에 의하여 학습된 인공 신경망은, 입력 데이터를 입력 데이터가 가지는 패턴에 따라 분류하거나 군 집화할 수 있다. 한편 훈련 데이터를 이용하여 학습된 인공 신경망을, 본 명세서에서는 학습 모델(trained model)이라 명칭할 수 있다. 다음은 인공 신경망의 학습 방식에 대하여 설명한다. 인공 신경망의 학습 방식은 크게, 지도 학습(supervised learning), 비 지도 학습(unsupervised learning), 준 지도 학습(semi-supervised learning), 강화 학습(reinforcement learning)으로 분류될 수 있다. 지도 학습은 훈련 데이터로부터 하나의 함수를 유추해내기 위한 기계 학습의 한 방법이다. 이때, 유추되는 함수 중, 연속적인 값을 출력하는 것을 회귀분석(regression)이라 하고, 입력 벡터의 클래스(class)를 예측하여 출력 하는 것을 분류(classification)라고 한다. 즉, 지도 학습에서는 훈련 데이터에 대한 레이블(label)이 주어진 상태에서 인공 신경망을 학습시킨다. 여기서, 레이블은 훈련 데이터가 인공 신경망에 입력되는 경우 인공 신경 망이 추론해 내야 하는 정답(또는 결과 값)을 의미한다. 비 지도 학습은 기계 학습의 일종으로, 훈련 데이터에 대한 레이블이 주어지지 않는다. 구체적으로, 비 지도 학 습은, 훈련 데이터 및 훈련 데이터에 대응하는 레이블의 연관 관계 보다는, 훈련 데이터 자체에서 패턴을 찾아 분류하도록 인공 신경망을 학습시키는 학습 방법이다. 준 지도 학습은 기계 학습의 일종으로, 레이블이 주어진 훈련 데이터와 레이블이 주어지지 않은 훈련 데이터를 모두 사용하는 학습 방법을 의미할 수 있다. 준 지도 학습의 기법 중 하나로, 레이블이 주어지지 않은 훈련 데 이터의 레이블을 추론한 후 추론된 라벨을 이용하여 학습을 수행하는 기법이 있으며, 이러한 기법은 레이블링에 소요되는 비용이 큰 경우에 유용하게 사용될 수 있다. 강화 학습은, 에이전트(Agent)가 매 순간 어떤 행동을 해야 좋을지 판단할 수 있는 환경이 주어진다면, 데이터 없이 경험으로 가장 좋을 길을 찾을 수 있다는 이론이다. 상기 내용을 참조하면, 본 발명의 특징점 매칭을 위한 인공 신경망에 기초한 알고리즘 모델은 입력 노드로 구성 된 입력 레이어, 출력 노드로 구성된 출력 레이어 및 입력 레이어와 출력 레이어 사이에 배치되며, 은닉 노드로 구성된 하나 이상의 은닉 레이어를 포함한다. 이때, 알고리즘 모델은 학습 데이터에 의해 학습되며, 학습을 통 해 노드들을 연결하는 에지의 가중치 및 노드의 바이어스가 업데이트될 수 있다. 본 발명의 일 실시예에 따르면, 상기 학습된 알고리즘 모델은 특징점 매칭부에 탑재될 수 있다. 이때, 서로 다 른 시점에서 센싱된 센싱 데이터 및 서로 다른 시점에서 획득된 영상에 포함된 특징점의 정보 중 적어도 하나가 학습된 알고리즘 모델의 입력 레이어에 입력되고, 학습된 알고리즘 모델의 출력 레이어로 특징점 매칭 정보가 출력될 수 있다. 또한, 본 발명의 다른 실시예에 따르면, 상기 학습된 알고리즘 모델은 외부의 AI 서버에 탑재될 수 있다. 이 경 우, 특징점 매칭부는 통신부를 통해 서로 다른 시점에서 센싱된 센싱 데이터 및 서로 다른 시점에서 획득된 영 상에 포함된 특징점의 정보 중 적어도 하나를 AI 서버로 전송한다. 서로 다른 시점에서 센싱된 센싱 데이터 및 서로 다른 시점에서 획득된 영상에 포함된 특징점의 정보 중 적어도 하나가 AI 서버의 학습된 알고리즘 모델의 입력 레이어에 입력되고, 학습된 알고리즘 모델의 출력 레이어로 특징점 매칭 정보가 출력될 수 있다. AI 서버 는 출력된 특징점 매칭 정보를 통신부를 통해 특징점 매칭부로 전송하고, 이를 통해 특징점 매칭부는 특징점을 매칭할 수 있다. 또한, 본 발명의 실시예들은 다양한 컴퓨터 수단을 통하여 수행될 수 있는 프로그램 명령 형태로 구현되어 컴퓨 터 판독 가능 매체에 기록될 수 있다. 상기 컴퓨터 판독 가능 매체는 프로그램 명령, 데이터 파일, 데이터 구조 등을 단독으로 또는 조합하여 포함할 수 있다. 상기 매체에 기록되는 프로그램 명령은 본 발명을 위하여 특별히 설계되고 구성된 것들이거나 컴퓨터 소프트웨어 당업자에게 공지되어 사용 가능한 것일 수도 있다. 컴퓨터 판독 가능 기록 매체의 예에는 하드 디스크, 플로피 디스크 및 자기 테이프와 같은 자기 매체(magnetic media), CD- ROM, DVD와 같은 광기록 매체(optical media), 플롭티컬 디스크(floptical disk)와 같은 자기-광 매체 (magneto-optical), 및 롬(ROM), 램(RAM), 플래시 메모리 등과 같은 프로그램 명령의 예에는 컴파일러에 의해 만들어지는 것과 같은 기계어 코드뿐만 아니라 인터프리터 등을 사용해서 컴퓨터에 의해서 실행될 수 있는 고급 언어 코드를 포함한다. 상기된 하드웨어 장치는 본 발명의 일 실시예들의 동작을 수행하기 위해 적어도 하나의 소프트웨어 모듈로서 작동하도록 구성될 수 있으며, 그 역도 마찬가지이다. 이상과 같이 본 발명에서는 구체적인 구성 요소 등과 같은 특정 사항들과 한정된 실시예 및 도면에 의해 설명되 었으나 이는 본 발명의 보다 전반적인 이해를 돕기 위해서 제공된 것일 뿐, 본 발명은 상기의 실시예에 한정되 는 것은 아니며, 본 발명이 속하는 분야에서 통상적인 지식을 가진 자라면 이러한 기재로부터 다양한 수정 및 변형이 가능하다. 따라서, 본 발명의 사상은 설명된 실시예에 국한되어 정해져서는 아니되며, 후술하는 특허청 구범위뿐 아니라 이 특허청구범위와 균등하거나 등가적 변형이 있는 모든 것들은 본 발명 사상의 범주에 속한다 고 할 것이다."}
{"patent_id": "10-2021-0175719", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 실시예에 따른 수면 무호흡 분류를 위한 심전도 주파수 기반 단일 채널 딥러닝 방법의 전체적 인 흐름을 순서대로 도시한 순서도이다. 도 2는 본 발명의 실시예에 따른 수면 무호흡 분류를 위한 심전도 주파수 기반 단일 채널 딥러닝 방법을 수행하 기 위한 신경망을 도시하는 도면이다. 도 3은 본 발명의 실시예에 따른 수면 무호흡 분류를 위한 심전도 주파수 기반 단일 채널 딥러닝 방법을 수행하 기 위한 신경망의 결과값을 나타내는 표를 도시한다."}
