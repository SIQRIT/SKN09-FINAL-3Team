{"patent_id": "10-2022-0110158", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2024-0007037", "출원번호": "10-2022-0110158", "발명의 명칭": "태양광 발전량 예측 정확도 향상을 위한 데이터 생성 기능을 구비한 태양광 발전량 예측 장치", "출원인": "고려대학교 산학협력단", "발명자": "황인준"}}
{"patent_id": "10-2022-0110158", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "기상 데이터, 시간 데이터 및 이에 대응하는 과거 태양광 발전량 데이터를 포함하는 복수의 실제 데이터 셋을수집하는 데이터 수집부;상기 복수의 실제 데이터 셋을 사용하여 오토인코더와 회귀 모델의 사전학습을 수행하는 모델 사전학습부; 상기 모델 사전학습부에서 사전학습이 완료된 오토인코더와 회귀 모델 및 적대적 생성 신경망 모델에 기초하여가상 데이터를 생성하는 가상 데이터 생성부; 상기 가상 데이터를 상기 실제 데이터 셋과 합성하여 합성 데이터를 생성하는 데이터 합성부; 및상기 합성 데이터로 학습을 수행한 태양광 발전량 예측 모델에 기초하여 태양광 발전량을 예측하는 태양광 발전량 예측부; 를 포함하는, 태양광 발전량 예측 장치."}
{"patent_id": "10-2022-0110158", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제2 항에 있어서,상기 모델 사전학습부는,상기 복수의 실제 데이터 셋 중 상기 시간 데이터, 상기 기상 데이터 및 상기 시간 데이터에 대응하는 태양광발전량 데이터를 이용하여 상기 회귀 모델을 사전학습 시키고, 상기 복수의 실제 데이터 셋 중 상기 시간 데이터와 상기 기상 데이터를 이용하여 상기 오토 인코더를 사전학습시키는, 태양광 발전량 예측 장치."}
{"patent_id": "10-2022-0110158", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1 항에 있어서,상기 가상 데이터 생성부는,상기 적대적 생성 신경망 모델에서 생성한 n-1(n은 1보다 큰 자연수)번째 가상 데이터와 상기 복수의 실제 데이터 셋에 기초하여 상기 오토 인코더에 의해 산출된 오차와 상기 회귀모델에 의해 산출된 오차를 피드백 받고 전체 손실함수를 업데이트 시키고, 상기 업데이트된 손실함수에 기초하여 n번째 가상 데이터를 생성하는, 태양광 발전량 예측 장치."}
{"patent_id": "10-2022-0110158", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제3 항에 있어서,상기 가상 데이터 생성부는 상기 업데이트된 손실함수가 실제 데이터와 상기 n-1번째 가상 데이터를 입력 받은적대적 생성 신경망 모델의 판별기에서 산출되는 값이 1/2이 되는 시점의 손실함수에 기초하여 생성된 n번째 가상 데이터를 상기 가상 데이터로서 상기 데이터 합성부로 출력하는, 태양광 발전량 예측 장치."}
{"patent_id": "10-2022-0110158", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제4 항에 있어서,상기 가상 데이터 생성부에서 가상 데이터 생성을 위해 피드백 되는 손실함수는 L = D(G(z)) + (XF - AE(XF))2 +(YF - R(XF))2 이며,공개특허 10-2024-0007037-3-여기서 L은 상기 적대적 생성 신경망 모델의 생성기로 피드백 되는 총 손실함수, D(G(z))는 상기 적대적 생성신경망 모델의 판별기에 가상데이터를 입력 받아 출력하는 손실함수, XF 와 YF는 각각 가상데이터를 이루는 입력변수와 출력변수이며, AE(XF)는 오토인코더에서 출력되는 오차이며. R(XF)는 회귀모델에서 출력되는 오차인, 태양광 발전량 예측 장치."}
{"patent_id": "10-2022-0110158", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제1 항에 있어서, 상기 사전학습부의 회귀모델은 LightGBM 모델을 사용하고,상기 가상 데이터 생성부의 적대적 생성 신경망 모델로 WGAN-GP(Wasserstein Generative Adversarial Network-Gradient Penalty) 모델을 사용하고,상기 태양광 발전량 예측부는 예측모델로 최소의 예측 정확도 평가(MAE, Mean Absolute Error)수치를 가지는 딥러닝 모델을 사용하는, 태양광 발전량 예측 장치."}
{"patent_id": "10-2022-0110158", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "태양광 발전량 예측 장치에 의해 수행되는 태양광 발전량 예측 방법에 있어서,기상 데이터, 시간 데이터 및 이에 대응하는 과거 태양광 발전량 데이터를 수집하는 단계;복수의 실제 수집 데이터 셋을 수집하여 오토인코더 및 회귀모델을 사전학습 하는 단계; 상기 모델 사전학습부에서 사전학습이 완료된 오토인코더 및 회귀모델 및 적대적 생성 신경망 모델에 기초하여가상 데이터를 생성하는 단계;상기 가상 데이터 생성부에서 생성된 가상 데이터를 상기 복수의 실제 데이터 셋과 합성하는 단계;상기 합성 데이터를 입력변수로 하여 예측모델을 학습하는 단계; 및학습된 태양광 발전량 예측 모델에 기초하여 태양광 발전량 예측값을 산출하는 단계를 포함하는, 태양광 발전량예측 방법."}
{"patent_id": "10-2022-0110158", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제8 항에 있어서,상기 가상 데이터 생성부는,상기 적대적 생성 신경망 모델에서 생성한 n-1(n은 1보다 큰 자연수)번째 가상 데이터와 상기 복수의 실제 데이터 셋에 기초하여 상기 오토 인코더에 의해 산출된 오차와 상기 회귀모델에 의해 산출된 오차를 피드백 받고 전체 손실함수를 업데이트 시키며, 상기 업데이트된 손실함수에 기초하여 n번째 가상 데이터를 생성하는 단계를 포함하는, 태양광 발전량 예측 방법."}
{"patent_id": "10-2022-0110158", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제8 항에 있어서, 상기 가상 데이터 생성부는 상기 업데이트된 손실함수가 실제 데이터와 상기 n-1번째 가상 데이터를 입력 받은적대적 생성 신경망 모델의 판별기에서 산출되는 값이 1/2이 되는 시점의 손실함수에 기초하여 생성된 n번째 가상 데이터를 상기 가상 데이터로서 상기 데이터 합성부로 출력하는 단계를 포함하는, 태양광 발전량 예측 방법."}
{"patent_id": "10-2022-0110158", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제8 항에 있어서,상기 가상 데이터 생성부에서 가상 데이터 생성을 위해 피드백 되는 손실함수는 L = D(G(z)) + (XF - AE(XF))2 +공개특허 10-2024-0007037-4-(YF - R(XF))2 이며,여기서 L은 상기 적대적 생성 신경망 모델의 생성기로 피드백 되는 총 손실함수, D(G(z))는 상기 적대적 생성신경망 모델의 판별기에 가상데이터를 입력 받아 출력하는 손실함수, XF 와 YF는 각각 가상데이터를 이루는 입력변수와 출력변수이며, AE(XF)는 오토인코더에서 출력되는 오차이며. R(XF)는 회귀모델에서 출력되는 오차인, 태양광 발전량 예측 방법."}
{"patent_id": "10-2022-0110158", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 태양광 발전량을 정확하고 효율적으로 예측할 수 있는 데이터 생성 장치 및 방법에 관한 것이며, 특히 예측 모델과 신경망 모델을 연계시켜 실제 데이터와 유사한 인공적인 데이터를 생성하고, 생성된 데이터는 입력 변수와 출력변수의 관계성이 잘 반영되어 있게 만드는 데이터 생성 장치 및 방법에 관한 것이다. 본 출원의 실시 (뒷면에 계속)"}
{"patent_id": "10-2022-0110158", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 예측 모델의 학습에 사용될 과거 데이터가 충분하지 않은 상황에서 예측 정확도를 향상시키기 위해 인공적인 가상 데이터를 생성할 수 있는 기능을 구비한 태양광 발전량 예측 장치 및 이의 동작 방법에 관한 것 이다."}
{"patent_id": "10-2022-0110158", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "온실가스로 인해 발생하는 기후변화 문제를 해결하기 위해서 기존의 에너지원을 신재생에너지로 대체하고 있다. 태양광 발전 시스템은 다른 신재생 에너지원에 비해 비교적 자유로운 입지 조건이나 낮은 유지보수 비용 등의 장점으로 인하여 최근 관심 및 수요가 급증하고 있다. 태양광 발전 시스템에서 생산된 전력을 보다 효율적으로 사용하기 위해서는 발전량을 정확하게 예측할 수 있는 모델이 필요하다. 정확한 예측 모델을 구성하기 위해서는 많은 양의 과거 데이터가 필요하며, 특히 우리나라의 경우 예측 모델이 계절적인 변화를 정확하게 반영하기 위해서는 최소 2년 이상의 데이터가 필요하다. 데이터가 충분하지 않은 경 우 예측 모델을 학습하게 되면 예측 성능이 떨어지게 된다. 이렇게 데이터가 충분하지 않은 상황에서도 정확한 예측 모델의 학습에 필요한 데이터 생성 모델에 대한 연구가 많은 관심을 받고 있는 가운데, 실제와 유사하면서도 입력변수와 출력변수 사이의 관계가 정확하게 반영된 데이 터 생성 모델이 필요한 실정이다."}
{"patent_id": "10-2022-0110158", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명의 목적은 예측 모델의 학습에 사용될 과거 데이터가 충분하지 않은 상황에서 태양광 발전량을 정확하고 효율적으로 예측할 수 있는 데이터 생성 기능을 구비한 태양광 발전량 예측 장치 및 이의 동작 방법을 제공하는 데 있다."}
{"patent_id": "10-2022-0110158", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 출원의 실시 예에 따른 태양광 발전량 예측 장치는, 기상 데이터, 시간 데이터 및 이에 대응하는 과거 태양 광 발전량 데이터를 포함하는 복수의 실제 데이터 셋을 수집하는 데이터 수집부; 상기 복수의 실제 데이터 셋을 사용하여 오토인코더와 회귀 모델의 사전학습을 수행하는 모델 사전학습부; 상기 모델 사전학습부에서 사전학습 이 완료된 오토인코더와 회귀 모델 및 적대적 생성 신경망 모델에 기초하여 가상 데이터를 생성하는 가상 데이 터 생성부; 상기 가상 데이터를 상기 실제 데이터 셋과 합성하여 합성 데이터를 생성하는 데이터 합성부; 및 상 기 합성 데이터로 학습을 수행한 태양광 발전량 예측 모델에 기초하여 태양광 발전량을 예측하는 태양광 발전량 예측부; 를 포함한다. 실시 예에 있어서, 상기 모델 사전학습부는, 상기 복수의 실제 데이터 셋 중 상기 시간 데이터, 상기 기상 데이 터 및 상기 시간 데이터에 대응하는 태양광 발전량 데이터를 이용하여 상기 회귀 모델을 사전학습 시키고, 상기 복수의 실제 데이터 셋 중 상기 시간 데이터와 상기 기상 데이터를 이용하여 상기 오토 인코더를 사전학습 시킨 다. 실시 예에 있어서, 상기 가상 데이터 생성부는, 상기 적대적 생성 신경망 모델에서 생성한 n-1(n은 1보다 큰 자 연수)번째 가상 데이터와 상기 복수의 실제 데이터 셋에 기초하여 상기 오토 인코더에 의해 산출된 오차와 상기 회귀모델에 의해 산출된 오차를 피드백 받고 전체 손실함수를 업데이트 시키고, 상기 업데이트된 손실함수에 기초하여 n번째 가상 데이터를 생성한다. 실시 예에 있어서, 상기 가상 데이터 생성부는 상기 업데이트된 손실함수가 실제 데이터와 상기 n-1번째 가상 데이터를 입력 받은 적대적 생성 신경망 모델의 판별기에서 산출되는 값이 1/2이 되는 시점의 손실함수에 기초 하여 생성된 n번째 가상 데이터를 상기 가상 데이터로서 상기 데이터 합성부로 출력한다. 실시 예에 있어서, 상기 가상 데이터 생성부에서 가상 데이터 생성을 위해 피드백 되는 손실함수는 L = D(G(z)) + (XF - AE(XF))2 + (YF - R(XF))2 이며, 여기서 L은 상기 적대적 생성 신경망 모델의 생성기로 피드백 되는 총 손실함수, D(G(z))는 상기 적대적 생성 신경망 모델의 판별기에 가상데이터를 입력 받아 출력하는 손실함수, XF 와 YF는 각각 가상데이터를 이루는 입력변수와 출력변수이며, AE(XF)는 오토인코더에서 출력되는 오차이며. R(XF)는 회귀모델에서 출력되는 오차이다. 실시 예에 있어서 상기 사전학습부의 회귀모델은 LightGBM 모델을 사용하고, 상기 가상 데이터 생성부의 적대적 생성 신경망 모델로 WGAN-GP(Wasserstein Generative Adversarial Network-Gradient Penalty) 모델을 사용하고, 상기 태양광 발전량 예측부는 예측모델로 최소의 예측 정확도 평가(MAE, Mean Absolute Error)수치를 가지는 딥러닝 모델을 사용한다. 본 출원의 실시 예에 따른 태양광 발전량 예측 장치에 의해 수행되는 태양광 발전량 예측 방법은, 기상 데이터, 시간 데이터 및 이에 대응하는 과거 태양광 발전량 데이터를 수집하는 단계; 복수의 실제 수집 데이터 셋을 수 집하여 오토인코더 및 회귀모델을 사전학습 하는 단계; 상기 모델 사전학습부에서 사전학습이 완료된 오토인코 더 및 회귀모델 및 적대적 생성 신경망 모델에 기초하여 가상 데이터를 생성하는 단계; 상기 가상 데이터 생성 부에서 생성된 가상 데이터를 상기 복수의 실제 데이터 셋과 합성하는 단계; 상기 합성 데이터를 입력변수로 하 여 예측모델을 학습하는 단계; 및 학습된 태양광 발전량 예측 모델에 기초하여 태양광 발전량 예측값을 산출하 는 단계를 포함한다. 실시 예에 있어서, 상기 가상 데이터 생성부는, 상기 적대적 생성 신경망 모델에서 생성한 n-1(n은 1보다 큰 자 연수)번째 가상 데이터와 상기 복수의 실제 데이터 셋에 기초하여 상기 오토 인코더에 의해 산출된 오차와 상기 회귀모델에 의해 산출된 오차를 피드백 받고 전체 손실함수를 업데이트 시키며, 상기 업데이트된 손실함수에 기 초하여 n번째 가상 데이터를 생성하는 단계를 포함한다. 실시 예에 있어서, 상기 가상 데이터 생성부는 상기 업데이트된 손실함수가 실제 데이터와 상기 n-1번째 가상 데이터를 입력 받은 적대적 생성 신경망 모델의 판별기에서 산출되는 값이 1/2이 되는 시점의 손실함수에 기초 하여 생성된 n번째 가상 데이터를 상기 가상 데이터로서 상기 데이터 합성부로 출력하는 단계를 포함한다. 실시 예에 있어서 상기 가상 데이터 생성부에서 가상 데이터 생성을 위해 피드백 되는 손실함수는 L = D(G(z)) + (XF - AE(XF))2 + (YF - R(XF))2 이며, 여기서 L은 상기 적대적 생성 신경망 모델의 생성기로 피드백 되는 총 손실함수, D(G(z))는 상기 적대적 생성 신경망 모델의 판별기에 가상데이터를 입력받아 출력하는 손실함수, XF 와 YF는 각각 가상데이터를 이루는 입력 변수와 출력변수이며, AE(XF)는 오토인코더에서 출력되는 오차이며. R(XF)는 회귀모델에서 출력되는 오차이다."}
{"patent_id": "10-2022-0110158", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 출원의 실시예에 따른 태양광 발전량 예측 장치 및 이의 동작 방법은 실제 데이터 셋으로 학습한 인공지능 모델로 가상 데이터를 생성한 뒤, 이를 실제 데이터 셋과 함께 합성하여 학습한 예측 모델을 가지고 태양광 발 전량 예측을 수행한다. 따라서, 본 출원의 실시 예에 따른 태양광 발전량 예측 장치 및 이의 동작 방법은 예측 모델의 학습에 활용할 과거 데이터가 충분하지 않은 상황에서도 정확하고 효율적인 예측이 가능하다."}
{"patent_id": "10-2022-0110158", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하에서는, 본 발명의 기술적 사상을 본 출원의 기술 분야에서 통상의 지식을 가진 자가 용이하게 실시할 수 있을 정도로 상세히 설명하기 위하여, 첨부된 도면을 참조하여 본 출원의 실시 예들이 자세히 설명될 것이다. 도 1은 본 출원의 실시 예에 따른 태양광 발전량 예측 장치를 보여주는 블록도이다. 도 1을 참조하면, 태양광 발전량 예측 장치는 데이터 수집부, 모델 사전학습부, 가상 데이터 생 성부, 데이터 합성부 및 태양광 발전량 예측부를 포함한다. 데이터 수집부는 태양광 발전량 예측에 필요한 각종 데이터를 수집한다. 예를 들어, 데이터 수집부는 기상 데이터와 시간 데이터 및 이에 대응하는 과거 태양광 발전량 데이터를 수집할 수 있다. 데이터 수집부는 외부로부터 각종 기상에 대한 데이터를 수집할 수 있다. 데이터 수집부가 수집하는 기상 데이터는, 예를 들어, 일 최고 기온, 일 최저 기온, 기온, 습도, 풍속, 전운량, 강수량에 대한 데이터일 수 있다. 데이터 수집부는, 예를 들어, 기상청의 기상자료 개방포털 등을 통하여 기상 데이터를 수집할 수 있다. 데이터 수집부는 각종 기상 및 전력 데이터를 수집할 때에, 이에 대응하는 시간 데이터를 함께 수집할 수 있다. 태양광 발전량은 계절의 변화, 하루 중의 시간 변화의 영향을 많이 받는다. 따라서, 데이터 수집부 는 기상 데이터를 수집할 때에 월(month), 일(day), 시(hour) 및 이에 대한 시간 데이터를 함께 수집할 수 있다. 모델 사전학습부는 데이터 수집부로부터 기상 데이터, 시간 데이터 및 이에 대응하는 과거 태양광 발 전량 데이터를 수신한다. 모델 사전학습부에서는 실제 데이터와 유사도 및 관련도가 높은 가상 데이터가 생성될 수 있도록 오토인코더와 회귀 모델을 복수의 실제 데이터 셋으로 사전학습을 수행한다. 가상 데이터 생성부는 모델 사전학습부에서 사전학습이 완료된 오토인코더와 회귀모델을 적대적 생성 신경망 모델과 연계하여 가상 데이터를 생성한다. 본 출원의 일 실시예에 있어서, 가상 데이터 생성부의 적대적 생성 신경망 모델은 WGAN-GP(Wasserstein Generative Adversarial Network-Gradient Penalty)모델을 통하여 구현될 수 있다. 가상 데이터 생성부의 구성은 이하의 도 4 및 도 5에서 좀 더 자세히 설명될 것이다. 데이터 합성부는 가상 데이터 생성부에서 생성된 가상 데이터와 데이터 수집부에서 수집한 실제 데이터를 합성한다. 본 발명의 일 실시예에서는, 가상 데이터의 프레임과 실제 데이터의 프레임을 연결 (concatenate)하는 것을 통해 데이터를 합성할 수 있다. 태양광 발전량 예측부는 데이터 합성부로부터 합성된 데이터를 수신한다. 태양광 발전량 예측부(50 0)는 수신된 합성 데이터를 이용하여 예측모델을 학습한 뒤 태양광 발전량을 예측하는 동작을 수행한다. 예를 들어, 태양광 발전량 예측부는 기계학습 모델을 통하여 구현되며, 수신된 합성 데이터를 입력 변수로 하여 태양광 발전량을 예측할 수 있다. 예를 들어, 태양광 발전량 예측부는 LR(Logistic Regression), DT(Decision Tress), SVM(Support Vector Machine), RF(Random Forest), LightGBM, AdaBoost 등과 같은 학습 모델을 통하여 구현될 수 있다. 상술한 바와 같이, 본 출원의 실시 예에 따른 태양광 발전량 예측 장치는 정확도가 향상된 예측을 위한 데 이터를 생성하기 위해 실제 데이터를 가지고 기계학습 모델을 학습시킨다. 태양광 발전량 예측 장치는 기계 학습 모델의 학습과 연계를 통해 생성된 가상 데이터를 실제 데이터와 합성하여 태양광 발전량 예측을 위한 학 습 모델에 입력 변수로 제공한다. 따라서, 본 출원에 따른 태양광 발전량 예측 장치는 태양광 발전량을 정 확하고 효율적으로 예측할 수 있다. 도 2는 사전학습부를 더 상세히 보여주는 도면이다. 도 2는 데이터 수집부에서 수집된 복수의 실제 데이터 셋으로 오토인코더와 회귀모델이 각각 사 전학습 되는 모습을 보여준다. 오토인코더은 실제 데이터 셋을 입력변수로 하여 가상 데이터 생성부에서 생성하는 가상 데이터가 실 제 데이터와 높은 유사도를 가질 수 있도록 학습된다. 회귀모델은 실제 데이터 셋의 입력변수와 출력변수를 사용하여 생성되는 가상 데이터가 실제 데이터 셋과 관련성이 반영될 수 있도록 학습된다. 도 3은 모델 사전학습부의 회귀 모델에 적용되는 기계학습 모델의 예시들 및 데이터 별 교차검증 결 과를 예시적으로 보여주는 도면이다. 도 3을 참조하면 사전학습 후 가상 데이터 생성부를 구성할 회귀 모델로 사용할 기계학습 모델을 선 택하기 위한 교차검증의 결과를 비교한 표를 확인할 수 있다. 회귀모델의 경우 실제 데이터를 가장 잘 표 현하는 모델을 사용해야 하기 때문에 교차검증을 기반으로 가장 성능이 좋은 기계학습 모델을 선택한다. 모델 사전학습부의 학습 모델로는 LR, DT, RF, LightGBM(LGBM), ADA, SVM이 사용될 수 있다. 실험 결과, LightGBM이 기계학습 모델로 가장 우수한 성능을 갖는 것으로 조사되었으며, 따라서 모델 사전학습 부에서 회귀모델로는 LightGBM이 사용될 수 있다. 다만, 이는 예시적인 것이며, 사전학습에 필요한 회귀모 델로는 다양한 학습모델들이 적용될 수 있음이 이해될 것이다. 상기 과정을 통해 선택된 기계학습 모델 및 오토인코더를 실제 데이터를 사용하여 사전학습을 수행한다. 도 4는 가상 데이터 생성부의 구성을 상세히 보여주는 도면이다. 가상 데이터 생성부는 상기 모델 사전학습부에서 사전학습이 완료된 오토인코더와 회귀 모델 및 적대적 생 성 신경망 모델에 기초하여 가상 데이터를 생성한다. 도 4를 참조하면 모델 사전학습부에서 사전학습이 완료된 오토인코더와 회귀모델이 각각 적대적 생성 신경망 모델과 가상 데이터 생성을 위해 연계되는 모습을 간략히 볼 수 있다. WGAN-GP 모델은 적대적 생성 신경망(GAN) 모델의 개선모델로서, 적대적 생성 신경망 모델은 생성기 (Generator)와 판별기(Discriminator)라는 이름의 신경망들이 서로 경쟁하면서 훈련되는 모델로, 학습 데이터의 확률 분포를 학습하여 이 분포에서 가짜 데이터를 생성할 수 있다. 데이터 부족 해결을 위해 적대적 생성 신경 망 모델이 많은 관심을 받고 있으나, 적대적 생성 신경망 모델은 모든 변수에 동일한 가중치를 두고 데이터를 생성하므로, 입력변수와 출력변수 사이의 관계성이 정확하게 반영되지 않은 상태로 데이터가 생성된다. 이러한 데이터를 모델의 학습에 사용하여 예측 성능이 하락할 수 있다. 따라서, 예측 모델의 학습에 사용할 데이터 생 성을 위하여 일반적인 적대적 생성 신경망 모델이 아닌 새로운 모델이 필요하여, 보다 정확한 예측 모델 구성을 위해 적대적 생성 신경망 모델의 한계점을 개선한 WGAN-GP모델을 사용하였다. WGAN-GP모델에서 가상 데이터를 생성하게 되면 사전학습이 완료된 오토인코더는 데이터 수집부 에서 수신한 실제 데이터 셋과 WGAN-GP모델이 출력한 가상 데이터의 유사도에 따른 오차를 WGAN-GP모 델의 생성기에 피드백 할 수 있다. 사전학습된 회귀모델은 데이터 수집부에서 수신한 실제 데이터 셋과 WGAN-GP모델이 출력한 가상 데이 터의 관련성에 따른 오차를 WGAN-GP모델의 생성기에 피드백 할 수 있다. 오토인코더와 회귀모델에서 각각 피드백 되는 오차는 판별기에서 발생하는 손실함수와 함께 새 로운 오차방정식의 변수로 제공된다. 생성기는 오차방정식을 반영하여 구성된 손실함수를 업데이트 한 뒤 가상 데이터를 생성할 수 있다. 이처럼, WGAN-GP 모델과 더불어 실제 데이터 셋으로 사전학습이 완료된 오토인코더와 회귀모델 이 연계됨으로써, WGAN-GP 모델의 학습 과정에서 생성된 데이터가 실제 데이터와 유사한 정도를 사전학습 된 오토인코더를 통하여 계산하고, 입력변수와 출력변수 사이의 관계가 정확한지를 사전학습된 회귀모델 을 통하여 계산한 후 이를 보완해 나가면서 학습하기 때문에 보다 실제 데이터와 유사한 가상 데이터 생성 이 가능하다. 도 5는 도 4의 가상 데이터 생성부에서 사전학습이 완료된 오토인코더 및 회귀모델 과 WGAN-GP 모델 이 연계되는 과정을 좀 더 자세히 보여주는 도면이다. 임의의 노이즈에 대하여 생성기가 가상 데이터를 생성한다. 가상 데이터는 판별기에 서 실제데이터와 구별이 이루어지는 한편, 사전학습된 오토인코더 및 회귀모델에서 실제데이터 와 가상 데이터를 입력변수로 받아 유사도 및 관련성을 검사한다. 이에 따라 오토인코더 및 회 귀모델의 출력변수 로서의 오차와 판별기에서 출력변수 로서의 손실함수가 각각 생성기로 피드 백 되는 손실함수를 이루는 오차방정식의 변수로 제공된다. 이후 상기 과정을 반복하면서 생성된 가상 데이터 에 대해 판별기에서 실제 데이터와 n-1(n은 1보다 큰 자연수)번째 가상 데이터를 입력 받았을 때 산출되는 값, D(G(z))값이 1/2에 가까워지는 시점에서 업데이트된 손실함수에 기초하여 n번째 생성된 가상 데이터는 데이터 합성부로 출력되어 실제데이터와 합성된다. 이때 피드백 되는 손실함수는 L = D(G(z)) + (XF - AE(XF))2 + (YF - R(XF))2이며, 여기서 L은 생성기로 피 드백 되는 총 손실함수를 의미하며, D(G(z))는 WGAN-GP 모델의 판별기에 가상데이터를 입력받아 출력 하는 손실함수로서 LOSS에 대응한다. XF 와 YF는 각각 가상데이터를 이루는 입력변수 와 출력변수이며, AE(XF)는 오토인코더에서 출력되는 오차이며. R(XF)는 회귀모델에서 출력되는 오차다. WGAN-GP 모델의 학습 과정에서 생성된 데이터가 실제 데이터와 유사한 정도를 사전학습된 오토인코더 를 통하여 검사하고 사전학습된 회귀모델과 오토인코더에 WGAN-GP 모델의 학습 과정 동안 생성된 가상 데이터를 입력했을 때 발생하는 오차들을 WGAN-GP 모델의 손실함수에 더하여 상기 식과 같이 새로운 오차 방정식을 구성한다. 상기 오차 방정식을 사용하게 되면 WGAN-GP 모델의 학습 방향이 오토인코더의 영향으로 실제 입력변 수와 유사한 데이터를 생성하는 방향으로, 회귀모델의 영향으로 입력변수와 출력변수 사이의 관계성이 잘 반영되는 방향으로 유도될 수 있다. 이러한 오차를 새로운 손실함수로 사용하는 것이 가상 데이터 생성부 에서 실제데이터에 충분히 가까운 가상데이터를 생성할 수 있게 한다. 도 6은 도 1의 발전량 예측부에 적용되는 학습 모델의 예시들 및 예측 정확도 평가 결과를 예시적으로 보 여주는 도면이다. 가상 데이터 생성부에서 본 발명의 일 실시예에 따라 오토인코더와 회귀모델 을 WGAN-GP 모델과 연계한 방법의 효과가 있는지를 검증하기 위하여 다양한 기계학습 기반의 예측 모델을 구성하였고 데이터가 추가되기 전과 후의 성능 비교를 수행하였다. 실제 데이터만을 가지고 학습한 경우보다 본 발명의 일 실시예에 따라 오토인코더와 회귀모델을 WGAN-GP 모델과 연계한 방법을 통해 학습한 경우 대체로 예측 정확도에 있어서 더 향상된 점을 확인할 수 있다. 특히 다른 머신 러닝 기반 모델의 경우보다 딥러닝 기반의 MLP(Multi-Layer Perceptron, 다층 퍼셉트론)모델에서 가장 높은 정 확도의 향상을 보였다. 다만, 이는 예시적인 것이며, 태양광 발전량 예측 모델로는 다양한 학습모델들이 적용될 수 있음이 이해될 것이다. 도 7은 도 1의 태양광 발전량 예측 장치의 동작을 보여주는 순서도이다. S110 단계에서, 데이터 수집부는 기상 데이터, 시간 데이터 및 이에 대응하는 과거 태양광 발전량 데이터 를 수집할 수 있다. S120 단계에서, 모델 사전학습부는 데이터 수집부로부터 수집한 실제 데이터 셋을 가지고 오토인코더 및 회귀모델을 사전학습 할 수 있다. 예를 들어, 교차검증 결과에 따라 회귀모델로는 LightGBM모델이 사용될 수 있다. S130 단계에서, 가상 데이터 생성부는 모델 사전학습부에서 사전학습 된 오토인코더 및 회귀모델과 WGAN-GP 모델을 기초로 가상 데이터를 생성할 수 있다. S140 단계에서, 데이터 합성부는 실제 데이터 셋과 가상 데이터 생성부에서 생성된 가상 데이터를 합 성할 수 있다. 예를 들어, 가상 데이터와 실제 데이터 셋의 데이터의 합성은 가상 데이터의 프레임과 실제 데이 터 셋의 프레임을 연결(concatenate)하는 것을 통해 데이터를 합성할 수 있다. S150 단계에서, 태양광 발전량 예측부는 데이터 합성부에서 합성된 합성 데이터를 가지고 기계학습 기반의 예측 모델을 학습할 수 있다. 예를 들어, 예측 모델로는 딥러닝 모델 MLP모델을 사용할 수 있다. S160 단계에서, 태양광 발전량 예측부는 합성 데이터로 학습된 예측 모델이 태양광 발전량 예측 동작을 수 행할 수 있다. 도 8은 PCA(Principle Component Analysis)기법으로 데이터 간의 유사도를 시각화한 모습을 표현한 도면이다. 본 발명의 태양광 발전량 예측부를 구성하는 태양광 발전량 예측 모델에 사용하기 전에 데이터 수집부 에서 수집한 실제 데이터와 가상 데이터 생성부에서 생성된 가상 데이터가 얼마나 유사한지 정량적인 지표로 평가하기 어렵기 때문에 시각화를 통해 파악한다. 도 8a는 실제데이터의 분포를 2차원적으로 표현한 것이고, 도 8b는 생성된 가상데이터의 분포를 2차원적으로 표 현한 것이고, 도 8c에서 도 8a와 도 8b를 겹쳐 봤을 때, 본 발명의 데이터 수집부에서 수집한 실제 데이터 와 가상 데이터 생성부에서 생성된 가상 데이터 간에 유사한 분포를 보이는 것을 통해, 유사도가 매우 높 다는 것을 알 수 있다. 도 9는 PCC(Pearson Correlation Coefficient)기법으로 데이터 간의 유사도를 시각화한 모습을 표현한 도면이 다. PCC기법은 두 변수 사이의 관계성이 얼마나 되는지 확인할 수 있는데 수치적으로 그대로 표현하면 한눈에 파악 하기 어렵기 때문에, 분석한 결과를 히트 맵(HEAT MAP) 그래프를 통해 확인한다. 도 9a는 본 발명의 데이터 수집부에서 수집한 실제데이터의 히트 맵 그래프를 나타낸 것이고, 도 9b는 본 발명의 일 실시예에 의해 가상 데이터 생성부에서 생성된 가상 데이터의 히트 맵 그래프를 나타낸 것이고, 도 9c는 도 9a와 도 9b끼리 서로 값을 뺀 형태를 표현한 모습이다. 값을 뺀 결과가 0에 가까울수록 색깔이 없는 부분이므로. 이를 통해서 본 발명의 데이터 수집부에서 수집한 실제 데이터와 가상 데이터 생성부에 서 생성된 가상 데이터 간에 간의 관계성이 높음을 알 수 있다. 한편, 상술한 설명은 예시적인 것이며, 본 출원의 기술적 사상은 이에 한정되지 않음이 이해될 것이다. 예를 들 어, 도 6 및 도 7에서는, 예시적으로 딥러닝 모델을 임의로 선정해 교차 검증하여 가장 높은 정확도를 보이는 모델을 선택하는 실시 예가 설명되었다. 다만, 이는 예시적인 것이며, 다양한 변형이 가능하다. 예를 들어, 동 일한 알고리즘의 다른 모델에서 효율성과 정확도에서 높다면 이를 활용해 예측을 수행될 수도 있다. 이상에서는 본 발명에 따른 바람직한 실시 예들에 대하여 도시하고 또한 설명하였다. 그러나 본 발명은 상술한 실시 예에 한정되지 아니하며, 특허 청구의 범위에서 첨부하는 본 발명의 요지를 벗어남이 없이 당해 발명이 속 하는 기술 분야에서 통상의 지식을 가진 자라면 누구든지 다양한 변형 실시가 가능할 것이다."}
{"patent_id": "10-2022-0110158", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 출원의 실시 예에 따른 태양광 발전량 예측 장치를 보여주는 블록도이다. 도 2는 사전학습부를 더 상세하게 보여주는 도면이다. 도 3은 사전학습부의 회귀 모델에 적용되는 기계학습 모델의 예시들 및 데이터 별 교차검증 결과를 예시적으로 보여주는 도면이다. 도 4는 도 1의 가상 데이터 생성부의 구성을 더 상세히 보여주는 도면이다. 도 5는 도 4의 가상 데이터 생성부에서 가상 데이터 생성을 위해 사전학습이 완료된 오토인코더 및 회귀모델 과 WGAN-GP모델이 연계되는 과정을 좀 더 자세히 보여주는 도면이다. 도 6은 도 1의 발전량 예측부에 적용되는 학습 모델의 예시들 및 예측 정확도(MAE, Mean Absolute Error) 평가 결과를 예시적으로 보여주는 도면이다. 도 7은 도 1의 태양광 발전량 예측 장치의 동작을 보여주는 순서도이다. 도 8은 PCA기법으로 데이터 간의 유사도를 시각화한 모습을 표현한 도면이다. 도 9는 PCC 기법으로 데이터 간의 유사도를 시각화한 모습을 표현한 도면이다."}
