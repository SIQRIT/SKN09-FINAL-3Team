{"patent_id": "10-2021-0145280", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2023-0060751", "출원번호": "10-2021-0145280", "발명의 명칭": "행동 인식을 위한 영상 내 2차원 방향성 정보 및 기울기 정보 기반의 학습 모델 생성 방법 및", "출원인": "전남대학교산학협력단", "발명자": "이칠우"}}
{"patent_id": "10-2021-0145280", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "사람의 행동이 촬영된 영상으로부터 사람 영역을 검출하는 단계;검출된 사람 영역의 이미지(이하, \"사람 영역 이미지\" 이라함)를 추출하고 정규화하는 단계;상기 사람 영역 이미지에 서로 다른 NxN개의 셀로 분할된 레이어들을 적용하여 각 레이어들의 셀에 해당하는 방향성 정보와 기울기 정보를 추출하고 방향성 히스토그램과 기울기 히스토그램을 생성하는 단계;상기 방향성 히스토그램과 상기 기울기 히스토그램으로부터 특징 벡터들을 산출하는 단계; 및상기 특징 벡터들을 미리 설계된 그래프 구조에 입력하고 인공신경망에 학습시켜 학습 모델을 생성하는 단계;를포함하는 것을 특징으로 하는 영상 내 2차원 방향성 정보 및 기울기 정보 기반의 학습 모델 생성 방법"}
{"patent_id": "10-2021-0145280", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제 1 항에 있어서,상기 NxN개의 셀로 분할된 레이어들은 1x1 셀로 분할된 Top 레이어, 2x2 셀로 분할된 Mid 레이어, 4x4 셀로 분할된 Bottom 레이어를 사용하는 것을 특징으로 하는 영상 내 2차원 방향성 정보 및 기울기 정보 기반의 학습 모델 생성 방법"}
{"patent_id": "10-2021-0145280", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제 2 항에 있어서, 상기 방향성 히스토그램과 기울기 히스토그램을 생성하는 단계:는상기 사람 영역 이미지를 그레이 영상으로 변환 후 상기 레이어들의 각 셀의 크기에 해당하는 전체 영역의 방향성 정보 및 기울기 정보와 상기 Top 레이어와 상기 Mid 레이어 각 셀의 분획된 영역별 방향성 정보와 기울기 정보를 추출하는 단계;추출된 각각의 방향성 정보와 기울기 정보를 기반으로 방향성 히스토그램, 기울기 히스토그램을 생성하는 단계;및생성된 방향성 히스토그램과 기울기 히스토그램을 정규화하는 단계;를 포함하는 것을 특징으로 하는 영상 내 2차원 방향성 정보 및 기울기 정보 기반의 학습 모델 생성 방법"}
{"patent_id": "10-2021-0145280", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제 3 항에 있어서,상기 분획된 영역별은 셀의 중심을 기준으로 오른쪽 영역, 왼쪽 영역, 윗 영역 및 아래 영역을 포함하는 것을특징으로 하는 영상 내 2차원 방향성 정보 및 기울기 정보 기반의 학습 모델 생성 방법"}
{"patent_id": "10-2021-0145280", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제 2 항에 있어서,상기 각 레이어의 셀의 크기는 인접한 셀 간의 영역이 소정 부분 겹쳐지도록 형성되거나, 서로 다른 크기를 갖는 것을 특징으로 하는 영상 내 2차원 방향성 정보 및 기울기 정보 기반의 학습 모델 생성 방법"}
{"patent_id": "10-2021-0145280", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제 1 항에 있어서,공개특허 10-2023-0060751-3-상기 인공신경망은 그래프 신경망(Graph Neural Networks, GNN)인 것을 특징으로 하는 영상 내 2차원 방향성 정보 및 기울기 정보 기반의 학습 모델 생성 방법"}
{"patent_id": "10-2021-0145280", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제 1 항에 있어서,상기 특징 벡터는 각 히스토그램의 k개의 최빈값(mode)들이 분포하는 위치 정도를 나타내는 코드값, 히스토그램평균값, 히스토그램 표준편차인 것을 특징으로 하는 영상 내 2차원 방향성 정보 및 기울기 정보 기반의 학습 모델 생성 방법"}
{"patent_id": "10-2021-0145280", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제 7 항에 있어서,상기 코드값은 아래의 수학식 2에 의해 계산되는 것을 특징으로 하는 영상 내 2차원 방향성 정보 및 기울기 정보 기반의 학습 모델 생성 방법[수학식 2]여기서, k는 상위 랭크된 최빈값의 개수, Mode(order)는 각 순위에 해당하는 최빈값, C는 상수를 의미한다."}
{"patent_id": "10-2021-0145280", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제 1 항에 있어서,상기 그래프는 각 레이어 간 셀의 전체 영역과 해당 레이어 내 셀별 분획된 영역 간의 계층적 관계를 나타낸 방사계층 그래프 구조로상기 방사계층 그래프 구조는 레이어별 각 셀의 전체 영역과 상기 Top 레이어와 상기 Mid 레이어의 셀별 분획된영역에 대응되는 노드들을 갖으며, 해당 레이어 내 각 셀의 영역들 간에 겹치는 영역의 노드들 및 레이어들 간의 겹치는 영역의 노드들에 대한 관계를 에지를 통해 계층적으로 연결하도록 설계된 것을 특징으로 하는 영상 내 2차원 방향성 정보 및 기울기 정보 기반의 학습 모델 생성 방법"}
{"patent_id": "10-2021-0145280", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "컴퓨터를 기능시켜 제 1 항 내지 제 9 항 중 어느 한 항의 학습 모델 생성 방법을 실행시키기 위한 기록 매체에저장된 컴퓨터 프로그램"}
{"patent_id": "10-2021-0145280", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "행동인식을 수행하고자 촬영된 영상으로부터 사람 영역을 검출하는 단계;검출된 사람 영역의 이미지를 정규화하는 단계;정규화된 사람 영역의 이미지에 서로 다른 NxN개의 셀로 분할된 레이어들을 적용하여 각 레이어들의 셀에 해당하는 방향성 정보와 기울기 정보를 추출하고 방향성 히스토그램과 기울기 히스토그램을 생성하는 단계;상기 방향성 히스토그램과 상기 기울기 히스토그램으로부터 특징 벡터들을 산출하는 단계; 및제 1 항 내지 제 9 항 중 어느 한 항의 학습 방법으로 학습된 학습 모델에 상기 특징 벡터를 입력하여 행동 인식을 수행하는 단계;를 포함하는 것을 특징으로 하는 행동 인식 방법"}
{"patent_id": "10-2021-0145280", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "공개특허 10-2023-0060751-4-컴퓨터를 기능시켜 제 11 항의 행동 인식 방법을 실행하기 위한 기록매체에 저장된 컴퓨터 프로그램"}
{"patent_id": "10-2021-0145280", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 행동 인식을 위한 영상 내 2차원 방향성 정보 및 기울기 정보 기반의 학습 모델 생성 방법 및 학습 모 델을 이용한 행동 인식 방법에 관한 것으로,영상으로부터 검출된 사람 영역에 다양한 크기의 셀을 갖는 레이어들 을 적용하여 각 셀에 해당하는 방향성 정보와 기울기 정보를 기반으로 강인하고 식별성 높은 특징 벡터를 추출한 후 그래프 신경망에 학습 및 인식을 수행하기 때문에 연산량이 적어 실시간으로 행동 인식이 가능하며 다양환 환 경에서도 높은 인식률을 나타낼 수 있는 행동 인식을 위한 영상 내 2차원 방향성 정보 및 기울기 정보 기반의 학 습 모델 생성 방법 및 학습 모델을 이용한 행동 인식 방법에 관한 것이다."}
{"patent_id": "10-2021-0145280", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 행동 인식을 위한 영상 내 2차원 방향성 정보 및 기울기 정보 기반의 학습 모델 생성 방법 및 학습 모델을 이용한 행동 인식 방법에 관한 것으로,영상으로부터 검출된 사람 영역에 다양한 크기의 셀을 갖는 레이 어들을 적용하여 각 셀에 해당하는 방향성 정보와 기울기 정보를 기반으로 강인하고 식별성 높은 특징 벡터를 추출한 후 그래프 신경망에 학습 및 인식을 수행하기 때문에 연산량이 적어 실시간으로 행동 인식이 가능하며 다양환 환경에서도 높은 인식률을 나타낼 수 있는 행동 인식을 위한 영상 내 2차원 방향성 정보 및 기울기 정보 기반의 학습 모델 생성 방법 및 학습 모델을 이용한 행동 인식 방법에 관한 것이다."}
{"patent_id": "10-2021-0145280", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "행동인식 기술 분야는 최근 화제를 모으고 있는 지능형 감시, 자율주행, 서비스 로봇, 스마트 병원, 영상 미디 어 해석 시스템과 같은 첨단 인프라를 구축하여 일상생활에서 편리한 서비스들을 제공할 수 있다. 일반적으로 행동인식 기술 분야는 CCTV, 카메라와 같은 장치를 통해 입력된 2차원 영상으로부터 사람을 검출한 후 움직임에 대한 특징을 추출하여 인식을 수행하였다. 대부분의 경우 학습 과정에서 구해진 특징 벡터를 기저 벡터로 사용하여 특징 벡터 공간을 구성한 뒤, 입력 영 상의 특징 벡터와 특징 공간에서 미리 정의된 행동 모델 간의 거리를 비교하여 인식을 수행하는 방법을 사용하 였으나 이런 방법의 문제는 특징벡터를 구할 때 연구자들의 직관적인 판단이 개입될 가능성이 있어, 사용된 특 징에 따라 인식결과가 달라지는 문제가 있다. 이에 따라, 인물의 크기, 복장, 배경 및 조명의 변화 등과 같은 복잡한 요소가 포함된 실제 상황에서는 강건한 인식결과를 없을 수 없었으며, 최근에는 이러한 문제점들을 해결하기 위해 인공 신경망을 기반으로 한 딥러닝 기법이 행동 인식 분야에 적용되면서 영상의 다변성을 학습 과정에서 흡수할 수 있어 인식률이 크게 향상되고 있는 추세이다. 그러나, 행동 인식이란 시공간 상에서 연속적으로 발생하는 움직임의 변화를 추상적인 개념으로 추정하는 것이 기 때문에 2차원의 움직임 정보를 인공 신경망으로 학습하기는 쉽지 않으며, 가장 어려운 문제가 인체의 구조적 인 변화를 네트워크에 어떻게 결합시키느냐는 것이다. 즉, 인물이 팔을 폈을 때 자연스럽게 손목의 위치가 달라지게 되는데 이런 구조적으로 계층성을 갖는 움직임을 네트워크로 어떻게 표현할 수 있는가가 행동 인식의 인식률을 향상시킬 수 있는 큰 요인이다. 이런 문제를 해결하기 위해서 Yan 등은 인체구조를 모방한 그래프 구조를 시공간적으로 연결된 네트워크(ST- GCN)를 제안하여 행동 인식을 수행하였다[1]. 이 방법은 학습 과정에서 정보 전달 경로가 그래프의 연결구조에 의해 정의되기 때문에 인체동작의 구조적 맥락을 네트워크로 표현할 수 있는 장점이 있으며, 정의된 네트워크 구조에 연속적으로 변화하는 각 관절의 3차원 위치를 입력시켜 인공신경망으로 학습함으로써 행동을 인식하였다. 그러나, 이 방법은 정확한 관절의 위치를 구하기 어렵기 때문에, 정확한 3차원 관절 위치가 입력되지 않으면 인 공 신경망 학습이 불안정해지고 결국 인식률이 떨어진다. 한편, 정확한 3차원 관절 위치를 구하기 위해 모션 캡처 장비와 같은 고가의 특수 장비를 이용하거나 OPENPOSE 와 같이 복잡하고 계산량이 많은 알고리즘을 사용할 수 있으나 일상생활에서 사용되는 CCTV 환경에서 실효성이 떨어지는 문제가 있다. 선행기술문헌 비특허문헌(비특허문헌 0001) [1].Yan, Sijie, Yuanjun Xiong, and Dahua Lin. \"Spatial temporal graph convolutional networks for skeleton-based action recognition.\" Thirty-Second AAAI Conference on Artificial Intelligence. 2018"}
{"patent_id": "10-2021-0145280", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명의 목적은 상기한 문제점을 해결하기 위해 안출된 것으로 인물의 크기, 복장, 배경 및 조명의 변화 등과 같은 복잡한 요소로부터 강인하고, 적은 연산량을 사용하여 특징 벡터를 추출할 수 있어, 실시간으로 행동 인식 이 가능할 뿐만 아니라 인식률이 높은 영상 내 2차원 방향성 정보 및 기울기 정보 기반의 학습 모델 생성 방법 및 생성된 학습 모델을 이용한 행동 인식 방법을 제공하는 데 있다. 한편, 본 발명의 목적들은 이상에서 언급한 목적들로 제한되지 않으며, 언급되지 않은 또 다른 목적들은 아래의 기재로부터 통상의 기술자에게 명확하게 이해될 수 있을 것이다."}
{"patent_id": "10-2021-0145280", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명은 상술한 목적을 달성하기 위하며 사람의 행동이 촬영된 영상으로부터 사람 영역을 검출하는 단계; 검 출된 사람 영역의 이미지(이하, \"사람 영역 이미지\" 이라함)를 추출하고 정규화하는 단계; 상기 사람 영역 이미 지에 서로 다른 NxN개의 셀로 분할된 레이어들을 적용하여 각 레이어들의 셀에 해당하는 방향성 정보와 기울기 정보를 추출하고 방향성 히스토그램과 기울기 히스토그램을 생성하는 단계; 상기 방향성 히스토그램과 상기 기 울기 히스토그램으로부터 특징 벡터들을 산출하는 단계; 및 상기 특징 벡터들을 미리 설계된 그래프 구조에 입 력하고 인공신경망에 학습시켜 학습 모델을 생성하는 단계;를 포함하는 것을 특징으로 하는 영상 내 2차원 방향 성 정보 및 기울기 정보 기반의 학습 모델 생성 방법을 제공한다. 바람직한 실시예에 있어서, 상기 NxN개의 셀로 분할된 레이어들은 1x1 셀로 분할된 Top 레이어, 2x2 셀로 분할 된 Mid 레이어, 4x4 셀로 분할된 Bottom 레이어를 사용한다. 바람직한 실시예에 있어서, 상기 방향성 히스토그램과 기울기 히스토그램을 생성하는 단계:는 상기 사람 영역 이미지를 그레이 영상으로 변환 후 상기 레이어들의 각 셀의 크기에 해당하는 전체 영역의 방향성 정보 및 기울 기 정보와 상기 Top 레이어와 상기 Mid 레이어 각 셀의 분획된 영역별 방향성 정보와 기울기 정보를 추출하는 단계; 추출된 각각의 방향성 정보와 기울기 정보를 기반으로 방향성 히스토그램, 기울기 히스토그램을 생성하는 단계; 및 생성된 방향성 히스토그램과 기울기 히스토그램을 정규화하는 단계;를 포함한다. 바람직한 실시예에 있어서, 상기 분획된 영역별은 셀의 중심을 기준으로 오른쪽 영역, 왼쪽 영역, 윗 영역 및 아래 영역을 포함한다. 바람직한 실시예에 있어서, 상기 각 레이어의 셀의 크기는 인접한 셀 간의 영역이 소정 부분 겹쳐지도록 형성되 거나, 서로 다른 크기를 갖는다. 바람직한 실시예에 있어서, 상기 인공신경망은 그래프 신경망(Graph Neural Networks, GNN)이다. 바람직한 실시예에 있어서, 상기 특징 벡터는 각 히스토그램의 k개의 최빈값(mode)들이 분포하는 위치 정도를 나타내는 코드값, 히스토그램 평균값, 히스토그램 표준편차이다. 바람직한 실시예에 있어서, 상기 코드값은 아래의 수학식 2에 의해 계산된다. [수학식 2]"}
{"patent_id": "10-2021-0145280", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 2, "content": "여기서, k는 상위 랭크된 최빈값의 개수, Mode(order)는 각 순위에 해당하는 최빈값, C는 상수를 의미한다. 바람직한 실시예에 있어서, 상기 그래프는 각 레이어 간 셀의 전체 영역과 해당 레이어 내 셀별 분획된 영역 간 의 계층적 관계를 나타낸 방사계층 그래프 구조로 상기 방사계층 그래프 구조는 레이어별 각 셀의 전체 영역과상기 Top 레이어와 상기 Mid 레이어의 셀별 분획된 영역에 대응되는 노드들을 갖으며, 해당 레이어 내 각 셀의 영역들 간에 겹치는 영역의 노드들 및 레이어들 간의 겹치는 영역의 노드들에 대한 관계를 에지를 통해 계층적 으로 연결하도록 설계된다. 또한, 본 발명은 컴퓨터를 기능시켜 제 1 항 내지 제 10 항 중 어느 한 항의 학습 모델 생성 방법을 실행시키기 위한 기록 매체에 저장된 컴퓨터 프로그램을 제공할 수 있다. 또한, 본 발명은 행동인식을 수행하고자 촬영된 영상으로부터 사람 영역을 검출하는 단계; 검출된 사람 영역의 이미지를 정규화하는 단계; 정규화된 사람 영역의 이미지에 서로 다른 NxN개의 셀로 분할된 레이어들을 적용하 여 각 레이어들의 셀에 해당하는 방향성 정보와 기울기 정보를 추출하고 방향성 히스토그램과 기울기 히스토그 램을 생성하는 단계; 상기 방향성 히스토그램과 상기 기울기 히스토그램으로부터 특징 벡터들을 산출하는 단계; 및 제 1 항 내지 제 9 항 중 어느 한 항의 학습 방법으로 생성된 학습 모델에 상기 특징 벡터를 입력하여 행동 인식을 수행하는 단계;를 포함하는 것을 특징으로 하는 행동 인식 방법을 제공한다. 또한, 본 발명은 컴퓨터를 기능시켜 제 11 항의 행동 인식 방법을 실행하기 위한 기록매체에 저장된 컴퓨터 프 로그램을 더 제공할 수 있다."}
{"patent_id": "10-2021-0145280", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명은 다음과 같은 우수한 효과가 있다. 본 발명의 영상 내 2차원 방향성 정보 및 기울기 정보 기반의 학습 모델 생성 방법 및 생성된 학습 모델을 이 용한 행동 인식 방법에 의하면, 고가의 장비나 복잡한 알고리즘을 사용하지 않고도, 영상으로부터 사람의 움직 임과 자세에 대한 특징 정보를 갖는 방향성 히스토그램와 기울기 히스토그램을 기반으로 강건하고 식별성 높은 특징 벡터를 추출할 수 있는 장점이 있다 또한, 본 발명의 영상 내 2차원 방향성 정보 및 기울기 정보 기반의 학습 모델 생성 방법 및 생성된 학습 모델 을 이용한 행동 인식 방법에 의하면, 검출된 사람 영역 이미지로부터 복수 개의 서로 다른 셀 크기를 갖는 레이 어들의 각 셀 영역에 대한 방향성 정보와 기울기 정보를 이용하여 히스토그램을 생성하고 각 히스토그램으로부 터 코드값, 히스토그램 평균값, 히스토그램 표준편차값을 특징 벡터로 추출하여 각 레이어의 셀 간과 레이어 내 의 셀 영역 간의 관계가 정의된 그래프 신경망을 통해 행동 인식을 수행함으로써, 연산량이 적어 실시간으로 행 동 인식이 수행이 가능하며 높은 인식률을 나타낼 수 있는 장점이 있다."}
{"patent_id": "10-2021-0145280", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "본 발명에서 사용되는 용어는 가능한 현재 널리 사용되는 일반적인 용어를 선택하였으나, 특정한 경우는 출원인 이 임의로 선정한 용어도 있는데 이 경우에는 단순한 용어의 명칭이 아닌 발명의 상세한 설명 부분에 기재되거 나 사용된 의미를 고려하여 그 의미가 파악되어야 할 것이다. 이하, 첨부한 도면에 도시된 바람직한 실시예들을 참조하여 본 발명의 기술적 구성을 상세하게 설명한다. 그러나, 본 발명은 여기서 설명되는 실시예에 한정되지 않고 다른 형태로 구체화될 수도 있다. 명세서 전체에 걸쳐 동일한 참조번호는 동일한 구성요소를 나타낸다.본 발명은 영상으로부터 2차원 정보인 객체의 움직임에 대한 방향성 정보와 기울기 정보를 추출하고 행동 인식 을 수행하기 위해 강건하고 식별성이 높으며, 연산량이 최소화된 특징 벡터를 추출하여 학습 모데을 생성하는 방법과 학습된 학습 모델을 통해 행동 인식을 수행하는 방법에 관한 것이다. 또한, 본 발명의 일 실시예에 따른 학습 모델 생성 방법과 행동 인식 방법은 컴퓨터에 의해 수행되며, 상기 컴 퓨터에는 상기 컴퓨터를 기능시켜 방법을 수행하는 컴퓨터 프로그램이 저장된다. 또한, 상기 컴퓨터는 일반적인 퍼스널 컴퓨터뿐만 아니라, 스마트폰이나 태블릿 PC와 같은 스마트 기기를 포함 하는 광의의 컴퓨팅 장치를 의미한다. 또한, 상기 컴퓨터 프로그램은 별도의 기록 매체에 저장되어 제공될 수 있으며, 상기 기록매체는 본 발명을 위 하여 특별히 설계되어 구성된 것들이거나 컴퓨터 소프트웨어 분야에서 통상의 지식을 가진 자에게 공지되어 사 용 가능한 것일 수 있다. 예를 들면, 상기 기록매체는 하드 디스크, 플로피 디스크 및 자기 테이프와 같은 자기 매체, CD, DVD와 같은 광 기록 매체, 자기 및 광 기록을 겸할 수 있는 자기-광 기록 매체, 롬, 램, 플래시 메모리 등 단독 또는 조합에 의해 프로그램 명령을 저장하고 수행하도록 특별히 구성된 하드웨어 장치일 수 있다. 또한, 상기 컴퓨터 프로그램은 프로그램 명령, 로컬 데이터 파일, 로컬 데이터 구조 등이 단독 또는 조합으로 구성된 컴퓨터 프로그램일 수 있고, 컴파일러에 의해 만들어지는 것과 같은 기계어 코드 뿐만 아니라, 인터프리 터 등을 사용하여 컴퓨터에 의해 실행될 수 있는 고급 언어 코드로 짜여진 컴퓨터 프로그램일 수 있다. 도 1은 본 발명의 일 실시예에 따른 학습 모델 생성 방법과 행동 인식 방법의 순서도, 도 2는 본 발명의 일 실 시예에 따른 특징 벡터 추출을 위해 적용되는 레이어들을 설명하기 위한 제1 도면, 도 3은 본 발명의 일 실시예 에 따른 특징 벡터 추출을 위해 적용되는 레이어들을 설명하기 위한 제2 도면, 도 4은 본 발명의 일 실시예 따 른 레이어의 셀 영역들을 설명하기 위한 예를 보여주는 제1 도면, 도 5는 본 발명의 일 실시예에 따른 레이어의 셀 영역들을 설명하기 위한 제2 도면, 도 6는 본 발명의 일 실시예에 따른 레이어 간의 대응되는 영역의 셀을 설명하기 위한 예를 보여주는 도면으로 도 1 내지 도 6을 참조하여, 본 발명의 학습 모델 생성 방법과 행동 인 식 방법에 대해 상세하게 설명한다. 먼저, 본 발명의 학습 모델 생성 방법(S1000)은 크게 사람 영역 검출 단계(S1100), 방향성 정보 및 기울기 정보 추출 단계(S1200), 방향성 히스토그램 및 기울기 히스토그램 생성 단계(S1300), 특징 벡터 추출 단계(S1400) 및 학습 단계(S1500)를 포함하여 이루어진다. 상세하게는 학습을 수행하고자 하는 사람의 행동이 촬영된 영상을 입력받아, 입력된 영상 내에 사람을 검출 한다(S1100). 입력된 영상 내에 사람을 검출하기 위한 방법으로서, 공지된 다양한 알고리즘이 사용될 수 있으며, 예를 들면 객체 검출에 뛰어난 성능을 보이는 딥러닝 계열의 알고리즘이 사용될 수 있다. 상세하게는, 상기 딥러닝 계열의 알고리즘은 Yolo 알고리즘일 수 있으며, 검출된 사람 영역의 좌표 데이터를 획 득할 수 있다. 이렇게, 검출된 사람 영역에 대한 좌표 데이터를 기반으로, 상기 입력된 영상으로부터 사람 영역에 대한 이미지 만을 추출하고, 추출된 사람 영역 이미지에 대한 정규화 과정을 수행한다. 이는, 사람마다 크기, 모양, 위치 등이 다양하여 검출된 사람 영역의 크기가 상이하기 때문에, 일정 크기를 갖 도록 사람 영역 이미지의 정규화를 수행한다. 다음, 정규화된 사람 영역 이미지로부터 방향성 정봐 기울기 정보를 추출하고(S1200),방향성 히스토그램과 기울기 히스토그램을 생성한다(S1300). 상세하게는 먼저, 상기 사람 영역 이미지를 그레이 영상으로 변환한 후 복수 개 레이어의 셀별 및 각 셀 내 의 분획된 영역에 해당하는 방향성 정보와 기울기 정보를 추출한다(S1200). 여기서, 상기 복수 개의 레이어들은 NxN 개의 셀(Cell)을 갖는 레이어들로써, 서로 다른 크기의 셀을 갖는 레이 어들을 상기 정규화된 사람 영역 이미지에 적용하여 각 셀 영역에 대한 방향성 정보와 기울기 정보를 추출한다. 또한, 상기 레이어들은 1x1 셀로 분할된 Top 레이어, 2x2 셀로 분할된 Mid 레이어, 4x4로 분할된 Bottom 레이어를 포함할 수 있으며, 이외에도 다양한 크기의 셀을 갖는 레이어들을 사용할 수 있으나, 본발명에서는 위에서 언급한 3개의 레이어를 이용하여 학습 모델을 생성하고 행동 인식을 수행한다. 한편, 레이어 내 셀의 크기는 모두 동일한 크기 갖도록 표현되었으나, 사람 영역 이미지의 전체 크기 내에서 각 셀의 크기가 서로 다르게 설계될 수 있다. 예를 들면, 인접한 셀 간의 영역이 겹치도록 셀의 크기가 설계될 수 있으며, 이를 통해, 향후 각 셀에서 데이터 를 취득 시 사람의 움직임과 자세에 따른 세부적이고 더욱 정확한 데이터 취득이 가능하다는 장점이 있다. 상기 분획된 영역은 셀의 중심을 기준으로 왼쪽 영역(L), 오른쪽 영역(R), 윗 영역(U), 아래 영역(D)을 포함하 며, 본 발명에서는 상기 사람 영역 이미지로부터 레이어별(100,200,300) 각 셀에 해당하는 전체 영역(A)의 방향성 정보와 기울기 정보, 상기 Top 레이어와 상기 Mid 레이어의 각 셀의 분획된 영역(L,R,U,D)에 해당하는 방향성 정보와 기울기 정보를 추출하였다. 한편, 상기 방향성 정보는 사람의 움직임에 대한 방향 정보를 의미하고, 상기 기울기 정보는 사람의 자세에 대 한 각도 정보를 의미하며 공지된 다양한 알고리즘에 의해 추출될 수 있다. 바람직하게는, 상기 방향성 정보는 옵티컬 플로우(Optical Flow) 알고리즘을 통해 추출될 수 있으며, 상기 기울 기 정보는 1차 미분 알고리즘을 통해 추출될 수 있다. 다음, 이러한 과정을 통해 추출된 방향성 정보와 기울기 정보를 이용하여 히스토그램을 생성한다(S1300). 상기 히스토그램은 극좌표(m,θ)로 표현되는 방향성 정보와 기울기 정보의 도수분포를 나타낸 것으로 추출된 각 레이어별(100,200,300) 셀과 각 셀의 분획된 영역(L,R,U,D)에 해당하는 방향성 정보와 기울기 정보에 대한 각각 의 방향성 히스토그램과 기울기 히스토그램이 생성된다. 또한, 상기 히스토그램은 다양한 차원을 갖도록 Bin을 설정하여 생성될 수 있으며, 바람직하게는 16차원을 갖도 록 Bin을 설계하여 히스토그램을 생성할 수 있다. 상세하게는, 16차원의 히스토그램을 표현하기 위해 0~360도의 방향을 16개의Bin으로 나누어, 각각의 Bin에 해당 하는 방향성 정보와 기울기 정보의 크기를 누적하여 히스토그램을 얻을 수 있다 이러한 과정을 통해 추출된 히스토그램은 아래의 식을 통해 정규화를 수행하게 된다. 수학식 1"}
{"patent_id": "10-2021-0145280", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "다음, 생성된 방향성 히스토그램과 기울기 히스토그램을 이용하여 특징 벡터를 생성한다(S1400). 한편, 상기 각 레이어(100,200,300)의 셀에 대한 방향성 히스토그램과 기울기 히스토그램의 데이터 자체만을 이 용하여 아래에서 설명할 학습 모델 생성을 위한 특징 벡터로 사용할 수 있으나, 학습 과정에서 연산량이 많아지 고, 인식률이 저하되는 문제가 있어, 본 발명에서는 상기 방향성 히스토그램과 기울기 히스토그램으로부터 연산 량을 최소화하고 식별성이 높은 특징 벡터를 추출한다. 여기서, 상기 특징 벡터는 총 6개로 상기 방향성 히스토그램과 상기 기울기 히스토그램 각각의 코드값(Code), 히스토그램 평균값, 히스토그램 표준편차를 포함한다.. 상기 코드값은 히스토그램의 값이 큰 순서대로 정렬된 최빈값(mode) 중 상위 랭크된 k 개의 최빈값(Mode)들이 분포하는 위치 정도를 나타내는 대표 단일값으로, 아래의 수학식 2에 의해 계산될 수 있다. 수학식 2 여기서, k는 상위 랭크된 최빈값의 개수, Mode(order)는 각 순위에 해당하는 최빈값, C는 상수를 의미한다. 한편, 상기 수학식 1을 통해 산출되는 코드값은 값이 클 수록 k 개의 최빈값들이 오른쪽으로 치우친 것을 의미 하며, 값이 작을 수록 왼쪽에 치우진 것을 의미한다. 또한, 상기 C는 상수로서, 히스토그램으로부터 나올 수 있는 최빈값의 최대 개수보다 큰 값을 사용할 수 있으며, 상기 k 값은 생성된 히스토그램의 차원 수 내에서 사용자에 의해 다양하게 설정될 수 있다. 다음, 추출된 특징 벡터들을 인공신경망에 학습시킨다(S1500). 상기 인공신경망은 그래프 신경망(Graph Neural Network)으로 입력으로 노드와 노드에 해당되는 특징 벡터 및 노드 간의 관계를 나타내는 에지로 이루어진 그래프 구조를 사용하며, 입력된 그래프를 통해 학습과 인식을 수 행한다. 한편, 종래에는 그래프 신경망을 이용하여 행동 인식을 수행하기 위해 사람의 관절 구조 또는 신체 구조와 동일 하게 노드를 구성하고 에지를 연결함으로써 각 노드 간의 관계를 정의하였으나 본 발명에서는 관절 구조나 신체 구조를 기반으로 추출된 특징이 아니기 때문에 그래프 구조를 새롭게 설계할 필요가 있다. 이에, 본 발명에서는 각 레이어(100,200,300)의 셀에 대한 상호 관계에 대한 계층 구조가 정의된 다중영역기반 방사계층 그래프를 설계하였다. 도 7는 본 발명의 일 실시예에 따른 설계된 방사계층 그래프의 구조를 보여주는 도면으로, 도 7을 참조하면, 다 중영역기반 방사계층 그래프를 설계하기 위해서 Top 레이어의 셀(1-1)이 영역별(A,L,R,U,D)로 분류된 5개 의 노드, Mid 레이어의 각 셀(2-1,2-2,2-3,2-4)이 영역별(A,L,R,U,D)로 분류된 20개의 노드를 생성하였으며, 상기 Bottom 레이어는 각 셀(3-1,3-2,3-3,...3-16)에 대응되는 16개의 노드를 생성하였다. 즉, 총 41개의 노드를 형성하였으며, 각 노드에 대응되는 특징 벡터들을 입력하였다. 또한, 레이어별 각 노드는 해당 레이어 내 각 셀의 전체 영역(A)과 셀의 분획된 영역(L,R,U,D) 간의 겹치는 부 분, 각 레이어들 간의 영역별(A,L,R,U,D) 겹치는 부분의 셀에 대한 관계성을 나타내도록 에지를 통해 계층적으 로 연결하였다. 이렇게 설계된 방사계층 그래프를 그래프 신경망에 입력으로 넣어 학습을 수행함으로써, 행동 인식을 위한 학습 모델이 생성되며, 상기 학습 모델에는 행동별로 다양한 클래스에 대한 특징 벡터들이 입력되어 학습된다. 위의 과정을 걸쳐 생성된 학습 모델을 이용하여 행동 인식을 수행하며, 행동 인식을 수행하는 방법(S2000)은 아 래와 같다. 먼저, 행동 인식을 수행하고자 하는 영상을 입력받는다(S2100). 다음. 상기 학습 모델 생성 방법(S1000)에서와 같이 동일한 방법으로 입력된 영상으로부터 사람 영역을 검출 과 정, 정규화 과정, 특징 벡터 추출 과정을 통해 상기 학습 모델에 입력할 특징 벡터들을 추출한다(S2200). 다음, 상기 학습 모델의 입력으로 설계된 방사계층 그래프에 상기 특징 벡터를 입력하여 행동 인식을 수행한다 (S2300). 따라서, 본 발명에 따르면, 고가의 장비나 복잡한 알고리즘을 사용하지 않고도, 영상으로부터 다양한 변화 요소 에도 강인한 방향성 정보와 기울기 정보를 이용하며, 특징 벡터를 추출하기 때문에 강건하고 식별성이 높은 특 징 벡터를 얻을 수 있다. 또한, 본 발명은 행동 인식 실험을 수행한 결과 93%의 높은 행동 인식률을 나타낸 바, 일상 생활에서 많이 사용 되는 CCTV 카메라 영상을 이용하여 행동을 인식할 수 있으며, 고가의 장비를 사용하거나 촬영 환경에 제약조건 을 두지 않기 때문에 실용성이 높다는 것을 확인할 수 있다. 이상에서 살펴본 바와 같이 본 발명은 바람직한 실시예를 들어 도시하고 설명하였으나, 상기한 실시예에 한"}
{"patent_id": "10-2021-0145280", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "정되지 아니하며 본 발명의 정신을 벗어나지 않는 범위 내에서 당해 발명이 속하는 기술분야에서 통산의 지식을 가진 자에 의해 다양한 변경과 수정이 가능할 것이다."}
{"patent_id": "10-2021-0145280", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 일 실시예에 따른 행동 인식을 위한 학습 모델 생성 방법과 행동 인식 방법의 순서도, 도 2는 본 발명의 일 실시예에 따른 특징 벡터 추출을 위해 적용되는 레이어들을 설명하기 위한 제1 도면, 도 3은 본 발명의 일 실시예에 따른 특징 벡터 추출을 위해 적용되는 레이어들을 설명하기 위한 제2 도면, 도 4는 본 발명의 일 실시예에 따른 레이어 각 셀의 분획되는 영역을 설명하기 위한 예를 보여주는 도면, 도 5는 본 발명의 일 실시예에 따른 레이어 각 셀의 분획되는 영역을 설명하기 위한 예를 보여주는 제2 도면, 도 6 본 발명의 일 실시예에 따른 레이어 간의 대응되는 영역의 셀을 설명하기 위한 예를 보여주는 도면, 도 7 은 본 발명의 일 실시예에 따른 설계된 방사계층 그래프의 구조를 보여주느 도면이다."}
