{"patent_id": "10-2022-0155170", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2024-0073401", "출원번호": "10-2022-0155170", "발명의 명칭": "GAN 기반의 이미지 변환 장치 및 GAN 기반의 이미지 변환 방법", "출원인": "한양대학교 에리카산학협력단", "발명자": "이민식"}}
{"patent_id": "10-2022-0155170", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "잠재공간 상의 z로부터 생성한 생성적 대립 신경망(GAN) 기반의 이미지를 변환하여 변환된 이미지를 생성하는GAN 기반의 이미지 변환 장치에 있어서, 상기 이미지의 상기 변환된 이미지로의 변화의 방향과 정도를 입력받아 상기 잠재공간 상의 변화량을 산출하는디포메이터;상기 잠재공간 상의 상기 z로부터 상기 이미지를 생성하고, 상기 z에 상기 변화량을 반영하여 상기 변환된 이미지를 생성하는 제너레이터; 및상기 이미지와 상기 변환된 이미지의 차이를 통해 상기 변화의 방향과 상기 정도를 산출하는 리그레서를 포함하는 것을 특징으로 하는, GAN 기반의 이미지 변환 장치."}
{"patent_id": "10-2022-0155170", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 디포메이터는 상기 GAN 기반의 이미지 변환 장치가 학습하는 데이터의 총 클래스의 수 + 1개의 선형 레이어로, 상기 데이터의 글로벌한 변화에 대한 요소인 A와 각 클래스별 변화에 대한 요소인 C1, C1, C2, …, CN(여기서 n은 상기 총 클래스의 수)를 포함하는 것을 특징으로 하는 GAN 기반의 이미지 변환 장치."}
{"patent_id": "10-2022-0155170", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제2항에 있어서,사전학습된 GAN을 이용하여 샘플(z)를 무작위로 추출하고, 학습할 변화의 수가 K개, 변화의 범위를 ε가 인 경우, 무작위로 1부터 K사이의 값()과 ε사이의 값()을 추출하고, 추출한 ()를 이용하여, 길이가 K이면서 번째 위치의 값이 1이고 나머지 위치의 값이 0인 one-hot 벡터를 구성하고, 이에 을 곱하여 특정 방향으로 주어진 만큼 이동하는 역할을 하는 상기 디포메이터의 입력 벡터를 구성하고, 상기 샘플 (z)에 대해 사전학습된 클래스 분류기를 이용하여 클래스를 얻고, 상기 입력 벡터와 상기 샘플 (z)에 대한 상기 클래스를 바탕으로, 상기 디포메이터에 상기 입력 벡터를 곱하여,글로벌한 변화벡터와 클래스별 변화 벡터를 추출하는 것을 특징으로 하는 GAN 기반의 이미지 변환 장치."}
{"patent_id": "10-2022-0155170", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제3항에 있어서, 상기 글로벌 레이어와 각 클래스별 레이어에서 학습되는 특성들끼리는 각각의 레이어 내에서 직교분해를 하고,상기 글로벌 레이어와 상기 클래스별 레이어에서 학습되는 특성들을 분할하기 위해, 직교사영을 통해 각 클래스레이어에서 글로벌 레이어의 성분을 제거하는 것을 특징으로 하는 GAN 기반의 이미지 변환 장치."}
{"patent_id": "10-2022-0155170", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제3항에 있어서, 상기 클래스 분류기는 손실함수로 서로 다른 클래스끼리 멀어지게 하는 Cross-entropy를 사용하는 것을 특징으로 하는 GAN 기반의 이미지 변환 장치.공개특허 10-2024-0073401-3-청구항 6 제5항에 있어서, 상기 GAN 기반의 이미지 변환 장치를 학습하기 위해서, 상기 제너레이터는 사전학습된 GAN 모델을 사용하고, 학습 데이터들의 글로벌한 특성과 각 클래스별 특성을 서로 분리하여 학습하는 것을 특징으로 하는 GAN 기반의 이미지 변환 장치."}
{"patent_id": "10-2022-0155170", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제6항에 있어서, 상기 글로벌한 특성을 학습할 때에는, 다음의 수학식 1과 같은 선형 레이어를 이용하고, [수학식1]상기 각 클래스별 특성을 학습할 때에는, 다음의 수학식 2와 같은 선형 레이어를 이용하는 것을 특징으로 하는GAN 기반의 이미지 변환 장치.[수학식 2]"}
{"patent_id": "10-2022-0155170", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제7항에 있어서, 상기 리그레서를 학습하는 데에는 다음 수학식 3의 선형 레이어와 수학식 4를 이용하는 것을 특징으로 하는 GAN기반의 이미지 변환 장치.[수학식 3][수학식 4]"}
{"patent_id": "10-2022-0155170", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "이미지를 생성하는 생성적 대립 신경망(GAN)을 사전 학습하는 단계;학습 데이터에 공통적으로 나타나는 글로벌한 특성을 반영하기 위한 글로벌 레이어와, 상기 학습 데이터의 각클래스 별로 나타나는 특성을 반영하기 위한 각 클래스별 레이어를 선언하는 글로벌 레이어와 클래스별 레이어선언 단계;상기 학습 데이터의 클래스를 분류하는 사전 학습된 클래스 분류기를 준비하는 단계;상기 각 클래스별로 다른 특성들을 학습하기 위하여, 학습된 변화로부터 생성한 이미지를 받아서 변화의 방향(k)과 변화크기(ε)를 예측하는 모델을 각 클래스에 대해 선언하는 클래스 별 시프트 예측기(Shift Predictor)를 선언하는 단계;잠재공간 상의 샘플(z)의 이동과 생성된 이미지 상의 변화의 방향과 변화크기의 관계를 학습하는 변화의 방향학습 단계; 및 상기 시프트 예측기를 이용하여, 생성될 이미지에 원하는 정도의 변화의 방향과 변화크기에 대응되는 상기 잠재공간 상의 이동을 산출하여, 상기 생성될 이미지를 원하는 정도의 변화의 방향과 변화크기로 변환한 변환 이미지를 생성하는 이미지 변환 단계를 포함하는 GAN 기반의 이미지 변환 방법. 공개특허 10-2024-0073401-4-청구항 10 제9항에 있어서,변화의 방향 학습 단계는, 사전학습된 GAN을 이용하여 샘플(z)를 무작위로 추출하고, 학습할 변화의 수가 K개, 변화의 범위를 ε가 인 경우, 무작위로 1부터 K사이의 값()과 ε사이의 값()을 추출하고, 추출한 ()를 이용하여, 길이가 K이면서 번째 위치의 값이 1이고 나머지 위치의 값이 0인 one-hot 벡터를 구성하고, 이에 을 곱하여 특정 방향으로 주어진 만큼 이동하는 역할을 하는 디포메이터의 입력 벡터를 구성하고, 상기 샘플 (z)에 대해 상기 사전학습된 클래스 분류기를 이용하여 클래스를 얻고, 상기 입력 벡터와 상기 샘플 (z)에 대한 상기 클래스를 바탕으로, 상기 디포메이터에 상기 입력 벡터를 곱하여,글로벌한 변화벡터와 클래스별 변화 벡터를 추출하는 것을 특징으로 하는 GAN 기반의 이미지 변환 방법."}
{"patent_id": "10-2022-0155170", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "제10항에 있어서, 상기 학습 데이터들의 글로벌한 특성과 각 클래스별 특성을 서로 분리하여 학습하고,상기 글로벌한 특성을 학습할 때에는, 다음의 수학식 1과 같은 선형 레이어를 이용하고, [수학식1]상기 각 클래스별 특성을 학습할 때에는, 다음의 수학식 2와 같은 선형 레이어를 이용하는 것을 특징으로 하는GAN 기반의 이미지 변환 방법.[수학식 2]"}
{"patent_id": "10-2022-0155170", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제11항에 있어서, 상기 시프트 예측기를 학습하는 데에는 다음 수학식 3의 선형 레이어와 수학식 4를 이용하는 것을 특징으로 하는 GAN 기반의 이미지 변환 방법.[수학식 3][수학식 4]"}
{"patent_id": "10-2022-0155170", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "제10항에 있어서,상기 글로벌 레이어와 클래스별 레이어 선언 단계에서는,상기 글로벌 레이어와 상기 클래스별 레이어는 상기 학습 데이터의 총 클래스의 수 + 1개의 선형 레이어로, 상기 데이터의 글로벌한 변화에 대한 요소인 상기 글로벌 레이어(A)와 각 클래스별 변화에 대한 요소인 상기 클래스별 레이어(C1, C1, C2, …, CN)(여기서 n은 상기 총 클래스의 수)인 것을 특징으로 하는 GAN 기반의 이미지 변공개특허 10-2024-0073401-5-환 방법."}
{"patent_id": "10-2022-0155170", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_14", "content": "잠재공간 상의 z로부터 생성한 생성적 대립 신경망(GAN) 기반의 이미지를 변환하여 변환된 이미지를 생성하는GAN 기반의 이미지 변환 방법에 있어서, 상기 이미지의 상기 변환된 이미지로의 변화의 방향과 정도인 변화 벡터를 입력받아 상기 잠재공간 상의 변화량을 산출하는 단계;상기 잠재공간 상의 상기 z로부터 상기 이미지를 생성하고, 상기 z에 상기 변화량을 반영하여 상기 변환된 이미지를 생성하는 단계; 및상기 이미지와 상기 변환된 이미지의 차이를 통해 상기 변화의 방향과 상기 정도를 산출하는 단계를 포함하는GAN 기반의 이미지 변환 방법."}
{"patent_id": "10-2022-0155170", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_15", "content": "제14항에 있어서,상기 변화량을 산출하는 단계에서는, 사전학습된 GAN을 이용하여 샘플(z)를 무작위로 추출하고, 학습할 변화의 수가 K개, 변화의 범위를 ε가 인 경우, 무작위로 1부터 K사이의 값()과 ε사이의 값()을 추출하고, 추출한 ()를 이용하여, 길이가 K이면서 번째 위치의 값이 1이고 나머지 위치의 값이 0인 one-hot 벡터를 구성하고, 이에 을 곱하여 특정 방향으로 주어진 만큼 이동하는 역할을 하는 상기 입력 벡터를 구성하고,상기 샘플 (z)에 대해 사전학습된 클래스 분류기를 이용하여 클래스를 얻고, 상기 입력 벡터와 상기 샘플 (z)에 대한 상기 클래스를 바탕으로, 디포메이터에 상기 입력 벡터를 곱하여, 글로벌한 변화벡터와 클래스별 변화 벡터를 포함하는 상기 변화 벡터를 추출하는 것을 특징으로 하는 GAN 기반의 이미지 변환 방법."}
{"patent_id": "10-2022-0155170", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "GAN 기반의 이미지 변환 장치는 잠재공간 상의 z로부터 생성한 생성적 대립 신경망(GAN) 기반의 이미지를 변환하 여 변환된 이미지를 생성한다. 상기 GAN 기반의 이미지 변환 장치는 상기 이미지의 상기 변환된 이미지로의 변화 의 방향과 정도를 입력받아 상기 잠재공간 상의 변화량을 산출하는 디포메이터, 상기 잠재공간 상의 상기 z로부 터 상기 이미지를 생성하고, 상기 z에 상기 변화량을 반영하여 상기 변환된 이미지를 생성하는 제너레이터, 및 상기 이미지와 상기 변환된 이미지의 차이를 통해 상기 변화의 방향과 상기 정도를 산출하는 리그레서를 포함한 다."}
{"patent_id": "10-2022-0155170", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 생성적 대립 신경망(GAN) 기반의 이미지 변환 장치 및 GAN 기반의 이미지 변환 방법에 관한 것이다."}
{"patent_id": "10-2022-0155170", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "모바일 관련 기술의 발전으로 인해, 카메라, 인터넷, 디스플레이 등과 같은 다양한 기능이 구현된 모바일 기기 가 개발되어 사람들의 필수품으로 사용되고 있다. 이러한 모바일 기기는 일상 생활을 누리기 위해 다양하게 활 용된다. 가장 대표적으로, 모바일 기기는 사진 관련 기능을 수행하기 위해 활용된다. 예를 들어, 모바일 기기는 간편하 게 사진을 촬영하고, 자신의 SNS(Social network system) 계정에 사진을 업로드하는데 사용될 수 있으며, 간단 하게 휴대폰 어플리케이션을 활용하여, 촬영한 사진을 원하는대로 수정하는 이미지 변환 및 합성 기술들이 등장 하고 있다. 생성적 대립 신경망(GAN)은 최근 각광을 받고 있는 이미지 생성 알고리듬으로, 게임이론에서의 최소극대화 알고 리듬을 딥러닝 기반의 이미지 생성 알고리듬과 접목시킨 알고리듬이다. 이를 통해 기존의 이미지 생성 알고리듬 과 비교하여 선명하고 좋은 품질의 이미지를 생성해낼 수 있게 되었다. 이에 따라 GAN을 이용한 많은 연구가 진행되었는데, 이 중 GAN의 잠재공간의 특성을 파악하려고 시도하는 연구 들이 진행되고 있다. 선행기술문헌 특허문헌 (특허문헌 0001) 미국 공개 특허 공보 2021-0073630"}
{"patent_id": "10-2022-0155170", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "이에 본 발명의 기술적 과제는 이러한 점에서 착안된 것으로, 본 발명의 목적은 GAN 기반의 이미지 변환 장치를 제공하는 것이다. 본 발명의 다른 목적은 GAN 기반의 이미지 변환 방법을 제공하는 것이다."}
{"patent_id": "10-2022-0155170", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "상기한 본 발명의 목적을 실현하기 위한 일 실시예에 따른 GAN 기반의 이미지 변환 장치는 잠재공간 상의 z로부 터 생성한 생성적 대립 신경망(GAN) 기반의 이미지를 변환하여 변환된 이미지를 생성한다. 상기 GAN 기반의 이 미지 변환 장치는 상기 이미지의 상기 변환된 이미지로의 변화의 방향과 정도를 입력받아 상기 잠재공간 상의 변화량을 산출하는 디포메이터, 상기 잠재공간 상의 상기 z로부터 상기 이미지를 생성하고, 상기 z에 상기 변화 량을 반영하여 상기 변환된 이미지를 생성하는 제너레이터, 및 상기 이미지와 상기 변환된 이미지의 차이를 통 해 상기 변화의 방향과 상기 정도를 산출하는 리그레서를 포함한다. 본 발명의 일 실시예에 있어서, 상기 디포메이터는 상기 GAN 기반의 이미지 변환 장치가 학습하는 데이터의 총 클래스의 수 + 1개의 선형 레이어로, 상기 데이터의 글로벌한 변화에 대한 요소인 A와 각 클래스별 변화에 대한 요소인 C1, C1, C2, …, CN(여기서 n은 상기 총 클래스의 수)를 포함할 수 있다. 본 발명의 일 실시예에 있어서, 상기 GAN 기반의 이미지 변환 장치는 사전학습된 GAN을 이용하여 샘플(z)를 무 작위로 추출하고, 학습할 변화의 수가 K개, 변화의 범위를 ε가 인 경우, 무작위로 1부터 K사이의 값( )과 ε사 이의 값( )을 추출하고, 추출한 ( )를 이용하여, 길이가 K이면서 번째 위치의 값이 1이고 나머지 위치의 값이 0인 one-hot 벡터를 구성하고, 이에 을 곱하여 특정 방향으로 주어진 만큼 이동하는 역할을 하는 상기 디포메 이터(D)의 입력 벡터를 구성하고, 상기 샘플 (z)에 대해 사전학습된 클래스 분류기를 이용하여 클래스를 얻고, 상기 입력 벡터와 상기 샘플 (z)에 대한 상기 클래스를 바탕으로, 상기 디포메이터에 상기 입력 벡터를 곱하여, 글로벌한 변화벡터와 클래스별 변화 벡터를 추출할 수 있다. 본 발명의 일 실시예에 있어서, 상기 글로벌 레이어와 각 클래스별 레이어에서 학습되는 특성들끼리는 각각의 레이어 내에서 직교분해를 하고, 상기 글로벌 레이어와 상기 클래스별 레이어에서 학습되는 특성들을 분할하기 위해, 직교사영을 통해 각 클래스 레이어에서 글로벌 레이어의 성분을 제거할 수 있다. 본 발명의 일 실시예에 있어서, 상기 클래스 분류기는 손실함수로 서로 다른 클래스끼리 멀어지게 하는 Cross- entropy를 사용할 수 있다. 본 발명의 일 실시예에 있어서, 상기 GAN 기반의 이미지 변환 장치를 학습하기 위해서, 상기 제너레이터는 사전 학습된 GAN 모델을 사용하고, 학습 데이터들의 글로벌한 특성과 각 클래스별 특성을 서로 분리하여 학습할 수 있다. 본 발명의 일 실시예에 있어서, 상기 글로벌한 특성을 학습할 때에는, 다음의 수학식 1과 같은 선형 레이어를 이용하고,"}
{"patent_id": "10-2022-0155170", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 2, "content": "[수학식1] 상기 각 클래스별 특성을 학습할 때에는, 다음의 수학식 2와 같은 선형 레이어를 이용할 수 있다."}
{"patent_id": "10-2022-0155170", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 3, "content": "[수학식 2] 본 발명의 일 실시예에 있어서, 상기 리그레서를 학습하는 데에는 다음 수학식 3의 선형 레이어와 수학식 4를 이용할 수 있다."}
{"patent_id": "10-2022-0155170", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 4, "content": "[수학식 3]"}
{"patent_id": "10-2022-0155170", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 5, "content": "[수학식 4] 상기한 본 발명의 목적을 실현하기 위한 일 실시예에 따른 GAN 기반의 이미지 변환 방법은 이미지를 생성하는 생성적 대립 신경망(GAN)을 사전 학습하는 단계; 학습 데이터에 공통적으로 나타나는 글로벌한 특성을 반영하기 위한 글로벌 레이어와, 상기 학습 데이터의 각 클래스 별로 나타나는 특성을 반영하기 위한 각 클래스별 레이어 를 선언하는 글로벌 레이어와 클래스별 레이어 선언 단계; 상기 학습 데이터의 클래스를 분류하는 사전 학습된 클래스 분류기를 준비하는 단계; 상기 각 클래스별로 다른 특성들을 학습하기 위하여, 학습된 변화로부터 생성 한 이미지를 받아서 변화의 방향(k)과 변화크기(ε)를 예측하는 모델을 각 클래스에 대해 선언하는 클래스 별 시프트 예측기(Shift Predictor)를 선언하는 단계; 잠재공간 상의 샘플(z)의 이동과 생성된 이미지 상의 변화의 방향과 변화크기의 관계를 학습하는 변화의 방향 학습 단계; 및 상기 시프트 예측기를 이용하여, 생성될 이미지 에 원하는 정도의 변화의 방향과 변화크기에 대응되는 상기 잠재공간상의 이동을 산출하여, 상기 생성될 이미지 를 원하는 정도의 변화의 방향과 변화크기로 변환한 변환 이미지를 생성하는 이미지 변환 단계를 포함할 수 있 다. 본 발명의 일 실시예에 있어서, 상기 변화의 방향 학습 단계는, 사전학습된 GAN을 이용하여 샘플(z)를 무작위로 추출하고, 학습할 변화의 수가 K개, 변화의 범위를 ε가 인 경우, 무작위로 1부터 K사이의 값( )과 ε사이의 값 ( )을 추출하고, 추출한 ( )를 이용하여, 길이가 K이면서 번째 위치의 값이 1이고 나머지 위치의 값이 0인 one-hot 벡터를 구성하고, 이에 을 곱하여 특정 방향으로 주어진 만큼 이동하는 역할을 하는 상기 디포메이터 (D)의 입력 벡터를 구성하고, 상기 샘플 (z)에 대해 상기 사전학습된 클래스 분류기를 이용하여 클래스를 얻고, 상기 입력 벡터와 상기 샘플 (z)에 대한 상기 클래스를 바탕으로, 상기 디포메이터에 상기 입력 벡터를 곱하여, 글로벌한 변화벡터와 클래스별 변화 벡터를 추출할 수 있다. 본 발명의 일 실시예에 있어서, 상기 학습 데이터들의 글로벌한 특성과 각 클래스별 특성을 서로 분리하여 학습 할 수 있다. 상기 글로벌한 특성을 학습할 때에는, 다음의 수학식 1과 같은 선형 레이어를 이용할 수 있다."}
{"patent_id": "10-2022-0155170", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 6, "content": "[수학식1] 상기 각 클래스별 특성을 학습할 때에는, 다음의 수학식 2와 같은 선형 레이어를 이용할 수 있다."}
{"patent_id": "10-2022-0155170", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 7, "content": "[수학식 2] 본 발명의 일 실시예에 있어서, 상기 시프트 예측기를 학습하는 데에는 다음 수학식 3의 선형 레이어와 수학식 4를 이용할 수 있다. [수학식 3]"}
{"patent_id": "10-2022-0155170", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 8, "content": "[수학식 4] 본 발명의 일 실시예에 있어서, 상기 글로벌 레이어와 클래스별 레이어 선언 단계에서는, 상기 글로벌 레이어와 상기 클래스별 레이어는 상기 학습 데이터의 총 클래스의 수 + 1개의 선형 레이어로, 상기 데이터의 글로벌한 변화에 대한 요소인 상기 글로벌 레이어(A)와 각 클래스별 변화에 대한 요소인 상기 클래스별 레이어(C1, C1, C2, …, CN)(여기서 n은 상기 총 클래스의 수)일 수 있다. 상기한 본 발명의 목적을 실현하기 위한 일 실시예에 따른 GAN 기반의 이미지 변환 방법은 잠재공간 상의 z로부 터 생성한 생성적 대립 신경망(GAN) 기반의 이미지를 변환하여 변환된 이미지를 생성한다. 상기 GAN 기반의 이 미지 변환 방법은 상기 이미지의 상기 변환된 이미지로의 변화의 방향과 정도인 변화 벡터를 입력받아 상기 잠 재공간 상의 변화량을 산출하는 단계, 상기 잠재공간 상의 상기 z로부터 상기 이미지를 생성하고, 상기 z에 상 기 변화량을 반영하여 상기 변환된 이미지를 생성하는 단계, 및 상기 이미지와 상기 변환된 이미지의 차이를 통 해 상기 변화의 방향과 상기 정도를 산출하는 단계를 포함한다. 본 발명의 일 실시예에 있어서, 상기 변화량을 산출하는 단계에서는, 사전학습된 GAN을 이용하여 샘플(z)를 무 작위로 추출할 수 있다. 학습할 변화의 수가 K개, 변화의 범위를 ε가 인 경우, 무작위로 1부터 K사이의 값( ) 과 ε사이의 값( )을 추출하고, 추출한 ( )를 이용하여, 길이가 K이면서 번째 위치의 값이 1이고 나머지 위치 의 값이 0인 one-hot 벡터를 구성하고, 이에 을 곱하여 특정 방향으로 주어진 만큼 이동하는 역할을 하는 상기 입력 벡터를 구성하고, 상기 샘플 (z)에 대해 사전학습된 클래스 분류기를 이용하여 클래스를 얻고, 상기 입력 벡터와 상기 샘플 (z)에 대한 상기 클래스를 바탕으로, 상기 디포메이터에 상기 입력 벡터를 곱하여, 글로벌한 변화벡터와 클래스별 변화 벡터를 포함하는 상기 변화 벡터를 추출할 수 있다."}
{"patent_id": "10-2022-0155170", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명의 실시예들에 따르면, GAN 기반의 이미지 변환 장치는 비지도학습 기반으로 학습되며, 잠재공간 상의 z 에 의해 생성되는 이미지에 대해 원하는 방향의 변화와 정도를 예측하여, 잠재공간 상의 z의 위치를 이동함으로 써, 원하는 방향의 변화와 정도가 반영된 변환된 이미지를 생성할 수 있다."}
{"patent_id": "10-2022-0155170", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 2, "content": "다만, 본 발명의 효과는 상기 효과들로 한정되는 것이 아니며, 본 발명의 사상 및 영역으로부터 벗어나지 않는 범위에서 다양하게 확장될 수 있을 것이다."}
{"patent_id": "10-2022-0155170", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하, 도면들을 참조하여 본 발명의 바람직한 실시예들을 보다 상세하게 설명하기로 한다. 본 발명은 다양한 변경을 가할 수 있고 여러 가지 형태를 가질 수 있는 바, 특정 실시예들을 도면에 예시하고 본문에 상세하게 설명하고자 한다. 그러나, 이는 본 발명을 특정한 개시 형태에 대해 한정하려는 것이 아니며, 본 발명의 사상 및 기술 범위에 포함되는 모든 변경, 균등물 내지 대체물을 포함하는 것으로 이해되어야 한다. 또한, 본 명세서에서 사용한 용어는 실시예를 설명하기 위해 사용된 것으로, 개시된 발명을 제한 및/또는 한정 하려는 의도가 아니다. 단수의 표현은 문맥상 명백하게 다르게 뜻하지 않는 한, 복수의 표현을 포함한다. 본 명 세서에서, \"포함하다\" 또는 \"가지다\" 등의 용어는 명세서상에 기재된 특징, 숫자, 단계, 동작, 구성요소, 부품또는 이들을 조합한 것이 존재함을 지정하려는 것이지, 하나 또는 그 이상의 다른 특징들이나 숫자, 단계, 동작, 구성요소, 부품 또는 이들을 조합한 것들의 존재 또는 부가 가능성을 미리 배제하지 않는다. 또한, 제1, 제2 등의 용어는 다양한 구성요소들을 설명하는데 사용될 수 있지만, 상기 구성요소들은 상기 용어 들에 의해 한정되어서는 안 된다. 상기 용어들은 하나의 구성요소를 다른 구성요소로부터 구별하는 목적으로만 사용된다. 예를 들어, 본 발명의 권리 범위를 벗어나지 않으면서 제1 구성요소는 제2 구성요소로 명명될 수 있 고, 유사하게 제2 구성요소도 제1 구성요소로 명명될 수 있다. \"및/또는\" 이라는 용어는 복수의 관련된 기재된 항목들의 조합 또는 복수의 관련된 기재된 항목들 중의 어느 항목을 포함한다. 도 1은 본 발명의 일 실시예에 따른 GAN 기반의 이미지 변환 장치의 아키텍처를 나타낸 도면이다. 도 1을 참조하면, 상기 GAN 기반의 이미지 변환 장치는 주어진 샘플의 잠재공간상에서의 움직임이 이미지 상에 어떤 의미론적인 변화를 주는지, 구체적으로는, 주어진 샘플의 클래스에 따라 다르게 학습되는 의미론적인 변화 의 방향과, 모든 샘플에 대하여 공통적으로 학습되는 의미론적인 변화의 방향을 학습할 수 있다. 이를 통해, 상 기 GAN 기반의 이미지 변환 장치는 주어진 이미지를 원하는 클래스에 대해 원하는 방향으로 변화시킬 수 있다. 즉, 본 발명의 실시예에 따른, 상기 GAN 기반의 이미지 변환 장치는 잠재공간 상의 z에 의해 생성되는 이미지에 대해 원하는 방향의 변화와 정도를 예측하여, 잠재공간 상의 z의 위치를 이동함으로써, 원하는 방향의 변화와 정도가 반영된 변환된 이미지를 생성할 수 있다. 이하, 상기 GAN 기반의 이미지 변환 장치의 아키텍처와 각 구성의 기능, 학습 모델을 설명한다. 상기 GAN 기반 의 이미지 변환 장치는 디포메이터(deformator; D), 제너레이터(generator; G), 리그레서(regressor; R)를 포 함할 수 있다. 상기 디포메이터(D)는 선형 레이어로, 총 클래스의 수 + 1개만큼 정의한다. 이때, 선형 레이어의 열 벡터는 사 전 학습된 GAN의 잠재공간 상에서의 의미론적인 변화 벡터를 의미한다. 즉 디포메이터(D)의 A는 글로벌한 변화 에 대한 요소이며, C1, C1, C2, …, CN은 각 클래스별 변화에 대한 요소이다. 상기 디포메이터(D)를 학습하기 위해, 사전학습된 GAN 을 이용하여, 샘플(z)을 무작위로 추출한다. 상기 디포메 이터(D)의 각 레이어에서 학습할 변화의 수가 K개로 주어지고, 변화의 범위가 ε으로 주어진 경우, 무작위로 1 부터 K사이의 값( )과 ε사이의 값( )을 추출한다. 그리고 추출한 ( )를 이용하여, 길이가 K이면서 번째 위치의 값이 1이고 나머지 위치의 값이 0인 one-hot 벡터 를 구성하고, 이에 을 곱하여 특정 방향으로 주어진 만큼 이동하는 역할을 하는 상기 디포메이터(D)의 입력 벡 터를 구성한다. 그리고 주어진 샘플 (z)에 대한 클래스(분류)를 얻기 위해서는, 사전 학습된 GAN에서 사용된 학습 데이터의 사 전 학습된 클래스 분류기를 이용한다. 그리고 샘플 (z)를 GAN의 제너레이터(G)에 통과시켜 이미지를 생성한 후 사전학습 된 클래스 분류기를 통과시켜 해당 샘플의 클래스를 얻는다. 이를 통해, 입력 벡터와 샘플 (z)에 대한 클래스가 주어졌을 때, 글로벌한 변화를 학습하는 선형 레이어(디포메 이터의 A)와 클래스별 변화를 학습하는 선형 레이어(디포메이터의 C1, C1, C2, …, CN)에 입력 벡터를 곱하여, 글로벌한 변화벡터와 클래스별 변화 벡터를 추출한다. 상기 변화 벡터를 통해 주어진 샘플을 이동시켜 GAN의 상기 제너레이터(G)를 통과시키면 해당 변화 벡터가 학습 한 특성에 맞게 변화된 이미지가 생성이 되는데(도면 상의 '샘플 z를 변화 벡터를 통해 이동 후, 생성된 이미지), 이 이미지를 주어진 샘플을 통해 획득한 이미지(도면 상의 '샘플 z로부터 형성된 이미지')와 함께 상 기 리그레서(R)를 통과시켜, 주어진 샘플로 생성한 이미지와, 변화 벡터를 통해 변화된 이미지의 차이를 통해 어떠한 특성이 바뀌었는지( )와 어느 정도의 변화( )가 발생했는지를 예측한다. 이를 통해, 상기 GAN 기반의 이미지 변환 장치는 미리 학습된 GAN에서 주어진 샘플의 잠재공간 상에서의 움직임 이 이미지 상에 어떤 의미론적인 변화를 주는지, 구체적으로는, 주어진 샘플의 클래스에 따라 다르게 학습되는 의미론적인 변화의 방향과, 모든 샘플에 대하여 공통적으로 학습되는 의미론적인 변화의 방향을 학습한다. 따라 서, 본 발명의 실시예는, 종래의 비지도 학습 기반의 알고리듬에 비해서, 사전 학습된 GAN의 데이터의 특성을 충분히 고려한 변화의 방향을 학습할 수 있다. 즉, 본 발명의 실시예에서는, 사전학습된 GAN에서 사용된 학습 데이터에서의 클래스의 수가 주어졌을 때, 각 클래스의 데이터가 가지고 있는 고유한 성질들과, 모든 클래스에서 공통적으로 나타나는 성질들을 분리하여 학습한다. 한편, 상기 제너레이터(G)는 미리 학습된 GAN의 제너레이터(생성기)에 해당한다. 예를 들면, 필요로 하는 데이 터 세트에 대응되는 Spectral-Norm(SNGAN), BigGAN, Progressive GAN (ProgGAN) 등의 사전 학습된 모델이 사용 될 수 있다. 여기서, SNGAN에서 학습된 데이터 세트는 MNIST, BigGAN에서 학습된 데이터는 ImageNet, ProgGAN 에서 학습된 데이터 세트는 CelebA-HQ 데이터셋이 대응될 수 있다. 도 2는 본 발명의 본 발명의 일 실시예에 따른 GAN 기반의 이미지 변환 방법을 나타낸 순서도이다. 도 2를 참조하면, 상기 GAN 기반의 이미지 변환 방법은 GAN을 사전 학습하는 단계(S100), 글로벌 레이어와 클래 스별 레이어 선언 단계(S200), 사전 학습된 클래스 분류기 준비하는 단계(S300), 클래스 별 Shift Predictor 선 언하는 단계(S400), 변화의 방향 학습 단계(S400) 및 이미지 변환 단계(S500)를 포함한다. 상기 GAN을 사전 학습하는 단계(S100)에서는, 영상을 생성하는 GAN을 사전 학습시켜, 학습이 완료된 GAN 모델을 준비할 수 있다. 예를 들면, 다양한 데이터셋에 대응하여, 대표적인 GAN인 Spectral-Norm(SNGAN), BigGAN, Progressive GAN (ProgGAN)에 대해 사전 학습된 모델을 준비할 수 있다. 여기서, SNGAN에서 학습된 데이터는 MNIST, BigGAN에서 학습된 데이터는 ImageNet, ProgGAN에서 학습된 데이터는 CelebA-HQ 데이터셋이다. 상기 GAN 모델들의 학습은 기존의 종래 알려진 다양한 방법을 이용하여 진행될 수 있으며, 데이터셋에 따라 알려진 다양한 GAN 모델이 활용될 수 있다. 상기 글로벌 레이어와 클래스별 레이어 선언 단계(S200)에서는, 잠재공간 상의 의미론적 변화를 찾기 위해, 학 습 데이터에 공통적으로 나타나는 글로벌한 특성을 반영하기 위한 글로벌 레이어와, 상기 학습 데이터의 각 클 래스 별로 나타나는 특성을 반영하기 위한 각 클래스별 레이어를 선언할 수 있다. 구체적으로, 상기 GAN을 통해 학습된 데이터 내에서, 공통적으로 학습되는 특성들을 학습하기 위한 글로벌 레이 어와, 학습 데이터의 클래스간의 다르게 나타나는 클래스별 레이어를 선언한다. 이 때, 상기 글로벌 레이어(디 포메이터의 A)와 상기 클래스별 레이어(디포메이터의 C1, C1, C2, …, CN)는 z의 차원과 각 레이어에서 학습하는 변화의 개수 K에 의해, dim(z) × K 의 행렬로 정의된다. 디포메이터(D)의 입력으로 주어진 벡터와, 상기 글로벌 레이어와 각 클래스별 레이어의 행렬곱을 통해 z의 차원 상의 벡터를 얻고, 최종적으로 이 벡터는 주어진 샘플의 특성을 변화시키는 벡터(A(εek),Ck(εek))이다. 이때, 상기 글로벌 레이어와 각 클래스별 레이어에서 학습되는 특성들끼리는 서로 직교해야 하므로 각각의 레이 어 내에서 직교분해를 하고, 상기 글로벌 레이어와 상기 클래스별 레이어에서 학습되는 특성들을 분할하기 위해, 직교사영을 통해 클래스 레이어에서 글로벌 레이어의 성분을 제거하는 작업을 진행한다. 상기 사전 학습된 클래스 분류기 준비하는 단계(S300)에서는, 클래스별 레이어를 학습하기 위해서는 주어진 샘 플의 클래스를 미리 알아야 하므로, 사전 학습된 GAN의 학습 데이터들을 가져와서, 데이터별로 클래스 분류기를 미리 학습한다. 상기 클래스 별 시프트 예측기(Shift Predictor)를 선언하는 단계(S400)에서는, 각 클래스별로 다른 특성들을 학습하기 위하여, 학습된 변화로부터 생성한 이미지를 받아서 방향(k)과 변화크기(ε)를 예측하는 모델을 각 클 래스에 대해 선언한다. 이 때, Shift Predictor는 LeNet, ResNet과 같은 CNN 기반 모델이고, Shift predictor의 입력의 차원은 H ×W ×2C로, 두 이미지를 채널축으로 이어 붙인 데이터이다. 상기 변화의 방향 학습 단계(S400)에서는, 잠재공간 상의 이동이 이미지 상의 어떠한 변화를 주는지 학습한다. 먼저, 사전학습된 GAN 위에서의 샘플(z)을 무작위로 추출한다. 여기서, 학습할 변화의 수가 K개, 변화의 범위가 ε으로 주어졌을 때, 무작위로 1부터 K사이의 값(k)과 ε 사이의 값(ε)을 추출한다. 그리고 추출한 k를 이용하 여, 길이가 K이면서 k번째 위치의 값이 1이고 나머지 위치의 값이 0인 one-hot 벡터를 구성하고, 이에 ε을 곱 하여 특정 방향으로 주어진 만큼 이동하는 역할을 하는 디포메이터(D)의 입력 벡터를 구성한다. 최종적으로 주어진 모델이 학습할 디포메이터(D)에는 글로벌 레이어(A)와 클래스별 레이어(C1, C1, C2, …, CN) 가 존재하고, 글로벌 레이어(A)에서는 학습 데이터상에 나타나는 공통적인 변화를 학습한다. 예를 들어, CelebA 데이터셋에 대해 사전학습된 GAN이 주어졌을 때, CelebA 데이터셋이 남성과 여성이라는 클래스로 분리되는 경우 를 생각해본다. 이 때, 글로벌 레이어에서는 머리 길이의 변화, 키(신장)의 변화, 체격의 변화 등, 남성과 여성에게서 공통적으로 나타나는 변화들을 학습한다. 그리고 남성에 대한 클래스 레이어는 수염의 길이처럼 남성에 서만 나타나는 변화를 학습하고, 여성에 대한 클레스 레이어는 색조 화장의 진한 정도와 같이 여성에서만 나타 나는 변화를 학습한다. 샘플 (z)를 GAN의 제너레이터(G)에 통과시켜, 이미지를 만든 후, 사전학습된 클래스 분류기를 통해 샘플 (z)에 대한 클래스를 구할 수 있다. 상기 디포메이터(D)의 입력 벡터와 샘플 (z)에 대한 클래스가 주어졌을 때, 글로벌한 변화를 학습하는 선형 레 이어와 클래스별 변화를 학습하는 선형 레이어에 입력 벡터를 곱하여, 글로벌한 변화벡터와 클래스별 변화벡터 를 추출한다. 글로벌한 변화벡터(A(εek))와 클래스에 해당하는 변화벡터(Ck(εek))를 통해 샘플 (z)를 이동시키고, 이들을 생성자에 통과시켜 이미지를 구성한다. 글로벌한 변화를 예측하는 Shift predictor와 샘플별 변화를 예측하는 Shift predictor에 각각 원본 이미지와 해당 변화에 따라 변형된 이미지들을 통과시켜 어떤 특성이 바뀌었는지(k)와 어느 정도의 변화(ε)가 발생했는 지를 예측한다. 다른 클래스간에 학습되는 특성과, 각 클래스 레이어와 글로벌 레이어에서 학습하는 특성들을 서로 다르게 하기 위해, 각각의 shift predictor로 추출한 방향에 대한 정보를 모두 이어 붙여서 학습한다. 한편, 주어진 모델이서 클래스 분류기를 학습할 때, 손실함수로 Cross-entropy를 사용하는데, 이 함수는 서로 다른 클래스끼리 멀어지게 하는 역할을 한다. 따라서, 이 특성을 이용하여 글로벌 레이어와 클래스별 레이어에서 학습하는 특성들을 서로 분리할 수 있다. 이때, 글로벌한 특성과 클래스간의 특성을 서로 분리하여 학습하기 때문에 글로벌 특성에 대한 레이블과 클래스 특성에 대한 레이블을 아래와 같이 정의한다. 상기 레이블을 정의할 때에는 글로벌한 정보를 첫 번째로 하고, 그 뒤에 각 클래스에 대한 값을 차례대로 쌓는 데, 글로벌한 레이어를 학습할 때에는 각 클래스에 대한 값은 0으로 둔다."}
{"patent_id": "10-2022-0155170", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "[수학식1] 또한, 클래스별 레이어를 학습할 때는 해당 클래스의 값만 남겨두고, 글로벌 레이어의 정보와 나머지 클래스에 대한 값을 0으로 둔다."}
{"patent_id": "10-2022-0155170", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "[수학식 2] 학습을 반복하여, 하기 수학식3, 4에 의해 shift predictor를 학습시킨다."}
{"patent_id": "10-2022-0155170", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "[수학식 3]"}
{"patent_id": "10-2022-0155170", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 5, "content": "[수학식 4] 상기 이미지 변환 단계(S500)에서는, 학습된 상기 shift predictor(리그레서(R)), 및 디포메이터, 사전학습된 GAN 모델에 의해, 각 클래스별, 또는 글로벌한 원하는 방향의 변화를 예측하여, 샘플 이미지로부터 원하는 방향 으로 원하는 정도 변화된 이미지로의 변환이 가능하다. 즉, 학습된 상기 GAN 기반의 이미지 변환 장치는 잠재공간 상에서 유의미한 변화의 방향(k)과 변화의 정도(ε) 의 의미를 학습하였으므로, 특정 이미지로부터 변화의 방향(k)과 변화의 정도(ε)를 지정하여, 상기 특정 이미 지를 원하는 방향과 정도로 변환할 수 있다. 도 3의 (a) 및 (b)는 본 발명의 일 실시예에 따른 GAN 기반의 이미지 변환 장치에서, 클래스가 8 및 9에 대한 샘플의 학습된 변화 방향을 나타낸 도면이다. 도 3(a)를 참조하면, MNSIT 데이터셋에서 본 발명의 실시예에 의해 학습된 GAN 기반의 이미지 변환 장치가 클래 스 숫자 9에 대해, 0, 1, 2의 변화의 방향에 대해 변화의 정도별로 변화하여 생성한 이미지를 나타내고 있다. 예를 들면, 변화의 방향 k=0의 경우, 숫자 9의 원 부분의 크기가 작아지는 방향에 대한 변화 방향으로, 우측으 로 갈수록 변화의 정도가 커지는 것을 확인할 수 있다. 도 3(b)를 참조하면, MNSIT 데이터셋에서 본 발명의 실시예에 의해 학습된 GAN 기반의 이미지 변환 장치가 클래 스 숫자 8에 대해, 0, 1, 2의 변화의 방향에 대해 변화의 정도별로 변화하여 생성한 이미지를 나타내고 있다. 예를 들면, 변화의 방향 k=1의 경우, 숫자 8의 두 원 부분이 서로 벌어지는 변화 방향으로, 우측으로 갈수록 변 화의 정도가 커지는 것을 확인할 수 있다. 본 발명의 실시예에 따르면, GAN 기반의 이미지 변환 장치는 비지도학습 기반으로 학습되며, 잠재공간 상의 z에 의해 생성되는 이미지에 대해 원하는 방향의 변화와 정도를 예측하여, 잠재공간 상의 z의 위치를 이동함으로써, 원하는 방향의 변화와 정도가 반영된 변환된 이미지를 생성할 수 있다. 이상 실시예를 참조하여 설명하였지만, 해당 기술 분야의 숙련된 당업자는 하기의 특허 청구의 범위에 기재된 본 발명의 사상 및 영역으로부터 벗어나지 않는 범위 내에서 본 발명을 다양하게 수정 및 변경시킬 수 있음을 이해할 수 있을 것이다."}
{"patent_id": "10-2022-0155170", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 일 실시예에 따른 GAN 기반의 이미지 변환 장치의 아키텍처를 나타낸 도면이다. 도 2는 본 발명의 본 발명의 일 실시예에 따른 GAN 기반의 이미지 변환 방법을 나타낸 순서도이다. 도 3의 (a) 및 (b)는 본 발명의 일 실시예에 따른 GAN 기반의 이미지 변환 장치에서, 클래스가 8 및 9에 대한 샘플의 학습된 변화 방향을 나타낸 도면이다."}
