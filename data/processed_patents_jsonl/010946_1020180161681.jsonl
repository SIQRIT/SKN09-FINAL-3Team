{"patent_id": "10-2018-0161681", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2019-0075810", "출원번호": "10-2018-0161681", "발명의 명칭": "반도체 장치 및 그 회전 이상 검출 방법", "출원인": "르네사스 일렉트로닉스 가부시키가이샤", "발명자": "와타나베 히사아키"}}
{"patent_id": "10-2018-0161681", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "모터를 구동하는 구동 신호의 파형을 나타내는 구동 파형 신호를 생성하는 모터 구동 제어 회로와,상기 모터의 회전각을 계측하는 리졸버로부터 상기 모터의 회전각을 나타내는 회전각 신호를 취득하고, 상기 회전각 신호를 디지털값으로 변환하여 회전각 정보를 생성하는 리졸버 회전각 변환 회로와,상기 모터의 상(相)마다의 상기 회전각 정보를 각각 상기 모터의 1회전분의 각도 변화로 변환하여 회전각 시간변화 정보를 생성하는 모터 회전각 변환 회로와,상기 회전각 시간 변화 정보에 있어서의 회전각 시간 변화가 이상 검출 범위를 초과하고 있었던 경우에, 상기모터에 이상이 발생했다고 판단하는 판단 회로,를 가지는 반도체 장치."}
{"patent_id": "10-2018-0161681", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "청구항 1에 있어서,상기 리졸버 회전각 변환 회로는,취득한 상기 회전각 신호에 대한 추종성이 낮은 제1 필터 계수를 이용하여 제어용 회전각 정보를 생성하고, 상기 모터 구동 제어 회로에 상기 제어용 회전각 정보를 출력하는 제1 트래킹 루프 회로와,취득한 상기 회전각 정보에 대한 추종성이 높은 제2 필터 계수를 이용하여 이상 검출용 회전각 정보를생성하고, 상기 모터 회전각 변환 회로에 상기 이상 검출용 회전각 정보를 출력하는 제2 트래킹 루프 회로,를 가지는 반도체 장치."}
{"patent_id": "10-2018-0161681", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "청구항 1에 있어서,상기 리졸버 회전각 변환 회로와, 상기 모터 회전각 변환 회로 사이에 설치되는 메모리를 더 가지며, 상기 리졸버 회전각 변환 회로는, 상기 회전각 정보를 상기 메모리에 축적하고, 상기 모터 회전각 변환 회로는, 상기 메모리로부터 상기 회전각 정보를 판독하는 반도체 장치."}
{"patent_id": "10-2018-0161681", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "청구항 1에 있어서,상기 판단 회로는, 상기 모터가 가감속(加減速) 상태에 있는 경우, 상기 이상 검출 범위를 상기 모터의 회전 속도에 맞춰서 변화시키는 반도체 장치."}
{"patent_id": "10-2018-0161681", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "청구항 1에 있어서,상기 판단 회로는, 상기 회전각 시간 변화 정보의 값이 상기 이상 검출 범위를 초과한 횟수가, 일정 시간 내에소정의 횟수를 초과한 경우에 상기 모터에 이상이 발생했다고 판단하는 반도체 장치."}
{"patent_id": "10-2018-0161681", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "청구항 1에 있어서,상기 판단 회로는, 상기 회전각 시간 변화 정보에 있어서의 회전각값의 피크의 출현 주기로부터 상기 모터의 진동 주파수를 해석하여, 상기 진동 주파수가 상기 모터의 고유 진동 주파수 이외였을 경우에 상기 모터에 이상이공개특허 10-2019-0075810-2-발생했다고 판단하는 반도체 장치."}
{"patent_id": "10-2018-0161681", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "청구항 1에 있어서,상기 판단 회로는, 상기 모터의 회전 및 진동의 정상 상태 및 이상 상태에 관하여 미리 학습된 인공지능으로서,상기 회전각 시간 변화 정보를 상기 인공지능에 입력한 결과에 따라 상기 모터의 상태를 상기 모터 구동 제어회로에 통지하는 반도체 장치."}
{"patent_id": "10-2018-0161681", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "청구항 1에 있어서,상기 리졸버 회전각 변환 회로는, 상기 모터 구동 제어 회로와 동일한 반도체 칩 상에 형성되는 반도체 장치."}
{"patent_id": "10-2018-0161681", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "모터의 회전각을 계측하는 리졸버로부터 얻어지는 정보에 대하여 연산 장치에서 연산 처리를 실시함으로써 상기모터의 이상 회전을 검출하는 방법으로서,상기 모터의 회전각을 계측하는 리졸버로부터 상기 모터의 회전각을 나타내는 회전각 신호를 취득하고,상기 회전각 신호를 디지털값으로 변환하여 회전각 정보를 생성하고,상기 모터의 회전각으로부터 회전각 정보를 생성하고,상기 모터의 상마다의 상기 회전각 정보를 각각 상기 모터의 1회전분의 각도 변화로 변환하여 회전각 시간 변화정보를 생성하고,상기 회전각 시간 변화 정보에 있어서의 회전각 시간 변화가 이상 검출 범위를 초과하고 있었던 경우에, 상기모터에 이상이 발생했다고 판단하는 회전 이상 검출 방법."}
{"patent_id": "10-2018-0161681", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "[과제] 종래의 반도체 장치에서는, 모터의 회전 이상을 검출하기 위하여 별도로 진동 센서 등을 이용할 필요가 있었다. [해결수단] 일 실시형태에 의하면, 반도체 장치는, 모터의 회전각을 계측하는 리졸버로부터 얻어지 는 모터의 회전각을 나타내는 회전각 신호(SR)를 취득하고, 회전각 신호(SR)를 디지털값으로 변환하여 회전각 정 보(RDT)를 생성하는 리졸버 회전각 변환 회로와, 모터의 상마다의 회전각을 각각 모터의 각도 변 화로 변환하여 회전각 시간 변화 정보를 생성하는 모터 회전각 변환 회로와, 회전각 시간 변화 정보에 있어 서의 회전각 시간 변화의 변동 이상 검출 범위를 초과하고 있었던 경우에, 모터에 이상이 발생했다고 판단하는 판단 회로를 가진다."}
{"patent_id": "10-2018-0161681", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 반도체 장치 및 그 회전 이상(異常) 검출 방법에 관하여, 예를 들면 모터를 제어하는 반도체 장치 및 반도체 장치에 있어서의 모터의 회전 이상 검출 방법에 관한 것이다."}
{"patent_id": "10-2018-0161681", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "최근, 프로그램을 실행 가능한 연산 장치(예를 들면, MCU(Micro Controller Unit))를 이용하여 모터의 회전을 제어하는 구동 파형을 생성함과 아울러 모터의 회전 상태를 연산 장치로 취득하여, 모터의 회전을 최적으로 제 어하는 것이 행해지고 있다. 여기서, 모터는, 회전하는 기기이며, 고장(failure)에 의해 이 회전에 진동이 가해 지는 일이 있다. 모터의 진동은 그 후의 큰 고장으로 연결되는 가능성도 있어, 모터의 이상 진동을 검출하는 것 은 안전 설계상 중요한 것이다. 그래서 모터의 이상 진동의 검출 방법의 일례가 특허문헌 1에 개시되어 있다. 특허문헌 1에는, 전동 차량의 이상 검지 장치가 개시되어 있다. 이 이상 검지 장치는, 차륜을 구동하는 모터와, 모터와 일체로 설치되어, 모터의 회전을 감속해서 차륜에 전달하는 감속기를 가지는 모터·감속기 유닛을 구비 한다. 그리고 이 이상 검지 장치는, 진동 센서로 측정된 진동 정보의 특정 주파수 영역에 있어서의 값이 설정된 문턱(threshold)값보다 커졌을 때, 모터·감속기 유닛에 이상이 발생한 것 및 그 이상 발생 개소(箇所)를, 모터 인지 감속기인지를 구별하여 검출하는 이상 검출 수단이 설치된다. 선행기술문헌 특허문헌"}
{"patent_id": "10-2018-0161681", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 2, "content": "(특허문헌 0001) [특허문헌 1] 일본국 특개 2015-119525호 공보 발명의 내용"}
{"patent_id": "10-2018-0161681", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "그러나 특허문헌 1에 기재된 기술에서는, 모터·감속기 유닛에 이상이 발생한 것을 검출하기 위해 진동 센서를 이용할 필요가 있다는 문제가 있었다. 그 밖의 과제와 신규 특징은, 본 명세서의 기술(記述) 및 첨부도면으로부터 명백해질 것이다."}
{"patent_id": "10-2018-0161681", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "일 실시형태에 의하면, 반도체 장치는, 모터의 회전각을 계측하는 리졸버로부터 얻어지는 모터의 회전각을 나타 내는 회전각 신호를 취득하고, 회전각 신호를 디지털값으로 변환하여 회전각 정보를 생성하는 리졸버(resolver) 회전각 변환 회로와, 모터의 상(相)마다의 회전각을 각각 상기 모터의 각도 변화로 변환하여 회전각 시간 변화 정보를 생성하는 모터 회전각 변환 회로와, 회전각 시간 변화 정보에 있어서의 회전각 시간 변화의 변동 이상 검출 범위를 초과해 있었던 경우, 모터에 이상이 발생했다고 판단하는 판단 회로를 가진다."}
{"patent_id": "10-2018-0161681", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "상기 일 실시형태에 의하면, 진동 센서 등의 진동 검출을 위한 소자를 이용하는 일없이 모터의 이상 진동을 검 출할 수 있다."}
{"patent_id": "10-2018-0161681", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "설명의 명확화를 위해, 이하의 기재 및 도면은, 적절히, 생략, 및 간략화가 이루어져 있다. 또한, 여러 가지 처 리를 행하는 기능 블록으로서 도면에 기재되는 각 요소는, 하드웨어적으로는, CPU, 메모리, 그 밖의 회로로 구 성할 수 있고, 소프트웨어적으로는, 메모리에 로드된 프로그램 등에 의해 실현된다. 따라서, 이들 기능 블록이 하드웨어만, 소프트웨어만, 또는 그들의 조합에 의해 여러 가지 형태로 실현될 수 있는 것은 당업자에게는 이해 되는 바이며, 어느 하나로 한정되는 것은 아니다. 또한, 각 도면에서, 동일한 요소에는 동일한 부호가 부여되어 있고, 필요에 따라 중복 설명은 생략되어 있다. 또한, 상술한 프로그램은, 여러 가지 타입의 비일시적인 컴퓨터 판독 가능 매체(non-transitory computer readable medium)를 이용해서 저장되어, 컴퓨터에 공급할 수 있다. 비일시적인 컴퓨터 판독 가능 매체는, 여러가지 타입의 실체가 있는 기록 매체(tangible storage medium)를 포함한다. 비일시적인 컴퓨터 판독 가능 매체 의 예는, 자기 기록 매체(예를 들면 플랙시블 디스크, 자기 테이프, 하드 디스크 드라이브), 광자기 기록 매체 (예를 들면 광자기 디스크), CD-ROM(Read Only Memory) CD-R, CD-R/W, 반도체 메모리(예를 들면, 마스크 ROM, PROM(Programmable ROM), EPROM(Erasable PROM), 플래시 ROM, RAM(Random Access Memory))를 포함한다. 또한, 프로그램은, 여러 가지 타입의 일시적인 컴퓨터 판독 가능 매체(transitory computer readable medium)에 의해 컴퓨터에 공급되어도 된다. 일시적인 컴퓨터 판독 가능 매체의 예는, 전기 신호, 광 신호, 및 전자파를 포함한 다. 일시적인 컴퓨터 판독 가능 매체는, 전선 및 광파이버 등의 유선 통신로, 또는 무선 통신로를 통하여, 프로 그램을 컴퓨터에 공급할 수 있다. 실시형태 1 도 1에 실시형태 1에 따른 반도체 장치의 블록도를 나타낸다. 도 1에서는, 반도체 장치에 더하여, 반도체 장치가 제어 대상으로 하는 모터를 나타냈다. 또한, 도 1에서는, 모터를 제어하기 위해 필요하게 되는 반도체 장치의 외부(外付) 부품으로서 파워 모듈 회로, 전류 센서, 및 리졸버(예를 들면, 리 졸버 센서 회로)를 나타냈다. 실시형태 1에 따른 반도체 장치는, 모터를 구동하는 구동 신호의 신호 파형이 되는 구동 파형 신호를 출력한다. 이 구동 파형 신호는, 파워 모듈 회로에서 증폭되어 구동 신호가 되며, 파워 모듈 회로가 출력하는 구동 신호에 의해 모터가 회전한다. 전류 센서는, 모터를 구동하는 구동 신호로서 주 어지는 구동 전류의 크기를 계측하여, 전류 검출 신호(IDET)를 출력한다. 리졸버 센서 회로는, 리졸버 센 서 회로의 회전각을 계측하여, 모터의 회전각을 나타내는 회전각 신호(SR)를 출력한다. 반도체 장치는, 전류 검출 신호(IDET)와 회전각 신호(SR)에 근거하여 구동 파형 신호의 파형을 변화시킴으로써 모터의 회 전수를 제어한다. 실시형태 1에서는, 상기와 같은 모터 제어를 행하면서, 회전각 신호(SR)에 근거하는 모터의 회전 이상을 검출한다. 그래서 실시형태 1에 관하여 이하에서 상세하게 설명한다. 도 1에 나타내는 바와 같이, 실시형태 1에 따른 반도체 장치는, 모터 구동 제어 회로, 리졸버 회전각 변환 회로(예를 들면, RD컨버터), 메모리 , 모터 회전각 변환 회로, 판단 회로를 가진다. 또한, RD컨버터는 모터 구동 제어 회로에 있어서의 모터 제어에도 이용되는 것이다. 또한, 모터 구동 제어 회로는, 연산 처리 회로, 타이머, 출력 인터페이스 회로, 아날로그 디지털 변환기를 가진다. 모터 구동 제어 회로는, 모터를 구동하는 구동 신호의 파형을 나타내는 구동 파형 신호를 생성한다. 이 구동 파형 신호는, 연산 처리 회로, 타이머, 출력 인터페이스 회로에 의해 생성된다. 연산 처리 회로는, 모터를 제어하기 위한 프로그램을 실행한다. 이 프로그램은, 메모리에 저장되어 있어도 되고, 도시하지 않는 다른 메모리에 저장되어 있어도 된다. 연산 처리 회로는, 메모리로부터 프로그램을 로 드하여 실행한다. 타이머는, 연산 처리 회로로부터 지시에 근거하여 구동 파형 신호가 되는 PWM(Pulse Width Modulation) 신호를 생성한다. 출력 인터페이스 회로는, 타이머에서 생성된 PWM 신호를 구동 파형 신호 로서 파워 모듈 회로에 출력한다. 아날로그 디지털 변환기는, 아날로그 신호로서 주어지는 전류 검출 신호(IDET)의 전압 레벨에 따른 크기의 디지털값을 출력한다. 아날로그 디지털 변환기가 출력하는 신호는 피드백 신호(SFB)로서 연산 처리 회로에 주어진다. RD컨버터는, 모터의 회전각을 나타내는 회전각 신호(SR)(아날로그 신호)를 취득하고, 회전각 신호(S R)를 디지털값으로 변환하여 회전각 정보를 생성한다. 도 1에 나타내는 예에서는, RD컨버터는, 회전각 정보 로서 제어용 회전각 정보(RCONT)와 이상 검출용 회전각 정보(RDT)를 출력한다. 제어용 회전각 정보(RCONT)는, 연산 처리 회로에 주어져서 모터의 회전 제어에 이용된다. 이상 검출용 회전각 정보(RDT)는, 메모리에 일단 저장된다. 또한, 도 1에 나타내는 예에서는, RD컨버터는, 반도체 장치 내에 내장되지만, RD컨버터 는, 반도체 장치와는 상이한 반도체 칩 상에 형성되어 있어도 상관없다. 모터 회전각 변환 회로는, 모터의 상마다의 회전각을 각각 모터의 각도 변화로 변환하여 회전각 시간 변화 정보를 생성한다. 실시형태 1에 따른 모터 회전각 변환 회로에서는, 1개의 회전각 시간 변화 정보에 적 어도 모터의 1회전분의 회전각 정보를 포함하도록 모터 회전각 변환 회로는 회전각 시간 변화 정보를 생성한다. 판단 회로는, 회전각 시간 변화 정보에 있어서의 회전각 시간 변화가 이상 검출 범위를 초과하고 있었던 경 우, 모터에 이상이 발생했다고 판단한다. 판단 회로는, 모터에 이상이 발생하고 있는지 아닌지의 정보를 연산 처리 회로에 제공한다. 연산 처리 회로는, 판단 회로로부터 주어지는 정보가 모터 구 동 제어 회로의 이상을 나타내는 것인 경우, 모터의 회전수를 억제하는, 혹은, 정지시키는 등의 조치 를 취한다. 판단 회로에 있어서의 이상 판단 방법의 상세는 후술한다. 이어서, 실시형태 1에 따른 RD컨버터에 관하여 상세하게 설명한다. 도 2에 실시형태 1에 따른 RD컨버터(1 5)의 블록도를 나타낸다. 도 2에 나타내는 바와 같이, 실시형태 1에 따른 RD컨버터는, 입력 버퍼(21, 22), 아날로그 디지털 변환기, 제1 트래킹 루프 회로, 제2 트래킹 루프 회로를 가진다. 입력 버퍼는, 회전각 신호(SR) 중 SIN 성분이 차동(差動) 신호로서 입력되고, 이 SIN 성분의 회전각 신호 (SR)를 싱글 엔드(single-ended) 신호로서 출력한다. 입력 버퍼는, 회전각 신호(SR) 중 COS 성분이 차동신 호로서 입력되고, 이 COS 성분의 회전각 신호(SR)를 싱글 엔드 신호로서 출력한다. 아날로그 디지털 변환기는, 입력 버퍼(21, 22)로부터 출력되는 신호를 디지털값으로 변환하여 후단(後段)의 제1 트래킹 루프 회로 및 제2 트래킹 루프 회로에 출력한다. 제1 트래킹 루프 회로는, 회전각 신호 (SR)에 대한 추종성이 낮은 제1 필터 계수(예를 들면, 모터 제어용 컷오프 주파수 게인 FCG_CONT)를 이용하여 아날로그 디지털 변환기가 출력한 디지털값으로부터 제어용 회전각 정보(RCONT)를 생성한다. 이 제어용 회 전각 정보(RCONT)는, 모터 구동 제어 회로에 출력된다. 제2 트래킹 루프 회로는, 회전각 신호(SR)에 대 한 추종성이 높은 제2 필터 계수(예를 들면, 이상 검출용 컷오프 주파수 게인 FCG_DT)를 이용하여 아날로그 디 지털 변환기가 출력한 디지털값으로부터 이상 검출용 회전각 정보(RDT)를 생성한다. 이 이상 검출용 회전각 정보(RDT)는, 메모리를 통하여 모터 회전각 변환 회로에 출력된다. 여기서, 제어용 회전각 정보(RCONT)와 이상 검출용 회전각 정보(RDT)에 관하여 설명한다. 제어용 회전각 정보 (RCONT)는, 이상 검출용 회전각 정보(RDT)보다 게인이 낮은 제1 필터 계수에 의해 필터링된다. 그 때문에, 도 2 에 나타내는 바와 같이, 제어용 회전각 정보(RCONT)는, 이상 검출용 회전각 정보(RDT)에 비하여 파형의 변동이 적다. 다시 말해, 제어용 회전각 정보(RCONT)는, 노이즈 성분이 적고 모터의 회전 위치의 파악에 의해 적 합한 회전각의 시간 천이를 나타낸다. 한편, 이상 검출용 회전각 정보(RDT)는, 회전각 신호(SR)에 대한 추종성 이 높고 리졸버 센서 회로에 의해 검출되는 모터의 회전각의 변화를 더 반영한 것이 된다. 이와 같이, 실시형태 1에 따른 반도체 장치에서는, 모터 구동 제어 회로에 대해서는 노이즈 성분이 적고 이상(理想) 상태에 가까운 회전각의 시간 변화를 나타내는 제어용 회전각 정보(RCONT)를 제공한다. 이에 의해, 실시형태 1에 따른 반도체 장치에서는, 모터의 회전 제어의 정밀도를 향상시킨다. 한편, 실시형태 1에 따른 반도체 장치에서는, 모터 회전각 변환 회로에 대하여 회전각의 변동을 반영한 회전각의 시간 변화를 나 타내는 이상 검출용 회전각 정보(RDT)를 제공한다. 이에 의해, 실시형태 1에 따른 반도체 장치에서는, 모터 의 진동의 검출 정밀도를 향상시킬 수 있다. 여기서, 제1 트래킹 루프 회로 및 제2 트래킹 루프 회로에 관하여 더 상세하게 설명한다. 도 2에 나타 내는 바와 같이, 제1 트래킹 루프 회로는, 신호 합성 회로, 파형 처리 회로, PI제어 회로, 가 산기를 가진다. 제2 트래킹 루프 회로는, 신호 합성 회로, 파형 처리 회로, PI제어 회로, 가산기를 가진다. 제1 트래킹 루프 회로와 제2 트래킹 루프 회로는, 적용되는 컷오프 주파수 게인 이 다를 뿐이고, 회로 구성은 같다. 그래서 제1 트래킹 루프 회로를 예로 트래킹 루프 회로의 회로 구성을 설명한다. 신호 합성 회로는, 제1 트래킹 루프 회로의 출력이 되는 제어용 회전각 정보(RCONT)에 포함되는 회전각 의 SIN 성분 및 COS 성분과, 아날로그 디지털 변환기로부터 출력되는 회전각 신호(SR)의 SIN 성분 및 COS 성분에 곱셈 및 뺄셈 등의 처리를 하여 새로운 SIN 성분과 COS 성분을 생성한다. 파형 처리 회로는, 신호 합성 회로에서 합성된 SIN 성분과 COS 성분에 대하여 위상 제어 및 동기 검파 처리를 실시한다. PI제어 회 로는, 파형 처리 회로에서 처리된 SIN 성분과 COS 성분에 대하여, 모터 제어용 컷오프 주파수 게인 FCG_CONT에 비례한 가중치를 매기는 비례(Proportional) 처리와, 가중치가 매겨진 각 값을 적분하는 적분 (Integral) 처리를 행한다. 가산기는, PI제어 회로에서 처리된 SIN 성분과 COS 성분을 가산하여 제어용 회전각 정보(RCONT)를 생성한다. 또한, 가산기는, 가산 전의 SIN 성분과 COS 성분을 피드백 신호로서 신호 합성 회로에 출력한다. 이어서, 실시형태 1에 따른 모터 회전각 변환 회로에서 행해지는 처리에 관하여 설명한다. 우선, 리졸버 센 서 회로는, 모터가 1회전 하는 것보다 짧은 시간에 1회전분의 회전각 신호(SR)를 출력한다. 그리고 모터회전각 변환 회로는, 모터의 상마다의 회전각을 각각 모터의 1회전분의 각도 변화로 변환하여 회전각 시간 변화 정보를 생성한다. 더 구체적으로는, 모터 회전각 변환 회로는, 메모리에 축적된 이상 검출용 회전 각 정보(RDT)로부터, 모터의 1회전분에 상당하는 이상 검출용 회전각 정보(RDT)를 판독하고, 판독한 이상 검출용 회전각 정보(RDT)를 합성하여 회전각 시간 변화 정보를 생성한다. 그래서, 도 3에 실시형태 1에 따른 반 도체 장치의 모터 회전각 변환 회로에 있어서의 처리를 설명하는 도면을 나타낸다. 도 3에서는, 상측에 리졸버 센서 회로로부터 출력되는 회전각 신호(SR)로부터 생성되는 이상 검출용 회전 각 정보(RDT)를 나타내고, 하측에 모터 회전각 변환 회로에서 처리된 후의 회전각 시간 변화 정보를 나타냈 다. 이상 검출용 회전각 정보(RDT)는, 횡축을 시간, 종축을 리졸버 회전 각도로 하여 표시된다. 도 3에 나타내 는 예에서는, 3개의 이상 검출용 회전각 정보(RDT)에 의해 모터의 1회전분의 회전각 변화가 된다. 그래서 모터 회전각 변환 회로는, 3개의 이상 검출용 회전각 정보(RDT)를 합성하여 모터의 1회전분의 회전각 시간 변화 정보를 생성한다. 또한, 도 3에 나타내는 바와 같이, 리졸버 센서 회로에 의해 계측된 회전각 신호(SR)에 근거하여 생성되는 모터의 회전각의 파형(예를 들면, 회전 파형)은, 이상(理想) 모터 회전 파 형에 대하여 변동을 가진다. 이어서, 판단 회로에 있어서의 모터의 회전 이상의 유무의 판단에 관하여 설명한다. 그래서, 도 4에 실시형태 1에 따른 반도체 장치에서 검출되는 회전 이상이 발생했을 때의 회전각 시간 변화 정보의 시간 변화를 설명하는 도면을 나타낸다. 모터에 진동 등의 회전 이상이 발생하고 있었던 경우, 모터의 회전 속도가 불균일해진다. 그 때문에, 리졸버 센서 회로가 출력하는 회전각 신호(SR)로부터 생성되는 회전각 시간 변화 정보는, 회전 이상이 발 생하고 있지 않을 때에 비하여 이상 모터 회전 파형에 대한 변동이 커진다. 판단 회로에서는, 이상 모터 회 전 파형과 회전각 시간 변화 정보의 차분값이 미리 설정되는 이상 검출 범위 이상이 된 경우에 모터에 회 전 이상이 발생했다고 판단한다. 여기서, 이상 모터 회전 파형과 회전각 시간 변화 정보의 차분값의 산출 방법의 일례로서는, 제곱 평균을 산출 하여, 이 제곱 평균이 이상 검출 범위를 넘었는지 아닌지에 의해 회전 이상의 유무를 판단하는 방법을 생각할 수 있다. 또한, 이상 모터 회전 파형과 회전각 시간 변화 정보의 차분값의 산출 방법의 다른 예로서는, 이상 모 터 회전 파형에 대하여 소정의 범위를 가진 이상 검출 범위를 설정하여 회전각 시간 변화 정보의 값이 이상 검 출 범위를 초과하는 변화를 나타낸 것을 검출하는 방법을 생각할 수 있다. 상기 설명으로부터, 실시형태 1에 따른 반도체 장치는, 리졸버 센서 회로로부터 출력되는 회전각 신호 (SR)로부터 모터의 1회전분의 회전각 시간 변화 정보를 생성한다. 그리고 실시형태 1에 따른 반도체 장치 는, 이 회전각 시간 변화 정보와 이상 모터 회전 파형의 차분값이 이상 검출 범위를 초과한 것에 따라 모터 의 회전 이상을 검출한다. 이에 의해, 실시형태 1에 따른 반도체 장치는, 진동 센서 등을 이용하는 일 없이 모터의 회전 이상을 검출할 수 있다. 또한, 실시형태 1에 따른 반도체 장치의 모터 회전각 변환 회로 및 판단 회로의 처리는, 주로 수치 연산에 의한 것이다. 그 때문에, 모터 회전각 변환 회로 및 판단 회로의 처리를 연산 처리 회로에 서 실행되는 프로그램에 의해 행할 수도 있다. 또한, 실시형태 1에 따른 반도체 장치에서는, 모터 구동 제어 회로에 있어서의 모터 제어에 이용되는 제 어용 회전각 정보(RCONT)보다 필터 게인이 높은 제2 필터 계수를 적용하여 회전각 신호(SR)에 대한 추종성이 높 은 이상 검출용 회전각 정보(RDT)를 생성하고, 이 이상 검출용 회전각 정보(RDT)를 이용하여 회전 이상의 검출 을 행한다. 이에 의해, 실시형태 1에 따른 반도체 장치는, 모터 구동 제어 회로에 있어서의 모터 제어를 적절히 행하면서, 높은 정밀도로 회전 이상을 검출할 수 있다. 또한, 상기 설명에서는, 실시형태 1에 따른 반도체 장치는, 모터의 1회전분의 이상 검출용 회전각 정보 (RDT)에 근거하여 모터의 회전 이상을 판정한다. 이와 같이, 모터의 1회전분 이상의 이상 검출용 회 전각 정보(RDT)에 근거하여 이상을 판정함으로써, 회전 이상의 오검출을 방지한 정밀도가 높은 이상 검출을 행 할 수 있다. 또한, 이상 검출에 이용하는 이상 검출용 회전각 정보(RDT)의 길이는, 모터의 1회전보다 짧은 길이이어도 상관없다. 또한, 더 긴 기간의 이상 검출용 회전각 정보(RDT)에 근거하여 회전 이상을 판정함으로써 이상 검출 정밀도를 더 높일 수 있다. 실시형태 2 실시형태 2에서는, 실시형태 1에 따른 반도체 장치의 다른 형태가 되는 반도체 장치를 설명한다. 그래서, 도 5에 실시형태 2에 따른 반도체 장치의 블록도를 나타낸다. 도 5에 나타내는 바와 같이, 실시형태 2에 따 른 반도체 장치는, 실시형태 1의 반도체 장치로부터 메모리를 제외하고, 모터 회전각 변환 회로 및 판단 회로 대신에, 모터 회전각 변환 회로 및 판단 회로를 가진다. 모터 회전각 변환 회로는, RD컨버터로부터 직접 이상 검출용 회전각 정보(RDT)를 수취하고, 수취한 순 으로 회전각 시간 변화 정보를 출력한다. 판단 회로는, 카운터를 가지며, 모터 회전각 변환 회로로부터 수취한 순으로 회전각 시간 변화 정보에 대하여 이상 판정 범위를 초과하고 있는지 아닌지를 판단하고, 회전각 시간 변화 정보가 이상 판정 범위를 초과하고 있었던 경우에는 카운터의 카운트값을 카운트업한다. 또한, 판단 회로는, 모터가 가감속 상태에 있는 경우, 이상 검출 범위를 모터의 회전 속도에 맞춰서 변화시킨다. 이 판단 회로의 이상 판정 방법을 구체적으로 이하에서 설명한다. 도 6에 실시형태 2에 따른 반도체 장치의 판단 회로에 있어서의 이상 판정 처리를 설명하는 플로우차트를 나타 낸다. 또한, 도 6에 나타낸 플로우차트의 처리는, 모터 회전각 변환 회로가 각속도(角速度) 시간 변화 정보 를 판단 회로에 제공할 때마다 행해진다. 도 6에 나타내는 바와 같이, 판단 회로는, 이상 판정 처리를 개시하면, 우선 모터가 정회전 동작 중인지 아닌지를 판단한다(스텝 S1). 이 스텝 S1의 판단에서는, 연산 처리 회로로부터 모터의 제어 상태를 취득한다. 그리고 스텝 S1에서, 모터가 정회전 동작 중이라고 판 단된 경우, 판단 회로는, 이상 검지 범위를 정회전용 이상 검출 범위로 설정한다(스텝 S2). 또한, 스텝 S1 에서, 모터가 가감속 동작 중이라고 판단된 경우, 판단 회로는, 이상 검지 범위를 가감속의 속도에 따 른 이상 검지 범위로 설정한다(스텝 S3). 여기서, 판단 회로에서 전환되는 이상 검지 범위에 관하여 설명한다. 도 7에 실시형태 2에 따른 반도체 장 치의 판단 회로에 있어서의 정회전시의 이상 검출 범위와 가속시의 이상 검출 범위를 설명하는 도면을 나타낸다. 도 7에 나타내는 바와 같이, 모터가 정회전 상태인 경우, 모터의 회전 각도와 이상 검출용 회전 각 정보(RDT)의 변화의 이상(理想) 상태는 선형(線形)이 되기 때문에, 이상 검출 범위의 상한값 및 하한값도 모 터의 회전각에 대하여 선형의 변화를 나타내는 것이 된다. 한편, 모터가 가속 상태인 경우, 모터의 회전 각도와 이상 검출용 회전각 정보(RDT)의 변화의 이상(理想) 상태는 가속도에 따른 비선형이 되기 때문에, 이상 검출 범위의 상한값 및 하한값도 모터의 회전각에 대하여 비선형의 변화를 나타내는 것이 된다. 이어서, 판단 회로에서는, 회전각 시간 변화 정보가 나타내는 값이 이상 검지 범위의 범위 내인지 아닌지를 판단하는 이상 검지 처리를 행한다(스텝 S4). 그리고 스텝 S4에서, 회전각 시간 변화 정보가 나타내는 값이 이 상 검지 범위의 범위를 초과하는 이상 상태가 검출된 경우, 판단 회로는 카운터의 카운트값을 1개 카운트업 한다(스텝 S5). 여기서, 판단 회로에 있어서의 이상 검출 방법에 관하여, 도 8에 나타내는 실시형태 2에 따 른 반도체 장치의 판단 회로에 있어서의 이상 검출 방법을 설명하는 도면을 참조하여 설명한다. 도 8에 나타내는 예는, 정회전 동작 중의 이상 검출 방법을 설명하는 것이다. 도 8에 나타내는 바와 같이, 판단 회로는, 스텝 S2에서 설정된 이상 검출 범위의 상한값, 또는, 하한값을 회전각 시간 변화 정보의 값이 초과 한 경우에 이상을 검출하고, 그 검출 횟수를 카운트한다. 그리고 판단 회로는, 카운터를 카운트업시킨 후에 카운트 수가 미리 설정되는 판정 문턱값을 초과했는지 아 닌지를 판단한다(스텝 S6). 이 스텝 S6에서, 카운트 수가 판정 문턱값 미만이었을 경우, 판단 회로는, 일단 이상 판정 처리를 종료하고 다음에 회전각 시간 변화 정보가 입력될 때까지 처리를 대기한다. 한편, 이 스텝 S6 에서, 카운트 수가 판정 문턱값 이상이었을 경우, 판단 회로는, 모터에 회전 이상의 징조가 있는 것으 로 하여, 연산 처리 회로에 이상 징조가 있는 것을 통지한다(스텝 S7). 또한, 스텝 S4에서, 회전 이상이 검출되지 않았을 경우, 판단 회로는, 일정 시간 동안 이상이 검출되지 않 았는지 여부를 판단한다(스텝 S8). 이 스텝 S8에서, 최후로 이상이 검출되고 나서의 경과 시간이 일정 기간을 초과하고 있으면, 판단 회로는, 카운터의 카운트값을 클리어하며, 일단 이상 판정 처리를 종료하고 다음에 회전각 시간 변화 정보가 입력될 때까지 처리를 대기한다(스텝 S9). 한편, 이 스텝 S8에서, 최후로 이상이 검출 되고 나서의 경과 시간이 일정 기간을 초과하고 있지 않으면, 판단 회로는, 카운터의 카운트값을 유지한 채, 일단 이상 판정 처리를 종료하고 다음에 회전각 시간 변화 정보가 입력될 때까지 처리를 대기한다. 상기 설명으로부터, 실시형태 2에 따른 반도체 장치에서는, 메모리를 이용하는 일없이 모터의 회전 이상을 검출할 수 있다. 이에 의해, 실시형태 2에 따른 반도체 장치는, 회로 면적을 삭감할 수 있다. 또한, 실시형태 2에 따른 반도체 장치에서는, 메모리의 용량에 관계없이 장기간의 이상 검출용 회전각 정보(RDT)에 근거하여 회전 이상을 검출할 수 있기 때문에, 회전 이상의 오검출을 방지하여 더 높은 정밀도의이상 검출을, 작은 회로 규모로 실현할 수 있다. 실시형태 3 실시형태 3에서는, 실시형태 1에 따른 반도체 장치의 다른 형태가 되는 반도체 장치에 관하여 설명한다. 도 9에 실시형태 3에 따른 반도체 장치의 블록도를 나타낸다. 도 9에 나타내는 바와 같이, 실시형태 3에 따 른 반도체 장치는, 실시형태 1에 따른 반도체 장치의 판단 회로를 판단 회로로 치환한 것이다. 판단 회로는, 회전각 시간 변화 정보에 있어서의 회전각값의 피크의 출현 주기로부터 모터의 진동 주 파수를 해석하여, 진동 주파수가 상기 모터의 고유 진동 주파수 이외인 경우에 상기 모터에 이상이 발생했다고 판단한다. 여기서, 판단 회로에서 해석되는 모터의 진동 주파수에 관하여, 도 10을 참조하여 설명한다. 도 10은, 실시형태 3에 따른 반도체 장치의 판단 회로에 있어서의 이상 판정에서 이용하는 피크 발생 주기를 설명 하는 도면이다. 도 10에 나타내는 바와 같이, 모터에 진동이 발생한 경우, 각속도 시간 변화 정보에 변동이 발생한다. 그 래서 판단 회로에서는, 각속도 시간 변화 정보로 변동 피크 사이의 주기(T1∼T4)를 산출하고, 이 주기(T1∼ T4)에 근거하여 변동 주파수를 해석한다. 이어서, 판단 회로에 있어서의 이상 판정 처리의 처리 플로우에 관하여 설명한다. 그래서, 도 11에 실시형 태 3에 따른 반도체 장치의 판단 회로에 있어서의 이상 판정 처리를 설명하는 플로우차트를 나타낸다. 또한, 도 11에 나타낸 플로우차트의 처리는, 모터 회전각 변환 회로가 각속도 시간 변화 정보를 판단 회로에 제 공할 때마다 행해진다. 도 11에 나타내는 바와 같이 판단 회로는, 모터 회전각 변환 회로가 메모리로부터 판독한 이상 검 출용 회전각 정보(RDT)에 근거하여 생성한 회전각 시간 변화 정보를 수취한다(스텝 S11). 그리고 판단 회로(6 8)는, 수취한 회전각 시간 변화 정보에 대하여 주파수 해석을 행한다(스텝 S12). 판단 회로는, 스텝 S12의 주파수 해석의 결과, 각속도 시간 변화 정보에 발생하고 있는 변동이 모터의 고유 진동 주파수 이외의 주파수인 경우, 이상 발생의 징조가 있는 것으로 하여, 이상을 연산 처리 회로에 통지한다(스텝 S13, S14). 한편, 판 단 회로는, 스텝 S12의 주파수 해석의 결과, 각속도 시간 변화 정보에 발생하고 있는 변동이 모터의 고유 진동 주파수와 같은 주파수라고 판정한 경우, 일단 이상 판정 처리를 종료하고, 다음의 회전각 시간 변화 정보 의 입력을 기다린다. 상기 설명으로부터, 실시형태 3에 따른 반도체 장치에서는, 이상 검출용 회전각 정보(RDT)로부터 얻어지는 모터의 진동에 관한 정보 중 모터의 고유 진동에 관해서는 정상적인 것으로서 판정한다. 이에 의해, 실시형태 3에 따른 반도체 장치에서는, 모터의 고유 진동에 관한 오판정을 저감할 수 있다. 실시형태 4 실시형태 4에서는, 실시형태 1에 따른 반도체 장치의 다른 형태가 되는 반도체 장치에 관하여 설명한다. 그래서, 도 12에 실시형태 4에 따른 반도체 장치의 블록도를 나타낸다. 도 12에 나타내는 바와 같이, 실시형 태 4에 따른 반도체 장치는, 판단 회로를 판단 회로로 치환한 것이다. 판단 회로는, 모터의 회전 및 진동의 정상 상태 및 이상 상태에 관하여 미리 학습된 인공지능으로서, 회전 각 시간 변화 정보를 인공지능에 입력한 결과에 따라 모터의 상태를 모터 구동 제어 회로에 통지한다. 이 인공지능의 학습 방법으로서는, 입력 데이터에 대하여 데이터 예측을 행하는 자율 학습(추론 알고리즘)에 의 한 것이나, 특징 분류에 의해 입력 데이터가 정상인 거동으로부터 얻어진 데이터인지 이상인 거동으로부터 얻어 진 데이터인지 등의 특징을 판단하는 지도 학습에 의한 것 등을 생각할 수 있다. 이 판단 회로를 이용함으로써, 실시형태 4에 따른 반도체 장치는, 문턱값, 혹은, 이상 판정 범위에 의하 지 않고 모터의 회전 이상을 검출할 수 있다. 또한, 실시형태 4에 따른 반도체 장치에서는, 추론 알고 리즘을 이용함으로써, 현재 얻어진 데이터에 근거하는 이상 발생의 징조를 검출할 수 있다. 이상, 본 발명자에 의해 이루어진 발명을 실시형태에 근거하여 구체적으로 설명했지만, 본 발명은 이미 서술한 실시형태에 한정되는 것은 아니며, 그 요지를 일탈하지 않는 범위에서 여러 가지의 변경이 가능한 것은 말할 필 요도 없다. (부기 1) 모터를 구동하는 구동 신호의 파형을 나타내는 구동 파형 신호를 생성하는 모터 구동 제어 회로와, 상기 모터의 회전각을 계측하는 리졸버로부터 상기 모터의 회전각을 나타내는 회전각 신호를 취득하고, 상기 회 전각 신호를 디지털값으로 변환하여 회전각 정보를 생성하는 리졸버 회전각 변환 회로와, 상기 모터의 상마다의 상기 회전각 정보를 각각 상기 모터의 각도 변화로 변환하여 회전각 시간 변화 정보를 생 성하는 모터 회전각 변환 회로와, 상기 회전각 시간 변화 정보에 있어서의 회전각 시간 변화가 이상 검출 범위를 초과하고 있었던 경우에, 상기 모터에 이상이 발생했다고 판단하는 판단 회로, 를 가지는 반도체 장치. (부기 2) 상기 리졸버 회전각 변환 회로는, 취득한 상기 회전각 신호에 대한 추종성이 낮은 제1 필터 계수를 이용하여 제어용 회전각 정보를 생성하고, 상 기 모터 구동 제어 회로에 상기 제어용 회전각 정보를 출력하는 제1 트래킹 루프 회로와, 취득한 상기 회전각 정보에 대한 추종성이 높은 제2 필터 계수를 이용하여 이상 검출용 회전각 정보를 생성하고, 상기 모터 회전각 변환 회로에 상기 이상 검출용 회전각 정보를 출력하는 제2 트래킹 루프 회로, 를 가지는 부기 1에 기재된 반도체 장치. (부기 3) 상기 모터 회전각 변환 회로는, 상기 모터의 상마다의 회전각을 각각 상기 모터의 1회전분의 각도 변화로 변환 하여 회전각 시간 변화 정보를 생성하는 부기 1에 기재된 반도체 장치. (부기 4) 상기 리졸버 회전각 변환 회로와, 상기 모터 회전각 변환 회로 사이에 설치되는 메모리를 더 가지며, 상기 리졸 버 회전각 변환 회로는, 상기 회전각 정보를 상기 메모리에 축적하고, 상기 모터 회전각 변환 회로는, 상기 메 모리로부터 상기 회전각 정보를 판독하는 부기 1에 기재된 반도체 장치. (부기 5) 상기 판단 회로는, 상기 모터가 가감속(加減速) 상태에 있는 경우, 상기 이상 검출 범위를 상기 모터의 회전 속 도에 맞춰서 변화시키는 부기 1에 기재된 반도체 장치. (부기 6) 상기 판단 회로는, 상기 회전각 시간 변화 정보의 값이 상기 이상 검출 범위를 초과한 횟수가, 일정 시간 내에 소정의 횟수를 초과한 경우에 상기 모터에 이상이 발생했다고 판단하는 부기 1에 기재된 반도체 장치. (부기 7) 상기 판단 회로는, 상기 회전각 시간 변화 정보에 있어서의 회전각값의 피크의 출현 주기로부터 상기 모터의 진 동 주파수를 해석하여, 상기 진동 주파수가 상기 모터의 고유 진동 주파수 이외인 경우에 상기 모터에 이상이 발생했다고 판단하는 부기 1에 기재된 반도체 장치. (부기 8) 상기 판단 회로는, 상기 모터의 회전 및 진동의 정상 상태 및 이상 상태에 관하여 미리 학습된 인공지능으로서, 상기 회전각 시간 변화 정보를 상기 인공지능에 입력한 결과에 따라 상기 모터의 상태를 상기 모터 구동 제어 회로에 통지하는 부기 1에 기재된 반도체 장치. (부기 9) 상기 리졸버 회전각 변환 회로는, 상기 모터 구동 제어 회로와는 상이한 반도체 칩 상에 형성되는 부기 1에 기 재된 반도체 장치. 부호의 설명1∼4 반도체 장치 10 모터 구동 제어 회로 11 연산 처리 회로 12 타이머 13 출력 인터페이스 회로 14 아날로그 디지털 변환기 15 RD컨버터 16 메모리 17, 57 모터 회전각 변환 회로 18, 58, 68, 78 판단 회로 21, 22 입력 버퍼 23 아날로그 디지털 변환기 24 제1 트래킹 루프 회로 25 제2 트래킹 루프 회로 31, 41 신호 합성 회로 32, 42 파형 처리 회로 33, 43 PI제어 회로 34, 44 가산기 100 파워 모듈 회로 101 전류 센서 102 모터 103 리졸버 센서 회로 SR 회전각 신호 IDET 전류 검출 신호 SFB 피드백 신호 RCONT 제어용 회전각 정보 RDT 이상 검출용 회전각 정보도면 도면1 도면2 도면3 도면4 도면5 도면6 도면7 도면8 도면9 도면10 도면11 도면12"}
{"patent_id": "10-2018-0161681", "section": "도면", "subsection": "도면설명", "item": 1, "content": "[도 1] 실시형태 1에 따른 반도체 장치의 블록도이다. [도 2] 실시형태 1에 따른 반도체 장치의 RD컨버터의 블록도이다. [도 3] 실시형태 1에 따른 반도체 장치의 모터 회전각 변환 회로에 있어서의 처리를 설명하는 도면이다. [도 4] 실시형태 1에 따른 반도체 장치에서 검출되는 회전 이상이 발생했을 때의 회전각 시간 변화 정보의 시간 변화를 설명하는 도면이다. [도 5] 실시형태 2에 따른 반도체 장치의 블록도이다. [도 6] 실시형태 2에 따른 반도체 장치의 판단 회로에 있어서의 이상 판정 처리를 설명하는 플로우차트이다. [도 7] 실시형태 2에 따른 반도체 장치의 판단 회로에 있어서의 정회전시의 이상 검출 범위와 가속시의 이상 검 출 범위를 설명하는 도면이다. [도 8] 실시형태 2에 따른 반도체 장치의 판단 회로에 있어서의 이상 검출 방법을 설명하는 도면이다. [도 9] 실시형태 3에 따른 반도체 장치의 블록도이다. [도 10] 실시형태 3에 따른 반도체 장치의 판단 회로에 있어서의 이상 판정에서 이용하는 피크 발생 주기를 설 명하는 도면이다. [도 11] 실시형태 3에 따른 반도체 장치의 판단 회로에 있어서의 이상 판정 처리를 설명하는 플로우차트이다. [도 12] 실시형태 4에 따른 반도체 장치의 블록도이다."}
