{"patent_id": "10-2020-0158043", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2021-0141303", "출원번호": "10-2020-0158043", "발명의 명칭": "압축 영상의 노이즈를 추출하는 방법 및 장치, 압축 영상의 노이즈를 저감하는 방법 및 장치", "출원인": "삼성전자주식회사", "발명자": "박재연"}}
{"patent_id": "10-2020-0158043", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "원본 영상의 압축 영상에 다운 컨볼루션 및 상기 다운 컨볼루션에 대응되는 업 컨볼루션을 순차적으로 수행하는컨볼루션 필터를 적용함으로써 제1 영상을 획득하는 단계;상기 압축 영상으로부터 상기 제1 영상을 감산한 제2 영상을 획득하는 단계; 및상기 제2 영상으로부터 상기 압축 영상의 고주파수 정보 및 압축 아티팩트를 포함하는 노이즈를 획득하는 단계를 포함하는, 압축 영상의 노이즈를 추출하는 방법."}
{"patent_id": "10-2020-0158043", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 제1 영상은 상기 압축 영상의 중간 주파수 정보 및 저주파수 정보를 포함하는, 압축 영상의 노이즈를 추출하는 방법."}
{"patent_id": "10-2020-0158043", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1항에 있어서,상기 컨볼루션 필터는 상기 압축 영상을 입력으로 하여 상기 압축 영상의 중간 주파수 정보 및 저주파수 정보를포함하는 상기 제1 영상을 획득하도록 훈련된 것인, 압축 영상의 노이즈를 추출하는 방법."}
{"patent_id": "10-2020-0158043", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제3항에 있어서,상기 다운 컨볼루션은 상기 압축 영상의 크기를 줄이도록 훈련된 컨볼루션 연산인, 압축 영상의 노이즈를 추출하는 방법."}
{"patent_id": "10-2020-0158043", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제3항에 있어서,상기 업 컨볼루션은 상기 다운 컨볼루션된 압축 영상을 상기 압축 영상의 원래 크기로 늘리도록 훈련된 컨볼루션 연산인, 압축 영상의 노이즈를 추출하는 방법."}
{"patent_id": "10-2020-0158043", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제1항에 있어서, 상기 다운 컨볼루션과 상기 업 컨볼루션은 전치(transpose)된 것인, 압축 영상의 노이즈를 추출하는 방법."}
{"patent_id": "10-2020-0158043", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "원본 영상의 압축 영상에 다운 컨볼루션 및 상기 다운 컨볼루션에 대응되는 업 컨볼루션을 순차적으로 수행하는컨볼루션 필터를 적용함으로써 제1 영상을 획득하는 단계;상기 압축 영상으로부터 상기 제1 영상을 감산한 제2 영상을 획득하는 단계;상기 제2 영상으로부터 상기 압축 영상의 고주파수 정보 및 압축 아티팩트를 포함하는 노이즈를 획득하는 단계;상기 노이즈에 압축 아티팩트 제거용 DNN을 적용하여 압축 아티팩트를 제거하여 제3 영상을 획득하는 단계; 및상기 제1 영상과 상기 제3 영상을 합산하여 상기 압축 영상을 복원하는 단계를 포함하는, 압축 영상의 노이즈를저감하는 방법.공개특허 10-2021-0141303-3-청구항 8 제7항에 있어서,상기 압축 아티팩트 제거용 DNN은 상기 압축 영상의 고주파수 정보 및 압축 아티팩트를 입력으로 하여 상기 압축 아티팩트를 저감하도록 훈련된 것인, 압축 영상의 노이즈를 저감하는 방법."}
{"patent_id": "10-2020-0158043", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제7항에 있어서,상기 압축 아티팩트 제거용 DNN은 컨볼루션 레이어 및 활성화 레이어를 포함하는, 압축 영상의 노이즈를 저감하는 방법."}
{"patent_id": "10-2020-0158043", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제9항에 있어서,상기 압축 아티팩트 제거용 DNN은 배치 정규화 레이어를 추가로 포함하는, 압축 영상의 노이즈를 저감하는방법."}
{"patent_id": "10-2020-0158043", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "제7항에 있어서,상기 제1 영상은 상기 압축 영상의 중간 주파수 정보 및 저주파수 정보를 포함하는, 압축 영상의 노이즈를 저감하는 방법."}
{"patent_id": "10-2020-0158043", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제7항에 있어서,상기 컨볼루션 필터는 상기 압축 영상의 중간 주파수 정보 및 저주파수 정보를 포함하는 상기 제1 영상을 획득하도록 훈련된 것인, 압축 영상의 노이즈를 저감하는 방법."}
{"patent_id": "10-2020-0158043", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "제7항에 있어서,상기 다운 컨볼루션은 상기 압축 영상의 크기를 줄이도록 훈련된 컨볼루션 연산인, 압축 영상의 노이즈를 저감하는 방법."}
{"patent_id": "10-2020-0158043", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_14", "content": "제7항에 있어서,상기 업 컨볼루션은 상기 다운 컨볼루션된 압축 영상을 상기 압축 영상의 원래 크기로 늘리도록 훈련된 컨볼루션 연산인, 압축 영상의 노이즈를 저감하는 방법."}
{"patent_id": "10-2020-0158043", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_15", "content": "제7항에 있어서,상기 다운 컨볼루션과 상기 업 컨볼루션은 전치(transpose)된 것인, 압축 영상의 노이즈를 저감하는 방법."}
{"patent_id": "10-2020-0158043", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_16", "content": "하나 이상의 인스트럭션들을 저장하는 메모리; 및상기 메모리에 저장된 상기 하나 이상의 인스트럭션들을 실행하는 프로세서를 포함하고,상기 프로세서는,원본 영상의 압축 영상에 다운 컨볼루션 및 상기 다운 컨볼루션에 대응되는 업 컨볼루션을 순차적으로 수행하는공개특허 10-2021-0141303-4-컨볼루션 필터를 적용함으로써 제1 영상을 획득하고,상기 압축 영상으로부터 상기 제1 영상을 감산한 제2 영상을 획득하고,상기 제2 영상으로부터 상기 압축 영상의 고주파수 정보 및 압축 아티팩트를 포함하는 노이즈를 획득하는 것을특징으로 하는 압축 영상의 노이즈를 추출하는 장치."}
{"patent_id": "10-2020-0158043", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_17", "content": "하나 이상의 인스트럭션들을 저장하는 메모리; 및상기 메모리에 저장된 상기 하나 이상의 인스트럭션들을 실행하는 프로세서를 포함하고,상기 프로세서는,원본 영상의 압축 영상에 다운 컨볼루션 및 상기 다운 컨볼루션에 대응되는 업 컨볼루션을 순차적으로 수행하는컨볼루션 필터를 적용함으로써 제1 영상을 획득하고,상기 압축 영상으로부터 상기 제1 영상을 감산한 제2 영상을 획득하고,상기 제2 영상으로부터 상기 압축 영상의 고주파수 정보 및 압축 아티팩트를 포함하는 노이즈를 획득하고,상기 노이즈에 압축 아티팩트 제거용 DNN을 적용하여 압축 아티팩트를 제거하여 제3 영상을 획득하고,상기 제1 영상과 상기 제3 영상을 합산하여 상기 압축 영상을 복원하는 것을 특징으로 하는 압축 영상의 노이즈를 저감하는 장치."}
{"patent_id": "10-2020-0158043", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "원본 영상의 압축 영상에 다운 컨볼루션 및 상기 다운 컨볼루션에 대응되는 업 컨볼루션을 순차적으로 수행하는 컨볼루션 필터를 적용함으로써 제1 영상을 획득하고, 상기 압축 영상으로부터 상기 제1 영상을 감산한 제2 영상 을 획득하고, 상기 제2 영상으로부터 상기 압축 영상의 고주파수 정보 및 압축 아티팩트를 포함하는 노이즈를 획 득하고, 상기 노이즈에 압축 아티팩트 제거용 DNN을 적용하여 압축 아티팩트를 제거하여 제3 영상을 획득하고, 상기 제1 영상과 상기 제3 영상을 합산하여 상기 압축 영상을 복원하는, 압축 영상의 노이즈를 저감하는 방법을 제안한다."}
{"patent_id": "10-2020-0158043", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 개시는 압축 영상의 노이즈를 추출하고 저감하기 위한 방법 및 장치에 관한 것으로, 보다 구체적으로, 본 개 시는 영상의 압축시 발생하는 압축 아티팩트를 포함하는 노이즈를 인공지능(AI)에 기반하여 추출하고 저감하기 위한 방법 및 장치에 관한 것이다."}
{"patent_id": "10-2020-0158043", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "영상은 소정의 데이터 압축 표준, 예를 들어 MPEG (Moving Picture Expert Group) 표준 등을 따르는 코덱 (codec)에 의해 부호화된 후 비트스트림의 형태로 기록매체에 저장되거나 통신 채널을 통해 전송된다. 영상 압축시에 압축 아티팩트가 발생될 수 있다. 따라서, 이러한 압축 아티팩트를 저감하여 압축 영상의 품질을 향상시킬 필요가 있다."}
{"patent_id": "10-2020-0158043", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "일 실시예에 따른 압축 영상의 노이즈를 추출하기 위한 방법 및 압축 영상의 노이즈를 저감하기 위한 방법, 및 장치는 AI 기반으로 압축 영상으로부터 복원가능성이 높은 구조적 정보와 손상 확률이 높은 고주파수 노이즈 영 역을 분리하여 영상의 압축시 생성되는 압축 아티팩트를 저감함으로써 압축 영상의 품질을 향상하는 것을 기술 적 과제로 한다."}
{"patent_id": "10-2020-0158043", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "상기 기술적 과제를 해결하기 위해 본 개시에서 제안하는, 압축 영상의 노이즈를 추출하는 방법은 원본 영상의 압축 영상에 다운 컨볼루션 및 상기 다운 컨볼루션에 대응되는 업 컨볼루션을 순차적으로 수행하는 컨볼루션 필 터를 적용함으로써 제1 영상을 획득하는 단계; 상기 압축 영상으로부터 상기 제1 영상을 감산한 제2 영상을 획 득하는 단계; 및 상기 제2 영상으로부터 상기 압축 영상의 고주파수 정보 및 압축 아티팩트를 포함하는 노이즈 를 획득하는 단계를 포함할 수 있다. 상기 기술적 과제를 해결하기 위해 본 개시에서 제안하는, 압축 영상의 노이즈를 저감하는 방법은, 원본 영상의 압축 영상에 다운 컨볼루션 및 상기 다운 컨볼루션에 대응되는 업 컨볼루션을 순차적으로 수행하는 컨볼루션 필터를 적용함으로써 제1 영상을 획득하는 단계; 상기 압축 영상으로부터 상기 제1 영상을 감산한 제2 영상을 획 득하는 단계; 상기 제2 영상으로부터 상기 압축 영상의 고주파수 정보 및 압축 아티팩트를 포함하는 노이즈를 획득하는 단계; 상기 노이즈에 압축 아티팩트 제거용 DNN을 적용하여 압축 아티팩트를 제거하여 제3 영상을 획 득하는 단계; 및 상기 제1 영상과 상기 제3 영상을 합산하여 상기 압축 영상을 복원하는 단계를 포함할 수 있다. 상기 기술적 과제를 해결하기 위해 본 개시에서 제안하는, 압축 영상의 노이즈를 추출하는 장치는, 하나 이상의 인스트럭션들을 저장하는 메모리; 및 상기 메모리에 저장된 상기 하나 이상의 인스트럭션들을 실행하는 프로세 서를 포함하고, 상기 프로세서는, 원본 영상의 압축 영상에 다운 컨볼루션 및 상기 다운 컨볼루션에 대응되는 업 컨볼루션을 순차적으로 수행하는 컨볼루션 필터를 적용함으로써 제1 영상을 획득하고, 상기 압축 영상으로부 터 상기 제1 영상을 감산한 제2 영상을 획득하고, 상기 제2 영상으로부터 상기 압축 영상의 고주파수 정보 및 압축 아티팩트를 포함하는 노이즈를 획득할 수 있다. 상기 기술적 과제를 해결하기 위해 본 개시에서 제안하는, 압축 영상의 노이즈를 저감하는 장치는, 하나 이상의 인스트럭션들을 저장하는 메모리; 및 상기 메모리에 저장된 상기 하나 이상의 인스트럭션들을 실행하는 프로세 서를 포함하고, 상기 프로세서는, 원본 영상의 압축 영상에 다운 컨볼루션 및 상기 다운 컨볼루션에 대응되는 업 컨볼루션을 순차적으로 수행하는 컨볼루션 필터를 적용함으로써 제1 영상을 획득하고, 상기 압축 영상으로부 터 상기 제1 영상을 감산한 제2 영상을 획득하고, 상기 제2 영상으로부터 상기 압축 영상의 고주파수 정보 및 압축 아티팩트를 포함하는 노이즈를 획득하고, 상기 노이즈에 압축 아티팩트 제거용 DNN을 적용하여 압축 아티 팩트를 제거하여 제3 영상을 획득하고, 상기 제1 영상과 상기 제3 영상을 합산하여 상기 압축 영상을 복원할 수 있다."}
{"patent_id": "10-2020-0158043", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "다운 컨볼루션 및 업 컨볼루션 연산를 포함하는 컨볼루션 필터와 감산 및 합산 연산을 이용하여 압축 영상을 저 주파수 정보 및 중간주파수 정보를 포함하는 영상과 고주파수 정보 및 압축 아티팩트를 포함하는 노이즈를 가지 는 영상으로 분리함으로써 노이즈를 추출하고, 고주파수 정보 및 압축 아티팩트를 포함하는 노이즈를 가지는 영 상을 압축 아티팩트 제거용 DNN에 입력하여 압축 아티팩트를 제거하고 저주파수 정보 및 중간주파수 정보를 포 함하는 영상과 다시 합산함으로써 압축 영상의 품질이 향상될 수 있다."}
{"patent_id": "10-2020-0158043", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "본 개시는 다양한 변경을 가할 수 있고 여러 가지 실시예를 가질 수 있는 바, 특정 실시예들을 도면에 예시하고, 이를 상세한 설명을 통해 상세히 설명하고자 한다. 그러나, 이는 본 개시의 실시 형태에 대해 한정 하려는 것이 아니며, 본 개시는 여러 실시예들의 사상 및 기술 범위에 포함되는 모든 변경, 균등물 내지 대체물 을 포함하는 것으로 이해되어야 한다. 실시예를 설명함에 있어서, 관련된 공지 기술에 대한 구체적인 설명이 본 개시의 요지를 불필요하게 흐릴 수 있 다고 판단되는 경우 그 상세한 설명을 생략한다. 또한, 명세서의 설명 과정에서 이용되는 숫자(예를 들어, 제 1, 제 2 등)는 하나의 구성요소를 다른 구성요소와 구분하기 위한 식별기호에 불과하다. 또한, 본 명세서에서, 일 구성요소가 다른 구성요소와 \"연결된다\" 거나 \"접속된다\" 등으로 언급된 때에는, 상기 일 구성요소가 상기 다른 구성요소와 직접 연결되거나 또는 직접 접속될 수도 있지만, 특별히 반대되는 기재가 존재하지 않는 이상, 중간에 또 다른 구성요소를 매개하여 연결되거나 또는 접속될 수도 있다고 이해되어야 할 것이다. 또한, 본 명세서에서 '~부(유닛)', '모듈' 등으로 표현되는 구성요소는 2개 이상의 구성요소가 하나의 구성요소 로 합쳐지거나 또는 하나의 구성요소가 보다 세분화된 기능별로 2개 이상으로 분화될 수도 있다. 또한, 이하에 서 설명할 구성요소 각각은 자신이 담당하는 주기능 이외에도 다른 구성요소가 담당하는 기능 중 일부 또는 전 부의 기능을 추가적으로 수행할 수도 있으며, 구성요소 각각이 담당하는 주기능 중 일부 기능이 다른 구성요소 에 의해 전담되어 수행될 수도 있음은 물론이다. 또한, 본 명세서에서, '영상(image)' 또는 '픽처'는 정지영상, 복수의 연속된 정지영상(또는 프레임)으로 구성 된 동영상, 또는 비디오를 나타낼 수 있다. 또한, 본 명세서에서 'DNN(deep neural network)'은 뇌 신경을 모사한 인공신경망 모델의 대표적인 예시로써, 특정 알고리즘을 사용한 인공신경망 모델로 한정되지 않는다. 또한, 본 명세서에서 '파라미터'는 뉴럴 네트워크를 이루는 각 레이어의 연산 과정에서 이용되는 값으로서 예를 들어, 입력 값을 소정 연산식에 적용할 때 이용되는 가중치를 포함할 수 있다. 또한, 파라미터는 매트릭스 형태 로 표현될 수 있다. 파라미터는 훈련의 결과로 설정되는 값으로서, 필요에 따라 별도의 훈련 데이터(training data)를 통해 갱신될 수 있다. 또한, 본 명세서에서 '컨볼루션 필터'는 압축 영상에 다운 컨볼루션과 업 컨볼루션을 순차적으로 수행하여 압축 영상의 중간 주파수 및 저주파수 정보만을 가지는 영상을 획득하기 위해 이용되는 훈련된 필터를 의미하고 2번 의 컨볼루션 연산이 수행되고 훈련된다는 점에서 DNN의 한 종류이고, “AI 압축 아티팩트 제거용 DNN”은 압축 영상의 고주파수 정보와 압축 아티팩트를 가지는 영상의 압축 아티팩트를 제거하기 위해 이용되는 DNN을 의미한 다. 또한, 본 명세서에서 '필터 설정 정보'는 컨볼루션 필터와 관련된 정보로서 전술한 파라미터를 포함한다. 필터 설정 정보를 이용하여 컨볼루션 필터가 설정될 수 있다. 또한, 본 명세서에서 'DNN 설정 정보'는 DNN을 구성하는 요소와 관련된 정보로서 전술한 파라미터를 포함한다. DNN 설정 정보를 이용하여 AI 압축 아티팩트 제거용 DNN이 설정될 수 있다. 또한, 본 명세서에서 '원본 영상'은 영상 압축의 대상이 되는 영상을 의미하고, '압축 영상'은 원본 영상의 영 상 압축의 결과 생성된 영상을 의미하고, '제 1 영상'은 다운 컨볼루션과 업 컨볼루션이 순차적으로 수행되는 컨볼루션 필터를 적용한 영상을 의미한다. 또한, '제 2 영상'은 압축 영상으로부터 제 1 영상을 감산한 영상을 의미하고, '제 3 영상'은 압축 아티팩트 제거 과정에서 제 2 영상에 대한 AI 압축 아티팩트 제거를 통해 획득된 영상을 의미하고, '복원 영상'은 제 1 영상과 제 3 영상을 합산한 영상을 의미한다. 또한, 본 명세서에서, '감산'은 영상의 픽셀 별로 픽셀 값을 감산하는 원소별 감산(element-wise subtract)을 의미하고, '합산'은 의 픽셀 별로 픽셀 값을 합산하는 원소별 합산(element-wise sum)을 의미한다. 또한, 본 명세서에서, '압축 아티팩트'는 영상 압축 시에 에지 주변과 텍스처가 손상되어 발생되는 에러를 의미 하고, 압축 아티팩트는 일반적으로 블록 아티팩트, 링잉 아티팩트 등이 있다. 도 1은 일 실시예에 따른 압축 영상의 노이즈를 추출하고 저감하는 방법을 설명하기 위한 도면이다. 원본 영상의 영상 압축으로 생성된 압축 영상에는 압축시에 발생한 압축 아티팩트를 포함한 노이즈가 발생하고, 이에 따라, 이러한 노이즈를 효과적으로 분리하여 추출하고, 노이즈에 포함된 압축 아티팩트를 효과적으로 저감 하는 방안이 필요하다. 압축 영상은 복원가능성이 높은 구조적 정보(저주파수 밴드 정보 및 중간주파수 밴드 정보)를 포함하는 영역과 손상 확률이 높은 고주파수 노이즈(고주파수 밴드 정보 및 압축 아티팩트) 영역을 포함한다. 도 1에 도시된 바와 같이, 본 개시의 일 실시예에 따르면, 압축 영상을 다운 컨볼루션와 업 컨볼루션 을 순차적으로 수행하는 컨볼루션 필터에 적용하여 제 1 영상를 획득하고, 압축 영상으로 부터 제 1 영상를 감산하여 제 2 영상를 획득한다. 그리고, 제 2 영상을 아티팩트 저감용 DNN에 입력하여 제 3 영상을 획득하고, 제 1 영상과 제 3 영상를 합산하여 복원 영 상을 획득한다. 컨볼루션 필터는 다운 컨볼루션과 다운 컨볼루션에 대응되는 업 컨볼루션을 순차적으로 수 행하는 필터로, 압축 영상을 입력으로하여 압축 영상의 저주파수 및 중간주파수를 가지는 제 1 영상 을 획득하도록 훈련된 것이다. 즉, 컨볼루션 필터를 적용한 결과 압축 영상의 저주파수 및 중간 주파수 정보를 가지는 제 1 영상이 획득되고, 압축 영상으로부터 제 1 영상을 감산하여 압축 영 상의 고주파수 정보와 압축 아티팩트를 가지는 제 2 영상이 획득된다. 컨볼루션 필터의 컨볼루션 연 산은 도 2을 통해 후술되고, 컨볼루션 필터의 훈련 방식은 도 6을 통해 후술된다. 아티팩트 저감용 DNN은 압축 영상의 고주파수 정보와 압축 아티팩트를 가지는 제 2 영상을 입력 으로 하여 압축 아티팩트가 저감된 제 3 영상을 획득하도록 훈련된 것이다. 즉, 아티팩트 저감용 DNN 적용 결과 압축 아티팩트가 저감된 제 3 영상이 획득되고, 제 1 영상과 제 3 영상을 합산하여 압축 영상으로부터 압축 아티팩트가 저감된 복원 영상이 획득된다. 아티팩트 저감용 DNN의 구조는 도 3을 통해 후술되고, 아티팩트 저감용 DNN의 훈련 방식은 도 7을 통해 후술된다. 상술된 압축 아티팩트가 포함된 노이즈를 추출하고, 압축 아티팩트를 저감하는 방법은 여러 번 수행될 수 있다. 또한, 영상의 블록 단위 별로 수행되거나 영상의 블록 단위 별로 여러 번 수행될 수 있다. 또한, 영상 압축이 수행된 후에 압축 아티팩트의 제거가 필요한 경우에, 상술된 압축 아티팩트가 포함된 노이즈를 추출하고 압축 아티팩트를 저감하는 방법이 어느 단계에나 적용될 수 있다. 압축 영상을 저주파수 및 중간주파수 정보를 포함하는 영상과 고주파수 정보 및 압축 아티팩트를 포함하는 영상 으로 분리하지 않고 AI에 기반하여 아티팩트를 저감하는 경우에는 저감해야할 압축 아티팩트와 유지해야할 아티 팩트의 정보를 구분하지 못하기 때문에 압축 아티팩트만 따로 저감하지 못한다. 그러나, 도 1에서 상술한 바와 같이, 훈련된 컨볼루션 필터를 이용하여 압축 영상을 저주파수 및 중간주파수 정보를 포함하는 영상과 압축 아 티팩트와 압축 아티팩트와 연관된 고주파수 정보를 포함하는 영상으로 분리하고, 고주파수 정보 및 압축 아티팩 트를 포함하는 영상에 대하여 훈련된 아티팩트 저감용 DNN을 이용하여 압축 아티팩트를 제거함으로써 영상 압축 시에 생성된, 원본 영상에 없던 압축 아티팩트를 집중하여 저감할 수 있다. 도 2는 따른 컨볼루션 필터에서 수행되는 다운 컨볼루션과 업 컨볼루션 연산을 나타내는 예시적인 도면이다. 도 2에 도시된 바와 같이, 다운 컨볼루션은 4x4의 입력 특징 맵에 대하여 스트라이드(stride)에 따라 3x3의 다운 필터 커널을 적용한 컨볼루션을 통해 특징 맵의 크기가 줄어든 2x2의 출력 특징 맵를 획 득하는 컨볼루션 연산이고, 업 컨볼루션은 다운 컨볼루션과 전치 관계에 있는 것으로, 특징 맵의 크 기가 줄어든 2x2의 입력 특징 맵에 대하여 스트라이드(stride)에 따라 다운 필터 커널에 대응되는 3x3의 업 필터 커널을 적용한 컨볼루션을 통해 특징 맵의 크기를 원래 크기로 늘어난 4x4의 출력 특징 맵 을 획득하는 컨볼루션 연산이다. 다운 컨볼루션을 통해 입력 특징 맵에 비하여 크기가 줄어든 출력 특징 맵을 획득하여 픽셀이 삭제된 만큼 고주파수 영역에 해당되는 입력 정보가 손실되지만, 그 이후에 업 컨볼루션을 통해 다시 특징 맵의 크기를 늘려 픽셀 수를 복원한다. 즉, 큰 차원의 정보를 가지는 입력 특징 맵을 훈련된 필터 커널을 이용하는 다운 컨볼루션 연산을 통해 작 은 차원으로 축소하면서 고주파수 정보가 손실된 작은 차원의 출력 특징 맵이 획득되고, 작은 차원의 입력 특징 맵을 다운 컨볼루션 연산에 대응되는 훈련된 필터 커널을 이용하는 업 컨볼루션 연산을 통해 큰 차원 으로 확대하면서 원래의 큰 차원의 출력 특징 맵이 획득된다. 이에 따라, 컨볼루션 필터에 입력된 압축 영상의 저주파수 및 중간주파수 정보를 포함하는 제 1 영상(13 5)이 획득된다. 일 실시예에 따라, 컨볼루션 필터는 다운 컨볼루션을 수행하는 1개의 컨볼루션 레이어와 업 컨볼루션을 수행하 는 1개의 컨볼루션 레이어로 구성되는 DNN일 수 있다. 보간 방식의 크기 축소 및 크기 확대 방식의 고정된 필터가 아니라 크기를 축소하는 컨볼루션 연산과 크기를 확 대하는 전치되는 컨볼루션(transposed convolution)을 순차적으로 수행하는 훈련된 컨볼루션 필터를 이용함으로써 압축 영상으로부터 컨볼루션 필터링된 영상을 감산하는 감산 연산 결과, 압축 영상으로부터 고주파수 정보와 압축 아티팩트를 포함하는 노이즈 영역의 영상을 효과적으로 분리할 수 있다. 이에 따라 분리된 노이즈 영역의 영상을 도 3에서 후술되는 압축 아티팩트를 제거하기 위한 DNN에 적용하여 효과적으로 압축 아티팩트를 저감할 수 있다. 도 2에서 설명한 컨볼루션 연산들은 하나의 예시일 뿐이며, 이에 한정되는 것은 아니다. 도 3은 압축 아티팩트를 제거하기 위한 DNN을 나타내는 예시적인 도면이다. 도 3에 도시된 바와 같이, 압축 영상의 고주파수 정보와 압축 아티팩트를 포함하는 노이즈를 가지는 제 2 영상은 제 1 컨볼루션 레이어로 입력된다. 도 3에 도시된 제 1 컨볼루션 레이어에 표시된 3X3X4 는 3 x 3의 크기의 4개의 필터 커널을 이용하여 1개의 입력 영상에 대해 컨볼루션 처리를 하는 것을 예시한다. 컨볼루션 처리 결과 4개의 필터 커널에 의해 4개의 특징 맵이 생성된다. 각 특징 맵은 제 2 영상의 고유한 특성들을 나타낸다. 예를 들어, 각 특징 맵은 제 2 영상의 수직 방향 특성, 수평 방향 특성, 에지 특성, 압축 아티팩트에서 나타내는 특성 등을 나타낼 수 있다. 컨볼루션 처리 결과 생성된 특징 맵들은 각 특징 별로 평균과 표준편차를 계산해서 배치 단위로 정규화하는 배 치 정규화(batch normalization) 레이어로 입력될 수 있다. 배치 정규화 방법은 미니 배치 단위로 정규화하여 학습하기 때문에 학습 속도가 개선된다. 여기서, 배치는 데이터의 일 부분을 의미한다. 제 1 컨볼루션 레이어에서 출력된 특징 맵들은 제 1 배치 정규화 레이어로 입력되고 나서 제 1 활성화 레 이어에 입력된다. 또한, 다른 예로, 배치 정규화는 하나의 옵션으로, 제 1 컨볼루션 레이어에 출력된 특징 맵들은 배치 정규화하 지 않고, 바로 제 1 활성화 레이어에 입력될 수 있다. 제 1 활성화 레이어는 각각의 특징 맵에 대해 비선형(Non-linear) 특성을 부여할 수 있다. 제 1 활성화 레 이어는 시그모이드 함수(sigmoid function), Tanh 함수, ReLU(Rectified Linear Unit) 함수 등을 포함할 수 있으나, 이에 한정되는 것은 아니다. 제 1 활성화 레이어에서 비선형 특성을 부여하는 것은, 제 1 컨볼루션 레이어 또는 제 1 컨볼루션 레 이어와 제 1 배치 정규화 레이어의 출력인, 특징 맵의 일부 샘플 값을 변경하여 출력하는 것을 의미 한다. 이때, 변경은 비선형 특성을 적용하여 수행된다. 제 1 활성화 레이어는 출력된 특징 맵들의 샘플 값들을 제 2 컨볼루션 레이어로 전달할지 여부를 결 정한다. 예를 들어, 특징 맵들의 샘플 값들 중 어떤 샘플 값들은 제 1 활성화 레이어에 의해 활성화되어 제 2 컨볼루션 레이어로 전달되고, 어떤 샘플 값들은 제 1 활성화 레이어에 의해 비활성화되어 제 2 컨볼루션 레이어로 전달되지 않는다. 특징 맵들이 나타내는 제 2 영상의 특징 중에서 압축 아티팩트 에 대응되는 특징은 비활성화되고, 압축 아티팩트에 대응되지 않는 특징은 제 1 활성화 레이어에 의해 강 조된다. 제 1 활성화 레이어에서 출력된 특징 맵들은 제 2 컨볼루션 레이어로 입력된다. 도 3에 도시된 제 2 컨볼루션 레이어에 표시된 3X3X1는 3 x 3의 크기의 1개의 필터 커널을 이용하여 1개의 출력 영상을 만들기 위해 컨볼루션 처리를 하는 것을 예시한다. 제 2 컨볼루션 레이어는 최종 영상을 출력하기 위한 레이어로 서 1개의 필터 커널을 이용하여 1개의 출력을 생성한다. 제 2 컨볼루션 레이어는 제 2 배치 정규화 레이어 로 입력되고 나서 제 2 활성화 레이어에 입력된다. 또한, 다른 예로, 배치 정규화는 하나의 옵션으로, 제 2 컨볼루션 레이어에 출력된 특징 맵들은 배치 정규화하 지 않고, 바로 제 2 활성화 레이어에 입력될 수 있다. 본 개시의 예시에 따르면, 제 2 활성화 레이어는 제 2 영상에 포함된 압축 아티팩트를 제거한 제 3 영상을 출력할 수 있다. 도 3은 아티팩트 저감용 DNN이 두 개의 컨볼루션 레이어(305, 320)와 두 개의 활성화 레이어(315, 330)를 포함하고 옵션으로 두 개의 배치 정규화 레이어(310, 325)를 포함할 수 있는 것으로 도시하고 있으나, 이는 하 나의 예시일 뿐이며, 구현예에 따라서, 컨볼루션 레이어, 활성화 레이어, 및 배치 정규화 레이어의 개수는 다양 하게 변경될 수 있다. 또한, 구현예에 따라서, 아티팩트 저감용 DNN은 RNN(recurrent neural network)을 통해 구현될 수도 있다. 이 경우는 본 개시의 예시에 따른 아티팩트 저감용 DNN의 CNN 구조를 RNN 구조로변경하는 것을 의미한다. 압축 아티팩트를 제거하기 위한 DNN은 도 7에서 후술되는 바와 같이, 압축 영상의 고주파수 정보와 압축 아티팩 트를 포함하는 노이즈를 가지는 제 2 영상을 입력으로하여 원본 영상에 포함되어 있던 고주파수 정보는 최대한 유지하고 원본 영상에 포함되지 않았던 압축 아티팩트가 제거된 제 3 영상을 획득되도록 훈련되기 떄문에, 압축 아티팩트를 효과적으로 제거한다. 그 후, 압축 영상의 저주파수 및 중간주파수 정보를 가지는 제 1 영상과 제 3 영상을 합산함으로써, 압축 영상의 압축 아티팩트만 저감되어 원본 영상에 가깝도록 품질이 향상된 복원 영상이 획득된다. 도 3에서 설명한 컨볼루션 과정은 하나의 예시일 뿐이며, 이에 한정되는 것은 아니다. 도 4는 일 실시예에 따른 압축 영상의 노이즈를 추출하는 장치의 구성을 나타내는 블록도이다. 도 4를 참조하면, 일 실시예에 따른 압축 영상의 노이즈를 추출하는 장치는 컨볼루션 필터, 감산부 , 및 필터 설정부를 포함한다. 컨볼루션 필터, 감산부, 및 필터 설정부는 하나의 프로세서를 통해 구현될 수 있다. 이 경우, 컨볼루션 필터, 감산부, 및 필터 설정부는 전용 프로세서로 구현될 수도 있고, AP(application processor) 또는 CPU(central processing unit), GPU(graphic processing unit)와 같은 범용 프로세서와 S/W의 조합을 통해 구현될 수도 있다. 또한, 전용 프로세서의 경우, 본 개시의 실시예를 구현하기 위한 메모리를 포함 하거나, 외부 메모리를 이용하기 위한 메모리 처리부를 포함할 수 있다. 컨볼루션 필터, 감산부, 및 필터 설정부는 복수의 프로세서로 구성될 수도 있다. 이 경우, 전용 프로세서들의 조합으로 구현될 수도 있고, AP 또는 CPU, GPU와 같은 다수의 범용 프로세서들과 S/W의 조합을 통 해 구현될 수도 있다. 일 실시예에서, 컨볼루션 필터는 제 1 프로세서로 구현되고, 감산부는 제 1 프 로세서와 상이한 제 2 프로세서로 구현되고, 필터 설정부는 제 1 프로세서 및 제 2 프로세서와 상이한 제 3 프로세서로 구현될 수 있다. 필터 설정부는 미리 결정된 기준에 기초하여 압축 영상에 대응되는 훈련된 필터 설정 정보를 컨볼루 션 필터에 제공할 수 있다. 필터 설정부는 압축 영상에 부합하는 제 1 영상의 획득을 위해 필터 설정 정보를 저장할 수 있 다. 필터 설정 정보는 압축 영상의 저주파수 및 중간주파수 정보를 가지는 제 1 영상을 획득하기 위해 훈 련된 것이다. 필터 설정 정보는 필터 커널의 개수, 필터 커널의 크기, 필터 커널의 파라미터 등을 포함할 수 있다. 컨볼루션 필터는 필터 설정부로부터 제공된 필터 설정 정보에 따라 다운 컨볼루션 및 업 컨볼루션을 순차적으로 수행한다. 컨볼루션 필터는 필터 설정부로부터 제공된 필터 설정 정보를 이용하여 압축 영상을 입력으로하 여 제 1 영상을 출력한다. 감산부는 압축 영상으로부터 컨볼루션 필터를 적용하여 출력된 제 1 영상을 감산한다. 감산부는 감산 결과, 압축 영상의 고주파수 정보와 압축 아티팩트를 포함하는 노이즈를 가지는 제 2 영상 를 출력한다. 도 5는 일 실시예에 따른 압축 영상의 노이즈를 저감하는 장치의 구성을 나타내는 블록도이다. 도 5를 참조하면, 일 실시예에 따른 압축 영상의 노이즈를 저감하는 장치는 노이즈 추출부 및 영상 복원부를 포함한다. 노이즈 추출부는 컨볼루션 필터, 감산부, 및 필터 설정부를 포함 하고, 영상 복원부는 아티팩트 저감용 DNN, 합산부, 및 AI 설정부를 포함할 수 있다. 도 5에는 노이즈 추출부 및 영상 복원부가 개별적인 장치로 도시되어 있으나, 노이즈 추출부 및 영상 복원부는 하나의 프로세서를 통해 구현될 수 있다. 이 경우, 노이즈 추출부 및 영상 복원부 는 전용 프로세서로 구현될 수도 있고, AP(application processor) 또는 CPU(central processing unit), GPU(graphic processing unit)와 같은 범용 프로세서와 S/W의 조합을 통해 구현될 수도 있다. 또한, 전용 프로 세서의 경우, 본 개시의 실시예를 구현하기 위한 메모리를 포함하거나, 외부 메모리를 이용하기 위한 메모리 처리부를 포함할 수 있다. 노이즈 추출부 및 영상 복원부는 복수의 프로세서로 구성될 수도 있다. 이 경우, 전용 프로세서들의 조합으로 구현될 수도 있고, AP 또는 CPU, GPU와 같은 다수의 범용 프로세서들과 S/W의 조합을 통해 구현될 수 도 있다. 일 실시예에서, 컨볼루션 필터 및 감산부는 제 1 프로세서로 구현되고, 아티팩트 저감용 DNN 및 합산부는 제 1 프로세서와 상이한 제 2 프로세서로 구현되고, 필터 설정부 및 AI 설정부 는 제 1 프로세서 및 제 2 프로세서와 상이한 제 3 프로세서로 구현될 수 있다. 필터 설정부는 미리 결정된 기준에 기초하여 압축 영상에 대응되는 훈련된 필터 설정 정보를 컨볼루 션 필터에 제공할 수 있다. 필터 설정부는 압축 영상에 부합하는 제 1 영상의 획득을 위해 필터 설정 정보를 저장할 수 있 다. 필터 설정 정보는 압축 영상의 저주파수 및 중간주파수 정보를 가지는 제 1 영상을 획득하기 위해 훈 련된 것이다. 필터 설정 정보는 필터 커널의 개수, 필터 커널의 크기, 필터 커널의 파라미터 등을 포함할 수 있다. 컨볼루션 필터는 필터 설정부로부터 제공된 필터 설정 정보에 따라 다운 컨볼루션 및 업 컨볼루션을 순차적으로 수행한다. 컨볼루션 필터는 필터 설정부로부터 제공된 필터 설정 정보를 이욯아ㅕ 압축 영상을 입력으로하 여 제 1 영상을 출력한다. 감산부는 압축 영상으로부터 컨볼루션 필터를 적용하여 출력된 제 1 영상을 감산한다. 감산부는 감산 결과, 압축 영상의 고주파수 정보와 압축 아티팩트를 포함하는 노이즈를 가지는 제 2 영상 를 출력한다. AI 설정부는 미리 결정된 기준에 따라 제 2 영상에 대응되는 훈련된 DNN 설정 정보를 아티팩트 저감 용 DNN에 제공한다. AI 설정부는 제 2 영상에 포함되는 압축 아티팩트가 저감된 제 3영상의 획득을 위해 DNN 설정 정보를 저장할 수 있다. DNN 설정 정보는 압축 영상의 고주파수 정보 및 압축 아티팩트를 가지는 제 2 영상에서 압축 아티팩 트가 제거된 제 3 영상을 획득하기 위해 훈련된 것이다. DNN 설정 정보는 아티팩트 저감용 DNN에 포함되는 컨볼루션 레이어의 수, 컨볼루션 레이어별 필터 커널의 개수 및 각 필터 커널의 파라미터 중 적어도 하나에 대한 정보를 포함할 수 있다. 아티팩트 저감용 DNN은 AI 설정부에서 제공된 DNN 설정 정보를 이용하여 제 2 영상을 입력으로 하여 제 2 영상에 포함된 압축 아티팩트가 제거된 제 3 영상를 출력한다. 합산부는 노이즈 추출부의 컨볼루션 필터를 통해 출력된 제 1 영상과 아티팩트 저감용 DNN(56 0)을 통해 출력된 제 3 영상을 합산하여 복원 영상을 출력한다. 제 1 영상은 압축 영상의 저주파수 및 중 간주파수 정보를 가지고, 제 3 영상은 압축 영상의 고주파수 정보를 가지므로, 합산된 복원 영상은 압축 영상에 서 압축 아티팩트가 제거된 영상이다. 따라서, 일 실시예에 따른 압축 영상의 노이즈를 저감하는 장치는 압축 영상에 포함된 영상 압축시 생성된 압축 아티팩트가 제거된 복원 영상을 획득한다. 도 6은 컨볼루션 필터를 훈련시키는 방법을 설명하기 위한 예시적인 도면이다. 도 6에서, 원본 훈련 영상은 영상 압축의 대상이 되는 영상이고, 압축 훈련 영상은 원본 훈련 영상이 영상 압축된 영상이고, 제 1 훈련 영상은 압축 훈련 영상에 다운 컨볼루션과 업 컨볼루 션을 순차적으로 수행하는 컨볼루션 필터를 적용한 영상이다. 원본 훈련 영상은 정지 영상 또는 복수의 프레임으로 이루어진 동영상을 포함한다. 일 실시예에서, 원본 훈련 영상은 정지 영상 또는 복수의 프레임으로 이루어진 동영상으로부터 추출된 휘도 영상을 포함할 수도 있다. 또한, 일 실시예에서, 원본 훈련 영상은 정지 영상 또는 복수의 프레임으로 이루어진 동영상에서 추 출된 패치 영상을 포함할 수도 있다. 원본 훈련 영상이 복수의 프레임으로 이루어진 경우, 압축 훈련 영상, 제 1 훈련 영상 및 저주파수 및 중간주파수 훈련 영상 역시 복수의 프레임으로 구성된다. 원 본 훈련 영상의 복수의 프레임이 영상 압축되면 압축 훈련 영상의 복수의 프레임이 획득되고, 컨볼루션 필터를 통해 제 1 훈련 영상의 복수의 프레임이 획득될 수 있다. 원본 훈련 영상의 영상 압축을 위해 MPEG-2, H.264, MPEG-4, HEVC, VC-1, VP8, VP9 및 AV1 중 어느 하나 의 코덱이 이용될 수 있다. 도 6을 참조하면, 압축 훈련 영상을 입력으로하여 컨볼루션 필터를 통해 제 1 훈련 영상이 출력 되는 것과 별개로, 압축 훈련 영상으로부터 레거시 주파수 대역 필터를 통해 필터링된 저주파수 및 중간주파수 훈련 영상이 획득된다. 여기서, 레거시 주파수 대역 필터의 차단 주파수는 압축 훈련 영 상의 특성에 따라 달라질 수 있다. 구체적으로, 컨볼루션 필터을 이용하는 것은 압축 영상을 복원가능성이 높은 구조적 정보를 포함하는 저주파수 및 중간주파수 정보와 손상 확률이 높은 고주파수 노이즈의 고주파수 정보 및 아티팩트를 분리하기 위한 것이므로, 레거시 주파수 대역 필터의 차단 주파수는 압축 훈련 영상에 따라 달라질 수 있다. 저주파수 및 중간주파수 훈련 영상은 레거시 주파수 대역 필터를 통해 압축 훈련 영상의 저주파수 및 중간주파수 정보만을 포함하는 영상을 의미한다. 컨볼루션 필터의 훈련을 위해 압축 훈련 영상의 저주파수 및 중간주파수 정보만을 포함하는 저주파수 및 중간주파수 훈련 영상을 획득하는 것이다. 훈련 진행 전 컨볼루션 필터는 미리 결정된 필터 설정 정보로 세팅될 수 있다. 훈련이 진행됨에 따라, 필 터 손실 정보가 결정될 수 있다. 필터 손실 정보는 제 1 훈련 영상과 저주파수 및 중간주파수 훈련 영상의 비교 결과에 기초하여 결정될 수 있다. 필터 손실 정보는 제 1 훈련 영상과 저주파수 및 중간주파수 훈련 영상의 차이에 대한 L1-norm 값, L2-norm 값, SSIM(Structural Similarity) 값, PSNR-HVS(Peak Signal-To-Noise Ratio-Human Vision System) 값, MS-SSIM(Multiscale SSIM) 값, VIF(Variance Inflation Factor) 값 및 VMAF(Video Multimethod Assessment Fusion) 값 중 적어도 하나를 포함할 수 있다. 필터 손실 정보는 제 1 훈련 영상이 저주 파수 및 중간주파수 훈련 영상과 어느 정도로 유사한지를 나타낸다. 필터 손실 정보가 작을수록 제 1 훈련 영상이 저주파수 및 중간주파수 훈련 영상에 더 유사해진다. 컨볼루션 필터는 필터 손실 정보가 감소 또는 최소화되도록 파라미터를 갱신할 수 있다. 컨볼루션 필터의 최종 손실 정보는 아래의 수학식 1과 같이 결정될 수 있다. [수학식 1] LossCF = a*필터 손실 정보 상기 수학식 1에서, LossCF는 컨볼루션 필터의 훈련을 위해 감소 또는 최소화되어야 할 최종 손실 정보를 나타내고, a는 미리 결정된 가중치에 해당할 수 있다. 즉, 컨볼루션 필터는 수학식 1의 LossCF가 감소되는 방향으로 파라미터들을 갱신하게 된다. 훈련 과정에서 도출된 LossCF에 따라 컨볼루션 필터의 파라미터들이 갱신되면, 갱신된 파라미터에 기초하여 획득되는 제 1 훈련 영상이 이전 훈련 과정에서의 제 1 훈련 영상과 달라지게 된다. 도 7은 AI 아티팩트 저감용 DNN을 훈련시키는 방법을 설명하기 위한 예시적인 도면이다. 도 7에서, 원본 훈련 영상은 복원 훈련 영상의 비교 대상이 되는 영상이고, 압축 훈련 영상은 원본 훈련 영상이 영상 압축된 영상이다. 제 1 훈련 영상은 압축 훈련 영상에 도 6에서의 훈련 과정을 통해 훈련이 완료된 컨볼루션 필터가 적용된 영상이다. 제 2 훈련 영상은 압축 훈련 영상 로부터 제 1 훈련 영상을 감산한 영상이고, 제 3 훈련 영상은 제 2 훈련 영상을 입력 으로하여 AI 아티팩트 저감용 DNN을 통해 출력된 영상이고, 본원 훈련 영상은 제 1 훈련 영상과 제 3 훈련 영상을 합산한 영상이다. 여기서, 제 1 훈련 영상은 압축 훈련 영상에 훈련이 완료된 컨볼루션 필터가 적용된다. 이는 컨 볼루션 필터는 저주파수 및 중간주파수 정보를 가지는 제 1 영상과 고주파수 정보 및 압축 아티팩트 를 가지는 제 2 영상을 효과적으로 분리하기 위해 훈련되는 것이고, AI 아티팩트 저감용 DNN은 제 2영상의 압축 아티팩트를 효과적으로 제거하기 위해 훈련되는 것이기 때문이다. 즉, 컨볼루션 필터와 AI 아티팩트 저감용 DNN은 독립적으로 훈련되어야 한다. 원본 훈련 영상은 정지 영상 또는 복수의 프레임으로 이루어진 동영상을 포함한다. 일 실시예에서, 원본 훈련 영상은 정지 영상 또는 복수의 프레임으로 이루어진 동영상으로부터 추출된 휘도 영상을 포함할 수도 있다. 또한, 일 실시예에서, 원본 훈련 영상은 정지 영상 또는 복수의 프레임으로 이루어진 동영상에서 추 출된 패치 영상을 포함할 수도 있다. 원본 훈련 영상이 복수의 프레임으로 이루어진 경우, 압축 훈련 영상 , 제 1 훈련 영상, 제 2 훈련 영상, 및 제 3 훈련 영상 역시 복수의 프레임으로 구성된다. 원본 훈련 영상의 복수의 프레임이 영상 압축되면 압축 훈련 영상의 복수의 프레임이 획득되고, 훈련이 완료된 컨볼루션 필터를 통해 제 1 훈련 영상의 복수의 프레임이 획득되고, 압축 훈련 영상 으로부터 제 1 훈련 영상의 감산을 통해 제 2 훈련 영상의 복수의 프레임이 획득되고, AI 아티팩트 저감용 DNN을 통해 제 3 훈련 영상의 복수의 프레임이 획득되고, 제 1 훈련 영상과 제 3 훈련 영상의 합산을 통해 복원 훈련 영상의 복수의 프레임이 획득된다. 훈련 진행 전 AI 아티팩트 저감용 DNN는 미리 결정된 DNN 설정 정보로 세팅될 수 있다. 훈련이 진행됨에 따라, 저감 손실 정보가 결정될 수 있다. 저감 손실 정보는 원본 훈련 영상과 복원 훈련 영상의 비교 결과에 기초하여 결정될 수 있다. 저감 손실 정보는 원본 훈련 영상과 복원 훈련 영상의 차이에 대한 L1-norm 값, L2-norm 값, SSIM(Structural Similarity) 값, PSNR-HVS(Peak Signal-To-Noise Ratio-Human Vision System) 값, MS- SSIM(Multiscale SSIM) 값, VIF(Variance Inflation Factor) 값 및 VMAF(Video Multimethod Assessment Fusion) 값 중 적어도 하나를 포함할 수 있다. 저감 손실 정보는 복원 훈련 영상이 원본 훈련 영상 과 어느 정도로 유사한지를 나타낸다. 저감 손실 정보가 작을수록 복원 훈련 영상이 원본 훈련 영상에 더 유사해진다. 즉, 원본 훈련 영상이 영상 압축되어 생성된 압축 아티팩트가 저감된 복원 훈련 영 상이 획득된다. AI 아티팩트 저감용 DNN는 저감 손실 정보가 감소 또는 최소화되도록 파라미터를 갱신할 수 있다. AI 아티팩트 저감용 DNN의 최종 손실 정보는 아래의 수학식 2와 같이 결정될 수 있다. [수학식 2] LossAR = b*저감 손실 정보 상기 수학식 2에서, LossAR는 AI 아티팩트 저감용 DNN의 훈련을 위해 감소 또는 최소화되어야 할 최종 손 실 정보를 나타내고, b는 미리 결정된 가중치에 해당할 수 있다. 즉, AI 아티팩트 저감용 DNN는 수학식 2의 LossAR가 감소되는 방향으로 파라미터들을 갱신하게 된다. 훈련 과정에서 도출된 LossAR에 따라 AI 아티팩트 저감용 DNN의 파라미터들이 갱신되면, 갱신된 파라미터에 기 초하여 획득되는 제 3 훈련 영상이 이전 훈련 과정에서의 제 3 훈련 영상과 달라지게 된다. 도 8은 일 실시예에 따른 압축 영상의 노이즈를 추출하는 방법 방법을 설명하기 위한 순서도이다. S810 단계에서, 압축 영상의 노이즈를 추출하는 장치는 원본 영상의 압축 영상에 다운 컨볼루션 및 상기 다운 컨볼루션에 대응되는 업 컨볼루션을 순차적으로 수행하는 컨볼루션 필터를 적용함으로써 제1 영상을 획득 한다. 일 실시예에 따라, 제1 영상은 상기 압축 영상의 중간 주파수 정보 및 저주파수 정보를 포함할 수 있다. 일 실시예에 따라, 컨볼루션 필터는 압축 영상을 입력으로 하여 압축 영상의 중간 주파수 정보 및 저주파수 정 보를 포함하는 제1 영상을 획득하도록 훈련될 수 있다. 일 실시예에 따라, 다운 컨볼루션은 압축 영상의 크기를 줄이도록 훈련된 컨볼루션 연산일 수 있다. 일 실시예에 따라, 업 컨볼루션은 다운 컨볼루션된 압축 영상을 상기 압축 영상의 원래 크기로 늘리도록 훈련된 컨볼루션 연산일 수 있다. 일 실시예에 따라, 다운 컨볼루션과 업 컨볼루션은 전치(transpose)된 것일 수 있다. S830 단계에서, 압축 영상의 노이즈를 추출하는 장치는 상기 압축 영상으로부터 상기 제1 영상을 감산한 제2 영상을 획득한다. S850 단계에서, 압축 영상의 노이즈를 추출하는 장치는 상기 제2 영상으로부터 상기 압축 영상의 고주파수 정보 및 압축 아티팩트를 포함하는 노이즈를 획득한다. 도 9는 일 실시예에 따른 압축 영상의 노이즈를 저감하는 방법 방법을 설명하기 위한 순서도이다. S910 단계에서, 압축 영상의 노이즈를 저감하는 장치는 원본 영상의 압축 영상에 다운 컨볼루션 및 상기 다운 컨볼루션에 대응되는 업 컨볼루션을 순차적으로 수행하는 컨볼루션 필터를 적용함으로써 제1 영상을 획득 한다. 일 실시예에 따라, 제1 영상은 상기 압축 영상의 중간 주파수 정보 및 저주파수 정보를 포함할 수 있다. 일 실시예에 따라, 컨볼루션 필터는 압축 영상을 입력으로 하여 압축 영상의 중간 주파수 정보 및 저주파수 정 보를 포함하는 제1 영상을 획득하도록 훈련될 수 있다. 일 실시예에 따라, 다운 컨볼루션은 압축 영상의 크기를 줄이도록 훈련된 컨볼루션 연산일 수 있다. 일 실시예에 따라, 업 컨볼루션은 다운 컨볼루션된 압축 영상을 상기 압축 영상의 원래 크기로 늘리도록 훈련된 컨볼루션 연산일 수 있다. 일 실시예에 따라, 다운 컨볼루션과 업 컨볼루션은 전치(transpose)된 것일 수 있다. S930 단계에서, 압축 영상의 노이즈를 저감하는 장치는 상기 압축 영상으로부터 상기 제1 영상을 감산한 제2 영상을 획득한다. S950 단계에서, 압축 영상의 노이즈를 저감하는 장치는 상기 제2 영상으로부터 상기 압축 영상의 고주파수 정보 및 압축 아티팩트를 포함하는 노이즈를 획득한다. S970 단계에서, 압축 영상의 노이즈를 저감하는 장치는 상기 노이즈에 압축 아티팩트 제거용 DNN을 적용하 여 압축 아티팩트를 제거하여 제3 영상을 획득한다. 일 실시예에 따라, 압축 아티팩트 제거용 DNN은 상기 압축 영상의 고주파수 정보 및 압축 아티팩트를 입력으로 하여 상기 압축 아티팩트를 저감하도록 훈련된 것일 수 있다. 일 실시예에 따라, 압축 아티팩트 제거용 DNN은 컨볼루션 레이어 및 활성화 레이어를 포함할 수 있다. 일 실시예에 따라, 압축 아티팩트 제거용 DNN은 배치 정규화 레이어를 추가로 포함할 수 있다. S990 단계에서, 압축 영상의 노이즈를 저감하는 장치는 상기 제1 영상과 상기 제3 영상을 합산하여 상기 압축 영상을 복원한다. 한편, 상술한 본 개시의 실시예들은 컴퓨터에서 실행될 수 있는 프로그램 또는 인스트럭션으로 작성가능하고, 작성된 프로그램 또는 인스트럭션은 매체에 저장될 수 있다. 매체는 컴퓨터로 실행 가능한 프로그램 또는 인스트럭션을 계속 저장하거나, 실행 또는 다운로드를 위해 임시 저장하는 것일 수도 있다. 또한, 매체는 단일 또는 수개 하드웨어가 결합된 형태의 다양한 기록수단 또는 저장 수단일 수 있는데, 어떤 컴퓨터 시스템에 직접 접속되는 매체에 한정되지 않고, 네트워크 상에 분산 존재하는 것일 수도 있다. 매체의 예시로는, 하드 디스크, 플로피 디스크 및 자기 테이프와 같은 자기 매체, CD-ROM 및 DVD와 같은 광기록 매체, 플롭티컬 디스크(floptical disk)와 같은 자기-광 매체(magneto-optical medium), 및 ROM, RAM, 플래시 메모리 등을 포함하여 프로그램 명령어가 저장되도록 구성된 것이 있을 수 있다. 또한, 다른 매체의 예시로, 애플리케이션을 유통하는 앱 스토어나 기타 다양한 소프트웨어를 공급 내지 유통하는 사이트, 서버 등에서 관리하는 기록매체 내지 저장매체도 들 수 있다. 한편, 상술한 DNN과 관련된 모델은, 소프트웨어 모듈로 구현될 수 있다. 소프트웨어 모듈(예를 들어, 명령어 (instruction)를 포함하는 프로그램 모듈)로 구현되는 경우, DNN 모델은 컴퓨터로 읽을 수 있는 판독 가능한 기 록매체에 저장될 수 있다. 또한, DNN 모델은 하드웨어 칩 형태로 집적되어 전술한 AI 복호화 장치 또는 AI 부호화 장치의 일부 가 될 수도 있다. 예를 들어, DNN 모델은 인공 지능을 위한 전용 하드웨어 칩 형태로 제작될 수도 있고, 또는 기존의 범용 프로세서(예를 들어, CPU 또는 애플리케이션 프로세서) 또는 그래픽 전용 프로세서(예를 들어, GPU)의 일부로 제작될 수도 있다.또한, DNN 모델은 다운로드 가능한 소프트웨어 형태로 제공될 수도 있다. 컴퓨터 프로그램 제품은 제조사 또는 전자 마켓을 통해 전자적으로 배포되는 소프트웨어 프로그램 형태의 상품(예를 들어, 다운로드 가능한 애플리케 이션)을 포함할 수 있다. 전자적 배포를 위하여, 소프트웨어 프로그램의 적어도 일부는 저장 매체에 저장되거나, 임시적으로 생성될 수 있다. 이 경우, 저장 매체는 제조사 또는 전자 마켓의 서버, 또는 중계 서버 의 저장매체가 될 수 있다. 이상, 본 개시의 기술적 사상을 바람직한 실시예를 들어 상세하게 설명하였으나, 본 개시의 기술적 사상은 상기 실시예들에 한정되지 않고, 본 개시의 기술적 사상의 범위 내에서 당 분야에서 통상의 지식을 가진 자에 의하여 여러 가지 변형 및 변경이 가능하다."}
{"patent_id": "10-2020-0158043", "section": "도면", "subsection": "도면설명", "item": 1, "content": "본 명세서에서 인용되는 도면을 보다 충분히 이해하기 위하여 각 도면의 간단한 설명이 제공된다. 도 1은 일 실시예에 따른 압축 영상의 노이즈를 추출하고 저감하는 방법을 설명하기 위한 도면이다. 도 2는 컨볼루션 필터에서 수행되는 다운 컨볼루션과 업 컨볼루션 연산을 나타내는 예시적인 도면이다. 도 3은 압축 아티팩트를 제거하기 위한 DNN을 나타내는 예시적인 도면이다. 도 4는 일 실시예에 따른 압축 영상의 노이즈를 추출하는 장치의 구성을 나타내는 블록도이다. 도 5는 일 실시예에 따른 압축 영상의 노이즈를 저감하는 장치의 구성을 나타내는 블록도이다. 도 6은 컨볼루션 필터를 훈련시키는 방법을 설명하기 위한 예시적인 도면이다. 도 7은 AI 아티팩트 저감용 DNN을 훈련시키는 방법을 설명하기 위한 예시적인 도면이다. 도 8은 일 실시예에 따른 압축 영상의 노이즈를 추출하는 방법 방법을 설명하기 위한 순서도이다. 도 9는 일 실시예에 따른 압축 영상의 노이즈를 저감하는 방법 방법을 설명하기 위한 순서도이다."}
