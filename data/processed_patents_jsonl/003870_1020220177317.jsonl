{"patent_id": "10-2022-0177317", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2024-0094763", "출원번호": "10-2022-0177317", "발명의 명칭": "학습 데이터 증강을 위한 장치 및 방법", "출원인": "현대오토에버 주식회사", "발명자": "허민오"}}
{"patent_id": "10-2022-0177317", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "메모리; 및상기 메모리와 연결된 프로세서를 포함하고, 상기 프로세서는,현실세계의 현실 이미지를 기반으로 복수의 가상 이미지를 생성하고, 상기 현실 이미지와 가상 이미지의 유사도에 기반하여 골든 페어(golden pair)를 생성하며, 상기 현실 이미지 및 가상 이미지에 대해 도메인 적응(DomainAdaptation) 학습을 수행하는 것을 특징으로 하는 학습 데이터 증강을 위한 장치."}
{"patent_id": "10-2022-0177317", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서, 상기 프로세서는, 상기 현실 이미지에 대해 거리, 피치 및 요 중 적어도 하나를 변경함으로써, 상기 현실 이미지에 대한 복수의가상 이미지를 생성하는 것을 특징으로 하는 학습 데이터 증강을 위한 장치."}
{"patent_id": "10-2022-0177317", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1항에 있어서, 상기 프로세서는, 상기 현실 이미지, 가상 이미지, 정상 데이터, 및 비정상 데이터를 레이블링하는 것을 것을 특징으로 하는 학습데이터 증강을 위한 장치."}
{"patent_id": "10-2022-0177317", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제1항에 있어서, 상기 프로세서는,각 현실 이미지와 해당 현실 이미지에 기초하여 생성된 가상 이미지들간의 유사도를 각각 산출하고, 해당 현실이미지와 유사도가 가장 높은 가상 이미지를 해당 현실 이미지와 페어링함으로써, 현실 이미지와 가상 이미지의쌍을 의미하는 골든 페어를 생성하는 것을 특징으로 하는 학습 데이터 증강을 위한 장치."}
{"patent_id": "10-2022-0177317", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제1항에 있어서, 상기 프로세서는,Domain Adversarial 학습(training)을 수행하는 것을 특징으로 하는 학습 데이터 증강을 위한 장치."}
{"patent_id": "10-2022-0177317", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "공개특허 10-2024-0094763-3-제5항에 있어서, 상기 프로세서는,상기 현실 이미지와 가상 이미지를 벡터로 변환하고,상기 벡터로 변환된 이미지 중에서 골든 페어의 현실 이미지와 가상 이미지에 대해 Triplet loss를 수행하며,상기 Triplet loss를 수행한 이미지에 대해 제1 분류기를 통해 정상과 비정상을 구별하도록 하고, 상기 Triplet loss를 수행한 이미지에 대해 제2 분류기를 통해 가상 이미지와 현실 이미지가 구별되지 않도록하는 것을 특징으로 하는 학습 데이터 증강을 위한 장치."}
{"patent_id": "10-2022-0177317", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "프로세서가, 현실세계의 현실 이미지를 기반으로 복수의 가상 이미지를 생성하는 단계;상기 프로세서가, 상기 현실 이미지와 가상 이미지의 유사도에 기반하여 골든 페어(golden pair)를 생성하는 단계; 및상기 프로세서가, 상기 현실 이미지 및 가상 이미지에 대해 도메인 적응(Domain Adaptation) 학습을 수행하는단계를 포함하는 학습 데이터 증강을 위한 방법."}
{"patent_id": "10-2022-0177317", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제7항에 있어서, 상기 복수의 가상 이미지를 생성하는 단계에서, 상기 프로세서는, 상기 현실 이미지에 대해 거리, 피치 및 요 중 적어도 하나를 변경함으로써, 상기 현실 이미지에 대한 복수의 가상 이미지를 생성하는 것을 특징으로 하는 학습 데이터 증강을 위한 방법."}
{"patent_id": "10-2022-0177317", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제7항에 있어서, 상기 복수의 가상 이미지를 생성하는 단계에서, 상기 프로세서는, 상기 현실 이미지, 가상 이미지, 정상 데이터, 및 비정상 데이터를 레이블링하는 것을 것을특징으로 하는 학습 데이터 증강을 위한 방법."}
{"patent_id": "10-2022-0177317", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제7항에 있어서, 상기 골든 페어를 생성하는 단계에서, 상기 프로세서는, 각 현실 이미지와 해당 현실 이미지에 기초하여 생성된 가상 이미지들간의 유사도를 각각 산출하고, 해당 현실 이미지와 유사도가 가장 높은 가상 이미지를 해당 현실 이미지와 페어링함으로써, 현실 이미지와 가상 이미지의 쌍을 의미하는 골든 페어를 생성하는 것을 특징으로 하는 학습 데이터 증강을 위한 방법."}
{"patent_id": "10-2022-0177317", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "제7항에 있어서, 공개특허 10-2024-0094763-4-상기 도메인 적응 학습을 수행하는 단계에서, 상기 프로세서는, Domain Adversarial 학습(training)을 수행하는 것을 특징으로 하는 학습 데이터 증강을 위한방법."}
{"patent_id": "10-2022-0177317", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제11항에 있어서, 상기 도메인 적응 학습을 수행하는 단계에서, 상기 프로세서는, 상기 현실 이미지와 가상 이미지를 벡터로 변환하고,상기 벡터로 변환된 이미지 중에서 골든 페어의 현실 이미지와 가상 이미지에 대해 Triplet loss를 수행하며,상기 Triplet loss를 수행한 이미지에 대해 제1 분류기를 통해 정상과 비정상을 구별하도록 하고, 상기 Triplet loss를 수행한 이미지에 대해 제2 분류기를 통해 가상 이미지와 현실 이미지가 구별되지 않도록하는 것을 특징으로 하는 학습 데이터 증강을 위한 방법."}
{"patent_id": "10-2022-0177317", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "학습 데이터 증강을 위한 장치 및 방법이 개시된다. 본 발명의 일 측면에 따른 학습 데이터 증강을 위한 장치는, 메모리, 및 상기 메모리와 연결된 프로세서를 포함하고, 상기 프로세서는, 현실세계의 현실 이미지를 기반으로 복수의 가상 이미지를 생성하고, 상기 현실 이미지와 가상 이미지의 유사도에 기반하여 골든 페어(golden pair) 를 생성하며, 상기 현실 이미지 및 가상 이미지에 대해 도메인 적응(Domain Adaptation) 학습을 수행할 수 있다."}
{"patent_id": "10-2022-0177317", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 학습 데이터 증강을 위한 장치 및 방법에 관한 것으로서, 보다 상세하게는 인공지능 학습에 적용할 수 있는 수준의 학습 데이터를 확보하여, 현실세계의 데이터 불균형 문제를 해결할 수 있도록 하는 학습 데이터 증강을 위한 장치 및 방법에 관한 것이다."}
{"patent_id": "10-2022-0177317", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "최근에는 딥러닝 기술을 이용하여 양불 판정 비전검사를 수행하고 있다. 딥러닝 기반 양불 판정 비전검사를 위해서는 검사 대상의 특성이 충분히 드러나는 다양한 학습 데이터의 확보가 필요하다. 즉, 정상 데이터와 비정상(불량) 데이터가 균형 잡힌 상태로 충분한 양이 확보되어야 하고, 다양한 정상 케이스와 비정상(불량) 케이스가 확보되어야 한다. 이처럼 학습데이터는 학습대상인 모든 객체에 대해서 비슷한 샘플 수를 가질 때 가장 효과가 크다. 그러나, 비정상(불량) 상황은 무수히 많은 경우가 존재하나, 검사 대상이 정상인 경우가 대다수이므로 정작 탐 지해야 하는 비정상(불량) 상황에 대한 데이터를 충분히 확보하기 어렵다. 즉, 현실세계에서 데이터 균형을 맞 춘 학습 샘플을 구축하는 것은 많은 시간과 인력이 필요한 일이며, 불가능한 경우도 존재한다. 또한, 현재 오픈 데이터셋 또는 이미지(영상)의 확보가 용이한 분야가 아닌 대부분의 산업분야들은 충분한 양의 학습 데이터가 없어서 인공지능 기술의 성능을 고도화시키는 것이 어렵다. 이에, 이미지(영상)의 확보가 용이하지 않은 분야에서도 인공지능 학습에 적용할 수 있는 수준의 학습 데이터를 확보하여, 현실세계의 데이터 불균형 문제를 해결할 수 있도록 하는 기술 개발이 요구되고 있다."}
{"patent_id": "10-2022-0177317", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 2, "content": "본 발명의 배경기술은 대한민국 등록특허공보 제10-1964282호(2019.04.01. 공고)에 개시되어 있다."}
{"patent_id": "10-2022-0177317", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명의 목적은 인공지능 학습에 적용할 수 있는 수준의 학습 데이터를 확보하여, 현실세계의 데이터 불균형 문제를 해결할 수 있도록 하는 학습 데이터 증강을 위한 장치 및 방법을 제공하는 것이다."}
{"patent_id": "10-2022-0177317", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명의 일 측면에 따른 학습 데이터 증강을 위한 장치는, 메모리, 및 상기 메모리와 연결된 프로세서를 포함 하고, 상기 프로세서는, 현실세계의 현실 이미지를 기반으로 복수의 가상 이미지를 생성하고, 상기 현실 이미지 와 가상 이미지의 유사도에 기반하여 골든 페어(golden pair)를 생성하며, 상기 현실 이미지 및 가상 이미지에 대해 도메인 적응(Domain Adaptation) 학습을 수행할 수 있다. 본 발명에서 상기 프로세서는, 상기 현실 이미지에 대해 거리, 피치 및 요 중 적어도 하나를 변경함으로써, 상 기 현실 이미지에 대한 복수의 가상 이미지를 생성할 수 있다. 본 발명에서 상기 프로세서는, 상기 현실 이미지, 가상 이미지, 정상 데이터, 및 비정상 데이터를 레이블링할 수 있다. 본 발명에서 상기 프로세서는, 각 현실 이미지와 해당 현실 이미지에 기초하여 생성된 가상 이미지들간의 유사 도를 각각 산출하고, 해당 현실 이미지와 유사도가 가장 높은 가상 이미지를 해당 현실 이미지와 페어링함으로 써, 현실 이미지와 가상 이미지의 쌍을 의미하는 골든 페어를 생성할 수 있다. 본 발명에서 상기 프로세서는, Domain Adversarial 학습(training)을 수행할 수 있다. 본 발명에서 상기 프로세서는, 상기 현실 이미지와 가상 이미지를 벡터로 변환하고, 상기 벡터로 변환된 이미지 중에서 골든 페어의 현실 이미지와 가상 이미지에 대해 Triplet loss를 수행하며, 상기 Triplet loss를 수행한 이미지에 대해 제1 분류기를 통해 정상과 비정상을 구별하도록 하고, 상기 Triplet loss를 수행한 이미지에 대 해 제2 분류기를 통해 가상 이미지와 현실 이미지가 구별되지 않도록 할 수 있다. 본 발명의 다른 측면에 따른 학습 데이터 증강을 위한 방법은, 프로세서가, 현실세계의 현실 이미지를 기반으로 복수의 가상 이미지를 생성하는 단계, 상기 프로세서가, 상기 현실 이미지와 가상 이미지의 유사도에 기반하여 골든 페어(golden pair)를 생성하는 단계, 및 상기 프로세서가, 상기 현실 이미지 및 가상 이미지에 대해 도메 인 적응(Domain Adaptation) 학습을 수행하는 단계를 포함한다. 본 발명은 상기 복수의 가상 이미지를 생성하는 단계에서, 상기 프로세서는, 상기 현실 이미지에 대해 거리, 피 치 및 요 중 적어도 하나를 변경함으로써, 상기 현실 이미지에 대한 복수의 가상 이미지를 생성할 수 있다. 본 발명은 상기 복수의 가상 이미지를 생성하는 단계에서, 상기 프로세서는, 상기 현실 이미지, 가상 이미지, 정상 데이터, 및 비정상 데이터를 레이블링할 수 있다. 본 발명은 상기 골든 페어를 생성하는 단계에서, 상기 프로세서는, 각 현실 이미지와 해당 현실 이미지에 기초 하여 생성된 가상 이미지들간의 유사도를 각각 산출하고, 해당 현실 이미지와 유사도가 가장 높은 가상 이미지 를 해당 현실 이미지와 페어링함으로써, 현실 이미지와 가상 이미지의 쌍을 의미하는 골든 페어를 생성할 수 있 다. 본 발명은 상기 도메인 적응 학습을 수행하는 단계에서, 상기 프로세서는, Domain Adversarial 학습(training) 을 수행할 수 있다. 본 발명은 상기 도메인 적응 학습을 수행하는 단계에서, 상기 프로세서는, 상기 현실 이미지와 가상 이미지를 벡터로 변환하고, 상기 벡터로 변환된 이미지 중에서 골든 페어의 현실 이미지와 가상 이미지에 대해 Triplet loss를 수행하며, 상기 Triplet loss를 수행한 이미지에 대해 제1 분류기를 통해 정상과 비정상을 구별하도록 하고, 상기 Triplet loss를 수행한 이미지에 대해 제2 분류기를 통해 가상 이미지와 현실 이미지가 구별되지 않 도록 할 수 있다."}
{"patent_id": "10-2022-0177317", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명의 일 실시예에 따른 학습 데이터 증강을 위한 장치 및 방법은, 현실 이미지를 기반으로 가상 이미지를 생성하고, Triplet loss 기반 골든 페어(golden pair)를 생성하여 도메인 적응(Domain Adaptation) 학습을 수 행함으로써, 현실 이미지와 가상 이미지가 호환되어 양측 데이터를 효율적으로 함께 쓸 수 있고, 다양한 케이스 (정상 케이스, 비정상 케이스)에 대한 양질의 학습 데이터를 확보할 수 있다. 본 발명의 일 실시예에 따른 학습 데이터 증강을 위한 장치 및 방법은, 인공지능 학습에 적용할 수 있는 수준의 학습 데이터를 확보함으로써, 현실세계의 데이터 불균형 문제를 해결할 수 있고, 학습 데이터 제작에 필요한 작 업 공수를 줄일 수 있다. 본 발명의 일 실시예에 따른 학습 데이터 증강을 위한 장치 및 방법은, 현실 이미지를 기반으로 복수의 가상 이 미지를 생성 현실세계와 유사한 가상환경을 생성하여 현실 도메인과 가상 도메인간의 격차를 최소화한 후, 도메인 적응(Domain Adaptation)을 실행하여 가상영상의 실사화 효과를 극대화시킬 수 있다. 본 발명의 일 실시예에 따른 학습 데이터 증강을 위한 장치 및 방법은, 현실 세계에서 구축하기 힘든 학습 샘플 을 생성함으로써 전반적으로 비전검사기의 양불 판정 성능을 향상시킬 수 있다."}
{"patent_id": "10-2022-0177317", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하, 첨부된 도면들을 참조하여 본 발명의 일 실시예에 따른 학습 데이터 증강을 위한 장치 및 방법을 설명한 다. 이 과정에서 도면에 도시된 선들의 두께나 구성요소의 크기 등은 설명의 명료성과 편의상 과장되게 도시되 어 있을 수 있다. 또한, 후술되는 용어들은 본 발명에서의 기능을 고려하여 정의된 용어들로서 이는 사용자, 운 용자의 의도 또는 관례에 따라 달라질 수 있다. 그러므로 이러한 용어들에 대한 정의는 본 명세서 전반에 걸친 내용을 토대로 내려져야 할 것이다. 도 1은 본 발명의 일 실시예에 따른 학습 데이터 증강을 위한 장치를 설명하기 위한 블록도, 도 2 및 도 3은 본 발명의 일 실시예에 따른 현실 이미지 기반으로 생성된 가상 이미지를 설명하기 위한 예시도, 도 4는 본 발명의 일 실시예에 따른 도메인 적응 학습을 설명하기 위한 도면, 도 5는 본 발명의 일 실시예에 따른 도메인 적응 학 습 전/후의 벡터 분포를 나타낸 예시도이다. 도 1을 참조하면, 본 발명의 일 실시예에 따른 학습 데이터 증강을 위한 장치는 메모리, 사용자 인터 페이스 및 프로세서를 포함한다. 메모리는 학습 데이터 증강을 위한 장치의 동작과 관련된 데이터들을 저장하는 구성이다. 특히, 메모 리에는 현실세계의 현실 이미지를 기반으로 복수의 가상 이미지를 생성하고, 현실 이미지와 가상 이미지의 유사도에 기반하여 골든 페어(golden pair)를 생성하며, 현실 이미지 및 가상 이미지에 대해 도메인 적응 (Domain Adaptation) 학습을 수행하도록 하는 프로그램(어플리케이션 또는 애플릿) 등이 저장될 수 있으며, 저 장되는 정보들은 필요에 따라 프로세서에 의해 취사 선택될 수 있다. 즉, 메모리에는 학습 데이터 증 강을 위한 장치의 구동을 위한 운영 체제나 프로그램(어플리케이션 또는 애플릿)의 실행 과정에서 발생되 는 여러 종류가 데이터가 저장된다. 이때, 메모리는 전원이 공급되지 않아도 저장된 정보를 계속 유지하는 비휘발성 저장장치 및 저장된 정보를 유지하기 위하여 전력이 필요한 휘발성 저장장치를 통칭하는 것이다. 또한, 메모리는 프로세서가 처리하는 데이터를 일시적 또는 영구적으로 저장하는 기능을 수행할 수 있다. 여기서, 메모리는 저장된 정보를 유지하기 위하여 전력이 필요한 휘발성 저장장치 외에 자기 저장 매체(magnetic storage media) 또는 플래시 저장 매체(flash storage media)를 포함할 수 있으나, 본 발명의 범위가 이에 한정되는 것은 아니다. 사용자 인터페이스는 학습 데이터 증강을 위한 장치의 동작을 위해 필요한 정보들을 입력하거나 출력 하기 위해 제공되는 것으로, 입력장치 또는 출력장치로 동작할 수 있다. 사용자 인터페이스가 입력장치로 동작하는 경우, 입력장치는 예컨대, 키보드, 마우스, 터치패드, 터치스크린, 전자펜, 터치 버튼 등으로 구현될 수 있다. 사용자 인터페이스가 출력장치로 동작하는 경우, 출력장치는 예컨대, TFT-LCD(thin film transistor-liquid crystal display) 패널, LED(light emitting diode) 패널, OLED(organic LED) 패널, AMOLED(active matrix OLED) 패널, 또는 플렉서블(flexible) 패널 등으로 구현될 수 있다. 프로세서는 학습 데이터 증강을 위한 장치의 전반적인 동작을 제어할 수 있다. 일 실시 예에 따르면, 프로세서는 집적 회로, 시스템 온 칩, 또는 모바일 AP로 구현될 수 있다.프로세서는 현실세계의 현실 이미지를 기반으로 복수의 가상 이미지를 생성하고, 현실 이미지와 가상 이미 지의 유사도에 기반하여 골든 페어(golden pair)를 획득하며, 현실 이미지 및 가상 이미지에 대해 도메인 적응 (Domain Adaptation) 학습을 수행할 수 있다. 이하. 프로세서의 동작에 대해 구체적으로 설명하기로 한다. 프로세서는, 현실 이미지에 대해 거리, 피치 및 요 중 적어도 하나를 변경함으로써, 현실 이미지에 대한 복수의 가상 이미지를 생성할 수 있다. 이때, 프로세서는 CATIA, Pixyz, Unity3D 등의 3D모델링을 이용하 여 가상 이미지를 생성할 수 있고, NeRF나 GAN과 같은 신경망 기반 생성모델을 이용하여 가상 이미지를 생성할 수도 있다. 예를 들면, 프로세서는 도 2의 (a)에 도시된 정상 체결된 조립나사의 현실 이미지에 대해 거리 5cm, 각도 30도를 변경함으로써, 도 2의 (b)와 같은 가상 이미지를 생성할 수 있다. 또한, 프로세서는 도 3의 (a)에 도시된 비정상으로 체결된 조립나사의 현실 이미지에 대해 거리 5cm, 각도 30도를 변경함으로써, 도 3의 (b)와 같은 가상 이미지를 생성할 수 있다. 현실 이미지에 대한 가상 이미지가 생성되면, 프로세서는 현실 이미지, 가상 이미지, 정상 데이터, 및 비 정상 데이터를 각각 레이블링할 수 있다. 즉, 현실 이미지는 정상과 비정상이 정해져 있으므로, 현실 이미지에 기초하여 생성된 가상 이미지는 현실 이미지에 따라 정상과 비정상으로 레이블링될 수 있다. 예를 들어, 정상인 현실 이미지에 기초하여 생성된 가상 이미지는 정상으로 레이블링 될 수 있고, 비정상인 현실 이미지에 기초하 여 생성된 가상 이미지는 비정상으로 레이블링될 수 있다. 레이블링된 충분한 데이터 집합이 생성되면, 프로세서는 현실 이미지와 가상 이미지의 유사도에 기반하여 골든 페어(golden pair)를 획득할 수 있다. 여기서, 골든 페어는 현실 이미지와 가장 유사한 가상 이미지를 페 어링(짝지은) 것을 의미할 수 있다. 따라서, 프로세서는 현실 이미지와 그 현실 이미지에 기초하여 생성된 가상 이미지들간의 유사도를 산출하고, 유사도가 가장 높은 가상 이미지와 현실 이미지를 골든 페어로 확보할 수 있다. 이때, 프로세서는 Feature Matching, 히스토그램, MSE(mean square error) 등 영상처리 및 컴퓨 터비전 분야의 다양한 방법을 이용하여 가상 이미지와 현실 이미지간의 유사도를 산출할 수 있다. 골든 페어가 확보되면, 프로세서는 현실 이미지 및 가상 이미지에 대해 도메인 적응(Domain Adaptation) 학습을 수행할 수 있다. 이때, 프로세서는 Domain Adversarial 학습(training)을 수행할 수 있다. 구체적으로, 프로세서는 현실 이미지와 가상 이미지를 벡터로 변환하고, 벡터로 변환된 이미지 중에서 골 든 페어의 현실 이미지와 가상 이미지에 대해 Triplet loss를 수행하며, Triplet loss를 수행한 이미지에 대해 제1 분류기를 통해 정상과 비정상을 구별하도록 하고, Triplet loss를 수행한 이미지에 대해 제2 분류기를 통해 가상 이미지와 현실 이미지가 구별되지 않도록 할 수 있다. 예를 들어, 도 4를 참조하면, 프로세서는 Resnet-101, Compact CNN 등의 백본망을 통해 현실 이미지와 가 상 이미지를 은닉공간 상의 벡터로 변환할 수 있다. 즉, 프로세서는 현실 이미지와 가상 이미지에 대해 특 징 벡터를 추출할 수 있다. 그런 후, 프로세서는 벡터로 변환된 이미지 중에서 골든 페어의 현실 이미지와 가상 이미지에 대해 Triplet loss를 수행할 수 있다. 예를 들어, 골드 페어된 이미지 중에서 현실 이미지를 anchor로 설정하는 경우 Triplet loss에 대해 설명하기로 한다. 이 경우, 프로세서는 anchor로 설정된 현실 이미지와 골드 페어된 가상 이미지를 positive로 설정하 고, positive로 설정된 가상 이미지를 제외한 나머지 이미지 중에서 랜덤하게 이미지를 선택하여, negative로 설정할 수 있다. 그런 후, 프로세서는 Domain Adversarial training을 수행할 수 있다. 즉, 프로세서는 Triplet loss 를 수행한 이미지에 대해 제1 분류기를 통해 정상과 비정상을 구별하도록 하고, Triplet loss를 수행한 이미지 에 대해 제2 분류기를 통해 가상 이미지와 현실 이미지가 구별되지 않도록 할 수 있다. 이때, 프로세서는 현실 이미지와 가상 이미지가 벡터 표현 공간에서 서로 구별되지 않도록 학습하기 위해 negative gradient로 backpropagation을 수행할 수 있다. 제1 분류기는 예컨대, MLP(multi-layer perseptron)로 구성될 수 있고, Cross Entropy Loss를 가지고 학습함으 로써, 정상 및 비정상을 분류하기 위한 가중치(weight)가 조정될 수 있다. 제2 분류기는 예컨대, MLP(multi- layer perseptron)로 구성될 수 있고, Cross Entropy Loss를 가지고 학습함으로써, 현실 이미지와 가상 이미지를 분류하기 위한 가중치(weight)가 조정될 수 있다. 이러한 제1 분류기와 제2 분류기는, Triplet loss를 수행 한 현실 이미지와 가상 이미지 간의 확률 분포를 유사하게 학습할 수 있다. 상기와 같은 도메인 적응을 수행함으로써, 다양한 연출 생성이 쉬운 가상 이미지를 현실 이미지와 호환되게 보 이게 하여 AI 비전 품질 검사 성능을 고도화할 수 있다. 예를 들면, 현실 이미지와 가상 이미지를 백본망에 입력하게 되면, 도 5의 (a)와 같은 결과가 출력될 수 있다. (a)를 참조하면, 가상 이미지와 현실 이미지는 명확히 구분되나, 정상과 비정상(불량)이 섞여 있어 분류 성능이 나쁘다는 것을 확인할 수 있다. 또한, 가상 이미지와 현실 이미지의 정상 및 비정상 판정만을 학습하게 되면, 도 5의 (b)와 같은 결과가 출력될 수 있다. (b)를 참조하면, 가상 이미지와 현실 이미지의 정상과 비정상(불량) 위주로 분류함을 확인할 수 있다. 또한, 본 발명에 따른 도메인 적응을 포함하여 학습하게 되면, 도 5의 (c)와 같은 결과가 출력될 수 있다. (c)를 참조하면, 가상 이미지와 현실 이미지가 섞이도록 학습되면서 정상과 비정 상이 분류되어 있음을 확인할 수 있다. 상기와 같이 구성된 학습 데이터 증강을 위한 장치는 현실세계에서 부족한 학습 샘플 군을 생성함으로써, 현실세계의 데이터 균형을 맞출 수 있다. 또한, 학습 데이터 증강을 위한 장치는 DA 기술을 활용함으로써, 가상 이미지와 현실 이미지 간의 격차를 최소화할 수 있다. 또한, 학습 데이터 증강을 위한 장치는 현실 이미지를 기반으로 가상 이미지를 생성하여 현실 도메인과 가상 도메인간의 격차를 최소화한 후, DA를 실행하여 가상 이미지의 실사화 효과를 극대화시킬 수 있다. 또한, 학습 데이터 증강을 위한 장치는 실제 세계에서 부족한 학습 샘플을 현실 이미지 기반으로 생성된 가상 이미지를 추가함으로써, 양질의 학습 데이터를 신속하게 확보할 수 있으며, 동시에 데이터 불균형 문제를 해결할 수 있다. 도 6은 본 발명의 일 실시예에 따른 학습 데이터 증강을 위한 방법을 설명하기 위한 흐름도이다. 도 6을 참조하면, 프로세서는 현실세계의 현실 이미지를 기반으로 복수의 가상 이미지를 생성한다(S602). 이때, 프로세서는 현실 이미지에 대해 거리, 피치 및 요 중 적어도 하나를 변경함으로써, 현실 이미지에 대한 복수의 가상 이미지를 생성할 수 있다. S602 단계가 수행되면, 프로세서는 현실 이미지, 가상 이미지, 정상 데이터, 및 비정상 데이터를 각각 레 이블링한다(S604). 즉, 현실 이미지는 정상과 비정상이 정해져 있으므로, 현실 이미지에 기초하여 생성된 가상 이미지는 현실 이미지에 따라 정상과 비정상으로 레이블링될 수 있다. S604 단계가 수행되면, 프로세서는 현실 이미지와 가상 이미지의 유사도에 기반하여 골든 페어(golden pair)를 생성한다(S606). 즉, 프로세서는, 각 현실 이미지와 해당 현실 이미지에 기초하여 생성된 가상 이 미지들간의 유사도를 각각 산출하고, 해당 현실 이미지와 유사도가 가장 높은 가상 이미지를 해당 현실 이미지 와 페어링함으로써, 현실 이미지와 가상 이미지의 쌍을 의미하는 골든 페어를 생성할 수 있다. S606 단계가 수행되면, 프로세서는 현실 이미지 및 가상 이미지에 대해 도메인 적응(Domain Adaptation) 학습을 수행한다(S608). 이때 프로세서는, Domain Adversarial 학습(training)을 수행할 수 있다. 즉, 프 로세서는 현실 이미지와 가상 이미지를 벡터로 변환하고, 벡터로 변환된 이미지 중에서 골든 페어의 현실 이미지와 가상 이미지에 대해 Triplet loss를 수행하며, Triplet loss를 수행한 이미지에 대해 제1 분류기를 통 해 정상과 비정상을 구별하도록 하고, Triplet loss를 수행한 이미지에 대해 제2 분류기를 통해 가상 이미지와 현실 이미지가 구별되지 않도록 할 수 있다. 상술한 바와 같이, 본 발명의 일 실시예에 따른 학습 데이터 증강을 위한 장치 및 방법은, 현실 이미지를 기반 으로 가상 이미지를 생성하고, Triplet loss 기반 골든 페어(golden pair)를 생성하여 도메인 적응(Domain Adaptation) 학습을 수행함으로써, 현실 이미지와 가상 이미지가 호환되어 양측 데이터를 효율적으로 함께 쓸 수 있고, 다양한 케이스(정상 케이스, 비정상 케이스)에 대한 양질의 학습 데이터를 확보할 수 있다. 본 발명의 일 실시예에 따른 학습 데이터 증강을 위한 장치 및 방법은, 인공지능 학습에 적용할 수 있는 수준의 학습 데이터를 확보함으로써, 현실세계의 데이터 불균형 문제를 해결할 수 있고, 학습 데이터 제작에 필요한 작 업 공수를 줄일 수 있다. 본 발명의 일 실시예에 따른 학습 데이터 증강을 위한 장치 및 방법은, 현실 이미지를 기반으로 복수의 가상 이 미지를 생성 현실세계와 유사한 가상환경을 생성하여 현실 도메인과 가상 도메인간의 격차를 최소화한 후, DA를 실행하여 가상영상의 실사화 효과를 극대화시킬 수 있다. 본 발명의 일 실시예에 따른 학습 데이터 증강을 위한 장치 및 방법은, 현실 세계에서 구축하기 힘든 학습 샘플 을 생성함으로써 전반적으로 비전검사기의 양불 판정 성능을 향상시킬 수 있다. 본 발명은 도면에 도시된 실시예를 참고로 하여 설명되었으나, 이는 예시적인 것에 불과하며, 당해 기술이 속하 는 분야에서 통상의 지식을 가진 자라면 이로부터 다양한 변형 및 균등한 타 실시예가 가능하다는 점을 이해할 것이다. 따라서 본 발명의 진정한 기술적 보호범위는 아래의 특허청구범위에 의해서 정하여져야 할 것이다."}
{"patent_id": "10-2022-0177317", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 일 실시예에 따른 학습 데이터 증강을 위한 장치를 설명하기 위한 블록도이다. 도 2 및 도 3은 본 발명의 일 실시예에 따른 현실 이미지 기반으로 생성된 가상 이미지를 설명하기 위한 예시도 이다. 도 4는 본 발명의 일 실시예에 따른 도메인 적응 학습을 설명하기 위한 도면이다. 도 5는 본 발명의 일 실시예에 따른 도메인 적응 학습 전/후의 벡터 분포를 나타낸 예시도이다. 도 6은 본 발명의 일 실시예에 따른 학습 데이터 증강을 위한 방법을 설명하기 위한 흐름도이다."}
