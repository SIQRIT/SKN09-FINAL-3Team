{"patent_id": "10-2020-0064668", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2021-0148514", "출원번호": "10-2020-0064668", "발명의 명칭": "인공신경망을 이용한 코로나19 진단 방법 및 그 장치", "출원인": "주식회사 테렌즈", "발명자": "샤티야버르타 아이치"}}
{"patent_id": "10-2020-0064668", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "컴퓨팅 장치에 의해 수행되는 코로나19 진단 방법에 있어서,제1 특징 추출 레이어 및 폐 이상 징후 분류 레이어를 포함하는 제1 신경망의 학습을 수행하는 단계;학습된 제1 특징 추출 레이어를 기초로 제2 신경망에 포함된 제2 특징 추출 레이어의 전이학습을 수행하는단계;코로나19 흉부 이미지를 기초로 합성 코로나19 흉부 이미지를 생성하는 단계;제2 신경망에 타겟 흉부 이미지를 입력하고, 제2 신경망의 출력 데이터를 기초로 타겟 흉부 이미지에 대한 코로나19 감염 여부를 추정하는 단계;를 포함하는,코로나19 진단 방법."}
{"patent_id": "10-2020-0064668", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1 항에 있어서, 폐 이상 징후 분류 레이어는, 입력된 흉부 이미지를 지정된 카테고리로 분류하고, 분류 결과를 기초로 폐 이상 징후 발병 여부를 추정하는,코로나19 진단 방법."}
{"patent_id": "10-2020-0064668", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1 항에 있어서, 폐 이상 징후 분류 레이어는,입력된 흉부 이미지를 정상(No Finding), 심장비대증(Enlarged Cardiom), 심근병증(Cardiomegaly), 폐 병변(Lung Lesion), 폐 음영(Lung Opacity), 부종(Edema), 폐경화(Consolidation), 폐렴(Pneumonia), 무기폐(Atelectasis), 기흉(Pneumothorax), 흉수(Pleural Effusion), 흉막(Pleural Other), 골절(Fracture) 및 보조장치(Circulatory support devices)중 적어도 하나의 카테고리로 분류하는,코로나19 진단 방법."}
{"patent_id": "10-2020-0064668", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제1 항에 있어서, 합성 코로나19 흉부 이미지를 생성하는 단계는,특정 코로나19 흉부 이미지에 대한 오버 샘플링을 통해 복수의 합성 흉부 이미지를 생성하고, 생성된 합성 흉부이미지에 대한 라벨링을 수행하는 단계를 포함하는,코로나19 진단 방법."}
{"patent_id": "10-2020-0064668", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제1 항에 있어서, 제2 특징 추출 레이어의 전이학습을 수행하는 단계는,제1 특징 추출 레이어의 가중치 또는 바이어스와 관련된 파라미터를 기초로 제2 특징 추출 레이어의 파라미터를지정하는,공개특허 10-2021-0148514-3-코로나19 진단 방법."}
{"patent_id": "10-2020-0064668", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제1 항에 있어서, 코로나19 흉부 이미지를 기초로 합성 코로나19 흉부 이미지를 생성하는 단계;정상 흉부 이미지, 폐렴 흉부 이미지 및 합성 코로나19 흉부 이미지를 이용하여 전이학습이 수행된 제2 신경망의 학습을 수행하는 단계를 더 포함하는,코로나19 진단 방법."}
{"patent_id": "10-2020-0064668", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제1 항에 있어서, 제2 신경망의 출력 데이터를 기초로 코로나19 감염 여부를 추정하는 단계는,입력된 흉부 이미지를 정상(No Finding), 폐렴(Pneumonia) 및 코로나19 감염 중 적어도 하나의 카테고리로 분류하는,코로나19 진단 방법."}
{"patent_id": "10-2020-0064668", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "인공신경망을 이용한 코로나19 진단 방법 및 그 장치가 제공 된다. 본 발명의 일 실시예에 코로나19 진단 방법은 제1 특징 추출 레이어 및 폐 이상 징후 분류 레이어를 포함하는 제1 신경망의 학습을 수행하는 단계, 학습된 제1 특징 추출 레이어를 기초로 제2 신경망에 포함된 제2 특징 추출 레이어의 전이학습을 수행하는 단계 코로나19 흉 부 이미지를 기초로 합성 코로나19 흉부 이미지를 생성하는 단계, 제2 신경망에 타겟 흉부 이미지를 입력하고, 제2 신경망의 출력 데이터를 기초로 타겟 흉부 이미지에 대한 코로나19 감염 여부를 추정하는 단계를 포함한다."}
{"patent_id": "10-2020-0064668", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 인공신경망을 이용한 코로나19 진단하는 방법 및 그 장치에 관한 것이다."}
{"patent_id": "10-2020-0064668", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "코로나바이러스는 12월 말 중국 우한시에서 시작되었으며, RNA 바이러스 집단에 속한다. 코로나바이러스는 동물 과 사람 모두가 감염될 수 있는 큰 규모의 바이러스 집단으로, 일반 감기와 같은 경증의 호흡기 질환에서 폐렴 과 같은 중증의 호흡기 질환을 야기한다. 신종 코로나바이러스 감염증(이하, 코로나19)의 확산세를 꺾기 위해서는 빠르고 정확한 진단 및 검사가 중요하 다. 이에 따라 현재 국내외에서는 진단시약을 이용한 진단키트를 사용하고 있다. 진단키트의 경우 진단시간이 길수록 진단 정확도가 높은 경향이 있으며, 진단 시간은 최소 2시간에서 최대 6시간이 소요되므로 이를 통한 즉 각적인 진단과 대처에는 한계가 존재한다. 뿐만 아니라, 진단키트를 이용한 코로나19 진단 결과 음성 결과가 나 왔음에도 불구하고, 이후 코로나19의 양성 판정을 받는 경우가 증가함에 따라 진단 방법의 개선과 정확도 향상 의 필요성이 증가하고 있다."}
{"patent_id": "10-2020-0064668", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 2, "content": "전술한 배경기술은 발명자가 본 발명의 도출을 위해 보유하고 있었거나, 본 발명의 도출 과정에서 습득한 기술 정보로서, 반드시 본 발명의 출원 전에 일반 공중에게 공개된 공지기술이라 할 수는 없다."}
{"patent_id": "10-2020-0064668", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명의 일 실시예에는 한정된 개수의 코로나19 흉부 이미지만으로도 코로나 19 진단을 수행하기 위한 인공신 경망의 정확도 향상시키는 방법 및 그 장치를 제공한다."}
{"patent_id": "10-2020-0064668", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명의 일 실시예에 따른 코로나19 진단 방법은 제1 특징 추출 레이어 및 폐 이상 징후 분류 레이어를 포함 하는 제1 신경망의 학습을 수행하는 단계, 학습된 제1 특징 추출 레이어를 기초로 제2 신경망에 포함된 제2 특 징 추출 레이어의 전이학습을 수행하는 단계, 코로나19 흉부 이미지를 기초로 합성 코로나19 흉부 이미지를 생 성하는 단계 및 제2 신경망에 타겟 흉부 이미지를 입력하고, 제2 신경망의 출력 데이터를 기초로 타겟 흉부 이 미지에 대한 코로나19 감염 여부를 추정하는 단계를 포함할 수 있다.일 실시예에서 폐 이상 징후 분류 레이어는, 입력된 흉부 이미지를 지정된 카테고리로 분류하고, 분류 결과를 기초로 폐 이상 징후 발병 여부를 추정할 수 있다. 일 실시예에서 폐 이상 징후 분류 레이어는, 입력된 흉부 이미지를 정상(No Finding), 심장비대증(Enlarged Cardiom), 심근병증(Cardiomegaly), 폐 병변(Lung Lesion), 폐 음영(Lung Opacity), 부종(Edema), 폐경화 (Consolidation), 폐렴(Pneumonia), 무기폐(Atelectasis), 기흉(Pneumothorax), 흉수(Pleural Effusion), 흉막 (Pleural Other), 골절(Fracture) 및 보조장치(Circulatory support devices)중 적어도 하나의 카테고리로 분 류할 수 있다. 일 실시예에서 합성 코로나19 흉부 이미지를 생성하는 단계는, 특정 코로나19 흉부 이미지에 대한 오버 샘플링 을 통해 복수의 합성 흉부 이미지를 생성하고, 생성된 합성 흉부 이미지에 대한 라벨링을 수행하는 단계를 포함 할 수 있다. 일 실시예에서 제2 특징 추출 레이어의 전이학습을 수행하는 단계는, 제1 특징 추출 레이어의 가중치 또는 바이 어스와 관련된 파라미터를 기초로 제2 특징 추출 레이어의 파라미터를 지정할 수 있다. 일 실시예에서 코로나19 흉부 이미지를 기초로 합성 코로나19 흉부 이미지를 생성하는 단계, 정상 흉부 이미지, 폐렴 흉부 이미지 및 합성 코로나19 흉부 이미지를 이용하여 전이학습이 수행된 제2 신경망의 학습을 수행하는 단계를 더 포함할 수 있다. 일 실시예에서 제2 신경망의 출력 데이터를 기초로 코로나19 감염 여부를 추정하는 단계는, 입력된 흉부 이미지 를 정상(No Finding), 폐렴(Pneumonia) 및 코로나19 감염 중 적어도 하나의 카테고리로 분류할 수 있다. 전술한 것 외의 다른 측면, 특징, 이점이 이하의 도면, 특허청구범위 및 발명의 상세한 설명으로부터 명확해질 것이다."}
{"patent_id": "10-2020-0064668", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "후술하는 본 발명에 대한 상세한 설명은, 본 발명이 실시될 수 있는 특정 실시예를 예시로서 도시하는 첨부 도 면을 참조한다. 이러한 실시예는 당업자가 본 발명을 실시할 수 있기에 충분하도록 상세히 설명된다. 본 발명의 다양한 실시예는 서로 다르지만 상호 배타적일 필요는 없음이 이해되어야 한다. 예를 들어, 본 명세서에 기재되 어 있는 특정 형상, 구조 및 특성은 본 발명의 정신과 범위를 벗어나지 않으면서 일 실시예로부터 다른 실시예 로 변경되어 구현될 수 있다. 또한, 각각의 실시예 내의 개별 구성요소의 위치 또는 배치도 본 발명의 정신과 범위를 벗어나지 않으면서 변경될 수 있음이 이해되어야 한다. 따라서, 후술하는 상세한 설명은 한정적인 의미 로서 행하여지는 것이 아니며, 본 발명의 범위는 특허청구범위의 청구항들이 청구하는 범위 및 그와 균등한 모 든 범위를 포괄하는 것으로 받아들여져야 한다. 도면에서 유사한 참조부호는 여러 측면에 걸쳐서 동일하거나 유 사한 구성요소를 나타낸다. 본 발명에서 개시하는 인공 지능(artificial intelligence, AI)은 인공적인 지능 또는 이를 만들 수 있는 방법 론을 연구하는 분야를 의미할 수 있고, 기계 학습(machine learning)은 인공지능 기술의 한 분야로서 컴퓨팅 장 치가 데이터를 통해 학습하여 특정 대상 혹은 조건을 이해할 수 있게 하거나 데이터의 패턴을 찾아내 분류하는 기술적 방식으로써 컴퓨터가 데이터를 분석할 수 있게 하는 알고리즘일 수 있다. 본 발명에서 개시하는 기계 학 습은 인공지능 모델을 학습하기 위한 동작 방법을 포함하는 의미로서 이해될 수 있다."}
{"patent_id": "10-2020-0064668", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "이하에서는, 본 발명이 속하는 기술분야에서 통상의 지식을 가진 자가 본 발명을 용이하게 실시할 수 있도록 하 기 위하여, 본 발명의 여러 실시예에 관하여 첨부된 도면을 참조하여 상세히 설명하기로 한다. 이하 도 1을 참조하여 본 발명의 일 실시예에 따른 코로나19 진단 시스템에 대하여 상세히 설명한다. 본 발명의 일 실시예에 따르는 코로나19 진단 방법을 수행하는 코로나19 진단 시스템은 인공신경망을 이용할 수 있다. 이하 본 명세서에서 후술되는 코로나19 진단 방법은 다양한 신종 바이러스 감염증 또는 신종 폐 질환에 이용될 수 있으며, 코로나19에만 한정되는 것은 아님에 유의한다. 다만 본 발명의 명확한 이해를 위해 이하 신 종 폐 질환의 일 예시로 코로나19를 이용하여 설명한다. 본 발명의 일 실시예에 따른 코로나19 진단 방법은 흉부 이미지를 이용하여 수행될 수 있다. 본 실시예에 따른 코로나19 진단 방법은 제1 신경망 및 제2 신경망을 이용하여 코로나19 감염 여부를 추정할 수 있다. 코로나19와 같은 신종 바이러스 감염증은 학습 데이터가 충분하지 않으므로 본 발명의 몇몇 실시예에 따른 코로나19 진단 방법에 이용되는 인공신경망은 전이학습이 수행될 수 있다. 보다 구체적으로 제1 신경망은 흉부 이미지를 이용 하여 폐 이상 질환 유무를 판별할 수 있고, 제2 신경망은 코로나19 감염 여부를 진단할 수 있을 때, 본 발명의 몇몇 실시예에 따르면 제1 신경망에 포함된 특징 추출부의 레이어를 이용하여 제2 신경망의 특징 추출부의 레이 어에 대한 전이학습이 수행될 수 있다. 도시된 바를 참조할 때 제1 신경망에는 다양한 흉부 이미지가 입력될 수 있다. 제1 신경망은 복 수의 레이어를 포함하는 특징 추출부 및 적어도 하나의 레이어를 포함하는 폐 이상 징후 분류부를 포 함할 수 있다. 제1 신경망은 학습 데이터로 입력된 복수의 흉부 이미지에 대한 특징을 군집화 하여 복수개 의 폐 이상 징후 카테고리를 생성할 수 있다. 흉부 이미지의 종류나 포맷은 한정되지 않으나 예를 들어 흉 부 이미지는 엑스레이 이미지일 수 있다. 또한, 폐 이상 징후의 카테고리 종류도 한정되지 않음은 물론이 다. 폐 이상 징후를 판별하는 제1 신경망은 방대한 양의 흉부 이미지를 이용하여 학습을 수행할 수 있고, 높은 정확도로 폐 이상 징후를 판별할 수 있다. 제2 신경망에도 다양한 흉부 이미지가 입력될 수 있다. 또한 제2 신경망은 복수의 레이어를 포 함하는 특징 추출부 및 적어도 하나의 레이어를 포함하는 코로나19 판별부를 포함할 수 있다. 제2 신 경망은 학습 데이터로 입력된 복수의 흉부 이미지에 대한 특징을 군집화 하여 코로나19 감염 여부, 바이러 스성 폐렴 유무를 더 판별할 수 있다. 코로나19 감염 여부를 판단하는 제2 신경망의 경우, 코로나19 감염 흉부 이미지의 양이 많지 않기 때문에 충분한 양의 학습 데이터의 확보가 문제가 되며, 이에 따라 제2 신경망의 정확도에도 문제가 발생할 수 있 다. 따라서 본 발명의 몇몇 실시예에 따른 코로나19 진단 방법은 정확도가 높은 제1 신경망의 특징 추출부 에 포함된 복수의 레이어를 이용하여, 제2 신경망의 특징 추출부에 포함된 복수의 레이어에 대 한 전이학습을 수행할 수 있다. 이를 통해 제2 신경망의 정확도가 향상될 수 있다. 또한, 부족한 학습 데 이터의 양을 확보하기 위해 본 발명의 몇몇 실시예에 따른 코로나19 진단 방법은 기 획득된 코로나19 감염 이미 지를 합성하여 충분한 양의 학습 데이터를 확보할 수 있다. 보다 상세한 설명은 이하 관련 도면에서 후술한다. 도 2는 본 발명의 일 실시예에 따른 코로나19 진단 장치의 하드웨어 구성을 설명하기 위한 블록도이다. 일 실시예에서 코로나19 진단을 수행하는 전자장치는 메모리, 프로세서, 입출력 인터페이스 및 통신 모듈을 포함할 수 있다. 메모리는 컴퓨터에서 판독 가능한 기록 매체로서, RAM(random access memory), ROM(read only memory) 및 디스크 드라이브와 같은 비소멸성 대용량 기록장치(permanent mass storage device)를 포함할 수 있다. 또한, 메모리에는 코로나19 를 진단하는 전자장치를 제어하기 위한 프로그램 코드 및 설정, 흉부 이미지 또 는 인공신경망부가 일시적 또는 영구적으로 저장될 수 있다.프로세서는 기본적인 산술, 로직 및 입출력 연산을 수행함으로써, 컴퓨터 프로그램의 명령을 처리하도록 구성될 수 있다. 명령은 메모리 또는 통신 모듈에 의해 프로세서로 제공될 수 있다. 예를 들어 프로세서는 메모리와 같은 기록 장치에 저장된 프로그램 코드에 따라 수신되는 명령을 실행하도록 구 성될 수 있다. 본 발명의 일 실시예에 따른 프로세서는 제1 특징 추출 레이어 및 폐 이상 징후 분류 레이 어를 포함하는 제1 신경망의 학습을 수행할 수 있다. 또한, 프로세서는 학습된 제1 특징 추출 레이어를 기 초로 제2 신경망에 포함된 제2 특징 추출 레이어의 전이학습을 수행할 수 있다. 그리고 프로세서는 코로나 19 흉부 이미지를 기초로 합성 코로나19 흉부 이미지를 생성할 수 있다. 뿐만 아니라 프로세서는 제2 신경 망에 타겟 흉부 이미지를 입력하고, 제2 신경망의 출력 데이터를 기초로 타겟 흉부 이미지에 대한 코로나19 감 염 여부를 추정할 수 있다. 통신 모듈은 네트워크를 통해 외부 서버와 통신하기 위한 기능을 제공할 수 있다. 일례로, 코로나19 를 진 단하는 전자장치의 프로세서가 메모리와 같은 기록 장치에 저장된 프로그램 코드에 따라 생성한 요청이 통신 모듈의 제어에 따라 네트워크를 통해 외부 서버로 전달될 수 있다. 역으로, 외부 서버의 프로 세서의 제어에 따라 제공되는 제어 신호나 명령, 컨텐츠, 파일 등이 네트워크를 거쳐 통신 모듈을 통해 전 자장치로 수신될 수 있다. 예를 들어 통신 모듈을 통해 수신된 외부 서버의 제어 신호나 명령 등은 프로세서나 메모리로 전달될 수 있고, 컨텐츠나 파일 등은 코로나19 를 진단하는 전자장치가 더 포함할 수 있는 저장 매체로 저장될 수 있다. 또한, 통신 모듈은 외부 서버와 네트워크를 통해 통신할 수 있다. 통신 방식은 제한되지 않지만, 네트워크는 근거리 무선통신망일 수 있다. 예를 들어, 네트워크는 블루투 스(Bluetooth), BLE(Bluetooth Low Energy), Wifi 통신망일 수 있다. 입출력 인터페이스는 입출력 장치와의 인터페이스를 위한 수단일 수 있다. 예를 들어, 입력 장치는 키보드 또는 마우스 등의 장치를, 그리고 출력 장치는 어플리케이션의 통신 세션을 표시하기 위한 디스플레이와 같은 장치를 포함할 수 있다. 다른 예로 입출력 인터페이스는 터치스크린과 같이 입력과 출력을 위한 기능이 하 나로 통합된 장치와의 인터페이스를 위한 수단일 수도 있다. 보다 구체적인 예로, 전자장치의 프로세서 는 메모리에 로딩된 컴퓨터 프로그램의 명령을 처리함에 있어서 외부 서버나 사용자 단말이 제공하는 데이터를 이용하여 구성되는 서비스 화면이나 컨텐츠가 입출력 인터페이스를 통해 디스플레이에 표시될 수 있다. 또한, 다른 실시예들에서 코로나19 를 진단하는 전자장치는 도 2의 구성요소들보다 더 많은 구성요소들을 포함할 수도 있다. 그러나, 대부분의 종래기술적 구성요소들을 명확하게 도시할 필요성은 없다. 예를 들어, 코 로나19 를 진단하는 전자장치는 사용자 단말의 내부 구성요소들에 전력을 공급하는 배터리 및 충전 장치를 포함할 수 있고, 상술한 입출력 장치 중 적어도 일부를 포함하도록 구현되거나 또는 트랜시버(transceiver), GPS(Global Positioning System) 모듈, 각종 센서, 데이터베이스 등과 같은 다른 구성요소들을 더 포함할 수도 있다. 도 3은 본 발명의 일 실시예에 따른 코로나19 진단 방법의 순서도이다. 단계 S110에서 제1 특징 추출 레이어 및 폐 이상 징후 분류 레이어를 포함하는 제1 신경망이 획득될 수 있다. 일 실시예에서 폐 이상 징후 분류 레이어는 입력된 흉부 이미지를 지정된 카테고리로 분류하고, 분류 결과를 기 초로 폐 이상 징후 발병 여부를 추정할 수 있다. 일 실시예에서 폐 이상 징후 분류 레이어는, 입력된 흉부 이미지를 정상(No Finding), 심장비대증(Enlarged Cardiom), 심근병증(Cardiomegaly), 폐 병변(Lung Lesion), 폐 음영(Lung Opacity), 부종(Edema), 폐경화 (Consolidation), 폐렴(Pneumonia), 무기폐(Atelectasis), 기흉(Pneumothorax), 흉수(Pleural Effusion), 흉막 (Pleural Other), 골절(Fracture) 및 보조장치(Circulatory support devices)중 적어도 하나의 카테고리로 분 류할 수 있다. 다만 이는 일 예시일 뿐 본 발명의 몇몇 실시예에 따른 제1 신경망이 반드시 상술한 카테고리에 따라 폐 이상 징후 분류를 수행하는 것은 아님은 물론이다. 단계 S120에서 흉부 이미지를 이용하여 제1 신경망 학습이 수행될 수 있다. 흉부 이미지의 종류 및 포맷은 한정 되지 않는다. 예를들어 상기 흉부 이미지는 흉부 엑스레이 이미지일 수 있다. 제1 신경망에 입력되는 흉부 이미 지는 흉부 방사선 이미지일 수 있고, 라벨링이 수행되지 않은 이미지일 수 있다. 제1 신경망의 학습 데이터로 입력되는 흉부 이미지의 폐 이상 징후 여부는 한정되지 않으므로, 다양한 환자의 다양한 흉부 이미지가 이용될 수 있어 방대한 양의 학습 데이터 확보가 가능하다.단계 S130에서 학습된 제1 특징 추출 레이어를 기초로 제2 신경망에 포함된 제2 특징 추출 레이어의 전이학습이 수행될 수 있다. 제2 특징 추출 레이어의 전이학습을 수행하는 단계는, 제1 특징 추출 레이어의 가중치 또는 바 이어스와 관련된 파라미터를 기초로 제2 특징 추출 레이어의 파라미터를 지정할 수 있다. 본 실시예에 따른 제1 신경망은 제1 특징 추출 레이어를 포함하고, 제2 신경망은 제2 특징 추출 레이어를 포함 할 수 있다. 제1 특징 추출 레이어 및 제2 특징 추출 레이어는 복수의 레이어를 포함하고, 상술한 단계 S120에 서의 학습을 통해 가중치 및 바이어스와 관련된 매개변수가 지정된 상태일 수 있다. 따라서 상술한 매개변수를 이용하여 제2 신경망에 포함된 제2 특징 추출 레이어의 매개변수를 지정할 수 있다. 제2 신경망의 경우 학습 데 이터로 이용되는 코로나19 감염 흉부 이미지의 양이 많지 않기 때문에 제2 신경망의 충분한 학습이 어렵다. 따 라서 상술한 전이학습을 통해 흉부 이미지의 특징 추출에 대한 높은 정확도를 확보할 수 있다. 단계 S140에서 코로나19 흉부 이미지를 기초로 합성 코로나19 흉부 이미지가 생성될 수 있다. 높은 정확도의 신 경망 학습을 위하여는 카테고리별로 균등한 양의 학습 데이터를 제공하는 것이 필요하다. 예를 들어 제2 신경망 이 입력된 흉부 이미지에 대하여 폐렴 유무, 코로나19 감염 여부 또는 정상 상태 중 하나로 분류하는 경우, 균 등한 양의 정상 흉부 이미지, 폐렴 흉부 이미지 및 합성 코로나19 흉부 이미지가 필요하다. 이에 따라 본 발명 의 몇몇 실시예에 따른 코로나19 진단 방법은 소량의 코로나 19 감염 흉부 이미지를 이용하여 복수의 합성 코로 나19 흉부 이미지를 생성할 수 있다. 이 경우 합성 흉부 이미지는 특정 코로나19 흉부 이미지에 대한 오버 샘플 링을 통해 생성될 수 있고, 이후 생성된 합성 흉부 이미지는 라벨링이 수행될 수 있다. 이후 단계 S150에서 제2 신경망의 학습이 수행될 수 있다. 일 실시예에서 단계 S140에서 전이학습이 수행된 제2 신경망에 대하여 정상 흉부 이미지, 폐렴 흉부 이미지 및 합성 코로나19 흉부 이미지를 입력하여 제2 신경망의 학습이 더 수행될 수 있다 단계 S160에서 제2 신경망에 타겟 흉부 이미지가 입력될 수 있다. 타겟 흉부 이미지는 학습 데이터로 사용되지 않은 테스트용 데이터일 수 있다. 단계 S170에서 제2 신경망의 출력 데이터를 기초로 입력된 흉부 이미지에 대한 코로나19 감염 여부가 추정될 수 있다. 본 실시예에서 제2 신경망은 적어도 하나의 레이어를 포함하는 코로나19 판별부를 포함할 수 있다. 예를 들어 코로나19 판별부는 완전 연결 레이어를 포함할 수 있다. 이 경우 상술한 코로나19 판별부는 입력된 흉부 이미지를 정상(No Finding), 폐렴(Pneumonia) 및 코로나19 감염 중 적어도 하나로 분류할 수 있다. 도 4는 본 발명의 일 실시예에 따른 코로나19 감염 여부를 판별하는 신경망의 학습 방법을 설명하기 위한 도면 이다. 도시된 바를 참조할 때, 흉부 엑스레이 데이터베이스에는 다양한 흉부 이미지가 저장될 수 있다. 예를 들 어 흉부 엑스레이 데이터베이스에는 폐렴 환자의 흉부 이미지, 정상 상태의 흉부 이미지, 심장비대증 환자 의 흉부 이미지 등 다양한 상태의 흉부 이미지가 저장될 수 있다. 전술한 바 흉부 이미지의 포맷은 제한되지 흉 부 이미지는 엑스레이 이미지가 아닐 수 있다. 흉부 엑스레이 데이터베이스는 방대한 양의 흉부 이미지가 저장될 수 있다. 코로나19 데이터베이스는 코로나19 환자의 흉부 이미지가 저장될 수 있다. 따라서 코로나19 데이터베이스 에는 흉부 엑스레이 데이터베이스에 비해 적은 양의 흉부 이미지가 저장될 수 있다. 제1 신경망은 흉부 엑스레이 데이터베이스로부터 입력 데이터를 수신하며, 복수의 레이어를 포함하는 특징 추출부 및 적어도 하나의 레이어를 포함하는 폐 이상 징후 분류부를 포함할 수 있다. 전술한 바, 제1 신경망은 흉부 엑스레이 데이터베이스로부터 수신한 입력 데이터를 기초로 특징 추출부 및 폐 이상 징후 분류부에 대한 학습을 수행할 수 있다. 제2 신경망에 입력되는 입력 데이터는 데이터 전처리부로부터 전달될 수 있다. 데이터 전처리부(30 2)는 코로나19 데이터베이스로부터 수신한 코로나19 감염 흉부 이미지를 합성하여 합성 코로나19 감염 이 미지를 생성할 수 있다. 또한, 이 경우 데이터 전처리부는 흉부 엑스레이 데이터베이스로부터 수신한 흉부 이미지의 양과 균등한 양의 합성 코로나19 감염 이미지를 생성할 수 있다. 일 실시예에서 데이터 전처리부 는 코로나19 카테고리에 해당하는 샘플의 수를 증가시키기 위해 코로나19 감염 이미지를 이용하여 오버 샘 플링을 수행할 수 있다. 예를 들어 데이터 전처리부는 SMOTE(Synthetic Minority Oversampling Technique)를 이용하여 이미지 합성을 수행할 수 있다. 이후 제2 신경망은 데이터 전처리부로부터 입력 데이터를 이용하여 특징 추출부 및 코로나19 판 별부의 학습을 수행할 수 있다. 다만, 이 경우 제2 신경망의 특징 추출부는 흉부 이미지에 대하 여 더욱 정확한 특징을 추출하기 위해 제1 신경망에 포함된 특징 추출부를 이용한 전이학습이 수행될 수 있다. 즉 제2 신경망의 특징 추출부에 포함된 복수의 레이어의 매개 변수는 제1 신경망의 특 징 추출부에 포함된 복수의 레이어의 매개 변수를 기초로 지정될 수 있다. 그리고 제2 신경망의 코로 나19 판별부는 지정된 카테고리에 따라 입력된 타겟 흉부 이미지에 대한 분류를 수행할 수 있다. 일 실시 예에서 코로나19 판별부는 코로나19 감염 상태인지 또는 정상 상태인지만 판별할 수도 있고, 다른 실시예 에서 코로나19 감염 상태인지, 정상 상태인지, 다른 바이러스성 폐렴에 감염된 상태인지 여부를 더 판별할 수도 있다. 이하 도 5 및 도 6을 참조하여 제1 신경망의 동작 방법의 일 예시를 설명한다. 도 5는 본 발명의 일 실시예에 따라 폐 이상 징후 판별을 수행하는 제1 신경망 모델의 구조를 도시하였다. 본 발명의 일 실시예에 따르면 제1 신경망은 복수의 합성곱-레이어(Convolutional Layer)를 포함할 수 있 고, 이 경우 제1 신경망은 CNN(Convolutional Neural Networks)구조를 기초로 생성 될 수 있다. 일 실시예에 따른 제1 신경망 구조는 입력 블록(a), 합성곱 블록(b), 감소 블록(c) 및 출력 블록(d)의 4가지 유 형의 블록을 이용하여 구성될 수 있다. 입력 블록은 제1 신경망의 시작 단계에 있으며 초기 입력 이미지 매트릭 스를 생성하고 입력 이미지의 초기 피쳐 표현을 초기화할 수 있다. 또한, 입력 블록의 출력 데이터는 합성곱 블 록으로 전달될 수 있다. 합성곱 블록은 입력 이미지의 복잡한 특징 표현을 생성하는 연속적인 세트의 합성곱 레 이어를 포함하는 형태로 구성될 수 있다. 다음으로 합성곱 블록의 출력 데이터는 감소 블록으로 전달될 수 있다. 감소 블록은 평균 풀링을 수행함으로써 특징 표현을 다운 샘플링을 수행할 수 있다. 이를 통해 합성곱 레 이어에서 확장된 포맷으로 변경된 출력 데이터는 감소 블록 거치며 축소된 포맷으로 변경될 수 있다. 이후, 합 성곱 블록과 감소 블록의 반복적인 구조를 통해 입력 데이터에 대한 최적의 특징 데이터셋이 추출될 수 있다. 이후 특징 데이터셋은 14 개 클래스에 대한 의사 결정을 수행하는 출력 블록으로 전달될 수 있다. 상술한 단계를 통해 분류된 입력 데이터와-출력 데이터의 예시는 도 6에 도시되어 있다. 도 6에 도시된 (a) 내 지 (n)의 흉부 이미지 각각은 제1 신경망에 입력된 후, 각각 정상(No Finding), 심장비대증(Enlarged Cardiom), 심근병증(Cardiomegaly), 폐 병변(Lung Lesion), 폐 음영(Lung Opacity), 부종(Edema), 폐경화 (Consolidation), 폐렴(Pneumonia), 무기폐(Atelectasis), 기흉(Pneumothorax), 흉수(Pleural Effusion), 흉막 (Pleural Other), 골절(Fracture) 및 보조장치(Circulatory support devices)의 상태로 판별된 경우의 일 예시 이다. 이하 도 7 및 도 8을 참조하여 제2 신경망의 동작 방법의 일 예시를 설명한다. 도 7은 본 발명의 일 실시예에 따른 코로나19 감염 여부를 판별하는 신경망 구조의 일 예시를 도시한 도면이다. 본 발명의 일 실시예에 따르면 제2 신경망은 복수의 합성곱-레이어(Convolutional Layer)를 포함할 수 있 고, 이 경우 제2 신경망은 CNN(Convolutional Neural Networks)구조를 기초로 생성 될 수 있다. 일 실시예에 따른 제2 신경망 구조는 입력 블록(a), 합성곱 블록(b), 감소 블록(c) 및 출력 블록(d)의 4가지 유 형의 블록을 이용하여 구성될 수 있다. 도 5를 참조하여 설명한 제1 신경망은 수많은 흉부 이미지를 이용하여 모델의 내부 레이어 또는 히든 레이어가 해당 이미지에서 최적의 특징을 추출하도록 훈련된다. 도 5의 경우 14개의 뉴런이 존재하는 완전 연결 레이어의 경우 입력 이미지에 대한 분류를 수행한다. 따라서 이 경우 상기 제1 신경망의 완전 연결 레이어를 제외한 모든 합성곱 레이어의 가중치 및 바이어스와 관련된 파라미터를 이용하여 제2 신경망의 전이학습을 수행할 수 있다. 도 7에 도시된 바를 참조하면 출력 블록(d)의 마지막 완전 연결 레이어를 제외한 모든 레이어(410, 420, 430, 440)가 제1 신경망의 특징 추출 레이어와 가중치가 통합되어 전이학습 되었다. 또한 제2 신경망의 출력 블록(d) 끝 단의 완전 연결 레이어는 코로나19 감염 여부, 바이러스성 폐렴 감염 여부, 정상 상태 여부를 판별하는 3가 지 카테고리로 입력 데이터를 분류한다. 상술한 단계를 통해 분류된 입력 데이터와-출력 데이터의 예시는 도 8에 도시되어 있다. 도 8에 도시된 (a) 내 지 (c)의 흉부 이미지 각각은 제2 신경망에 입력된 후, 각각 정상상태(healthy), 폐렴(Pneumonia) 및 코로나 19(COVID-19) 상태로 판별된 경우의 일 예시이다. 이하 제2 신경망의 훈련을 수행하는 구체적인 방법에 대하여 상세히 설명한다. 제2 신경망 모델의 학습에서 중 요한 측면은 가중치, 바이어스 및 손실함수를 최적화하기 위한 올바른 파라미터를 선택하는 것이다. 또한 훈련 프로세스를 제어하는 프로세스도 매우 중요하다. 따라서 본 발명의 몇몇 실시예에 따른 제2 신경망은 학습 프로 세스를 제어하고 매개 변수를 최적화하기 위해 역 전파를 수행할 수 있다. 또한, 제2 신경망의 유효성 검사 및 테스트 오류를 최소화하는 최적화 알고리즘이 사용될 수 있다. 최적화 알고리즘은 제한되지 않으나, 예를 들어 최적화는 AdaDelta 최적화 알고리즘을 사용하여 수행될 수 있다. 이 경우 최적화 알고리즘은 1 차 정보만 활용 하여 학습 과정의 적법한 과정을 동적으로 조정할 수 있다. 더욱이, 최적화 알고리즘은 학습 속도의 수동 튜닝 을 필요로 하지 않고 잡음이 많은 그래디언트 정보에 대해 강력하다. 따라서 최적화 알고리즘에 적합한 파라미 터를 선택하고 제2 신경망 모델의 일반화 및 최적 목표 점수를 유지하기 위해 베이지안 SMBO (Bayesian Sequential Model-Based Optimization)가 이용될 수 있다. 베이지안 SMBO는 이전 목표 함수의 평가 결과를 기 반으로 대리 모델 (확률 함수)을 생성하여 목표 함수를 최소화하는 작업을 하이퍼 파라미터 최적화에 사용하는 알고리즘이다. 베이지안 SMBO의 기본 목적 함수는 하기 수식 1을 통해 정해질 수 있다. [수식 1]"}
{"patent_id": "10-2020-0064668", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "또한, 상술한 최적화 알고리즘의 평가 결과는 예상 개선 기준을 사용하여 선택될 수 있다. 상기 예상 개선 기준 은 하기 수식 2를 통해 정해질 수 있다. [수식 2]"}
{"patent_id": "10-2020-0064668", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "여기서 x는 파라미터 값에 속하고 f (x)의 객관적 통증 개선으로 간주되며 f *는 프로세스에서 찾은 객관적 점 수의 최대 값이다. 한편 제2 신경망의 성능 향상에 중요한 또 다른 요소는 손실 함수이다. 이러한 함수는 일반적으로 예측과 실제 값 사이의 변동성을 결정하는 데 사용된다. 작업에 사용되는 손실 함수는 범주 형 교차 엔트로피 손실함수일 수 있다. 예를 들어 손실함수는 SoftMax 손실함수일 수 있다. 범주 형 교차 엔트로피 손실 함수에서 각 예측은 실 제 클래스 값과 비교되고 점수가 계산될 수 있다. 또한 점수는 실제 값과의 차이를 기반으로 예측 확률에 불이 익을 주는 데 사용된다. 예측 값에 제공된 페널티는 순전히 로그입니다. 작은 점수는 작은 차이에 할당되고 큰 점수는 큰 차이에 할당됩니다. 범주 형 교차 엔트로피 손실 방정식은 하기 수식3을 통해 정해질 수 있다. [수식 3]"}
{"patent_id": "10-2020-0064668", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 5, "content": "전술한 바와 마찬가지로 제1 신경망의 훈련을 수행할 수도 있음은 물론이다. 이상에서 설명된 장치는 하드웨어 구성요소, 소프트웨어 구성요소, 및/또는 하드웨어 구성요소 및 소프트웨어 구성요소의 조합으로 구현될 수 있다. 예를 들어, 실시예들에서 설명된 장치 및 구성요소는, 예를 들어, 프로세 서, 콘트롤러, ALU(arithmetic logic unit), 디지털 신호 프로세서(digital signal processor), 마이크로컴퓨 터, FPGA(field programmable gate array), PLU(programmable logic unit), 마이크로프로세서, 또는 명령(instruction)을 실행하고 응답할 수 있는 다른 어떠한 장치와 같이, 하나 이상의 범용 컴퓨터 또는 특수 목적 컴퓨터를 이용하여 구현될 수 있다. 처리 장치는 운영 체제(OS) 및 운영 체제 상에서 수행되는 하나 이상의 소 프트웨어 어플리케이션을 수행할 수 있다. 또한, 처리 장치는 소프트웨어의 실행에 응답하여, 데이터를 접근, 저장, 조작, 처리 및 생성할 수도 있다. 이해의 편의를 위하여, 처리 장치는 하나가 사용되는 것으로 설명된 경"}
{"patent_id": "10-2020-0064668", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 6, "content": "우도 있지만, 해당 기술분야에서 통상의 지식을 가진 자는, 처리 장치가 복수 개의 처리 요소(processing element) 및/또는 복수 유형의 처리 요소를 포함할 수 있음을 알 수 있다. 예를 들어, 처리 장치는 복수 개의 프로세서 또는 하나의 프로세서 및 하나의 콘트롤러를 포함할 수 있다. 또한, 병렬 프로세서(parallel processor)와 같은, 다른 처리 구성(processing configuration)도 가능하다. 소프트웨어는 컴퓨터 프로그램(computer program), 코드(code), 명령(instruction), 또는 이들 중 하나 이상의 조합을 포함할 수 있으며, 원하는 대로 동작하도록 처리 장치를 구성하거나 독립적으로 또는 결합적으로 (collectively) 처리 장치를 명령할 수 있다. 소프트웨어 및/또는 데이터는, 처리 장치에 의하여 해석되거나 처 리 장치에 명령 또는 데이터를 제공하기 위하여, 어떤 유형의 기계, 구성요소(component), 물리적 장치, 가상 장치(virtual equipment), 컴퓨터 저장 매체 또는 장치, 또는 전송되는 신호 파(signal wave)에 영구적으로, 또는 일시적으로 구체화(embody)될 수 있다. 소프트웨어는 네트워크로 연결된 컴퓨터 시스템 상에 분산되어서, 분산된 방법으로 저장되거나 실행될 수도 있다. 소프트웨어 및 데이터는 하나 이상의 컴퓨터 판독 가능 기록 매 체에 저장될 수 있다. 실시예에 따른 방법은 다양한 컴퓨터 수단을 통하여 수행될 수 있는 프로그램 명령 형태로 구현되어 컴퓨터 판 독 가능 매체에 기록될 수 있다. 컴퓨터 판독 가능 매체는 프로그램 명령, 데이터 파일, 데이터 구조 등을 단독 으로 또는 조합하여 포함할 수 있다. 매체에 기록되는 프로그램 명령은 실시예를 위하여 특별히 설계되고 구성 된 것들이거나 컴퓨터 소프트웨어 당업자에게 공지되어 사용 가능한 것일 수도 있다. 컴퓨터 판독 가능 기록 매 체의 예에는 하드 디스크, 플로피 디스크 및 자기 테이프와 같은 자기 매체(magnetic media), CD-ROM, DVD와 같 은 광기록 매체(optical media), 플롭티컬 디스크(floptical disk)와 같은 자기-광 매체(magneto-optical media), 및 롬(ROM), 램(RAM), 플래시 메모리 등과 같은 프로그램 명령을 저장하고 수행하도록 특별히 구성된 하드웨어 장치가 포함된다. 프로그램 명령의 예에는 컴파일러에 의해 만들어지는 것과 같은 기계어 코드뿐만 아 니라 인터프리터 등을 사용해서 컴퓨터에 의해서 실행될 수 있는 고급 언어 코드를 포함한다. 상기된 하드웨어 장치는 실시예의 동작을 수행하기 위해 하나 이상의 소프트웨어 모듈로서 작동하도록 구성될 수 있으며, 그 역 도 마찬가지이다."}
{"patent_id": "10-2020-0064668", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 7, "content": "이상과 같이 실시예들이 비록 한정된 실시예와 도면에 의해 설명되었으나, 해당 기술분야에서 통상의 지식을 가 진 자라면 상기의 기재로부터 다양한 수정 및 변형이 가능하다. 예를 들어, 설명된 기술들이 설명된 방법과 다 른 순서로 수행되거나, 및/또는 설명된 시스템, 구조, 장치, 회로 등의 구성요소들이 설명된 방법과 다른 형태 로 결합 또는 조합되거나, 다른 구성요소 또는 균등물에 의하여 대치되거나 치환되더라도 적절한 결과가 달성될 수 있다. 그러므로, 다른 구현들, 다른 실시예들 및 특허청구범위와 균등한 것들도 후술하는 특허청구범위의 범위에 속한 다.도면 도면1 도면2 도면3 도면4 도면5 도면6 도면7 도면8"}
{"patent_id": "10-2020-0064668", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 일 실시예에 따른 코로나19 진단 시스템의 예를 도시한 도면이다. 도 2는 본 발명의 일 실시예에 따른 코로나19 진단 장치의 하드웨어 구성을 설명하기 위한 블록도이다. 도 3은 본 발명의 일 실시예에 따른 코로나19 진단 방법의 순서도이다. 도 4는 본 발명의 일 실시예에 따른 코로나19 감염 여부를 판별하는 신경망의 학습 방법을 설명하기 위한 도면 이다. 도 5는 본 발명의 일 실시예에 따른 폐 이상 징후 판별을 수행하는 신경망 구조의 일 예시를 도시한 도면이다. 도 6은 본 발명의 일 실시예에 따른 폐 이상 징후 판별을 수행하는 신경망의 입출력 데이터의 일 예시를 도시한 도면이다. 도 7은 본 발명의 일 실시예에 따른 코로나19 감염 여부를 판별하는 신경망 구조의 일 예시를 도시한 도면이다. 도 8은 본 발명의 일 실시예에 따른 코로나19 감염 여부를 판별하는 신경망의 입출력 데이터의 일 예시를 도시 한 도면이다."}
