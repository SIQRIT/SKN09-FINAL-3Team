{"patent_id": "10-2024-0033377", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2025-0056749", "출원번호": "10-2024-0033377", "발명의 명칭": "IFPP 기능 활성화 및 비활성화를 위한 방법 및 장치", "출원인": "삼성전자주식회사", "발명자": "강수정"}}
{"patent_id": "10-2024-0033377", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "단말에 의해 수행되는 방법에 있어서, 상기 방법은,공장 프로파일 프로비저닝 (IFPP, in factory profile provisioning) 프로파일 설치를 위한 요청을 수신한 것에 응답하여 상기 단말의 FPA을 사용하여 FPA 서비스의 비활성화 여부를 판단하는 단계;내장형 범용 집적 회로 카드 (eUICC, embedded universal integrated circuit card)를 사용하여 상기 IFPP 프로파일을 설치하는 단계; 상기 eUICC를 사용하여 상기 FPA 서비스의 비활성화 처리 여부를 결정하는 단계;상기 eUICC로부터 상기 FPA에게 상기 FPA 서비스의 비활성화 처리 결과를 전송하는 단계를 포함하는, 방법."}
{"patent_id": "10-2024-0033377", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 개시는 보다 높은 데이터 전송률을 지원하기 위한 5G 또는 6G 통신 시스템에 관련된 것이다. 본 개시의 대량 의 프로파일들을 단말들에 프로비저닝 하기 위한 방법은, 단말제조사가 프로파일 서버로부터 Bound Profile Package(BPP) 및 프로파일 설치 키를 포함하는 프로파일 요청 응답 메시지를 수신하는 단계, 및 단말에게, 수신 된 BPP 및 프로파일 설치 키를 전송하는 단계 및 BPP 설치 후에 FPA 서비스를 비활성화하도록 처리하는 방법을 포함할 수 있다."}
{"patent_id": "10-2024-0033377", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 개시는 무선 통신 시스템에서, 프로파일을 프로비저닝(provisioning)하기 위한 방법 및 장치에 관한 것이다. 구체적으로, 본 개시는 무선 통신 시스템에서 대량의 프로파일들을 단말에 프로비저닝하기 위한 방법 및 장치에 관한 것이다."}
{"patent_id": "10-2024-0033377", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "5G 이동통신 기술은 빠른 전송 속도와 새로운 서비스가 가능하도록 넓은 주파수 대역을 정의하고 있으며, 3.5 기가헤르츠(3.5GHz) 등 6GHz 이하 주파수('Sub 6GHz') 대역은 물론 28GHz와 39GHz 등 밀리미터파(㎜Wave)로 불 리는 초고주파 대역('Above 6GHz')에서도 구현이 가능하다. 또한, 5G 통신 이후(Beyond 5G)의 시스템이라 불리 어지는 6G 이동통신 기술의 경우, 5G 이동통신 기술 대비 50배 빨라진 전송 속도와 10분의 1로 줄어든 초저 (Ultra Low) 지연시간을 달성하기 위해 테라헤르츠(Terahertz) 대역(예를 들어, 95GHz에서 3 테라헤르츠(3THz) 대역과 같은)에서의 구현이 고려되고 있다. 5G 이동통신 기술의 초기에는, 초광대역 서비스(enhanced Mobile BroadBand, eMBB), 고신뢰/초저지연 통신 (Ultra-Reliable Low-Latency Communications, URLLC), 대규모 기계식 통신 (massive Machine-Type Communications, mMTC)에 대한 서비스 지원과 성능 요구사항 만족을 목표로, 초고주파 대역에서의 전파의 경로 손실 완화 및 전파의 전달 거리를 증가시키기 위한 빔포밍(Beamforming) 및 거대 배열 다중 입출력(Massive MIMO), 초고주파수 자원의 효율적 활용을 위한 다양한 뉴머롤로지 지원(복수 개의 서브캐리어 간격 운용 등)와 슬롯 포맷에 대한 동적 운영, 다중 빔 전송 및 광대역을 지원하기 위한 초기 접속 기술, BWP(Band-Width Part) 의 정의 및 운영, 대용량 데이터 전송을 위한 LDPC(Low Density Parity Check) 부호와 제어 정보의 신뢰성 높은 전송을 위한 폴라 코드(Polar Code)와 같은 새로운 채널 코딩 방법, L2 선-처리(L2 pre-processing), 특정 서 비스에 특화된 전용 네트워크를 제공하는 네트워크 슬라이싱(Network Slicing) 등에 대한 표준화가 진행되었다. 현재, 5G 이동통신 기술이 지원하고자 했던 서비스들을 고려하여 초기의 5G 이동통신 기술 개선(improvement) 및 성능 향상(enhancement)을 위한 논의가 진행 중에 있으며, 차량이 전송하는 자신의 위치 및 상태 정보에 기 반하여 자율주행 차량의 주행 판단을 돕고 사용자의 편의를 증대하기 위한 V2X(Vehicle-to-Everything), 비면허 대역에서 각종 규제 상 요구사항들에 부합하는 시스템 동작을 목적으로 하는 NR-U(New Radio Unlicensed), NR 단말 저전력 소모 기술(UE Power Saving), 지상 망과의 통신이 불가능한 지역에서 커버리지 확보를 위한 단말- 위성 직접 통신인 비 지상 네트워크(Non-Terrestrial Network, NTN), 위치 측위(Positioning) 등의 기술에 대 한 물리계층 표준화가 진행 중이다. 뿐만 아니라, 타 산업과의 연계 및 융합을 통한 새로운 서비스 지원을 위한 지능형 공장 (Industrial Internet of Things, IIoT), 무선 백홀 링크와 액세스 링크를 통합 지원하여 네트워크 서비스 지역 확장을 위한 노드를제공하는 IAB(Integrated Access and Backhaul), 조건부 핸드오버(Conditional Handover) 및 DAPS(Dual Active Protocol Stack) 핸드오버를 포함하는 이동성 향상 기술(Mobility Enhancement), 랜덤액세스 절차를 간소화하 는 2 단계 랜덤액세스(2-step RACH for NR) 등의 기술에 대한 무선 인터페이스 아키텍쳐/프로토콜 분야의 표준 화 역시 진행 중에 있으며, 네트워크 기능 가상화(Network Functions Virtualization, NFV) 및 소프트웨어 정 의 네트워킹(Software-Defined Networking, SDN) 기술의 접목을 위한 5G 베이스라인 아키텍쳐(예를 들어, Service based Architecture, Service based Interface), 단말의 위치에 기반하여 서비스를 제공받는 모바일 엣지 컴퓨팅(Mobile Edge Computing, MEC) 등에 대한 시스템 아키텍쳐/서비스 분야의 표준화도 진행 중이다. 이와 같은 5G 이동통신 시스템이 상용화되면, 폭발적인 증가 추세에 있는 커넥티드 기기들이 통신 네트워크에 연결될 것이며, 이에 따라 5G 이동통신 시스템의 기능 및 성능 강화와 커넥티드 기기들의 통합 운용이 필요할 것으로 예상된다. 이를 위해, 증강현실(Augmented Reality, AR), 가상현실(Virtual Reality, VR), 혼합 현실 (Mixed Reality, MR) 등을 효율적으로 지원하기 위한 확장 현실(eXtended Reality, XR), 인공지능(Artificial Intelligence, AI) 및 머신러닝(Machine Learning, ML)을 활용한 5G 성능 개선 및 복잡도 감소, AI 서비스 지 원, 메타버스 서비스 지원, 드론 통신 등에 대한 새로운 연구가 진행될 예정이다. 또한, 이러한 5G 이동통신 시스템의 발전은 6G 이동통신 기술의 테라헤르츠 대역에서의 커버리지 보장을 위한 신규 파형(Waveform), 전차원 다중입출력(Full Dimensional MIMO, FD-MIMO), 어레이 안테나(Array Antenna), 대규모 안테나(Large Scale Antenna)와 같은 다중 안테나 전송 기술, 테라헤르츠 대역 신호의 커버리지를 개선 하기 위해 메타물질(Metamaterial) 기반 렌즈 및 안테나, OAM(Orbital Angular Momentum)을 이용한 고차원 공 간 다중화 기술, RIS(Reconfigurable Intelligent Surface) 기술 뿐만 아니라, 6G 이동통신 기술의 주파수 효 율 향상 및 시스템 네트워크 개선을 위한 전이중화(Full Duplex) 기술, 위성(Satellite), AI(Artificial Intelligence)를 설계 단계에서부터 활용하고 종단간(End-to-End) AI 지원 기능을 내재화하여 시스템 최적화를 실현하는 AI 기반 통신 기술, 단말 연산 능력의 한계를 넘어서는 복잡도의 서비스를 초고성능 통신과 컴퓨팅 자 원을 활용하여 실현하는 차세대 분산 컴퓨팅 기술 등의 개발에 기반이 될 수 있을 것이다. 상술한 것과 이동통신 시스템의 발전에 따라 다양한 서비스를 제공할 수 있게 됨으로써, 이러한 서비스들을 효 과적으로 제공하기 위한 방안이 요구되고 있다."}
{"patent_id": "10-2024-0033377", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "상술한 바와 같은 논의를 바탕으로, 본 개시(disclosure)는, 무선 통신 시스템에서 대량의 프로파일들을 단말에 설치하는 방법 및 장치를 제공하고자 한다."}
{"patent_id": "10-2024-0033377", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 개시의 다양한 실시예에 따르면, 대량의 프로파일들을 단말들에 프로비저닝하기 위한 기능을 활성화 또는 비 활성화하는 방법에 있어서, 방법은, 단말이 단말 제조사의 서버로부터 프로파일 설치에 대한 메시지를 수신하는 단계, 단말의 공장 프로파일 어시스턴트 (FPA, Factory Profile Assistant)가 수신된 프로파일 설치 메시지를 단말의 eUICC(embedded universal integrated circuit card)에 전송하는 단계, 프로파일 설치 동작에 따라 FPA Service의 상태를 비활성화 처리하는 단계를 포함할 수 있다."}
{"patent_id": "10-2024-0033377", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 개시는 대량의 단말들에 프로파일들을 효과적으로 설치할 수 있는 방법 및 장치를 제공할 수 있다. 본 개시에서 얻을 수 있는 효과는 다양한 실시 예들에서 언급한 효과들로 제한되지 않으며, 언급하지 않은 또 다른 효과들은 아래의 기재로부터 본 개시가 속하는 기술 분야에서 통상의 지식을 가진 자에게 명확하게 이해될 수 있을 것이다."}
{"patent_id": "10-2024-0033377", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하 첨부된 도면을 참조하여 본 개시의 동작 원리를 상세히 설명한다. 하기에서 본 개시를 설명하기에 있어 관 련된 공지 기능 또는 구성에 대한 구체적인 설명이 본 개시의 요지를 불필요하게 흐릴 수 있다고 판단되는 경우 에는 그 상세한 설명을 생략할 것이다. 그리고 후술되는 용어들은 본 개시에서의 기능을 고려하여 정의된 용어 들로서 이는 사용자, 운용자의 의도 또는 관례 등에 따라 달라질 수 있다. 그러므로 그 정의는 본 명세서 전반 에 걸친 내용을 토대로 내려져야 할 것이다. 본 개시의 이점 및 특징, 그리고 그것들을 달성하는 방법은 첨부되는 도면과 함께 상세하게 후술되어 있는 실시 예들을 참조하면 명확해질 것이다. 그러나 본 개시는 이하에서 개시되는 실시 예들에 한정되는 것이 아니라 서 로 다른 다양한 형태로 구현될 수 있으며, 단지 본 실시 예들은 본 개시의 개시가 완전하도록 하고, 본 개시가"}
{"patent_id": "10-2024-0033377", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "속하는 기술분야에서 통상의 지식을 가진 자에게 발명의 범주를 완전하게 알려주기 위해 제공되는 것이며, 본 개시는 청구항의 범주에 의해 정의될 뿐이다. 명세서 전체에 걸쳐 동일 참조 부호는 동일 구성 요소를 지칭한다. 이하, 기지국은 단말의 자원할당을 수행하는 주체로서, gNode B, eNode B, Node B, BS (Base Station), 무선 접속 유닛, 기지국 제어기, 또는 네트워크 상의 노드 중 적어도 하나일 수 있다. 단말은 UE (User Equipment), MS (Mobile Station), 셀룰러폰, 스마트폰, 컴퓨터, 또는 통신 기능을 수행할 수 있는 멀티미디어 시스템을 포 함할 수 있다. 본 개시에서 하향링크(Downlink; DL)는 기지국이 단말에게 전송하는 신호의 무선 전송 경로이고, 상향링크는(Uplink; UL)는 단말이 기국에게 전송하는 신호의 무선 전송경로를 의미한다. 또한, 이하에서 LTE 혹 은 LTE-A 시스템을 일 예로서 설명할 수도 있지만, 유사한 기술적 배경 또는 채널 형태를 갖는 다른 통신시스템 에도 본 개시의 실시예가 적용될 수 있다. 예를 들어 LTE-A 이후에 개발되는 5세대 이동통신 기술(5G, new radio, NR)이 본 개시의 실시예가 적용될 수 있는 시스템에 포함될 수 있으며, 이하의 5G는 기존의 LTE, LTE-A 및 유사한 다른 서비스를 포함하는 개념일 수도 있다. 또한, 본 개시는 숙련된 기술적 지식을 가진 자의 판단으 로써 본 개시의 범위를 크게 벗어나지 아니하는 범위에서 일부 변형을 통해 다른 통신시스템에도 적용될 수 있 다. 이 때, 처리 흐름도 도면들의 각 블록과 흐름도 도면들의 조합들은 컴퓨터 프로그램 인스트럭션들에 의해 수행될 수 있음을 이해할 수 있을 것이다. 이들 컴퓨터 프로그램 인스트럭션들은 범용 컴퓨터, 특수용 컴퓨터 또는 기타 프로그램 가능한 데이터 프로세싱 장비의 프로세서에 탑재될 수 있으므로, 컴퓨터 또는 기타 프로그램 가능한 데이터 프로세싱 장비의 프로세서를 통해 수행되는 그 인스트럭션들이 흐름도 블록(들)에서 설명된 기능들을 수행하는 수단을 생성하게 된다. 이들 컴퓨터 프로그램 인스트럭션들은 특정 방식으로 기능을 구현하기 위해 컴퓨터 또는 기타 프로그램 가능한 데이 터 프로세싱 장비를 지향할 수 있는 컴퓨터 이용 가능 또는 컴퓨터 판독 가능 메모리에 저장되는 것도 가능하므 로, 그 컴퓨터 이용가능 또는 컴퓨터 판독 가능 메모리에 저장된 인스트럭션들은 흐름도 블록(들)에서 설명된 기능을 수행하는 인스트럭션 수단을 내포하는 제조 품목을 생산하는 것도 가능하다. 컴퓨터 프로그램 인스트럭 션들은 컴퓨터 또는 기타 프로그램 가능한 데이터 프로세싱 장비 상에 탑재되는 것도 가능하므로, 컴퓨터 또는 기타 프로그램 가능한 데이터 프로세싱 장비 상에서 일련의 동작 단계들이 수행되어 컴퓨터로 실행되는 프로세 스를 생성해서 컴퓨터 또는 기타 프로그램 가능한 데이터 프로세싱 장비를 수행하는 인스트럭션들은 흐름도 블 록(들)에서 설명된 기능들을 실행하기 위한 단계들을 제공하는 것도 가능하다. 또한, 각 블록은 특정된 논리적 기능(들)을 실행하기 위한 하나 이상의 실행 가능한 인스트럭션들을 포함하는 모듈, 세그먼트 또는 코드의 일부를 나타낼 수 있다. 또, 몇 가지 대체 실행 예들에서는 블록들에서 언급된 기 능들이 순서를 벗어나서 발생하는 것도 가능함을 주목해야 한다. 예를 들면, 잇달아 도시되어 있는 두 개의 블 록들은 사실 실질적으로 동시에 수행되는 것도 가능하고 또는 그 블록들이 때때로 해당하는 기능에 따라 역순으 로 수행되는 것도 가능하다. 이때, 본 실시 예에서 사용되는 '~부'라는 용어는 소프트웨어 또는 FPGA(Field Programmable Gate Array) 또는 ASIC(Application Specific Integrated Circuit)과 같은 하드웨어 구성요소를 의미하며, '~부'는 어떤 역할들을 수행할 수 있다. 그렇지만 '~부'는 소프트웨어 또는 하드웨어에 한정되는 의 미는 아니다. '~부'는 어드레싱할 수 있는 저장 매체에 있도록 구성될 수도 있고 하나 또는 그 이상의 프로세서 들을 재생시키도록 구성될 수도 있다. 따라서, 일 예로서 '~부'는 소프트웨어 구성요소들, 객체지향 소프트웨 어 구성요소들, 클래스 구성요소들 및 태스크 구성요소들과 같은 구성요소들과, 프로세스들, 함수들, 속성들, 프로시저들, 서브루틴들, 프로그램 코드의 세그먼트들, 드라이버들, 펌웨어, 마이크로코드, 회로, 데이터, 데이 터베이스, 데이터 구조들, 테이블들, 어레이들, 및 변수들을 포함한다. 구성요소들과 '~부'들 안에서 제공되는 기능은 더 작은 수의 구성요소들 및 '~부'들로 결합되거나 추가적인 구성요소들과 '~부'들로 더 분리될 수 있다. 뿐만 아니라, 구성요소들 및 '~부'들은 디바이스 또는 보안 멀티미디어카드 내의 하나 또는 그 이상의 CPU들을 재생시키도록 구현될 수도 있다. 또한 실시예에서 '~부'는 하나 이상의 프로세서를 포함할 수 있다. 이하 설명의 편의를 위하여, 본 개시는 현재 존재하는 통신표준 가운데 3GPP (The 3rd Generation Partnership Project) 단체에서 정의하는 표준인 5GS 및 NR 규격에서 정의하고 있는 용어 및 명칭들을 사용한다. 하지만, 본 개시가 상기 용어 및 명칭들에 의해 한정되는 것은 아니며, 다른 규격에 따르는 무선통신망에도 동일하게 적용 될 수 있다. 예를 들면, 본 개시는 3GPP 5GS/NR (5세대 이동통신 표준)에 적용할 수 있다. 이하 설명의 편의를 위하여, 본 개시는 현재 존재하는 eSIM (embedded subscriber identity module) 표준 가운 데 GSMA (Global System for Mobile Communications Association) 단체에서 정의하는 표준인 원격 SIM 프로비 저닝 (RSP, remote SIM provisioning) 규격들(SGP.XX 시리즈)에서 정의하고 있는 용어 및 명칭들을 사용한다. 하지만, 본 개시가 상기 용어 및 명칭들에 의해 한정되는 것은 아니며, 다른 규격에 따르는 eSIM에도 동일하게 적용될 수 있다. 범용 통합 회로 카드(UICC: Universal Integrated Circuit Card)는 단말, 일 예로 이동 통신 단말기 등에 삽입 되어 사용되는 스마트카드(smart card)이고 UICC 카드라고도 칭해진다. 상기 UICC에 이동 통신 사업자의 네트워 크에 접속하기 위한 접속 제어 모듈이 포함될 수 있다. 이러한 접속 제어 모듈의 예제들은 범용 가입자 식별 모 듈(USIM: Universal Subscriber Identity Module), 가입자 식별 모듈(SIM: Subscriber Identity Module), 인 터넷 프로토콜 멀티미디어 서비스 식별 모듈(ISIM: IP (Internet Protocol) Multimedia Service Identity Module) 등을 포함한다. USIM이 포함된 UICC를 통상 USIM 카드라고 부르기도 한다. 마찬가지로 SIM 모듈이 포함된 UICC를 통상적으로 SIM카드라고 부르기도 한다. 하기의 설명에서 SIM 카드라 함은 UICC 카드, USIM 카드, ISIM이 포함된 UICC 등을 포함하는 통상의 의미로 사용될 수 있음에 유의하여야만 할 것이다. SIM 카드라 하여도 그 기술적 적용이 USIM 카드 또는 ISIM 카드 또는 일반적인 UICC 카드에도 동일하게 적용될 수 있음은 물론이다. SIM 카드는 이동 통신 가입자의 개인 정보를 저장하고, 이동 통신 네트워크에 접속 시 가입자 인증 및 트래픽 (traffic) 보안 키(key) 생성을 수행하여 안전한 이동통신 이용을 가능하게 한다. SIM 카드는 일반적으로 상기 SIM 카드를 제조할 때 특정 이동 통신 사업자의 요청에 의해 해당 이동 통신 사업 자를 위한 전용 카드로 제조되며, 해당 사업자의 네트워크 접속을 위한 인증 정보, 예를 들어, USIM (UniversalSubscriber Identity Module) 어플리케이션 및 IMSI (International Mobile Subscriber Identity), K 값, OPc 값 등이 사전에 카드에 탑재되어 출고된다. 따라서 제조된 상기 SIM 카드는 해당 이동 통신 사업자가 납품 받아 가입자에게 제공되며, 이후 필요 시에는 OTA (Over The Air) 등의 기술을 활용하여 상기 UICC 내 어플리케이션 의 설치, 수정, 삭제 등의 관리도 수행할 수 있다. 가입자는 소유한 이동 통신 단말기에 UICC 카드를 삽입하여 해당 이동 통신 사업자의 네트워크 및 응용 서비스 의 이용이 가능하다. 그리고 가입자는 이동 통신 단말기 교체 시 UICC 카드를 기존 이동 통신 단말기에서 새로 운 이동 통신 단말기로 이동 삽입함으로써 UICC 카드에 저장된 인증 정보, 이동통신 전화번호, 개인 전화번호부 등을 새로운 이동 통신 단말기에서 그대로 사용이 가능하다. 그러나, SIM 카드는 이동 통신 단말기 사용자가 다른 이동 통신사의 서비스를 제공받는데 있어 불편한 점이 있 다. 이동 통신 단말기 사용자는 이동 통신 사업자로부터 서비스를 받기 위해 SIM 카드를 물리적으로 획득해야 되는 불편함이 있다. 예를 들면, 다른 나라로 여행을 했을 때 현지 이동통신 서비스를 받기 위해서는 현지 SIM 카드를 구해야 하는 불편함이 있다. 로밍 서비스의 경우 불편함을 어느 정도 해결해 주지만, 비싼 요금 및 통신 사간 계약이 되어 있지 않은 경우 서비스를 받을 수 없는 문제도 있다. 한편, UICC 카드에 SIM 모듈을 원격으로 다운로드 받아서 설치할 경우, 이러한 불편함을 상당 부분 해결할 수 있다. 예를 들면, 사용자가 원하는 시점에 사용하고자 하는 이동통신 서비스의 SIM 모듈을 UICC 카드에 다운로 드 받을 수 있다. 이러한 UICC 카드는 또한 복수 개의 SIM 모듈을 다운로드 받아서 설치하고 그 중의 적어도 한 개의 SIM 모듈만을 선택하여 사용할 수 있다. 이러한 UICC 카드는 단말기에 고정하거나 고정하지 않을 수 있다. 단말에 고정하여 사용하는 UICC를 통상적으로 eUICC라고 하는데, 본 개시에서는 원격으로 SIM 모듈을 다운로드 받아 선택할 수 있는 UICC 카드를 eUICC로 통칭할 수 있다. 즉, 원격으로 SIM 모듈을 다운로드 받아 선택할 수 있는 UICC 카드 중 단말에 고정하는 UICC 카드 및 고정하지 않는 UICC 카드를 통칭하여 eUICC로 사용할 수 있다. 또한 다운로드 받는 SIM 모듈정보를 통칭하여 프로파일(Profile) 이라는 용어로 사용한다. 프로파일의 예 는 초기 설정을 위한 Connectivity를 위해서만 용도 제한된 프로파일인 프로비저닝 프로파일 (provisioning Profile), 그리고 이런 용도 제한이 없는 프로파일인 오퍼레이셔널 프로파일 (operational Profile), 테스트용 으로 한정된 테스트 프로파일(test Profile)등으로 용도에 따라 더 구분될 수도 있다. eUICC내에 프로파일을 설치하기 위해서는 통상 단말의 출고 이후에 단말 사용자가 프로파일 다운로드 서버와 실 시간 네트워크 연결을 통해서 프로파일을 다운로드하는 것을 가정하고 있다. 현재, GSMA에서 정의된 eSIM 표준 화 규격인 Remote Profile Provisioning 표준 규격들, 일 예로 Consumer 단말향 Remote SIM Provisioning 표준 인 SGP.21/22, IoT 단말향 Remote SIM Provisioning 표준인 SGP.31/32, M2M 단말향 Remote SIM Provisioning 표준인 SGP.01/02에 따르면, 단말은 프로파일 다운로드 서버와 실시간으로 네트워크로 연결되어, 단말과 프로파 일 서버간에 여러 차례 메시지를 주고받는 과정 및 이 과정에서 상호 인증(Common Mutual Authentication)을 거 친 다음에 프로파일을 다운로드하는 과정으로 정의하고 있다. 하지만, 단말은 프로파일 다운로드 서버와 프로파 일을 다운로드하는 시점에서 항상 네트워크가 연결된 상황을 가정할 수 없다. 따라서, 이를 해소하기 위해서 단 말에 초기 설정을 위한 connectivity만을 제공하는 용도로, 용도가 제한된 프로파일인 provisioning Profile(프 로비저닝 프로파일)이 SGP.21/22에 도입되었다. 이에 따라, 단말 제조사는 provisioning Profile이 탑재된 eUICC를 출고할 수도 있다. 또한, 서비스 사업자와 계약에 의거하여 제조사에서 eUICC내에 위와 같은 용도 제한 이 없는 통신 사업자의 Operational Profile을 선 탑재하여 출고하는 경우도 가능할 수 있다. eUICC에 프로파일 을 선 탑재하는 경우에 있어, 통상 eUICC 제조사 공장에서 프로파일이 선 탑재된 eUICC를 단말 제조사에 납품하 는 형태로 탑재하게 되는데, 해당 eUICC를 포함하고 있는 단말들은 단말 제조사가 하드웨어를 구분하여 재고 관 리(SKU: Stock Keeping Unit)가 필요하다는 문제가 있어 활성화되지 못하고 있다. 한편, 공장에서 프로파일을 단말에 프로비저닝 하는 신규 Work Item이 최근 GSMA(GSM Association, 통신사업자 연합)에서 승인되어 SGP.41 (기술 요구사항 규격), SGP.42(기술 규격(예정))으로 공장에서 프로파일을 단말에 프로비저닝하기 위한 장치 및 방법들에 대한 표준화 논의가 이루어질 예정이다. 본 개시에서 공장에서 프로파일을 프로비저닝하기 위한 기능은 IFPP (In Factory Profile Provisioning) 기능 이라고 지칭하고 해당 기능을 지원하는 상태로 진입하는 경우 IFPP 모드로 진입 또는 IFPP 상태로 표기할 수 있 다. 또한, 각 엔티티(Entity)의 이름 끝에 \"f\"를 추가로 붙여서 해당 모드로 동작하는 상태임을 표기할 수도 있 다. 예를 들어, 특정 Entity로서 단말, LPA, eUICC, 프로파일 서버, 팩토리 IT, SP(Service Provider) 서버, EUM(eUICC Manufacturer) 서버는 IFPP 모드를 더 지원하는 Entity일 수 있으며, 또는 해당 기능만을 지원하는 Entity일 수 있다. 예를 들어, 프로파일 서버의 하나인 SM-DP+는 SGP.21/22에서 정의한 Consumer향 Remote SIM Provisioning 기능을 지원하지만, SGP.41/42에서 정의하는 IFPP 기능의 일부를 추가적으로 더 지원하는 서버일수 있다. 또는 프로파일 서버인 SM-DP+는 IFPP 기능 만을 지원하는 프로파일 서버일 수도 있다. IFPP 상태로 동 작하고 있는 프로파일 서버는 일 예로 프로파일서버f, SM-DPf와 같이 본 발명에서 혼용하여 표기할 수도 있다. 본 개시에서 UICC(Universal Integrated Circuit Card)는 이동통신 단말기에 삽입하여 사용하는 스마트카드로 서 이동통신 가입자의 네트워크 접속 인증 정보, 전화번호부, SMS와 같은 개인정보가 저장되어 GSM(Global System for Mobile Communications), WCDMA, LTE, 5G 등과 같은 이동통신 시스템에 접속 시 가입자 인증 및 트 래픽 보안 키 생성을 수행하여 안전한 이동통신 이용을 가능케 하는 칩을 의미할 수 있다. UICC에는 가입자가 접속하는 이동통신 네트워크의 종류에 따라 SIM(Subscriber Identification Module), USIM(Universal SIM), ISIM(IP Multimedia SIM)등의 통신 어플리케이션이 탑재되며, 또한 전자지갑, 티켓팅, 전자여권 등과 같은 다양 한 응용 어플리케이션의 탑재를 위한 상위 레벨의 보안 기능을 제공할 수 있다. 본 개시에서 eUICC(embedded UICC)는 단말에 내장된 보안 모듈로 한정하지 않으며 단말에 삽입 및 탈거가 가능 한 착탈식 보안 모듈을 포함한다. eUICC는 programmable SIM 카드로 일반적으로 OTA(Over The Air)기술을 이용 하여 프로파일을 저장한 서버로부터 다운받아 설치할 수 있다. eUICC는 프로파일 다운로드 및 설치가 가능한 UICC로 명명할 수 있다. 본 개시에서 eUICC에 OTA 기술을 이용하여 프로파일을 다운받아 설치하는 방법은 전술한 바와 같이 단말에 삽입 및 탈거가 가능한 착탈식 UICC에도 적용될 수 있다. 예를 들면, 본 개시의 실시 예는 OTA 기술을 이용하여 프로 파일을 다운 받아 설치 가능한 착탈식 UICC에 적용될 수 있다. 본 개시에서 eUICC 고유 식별 번호로(eUICC ID) 는 EID로 지칭될 수 있다. 본 개시에서 지칭하는 UICC는 SIM과 혼용될 수 있고, 용어 eUICC는 eSIM과 혼용될 수 있다. 본 개시에서 프로파일(Profile)은 UICC 내에 저장되는 어플리케이션, 파일시스템, 인증키 값 등을 소프트웨어 형태로 패키징 한 것을 의미할 수 있다. 또한, 프로파일을 접속정보로 명명할 수 있다. 또한, 본 개시에서 USIM 프로파일은 프로파일과 동일한 의미 또는 프로파일 내 USIM 어플리케이션에 포함된 정보를 소프트웨어 형태로 패키징 한 것을 의미할 수 있다. 본 개시에서 프로파일 패키지(Profile Package) 내지 암호화된 프로파일 패키 지 (Bound Profile Package, BPP)는 프로파일과 혼용되거나 특정 프로파일의 데이터 객체(data object)를 나타 내는 용어로 사용될 수 있으며, 프로파일 TLV 또는 프로파일 패키지 TLV (Profile Package TLV)로 명명될 수 있 다. 프로파일 식별자는, 프로파일의 고유 식별 번호를 나타내는 ICCID (Integrated Circuit Card Identifier) 로 지칭될 수 있다. 프로파일 패키지가 암호화 파라미터를 이용해 암호화된 경우 보호된 프로파일 패키지 (Protected Profile Package (PPP)) 또는 보호된 프로파일 패키지 TLV (PPP TLV)로 명명될 수 있다. 프로파일 패키지가 특정 eUICC에 의해서만 복호화 가능한 암호화 파라미터를 이용해 암호화된 경우 묶인 프로파일 패키지 (Bound Profile Package (BPP)) 또는 묶인 프로파일 패키지 TLV (BPP TLV)로 명명될 수 있다. 프로파일 패키지 TLV는 TLV (Tag, Length, Value) 형식으로 프로파일을 구성하는 정보를 표현하는 데이터 세트 (set) 일 수 있다. 본 개시에서 프로파일 서버는 프로파일을 생성하거나, 생성된 프로파일을 암호화하거나, 프로파일 원격관리 명 령어를 생성하거나, 생성된 프로파일 원격관리 명령어를 암호화하는 기능을 제공하거나, IFPP 모드를 제공하거 나, 또는 단말의 복수 프로파일 활성화 지원 기능을 포함할 수 있는 서버로, SM-DP(Subscription Manager Data Preparation), SM-DP+(Subscription Manager Data Preparation plus), SM-SR (Subscription Manager Secure Routing)으로 표현될 수 있다. 본 개시에서 사용하는 용어 '단말' 또는 '기기'는 이동국(MS), 사용자 장비(UE; User Equipment), 모바일 장비 (ME: Mobile Equipment), 사용자 터미널(UT; User Terminal), 무선 터미널, 액세스 터미널(AT), 터미널, 가입 자 유닛(Subscriber Unit), 가입자 스테이션(SS; Subscriber Station), 무선 기기(wireless device), 무선 통 신 디바이스, 무선 송수신 유닛(WTRU; Wireless Transmit/Receive Unit), 이동 노드, 모바일 또는 다른 용어들 로서 지칭될 수 있다. 단말의 다양한 실시 예들은 셀룰러 전화기, 무선 통신 기능을 가지는 스마트 폰, 무선 통 신 기능을 가지는 개인 휴대용 단말기(PDA), 무선 모뎀, 무선 통신 기능을 가지는 휴대용 컴퓨터, 무선 통신 기 능을 가지는 디지털 카메라와 같은 촬영장치, 무선 통신 기능을 가지는 게이밍 장치, 무선 통신 기능을 가지는 음악저장 및 재생 가전제품, 무선 인터넷 접속 및 브라우징이 가능한 인터넷 가전제품뿐만 아니라 그러한 기능 들의 조합들을 통합하고 있는 휴대형 유닛 또는 단말기들을 포함할 수 있다. 또한, 단말은 지원하는 성능 특성 에 따라 M2M(Machine to Machine) 단말, MTC(Machine Type Communication) 단말/디바이스, IoT 단말/디바이스 를 포함할 수도 있다. 본 개시에서 단말은 전자장치 또는 단순히 디바이스라 지칭할 수 있다. eUICC로 프로파일 설치하는 기능을 제공하는 단말은 eSIM 단말로 지칭할 수 있다.본 개시의 실시 예에 따르면, EUM은 eUICC Manufacturer로 eUICC를 생산하고 eUICC를 personalization하여 제 공하는 제조 업체를 의미하며, EUM에서 전달하는 정보들은 EUM 서버 또는 별도 구성 요소 간의 채널을 통해서 온 오프라인으로 전달될 수 있다. 또한, EUM은 EUM 서버 또는 EUM에서 수행하는 역할을 의미할 수 있다. 본 개시에서 단말 또는 기기는 UICC 또는 eUICC를 제어하도록 단말 또는 기기 내에 설치된 소프트웨어 또는 애 플리케이션을 포함할 수 있다. 소프트웨어 또는 애플리케이션은, 일 예로 Local Profile Assistant(LPA), SIM Manager, IoT Profile Assistant(IPA)와 같은 애플리케이션일 수 있다. 해당 소프트웨어 또는 기능들은 통합되 어 제공될 수도 있다. 예를 들어, LPA와 IPA는 하나의 통합 앱으로 제공될 수도 있다. 본 개시에서 UICC 또는 eUICC를 제어하도록 단말 또는 기기 내에 설치된 소프트웨어 또는 애플리케이션을 통칭하여 LPA로 표기할 수 있 다. 본 개시에서 AKA는 인증 및 키 합의 (Authentication and Key agreement)를 나타낼 수 있으며, 3GPP 및 3GPP2 망에 접속하기 위한 인증 알고리즘을 나타낼 수 있다. K는 AKA 인증 알고리즘에 사용되는 eUICC에 저장되는 암 호키 값이며, 본 개시에서 OPc는 AKA 인증 알고리즘에 사용되는 eUICC에 저장될 수 있는 파라미터 값이다. 본 개시에서 NAA는 네트워크 접속 어플리케이션 (Network Access Application) 응용프로그램으로, UICC에 저장 되어 망에 접속하기 위한 USIM 또는 ISIM과 같은 응용프로그램일 수 있다. NAA는 망접속 모듈일 수 있다. 본 개시에서 End user, 사용자, 가입자, 서비스 가입자, user는 해당 단말의 사용자로 혼용되어 사용될 수 있다. 본 개시에서 Device Mf는 단말 제조 공정에서 단말에 특정 데이터 또는 설정을 프로비저닝하도록 처리하는 역할 을 담당하는 장치들로 구성되며, 단말에 프로파일을 다운로드 해 주는 기능을 포함하는 모듈을 지칭할 수 있고, 프로파일 서버로부터 프로파일들을 획득하여 저장할 수 있는 기능을 더 포함할 수도 있다. Factory IT는 팩토리 IT 장비,팩토리 IT 서버, 팩토리 프로비저닝 장비, 공장 서버와 혼용되어 사용될 수 있고, 이하 서버로 표현하 였더라도 본 발명에서 Factory IT는 1개 이상의 모듈, 일 예로 데이터를 저장하는 서버와 설정 또는 데이터를 eSIM 단말에 주입해 주는 역할을 하는 단말로 기능할 수 있다. 본 개시에서 OEM은 단말 제조사, 제조사, Device Mf와 혼용되어 사용될 수 있다. 본 개시에서 Service provider(SP)는 통신 서비스 사업자, MNO, 모바일 네트워크 사업자, 사업자, 통신사, SP 서버로 혼용되어 사용할 수 있으며 실시 예에 따라 Service provider는 Service Provider의 서버 또는 Service Provider에서 수행하는 역할을 의미할 수 있다. 본 개시에서 프로파일 서버는 공장용 프로파일을 생성 및 준비, 저장하는 역할을 포함하는 서버로 SM-DPf 또는 프로파일 서버로 사용하였다 본 개시에서 암호화 키는 암복호화키를 모두 포괄하는 의미로 사용하였다. 예를 들어, 암호화 키는 데이터를 암 호화하는 데 사용하는 비밀키 (secret key 또는 private key, 개인키로 용어 혼용 사용) 또는 이를 복호화하는 공개키가 포함될 수 있으며, 공개 키는 인증서 형태로 공유될 수 있다. 본 개시에서 일회용 암호화 키, 일회용 공개키 또는 개인키는 key agreement를 위해 요구되는 암호화 키를 의미 할 수 있으며, 여기에서 일회용(one-time)은 1번의 프로파일 설치를 위해 사용되는 키라는 의미로 해석될 수 있 다. 본 개시에서 후술하는 바와 같이 해당 키는 프로파일 설치 성공 시 폐기, 설치 최종 성공 전에는 eUICC에 저장 가능하며, GSMA SGP.22 정의를 참고하여 해석될 수 있다. 본 개시는 eUICC를 포함하는 단말에서 하드웨어 SKU는 분리하지 않고, 프로파일을 삽입하여, 하드웨어 SKU를 동 일하게 유지하면서 eSIM 단말을 출시할 수 있도록 하는 방법 및 장치를 제공하고자 하는 것이다. 또한, 본 개시는 공장 환경의 특성상 대량의 단말들에 빠르게 프로파일 주입이 필요하여, 프로파일 서버와 개별 단말 간 실시간 네트워크 연결 및 상호 인증하는 절차를 포함하여 여러 차례 왕복으로 메시지를 주고받는 과정 을 수행하기 어려우므로, 이를 극복하여 대량의 단말들에 프로파일들을 신속하게 다운로드하여 설치해 줄 수 있 는 방법 및 장치를 제공하고자 하는 것이다. 이를 위해 프로파일 서버 및 eSIM 단말에서 일반 상황에서의 프로 파일 다운로드와 공장에서의 단말에 프로파일을 대량으로 주입하는 환경에서의 프로파일 다운로드를 구분하는 동작이 필요할 수 있다. 또한, 프로파일 서버와 단말 간 실시간 연결을 고려하지 않고 Factory IT 장비에서 프 로파일(들)을 단말에 프로비저닝하는 방법이 필요할 수 있으며, 특히 프로파일 서버 (일 예로 SM-DP+) - eUICC간 \"비 실시간성\"을 고려한 프로파일 암호화 키 전달 및 검증, 설치하는 방법이 필요할 수 있다. 또한, 공장에 서 대량으로 프로파일을 프로비저닝하는 환경을 고려한 방식이 필요하며, 특히 이를 위해 프로파일들을 주문 및 준비하는 과정에서 Entity간에 대량의 프로파일(들)의 정보를 전송할 수 있도록 제공하는 방법 및 장치가 필요 할 수 있다. 본 개시의 다양한 실시 예에 따르면, 단말 제조사는 대량의 프로파일들을 프로파일 서버와의 실시간 연결이 없 이도 eSIM 단말에 미리 설치하여 출고할 수 있으며, H/W SKU 분리 없이 프로파일을 설치함으로써 재고를 효율적 으로 관리할 수 있다. 또한, 본 개시의 다양한 실시 예에 따르면, 사용자는 프로파일이 이미 설치된 단말을 구입함으로써 네트워크에 바로 접속할 수 있어 사용자가 프로파일 다운로드를 위해 와이파이 또는 이동통신 망을 찾아가야 하는 불편함을 해소할 수 있으므로 사용자의 편의성을 증대시킬 수 있다. 또한, 본 개시의 다양한 실시 예에 따르면, 통신 사업자는 자사 프로파일 다운로드를 위한 Provisioning Profile 또는 자사의 네트워크 서비스를 바로 이용할 수 있는 operational Profile이 설치된 상태로 단말을 사 용자에게 제공할 수 있으므로 사용자의 eSIM 사용 편리성을 재고할 수 있다. 도 1은 본 개시의 실시 예들에 따른 프로파일을 프로비저닝하기 위한 구성 요소 간의 관계를 나타낸 도면이다. 도 1을 참조하면, SM-DPf (이하 'SM-DPf' 또는 '프로파일 서버'로 기술)는 프로파일을 생성하기, 생성된 프로파일을 저장하기, 생성된 프로파일을 암호화하기, 원격 프로파일 관리 명령어(RPM: Remote Profile Management)를 생성하기, 생성된 프로파일 원격 관리 명령어를 암호화하기, 생성된 프로파일을 eSIM 단말 또는 다른 프로파일 저장 서버에 전송하기, IFPP를 위한 프로파일을 생성하기, IFPP를 위해 생성된 프로파일을 저장 하기, 또는 IFPP를 위해 생성된 프로파일을 암호화하기 중 적어도 하나를 수행할 수 있다. 원격 프로파일 관리 (RPM: Remote Profile Management)는 프로파일 서버에서 단말로 전송하는 명령어에 의해 프로파일 설치, 활성화, 비활성화, 삭제 및 기타 기능이 수행되는 일련의 절차를 통칭할 수 있다. RPM의 명령어는 통신 사업자, 서비스 제공자, 또는 단말의 소유자에 의해 요청되어 프로파일 서버에 의해 생성될 수 있다. SM- DPf는 SP(Service Provider)/SP 서버(이하, SP 또는 SP 서버로 칭할 수 있다.)로부터 프로파일 주 문 요청을 수신하여 IFPP를 위한 프로파일 생성을 위한 요청인지를 판별하거나, Device Mf(이하, Device Mf, Factory 서버, 또는 OEM, Device Mf으로 칭할 수 있다.) 내지 SP/SP서버로부터 수신된 프로파일 주문 정보를 EID 주문 정보와 조합하여 프로파일과 EID를 맵핑하고 프로파일 서버에 준비해 둘 수도 있다. SP/SP서버는 Device Mf으로부터 수신된 프로파일 주문 요청을 수신하고 IFPP를 위한 프로파 일들에 대한 제공 주문 요청인지를 판별하여 SP/SP서버에서 SM-DPf로 주문을 넣음으로써, 프로파일 서버에서 1개 이상의 BPP(Bound Profile Package)를 Device Mf에 제공하도록 할 수 있다. 단말은 eUICC와 통신 모뎀(미도시)을 포함할 수 있다. 통신 모뎀은 무선 통신을 위한 기저대역 프 로세서(Baseband Processor) (이하 기저대역(Baseband))가 1개 이상 탑재될 수도 있다. 단말은 Device Mf로부터 IFPP를 위해 생성된 BPP(들)을 제공받아 eUICC로 BPP(들)을 설치하는 기능을 제공할 수 있다. 단말은 FPA를 거쳐서 eUICC에 BPP를 eUICC로 전달할 수 있다. 한편, SM-DPf를 1개로 표현하였으나 SM-DPf는 복수 개일 수 있고 이에 따라 Device Mf는 복 수 개의 SM-DPf로부터 BPP들을 수신하여 저장해 둘 수도 있다. 전술한 바와 같이 FPA는 eUICC 제어 소프트웨어 또는 애플리케이션으로 IFPP 기능을 지원하는 역할을 수 행할 수 있다. FPA는 단말 내지 eUICC의 논리적인 기능으로 구현될 수도 있다. FPA는 Device Mf로부터 프로파일과 프로파일 서버인증을 위한 정보들을 수신 받아 이를 eUICC에 전 송해 줄 수 있고, eUICC로부터 프로파일 설치 결과를 획득하여 Device Mf에 전달해 주는 역할을 수 행할 수도 있다. eUICC은 FPA로부터 공장용 프로파일 설치 준비 또는 설치를 요청하는 ES10f 함수를 수신하여, 공장 에서의 프로파일 설치 요청임을 판별하고 IFPP모드로 진입을 결정할 수 있다. IFPP를 지원하는 eUICC는 FPA 서비스를 통해 FPA에서 요청된 메시지를 처리하고 처리 결과를 FPA에 회신하여 줄 수 있다. eUICC는 프로파일과 SM-DPf 인증 정보들을 FPA로부터 획득하여 해당 정보를 가지고 프로파일 의 복호화를 수행하여 설치를 처리하고, 설치된 결과를 FPA에 회신할 수도 있다. 또한, eUICC는 수신된 메시지를 서명한 구성 요소의 서명 검증을 통해서 프로파일을 암호화한 프로파일 서버를 검증하거나 또는 메시지를 전송한 프로파일 서버의 인증을 수행할 수도 있다. eUICC에는 eUICC의 보안 도메인들에서 요구하는 인증서들(Credentials), 예를 들어 프로파일 서버의 인증서를 검증하기 위한 증명 서 발급자의 루트 공개 키(Certificate Issuer's Root public Key), eUICC 제조사의 키 셋(keyset) 등을 저장 하는 공간인 ECASD(Embedded UICC Controlling Authority Security Domain), eSIM 운영 플랫폼, FPA Service를 제공하는 ISD-R(Issuer Security Domain-Root)이 포함될 수 있다. 또한, eUICC에는 FPA의 기능의 일부가 구현되어 있을 수도 있다. Device Mf는 EUM/EUM 서버(이하, EUM(eUICC manufacturer) 또는 EUM 서버로 칭할 수 있다.)로부터 일회용 eUICC 암호화 키를 포함한 주문한 eUICC들에 대한 소정의 정보들을 획득하거나, 해당 정보의 전체 또는 일부를 BPP 생성을 위해 SM-DPf에 전달하고, 이에 대한 결과로 수신된 암호화 키 정보와 BPP들을 저 장하는 서버를 포함할 수 있다. 또한, 이를 통해 획득한 대량의 BPP들 중에 하나 또는 그 이상의 BPP들을 단말 들에 프로비저닝하는 단말 (예. 설치 PC)을 포함하여 구성될 수 있다. Device Mf에서 SM-DPf, SP 서버, EUM과 주고받는 정보들의 일부는 서버 간 인터페이 스를 통한 메시지 송수신이 아닌 다른 온라인 또는 오프라인 채널 (예, 이메일 전송 등)의 형태로 해당 역할을 수행하는 주체 간(즉, 단말 제조사, 프로파일 서버 운영 벤더, 서비스 사업자, eUICC 제조사)에 공유될 수도 있 다. EUM(eUICC Manufacturer)은 eUICC 제조 업체로 eUICC들을 단말 제조사에 제공할 수 있다. EUM은 eUICC 인증을 위한 자격 증명을 위한 키 정보들을 생성하여 eUICC에 주입하여 개인화(personalization)할 수 있다. EUM(eUICC Manufacturer)/EUM 서버은 일회용 암호화 키를 포함한 해당 eUICC들에 대한 소정의 정보들을 OEM/Device Mf 서버에 제공할 수도 있다. 본 개시의 도면에는 도시되지 않았으나, 해당 eUICC들에 대한 소정의 정보들은 OEM의 요청에 따라 EUM(eUICC Manufacturer)/EUM 서버에서 SM-DPf로 전송될 수도 있다. 이는 eUICC에 대한 일회용 암호화 키 또는/그리고 eUICC Info와 같은 정보일 수 있다. SP(Service Provider)는 전술한 바와 같이 프로파일을 사용하여 네트워크 서비스를 제공하는 사업자로, SP/SP 서버에서 IFPP 기능을 위한 프로파일(들)을 SM-DPf에 주문하여 프로파일 서버에서 주 문받은 프로파일들을 생성 및 준비하도록 할 수 있다. 이하, 전술한 구성 모듈들에 대한 설명은 후술할 도면들에서 표기된 모듈들의 역할 및 관계에서도 적용될 수 있 다. 또한, 전술한 구성 모듈 중에서 SM-DPf, Device Mf, EUM/EUM 서버, SP/SP 서버간 에 주고받는 정보로써 주문 정보들은, 각 Entity의 서버 간 인터페이스 연동 또는 이메일 등 다른 형태로 전달 될 수 있다. 도 2는 본 개시의 일 실시예에 따른 대량의 프로파일들을 프로비저닝하는 동작을 설명하기 위한 도면이다. 도 2를 참조하면, 단말을 출고하기에 앞서 단말 제조사는 공장에서 프로파일을 eUICC에 선 탑재하여 출고할 수 있으며 이 경우 1개 이상의 단말들, 특히 대량의 단말들에 프로파일들을 프로비저닝 할 수도 있다. 이 단계는 프로파일들을 준비하여 Device Mf에 전달하는 단계 (2027 단계), 및 Factory IT에서 이를 N개의 서로 다 른 eUICC에 설치하는 단계 (2070 단계)로 나누어질 수 있다. 도 2의 각 단계에서 주고받은 상세 정보들 및 이에 대한 실시 예들은 후술하는 도 3 내지 6에서 상세히 설명된다. 2027 단계에서, IFPP용 프로파일들이 준비되어 Device Mf에 전달될 수 있다. eUICC를 탑재한 단말을 제조하고자 하는 단말 제조사는 EUM/EUM 서버를 통해 M개의 eUICC들을 주문할 수 있고, EUM은 주문받은 M개의 eUICC들에 대한 암호화 키 정보들을 포함한 소정의 정보들을 Device Mf에 제공(2030 단계)할 수 있다. 해 당 암호화키 정보들을 포함한 소정의 정보들은 도 3에서 후술하는 바와 같이 EUM의 private key 또는 개별 eUICC의 private key로 서명되어 암호화된 정보로 전송될 수 있다. EUM/EUM 서버는 IFPP용 프로파일들에 대한 주문을 받은 경우, eUICC별로 BPP 복호화에 필요한 eUICC 암호화 키 정보를 포함하여 Device Mf에 제공할 수 있다. 이를 수신한 Device Mf는 주문받은 M개의 eUICC들에 대한 암호화 키 정보들을 Factory IT 서버에 저장(2035 단계)할 수 있다. 이후 특정 시점에, Device Mf는 EUM으로부터 주문한 M개의 eUICC들의 일부 N개 또는 전체 eUICC에 프로파일 탑재를 결정할 수 있다. 이는, SP(Service Provider)/SP 서버로부터의 프로파일의 선 탑재 출고 요청에 따른 것일 수 있다. Device Mf은 EID 리스트를 260 단계 이전의 특정 시점에서 SP/SP 서버 또는 SM-DPf에 제공 할 수도 있다. 이를 수신한 SP/SP 서버는 260 단계 이전에 EID 리스트를 SM-DPf에 제공할 수 있다. 일 예로, 245 단계가 발생하기 전 Device Mf가 SP/SP 서버에게 EID에 Linked된 프로파일을 사전에 준비할 수 있도록 Profile(들) 개수, EID(들)의 리스트 중 적어도 하나의 정보를 SP/SP서버에게 전달할 수도 있다. SP/SP 서버는 프로파일을 SM-DPf에 주문(2045 단계)할 수 있다. 앞서 SP/SP 서버가 EID 리 스트를 가지고 있거나 또는 이전 특정 시점에서 EID 리스트를 획득한 경우, SP/SP 서버는 Profile을 주문 시 Profile(들) 개수에 추가로 EID 정보를 포함하여 SM-DPf에 요청할 수 있다. SP/SP 서버, SM-DPf, 및 Device Mf는 해당 주문을 특정할 수 있는 정보를 서로 공유(2050 단계)할 수 있다. 해당 주문을 특정할 수 있는 정보는 SP/SP 서버 또는 SM-DPf가 Device Mf(201 5)에게 제공하는 식별 정보로 공유될 수도 있다. 일 예로 식별 정보는, Batch ID, 주문 ID 같은 정보, 주문한 프로파일 리스트 또는 EID 리스트, 프로파일 리스트 또는 EID 리스트들의 시작과 끝 번호에 관한 정보, 공장 일 련 번호, 또는 생산자 식별 번호에 관한 정보 중 적어도 하나일 수 있다. Device Mf는 2030 단계에서 획득한 eUICC들의 키 정보 중에서 SP(Service Provider)가 프로파일을 탑재할 단말들의 숫자인 N개 만큼 해당 대상 단말들의 eUICC에 해당하는 키 정보들을 SM-DPf에 전달(2055 단계)할 수 있다. 대상 단말들의 eUICC에 해당하는 키 정보들은 전술한 2030 단계에서 수신한 키 정보들의 일부 또는 전체일 수 있다. SM-DPf은 245 단계에서 수신한 프로파일 주문 정보, 2040 단계에서 수신한 프로파 일-EID의 링크 정보, 250 단계에서 상호 공유한 주문 정보, 255 단계에서 수신한 프로파일을 설치할 대상 eUICC 들의 암호화 키 정보들을 수집하는 단계 중 적어도 하나 이상의 단계에서 수집한 정보들을 조합하여 프로파일 서버에서 암호화된 프로파일 패키지를 생성한 후 (2060 단계) 해당 생성한 프로파일 패키지들과 eUICC binding에 대한 정보를 Device Mf에 제공(2065 단계)할 수 있다. 프로파일 서버는 생성한 암호화 된 프로파일 패키지들과 각 BPP 암호화 키 정보들을 하나 이상의 메시지로 Device Mf에게 전송할 수 있고 해당 메시지로 전송되는 데이터의 일부 또는 전부는 서명된 데이터로 제공될 수도 있다. 2070 단계에서, Factory IT에서 IFPP를 위한 프로파일들을 eUICC에 설치하는 동작이 설명될 수 있다. 이 단계는 N개의 eUICC에 대해서 수행될 수 있다. Device Mf는 공장에서 단말을 출고하기 전에 단말에 프로파일을 주입하여 출고할 수 있다. 이를 위해 Factory IT에 BPP와 eUICC에서 프로파일 복호화에 필요한 일련의 암호화 키 정보들을 Device Mf에 서 획득하여 저장할 수 있다. 해당 일련의 암호화 키 정보들은 eUICC의 일회용 공개 키(이하 otPK.eUICC.KA 또 는 eUICC의 otPK로 표기)를 포함할 수 있다. Factory IT에 BPP와 eUICC에서 프로파일 복호화에 필요한 일련의 암호화 키 정보들은 공장 내부의 유무선 네트워크를 통해 공장에서 개별 단말들에 전송될 수 있다. BPP와 일련의 암호화 키 정보들은 하나 이상의 메시지에 포함되어 단말에게 전송될 수 있다. otPK.eUICC.KA가 포함되어 전송되는 경우, otPK.eUICC.KA는 프로파일 서버로부터 서명된 데이터에 포함되어 단말에게 수신될 수 있다. 일 예로, otPK.eUICC.KA는 다 음 중 하나로 서명된 데이터에 포함되어 수신될 수 있다. 물론 하기의 예시에 제한되지 않는다. -SK.DPauth.SIG: 프로파일 서버가 프로파일 서버 인증에 사용한 프로파일 서버의 개인키 - SK.DPpb.SIG: 프로파일 서버가 프로파일 바인딩에 사용한 프로파일 서버의 개인키 - SK.DPxx.SIG: xx가 IFFP 용도를 의미하도록 정의된 프로파일 서버의 개인키 전술한 바와 같이, SK.DPpb.SIG는 프로파일 서버에서 프로파일 바인딩을 위해 사용되는 프로파일 서버의 개인키 또는 프로파일 서버는 IFPP 용도를 위해 사용한 프로파일 서버의 개인키일 수 있다. DPxx.SIG에서 용도를 나타 내는 xx에서 xx가 IFPP 용도임을 나타내는 특정 정보로 표기될 수 있다. 한편, IFPP에서 SK.DPpb.SIG 추가적인 용도로 프로파일 서버의 인증을 제공하는 경우, SK.DPpb.SIG 및 대응되는 PK.DPpb.SIG가 프로파일 서버의 인증을 위해 사용될 수도 있다.단말은 Factory IT로부터 BPP(들)을 제공받아 eUICC로 IFPP모드에서 BPP(들)을 주입하는 기 능을 제공할 수 있다. 예를 들어, 해당 단말이 BPP를 수신하는 시점에 Factory Provisioning 모드인 상태 로 동작하거나 단말은 BPP 수신 시점에서 IFPP로 진입해야 함으로 인지하여 동작을 개시할 수도 있다. 또 는, 단말은 공장 직원의 단말에 입력되는 이벤트, 또는 설정 값, 또는 특정 VPN(Virtual Private Network) 임으로 인지 등을 통해서 해당 모드로 진입할 수도 있다. 한편, UI 또는 설정 값으로 IFPP 모드 진입 은 일반 환경에서는 사용자에게 표시되지 않도록 제한되는 UI로 제공될 수 있다. 단말은 BPP를 eUICC으로 전달할 수 있는데, 전술한 바와 같이 FPA(미도시)를 거쳐서 eUICC로 전달할 수 있다 (2075 단계). FPA(미도시)를 사용하여 eUICC로 전달되는 메시지의 한 예로 ES10x의 하나 이상의 메시지에 포함되어 전송될 수 있다. 이하, 구체적인 실시 예는 도 4 내지 도 6에서 후술된다. eUICC가 단말로부터 수신한 메시지는 IFPP를 위한 동작임을 인지할 수 있는 정보를 포함할 수 있다. eUICC가 단말로부터 수신한 메시지에 기반하여 IFPP용으로 프로파일 설치 동작 수행으로 판 단하여 진입할 수 있다. IFPP를 위한 동작임을 인지할 수 있는 정보는 IFPP용으로 정의되는 신규 function , 기 존 SGP.21/22 내지 SGP. 31/32에서 정의한 ES10x 메시지에 추가되는 IFPP 구분자 파라미터, 또는 단말 출고 후 일반 환경에서 (Consumer향, 또는 M2M향 또는 IoT향) 프로파일 프로비저닝을 위해서 포함되는 공장 출고용 식별 정보 중 적어도 일부일 수 있다. 일 예로 공장 일련 번호, Batch ID, 생산자 식별 정보와 같은 값 중의 하나일 수 있다. 전술한 바와 같이, 단말은 프로파일 서버로부터 otpk.eUICC.KA가 포함된 데이터를 수신(2075 단계) 하면, 단말은 서명된 데이터를 다시 eUICC에 FPA를 통해 eUICC에 전달할 수 있다. 단말의 FPA는 수신된 메시지를 프로파일 설치 준비를 위한 ES10f함수와 BPP전송을 위한 ES10f함수로 구분하여 순차적으로 전 송할 수도 있다. 또는 이 둘을 구분하지 않고, 하나의 함수에 모두 포함하여 전송하는 것도 가능할 수 있다. 프 로파일 설치 준비를 위한 ES10f함수를 구분하여 전송하는 경우, DPf Signature와 otPK.EUICC.KA 또는/그리고 otPK.EUICC.KA를 SM-DPf의 개인키(앞서 전술한 예시로 SK.DPpb.SIG, SK.DPauth.SIG, 또는 SK.DPifpp.SIG 중의 하나)로 서명한 DPf signature 중 적어도 하나 이상의 정보가 포함되어 전송될 수 있다. eUICC는 프로파일 서버의 서명을 검증하고, 사전에 eUICC에 저장해 둔 eUICC의 일회성 비밀 키(otSK.EUICC.KA)를 이용하여 세션 키를 생성하고, BPP를 복호화하여 설치를 처리할 수 있다. (2080 단계) 또 한 프로파일 설치를 처리한 후술할 도 4 내지 도 6과 같이 FPA Service 상태를 비활성화 상태로 변경하여 처리 하는 것도 가능할 수 있다. eUICC는 프로파일의 설치 결과를 단말의 FPA에 전송하여 단말에서 Device Mf에 회신해 줄 수 있다. (2085 단계) Device Mf는 프로파일 설치 결과를 다시 SM-DPf에게 회신해 줄 수 있다. Device Mf은 프로 파일 설치 결과들을 개별적으로 SM-DPf에 회신할 수도 있고, 프로파일 설치 결과들을 수집했다가 특정 시 점에 일괄로 SM-DPf에 제공할 수도 있다. 또한, SM-DPf 또는 Device Mf은 프로파일 설치 결 과(들)을 SP/SP 서버에 선택적으로 제공할 수도 있다. 도 3은 본 개시의 일 실시 예에 따른 대량의 프로파일을 프로비저닝하기 위해 프로파일을 준비하는 동작을 설명 하기 위한 도면이다. 도 3은 도 2의 2070 단계 내지 2090 단계를 상세하게 설명하기 위한 것일 수 있다. 도 3은 도 4 내지 도 8의 절차를 수행하기 전에 Device Mf에서 BPP를 획득하여 준비하는 일 예이다. 다만, 본 개시가 도 4 내지 도 8의 절차를 수행하기 전에 도 3의 절차에 한정되어 BPP를 획득해야 하는 것은 아니다. 도 3을 참조하면, eUICC를 탑재하고자 하는 Factory IT/OEM는 EUM/EUM 서버에게 eUICC들을 주문할 수 있다. EUM은 eUICC에서 사용하는 otSK/PK. EUICC.KA 쌍을 생성해서 eUICC에 otSK.EUCC.KA를 주입하고, Device Mf에게 otSK.EUICC.KA가 탑재된 상기 eUICC 납품 시에 eUICC별로 otPK.EUICC.KA, [eUICC Info], [EID], otPK.EUICC.KA를 포함한 데이터를 eUICC 또는 EUM의 개인키로 서명한 Signature, eUICC 의 인증서(CERT.EUICC.SIG) 및 인증서 체인, EID, 또는 PK.EUICC.SIG 중 적어도 하나를 포함하여 전달할 수 있다. EMU에서 Device Mf으로 전달되는 상기 데이터들이 EUM 서명된 데이터로 전송되는 경우, EUM의 서명 값(eumSignature) 및 EUM 인증서 내지 EUM의 공개키(PK.EUM.SIG)가 더 포함되어 전송될 수 있다. 또한 해당 전 송되는 정보 중에서 해당 eUICCs 주문에 공통으로 적용되는 정보들(일 예로 eUICC Info)는 eUICC별 중복 포함되 지 않고 전송될 수도 있다. (3030 단계) 위에 언급한 바와 같이 otPK.EUICC.KA는 EUM의 비밀키로 서명되어 전송될 수도 있다. otPK.EUICC.KA가 EUM의 비밀키로 서명되어 전송되는 경우, eUICC의 서명 값 및/또는 eUICC별 인증서를 포함하지 않고 전송될 수 있다. 전송되는 정보들은 프로파일 서버에서 Factory IT와 연동된 interface를 통해서 전달 또는 다른 온/오프 라인 방법을 통해 전달될 수 있다. 각 전송되는 정보는 다음을 나타낼 수 있다. 물론 하기의 예시에 제한되지 않는다. - otPK.EUICC.KA: 프로파일 서버와 eUICC간 세션 키 생성에 사용되는 일회성 공개키. SGP.22에 언급된 바와 같 이 여기서 일회성의 의미는 한 번의 프로파일 설치 성공 시에만 사용된다는 의미. - SK(Data including otPK.EUICC.KA): eUICC의 비밀키로 서명된 otPK.EUICC.KA를 포함하는 데이터로, 하기 데 이터 포맷의 예시에서는 euiccfSignature로 표시 - CERT.EUICC.SIG과 인증서 체인: eUICC 인증서 및 eUICC 인증서 검증을 위한 상위 인증서들의 체인을 의미 - CERT.EUICC.SIG는 eUICC 인증서로, 고유 식별 번호인 EID와 eUICC 서명을 복호화하기 위한 공개 키 (PK.EUICC.SIG)를 포함. eUICC가 EUM으로부터 인증된 것인지를 증명하는 데에도 사용 - Certificate Chain: CERT.EUICC.SIG의 상위 인증서 체인.EUM 공개 키를 포함하는 인증서인 CERT.EUM.SIG가 포함될 수 있음. - eUICC Info: eUICC Capability에 대한 정보로, IFPP를 지원하는 eUICC인지를 나타내는 capability에 대한 indication이 포함되거나 포함되어 있지 않을 수 있다. 특정 주문 건에 대해서 동일한 eUICC Capability를 가지 는 경우 eUICC Info는 eUICC별이 아닌 주문 건에 대해 전송될 수도 있음 - EID: eUICC별 할당되는 고유 식별 번호 - PK.EUICC.SIG: eUICC 서명을 복호화하기 위한 eUICC의 공개키로, CERT.EUICC.SIG에 포함되는 값으로 전송되 거나 CERT.EUICC.SIG에 포함되지 않고 전송되는 경우에 별도 파라미터로 전송될 수 있음 전달되는 데이터 형식의 일 예는 다음과 같이 표 1의 형식일 수 있다. 표 1 --ASN1START EuiccData ::= SEQUENCE { euiccOrderId OctetTo16, -- Each unique Order ID euiccInfo2 [34] EUICCInfo2, - as defined in the SGP.22 [2] kmList [58] SEQUENCE OF KeyMaterial, nextCertInChain Certificate, -- The Certificate certifying the eUICC Certificate otherCertsInChain [1] CertificateChain OPTIONAL, -- Other Certificates in the eUICC certificate chain, if any } KeyMaterial ::= SEQUENCE { eidValue [APPLICATION 26] Octet16, -- tag '5A' euiccfSigned EuiccfSigned, euiccfSignature [APPLICATION 55] OCTET STRING, -- tag '5F37' euiccCertificate Certificate -- eUICC Certificate (CERT.EUICC.SIG) } EuiccfSigned ::= SEQUENCE { euiccOtpk [APPLICATION 73] OCTET STRING, -- otPK.EUICC.KA to be used for binding a Profile, tag '5F49' additionalInformation VendorSpecificExtension OPTIONAL, -- as defined in the SGP.22 [2] 2.4a.1.8 } --ASN1STOP 해당 정보를 수신한 Device Mf은 해당 정보들을 저장하여 가지고 있다가 특정 시점에, Device Mf는 EUM으로부터 주문한 M개의 eUICC들의 일부인 N개 또는 전체 eUICC에 프로파일 탑재를 결정하거나 또는 SP 가 Device Mf에 해당 프로파일들을 출고할 단말들에 선 탑재를 요청할 수 있다. Device Mf는 선택적인(optional) 절차로 SP/SP 서버에게 EID에 Linked된 프로파일을 사전에 준비 할 수 있도록 프로파일 개수 및 EID(들)의 정보 중의 적어도 하나를 포함하여 SP/SP 서버에게 전달할 수 있다. (3033 단계) Device Mf는 EID(들)의 정보를 3033 단계가 아닌 3050단계가 발생하기 전의 특정 시 점에 SM-DPf에게 전달할 수도 있다. SP/SP 서버는 프로파일을 SM-DPf에 주문할 수 있다. (3035 단계) SP/SP 서버가 333 단계 또는 이전의 특정 시점에서 EID 리스트들을 획득하여 가지고 있는 경우에, SP/SP 서버는 Profile을 주문하면서 EID 정보를 포함하여 SM-DPf에 주문을 넣을 수도 있다. 프로파일 주 문 메시지는 신규 function 또는 기존 GSMA RSP에서 정의한 Service Provider-프로파일 서버간 ES2+ 주문 interface에 IFPP 주문 식별 정보를 더 포함한 형태로 정의될 수도 있다. 주문 메시지에 포함되는 정보는, 적어 도 다음 중 하나를 포함할 수 있다. - 주문 프로파일들의 묶음을 나타내는 Batch ID - Batch ID별 할당된 프로파일의 개수 또는 ICCID Lists - 주문 프로파일(들)의 개수 - ICCID(s) - 프로파일이 Linked가 필요한 EID(s) - SP (Service Provider) ID - 주문 프로파일들을 준비할 프로파일 서버 주소 (예로 FQDN 타입의 주소) - IFPP 주문 식별자 (IFPP indication) - 생성한 BPP를 전달할 Factory IT 일련 번호 - 생성한 BPP를 전달할 OEM 식별 번호 (생산자 번호) IFPP 주문 식별자로 IFPP indication, 또는 Batch ID는 ES2+ 주문 interface의 Profile Type 데이터의 값의 하 나에 포함되어 전송될 수도 있다. Batch ID는 그룹의 프로파일 주문을 식별하기 위한 ID이므로 Profile Order ID, Bundle Order ID등의 다른 용 어로 대체 사용될 수 있다. SM-DPf는 IFPP만을 지원하는 SM-DPf일 수도 있으나, IFPP를 SM-DPf의 기능 중의 하나로 지원하는 SM-DPf 일 수도 있다. 예를 들어, SM-DPf는 GSMA에서 정의한 SGP.21/22 (스마트폰 등 Consumer 단말에 프로파일 프로비저닝을 위한 규격) 또는 SGP.31/32 (IoT 특화 단말에 프로파일 프로비저닝을 위한 규격)을 지원하는 SM- DPf로 공장에서의 프로파일 프로비저닝을 위한 기능을 추가적으로 지원하는 서버일 수 있다. 해당 프로파일 다 운로드 주문을 수신한 SM-DPf는 IFPPOrder로 정의된 신규 Function 또는 기존 ES2+.DownloadOrder의 신 규 파라미터로 IFPP 판단 정보가 있는지를 판단하여 해당 주문이 IFPP용으로 프로파일 준비임을 인지하여 관리 할 수 있다. 이는 일 예로 전술한 IFPP 주문 식별자 또는 Batch ID 일 수 있다. 한편, 앞서 3035 단계에서 EID 가 함께 수신되지 않은 경우에는, SM-DPf가 해당 Profile을 할당 단계 (allocated)로 상태를 변경하여 처 리해 둘 수 있으며, EID가 335 단계에서 함께 수신된 경우에 EID를 ICCID와 연결하여 Profile의 상태를 링크된 단계(Linked)로 변경하여 준비해 둘 수도 있다. SP/SP 서버 내지 SM-DPf는 Device Mf에게 해당 주문을 특정할 수 있는 정보를 공유할 수 있 다. (3040 단계) SP/SP 서버 내지 SM-DPf는 Factory IT/제조사가 공통으로 동일 주문에 대한 건인지 인지할 수 있는 정보일 수 있다. 즉, 추후 SM-DPf가 프로파일 다운로드 요청을 수신할 수 있다. (3045 단계) SM- DPf가 프로파일 다운로드 요청을 수신 시, 이전에 SP로부터 요청받아 준비한 프로파일들과 맵핑(mappin g)할 수 있도록 해야 하며, 이를 위해서 SP-Device Mf-SM-DPf 간 주문 정보를 공유할 수 있다. 일 예로, 공유할 수 있는 주문 정보는, Batch ID, 프로파일을 저장한 서버의 주소, 프로파일 생성을 요청한 서비스 사업자 식별 정보, 주문한 프로파일 리스트 또는 EID 리스트의 시작과 끝 번호와 같은 정보, 또는 주문한 프로파일 리스트, EID 리스트, Factory IT 식별 번호 중 적어도 하나일 수 있다. 3045 단계에서, Device Mf는 공장에서 단말을 출고하기 전에 단말에 프로파일을 주입하여 출고하고자 할 수 있다. 이를 위해 Device Mf는 SM-DPf에 IFPP용으로 준비된 BPP를 요청할 수 있다. Factory IT에서 SM-DPf로 IFPP 요청임을 표시(indication)하는 방법은 IFPP을 위한 BPP 요청임을 나타내는 신규 Function으로 메시지를 전송, ES9+. Function에 IFPP 식별 indication를 전송, 또는 해당 IFPP 에서만 요구되는 파라미터(일 예로 otPK.eUICC.KA, Batch ID, 또는 SP ID 중 적어도 하나 이상의 정보)가 포함 되어 전송되는 경우 중 적어도 하나로 SM-DPf가 판단할 수 있다. 전술한 ES9+. Function의 일 예로, ES9+. GetBoundProfilePackage과 같은 메시지일 수 있다. 한편, IFPP용 BPP 요청 또는 해당 BPP 생성 요청에 수반되는 일련의 후속 메시지들의 데이터의 하나에, Device Mf는 3030 단계에서 획득한 eUICC들의 Key 정 보 중에서 SP(Service Provider)가 프로파일을 탑재할 단말들의 숫자만큼 해당 대상 단말들의 eUICC에 해 당하는 otPK.EUICC.KA를 포함된 Key 정보들을 SM-DPf에 전달할 수도 있다. 또한, Device Mf에서 SM-DPf로 전송되는 해당 BPP 생성 요청에 수반되는 일련의 후속 메시지들의 데이터의 하나에 BPP 생성을 위해 제공되는 추가 정보로써 단말의 capability로 device info 내지 eUICC capability 정보로 eUICC info를 선택적으로 포함하여 전송할 수도 있다. SM-DPf가 Device Mf로부터 IFPP용 BPP 요청임을 판단할 수 있는 메시지를 수신하고, otPK.eUICC.KA에 대한 키 정보를 수신한 경우에, SM-DPf는 IFPP를 위한 BPP 준비로 판단하여 SM- DPf는 IFPP용 BPP를 생성 단계를 수행할 수 있다. (3050 단계) SM-DPf는 IFPP 모드에서 암호화된 프로파일 패키지인 BPP를 생성하는 절차로 진입할 수 있다. SM-DPf가 IFPP용으로 BPP 생성에 대한 판단하 는 경우는 Factory IT로부터 수신되는 메시지에 이를 인지할 수 있는 정보(일 예로, IFPP용으로 정의된 신규 function, 기존 ES9+ 메시지에 공장에서의 프로파일 다운로드 요청임을 인지할 수 있는 신규 IFPP indication, 또는 신규 파라미터(암호화 Key 정보 등) 중 적어도 하나를 포함하는 정보)를 수신하는 경우일 수있다. SM-DPf가 IFPP용 BPP를 생성해야 함으로 판단하면, SM-DPf는 다음의 절차 중 하나 이상의 절차를 포함하여 IFPP용으로 BPP를 생성할 수 있다. - Profile Eligibility Check : 프로파일 다운로드를 수행하기 전에, SM-DPf가 SP에서 ES2+ 주문 Interface를 통해 수신한 프로파일 타 입이 타겟이 되는 단말/EID에 설치가 적합한지 확인하는 절차로 선택적으로 수행될 수 있다. 335 단계 내지 345 단계를 통해서 EID, eUICC Info, Device Info 중 적어도 하나 이상의 정보가 수신되는 경우, 3035 단계에서 수 신되는 프로파일 주문, 특히 주문에서 명시한 프로파일 타입을 설치할 수 있는지 여부를 선택적으로 (Optionally) 수행할 수 있다. 이에 따라, SM-DPf는 IFPP용 프로파일의 설치가 가능한 EID/단말인지 여 부를 포함하여 자격 검증을 하거나 하지 않을 수 있다. - eUICC의 인증서인 CERT.EUICC.SIG 검증 : SM-DPf가 3045 단계에서 CERT.EUICC.SIG를 수신한 경우 검증을 수행할 수 있다. SM-DPf는 EUM의 인증서를 가지고 3045 단계에서 수신된 CERT.EUICC.SIG를 검증할 수 있다. CERT.EUICC.SIG는 EID를 포함할 수 있는데, EID는 EUM 인증서 안의 EINs의 하나를 포함하는 일련의 번호로 구성될 수 있다. SM-DPf는 CERT.EUICC.SIG에 포함된 EID와 EUM 인증서인 CERT.EUM.SIG에 포함된 허용된 EINs (EUM 식별 IDs)의 값 중의 하나가 매칭 되는 지를 확인하여 CERT.EUICC.SIG가 적법한 eUICC인지를 인증할 수 있다. - eUICC의 서명을 검증 : SM-DPf는 otPK.EUICC.KA가 포함된 데이터의 서명에 사용한 eUICC의 비밀키를 CERT.EUICC.SIG에 포함된 eUICC의 공개키를 가지고 복호화할 수 있다. 본 개시의 일 실시예에 따르면, 3045 단계에서 수신된 otPK.EUICC.KA가 포함된 데이터가 EUM의 비밀키로 서명되어 수신되었다면, SM-DPf는 CERT.EUM.SIG에 포함된 EUM의 공개키를 가지고 복호화를 수행할 수 있다. - otSK/PK.DP.KA : SM-DPf의 일회용 개인키와 공개키 쌍을 생성할 수 있다. - otSK.DP.KA와 otPK.EUICC.KA를 가지고 Session Key 생성 : SM-DPf는 otSK.DP.KA와 otPK.EUICC.KA를 사용하여 특정 프로파일 전송 세션에 사용할 공유된 비밀 값 (shared secret value)을 생성할 수 있다. - ServerChallenge : 3045 단계 내지 3045 단계의 전 단계에서 Device Mf에서 SM-DPf에 해당 정보를 포함하여 전송을 요구하는 경우, SM-DPf가 생성할 수 있다. - eUICC가 SM-DPf와 eUICC간 상호 인증 절차에서 SM-DPf가 eUICC로 보내는 Server Challenge 값을 그대로 보낼 수 있도록 설계된 경우 제공할 수 있다. - BPP (Bound Profile Package) : 세션 키, 키 교체 패키지, ISD-P 생성 및 구성 정보가 포함하여 EID와 바인딩한 프로파일 패키지를 생성할 수 있다. BPP에는 otPK.DP.KA를 포함하며 otPK.DP.KA를 서명한 SM-DPf의 signature를 포함할 수 있다. 3050 단계에서 SM-DPf가 IFPP를 위한 BPP를 성공적으로 생성하면, SM-DPf는 BPP와 BPP설치에 필요 한 일련의 정보들을 Device Mf에게 하나 이상의 메시지들을 통해 전송할 수 있다. (3055 단계) 만약 앞서 BPP를 요청하는 시점에서 Device Mf가 SM-DPf에 Push 서비스를 등록한 경우에, 해당 BPP와 BPP설 치에 필요한 일련의 정보들은 350 단계에서, SM-DPf가 이를 준비한 시점에서 푸시 메시지에 포함되어 전 송될 수 있다. 또는 SM-DPf가 푸시 메시지로 프로파일이 준비되었음을 알리고 이에 대해 Factory IT가 SM-DPf로 접속하여 획득하는 절차가 진행될 수도 있다. 프로파일서버/서버 벤더는 Device Mf에게 생성한 BPP 및 맵핑된 eUICC에서 BPP 검증을 위해 요구되 는 일련의 SM-DPf의 암호화 키 정보리스트들을 하나 이상의 메시지를 통해서 전송할 수 있다. 해당 암호화 키 정보, 일 예로 SM-DPf의 공개키(예를 들어, PK.DPxx.SIG)들은 인증서에 포함되어 전달되거나 인증서에 포함하지 않고 전달될 수 있다. 또한, SM-DPf에서 전송하는 정보는 주문 식별 정보 (일 예로 Service Provider ID, Batch ID, 또는 주문 ID와 같은 정보)를 포함할 수도 있다. SM-DPf에서 전송하는 정보의 일 예는ESbpp.BulkProfileResponse ([SP ID], N x ([Batch ID], BPP including otPK.DP.KA, CERT.DPpb.SIG, [CERT.DPauth.SIG], DPfSigned([otPK.EIUCC.KA or [Index ID]),[DPf Signature]), SM-DPf Certificate Chains)와 같은 메시지일 수 있다. []는 선택적으로 포함될 수 있는 정보를 의미한다. 3055단계에서, otPK.EUICC.KA는 포함되어 전송될 수도 있으며, 만약 포함되어 전송되는 경우에 있어서 서명된 정보로 전송될 수 있다. otPK.EUICC.KA는 BPP에 포함된 ES8+의 하나에 포함되어 전송되거나 또는 BPP에 포함되 지 않고 별도 SM-DPf 서명된 데이터로 전송될 수도 있다. 355 단계에서 전달되는 정보들은 하나의 메시지 또는 한 개 이상의 메시지로 구성되어 Device Mf에 전달 되어 Device Mf에 저장될 수도 있다. Device Mf는 수신된 BPP, BPP별로 맵핑된 EID와 해당 EID에 BPP를 다운로드 설치하기 위한 암호화 키 정 보들을 맵핑하여 저장해 두었다가, 프로파일의 프로비저닝을 수행할 수 있다. (3060 단계). 상기 360 단계의 절 차는 Factory IT가 단말에 BPP 및 해당 EID에 BPP를 다운로드 설치하기 위한 암호화 키 정보들을 전송해 주어, 해당 단말이 eUICC에 BPP와 다운로드 설치를 위한 암호화 키 정보들을 전달하여 eUICC가 전달된 BPP 및 이를 설치하기 위한 암호화 키를 검증하고 프로파일 설치하는 절차를 포함하여 수 행될 수 있다. 단말에서 eUICC에게 BPP 설치를 위한 메시지가 전달될 때, FPA(미도시)를 거쳐서 전달될 수 있고, 또는 FPA(미도시)가 사용되지 않고 전달될 수도 있다. FPA를 사용하여 eUICC로 메시지가 전달되는 일 예로서, BPP 설치를 위한 메시지는 ES10x의 하나 이상의 메시지에 포함되어 전송할 수 있다. 또한, 단말에서 BPP 설치를 위한 메시지의 전송 방법은 다음 중의 하나의 방법일 수 있다. 물론, 하기의 방법에 제한되지 않는다. 1. 기존 SGP.22의 서버와 eUICC간 인증 절차, Profile 설치를 위한 사전 정보 공유 절차, 및 BPP 설치 절차의 3 단계를 재활용하여 처리하는 방법 2. 전술한 SGP.22의 3 단계의 절차에서, 서버를 인증하고 Profile 설치를 위한 사전 정보 공유를 제공하는 절 차, BPP 설치 절차를 재활용하는 2 단계로 처리하는 방법 3. 1 단계로 이루어진 신규 Function을 정의하여 BPP 및 BBP와 관련된 Key 정보를 단말에서 일괄적으로 eUICC에 전달하는 방법 이하 도 4 내지 도 6에서 BPP 설치 절차 및 해당 설치 절차에서 FPA Service 활성화 및 비활성화를 처리하는 방 법에 대해서 상세하게 기술한다. 이하 도 4 내지 도 6에서는 단말에서 전송 방법에서 위 기술한 방법 중에 2번 방법을 예로 들어 설명한다. 한편, 도 3의 동작을 수행하지 않더라도 프로파일 서버가 BPP와 암호화 키를 생성 하여 준비해 둔 경우에, 도 4 내지 도 6과 같이 이후 프로파일 설치 절차를 처리할 수도 있다. 도 4는 본 개시의 일 실시 예에 따른 프로파일 설치 성공 시 FPA 서비스를 비 활성화 처리하는 동작을 설명하기 위한 도면이다. FPA는 ESfac인터페이스 (SGP.41에 정의된 Device Manufacturer - FPA interface)를 통해서 프로파일 설 치를 위한 동작을 위한 요청을 인지하여 IFPP 모드로 진입(4030 단계)할 수 있다. 해당 요청에는 프로파일 설치 를 위한 세션 키 생성 정보 또는/그리고 BPP가 포함될 수 있다. 세션 키 생성 정보는 eUICC의 otPK.EUICC.KA 또 는 해당 otPK.EUICC.KA를 특정할 수 있는 정보, 상기 데이터를 SM-DPf 개인키로 서명한 서명값, SM-DPf의 인증 서 및 인증서 체인 정보 중 적어도 일부를 포함할 수 있다. - FPA는 저장된 FPA 서비스 상태 정보가 있으며 비활성화 상태인지를 판단(4040 단계)할 수 있다. FPA 서 비스 상태 정보는 eUICC의 ISD-R에서 FPA 서비스 제공이 활성화 상태인지 또는 비활성화 상태인지를 판단할 수 있는 정보일 수 있다. FPA는 FPA 서비스 상태 정보를 eUICC에 Select ISD-R APDU를 전송하여 수신 되는 회신 값으로부터 획득하여 확인할 수도 있다. 이는 일 예로 IsdrProprietaryTemplete에 포함된 FPA 서비스 활성화/비활성화 상태 식별자 또는/그리고 사용 조건, 잔여 one-time key 쌍 중 적어도 하나일 수 있다. FPA는 FPA 서비스 상태 정보를 eUICC에 eUICC Info를 요청(일 예로 GeteUICCInfo)하여 수신되는 정보로써 획득할 수도 있다. 이는 본 발명의 다른 도면에서도 동일하게 적용될 수 있다. FPA는 FPA 서비스의 상태가 비활성화 상태인 경우, Device Mf에 에러를 리턴하고 절차를 종료(4050 단계)할 수 있다. FPA는 FPA 서비스의 상태가 비활성화 상태인 경우를, IsdrProprietaryTemplete 또는eUICC Info에 회신되는 정보에서 FPA 서비스 활성화가 꺼져 있거나 (일 예로, fpaServicesEnabled로 설정된 bit가 꺼져 있거나 fpaServicesDisabled로 설정) 또는 잔여 one time key 쌍 (즉, otPK/otSK.EUICC.KA)의 개수 가 0개인 경우 중 하나로 판단할 수 있다. 이를 수신한 Device Mf은 FPA 상태 비활성화 절차임을 인지하고 절차를 종료하거나 또는 도 8에서 후술하 는 바와 같이 FPA 상태를 명시적으로 활성화하기 위한 동작을 수행할 수도 있다. 비 활성화 상태인 경우에 예를 들어, 잔여 one time key 쌍 (즉, otPK/otSK.EUICC.KA)의 개수가 0개인 경우는 영구적인 비활성화로 인지하여 절차를 종료할 수도 있다. FPA는 BPP를 전송하기에 앞서, 프로파일 서버 인증을 위한 정보를 포함하여 eUICC에 전송(4060 단 계)할 수 있으며, 일 예로 ES10f.prepareLoading와 같은 ES10f 함수에 프로파일 서버 인증을 위한 정보를 포함 하여 전송할 수 있다. 프로파일 서버 인증을 위한 정보로는, 앞서 Device Mf로부터 수신된 SM-DPf 서버의 인증 서 및 인증서 체인을 포함할 수 있다. 프로파일 서버 인증을 위한 인증서로 SM-DPf가 프로파일 바인딩을 위해 사용한 인증서가 사용될 수도 있다. 이를 수신한 eUICC는 먼저 ISD-R의 FPA 서비스 상태를 판단(4070 단계)할 수 있다. 만약 ISD-R의 FPA 서 비스가 비활성화 상태인 경우, eUICC는 에러 메시지를 회신(4080 단계)하고 절차를 종료할 수 있다. 에러 메시지는 FPA 서비스가 비활성화 상태임을 나타내는 메시지일 수 있고 eUICC가 서명하지 않은 메시지로 회신될 수 있다. 이를 수신한 FPA는 Device Mf에 에러 메시지를 회신(4090 단계)하여 절차를 종료 할 수 있다. 이를 수신한 Device Mf은 FPA 상태 비활성화 절차임을 인지하고 절차를 종료하거나 또는 도 8에서 후술하는 바와 같이 동작할 수도 있다. eUICC가 ISD-R의 FPA 서비스가 비활성화 상태가 아니라고 판단하는 경우, 일 예로 FPA 서비스가 활성화 상태이거나 또는 FPA 서비스의 활성화 여부에 대한 정보를 판단할 수 없는 경우, eUICC는 ES10f.prepareLoading 요청에 따른 동작을 수행할 수 있다. ES10f로 수신되는 정보는 세션 관리를 위한 ID로 transaction ID가 포함된 데이터, SM-DPf의 개인키로 상기 데이터를 서명한 서명 값, SM-DPf의 공개키를 포함하 는 프로파일 서버 인증서 및 인증서 체인 중 하나를 포함할 수 있다. eUICC의 ES10f.prepareLoading 요청에 따른 동작은 SM-DPf의 인증서를 검증하는 동작, SM-DPf의 공개키 를 기반으로 SM-DPf의 서명 값을 검증하여 서명된 데이터의 무결성을 확인하는 동작, 데이터에 포함된 eUICC의 otPK를 확인 또는 eUICC의 otPK 또는 otPK를 특정할 수 있는 정보를 참조하여 이에 맵핑되는 eUICC의 otSK를 확 인하는 동작, 또는 수신된 transaction ID를 세션 ID로 하여 데이터들을 이 세션 ID에 연결(attach)하는 동작 중 적어도 하나를 포함할 수 있다. eUICC는 프로파일의 설치가 완료될 때까지 FPA 서비스의 상태를 활성화 상태로 유지할 수 있다. 따 라서, ES10f.prepareLoading 요청에 따른 동작을 수행하면서 에러 또는 성공과 무관하게, FPA 서비스의 상태를 활성화 상태로 유지할 수도 있다. FPA는 eUICC의 ES10f.prepareLoading에 대한 회신 값으로 성공 응답을 수신한 경우, BPP를 전송 할 수 있다. 일 예로, ES10f.LoadBoundProfilePackage 함수에 실어 BPP가 전송될 수 있다. eUICC는 BPP를 수신하여, 프로파일 설치를 수행하는 동작을 수행(4140 단계)할 수 있다. 이 동작은 보안 채널 생성을 위한 세션 키를 생성하고, 수신된 메타데이터를 저장하고, 프로파일을 복호화하는 것을 포함할 수 있다. 또한, 이때, eUICC transaction ID에 연결(attach)해 둔, 앞서 수신된 SM-DPf의 인증서를 사용하 여 수신된 SM-DPf 서명값을 검증할 수 있다. eUICC은 프로파일 설치 결과를 FPA에 회신(4160 단계)하여 줄 수 있다. 이때 eUICC는 변경 한(또는 변경할) FPA 서비스 상태를 추가하여 FPA에 회신할 수도 있다(4160 단계). 예를 들어 프로파일 설치 결과가 성공인 경우, eUICC는 FPA 서비스 상태를 비활성화로 회신할 수 있다. 프로파일 설치 결과가 실패인 경우, eUICC는 FPA 서비스 상태를 활성화로 변경 없이 회신할 수도 있다. eUICC는 프로파일 설치 결과가 성공인 경우, FPA로 프로파일 설치 결과 및 FPA 서비스 상태를 전송하는 4160 단계를 수행한 후 상기 업데이트된 FPA 서비스 상태로 저장할 수 있다. 또는, eUICC는 프로파일 설치를 완료(4140 단 계)하고 4160 단계를 수행하기 전에 상기 업데이트된 FPA 서비스 상태로 저장(4150 단계)할 수도 있다. FPA가 FPA 서비스 상태를 저장 및 관리하고 있는 경우, 프로파일 설치 결과를 성공으로 수신하거나 또는 FPA 서비스 상태로 비활성화를 수신하는 경우(4160 단계)에, FPA 서비스 상태를 비활성화로 업데이트해 둘 수있다. FPA는 수신한 프로파일 설치 결과(4160 단계)를 Device Mf에 전송(4170 단계)할 수 있다. 도 5는 본 개시의 일 실시 예에 따른 미리 설정한 프로파일 설치 개수 도달 시, FPA 서비스를 비활성화로 처리 하는 동작을 설명하기 위한 도면이다. eUICC에 프로파일 설치 허용 개수에 대한 설정 값을 저장하는 단계가 수행될 수 있다(5025 단계). 예를 들어, eUICC의 제조 시에 프로파일 설치 허용 개수가 미리 설정될 수 있다. 이는 eSIM칩 제조사에게 eUICC들을 주문 시에 프로파일 설치 허용 개수를 설정하여 납품하도록 요청함으로써, eSIM칩 제조사가 eUICC에 이 정보를 미리 설정하여 납품하는 방법일 수 있다. 예를 들어, 단말은 eUICC에 프로파일 설치 허용 개수를 명시적으로 요청하는 메시지를 전송하도록 미리 설정될 수 있고, 단말로부터 수신한 메시지에 기반하여 eUICC의 프로파일 설치 허용 개수가 설정될 수 있다. 단말 제조사가 eUICC에 프로파일 설 치 허용 개수를 명시적으로 요청하는 메시지를 전송하여 이를 수신한 eUICC가 수신된 정보로 설정하여 둘 수도 있다. 명시적인 메시지를 전송하도록 설정되는 경우, 단말은 지정된 암호화 키로 서명한 데이터로 프로파 일 설치 허용 개수를 명시적으로 요청하는 메시지를 전송할 수도 있다. 프로파일 설치 허용 개수를 명시적으로 요청하는 메시지가 단말 제조사의 암호화 키로 서명한 데이터로 전송되 는 경우, 단말 제조사는 수신한 서명 값을 검증하기 위한 암호화 대칭키 또는 공개키를 EUM에게 전달할 수 있다. 암호화 대칭키 또는 공개키를 수신한 EUM이 eUICC들에 상기 복호화를 위한 키를 주입해 둘 수 있다. FPA는 ESfac 인터페이스를 통해서 프로파일 설치를 위한 동작을 위한 요청을 인지하여 IFPP 모드로 진입 (5030 단계)할 수 있다. 해당 요청에는 프로파일 설치를 위한 세션 키 생성 정보 또는/그리고 BPP가 포함되어 수신될 수 있다. 세션 키 생성 정보는 eUICC의 otPK.EUICC.KA 또는 eUICC otPK를 특정할 수 있는 정보, 해당 데이터를 SM-DPf 개인키로 서명한 서명값, SM-DPf의 인증서 및 인증서 체인 정보 중 적어도 일부를 포함할 수 있다. FPA는 FPA 서비스 상태 정보를 저장하고 있을 수 있으며 FPA 서비스 상태가 비활성화 상태인지를 판단 (5040 단계)할 수 있다. FPA 서비스 상태 정보는 eUICC의 ISD-R에서 FPA 서비스 제공이 활성화 상태인지 또는 비활성화 상태인지에 대한 정보일 수 있다. FPA는 FPA 서비스 상태 정보를 eUICC에 Select ISD-R APDU를 전송하여 수신되는 회신 값으로부터 획득하여 확인할 수도 있다. 이는 일 예로 IsdrProprietaryTemplete 에 포함된 FPA 서비스 활성화/비활성화 상태 식별자 또는/그리고 사용 조건 정보, 잔여 one-time key 쌍 중 적 어도 하나일 수 있다. FPA는 FPA 서비스 상태 정보를 eUICC에 eUICC Info를 요청(일 예로 GeteUICCInfo)하고 수신함으로써 획득할 수도 있다. FPA는 FPA 서비스의 상태가 비활성화 상태인 경우, Device Mf에 에러를 리턴하고 절차를 종료(5050 단계)할 수 있다. 이를 수신한 Device Mf은 FPA 상태 비활성화 절차임을 인지하고 절차를 종료하거나 또 는 도 8에서 후술하는 바와 같이 동작할 수도 있다. FPA는 BPP를 전송하기에 앞서, 프로파일 서버 인증을 위한 정보를 포함하여 eUICC에 전송(5060 단 계)할 수 있으며, 이는 일 예로 ES10f.prepareLoading와 같은 ES10f 함수일 수 있다. 프로파일 서버 인증을 위 한 정보로는, 앞서 Device Mf로부터 수신된 SM-DPf 서버의 인증서 및 인증서 체인을 포함할 수 있다. 프로파일 서버 인증을 위한 인증서로 SM-DPf가 프로파일 바인딩을 위해 사용한 인증서가 사용될 수도 있다. 이를 수신한 eUICC는 먼저 ISD-R의 FPA 서비스 상태를 판단(5070 단계)할 수 있다. 만약 ISD-R의 FPA 서 비스가 비활성화 상태인 경우, eUICC는 에러 메시지를 회신(5080 단계)하고 절차를 종료할 수 있다. 에러 메시지는 FPA 서비스가 비활성화 상태임을 나타내는 메시지일 수 있고 eUICC가 서명하지 않은 메시지로 회신될 수 있다. 이를 수신한 FPA는 Device Mf에 에러 메시지를 회신(5090 단계)하여 절차를 종료 할 수 있다. 이를 수신한 Device Mf은 FPA 상태 비활성화 절차임을 인지하고 절차를 종료하거나 또는 도 8에서 후술하는 바와 같이 동작할 수도 있다. eUICC가 ISD-R의 FPA 서비스가 비활성화 상태가 아니라고 판단하는 경우, 일 예로 FPA 서비스가 활성화 상태이거나 또는 FPA 서비스의 활성화 여부에 대한 정보를 판단할 수 없는 경우, eUICC는 ES10f.prepareLoading 요청에 따른 동작을 수행할 수 있다. ES10f로 수신되는 정보는 세션 관리를 위한 ID로transaction ID가 포함된 데이터, SM-DPf의 개인키로 상기 데이터를 서명한 서명 값, SM-DPf의 공개키를 포함하 는 프로파일 서버 인증서 및 인증서 체인 중 하나를 포함할 수 있다. eUICC의 ES10f.prepareLoading 요청에 따른 동작은 SM-DPf의 인증서를 검증하는 동작, SM-DPf의 공개키 를 기반으로 SM-DPf의 서명 값을 검증하여 서명된 데이터의 무결성을 확인하는 동작, 데이터에 포함된 eUICC의 otPK를 확인하는 동작, eUICC의 otPK 또는 otPK.EUICC.KA를 특정할 수 있는 정보를 참조하여 이에 맵핑되는 eUICC의 otSK를 확인하는 동작, 수신된 transaction ID를 세션 ID로 하여 데이터들을 이 세션 ID에 연결 (attach)하는 동작 중 적어도 하나를 포함할 수 있다. eUICC는 프로파일의 설치가 완료될 때까지 FPA 서비스의 상태를 활성화 상태로 유지할 수 있다. 따 라서, ES10f.prepareLoading 요청에 따른 동작을 수행하면서 에러 또는 성공과 무관하게, FPA 서비스의 상태를 활성화 상태로 유지할 수도 있다. FPA는 eUICC의 ES10f.prepareLoading에 대한 회신 값으로 성공 응답을 수신한 경우, BPP를 전송 할 수 있다. 일 예로, ES10f.LoadBoundProfilePackage 함수에 실어 BPP가 전송될 수 있다. eUICC는 BPP를 수신하여, 프로파일 설치를 수행하는 동작을 수행(5140 단계)할 수 있다. 이 동작은 보안 채널 생성을 위한 세션 키를 생성하고, 수신된 메타데이터를 저장하고, 프로파일을 복호화하는 것을 포함할 수 있다. 또한, 이때, eUICC transaction ID에 연결(attach)해 둔, 앞서 수신된 SM-DPf의 인증서를 사용하 여 수신된 SM-DPf 서명값을 검증할 수 있다. eUICC은 IFPP 프로파일 설치 성공 후, 프로파일 설치 허용 개수를 추가적으로 확인할 수 있다. 만약 프로 파일 설치 성공 후, 설치된 프로파일의 개수가 프로파일 설치 허용 개수에 도달하는 경우, eUICC는 FPA 서비스 상태를 비활성화 상태로 변경하여 저장할 수 있다 (5150 단계). 예를 들어 프로파일을 성공적으로 설치 하는 경우, eUICC는 FPA 서비스를 통한 설치 허용 개수(횟수) 중 1회를 사용한 것으로 간주할 수 있다. eUICC은 IFPP 프로파일 설치 개수가 IFPP 프로파일 설치 허용 개수보다 작은 경우, FPA 서비스 상태를 활 성화 상태 (FPA Service = activated)로 유지할 수 있다. 만약 IFPP 프로파일 설치 개수가 IFPP 프로파일 설치 허용 개수에 도달하는 경우, eUICC은 FPA 서비스 상태를 비활성화 상태 (FPA Service = deactivated)로 변경하여 저장할 수 있다. eUICC은 프로파일 설치 결과를 FPA에 회신(5150 단계)할 수 있다. 이때 eUICC는 변경한(또 는 변경할) FPA 서비스 상태를 추가하여 FPA에 회신할 수도 있다(5160 단계). 한편, eUICC는 5160 단계를 수행하고 난 후, 상기 업데이트된 FPA 서비스 상태를 저장할 수도 있다. FPA가 FPA 서비스 상태를 저장 및 관리하고 있는 경우, 프로파일 설치 결과를 성공으로 수신하는 경우, 또는 FPA 서비스 상태로 비활성화를 수신하는 경우(5160 단계)에, FPA 서비스 상태를 비활성화로 업데이트해 둘 수 있다. FPA는 수신한 프로파일 설치 결과(5160 단계)를 Device Mf에 전송(5170 단계)할 수 있다. 도 6은 본 개시의 일 실시 예에 따른 FPA 서비스를 비활성화하는 방법으로 FPA 서비스 비활성화 지시자를 도입 하여 처리하는 도면이다. FPA는 ESfac 인터페이스를 통해서 프로파일 설치를 위한 동작을 위한 요청을 인지하여 IFPP 모드로 진입 (6030 단계)할 수 있다. 해당 요청에는 프로파일 설치를 위한 세션 키 생성 정보 또는/그리고 BPP가 포함될 수 있다. 세션 키 생성 정보는 eUICC의 otPK.EUICC.KA 또는 otPK.EUICC.KA를 특정할 수 있는 정보, 해당 데이터를 SM-DPf 개인키로 서명한 서명값, SM-DPf의 인증서 및 인증서 체인 정보 중 적어도 일부를 포함할 수 있다. 또한, 프로파일 설치를 위한 동작 요청 정보에 FPA 서비스 비활성화 지시자(이하 설명을 위해 deactivateFlag로 표기)가 더 포함되어 수신될 수 있다. deactivateFlag는 Device Mf에 의해 프로파일 설치 동작 요청 정보 에 추가되어, ESfac로 전송될 수 있다. FPA는 FPA 서비스 상태 정보를 저장하고 있을 수 있으며 FPA 서비스 상태가 비활성화 상태인지를 판단 (6040 단계)할 수 있다. FPA 서비스 상태 정보는 eUICC의 ISD-R에서 FPA 서비스 제공이 활성화 상태인지 또는 비활성화 상태인지를 판단할 수 있는 정보일 수 있다. FPA는 FPA 서비스 상태 정보를 eUICC에 Select ISD-R APDU를 전송하여 수신되는 회신 값으로부터 획득하여 확인할 수도 있다. 이는 일 예로 IsdrProprietaryTemplete에 포함된 FPA 서비스 활성화/비활성화 상태 식별자 또는/그리고 사용 조건, 잔여 one-time key 쌍 중 적어도 하나일 수 있다. FPA는 FPA 서비스 상태 정보를 eUICC에 eUICC Info를 요청(일 예로 GeteUICCInfo)하여 수신되는 정보로써 획득할 수도 있다. FPA는 FPA 서비스의 상태가 비활성화 상태인 경우, Device Mf에 에러를 리턴하고 절차를 종료(6050 단계)할 수 있다. FPA는 FPA 서비스의 상태가 비활성화 상태인 경우를, IsdrProprietaryTemplete 또는 eUICC Info에 회신되는 정보에서 FPA 서비스 활성화가 꺼져 있거나 (일 예로, fpaServicesEnabled로 설정된 bit가 꺼져 있거나 fpaServicesDisabled로 설정) 또는 잔여 one time key 쌍 (즉, otPK/otSK.EUICC.KA)의 개수 가 0개인 경우 중 하나로 판단할 수 있다. 이를 수신한 Device Mf은 FPA 상태 비활성화 절차임을 인지하고 절차를 종료하거나 또는 도 8에서 후술하 는 바와 같이 FPA 상태를 명시적으로 활성화하기 위한 동작을 수행할 수도 있다. 비 활성화 상태인 경우에 예를 들어, 잔여 one time key 쌍 (즉, otPK/otSK.EUICC.KA)의 개수가 0개인 경우는 영구적인 비활성화로 인지하여 절차를 종료할 수도 있다. FPA은 프로파일 설치를 위한 함수 중 하나에, 명시적인 비활성화 지시자로 예를 들어 deactivateFlag, 단 말 제조사 인증 Key 중 적어도 하나를 포함하여 전송할 수 있다. 일 예로, 프로파일 설치를 위한 함수는 ES10f.prepareLoading 또는 ES10f.loadBoundProiflePackage 중의 하나일 수 있다. FPA는 BPP를 전송하기에 앞서, 프로파일 서버 인증을 위한 정보를 포함하여 eUICC에 전송(6060 단 계)할 수 있으며, 일 예로 ES10f.prepareLoading와 같은 ES10f 함수에 프로파일 서버 인증을 위한 정보를 포함 하여 전송할 수 있다. 프로파일 서버 인증을 위한 정보로는, 앞서 Device Mf로부터 수신된 SM-DPf 서버의 인증 서 및 인증서 체인을 포함할 수 있다. 프로파일 서버 인증을 위한 인증서로 SM-DPf가 프로파일 바인딩을 위해 사용한 인증서가 사용될 수도 있다. 이를 수신한 eUICC는 먼저 ISD-R의 FPA 서비스 상태를 판단(6070 단계)할 수 있다. 만약 ISD-R의 FPA 서 비스가 비활성화 상태인 경우, eUICC는 에러 메시지를 회신(6080 단계)하고 절차를 종료할 수 있다. 에러 메시지는 FPA 서비스가 비활성화 상태임을 나타내는 메시지일 수 있고 eUICC가 서명하지 않은 메시지로 회신될 수 있다. 이를 수신한 FPA는 Device Mf에 에러 메시지를 회신(6090 단계)하여 절차를 종료 할 수 있다. 이를 수신한 Device Mf은 FPA 상태 비활성화 절차임을 인지하고 절차를 종료하거나 또는 도 8에서 후술하는 바와 같이 동작할 수도 있다. eUICC가 ISD-R의 FPA 서비스가 비활성화 상태가 아니라고 판단하는 경우, 일 예로 FPA 서비스가 활성화 상태이거나 또는 FPA 서비스의 활성화 여부에 대한 정보를 판단할 수 없는 경우, eUICC는 ES10f.prepareLoading 요청에 따른 동작을 수행할 수 있다. ES10f로 수신되는 정보는 세션 관리를 위한 ID로 transaction ID가 포함된 데이터, SM-DPf의 개인키로 상기 데이터를 서명한 서명 값, SM-DPf의 공개키를 포함하 는 프로파일 서버 인증서 및 인증서 체인, deactivateFlag 중 하나를 포함할 수 있다. eUICC의 ES10f.prepareLoading 요청에 따른 동작은 SM-DPf의 인증서를 검증하는 동작, SM-DPf의 공개키 를 기반으로 SM-DPf의 서명 값을 검증하여 서명된 데이터의 무결성을 확인하는 동작, 데이터에 포함된 eUICC의 otPK를 확인, eUICC의 otPK 또는 otPK를 특정할 수 있는 정보를 참조하여 이에 맵핑되는 eUICC의 otSK를 확인하 는 동작, 또는 수신된 transaction ID를 세션 ID로 하여 데이터들을 이 세션 ID에 연결(attach)하는 동작 중 적 어도 하나를 포함할 수 있다. 만약, ES10f.prepareLoading에 deactivateFlag가 포함되어 수신되는 경우, eUICC는 deactivateFlag를 해당 세션 ID에 연결하여 해당 세션에서 사용하도록 할 수 있다. eUICC는 프로파일의 설치가 완료될 때까지 FPA 서비스의 상태를 활성화 상태로 유지할 수 있다. 따 라서, ES10f.prepareLoading 요청에 따른 동작을 수행하면서 에러 또는 성공과 무관하게, FPA 서비스의 상태는 활성화 상태로 유지할 수도 있다. FPA는 eUICC의 ES10f.prepareLoading에 대한 회신 값으로 성공 응답을 수신한 경우, BPP를 전송 할 수 있다. 일 예로, ES10f.LoadBoundProfilePackage 함수에 실어 BPP가 전송될 수 있다. FPA는 ES10f.LoadBoundProfilePackage에 명시적인 비활성화 지시자로 예를 들어 deactivateFlag, 단말 제조사 인증 Key 중 적어도 하나를 포함하여 전송할 수도 있다. eUICC는 BPP를 수신하여, 프로파일 설치를 수행하는 동작을 수행(6140 단계)할 수 있다. 이 동작은 보안 채널 생성을 위한 세션 키를 생성하고, 수신된 메타데이터를 저장하고, 프로파일을 복호화하는 것을 포함할 수있다. 또한, 이 때, eUICC transaction ID에 연결(attach)해 둔 앞서 수신된 SM-DPf의 인증서를 사용하 여 수신된 SM-DPf 서명값을 검증할 수 있다. eUICC은 IFPP 프로파일 설치 성공 후, FPA 서비스 상태를 비활성화 상태로 변경해야 할지를 추가적으로 판단할 수 있다. 이는 ES10f.LoadBoundProfilePackage에 포함된 deactivateFlag가 있거나 또는 ES10f.LoadBoundProfilePackage의 동일 transaction ID에 연결(attach)해 둔 deactivateFlag가 있는지의 여부 로 판단할 수 있다. GSMA SGP.22를 참조하면, 동일 세션에 대해서는 transaction ID가 동일하다. eUICC는 ES10f.LoadBoundProfilePackage에 포함되어 수신된 transaction ID가 앞서 수신한 ES10f.prepareLoading에 포 함된 transaction ID와 동일한지 여부로 같은 세션에서 사용하는 데이터인지 여부를 판단할 수 있다. 이는 본 발명의 다른 실시 예에서도 동일하게 적용될 수 있다. 만약 deactivateFlag가 있는 경우, eUICC는 프로파일 설치 성공 후 FPA 서비스 상태를 비활성화 상태로 변경하여 저장할 수 있다 (6150 단계). 만약 앞서 명령에 FPA가 인증 Key를 포함하여 전송한 경우, eUICC는 프로파일 설치 성공 후 FPA 서 비스 상태를 비활성화 상태로 변경하기에 앞서 해당 단말 제조사 인증 Key를 저장된 FPA 서비스 동작을 위한 인 증 Key와 비교 검증하여, 동일한 경우에 한해 비활성화 상태로 변경하여 저장할 수 있다 (6150 단계). 만약 검 증 결과 값이 다른 경우에 eUICC은 FPA 서비스 상태를 활성화 상태로 유지하여 둘 수도 있다. eUICC은 프로파일 설치 결과를 FPA에 회신(6150 단계)할 수 있다. 이때 eUICC는 변경한(또 는 변경할) FPA 서비스 상태를 추가하여 FPA에 회신할 수도 있다(6160 단계). 한편, eUICC는 6160 단계를 수행하고 난 후, 상기 업데이트된 FPA 서비스 상태를 저장할 수도 있다. FPA가 FPA 서비스 상태를 저장 및 관리하고 있는 경우, 프로파일 설치 결과를 성공으로 수신하는 경우 또 는 FPA 서비스 상태로 비활성화를 수신하는 경우(6160 단계)에, FPA 서비스 상태를 비활성화로 업데이트해 둘 수 있다. FPA는 수신한 프로파일 설치 결과(6160 단계)를 Device Mf에 전송(6170 단계)할 수 있다. FPA는 FPA 서비스 상태도 함께 포함하여 Device Mf에 함께 전송하여 줄 수도 있다. 한편, 이 도면에서는 비활성화 flag를 중심으로 설명하였으나, 프로파일 설치를 위한 함수, 예를 들어 ES10f.PrepareLoading 또는 ES10f.LoadBoundProfilePackage 명령에 활성화 지시자 (예를 들어 활성화 flag), 해당 동작 수행을 위한 인증 key 중 적어도 하나의 정보가 포함되어 전송되는 것도 가능할 수 있다. 이 경우에, eUICC은 먼저 FPA 서비스를 활성화 처리하고 이후 동작을 수행할 수 있다. 즉 앞서 언급한 ES10f.PrepareLoading 또는 ES10f.LoadBoundProfilePackage에서의 요구되는 동작을 수행할 수 있다. 만약 동작 수행을 위한 인증 키(여기서는 FPA 서비스 활성화 키)가 포함되어 수신된 경우, eUICC는 해당 수신된 인증 키와 저장한 활성화 동작 허용을 위한 인증키를 비교 검증하여 동일한 값인지를 더 판단하고, 동일한 경우 에 한해 FPA 서비스 활성화를 허용할 수 있다. 만약 검증에 실패하는 경우, eUICC는 에러를 리턴하고, 이후 절 차를 종료할 수 있다. 도 7은 본 개시의 일 실시 예에 따른 메모리 리셋 명령 처리에 대한 결과로 FPA서비스 활성화를 처리하는 동작 을 설명하기 위한 도면이다. FPA은 IFPP 모드에서의 eUICC 메모리 리셋 처리를 요청하기 위해 ES10f.euiccMemoryReset 함수를 호출 (7050 단계)할 수 있다. Device Mf가 ESfac를 통해서 eUICCMemoryReset 요청을 전송하면, 이를 수신한 단말에서 FPA로 이를 트리거(trigger) 할 수도 있다. 현재 SGP.22 또는 메모리 리셋을 수행하는 경우 단말의 LPA(미 도시)에서 사용자의 동의 (User Intent)를 획득 하도록 규정하고 있으나, 단말에서 ESfac을 통해서 eUICC 메모리 리셋 처리 요청을 수신한 경우, 단말 또는 단 말의 FPA는 eUICC 메모리 리셋 처리 요청을 수신함을 인지하면 사용자의 동의를 요구하지 않는 것으로 인 지하고 ES10f를 사용하여 eUICC Memory Reset을 요청하는 명령을 생성하여(7040 단계) 해당 메시지를 eUICC에게 전송(7050 단계)할 수 있다. eUICC Memory Reset을 요청하는 명령은 일 예로, ES10f.euiccMemoryReset과 같은 명령일 수 있다. ES10f.euiccMemoryReset의 일 예는 다음 표 2과 같은 명령 및 응답에 대한 메시지 구조를 가질 수도 있다. 표 2 EuiccMemoryResetRequest ::= SEQUENCE { resetOptions BIT STRING { deleteOperationalProfiles, deleteFieldLoadedTestProfiles, resetDefaultSmdpAddress, deletePreLoadedTestProfiles, deleteProvisioningProfiles, deleteIfppProfiles, resetDefaultFpaServiceValue} -- setting bits 0, 1, 3 and 4 wipes all Profiles } EuiccMemoryResetResponse ::= SEQUENCE { resetResult INTEGER {ok, nothingToDelete, catBusy, undefinedError} FPA를 통해서 설치되는 프로파일의 종류는 Provisioning Profile 이거나 Operational Profile일 수 있다. 또는, FPA 서비스를 통해서만 프로파일의 설치가 가능하도록 하는 정보가 프로파일의 메타데이터에 추가될 수 있다. 일 예로 공장 설치용 프로파일 식별자 (본 개시에서는 IFPP 프로파일로 설명될 수 있음) 또는 Ifpp configuration이 메타데이터에 포함된 것으로 eUICC가 판단할 수도 있다. IFPP Profile은 Provisioning Profile 이거나 Operational Profile일 수 있다. eUICC는 ES10f.euiccMemoryReset를 수신(7050 단계)하여 공장에서 설치된 프로파일을 삭제할 수 있다. 해당 설치된 프로파일을 삭제하는 방법은 예를 들어, FPA가 Provisioning Profile을 삭제 또는/그리고 Operational Profile을 삭제하는 bit를 찍어 전송하거나 또는 IFPP Profile만을 삭제하도록 IFPP Profile 삭제 bit를 찍어 전송하는 방법일 수 있다. FPA가 Provisioning Profile을 삭제 또는/그리고 Operational Profile을 삭제하는 bit를 찍어 eUICC에게 전송하는 경우, eUICC은 프로파일이 공장에서 설치되었는지 여부를 떠나서 해당 종류가 메타데이터에 마킹된 프로파일들을 삭제할 수도 있다. eUICC는 ES10f.euiccMemoryReset를 수신(7050 단계)하여 공장에서 설치된 프로파일을 삭제한 후, FPA 서 비스 상태를 initial value인 활성화 상태로 저장하여 둘 수도 있다. FPA 서비스 상태를 initial value로 변경 하는 것은, 명시적인 bit로 요청이 수신되어 수행되거나 (예를 들어, resetDefaultFpaServiceValue) 또는 IFPP 프로파일을 삭제하는 경우에 eUICC의 기본 동작으로 수행될 수도 있다. eUICC은 처리한 결과를 FPA에게 회신(7070 단계)하여 eUICC Memory Reset에 대한 동작을 완료할 수 있다. 만약, IFPP 프로파일들 중에 활성화 상태의 프로파일을 삭제하는 경우, eUICC은 SGP.22에 정의 된 바와 같이 단말의 모뎀에 리셋을 요청하여 모뎀이 eUICC에 리셋 처리하도록 동작할 수 있 다 (7080 단계). FPA에서 7070 단계를 통해 EuiccMemoryResetResponse를 수신하면, FPA은 성공 응 답을 수신 시, FPA 서비스 상태를 관리하고 있고, FPA의 상태가 비활성화 상태인 경우, FPA의 상태를 활성화 상 태로 변경(7090 단계)하여 둘 수 있다. 또한, FPA은 7070 단계에서 수신 받은 처리 결과를 Device Mf에 회신하고 절차를 종료할 수 있다. 도 8은 본 개시의 일 실시 예에 따른 명시적인 활성화/비활성화 명령에 대하여 전송하여 단말에서 FPA 서비스 변경을 처리하는 동작을 설명하기 위한 도면이다. 도 8에서는 설명의 일관성을 위해 활성화 명령을 중심으로 작 성하였으나, 비활성화 명령에도 유사하게 적용될 수 있다. FPA은 FPA Service 상태 변경을 요청 함수를 eUICC에 전송(8050 단계)할 수 있다. 해당 함수에 포 함되는 메시지는 Device Mf로부터 수신된 FPA Service 상태 변경 메시지를 포함할 수 있다. 8050 단계는 Device Mf로부터 ESfac를 통해 단말로 수신된 명시적인 FPA 상태 변경에 대한 요청(8040 단 계)으로 trigger 될 수 있다. 8040 단계에서 deactivation 명령을 전송하는 경우는, PrepareLoading 또는 LoadBpp를 처리한 이후 FPA Service 상태가 activation로 회신되어 전송된 경우일 수 있다. 8040 단계에서 activation 명령을 전송하는 경우는, PrepareLoading로부터 회신된 메시지로 FPA Service 상태가 deactivated로 회신되어 전송된 경우일 수 있다. 전송되는 메시지의 일 예는 Device Mf Id, FPA 상태 요청(예를 들어 activation, deactivation, 잔여 otPK 삭제 요청), FPA 상태 요청 처리를 위한 단말 제조사 인증 키, 중 적어 도 하나를 포함하는 메시지 구성일 수 있으며, 단말 제조사의 암호화 키로 해당 데이터를 서명한 값인 signature를 포함할 수도 있다. 8040 단계에서 전송되는 메세지는, operation auth info 및/또는 operation에 대한 요청을 포함할 수 있고, signature를 포함할 수도 있다. operation auth info는 단말 제조사를 확인할 수 있는 정보를 의미할 수 있고, 예를 들어, Device Mf Id 및/또는 FPA 상태 요청 처리를 위한 단말 제조사 인증 키를 포함할 수 있다. operation에 대한 요청은 FPA 상태에 대한 요청을 의미할 수 있고, 예를 들어 activation, deactivation, 잔여 otPK 삭제 요청을 포함할 수 있다. 한편, 단말 제조사 인증 키는 단말 제조사 또는 (단말 제조사 요청에 의해) eUICC가 생성할 수 있고, eUICC 제 조사가 해당 인증 키가 주입된 eUICC들을 단말 제조사에 전달할 수 있다. 인증 키의 일 예는 PIN CODE일 수 있 다. 해당 전송되는 메시지의 일 예는 다음 표 3과 같은 명령 메시지 구조를 포함할 수 있다. 표 3 -- ASN1START ManageFpaServiceRequest ::= SEQUENCE { fpaServiceKeyString UTF8String (SIZE(0..255)) OPTIONAL, fpaOperationOptions ::= INTEGER { fpaServiceOn , fpaServiceOff , removeOtKeyPairs } } -- ASN1STOP Device Mf은 FPA Service operation (일 예로 활성화) 명령을 생성(8030 단계)할 수 있다. Device Mf가 전송되는 메시지를 단말 제조사의 키로 서명하여, 8040 단계에서 전송할 수도 있다. 이 경우에 Device Mf는 HSM(Hardware Security Module)을 구비할 수 있으며, 8030 단계에서 HSM을 통해 명령을 생 성하여 사용할 수 있다. HSM은 하드웨어 모듈로써, 암호화 키를 생성하고 저장하는 역할을 하는 전용 장치를 의 미할 수 있다. 한편, eUICC은 Device Mf 설정 정보를 선 탑재하여 Device Mf에 납품될 수도 있다. 이 Device Mf 설정 정보는 일 예로 Device Mf Id, 허용 동작 (예: activation, deactivation), FPA로 설치 가능한 프로파일 개수, 설정 유효 기간, 단말 제조사 인증 키, Device Mf 공개키 또는 대칭키와 같은 정보 중 적어도 하나를 포 함할 수 있다. eUICC가 8050 단계의 메시지를 수신하면, eUICC는 8060 단계에서 다음 중 하나의 동작을 포함하여 수행할 수 있다. eUICC는 수신된 메시지에 관련된 단말 제조사가, 허가된 단말 제조사인지 여부, 그리고 또는 수신된 메시 지의 요청 동작이 해당 단말 제조사에 허가된 동작인지 여부를 판단할 수 있다. 만약 8050 단계의 메시지에 단 말 제조사 서명이 포함되어 수신된 경우에, eUICC는 단말 제조사 서명을 검증을 먼저 수행할 수 있다. 단 말 제조사 서명의 검증은 저장된 Device Mf 공개키 또는 대칭키를 통해서 수행될 수 있다. 메시지의 FPA 서비스 관련 요청 동작이 해당 단말 제조사에 허가된 동작인지 여부를 판단하는 동작은, 예들 들어, eUICC가 수신된 메 시지에 포함된 단말 제조사 인증 키와 eUICC에 저장된 단말 제조사 인증 키를 비교하여 동일한 값이 확인되는지 여부를 판단하는 동작을 포함할 수 있다.수신된 메시지가 허가된 단말 제조사 또는 허가된 동작과 관련된 경우, eUICC은 수신된 동작을 수행(8060 단계)할 수 있다. 일 예로 수신된 동작이 activation인 경우, eUICC은 FPA Service status를 activation으로 변경할 수 있고, 수신된 동작이 deactivation인 경우, eUICC은 FPA Service status를 activation으로 변경할 수 있다. 다른 예로 수신된 동작이 잔여 otPK 삭 제 요청인 경우, eUICC은 FPA Service status를 deactivation으로 변경하거나 변경하지 않고, 잔여 otPK개수 정보를 0으로 변경하여 둘 수 있다. 이 경우, BPP 설치를 위한 otPK가 모두 삭제되었으므로, eUICC는 이를 FPA Service status 정보와 무관하게 영구적인 비활성화 상태 (permanent deactivated) 상태로 판단할 수 있다. eUICC는 8060 단계에서 만약, 허가된 단말 제조사 또는 동작이 아니라고 판단하는 경우(예를 들어 Device Mf Id 또는 해당 Device Mf Id에 허용된 동작이 아닌 동작에 대한 요청이 수신되는 경우, 단말 제조사 인증 키 가 없거나 다른 경우), 또는 서명 검증에 실패하는 경우, eUICC는 8070 단계에서 Result로 에러를 전송하 고 절차를 종료할 수도 있다. eUICC는 8060 단계에서 정상으로 처리를 완료하는 경우, 8070 단계에서 Result로 정상 응답을 전송하고 절차를 종료할 수도 있다. FPA은 수신된 Result를 Device Mf에 전송하고 절차를 종료할 수도 있다. (8080 단계) 한편, FPA 서비스 활성화 처리 이후, Device Mf 내지 FPA는 이어서 FPA Service가 요구되는 동작 들을 수행할 수도 있다. 이는 일 예로 prepareLoading 또는 enableProfile과 같은 동작일 수 있다. 도 9은 본 개시의 일 실시 예에 따른 무선 통신 시스템에서 SM-DPf,Device Mf 및 단말의 구조를 나타내는 블록 도이다. 도 9을 참조하면, 본 개시의 일 실시 예에 따른 프로파일 서버는 통신부, 제어부 및 암호화 부를 포함할 수 있다. 통신부는 다른 장치들로 데이터를 송신하거나 다른 장치로부터 데이터를 수신할 수 있다. 통신부는 암호화된 키, 암호화된 프로파일 등을 송신하거나 수신할 수 있다. 이를 위하여 통신부는 적어도 하나의 통신 모듈과 안테나 등을 구비할 수 있다. 제어부는 본 발명에 따른 프로파일 설치를 위하여 프로파일 서버의 각 구성 요소를 제어할 수 있다. 제어부의 구체적인 동작을 상술한 바와 같다. 일 실시 예에 따르면, 프로파일 서버는 서비스 사업자 서버 또는 제조사의 서버 또는 서비스 사업자와 제조사로부터 수신된 정보를 참조하여 동일한 주문 건인 지를 판단하고, 동일한 주문 건에 대해서 프로파일과 eUICC 제공 정보를 맵핑하여 저장부(미도시)에 저장 해 두도록 처리할 수 있다. 또한, 서비스 사업자로부터 수신된 EID 정보를 참조하여 프로파일을 특정 EID와 맵 핑하여 미리 준비하도록 동작을 제어할 수 있다. 또 다른 일 실시 예에 따르면, 제어부는 통신부을 통해서 수신된 메시지로부터 수신된 정보를 가지고 IFPP용으로 프로파일을 준비해야 하는지를 판단하여 프로파 일을 준비하는 동작으로 진입을 처리하여 동작을 수행할 수 있다. 프로파일 서버는 Device Mf로부터 수신 된 메시지를 통신부를 통해 수신하여 해당 수신 메시지로부터 IFPP용 프로파일의 다운로드 요청임으로 판 단하고 공장용으로 프로파일을 준비하도록 동작을 처리하여 해당 처리 결과를 통신부를 통해 Device Mf로 송신해 줄 수 있다. 암호화부는 제어부의 제어에 따라 키 또는 프로파일의 암호화 또는 복호화를 수행한다. 암호화부는 HSM을 포함하거나 HSM 그 자체로 명명될 수 있으며, 암호 키를 노출시키지 않고 프로파일의 암호화 및 복호화를 수행할 수 있다. 구현하기에 따라, 암호화부는 제어부에 내장되거나, 제어부 에 의하여 구동되는 소프트웨어 코드 형식으로 구현될 수 있다. 도 9를 참조하면, 본 개시의 일 실시 예에 따른 Device Mf는 통신 장치, 제어 장치, 및 저 장 장치를 포함할 수 있다. 통상 공장에서 프로파일 설치를 처리하기 위한 Device Mf의 구성 요소는 1개 이상의 서버 또는 단말(예. PC)로 구성될 수 있으며, 구성 요소는 하나 이상의 장치들의 조합으로 구성될 수 있다. 예를 들어, Device Mf은 제 1장치로 공장에서 설치할 프로파일들의 설치에 사용되는 eUICC 데이터(암호화 키, 인증서 등 정보) 또는 프로파일들을 저장하는 저장부, 프로파일 서버와의 송수신 또는 제 2장치로 저장된 일부의 프로파일들과 eUICC데이터를 포함해 전송하는 통신부, 암호화부를 포함하는 제어부를 가진 장치를 포함 할 수 있다. 또한 제 1장치는 다시 1개 이상의 장치들로 구성될 수도 있다. 또한, 단말에 프로파일 주입을 담당 하는 제 2장치(예를 들어, PC)로, 해당 단말들을 위해 준비된 프로파일들을 저장하는 저장부, 단말에 유무선으로 연결하여 프로파일 주입을 위한 일련의 명령을 전송하고, 단말로부터 명령에 대한 처리 결과를 수신하는 통신부, 이를 제어하는 제어부를 포함할 수 있다. 또한, 이를 중앙에서 제어하는 통신부와 제어부를 포함한 제 3의 장치를 더 포함하여 구성될 수 있다. 통신부는 암호화된 키, 암호화된 프로파일 등을 송신하거나 수신할 수 있다. 이를 위하여 통신부는 적어도 하나의 통신 모듈과 안테나 등을 구비할 수 있다. 본 개시의 일 실시 예에 따르면, Device Mf가 저장부를 포함하는 하나의 장치로써 동작하는 경우, 통신부는 제조사의 외부 서버와의 연결이 아닌 Device Mf의 내부에 독립적인 네트워크 연결을 위해서 구비될 수 있다. Device Mf는 통신부를 통 해서 암호화된 키 정보와 암호화된 프로파일 등을 송신하거나 수신할 수 있다. 수신된 프로파일 또는 암호화된 키 등은 Device Mf의 제어부에 의해서 해당 정보와 맵핑되는 단말과의 맵핑을 판단하여 통신부 를 통해 단말에 송신될 수 있다. 한편, 암호화된 키 정보와 암호화된 프로파일 등을 프로파일 서버로 송신 또는 프로파일 설치 결과를 회신하는 Device Mf 장치들은 서로 같거나 같지 않은 장치일 수 있다. 예를 들어, 프로파일을 프로파일 서버/서버 벤더로 부터 수신한 Device Mf의 제 1장치와 단말에 프로파일을 전송해 주는 Device Mf 장치는 서로 같거나 다른 장치 일 수 있다. 프로파일을 단말에 전송해 주는 Device Mf 장치는 외부 서버와의 연결이 있거나 없을 수도 있다. 따라서, 설치 결과는 이를 단말로부터 수신한 장치로부터 Device Mf 내의 다른 장치로 전달되어 외부 연결이 있 는 Device Mf 장치로부터 프로파일 서버/서버 벤더에 전달될 수도 있다. Device Mf의 저장부는 적어도 하나의 암호화된 프로파일을 저장할 수 있다. 또한, 적어도 하나의 암호화된 프로파일에 대한 암호화된 키 정보를 저장할 수 있다. Device Mf의 통신부는 프로파일 설 치 결과를 수신하면 제어부가 이를 판단하여 맵핑된 프로파일의 설치 결과 정보를 업데이트하여 결과 정 보를 저장부에 업데이트했다가, 특정 시점에 프로파일 서버에 일괄로 제공해 줄 수 있다. 저장부 는 하드디스크 타입(hard disk type), 램 (Random Access Memory, RAM), SRAM(Static Random Access Memory), 롬(Read-Only Memory, ROM), EEPROM(Electrically Erasable Programmable Read-Only Memory), PROM(Programmable Read-Only Memory), 자기 메모리, 자기 디스크, 광디스크 중 적어도 하나의 타입의 저장매 체를 포함할 수 있다. Device Mf는 서버 등의 형태로 구현될 수 있다. 암호화부(미도시)는 HSM을 포함하거나 HSM 그 자체로 명명될 수 있으며, 암호 키를 노출시키지 않고 프로파일의 암호화 및 복호화를 수행할 수 있다. 구현하기에 따라, 암호화부(미도시)는 제어부에 내장되거나, 제어부 에 의하여 구동되는 소프트웨어 코드 형식으로 구현될 수 있다. 본 발명의 일 실시 예에 따르면, Device Mf은 제어부를 통해서 FPA 서비스 활성화 또는 바 활성화 메시지를 단말에 전송할 지 여부를 판단하고, 해당 장치 또는 별도 구비된 장치의 HSM을 통해 메시지의 암호화를 수행하도록 처리하고, 암호화된 메시지를 통신부를 통해서 단말에 전송하도록 처리할 수 있다. 도 9를 참조하면, 단말은 통신부, 제어부, 저장부, 및 eUICC를 포함할 수 있다. 통신부는 다른 장치들로 데이터를 송신하거나 다른 장치로부터 데이터를 수신할 수 있다. 통신부 는 암호화된 키, 암호화된 프로파일 등을 수신할 수 있다. 이를 위하여 통신부는 적어도 하나의 통 신 모듈과 안테나 등을 구비할 수 있다. 제어부는 본 발명에 따른 프로파일 설치를 위하여 단말의 각 구성 요소를 제어할 수 있다. 제어부는 단말의 전반적인 동작들을 제어할 수 있다. 예를 들어, 제어부는 통신부를 통해 신호를 송수신할 수 있다. 또한, 제어부는 저장부에 데이터를 기록하고 읽을 수 있다. 제어부는 적어도 하나일 수 있다. 예를 들어, 제어부는 통신을 위한 제어 를 수행하는 CP(communication processor) 및 응용 프로그램 등 상위 계층을 제어하는 AP(application processor)를 포함할 수 있다. 일 실시 예에 따르면, 저장부에 단말 저장된 Configuration 정보가 있는 경우에 제어부는 해당 정보를 저장부에 요청하여 화면 표시부(미도시)가 표시하거나 해당 정보를 받아서 추가적인 동작을 처리할 수 있다. 또다른 일 실시예에 따르면, 제어부는 저장부를 통해서 읽은 데이터 기록, 또는 제어부 및 통신부를 통해 수집된 정보를 매칭하여 공장에서의 프로파일 설 치 선택에 참조할 수 있는 정보를 단말이 추론하는 처리 과정을 수행할 수 있다. 또한, 제어부는 단말 에 저장된 특정 정보에 대한 사용자 동의가 필요한지 여부를 판단하고, 화면 표시부(미도시)에 표시할 수 있다.제어부는 이에 대응하는 동작을 수행하도록 단말을 제어할 수 있다. 일 실시 예에 따르면, 제어부 는 eUICC의 구동 및 제어를 담당하는 FPA, FPA가 통합 구현된 애플리케이션, 공장 설치를 관장하는 애플리케이션을 포함할 수 있다. 또한, 제어부는 FPA로 또는 애플리케이션에 수신된 정보를 해석하여 CP(communication processor)에 특정 Command APDU 요청을 처리하거나 요청된 정보의 일부 또는 전체를 저장부 로부터 수집하여 FPA 또는 애플리케이션에 회신하는 단말 프레임워크를 포함할 수 있다. 제어부는 단말, 통신부을 통해 eUICC로부터 획득한 소정의 정보를 종합하여 IFPP 모드 로 진입하는 동작을 판단하여 eUICC에 IFPP로 진입할 수 있도록 제어할 수 있다. eUICC는 제어부 의 FPA(미 도시)의 제어에 따라 동작할 수 있다, 본 개시의 일 실시 예에 따르면, eUICC는 IFPP모 드로 진입하여 프로파일 설치에 대한 절차를 처리하고 해당 처리 결과를 단말의 FPA(미 도시)에 회신해 줄 수 있다. 본 개시의 일 실시 예에 따른 제어부는 Device Mf로부터 수신 받은 프로파일 패키지의 프로파일 정보 또는 응답 메시지를 수신하고, 수신된 프로파일 정보 또는 응답 메시지로부터 IFPP용 프로파일 설치 요청 정보가 있는지를 판단하고, 수신 시의 단말 설정 또는 사용자 입력 정보를 참조하여 공장 모드에서의 프로파일 설치를 수행할 지를 판단하고, 일반 모드로 진입할 지 IFPP 모드로 진입을 판단하고, IFPP 모드로 진 입을 결정하고, IFPP 모드로 진입을 결정 시, FPA를 사용하도록 설정하고, FPA에서 FPA Service 상태가 비활성 화 상태인지 여부를 판단하고, IFPP로 프로파일을 설치하기 위해 eUICC에 전달할 메시지를 구성하고, 프 로파일 패키지의 프로파일 정보를 하나 이상의 메시지로 구성하고, 해당 메시지를 eUICC에 전달할 수 있 도록 제어하고, eUICC로부터 단말에 수신된 처리 결과를 수신하여 프로파일 설치 절차를 종료할 지 여부를 판단하고, 처리 결과를 통신부에 전달하고, 통신부로 하여금 처리 결과를 Device Mf 에 전달하도록 단말을 제어하는 역할 중의 하나 이상을 수행할 수 있다. 저장부는 단말의 동작을 위한 기본 프로그램, 응용 프로그램, 설정 정보 등의 데이터를 저장할 수 있다. 본 개시에 따른 일 실시 예에서는 저장부는 플래시 메모리 타입(Flash Memory Type), 하드 디스크 타입(Hard Disk Type), 멀티미디어 카드 마이크로 타입(Multimedia Card Micro Type), 카드 타입의 메모리(예 를 들면, SD 또는 XD 메모리 등), 자기 메모리, 자기 디스크, 광디스크, 램(Random Access Memory, RAM), SRAM(Static Random Access Memory), 롬(Read-Only Memory, ROM), PROM(Programmable Read-Only Memory), EEPROM(Electrically Erasable Programmable Read-Only Memory) 중 적어도 하나의 저장 매체를 포함할 수 있다. 저장부는 제어부와 SoC(System on Chip)으로 통합 구현되어 있을 수 있다. 제어부는 저장부에 저장된 각종 프로그램, 컨텐츠, 데이터 등을 이용하여 다양한 동작을 수행할 수 있다. 도 9에서 eUICC는 단말에 내장된 UICC칩으로, 적어도 하나의 프로파일을 설치, 저장, 관리, 삭제하 는 기능을 수행할 수 있다. 프로파일은 기존 UICC 카드에 저장되는 하나 또는 복수 개의 어플리케이션 및 가입 자 인증정보, 전화번호부 등의 데이터 정보를 총칭할 수 있다. eUICC는 도 1에서 도시한 것과 같이 단말 의 일부로 포함될 수 있으며 본 발명의 다른 도면에서는 단말과 eUICC간의 동작을 설명하기 위해서 각각 별도 모듈로 표현하였다. eUICC는 프로파일을 설치하기 위한 제어부, 저장부, 통신부를 포함 할 수도 있다. eUICC내에 애플리케이션의 일부는 제어부에 설치되어 있을 수 있으며 설치되어 있는 애플리케이션은 FPA의 기능의 일부를 포함할 수도 있다. 본 개시의 일 실시 예에 따르면, eUICC의 제어부는 통신부를 통해서 수신된 단말의 프로파일 설치 요청 정보를 획득한 후, 해당 메시지 정보를 통해서 프로파일 패키지와 암호화 키 정보들에 대한 소정의 정보를 획득하고, eUICC가 IFPP로 진입할 지 여부를 판단하여 동작을 결정하고, 이를 위해 FPA Service 상태를 확인하고, 이에 따라 IFPP을 위한 프로파일 설치 절차 및 수신된 정보를 eUICC의 저장부에 있는 정보와 비교 검증하여 처리하고, 수신된 프로파일 패키지를 검증하여 설치에 대한 동작을 수행하고, 설치를 처리하고 나서 FPA Service 상태를 비활성화 또는 활성화 상태로 둘 지를 판단하고, 메시지를 구성하여 통신부를 통해 단 말에 처리 결과를 회신해 줄 수 있다. 다만, 도 9에서 언급하는 구성 요소가 전술한 예에 한정되는 것은 아니다. 예를 들어, Device Mf는 전술 한 구성 요소보다 더 많은 구성 요소를 포함하거나 더 적은 구성 요소를 포함할 수 있다. 본 문서에 개시된 다 양한 실시 예들에 따른 단말은 전자 디바이스가 될 수 있으며, 상기 전자 디바이스는 다양한 형태의 디바 이스가 될 수 있다. 상기 전자 디바이스는, 예를 들면, 휴대용 통신 디바이스 (예: 스마트폰), 컴퓨터 디바이스, 휴대용 멀티미디어 디바이스, 휴대용 의료 기기, 카메라, 웨어러블 디바이스, 또는 가전 디바이스를 포함할 수 있다. 본 문서의 일 실시 예에 따른 전자 디바이스는 전술한 기기들에 한정되지 않는다.도 10은 본 개시의 일 실시예에 따른 프로파일 설치 성공 시 FPA 서비스를 비 활성화 처리하는 동작을 설명하기 위한 도면이다. 도 4 내지 도 6에서 eUICC에 ES10f 메시지를 전송하기 전에 FPA가 FPA 서비스의 상태를 체크하고 또한 FPA 서비스 상태의 변경을 eUICC로부터 회신 받아 저장하는 단계를 수행하였다. 이는 FPA에서 1차적으로 체크를 수행하여 eUICC까지 메시지를 전송하고, 처리 결과를 회신 받는 절차를 수행하기 않도록 하기 위 함이었다. 하지만, 공장 환경에서 프로파일 관리 동작을 수행 시에 따른 처리 속도 등 효율성을 위해 eUICC에서만 FPA 서비스의 상태를 저장하고 상태를 회신하는 것도 가능할 수 있다. 즉 도 4 내지 도 6을 참조하면 FPA가 도 4에서 4040 단계, 4050 단계, 4160 단계 수신 후의 FPA 서비스를 저장하는 단계, 도 5에서 5040 단계, 5050 단계, 5160 단계 수신 후의 FPA 서비스를 저장하는 단계, 도 6에서 6040 단계, 6050 단 계, 6160 단계 수신 후의 FPA 서비스를 저장하는 단계를 수행하지 않고 동작을 처리할 수도 있다. 또한, eUICC은 도 4에서 4160 단계, 도 5에서 5160 단계, 도 6에서 6160 단계에서 FPA 서비스 상태 정보를 회 신하지 않을 수 있다. 도 10에서는 도 4를 기반으로 상세 예시를 들어 설명하고 있으나, 이는 도 5와 도 6에게 동일하게 해석될 수 있 다. FPA는 ESfac인터페이스 (SGP.41에 정의된 Device Manufacturer - FPA interface)를 통해서 프로파일 설 치를 위한 동작을 위한 요청을 인지하여 IFPP 모드로 진입(10015 단계)할 수 있다. 해당 요청에는 프로파일 설 치를 위한 세션 키 생성 정보 또는/그리고 BPP가 포함될 수 있다. 세션 키 생성 정보는 eUICC의 otPK.EUICC.KA 또는 해당 otPK.EUICC.KA를 특정할 수 있는 정보, 상기 데이터를 SM-DPf 개인키로 서명한 서명값, SM-DPf의 인 증서 및 인증서 체인 정보 중 적어도 일부를 포함할 수 있다. FPA는 BPP를 전송하기에 앞서, 프로파일 서버 인증을 위한 정보를 포함하여 eUICC에 전송(10020 단계)할 수 있으며, 일 예로 ES10f.prepareLoading와 같은 ES10f 함수에 프로파일 서버 인증을 위한 정보를 포 함하여 전송할 수 있다. 프로파일 서버 인증을 위한 정보로는, 앞서 Device Mf로부터 수신된 SM-DPf 서버의 인 증서 및 인증서 체인을 포함할 수 있다. 프로파일 서버 인증을 위한 인증서로 SM-DPf가 프로파일 바인딩을 위해 사용한 인증서가 사용될 수도 있다. 이를 수신한 eUICC는 먼저 ISD-R의 FPA 서비스 상태를 판단(10025 단계)할 수 있다. 만약 ISD-R의 FPA 서비스가 비활성화 상태인 경우, eUICC는 에러 메시지를 회신(10030 단계)하고 절차를 종료할 수 있다. 에러 메시지는 FPA 서비스가 비활성화 상태임을 나타내는 메시지일 수 있고 eUICC가 서명하지 않은 메시 지로 회신될 수 있다. 이를 수신한 FPA는 Device Mf에 에러 메시지를 회신(10035 단계)하여 절 차를 종료할 수 있다. 이를 수신한 Device Mf은 FPA 상태 비활성화 절차임을 인지하고 절차를 종료하거 나 또는 도 8에서 후술하는 바와 같이 동작할 수도 있다. eUICC가 ISD-R의 FPA 서비스가 비활성화 상태가 아니라고 판단하는 경우, 일 예로 FPA 서비스가 활성화 상태이거나 또는 FPA 서비스의 활성화 여부에 대한 정보를 판단할 수 없는 경우, eUICC는 ES10f.prepareLoading 요청에 따른 동작을 수행할 수 있다. ES10f로 수신되는 정보는 세션 관리를 위한 ID로 transaction ID가 포함된 데이터, SM-DPf의 개인키로 상기 데이터를 서명한 서명 값, SM-DPf의 공개키를 포함하 는 프로파일 서버 인증서 및 인증서 체인 중 적어도 하나를 포함할 수 있다. eUICC의 ES10f.prepareLoading 요청에 따른 동작은 SM-DPf의 인증서를 검증하는 동작, SM-DPf의 공개키 를 기반으로 SM-DPf의 서명 값을 검증하여 서명된 데이터의 무결성을 확인하는 동작, 데이터에 포함된 eUICC의 otPK를 확인 또는 eUICC의 otPK 또는 otPK를 특정할 수 있는 정보를 참조하여 이에 맵핑되는 eUICC의 otSK를 확 인하는 동작, 또는 수신된 transaction ID를 세션 ID로 하여 데이터들을 이 세션 ID에 연결(attach)하는 동작 중 적어도 하나를 포함할 수 있다. eUICC는 프로파일의 설치가 완료될 때까지 FPA 서비스의 상태를 활성화 상태로 유지할 수 있다. 따라서, ES10f.prepareLoading 요청에 따른 동작을 수행하면서 에러 또는 성공과 무관하게, FPA 서비스의 상태를 활성화 상태로 유지할 수도 있다. FPA는 eUICC의 ES10f.prepareLoading에 대한 회신 값으로 성공 응답을 수신한 경우, BPP를 전송 할 수 있다. 일 예로, ES10f.LoadBoundProfilePackage 함수에 실어 BPP가 전송될 수 있다. eUICC는 BPP를 수신하여, 프로파일 설치를 수행하는 동작을 수행(10060 단계)할 수 있다. 이 동작은 보 안 채널 생성을 위한 세션 키를 생성하고, 수신된 메타데이터를 저장하고, 프로파일을 복호화하는 것을 포함할 수 있다. 또한, 이때, eUICC transaction ID에 연결(attach)해 둔, 앞서 수신된 SM-DPf의 인증서를 사 용하여 수신된 SM-DPf 서명값을 검증할 수 있다. eUICC은 프로파일 설치 결과를 FPA에 회신(10070 단계)하여 줄 수 있다. eUICC는 프로파 일 설치 결과가 성공인 경우, FPA로 프로파일 설치 결과 및 FPA 서비스 상태를 전송하는 10070 단계를 수행한 후 상기 업데이트된 FPA 서비스 상태로 저장할 수 있다. 또는, eUICC는 프로파일 설치를 완료 (10060 단계)하고 10070 단계를 수행하기 전에 상기 업데이트된 FPA 서비스 상태로 저장(10065 단계)할 수도 있 다. FPA는 수신한 프로파일 설치 결과(10070 단계)를 Device Mf에 전송(10075 단계)할 수 있다. 도 11은 본 개시의 일 실시 예에 따른 단말의 구성을 도시한다. 도 11에 도시되는 바와 같이, 본 개시의 단말은 제어부(컨트롤 유닛) , 송수신부, 저장부(메모 리)를 포함할 수 있다. 다만 단말의 구성 요소가 전술한 예에 한정되는 것은 아니다. 예를 들어, 단말은 전술한 구성 요소보다 더 많은 구성 요소를 포함하거나 더 적은 구성 요소를 포함할 수 있다. 뿐만 아니라, 제 어부, 송수신부 및 저장부가 하나의 칩(Chip) 형태로 구현될 수도 있다. 일 실시예에 따르면, 도 11의 송수신부는 도 23의 송신부 및 수신부를 포함할 수 있다. 또한, 도 11의 제 어부는 적어도 하나의 프로세서 또는 컨트롤러를 포함할 수 있다. 일 실시예에 따르면, 제어부는 상술한 본 개시의 실시 예에 따라 단말이 동작할 수 있는 일련의 과정을 제어할 수 있다. 예를 들면, 본 개시의 실시 예에 따라 기지국 모드가 기지국 에너지 절감 모드인지 기지국 일 반 모드인지에 따라 단말의 송수신 방법을 수행하도록 단말의 구성요소들을 제어할 수 있다. 제어부는 하 나 또는 복수 개일 수 있으며, 제어부는 저장부에 저장된 프로그램을 실행함으로써 전술한 본 개시 의 반송파 묶음을 적용하는 무선 통신 시스템에서 단말의 송수신 동작을 수행할 수 있다. 송수신부는 기지국과 신호를 송수신할 수 있다. 기지국과 송수신하는 신호는 제어 정보와, 데이터를 포함 할 수 있다. 송수신부는 송신되는 신호의 주파수를 상승 변환 및 증폭하는 RF 송신기와, 수신되는 신호를 저 잡음 증폭하고 주파수를 하강 변환하는 RF 수신기 등으로 구성될 수 있다. 다만, 이는 송수신부는 일 실시 예일뿐이며, 송수신부의 구성요소가 RF 송신기 및 RF 수신기에 한정되는 것은 아니다. 또한, 송수신 부는 무선 채널을 통해 신호를 수신하여 제어부로 출력하고, 제어부로부터 출력된 신호를 무 선 채널을 통해 전송할 수 있다. 일 실시예에 따르면, 저장부는 단말의 동작에 필요한 프로그램 및 데이터를 저장할 수 있다. 또한, 저장 부는 단말이 송수신하는 신호에 포함된 제어 정보 또는 데이터를 저장할 수 있다. 저장부는 롬 (ROM), 램(RAM), 하드디스크, CD-ROM 및 DVD 등과 같은 저장 매체 또는 저장 매체들의 조합으로 구성될 수 있다. 또한, 저장부는 복수 개일 수 있다 일 실시 예에 따르면, 저장부는 전술한 본 개시의 실시 예들인 기지국 모드가 기지국 에너지 절감 모드인지 기지국 일반 모드인지에 따라 단말의 송수신 동작을 수행하 기 위한 프로그램을 저장할 수 있다. 도 12는 본 개시의 일 실시 예에 따른 기지국의 구성을 도시한다. 도 12에 도시되는 바와 같이, 본 개시의 기지국은 제어부(컨트롤 유닛) , 송수신부, 저장부(메모리)를 포함할 수 있다. 다만 기지국의 구성 요소가 전술한 예에 한정되는 것은 아니다. 예를 들어, 기지국은 전술한 구성 요소보다 더 많은 구성 요소를 포함하거나 더 적은 구성 요소를 포함할 수 있다. 뿐만 아니라, 제어부, 송수신부 및 저장부가 하나의 칩(Chip) 형태로 구현될 수도 있다. 도 12의 제어부는 적어도 하나의 프로세서 또는 컨트롤러를 포함할 수 있다. 제어부는 상술한 본 개시의 실시 예에 따라 기지국이 동작할 수 있도록 일련의 과정을 제어할 수 있다. 예를 들면, 본 개시의 실시 예에 따라 기지국 모드가 기지국 에너지 절감 모드인지 기지국 일반 모드인지에 따 라 단말을 스케줄링하는 방법을 수행하도록 기지국의 구성 요소들을 제어할 수 있다. 제어부는 하나 또 는 복수 개일 수 있으며, 제어부는 저장부에 저장된 프로그램을 실행함으로써 전술한 본 개시의 기 지국 모드가 기지국 에너지 절감 모드인지 기지국 일반 모드인지에 따라 단말을 스케줄링하는 방법을 수행할 수 있다.송수신부는 단말과 신호를 송수신할 수 있다. 단말과 송수신하는 신호는 제어 정보와, 데이터를 포함할 수 있다. 송수신부는 송신되는 신호의 주파수를 상승 변환 및 증폭하는 RF 송신기와, 수신되는 신호를 저 잡음 증폭하고 주파수를 하강 변환하는 RF 수신기 등으로 구성될 수 있다. 다만, 이는 송수신부는 일 실 시 예일뿐이며, 송수신부의 구성요소가 RF 송신기 및 RF 수신기에 한정되는 것은 아니다. 또한, 송수신부 는 무선 채널을 통해 신호를 수신하여 제어부로 출력하고, 제어부로부터 출력된 신호를 무선 채널을 통해 전송할 수 있다. 일 실시 예에 따르면, 저장부는 기지국의 동작에 필요한 프로그램 및 데이터를 저장할 수 있다. 또한, 저 장부는 기지국이 송수신하는 신호에 포함된 제어 정보 또는 데이터를 저장할 수 있다. 저장부는 롬 (ROM), 램(RAM), 하드디스크, CD-ROM 및 DVD 등과 같은 저장 매체 또는 저장 매체들의 조합으로 구성될 수 있다. 또한, 저장부는 복수 개일 수 있다. 일 실시예에 따르면, 저장부는 전술한 본 개시의 실시 예들인 기지국 모드가 기지국 에너지 절감 모드인지 기지국 일반 모드인지에 따라 단말을 스케줄링하는 방법을 수행하기 위한 프로그램을 저장할 수 있다. 도 13은 본 개시의 일 실시 예에 따른 네트워크 엔티티의 구성을 도시한다. 도 13을 참조하면, 본 개시의 네트워크 엔티티는 제어부, 송수신부, 저장부(또는 메모리)를 포함할 수 있다. 다만 네트워크 엔티티의 구성 요소가 전술한 예에 한정되는 것은 아니다. 예를 들어, 네트워크 엔티티는 전술한 구성 요소보다 더 많은 구성 요소를 포함하거나 더 적은 구성 요소를 포함할 수 있다. 뿐만 아 니라, 제어부, 송수신부 및 저장부이 하나의 칩(Chip) 형태로 구현될 수도 있다. 또한 본 개 시의 일 실시예에 따르면, 네트워크 엔티티는 NF(network function)을 의미할 수 있고, NF는 AMF, SMF, PCF, UDM, DN, AF, UPF, L-UPF, NEF, UTM, EASDF, Local Edge Control NF(LECF) 등을 포함할 수 있다. 본 개시의 일 실시예에 따르면, 제어부는 상술한 본 개시의 실시예에 따라 NF가 동작할 수 있는 일련의 과정을 제어할 수 있다. 예를 들면, 제어부는 전술한 실시예들에 따라 네트워크 슬라이스 변경 지원 방법 을 수행하도록 네트워크 엔티티의 구성요소들을 제어할 수 있다. 제어부는 저장부에 저장된 프로그 램을 실행함으로써 전술한 본 개시의 실시예들이 수행되도록 네트워크 엔티티의 구성요소들을 제어할 수 있다. 또한 제어부는 AP(Application Processor), CP(Communication Processor), 회로(circuit), 어플리케이션 특정(application-specific) 회로, 또는 적어도 하나의 프로세서(processor)일 수 있다. 본 개시의 일 실시예에 따르면 송수신부는 다른 네트워크 엔티티, 기지국 또는 단말과 신호를 송수신할 수 있다. 다른 네트워크 엔티티 또는 단말과 송수신하는 신호는 제어 정보와, 데이터를 포함할 수 있다. 송수신 부는 송신되는 신호의 주파수를 상승 변환 및 증폭하는 RF 송신기와, 수신되는 신호를 저 잡음 증폭하고 주파수를 하강 변환하는 RF 수신기 등으로 구성될 수 있다. 다만, 이는 송수신부는 일 실시예일 뿐이며, 송수신부의 구성요소가 RF 송신기 및 RF 수신기에 한정되는 것은 아니다. 또한, 송수신부는 무선 채널을 통해 신호를 수신하여 제어부로 출력하고, 제어부로부터 출력된 신호를 무선 채널을 통해 전송할 수 있다. 본 개시의 일 실시예에 따르면, 저장부는 네트워크 엔티티의 동작에 필요한 프로그램 및 데이터를 저장할 수 있다. 또한, 저장부는 네트워크 엔티티가 송수신하는 신호에 포함된 제어 정보 또는 데이터를 저장할 수 있다. 저장부는 롬(ROM), 램(RAM), 하드디스크, CD-ROM 및 DVD 등과 같은 저장 매체 또는 저장 매체들 의 조합으로 구성될 수 있다. 또한, 저장부는 복수 개일 수 있다. 또한 일 실시예에 따르면, 저장부 는 전술한 네트워크 슬라이스 변경 지원 방법을 수행하기 위한 프로그램을 저장할 수 있다. 본 문서의 다양한 실시 예들 및 이에 사용된 용어들은 본 문서에 기재된 기술적 특징들을 특정한 실시 예들로 한정하려는 것이 아니며, 해당 실시예의 다양한 변경, 균등물, 또는 대체물을 포함하는 것으로 이해되어야 한다. 도면의 설명과 관련하여, 유사한 또는 관련된 구성요소에 대해서는 유사한 참조 부호가 사용될 수 있다. 아이템에 대응하는 명사의 단수 형은 관련된 문맥상 명백하게 다르게 지시하지 않는 한, 상기 아이템 한 개 또 는 복수 개를 포함할 수 있다. 본 문서에서, \"A 또는 B\", \"A 및 B 중 적어도 하나\",\"A 또는 B 중 적어도 하 나,\"\"A, B 또는 C,\" \"A, B 및 C 중 적어도 하나,\"및 \"A, B, 또는 C 중 적어도 하나\"와 같은 문구들 각각은 그 문구들 중 해당하는 문구에 함께 나열된 항목들 중 어느 하나, 또는 그들의 모든 가능한 조합을 포함할 수 있다. \"제 1\", \"제 2\", 또는 \"첫째\" 또는 \"둘째\"와 같은 용어들은 단순히 해당 구성요소를 다른 해당 구성요소와 구분하기 위해 사용될 수 있으며, 해당 구성요소들을 다른 측면(예: 중요성 또는 순서)에서 한정하지 않는다. 어떤(예: 제 1) 구성요소가 다른(예: 제 2) 구성요소에, \"기능적으로\" 또는 \"통신적으로\"라는 용어와 함께 또는 이런 용어 없이, \"커플드\" 또는 \"커넥티드\"라고 언급된 경우, 그것은 상기 어떤 구성요소가 상기 다 른 구성요소에 직접적으로(예: 유선으로), 무선으로, 또는 제 3 구성요소를 통하여 연결될 수 있다는 것을 의미 한다. 본 문서에서 사용된 용어 \"모듈\"은 하드웨어, 소프트웨어 또는 펌웨어로 구현된 유닛을 포함할 수 있으며, 예를 들면, 로직, 논리 블록, 부품, 또는 회로 등의 용어와 상호 호환적으로 사용될 수 있다. 모듈은, 일체로 구성된 부품 또는 하나 또는 그 이상의 기능을 수행하는, 상기 부품의 최소 단위 또는 그 일부가 될 수 있다. 예를 들 면, 일 실시 예에 따르면, 모듈은 ASIC(application-specific integrated circuit)의 형태로 구현될 수 있다. 본 문서의 다양한 실시 예들은 머신(machine)(예: 전자 디바이스) 의해 읽을 수 있는 저장 매체(storage medium)(예: 내장 메모리 또는 외장 메모리)에 저장된 하나 이상의 명령어들을 포함하는 소프트웨어(예: 프로그 램)로서 구현될 수 있다. 예를 들면, 머신(예: 전자 디바이스)의 프로세서는, 저장 매체로부터 저장된 하나 이 상의 명령어들 중 적어도 하나의 명령을 호출하고, 그것을 실행할 수 있다. 이것은 기기가 상기 호출된 적어도 하나의 명령어에 따라 적어도 하나의 기능을 수행하도록 운영되는 것을 가능하게 한다. 상기 하나 이상의 명령 어들은 컴파일러에 의해 생성된 코드 또는 인터프리터에 의해 실행될 수 있는 코드를 포함할 수 있다. 기기로 읽을 수 있는 저장매체는, 비일시적(non-transitory) 저장매체의 형태로 제공될 수 있다. 여기서, '비일시적'은 저장매체가 실재(tangible)하는 디바이스고, 신호(signal)(예: 전자기파)를 포함하지 않는다는 것을 의미할 뿐 이며, 이 용어는 데이터가 저장매체에 반영구적으로 저장되는 경우와 임시적으로 저장되는 경우를 구분하지 않 는다. 일 실시 예에 따르면, 본 문서에 개시된 다양한 실시 예들에 따른 방법은 컴퓨터 프로그램 제품(computer program product)에 포함되어 제공될 수 있다. 컴퓨터 프로그램 제품은 상품으로서 판매자 및 구매자 간에 거래 될 수 있다. 컴퓨터 프로그램 제품은 기기로 읽을 수 있는 저장 매체(예: compact disc read only memory (CD- ROM))의 형태로 배포되거나, 또는 어플리케이션 스토어(예: 플레이 스토어TM)를 통해 또는 두 개의 사용자 디바 이스들(예: 스마트폰들) 간에 직접, 온라인으로 배포(예: 다운로드 또는 업로드)될 수 있다. 온라인 배포의 경 우에, 컴퓨터 프로그램 제품의 적어도 일부는 제조사의 서버, 어플리케이션 스토어의 서버, 또는 중계 서버의 메모리와 같은 기기로 읽을 수 있는 저장 매체에 적어도 일시 저장되거나, 임시적으로 생성될 수 있다. 다양한 실시 예들에 따르면, 상기 기술한 구성요소들의 각각의 구성요소(예: 모듈 또는 프로그램)는 단수 또는 복수의 개체를 포함할 수 있다. 다양한 실시 예들에 따르면, 전술한 해당 구성요소들 중 하나 이상의 구성요소 들 또는 동작들이 생략되거나, 또는 하나 이상의 다른 구성요소들 또는 동작들이 추가될 수 있다. 대체적으로 또는 추가적으로, 복수의 구성요소들(예: 모듈 또는 프로그램)은 하나의 구성요소로 통합될 수 있다. 이런 경우, 통합된 구성요소는 상기 복수의 구성요소들 각각의 구성요소의 하나 이상의 기능들을 상기 통합 이전에 상기 복수의 구성요소들 중 해당 구성요소에 의해 수행되는 것과 동일 또는 유사하게 수행할 수 있다. 다양한 실시 예들에 따르면, 모듈, 프로그램 또는 다른 구성요소에 의해 수행되는 동작들은 순차적으로, 병렬적으로, 반복적으로, 또는 휴리스틱하게 실행되거나, 상기 동작들 중 하나 이상이 다른 순서로 실행되거나, 생략되거나, 또는 하나 이상의 다른 동작들이 추가될 수 있다. 상술한 본 개시의 구체적인 실시 예들에서, 본 개시에 포함되는 구성 요소는 제시된 구체적인 실시 예에 따라 단수 또는 복수로 표현되었다. 그러나, 단수 또는 복수의 표현은 설명의 편의를 위해 제시한 상황에 적합하게 선택된 것으로서, 본 개시가 단수 또는 복수의 구성 요소에 제한되는 것은 아니며, 복수로 표현된 구성 요소라 하더라도 단수로 구성되거나, 단수로 표현된 구성 요소라 하더라도 복수로 구성될 수 있다. 한편 본 개시의 상세한 설명에서는 구체적인 실시 예에 관해 설명하였으나, 본 개시의 범위에서 벗어나지 않는 한도 내에서 여러 가지 변형이 가능함은 물론이다. 그러므로 본 개시의 범위는 설명된 실시 예에 국한되어 정해 져서는 아니 되며 후술하는 특허청구의 범위뿐만 아니라 이 특허청구의 범위와 균등한 것들에 의해 정해져야 한 다.도면 도면1 도면2 도면3 도면4 도면5 도면6 도면7 도면8 도면9 도면10 도면11 도면12 도면13"}
{"patent_id": "10-2024-0033377", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 개시의 실시 예들에 따른 프로파일을 프로비저닝하기 위한 구성 요소 간의 관계를 나타낸 도면이다. 도 2는 본 개시의 일 실시 예에 따른 대량의 프로파일을 프로비저닝하는 동작을 설명하기 위한 도면이다. 도 3은 본 개시의 일 실시 예에 따른 대량의 프로파일을 프로비저닝하기 위해 프로파일을 준비하는 동작을 설명하기 위한 도면이다. 도 4는 본 개시의 일 실시 예에 따른 프로파일 설치 성공 시 FPA 서비스를 비활성화 처리하는 동작을 설명하기 위한 도면이다. 도 5는 본 개시의 일 실시 예에 따른 미리 설정한 프로파일 설치 개수 도달 시, FPA 서비스를 비활성화로 처리 하는 동작을 설명하기 위한 도면이다. 도 6은 본 개시의 일 실시 예에 따른 FPA 서비스를 비활성화하는 방법으로 FPA 서비스 비활성화 지시자를 도입 하여 처리하는 도면이다. 도 7은 본 개시의 일 실시 예에 따른 메모리 리셋 명령 처리에 대한 결과로 FPA 서비스 활성화를 처리하는 동작 을 설명하기 위한 도면이다. 도 8은 본 개시의 일 실시 예에 따른 명시적인 활성화 명령에 대하여 단말에서 FPA 서비스 활성화를 처리하는 동작을 설명하기 위한 도면이다. 도 9는 본 개시의 일 실시 예에 따른 무선 통신 시스템에서 SM-DPf (Subscription Manager Data Preparation factory), Device Mf (Device Manufacturer) 및 단말 구조를 나타낸 블록도이다. 도 10은 본 개시의 일 실시예에 따른 프로파일 설치 성공 시 FPA 서비스를 비활성화 처리하는 동작을 설명하기 위한 도면이다. 도 11은 본 개시의 일 실시예에 따른 단말의 구성을 도시한다. 도 12는 본 개시의 일 실시예에 따른 기지국의 구성을 도시한다. 도 13은 본 개시의 일 실시예에 따른 네트워크 엔티티의 구성을 도시한다."}
