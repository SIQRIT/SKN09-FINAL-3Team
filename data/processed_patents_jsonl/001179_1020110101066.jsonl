{"patent_id": "10-2011-0101066", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2012-0085147", "출원번호": "10-2011-0101066", "발명의 명칭": "유기화합물의 용해지수를 예측하는 다중선형회귀?인공신경망 혼성모형", "출원인": "주식회사 켐에쎈", "발명자": "권윤경"}}
{"patent_id": "10-2011-0101066", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 수소(H), 탄소(C), 질소(N), 산소(O), 황(S) 등 5가지 이내의 원소로 구성되고 수소를 제외한 원자의 개수가 25개 이하인 분자로 이루어지고 표준상태에서 액체인 순수한 유기화합물의 용해지수(Solubility parameter)를 높은 정확도로 예측하는 수학적 모형을 제공한다. 상기의 모형은, 용해지수의 정의값이 알려져 있 는 상기 조건을 만족하는 다수의 유기화합물들에 대해, 다양한 분자표현자(molecular descriptor)들 중 일부를 독립변수로, 용해지수를 종속변수로 하는 많은 다중선형회귀모형(multiple linear regression model)들 중 최선 의 것을 유전적 알고리즘(genetic algorithm)을 사용하여 구한 뒤, 이 모형에 포함된 분자표현자들의 값을 입력 받아 용해지수를 출력하는 인공신경망(artificial neural network)을 구성함으로써 예측성능을 더욱 향상시킨 다 중선형회귀-인공신경망 혼성모형(hybrid model)으로서, QSPR(quantitative structure-property relationship) 모형의 일례이며, 모형에 포함된 분자표현자들의 구체적인 값만 알 수 있다면 그 어떤 분자든, 이 분자로 순수하 게 이루어진 화합물의 용해지수를 예측하여 준다. 이처럼, 본 발명은 실험값이 알려지지 않은 수많은 상기 조건 의 유기화합물에 대해서도 신뢰할만한 용해지수를 예측할 수 있는 방법을 제공하여 줌으로써 실험에 드는 비용과 시간을 절약하게 해주어, 관련 산업의 연구개발활동을 용이하게 하는 등의 효과를 낳는다."}
{"patent_id": "10-2011-0101066", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은, 물성예측이라는 물리화학의 한 분야에 속하는 것으로 유기화합물의 여러 특성 중 하나인 용해지수를 높은 정확도로 예측하기 위한 방법에 관한 것이다."}
{"patent_id": "10-2011-0101066", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "유기화합물의 여러 물성의 정확한 값을 구체적으로 아는 것은 그 물질의 용도의 타당성을 검토하거나 합성및 정 제 과정을 설계하고 보관, 운반, 사용, 폐기의 방법과 조건을 설정하는 등, 생산과 소비의 전 과정에 걸친 제반 의사결정 사항들에 결정적이기 때문에 산업적으로나 학문적으로 매우 중요한 문제이다. 관심 있는 유기화합물의 관심 있는 물성의 값을 가장 정확하게 알 수 있는 방법은 역시 실험이겠으나 정제된 시료의 준비, 정확한 측정 을 위한 환경의 구축 등 여러 가지 측면에서 상당한 비용과 시간이 드는 것이 사실이며 경우에 따라서는 불가능 할 수도 있다. 따라서, 그 대안으로 오래전부터 많은 연구자들이 유기화합물의 여러 물성의 정확한 값을 예측하 고자 노력을 기울여 왔다. 이처럼 물성 예측은 오랜 역사를 가지며 끊임 없이 새로운 예측 방법들이 등장하여 현재는 물성 별로 정확도와 적용범위 등이 서로 다른 여러 예측모형들이 공존하고 있는 상황이다. 본 발명의 관심 대상인 용해지수에 대해서도 현재까지 여러 예측모형들이 제안되었다. 용해지수에 대해 설명하 자면 용질이 용매에 녹기 위해서는 용질분자 상호간의 인력이나 용매분자 상호간의 인력에 대등한 정도의 용질- 용매간의 인력이 작용하지 않으면 안되는데 이와 같은 용질분자 상호간의 인력 및 용매분자 상호간의 인력은 각 각의 분자집단으로부터 1개의 분자를 분리시키는 데 요구되는 에너지로써 나타낼 수 있다. 이 에너지가 응집에 너지(cohesive energy)이다. 단위체적당의 응집에너지를 응집에너지밀도(cohesive energy density, CED)라고 하며, 응집에너지 밀도의 평방근을 용해지수(solubility parameter, δ)라고 한다. 비슷한 용해지수를 가진 두 물질들은 혼화될만큼 충분한 상호분산에 대한 에너지를 가진다. 반면에 다른 용해지수를 가지는 두 물질은 혼화 함으로써 가지는것보다 분산하기 위해 더 많은 에너지를 요구한다. 그래서 혼화할 수 없는 결과를 가진다. 현재 용해지수를 예측하는 모형으로 잘 알려지고 널리 쓰이는 것은 힐더브랜드 수식[J.H. Hildebrand, R.L.Scott, The Solubility of Nonelectrolytes, 3rd ed., Reinhold Publishing ; Dover Publications , Chap. VII, p.129; Chap. XXIII, for the original definition, theory, and extensive examples Poling B. E., Prausnitz J. M., O’Connell J. P.]을 이용한 것들이다. 표 1은 그 동안 제안되었던 용해지수 들에 대한 주요한 모형들을 연도순으로 보여 주고 있다. [표 1]"}
{"patent_id": "10-2011-0101066", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 2, "content": "낮은 분자량을 가진 화합물에 대한 응집에너지(cohesive energy, Ucoh)는 보통 기화열( )로부터 얻는다."}
{"patent_id": "10-2011-0101066", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 3, "content": "Solubility parameter,"}
{"patent_id": "10-2011-0101066", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 4, "content": "R은 이상기체상수. ΔHvap는 기화열. LMV는 액체몰부피이다. 간접적으로 용해지수를 계산하는 방법으로 수식의 기화열과 액체몰부피는 QSPR로 모델링한 계산값이며, T=298.15K이다. 예측모형을 구축하는데 있어서 그룹기여 방법의 대안이 될 수 있는다른 방법들의 하나는 QSPR(quantitative structure-property relationship) 방법이다. 이 방법은 기본적으로 화합물의 물성은 그 분자의 구조적 특성들 의 함수라는 가정에서부터 출발하고 있으며 서로 다른 여러 구조적 특성들을 반영하는 다양한 분자표현자 (molecular descriptor)들을 이용한다. 현재까지 제안된 분자표현자들의 종류는 수천에 이르며 한 분자내의 탄 소나 수소의 개수와 같은 단순한 것들로부터 분자의 모양이나 연결상태, 전기화학적 특성과 같은 복잡한 것들에 이르기까지 수많은 종류의 분자표현자들에 대한 계산법들이 개발되어 있다[Todeschini R., V. Consonni V., Molecular Descriptors for Chemoinformatics: Second, Revised and Enlarged Edition: Volume I/II, Wiley- VCH, 2009]. QSPR 예측모형은 이러한 분자표현자들 그리고 때로는 이에 더하여 화합물의 다른 물리화학적 물성 들(이들 역시 구조적 특성들의 함수이다) 중 일부를 독립변수로 포함하는 함수의 형태로 제시된다. 이때 이러한 함수의 꼴로 가장 빈번이 채택되는 것은 아래와 같은 표현자 들의 선형 결합 함수이며 각 계수 들은 주로 다중선형회귀분석을 통해 실험데이터로부터 결정된다."}
{"patent_id": "10-2011-0101066", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 5, "content": "QSPR 모형을 만드는 또 다른 방법은 인공신경망을 이용하는 것이다. 인공신경망 기법은 지능을 가진 인간의 신 경세포를 모델링하여 인공적으로 지능을 가진 기계를 만들어 보고자 하는 인류의 오랜 연구결과의 하나로서, 20 세기 중반에 처음 등장하여 현재 다방면으로 응용되고 있는 정보처리기술이다. 도 2는 인공신경망의 전형적인 한 예를 보여주고 있다. 여기서 볼 수 있듯이, 인공신경망에는 입력 데이터를 수용하는 입력층(input layer)과출력데이터를 만드는 출력층(output layer), 이들 사이에 위치한 은닉층(hidden layer)이 존재하며 각 층은하나 이상의 노드(node)들로 구성되어 있다. 은닉층의 각 노드들은 입력층과 출력층의 노드들과 연결되어 있으며 각 연결들에는 가중치(weight)라 불리는 양 이 부여되어 있다. 은닉층과 출력층의 각 노드들은 전 단계의 노드들로부터 이러한 연결들을 통해 입력을 받은 뒤 이를 가공하여 출력값을 만드는데 이때 활성화 함수 (activation function)라 불리는 함수 를 적용한다. 이러한 인공신경망을 실제로 활용하려면 먼저, 다양한 입력값과 그 입력값에 대응하는 출력값을 함께묶어 놓은 샘플집합을 이용하여 인공신경망을 훈련시키는 과정이 필요한데 이는 주어진 입력에 대한 인공신경망의 출력과 원하는 출력의 차이가 최소가 되도록 역전파(back propagation) 알고리즘을 사용하여 각 연결의 가중치를 최적화 하는 것을 말한다. 이러한 훈련을 거친 인공신경 망은 문제해결에 필요한 규칙이나 지식을 따로 제공하지 않아도 학습을 통해서 스스로 일반적인 규칙을 수립하 여 미지의 입력에 대해서도 타당성 있는 출력을 내주므로 화합물의 물성예측과 같이 기반 이론이 결여되어 있는 분야에 매우 유용한 수단으로 널리 이용되고 있다. 현재까지 용해지수에 대한 QSPR 예측모형은 그다지 많이 제안되어 있지 않으며 제안된 것들도 샘플 화합물의 수 가 많지 않거나 적용 대상이 특정 종류의 화합물에 제한되어 있는 단점이 있다. 문헌[James E. Code, Andrew J . Holder and J. David Eick, Direct and Indirect Quantum Mechanical QSPR Hildebrand Solubility Parameter Models, QSAR Comb. Sci. 27, 2008, No. 7, 841 849]에는 56개의 화합물에 대한 데이터를 이용하여 0.69(J/cm3)1/2의 표준오차, 0.97의 결정계수(coefficient of determination)값을 갖는 4개의 분자표현자를 사용 한 모형이 보고되어 있다."}
{"patent_id": "10-2011-0101066", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명이 이루고자 하는 기술적 과제는 보다 많은 실험데이터를 바탕으로 보다 신뢰성 있는, 수소(H), 탄소 (C), 질소(N), 산소(O), 황(S) 등 5가지 이내의 원소로 구성되고, 수소를 제외한 원자의 개수가 25개 이하인 분 자 중 액체인 순수한 유기화합물의 용해지수에 대한 QSPR 모형을 구축하는 것이다."}
{"patent_id": "10-2011-0101066", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "우리는 보다 많은 실험데이터를 바탕으로 보다 다양한 분자표현자들을 고려한 다중선형회귀-인공신경망 혼성모 형을 구축함으로써 이 목표를 달성하였다. 특히 인공신경망은 다중선형회귀모형이 반영할 수 없는 독립변수와 종속변수의 비선형적인 함수관계를 반영할 수 있다는 장점이 있어보다 높은 예측성능을 가진 모형을 구현할 수 있게 해준다. 그러나 인공신경망은 내부적으로 규칙수립의 자유도가 높아 안정성이 다중선형회귀모형보다 떨어 지는 단점이 있다. 본 발명에서는 인공신경망모형의 예측값과 다중선형회귀모형의 예측값이 큰 차이를 보일 때 다중선형회귀모형의 예측값을 채택하는 방법으로 이러한 단점을 보완하여 예측성능과 안정성의 측면에서 다중선 형회귀모형과 인공신경망모형의 장점만을 살린 우수한 예측모형을 확립하였다. 예측모형을 적용할 수 있는 유기화합물의 범위에 위에 언급한 바와 같은 제한을 두는 이유는 주로, 사용된 분자 표현자들 중 그 값을구하기 위해서는 양자역학적 계산이 필요한 것들이 존재하는 경우, 현재의 기술수준으로는 언급된 범위를 넘어서는 화합물에 대해서는 정확도와 계산시간의 측면에서 곤란한 문제가 발행한다는 사실에 기 인하고 있다. 그러나 상기의 제한범위 내라 할지라도 대단히 많은 화합물들이 존재하며 산업적으로 중요한 화합 물들이 상당부분 포함되므로 본 발명이 인류사회에 큰 유익을 끼칠 수 있을 것으로 판단된다."}
{"patent_id": "10-2011-0101066", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "오늘날 인류는 플라스틱, 섬유, 고무, 도료, 비료, 의약품, 연료 등, 방대한 종류의 유기화합물에 의존하여 살 아가고 있으며 이러한 경향은 더욱 심화될 것으로 예상된다. 미국 화학회(ACS)에 따르면 2010년 7월 기준으로 등록된 전체화합물의 수는 54,000,000개를 넘는다고 한다. 이에 비해 물성값이 한가지라도 실험적으로 알려져 있는 화합물의 수는 고작해야 수만에 지나지 않는다. 화합물의 물성값은 신물질과 신약의 개발, 화학플랜트의최적 설계, 기존 설비의 생산성 향상, 자원의 개발과 절약, 안전성 확보, 환경보호 등 인류의 보다 나은 물질생 활에 필수적인 요소이다. 특히 용해지수의 개념은 아스팔트, 원유같은 다른 복잡한 물질들 내의 분자간 관계를 표현하는데 중요한 가치를 가지며 이를 통해 실험을 통하지 않고 섞일 수 있는지에 대한용해성을 예측하기 위해 사용된다."}
{"patent_id": "10-2011-0101066", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "item": 1, "content": "도 1은 액체의 용해지수에 대한 다중선형회귀-인공신경망 혼성모형을 구축하는 과정을 흐름도로 간략히 표현한 것이다. 모형을 구축하는데 있어서 가장 먼저 해야 할 일은단계 1에 지정된 바와 같이 실험데이터를 수집하고 검토 분류 하는 일이다. 본 발명을 위해 각종 논문과 단행본, 인터넷 사이트 등을 망라하여 참고할 수 있는모든 문헌과 자 료에 대한 광범위한 조사를 벌인 결과, 총 1,658개의 본 발명의 조건에 맞는 화합물들에 대한 용해지수의 데이 터가 수집되었다. 이렇게 수집된 데이터가 모형을 구축하는데 쓰일 수 있는진정 타당한 값인지 다방면으로 검토 하였는데 데이터 표기에 오류가 있었거나 동일 화합물에 대한 값들임에도 불구하고 차이가 많이 나거나 가까운 다른 화합물들의 값에 비해 신뢰하기 어려울 정도로 동떨어진 값이거나 분자표현자들에 대한 값들이 당장 준비 되기 어려운 화합물에 대한 데이터인 경우 등에 대해 면밀한 분석을 거쳐 데이터를 수정 또는 삭제하여 최종적 으로 총 1,200개의 화합물들에 대한 데이터를 선정하였다. 본 발명에서 ‘유기화합물’또는‘화합물’은 수소 (H), 탄소(C), 질소(N), 산소(O), 황(S) 등 5가지 이내의 원소로 구성되고, 수소를 제외한 원자의 개수가 25개 이하인 분자로 이루어진 물질을 지칭한다. 그 다음 단계는 이들 화합물들에 대한 분자표현자들의 값들을 준비하는 단계이다. 총 1978개에 달하는 다양한 분자표현자들에 대한 값들을 각 화합물들의 분자에 대한정보를 담은 파일들로부터 컴퓨터를 이용하여 일괄적으 로 계산한다. 분자의 전자구조 계산을 하기 위해서는 보통 순이론인 방법으로 슈뢰딩거(Schrodinger) 방정식을 풀어 전자에너지에 대한 해를 구하게 되지만 전자가 많은 계의 경우 전자상관관계(electron correlation)를 무 시한 근사법을 적용한 하트리-포크(Hartree-Fock, HF) 방법[C.C. J. Roothan, Rev. Mod. Phys. 23, 69 (195 1)]을 사용하여 해를 풀게 된다. 이런 근사법으로 인해 계산된 결과에서 근본적인 오차가 유발되어 다차원의 이 론적인 섭동항을 추가한 포스트 하트리-포크(Post Hartree-Fock) 방법[C. Moller and M. S. Plesset, Phys. Rev. 46, 618 ]들을 사용하여 더 정확한 해를 구하긴 하지만 상대적으로 엄청나게 많은 계산량이 요구된 다. 이런 방식으로는 큰 분자를 계산하기에는 비용이나 시간의 측면에서 무리가 있는 상황이다. 또한 하트리-포크와 포스트 하트리-포크를 조합한 가우시안 방법[L. A. Curtiss, K. Raghavachari, G. W. Trucks, and J. A. Pople, J. Chem. Phys. 94, 7221 ; L. A. Curtiss, K. Raghavachari, P. C. Redfern, V. Rassolov, and J. A. Pople, J. Chem. Phys. 109, 7764 ]은 에너지 예측에 있어 아주 적은 오차를 보이지만 여러 포스트 하트리-포크 방법에 대한 에너지 계산을 수행하기 때문에 더 많은 계산량이 요구 된다. 많은 전자로 이루어진 분자에 대한 전자들간의 상관관계를 고려하기 위해 다차원의 섭동항이 추가된 파동함수 대신 전자 밀도함수를 써서 총에너지의 범함수를 이용해서 바닥상태를 구하는 밀도 범함수 이론(density functional theory)[ R. Seeger and J. A. Pople, J. Chem. Phys. 66, 3045 ]을 적용하여 계산했다. 밀 도 범함수 이론의 장점은 전자밀도만 고려하면 되므로 하트리-포크(Hartree-Fock) 방법과 비슷한 수준의 계산량 으로 더 정확한 결과를 얻어낼 수 있다. 전자들의 교환-상관에너지를 계산을 위해 교환 범함수들과 상관 범함수들의 조합을 사용하여 계산량을 늘이지 않고도 더 향상된 결과를 얻고 있다. 최적의 양자역학 계산방법을 선발하기 위해 선행하여 시도하였던 계산이론은 상기에 언급된 하트리-포크 방법, 다양한 포스트 하트리-포크 방법, 가우시안(G2, G3) 방법, 다양한 범함수 조합의 밀도 범함수 이론 등이다. 이 중에서 계산시간 대비 가장 성능이 우수한 밀도 범함수 이론의 한가지 방법을 선발하였다. 따라서 본 발명에서는 상용 양자역학 계산 프로그램을 이용하여 지정된 밀도 범함수 이론의 계산방법을 적용하 여 분자구조에 대한 최적화 및 진동수 계산을 수행하게 된다. 최적화된 구조에서는 상기의 물성정보뿐만 아니라 분자의 특성을 반영하는 여러의미있는 수치로 나타내는 분자 표현자(molecular descriptor)들을 얻을 수 있다. 2차원 구조의 특징을 표현할 수 있는 분자표현자들도 있고 3 차원 구조의 특징을 표현하는 분자표현자들도 있다. 크게 나누어 총 24개의 범주로 나누고 각 범주에 상세한 표 현자들을 포함한다. 분자 표현자 값을 계산한 후에 이들 중 적합하지 않은 것, 즉 모든 샘플 화합물에 대해 값 이 동일하게 나와 모형의 독립변수가 될 수 없는 것들을 추려 내었다. 이는 관련 없는 분자표현자가 예측모형에 포함되는 것을 막아 모형의 신뢰도를 높이는 동시에 이렇게 분자표현자의 개수를 줄임으로써 최적 모형을 찾는 데 드는 계산 시간을 줄일 수 있기 때문이다. 단계 4에서는 샘플 화합물들을 예측모형을 탐색하는데 사용할 훈련집합(training set)과 결정된 모형의 예측성 능을 시험하는데 사용할 시험집합(test set), 이렇게 두 부분으로 나누는 작업을 진행한다. 유사한 분자들이 한 쪽 부분에만 치우쳐 분포하지 않도록 주의하면서 샘플들을 5:5 ~ 8:2, 바람직하게는 6 대 4의 비율로 각각 나누 었다. 이후 훈련집합을 토대로 최선의 다중선형회귀모형(multiple linear regression model)을 찾는다. 여기서 ‘최선 ’이라 함은 상대적인 의미로서 비교적 짧은 시간 내에 구할 수 있으면서 절대적인 의미에서의 최적 해에 매우 근접한 성능을 갖는다는 의미로 쓰여진 것이다. 최적 해를 직접 구하지 않는 이유는 긴 계산시간 때문인데 예를 들어 1978개의 분자표현자들 중 적합한 분자표현자들의 개수가 1700개일 때, 이 중에서 5개를 뽑아 만들 수 있 는서로 다른 다중선형회귀모형들의 총 개수는 이며 이들을 다 조사하는 것은 현실적으로 불가능 하다. 한정된 시간 내에 유용한 결과를 얻기 위해 본 발명에서는 유전적 알고리즘(genetic algorithm) [Judson, \"Genetic Algorithms and Their Uses in Chemistry\", Reviews in Computational Chemistry, Lipkowitz & Boyd, Eds., Vol.10, pp.1-73 (VCH Publishers, NY, 1997)]을 채택하였으며 그 상세한 방법은 다음과 같다. 먼 저 분자표현자들의 풀(pool)에서 일정한 개수의 분자표현자들을 무작위로 뽑아 만든 다수의 다중선형회귀모형들 로 구성된 개체군(population)을 생성한다. 예를 들어 1700개의 적합한 분자표현자들 중 5개를 무작위로 뽑아 만든 1000개의 서로 다른 다중선형회귀모형들로 개체군을 만들었다고 하자. 이때 염색체(chromosome)라 불리는 각 개체(individual)들은 뽑힌 분자표현자들의 번호들을 조합하여 부호화한 다. 예를 들어 1700개의 분자표현자중 45, 167, 684, 1033, 1502번째의 분자표현자들로 형성한 다중선형회귀모 형의 염색체는 (45, 167, 684, 1033, 1502)와 같이 표현할 수 있다. 이렇게 생성된 개체군으로부터 두 개의 부 모 염색체를 선택한 뒤 교배(crossover)하여 자식들을 만들어 내는데 본 발명에서는 부모 염색체를 선택하는 선 택기법으로 Roulette Wheel 방법을 채택하였다. Roulette Wheel 방법은 일반적으로 가장 많이 사용하는 선택 알고리즘으로 각 염색체의 적합도(fitness)에 비례 하는 만큼 룰렛의 영역을 그 염색체에 할당한 다음, 룰렛을 돌려 해당된 영역의 염색체를 선택하는 방법이다. 따라서 이 방법에서는 적합도가 높은 개체일수록 선택될 확률이 높다. 선택확률을 결정짓는 각 염색체의 적합도 계산에는 회귀모형의 결정계수(coefficient of determination: R2) 또는 평균절대오차(average absolute error: AAE)를 활용하였다. 즉 결정계수값이 크거나 평균절대오차값이 작은 것이 선택확률이 높도록 하였다. 교배방법으로는 단순교배(single point crossover)법을 채택하였는데 이는 가장 일반적인 교배 방법으로서 부모 염색체에서 임의로 1개의 교배점을 선택하여 그 지점전후의 염색체부분을 서로 교환함으로써 자식을 생성하는 것을 말한다. 예를 들어 부모 염색체가 각각 (24, 262, 343, 789, 1290), (38, 454, 554, 1322, 1449)와 같이 주어지고 3번째와 4번째 요소 사이에 교배점이 놓이게 되면 자식 염색체는 각각 (24, 262, 343, 1322, 1449), (38, 454, 554, 789, 1290)와 같이 된다. 이렇게 자식들이 생성되면 이들의 염색체 일부를 일정 확률로 돌연변이(mutation) 시키는 과정을 거치는데 이는 임의로 몇 개의 요소를 전혀 새로운 값으로 바꾸는 것으로 현재 집단에 존재하지 않는 새로운 정보로 초기 유전 자 조합 이외의 공간을 탐색할 수 있게 해주어 초기 집합의 조합 내에 적절한 해가 없을 경우를 보완해주는 과 정이다. 이 같은 방법으로 새로이 구해진 개체들로 기존 개체군의 일부 또는 전부를 교체하여 새 세대의 개체군을 생성 한다. 이 과정을 반복하여 그 세대수가 미리 정한 값(보통 10 ~ 1000 사이에서 선택)에 이르면 가장 적합도가 큰 개체, 즉 예측성능이 가장 좋은 회귀모형을 선택하고 끝낸다. 일단 이렇게 최선의 다중선형회귀모형이 선정되면 다음 단계로 이 모형의 타당성을 검토한다. 만일 모형에 포함 된 분자표현자의 t검정값이 좋지 않다든지 하는 문제점이 발견되면 이전 단계로 돌아가 다른 모형을 찾는다. 예 를 들어 샘플 화합물의 수가 1005이고 선정된 모형이 5개의 분자표현자로 구성되어 있을 경우 그 중 한 분자표 현자에 대한 t검정값이 3.3이상이면 이는 이 분자표현자가 해당 물성과 무관할 확률이 0.1%이하임을 뜻한다. 본 발명에서는 대략 3미만의 t검정값을 갖는 분자표현자가 존재할 경우 선정된 모형을 버리고 다른 모형을 찾았다. 또한 샘플 화합물들에 대한 한 분자표현자의 값들이 소수의 몇몇 화합물들을 제외하고는 모두 동일한 경우도 신 뢰성 있는 모형이라고 볼 수 없어 마찬가지로 조처하였다. 일반적으로 모형에 포함되는 분자표현자의 개수를 늘 리면 예측성능은 높아지지만 이와 같은 문제들이 발생하게 되므로 보통 최종 모형은 이 단계들을 분자표현자의 개수를 바꿔가며 여러 번의 시행착오를 거쳐 반복 수행함으로써 얻어진다. 선정된 모형에 더 이상 문제가 나타 나지 않으면 다음 단계로 넘어간다. 그 다음인 단계 7에서는 모형을 형성하는데 참여하지 않았던 시험집합을 이용하여 찾아낸 모형의 예측성능을 평 가한다. 만일 훈련집합에서 보다 예측성능이 많이 떨어지거나 예측이 크게 벗어나는 샘플들이 보이는 등의 문제 점이 발견되면 단계 4로 가서 훈련집합과 시험집합을 재조정한 뒤 이후 단계를 진행한다. 여기서 훈련집합과 시 험집합의 차이가 훈련집합에 대해서 얻은 절대평균오차(AAE)의 20%를 넘지 않으면 예측성능이 만족되는 것으로 판단한다. 이렇게 하여 액체의 용해지수에 대한 다중선형회귀모형이 일단 확립되면 인공신경망모형을 확립하기 위해 먼저 분자표현자들의 데이터와 용해지수의 실험값 데이터를 표준화하는 작업, 즉 각 값에서 해당 데이터의 평균을 뺀 뒤 표준편차로 나누는 작업을 진행한다. 이렇게 준비된 전체 샘플을 대략 6:2:2의 비율로 훈련집합(training set), 검증집합(validation set), 시험집합(test set)으로 나눈다. 이후 이들을 사용하여 최선의 인공신경망모형을 탐색한다. 이때 탐색 범위는 도 2에서처럼 입력층과 출력층 사 이에 한 개의 은닉층을 가지면서 이 3개 층이 전방향으로(feed forward), 즉 입력에서 출력으로 향하는 방향으 로만 연결되어 있는 구조를 갖는 신경망으로 제한하였다. 입력층은 이미 확립되어 있는 다중선형회귀모형에 포 함된 각 분자표현자들의 값을 입력받는, 같은 개수만큼의 노드들로 구성하였으며 출력층은 임계부피를 출력하는 한 개의 노드로 구성하였다. 또한 은닉층의 활성화 함수로는 Sigmoid 함수 즉 f1(x)=(1+e-x)-1을, 출력층의 활성 화 함수로는 선형함수 즉 를 채택하였다. 따라서 입력층의 각 노드들이 받는 입력값들을 라 할 때 은닉층의 j번째 노드의 출력값은 와 같이 주어지며 은닉층이 개의 노드로 이루어져 있을 때 출력층 출력노드의 최종 출력값은 와 같이 주어진다. 여기서 는 문턱 가중치(threshold weight)를 의미한다. 탐색은 은닉노드의 수가 1개인 것부터 차례로 개수를 늘려가며 진행하는데 보통 입력노드 개수의 2배가 될 때까 지 진행하지만 만족스러운 모형이 나오지 않을 경우 더 진행하여 탐색한다. 자세한 절차는 다음과 같다. 먼저 은닉노드의 각 개수별로, 난수 발생 함수를 써서 생성한 가중치 들의 다양한 초기값세트(보통 1000세 트 이내)를 마련하고, 훈련집합을 사용하여 각 세트로 초기화된 신경망을 역전파 알고리즘을 통해 반복 훈련함 으로써 가중치 들의 최적화된 값을 찾는다. 최적화에 대한 판단은 매 훈련후 경신된 가중치들의 값으 로 정해지는 모형을 검증집합에 적용하였을 때 그 평균제곱오차(mean square error)의 값이 최소가 되는 것으로 한다. 보통은 3000~5000번의 반복훈련 내에 이러한 시점이 나오게 된다. 이렇게 얻어진 각 초기값세트에 대응하 는 최적화된 신경망모형을 훈련집합, 검증집합, 시험집합에 각각 적용하여 그 평균제곱오차들이 모두 다중선형 회귀모형의 그것들보다 작은 것만을 모은다. 이러한 것이 여러 개 있을 경우, 결정계수나 평균절대오차 등을 기 준으로 가장 우수한 모형을 선택한다.이렇게 인공신경망모형이 선정되면 마지막으로 과적합(overfitting) 방지기준을 설정한다. 이는 과도한 훈련의 결과로 인공신경망이 미지의 입력에 대해 엉뚱한 답을 내놓는 불안정성을 개선하기 위한 조처로, 한 기준값을 정하여 인공신경망모형과 다중선형회귀모형의 예측값들 차이의 절대값이 기준값을 넘을 경우 다중선형회귀모형 의 예측값을 채택하고 이보다 작을 경우 인공신경망모형의 값을 채택하게 하는 것을 말한다. 이 같은 과정을 거쳐 최종적으로 확립된 모형에 대한 결과는 표 2에 간략히 나와 있다. 표 2 용해지수에 대한 QSPR 예측모형의 주요 내용 샘플 화합물들의 개수 1200 분자표현자들의 개수 15 분자표현자들의 이름 P1: 모서리도 가중 모서리 인접행렬 고유값7 (Eigenvalue 07 from edge adjacency matrix weighted by edge degrees) P2: Pogliani의 지수 (Pogliani index) P3: Moran의 자기상관 차수7/원자 Sanderson 전기음성도 가중 P4: X--CH..X 기능기 수 (X--CH..X) P5: 평균 분자량 (average molecular weight) P6: 분자 프로필 차수13(molecular profile no. 13) P7: 전자회절기반 3차원 분자구조 표현-차수13/원자량 가중 (3D-MoRSE - signal 13 / weighted by atomic masses) P8: 수소결합수용체 표면적 분율(FHASA Fractional HASA (HASA/TMSA)) P9: 동경 분포 함수-14.0/원자 Sanderson 전기음성도 가중 (Radial Distribution Function - 14.0 / weighted by atomic Sanderson electronegativities) P10:298.15K포화액체밀도(Liquid density at 298.15K) P11: 위상거리1 N-N 결합의 빈도 P12: 수소결합 제공원자의 수(number of donor atoms for H-bonds (N and O)) P13: 정상끓는점에서의 기화열 (Heat of vaporization at normal boiling point) P14: 3차 성분접근지향적 가중 포괄불변분자 지수/원자 전자위상 상태 가중 P15: Ar2NH / Ar3N / Ar2N-Al / R..N..R 기능기 수 (Ar2NH / Ar3N / Ar2N-Al / R..N..R) 회귀모형 결정계수 0.958 회귀모형 AAE221.687(cal/m3)(1/2) 회귀모형 용해지수(cal/m3)(1/2)= 인공신경망 결정계수 0.97 인공신경망 AAE186.075(cal/m3)(1/2) 인공신경망모형 용해지수(cal/m3)(1/2)= 과적합 방지기준1222.21(cal/m3)(1/2) 본 발명이 기존 기술보다 우월함을 보이기 위해 이렇게 확립된 QSPR 모형과 용해지수를 구하는데 널리 사용되는 힐더브랜드가 제안한 알려진 1200개의 화합물들의 데이터를 사용하여 비교하였다. 힐더브랜드 식에 이미 알려져 있는 값 또는 QSPR 모형에 근거한 계산 방법에 의해서 구한 298K에서의 기화열(Heat of vaporization)과 액체몰 부피(liquid molar volume)을 넣어 간접적으로 액체의 용해지수를 구한다. 그 결과 힐더브랜드 수식에 의한 모 형은 0.925의 결정계수값과 235.7519(cal/m3)(1/2)의 평균절대오차값을 가짐을 알게 되었다. 반면 QSPR 모형은 0.970의 결정계수값과 186.0753(cal/m3)(1/2) 평균절대오차값을 가져 수식을 이용한 간접적인 방법보다 우수함을 알게 되었다. 도 2 및 3은 각 모형의 예측성능을 보여주는 패리티(parity) 도면들이며 이 도면들로부터 QSPR 모 형이 기존 모형보다 우수한 성능을 가짐을 눈으로 확인할 수 있다. 한편 1200개 화합물들에 대한 실험데이터 중실험오차가 알려진 것들의 평균 퍼센트 오차는 약 6%이며 이 값을 중심으로 실험값과 예측값 사이의 오차를 히 스토그램으로 그린 것이 도 4 및 5이다. 이 도면들은 힐더브랜드 수식에 의한모형은 88.91%, QSPR 모형은 94.33%의 확률로 평균 실험오차의 범위 이내로 용해지수를 예측하고 있음을 보여주어 QSPR 모형이 기존 모형보 다 정확함을 증명해준다. 본 발명은 상기한 실시예에 한정되지 아니하며, 청구범위에서 청구하는 본 발명의 요지를 벗어남이 없이 당해"}
{"patent_id": "10-2011-0101066", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "발명이 속하는 기술분야에서 통상의 지식을 가진 자라면 누구든지 다양한 변형실시가 가능한 것은 물론, 그와 같은 변경은 청구범위 기재의 범위 내에 있게 된다."}
{"patent_id": "10-2011-0101066", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명이 제공하는 용해지수에 대한 QSPR 모형을 구축하는 과정을 흐름도로 나타낸 도면이다. 도 2는 본 발명에 사용된 인공신경망의 구조를 나타낸 도면이다. 도 3는 용해지수에 대한 힐더브랜드 수식을 이용해 계산된 1200개의 실험데이터에 대한 패리티 도면이다. 도 4는 본 발명이 제공하는 용해지수에 대한 QSPR 모형의 1200개의 실험데이터에 대한 패리티 도면이다. 도 5는 힐더브랜드 수식을 이용한 모형의 1200개의 실험데이터에 대한 히스토그램 도면이다. 도 6는 QSPR 모형의 1200개의 실험데이터에 대한 히스토그램 도면이다."}
