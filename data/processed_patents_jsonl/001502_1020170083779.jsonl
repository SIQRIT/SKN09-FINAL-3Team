{"patent_id": "10-2017-0083779", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2019-0003202", "출원번호": "10-2017-0083779", "발명의 명칭": "인공지능 기반 악성코드 검출 시스템 및 방법", "출원인": "주식회사 씨티아이랩", "발명자": "조홍연"}}
{"patent_id": "10-2017-0083779", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "악성코드 바이너리 데이터(malware binary data)를 입력받는 단계,상기 입력된 악성코드 바이너리 데이터에서 메타데이터를 추출하는 단계,상기 추출된 메타데이터를 영상 데이터로 변환하는 단계, 그리고상기 변환된 영상 데이터를 입력받아 신경망부에서 악성코드를 학습하는 단계를 포함하는 인공지능 기반 악성코드 검출 방법."}
{"patent_id": "10-2017-0083779", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제 1 항에서,상기 추출된 메타데이터를 영상 데이터로 변환하는 단계는,상기 추출된 메타데이터를 그레이스케일(gray scale) 영상 데이터로 변환하는 단계를 포함하는 인공지능 기반 악성코드 검출 방법."}
{"patent_id": "10-2017-0083779", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제 2 항에서,상기 추출된 메타데이터를 영상 데이터로 변환하는 단계는,상기 추출된 메타데이터를 오디오 파일로 변환하는 단계, 그리고상기 변환된 오디오 파일을 스펙트로그램(spectrogram) 영상 데이터로 변환하는 단계를 더 포함하는 인공지능 기반 악성코드 검출 방법."}
{"patent_id": "10-2017-0083779", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제 3 항에서,상기 변환된 영상 데이터를 미리 정해진 사이즈로 조정하는 단계를 더 포함하는 인공지능 기반 악성코드 검출 방법."}
{"patent_id": "10-2017-0083779", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제 3 항에서,상기 그레이스케일 영상 데이터를 이용한 제1 신경망의 학습과 상기 스펙트로그램 영상 데이터를 이용한 제2 신경망의 학습이 개별적으로 이루어지는 인공지능 기반 악성코드 검출 방법."}
{"patent_id": "10-2017-0083779", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제 3 항에서,상기 변환된 영상 데이터에 대한 데이터 확장(data augmentation)을 수행하여 확장 영상 데이터를 생성하는 단계를 더 포함하는 인공지능 기반 악성코드 검출 방법."}
{"patent_id": "10-2017-0083779", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "공개특허 10-2019-0003202-3-제 6 항에서,상기 확장 영상 데이터를 생성하는 단계는,상기 변환된 영상 데이터에 대해 주성분분석(PCA, Principal Component Analysis)을 적용하여 악성코드 피처 공간(feature space)에서의 주성분 피처를 추출하는 단계,상기 변환된 영상 데이터에 대해 상기 피처 공간에서의 주성분 벡터를 산출하는 단계,상기 산출된 주성분 벡터 방향으로 노이즈 지터링(noise jittering)을 통해 변형된 관심 영역을 생성하는 단계,그리고상기 생성된 관심 영역을 상기 변환된 영상 데이터의 배경 영상에 융합(merging)하여 상기 확장 영상 데이터를생성하는 단계를 포함하는 인공지능 기반 악성코드 검출 방법."}
{"patent_id": "10-2017-0083779", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제 7 항에서,상기 확장 영상 데이터를 포함하여 악성코드에 대한 학습을 수행하는 인공지능 기반 악성코드 검출 방법."}
{"patent_id": "10-2017-0083779", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제 1 항에서,상기 학습된 신경망부를 통해 추출된 악성코드 바이너리 데이터의 피처를 t-SNE 알고리즘을 적용하여 시각화하는 단계를 더 포함하는 인공지능 기반 악성코드 검출 방법."}
{"patent_id": "10-2017-0083779", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제 1 항에서,상기 신경망은,컨벌루션 신경망(convolutional Neural Networks)인 인공지능 기반 악성코드 검출 방법."}
{"patent_id": "10-2017-0083779", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "악성코드 바이너리 데이터(malware binary data)를 입력받아 메타데이터를 추출하는 메타데이터 추출부,상기 추출된 메타데이터를 영상 데이터로 변환하는 데이터 변환부, 그리고상기 변환된 영상 데이터를 입력받아 악성코드를 학습하는 신경망부를 포함하는 인공지능 기반 악성코드 검출 시스템."}
{"patent_id": "10-2017-0083779", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제 11 항에서,상기 데이터 변환부는,상기 추출된 메타데이터를 그레이스케일(gray scale) 영상 데이터로 변환하는 제1 영상 생성부를 포함하는 인공지능 기반 악성코드 검출 시스템."}
{"patent_id": "10-2017-0083779", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "제 12 항에서,상기 데이터 변환부는,상기 추출된 메타데이터를 오디오 파일로 변환하는 오디오 파일 생성부, 그리고공개특허 10-2019-0003202-4-상기 변환된 오디오 파일을 스펙트로그램(spectrogram) 영상 데이터로 변환하는 제2 영상 생성부를 더 포함하는 인공지능 기반 악성코드 검출 시스템."}
{"patent_id": "10-2017-0083779", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_14", "content": "제 13 항에서,상기 변환된 영상 데이터를 미리 정해진 사이즈로 조정하는 리사이징부를 더 포함하는 인공지능 기반 악성코드 검출 시스템."}
{"patent_id": "10-2017-0083779", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_15", "content": "제 13 항에서,상기 신경망부는,상기 그레이스케일 영상 데이터를 이용하여 악성코드 학습을 수행하는 제1 신경망, 그리고상기 스펙트로그램 영상 데이터를 이용하여 악성코드 학습을 수행하는 제2 신경망을 포함하는 인공지능 기반 악성코드 검출 시스템."}
{"patent_id": "10-2017-0083779", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_16", "content": "제 13 항에서,상기 변환된 영상 데이터에 대한 데이터 확장(data augmentation)을 수행하여 확장 영상 데이터를 생성하는 데이터 확장부를 더 포함하는 인공지능 기반 악성코드 검출 시스템."}
{"patent_id": "10-2017-0083779", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_17", "content": "제 16 항에서,상기 데이터 확장부는,상기 변환된 영상 데이터에 대해 주성분분석(PCA, Principal Component Analysis)을 적용하여 악성코드 피처 공간(feature space)에서의 주성분 피처를 추출하고, 상기 변환된 영상 데이터에 대해 상기 피처 공간에서의 주성분 벡터를 산출하며, 상기 산출된 주성분 벡터 방향으로 노이즈 지터링(noise jittering)을 통해 변형된 관심영역을 생성하고, 상기 생성된 관심 영역을 상기 변환된 영상 데이터의 배경 영상에 융합(merging)하여 상기 확장 영상 데이터를 생성하는 인공지능 기반 악성코드 검출 시스템."}
{"patent_id": "10-2017-0083779", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_18", "content": "제 17 항에서,상기 신경망부는,상기 확장 영상 데이터를 포함하여 악성코드에 대한 학습을 수행하는 인공지능 기반 악성코드 검출 시스템."}
{"patent_id": "10-2017-0083779", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_19", "content": "제 11 항에서,상기 학습된 신경망부를 통해 추출된 악성코드 바이너리 데이터의 피처를 t-SNE 알고리즘을 적용하여 시각화하는 시각화부를 더 포함하는 인공지능 기반 악성코드 검출 시스템."}
{"patent_id": "10-2017-0083779", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_20", "content": "제 1 항에서,공개특허 10-2019-0003202-5-상기 신경망부는,컨벌루션 신경망(convolutional Neural Networks)인 인공지능 기반 악성코드 검출 시스템."}
{"patent_id": "10-2017-0083779", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 인공지능 기반 악성코드 검출 시스템 및 방법에 관한 것이다. 본 발명에 따른 방법은 악성코드 바이너 리 데이터(malware binary data)를 입력받는 단계, 상기 입력된 악성코드 바이너리 데이터에서 메타데이터를 추 출하는 단계, 상기 추출된 메타데이터를 영상 데이터로 변환하는 단계, 그리고 상기 변환된 영상 데이터를 입력 받아 신경망부에서 악성코드를 학습하는 단계를 포함한다. 본 발명에 의하면 악성코드 바이너리 데이터를 영상 기술을 적용하여 영상화한 후 딥러닝 기반의 영상 인식을 통해 효율적으로 인식 및 분류할 수 있다. 또한 인공지 능 검출 알고리즘 기술과 분류된 악성코드를 시각적으로 명확하게 디스플레이해줄 수 있다."}
{"patent_id": "10-2017-0083779", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 악성코드 검출 시스템 및 방법에 관한 것으로, 보다 자세하게는 악성코드 바이너리 데이터를 영상 기 술을 적용하여 영상화한 후 딥러닝 기반의 영상 인식을 통해 분류 및 인식하는 인공지능 기반 악성코드 검출 시 스템 및 방법에 관한 것이다."}
{"patent_id": "10-2017-0083779", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "악성코드(malware) 탐지 방법으로 시그니처 분석을 통해 악성코드를 탐지하는 방식이 가장 널리 사용되고 있으 나 미리 알려지지 않은 악성코드를 탐지하는 데는 한계가 있었다. 시그니처 분석의 한계를 극복하기 위해서 머신 러닝 기술을 도입하여 미리 알려지지 않은 악성코드에 대한 탐지 율을 높이려는 시도가 이루어지고 있다. 그러나 기존의 머신 러닝 기반 악성코드 탐지 기술은 축적된 데이터를 토대로 상관관계와 특성을 찾아내고 여기에 나타난 패턴을 통해 결론을 내리는 방식이라는 점에서 여전히 한계 가 있었다. 최근 들어 컴퓨터가 인간처럼 판단하고 학습할 수 있도록 하고 이를 통해 사물이나 데이터를 군집화하거나 분류 할 수 있도록 머신러닝에 인간의 뇌를 모방한 신경망 네트워크를 더한 딥러닝 알고리즘에 대한 관심 및 적용이 늘어나고 있다."}
{"patent_id": "10-2017-0083779", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "따라서 본 발명이 해결하려는 과제는 악성코드 바이너리 데이터를 영상 기술을 적용하여 영상화한 후 딥러닝 기 반의 영상 인식을 통해 분류 및 인식하는 인공지능 기반 악성코드 검출 시스템 및 방법을 제공하는 것이다."}
{"patent_id": "10-2017-0083779", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "상기한 기술적 과제를 해결하기 위한 본 발명에 따른 인공지능 기반 악성코드 검출 방법은 악성코드 바이너리 데이터(malware binary data)를 입력받는 단계, 상기 입력된 악성코드 바이너리 데이터에서 메타데이터를 추출 하는 단계, 상기 추출된 메타데이터를 영상 데이터로 변환하는 단계, 그리고 상기 변환된 영상 데이터를 입력받 아 신경망부에서 악성코드를 학습하는 단계를 포함한다. 상기 추출된 메타데이터를 영상 데이터로 변환하는 단계는, 상기 추출된 메타데이터를 그레이스케일(gray scale) 영상 데이터로 변환하는 단계를 포함할 수 있다. 상기 추출된 메타데이터를 영상 데이터로 변환하는 단계는, 상기 추출된 메타데이터를 오디오 파일로 변환하는 단계, 그리고 상기 변환된 오디오 파일을 스펙트로그램(spectrogram) 영상 데이터로 변환하는 단계를 더 포함할 수 있다. 상기 방법은, 상기 변환된 영상 데이터를 미리 정해진 사이즈로 조정하는 단계를 더 포함할 수 있다. 상기 그레이스케일 영상 데이터를 이용한 제1 신경망의 학습과 상기 스펙트로그램 영상 데이터를 이용한 제2 신 경망의 학습이 개별적으로 이루어질 수 있다. 상기 방법은, 상기 변환된 영상 데이터에 대한 데이터 확장(data augmentation)을 수행하여 확장 영상 데이터를 생성하는 단계를 더 포함할 수 있다. 상기 확장 영상 데이터를 생성하는 단계는, 상기 변환된 영상 데이터에 대해 주성분분석(PCA, Principal Component Analysis)을 적용하여 악성코드 피처 공간(feature space)에서의 주성분 피처를 추출하는 단계, 상기 변환된 영상 데이터에 대해 상기 피처 공간에서의 주성분 벡터를 산출하는 단계, 상기 산출된 주성분 벡터 방향 으로 노이즈 지터링(noise jittering)을 통해 변형된 관심 영역을 생성하는 단계, 그리고 상기 생성된 관심 영역을 상기 변환된 영상 데이터의 배경 영상에 융합(merging)하여 상기 확장 영상 데이터를 생성하는 단계를 포 함할 수 있다. 상기 확장 영상 데이터를 포함하여 악성코드에 대한 학습을 수행할 수 있다. 상기 방법은, 상기 학습된 신경망부를 통해 추출된 악성코드 바이너리 데이터의 피처를 t-SNE 알고리즘을 적용 하여 시각화하는 단계를 더 포함할 수 있다. 상기 신경망은, 컨벌루션 신경망(Convolutional Neural Networks)일 수 있다. 상기한 기술적 과제를 해결하기 위한 본 발명에 따른 인공지능 기반 악성코드 검출 시스템은, 악성코드 바이너 리 데이터(malware binary data)를 입력받아 메타데이터를 추출하는 메타데이터 추출부, 상기 추출된 메타데이 터를 영상 데이터로 변환하는 데이터 변환부, 그리고 상기 변환된 영상 데이터를 입력받아 악성코드를 학습하는 신경망부를 포함한다."}
{"patent_id": "10-2017-0083779", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명에 의하면 악성코드 바이너리 데이터를 영상 기술을 적용하여 영상화한 후 딥러닝 기반의 영상 인식을 통해 효율적으로 인식 및 분류할 수 있다. 또한 인공지능 검출 알고리즘 기술과 분류된 악성코드를 시각적으로 명확하게 디스플레이해줄 수 있다."}
{"patent_id": "10-2017-0083779", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "그러면 첨부한 도면을 참고로 하여 본 발명의 실시예에 대하여 본 발명이 속하는 기술 분야에서 통상의 지식을 가진 자가 용이하게 실시할 수 있도록 상세히 설명한다. 도 1은 본 발명의 일 실시예에 따른 인공지능 기반 악성코드 검출 시스템의 구성을 나타낸 블록도이다. 도 1을 참고하면, 본 발명에 따른 인공지능 기반 악성코드 검출 시스템은 메타데이터 추출부, 데이터 변환 부, 리사이징부, 데이터확장부, 신경망부 및 시각화부를 포함할 수 있다. 메타데이터 추출부는 학습 대상 악성코드 바이너리 데이터(malware binary data)를 입력받아 메타데이터를 추출할 수 있다. 추출되는 악성코드 메타데이터는 도 2에 예시한 것이 포함될 수 있다. 도 2는 본 발명에 따른 악성코드 메타데이터를 설명하기 위해 제공되는 도면이다. 도 2를 참고하면, 퍼스널 컴퓨팅(personal computing)의 경우, 악성코드 메타데이터는 Strings, DLL & API call, Byte-n-grams, Opcode-n-grams, PE headers fields, Network and Host activities, Image properties, Hardware features 등일 수 있다. 그리고 모바일 컴퓨터(mobile computing)의 경우, 악성코드 메타데이터는 Permissions and Intents, Strings, System calls, image properties, Network and Host activities 등일 수 있다. 데이터 변환부는 추출된 메타데이터를 영상 데이터로 변환할 수 있다. 데이터 변환부는 제1 영상 생성부, 오디오 파일 생성부, 제2 영상 생성부를 포함할 수 있 다. 제1 영상 생성부는 추출된 메타데이터를 그레이스케일(gray scale) 영상 데이터로 변환할 수 있다. 예컨대 메타데이터를 8 비트(bit)씩 처리하면, 도 3에 예시한 것과 같이 각 화소의 밝기값을 256 단계로 나타내는 그레 이스케일 영상으로 변환할 수 있다. 도 3은 본 발명에 따른 악성코드 메타데이터를 그레이스케일 영상 데이터로 변환한 예를 나타낸 것이다. 오디오 파일 생성부는 추출된 메타데이터에 오디오 헤더를 붙여서 오디오 파일로 변환할 수 있다. 구체적 으로 악성코드 바이너리 데이터나 그로부터 추출된 메타데이터를 무압축 PCM(pulse code modulation) 오디오 데 이터와 마찬가지로 취급하여, 그 앞에 wav 오디오 헤더를 붙임으로써 오디오 파일로 변환할 수 있다. 도 4는 본 발명의 일 실시예에 따른 악성코드 메타데이터를 변환한 오디오 파일의 파형을 예시한 도면이다. 제2 영상 생성부는 변환된 오디오 파일을 스펙트로그램(spectrogram) 영상 데이터로 변환할 수 있다. 스펙 트로그램은 음파의 스펙트럼을 이미지로 나타낸 것이다. 변환된 오디오 파일을 도 5에 예시한 것과 같이 멜-스 펙트로그램(mel spectrogram) 영상으로 변환할 수 있다. 도 5는 본 발명에 따른 오디오 파일로 변환된 악성코드 메타데이터를 스펙트로그램 영상으로 변환한 예를 나타 낸 것이다. 다시 도 1을 참고하면, 리사이징부는 제1 영상 생성부와 제2 영상 생성부에서 변환된 영상 데이 터를 신경망부에서 학습시키기 적합한 사이즈(예컨대 256*256 픽셀 등 미리 정해진 사이즈)로 조정할 수 있다. 실시예에 따라 제1 영상 생성부나 제2 영상 생성부에서 영상 데이터를 신경망부에서 학습 시키기 적합한 사이즈로 생성하면, 리사이징부는 필요하지 않을 수 있다. 데이터확장부는 제1 영상 생성부와 제2 영상 생성부에서 변환된 영상 데이터에 대한 데이터 확 장(data augmentation)을 수행할 수 있다. 데이터확장부는 영상 데이터에 대해 학습쌍(training pair) 데 이타 및 검증쌍(validation pair) 데이타를 확장할 수 있다. 데이터 확장은 신경망 학습에서 훈련 이미지 데이 터가 적은 경우, 이미지를 회전하거나, 픽셀 시프트(pixel shift)하는 등의 미세한 변화를 주어 훈련 데이터의 수를 늘리는 방법으로 사용되고 있다. 특히 본 발명에 따른 데이터확장부는 변환된 영상 데이터에 대해 주성분분석(PCA, Principal Component Analysis)을 적용하여 악성코드 피처 공간(feature space)에서의 주성분 피처를 추출할 수 있다. 그리고 데이터 확장부는 변환된 영상 데이터에 대해 피처 공간에서의 주성분 벡터를 산출하고, 산출된 주성분 벡터 방향 으로 노이즈 지터링(noise jittering)을 통해 변형된 관심 영역을 생성할 수 있다. 다음으로 데이터확장부(14 0)는 생성된 관심 영역을 변환된 영상 데이터의 배경 영상에 융합(merging)하는 방식으로 확장 영상 데이터를 생성할 수 있다. 신경망부는 데이터확장부에서 확장된 영상 데이터를 입력받아 악성코드를 학습할 수 있다. 이를 위해 신경망부는 영상 인식에서 우수한 성능을 가지는 인셉션 모듈(inception module) 기반 컨벌루션 신경망 (Convolutional Neural Networks, CNN)을 이용하여 악성코드를 영상 기반으로 학습할 수 있다. 물론 컨벌루션 신경망뿐만 아니라 심층 신경망(Deep Neural Network, DNN), 재귀 신경망(Recurrent Neural Network, RNN), 제 한 볼츠만 머신(restricted Boltzmann machine), 심층 신뢰 신경망(Deep Belief Network, DBN), 심층 Q-네트워 크(Deep Q-Network) 등과 같이 다양한 딥 러닝 기법이 적용된 신경망 알고리즘이 사용될 수 있다. 신경망부는 제1 신경망과 제2 신경망을 포함할 수 있다. 여기서 제1 신경망은 그레이스케 일 영상 데이터를 이용하여 악성코드를 학습할 수 있다. 그리고 제2 신경망은 스펙트로그램 영상 데이터를 이용하여 악성코드를 학습할 수 있다. 신경망부는 제1 신경망과 제2 신경망을 개별적으로 학습시킬 수 있으며, 개별적인 학습이 완료 된 후에 제1 신경망과 제2 신경망의 출력에 각각 가중치(W_1, W_2)를 다르게 적용하여 최종 출력을 산출할 수 있다. 시각화부는 학습된 신경망부를 통해 추출된 악성코드 바이너리 데이터의 피처(feature)를 가지고 t-SNE 알 고리즘을 통해 2차원 및 3차원 t-SNE 플롯(Plot)을 산출하여 시각화할 수 있다. 도 6은 본 발명에 따른 악성코드 영상 데이터를 이용하여 산출한 2차원 t-SNE 플롯을 예시한 것이고, 도 7은 악 성코드 영상 데이터를 이용하여 산출한 3차원 t-SNE 플롯을 예시한 것이다. 한편 악성코드 바이너리 데이터를 변환한 그레이스케일 영상 데이터보다는 스펙트로그램 영상 데이터에서 피처 를 추출하여 t-SNE 플롯으로 시각화하는 것이 보다 효과적이다. 도 8은 본 발명에 따른 악성코드 그레이스케일 영상 데이터를 이용하여 산출한 2차원 t-SNE 플롯을 예시한 것이 고, 도 9는 악성코드 스펙트로그램 영상 데이터를 이용하여 산출한 2차원 t-SNE 플롯을 예시한 것이다. 도 8 및 도 9는 각각 악성코드 바이너리 데이터를 변환한 영상 데이터에서 2개의 피처를 추출하여 시각화한 t- SNE 플롯이다. 물론 3차원 t-SNE 플롯은 3개의 피처를 추출하여 시각화할 수 있다. 도 8 및 도 9에서 동일한 숫 자는 동일한 클라스를 나타낸다. 인터클래스(interclass)간의 거리는 멀고 인트라클래스(intraclass)간의 거리는 가까워야 하는데, 악성코드 스 펙트로그램 영상 데이터를 이용한 경우가, 그레이스케일 영상 데이터를 이용한 것보다 더 분리 특성이 좋은 것 을 확인할 수 있었다. 한편 악성코드 그레이스케일 영상 데이터를 이용한 경우 피처가 전역에 걸쳐 퍼져 있어 시각적으로 클래스 구분 이 어려운데 반하여, 악성코드 스펙트로그램 영상 데이터를 이용한 경우는 시각적으로 명확하게 클래스 구분을 할 수 있었다. 도 10은 본 발명의 일 실시예에 따른 인공지능 기반 악성코드 검출 시스템의 동작을 설명하기 위해 제공되는 흐 름도이다. 도 1 및 도 10을 참고하면, 먼저 본 발명에 따른 인공지능 기반 악성코드 검출 시스템은 악성코드 바이너리 데 이터를 포함한 학습 데이터를 입력받아 악성코드를 분류 및 인식할 수 있도록 신경망을 학습시킬 수 있다. 이를 위해 먼저 메타데이터 추출부는 학습 대상 악성코드 바이너리 데이터(malware binary data)를 입력받 으면 메타데이터를 추출할 수 있다(S210). 다음으로 데이터 변환부는 추출된 메타데이터를 영상 데이터로 변환할 수 있다(S220). 단계(S220)에서 데이터 변환부는 추출된 메타데이터를 그레이스케일 영상 데이터로 변환할 수 있다. 또한 데이터 변환부는 추출된 메타데이터에 오디오 헤더를 붙여서 오디오 파일을 생성하고, 생성된 오디오 파일 을 스펙트로그램 영상 데이터로 변환할 수도 있다. 물론 실시예에 따라서 데이터 변환부는 추출된 메타데 이터를 그레이스케일 영상 데이터 또는 스펙트로그램 영상 데이터 중 하나로만 변환할 수도 있다. 다음으로 필요한 경우 리사이징부는 단계(S220)에서 변환된 영상 데이터를 신경망부에서 학습시키기 적합한 사이즈(예컨대 256*256 픽셀 등 미리 정해진 사이즈)로 조정할 수 있다(S230). 물론 단계(S220)에서 신 경망부에서 학습시키기 적합한 사이즈로 영상 데이터가 생성되면 단계(S230)는 생략될 수도 있다. 다음으로 데이터확장부는 변환된 영상 데이터에 대한 데이터 확장(data augmentation)을 수행할 수 있다 (S240). 도 11을 참조하여 단계(S240)를 보다 구체적으로 설명한다. 도 11은 도 10의 데이터 확장 단계를 보다 자세히 설명하기 위해 제공되는 흐름도이다. 먼저 데이터확장부는 변환된 영상 데이터에 대해 주성분분석(PCA, Principal Component Analysis)을 적용 하여 악성코드 피처 공간(feature space)에서의 주성분 피처(feature)을 추출할 수 있다(S241). 다음으로 데이터확장부는 변환된 영상 데이터에 대해 피처 공간에서의 주성분 벡터를 산출하고(S243), 산 출된 주성분 벡터 방향으로 노이즈 지터링(noise jittering)을 통해 변형된 관심 영역을 생성할 수 있다(S245). 이후 데이터확장부는 생성된 관심 영역을 변환된 영상 데이터의 배경 영상에 융합(merging)하는 방식으로 확장 영상 데이터를 생성할 수 있다(S247).다시 도 10을 참고하면, 신경망부는 데이터확장부에서 확장된 영상 데이터를 학습 데이터로 입력받아 악성코드를 학습할 수 있다(S250). 이를 위해 신경망부는 영상 인식에서 우수한 성능을 가지는 인셉션 모 듈(inception module) 기반 컨벌루션 신경망(Convolutional Neural Networks, CNN), 심층 신경망(Deep Neural Network, DNN), 재귀 신경망(Recurrent Neural Network, RNN), 제한 볼츠만 머신(restricted Boltzmann machine), 심층 신뢰 신경망(Deep Belief Network, DBN), 심층 Q-네트워크(Deep Q-Network) 등과 같이 다양한 딥 러닝 기법이 적용된 신경망 알고리즘이 사용될 수 있다. 특히 단계(S250)에서 신경망부는 제1 신경망과 제2 신경망을 각각 그레이스케일 영상 데이터와 스펙트로그램 영상 데이터에 대해서 개별적으로 학습시키는, 앙상블 학습(ensemble learning)을 수행할 수 있다. 그리고 신경망부는 개별적인 학습이 완료된 후에 제1 신경망과 제2 신경망의 출력에 각각 가중치(W_1, W_2)를 다르게 적용하여 최종 출력을 산출할 수 있다. 이후 학습된 신경망부에서 악성코드 바이너리 데이터를 검출하면(S260), 시각화부는 학습된 신경망부 를 통해 추출된 악성코드 바이너리 데이터의 피처(feature)를 가지고 t-SNE 알고리즘을 통해 2차원 및 3차원 t- SNE 플롯(Plot)을 산출하여 시각화할 수 있다(S270). 본 발명의 실시예는 다양한 컴퓨터로 구현되는 동작을 수행하기 위한 프로그램 명령을 포함하는 컴퓨터로 읽을 수 있는 매체를 포함한다. 이 매체는 앞서 설명한 인공지능 기반 악성코드 검출 방법을 실행시키기 위한 프로 그램을 기록한다. 이 매체는 프로그램 명령, 데이터 파일, 데이터 구조 등을 단독으로 또는 조합하여 포함할 수 있다. 이러한 매체의 예에는 하드디스크, 플로피디스크 및 자기 테이프와 같은 자기 매체, CD 및 DVD와 같 은 광기록 매체, 플롭티컬 디스크(floptical disk)와 자기-광 매체, 롬, 램, 플래시 메모리 등과 같은 프로그램 명령을 저장하고 수행하도록 구성된 하드웨어 장치 등이 있다. 또는 이러한 매체는 프로그램 명령, 데이터 구 조 등을 지정하는 신호를 전송하는 반송파를 포함하는 광 또는 금속선, 도파관 등의 전송 매체일 수 있다. 프 로그램 명령의 예에는 컴파일러에 의해 만들어지는 것과 같은 기계어 코드뿐만 아니라 인터프리터 등을 사용해 서 컴퓨터에 의해서 실행될 수 있는 고급 언어 코드를 포함한다. 이상에서 본 발명의 바람직한 실시예에 대하여 상세하게 설명하였지만 본 발명의 권리범위는 이에 한정되는 것 은 아니고 다음의 청구범위에서 정의하고 있는 본 발명의 기본 개념을 이용한 당업자의 여러 변형 및 개량 형태 또한 본 발명의 권리범위에 속하는 것이다.도면 도면1 도면2 도면3 도면4 도면5 도면6 도면7 도면8 도면9 도면10 도면11"}
{"patent_id": "10-2017-0083779", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 일 실시예에 따른 인공지능 기반 악성코드 검출 시스템의 구성을 나타낸 블록도이다. 도 2는 본 발명에 따른 악성코드 메타데이터를 설명하기 위해 제공되는 도면이다. 도 3은 본 발명에 따른 악성코드 메타데이터를 그레이스케일 영상 데이터로 변환한 예를 나타낸 것이다. 도 4는 본 발명의 일 실시예에 따른 악성코드 메타데이터를 변환한 오디오 파일의 파형을 예시한 도면이다. 도 5는 본 발명에 따른 오디오 파일로 변환된 악성코드 메타데이터를 스펙트로그램 영상으로 변환한 예를 나타 낸 것이다. 도 6은 본 발명에 따른 악성코드 영상 데이터를 이용하여 산출한 2차원 t-SNE 플롯을 예시한 것이다. 도 7은 악성코드 영상 데이터를 이용하여 산출한 3차원 t-SNE 플롯을 예시한 것이다. 도 8은 본 발명에 따른 악성코드 그레이스케일 영상 데이터를 이용하여 산출한 2차원 t-SNE 플롯을 예시한 것이다. 도 9는 악성코드 스펙트로그램 영상 데이터를 이용하여 산출한 2차원 t-SNE 플롯을 예시한 것이다. 도 10은 본 발명의 일 실시예에 따른 인공지능 기반 악성코드 검출 시스템의 동작을 설명하기 위해 제공되는 흐 름도이다. 도 11은 도 10의 데이터 확장 단계를 보다 자세히 설명하기 위해 제공되는 흐름도이다."}
