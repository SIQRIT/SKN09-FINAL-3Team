{"patent_id": "10-2022-0164067", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2024-0080581", "출원번호": "10-2022-0164067", "발명의 명칭": "인공 지능 기반 다상 간 ＣＴ 정합 장치 및 방법", "출원인": "숭실대학교산학협력단", "발명자": "이정진"}}
{"patent_id": "10-2022-0164067", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "동일 환자의 시간차를 두고 촬영된 간(Liver) CT 영상의 간(liver) 분할(segmentation)에 대한 초기 정합(registration)을 수행하는 초기 정합 단계; 및초기 정합된 각각의 상기 간의 분할에 대하여 인공 지능 기반 비강체 정합을 수행하는 비강체 정합 단계;를 포함하는, 인공 지능 기반 다상 간 ＣＴ 정합 방법."}
{"patent_id": "10-2022-0164067", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "청구항 1항에 있어서,상기 초기 정합 단계는,분할된 상기 간의 경계로부터 간을 포함하는 최적 경계 볼륨을 생성하는 단계로서, 상기 최적 경계 볼륨은 제1시간에서 얻어진 템플릿 볼륨(template volume), 상기 제1 시간으로부터 미리 결정된 시간이 경과한 제2 시간에서 얻어진 타겟 볼륨(target volume)을 포함하는, 상기 최적 경계 볼륨을 생성하는 단계;상기 템플릿 볼륨에서 지역적 거리 전파를 이용하여 3차원 거리맵을 생성하는 단계;상기 지역적 거리 전파의 최대 변위 내에서 상기 타겟 볼륨을 상기 템플릿 볼륨으로 회전 변환 (R) 및 병진이동변환(t) 하면서 상기 템플릿 볼륨과 상기 타겟 볼륨간의 거리 차이가 최소인 위치를 탐색하는 단계를 포함하는,인공 지능 기반 다상 간 ＣＴ 정합 방법."}
{"patent_id": "10-2022-0164067", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "청구항 2항에 있어서,상기 비강체 정합 단계는,상기 타겟 볼륨을 이동 영상(moving image)으로 하고, 상기 템플릿 볼륨을 고정 영상(fixed image)으로 하여 수행되는, 인공 지능 기반 다상 간 ＣＴ 정합 방법."}
{"patent_id": "10-2022-0164067", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "청구항 3에 있어서,상기 비강체 정합 단계는,상기 이동 영상 및 상기 고정 영상을 인공 지능기반 네트워크에 통과시켜 특징 벡터를 생성하는 단계;변위 벡터 발생기(displacement vector generator)를 이용하여 상기 특징 벡터에 대한 변위 벡터장을 생성하는단계; 리샘플러(resampler)를 이용하여 상기 변위 벡터장을 따라 상기 이동 영상에 변형을 가하여 변형 영상을 생성하는 단계;상기 고정 영상과 상기 변형 영상의 유사도를 측정하는 단계; 상기 유사도를 이용하여 상기 네트워크의 손실 함수를 생성하는 단계; 및상기 손실 함수의 특이점(outlier)을 줄이기 위해 균일화 항(regularization term)을 추가하는 단계;를 포함하는, 인공 지능 기반 다상 간 ＣＴ 정합 방법."}
{"patent_id": "10-2022-0164067", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "청구항 4에 있어서,공개특허 10-2024-0080581-3-상기 인공 지능기반 네트워크는 U-Net 기반 네트워크인 것을 특징으로 하는, 인공 지능 기반 다상 간 ＣＴ 정합방법."}
{"patent_id": "10-2022-0164067", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "동일 환자의 시간차를 두고 촬영된 간(Liver) CT 영상의 간(liver) 분할(segmentation)에 대한 초기 정합(registration)을 수행하는 초기 정합부; 및초기 정합된 각각의 상기 간의 분할에 대하여 인공 지능 기반 비강체 정합을 수행하는 비강체 정합부;를 포함하는, 인공 지능 기반 다상 간 ＣＴ 정합 장치."}
{"patent_id": "10-2022-0164067", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "청구항 6항에 있어서,상기 초기 정합부는,분할된 상기 간의 경계로부터 간을 포함하는 최적 경계 볼륨을 생성하는 경계 볼륨 생성부로서, 상기 최적 경계볼륨은 제1 시간에서 얻어진 템플릿 볼륨(template volume), 상기 제1 시간으로부터 미리 결정된 시간이 경과한제2 시간에서 얻어진 타겟 볼륨(target volume)을 포함하는, 상기 경계 볼륨 생성부;상기 템플릿 볼륨에서 지역적 거리 전파를 이용하여 3차원 거리맵을 생성하는 거리맵 생성부;상기 지역적 거리 전파의 최대 변위 내에서 상기 타겟 볼륨을 상기 템플릿 볼륨으로 회전 변환 (R) 및 병진이동변환(t) 하면서 상기 템플릿 볼륨과 상기 타겟 볼륨간의 거리 차이가 최소인 위치를 탐색하는 최소 위치탐색부;를 포함하는, 인공 지능 기반 다상 간 ＣＴ 정합 장치."}
{"patent_id": "10-2022-0164067", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "청구항 7항에 있어서,상기 비강체 정합부는,상기 타겟 볼륨을 이동 영상(moving image)으로 하고, 상기 템플릿 볼륨을 고정 영상(fixed image)으로 하여 수행되는, 인공 지능 기반 다상 간 ＣＴ 정합 장치."}
{"patent_id": "10-2022-0164067", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "청구항 8에 있어서,상기 비강체 정합부는,상기 이동 영상 및 상기 고정 영상을 입력 받아 특징 벡터를 생성하는 인공 지능기반 네트워크;상기 특징 벡터에 대한 변위 벡터장을 생성하는 변위 벡터 발생기(displacement vector generator); 상기 변위 벡터장을 따라 상기 이동 영상에 변형을 가하여 변형 영상을 생성하는 리샘플러(resampler);상기 고정 영상과 상기 변형 영상의 유사도를 측정하는 유사도 측정부; 상기 유사도를 이용하여 상기 네트워크의 손실 함수를 생성하는 손실 함수 계산부; 및상기 손실 함수의 특이점(outlier)을 줄이기 위해 균일화 항(regularization term)을 추가하는 특이점 제어부;를 포함하는, 인공 지능 기반 다상 간 ＣＴ 정합 장치."}
{"patent_id": "10-2022-0164067", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "청구항 9에 있어서,상기 인공 지능기반 네트워크는 U-Net 기반 네트워크인 것을 특징으로 하는, 인공 지능 기반 다상 간 ＣＴ 정합장치."}
{"patent_id": "10-2022-0164067", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 인공 지능 기반 다상 간 ＣＴ 정합 장치 및 방법을 제공한다. 본 발명의 일 실시예에 따른 인공 지능 기반 다상 간 ＣＴ 정합 방법은 동일 환자의 시간차를 두고 촬영된 간 (Liver) CT 영상의 간(liver) 분할(segmentation)에 대한 초기 정합(registration)을 수행하는 초기 정합 단계; 및 초기 정합된 각각의 상기 간의 분할에 대하여 인공 지능 기반 비강체 정합을 수행하는 비강체 정합 단계;를 포함한다."}
{"patent_id": "10-2022-0164067", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 간 ＣＴ 영상 정합에 관한 것으로, 보다 상세하게는 인공 지능 기반 다상 간 ＣＴ 정합 장치 및 방법 에 관한 것이다. 본 발명은 정부(과학기술정보통신부)의 재원으로 한국연구재단의 지원을 받아 수행된 연구임(No. 2020R1A2C1102727)."}
{"patent_id": "10-2022-0164067", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "의료 영상 분석을 통한 질환의 진단을 위해서 1, 3, 6, 12 개월 등의 시간차를 두고 촬영한 CT 영상에서 종양 의 변이 분석등이 수행된다. 그러나, 환자 데이터가 방대해지고, 환자의 움직임에 따른 영상 간 차이로 인해 분 석을 수작업으로 수행하는 데 어려움이 있다. 이를 해결하기 위해 간과 같은 조직의 CT 영상에서 종양의 변이 분석을 자동화하려는 방법이 연구되고 있다. CT 영상에서 효율적인 변이 분석을 위해서는 시간차를 두고 촬영된 여러 CT 영상에서 간의 정합이 요구된다. 비강체(Non-rigid) 영상 정합(Registration)은 의료 영상처리 분야에서 중요한 역할을 한다. 같은 대상을 서로 다른 위치, 각도, 시간에서 또는 다른 영상 촬영 기법(Modality)으로 촬영하였거나, 서로 다른 대상들로부터 얻 어진 상이한 영상의 쌍을 분석하기 위해서 반드시 필요한 과정이다. 과거 자동화된 방법들이 개발되기 전에는 의사들이 직접 수동으로 정합을 수행하였다. 이는 정합을 수행하는 의사의 숙련도와 컨디션에 따라 성능이 좌우 되고, 강건성을 보장할 수 없으며, 매일 얻어지는 수많은 양의 임상 데이터를 직접 처리하기에 물리적으로 어렵 다는 한계가 있다. 이러한 문제를 극복하고자 자동화된 방법들이 다양하게 연구되었다. 선행기술문헌 특허문헌 (특허문헌 0001) 등록특허공보 10-2372046 (2022.03.03)"}
{"patent_id": "10-2022-0164067", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명이 해결하고자 하는 과제는 인공 지능 기반 다상 간 ＣＴ 정합 장치 및 방법을 제공하고자 한다. 본 발명의 과제들은 이상에서 언급한 과제들로 제한되지 않으며, 언급되지 않은 또 다른 과제들은 아래의 기재 로부터 당업자에게 명확하게 이해될 수 있을 것이다."}
{"patent_id": "10-2022-0164067", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명의 일 실시예에 따른 인공 지능 기반 다상 간 ＣＴ 정합 방법은, 동일 환자의 시간차를 두고 촬영된 간(Liver) CT 영상의 간(liver) 분할(segmentation)에 대한 초기 정합 (registration)을 수행하는 초기 정합 단계; 및 초기 정합된 각각의 상기 간의 분할에 대하여 인공 지능 기반 비강체 정합을 수행하는 비강체 정합 단계;를 포 함한다. 바람직하게는, 상기 초기 정합 단계는, 분할된 상기 간의 경계로부터 간을 포함하는 최적 경계 볼륨을 생성하는 단계로서, 상기 최적 경계 볼륨은 제1 시간에서 얻어진 템플릿 볼륨(template volume), 상기 제1 시간으로부터 미리 결정된 시간이 경과한 제2 시간에 서 얻어진 타겟 볼륨(target volume)을 포함하는, 상기 최적 경계 볼륨을 생성하는 단계;상기 템플릿 볼륨에서 지역적 거리 전파를 이용하여 3차원 거리맵을 생성하는 단계; 상기 지역적 거리 전파의 최대 변위 내에서 상기 타겟 볼륨을 상기 템플릿 볼륨으로 회전 변환 (R) 및 병진이동 변환(t) 하면서 상기 템플릿 볼륨과 상기 타겟 볼륨간의 거리 차이가 최소인 위치를 탐색하는 단계를 포함한다. 바람직하게는, 상기 비강체 정합 단계는, 상기 타겟 볼륨을 이동 영상(moving image)으로 하고, 상기 템플릿 볼륨을 고정 영상(fixed image)으로 하여 수 행된다. 바람직하게는, 상기 비강체 정합 단계는, 상기 이동 영상 및 상기 고정 영상을 인공 지능기반 네트워크에 통과시켜 특징 벡터를 생성하는 단계; 변위 벡터 발생기(displacement vector generator)를 이용하여 상기 특징 벡터에 대한 변위 벡터장을 생성하는 단계; 리샘플러(resampler)를 이용하여 상기 변위 벡터장을 따라 상기 이동 영상에 변형을 가하여 변형 영상을 생성하 는 단계; 상기 고정 영상과 상기 변형 영상의 유사도를 측정하는 단계; 상기 유사도를 이용하여 상기 네트워크의 손실 함수를 생성하는 단계; 및 상기 손실 함수의 특이점(outlier)을 줄이기 위해 균일화 항(regularization term)을 추가하는 단계;를 포함한 다. 바람직하게는, 상기 인공 지능기반 네트워크는 U-Net 기반 네트워크인 것을 특징으로 한다. 발명의 일 실시예에 따른 인공 지능 기반 다상 간 ＣＴ 정합 장치는, 동일 환자의 시간차를 두고 촬영된 간(Liver) CT 영상의 간(liver) 분할(segmentation)에 대한 초기 정합 (registration)을 수행하는 초기 정합부; 및 초기 정합된 각각의 상기 간의 분할에 대하여 인공 지능 기반 비강체 정합을 수행하는 비강체 정합부;를 포함한 다. 바람직하게는, 상기 초기 정합부는, 분할된 상기 간의 경계로부터 간을 포함하는 최적 경계 볼륨을 생성하는 경계 볼륨 생성부로서, 상기 최적 경계 볼륨은 제1 시간에서 얻어진 템플릿 볼륨(template volume), 상기 제1 시간으로부터 미리 결정된 시간이 경과한 제2 시간에서 얻어진 타겟 볼륨(target volume)을 포함하는, 상기 경계 볼륨 생성부; 상기 템플릿 볼륨에서 지역적 거리 전파를 이용하여 3차원 거리맵을 생성하는 거리맵 생성부; 상기 지역적 거리 전파의 최대 변위 내에서 상기 타겟 볼륨을 상기 템플릿 볼륨으로 회전 변환 (R) 및 병진이동 변환(t) 하면서 상기 템플릿 볼륨과 상기 타겟 볼륨간의 거리 차이가 최소인 위치를 탐색하는 최소 위치 탐색부 를 포함한다.바람직하게는, 상기 비강체 정합부는, 상기 타겟 볼륨을 이동 영상(moving image)으로 하고, 상기 템플릿 볼륨을 고정 영상(fixed image)으로 하여 수 행된다. 바람직하게는, 상기 비강체 정합부는, 상기 이동 영상 및 상기 고정 영상을 입력 받아 특징 벡터를 생성하는 인공 지능기반 네트워크; 상기 특징 벡터에 대한 변위 벡터장을 생성하는 변위 벡터 발생기(displacement vector generator); 상기 변위 벡터장을 따라 상기 이동 영상에 변형을 가하여 변형 영상을 생성하는 리샘플러(resampler); 상기 고정 영상과 상기 변형 영상의 유사도를 측정하는 유사도 측정부; 상기 유사도를 이용하여 상기 네트워크의 손실 함수를 생성하는 손실 함수 계산부; 및 상기 손실 함수의 특이점(outlier)을 줄이기 위해 균일화 항(regularization term)을 추가하는 특이점 제어부; 를 포함한다. 바람직하게는, 상기 인공 지능기반 네트워크는 U-Net 기반 네트워크인 것을 특징으로 한다. 기타 실시예들의 구체적인 사항들은 상세한 설명 및 도면들에 포함되어 있다."}
{"patent_id": "10-2022-0164067", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명의 인공 지능 기반 다상 간 ＣＴ 정합 장치 및 방법은 환자의 자세 변화 등에 따른 차이로 인한 분석의 어려움을 개선할 수 있는 효과가 있다."}
{"patent_id": "10-2022-0164067", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 2, "content": "다만, 본 발명의 효과들은 이상에서 언급한 효과로 제한되지 않으며, 언급되지 않은 또 다른 효과들은 아래의 기재로부터 당업자에게 명확하게 이해될 수 있을 것이다."}
{"patent_id": "10-2022-0164067", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "본 발명의 이점 및 특징, 그리고 그것들을 달성하는 방법은 첨부되는 도면과 함께 상세하게 후술되어 있는 실시 예들을 참조하면 명확해질 것이다. 그러나 본 발명은 이하에서 개시되는 실시예들에 한정되는 것이 아니라 서로 다른 다양한 형태로 구현될 수 있으며, 단지 본 실시예들은 본 발명의 개시가 완전하도록 하고, 본 발명이 속하"}
{"patent_id": "10-2022-0164067", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "는 기술분야에서 통상의 지식을 가진 자에게 발명의 범주를 완전하게 알려주기 위해 제공되는 것이며, 본 발명 은 청구항의 범주에 의해 정의될 뿐이다. 명세서 전체에 걸쳐 동일 참조 부호는 동일 구성 요소를 지칭한다. 본 명세서에서 기술하는 실시예들은 본 발명의 이상적인 예시도인 단면도 및/또는 평면도들을 참고하여 설명될 것이다. 도면들에 있어서, 구성들의 두께는 기술적 내용의 효과적인 설명을 위해 과장된 것이다. 따라서, 도면 에서 예시된 구성들은 개략적인 속성을 가지며, 도면에서 예시된 구성들의 모양은 구성의 특정 형태를 예시하기 위한 것이며 발명의 범주를 제한하기 위한 것이 아니다. 본 명세서의 다양한 실시예들에서 제1, 제2, 제3 등의 용어가 다양한 구성요소들을 기술하기 위해서 사용되었지만, 이들 구성요소들이 이 같은 용어들에 의해서 한정 되어서는 안 된다. 이들 용어들은 단지 어느 구성요소를 다른 구성요소와 구별시키기 위해서 사용되었을 뿐이다. 여기에 설명되고 예시되는 실시예들은 그것의 상보적인 실시예들도 포함한다. 본 명세서에서 사용된 용어는 실시예들을 설명하기 위한 것이며 본 발명을 제한하고자 하는 것은 아니다. 본 명 세서에서, 단수형은 문구에서 특별히 언급하지 않는 한 복수형도 포함한다. 명세서에서 사용되는 \"포함한다 (comprises)\" 및/또는 \"포함하는(comprising)\"은 언급된 구성요소, 단계, 동작 및/또는 소자에 하나 이상의 다 른 구성요소, 단계, 동작 및/또는 소자의 존재 또는 추가를 배제하지 않는다. 다른 정의가 없다면, 본 명세서에서 사용되는 모든 용어(기술 및 과학적 용어를 포함)는 본 발명이 속하는 기술 분야에서 통상의 지식을 가진 자에게 공통적으로 이해될 수 있는 의미로 사용될 수 있을 것이다. 또 일반적으로 사용되는 사전에 정의되어 있는 용어들은 명백하게 특별히 정의되어 있지 않는 한 이상적으로 또는 과도하게 해 석되지 않는다. 이하, 도면을 참조하여, 본 발명의 개념 및 이에 따른 실시예들에 대해 상세히 설명하기로 한다. 본 발명에서 사용되는, 용어 '강체 정합(rigid registration)'은 영상 정합의 일 유형이다. 영상 정합 (image registration)은 공간좌표가 서로 다른 영상에서 연관관계를 쉽게 파악하기 위하여 동일 좌표계로 정렬하는 것으로 서로 맵핑되는 기하학적 변환을 찾는 과정이다. 영상 접합은 1) 서로 다른 센서로부터 얻어진 정보들을 통합, 2) 서로 다른 시간에 얻어진 동일한 영역을 촬영한 영상에서 변화 감지, 3) 움직이는 객체를 촬영한 일련의 영상으로부터 3차원 정보를 추론, 및 4) 모델-기반의 객체 인식등에 사용된다. 영상 정합은 강체 정합과 비강제 정합을 포함한다. 강체 정합에는 표식 기반 정합, 표면기반 정합 및 복셀 기반 정합이 있다. 비강체 정합에는 스플라인 정합, 탄성 정합, 유체 정합 및 광학 흐름 정합이 있다. 도 1은 본 발명의 일 실시예에 따른 인공 지능 기반 다상 간(liver) ＣＴ 정합 방법의 흐름도를 보여주는 도면 이다. 인공 지능 기반 다상 간(liver) ＣＴ 정합 방법은 초기 정합 단계(S110) 및 비강체 정합 단계(S130)를 포함한다. 초기 정합 단계(S110)는 동일 환자의 시간차를 두고 촬영된 간(Liver) CT 영상의 간(liver) 분할 (segmentation)에 대한 초기 정합(registration)을 수행한다. 비강체 정합 단계(S130)는 초기 정합된 각각의 간의 분할에 대하여 인공 지능 기반 비강체 정합을 수행한다. 도 2는 본 발명의 일 실시예에 따른 인공 지능 기반 다상 간 ＣＴ 정합 장치 및 방법에서의 초기 정합 단계의 최적 경계 볼륨을 도시한 도면이다. 초기 정합 단계(S110)는 전역적인 차이 보정을 위한 단계이다. 동일 환자의 시간차를 두고 촬영된 간(liver) CT 영상 (pre-contrast, arterial, portal phase)들은 조영 정도 에 따라 종양이나 혈관 같은 다양한 정보를 얻을 수 있지만, 환자의 자세나 호흡 등에 따라 형태의 차이가 발생 할 수 있다. 이를 활용하기 위해서 우선, 초기정합을 통하여 전역적인 차이 보정이 필요하다. 본 발명에선 최적 경계 볼륨과 거리맵 생성 기술을 이용하여 전역적인 차이 보정을 수행한다. 초기 정합 단계(S110)에서는 우선 각각의 간(Liver) CT 영상에 대하여 간 영역 분할을 수행한다. 초기 정합 단계(S110)는 경계 볼륨 생성 단계, 거리맵 생성 단계, 및 거리 차이 최소 위치 탐색 단계를 포함한 다. 경계 볼륨 생성 단계는 경계 볼륨 생성부(도 7의 711)를 이용하여 분할된 간의 경계로부터 간을 포함하는 최적 경계 볼륨을 생성한다. 최적 경계 볼륨은 제1 시간(t=T1)에서 얻어진 템플릿 볼륨(template volume) 및 제1 시 간으로부터 미리 결정된 시간이 경과한 제2 시간(t=T1+dt)에서 얻어진 타겟 볼륨(target volume)을 포함한다. 거리맵 생성 단계는 템플릿 볼륨에서 지역적 거리 전파를 이용하여 3차원 거리맵을 생성한다. 거리 차이 최소 위치 탐색 단계는 지역적 거리 전파의 최대 변위 내에서 타겟 볼륨을 템플릿 볼륨으로 회전 변 환 (R) 및 병진이동 변환(t) 하면서 템플릿 볼륨과 상기 타겟 볼륨간의 거리 차이가 최소인 위치를 탐색한다. 초기 정합시 수행 시간을 효과적으로 단축하기 위해 최적 경계 볼륨을 이용한 초기 정합을 수행한다. 이를 위하여 템플릿 볼륨과 타겟 볼륨으로부터 추출된 간 경계로부터 이진 볼륨 데이터를 생성한다. 이때 간 경 계는 1로 그 외의 부분은 0으로 값을 할당한다. 이렇게 생성된 두 개의 이진 볼륨 데이터에서 간 경계에 해당하 는 점을을 방문하면서 점의 x,y,z 축 최소, 최대값인 xmin, ymin, zmin, xmax, ymax, zmax를 구하고, (xmin, ymin, zmi n)과 (xmax, ymax, zmax)를 꼭지점으로 하는 경계 볼륨을 생성한다. 정합 과정에서의 기하학적 변환을 고려하여 (xmin-d, ymin-d,, zmin-d,)과 (xmax+d, ymax+d, zmax+d)를 꼭지점으로 하는 최적 경계 볼륨을 도 2와 같이 생성한다. 도 2와 같이 최적 경계 볼륨을 생성하고 두 영상의 최적 경계 볼륨을 일치시켜 이동변수 t에 대한 초기 추정치 를 획득한다. 도 3은 본 발명의 일 실시예에 따른 인공 지능 기반 다상 간 ＣＴ 정합 장치 및 방법에서의 초기 정합 단계의 거리 맵을 보여주는 도면이다. 거리맵 생성 단계는 템플릿 볼륨에서 지역적 거리 전파를 이용하여 3차원 거리맵을 생성한다. 거리 차이 최소 위치 탐색 단계는 지역적 거리 전파의 최대 변위 내에서 타겟 볼륨을 템플릿 볼륨으로 회전 변 환 (R) 및 병진이동 변환(t) 하면서 템플릿 볼륨과 상기 타겟 볼륨간의 거리 차이가 최소인 위치를 탐색한다. 두 영상(템플릿 볼륨과 타겟 볼륨)의 유사도를 비교하여 거리 차이가 최소인 위치를 찾기 위하여 AADD(Average of Absolute Distance Difference)를 사용하며, 를 최소로 만드는 회전변환 R과 이동 변환 t를 계산하 여 전역적인 차이를 보정한다. (수식 1) 여기서, 은 타겟 볼륨의 복셀수이고, 은 타겟 볼륨의 i번째 복셀이고, 은 템플릿 볼륨과 타겟 볼륨의 i번째 복셀과의 최단거리이다. (수식 2) 여기서, 은 회전 행렬이고, 는 이동 행렬이고, 은 템플릿 볼륨의 복셀수이고, 은 타겟 볼륨 의 복셀수이고, 은 템플릿 볼륨의 i번째 복셀이고, 은 타겟 볼륨의 j번째 복셀이고, 은 회전행렬R, 이동행렬T를 이용하여 변환된 타겟 볼륨의 j번째 복셀이고, 은 템플렛 볼륨의 i번째 복셀과 변환된 타겟 볼륨 j번째 복셀과의 거리이다. 도 4는 본 발명의 일 실시예에 따른 인공 지능 기반 다상 간 ＣＴ 정합 장치 및 방법에서의 비강체 정합 단계의 개략적으로 흐름도를 도식화한 도면이다. 본 발명은 초기 정합 이후에 지역적인 변형을 고려하기 위한 인공지능 기반 비강체 정합 단계를 수행한다. 본 발명의 비강체 정합 단계는 딥러닝 네트워크를 이용하여 수행된다. 비강체 정합 단계(S130)는 타겟 볼륨을 이동 영상(moving image)으로 하고, 템플릿 볼륨을 고정 영상 (fixed image)으로 하여 수행된다. 인공 지능기반 네트워크는 이동 영상 및 고정 영상을 입력 받아 특징 벡터를 생성한다. 변위 벡터 발생기(displacement vector generator)는 특징 벡터에 대한 변위 벡터장을 생성한 다. 리샘플러(resampler)는 변위 벡터장을 따라 이동 영상에 변형을 가하여 변형 영상을 생성 한다. 유사도 측정부는 고정 영상과 변형 영상의 유사도를 측정한다. 손실 함수 계산부는 유사도를 이용하여 네트워크의 손실 함수를 생성한다. 특이점 제어부는 손실 함수의 특이점(outlier)을 줄이기 위해 균일화 항(regularization term)을 추가한다. 고정 영상과 변형(deformation) 영상의 유사도를 측정하고 유사도를 바탕으로 만들어진 네트워크의 손실함수 L 의 값을 줄이는 변위 벡터장을 찾는 방향으로 네트워크를 학습시킨다(수식 3). (수식 3) 여기서, 은 템플릿 볼륨이고, 은 변형된 타겟 영상이고, 은 템플릿 볼륨과 변형된 타겟 영상사이의 손실함수 L이 최소가 되는 값 이다. 도 5는 본 발명의 일 실시예에 따른 인공 지능 기반 다상 간 ＣＴ 정합 장치 및 방법에서의 초기 정합 단계의 비강체 정합 단계의 인공 지능기반 네트워크인, U-Net 기반 네트워크를 도시한 도면이다. 비강체 정합 단계는 공간 변환 파라미터를 예측할 수 있도록 도 5와 같이 Localization Network를 구성한다. 높은 해상도의 특징 벡터를 추출하기 위하여 전역적인 특징 벡터만을 고려하지 않고, 지역적인 특징 벡터를 함 께 고려하는 U-Net 기반 네트워크를 사용한다. 네트워크의 학습은 영상과 정답 데이터를 입력 받아 학습하는 지도 학습(supervised learning)을 많이 사용 하 지만, 본 발명에서 사용하는 다상(Multi-phase) 간(Liver) CT는 정답 데이터 생성에 많은 시간이 소요된다. 따라서 네트워크의 비용 함수 L의 값을 줄이는 변위 벡터장을 찾는 방향으로 학습하는 비지도 학습 (unsupervised learning)을 수행한다. 네트워크는 학습 기반의 의료 영상처리 분야에서 좋은 성능을 보이는 U-Net의 형태를 사용한다. U-Net은 인코더 역할을 하는 수축 경로(contracting path)와 디코더 역할의 확장 경로(expansion path)로 이루어져 있다. 인코더의 각 층에서 추출한 지역적 특징 벡터를 대응하는 디코더의 각 층에 전달하여 해당 층에서의 전역적 특 징 벡터와 concatenate 연산을 수행하는 skip connection을 적용한다. 이를 통해 디코더에서 단순히 전역 적 특징 벡터만을 복원하는 것이 아닌 지역적 정보를 함께 나타낼 수 있는 높은 해상도의 특징 벡터를 추출할 수 있다. 네트워크의 마지막 층은 입력 영상과 같은 크기를 갖는 3채널의 특징 벡터를 추출하도록 구성한다. 수축 경로(Contracting path)는 3×3×3 크기의 1 stride를 갖는 3차원 컨볼루션(Convolution)을 적용한 다. 배치 정규화(Batch normalization)와 ReLU 활성화 함수를 사용하였고, 2×2×2 맥스 풀링(Max Pooling) 연산을 통해 특징 벡터의 크기를 각 방향에서 반으로 줄인다. 다음 층에서는 이전 층에서 사용한 컨볼루션 커널 수의 2배 만큼의 컨볼루션 커널을 사용한다. 확장 경로(Expansion path)에서는 2×2×2 크기의 전치 컨볼루션(Transposed Convolution)연산을 통해 특 징 벡터의 크기를 각 방향으로 2배씩 증가시킨다. 이 때, 수축 경로(contracting path)에서 대응하는 동일한 크 기의 특징 벡터와 concatenate 연산을 통해 U-Net의 skip connection을 수행한다. 맥스 풀링 연산에서와는 반대 로 전치 컨볼루션 연산 후에는 컨볼루션 커널의 개수를 반으로 줄인다. 영상 변형 과정은 변위 벡터장 발생기(DVF generator)와 리샘플러의 두 단계로 구성된다. 변위 벡터 장 발생기는 네트워크의 출력인 3채널의 특징 벡터를 동일한 채널의 변위 벡터장으로 만드는 역할을 한다. 변위 벡터장은 각 방향으로 정렬된 그리드 좌표 3차원 영상 3개를 각 특징 벡터 영상과 합 연산을 통해 구한다. 변위 벡터장은 3차원 이동(moving) 영상의 각 복셀의 밝기 값이 결과 영상의 어떤 좌표로 이동하는지 에 대한 정보를 담고 있다. 리샘플러는 앞서 구한 변위 벡터장에 따라 이동 영상에 3차원 선형 보간 법을 적용하여 변형된 영상(deformation image)을 생성한다. 변위 벡터장(DVF)은 이동 영상의 각 복셀(Voxel) 값이 결과 영상의 어떤 좌표로 이동하는지에 대한 정보를 나타낸다. Localization network에서 도출된 공간 변환 파라미터에 따라서 입력 특징 맵 상에서 샘 플링할 포인트를 정해주는 샘플링 그리드(sampling grid)를 계산하여 변위 벡터장을 생성하고, 이에 따라 3차원 선형 보간법을 적용하여 변형(deformation)을 수행한다. 결과로 만들어진 변형 영상은 고정 영상과 유사도 측정을 통해 비교를 수행한다. 이러한 유사도 측정은 네트워크의 손실함수를 만드는데 사용한다. 비학습 기반 영상 정합에서 영상 간의 유사도는 Mean Squared Error(MSE), Normalized Cross Correlation(NCC), Mutual Information(MI) 등의 방법을 사용하는데 본 발명에서는 NCC(수식 4)를 사용하였다. (수식 4) pi는 i번째 픽셀을, N은 픽셀의 총 개수를 의미한다. 은 영상의 평균값을, σ는 표준편차를 나타낸다. NCC는 두 영상이 유사할 경우 1에 가까운 값을, 상이할 경우 0에 가까운 값을 갖는 특징이 있다. 리샘플러로 3차원 선형 보간법 만을 사용할 경우 실제 간과 유사하지 않은 결과를 얻게 된다. 이는 영상 변형 과정에서 3차원 영상의 각 복셀 마다 변화할 수 있는 크기 및 방향이 각자 자유롭기 때문이다. 이러한 자 유도는 단순히 손실함수가 작아지는 방향으로만 학습하다 보면, 후에 네트워크로부터 특이점이 존재하는 특징 벡터가 추출되는 원인이 된다. 실제 간과 유사한 결과를 얻기 위해서는 이러한 특이점을 제거하여 이동 영상 의 특성을 유지하면서 고정 영상과 유사한 형태의 결과를 만들 수 있는 특징 벡터를 추출해야 한다.본 발명에서는 손실 함수에 특이점들을 제어할 수 있는 균일화 항(Regularization Term)을 추가한다. 이 방법은 3차원 선형 보간법을 그대로 사용하여 전체 자유도는 보장하는 반면, 소량의 계산량 증가만으로도 특이점들의 크기를 제어하여 실제 간과 유사한 결과를 얻을 수 있다. 균일화 항은 최적화 과정에서 특징 벡터의 자유도 자체는 그대로 두고 특이점들의 크기를 제한한다. 이를 통해 간의 구조적인 경계가 아닌 곳의 특징 벡터를 주변과 유사한 값을 갖도록 만드는 역할을 한다. 이때, 특징점(outlier)를 제어하기 위하여 균일화 항(regularization term)을 추가한다. 3차원 선형 보간법만을 이용하여 샘플링할 경우, 영상 변형 과정에서 각 복셀 마다 변화할 수 있는 크기 및 방향이 자유롭기 때문에 특 징점(outlier)로 인한 에러가 발생할 수 있다. 본 발명에선 특징 벡터의 자유도는 유지하고, 특이점의 크기를 제한하여 변형을 수행한다. 도 6은 본 발명의 일 실시예에 따른 인공 지능 기반 다상 간 ＣＴ 정합 장치 및 방법을 이용한 정합 결과를 보 여주는 도면이다. 도 6(a)는 고정 영상을 도시한다. 도 6(b)는 이동 영상을 도시한다. 도 6(c)는 변위 벡터장을 도시한다. 도 6(d)는 정합된 결과를 도시한다. 도 7은 본 발명의 일 실시예에 따른 인공 지능 기반 다상 간 ＣＴ 정합 장치의 개략적인 구성을 보여주는 도면 이다. 인공 지능 기반 다상 간 ＣＴ 정합 장치는 초기 정합부 및 비강체 정합부을 포함한다. 초기 정합부는 동일 환자의 시간차를 두고 촬영된 간(Liver) CT 영상의 간(liver) 분할(segmentation)에 대한 초기 정합(registration)을 수행한다. 비강체 정합부는 초기 정합된 각각의 간의 분할에 대하여 인공 지능 기반 비강체 정합을 수행한다. 초기 정합부는 경계 볼륨 생성부, 거리맵 생성부 및 최소 위치 탐색부를 포함한다. 경계 볼륨 생성부는 분할된 상기 간의 경계로부터 간을 포함하는 최적 경계 볼륨을 생성한다. 최적 경계 볼륨은 제1 시간에서 얻어진 템플릿 볼륨(template volume), 제1 시간으로부터 미리 결정된 시간이 경과한 제2 시간에서 얻어진 타겟 볼륨(target volume)을 포함한다. 거리맵 생성부는 템플릿 볼륨에서 지역적 거리 전파를 이용하여 3차원 거리맵을 생성한다. 최소 위치 탐색부는 지역적 거리 전파의 최대 변위 내에서 타겟 볼륨을 상기 템플릿 볼륨으로 회전 변환 (R) 및 병진이동 변환(t) 하면서 템플릿 볼륨과 타겟 볼륨간의 거리 차이가 최소인 위치를 탐색한다. 비강체 정합부는 타겟 볼륨을 이동 영상(moving image)으로 하고, 템플릿 볼륨을 고정 영상(fixed image) 으로 하여 수행된다. 비강체 정합부(도 7의 730)는 인공 지능기반 네트워크, 변위 벡터 발생기(displacement vector generator), 리샘플러(resampler), 유사도 측정부, 손실 함수 계산부,및 특이점 제어부 를 포함한다. 인공 지능기반 네트워크는 이동 영상 및 고정 영상을 입력 받아 특징 벡터를 생성한다. 변위 벡터 발생기는 특징 벡터에 대한 변위 벡터장을 생성한다. 리샘플러(resampler)는 변위 벡터장을 따라 이동 영상에 변형을 가하여 변형 영상을 생성한다. 유사도 측정부는 고정 영상과 변형 영상의 유사도를 측정한다. 손실 함수 계산부는 유사도를 이용하여 네트워크의 손실 함수를 생성한다. 특이점 제어부는 손실 함수의 특이점(outlier)을 줄이기 위해 균일화 항(regularization term)을 추가한다.인공 지능기반 네트워크는 U-Net 기반 네트워크인 것을 특징으로 한다. 도 8은 본 발명의 다양한 실시예에 따른 장치 및/또는 시스템을 구현할 수 있는 예시적인 컴퓨팅 장치를 도시한 도면이다. 도 8을 참조하여 본 개시의 몇몇 실시예에 따른 장치들을 구현할 수 있는 예시적인 컴퓨팅 장치를 보다 구 체적으로 설명하기로 한다. 컴퓨팅 장치는 하나 이상의 프로세서, 버스, 통신 인터페이스, 프로세서에 의하여 수 행되는 컴퓨터 프로그램을 로드(load)하는 메모리와, 컴퓨터 프로그램을 저장하는 스토리지 를 포함할 수 있다. 다만, 도 8에는 본 개시의 실시예와 관련 있는 구성 요소들 만이 도시되어 있다."}
{"patent_id": "10-2022-0164067", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "따라서, 본 개시가 속한 기술분야의 통상의 기술자라면 도 8에 도시된 구성 요소들 외에 다른 범용적인 구성 요 소들이 더 포함될 수 있음을 알 수 있다. 프로세서는 컴퓨팅 장치의 각 구성의 전반적인 동작을 제어한다. 프로세서는 CPU(Central Processing Unit), MPU(Micro Processor Unit), MCU(Micro Controller Unit), GPU(Graphic Processing Unit) 또는 본 개시의 기술 분야에 잘 알려진 임의의 형태의 프로세서를 포함하여 구성될 수 있다. 또한, 프로세서 는 본 개시의 실시예들에 따른 방법을 실행하기 위한 적어도 하나의 애플리케이션 또는 프로그램에 대한 연산을 수행할 수 있다. 컴퓨팅 장치는 하나 이상의 프로세서를 구비할 수 있다. 메모리는 각종 데이터, 명령 및/또는 정보를 저장한다. 메모리는 본 개시의 실시예들에 따른 방법을 실행하기 위하여 스토리지로부터 하나 이상의 프로그램을 로드할 수 있다. 메모리는 RAM과 같은 휘발성 메모리로 구현될 수 있을 것이나, 본 개시의 기술적 범위가 이에 한정되는 것은 아니다. 버스는 컴퓨팅 장치의 구성 요소 간 통신 기능을 제공한다. 버스는 주소 버스(Address Bus), 데 이터 버스(Data Bus) 및 제어 버스(Control Bus) 등 다양한 형태의 버스로 구현될 수 있다. 통신 인터페이스는 컴퓨팅 장치의 유무선 인터넷 통신을 지원한다. 또한, 통신 인터페이스는 인 터넷 통신 외의 다양한 통신 방식을 지원할 수도 있다. 이를 위해, 통신 인터페이스는 본 개시의 기술 분 야에 잘 알려진 통신 모듈을 포함하여 구성될 수 있다. 몇몇 실시예들에 따르면, 통신 인터페이스는 생략될 수도 있다. 스토리지는 상기 하나 이상의 프로그램과 각종 데이터를 비임시적으로 저장할 수 있다. 스토리지는 ROM(Read Only Memory), EPROM(Erasable Programmable ROM), EEPROM(Electrically Erasable Programmable ROM), 플래시 메모리 등과 같은 비휘발성 메모리, 하드 디스크, 착탈형 디스크, 또는 본 개시가 속하는 기술 분야에서 잘 알려진 임의의 형태의 컴퓨터로 읽을 수 있는 기록 매체를 포함하여 구성될 수 있다. 컴퓨터 프로그램은 메모리에 로드 될 때 프로세서로 하여금 본 개시의 다양한 실시예에 따른 방 법/동작을 수행하도록 하는 하나 이상의 인스트럭션들을 포함할 수 있다. 즉, 프로세서는 상기 하나 이상 의 인스트럭션들을 실행함으로써, 본 개시의 다양한 실시예에 따른 방법/동작들을 수행할 수 있다. 이상에서는 본 발명의 바람직한 실시예에 대하여 도시하고 설명하였지만, 본 발명은 상술한 특정의 실시예에 한"}
{"patent_id": "10-2022-0164067", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "정되지 아니하며, 특허청구범위에서 청구하는 본 발명의 요지를 벗어남이 없이 당해 발명이 속하는 기술분야에 서 통상의 지식을 가진 자에 의해 다양한 변형실시가 가능한 것은 물론이고, 이러한 변형실시들은 본 발명의 기 술적 사상이나 전망으로부터 개별적으로 이해되어서는 안될 것이다.도면 도면1 도면2 도면3 도면4 도면5 도면6a 도면6b 도면6c 도면6d 도면7 도면8"}
{"patent_id": "10-2022-0164067", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 일 실시예에 따른 인공 지능 기반 다상 간(liver) ＣＴ 정합 방법의 흐름도를 보여주는 도면 이다. 도 2는 본 발명의 일 실시예에 따른 인공 지능 기반 다상 간 ＣＴ 정합 장치 및 방법에서의 초기 정합 단계의 최적 경계 볼륨을 도시한 도면이다. 도 3은 본 발명의 일 실시예에 따른 인공 지능 기반 다상 간 ＣＴ 정합 장치 및 방법에서의 초기 정합 단계의 거리 맵을 보여주는 도면이다. 도 4는 본 발명의 일 실시예에 따른 인공 지능 기반 다상 간 ＣＴ 정합 장치 및 방법에서의 비강체 정합 단계의 개략적으로 흐름도를 도식화한 도면이다. 도 5는 본 발명의 일 실시예에 따른 인공 지능 기반 다상 간 ＣＴ 정합 장치 및 방법에서의 초기 정합 단계의 비강체 정합 단계의 인공 지능기반 네트워크인, U-Net 기반 네트워크를 도시한 도면이다. 도 6은 본 발명의 일 실시예에 따른 인공 지능 기반 다상 간 ＣＴ 정합 장치 및 방법을 이용한 정합 결과를 보 여주는 도면이다. 도 7은 본 발명의 일 실시예에 따른 인공 지능 기반 다상 간 ＣＴ 정합 장치의 개략적인 구성을 보여주는 도면이다. 도 8은 본 발명의 다양한 실시예에 따른 장치 및/또는 시스템을 구현할 수 있는 예시적인 컴퓨팅 장치를 도시한 도면이다."}
