{"patent_id": "10-2023-0059839", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2024-0162797", "출원번호": "10-2023-0059839", "발명의 명칭": "위협헌팅 기반 클라우드 침해사고 탐지 및 대응 시스템 및 그 방법", "출원인": "한전케이디엔주식회사", "발명자": "최우현"}}
{"patent_id": "10-2023-0059839", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "PC 또는 서버에 상당하는 자산으로 구성된 클라우드;상기 크라우드와 연결되어 상기 자산의 정보를 수신하는 수집모듈;상기 수집모듈로부터 전달받은 수집한 자산 정보와 정상범위에 해당하는 AI 학습 결과값을 비교하여 사이버 공격으로 인해 발생한 침해사고를 탐지하는 침해사고 탐지서버; 및상기 침해사고 탐지서버로부터 상기 자산에 발생한 침해사고 탐지 정보를 전달받은 경우 사이버 공격에 대응하는 관제센터 서버;를 포함하는 것을 특징으로 하는 위협헌팅 기반 클라우드 침해사고 탐지 및 대응 시스템."}
{"patent_id": "10-2023-0059839", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제 1항에 있어서,상기 수집모듈은 자산들이 구축되어 있는 클라우드 네트워크 입구에 설치된 패킷 수집기를 통해 패킷 데이터를 수집하는 패킷 수집탭;자산들의 운영체제에서 로그 관리 프로그램을 통해 로그 정보를 수집하는 로그 수집기; 및 자산들의 운영체제에서 기본적으로 수집하는 프로그램을 통해 리소스 정보를 수집하는 리소스 수집기;를 포함하는 것을 특징으로 하는 위협헌팅 기반 클라우드 침해사고 탐지 및 대응 시스템."}
{"patent_id": "10-2023-0059839", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제 2항에 있어서,상기 패킷 수집탭이 수집하는 파라미터는 상기 자산의 통신에 사용되는 프로토콜로 네트워크 주소에 해당되는 아이피;상기 자산의 통신에 사용되는 포트; 및상기 자산의 네트워크 통신량에 해당되는 트래픽;을 포함하는 것을 특징으로 하는 위협헌팅 기반 클라우드 침해사고 탐지 및 대응 시스템."}
{"patent_id": "10-2023-0059839", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제 3항에 있어서,상기 침해사고 탐지서버는상기 자산이 평소와 다른 상기 아이피와 통신시, 상기 자산이 평소 사용하지 않는 포트 사용시, 또는 상기 자산의 트랙픽이 평소와 상이하게 갑자기 증가시에 상기 사이버 공격으로 인해 발생한 침해사고로 탐지하는 것을 특징으로 하는 위협헌팅 기반 클라우드 침해사고 탐지 및 대응 시스템."}
{"patent_id": "10-2023-0059839", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "공개특허 10-2024-0162797-3-제 2항에 있어서,상기 침해사고 탐지서버는 상기 리소스 수집기가 상기 자산의 씨피유 사용량과 메모리 사용량을 파라미터로 수집하면, 상기 씨피유 사용량이 갑자기 증가하거나, 또는 메모리 사용량이 갑자기 증가하는 경우 상기 사이버 공격으로 인해 발생한 침해사고로 탐지하는 것을 특징으로 하는 위협헌팅 기반 클라우드 침해사고 탐지 및 대응 시스템."}
{"patent_id": "10-2023-0059839", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제 1항 내지 제 5항 중, 어느 한 항에 있어서,상기 클라우드, 수집모듈, 침해사고 탐지서버, 및 관제센터 서버간 전송 데이터 형식은 16진수인 것을 특징으로하는 위협헌팅 기반 클라우드 침해사고 탐지 및 대응 시스템."}
{"patent_id": "10-2023-0059839", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명에 따른 위협헌팅 기반 클라우드 침해사고 탐지 및 대응 시스템은 PC 또는 서버에 상당하는 자산으로 구 성된 클라우드; 상기 크라우스와 연결되어 상기 자산의 정보를 수신하는 수집모듈; 상기 수집모듈로부터 전달받 은 수집한 자산 정보와 정상범위에 해당하는 AI 학습 결과값을 비교하여 사이버 공격으로 인해 발생한 침해사고 를 탐지하는 침해사고 탐지서버; 및 상기 침해사고 탐지서버로부터 상기 자산에 발생한 침해사고 탐지 정보를 전 달받은 경우 사이버 공격에 대응하는 관제센터 서버;를 포함하여 숨어있어 드러나지 않은 사이버공격 선대응 가 능하여 재산상 피해를 방지할 수 있는 효과가 있다."}
{"patent_id": "10-2023-0059839", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 위협헌팅 기반 클라우드 침해사고 탐지 및 대응 시스템 및 그 방법에 관한 것으로써, 더욱 상세하게 는 클라우드가 사이버공격을 당했으나 피해가 표면적으로 드러나지 않아 관리자가 인지하지 못하는 경우, 공격 에 대응하지 못했던 기존 방법의 한계를 보완하는 것으로 클라우드 자산을 모니터링하여 침해사고 대응을 용이 하게 해주는 위협헌팅 기반 클라우드 침해사고 탐지 및 대응 방법에 관한 것이다."}
{"patent_id": "10-2023-0059839", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "종래 조직에서 구축하여 사용 중인 IPS, DIS 등과 같은 보안솔루션은 알려진 공격만 인식이 가능하기 때문에, 알려지지 않은 공격(zero-day, 변종)에 대해선 인식할 방법이 없어 대응할 방법 미비하다는 문제점이 있다. 특히, 널리 사용 중인 종래 보안솔루션들은 알려지지 않은 공격의 경우 이를 탐지할 수 없어 공격이 성공하여 시스템에 잠입하고 있을 때, 피해가 표면적으로 들어나 사용자 또는 시스템 관리자가 인지하지 못하는 경우에 공격을 인식할 방법이 없어 대응할 방법이 미비하다는 문제점이 있다. 선행기술문헌 특허문헌 (특허문헌 0001) 대한민국 등록특허 제10-1788410호 (2017.10.13)"}
{"patent_id": "10-2023-0059839", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "상술한 문제점을 해결하기 위해 본 발명은 클라우드의 자산으로부터 패킷 수집탭, 로그 수집기, 및 리소스 수집 기를 통해 아이피(IP), 포트(PORT), 트래픽, 이벤트 ID, CPU 사용량 또는 메모리(MEMORY) 사용량을 상관 분석하 여 침해사고를 탐지하는 위협헌팅 기반 클라우드 침해사고 탐지 및 대응 시스템 및 방법을 제공하는데 목적이 있다."}
{"patent_id": "10-2023-0059839", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "상술한 목적을 달성하기 위해 본 발명에 따른 위협헌팅 기반 클라우드 침해사고 탐지 및 대응 시스템은 PC 또는 서버에 상당하는 자산으로 구성된 클라우드; 상기 클라우드와 연결되어 상기 자산의 정보를 수신하는 수집모듈; 상기 수집모듈로부터 전달받은 수집한 자산 정보와 정상범위에 해당하는 AI 학습 결과값을 비교하여 사이버 공 격으로 인해 발생한 침해사고를 탐지하는 침해사고 탐지서버; 및 상기 침해사고 탐지서버로부터 상기 자산에 발 생한 침해사고 탐지 정보를 전달받은 경우 사이버 공격에 대응하는 관제센터 서버;를 포함하는 것을 특징으로 한다. 상술한 목적을 달성하기 위해 본 발명에 따른 위협헌팅 기반 클라우드 침해사고 탐지 및 대응 시스템의 수집모 듈은 자산들이 구축되어 있는 클라우드 네트워크 입구에 설치된 패킷 수집기를 통해 패킷 데이터를 수집하는 패 킷 수집탭; 자산들의 운영체제에서 로그 관리 프로그램을 통해 로그 정보를 수집하는 로그 수집기; 및 자산들의 운영체제에서 기본적으로 수집하는 프로그램을 통해 리소스 정보를 수집하는 리소스 수집기;를 포함하는 것을 특징으로 한다. 상술한 목적을 달성하기 위해 본 발명에 따른 위협헌팅 기반 클라우드 침해사고 탐지 및 대응 시스템의 패킷 수 집탭이 수집하는 파라미터는 상기 자산의 통신에 사용되는 프로토콜로 네트워크 주소에 해당되는 아이피; 상기 자산의 통신에 사용되는 포트; 및 상기 자산의 네트워크 통신량에 해당되는 트래픽;을 포함하는 것을 특징으로 한다. 상술한 목적을 달성하기 위해 본 발명에 따른 위협헌팅 기반 클라우드 침해사고 탐지 및 대응 시스템의 침해사 고 탐지서버는 상기 자산이 평소와 다른 상기 아이피와 통신시, 상기 자산이 평소 사용하지 않는 포트 사용시, 또는 상기 자산의 트랙픽이 평소와 상이하게 갑자기 증가시에 상기 사이버 공격으로 인해 발생한 침해사고로 탐 지하는 것을 특징으로 한다. 상술한 목적을 달성하기 위해 본 발명에 따른 위협헌팅 기반 클라우드 침해사고 탐지 및 대응 시스템의 침해사 고 탐지서버는 상기 리소스 수집기가 상기 자산의 씨피유 사용량과 메모리 사용량을 파라미터로 수집하면, 상기 씨피유 사용량이 갑자기 증가하거나, 또는 메모리 사용량이 갑자기 증가하는 경우 상기 사이버 공격으로 인해 발생한 침해사고로 탐지하는 것을 특징으로 한다. 상술한 목적을 달성하기 위해 본 발명에 따른 위협헌팅 기반 클라우드 침해사고 탐지 및 대응 시스템의 상기 클 라우드, 수집모듈, 침해사고 탐지서버, 및 관제센터 서버간 전송 데이터 형식은 16진수인 것을 특징으로 하는 한다."}
{"patent_id": "10-2023-0059839", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명에 따른 위협헌팅 기반 클라우드 침해사고 탐지 및 대응 시스템 및 그 방법은 숨어있어 드러나지 않은 사이버공격(악성파일 등) 선대응 가능하여 재산상 피해를 방지할 수 있는 효과가 있다. 또한, 본 발명에 따른 위협헌팅 기반 클라우드 침해사고 탐지 및 대응 시스템 및 그 방법은 이미 시스템이 공격 을 당했다고 가정하는 '위협헌팅' 개념이 들어간 탐지 방법을 통해 작업인 시스템 분석을 수행할 자산 특정 용 이한 효과가 있다."}
{"patent_id": "10-2023-0059839", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "본 명세서 및 청구범위에 사용된 용어나 단어는 통상적이거나 사전적인 의미로 한정하여 해석되어서는 아니 되 며, 발명자는 그 자신의 발명을 가장 최선의 방법으로 설명하기 위해 용어의 개념을 적절하게 정의할 수 있다는 원칙에 입각하여, 본 발명의 기술적 사상에 부합하는 의미와 개념으로 해석되어야만 한다. 따라서, 본 명세서에 기재된 실시예와 도면에 도시된 구성은 본 발명의 가 장 바람직한 일 실시예에 불과할 뿐 이고 본 발명의 기술적 사상을 모두 대변하는 것은 아니므로, 본 출원시점에 있어서 이들을 대체할 수 있는 다 양한 균등물과 변형예들이 있을 수 있음을 이해하여야 한다. 이하, 첨부된 도면을 참조하여 본 발명에 따른 위협헌팅 기반 클라우드 침해사고 탐지 및 대응 시스템 및 그 방 법에 대해 보다 구체적으로 설명한다. 도 1은 본 발명에 따른 위협헌팅 기반 클라우드 침해사고 탐지 및 대응 시스템 블록도이다. 도 1에 도시된 바와 같이 본 발명에 따른 위협헌팅 기반 클라우드 침해사고 탐지 및 대응 시스템은 클라우드 , 수집모듈, 침해사고 탐지서버, 및 관제센터 서버를 포함한다. 상기 클라우드는 인터넷을 통해 액세스할 수 있는 서버, 또는 상기 서버에서 작동하는 소프트웨어와 데이 터베이스에 해당된다. 상기 클라우드는 자산도 해당될 수 있는데, 자산은 국가·공공기관, 회사 등의 조직에서 사용하는 PC 또는 서버, 장비 등에 해당된다. 상기 수집모듈은 패킷 수집탭, 로그 수집기, 및 리소스 수집기를 포함한다. 상기 패킷 수집탭은 상기 자산들 즉, PC 또는 서버가 송수신하는 네트워크 데이터를 수집하는 장비이다. 참고로, 상기 자산들이 송수신하는 네트워크 데이터는 통신시에 발생하는 데이터로 상기 패킷 수집탭이 수 집하는 패킷에 해당되며, 도 2에 도시된 바와 같이 서브정보가 들어있는 헤더와, 메인정보가 들어있는 바디로 이루어지는데, 여기서 상기 바디를 페이로드라 부른다. 전통적 방법으로는 상기 헤더와 바디를 모두 모니터링하는데, 이때 정해진 16진수 스트링(string)을 필터링하여 매칭되는 특정 문자열이 있다면 탐지하는 방식을 사용한다. 본 발명에 따른 네트워크 데이터 탐지에서는 상술한 전통적 방법이 사용된다. 차이점이 있다면 컨테이너에 들어가는 네트워크 데이터를 모니터링 해야하므로, 컨테이너 ID 기반으로 모리터링 한다는 것으로, 해당 컨테이너 ID 기반으로 모리터링 장치는 오픈소스로 나와있어 구현이 바로 가능하다. 상기 패킷 수집탭은 자산에 들어오는 패킷 정보를 수집할 수 있도록 자산을 구성하는 네트워크에 설치된다. 패킷 수집과 관련하여 추가적으로 설명하면, 상기 클라우드는 주로 도커(Docker) 등의 컨테이너를 기반으 로 운영된다. 상기 클라우드를 구현하기 위해 도 3에 도시된 바와 같이 Virtual Machine, Container 기술이 사용되고, 상기 도커는 상기 컨테이너를 만드는 프로그램 중 하나이다. 상기 패킷 수집탭은 컨테이너 패킷 모니터링 패키지를 설치하여 패킷을 수집하는데, 이때, 헤더(header)와 바디(body) 모두 모니터링 가능하다. 상기 패킷 수집탭은 docker-id 등 컨테이너 id로 수집된 패킷을 분류할 수 있다. 상기 패킷 수집탭은 상기 컨테이너에 가장 침입탐지 시스템을 구축가능하며, rule-base 탐지 프로그램을 설치하여 이상행위를 모니터링한다. 상기 로그 수집기는 상기 PC 또는 서버 운영되는 것과 같은 자산들의 행위가 기록되는 로그들을 자산 각각 에 대해 총합적으로 수집하는 장비이다. 상기 로그 수집기는 윈도우의 경우 rocess, Event-Log, Prefetch, UserAssist, Jump Lists의 정보를 수집 하고, 리눅스의 경우 process, session, network 정보와 웹, DB, WAS, histroy, 시스템 로그, 파일의 수정시간, crontab 정보를 수집한다. 상기 리소스 수집기은 CPU 사용량, 또는 메모리(MEMORY) 사용량 등 자산들의 리소스 정보를 각각에 대하여 총합적으로 수집하는 장비이다.보다 구체적으로 상기 리소스 수집기는 Windows 성능 모니터를 통해서 데이터를 수집할 수 있는데, 수집 가능한 성능 데이터는 Logical Disk(쓰기 요청, 하드 디스크에서 읽고 쓴 바이트의 양), Memory(사용 중인 가상 메모리의 비율과 사용 가능한 메모리의 양(MB)), Processor Information(프로세스가 활성 상태를 유지한 시간 비율과 처리용량의 비율), 또는 Process (특정 프로세스에 의해 사용되고 있는 처리 용량의 비율과 프로세스에 예약된 메모리의 양) 등이 있을 수 있다. 상기 침해사고 탐지서버는 상기 패킷 수집탭, 로그 수집기, 및 리소스 수집기가 수집한 데 이터들을 상관분석하여, 악성코드 감염, 웹쉘 업로드 등으로 자산의 침해사고 발생 여부를 판단한다. 이때, 상기 침해사고 탐지서버는 상기 자산이 이미 공격을 당한 상태라고 간주(판단)하는 위협헌팅 관점에 서 상기 수집모듈로부터 전달받은 수집한 자산 정보를 상관분석한 결과값과 정상범위에 해당하는 AI 학습 결과값을 비교하여 사이버 공격으로 인해 발생한 침해사고를 탐지한다. 즉, 상기 침해사고 탐지서버는 자산 정보를 상관분석한 결과값이 정상범위에 있는 경우 침해사고 탐지를 못하지만, 정상범위를 벗어나는 경우 침해사고를 탐지하게 된다. 상기 패킷 수집탭은 자산들이 구축되어 있는 클라우드 네트워크 입구에 설치된 패킷 수집기(WireShark 등)를 통해 패킷 데이터를 수집한다. 상기 로그 수집기는 자산들의 운영체제에서 기본적으로 수집하는 로그 관리 프로그램을 통해 로그 정보를 수집한다. 상기 리소스 수집기는 자산들의 운영체제에서 기본적으로 수집하는 프로그램을 통해 리소스 정보를 수집한 다. 상기 관제센터 서버는 상기 침해사고 탐지서버와 연결되어 해당 침해사고 탐지서버의 침해사고 발생을 판단한 경우 대응한다. 한편, 상기 패킷 수집탭이 수집하는 패킷은 아이피(IP), 포트(PORT), 및 트래픽 정보를 포함한다. 상기 아이피는 통신에 사용되는 프로토콜로 자산의 네트워크 주소를 의미한다. 상기 침해사고 탐지서버는 상기 아이피를 침해사고 탐지 기준으로 사용하는데, 평소와 다른 아이피와 통신 시, 웹쉘 등의 공격으로 추정한다. 상기 포트는 통신에 사용되는 포트로, 상기 침해사고 탐지서버는 평소 사용하는 포트가 아닐 경우 공격으 로 판단한다. 예를 들어, 구글 등의 접속은 80 또는 443포트를 사용하는데 이외의 포트를 사용하는 경우 공격으로 판단한다. 상기 트래픽은 네트워크 통신량을 의미하는 용어로, 상기 침해사고 탐지 서버는 상기 트래픽이 평소와 상 이하게 갑자기 많아질 경우 DDoS 공격 등으로 판단한다. 상기 로그 수집기가 수집하는 로그는 이벤트 ID를 포함하는데, 운영체제에서 사용하는 로그 분류 기호로 시스템에서 발생하는 로그들의 내용이 포함하고 있어, 상기 침해사고 탐지 서버는 공격을 추정하는 기준으 로 활용할 수 있다. 상기 리소스 수집기는 씨피유(CPU) 사용량과 메모리(MEMORY) 사용량을 포함한다. 상기 씨피유(CPU)는 컴퓨터 시스템에 포함되는 하드웨어 장비로 작업을 하는 실질적인 부품이다. 상기 침해사고 탐지 서버는 상기 씨피유 사용량이 갑자기 늘어날 시, 공격을 추정하는 기준으로 사용한다. 상기 메모리는 컴퓨터 시스템에 포함되는 하드웨어 장비로 상기 씨피유와 협업하는 부품이다. 상기 침해사고 탐지 서버는 메모리 사용량이 갑자기 늘어날 경우 공격을 추정하는 기준으로 사용한다. 상기 침해사고 탐지 서버는 사이버 침해 분석 기술에 활용되는 디지털 포렌식 기법을 활용하는데, 해당 디 지털 포렌식 기법은 자산의 파일 실행에 따라 자산 시스템에 남은 기록을 참고하여 \"정상 행위가 아닌 것\"을 기 준으로 악성 행위여부를 자동으로 판단한다. 상기 자산이 파일을 실행하면, 해당 파일은 악성해위를 시작하는데 실행되는 파일을 프로세스라고 한다. 파일이 프로세스로 되면 그에 대한 행위들을 시스템에 로그로 남기게 되는데 그 종류는 EventLog, Prefetch, Registry등이 있다. 이때, 상기 파일이 실행되어 악성행위를 시작했지만 백신 등이 탐지하지 못하는 경우, 실행된 파일을 \"드러나지 않은 악성파일\"이라고 한다. 윈도우 운영체제에서 사용자가 시스템을 사용하면 Process, Event-Log, Prefetch, UserAssist, Jump Lists 등 의 기록이 남게된다. 위의 기록들을 바탕으로 악성 여부를 판단하는 방법은 아래와 같다. 먼저, 프로세스에서 발생할 수 있는 정상범위에서 벗어나면 악성으로 분류한다. 예를 들어, 윈도우 프로세스인 System smss.exe, wininit.exe, RuntimeBroker.exe, taskhostw.exe, winlogon.exe, crss.exe, services.exe, svchost.exe, lsaiso.exe, lsass.exe, explorer.exe는 시스템 사용에 필수적이다. 다만, 악성코드 감염 시, 해당 프로세스를 사칭하는 프로세스들이 생기는데 이를 탐지하여 악성코드 감염 여부 를 판단한다. 이 때, 위 나열된 프로세스들은 특정 규칙을 준수하며 운영되는 점을 활용한다. 즉, 특정 규칙을 어길시 악성 프로세스라고 판단하는 것이다. 이는 언급한 바와 같이 사이버 침해사고 분석 기 술에 활용되는 디지털 포렌식 방법론과 같다. 다른 예시로 한글파일의 경우 원격 패킷 전송의 행위는 보통 일어나지 않는다. 다만, 악성파일의 경우 악성 중 계서버인 C&C로 통신 패킷을 보낸다. 이 때, 정상 범위를 \"원격으로 패킷을 보내지 않는다.\"로 두고, 악성의 경우를 \"원격으로 패킷을 보낸다.\"라고 본다. 또 usb 연결, 원격 데스크톱 연결, 시스템 시간 변경, 무선 연결 내역 등의 행위는 이벤트로그에 기록된다. 이 이벤트 로그는 이벤트ID에 매핑되는데, 이를 모니터링하면 이상행위가 발생했는지도 볼 수 있다. 이는 클라우드 시스템이 올라간 센터의 내부자 위협을 대응할 수 있기도 하다. 클라우드 자산에 usb가 연결되거나 했다는 것은 자료가 유출되었을 수도 있는 증거이기 때문이다. 다른 예시로 웹쉘 판단에 해당되는 것이 있다. 웹쉘은 웹상에서 동작하는 쉘로 시스템 명령어를 올릴 수 있다. 이는 최종적으로 시스템 공격까지 이어질 수 있는데 모든 웹서버 공격의 시작에 해당된다. 이를 탐지하기 위해선 웹쉘에서 주로 사용되는 함수가 사용되는 지 모니터링 해야한다. ASP, PHP, JSP 등 주로 사용되는 것은 다른데 ASP는 Wscript.Exec, ShellExecute 등이 사용된다. 이를 모니터링하여 해당되는 것이 있다면 악성요소로 분류한다. 또 다른 예시로 API를 모니터링 할 수 있다. 윈도우에서 동작하는 악성파일의 경우 주로 사용되는 API가 있는데 그 종류로는 AdjustTokenPrivileges, AttachTreadInput, Bind, Connect 등이 있다. 이를 모니터링함으로써 이것이 사용되는 것이 있다면 악성요소로 분류한다. 위의 분석과 결과는 이는 Agent를 통해 모니터링하고 침해사고 탐지서버에 데이터를 보내는 형식으로 위협 헌팅을 수행할 수 있다. 선대응으로는 공격 대응 조직에 알려주는 것이 있다. 공격 내용을 알릴 때 분석에 참조한 패킷, 로그 등의 정보 를 함께 보낸다. 이 자료들을 바탕으로 공격 대응 조직의 근무자는 추가로 분석을 수행할 수 있다. 이는 해당 특허의 장치로 분 석 후 사람의 수동분석이 이뤄지는 2단계 구조를 가능하게 한다. 리눅스 운영체제에서 사사용자가 시스템을 사용하거나 악성파일 실행 등으로 시스템이 변경되었을 땐, 기록이 남는다. 본 발명에서는 상기 침해사고 탐지서버는 상기 기록을 기준으로 시스템 감염을 자동으로 수행한다. 즉, 상기 침해사고 탐지서버는 process, session, network 정보와 웹, DB, WAS, histroy, 시스템 로그, 파일의 수, 정시간, crontab 정보를 확인한다.예를 들어, 상기 process는 파일로부터 시작되는데, 이것의 권한을 확인할 수 있다. # find /-uid 0 -perm 4000의 명령어를 통해 시스템 권한을 갖는 파일을 확인할 수 있다. 만약, 명령어 사용 결 과로 나온 일반 파일들이 있다면 이는 감염된 파일일 확률이 높다. 그 이유로는 해당 파일 실행 시, 허가되지 않은 상위 권한을 갖게 되어 시스템에 추가 피해가 발생할 수 있기 때문이다. 다른 예시로 웹쉘 판단에 해당되는 것이 있다. 웹쉘은 웹상에서 동작하는 쉘로 시스템 명령어를 올릴 수 있다. 이는 최종적으로 시스템 공격까지 이어질 수 있는데 모든 웹서버 공격의 시작에 해당된다. 이를 탐지하기 위해 선 웹쉘에서 주로 사용되는 함수가 사용되는지 모니터링 해야한다. ASP, PHP, JSP 등 주로 사용되는 것은 다른데, ASP는 Wscript.Exec, ShellExecute 등이 사용된다. 이를 모니터 링한다면 웹쉘 여부를 확인할 수 있다윈도우 운영체제에서 사용자가 시스템을 사용하면 Process, Event-Log, Prefetch, UserAssist, Jump Lists 등의 기록이 남게된다. 위의 기록들을 바탕으로 악성 여부를 판단하는 방법은 아래와 같다. 먼저, 프로세스에서 발생할 수 있는 정상범위에서 벗어나면 악성으로 분류한다. 예를들어, 윈도우 프로세스인 System smss.exe, wininit.exe, RuntimeBroker.exe, taskhostw.exe, winlogon.exe, crss.exe, services.exe, svchost.exe, lsaiso.exe, lsass.exe, explorer.exe는 시스템 사용에 필수적이다. 다만, 악성코드 감염 시, 해당 프로세스를 사칭하는 프로세스들이 생기는데 이를 탐지하여 악성코드 감염 여부 를 판단한다. 이 때, 위 나열된 프로세들은 특정 규칙을 준수하며 운영되는 점을 활용한다. 즉, 특정 규칙을 어길시 악성 프로세스라고 판단하는 것이다. 이는 언급한 바와 같이 사이버 침해사고 분석 기 술에 활용되는 디지털 포렌식 방법론과 같다. 다른 예시로 한글파일의 경우 원격 패킷 전송의 행위는 보통 일어나지 않는다. 다만, 악성파일의 경우 악성 중 계서버인 C&C로 통신 패킷을 보낸다. 이 때, 정상 범위를 \"원격으로 패킷을 보내지 않는다.\"로 두고, 악성의 경우를 \"원격으로 패킷을 보낸다.\"라고 본다. 또 usb 연결, 원격 데스크톱 연결, 시스템 시간 변경, 무선 연결 내역 등의 행위는 이벤트로그에 기록된다. 이 이벤트 로그는 이벤트ID에 매핑되는데, 이를 모니터링하면 이상행위가 발생했는지도 볼 수 있다. 이는 클라우드 시스템이 올라간 센터의 내부자 위협을 대응할 수 있기도 하다. 클라우드 자산에 usb가 연결되거나 했다는 것은 자료가 유출되었을 수도 있는 증거이기 때문이다. 다른 예시로 웹쉘 판단에 해당되는 것이 있다. 웹쉘은 웹상에서 동작하는 쉘로 시스템 명령어를 올릴 수 있다. 이는 최종적으로 시스템 공격까지 이어질 수 있는데 모든 웹서버 공격의 시작에 해당된다. 이를 탐지하기 위해선 웹쉘에서 주로 사용되는 함수가 사용되는 지 모니터링 해야한다. ASP, PHP, JSP 등 주로 사용되는 것은 다른데 ASP는 Wscript.Exec, ShellExecute 등이 사용된다. 이를 모니터링하여 해당되는 것이 있다면 악성요소로 분류한다. 또 다른 예시로 API를 모니터링 할 수 있다. 윈도우에서 동작하는 악성파일의 경우 주로 사용되는 API가 있는데 그 종류로는 AdjustTokenPrivileges, AttachTreadInput, Bind, Connect 등이 있다. 이를 모니터링함으로써 이것이 사용되는 것이 있다면 악성요소로 분류한다. 위의 분석과 결과는 이는 Agent를 통해 모니터링하고 침해사고 탐지서버에 데이터를 보내는 형식으로 위협 헌팅을 수행할 수 있다. 선대응으로는 공격 대응 조직에 알려주는 것이 있다. 공격 내용을 알릴 때 분석에 참조한 패킷, 로그 등의 정보 를 함께 보낸다. 이 자료들을 바탕으로 공격 대응 조직의 근무자는 추가로 분석을 수행할 수 있다. 이는 해당 특허의 장치로 분 석 후 사람의 수동분석이 이뤄지는 2단계 구조를 가능하게 한다. 리눅스 운영체제에서 사용자가 시스템을 사용하거나 악성파일 실행 등으로 시스템이 변경되었을 땐, 기록이 남 는다. 본 발명에서는 상기 침해사고 탐지서버는 상기 기록을 기준으로 시스템 감염을 자동으로 수행한다. 즉, 상기 침해사고 탐지서버는 process, session, network 정보와 웹, DB, WAS, histroy, 시스템 로그, 파일의 수, 정시간, crontab 정보를 확인한다. 예를 들어, 상기 process는 파일로부터 시작되는데, 이것의 권한을 확인할 수 있다. # find /-uid 0 -perm 4000의 명령어를 통해 시스템 권한을 갖는 파일을 확인할 수 있다. 만약, 명령어 사용 결 과로 나온 일반 파일들이 있다면 이는 감염된 파일일 확률이 높다. 그 이유로는 해당 파일 실행 시, 허가되지 않은 상위 권한을 갖게 되어 시스템에 추가 피해가 발생할 수 있기 때문이다. 다른 예시로 웹쉘 판단에 해당되는 것이 있다. 웹쉘은 웹상에서 동작하는 쉘로 시스템 명령어를 올릴 수 있다. 이는 최종적으로 시스템 공격까지 이어질 수 있는데 모든 웹서버 공격의 시작에 해당된다. 이를 탐지하기 위해 선 웹쉘에서 주로사용되는 함수가 사용되는지 모니터링 해야한다. ASP, PHP, JSP 등 주로 사용되는 것은 다른데, ASP는 Wscript.Exec, ShellExecute 등이 사용된다. 이를 모니터 링한다면 웹쉘 여부를 확인할 수 있다. 상술한 구성간 데이터 전달을 위한 전송 데이터 형식은 16진수로 아래의 [표 1]과 같다. 표 1 CMD 종류 (16진수)설명 01 자산에서 패킷 수집탭으로 네트워크 데이터 정보 전송 02 자산에서 로그 수집기로 로그 정보 전송 03 자산에서 리소스 수집기로 리소스 정보 전송 04 수집기(패킷 수집탭, 로그 수집기, 리소스 수집기)에서 침해사고 탐지 서버으로 각각 데이터 정보 전송 05 침해사고 탐지 서버에서 사고 발생 여부 판단 AI기반 상관분석 수행 06 침해사고 탐지 서버에서 사고 발생으로 판단됐을 시, 관제센터로 알림 발송 도 4에 도시된 바와 같이 상기 패킷 수집탭는 클라우드에 구축되어 있는 자산으로부터 `CMD01`형식 의 네트워크 데이터 정보를 수신한다.또한, 상기 자산은 `CMD02`형식으로 각각의 로그 정보를 상기 로그 수집기 에 전송한다. 상기 자산은 `CMD03`형식으로 각각의 리소스 정보를 상기 리소스 수집기로 전달한다. 상기 패킷 수집탭, 상기 로그 수집기, 및 상기 리소스 수집기는 `CMD04`형식으로 상기 침해사고 탐지 서버로 수집한 정보를 전송한다. 상기 침해사고 탐지 서버는 수집된 정보를 기반으로 AI 상관분석을 하여 침해사고 발생 여부를 `CMD05`형 식으로 판단한다. 상기 침해사고 탐지 서버는 상기 패킷 수집탭으로부터 수신한 네트워크 정보(IP, PORT, 트래픽), 상 기 로그 수집기로부터 수신한 로그 정보(EVEN ID), 상기 리소스 수집기로부터 수신한 리소스 정보 (CPU, MEMORY 사용량)를 인공지능 알고리즘(LSTM 등)을 사용한 모델로 학습을 통한 상관분석을 하여 침해사고 탐지를 수행한다. 상기 상관분석과 관련하여 보다 구체적으로 설명한다. 상기 패킷 수집탭은 컨테이너 기반으로 트리거(trigger)역할을 하는 패킷을 수집한다. 상기 침해사고 탐지 서버는 상기 패킷 수집탭이 수집한 패킷에 에 대하여 snort 룰 등 rule-base 패 킷 탐지를 하여 이상행위로 의심되는 것을 파악한다. 상기 침해사고 탐지 서버가 탐지된 패킷을 기준으로 해당되는 컨터이너 id를 들어가면, 상기 로그 수집기 와 상기 리소스 수집기가 로그와 리소스 정보를 수집함에 따라 해당 로그와 리소스 정보를 얻을 수 있다.상기 침해사고 탐지 서버는 얻은 상기 로그 정보에 대하여, 정상적이지 않은 범위의 프로세스 생성, API 사용 등을 확인하고, 이 내용이 있는 경우, 악성 행위 발생 2단계라고 표시하고, 로그 정보에 이상행위가 없다 면 1단계로 표시한다. 또한, 상기 침해사고 탐지 서버는 얻은 상기 리소스 정보에 대하여, 시계열 분석 방법을 사용하여 평소 시 간대에 해당되는 리소스 정보를 확인하고, 만약 패킷, 로그, 리소스 정보 모두 연관되었을 경우, 이상행위 3단 계로 표시한다. 상기 침해사고 참지 서버는 보안 담당자가 확인할 수 있도록, 상기 관제센터 서버에 상기 1단계, 2단 계, 또는 3단계 정보와 함께 패킷, 로그, 리소스 정보들을 모두 전송한다. 상기 침해사고 탐지 서버가 상기 관제센터 서버로 전송하는 패킷은 1분 전후의 pcap 파일이고, 로그 는 txt 파일이며, 리소스 정보는 png 파일이다. 상기 침해사고 탐지 서버는 학습 후, 새롭게 들어오는 정보에 대해서 소정의 시간단위로 상관분석을 수행 한다. 상기 침해사고 탐지 서버는 상관분석 결과값으로 침해사고 발생 여부를 수치로 도출한 상기 침해사고 탐지 서버는 상기 상관분석한 결과 침해사고 발생으로 판단 시, 관제센터에 `CMD06`형식으 로 알림을 발송한다. 상기 침해사고 탐지 서버는 상기 상관분석한 결과 침해사고 발생으로 판단 시, `1`을 침해사고 발생이 아 닌겨우 `0`으로 일림을 발송할 수 있다. 침해사고가 발생하여 상기 침해사고 탐지 서버가 이를 탐지하여 상기 관제센터 서버에 접수되면, 해당 관 제센터 서버는 네트워크, 로그, 리소스 정보 등을 기반으로 공격의 발생여부, 경로, 그리고 영향도를 판단 한다. 상기에서 언급한 관제센터는 사이버 공격이 들오왔을 때 탐지하고 대응하는 기관의 조직이다. 이상에서는 본 발명에 대한 기술사상을 첨부 도면과 함께 서술하였지만 이는 본 발명의 바람직한 실시 예를 예 시적으로 설명한 것이지 본 발명을 한정하는 것은 아니다. 또한 본 발명이 속하는 기술 분야에서 통상의 지식을 가진 자라면 누구나 본 발명의 기술적 사상의 범주를 이탈하지 않는 범위 내에서 다양한 변형 및 모방이 가능함 은 명백한 사실이다."}
{"patent_id": "10-2023-0059839", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명에 따른 위협헌팅 기반 클라우드 침해사고 탐지 및 대응 시스템 도면이다. 도 2는 본 발명에 따른 위협헌팅 기반 클라우드 침해사고 탐지 및 대응 시스템에서 사용되는 헤더와 바디, 그리 고 페이로드를 설명하기 위한 도면이다. 도 3은 본 발명에 따른 위협헌팅 기반 클라우드 침해사고 탐지 및 대응 시스템에서 사용되는 Virtual Machine, Container, 및 도커의 관계를 설명하기 위한 도면이다. 도 4는 본 발명에 따른 위협헌팅 기반 클라우드 침해사고 탐지 및 대응 시스템의 동작 원리를 설명하기 위한 도 면이다."}
