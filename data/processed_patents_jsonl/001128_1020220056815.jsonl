{"patent_id": "10-2022-0056815", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2023-0157162", "출원번호": "10-2022-0056815", "발명의 명칭": "고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장치 및 방법", "출원인": "경기대학교 산학협력단", "발명자": "김민기"}}
{"patent_id": "10-2022-0056815", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장치에 있어서, 고해상도 영상을 입력받는 입력부; 상기 고해상도 영상을 이용해 서로 다른 크기의 패치 영상들을 생성하는 전처리부;특징 추출 네트워크를 이용해 학습 데이터 셋의 특징을 포함하는 학습 데이터베이스를 생성하는 학습부;상기 특징 추출 네트워크를 이용해 패치 영상의 특징을 추출하는 측정부;상기 고해상도 영상을 판단하기 위한 이상 점수를 산출하는 산출부; 및상기 이상 점수를 이용해 상기 고해상도 영상의 상태를 판단하는 판단부를 포함하는 고해상도 영상을 활용한 딥러닝 기반 이상 탐지 장치."}
{"patent_id": "10-2022-0056815", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 학습부는 상기 패치 영상의 크기에 따라 특징 추출 네트워크를 이용하는 학습 데이터베이스를 생성하는고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장치."}
{"patent_id": "10-2022-0056815", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1항에 있어서,상기 측정부는상기 패치 영상의 특징 값과 상기 학습 데이터베이스에서 동일한 위치의 패치 특징 값과 비교하여 유사도를 측정하는고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장지."}
{"patent_id": "10-2022-0056815", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제1항에 있어서,상기 산출부는유사도 값을 기반으로 각 패치 영상의 크기를 결합하여 이상 점수를 산출하고, 이상 점수를 기반으로, 이상 점수 지도(anomaly score map)를 생성하는고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장치."}
{"patent_id": "10-2022-0056815", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장치의 이상 탐지 방법에 있어서,공개특허 10-2023-0157162-3-고해상도의 영상을 이용하여 서로 다른 크기의 패치 영상들을 생성하는 단계;특징 추출 네트워크를 이용해 상기 패치 영상들의 특징을 추출하는 단계;상기 패치 영상에서 추출한 특징 값과 학습 데이터베이스와의 유사도를 측정하는 단계;상기 고해상도 영상을 판단하기 위한 이상 점수를 산출하는 단계;상기 이상 점수와 임계 값을 비교하는 단계; 및상기 고해상도 영상을 정상 또는 비정상으로 판단하는 단계를 포함하는 고해상도 영상을 활용한 딥 러닝 기반이상 탐지 방법"}
{"patent_id": "10-2022-0056815", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제5항에 있어서,상기 패치 영상의 크기에 따라 특징 추출 네트워크를 이용하는 학습 데이터베이스를 생성하는 단계를 더 포함하는고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 방법."}
{"patent_id": "10-2022-0056815", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제5항에 있어서상기 패치 영상에서 추출한 특징 값과 학습 데이터베이스와의 유사도를 측정하는 단계는상기 패치 영상의 특징 값과 학습 데이터베이스에서 동일한 위치의 패치 특징 값을 비교하여 유사도를 측정하는고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 방법."}
{"patent_id": "10-2022-0056815", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제5항에 있어서상기 고해상도 영상을 판단하기 위한 이상 점수를 산출하는 단계는 유사도 값을 기반으로 각 패치 영상의 크기를 결합하여 이상 점수를 산출하고, 이상 점수를 기반으로 이상 점수지도(anomaly score map)를 생성하는고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 방법."}
{"patent_id": "10-2022-0056815", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제5항 내지 제8항의 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 방법 중 어느 하나를 실행하는 컴퓨터가판독 가능한 기록매체에 기록된 컴퓨터 프로그램."}
{"patent_id": "10-2022-0056815", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 이상치 탐지 기술에 관한 것으로, 더욱 상세하게는 고해상도 영상을 기반으로 특징 손실 없이 생성한 패치 영상의 특징 값을 딥 러닝 기반 이상 탐지 네트워크를 통해 추출하여 효과적으로 이상치를 탐지하는 고해상 도 영상을 활용한 딥 러닝 기반 이상 탐지 장치 및 방법에 대한 것이다. 본 발명의 일 실시 예에 따르면, 고해 상도 영상을 입력받아 패치 영상으로 전처리하여 특징을 추출하므로 고해상도 영상의 특징을 손실없이 잘 보존하 여 판별의 정확도와 성능을 향상시킬 수 있다"}
{"patent_id": "10-2022-0056815", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 이상치 탐지 기술에 관한 것으로, 더욱 상세하게는 고해상도 영상을 기반으로 특징 손실 없이 생성한 패치 영상의 특징 값을 딥 러닝 기반 이상 탐지 네트워크를 통해 추출하여 효과적으로 이상치를 탐지하는 고해 상도 영상을 활용한 딥 러닝 기반 이상 탐지 장치 및 방법에 대한 것이다."}
{"patent_id": "10-2022-0056815", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "딥 러닝 기술의 발전에 따라 인공지능 의료 시장이 커지면서 딥 러닝에 필요한 관련 의료 데이터 셋이 구축되고 공개됨에 따라 더욱 다양한 연구가 활성화되고 있다. Radiography(X-Ray), CT(Computed Tomography), MRI(Magnetic Resonance Imaging), 초음파 등 다양한 의료 데이터 셋이 존재하는 가운데 Radiography 는 비교 적 촬영 속도가 빠르고 저렴해 의료계에서 많이 사용되고 있다. 그 중 Chest Radiograph 는 폐, 심장, 갈비뼈 등 다양한 기관들의 모습을 확인할 수 있어 활용도가 높다. Chest Radiograph가 많이 사용됨에 따라 자동으로 질병의 유무를 분류할 수 있는 Screening 기술도 연구되고 있 다. Screening 기술을 활용하면 빠르게 입력 Chest Radiograph의 단순히 정상/비정상을 빠르게 분류할 수 있어 실제 전문의가 비정상인 환자를 대상으로 진단을 집중하게끔 할 수 있다. 이처럼 Screening 기술을 활용한 Chest Radiograph Screening은 의료 현장에서의 많은 필요성을 느끼며 최근 연구되고 있는 AI 의료 분야 중 하 나이다. Chest Radiograph 내에서의 미세한 특징이 사라지는 것을 방지하기 위해 딥러닝 네트워크의 입력으로 사용하기 위해 작은 해상도로 재조정(Resize) 하지 않고 원본과 유사한 크기를 가지는 비교적 큰 해상도를 사용하는 것이 효과적이다. 하지만 하드웨어적 한계, 큰 해상도 영상에서의 특징 추출의 어려움 등으로 성능이 저하되고, 이를 막기 위해 입력 영상의 크기가 재조정되면 Chest Radiograph 내에 존재하는 특징들은 압축되어 Screening의 의 미가 손실되는 단점이 발생한다. 이에 따라 Chest Radiograph의 특징을 잘 보존하고 효과적으로 정상/비정상을 분류하는 방법이 요구되고 있다. 선행기술문헌 특허문헌 (특허문헌 0001) 1. 한국 등록특허공보 제10-1760287호 “의료영상 분할 장치 및 방법”(공개일자: 2017년 07월 25일)"}
{"patent_id": "10-2022-0056815", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은 고해상도의 영상을 입력받아 패치 크기로 영상을 분할함으로 특징을 잘 보존하여 효과적으로 이상치 를 탐지할 수 있는 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장치 및 방법을 제공한다. 본 발명은 특징이 잘 보존된 패치 영상을 이용해 학습 데이터와 유사도를 측정하여 이상 점수(anomaly score)를 산출하여 정상 또는 비정상을 판별하는 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장치 및 방법을 제공한 다."}
{"patent_id": "10-2022-0056815", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명의 일 측면에 따르면, 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장치를 제공한다. 본 발명의 일 실시 예에 따른 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장치는 고해상도 영상을 입력받 는 입력부, 고해상도 영상을 이용해 서로 다른 크기의 패치 영상들을 생성하는 전처리부, 특징 추출 네트워크를 이용해 학습 데이터 셋의 특징을 포함하는 학습 데이터베이스를 생성하는 학습부, 특징 추출 네트워크를 이용해 패치 영상의 특징을 추출하는 측정부, 고해상도 영상을 판단하기 위한 이상 점수를 산출하는 산출부 및 이상 점 수를 이용해 고해상도 영상의 상태를 판단하는 판단부를 포함할 수 있다. 본 발명의 다른 일 측면에 따르면, 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 방법 및 이를 실행하는 컴 퓨터 프로그램을 제공한다. 본 발명의 일 실시 예에 따른 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 방법 및 이를 실행하는 컴퓨터 프로그램은 고해상도의 영상을 이용하여 서로 다른 크기의 패치 영상들을 생성하는 단계, 특징 추출 네트워크를 이용해 패치 영상들의 특징을 추출하는 단계, 패치 영상에서 추출한 특징 값과 학습 데이터베이스와의 유사도를 측정하는 단계, 고해상도 영상을 판단하기 위한 이상 점수를 산출하는 단계, 이상 점수와 임계 값을 비교하는 단계 및 고해상도 영상을 정상 또는 비정상으로 판단하는 단계를 포함할 수 있다."}
{"patent_id": "10-2022-0056815", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명의 일 실시 예에 따르면, 고해상도 영상을 입력받아 패치 영상으로 전처리하여 특징을 추출하므로 고해 상도 영상의 특징을 손실없이 잘 보존하여 판별의 정확도와 성능을 향상시킬 수 있다. 또한, 본 발명의 일 실시 예에 따르면, 고해상도 영상을 분할한 패치 영상 뿐만 아니라 패치 영상 주변의 정보 도 유사도를 측정하여 판별의 정확성을 높일 수 있다."}
{"patent_id": "10-2022-0056815", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "본 발명은 다양한 변경을 가할 수 있고 여러 가지 실시 예를 가질 수 있는 바, 특정 실시 예들을 도면에 예시하 고 이를 상세한 설명을 통해 상세히 설명하고자 한다. 그러나, 이는 본 발명을 특정한 실시 형태에 대해 한정하 려는 것이 아니며, 본 발명의 사상 및 기술 범위에 포함되는 모든 변경, 균등물 내지 대체물을 포함하는 것으로 이해되어야 한다. 본 발명을 설명함에 있어서, 관련된 공지 기술에 대한 구체적인 설명이 본 발명의 요지를 불 필요하게 흐릴 수 있다고 판단되는 경우 그 상세한 설명을 생략한다. 또한, 본 명세서 및 청구항에서 사용되는 단수 표현은, 달리 언급하지 않는 한 일반적으로 \"하나 이상\"을 의미하는 것으로 해석되어야 한다. 이하, 본 발명의 바람직한 실시 예를 첨부도면을 참조하여 상세히 설명하기로 하며, 첨부 도면을 참조하여 설명 함에 있어, 동일하거나 대응하는 구성 요소는 동일한 도면번호를 부여하고 이에 대한 중복되는 설명은 생략하기 로 한다. 도 1 내지 3은 본 발명의 일 실시예에 따른 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장치를 설명하기 위한 도면들이다. 도 1을 참조하면, 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장치는 입력부, 전처리부, 측 정부, 산출부 및 판단부를 포함할 수 있다. 도 2 및 도 3을 참조하면, 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장치는 고해상도 영상을 입력받 아 패치 영상을 생성하고, 패치 영상과 학습 데이터 간의 유사도를 측정하여 이상 점수(anomaly score)를 산출 하여 영상의 비정상 또는 정상 여부를 판별할 수 있다. 다시 도 1을 참조하면, 입력부는 고해상도의 방사선 촬영 영상을 입력받는다. 본 발명의 이해를 돕기 위해 다양한 부위의 의료 목적의 고해상도 영상 중에 흉부 방사선(Chest Radiograph, Chest X-ray) 영상을 기준으로 예시를 제공하고 설명하도록 한다. 입력부는 고해상도 영상의 해상도를 조정한다. 예를 들면 입력부는 입력된 영상을1024x1024의 고해상 도로 조정한다. 만약 입력부가 저해상도로 영상을 조정하면 영상 내에 존재하는, 판별에 영향을 줄 수 있 는 미세한 특징들이 압축되어 사라질 수 있기 때문에 1024x1024의 해상도로 조정할 수 있다. 도 4는 본 발명의 일 실시 예에 따른 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장치의 패치 영상 예시들 이다. 도 4를 참조하면, 전처리부는 고해상도의 영상을 이용하여 다양한 크기의 패치 영상들을 생성한다. 예를 들면, 전처리부는 패치 영상의 해상도를 최소한의 유의미한 특징을 가지는 128X128 부터 256X256, 512X512, 1024X1024까지 조정할 수 있다. 도 4의 각 패치 영상들은 모두 흉부 방사선으로부터 정상/비정상임을 판별하기 위한 유의미한 특징들을 포함하고 있다. 전처리부는 고해상도 입력 영상을 기준으로 각 좌표에 따라 패치 영상을 생성한다. 전처리부는 좌표 를 기준으로 하는 것 이 외의 어떠한 Stride나 Padding을 설정하지 않는다. 도 5 내지 도 7은 본 발명의 일 실시 예에 따른 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장치의 딥 러 닝 네트워크를 간략히 설명하기 위한 도면들이다. 학습부는 특징 추출 네트워크를 이용해 학습 데이터의 특징을 포함하는 학습 데이터베이스를 생성할 수 있 다. 예를 들면 학습부는 Contrastive Loss 기반 네트워크인 SimCLR 네트워크로 추출된 학습 데이터의 특징 이 있는 학습 데이터베이스를 이용할 수 있다. 다시 말해, 학습부는 학습 데이터의 특징을 담고 있는 학습 데이터베이스를 생성하기 위해 SimCLR 네트워크를 특징 추출 네트워크로 사용할 수 있다. 학습부는 도 5와 같은 예시 구조의 SimCLR 모델을 사용할 수 있다. 도 5를 참조하면, 학습부는 x는 원본 훈련 데이터로 하고, xi, xj는 전처리 방식인 Random Crop과 Random Rotation을 통해 생성된 임의의 두 데이터로 설정한다. SimCLR 연구에서 다양한 전처리 방식을 사용해 실험을 진행해 본 결과 Color-Crop 조합이 가장 성능이 좋았지만, 학습부는 의료 데이터 셋과 흑백 이미지인 점을 감안해 Crop-Rotation 전처리 방식을 사용할 수 있다. f는 ResNet50 구조를 가지고 있는 Encoder를 의미하고, g는 두 개의 MLP(Multi-Layer-Perceptron)로 이루어져 있는 Projection head를 의미한다. 최종적으로 학습부 는 두 개의 네트워크 f, g를 통해 추출된 zi, zj 는, 비교를 통해 x로부터 생성된 같은 데이터임을 학습시 키는 SimCLR 네트워크를 이용할 수 있다. 도 6을 참조하면, 학습부는 각 패치 영상 크기에 따른 네트워크를 통해 크기 별 특징을 담은 데이터베이스 를 생성할 수 있다. 학습부는 각 패치 영상의 해상도 별로 model128X128, model256X256, model512X512 및 model1024X1024 으로 SimCLR 학습 모델을 분류하여 학습할 수 있다. 학습부는 Radom Crop(50%), Radom Rotation(-5°~5°)의 전처리를 수행하여 다양한 모양의 흉부 방사선 영상에 대해 학습을 진행할 수 있다. 학습부는 다양한 전처리 방식을 통해 학습된 각 SimCLR 모델을 어떠한 전처리도 하지 않은 원본 패치 영상 의 특징을 추출해 그 값을 데이터베이스 형태로 저장해 학습 데이터 셋의 특징을 담고 있는 학습 데이터베이스 를 생성한다.도 7을 참조하면, 학습부는 각 패치 영상의 해상도에 따라 각 SimCLR 모델을 수행하고 feature128X128, feature256X256, feature512X512 및 feature1024X1024 학습 데이터베이스를 각각 생성하여 저장한다. 다시 도 1을 참조하면 측정부는 생성된 패치 영상을 학습 데이터 셋의 특징을 담고 있는 학습 데이터베이 스와의 유사도를 측정할 수 있다. 또한 측정부는 패치 영상에서 효과적인 특징 추출을 하기 위해 학습부 가 사용한 SimCLR 네트워크를 이용할 수 있다. 측정부는 학습 데이터 셋의 특징을 추출해 데이터베이 스 형태로 저장하는 SimCLR 네트워크를 패치 영상에서 효과적인 특징을 추출하기 위한 네트워크로 이용할 수 있 다. 측정부는 SimCLR을 통해 추출된 입력 패치 영상의 특징 값과 학습부가 생성한 학습 데이터베이스 내 에 존재하는 값을 비교하여 유사도를 측정할 수 있다. 도 8 내지 도 10은 본 발명의 일 실시 예에 따른 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장치의 유사 도 측정 방법에 대한 설명을 하기 위한 도면들이다. 도 8을 참조하면, 측정부는 각 패치 영상의 특징 값은 학습 데이터베이스에서 동일한 위치의 패치 특징 값 과 비교할 수 있다. 측정부는 작은 패치 해상도 영상에서는 각 패치 영상의 위치와 동일한 위치의 학습 데이터베이스 특징 값 의 유사도 뿐만 아니라 주변 영역에 대해서도 유사도를 측정하여 활용할 수 있다. 도 9를 참조하면, 측정부는 파라미터 d를 이용해 주변 패치 영상 간 유사도를 측정할 수 있다. 도 9(a)를 참조하면 측정부는 파라미터 d를 1로 설정한 것이고 도 9(b)는 파라미터 d를 2로 설정한 예시이 다. 측정부는 입력 패치 영상의 주변 인접 영역의 패치 영상을 포함하여 비교 범위를 넓혀서 유사도를 측 정할 수 있다. 예를 들면 측정부는 128X128 해상도의 패치 영상에 대해서는 파라미터 d를 2로 설정하고, 256X256 해당도의 패치 영상에 대하여는 파라미터 d를 1로 설정하여 유사도를 측정할 수 있다. 측정부는 해상도에 따른 패치 영상과 동일한 해상도의 학습 데이터베이스에 저장된 값을 비교하여 유사도 를 측정할 수 있다. 측정부는 다양한 유사도 측정 알고리즘을 이용할 수 있다. 예를 들면, 대표적인 유사도 측정 알고리즘인 유클리디안 거리(Euclidean Distance), 맨해튼 거리 (Manhattan Distance), 코사인 유사도(Cosine Similarity), 마할라노비스 거리(Mahalanobis Distance) 등 다양한 측정 방식을 사용할 수 있다. 수학식 1"}
{"patent_id": "10-2022-0056815", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "수학식 2"}
{"patent_id": "10-2022-0056815", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "수학식 3 수학식 4"}
{"patent_id": "10-2022-0056815", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "다시 도 1을 참조하면, 산출부는 최종적으로 고해상도 영상의 정보가 정상 또는 비정상을 판단하는 근거인 이상 점수(anomaly score)를 산출할 수 있다. 도 10을 참조하면, 산출부는 유사도 값을 기반으로 각 패치 영상의 크기를 결합하여 이상 점수를 산출할 수 있고, 이상 점수 지도(anomaly score map)를 생성할 수 있다. 산출부는 측정부의 측정 방식에 따라 다양한 범위의 이상 점수(anomaly score)를 산출할 수 있다. 산출부는 이상 점수(anomaly score)의 용이한 비교를 위해 모든 이상 점수(anomaly score)는 0 이상의 값 을 가지는 범위로 변경하여 사용할 수 있다. 산출부는 이상 점수 지도(anomaly score map)를 기반으로 해상도별 각 패치 영상의 단독 이상 점수 (anomaly score)를 산출할 수 있다. 산출부는 동일한 해상도의 패치 영상 점수 중 가장 낮은 점수를 해상 도별 패치 영상의 단독 이상 점수로 설정할 수 있다. 예를 들면, 도 10의 512X512 해상도에 대한 패치 영상의 단독 이상 점수는 0.3으로 표현될 수 있다. 산출부는 패치 영상을 좀 더 효과적으로 사용하기 위해 각 패치 크기에 따른 결과 값에 각각의 가중치를 설정할 수 있다. [표 1]은 각 패치 크기에 따른 설정 가능한 가중치 이름에 대한 예시이다. 표 1 패치크기 가중치 이름 128X128 W1 256X256 W2 512X512 W3 1024X1024 W4 다시 도 1을 참조하면, 판단부는 이상 점수(anomaly score)를 이용해 입력 영상의 상태를 정상 또는 비정 상으로 판단할 수 있다. 예를 들면 판단부는 이상 점수(anomaly score)와 임계 값을 비교하여 정상 또는 비정상으로 판단할 수 있다. 판단부는 임계 값보다 이상 점수(anomaly score)가 낮은 경우 비정상으로 판 단할 수 있다. 도 11은 본 발명의 일 실시 예에 따른 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 방법을 도시한 도면이다. 이하 설명하는 과정은 각 단계에서 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장치를 구성하는 각 기능부가 수행하는 과정이나, 본 발명의 간결하고 명확한 설명을 위해 각 단계의 주체를 고해상도 영상을 활 용한 딥 러닝 기반 이상 탐지 장치로 통칭하도록 한다. 도11을 참조하면, S1110 단계에서 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장치는 고해상도 영상을 입력받아 해상도를 조정한다. 예를 들면 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장치는 고해상도 의 방사선 촬영 영상을 입력받는다. 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장치는 해상도를 1024X1024로 조정할 수 있다. S1120 단계에서 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장치는 고해상도의 영상을 이용하여 서로 다른 다양한 크기의 패치 영상들을 생성할 수 있다. S1130 단계에서 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장치는 특징 추출 네트워크를 이용해 패치 영상의 특징을 추출할 수 있다. 이때 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장치는 특징 추출 네 트워크를 이용해 학습 데이터의 특징을 담고 있는 학습 데이터베이스를 생성할 수 있다. 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장치는 각 패치 영상 크기에 따른 각각의 특징 추출 네트 워크를 수행하여 크기 별 특징을 담은 학습 데이터베이스를 각각 생성할 수 있다. 예를 들면 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장치는 SimCLR 네트워크를 특징 추출 네트워크로 사용할 수 있고, 패치 영 상의 해상도에 따라 SimCLR 네트워크를 개별로 수행하여, feature128X128, feature256X256, feature512X512 및 feature1024X1024 학습 데이터베이스를 각각 생성하여 저장한다. S1140 단계에서 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장치는 생성된 패치 영상에서 추출한 특징 값과 학습 데이터의 특징을 담고 있는 학습 데이터베이스와의 유사도를 측정할 수 있다. 고해상도 영상을 활용 한 딥 러닝 기반 이상 탐지 장치는 각 패치 영상의 특징 값과 학습 데이터베이스에서 동일한 위치의 패치 특징 값을 비교하여 유사도를 측정할 수 있다. 또한 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장치 는 작은 패치 해상도 영상에서는 각 패치 영상의 위치와 동일한 위치의 학습 데이터베이스 특징 값의 유사도 뿐 만 아니라 파라미터 d를 이용해 주변 영역에 대해서도 유사도를 측정하여 활용할 수 있다. 예를 들면 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장치는 다양한 유사도 측정 알고리즘을 이용할 수 있다. 예를 들면, 대표적인 유사도 측정 알고리즘인 유클리디안 거리(Euclidean Distance), 맨해튼 거리 (Manhattan Distance), 코사인 유사도(Cosine Similarity), 마할라노비스 거리(Mahalanobis Distance) 등 다양한 측정 방식을 사용할 수 있다. S1150 단계에서 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장치는 최종적으로 고해상도 영상의 정보 가 정상 또는 비정상을 판단하는 근거인 이상 점수(anomaly score)를 산출할 수 있다. 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장비는 유사도 값을 기반으로 각 패치 영상의 크기를 결합하여 이상 점수를 산출할 수 있고, 이상 점수 지도(anomaly score map)를 생성할 수 있다. 고해상도 영상을 활용한 딥 러닝 기반 이상 탐 지 장치는 S1140 단계에서 수행한 다양한 유사도 측정 방식에 따란 다양한 범위의 이상 점수(anomaly score)를 산출할 수 있다. 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장치는 이상 점수(anomaly score)의 용이한 비교를 위해 모든 이상 점수(anomaly score)는 0 이상의 값을 가지는 범위로 변경하여 사용할 수 있다. 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장치는 패치 영상을 좀 더 효과적으로 사용하기 위해 각 패치 크기에 따른 결과 값에 각각의 가중치를 설정할 수 있다. S1160 단계에서 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장치는 도 12 내지 도 14는 본 발명의 일 실시 예에 따른 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장치의 성능 비교 실험 결과 예시들이다. 도 12를 참조하면, 다양한 유사도 측정 방식 가운데 실험 결과 Mahalanobis 유사도 측정방식이 가장 좋은 성능 을 보였으며 패치 해상도는 512x512를 단독으로 사용해 Anomaly Score를 판단했을 때 가장 분류 성능이 좋았다. 도 13은 유사도 측정 방식에서 좋은 성능을 나타낸 코사인 및 마할라노비스 유사도 측정 방식과 패치 영상 별 가중치를 설정한 패치 결합을 이용한 성능 비교 결과이다. 도 13을 참조하면, 패치 영상 별 가중치를 -0, -1.2, -1.2, -1로 설정했을 때 가장 좋은 분류 성능을 보여줬다. 도 14는 다양한 비교 네트워크와 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장치의 성능 비교 실험의 결과로 다른 네트워크 들과의 성능을 비교했을 때도 본 발명이 가장 좋은 성능을 보였다. 도 14를 참조하면, 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장치의 실시 예 중 성능이 가장 좋은 모델인 Mahalanobis 유사도 측정 방식으로 -0, -1.2, -1.2, -1로 가중치를 설정했을 때의 성능이 가장 좋다. 상술한 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 방법은 컴퓨터가 읽을 수 있는 매체 상에 컴퓨터가 읽 을 수 있는 코드로 구현될 수 있다. 상기 컴퓨터로 읽을 수 있는 기록 매체는, 예를 들어 이동형 기록 매체(CD, DVD, 블루레이 디스크, USB 저장 장치, 이동식 하드 디스크)이거나, 고정식 기록 매체(ROM, RAM, 컴퓨터 구비형 하드 디스크)일 수 있다. 상기 컴퓨터로 읽을 수 있는 기록 매체에 기록된 상기 컴퓨터 프로그램은 인터넷 등의 네트워크를 통하여 다른 컴퓨팅 장치에 전송되어 상기 다른 컴퓨팅 장치에 설치될 수 있고, 이로써 상기 다른컴퓨팅 장치에서 사용될 수 있다. 이상에서, 본 발명의 실시 예를 구성하는 모든 구성 요소들이 하나로 결합되거나 결합되어 동작하는 것으로 설 명되었다고 해서, 본 발명이 반드시 이러한 실시 예에 한정되는 것은 아니다. 즉, 본 발명의 목적 범위안에서라 면, 그 모든 구성요소들이 하나 이상으로 선택적으로 결합하여 동작할 수도 있다. 도면에서 동작들이 특정한 순서로 도시되어 있지만, 반드시 동작들이 도시된 특정한 순서로 또는 순차적 순서로 실행되어야만 하거나 또는 모든 도시 된 동작들이 실행되어야만 원하는 결과를 얻을 수 있는 것으로 이해되어서 는 안 된다. 특정 상황에서는, 멀티태스킹 및 병렬 처리가 유리할 수도 있다. 더욱이, 위에 설명한 실시 예 들 에서 다양한 구성들의 분리는 그러한 분리가 반드시 필요한 것으로 이해되어서는 안 되고, 설명된 프로그램 컴 포넌트들 및 시스템들은 일반적으로 단일 소프트웨어 제품으로 함께 통합되거나 다수의 소프트웨어 제품으로 패 키지 될 수 있음을 이해하여야 한다. 이제까지 본 발명에 대하여 그 실시 예들을 중심으로 살펴보았다. 본 발명이 속하는 기술 분야에서 통상의 지식 을 가진 자는 본 발명이 본 발명의 본질적인 특성에서 벗어나지 않는 범위에서 변형된 형태로 구현될 수 있음을 이해할 수 있을 것이다. 그러므로 개시된 실시 예들은 한정적인 관점이 아니라 설명적인 관점에서 고려되어야 한다. 본 발명의 범위는 전술한 설명이 아니라 특허청구범위에 나타나 있으며, 그와 동등한 범위 내에 있는 모 든 차이점은 본 발명에 포함된 것으로 해석되어야 할 것이다."}
{"patent_id": "10-2022-0056815", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1 내지 3은 본 발명의 일 실시예에 따른 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장치를 설명하기 위한 도면들. 도 4는 본 발명의 일 실시 예에 따른 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장치의 패치 영상 예시들. 도 5 내지 도 7은 본 발명의 일 실시 예에 따른 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장치의 딥 러 닝 네트워크를 간략히 설명하기 위한 도면들. 도 8 내지 도 10은 본 발명의 일 실시 예에 따른 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장치의 유사 도 측정 방법에 대한 설명을 하기 위한 도면들. 도 11은 본 발명의 일 실시 예에 따른 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 방법을 도시한 도면. 도 12 내지 도 15는 본 발명의 일 실시 예에 따른 고해상도 영상을 활용한 딥 러닝 기반 이상 탐지 장치의 성능 비교 실험 결과 예시들."}
