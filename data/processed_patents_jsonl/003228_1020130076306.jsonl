{"patent_id": "10-2013-0076306", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2015-0011036", "출원번호": "10-2013-0076306", "발명의 명칭": "이더넷 기반의 차량 네트워크 메시지 전달 시스템 및 방법", "출원인": "현대자동차주식회사", "발명자": "서석현"}}
{"patent_id": "10-2013-0076306", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "또는 청구항 3에 있어서, 상기 이더넷 스위치는 분할 과정에서 게이트웨이로부터 수신된 이더넷 메시지의 프레임을 분석하여 이더넷 메시지에 포함된 개별 메시지들을 구분하고, 각 개별 메시지들의 헤더를 분석하여 개별 메시지의 목적지 주소를 확인한 뒤, 목적지에 따라 각각 개별 메시지의 정보가 포함된 이더넷 메시지를 분할, 생성하는 것을 특징으로 하는 이더넷 기반의 차량 네트워크 메시지 전달 방법."}
{"patent_id": "10-2013-0076306", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "청구항 1에 있어서,이더넷 스위치에 연결된 차량 기기들이 이더넷 메시지를 전송하여 이더넷 스위치가 수신하는 단계; 및이더넷 스위치가 차량 기기들로부터 수신한 이더넷 메시지들을 하나의 이더넷 메시지로 병합하여 게이트웨이로전송하는 단계;를 더 포함하는 것을 특징으로 하는 이더넷 기반의 차량 네트워크 메시지 전달 방법."}
{"patent_id": "10-2013-0076306", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "청구항 2에 있어서,상기 이더넷 스위치는 수신된 이더넷 메시지의 프레임을 분석하여 상기한 이더넷 메시지의 분할 또는 병합 여부를 결정한 뒤, 메시지 분할 알고리즘과 메시지 병합 알고리즘 중 하나를 호출하여 각 알고리즘에 따라 분할 또는 병합 과정을 수행하는 것을 특징으로 하는 이더넷 기반의 차량 네트워크 메시지 전달 방법."}
{"patent_id": "10-2013-0076306", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "청구항 3에 있어서,상기 메시지 병합 알고리즘에서, 수신된 이더넷 메시지의 프레임 정보로부터 룩업 테이블을 검색하여 병합이 필요한 메시지인지를 확인하고, 병합이 필요한 이더넷 메시지인 경우 게이트웨이트로 전송할 하나의 이더넷 메시지에 추가하여 병합하는 것을 특징으로 하는 이더넷 기반의 차량 네트워크 메시지 전달 방법."}
{"patent_id": "10-2013-0076306", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "청구항 3에 있어서,상기 메시지 병합 알고리즘에서, 다른 신규 메시지의 수신, 신규 메시지의 병합 필요 확인, 신규 메시지의 병합과정을 설정 시간 경과시까지 또는 정해진 개수의 메시지 병합 완료시까지 반복한 뒤 병합 완료한 이더넷 메시지를 게이트웨이로 전송하는 것을 특징으로 하는 이더넷 기반의 차량 네트워크 메시지 전달 방법. 공개특허 10-2015-0011036-3-청구항 6"}
{"patent_id": "10-2013-0076306", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "청구항 6에 있어서,상기 이더넷 스위치는 각 개별 메시지의 헤더에서 식별부호(ID) 및 헤더 길이를 읽어들인 뒤 룩업 테이블을 검색하여 목적지 주소를 확인하는 것을 특징으로 하는 이더넷 기반의 차량 네트워크 메시지 전달 방법."}
{"patent_id": "10-2013-0076306", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "청구항 1에 있어서,상기 이종의 차량 네트워크는 CAN(Controller Area Network), LIN(Local Interconnect Network) 및 FlexRay 중어느 하나 이상을 포함하는 것을 특징으로 하는 이더넷 기반의 차량 네트워크 메시지 전달 방법."}
{"patent_id": "10-2013-0076306", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "이더넷을 이종의 프로토콜을 갖는 차량 네트워크와 연결하는 게이트웨이; 및 게이트웨이와 차량 기기 간에 이더넷 메시지를 스위칭하여 전달하는 이더넷 스위치를 포함하는 차량 네트워크 메시지 전달 시스템에 있어서,상기 이더넷 스위치는 상기 이종의 차량 네트워크에서 게이트웨이를 통해 수신된 이더넷 메시지를 전달하는 프로세싱 모듈; 상기 프로세싱 모듈에서 전달된 메시지의 스위칭을 담당하는 차량 네트워크 처리 모듈; 및 차량 네트워크 처리 모듈의 스위칭에 필요한 정보가 저장된 룩업 테이블;을 포함하며, 차량 네트워크 처리 모듈은 게이트웨이에서 프로세싱 모듈을 통해 전달된 이더넷 메시지를 분석하여 이더넷 메시지 내 개별 메시지들의 목적지를 확인하고, 상기 이더넷 메시지로부터 목적지에 따라 개별 메시지의 정보가 포함된 이더넷 메시지를 분할, 생성하여 목적지의 차량 기기에 전송하도록 된 것을 특징으로 하는이더넷 기반의 차량 네트워크 메시지 전달 시스템."}
{"patent_id": "10-2013-0076306", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "청구항 9에 있어서,상기 차량 네트워크 처리 모듈은 이더넷 스위치에 연결된 차량 기기들로부터 이더넷 메시지를 전달받은 경우,전달받은 이더넷 메시지들을 하나의 이더넷 메시지로 병합한 뒤 게이트웨이로 전송하도록 된 것을 특징으로 하는 이더넷 기반의 차량 네트워크 메시지 전달 시스템."}
{"patent_id": "10-2013-0076306", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "청구항 10에 있어서,공개특허 10-2015-0011036-4-상기 차량 네트워크 처리 모듈은 수신된 이더넷 메시지의 프레임을 분석하여 상기한 이더넷 메시지의 분할 또는병합 여부를 결정하고, 메시지 분할 알고리즘과 메시지 병합 알고리즘 중 하나를 호출하여 각 알고리즘에 따라분할 또는 병합 과정을 수행하도록 된 것을 특징으로 하는 이더넷 기반의 차량 네트워크 메시지 전달 시스템."}
{"patent_id": "10-2013-0076306", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "청구항 11에 있어서,상기 메시지 병합 알고리즘에서, 수신된 이더넷 메시지의 프레임 정보로부터 룩업 테이블을 검색하여 병합이 필요한 메시지인지를 확인하고, 병합이 필요한 이더넷 메시지인 경우 게이트웨이트로 전송할 하나의 이더넷 메시지에 추가하여 병합하는 것을 특징으로 하는 이더넷 기반의 차량 네트워크 메시지 전달 시스템."}
{"patent_id": "10-2013-0076306", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "청구항 12에 있어서,상기 메시지 병합 알고리즘에서, 다른 신규 메시지의 수신, 신규 메시지의 병합 필요 확인, 신규 메시지의 병합과정을 설정 시간 경과시까지 또는 정해진 개수의 메시지 병합 완료시까지 반복한 뒤 병합 완료한 이더넷 메시지를 게이트웨이로 전송하는 것을 특징으로 하는 이더넷 기반의 차량 네트워크 메시지 전달 시스템."}
{"patent_id": "10-2013-0076306", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_14", "content": "청구항 9 또는 청구항 11에 있어서, 상기 차량 네트워크 처리 모듈은 분할 과정에서 게이트웨이로부터 수신된 이더넷 메시지의 프레임을 분석하여이더넷 메시지에 포함된 개별 메시지들을 구분하고, 각 개별 메시지들의 헤더를 분석하여 개별 메시지의 목적지주소를 확인한 뒤, 목적지에 따라 각각 개별 메시지의 정보가 포함된 이더넷 메시지를 분할, 생성하는 것을 특징으로 하는 이더넷 기반의 차량 네트워크 메시지 전달 시스템."}
{"patent_id": "10-2013-0076306", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_15", "content": "청구항 14에 있어서,상기 차량 네트워크 처리 모듈은 각 개별 메시지의 헤더에서 식별부호(ID) 및 헤더 길이를 읽어들인 뒤 룩업 테이블을 검색하여 목적지 주소를 확인하는 것을 특징으로 하는 이더넷 기반의 차량 네트워크 메시지 전달시스템."}
{"patent_id": "10-2013-0076306", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_16", "content": "청구항 9에 있어서,상기 이종의 차량 네트워크는 CAN(Controller Area Network), LIN(Local Interconnect Network) 및 FlexRay 중어느 하나 이상을 포함하는 것을 특징으로 하는 이더넷 기반의 차량 네트워크 메시지 전달 시스템.명 세 서기 술 분 야본 발명은 차량 네트워크 시스템 및 방법에 관한 것으로서, 더욱 상세하게는 CAN, LIN, FlexRay 등의 차량 네트 [0001]워크와 이더넷(Ethernet)이 연결된 차량 네트워크 구조에서 메시지 전달 과정에서 나타나는 대역폭 낭비와 오버헤드 발생 등의 문제점이 해결될 수 있고, 차량 기기들 간의 보다 효율적인 통신이 가능해지는 시스템과 방법에관한 것이다.공개특허 10-2015-0011036-5-배 경 기 술최근 들어 자동차에 관련된 전자기술 및 통신기술의 발전이 급격히 진행됨에 따라 차량에 적용되는 전자 시스템 [0002]의 수와 종류가 크게 늘어나고 있다. 예를 들면, 자동차에서 엔진 제어나 배기가스 제어에 관련된 제어 시스템, 그리고 에어백 시스템 등의 안전 시 [0003]스템에 더하여, 정보 및 멀티미디어 재생 시스템, 인공지능 시스템, 후방 감지 시스템, 어라운드 뷰 모니터링(AVM:Around View Monitoring) 시스템, 차선 이탈 경보 시스템(LDWS:Lane Departure Warning System), 충돌 방지 시스템(CAS:Collision Avoidance System), 교통표지판 인식 시스템과 같은 전자 시스템에 대한 다양한 요구들이 지속적으로 증가하고 있다. 이러한 전자 시스템에서는 카메라나 각종 센서 등의 정보수집장치 및 상/하위 제어기 등의 차량 기기들이 통신 [0004]네트워크를 통해 서로 연결되어 있으며, 이에 따라 보다 효율적인 전자 시스템을 구성하기 위해 다양한 기능들을 지원하면서도 각 기능을 위한 별도의 전용 배선을 줄일 수 있는 네트워크 구조가 요구되고 있다.아울러, 상기한 네트워크 구조를 구성하기 위해 고대역폭 및 높은 유연성, 결정적(deterministic) 동작을 제공 [0005]하는 프로토콜들이 요구되고 있으며, 최근 배선 구조와 상위 레벨 시스템과의 통신 규약을 정의한 다양한 프로토콜들이 차량에 적용되고 있다. CAN(Controller Area Network), LIN(Local Interconnect Network), Flexray 등이 그 대표적인 프로토콜들이며, [0006]그 외에 차량 내에서 각기 장점을 발휘할 수 있는 다양한 프로토콜이 개발되고 있고, 여러 프로토콜 간의 데이터 변환을 통해 이질적인 차량 내 프로토콜을 연결하고 이들을 통합 운영할 수 있는 통합 네트워크 시스템의 개발도 이루어지고 있다.최근 통신 시스템이나 제어 시스템, 영상 제공 시스템 등과 같은 차량 시스템에서 이더넷(Ethernet)을 이용하는 [0007]기술들이 제시되고 있으며, 차량에서의 이더넷 이용에 대한 선행특허문헌으로는 한국공개특허 제10-2013-0003902호(2013.1.9.), 한국공개특허 제10-2012-0107783호(2012.10.4.), 한국등록특허 제10-1033793호(2011.5.2.), 한국공개특허 제10-2011-0038197호(2011.4.14.) 등을 들 수 있다.또한 최근의 차량에서는 센서류나 카메라, 레이저 스캐너 등과 같은 다양한 기기들이 사용되고 있고, 차량 기기 [0008]들의 수가 점차 증가함에 따라 기존의 차량 네트워크(CAN, LIN, Flexray 등)로는 요구 대역폭을 지원하기 어려울 것으로 예상되고 있다.이를 위해, 차량에서도 이더넷 오디오 비디오 브리징(AVB:Audio Video Bridging, 이하, 'AVB'라 칭함) 기술이 [0009]적용될 것으로 예상되고 있으며, 이더넷 AVB 기술은 오디오, 비디오 등의 스트링 데이터를 전송하기 위한 프로토콜로, 아직까지 차량과 관련한 기술 개발은 미흡한 실정이다.AVB가 적용된 이더넷을 이용하는 차량 전자 시스템에서는 차량 기기들이 하나 또는 그 이상의 이더넷 링크들을 [0010]통해 통신 가능하게 연결되고, 멀티미디어, 제어, 진단, 감지 정보 등의 각종 정보를 주고받기 위해 AVB를 이용하는 이더넷 링크 상에서 전자 장치 간의 통신이 이루어진다.도 1은 이더넷 AVB가 기존의 차량 네트워크와 게이트웨이로 연결되어 있는 차량 네트워크 시스템의 구성이고, [0011]도 2는 이더넷 AVB의 메시지 프레임 포맷 및 송수신 방법을 설명하기 위한 도면이다.도 1에 나타낸 바와 같이 이더넷 AVB가 게이트웨이(gateway)를 통해 CAN, LIN, FlexRay 등의 차량 네트워크에 [0012]연결되어 있는 경우, 데이터 크기가 작은 여러 개의 메시지가 하나의 이더넷 메시지에 통합되어 전송될 수있다.이때, 이더넷 메시지에 포함된 차량 네트워크 메시지(기기들이 전송하는 정보들이 포함된 메시지)의 목적지 노 [0013]드(Node)가 다를 경우, 이더넷 메시지가 여러 개의 노드(메시지를 송수신하는 차량 내 각 기기들)로 중복 전송되어야 하고, 이를 수신한 각 노드는 여러 개의 차량 네트워크 메시지 중에 자신이 필요로 하는 메시지를 추출하여 사용해야 하는 문제가 발생한다.이러한 종래의 문제점에 대해 좀더 상세히 설명하면 다음과 같다. [0014]CAN, LIN, FlexRay와 같은 차량 네트워크에서 이더넷 AVB 상에 차량 네트워크 메시지를 전송하기 위한 관련 표 [0015]준을 IEEE 1722a에서 정의하고 있다. 공개특허 10-2015-0011036-6-즉, IEEE 1722a의 드래프트(draft) 버전에서 CAN 메시지에 대한 프레임 포맷은 AVB 헤더와 복수의 CAN 메시지로 [0016]구성되며, 이때 각 메시지는 수신한 시점의 시간을 ns 단위로 측정한 타임스탬프(timestamp) 값을 포함한다. 또한 이더넷 AVB 내의 모든 노드는 IEEE 802.1AS에 따라 시간 동기화가 되어 있으며, 도 1의 게이트웨이는 LIN, [0017]CAN, FlexRay로부터 메시지를 수신한 뒤 도 2에서와 같이 하나의 이더넷 AVB 프레임에 복수의 메시지를 포함시켜 전송할 수 있다.여기서, 이더넷은 헤더에 대한 오버헤드가 있으므로 최대한 데이터 크기를 크게 전송하는 것이 효율적이다. [0018]만약, 종래와 같이 하나의 이더넷 AVB 프레임 내에 도 1의 노드 1과 노드 2로 전송해야 하는 복수의 CAN 메시지 [0019]를 함께 포함시킬 경우, 동일한 이더넷 AVB 메시지를 각각의 모든 노드로 전송해야 한다. 따라서, 노드 1의 경우 불필요한 노드 2의 정보를 수신하게 되므로 네트워크의 대역폭을 낭비하게 되고, 수신하 [0020]는 각 노드가 이더넷 AVB 메시지에서 자신이 필요한 정보를 추출하는 오버헤드가 발생하게 된다. 반면, 하나의 이더넷 AVB 프레임 내에 목적지가 특정 노드인 하나의 메시지만을 담을 경우에는 작은 이더넷 AVB [0021]프레임을 다수 전송해야 하므로 역시 오버헤드 문제가 발생하게 된다. 그리고, 차량의 이더넷은 기존의 대표적인 차량 네트워크인 LIN, CAN, FlexRay와 연동되어 사용될 수 있어야 한 [0022]다. 이를 위해, 도 1 및 도 2에 나타낸 바와 같은 게이트웨이가 사용되며, 프레임 크기가 작은 CAN 메시지 등 1개 [0023]이상의 차량 네트워크 메시지를 하나의 이더넷 메시지에 포함시켜 전송하는 게이트웨이 관련 기술이 제시되어있다.또한 차량의 이더넷 메시지에 CAN, LIN, FlexRay 등을 통해 전송된 차량 네트워크 메시지를 담을 수 있는 프레 [0024]임 포맷도 IEEE 1722a 드래프트 버전으로 공개되어 있으며, 향후 표준으로 제정될 것으로 예상된다. 이하, 본 명세서에서 차량 네트워크 메시지는 LIN, CAN, FlexRay 등의 차량 네트워크에 연결된 기기들, 그리고 [0025]이더넷 스위치에 연결된 노드들(노드 1 ~ 노드 n)이 전송하는 메시지를 의미하며, 여기서 LIN, CAN, FlexRay 등에 연결된 기기들과 이더넷 스위치에 연결된 노드들은 서로 간에 통신을 필요로 하는 차량 내 제어기가 될 수있다.이러한 차량 네트워크 메시지에는 제어기들 간에 주고받아야 하는 정해진 정보들이 포함되며, 더불어 메시지의 [0026]발신지 및 목적지 등의 정보(주소나 식별부호(ID) 등)가 포함된다.현재 이더넷 스위치(switch) 기술은 인터넷 기술 및 산업용 네트워크 기술에서 이미 개발되어 있으며, 이러한 [0027]산업분야에서는 이더넷만을 고려하였기 때문에 통상 이더넷 스위치는 MAC 어드레스를 기반으로 목적지 포트로해당 메시지를 전달한다. 이때, 도 2에 나타낸 바와 같이 5개의 차량 네트워크 메시지를 하나의 이더넷 메시지에 포함시키되, 메시지 1, [0028]3은 노드 1로, 메시지 2는 노드 3으로, 메시지 4, 5는 노드 4로 전달해야 하는 경우에서도, 기존 스위치 기술에서는 내부 차량 네트워크 메시지를 고려하지 않기 때문에 전체 이더넷 메시지를 각 노드로 복사하여 동일하게전달한다. 이로 인해 전체 네트워크에 오버헤드가 발생하며, 또한 메시지를 수신한 노드가 전체 이더넷 메시지를 분석하여 [0029]자신이 필요한 메시지를 추출하여 사용해야 하는 문제점이 발생한다.요컨대, 종래의 이더넷 스위치는 이더넷 MAC 주소를 기반으로 이더넷 프레임 전체를 스위칭하며, 차량에서 이더 [0030]넷을 활용할 경우 CAN, LIN, FlexRay 등의 기존 차량 네트워크와 연동이 필요하다. 이 경우에서 이더넷 메시지 내에 여러 개의 차량 네트워크 메시지가 포함되어 전송될 수 있는데, 이더넷 스위치 [0031]가 MAC 주소를 기반으로 스위칭을 수행하므로 각각 특정 노드로만 전송되어야 하는 여러 개의 차량 네트워크 메시지를 하나의 이더넷 메시지에 포함시켜야 한다. 이와 같이 다양한 MAC 주소의 각 노드로 전송되어야 할 복수의 차량 네트워크 메시지가 하나의 이더넷 메시지에 [0032]포함되는 경우에서 동일한 메시지를 복사하여 복수의 노드로 전송해야 하고, 이로 인해 네트워크의 대역폭이 낭비됨은 물론, 각 노드에서는 전체 이더넷 메시지 내에서 필요한 데이터를 추출하여 사용하여야 하므로 오버헤드가 발생한다. 공개특허 10-2015-0011036-7- [0033]발명의 내용해결하려는 과제따라서, 본 발명은 상기와 같은 문제점을 해결하기 위하여 창출한 것으로서, CAN, LIN, FlexRay 등의 차량 네트 [0034]워크에서 전송된 복수의 차량 네트워크 메시지를 게이트웨이에서 하나의 이더넷 메시지에 포함시켜 전송하고 이더넷 스위치에서 동일한 이더넷 메시지를 복사하여 복수의 노드로 스위칭하는 종래의 방식이 가지는 문제점, 즉대역폭 낭비 및 오버헤드 발생 등의 문제점이 해결될 수 있으면서 보다 효율적으로 메시지를 송수신할 수 있는시스템과 방법을 제공하는데 그 목적이 있다.과제의 해결 수단상기한 목적을 달성하기 위해, 본 발명은, 이종의 프로토콜을 갖는 차량 네트워크와 이더넷이 게이트웨이를 통 [0035]해 연결된 차량 네트워크 시스템에서, 상기 이더넷과 이종의 차량 네트워크를 통해 차량 기기들 간에 메시지를전달하는 방법에 있어서, 게이트웨이가 상기 이종의 차량 네트워크를 통해 차량 기기들로부터 목적지를 달리하는 개별 메시지들을 수신하는 단계; 게이트웨이가 상기 수신된 개별 메시지들을 하나의 이더넷 메시지에 포함시켜 이더넷 스위치로 전송하는 단계; 이더넷 스위치가 수신된 이더넷 메시지를 분석하여 이더넷 메시지에 포함된개별 메시지들의 목적지를 확인하는 단계; 및 이더넷 스위치가 상기 수신된 이더넷 메시지로부터 목적지에 따라개별 메시지의 정보가 포함된 이더넷 메시지를 분할, 생성하여 각 목적지에 해당하는 차량 기기에 전송하는 단계;를 포함하는 이더넷 기반의 차량 네트워크 메시지 전달 방법을 제공한다. 또한 상기한 본 발명의 차량 네트워크 메시지 전달 방법은, 이더넷 스위치에 연결된 차량 기기들이 메시지를 전 [0036]송하여 이더넷 스위치가 수신하는 단계; 및 이더넷 스위치가 차량 기기들로부터 수신한 메시지들을 하나의 이더넷 메시지로 병합하여 게이트웨이로 전송하는 단계;를 더 포함하여 구성될 수 있다.그리고, 본 발명은, 이더넷을 이종의 프로토콜을 갖는 차량 네트워크와 연결하는 게이트웨이; 및 게이트웨이와 [0037]차량 기기 간에 이더넷 메시지를 스위칭하여 전달하는 이더넷 스위치를 포함하는 차량 네트워크 메시지 전달 시스템에 있어서, 상기 이더넷 스위치는 상기 이종의 차량 네트워크에서 게이트웨이를 통해 수신된 이더넷 메시지를 전달하는 프로세싱 모듈; 상기 프로세싱 모듈에서 전달된 메시지의 스위칭을 담당하는 차량 네트워크 처리모듈; 및 차량 네트워크 처리 모듈의 스위칭에 필요한 정보가 저장된 룩업 테이블;을 포함하며, 차량 네트워크처리 모듈은 게이트웨이에서 프로세싱 모듈을 통해 전달된 이더넷 메시지를 분석하여 이더넷 메시지 내 개별 메시지들의 목적지를 확인하고, 상기 이더넷 메시지로부터 목적지에 따라 개별 메시지의 정보가 포함된 이더넷 메시지를 분할, 생성하여 목적지의 차량 기기에 전송하도록 된 이더넷 기반의 차량 네트워크 메시지 전달 시스템을 제공한다.발명의 효과이에 따라, 본 발명의 차량 네트워크 메시지 전달 시스템 및 방법에 의하면, 이더넷 스위치가 게이트웨이로부터 [0038]수신한 메시지를 분할한 후 각 메시지를 해당 목적지에 전달하는 방식이 적용됨으로써, 이더넷 스위치에서 동일한 이더넷 메시지를 복사하여 복수의 노드로 스위칭하는 종래의 방식이 가지는 대역폭 낭비 및 오버헤드 발생등의 문제점이 해결될 수 있고, 효율적인 메시지를 송수신이 가능해진다.도면의 간단한 설명도 1은 종래기술에서 이더넷 AVB가 기존의 차량 네트워크와 게이트웨이로 연결되어 있는 차량 네트워크 시스템 [0039]의 구성이다. 도 2는 이더넷 AVB의 메시지 프레임 포맷 및 송수신 방법을 설명하기 위한 도면이다.도 3과 도 4는 본 발명의 실시예에 따른 시스템의 구성도이다.공개특허 10-2015-0011036-8-도 5는 본 발명에 따른 시스템에서 스위치의 구성을 나타내는 블록도이다.도 6 내지 도 9는 본 발명에 따른 메시지 송수신 방법을 나타내는 순서도이다.발명을 실시하기 위한 구체적인 내용이하, 첨부한 도면을 참조하여 본 발명의 실시예에 대해 본 발명이 속하는 기술분야에서 통상의 지식을 가진 자 [0040]가 용이하게 실시할 수 있도록 상세히 설명하기로 한다.도 3과 도 4는 본 발명의 실시예에 따른 시스템의 구성도로, CAN, LIN, FlexRay 등의 차량 네트워크가 게이트웨 [0041]이를 통해 이더넷 AVB에 연결된 구성을 보여주고 있다.도시된 바와 같이, 차량 내 복수의 기기들이 각종 정보(다른 기기에서 필요로 하는 정보)를 포함하는 메시지를 [0042]송수신할 수 있도록 CAN, LIN, FlexRay 등의 차량 네트워크에 연결된다.또한 차량에서 이더넷이 복수의 차량 네트워크와 연동하여 이용될 수 있도록 이더넷 AVB가 게이트웨이를 통해 [0043]CAN, LIN, FlexRay 등의 차량 네트워크에 통신 가능하게 연결된다.상기 게이트웨이는 이질적인 복수의 네트워크, 즉 CAN, LIN, FlexRay 등의 네트워크와 이더넷을 연결하는 구성 [0044]요소로, CAN, LIN, FlexRay 등의 네트워크를 통해 목적지가 다른 여러 개의 차량 네트워크 메시지를 수신한 뒤,목적지가 다른 여러 개의 수신된 메시지를 하나의 이더넷 프레임에 담아 이더넷 스위치로 전송한다.또한 상기 게이트웨이에 연결된 이더넷 스위치는 메시지의 송/수신처가 되는 차량 내 각 기기, 즉 단수 또는 복 [0045]수의 노드(노드 1 ~ 5, 노드 n)들에 통신 가능하게 연결된다.이때, 이더넷 스위치(이하, '스위치 1'이라 칭함)의 미리 지정된 통신포트에 게이트웨이와 각 노드들이 연결되 [0046]며, 스위치 1은 지정된 별도의 통신포트를 통해 다른 이더넷 스위치(이하, '스위치 2'라 칭함)와도 메시지의 송수신이 가능하도록 연결될 수 있다.여기서, 상기 스위치 2 역시 미리 지정된 각 통신포트를 통해 메시지의 송수신처가 되는 단수 또는 복수의 노드 [0047]들과 통신 가능하게 연결된다. 본 발명에서 CAN, LIN, FlexRay 등의 차량 네트워크에 연결된 단수 또는 복수의 기기들과 스위치에 연결된 노드 [0048]들은 서로 간에 통신을 필요로 하는 차량 기기들, 예컨대 차량 전자 시스템의 제어기들이 될 수 있다.한편, 종래의 알려진 여러 문제점을 해결하기 위한 메시지 전달 과정을 살펴보면, 먼저 게이트웨이는 CAN, LIN, [0049]FlexRay 등의 차량 네트워크들로부터 차량 네트워크 메시지를 수신한 뒤 수신된 복수의 차량 네트워크 메시지를하나의 이더넷 메시지에 포함시켜 스위치 1로 전송하게 된다.이어 스위치 1은 게이트웨이로부터 이더넷 메시지를 수신하는 경우, 수신된 이더넷 메시지의 헤더 및 내부의 각 [0050]차량 네트워크 메시지에 지정되어 있는 주소(또는 식별부호)를 참조하여 각 차량 네트워크 메시지의 목적지 경로에 따라 이더넷 메시지를 분할하는데, 이 과정에서 각 차량 네트워크 메시지에 대한 분할된 이더넷 메시지를생성한 뒤, 각 분할된 이더넷 메시지를 지정된 통신포트를 통해 해당 목적지 노드로 전송하게 된다.이때, 스위치 1에서 분할된 이더넷 메시지가 지정된 통신포트를 통해 스위치 2로 전송될 수 있고, 전송된 이더 [0051]넷 메시지는 스위치 2에서 분할 없이 하나의 목적지 노드로 전달되거나(도 4 참조), 또는 스위치 2에서 최종 목적지 노드가 복수인 경우 메시지에 지정되어 있는 주소에 따라 이더넷 메시지가 다시 분할된 뒤 분할된 각 이더넷 메시지가 지정된 통신포트를 통해 각각의 최종 목적지 노드로 전송된다(도 3 참조). 요컨대, 스위치 1이 게이트웨이로부터 전송된 이더넷 메시지를 수신하여 이더넷 메시지 및 개별 차량 네트워크 [0052]메시지를 분석한 뒤, 각 차량 네트워크 메시지의 목적지에 대해 각각의 이더넷 메시지를 만들어 전송하는 것이다. 반대로 각 노드가 CAN, LIN, FlexRay로 전송할 차량 네트워크 메시지를 스위치로 전송하면, 각 스위치는 해당 [0053]메시지들을 병합한 뒤 병합된 이더넷 메시지를 지정된 통신포트를 통해 게이트웨이로 전송한다. 도 5는 본 발명에 따른 시스템에서 스위치의 구성을 나타내는 블록도로서, 스위치는, 이더넷 메시지가 수신된 [0054]통신포트 정보와 수신된 이더넷 메시지를 분석하여 각 처리 모듈로 전달하거나 각 처리 모듈에서 전달받은 메시지를 해당 통신포트로 전달하는 프로세싱 모듈; 표준 이더넷 또는 기타 이더넷 메시지를 스위칭할 수 있는 표준공개특허 10-2015-0011036-9-이더넷 처리 모듈 및 기타 이더넷 처리 모듈; CAN, LIN, FlexRay 등의 차량 네트워크에서 게이트웨이를 통해 전달된 차량 네트워크 메시지의 스위칭을 담당하는 차량 네트워크 처리 모듈; 각 처리 모듈의 스위칭에 필요한 정보를 저장하고 있는 룩업 테이블; 및 스위치의 기능 및 룩업 테이블의 정보를 변경할 수 있는 설정 모듈을 포함하여 구성된다.도 6 내지 도 9는 본 발명에 따른 메시지 송수신 방법을 나타내는 순서도로서, 도 6은 차량 네트워크 메시지의 [0055]효율적인 송수신을 위해 스위치의 프로세싱 모듈에서 이루어지는 알고리즘을 나타내며, 도 7은 차량 네트워크처리 모듈에서 이루어지는 알고리즘을 보여주고 있다.먼저, 도 6에 나타낸 바와 같이, 스위치 1이 통신포트를 통해 메시지를 수신하면, 스위치 1의 프로세싱 모듈은 [0056]메시지를 수신한 통신포트와 메시지가 전송된 위치(해당 메시지를 전달한 송신처(메시지 소스))를 확인한다.만약, 프로세싱 모듈이 처리 모듈로부터 메시지를 수신한 경우, 즉 수신한 메시지가 처리 모듈로부터 전송된 메 [0057]시지인 경우라면, 목적 포트(목적지에 해당하는 통신포트)를 확인한 뒤 확인된 목적 포트를 통해 메시지를 전송한다.이때, 처리 모듈로부터 전달된 이더넷 메시지는 표준 이더넷 처리 모듈, 기타 이더넷 AVB 처리 모듈, 차량 네트 [0058]워크 처리 모듈에서 전달된 메시지가 될 수 있다.기본적으로 차량 네트워크 처리 모듈에서 전달된 메시지는 후술하는 메시지 병합 알고리즘에 의해 병합된 이더 [0059]넷 메시지일 수 있고, 차량 네트워크 처리 모듈에서 병합 처리된 이더넷 메시지는 프로세싱 모듈에서 통신포트를 통해 게이트웨이로 전송된 뒤 종래와 마찬가지로 최종의 목적지로 전달된다.또한 수신된 메시지가 통신포트를 통해 스위치 외부에서 수신된 이더넷 메시지임을 확인한 경우, 프로세싱 모듈 [0060]은 이더넷 메시지의 헤더를 분석하여 메시지 타입을 구분하여 확인한다.여기서, 수신된 이더넷 메시지가 표준 이더넷 메시지이거나 기타 이더넷 AVB 메시지인 경우, 메시지를 표준 이 [0061]더넷 처리 모듈과 기타 이더넷 AVB 처리 모듈로 전달하여 스위칭 처리될 수 있도록 한다.또한 수신된 이더넷 메시지가 CAN, LIN, FlexRay 등의 차량 네트워크에서 게이트웨이를 거쳐 수신된 메시지, 즉 [0062]차량 네트워크 메시지가 포함되어 있는 이더넷 메시지인 경우, 수신된 이더넷 메시지를 차량 네트워크 처리 모듈로 전달한다.여기서, 차량 네트워크 메시지는 차량 기기들이 CAN, LIN, FlexRay 등의 네트워크를 통해 전송하려는 정보들이 [0063]포함된 메시지이며, 전술한 바와 같이 게이트웨이가 복수의 차량 기기들로부터 수신한 메시지들을 하나의 이더넷 메시지에 포함시켜 스위치 1로 전송하게 된다. 한편, 스위치의 차량 네트워크 처리 모듈은 통신포트 및 프로세싱 모듈을 통해 게이트웨이에서 전송된 이더넷 [0064]메시지를 전달받으며, 이와 별도로 노드들로부터는 차량 기기들에 게이트웨이를 통해 전송할 정보들이 포함된이더넷 메시지를 각 노드별로 지정된 통신포트를 통해 수신하게 된다.상기 프로세싱 모듈을 통해 전달된 이더넷 메시지는 차량 기기들이 CAN, LIN, FlexRay 등의 네트워크를 통해 보 [0065]내온 정보가 포함된 복수의 메시지, 즉 복수의 차량 네트워크 메시지들이 포함된 메시지가 된다. 상기 프로세싱 모듈을 통해 전달된 이더넷 메시지는 각 목적지 노드에 전달되어야 하는 메시지를 포함하고 있는 [0066]메시지이므로 이는 차량 네트워크 처리 모듈이 목적지 노드에 전송될 개별 메시지로 분할해야 하는 메시지이다. 반면, 각 노드로부터 수신된 이더넷 메시지는 차량 네트워크 처리 모듈이 외부 전송을 위해 하나의 이더넷 메시 [0067]지로 병합해야 하는 메시지가 된다.이에 차량 네트워크 처리 모듈은 도 7에 나타낸 바와 같이 프로세싱 모듈로부터 전달된 이더넷 메시지의 프레임 [0068]분석 등을 통하여 이더넷 메시지를 분할 것인지, 아니면 병합할 것인지를 결정하고, 이어 메시지 분할 또는 병합을 위해 해당 알고리즘을 호출한다.만약, 차량 네트워크 처리 모듈이 전달받은 이더넷 메시지가 각 노드로부터 수신된 메시지라면, 수신된 각 노드 [0069]의 메시지를 하나의 이더넷 메시지로 병합한 뒤 프로세싱 모듈로 전송하는 메시지 병합 알고리즘을 호출하게 된다.반면, 차량 네트워크 처리 모듈이 전달받은 이더넷 메시지가 통신포트 및 프로세싱 모듈을 통해 게이트웨이에서 [0070]전송된 이더넷 메시지, 즉 복수의 차량 네트워크 메시지(차량 기기들에서 CAN, LIN, FlexRay 등을 통해 전송된공개특허 10-2015-0011036-10-메시지)가 포함된 이더넷 메시지라면, 이더넷 메시지를 분할한 뒤 분할된 차량 네트워크 메시지를 해당 목적지노드로 전송하는 메시지 분할 알고리즘을 호출하게 된다.도 8과 도 9는 차량 네트워크 처리 모듈에서 수행되는 메시지 분할 알고리즘과 메시지 병합 알고리즘의 과정을 [0071]나타내는 순서도이다.먼저, 분할할 필요가 있는 이더넷 메시지의 스위칭 처리를 위해 도 8과 같은 분할 알고리즘이 호출되며, 분할 [0072]알고리즘에서는 이더넷 메시지의 프레임 분석을 통하여 이더넷 메시지 내부에 포함된 개별 차량 네트워크 메시지들을 구분하게 된다.이어 이더넷 메시지에 포함되어 있는 차량 네트워크 메시지들을 순차적으로 읽어들이면서, 각 차량 네트워크 메 [0073]시지의 헤더를 분석하여 해당 메시지의 목적지 주소를 확인한다.이때, 차량 네트워크 메시지의 헤더에서 식별부호(ID) 및 헤더 길이를 읽어들인 뒤 룩업 테이블을 검색하여 목 [0074]적지를 찾아내고, 이후 룩업 테이블에 따라 해당 차량 네트워크 메시지에 대한 개별 이더넷 메시지(차량 네트워크 메시지의 정보가 포함된 이더넷 메시지)를 생성한다.이렇게 생성된 이더넷 메시지는 통신포트를 통해 목적지 노드로 전송되며, 이러한 과정을 이더넷 메시지에 포함 [0075]되어 있는 모든 차량 네트워크 메시지에 대해서 반복 실시한 후 종료한다.다음으로, 병합해야 할 메시지의 처리를 위해 차량 네트워크 처리 모듈에서 메시지 병합 알고리즘이 호출되며, [0076]메시지 병합 알고리즘에서는 각 노드에서 게이트웨이로 전송하고자 하는 차량 네트워크 메시지, 즉 각 노드의이더넷 메시지를 수신하여 하나의 이더넷 메시지로 병합한 뒤 전송하는 역할을 한다.도 9에 나타낸 바와 같이, 메시지 병합 알고리즘에서는 타이머를 이용하여 타이머에 의해 설정된 시간이 경과하 [0077]거나, 미리 설정된 개수의 메시지를 모두 병합 완료한 경우, 병합된 이더넷 메시지를 통신포트를 통해전송한다.또한 메시지 병합 알고리즘에서는 타이머 만기 또는 병합 완료시까지 노드로부터 통신포트를 통해 새로운 정보 [0078]가 포함된 신규 메시지가 수신되어 대기하게 되면, 수신된 신규 메시지가 병합이 필요한 메시지인지를 메시지프레임 정보에 대한 룩업 테이블 검색을 통해 확인하고, 병합이 필요한 메시지일 경우 전송할 이더넷 메시지의끝에 해당 신규 메시지를 추가하여 병합한다.이렇게 최종적으로 병합이 완료된 이더넷 메시지는 차량 네트워크 처리 모듈에서 프로세싱 모듈로 전달된 뒤 통 [0079]신포트를 통해 게이트웨이로 전송된다. 본 발명에서 상기와 같이 메시지 병합 알고리즘에 의해 병합된 이더넷 메시지의 헤더에는 각 노드의 메시지별로 [0080]발신지와 목적지의 정보(주소나 식별부호)가 포함된다.더불어, 메시지 분할 알고리즘에 의해 분할된 각 이더넷 메시지(각 노드로 보내질 차량 네트워크 메시지)의 경 [0081]우에도 이더넷 헤더에 발신지와 목적지의 정보가 포함된다. 이상으로 본 발명의 실시예에 대해 상세히 설명하였는바, 본 발명의 권리범위는 상술한 실시예에 한정되지 않으 [0082]며, 다음의 특허청구범위에서 정의하고 있는 본 발명의 기본 개념을 이용한 당업자의 여러 변형 및 개량 형태또한 본 발명의 권리범위에 포함된다.공개특허 10-2015-0011036-11-도면도면1공개특허 10-2015-0011036-12-도면2공개특허 10-2015-0011036-13-도면3공개특허 10-2015-0011036-14-도면4공개특허 10-2015-0011036-15-도면5공개특허 10-2015-0011036-16-도면6도면7공개특허 10-2015-0011036-17-도면8공개특허 10-2015-0011036-18-도면9공개특허 10-2015-0011036-19-"}
{"patent_id": "10-2013-0076306", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 이더넷 기반의 차량 네트워크 메시지 전달 시스템 및 방법에 관한 것으로서, CAN, LIN, FlexRay 등의 차량 네트워크에서 전송된 복수의 차량 네트워크 메시지를 하나의 이더넷 메시지에 병합한 뒤 동일한 이더넷 메 시지를 복사하여 각 노드로 전송하는 방식의 문제점, 즉 대역폭 낭비 및 오버헤드 발생 등의 여러 문제점을 해결 (뒷면에 계속)"}
{"patent_id": "10-2013-0076306", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 차량 네트워크 시스템 및 방법에 관한 것으로서, 더욱 상세하게는 CAN, LIN, FlexRay 등의 차량 네트 워크와 이더넷(Ethernet)이 연결된 차량 네트워크 구조에서 메시지 전달 과정에서 나타나는 대역폭 낭비와 오버 헤드 발생 등의 문제점이 해결될 수 있고, 차량 기기들 간의 보다 효율적인 통신이 가능해지는 시스템과 방법에 관한 것이다."}
{"patent_id": "10-2013-0076306", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "최근 들어 자동차에 관련된 전자기술 및 통신기술의 발전이 급격히 진행됨에 따라 차량에 적용되는 전자 시스템 의 수와 종류가 크게 늘어나고 있다. 예를 들면, 자동차에서 엔진 제어나 배기가스 제어에 관련된 제어 시스템, 그리고 에어백 시스템 등의 안전 시 스템에 더하여, 정보 및 멀티미디어 재생 시스템, 인공지능 시스템, 후방 감지 시스템, 어라운드 뷰 모니터링 (AVM:Around View Monitoring) 시스템, 차선 이탈 경보 시스템(LDWS:Lane Departure Warning System), 충돌 방 지 시스템(CAS:Collision Avoidance System), 교통표지판 인식 시스템과 같은 전자 시스템에 대한 다양한 요구 들이 지속적으로 증가하고 있다. 이러한 전자 시스템에서는 카메라나 각종 센서 등의 정보수집장치 및 상/하위 제어기 등의 차량 기기들이 통신 네트워크를 통해 서로 연결되어 있으며, 이에 따라 보다 효율적인 전자 시스템을 구성하기 위해 다양한 기능들 을 지원하면서도 각 기능을 위한 별도의 전용 배선을 줄일 수 있는 네트워크 구조가 요구되고 있다. 아울러, 상기한 네트워크 구조를 구성하기 위해 고대역폭 및 높은 유연성, 결정적(deterministic) 동작을 제공 하는 프로토콜들이 요구되고 있으며, 최근 배선 구조와 상위 레벨 시스템과의 통신 규약을 정의한 다양한 프로 토콜들이 차량에 적용되고 있다. CAN(Controller Area Network), LIN(Local Interconnect Network), Flexray 등이 그 대표적인 프로토콜들이며, 그 외에 차량 내에서 각기 장점을 발휘할 수 있는 다양한 프로토콜이 개발되고 있고, 여러 프로토콜 간의 데이 터 변환을 통해 이질적인 차량 내 프로토콜을 연결하고 이들을 통합 운영할 수 있는 통합 네트워크 시스템의 개 발도 이루어지고 있다. 최근 통신 시스템이나 제어 시스템, 영상 제공 시스템 등과 같은 차량 시스템에서 이더넷(Ethernet)을 이용하는 기술들이 제시되고 있으며, 차량에서의 이더넷 이용에 대한 선행특허문헌으로는 한국공개특허 제10-2013- 0003902호(2013.1.9.), 한국공개특허 제10-2012-0107783호(2012.10.4.), 한국등록특허 제10-1033793호 (2011.5.2.), 한국공개특허 제10-2011-0038197호(2011.4.14.) 등을 들 수 있다. 또한 최근의 차량에서는 센서류나 카메라, 레이저 스캐너 등과 같은 다양한 기기들이 사용되고 있고, 차량 기기 들의 수가 점차 증가함에 따라 기존의 차량 네트워크(CAN, LIN, Flexray 등)로는 요구 대역폭을 지원하기 어려 울 것으로 예상되고 있다. 이를 위해, 차량에서도 이더넷 오디오 비디오 브리징(AVB:Audio Video Bridging, 이하, 'AVB'라 칭함) 기술이 적용될 것으로 예상되고 있으며, 이더넷 AVB 기술은 오디오, 비디오 등의 스트링 데이터를 전송하기 위한 프로 토콜로, 아직까지 차량과 관련한 기술 개발은 미흡한 실정이다. AVB가 적용된 이더넷을 이용하는 차량 전자 시스템에서는 차량 기기들이 하나 또는 그 이상의 이더넷 링크들을 통해 통신 가능하게 연결되고, 멀티미디어, 제어, 진단, 감지 정보 등의 각종 정보를 주고받기 위해 AVB를 이용 하는 이더넷 링크 상에서 전자 장치 간의 통신이 이루어진다. 도 1은 이더넷 AVB가 기존의 차량 네트워크와 게이트웨이로 연결되어 있는 차량 네트워크 시스템의 구성이고, 도 2는 이더넷 AVB의 메시지 프레임 포맷 및 송수신 방법을 설명하기 위한 도면이다. 도 1에 나타낸 바와 같이 이더넷 AVB가 게이트웨이(gateway)를 통해 CAN, LIN, FlexRay 등의 차량 네트워크에 연결되어 있는 경우, 데이터 크기가 작은 여러 개의 메시지가 하나의 이더넷 메시지에 통합되어 전송될 수 있다. 이때, 이더넷 메시지에 포함된 차량 네트워크 메시지(기기들이 전송하는 정보들이 포함된 메시지)의 목적지 노 드(Node)가 다를 경우, 이더넷 메시지가 여러 개의 노드(메시지를 송수신하는 차량 내 각 기기들)로 중복 전송 되어야 하고, 이를 수신한 각 노드는 여러 개의 차량 네트워크 메시지 중에 자신이 필요로 하는 메시지를 추출 하여 사용해야 하는 문제가 발생한다. 이러한 종래의 문제점에 대해 좀더 상세히 설명하면 다음과 같다. CAN, LIN, FlexRay와 같은 차량 네트워크에서 이더넷 AVB 상에 차량 네트워크 메시지를 전송하기 위한 관련 표 준을 IEEE 1722a에서 정의하고 있다. 즉, IEEE 1722a의 드래프트(draft) 버전에서 CAN 메시지에 대한 프레임 포맷은 AVB 헤더와 복수의 CAN 메시지로 구성되며, 이때 각 메시지는 수신한 시점의 시간을 ns 단위로 측정한 타임스탬프(timestamp) 값을 포함한다. 또한 이더넷 AVB 내의 모든 노드는 IEEE 802.1AS에 따라 시간 동기화가 되어 있으며, 도 1의 게이트웨이는 LIN, CAN, FlexRay로부터 메시지를 수신한 뒤 도 2에서와 같이 하나의 이더넷 AVB 프레임에 복수의 메시지를 포함시 켜 전송할 수 있다. 여기서, 이더넷은 헤더에 대한 오버헤드가 있으므로 최대한 데이터 크기를 크게 전송하는 것이 효율적이다. 만약, 종래와 같이 하나의 이더넷 AVB 프레임 내에 도 1의 노드 1과 노드 2로 전송해야 하는 복수의 CAN 메시지 를 함께 포함시킬 경우, 동일한 이더넷 AVB 메시지를 각각의 모든 노드로 전송해야 한다. 따라서, 노드 1의 경우 불필요한 노드 2의 정보를 수신하게 되므로 네트워크의 대역폭을 낭비하게 되고, 수신하 는 각 노드가 이더넷 AVB 메시지에서 자신이 필요한 정보를 추출하는 오버헤드가 발생하게 된다. 반면, 하나의 이더넷 AVB 프레임 내에 목적지가 특정 노드인 하나의 메시지만을 담을 경우에는 작은 이더넷 AVB 프레임을 다수 전송해야 하므로 역시 오버헤드 문제가 발생하게 된다. 그리고, 차량의 이더넷은 기존의 대표적인 차량 네트워크인 LIN, CAN, FlexRay와 연동되어 사용될 수 있어야 한 다. 이를 위해, 도 1 및 도 2에 나타낸 바와 같은 게이트웨이가 사용되며, 프레임 크기가 작은 CAN 메시지 등 1개 이상의 차량 네트워크 메시지를 하나의 이더넷 메시지에 포함시켜 전송하는 게이트웨이 관련 기술이 제시되어 있다. 또한 차량의 이더넷 메시지에 CAN, LIN, FlexRay 등을 통해 전송된 차량 네트워크 메시지를 담을 수 있는 프레 임 포맷도 IEEE 1722a 드래프트 버전으로 공개되어 있으며, 향후 표준으로 제정될 것으로 예상된다. 이하, 본 명세서에서 차량 네트워크 메시지는 LIN, CAN, FlexRay 등의 차량 네트워크에 연결된 기기들, 그리고 이더넷 스위치에 연결된 노드들(노드 1 ~ 노드 n)이 전송하는 메시지를 의미하며, 여기서 LIN, CAN, FlexRay 등 에 연결된 기기들과 이더넷 스위치에 연결된 노드들은 서로 간에 통신을 필요로 하는 차량 내 제어기가 될 수 있다. 이러한 차량 네트워크 메시지에는 제어기들 간에 주고받아야 하는 정해진 정보들이 포함되며, 더불어 메시지의 발신지 및 목적지 등의 정보(주소나 식별부호(ID) 등)가 포함된다. 현재 이더넷 스위치(switch) 기술은 인터넷 기술 및 산업용 네트워크 기술에서 이미 개발되어 있으며, 이러한 산업분야에서는 이더넷만을 고려하였기 때문에 통상 이더넷 스위치는 MAC 어드레스를 기반으로 목적지 포트로 해당 메시지를 전달한다. 이때, 도 2에 나타낸 바와 같이 5개의 차량 네트워크 메시지를 하나의 이더넷 메시지에 포함시키되, 메시지 1, 3은 노드 1로, 메시지 2는 노드 3으로, 메시지 4, 5는 노드 4로 전달해야 하는 경우에서도, 기존 스위치 기술에 서는 내부 차량 네트워크 메시지를 고려하지 않기 때문에 전체 이더넷 메시지를 각 노드로 복사하여 동일하게 전달한다. 이로 인해 전체 네트워크에 오버헤드가 발생하며, 또한 메시지를 수신한 노드가 전체 이더넷 메시지를 분석하여 자신이 필요한 메시지를 추출하여 사용해야 하는 문제점이 발생한다. 요컨대, 종래의 이더넷 스위치는 이더넷 MAC 주소를 기반으로 이더넷 프레임 전체를 스위칭하며, 차량에서 이더 넷을 활용할 경우 CAN, LIN, FlexRay 등의 기존 차량 네트워크와 연동이 필요하다. 이 경우에서 이더넷 메시지 내에 여러 개의 차량 네트워크 메시지가 포함되어 전송될 수 있는데, 이더넷 스위치 가 MAC 주소를 기반으로 스위칭을 수행하므로 각각 특정 노드로만 전송되어야 하는 여러 개의 차량 네트워크 메 시지를 하나의 이더넷 메시지에 포함시켜야 한다. 이와 같이 다양한 MAC 주소의 각 노드로 전송되어야 할 복수의 차량 네트워크 메시지가 하나의 이더넷 메시지에 포함되는 경우에서 동일한 메시지를 복사하여 복수의 노드로 전송해야 하고, 이로 인해 네트워크의 대역폭이 낭 비됨은 물론, 각 노드에서는 전체 이더넷 메시지 내에서 필요한 데이터를 추출하여 사용하여야 하므로 오버헤드 가 발생한다."}
{"patent_id": "10-2013-0076306", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "따라서, 본 발명은 상기와 같은 문제점을 해결하기 위하여 창출한 것으로서, CAN, LIN, FlexRay 등의 차량 네트 워크에서 전송된 복수의 차량 네트워크 메시지를 게이트웨이에서 하나의 이더넷 메시지에 포함시켜 전송하고 이 더넷 스위치에서 동일한 이더넷 메시지를 복사하여 복수의 노드로 스위칭하는 종래의 방식이 가지는 문제점, 즉 대역폭 낭비 및 오버헤드 발생 등의 문제점이 해결될 수 있으면서 보다 효율적으로 메시지를 송수신할 수 있는 시스템과 방법을 제공하는데 그 목적이 있다."}
{"patent_id": "10-2013-0076306", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "상기한 목적을 달성하기 위해, 본 발명은, 이종의 프로토콜을 갖는 차량 네트워크와 이더넷이 게이트웨이를 통 해 연결된 차량 네트워크 시스템에서, 상기 이더넷과 이종의 차량 네트워크를 통해 차량 기기들 간에 메시지를 전달하는 방법에 있어서, 게이트웨이가 상기 이종의 차량 네트워크를 통해 차량 기기들로부터 목적지를 달리하 는 개별 메시지들을 수신하는 단계; 게이트웨이가 상기 수신된 개별 메시지들을 하나의 이더넷 메시지에 포함시 켜 이더넷 스위치로 전송하는 단계; 이더넷 스위치가 수신된 이더넷 메시지를 분석하여 이더넷 메시지에 포함된 개별 메시지들의 목적지를 확인하는 단계; 및 이더넷 스위치가 상기 수신된 이더넷 메시지로부터 목적지에 따라 개별 메시지의 정보가 포함된 이더넷 메시지를 분할, 생성하여 각 목적지에 해당하는 차량 기기에 전송하는 단 계;를 포함하는 이더넷 기반의 차량 네트워크 메시지 전달 방법을 제공한다. 또한 상기한 본 발명의 차량 네트워크 메시지 전달 방법은, 이더넷 스위치에 연결된 차량 기기들이 메시지를 전 송하여 이더넷 스위치가 수신하는 단계; 및 이더넷 스위치가 차량 기기들로부터 수신한 메시지들을 하나의 이더 넷 메시지로 병합하여 게이트웨이로 전송하는 단계;를 더 포함하여 구성될 수 있다. 그리고, 본 발명은, 이더넷을 이종의 프로토콜을 갖는 차량 네트워크와 연결하는 게이트웨이; 및 게이트웨이와 차량 기기 간에 이더넷 메시지를 스위칭하여 전달하는 이더넷 스위치를 포함하는 차량 네트워크 메시지 전달 시 스템에 있어서, 상기 이더넷 스위치는 상기 이종의 차량 네트워크에서 게이트웨이를 통해 수신된 이더넷 메시지 를 전달하는 프로세싱 모듈; 상기 프로세싱 모듈에서 전달된 메시지의 스위칭을 담당하는 차량 네트워크 처리 모듈; 및 차량 네트워크 처리 모듈의 스위칭에 필요한 정보가 저장된 룩업 테이블;을 포함하며, 차량 네트워크 처리 모듈은 게이트웨이에서 프로세싱 모듈을 통해 전달된 이더넷 메시지를 분석하여 이더넷 메시지 내 개별 메 시지들의 목적지를 확인하고, 상기 이더넷 메시지로부터 목적지에 따라 개별 메시지의 정보가 포함된 이더넷 메 시지를 분할, 생성하여 목적지의 차량 기기에 전송하도록 된 이더넷 기반의 차량 네트워크 메시지 전달 시스템 을 제공한다."}
{"patent_id": "10-2013-0076306", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "이에 따라, 본 발명의 차량 네트워크 메시지 전달 시스템 및 방법에 의하면, 이더넷 스위치가 게이트웨이로부터 수신한 메시지를 분할한 후 각 메시지를 해당 목적지에 전달하는 방식이 적용됨으로써, 이더넷 스위치에서 동일 한 이더넷 메시지를 복사하여 복수의 노드로 스위칭하는 종래의 방식이 가지는 대역폭 낭비 및 오버헤드 발생 등의 문제점이 해결될 수 있고, 효율적인 메시지를 송수신이 가능해진다."}
{"patent_id": "10-2013-0076306", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하, 첨부한 도면을 참조하여 본 발명의 실시예에 대해 본 발명이 속하는 기술분야에서 통상의 지식을 가진 자 가 용이하게 실시할 수 있도록 상세히 설명하기로 한다. 도 3과 도 4는 본 발명의 실시예에 따른 시스템의 구성도로, CAN, LIN, FlexRay 등의 차량 네트워크가 게이트웨 이를 통해 이더넷 AVB에 연결된 구성을 보여주고 있다. 도시된 바와 같이, 차량 내 복수의 기기들이 각종 정보(다른 기기에서 필요로 하는 정보)를 포함하는 메시지를 송수신할 수 있도록 CAN, LIN, FlexRay 등의 차량 네트워크에 연결된다. 또한 차량에서 이더넷이 복수의 차량 네트워크와 연동하여 이용될 수 있도록 이더넷 AVB가 게이트웨이를 통해 CAN, LIN, FlexRay 등의 차량 네트워크에 통신 가능하게 연결된다. 상기 게이트웨이는 이질적인 복수의 네트워크, 즉 CAN, LIN, FlexRay 등의 네트워크와 이더넷을 연결하는 구성 요소로, CAN, LIN, FlexRay 등의 네트워크를 통해 목적지가 다른 여러 개의 차량 네트워크 메시지를 수신한 뒤, 목적지가 다른 여러 개의 수신된 메시지를 하나의 이더넷 프레임에 담아 이더넷 스위치로 전송한다. 또한 상기 게이트웨이에 연결된 이더넷 스위치는 메시지의 송/수신처가 되는 차량 내 각 기기, 즉 단수 또는 복 수의 노드(노드 1 ~ 5, 노드 n)들에 통신 가능하게 연결된다. 이때, 이더넷 스위치(이하, '스위치 1'이라 칭함)의 미리 지정된 통신포트에 게이트웨이와 각 노드들이 연결되 며, 스위치 1은 지정된 별도의 통신포트를 통해 다른 이더넷 스위치(이하, '스위치 2'라 칭함)와도 메시지의 송 수신이 가능하도록 연결될 수 있다. 여기서, 상기 스위치 2 역시 미리 지정된 각 통신포트를 통해 메시지의 송수신처가 되는 단수 또는 복수의 노드 들과 통신 가능하게 연결된다. 본 발명에서 CAN, LIN, FlexRay 등의 차량 네트워크에 연결된 단수 또는 복수의 기기들과 스위치에 연결된 노드 들은 서로 간에 통신을 필요로 하는 차량 기기들, 예컨대 차량 전자 시스템의 제어기들이 될 수 있다. 한편, 종래의 알려진 여러 문제점을 해결하기 위한 메시지 전달 과정을 살펴보면, 먼저 게이트웨이는 CAN, LIN, FlexRay 등의 차량 네트워크들로부터 차량 네트워크 메시지를 수신한 뒤 수신된 복수의 차량 네트워크 메시지를 하나의 이더넷 메시지에 포함시켜 스위치 1로 전송하게 된다. 이어 스위치 1은 게이트웨이로부터 이더넷 메시지를 수신하는 경우, 수신된 이더넷 메시지의 헤더 및 내부의 각 차량 네트워크 메시지에 지정되어 있는 주소(또는 식별부호)를 참조하여 각 차량 네트워크 메시지의 목적지 경 로에 따라 이더넷 메시지를 분할하는데, 이 과정에서 각 차량 네트워크 메시지에 대한 분할된 이더넷 메시지를 생성한 뒤, 각 분할된 이더넷 메시지를 지정된 통신포트를 통해 해당 목적지 노드로 전송하게 된다. 이때, 스위치 1에서 분할된 이더넷 메시지가 지정된 통신포트를 통해 스위치 2로 전송될 수 있고, 전송된 이더 넷 메시지는 스위치 2에서 분할 없이 하나의 목적지 노드로 전달되거나(도 4 참조), 또는 스위치 2에서 최종 목 적지 노드가 복수인 경우 메시지에 지정되어 있는 주소에 따라 이더넷 메시지가 다시 분할된 뒤 분할된 각 이더 넷 메시지가 지정된 통신포트를 통해 각각의 최종 목적지 노드로 전송된다(도 3 참조). 요컨대, 스위치 1이 게이트웨이로부터 전송된 이더넷 메시지를 수신하여 이더넷 메시지 및 개별 차량 네트워크 메시지를 분석한 뒤, 각 차량 네트워크 메시지의 목적지에 대해 각각의 이더넷 메시지를 만들어 전송하는 것이다. 반대로 각 노드가 CAN, LIN, FlexRay로 전송할 차량 네트워크 메시지를 스위치로 전송하면, 각 스위치는 해당 메시지들을 병합한 뒤 병합된 이더넷 메시지를 지정된 통신포트를 통해 게이트웨이로 전송한다. 도 5는 본 발명에 따른 시스템에서 스위치의 구성을 나타내는 블록도로서, 스위치는, 이더넷 메시지가 수신된 통신포트 정보와 수신된 이더넷 메시지를 분석하여 각 처리 모듈로 전달하거나 각 처리 모듈에서 전달받은 메시 지를 해당 통신포트로 전달하는 프로세싱 모듈; 표준 이더넷 또는 기타 이더넷 메시지를 스위칭할 수 있는 표준이더넷 처리 모듈 및 기타 이더넷 처리 모듈; CAN, LIN, FlexRay 등의 차량 네트워크에서 게이트웨이를 통해 전 달된 차량 네트워크 메시지의 스위칭을 담당하는 차량 네트워크 처리 모듈; 각 처리 모듈의 스위칭에 필요한 정 보를 저장하고 있는 룩업 테이블; 및 스위치의 기능 및 룩업 테이블의 정보를 변경할 수 있는 설정 모듈을 포함 하여 구성된다. 도 6 내지 도 9는 본 발명에 따른 메시지 송수신 방법을 나타내는 순서도로서, 도 6은 차량 네트워크 메시지의 효율적인 송수신을 위해 스위치의 프로세싱 모듈에서 이루어지는 알고리즘을 나타내며, 도 7은 차량 네트워크 처리 모듈에서 이루어지는 알고리즘을 보여주고 있다. 먼저, 도 6에 나타낸 바와 같이, 스위치 1이 통신포트를 통해 메시지를 수신하면, 스위치 1의 프로세싱 모듈은 메시지를 수신한 통신포트와 메시지가 전송된 위치(해당 메시지를 전달한 송신처(메시지 소스))를 확인한다. 만약, 프로세싱 모듈이 처리 모듈로부터 메시지를 수신한 경우, 즉 수신한 메시지가 처리 모듈로부터 전송된 메 시지인 경우라면, 목적 포트(목적지에 해당하는 통신포트)를 확인한 뒤 확인된 목적 포트를 통해 메시지를 전송 한다. 이때, 처리 모듈로부터 전달된 이더넷 메시지는 표준 이더넷 처리 모듈, 기타 이더넷 AVB 처리 모듈, 차량 네트 워크 처리 모듈에서 전달된 메시지가 될 수 있다. 기본적으로 차량 네트워크 처리 모듈에서 전달된 메시지는 후술하는 메시지 병합 알고리즘에 의해 병합된 이더 넷 메시지일 수 있고, 차량 네트워크 처리 모듈에서 병합 처리된 이더넷 메시지는 프로세싱 모듈에서 통신포트 를 통해 게이트웨이로 전송된 뒤 종래와 마찬가지로 최종의 목적지로 전달된다. 또한 수신된 메시지가 통신포트를 통해 스위치 외부에서 수신된 이더넷 메시지임을 확인한 경우, 프로세싱 모듈 은 이더넷 메시지의 헤더를 분석하여 메시지 타입을 구분하여 확인한다. 여기서, 수신된 이더넷 메시지가 표준 이더넷 메시지이거나 기타 이더넷 AVB 메시지인 경우, 메시지를 표준 이 더넷 처리 모듈과 기타 이더넷 AVB 처리 모듈로 전달하여 스위칭 처리될 수 있도록 한다. 또한 수신된 이더넷 메시지가 CAN, LIN, FlexRay 등의 차량 네트워크에서 게이트웨이를 거쳐 수신된 메시지, 즉 차량 네트워크 메시지가 포함되어 있는 이더넷 메시지인 경우, 수신된 이더넷 메시지를 차량 네트워크 처리 모 듈로 전달한다. 여기서, 차량 네트워크 메시지는 차량 기기들이 CAN, LIN, FlexRay 등의 네트워크를 통해 전송하려는 정보들이 포함된 메시지이며, 전술한 바와 같이 게이트웨이가 복수의 차량 기기들로부터 수신한 메시지들을 하나의 이더 넷 메시지에 포함시켜 스위치 1로 전송하게 된다. 한편, 스위치의 차량 네트워크 처리 모듈은 통신포트 및 프로세싱 모듈을 통해 게이트웨이에서 전송된 이더넷 메시지를 전달받으며, 이와 별도로 노드들로부터는 차량 기기들에 게이트웨이를 통해 전송할 정보들이 포함된 이더넷 메시지를 각 노드별로 지정된 통신포트를 통해 수신하게 된다. 상기 프로세싱 모듈을 통해 전달된 이더넷 메시지는 차량 기기들이 CAN, LIN, FlexRay 등의 네트워크를 통해 보 내온 정보가 포함된 복수의 메시지, 즉 복수의 차량 네트워크 메시지들이 포함된 메시지가 된다. 상기 프로세싱 모듈을 통해 전달된 이더넷 메시지는 각 목적지 노드에 전달되어야 하는 메시지를 포함하고 있는 메시지이므로 이는 차량 네트워크 처리 모듈이 목적지 노드에 전송될 개별 메시지로 분할해야 하는 메시지이다. 반면, 각 노드로부터 수신된 이더넷 메시지는 차량 네트워크 처리 모듈이 외부 전송을 위해 하나의 이더넷 메시 지로 병합해야 하는 메시지가 된다. 이에 차량 네트워크 처리 모듈은 도 7에 나타낸 바와 같이 프로세싱 모듈로부터 전달된 이더넷 메시지의 프레임 분석 등을 통하여 이더넷 메시지를 분할 것인지, 아니면 병합할 것인지를 결정하고, 이어 메시지 분할 또는 병 합을 위해 해당 알고리즘을 호출한다. 만약, 차량 네트워크 처리 모듈이 전달받은 이더넷 메시지가 각 노드로부터 수신된 메시지라면, 수신된 각 노드 의 메시지를 하나의 이더넷 메시지로 병합한 뒤 프로세싱 모듈로 전송하는 메시지 병합 알고리즘을 호출하게 된 다. 반면, 차량 네트워크 처리 모듈이 전달받은 이더넷 메시지가 통신포트 및 프로세싱 모듈을 통해 게이트웨이에서 전송된 이더넷 메시지, 즉 복수의 차량 네트워크 메시지(차량 기기들에서 CAN, LIN, FlexRay 등을 통해 전송된메시지)가 포함된 이더넷 메시지라면, 이더넷 메시지를 분할한 뒤 분할된 차량 네트워크 메시지를 해당 목적지 노드로 전송하는 메시지 분할 알고리즘을 호출하게 된다. 도 8과 도 9는 차량 네트워크 처리 모듈에서 수행되는 메시지 분할 알고리즘과 메시지 병합 알고리즘의 과정을 나타내는 순서도이다. 먼저, 분할할 필요가 있는 이더넷 메시지의 스위칭 처리를 위해 도 8과 같은 분할 알고리즘이 호출되며, 분할 알고리즘에서는 이더넷 메시지의 프레임 분석을 통하여 이더넷 메시지 내부에 포함된 개별 차량 네트워크 메시 지들을 구분하게 된다. 이어 이더넷 메시지에 포함되어 있는 차량 네트워크 메시지들을 순차적으로 읽어들이면서, 각 차량 네트워크 메 시지의 헤더를 분석하여 해당 메시지의 목적지 주소를 확인한다. 이때, 차량 네트워크 메시지의 헤더에서 식별부호(ID) 및 헤더 길이를 읽어들인 뒤 룩업 테이블을 검색하여 목 적지를 찾아내고, 이후 룩업 테이블에 따라 해당 차량 네트워크 메시지에 대한 개별 이더넷 메시지(차량 네트워 크 메시지의 정보가 포함된 이더넷 메시지)를 생성한다. 이렇게 생성된 이더넷 메시지는 통신포트를 통해 목적지 노드로 전송되며, 이러한 과정을 이더넷 메시지에 포함 되어 있는 모든 차량 네트워크 메시지에 대해서 반복 실시한 후 종료한다. 다음으로, 병합해야 할 메시지의 처리를 위해 차량 네트워크 처리 모듈에서 메시지 병합 알고리즘이 호출되며, 메시지 병합 알고리즘에서는 각 노드에서 게이트웨이로 전송하고자 하는 차량 네트워크 메시지, 즉 각 노드의 이더넷 메시지를 수신하여 하나의 이더넷 메시지로 병합한 뒤 전송하는 역할을 한다. 도 9에 나타낸 바와 같이, 메시지 병합 알고리즘에서는 타이머를 이용하여 타이머에 의해 설정된 시간이 경과하 거나, 미리 설정된 개수의 메시지를 모두 병합 완료한 경우, 병합된 이더넷 메시지를 통신포트를 통해 전송한다. 또한 메시지 병합 알고리즘에서는 타이머 만기 또는 병합 완료시까지 노드로부터 통신포트를 통해 새로운 정보 가 포함된 신규 메시지가 수신되어 대기하게 되면, 수신된 신규 메시지가 병합이 필요한 메시지인지를 메시지 프레임 정보에 대한 룩업 테이블 검색을 통해 확인하고, 병합이 필요한 메시지일 경우 전송할 이더넷 메시지의 끝에 해당 신규 메시지를 추가하여 병합한다. 이렇게 최종적으로 병합이 완료된 이더넷 메시지는 차량 네트워크 처리 모듈에서 프로세싱 모듈로 전달된 뒤 통 신포트를 통해 게이트웨이로 전송된다. 본 발명에서 상기와 같이 메시지 병합 알고리즘에 의해 병합된 이더넷 메시지의 헤더에는 각 노드의 메시지별로 발신지와 목적지의 정보(주소나 식별부호)가 포함된다. 더불어, 메시지 분할 알고리즘에 의해 분할된 각 이더넷 메시지(각 노드로 보내질 차량 네트워크 메시지)의 경 우에도 이더넷 헤더에 발신지와 목적지의 정보가 포함된다. 이상으로 본 발명의 실시예에 대해 상세히 설명하였는바, 본 발명의 권리범위는 상술한 실시예에 한정되지 않으 며, 다음의 특허청구범위에서 정의하고 있는 본 발명의 기본 개념을 이용한 당업자의 여러 변형 및 개량 형태 또한 본 발명의 권리범위에 포함된다.도면 도면1 도면2 도면3 도면4 도면5 도면6 도면7 도면8 도면9"}
{"patent_id": "10-2013-0076306", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 종래기술에서 이더넷 AVB가 기존의 차량 네트워크와 게이트웨이로 연결되어 있는 차량 네트워크 시스템 의 구성이다. 도 2는 이더넷 AVB의 메시지 프레임 포맷 및 송수신 방법을 설명하기 위한 도면이다. 도 3과 도 4는 본 발명의 실시예에 따른 시스템의 구성도이다.도 5는 본 발명에 따른 시스템에서 스위치의 구성을 나타내는 블록도이다. 도 6 내지 도 9는 본 발명에 따른 메시지 송수신 방법을 나타내는 순서도이다."}
