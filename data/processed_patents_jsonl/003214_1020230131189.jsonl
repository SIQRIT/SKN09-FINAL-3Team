{"patent_id": "10-2023-0131189", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2025-0047009", "출원번호": "10-2023-0131189", "발명의 명칭": "중이염 질환을 진단하는 영상 진단 장치 및 영상 진단 방법", "출원인": "가톨릭대학교 산학협력단", "발명자": "최인영"}}
{"patent_id": "10-2023-0131189", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "중이염 질환을 진단하는 영상 진단 장치에 있어서,고막 내시경 영상에 대해 정상과 비정상을 1차적으로 분류하고, 비정상인 경우 급성 중이염, 만성 중이염, 삼출성 중이염 및 비정상 중이염 중 어느 하나의 중이염 질환으로 2차적으로 분류하도록 학습된 딥러닝 모델을 이용하여 대상 고막 내시경 영상의 정상 여부를 분류하고,상기 대상 고막 내시경 영상이 비정상으로 분류된 경우, 상기 딥러닝 모델 및 이상값 탐지 모델 중 적어도 하나를 이용하여 상기 대상 고막 내시경 영상을 상기 어느 하나의 중이염 질환으로 분류하는 프로세서를 포함하는영상 진단 장치."}
{"patent_id": "10-2023-0131189", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 딥러닝 모델은, 상기 고막 내시경 영상에서 추출된 특징에 기초하여 정상인데 비정상으로 판단할 확률 분포와 비정상인데 정상으로 판단할 확률 분포에 대해 서로 다른 가중치를 부여한 가중손실함수를 사용하여 상기 고막 내시경 영상을정상 또는 비정상으로 분류하도록 학습된 1차 분류기;를 포함하는 것을 특징으로 하는 영상 진단 장치."}
{"patent_id": "10-2023-0131189", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제2항에 있어서,상기 딥러닝 모델은, 상기 고막 내시경 영상이 비정상인 경우, 중이염 질환 클래스 별 데이터 분포에 따라 차등적으로 가중치를 부여한 가중손실함수를 사용하여 상기 고막 내시경 영상을 급성 중이염, 만성 중이염, 삼출성 중이염 및 비정상 중이염 중 어느 하나의 중이염 질환으로 분류하도록 학습된 2차 분류기;를 더 포함하는 것을 특징으로 하는 영상진단 장치."}
{"patent_id": "10-2023-0131189", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제2항에 있어서,상기 1차 분류기는, 2 이상의 딥러닝 모델들의 분류 결과를 다수결 기반의 앙상블, 만장일치 기반의 앙상블 및 불확실성 기반의 앙상블 중 적어도 하나를 기초로 앙상블 시켜 학습되는 것을 특징으로 하는 영상 진단 장치."}
{"patent_id": "10-2023-0131189", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제1항에 있어서,상기 프로세서는,상기 고막 내시경 영상을 화질을 유지하면서 고정된 사이즈로 변환한 후 허프 그래디언트 방법을 이용하여 중이를 포함하는 원 영역을 검출하고, 상기 고막 내시경 영상에서 상기 원 영역을 제외한 나머지 영역을 제거한 후 기 정의된 사이즈로 영상을 조정하는 영상 진단 장치."}
{"patent_id": "10-2023-0131189", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "공개특허 10-2025-0047009-3-제5항에 있어서,상기 프로세서는, 기 정의된 사이즈로 상기 조정된 영상을 이루는 복수의 픽셀에 대한 CIE L*a*b* 값 중 영상의 밝기 정보를 포함하는 L채널을 추출하고,추출된 L 채널에 CLAHE(Contrast Limited Adaptive Histogram Equalization) 기법을 이용하여, 상기 영상의 밝기 정보를 조정하는 영상 진단 장치."}
{"patent_id": "10-2023-0131189", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제2항에 있어서,상기 이상값 탐지 모델은,상기 고막 내시경 영상이 비정상인 경우, 중이염 질환 각각에 대한 임상적 특성을 기반으로 상기 고막 내시경영상을 상기 어느 하나의 중이염 질환으로 분류하는 룰 기반(rule-based) 로직 및 오토 인코더(autoencoder)를포함하는 영상 진단 장치."}
{"patent_id": "10-2023-0131189", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제7항에 있어서,상기 프로세서는, 상기 고막 내시경 영상을 이루는 복수의 픽셀에 대한 CIE L*a*b* 값 중 a 채널을 추출하고,통계적 이상값 탐지(Outlier Detection) 방법을 이용하여 상기 중이염 질환 별 임상적 특성에 따라 임계값을 설정하고,상기 a 채널을 구성하는 값과 상기 임계값에 기초하여 상기 룰 기반 로직에 따른 상기 중이염 질환을 분류하는영상 진단 장치."}
{"patent_id": "10-2023-0131189", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제1항에 있어서,디스플레이를 더 포함하고,상기 프로세서는,상기 대상 고막 내시경 영상의 정상 여부 및 비정상인 경우 분류된 중이염 질환을 포함하는 진단 정보를 생성하고,상기 디스플레이에 상기 진단 정보를 표시하는 영상 진단 장치."}
{"patent_id": "10-2023-0131189", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "영상 진단 장치에 의해 수행되는 중이염 질환을 진단하는 영상 진단 방법에 있어서,고막 내시경 영상에 대해 정상과 비정상을 1차적으로 분류하고, 비정상인 경우 급성 중이염, 만성 중이염, 삼출성 중이염 및 비정상 중이염 중 어느 하나의 중이염 질환으로 2차적으로 분류하도록 학습된 딥러닝 모델을 이용하여 대상 고막 내시경 영상의 정상 여부를 분류하는 단계;상기 대상 고막 내시경 영상이 비정상으로 분류된 경우, 상기 딥러닝 모델 및 이상값 탐지 모델 중 적어도 하나를 이용하여 상기 대상 고막 내시경 영상을 상기 어느 하나의 중이염 질환으로 분류하는 단계를 포함하는 영상진단 방법."}
{"patent_id": "10-2023-0131189", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "제10항에 있어서,상기 고막 내시경 영상에서 추출된 특징에 기초하여 정상인데 비정상으로 판단할 확률 분포와 비정상인데 정상공개특허 10-2025-0047009-4-으로 판단할 확률 분포에 대해 서로 다른 가중치를 부여한 가중손실함수를 사용하여 상기 고막 내시경 영상을정상 또는 비정상으로 분류하도록 상기 딥러닝 모델을 학습하는 단계를 포함하는 영상 진단 방법."}
{"patent_id": "10-2023-0131189", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제11항에 있어서,상기 딥러닝 모델을 학습하는 단계는,상기 고막 내시경 영상이 비정상인 경우, 중이염 질환 클래스 별 데이터 분포에 따라 차등적으로 가중치를 부여한 가중손실함수를 사용하여 상기 고막 내시경 영상을 급성 중이염, 만성 중이염, 삼출성 중이염 및 비정상 중이염 중 어느 하나의 중이염 질환으로 분류하도록 상기 딥러닝 모델을 학습하는 단계를 포함하는 영상 진단 방법."}
{"patent_id": "10-2023-0131189", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "제12항에 있어서,상기 딥러닝 모델을 학습하는 단계는,2 이상의 딥러닝 모델들의 분류 결과를 다수결 기반의 앙상블, 만장일치 기반의 앙상블 및 불확실성 기반의 앙상블 중 적어도 하나를 기초로 앙상블 시켜 상기 딥러닝 모델을 학습하는 단계를 포함하는 영상 진단 방법."}
{"patent_id": "10-2023-0131189", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_14", "content": "제13항에 있어서,상기 딥러닝 모델을 학습하는 단계는,Stratified KFold 값으로 분할된 데이터 셋을 이용하여 차등적으로 학습된 모델의 예측값을 바탕으로, 하드 보팅(Hard Voting) 방식에 기초하여 다수결 기반의 앙상블 모델을 학습하는 단계를 포함하는 영상 진단 방법."}
{"patent_id": "10-2023-0131189", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_15", "content": "제14항에 있어서,상기 딥러닝 모델을 학습하는 단계는,상기 앙상블 모델과 상기 이상값 탐지 모델에서 예측한 값을 스태킹하여 최종적으로 중이염 질환을 진단하도록학습하는 단계를 포함하는 영상 진단 방법."}
{"patent_id": "10-2023-0131189", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_16", "content": "제10항에 있어서,상기 딥러닝 모델을 학습하는 단계 이전에,상기 고막 내시경 영상에서 허프 그래디언트 방법을 이용하여 중이를 포함하는 원 영역을 검출하는 단계;상기 고막 내시경 영상에서 상기 원 영역을 제외한 나머지 영역을 제거한 후 기 정의된 사이즈로 영상을 조정하는 단계를 포함하는 영상 진단 방법."}
{"patent_id": "10-2023-0131189", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_17", "content": "제16항에 있어서,상기 영상을 조정하는 단계는,기 정의된 사이즈로 상기 조정된 영상을 이루는 복수의 픽셀에 대한 CIE L*a*b* 값 중 영상의 밝기 정보를 포함하는 L채널을 추출하는 단계;추출된 L 채널에 CLAHE(Contrast Limited Adaptive Histogram Equalization) 기법을 이용하여, 상기 영상의 밝기 정보를 조정하는 단계를 포함하는 영상 진단 방법.공개특허 10-2025-0047009-5-청구항 18 제11항에 있어서,상기 어느 하나의 중이염 질환으로 분류하는 단계는,상기 고막 내시경 영상이 비정상인 경우, 룰 기반(rule-based) 로직 및 오토 인코더(autoencoder)를 포함하는상기 이상값 탐지 모델을 이용하여 중이염 질환 각각에 대한 임상적 특성을 기반으로 상기 고막 내시경 영상을상기 어느 하나의 중이염 질환으로 분류하는 단계를 포함하는 영상 진단 방법."}
{"patent_id": "10-2023-0131189", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_19", "content": "제18항에 있어서,상기 어느 하나의 중이염 질환으로 분류하는 단계는,상기 고막 내시경 영상을 이루는 복수의 픽셀에 대한 CIE L*a*b* 값 중 a 채널을 추출하는 단계;이상값 탐지(Outlier Detection) 방법을 이용하여 상기 중이염 질환 별 임상적 특성에 따라 임계값을 설정하는단계;상기 a 채널을 구성하는 값과 상기 임계값에 기초하여 상기 중이염 질환을 분류하는 단계를 포함하는 영상 진단방법."}
{"patent_id": "10-2023-0131189", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_20", "content": "제10항에 있어서,상기 대상 고막 내시경 영상의 정상 여부 및 비정상인 경우 분류된 중이염 질환을 포함하는 진단 정보를 생성하는 단계;디스플레이에 상기 진단 정보를 표시하는 단계를 더 포함하는 영상 진단 방법."}
{"patent_id": "10-2023-0131189", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명의 일 실시예에 따른 중이염 질환을 진단하는 영상 진단 장치에 있어서, 고막 내시경 영상에 대해 정상과 비정상을 1차적으로 분류하고, 비정상인 경우 급성 중이염, 만성 중이염, 삼출성 중이염 및 비정상 중이염 중 어 느 하나의 중이염 질환으로 2차적으로 분류하도록 학습된 딥러닝 모델을 이용하여 대상 고막 내시경 영상의 정상 여부를 분류하고, 상기 대상 고막 내시경 영상이 비정상으로 분류된 경우, 상기 딥러닝 모델을 이용하여 상기 대 상 고막 내시경 영상을 상기 어느 하나의 중이염 질환으로 분류하는 프로세서를 포함할 수 있다."}
{"patent_id": "10-2023-0131189", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 중이염 질환을 진단하는 영상 진단 장치 및 영상 진단 방법에 관한 것이다."}
{"patent_id": "10-2023-0131189", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "최근 의료진의 진료를 돕기 위하여 컴퓨터 등 영상 진단 장치를 이용하여 의료 영상으로부터 자동으로 질병의 유무를 판별하는 기술이 도입되고 있다. 그러나, 기존의 영상 진단 기술들은, 실질적인 환자 데이터에 대한 접 근이 쉽지 않기 때문에 개발된 모델들은 실제 데이터 분포를 잘 반영하지 못한다는 단점이 있다. 예를 들어, 병 원을 방문하는 사람들은 환자 카테고리로 분류된다는 것, 그래서 정상 데이터 보다 질환이 있는 데이터의 수가 훨씬 많다. 또한, 종합병원에 올 정도로 상대적으로 중증인 환자들만이 내원하기에, 급성 중이염과 같이 치료의 시급성은 높으나, 정작 종합 병원에 내원할 수준이면, 이미 급성에서 만성으로 진행된 이후일 가능성이 높다. 그리하여, 종합 병원 데이터 중 급성 중이염과 같은 데이터의 수가 극도로 적을 수 밖에 없는 점 등의 내용을 감안하지 않고, 모델을 개발하는 경우가 많다. 또한, 많은 진단 예측 모델들은 정확도를 최적화한 모델 설계들이 주류를 이루는데, 위음성(False negative) 즉, 질환이 없다고 판명하였지만, 실제적으로 질환이 있는 환자들은 제때에 적절한 치료를 받지 못하는 치명적 인 단점이 있는 바, 위음성 확률을 낮추는 것이 시급하다. 이러한 점들을 개선하기 위해, 실제 의료 현장 데이터의 특성을 반영하여 모델의 정확도, 정밀도, 민감도를 전 반적으로 향상을 꾀하고, 위음성 확률을 낮출 수 있는 모델 개발이 시급한 실정이다."}
{"patent_id": "10-2023-0131189", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명의 목적은 정확도, 정밀도 및 민감도 높은 딥러닝 모델을 이용하는 영상 진단 장치 및 영상 진단 방법을 제공하는 것이다. 특히, 모델의 가중치 조정을 통해서 위음성을 획기적으로 낮출 수 있는 딥러닝 모델을 이용하 는 영상 진단 장치 및 영상 진단 방법을 제공하는 것이다."}
{"patent_id": "10-2023-0131189", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명의 일 실시예에 따른 중이염 질환을 진단하는 영상 진단 장치에 있어서, 고막 내시경 영상에 대해 정상 과 비정상을 1차적으로 분류하고, 비정상인 경우 급성 중이염, 만성 중이염, 삼출성 중이염 및 비정상 중이염 중 어느 하나의 중이염 질환으로 2차적으로 분류하도록 학습된 딥러닝 모델을 이용하여 대상 고막 내시경 영상 의 정상 여부를 분류하고, 상기 대상 고막 내시경 영상이 비정상으로 분류된 경우, 상기 딥러닝 모델 및 이상값 탐지 모델 중 적어도 하나를 이용하여 상기 대상 고막 내시경 영상을 상기 어느 하나의 중이염 질환으로 분류하 는 프로세서를 포함할 수 있다. 상기 딥러닝 모델은, 상기 고막 내시경 영상에서 추출된 특징에 기초하여 정상인데 비정상으로 판단할 확률 분 포와 비정상인데 정상으로 판단할 확률 분포에 대해 서로 다른 가중치를 부여한 가중손실함수를 사용하여 상기 고막 내시경 영상을 정상 또는 비정상으로 분류하도록 학습된 1차 분류기;를 포함할 수 있다. 상기 딥러닝 모델은, 상기 고막 내시경 영상이 비정상인 경우, 중이염 질환 클래스 별 데이터 분포에 따라 차등 적으로 가중치를 부여한 가중손실함수를 사용하여 상기 고막 내시경 영상을 급성 중이염, 만성 중이염, 삼출성 중이염 및 비정상 중이염 중 어느 하나의 중이염 질환으로 분류하도록 학습된 2차 분류기;를 더 포함할 수 있다. 상기 1차 분류기는, 2 이상의 딥러닝 모델들의 분류 결과를 다수결 기반의 앙상블, 만장일치 기반의 앙상블 및 불확실성 기반의 앙상블 중 적어도 하나를 기초로 앙상블 시켜 학습될 수 있다. 상기 프로세서는, 상기 고막 내시경 영상에서 허프 그래디언트 방법을 이용하여 중이를 포함하는 원 영역을 검 출하고, 상기 고막 내시경 영상에서 상기 원 영역을 제외한 나머지 영역을 제거한 후 기 정의된 사이즈로 영상 을 조정할 수 있다. 상기 프로세서는, 기 정의된 사이즈로 상기 조정된 영상을 이루는 복수의 픽셀에 대한 CIE L*a*b* 값 중 영상의 밝기 정보를 포함하는 L채널을 추출하고, 추출된 L 채널에 CLAHE(Contrast Limited Adaptive Histogram Equalization) 기법을 이용하여, 상기 영상의 밝기 정보를 조정할 수 있다. 상기 이상값 탐지 모델은, 상기 고막 내시경 영상이 비정상인 경우, 중이염 질환 각각에 대한 임상적 특성을 기 반으로 상기 고막 내시경 영상을 상기 어느 하나의 중이염 질환으로 분류하는 룰 기반 로직 및 오토인코더를 포 함할 수 있다. 상기 프로세서는, 상기 고막 내시경 영상을 이루는 복수의 픽셀에 대한 CIE L*a*b* 값 중 a 채널을 추출하고, 통계적 이상값 탐지(Outlier Detection) 방법을 이용하여 상기 중이염 질환 별 임상적 특성에 따라 임계값을 설 정하고, 상기 a 채널을 구성하는 값과 상기 임계값에 기초하여 상기 룰 기반 로직에 따른 상기 중이염 질환을 분류할 수 있다. 상기 영상 진단 장치는 디스플레이를 더 포함하고, 상기 프로세서는, 상기 대상 고막 내시경 영상의 정상 여부 및 비정상인 경우 분류된 중이염 질환을 포함하는 진단 정보를 생성하고, 상기 디스플레이에 상기 진단 정보를 표시할 수 있다. 본 발명의 일 실시예에 따른 영상 진단 장치에 의해 수행되는 중이염 질환을 진단하는 영상 진단 방법에 있어서, 고막 내시경 영상에 대해 정상과 비정상을 1차적으로 분류하고, 비정상인 경우 급성 중이염, 만성 중이 염, 삼출성 중이염 및 비정상 중이염 중 어느 하나의 중이염 질환으로 2차적으로 분류하도록 학습된 딥러닝 모 델을 이용하여 대상 고막 내시경 영상의 정상 여부를 분류하는 단계; 상기 대상 고막 내시경 영상이 비정상으로 분류된 경우, 상기 딥러닝 모델 및 이상값 탐지 모델 중 적어도 하나를 이용하여 상기 대상 고막 내시경 영상을 상기 어느 하나의 중이염 질환으로 분류하는 단계를 포함할 수 있다. 상기 방법은, 상기 고막 내시경 영상에서 추출된 특징에 기초하여 정상인데 비정상으로 판단할 확률 분포와 비 정상인데 정상으로 판단할 확률 분포에 대해 서로 다른 가중치를 부여한 가중손실함수를 사용하여 상기 고막 내 시경 영상을 정상 또는 비정상으로 분류하도록 상기 딥러닝 모델을 학습하는 단계를 포함할 수 있다. 상기 딥러닝 모델을 학습하는 단계는, 상기 고막 내시경 영상이 비정상인 경우, 중이염 질환 클래스 별 데이터 분포에 따라 차등적으로 가중치를 부여한 가중손실함수를 사용하여 상기 고막 내시경 영상을 급성 중이염, 만성 중이염, 삼출성 중이염 및 비정상 중이염 중 어느 하나의 중이염 질환으로 분류하도록 상기 딥러닝 모델을 학습 하는 단계를 포함할 수 있다. 한편, 학습을 위한 데이터 수량이 적은 경우, 딥러닝 모델을 학습하는 방안 이외 에도 임상적 특성을 데이터에서 추출한 Rule-based 형태로 분류할 수 있다. 상기 딥러닝 모델을 학습하는 단계는, 2 이상의 딥러닝 모델들의 분류 결과를 다수결 기반의 앙상블, 만장일치 기반의 앙상블 및 불확실성 기반의 앙상블 중 적어도 하나를 기초로 앙상블 시켜 상기 딥러닝 모델을 학습하는 단계를 포함할 수 있다. 상기 딥러닝 모델을 학습하는 단계는, Stratified KFold 값으로 분할된 데이터 셋을 이용하여 차등적으로 학습 된 모델의 예측값을 바탕으로, 하드 보팅(Hard Voting) 방식에 기초하여 다수결 기반의 앙상블 모델을 학습하는 단계를 포함할 수 있다. 상기 딥러닝 모델을 학습하는 단계는, 상기 앙상블 모델과 상기 이상 탐지 모델에서 예측한 값을 스태킹하여 최 종적으로 중이염 질환을 진단하도록 학습하는 단계를 포함할 수 있다. 상기 딥러닝 모델을 학습하는 단계 이전에, 상기 고막 내시경 영상에서 허프 그래디언트 방법을 이용하여 중이 를 포함하는 원 영역을 검출하는 단계; 상기 고막 내시경 영상에서 상기 원 영역을 제외한 나머지 영역을 제거 한 후 기 정의된 사이즈로 영상을 조정하는 단계를 포함할 수 있다. 아울러, 고막 이미지의 특성상 내시경 빛으 로 인한 추가 데이터가 생성되는데, 이미지의 대비를 향상시키기 위해 히스토그램 균일화를 적용하는 CLAHE(Contrast Limited Adaptive Histogram Equalization) 기법을 적용하여, 이미지 밝기 정보를 개선하는 효 과를 기대할 수 있다. 상기 어느 하나의 중이염 질환으로 분류하는 단계는, 상기 고막 내시경 영상이 비정상인 경우, 룰 기반(rule- based) 로직 및 오토 인코더(autoencoder)를 포함하는 상기 이상값 탐지 모델을 이용하여 중이염 질환 각각에 대한 임상적 특성을 기반으로 상기 고막 내시경 영상을 상기 어느 하나의 중이염 질환으로 분류하는 단계를 포 함할 수 있다. 상기 방법은, 상기 대상 고막 내시경 영상의 정상 여부 및 비정상인 경우 분류된 중이염 질환을 포함하는 진단 정보를 생성하는 단계; 디스플레이에 상기 진단 정보를 표시하는 단계를 더 포함할 수 있다."}
{"patent_id": "10-2023-0131189", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명의 일 실시예에 따르면, 실제 의료 현장의 고막 내시경 영상 진단의 정확도, 정밀도, 민감도를 비약적으 로 높일 수 있다. 본 발명의 일 실시예에 따르면, 중이염 영상 진단의 에러를 최소화할 수 있는 영상 진단 장치 및 영상 진단 방 법을 제공할 수 있다."}
{"patent_id": "10-2023-0131189", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하, 본 발명에 따른 바람직한 실시 형태를 첨부된 도면을 참조하여 상세하게 설명한다. 첨부된 도면과 함께 이하에 개시될 상세한 설명은 본 발명의 예시적인 실시형태를 설명하고자 하는 것이며, 본 발명이 실시될 수 있 는 유일한 실시형태를 나타내고자 하는 것이 아니다. 도면에서 본 발명을 명확하게 설명하기 위해서 설명과 관 계없는 부분은 생략할 수 있고, 명세서 전체를 통하여 동일 또는 유사한 구성 요소에 대해서는 동일한 참조 부 호를 사용할 수 있다. 도 1은 본 발명의 일 실시예에 따른 영상 진단 장치의 동작 모습을 도시한 개략도이다. 도 1을 참조하면, 고막 내시경 영상(이하, 내시경 영상 이라고도 한다.), 딥러닝 모델 및 영상 진 단 장치가 도시되어 있다. 본 발명의 일 실시예에 따르면, 영상 진단 장치는 딥러닝 모델을 이용 하여 내시경 영상의 정상 유무를 분류 및 비정상인 경우 질환의 종류를 분류하고, 진단 정보를 제공하는 장 치로써, 컴퓨터, 서버, 스마트 폰, 태블릿 PC, 스마트 패드, 노트북 등으로 구현될 수 있다. 본 발명의 일 실시예에 따르면, 고막 내시경 영상은 피검사자의 귀에 내시경을 삽입하여 중이(middle ear) 등을 촬영하여 획득한 영상으로, 내시경의 종류에 따라 카메라, 라이다 등을 장착할 수 있다. 본 발명에서는, 실제 의료 현장 데이터의 특성을 반영하여 모델의 정확도, 정밀도, 민감도를 높일 뿐 아니라, F-beta Score 수치를 최적화하여, 위음성을 획기적으로 낮출 수 있는 방안에 대해 제안한다. 이하, 도면들을 참조하여 본 발명의 일 실시예에 따른 전자장치의 구성 및 동작에 대해 구체적으로 설명한다. 도 2는 본 발명의 일 실시예에 따른 영상 진단 장치의 구성을 도시한 블럭도이다. 본 발명의 일 실시예에 따른 영상 진단 장치는 입력부, 통신부, 표시부, 저장부 및 프로세서를 포함한다. 입력부는 영상 진단 장치의 사용자 입력에 대응하여 입력데이터를 발생시킨다. 예를 들어, 사용자 입 력은 영상 진단 장치의 동작을 시작하게 하는 사용자 입력, 내시경 영상을 입력하기 위한 사용자 입력 등일 수 있으며, 이 외에도 영상 진단을 위해 필요한 사용자 입력인 경우 제한하지 않고 적용 가능하다. 입력부는 적어도 하나의 입력수단을 포함한다. 입력부는 키보드(key board), 키패드(key pad), 돔 스 위치(dome switch), 터치패널(touch panel), 터치 키(touch key), 마우스(mouse), 메뉴 버튼(menu button) 등 을 포함할 수 있다. 통신부는 내시경 영상, 딥러닝 모델, 진단 정보 등을 송수신하기 위해 내시경, 서버 등 외부장치 와의 통신을 수행한다. 이를 위해, 통신부는 5G(5th generation communication), LTE-A(long term evolution-advanced), LTE(long term evolution), Wi-Fi(wireless fidelity), Bluetooth 등의 무선 통신, 혹은 LAN(local area network), WAN(Wide Area Network), 전력선 통신 등의 유선 통신을 수행할 수 있다. 표시부는 영상 진단 장치의 동작에 따른 표시 데이터를 표시한다. 표시부는 내시경 영상을 표시하는 화면, 진단 정보를 표시하는 화면, 사용자 입력을 수신하는 화면 등을 표시할 수 있다. 표시부는 액정 디스플레이(LCD; liquid crystal display), 발광 다이오드(LED; light emitting diode) 디 스플레이, 유기 발광 다이오드(OLED; organic LED) 디스플레이, 마이크로 전자기계 시스템(MEMS; micro electro mechanical systems) 디스플레이 및 전자 종이(electronic paper) 디스플레이를 포함한다. 표시부 는 입력부와 결합되어 터치 스크린(touch screen)으로 구현될 수 있다. 저장부는 영상 진단 장치의 동작 프로그램들을 저장한다. 저장부는 전원의 제공 유무와 무관하 게 데이터(정보)를 보존할 수 있는 비휘발성 속성의 스토리지(storage)와, 프로세서에 의해 처리되기 위한 데이터가 로딩되며 전원이 제공되지 않으면 데이터를 보존할 수 없는 휘발성 속성의 메모리(memory)를 포함한다. 스토리지에는 플래시메모리(flash-memory), HDD(hard-disc drive), SSD(solid-state drive) ROM(Read Only Memory) 등이 있으며, 메모리에는 버퍼(buffer), 램(RAM; Random Access Memory) 등이 있다. 저장부는 내시경 영상, 딥러닝 모델, 진단 정보 등을 저장할 수 있다. 저장부는 딥러닝 모델 구축, 내시경 영상의 전처리, 내시경 영상의 정상 여부, 비정상인 경우 구체적인 질환 분류 등을수행하는 과정에서 필요한 연산 프로그램 등을 저장할 수 있다. 프로세서는 프로그램 등 소프트웨어를 실행하여 영상 진단 장치의 적어도 하나의 다른 구성요소(예: 하드웨어 또는 소프트웨어 구성요소)를 제어할 수 있고, 다양한 데이터 처리 또는 연산을 수행할 수 있다. 본 발명의 일 실시예에 따른 프로세서는 고막 내시경 영상에 대해 정상과 비정상을 1차적으로 분류하고, 비정상인 경우 급성 중이염, 만성 중이염, 삼출성 중이염 및 비정상 중이염 중 어느 하나의 중이염 질환으로 2 차적으로 분류하도록 학습된 딥러닝 모델을 이용하여 대상 고막 내시경 영상의 정상 여부를 분류하고, 상기 대 상 고막 내시경 영상이 비정상으로 분류된 경우, 상기 딥러닝 모델을 이용하여 상기 대상 고막 내시경 영상을 상기 어느 하나의 중이염 질환으로 분류할 수 있다. 이때, 프로세서는 고막 내시경 영상을 분류하는 딥러닝 모델을 학습하거나, 기 학습되어 생성된 딥러닝 모 델을 외부로부터 수신 및 저장하여 이용할 수 있으며 어느 하나에 한정되는 것은 아니다. 한편, 프로세서는 상기 동작들을 수행하기 위한 데이터 분석, 처리, 및 결과 정보 생성 중 적어도 일부를 규칙 기반 또는 인공지능(Artificial Intelligence) 알고리즘으로서 기계학습, 신경망 네트워크(neural network), 또는 딥러닝 알고리즘 중 적어도 하나를 이용하여 수행할 수 있다. 신경망 네트워크의 예로는, CNN (Convolutional Neural Network), DNN (Deep Neural Network), RNN (Recurrent Neural Network), Vision Transformer과 같은 모델을 포함할 수 있다. 도 3은 본 발명의 일 실시예에 따른 영상 진단 장치의 동작 흐름도를 도시한 도면이다. 본 발명의 일 실시예에 따른 프로세서는 고막 내시경 영상에 대해 정상과 비정상을 1차적으로 분류하 고, 비정상인 경우 급성 중이염, 만성 중이염, 삼출성 중이염 및 비정상 중이염 중 어느 하나의 중이염 질환으 로 2차적으로 분류하도록 학습된 딥러닝 모델을 이용하여 대상 고막 내시경 영상의 정상을 포함한 중이염 종류를 분류할 수 있다(S10). 딥러닝 모델은 고막 내시경 영상을 정상 또는 비정상으로 분류하도록 학습된 1차 분류기 및 고막 내시 경 영상이 비정상인 경우, 고막 내시경 영상을 급성 중이염, 만성 중이염, 삼출성 중이염 및 비정상 중 이염 중 어느 하나의 중이염 질환으로 분류하도록 학습된 2차 분류기를 포함할 수 있다. 딥러닝 모델의 학 습 과정은 도 5 내지 도 7을 참조하여 설명한다. 대상 고막 내시경 영상은, 대상체(환자)의 고막 내시경 영상을 의미하며, 프로세서는 내시경으로부터 유무 선 통신을 통해 대상 고막 내시경 영상을 수신할 수 있다. 대상 고막 내시경 영상의 획득 경로 및 방법은 어느 하나에 한정되지 않는다. 본 발명의 일 실시예에 따른 프로세서는 대상 고막 내시경 영상이 비정상으로 분류된 경우, 딥러닝 모델 및 이상값 탐지 모델 중 적어도 하나를 이용하여 대상 고막 내시경 영상을 어느 하나의 중이염 질환으로 분류할 수 있다(S20). 중이염 질환은 급성 중이염, 만성 중이염, 삼출성 중이염 및 비정상 중이염을 포함할 수 있다. 도 4는 본 발명의 일 실시예에 딥러닝 기반 분류된 중이염 질환을 도시한 도면이다. 도 5는 본 발명의 일 실시예에 따른 딥러닝 모델의 학습 과정 및 영상 진단 장치의 동작 모습을 도시한 도면이 다. 앞서 서술한 바와 같이, 프로세서는 고막 내시경 영상을 분류하는 딥러닝 모델을 학습하거나, 기 학습되어 생성된 딥러닝 모델을 외부로부터 수신 및 저장하여 이용할 수 있다. 본 도면에서는, 프로세서가 딥러닝 모델을 학습하는 과정 및 딥러닝 모델을 이용한 영상 진단 장치의 동작 과정에 대해 설명한다. 딥러닝 모델은 다층의 네트워크로 이루어진 심층 신경망에서 다량의 데이터를 학습시킴으로써 각각의 영상의 특 징을 자동으로 학습하고, 이를 통해 목적 함수, 즉 예측 정확도의 에러를 최소화시키는 방법으로 네트워크를 학 습시켜 나아가는 형태이다. 본 명세서에서 딥러닝 모델은 예를 들어, CNN 기반의 Inception V3 모델일 수 있다. 먼저, 프로세서는 딥러닝 모델의 입력 데이터(학습 데이터)를 마련하기 위해 내시경 영상을 전처리할 수 있다. 내시경 영상의 로(raw) 데이터는 배경 화면(검은색)과 중이 이미지(원 안 픽셀로 구성됨)와 촬영된 시기 를 포함하는 라벨링 임상 데이터로 구성될 수 있다. 우선적으로, 내시경 영상을 딥러닝 모델의 입력 데이터로 활용하기 위하여, 표준화된 영상 크기로 변경하는 프 로세스가 필요하다. 이를 위하여, 각 이미지 별 세로(height)x가로(width)의 비율은 유지할 수 있도록 로직을 다음과 같이 설계할 수 있다. 우선 타겟 사이즈를 정하고, 신규 가로 비(width ratio)와 세로 비(height rati o)를 구하기 위해, 타겟 사이즈를 원본 이미지의 가로와 세로로 나눠주게 된다. 그 이후, 가로 비가 세로 비보다 작을 때는, 신규 가로는 타겟 사이즈의 가로와 동일하게 두고, 신규 세로는 기 존 세로(original height)와 가로 비를 곱하여 구할 수 있다. 반대 경우인 가로 비가 세로 비보다 클 때는, 신 규 가로는 기존 가로(original width)와 세로 비를 곱하여 구하고, 신규 세로는 타겟 사이즈로 둘 수 있다. 신규 가로와 신규 세로로 설정된 이미지를 (480x480) 타겟 사이즈로 변경하기 위하여, LANCZOS 기법을 활용하여 이미지의 화질은 유지하되, 이미지 사이즈로 변경을 진행하게 되고, 변경된 이미지를 중앙에 위치시키기 위하여, 다음과 같은 로직을 따르게 된다. Left 변수는 (target width - new width)이를 2로 나눈 몫의 값을 설정하게 되고, top 변수는 (target height - new height)를 2로 나눈 몫의 값을 설정한다. 사이즈가 변경된 이미지에 Left 또는 Top 변수가 0이 아닌 경우에만, 0으로 이미지 부분을 채워주어(패딩) 최종적으로 사이즈가 변경된 고막 이미지가 전체 이미지 중앙에 위치하도록 한다. 1차적으로, 480x480 사이즈가 변경된 이미지에서 원 안의 중이 이미지만을 뽑아 내기 위해 허프 변환 원 검출 로직을 사용한다. 프로세서는 고막 내시경 영상에서 허프 그래디언트 방법을 이용하여 중이를 포함하는 원 영역을 검출할 수 있다. 관련하여 도 9를 참조한다. 수학식 1"}
{"patent_id": "10-2023-0131189", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "수학식 1은, 중심 좌표가 (a, b)이고, 반지름이 r인 원의 방정식이다. 3차원 파라미터 공간에서 축적 배열을 정 의하고, 사용하려면 많은 메모리와 연산 시간을 필요로 하므로, 본 발명에서는 허프 변환 대신 허프 그래디언트 방법(Hough gradient method)을 사용하여 원을 검출한다. 허프 그래디언트 방법은 2단계로 구성되며, 1단계에서는 영상에 존재하는 모든 원의 중심 좌표를 검출하고, 2단 계에서 검출된 원의 중심으로부터 원에 적합한 반지름을 구한다. 1단계에서는 축적 배열이 사용되며, 축적 배열 은 파라미터 공간에서 만드는 것이 아닌 동일한 xy좌표 공간에서 2차원 배열로 만든다. 원의 중심을 찾기 위해 허프 그래디언트 방법은 입력 영상의 모든 에지 픽셀에서 그래디언트 구하고, 그래디언트 방향을 따르는 직선상 의 축적 배열 값을 1씩 감소시킨다. 원주상에 모든 점에 대해 그래디언트 방향의 직선을 그리고, 직선상의 축적 배열 값을 증가시키면 원의 중심 위 치에서 축적 배열 값이 크게 나타난다. 원의 중심을 찾은 후, 다양한 반지름의 원에 대해 원주상에 충분히 많은 에지 픽셀이 존재하는지 확인하여 적절한 반지름을 선택할 수 있다. OpenCV를 활용해서, 원을 검출하기 위해서 쓰는 파라미터 옵션 값 중 설정해야 하는 값은, Canny 엣지 검출을 위한 임계값, 작은 원과 큰 원 간의 거리 임계값, 최소 반지름 크기, 최대 반지름 크기 등이 있다. 일단, 쉬운 것부터 설정하자면, 최대 반지름의 경우 480 고정된 이미지 사이즈를 벗어날 수 없기에 480으로 설정하고, 최소 반지름의 크기는 보유하고 있는 데이터의 trials―and-error 방식으로 발견해낸 15 크기를 설정한다. 원 간의 최소 거리는 의미가 없는 파라미터 값이므로 임의의 값인 100으로 두게 되고, 가장 중요한 Canny 엣지 검출을 위한 임계값 로직은 우선 시작을 15 최소값으로 시작하여 점차적으로 임계값을 상승시키다 최대값 100은 넘지 않게 설정해 주어야, 원의 형태가 찌그러지든, 일부의 이미지가 가려지더라도 도출되는 것을 확인하였다. 프로세서는 고막 내시경 영상에서 중이를 포함하는 원 영역을 검출하고, 고막 내시경 영상에서 원 영역을 제외한 나머지 영역을 제거한 후 기 정의된 사이즈로 영상을 조정할 수 있다. 예를 들어, 프로세서는 딥러 닝 모델 학습의 용이성을 위해 (480x640) 크기의 내시경 영상을 (480x480), (224x224) 등 중이 이미지와 최소한 의 배경을 포함한 정사각형 형태의 영상으로 조정할 수 있다. 프로세서는 정사각형 형태의 영상을 추출한 이후, 고막 이미지에 대한 전처리 과정을 포함한다. 고막 내시 경 영상은, 이미지 생성 원리 상, 내시경 빛에 의해 반사되는 중이의 이미지를 담게 되는데, 이 때 내시경 빛은 모델이 판단할 수 있는 정보를 가리는 현상이 발생할 수 있다. 이러한 밝기 처리 문제를 해결하기 위해, 본 연 구진은 RGB(빨간색, 녹색, 파란색) 이미지 형태를 CIE L*a*b* (밝기, 빨강/녹색, 파랑/노랑)(이하, LAB라고도한다.) 형태로 전환하고, L 채널(밝기)만 추출하여, CLAHE(Contrast Limited Adaptive Histogram Equalization) 기법을 적용하여, 원본 이미지 상의 이미지 밝기 대비를 향상시키고, 이미지의 세부 사항이 뚜렷 해 지는 결과를 도출할 수 있다. 이 때, CLAHE 기법을 최적으로 적용하기 위한 중요한 2가지 매개변수가 있는데 이는 Clip limit와 Tile grid size이다. Clip limit는 CLAHE에서 히스토그램 균일화를 수행할 때 사용되는 대비 제한 값으로, 히스토그램을 자르는 정도를 결정한다. Tile grid size의 경우, 로컬 히스토그램 균일화를 수행할 때 영상을 격자 형태로 나 누는 크기를 결정한다. 이 두 개의 매개변수를 최적화하기 위하여, GridSearch 기법을 활용하여, 중이염 이미지 에 최적화된 Clip limit와 Tile grid size를 도출해 낼 수 있다. 프로세서는 임상 실제 현장 데이터의 불균형(Imbalanced)적인 상황을 고려하고, 이에 따른 딥러닝 분류 예 측 성능을 향상시키기 위해, 학습 과정에서 다양한 기법을 활용할 수 있다. 예를 들어, 프로세서는 데이터 증강(Data Augmentation) 기법을 활용하여, 학습 영상의 다양한 파생된 영 상을 생성하고 포괄적으로 모델 학습을 수행할 수 있다. 예를 들어, 프로세서는 파라미터 값(Tensorflow ImageDataGenerator 메소드를 활용하여 Rotation range=40, width shift range=0.2, height shift range=0.2, shear range=0.2, zoom range=0.2, horizontal flip = True, vertical flip = False)을 사용하여 데이터 증강 을 수행할 수 있다. 또한, 프로세서는 데이터 분포의 치우침을 반영하기 위하여 Stratified KFold 기법을 활용할 수 있다. 모 델의 최적화 성능 튜닝을 위해서 검증 데이터 셋의 F beta score 기준으로 튜닝을 진행할 수 있다. 이때 최적화 된 Beta값을 구하기 위해 아래의 표 1와 같은 테스트를 진행하게 된다. 표 1 Beta 특이도(Specificity) 가중치 민감도(Sensitivity) 가중치 1 1.00 1.00 2 0.80 1.25 3 0.70 1.50 4 0.67 1.67 5 0.63 1.80 10 0.53 2.25 20 0.48 2.80 학습 데이터와 검증 데이터의 뚜렷한 구분을 위하여, 시험(Test) 데이터는, 병원을 내원한 최근 사례 500 건을 따로 떼어놓고, 모델 성능에 대한 테스트 데이터 셋으로 활용하였다. 프로세서는 고막 내시경 영상에서 추출된 특징에 기초하여 정상인데 비정상으로 판단할 확률 분포와 비정 상인데 정상으로 판단할 확률 분포에 대해 서로 다른 가중치를 부여한 가중손실함수를 사용하여 고막 내시경 영 상을 정상 또는 비정상으로 분류하도록 학습된 1차 분류기를 생성할 수 있다. 이를 위해, 프로세서는 네트워크 내부의 중첩된 컨볼루션 연산을 통해 내시경 영상을 추상화하고, 가장 마 지막 컨볼루션 계층의 결과물을 추출하는 과정을 통해 내시경 영상의 특징을 추출할 수 있다. 예를 들어, 분류 목적(이진 분류 혹은 다중 분류)에 따라 컨볼루션 계층의 결과물을 의미하는 병목(Bottleneck) 특징을 추출할 수 있다. 네트워크를 훈련하는 과정은 컨벌루션 연산에서의 필터 종류, 오프셋, 필터 계수 등 학습 파라미터로 구성되어 진행된다. 학습 과정은 순방향 전파를 통해 학습하고, 역전파 알고리즘을 통해 예측된 결과와 실제 데이터 간의 오류를 교정하는 방식으로 가중치를 업데이트하게 된다. 컨볼루션 계층의 계수들은 사전 훈련된 상태로 가져와 내시경 영상의 분류 특성에 맞게 미세 조정(Fine-tuning)할 수 있다. 프로세서는 전이학습 방식을 차용하여, 딥러닝 모델, 예를 들어 InceptionV3,의 말단 레이어를 제거하고, 전역 평균 풀링(Global Average pooling) 레이어와 덴스(완전 연결) 레이어를 추가하여 분류 및 학습을 수행할 수 있다. 의료 데이터에서는 환자가 질병이 있는 데도 불구하고, 모델의 예측이 부정확하여 환자의 질병을 진단하지 못할 경우가 발생할 수 있다. 즉, 표 2와 같이, 검사결과 음성인데, 실제로 질병이 있는 경우를 위음성(Falsenegative)이라 하고, 실제로 질병이 없는데 검사결과 양성일 경우 위양성(False positive)이라 한다. 위음성과 위양성은 각각 진단 결과 에러로 전자를 타입 II 에러(type II error), 후자를 타입 I 에러(type I error)라고 한다. 표 2 질병이 있음(환자) 질병이 없음(정상인) 검사결과 양성 진양성(True positive) 위양성(False positive) 검사결과 음성 위음성(False negative) 진음성(True negative) 대표적으로 딥러닝 모델의 성능 지표로 쓰이는 정확도, 특이도, 민감도, F-beta score를 수학식으로 표현하면 다음 수학식 2 내지 수학식 5와 같다. 수학식 2"}
{"patent_id": "10-2023-0131189", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "수학식 3"}
{"patent_id": "10-2023-0131189", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "수학식 4"}
{"patent_id": "10-2023-0131189", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 5, "content": "수학식 5"}
{"patent_id": "10-2023-0131189", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 6, "content": "영상 진단의 정확도를 높이는 것은 타입 I 에러와 타입 II 에러를 동시에 최소화하는 것이다. 타입 에러를 최소 화하는 것은 특이도를 높이는 것이고, 타입 II 에러를 최소화하는 것은 민감도를 높이는 것이다. 특히, 영상 진단 검사에서 환자 치료를 위해서는 타입 I 에러보다, 타입 II 에러를 최소화하는 것이 훨씬 더 중 요할 수 있다. 왜냐하면, 영상 진단 검사에서 질병이 없는 것으로 영상 진단 결과가 나왔으나, 실제로 질병이 있는 환자는 그 질병에 대한 치료시기를 미루거나 놓치므로 환자에게 치명적인 문제를 야기할 수 있기 때문이다. 본 발명의 일 실시예에 따른 프로세서는 영상 진단의 민감도를 높이는 데 집중하는 가중손실함수 기반의 딥러닝 모델을 이용하여 영상 진단을 수행할 수 있다. 구체적으로, 1차 분류기에서는, 정상인데 비정상으로 판단할 확률 분포와 비정상인데 정상으로 판단할 확률 분 포에 대해 서로 다른 가중치를 부여한 가중손실함수를 사용하여 고막 내시경 영상을 정상 또는 비정상으로분류할 수 있다. 고막 내시경 영상이 비정상인 경우, 2차 분류기에서는 각 클래스 별 비율에 따른 차등적인 가중치를 부여한 가중손실함수를 사용하여 비정상으로 분류된 고막 내시경 영상을 만성 중이염, 급성 중이염, 삼출성 중이염, 비 정상 중이염으로 분류할 수 있다. 혹은 고막 내시경 영상이 비정상인 경우, 중이염의 임상적 특성을 잘 반 영한 이상값 탐지 모델을 이용하여 중이염 질환을 분류할 수 있다. 이상값 탐지 모델은 중이염 질환 각 각에 대한 임상적 특성을 기반으로 고막 내시경 영상을 어느 하나의 중이염 질환, 특히 급성 중이염인지 분류하 는 룰 기반(rule-based) 로직 및 오토 인코더(autoencoder)를 포함할 수 있다. 프로세서는 고막 내시경 영상의 정상 여부 및 비정상인 경우 분류된 중이염 질환을 포함하는 진단 정 보를 생성할 수 있다. 영상 진단 장치가 디스플레이를 구비하는 경우, 프로세서는 디스플레이에 진단 정보를 표시할 수 있다. 본 발명의 일 실시예에 따르면, 실제 의료 현장의 고막 내시경 영상 진단의 정확도, 정밀도, 민감도를 비약적으 로 높일 수 있다. 본 발명의 일 실시예에 따르면, 중이염 영상 진단의 에러를 최소화할 수 있는 영상 진단 장치 및 영상 진단 방 법을 제공할 수 있다. 도 6은 딥러닝 모델의 손실함수 개념도이다. 수학식 6"}
{"patent_id": "10-2023-0131189", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 7, "content": "수학식 6은 1차 분류기에서 출력된 값을 (0, 1) 사이 값으로 압축한 시그모이드(sigmoid) 함수를 나타낸다. 수학식 7"}
{"patent_id": "10-2023-0131189", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 8, "content": "수학식 7에서, 2차 분류기 CNN 클래스의 스코어를 나타내는 벡터 각각의 요소는 (0, 1) 범위가 되며, 모든 합이 1이 되도록 만들어 준다. sj는 각 스코어이고, 모든 i에 대한 소프트맥스 값을 더하면 1이 나온다. 수학식 8"}
{"patent_id": "10-2023-0131189", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 9, "content": "수학식 8의 CE(Cross Entropy)는 ti는 Ground truth(정답), si는 각 클래스 i에 대한 CNN 마지막 층의 출력인 Score 벡터의 i번째 요소이다. 1차 분류기에서 ti={0(normal), 1(abnormal)}으로 구성되고, 2차 분류기에서, ti={0(acute), 1(chronic), 2(diffusion), 3(abnormal)}로 구성된다.수학식 9"}
{"patent_id": "10-2023-0131189", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 10, "content": "수학식 9는 Cross Entropy에서 C=2일 때, 이진 분류(Binary Classification)인 1차 분류기에 쓰이게 된다. ti는 Ground truth(정답), si는 각 클래스 i에 대한 CNN 마지막 층의 출력인 Score 벡터의 i번째 요소이다. 1차 분류 기에서 ti={0(normal), 1(abnormal)}으로 구성된다. 수학식 10"}
{"patent_id": "10-2023-0131189", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 11, "content": "수학식 10에서 L(abnormal | normal)은 정상인데 비정상으로 판단할 확률 분포이며, L(normal | abnormal)은 비정상인데 정상으로 판단할 확률 분포이다. 전술한 바와 같이, 1차 분류기는 영상 진단의 특이도를 높이는 데 집중하거나 영상 진단의 정확도를 높이는 데 집중하는 가중손실함수 기반의 딥러닝 모델을 이용하여 영상 진단을 수행한다. 수학식 11"}
{"patent_id": "10-2023-0131189", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 12, "content": "수학식 12"}
{"patent_id": "10-2023-0131189", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 13, "content": "전술한 바와 같이, 영상 진단을 위한 딥러닝 모델은 1차 분류기(Binary Classification)에 이어, 2차 분류기 (Multi-Classification)로 이어지는 조건 구조를 가질 수 있으며, 1차 분류기의 높은 분류 정확도, 민감도, 정 밀도가 요구된다. 1차 분류기의 분류 정확도를 높이기 위하여, 정상인데 비정상으로 판단할 확률 분포에 부여한 제1가중치(W1)와 비정상인데 정상으로 판단할 확률 분포에 부여한 제2가중치(W2)를 산정하여 손실을 최적화하는 가중손실함수(Weight loss function)를 만들어 모델의 학습을 수행할 수 있다. 이때, 제1가중치와 제2가중치는 다양하게 설정될 수 있다. 예를 들어, 계산의 편의를 위해 제1가중치와 제2가중치는 자연수일 수 있으며, 제1가 중치는 1이고, 제2가중치는 1보다 큰 자연수일 수 있다. 도 7은 1차 분류기의 앙상블 모델의 개념도이다. CNN 기반 딥러닝 모델은 특징 추출 영역과 분류 영역에서 각 개별 레이어에 파라미터를 최적으로 학습시키는 것 을 목표로 하기에 데이터의 순서가 초기 파라미터의 값을 결정하는 중요한 요인이 될 수 있다. 이러한 특성을 반영하기 위하여, Stratified KFold의 클래스 별 비중에 따라 랜덤 샘플링(데이터 순서 랜덤)을 적용할 때, 데 이터 스플릿 하는 기준을 5로 잡아 전체 데이터를 20%씩 나누어, 8:2 비율의 학습 데이터 셋, 검증 데이터 셋으 로 구성하여 모델의 학습 및 평가를 진행하였다. 특히, 딥러닝 모델들의 특징인 비선형 알고리즘에 따라서, 딥러닝 모델은 동일하더라도 데이터의 구성, 순서, 드롭 아웃의 랜덤성에 따라 가중치를 포함한 모델의 파라미터 값들이 달라질 수 있다. 따라서, 서로 다른 모델 에 기초한 분류 결과들의 편차를 줄이고, 단독 모델의 비교적 낮은 성능과 성능의 일관성을 개선하기 위하여, 프로세서는 2 이상의 딥러닝 모델들의 분류 결과를 다수결 기반의 앙상블, 만장일치 기반의 앙상블 및 불 확실성 기반의 앙상블 중 적어도 하나를 기초로 앙상블 시킬 수 있다. 본 발명의 일 실시예에 따르면, 상기 앙상블 중 하나 또는 둘 이상을 기초로 앙상블시킨 딥러닝 모델로 최종 정 상과 비정상으로 고막 내시경 영상을 분류할 수 있다. 이를 통해, 딥러닝 모델의 분류 정확도, 정밀도, 민감도 를 대폭 개선할 수 있다. 이때 딥러닝 모델들의 적어도 일부는 동일한 하나의 딥러닝 모델을 사용하되, 상기 하나의 딥러닝 모델에 대해 학습에 사용된 학습 데이터들의 개수나 순서를 조절하여 학습할 수 있다. 딥러닝 모델의 적어도 일부는 레이어 의 뎁스 또는 레이어들의 개수가 다르거나, 컨볼루션 필터 크기, 배치 사이즈(Batch size), 학습 속도(learning rate), 학습된 가중치 등이 다를 경우, 개별 딥러닝 모델로 분류되어 앙상블 모델의 구성 모델로 활용될 수 있 다. 또한, 상기에 전술한 바와 수학식 10을 참고하여, 정상인데 비정상으로 분류한 확률 분포와 비정상인데 정상으 로 분류한 확률 분포의 차이를 손실함수에 반영하여 모델의 예측 정확도를 개선할 수 있다. 2차 분류기인 다중 클래스의 분류 모델의 경우, 1차 분류기와 같이 CNN 기반 딥러닝 모델의 성능을 높이기 위하 여 클래스 별 차등적인 가중치를 반영하여 모델을 학습할 수 있다. Stratified KFold로 나뉘어진 검증 데이터 셋의 정확도, 정밀도, 민감도를 최적화하기 위하여, 배치 사이즈(Batch size), 드롭아웃 (dropout rate), 학습 속도(learning rate), 가중치 등을 최적화할 수 있다. 이때, 파라미터들을 최적화하기 위해 Optuna 패키지를 활 용할 수 있다. 1차 분류기와 마찬가지로, 2차 분류기에서도 로지스틱 회귀(Logistic Regression)를 포함하는 앙상블 기반의 모 델을 기반으로 최종적으로 급성, 만성, 삼출성, 비정상 중이염으로 진단할 수 있다. 하지만, 고막 내시경 영상 을 어느 하나의 중이염 질환으로 분류하는 것은 앞서 설명한 2차 분류기와 같이 인공지능 모델에만 국한시킬 것 은 아니고, 중이염의 임상적 특성을 잘 반영한 특정 룰 기반(Rule-based) 로직으로도 구현될 수 있을 것이다. 예를 들어, 급성 중이염의 시각적인 특성 중 하나는, \"고막이 부풀어오르고, 고름이 나오며, 색깔은 붉은색을 띈다\"이다. 이와 같은 시각적인 특성을 파악하기 위한 수단으로, 먼저 RGB로 구성된 고막 이미지를 OpenCV를 통 해 LAB 형식으로 변환한 이후, A 채널만 추출하게 되면 해당 이미지의 녹색에서 빨간색까지의 색상만을 뽑아낼 수 있다. A 채널은 -128부터 +127까지의 범위를 가지며, 음수 값은 녹색 값을 나타내고, 양수 값은 빨간색을 나 타내며, 숫자가 커질수록 더욱 붉어지기 때문에 해당 이미지의 붉은색의 정도를 파악하기에 용이하다. 붉은색의 정도를 파악하기 위해, 여러가지 방법이 있을 수 있으나, 하나의 예를 들자면, 이미지의 A 채널을 구성하는 값 중, 양수 값들만 합산하게 되면, 각 이미지당 하나의 값 만을 갖게 되고, 전체 이미지로 이 개념을 확장할 경우, 고막 이미지 당 하나의 합산된 값을 가지게 될 것이다. 서울 성모병원에서 제공한 환자 데이터들을 기반하여, 이러한 값 분포를 통계적으로 분석하게 되면, 해당 값들 의 Q1, Q2, Q3 각 각 25%, 50%, 75% Threshold를 구할 수 있게 되고, 통계적 IQR Outlier Detection 방식을 차 용하여, 임계값 = Q3 + 1.5*IQR(Q3-Q1), 임계값을 구하게 되고, 각 이미지 별로 해당 임계값을 넘게 되는 이미 지만을 산출하게 된다면, 이는 급성 중이염의 임상적 특성을 잘 반영하는 Rule-based 로직이 될 수 있을 것이다. 물론, 급성 중이염 외 다른 중이염 질환에도 적용할 수 있다. 또한, 임계값을 산출하기 위하여 꼭 1.5*IQR(Q3-Q1)일 필요는 없고, 해당 임계값은 환자 리얼 데이터 기반으로, 급성 중이염을 잘 나타낼 수 있는 적정한 값으로 대체될 수 있다. 또한, 임계값으로만 이미지를 비교하는 것이 아니라, 붉은색의 분포의 형태 혹은 개수에 따라서도 급성 중이염 으로 이미지를 분류할 수도 있을 것이다. 예를 들어, LAB으로 변환된 이미지에서 A 채널만 추출하여, Otsu's thresholding 기법을 적용하여, 이미지를 이진화하게 된다. Otsu's thresholding 은 이미지 이진화 기법으로, 이미지의 히스토그램을 분석하여 최적의 이진화 경계값(Threshold)을 찾아내는 알고리즘이다. 계산된 경계값을 사용하여 이진화된 이미지는, 경계값보다 작은 값은 검은색으로, 경계값보다 큰 값은 흰색으로 처리하여, 흰색 으로 처리된 부분들의 패턴을 딥러닝 모델을 통해 학습을 하여, 급성 중이염만을 진단하기 위한 모델을 2차 분 류기 부분에 추가하여 적용할 수 있을 것이다. 또한, 데이터 수량이 적어 충분히 모델의 좋은 학습 결과를 예측하기 어려울 경우에는, 해당 데이터의 빈도 수 를 카운팅하여, 각 이미지마다 하나의 카운팅된 값을 매핑하게 되고, 특정 빈도 수를 넘어가는 이미지들을 급성중이염 이미지로 분류할 수 도 있을 것이다. 여기에서 Outlier detection 개념은, 통계적 모델에 국한되는 것이 아니라, 딥러닝 모델 중 오토인코더를 비롯 한 Outlier detection 모델 종류를 포괄적으로 포함한다고 볼 수 있을 것이다. 오토인코더를 활용하는 경우, 급 성 중이염을 제외한 모든 질환을 정상으로 학습하여, 모델 테스트 시 MSE (Mean Squared Error) 값이 설정된 특 정 임계값(threshold)를 넘는 경우, 급성 중이염으로 진단할 수 있다. 이 외에도, 전처리가 완료된 학습 데이터에 과도하게 학습된 딥러닝 모델의 오버피팅을 줄이는 정규화 기술로서, 드롭 아웃 기술이나 드롭 커넥티드 기술 등을 수행할 수 있다. 딥러닝 모델들의 전부 또는 일부는, 학습 데이터로 학습할 때, 각 레이어에 있는 노드를 특정 확률로 제거하여 학습시킬 수 있다. 이후, 학습이 완 료되고 테스트할 때에는 원래대로 모든 노드를 고려하고 노드마다 가지고 있는 가중치를 상기 확률을 곱한 드롭 아웃 기술을 적용할 수 있다. 마지막으로, 1차 분류기와 2차 분류기에 이은 5가지 중이염 질환 타입의 결과를 시각적으로 보여주도록 구성되 어, 의료진이나 사용자들은 내시경 영상만 있다면 시간과 장소에 얽매이지 않고, 중이염 진단 결과를 높은 정확 도 수준으로 보장받을 수 있다. 이하, 모델 학습 및 평가에 따른 실시예들을 설명한다. [실시예 1 - 1차 분류기 가중치 시뮬레이션]"}
{"patent_id": "10-2023-0131189", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 14, "content": "*0: Normal, 1: Abnormal Classification 딥러닝 모델의 가중치 변화에 따른, 모델 성능 평가(Accuracy, Precision, Recall)를 진행하였다. W2의 가중치 가 1.5 보다 높아질수록 Recall 성능은 저하되고, 해당 데이터 셋의 가장 적정한 W2 가중치 범위는 0.2~0.6, 1.0, 1.5임을 확인할 수 있다. [실시예 2 - 2차 분류기 가중치 시뮬레이션]"}
{"patent_id": "10-2023-0131189", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 15, "content": "*1: Normal, 2: Acute, 3: Chronic, 4: Diffusion, 5: Abnormal Default 값은, InceptionV3 모델 학습 시, 데이터 분포도에 따른 가중치에 따른 학습 비중을 주지 않은 것이고, Weight 값은 데이터 셋 기반 가중치에 따라 중요도를 차등적으로 부여하여 모델의 학습을 진행한 것이다. 서울 성모병원을 내원한 환자들의 RWD (Real World Data)에 따르면, 급성(Acute) 중이염으로 진단 받은 데이터가 가 장 적었고, 비정상으로 진단된 환자 비중이 가장 높았다. [실시예 3 - 가중 평균 혼동 행렬]"}
{"patent_id": "10-2023-0131189", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 16, "content": "Default 값의 Weighted Average 모델 성능은 다소 비교 우위에 있으나, 실시예 4와 같이 Default일 경우, 급성 환자를 전혀 예측하지 못하는 단점이 존재하였다. [실시예 4 - Default 혼동 행렬]"}
{"patent_id": "10-2023-0131189", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 17, "content": "*0: Normal, 1: Acute, 2: Chronic, 3: Diffusion, 4: Abnormal 각 클래스 별, 검증 셋(Validation Set)의 혼동 행렬 결과에 따르면, 정상, 만성, 비정상 중이염은 상대적으로 분류 정확도가 높으나, 급성, 삼출성 중이염의 경우, Recall (재현율)이 큰 폭으로 하락한 것을 확인할 수 있다. [실시예 5 - 최적화된 가중치 혼동 행렬]"}
{"patent_id": "10-2023-0131189", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 18, "content": "*0: Normal, 1: Acute, 2: Chronic, 3: Diffusion, 4: Abnormal 데이터 분포에 따른, 차등화된 가중치로 학습된 모델의 검증 평가는, 실시예 4보다, 급성 및 삼출성 중이염 부 분의 Recall(재현율) 값이 높으나, 전체적인 정확도가 0.48로 대폭 감소하는 것을 확인할 수 있다. [실시예 6 - 최적화된 가중치 혼동 행렬 +급성 중이염 판단 로직 추가]"}
{"patent_id": "10-2023-0131189", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 19, "content": "실시예 6의 경우, 급성 중이염 판단 로직을 추가하여 실시한 결과, 실시예 5에 비해서, 전체적인 정확도는 0.48 에서 0.77로 그 수치가 대폭 개선됨을 확인할 수 있다. 또한, 급성 중이염의 경우 재현율(Recall) 값이 0.23으 로 상승하여 실시예 4와 비교하여 급성 중이염을 탐지할 수 있게 됨을 확인할 수 있다. 도 8은 CLAHE(Contrast Limited Adaptive Histogram Equalization) 기법 적용 전 및 후의 고막 내시경 영상을 도시한 도면이다. [실시예 7 - CLAHE 기법 적용 전/후 혼동 행렬] 1.CLAHE 기법 적용 전"}
{"patent_id": "10-2023-0131189", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 20, "content": "*0: Normal, 1: Acute, 2: Chronic, 3: Diffusion, 4: Abnormal 2.CLAHE 기법 적용 후"}
{"patent_id": "10-2023-0131189", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 21, "content": "*0: Normal, 1: Acute, 2: Chronic, 3: Diffusion, 4: Abnormal CLAHE 기법을 적용한 후, 재현율(Recall) 값의 변동인데, CLAHE 기법 적용 전에는 Weighted average로 비교했 을 때는, 0.77 → 0.78로 소폭 상승했지만, Class 별 Recall 수치는 차이가 다음 표와 같이 나타나게 된다. CLAHE 기법을 적용한 후, 특이사항으로는 만성 중이염 재현율이 0.06 하락하나, 비정상 중이염의 재현율의 경우 0.04 만큼 상승하는 것을 확인할 수 있다. 물론, Weighted average로 비교할 경우, CLAHE 적용으로 재현율이 0.01 하락하였으나, 해당 기법 적용 이후, 비정상 중이염의 변별력이 높아진 것을 확인할 수 있다. 따라서, 해당 데이터셋을 CLAHE 기법을 적용한 후, 학습된 모델은 전체 정확도가 0.01이 증가하고, 비정상 중이 염의 재현율이 높은 모델로서 활용이 가능하며, 이는 사용자에 따라, 만성 중이염 오진율 보다, 비정상 중이염 오진율이 더욱 중요한 사용자에게는 유용한 모델이 될 수 있을 것으로 판단된다. [실시예 8 - 앙상블 모델 적용 전/후 혼동 행렬] 앙상블 모델을 적용하기 위해서, Stratified KFold에서 서로 다른 가중치로 학습된 모델의 앙상블 모델과 이상 치 탐지 모델의 예측 값을 합쳐서 최종 앙상블 모델의 예측을 진행하게 된다. 객관적인 예측력을 측정하고자, 학습 및 검증 데이터로는 쓰이지 않은, 최근 고막 이미지 500 건에 대하여 테스트를 진행하였다. 1. 앙상블 모델 적용 전 (Test Set, N=500)"}
{"patent_id": "10-2023-0131189", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 22, "content": "2. 앙상블 모델 적용 후 (Test Set, N=500)"}
{"patent_id": "10-2023-0131189", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 23, "content": "3. 앙상블 모델 적용 전/후 차이 단일 모델에서 가장 우수한 모델의 유효성 평가 결과 보다, 앙상블 모델의 유효성 평가 (혼동 행렬) 값이 전체 적으로 다소 감소함을 확인하였고, Recall 값의 경우 다소 큰 폭으로 하락한 것을 확인할 수 있다. 다만, 중이 염 질환 타입 별로 Recall 값을 아래와 같이 비교한 표에서는, 앙상블 모델의 급성 중이염 Recall 수치가 현저 히 증가함을 확인할 수 있다."}
{"patent_id": "10-2023-0131189", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 24, "content": "아쉽게도 테스트 데이터에 포함된 급성 중이염 개수가 5개 밖에 되지 않아, 가중 평균으로 모델 유효성 검사를 했을 경우, 전체적인 성능은 다소 저하되나, 무엇보다 이 때까지 아예 검출하지 못한 급성 중이염을 검출했다는 점이, Recall 값을 올려 기존의 모델이 진단하지 못한 점을 대폭 개선한 부분이 특허 개발 필요성을 충족하는 결과로 판단된다. [이 발명을 지원한 연구개발사업] [과제명] CMC CDW 고막 이미지 데이터를 활용한 인공지능 기반 스마트 귀 질환 진단시스템 개발 [연구지원기관] 서울성모병원 [연구지원사업] 2022년도 서울성모병원 R&D성과창출 촉진사업 [주관기관] 서울성모병원 [참여기관] (주)디지털팜 [과제기간] 2022.09.01 ~ 2023.08.31"}
{"patent_id": "10-2023-0131189", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 일 실시예에 따른 영상 진단 장치의 동작 모습을 도시한 개략도이다. 도 2는 본 발명의 일 실시예에 따른 영상 진단 장치의 구성을 도시한 블럭도이다. 도 3은 본 발명의 일 실시예에 따른 영상 진단 장치의 동작 흐름도를 도시한 도면이다. 도 4는 본 발명의 일 실시예에 딥러닝 기반 분류된 중이염 질환을 도시한 도면이다. 도 5는 본 발명의 일 실시예에 따른 영상 진단 장치의 동작 모습을 도시한 도면이다. 도 6은 CNN 분류 모델의 손실함수 개념도이다. 도 7은 CNN 1차 분류기 앙상블 모델의 개념도이다. 도 8은 CLAHE(Contrast Limited Adaptive Histogram Equalization) 기법 적용 전 및 후의 고막 내시경 영상을 도시한 도면이다. 도 9는 허프 그래디언트 방법을 이용하여 중이를 포함하도록 내시경 영상을 조정하는 과정을 도시한 도면이다. 도 10은 앙상블 모델과 이상값 탐지 모델을 통해 예측하는 구조를 도시한 도면이다."}
