{"patent_id": "10-2021-0071114", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2022-0162546", "출원번호": "10-2021-0071114", "발명의 명칭": "신경망 기반의 이미지 압축 방법 및 시스템", "출원인": "성균관대학교산학협력단", "발명자": "류은석"}}
{"patent_id": "10-2021-0071114", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "이미지 압축 모델을 기반으로 입력 이미지를 부호화하여 압축 이미지를 생성하는 단계;상기 이미지 압축 모델을 기반으로 상기 압축 이미지를 복호화하여 복원 이미지를 생성하는 단계;상기 입력 이미지의 주파수 도메인과 상기 복원 이미지 간의 주파수 도메인 간의 편차에 기반하여 오차를 산출하는 단계; 및상기 오차에 기초하여 상기 이미지 압축 모델의 가중치를 업데이트하는 단계를 포함하는 신경망 기반의 이미지압축 방법."}
{"patent_id": "10-2021-0071114", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제 1 항에 있어서,상기 오차를 산출하는 단계는상기 입력 이미지를 이산코사인 변환하여 제1 계수를 생성하고, 상기 복원 이미지를 이산코사인 변환하여 제2계수를 생성하는 단계; 및상기 제1 계수 및 상기 제2 계수 간의 편차에 기반하여 상기 오차를 산출하는 단계를 포함하는 것을 특징으로하는 신경망 기반의 이미지 압축 방법."}
{"patent_id": "10-2021-0071114", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제 2 항에 있어서,상기 가중치는 최종 손실함수를 바탕으로 결정되고,상기 최종 손실함수는 상기 오차의 평균 제곱 오차에 비례하는 것을 특징으로 하는 신경망 기반의 이미지 압축방법."}
{"patent_id": "10-2021-0071114", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제 3 항에 있어서,상기 최종 손실함수는 상기 입력 이미지와 상기 복원 이미지 간의 픽셀 데이터의 평균 제곱 오차에 비례하는 제1 손실함수 및 상기 제1 계수 및 상기 제2 계수 간의 평균 제곱 오차에 비례하는 제2 손실함수의 합으로 결정되는 것을 특징으로 하는신경망 기반의 이미지 압축 방법."}
{"patent_id": "10-2021-0071114", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제 1 항에 있어서,상기 가중치는 손실 함수를 바탕으로 결정되고,상기 손실함수는 상기 오차의 최대 신호 대 잡음비에 기초하여 생성되는 것을 특징으로 하는 신경망 기반의 이미지 압축 방법."}
{"patent_id": "10-2021-0071114", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "이미지 압축 모델을 기반으로 입력 이미지를 부호화하여 압축 이미지를 생성하고, 상기 이미지 압축 모델을 기반으로 상기 압축 이미지를 복호화하여 복원 이미지를 생성하는 이미지 변환부;상기 입력 이미지의 주파수 도메인과 상기 복원 이미지 간의 주파수 도메인 간의 편차에 기반하여 오차를 산출공개특허 10-2022-0162546-3-하는 계산부; 및상기 오차에 기초하여 상기 이미지 압축 모델의 가중치를 업데이트하는 결정부;를 포함하는 신경망 기반의 이미지 압축 시스템."}
{"patent_id": "10-2021-0071114", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제 6 항에 있어서,상기 계산부는상기 입력 이미지를 이산코사인 변환하여 제1 계수를 생성하고, 상기 복원 이미지를 이산코사인 변환하여 제2계수를 생성하며, 상기 제1 계수 및 상기 제2 계수 간의 편차에 기반하여 상기 오차를 산출하는 것을 특징으로하는 신경망 기반의 이미지 압축 시스템."}
{"patent_id": "10-2021-0071114", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제 7 항에 있어서,상기 가중치는 최종 손실함수를 바탕으로 결정되고, 상기 최종 손실함수는 상기 오차의 평균 제곱 오차에 비례하는 것을 특징으로 하는 신경망 기반이 이미지 압축시스템."}
{"patent_id": "10-2021-0071114", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명에 의한 신경망 기반의 이미지 압축 방법은 이미지 압축 모델을 기반으로 입력 이미지를 부호화하여 압축 이미지를 생성하는 단계, 이미지 압축 모델을 기반으로 압축 이미지를 복호화하여 복원 이미지를 생성하는 단계, 입력 이미지의 주파수 도메인과 복원 이미지 간의 주파수 도메인 간의 편차에 기반하여 오차를 산출하는 단계, 및 오차에 기초하여 이미지 압축 모델의 가중치를 업데이트하는 단계를 포함한다."}
{"patent_id": "10-2021-0071114", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 신경망 기반의 이미지 압축 방법 및 시스템에 관한 것으로 이미지 압축 과정에서 화질을 개선할 수 있는 이미지 압축 방법 및 시스템에 관한 것이다."}
{"patent_id": "10-2021-0071114", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "인공지능의 발달과 더불어, 인공지능은 이미지를 분류하고 판단하는 작업을 수행하는 빈도가 높아지고 있다. 인공지능 시스템은 이미지를 학습하기 위해서 JPEG(Joint Photographic Experts Group)과 같이 압축된 이미지 데이터를 제공받는 것이 일반적이다. 인공지능과 사물인터넷(Internet of Things; IoT) 기기에서의 딥러닝 정확도와 추론 속도 향상을 위하여 종래의 JPEG 압축 방식보다 효율적인 입력 데이터의 압축 및 처리가 요구된다."}
{"patent_id": "10-2021-0071114", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은 이미지 압축 효율 및 정확도를 높일 수 있는 신경망 기반의 이미지 압축 방법 및 시스템을 제공하기 위한 것이다."}
{"patent_id": "10-2021-0071114", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명에 의한 신경망 기반의 이미지 압축 방법은 이미지 압축 모델을 기반으로 입력 이미지를 부호화하여 압 축 이미지를 생성하는 단계, 이미지 압축 모델을 기반으로 압축 이미지를 복호화하여 복원 이미지를 생성하는 단계, 입력 이미지의 주파수 도메인과 복원 이미지 간의 주파수 도메인 간의 편차에 기반하여 오차를 산출하는 단계, 및 오차에 기초하여 이미지 압축 모델의 가중치를 업데이트하는 단계를 포함한다."}
{"patent_id": "10-2021-0071114", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명은 입력 이미지와 복원 이미지 간의 픽셀 오차와 더불어 입력 이미지의 주파수 도메인과 복원 이미지의 주파수 도메인의 편차에 기초한 오차값을 반영하여 이미지 압축 모델의 가중치를 설정하기 때문에 보다 정확한 이미지 압축 모델 및 시스템을 구현할 수 있다."}
{"patent_id": "10-2021-0071114", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "본 명세서의 이점 및 특징, 그리고 그것들을 달성하는 방법은 첨부되는 도면과 함께 상세하게 후술되어 있는 실 시예들을 참조하면 명확해질 것이다. 그러나 본 명세서는 이하에서 개시되는 실시예들에 한정되는 것이 아니라 서로 다른 다양한 형태로 구현될 것이며, 단지 본 실시예들은 본 명세서의 개시가 완전하도록 하며, 본 명세서 가 속하는 기술 분야에서 통상의 지식을 가진 자에게 발명의 범주를 완전하게 알려주기 위해 제공되는 것이며, 본 명세서는 청구항의 범주에 의해 정의될 뿐이다. 본 명세서의 여러 실시예들의 각각 특징들이 부분적으로 또는 전체적으로 서로 결합 또는 조합 가능하고, 기술 적으로 다양한 연동 및 구동이 가능하며, 각 실시예들이 서로에 대하여 독립적으로 실시 가능할 수도 있고 연관 관계로 함께 실시할 수도 있다. 도 1은 본 발명의 실시 예에 의한 신경망 기반의 이미지 압축 시스템을 나타내는 도면이다. 도 1을 참조하면, 본 발명의 실시 예에 의한 신경망 기반이 이미지 압축 시스템은 이미지 변환부, 계산부 및 결정부를 포함한다. 이미지 변환부는 이미지 압축 모델을 기반으로 입력 이미지를 부호화하여 압축 이미지를 생성하고, 이미지 압축 모델을 기반으로 압축 이미지를 복호화하여 복원 이미지를 생성한다. 계산부는 입력 이미지의 주파수 도메인과 복원 이미지 간의 주파수 도메인 간의 편차에 기반하여 오차를 산출한다. 결정부는 오차에 기초하여 이미지 압축 모델의 가중치를 업데이트한다. 도 2는 본 발명의 실시 예에 의한 신경망 기반의 이미지 압축 방법을 나타내는 순서도이다. 도 1 및 도 2를 참조하여 본 발명의 실시 예에 의한 신경망 기반의 이미지 압축 방법을 살펴보면 다음과 같다. 제1 단계(S200) 및 제2 단계(S210)에서, 이미지 변환부는 이미지 압축 모델을 기반으로 입력 이미지를 부 호화하여 압축 이미지를 생성한다. 이미지 압축 모델은 도 3에 도시된 바와 같이, 컨볼루션 신경 네트워크(Convolutional Neural Network; 이하, CNN) 기반으로 구현될 수 있다. 도 3을 참조하면, 입력 이미지는 (M×N×d)의 벡터로 표현될 수 있다. 이때, M은 입력 이미지의 높이에 해당하 고, N은 폭에 해당하며, d는 뎁스(depth)를 지칭한다. 뎁스는 하나의 픽셀을 구성하는 서브픽셀일 수 있으며, 예를 들어 삼원색에 해당하는 R,G,B 각각의 채널을 지칭하는 \"3\"이 될 수 있다. CNN은 컨볼루션 레이어(Convolution), 정류화 선형 유닛(Rectified Linear Unit; 이하, ReLU) 및 풀링 레이어 (Pooling)가 반복되는 다층 구조로 구현될 수 있다. 컨볼루션 레이어는 이미지의 특성(feature)을 추출하는 하나 이상의 필터로 구성된다. 필터는 커널로 지칭된다. 각각의 필터들은 입력 이미지에 대한 합성곱 연산을 수행한다. 필터의 개수에 비례하여 출력의 채 널 수는 증가하고, 필터의 크기와 이동 간격에 따라 컨볼루션 레이어의 출력은 입력보다 크기가 작아진다. 컨볼루션 레이어는 특성맵을 출력하고, 특성맵의 각 채널은 각각의 필터들이 찾는 특성을 얼마나 보유하는지에 대한 정보를 포함한다. 정류화 선형 유닛(Rectified Linear Unit; 이하, ReLU)은 활성화 함수의 한 종류로써, 네트워크에 비선형성을 추가하여 비선형 문제를 해결한다. ReLU는 음수 값을 0에 매핑하고 양수 값을 유지하여 더 빠르고 효과적인 학 습을 가능하도록 하며, 이때 활성화된 특징만을 다음 계층으로 전달한다. ReLU는 동시에 모든 뉴런을 활성화하 지 않기 때문에 시간당 활성화되는 뉴런이 적어서 활성화 기능에 효율적이다. 풀링 레이어는 비선형 다운 샘플링을 수행하고 네트워크에서 학습해야 하는 매개변수의 개수를 줄여서 출력을 간소화한다. 풀링 레이어는 연산의 종류에 따라 맥스 풀링과 평균 풀링 방식으로 구분될 수 있다. 완전연결계층(Fully connected layer)는 이미지 분류를 수행한다. 완전연결계층의 입력으로 사용되기 위해서 특성맵은 1차원으로 변환된다. 완전연결계층은 학습된 가중치 파라미터를 사용하여 입력 이미지가 속하는 클래 스(class)를 분류한다. 제3 단계(S220)에서, 이미지 변환부는 이미지 압축 모델을 기반으로 압축 이미지를 복호화하여 복원 이미 지를 생성한다. 제4 단계(S230)에서, 계산부는 입력 이미지의 제1 주파수 도메인과 복원 이미지의 제2 주파수 도메인 간의 편차에 기반하여 오차를 산출한다. 제1 주파수 도메인과 제2 주파수 도메인 간의 편차는 이산코사인 변환(discrete cosine transform; 이하, DC T)을 기반으로 산출될 수 있다. 즉, 계산부는 입력 이미지를 이산코사인 변환하여 제1 계수를 생성하고, 복원 이미지를 이산코사인 변환하여 제2 계수를 생성한다. 이산코사인 변환은 다음의 [수학식 1]을 바탕으로 산출될 수 있다. [수학식 1]"}
{"patent_id": "10-2021-0071114", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "그리고, 계산부는 제1 계수 및 상기 제2 계수 간의 편차에 기반하여 오차를 산출할 수 있다. 오차는 최종 손실함수를 결정하는 파라미터에 해당하며, 최종 손실함수는 이미지 압축 모델의 가중치를 결정하 는 기준이 된다. 최종 손실함수(Ltotal)는 다음의 [수학식 2]를 바탕으로 산출될 수 있다. [수학식 2]"}
{"patent_id": "10-2021-0071114", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "이때, L은 제1 손실함수이며, LDCT는 제2 손실함수이다. 는 최종 손실함수의 조절 파라미터이며, 제1 계수 및 제2 계수 간의 편차를 반영하는 정도에 따라서 미리 결정될 수 있다. 제1 손실함수(L)는 다음의 [수학식 3]을 바탕으로 산출될 수 있다. [수학식 3]"}
{"patent_id": "10-2021-0071114", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "이때, \" \"는 손실함수 조절 파라미터에 해당하고, \"D\"는 픽셀 오차에 해당한다. \"R\"은 부호화된 비트스트림의 엔트로피를 나타낸다. 픽셀 오차(D)는 입력 이미지의 픽셀 데이터와 복원 이미지의 픽셀 데이터 간의 평균 제 곱 오차를 의미한다. 픽셀 오차(D)는 최대 신호 대 잡음비(peak signal-to-noise ratio; 이하, PSNR)로 산출될 수도 있다. PSNR 은 신호가 가질 수 있는 최대 전력에 대한 잡음의 전력을 나타내며, 다음의 [수학식 4]와 같이 산출된다. [수학식 4]"}
{"patent_id": "10-2021-0071114", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 5, "content": "제2 손실함수(LDCT)는 다음의 [수학식 5]와 같이 평균 제곱 오차(Mean Square Error; MSE)를 바탕으로 산출될 수 있다. [수학식 5]"}
{"patent_id": "10-2021-0071114", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 6, "content": "이때, 는 제1 계수를 지칭하고, 는 제2 계수를 지칭한다. 제5 단계(S250)에서, 결정부는 이와 같이 생성된 최종 손실함수(Ltotal)에 기초하여, 이미지 압축 모델의 가중치(w)를 결정한다. 결정부는 최종 손실함수(Ltotal)의 손실 값이 줄어들도록 가중치(w)를 업데이트할 수 있다. 결정부는 가중치(w)를 업데이트하는 과정에서, 주파수 도메인 변화인 DCT의 계수를 고려하여 가중치를 업 데이트할 수 있다. 아래의 [수학식 6], [수학식 7] 및 [수학식 8]은 가중치를 업데이트하기위한 선형 결합의 실시 예를 나타내는 수학식들이다. [수학식 6]"}
{"patent_id": "10-2021-0071114", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 7, "content": "[수학식 7] [수학식 8]"}
{"patent_id": "10-2021-0071114", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 8, "content": "[수학식 6], [수학식 7] 및 [수학식 8]은 w 행렬과 b 행렬이 학습되어 업데이트 되는 것을 나타내며, x는 입력 값을 지칭한다. 가중치들(w,b)은 행렬 형태로 학습시에 서버에 저장되어, 복호화 또는 추론 과정이 필요할 경 우 다른 클라이언트에 공유될 수 있다. 본 명세서에 의한 실시 예에서, 이미지 압축 모델의 가중치는 입력 이미지와 복원 이미지 간의 픽셀 오차와 더 불어, 입력 이미지의 주파수 도메인과 복원 이미지의 주파수 도메인의 편차에 기초한 오차값을 반영하여 설정되 기 때문에, 이미지 압축 모델은 보다 정확하게 구현될 수 있다. 도 4는 본 명세서의 실시 예에 의한 이미지 압축 시스템을 사용하여 이미지를 압축한 시뮬레이션 결과를 나타내 는 도면이다. 도 4에서 제1 그래프(g1)는 본 발명의 실시 예에 의한 압축 이미지의 PSNR을 나타내고, 제2 그래 프(g2)는 종래의 이미지 압축 시스템에 의한 압축 이미지의 PSNR을 나타내는 도면이다. 도 4에서 알 수 있는 바와 같이, 동일한 크기의 이미지에서 본 발명의 실시 예를 바탕으로 생성된 압축 이미지 의 PSNR이 높은 것을 알 수 있으며, 이는 본 발명의 실시 예를 바탕으로 코딩 된 이미지의 화질이 개선되었음을 보여준다. 아래의 [수학식 9]는 본 발명의 다른 실시 예에 의한 DCT 변환(이하 제2 DCT)을 나타내는 수학식이다. [수학식 9]"}
{"patent_id": "10-2021-0071114", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 9, "content": "아래의 [표 1]은 제2 DCT에 의한 성능개선을 나타내는 표이다. [표 1]"}
{"patent_id": "10-2021-0071114", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 10, "content": "[표 1]에서, Lambda는 사용자가 임의로 정할 수 있는 컨트롤 파라미터를 나타낸다. [수학식 3]에 따라서 Lambda 값이 클수록 더 높은 복원화질을 가지지만, 더 큰 비트레이트(파일크기)를 필요로 하는 비트스트림을 생성한다. 여러 Lambda 파라미터로 학습된 모델을 다수 보유한 상태에서 네트워크 환경에 따라 대역폭이 제한된 모바일 환 경 또는 안정적인 데스크탑 환경 등에 따라 선택적으로 보내는 방식으로 응용될 수 있다. w/o DCT loss는 DCT loss를 사용하지 않고, 기존의 딥 러닝 기반 이미지 압축 방법을 사용하였을 때의 결과를 나타낸다. PSNR, bpp는 딥 러닝 모델이 복원한 이미지와 원본 이미지의 비교 화질(PSNR)과, 딥 러닝 모델이 이미지를 압축 하여 생성한 비트스트림의 크기를 나타낸다(bits per pixel). 따라서 bpp가 낮으면서 PSNR이 높은 모델은 압축 성능이 더 높다는 것을 의미한다. 또한, 본 발명의 실시 예는 주파수 도메인 변환을 위한 방법으로 DCT 이외에도 웨이블릿 변환(Wavelet Transform)을 이용할 수도 있다. 웨이블릿 변환은 다수의 단계로 이루어질 수 있으며, 실시 예에서는 3단계까지 의 변환을 수행하고 각 단계별 주파수 도메인 변환 값에 대한 MSE의 가중치 합을 손실 함수로 추가하였다. 아래의 [수학식 10]은 본 발명의 다른 실시 예에 의한 웨이블릿 변환을 나타내는 수학식이다. [수학식 10]"}
{"patent_id": "10-2021-0071114", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 11, "content": "i는 웨이블릿 변환의 단계를 나타내며, 는 각 단계별 가중치를 의미한다. 또한 는 원본 이미지에서 웨이블 릿 변환을 거친 주파수 도메인의 계수(coefficient) 값을 나타내며, 는 복원된 이미지에서 웨이블릿 변환을 거친 주파수 도메인의 계수 값을 나타낸다. 아래의 [표 2]는 웨이블릿 변환에 기초하여 주파수 도메인 변환을 수행하고, 가중치를 업데이트 한 것에 기초하 여 이미지 압축 모델의 성능 개선을 나타내는 표이다. [표 2]"}
{"patent_id": "10-2021-0071114", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 12, "content": "이상 설명한 내용을 통해 당업자라면 본 명세서의 기술사상을 일탈하지 아니하는 범위에서 다양한 변경 및 수정 이 가능함을 알 수 있을 것이다. 따라서, 본 명세서의 기술적 범위는 명세서의 상세한 설명에 기재된 내용으로 한정되는 것이 아니라 특허 청구의 범위에 의해 정하여져야만 할 것이다."}
{"patent_id": "10-2021-0071114", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 실시 예에 의한 신경망 기반의 이미지 압축 시스템을 나타내는 도면이다. 도 2는 본 발명의 실시 예에 의한 신경망 기반의 이미지 압축 방법을 나타내는 순서도이다. 도 3은 이미지 압축 모델의 실시 예를 나타내는 도면이다. 도 4는 본 명세서의 실시 예에 의한 이미지 압축 시스템을 사용하여 이미지를 압축한 시뮬레이션 결과를 나타내 는 도면이다."}
