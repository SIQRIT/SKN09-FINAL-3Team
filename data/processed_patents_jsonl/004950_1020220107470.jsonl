{"patent_id": "10-2022-0107470", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2024-0029247", "출원번호": "10-2022-0107470", "발명의 명칭": "인공지능을 사용한 연합학습 방법", "출원인": "성균관대학교산학협력단", "발명자": "이지형"}}
{"patent_id": "10-2022-0107470", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "로컬 클라이언트가 수행하는 인공지능을 사용한 연합학습 방법에 있어서,중앙 서버로부터 모델을 수신하여 글로벌 모델 및 로컬 모델로 저장하는 단계;상기 글로벌 모델을 기반으로 내부 데이터를 사용하여 상기 로컬 모델을 학습하는 단계; 및상기 학습된 로컬 모델을 상기 중앙 서버로 송신하는 단계;를 포함하고,상기 로컬 모델을 학습하는 단계는,상기 내부 데이터의 한 배치(batch)마다 상기 글로벌 모델 및 상기 로컬 모델의 특성(feature)들을 사용하여 판별자 모델 및 분류기를 학습하여 상기 로컬 모델의 학습을 통해, 상기 로컬 모델의 특성들이 상기 판별자 모델로 판별되지 못하도록 상기 로컬 모델의 특성들이 생성되고, 분류기는 정답을 분류하도록 동작하는 것을 특징으로 하는 연합학습 방법."}
{"patent_id": "10-2022-0107470", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 분류기 학습에는 하기의 식의 손실함수()가 사용되는 것을 특징으로 하는 연합학습 방법.(여기서, : y번째 차원 벡터, : j번째 차원 벡터, j: 클래스 수임.)"}
{"patent_id": "10-2022-0107470", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제2항에 있어서,상기 판별자 모델 학습에는 하기의 식의 손실함수()가 사용되는 것을 특징으로 하는 연합학습 방법.(여기서, : 글로벌 모델 특성 벡터, : 로컬 모델 특성 벡터, : 특성 벡터를 판별한 예측값, n:데이터 포인트 개수임.)"}
{"patent_id": "10-2022-0107470", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제3항에 있어서,전체 손실함수는 상기 분류기 학습에 사용되는 손실함수와 상기 판별자 모델 학습에 사용되는 손실함수의 합으로 산출되고,상기 산출된 전체 손실함수가 감소하도록 상기 로컬 모델의 학습이 수행되는 것을 특징으로 하는 연합학습방법."}
{"patent_id": "10-2022-0107470", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "공개특허 10-2024-0029247-3-제1항에 있어서,상기 학습된 로컬 모델을 상기 중앙 서버로 송신하는 단계 이후, 상기 중앙 서버로부터 새로운 모델을 수신하여상기 모델 저장 단계, 상기 로컬 모델 학습 단계 및 상기 중앙 서버로의 송신 단계를 반복해 수행하되,상기 새로운 모델은 상기 중앙 서버에서 상기 로컬 클라이언트의 상기 학습된 로컬 모델 및 다른 로컬 클라이언트들의 학습된 로컬 모델들을 평균 내어 새롭게 생성된 모델인 것을 특징으로 하는 연합학습 방법."}
{"patent_id": "10-2022-0107470", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제1항에 있어서,상기 로컬 클라이언트는 비독립 동일 분포(Non-Independent Identically Distributed) 분산 환경 하에서 동작하는 것을 특징으로 하는 연합학습 방법."}
{"patent_id": "10-2022-0107470", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "중앙 서버가 수행하는 인공지능을 사용한 연합학습 방법에 있어서,로컬 클라이언트로 모델을 송신하는 단계;상기 로컬 클라이언트에서 학습된 로컬 모델을 수신하는 단계; 및상기 로컬 클라이언트의 상기 학습된 로컬 모델을 기반으로 새로운 모델을 생성하는 단계;를 포함하고,상기 학습된 로컬 모델은,상기 로컬 클라이언트가 수신한 상기 모델을 글로벌 모델 및 로컬 모델로 저장하고, 상기 글로벌 모델을 기반으로 상기 로컬 클라이언트의 내부 데이터를 사용하여 상기 로컬 모델을 학습함으로써 생성된 것이며,상기 로컬 모델의 학습은,상기 내부 데이터의 한 배치(batch)마다 상기 글로벌 모델 및 상기 로컬 모델의 특성(feature)들을 사용하여 판별자 모델 및 분류기를 학습하여 상기 로컬 모델의 학습을 통해, 상기 로컬 모델의 특성들이 상기 판별자 모델로 판별되지 못하도록 상기 로컬 모델의 특성들이 생성되고, 분류기는 정답을 분류하도록 동작하는 것을 특징으로 하는 연합학습 방법."}
{"patent_id": "10-2022-0107470", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제7항에 있어서,상기 분류기 학습에는 하기의 식의 손실함수()가 사용되는 것을 특징으로 하는 연합학습 방법.(여기서, : y번째 차원 벡터, : j번째 차원 벡터, j: 클래스 수임.)"}
{"patent_id": "10-2022-0107470", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제8항에 있어서,상기 판별자 모델 학습에는 하기의 식의 손실함수()가 사용되는 것을 특징으로 하는 연합학습 방법.(여기서, : 글로벌 모델 특성 벡터, : 로컬 모델 특성 벡터, : 특성 벡터를 판별한 예측값, n:공개특허 10-2024-0029247-4-데이터 포인트 개수임.)"}
{"patent_id": "10-2022-0107470", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제9항에 있어서,전체 손실함수는 상기 분류기 학습에 사용되는 손실함수와 상기 판별자 모델 학습에 사용되는 손실함수의 합으로 산출되고,상기 산출된 전체 손실함수가 감소하도록 상기 로컬 모델의 학습이 수행되는 것을 특징으로 하는 연합학습방법."}
{"patent_id": "10-2022-0107470", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "제7항에 있어서,상기 새로운 모델을 생성하는 단계 이후, 상기 새로운 모델을 상기 로컬 클라이언트로 송신하여 상기 모델 송신단계, 상기 학습된 로컬 모델 수신 단계 및 상기 새로운 모델 생성 단계를 반복해 수행하되,상기 새로운 모델은 상기 중앙 서버에서 상기 로컬 클라이언트의 상기 학습된 로컬 모델 및 다른 로컬 클라이언트들의 학습된 로컬 모델들을 평균 내어 새롭게 생성된 모델인 것을 특징으로 하는 연합학습 방법."}
{"patent_id": "10-2022-0107470", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제7항에 있어서,상기 로컬 클라이언트는 비독립 동일 분포(Non-Independent Identically Distributed) 분산 환경 하에서 동작하는 것을 특징으로 하는 연합학습 방법."}
{"patent_id": "10-2022-0107470", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명의 일 실시 예에 따른 로컬 클라이언트가 수행하는 인공지능을 사용한 연합학습 방법은, 중앙 서버로부터 모델을 수신하여 글로벌 모델 및 로컬 모델로 저장하는 단계; 상기 글로벌 모델을 기반으로 내부 데이터를 사용 하여 상기 로컬 모델을 학습하는 단계; 및 상기 학습된 로컬 모델을 상기 중앙 서버로 송신하는 단계;를 포함하 고, 상기 로컬 모델을 학습하는 단계는, 상기 내부 데이터의 한 배치(batch)마다 상기 글로벌 모델 및 상기 로컬 모델의 특성(feature)들을 사용하여 판별자 모델 및 분류기를 학습하여 상기 로컬 모델의 학습을 통해, 상기 로 컬 모델의 특성들이 상기 판별자 모델로 판별되지 못하도록 상기 로컬 모델의 특성들이 생성되고, 분류기는 정답 을 분류하도록 동작하는 것을 특징으로 한다. 이에 따라, 연합학습에서의 글로벌 모델의 발산을 억제할 수 있다."}
{"patent_id": "10-2022-0107470", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 인공지능을 사용한 연합학습 방법에 관한 것으로서, 보다 구체적으로는 로컬 모델의 특성을 글로벌 모델의 특성과 구분되지 않도록 로컬 모델을 학습시켜 연합학습에서의 글로벌 모델의 발산을 억제하는 인공지능 을 사용한 연합학습 방법에 관한 것이다."}
{"patent_id": "10-2022-0107470", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "연합학습은 분산 환경이 발달하고, 데이터 프라이버시의 중요성이 강조되면서 중앙 서버에 있는 데이터를 활용 하여 학습하는 기존의 인공지능 모델과 달리, 중앙 서버가 각 클라이언트에 대한 직접적인 데이터 접근 없이 각 클라이언트에서 학습한 모델의 파라미터를 사용하여 글로벌 모델을 생성하는 방식이다. 분산 환경의 발달로 다양한 기기에서의 데이터 사용이 가능해졌으며, 이러한 다양한 데이터의 사용은 종래의 중 앙화된 데이터와는 다르게 비독립적 동일 분포(Non-IID, Not Independent and Identically Distributed)인 경 우가 많다. 이와 같은 데이터의 분포는 로컬 클라이언트에서의 학습에 있어서는 영향이 적으나 중앙 서버에서의 글로벌 모델 생성 시 상당한 영향을 미쳐 성능 하락의 원인이 된다. 결국 연합학습에서는 데이터의 분산으로 인 해 데이터 분포가 각 클라이언트 별로 이질성을 띄게 되는 점을 해결해야 한다. 인공지능을 사용한 연합학습에 있어서, 로컬 클라이언트들의 비독립적 동일 분포(Non-IID) 데이터들로 인해 학 습 과정에서 글로벌 모델과 로컬 모델의 격차가 커지게 되어 중앙 서버의 글로벌 모델이 발산하게 되는 바, 이 를 억제할 수 있는 방안이 요구된다."}
{"patent_id": "10-2022-0107470", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은 상술한 바와 같은 종래 기술의 문제점을 해결하기 위한 것으로서, 적대적 학습에서 사용되는 판별자 손실 함수를 사용하여 로컬 모델의 특성을 글로벌 모델의 특성과 구분되지 않도록 로컬 모델을 학습시킴으로써 연합학습에서의 글로벌 모델의 발산을 억제하는 인공지능을 사용한 연합학습 방법을 제공하는 것이다."}
{"patent_id": "10-2022-0107470", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명의 제1 특징에 따른 로컬 클라이언트가 수행하는 인공지능을 사용한 연합학습 방법은, 중앙 서버로부터 모델을 수신하여 글로벌 모델 및 로컬 모델로 저장하는 단계; 상기 글로벌 모델을 기반으로 내부 데이터를 사용 하여 상기 로컬 모델을 학습하는 단계; 및 상기 학습된 로컬 모델을 상기 중앙 서버로 송신하는 단계;를 포함하 고, 상기 로컬 모델을 학습하는 단계는, 상기 내부 데이터의 한 배치(batch)마다 상기 글로벌 모델 및 상기 로 컬 모델의 특성(feature)들을 사용하여 판별자 모델 및 분류기를 학습하여 상기 로컬 모델의 학습을 통해, 상기 로컬 모델의 특성들이 상기 판별자 모델로 판별되지 못하도록 상기 로컬 모델의 특성들이 생성되고, 분류기는 정답을 분류하도록 동작하는 것을 특징으로 한다. 본 발명의 제2 특징에 따른 중앙 서버가 수행하는 인공지능을 사용한 연합학습 방법은, 로컬 클라이언트로 모델 을 송신하는 단계; 상기 로컬 클라이언트에서 학습된 로컬 모델을 수신하는 단계; 및 상기 로컬 클라이언트의 상기 학습된 로컬 모델을 기반으로 새로운 모델을 생성하는 단계;를 포함하고, 상기 학습된 로컬 모델은, 상기 로컬 클라이언트가 수신한 상기 모델을 글로벌 모델 및 로컬 모델로 저장하고, 상기 글로벌 모델을 기반으로 상 기 로컬 클라이언트의 내부 데이터를 사용하여 상기 로컬 모델을 학습함으로써 생성된 것이며, 상기 로컬 모델 의 학습은, 상기 내부 데이터의 한 배치(batch)마다 상기 글로벌 모델 및 상기 로컬 모델의 특성(feature)들을 사용하여 판별자 모델 및 분류기를 학습하여 상기 로컬 모델의 학습을 통해, 상기 로컬 모델의 특성들이 상기 판별자 모델로 판별되지 못하도록 상기 로컬 모델의 특성들이 생성되고, 분류기는 정답을 분류하도록 동작하는 것을 특징으로 한다."}
{"patent_id": "10-2022-0107470", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명의 실시 예에 따른 인공지능을 사용한 연합학습 방법은 다음과 같은 효과를 제공한다. 적대적 학습에서 사용되는 판별자 손실 함수를 사용하여 로컬 모델의 특성을 글로벌 모델의 특성과 구분되지 않 도록 로컬 모델을 학습시킴으로써 연합학습에서의 글로벌 모델의 발산을 억제할 수 있다."}
{"patent_id": "10-2022-0107470", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하, 본 발명에 대해서 실시예 및 도면을 참조하여 구체적으로 설명한다. 그러나, 이하의 설명은 본 발명을 특 정한 실시 형태에 대해 한정하려는 것이 아니며, 본 발명을 설명함에 있어서 관련된 공지 기술에 대한 구체적인 설명이 본 발명의 요지를 흐릴 수 있다고 판단되는 경우 그 상세한 설명을 생략한다. 다르게 정의되지 않는 한, 기술적이거나 과학적인 용어를 포함해서 여기서 사용되는 모든 용어들은 본 발명이 속하는 기술 분야에서 통상의 지식을 가진 자에 의해 일반적으로 이해되는 것과 동일한 의미를 가지고 있다. 일 반적으로 사용되는 사전에 정의되어 있는 것과 같은 용어들은 관련 기술의 문맥 상 가지는 의미와 일치하는 의 미를 가지는 것으로 해석되어야 하며, 본 출원에서 명백하게 정의하지 않는 한, 이상적이거나 과도하게 형식적 인 의미로 해석되지 않는다. 연합학습(Federated Learning)은 인공지능 모델 학습 방법으로서, 중앙 서버에 있는 데이터를 활용하여 학습하 는 방식이 아닌, 각 로컬 클라이언트에서 학습된 인공지능 모델의 파라미터 만을 사용하여 중앙 서버의 인공지 능 모델을 학습하는 방법이다. 로컬 클라이언트 별 보유 데이터의 분포에 따라 데이터 분산 환경은 독립 동일 분포(IID, Independent Identically Distributed) 환경과 비독립 동일 분포(Non-IID, Not Independent and Identically Distributed) 환경으로 구분된다. 독립 동일 분포(IID)는 각 로컬 클라이언트 별 보유 데이터의 분포가 비슷한 경우, 다시 말 하면, 데이터 양과 레이블이 비슷하게 분포된 경우를 의미하고, 비독립 동일 분포(Non-IID)는 각 로컬 클라이언 트 별 보유 데이터의 분포가 다른 경우, 다시 말하면, 데이터 양과 레이블이 비슷하지 않고 서로 다르게 분포된경우를 의미한다. 도 1은 개시된 실시 예에 따른 인공지능을 사용한 연합학습 방법에 대한 프레임워크를 도시한 도면이고, 도 2는 상기 연합학습 방법을 순차적으로 도시한 플로우차트이다. 도 2를 참조하여 개시된 실시 예의 인공지능을 사용한 연합학습 방법은 다음과 같이 수행될 수 있다. S110단계에서, 중앙 서버는 글로벌 모델을 로컬 클라이언트로 전송한다. S120단계에서, 로컬 클라이언트는 전송된 모델을 수신하여 이를 글로벌 모델 및 로컬 모델로 저장한다. S130단계에서, 로컬 클라이언트는 글로벌 모델을 기반으로 로컬 클라이언트 내부의 데이터를 사용하여 로컬 모 델을 학습한다. S140단계에서, 중앙 서버는 로컬 클라이언트에서 학습된 로컬 모델을 수신한다. S150단계에서, 중앙 서버는 로컬 클라이언트들 각각에서 수신된 로컬 모델들을 평균 내어 새로운 글로벌 모델을 생성한다. 이하에서 도 1을 참조하여 로컬 모델의 학습과 관련하여 좀 더 구체적으로 설명한다. 로컬 클라이언트에 포함되는 판별자 모델(discriminator)은 로컬 모델 및 글로벌 모델의 특성(feature)들을 판 별하는 기능을 수행하고, 분류기(classifier)는 특성들을 통해 정답을 분류하는 기능을 수행한다. 개시된 실시 예에서, 로컬 모델 학습 시, 한 배치(batch)마다 글로벌 모델 및 로컬 모델의 특성들을 사용하여 판별자 모델 및 분류기를 학습하여 상기 로컬 모델의 학습을 통해 로컬 모델의 특성들이 판별자 모델로 판별되 지 못하도록 로컬 모델의 특성들이 생성되고, 분류기는 정답을 분류하도록 동작하게 된다. 한편, 판별자 모델을 로컬 모델 및 글로벌 모델의 특성을 구분하지 못하도록 학습시키기 위해 적대적 학습에서 사용되는 판별자 함수 를 사용할 수 있다. 개시된 실시 예에서, 학습된 로컬 모델은 로컬 클라이언트에서 중앙 서버로 전송되어 S150단계와 같이 새로운 글로벌 모델이 생성되고, 설정한 라운드(round)만큼 S110 내지 S150단계의 과정이 중앙 서버 및 로컬 클라이언 트에서 반복해서 수행될 수 있다. 다시 도 1을 참조하면, 개시된 실시 예에서, 로컬 클라이언트에서 학습에 사용하는 손실함수는 하기의 수학식 1 내지 3과 같다. 수학식 1"}
{"patent_id": "10-2022-0107470", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "(여기서, : y번째 차원 벡터, : j번째 차원 벡터, j: 클래스 수이다.) 수학식 2"}
{"patent_id": "10-2022-0107470", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "(여기서, : 글로벌 모델 특성 벡터, : 로컬 모델 특성 벡터, : 특성 벡터를 판별한 예측값, n: 데이터 포인트 개수이다.)수학식 3"}
{"patent_id": "10-2022-0107470", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "(여기서, L은 전체 손실함수, LCE는 분류기, LDis는 판별자 모델과 각각 관련된 손실함수이다.) 개시된 실시 예에서, 전체 손실함수 L이 감소하도록 모델의 업데이트가 진행될 수 있다. 도 3은 개시된 실시 예에 따른 인공지능을 사용한 연합학습 방법과 종래 연합학습 방법들의 이미지 분류 정확도 를 CIFAR-10 데이터셋에 대해 IID 및 Non-IID 상황으로 나누어 비교한 표이다. 개시된 실시 예에서, 실험 데이터셋은 CIFAR-10을 사용하였으며, 모델은 VGG-9 신경망을 사용하였다. 학습에 사 용된 클라이언트 수는 10개, 라운드는 100회, Non-IID는 Dirichlet α=0.1로 설정하였다. 도 3을 참조하면, 개시된 실시 예의 연합학습 방법이 FedADD에 해당하고, 종래 연합학습 방법으로 FedAvg, FedProx, SCAFFOLD가 사용되었다. FedADD의 방법이 다른 종래 연합학습 방법들과 비교하여 IID 상황에서 평균 7% 정도, Non-IID 상황에서 평균 9% 정도의 분류 성능 향상이 이루어졌음을 확인할 수 있다. 지금까지 살펴본 바와 같이, 본 발명의 인공지능을 사용한 연합학습 방법은 적대적 학습에서 사용되는 판별자 손실 함수를 사용하여 로컬 모델의 특성을 글로벌 모델의 특성과 구분되지 않도록 로컬 모델을 학습시킴으로써 연합학습에서의 글로벌 모델의 발산을 억제할 수 있게 된다. 한편, 본 발명의 실시예들은 컴퓨터로 읽을 수 있는 기록 매체에 컴퓨터가 읽을 수 있는 코드로 구현하는 것이 가능하다. 컴퓨터가 읽을 수 있는 기록 매체는 컴퓨터 시스템에 의하여 읽혀질 수 있는 데이터가 저장되는 모든 종류의 기록 장치를 포함한다. 컴퓨터가 읽을 수 있는 기록 매체의 예로는 ROM, RAM, CD-ROM, 자기 테이프, 플로피디스크, 광 데이터 저장장치 등이 있으며, 또한 캐리어 웨이브(예를 들어 인터넷을 통한 전송)의 형태로 구현하는 것을 포함한다. 또한, 컴 퓨터가 읽을 수 있는 기록 매체는 네트워크로 연결된 컴퓨터 시스템에 분산되어, 분산 방식으로 컴퓨터가 읽을 수 있는 코드가 저장되고 실행될 수 있다. 그리고 본 발명을 구현하기 위한 기능적인(functional) 프로그램, 코 드 및 코드 세그먼트들은 본 발명이 속하는 기술 분야의 프로그래머들에 의하여 용이하게 추론될 수 있다. 다양한 변형예가 본 발명의 범위를 벗어남이 없이 본 명세서에 기술되고 예시된 구성 및 방법으로 만들어질 수 있으므로, 상기 상세한 설명에 포함되거나 첨부 도면에 도시된 모든 사항은 예시적인 것으로 본 발명을 제한하 기 위한 것이 아니다. 따라서, 본 발명의 범위는 상술한 예시적인 실시예에 의해 제한되지 않으며, 이하의 청구 범위 및 그 균등물에 따라서만 정해져야 한다.도면 도면1 도면2 도면3"}
{"patent_id": "10-2022-0107470", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 개시된 실시 예에 따른 인공지능을 사용한 연합학습 방법에 대한 프레임워크를 도시한 도면이다. 도 2는 개시된 실시 예에 따른 인공지능을 사용한 연합학습 방법을 순차적으로 도시한 플로우차트이다. 도 3은 개시된 실시 예에 따른 인공지능을 사용한 연합학습 방법과 종래 연합학습 방법들의 이미지 분류 정확도 를 CIFAR-10 데이터셋에 대해 IID 및 Non-IID 상황으로 나누어 비교한 표이다."}
