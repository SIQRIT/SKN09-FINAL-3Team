{"patent_id": "10-2021-0022704", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2022-0118801", "출원번호": "10-2021-0022704", "발명의 명칭": "CAN 데이터를 활용한 인공지능 기반 차량 진단 방법 및 장치", "출원인": "현대자동차주식회사", "발명자": "이동철"}}
{"patent_id": "10-2021-0022704", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "엔진;상기 엔진이 장착된 차량 엔진룸 내 위치하며, 진동 신호를 센싱하는 진동 센서;환경조건, 차량상태, 엔진상태, 엔진제어 파라미터 중 어느 한 개 이상과 통신하는 CAN(Controller AreaNetwork);상기 엔진으로부터 발생하는 불규칙 진동의 한도값(threshold)을 초과하는 진동 데이터(dB) 및 상기 CAN 데이터간의 상관성이 90%이상이 되는 특성(features)이 도출되도록 상기 진동 센서 및 상기 CAN으로부터의 데이터 전처리(data processing)가 수행되는 것을 특징으로 하는 CAN 데이터를 활용한 인공지능 기반 차량 진단 장치."}
{"patent_id": "10-2021-0022704", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 불규칙 진동의 한도값(threshold)은 0.5차 및 1차 오더(order) 성분이 대상인 것을 특징으로 하는 CAN 데이터를 활용한 인공지능 기반 차량 진단 장치"}
{"patent_id": "10-2021-0022704", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제2항에 있어서,상기 진동 데이터에 대한 전처리는, 상기 진동 신호의 레벨(level)이 기준 dB 이상이고, 제1 지속시간 이상 지속되는 제1 진동 데이터;를 구분하는 것을 특징으로 하는 CAN 데이터를 활용한 인공지능 기반 차량 진단 장치."}
{"patent_id": "10-2021-0022704", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제3항에 있어서, 상기 진동 데이터에 대한 전처리는 상기 진동 신호의 평균 레벨(level)이 기준 dB로부터 일정범위 이내이고, 상기 평균 레벨로 제2 지속시간 이상,제3 지속시간 이하로 지속되는 제2 진동 데이터; 를 추가로 구분하는 것을 특징으로 하는 CAN 데이터를 활용한 인공지능 기반 차량 진단 장치."}
{"patent_id": "10-2021-0022704", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제4항에 있어서, 상기 진동 데이터에 대한 전처리는 상기 진동 신호의 평균 레벨(level)이 기준 dB보다 작고, 제3 지속시간 미만으로 지속되는 제3 진동 데이터;를추가로 구분하고, 상기 제3 진동 데이터는 제거하는 것을 특징으로 하는 CAN 데이터를 활용한 인공지능 기반 차량 진단 장치"}
{"patent_id": "10-2021-0022704", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "공개특허 10-2022-0118801-3-제2항에 있어서, 상기 진동 데이터에 대한 전처리는 상기 엔진의 0.5차 및 1차 오더(order)에서의 진동의 레벨(level) 및 상기 레벨 별 개수분포를 각각에 구한 뒤,상기 진동 레벨의 상위 일정비율에 대한 레이블(Label)이 위치한 프레임으로부터 좌우 1개 프레임씩을 확장하는것을 특징으로 하는 CAN 데이터를 활용한 인공지능 기반 차량 진단 장치"}
{"patent_id": "10-2021-0022704", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제6항에 있어서, 상기 확장된 0.5차 및 1차 오더(order)에서의 레이블을 통합하고, 불규칙 진동 간의 거리인 프레임 수(x축)에대한 개수(y축)로부터 하위일정시간의 프레임 데이터는 한 개 레이블로 통합처리하는 것을 특징으로 하는 CAN 데이터를 활용한 인공지능 기반 차량 진단 장치"}
{"patent_id": "10-2021-0022704", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제6항에 있어서, 상기 전후 1개씩 프레임이 확장된 레이블에 대해서는 3개 레이블에 대한 평균필터링을 적용해, 전후에 경사도를갖는 기울기 값이 레이블로 부여되는 것을 특징으로 하는 CAN 데이터를 활용한 인공지능 기반 차량 진단 장치"}
{"patent_id": "10-2021-0022704", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제1항에 있어서,상기 CAN 데이터의 특성(features) 중 분산값과 평균값을 이용해 영향도가 낮은 타겟 레이블(Target label) 인자에 대해서는 제거하는 것을 특징으로 하는 것을 특징으로 하는 CAN 데이터를 활용한 인공지능 기반 차량 진단 장치"}
{"patent_id": "10-2021-0022704", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "환경조건, 차량상태, 엔진상태, 엔진제어 파라미터 중 어느 한 개 이상과 통신하는 CAN(Controller AreaNetwork)으로부터 CAN 데이터 취득단계;차량 내 아이들 진동을 발생하는 엔진으로부터 진동 센서에 의해 진동 신호를 센싱해, 진동 데이터를 취득하는단계;상기 엔진의 0.5차 및 1차 오더(order) 레벨(level) 중 불규칙 진동한도값(threshold)을 초과하는 진동 데이터(dB) 및 상기 CAN 데이터 간의 상관성이 90%이상인 특성(features)을 상기 진동 데이터 또는 상기 CAN 데이터로부터 취득하는 전처리(data processing)가 수행되는 것을 특징으로 하는 CAN 데이터를 활용한 인공지능 기반 차량 진단 방법"}
{"patent_id": "10-2021-0022704", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "제10항에 있어서,상기 진동 데이터에 대한 전처리는, 상기 진동 신호의 레벨(level)이 기준 dB 이상이고, 제1 지속시간이상 지속되는 제1 진동 데이터;상기 진동 신호의 평균 레벨(level)이 기준 dB로부터 일정범위 이내이고, 상기 평균 레벨로 제2 지속시간 이상,제3 지속시간 이하로 지속되는 제2 진동 데이터; 상기 진동 신호의 평균 레벨(level)이 기준 dB보다 작고, 제3 지속시간 미만으로 지속되는 제3 진동 데이터;를추가로 구분하고, 상기 제3 진동 데이터는 제거하는 것을 특징으로 하는 공개특허 10-2022-0118801-4-CAN 데이터를 활용한 인공지능 기반 차량 진단 방법"}
{"patent_id": "10-2021-0022704", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제10항에 있어서,상기 CAN 데이터에 대한 전처리는전체 수집된 CAN 데이터 특성 중 분산값과 평균값을 이용해 타겟 레이블(Target Label)에 대한 영향도가 낮은인자로서 분산값이 0인 경우 제거되는 것을 특징으로 하는 CAN 데이터를 활용한 인공지능 기반 차량 진단 방법"}
{"patent_id": "10-2021-0022704", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "제12항에 있어서,JSD방법을 적용해 상기 CAN 데이터 중 최소값과 최대값이 같은 특성(Features)에대해 제거하는 단계;를 추가로포함하는 것을 특징으로 하는CAN 데이터를 활용한 인공지능 기반 차량 진단 방법"}
{"patent_id": "10-2021-0022704", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_14", "content": "제13항에 있어서,피어슨 상관분석 방법으로 상기 CAN 데이터의 물리적인 특징을 이용해 특성(Features)을 축소하되, 상기 CAN 데이터의 특성과 타겟 간의 피어슨 계수를 계산하여 상기 CAN 데이터 중 특성(features)을 선별하는 단계:를 추가로 포함하는 것을 특징으로 하는CAN 데이터를 활용한 인공지능 기반 차량 진단 방법"}
{"patent_id": "10-2021-0022704", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_15", "content": "환경조건, 차량상태, 엔진상태, 엔진제어 파라미터 중 어느 한 개 이상과 통신하는 CAN(Controller AreaNetwork)으로부터 CAN 데이터 취득단계;차량 내 진동을 발생하는 엔진으로부터 진동 센서에 의해 진동 신호를 센싱해, 진동 데이터를 취득하는 단계;상기 엔진의 0.5차 및 1차 오더(order) 레벨(level) 중 불규칙 진동한도값(threshold)을 초과하는 진동 데이터(dB) 및 상기 CAN 데이터 간의 상관성이 90%이상인 특성(features)을 상기 CAN 데이터로부터 취득하는 전처리(data processing) 단계;상기 특성의 CAN 데이터를 입력 데이터로 입력하는 단계;어텐션 레이어(Attention layer) 및 덴스 레이어(Dense layer)가 적용된 DNN 학습 단계;학습된 출력값을 출력하는 단계; 를 포함하는 것을 특징으로 하는CAN 데이터를 활용한 인공지능 기반 차량 진단 방법"}
{"patent_id": "10-2021-0022704", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_16", "content": "제15항의 CAN 데이터를 활용한 인공지능 기반 차량 진단 방법이 적용된 진단기"}
{"patent_id": "10-2021-0022704", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_17", "content": "제15항의 CAN 데이터를 활용한 인공지능 기반 차량 진단 방법이 적용된 진단 및 제어부;상기 차량과 동종의 다른 차량으로부터 취득한 CAN 데이터를 상기 진단 및 제어부에 입력되면, 출력되는 인공지능 기반의 불규칙 진동에 대한 진단 결과에 대해 상기 진단 및 제어부에서 상기 불규칙 진동를 제거하도록 제어인자를 변경하는 것을 특징으로 하는공개특허 10-2022-0118801-5-CAN 데이터를 활용한 인공지능 기반 차량 진단 및 제어 장치"}
{"patent_id": "10-2021-0022704", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 CAN 데이터를 활용한 인공지능 기반 차량 진단 장치는 엔진; 기 엔진이 장착된 차량 엔진룸 내 위치하 며, 진동 신호를 센싱하는 진동 센서; 환경조건, 차량상태, 엔진상태, 엔진제어 파라미터 중 어느 한 개 이상과 통신하는 CAN(Controller Area Network); 상기 엔진으로부터 발생하는 불규칙 진동의 한도값(threshold)을 초과 하는 진동 데이터(dB) 및 상기 CAN 데이터 간의 상관성이 90%이상이 되는 특성(features)이 도출되도록 상기 진 동 센서 및 상기 CAN으로부터의 데이터 전처리(data processing)가 수행될 수 있다."}
{"patent_id": "10-2021-0022704", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 CAN 데이터를 활용해 인공지능 기반으로 엔진의 불규칙 진동을 진단하고, 엔진제어를 통해 진동 억제 를 하는 방법 및 장치에 관한 것이다."}
{"patent_id": "10-2021-0022704", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "종래 자동차 엔진의 연소제어를 연구하는 보쉬 등의 FIE(Fuel Injection Equpment) 업체에서는 엔진 기통간의 불완전한 연소에 대한 실험식 결과를 이용해 엔진 상태를 진단하나, 진단 정확도는 60% 이하의 수준이다. 즉, 불완전한 연소가 발생하는 기통에 대한 정보를 이용해, 엔진에 연료분사에 관한 변수를 제어함으로서, 불완전 연소를 안정화시키고자 하나, 진단에 대한 정확도가 낮아, 이를 근거로 엔진 제어를 할 때 과도한 제어 전략으 로 변경되거나, 심지어 제어오류로 인한 문제점이 발생할 수 있다. 더구나, 엔진 기통간의 불완전한 연소에 대 한 실험식은 FIE 업체에서 공개를 꺼려하는 Black Box Function으로서, 이에 대해 개선을 하기가 어렵고, 검증 을 하는 것은 아예 불가능하다. 이에, FIE 업체의 실험식에 의존하지 않고, 차량 CAN 데이타로부터 엔진 기통간의 불완전한 연소를 진단하는 방 법을 개발할 필요가 있다. 선행기술문헌 특허문헌 (특허문헌 0001) 한국공개특허 2018-0029320"}
{"patent_id": "10-2021-0022704", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "이에 상기와 같은 점을 해결하기 위한 본 발명은 CAN 데이터를 활용해 인공지능 기반으로 엔진의 불규칙 진동을 진단하고, 엔진제어를 통해 진동 억제를 하는 방법 및 장치에 관한 것으로, 수집된 CAN데이터에 대한 전처리를 통해 수집된 진동 데이터의 전처리 전처리를 통해 진단 모델의 정확도를 향상시키며, 진동센서 없이CAN 데이터 들 중에서 불규칙 진동과의 상관성이 높은 특징을 추출하는 딥리넝을 통해 진단 모델의 정확도를 더욱 향상시킴 으로서, 불규칙 진동 진단 및 제어에 활용하고자 하는데 목적이 있다."}
{"patent_id": "10-2021-0022704", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "상기와 같은 목적을 달성하기 위한 본 발명의 CAN 데이터를 활용한 인공지능 기반 차량 진단 장치는 엔진; 기 엔진이 장착된 차량 엔진룸 내 위치하며, 진동 신호를 센싱하는 진동 센서; 환경조건, 차량상태, 엔진상태, 엔 진제어 파라미터 중 어느 한 개 이상과 통신하는 CAN(Controller Area Network); 상기 엔진으로부터 발생하는 불규칙 진동의 한도값(threshold)을 초과하는 진동 데이터(dB) 및 상기 CAN 데이터 간의 상관성이 90%이상이 되 는 특성(features)이 도출되도록 상기 진동 센서 및 상기 CAN으로부터의 데이터 전처리(data processing)가 수 행될 수 있다. 한편, 상기 불규칙 진동의 한도값(threshold)은 0.5차 및 1차 오더(order) 성분을 대상으로 하며, 상기 진동 데 이터에 대한 전처리는 상기 진동 신호의 레벨(level)이 기준 dB 이상이고, 제1 지속시간이상 지속되는 제1 진동 데이터; 상기 진동 신호의 평균 레벨(level)이 기준 dB로부터 일정범위 이내이고, 상기 평균 레벨로 제2 지속시 간 이상, 제3 지속시간 이하로 지속되는 제2 진동 데이터; 상기 진동 신호의 평균 레벨(level)이 기준 dB보다 작고, 제3 지속시간 미만으로 지속되는 제3 진동 데이터;를 구분하고, 상기 제3 진동 데이터는 제거처리할 수 있다.상기 엔진의 0.5차 및 1차 오더(order)에서의 진동의 레벨(level) 및 상기 레벨 별 개수분포를 각각에 구한 뒤, 상기 진동 레벨의 상위 일정비율에 대한 레이블(Label)이 위치한 프레임으로부터 좌우 1개 프레임씩을 확장하고, 상기 확장된 0.5차 및 1차 오더(order)에서의 레이블을 통합하고, 불규칙 진동 간의 거리인 프레임 수(x축)에 대한 개수(y축)로부터 하위일정시간의 프레임 데이터는 한 개 레이블로 통합처리 할 수 있다. 상기 전후 1개씩 프레임이 확장된 레이블에 대해서는 3개 레이블에 대한 평균 필터링을 적용해, 전후에 경사도를 갖 는 기울기 값이 레이블로 부여되는 할 수 있다. 환경조건, 차량상태, 엔진상태, 엔진제어 파라미터 중 어느 한 개 이상과 통신하는 CAN(Controller Area Network)으로부터 CAN 데이터 취득단계; 차량 내 아이들 진동을 발생하는 엔진으로부터 진동 센서에 의해 진동 신호를 센싱해, 진동 데이터를 취득하는 단계; 상기 엔진의 0.5차 및 1차 오더(order) 레벨(level) 중 불규칙 진동한도값(threshold)을 초과하는 진동 데이터(dB) 및 상기 CAN 데이터 간의 상관성이 90%이상인 특성 (features)을 상기 진동 데이터 또는 상기 CAN 데이터로부터 취득하는 전처리(data processing)가 수행되며, 상 기 진동 데이터에 대한 전처리는, 상기 진동 신호의 레벨(level)이 기준 dB 이상이고, 제1 지속시간이상 지속되 는 제1 진동 데이터; 상기 진동 신호의 평균 레벨(level)이 기준 dB로부터 일정범위 이내이고, 상기 평균 레벨 로 제2 지속시간 이상, 제3 지속시간 이하로 지속되는 제2 진동 데이터; 상기 진동 신호의 평균 레벨(level)이 기준 dB보다 작고, 제3 지속시간 미만으로 지속되는 제3 진동 데이터;를 추가로 구분하고, 상기 제3 진동 데이 터는 제거할 수 있고, 상기 CAN 데이터 전처리는 전체 수집된 CAN 데이터 특성 중 분산값과 평균값을 이용해 타 겟 레이블(Target Label)에 대한 영향도가 낮은 인자로서 분산값이 0인 경우 영향도 낮은 타겟 레이블(Target label) 인자에 대해서 제거함으로서 학습에 필요한 입력값을 최적화 할 수 있다. 또한, JSD방법을 적용해 상기 CAN 데이터 중 최소값과 최대값이 같은 특성(Target Features)을 제거하는 단계; 피어슨 상관분석 방법으로 CAN 데이터의 물리적인 특징을 이용해 특성(Features)을 축소하되, 상기 CAN 데이터의 특성과 타겟 간의 피어슨 계 수를 계산하여 상기 CAN 데이터 중 특성(features)을 선별할 수 있다. 또한, 환경조건, 차량상태, 엔진상태, 엔진제어 파라미터 중 어느 한 개 이상과 통신하는 CAN(Controller Area Network)으로부터 CAN 데이터 취득단계; 차량 내 아이들 진동을 발생하는 엔진으로부터 진동 센서에 의해 진동 신호를 센싱해, 진동 데이터를 취득하는 단계; 상기 엔진의 0.5차 및 1차 오더(order) 레벨(level) 중 불규칙 진동한도값(threshold)을 초과하는 진동 데이터(dB) 및 상기 CAN 데이터 간의 상관성이 90%이상인 특성 (features)을 상기 CAN 데이터로부터 취득하는 전처리(data processing) 단계; 상기 특성의 CAN 데이터를 입력 데이터로 입력하는 단계; 어텐션 레이어(Attention layer) 및 덴스 레이어(Dense layer)가 적용된 DNN 학습 단 계; 학습된 출력값을 출력하는 단계; 를 포함하는 CAN 데이터를 활용한 인공지능 기반 차량 진단 방법이 적용된 진단기에서의 적용 할 수 있다. 또한, CAN 데이터를 활용한 인공지능 기반 차량 진단 및 제어 장치에서 CAN 데이터를 활용한 인공지능 기반 차 량 진단 방법이 적용된 진단 및 제어부; 상기 차량과 동종의 다른 차량으로부터 취득한 CAN 데이터를 상기 진단 및 제어부에 입력되면, 출력되는 인공지능 기반의 불규칙 진동에 대한 진단 결과에 대해 상기 진단 및 제어부에 서 상기 불규칙 진동를 제거하도록 제어인자를 변경 할 수 있다."}
{"patent_id": "10-2021-0022704", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하 본 발명의 실시 예를 첨부된 예시도면을 참조로 상세히 설명하며, 이러한 실시 예는 일례로서 본 발명이 속하는 기술 분야에서 통상의 지식을 가진 자가 여러 가지 상이한 형태로 구현될 수 있으므로, 여기에서 설명하 는 실시 예에 한정되지 않는다. 차량 운전 중 수집되는 CAN 데이터 중 엔진으로부터 불완전 연소와 관련이 되는 데이터로 대표적인 것은 진동신 호에 관련된 진동 데이터이다. 진동 데이터는 딥러닝 모델에 의해 예측하고자 하는 레이블(Label)의 대상이 되 는 타겟(Target) 진동 데이터이며, 진동센서를 엔진룸에 부착하는 경우에는 엔진의 진동, 시트에 부착하는 경우 에는 시트의 진동 데이타이지만, 근본적으로 진동 센서가 어디에 부착되든 지 엔진의 불완전 연소로부터 비롯된 진동을 감지한다. 진동센서를 엔진룸에 설치하여, 기통당 크랭크 샤프트가 2회전할 때마다 폭발에 의한 불완전 연소가 발생하므로 0.5차 오더 성분이 발생하며, 최대 6기통인 경우 3차 오더 성분까지 0.5 ~ 3차 오더 성분이 발생한다. 이러한 진동 센서가 XYZ 축에 대해 각각 장착될 수 있다. 한편, 엔진룸 이외에도 시트에 진동센서를 부착해 엔진의 불 완전 연소에 의한 시트의 진동을 측정할 수 있다. 이 경우에도 불완전 성분은 엔진이므로, 0.5 ~ 3차 오더 성분 이 발생한다. 실제 운행되는 차량에서는 진동 데이타를 취득하기 위한 목적으로 진동센서를 장착할 수는 없으며, 오직 개발단계에서만 데이터 수집을 위해 다수의 진동센서를 장착할 수 있다. 진동 데이터 외에 CAN 데이터를 통해 운전 환경조건, 차량의 운전 상태, 엔진의 상태 및 엔진 제어 파라미터 등 ECU 데이터가 취득된다. ECU 데이터는 진단 모델의 입력 데이터로 사용될 수 있다. 또한, 시간(time)이나 사이클 수(cycle number)도 CAN 데이터 수집에서 중요하다. 딥러닝 모델 구성을 위해, 개발 단계에서는 딥러닝 모델에 의해 예측하고자 하는 레이블(Label)의 대상이 되는 타겟(Target) 진동 데이터에 대한 수집이 필요하다. 수집된 진동 데이터로부터 생성된 딥러닝 모델은 개발 시와 동일한 엔진 및 동일한 샤시 플랫폼을 가진 차량에서는 개발 시 1회의 딥러닝 학습으로 전체 차량에 적용이 가 능하다. 그러나, 개발 단계에서 사용했던 엔진과 다른 엔진이거나 다른 샤시 플랫폼을 가진 차량의 경우에는 그 대로 적용할 수 없고, 입력 데이터로 사용할 타겟(Target) 진동 데이터에 대한 재수집 및 재학습에 의해 기본 모델로부터의 모델 변경이 필요하다. 운전자가 느끼는 타겟(Target) 진동 데이터는 불규칙 진동의 한도값(threshold)을 초과하는 진동 데이터(dB)로 서 엔진의 불규칙 진동의 기준이 되는 0.5차 오더 성분와 1차 오더 성분에서의 진동 데이터로서, 통상적으로 사 람이 느끼는 불규칙 진동에 해당하며, 각각의 진동 레벨은 개발 차량의 개발 목표의 기준이 된다. 0.5차 오더 성분에서의 진동 레벨, 1차 오더 성분에서의 진동 레벨 각각 혹은 이들의 합으로부터 불규칙 진동을 도 1을 참 고해 다음과 같이 분류한다. 첫째, 강하고 지속시간이 긴 불규칙 진동이다. 즉, 도 1(a)에서 일정 레벨이상의 진동이 일정 시간 이상 지속되 는 불규칙한 진동으로 분류된다. 즉, 진동 신호의 레벨(level)이 기준 dB 이상이고, 제1 지속시간이상 지속되는 제1 진동 데이터로 정의할 수 있다. 둘째, 연속적으로 발생하는 불규칙 진동이다. 즉, 도 1(b)에서 지속시간이 일정 시간 이하이지만 일정 레벨 이 상의 진동이 연속적으로 발생하는 경우로서, 이들 불규칙 진동 신호 간 통합을 통해 불규칙한 진동으로 분류된 다. 즉, 진동 신호의 평균 레벨(level)이 기준 dB로부터 일정범위 이내이고, 상기 평균 레벨로 제2 지속시간 이 상, 제3 지속시간 이하로 지속되는 제2 진동 데이터로 정의할 수 있다.셋째, 지속시간이 짧은 불규칙 진동이다. 즉, 도 1(c)에서 지속시간이 일정 시간이 이하이면서도 연속적이지 않 은 경우로서, 이들 불규칙 진동 신호는 제거 처리한다. 즉, 진동 신호의 평균 레벨(level)이 기준 dB보다 작고, 제3 지속시간 미만으로 지속되는 제3 진동 데이터로 추가 구분하고, 제3 진동 데이터는 제거처리 된다. 수집된 진동 데이터의 특징 중 실제 딥러닝 모델에 의해 예측하고자 하는 레이블(Label)로서 타겟(Target) 진동 데이터의 설정이 매우 중요하다. 타겟 진동 데이터를 전처리 함으로써, 딥러닝 진단 모델의 정확도가 더욱 향상 되기 때문이다. 넷째, 불규칙 진동 발생시간을 고려해, 딥러닝 모델에 의해 예측하고자 하는 레이블(Label)로서 타겟(Target) 진동 데이터에 대해 레이블을 확장(extending)하고 스무딩(smoothing) 처리이다. 이를 위해 먼저, 강하고 지속시간이 긴 분류의 불규칙 진동, 연속적으로 발생해 통합 처리한 분류의 불규칙 진 동, 및 지속시간이 짧아 제거 처리한 불규칙 진동을 포함한 0.5차 오더 성분에서의 진동 레벨 및 1차 오더 성분 에서의 진동 레벨(level) 데이터의 분포를 구한다. 도 2는 데이터 분포를 보기 위한 히스토그램으로서, 도 2(a)는 1차 오더, 도2(b)는 0.5차 오더 성분에서의 분포 이다. x축은 취득된 진동 레벨과 개발목표(0 dB) 진동 레벨의 차이로서 상대값(dB 단위)을 나타내고, y축은 각 범위 별 개수로서 데이터 수를 나타낸다. 그 후, 도 2(a)(b)의 분포에서 상위 30%의 불규칙 진동에 대한 레이블(Label)이 있는 프레임(frame)으로부터 좌 우 프레임 1개씩, 전체 2개 프레임(frame)만큼 확장(extending)한다. 30%는 일정 비율의 강한 진동을 나타내는 일례로서, 레이블(Label)을 확장할 불규칙 진동 레벨의 비율은 강하게 발생하는 명확한 불규칙 진동을 어떻게 설정하냐에 따라 조정할 수 있다. 1개 프레임이 0.2초인 경우, 현재 프레임을 포함해 전후 2개 프레임을 합해, 총 0.6초의 데이터를 처리한다. 프레임 확장 후, 0.5차 오더 성분 및 1차 오더 성분에 대한 레이블(Label) 및 개수를 통합해서 도 3(a)의 불규 칙 진동에 대한 시간 간격 분포로 나타낸다. 여기서, x축은 불규칙 진동 간 거리로서 프레임(frame)단위로 불규 칙 진동에 대한 개발목표를 초과한 프레임과 그 다음 초과한 프레임과의 거리이다. 불규칙 진동에 대한 개발목 표를 초과한 프레임이란, 앞서 설정한 개발목표 0dB보다 큰 불규칙 진동이 있는 프레임(frame)을 의미한다. y축 은 불규칙 진동 간 동일 거리 데이터의 개수이다. 즉, x축이 0에 가까울수록 불규칙 진동 간의 프레임이 작아, 불규칙 진동이 반복된다는 것을 의미한다. 즉, 확장된 0.5차 및 1차 오더(order)에서의 레이블을 통합하고, 불규칙 진동 간의 거리인 프레임 수(x축)에 대 한 개수(y축)로부터 하위일정시간의 프레임 데이터는 한 개 레이블로 통합처리한다. 도 3(b)는 취득된 진동 데이터에 대한 최초 데이터 레이블링(Original Data Labeling)이 본 발명에서의 데이터 전처리에 의해 새로운 데이터 레이블링(New Data Labeling)으로 변환됨을 나타낸다. 즉, 최초 신호(original signal)인 진동 레벨(dB)이 프레임(시간)에 따라 0.5차 오더 및 1차 오더 성분에 대해 필터링을 통해 취득된 후, 진동 레벨(dB)에 대한 레이블(Label) 처리된 값으로 y축에 1 또는 0을 최초에 부여한다. Label 0은 불규칙 진동이 발생하지 않고, Label 1은 불규칙 진동이 발생했음을 의미한다. 본 발명의 전처리를 통해 최초 레이블 (Original Lable)로부터 불규칙 진동 시간 간격을 고려해 빠른 시간 주기를 갖는 값을 하나로 통합 처리해 새로 운 레이블(New Label)이 만들어 진다. 도 4(a)는 통합 처리된 새로운 레이블을 나타내며, 불규칙 진동 타겟 레이블이 있는 프레임으로부터 좌우 1프레 임씩의 확장을 통해 도 4(b)로 레이블이 변화됨을 확인 할 수 있다. 프레임 확장에 따른 레이블은 평균 필터링 을 통해, Label[i] = ( Label[i-1] + Label[i] + Label[i+1] )/3 로 정의한다. 여기서 i는 프레임이며, 1개의 프레임이 매우 짧은 시간 데이터이므로, 확장 후 불규칙 진동 레이블의 정보 소실을 방지하기 위해 평균 필터링 처리를 통해 경사도를 갖는 기울기 값이 부여될 수 있다. 도 5는 불규칙 진동의 최초 레이블로부터 지속시간이 짧은(예: 2frame 이하) 불규칙 진동의 레이블을 제거 (delete)하는 과정이다. 도 4(a)에서의 최초 레이블 중 2frame 이하의 데이터는 사람이 인지하지 못하는 수준으 로 판단하여 데이터를 제거 처리 할 수 있다. 강하지 않지만 개발 목표를 넘는 진동 데이터와 빠른 주기를 갖지 않는 진동 데이터가 대상이다. 도 6은 앞서 설명한 전처리 과정을 통합해서 보여준다. 진동센서에 의해 취득된 매우 빠르게 반응하는 진동 신 호에서 개발 목표를 대표하는 진동 신호로 처리하는 과정으로 타겟 레이블(Target Label)로 사용하도록 변환하 는 과정이다. 원본 NVH데이터에서는 신호를 추출(취득)하는 샘플링 레이트(sampling rate)를 따라 20msec이내 수준의 매우 빠 른 응답 특성을 보이나, 노이즈 성분이 실제 진동 특성을 반영하지 못한다. 이에, 0.5차 및 1차 오더 성분 중 개발 목표를 초과하는 신호를 추출하고, 노이즈 성분이 잔존하는 raw data를 제거하여 최초 레이블(original label)을 진행한 뒤, 본 발명의 전처리 과정을 통해 최종적으로 타겟 특성(Target Features)이 추출됨으로서, 딥러닝 모델에 맞는 정확한 레이블이 가능하다. 이를 통해 기존의 진단 모델을 구성하는 방식과 전혀 다른 형태로 원하는 특성(Features)이 뚜렷해지는 효과가 발생하며, 타겟 특성(Target Features)의 정확도는 전체 모델의 정확도를 결정하게 된다. 한편, 딥러닝 학습을 위한 CAN 신호로부터 타겟 특성(Target Features)을 추출하되 최적화가 필요함에 따라 차 원 축소 기법을 적용할 수 있다. 즉, CAN 데이터는 매우 빠르게 변화하는데, 입력 데이터 중에서 타겟 레이블 (Target Label)인 진동신호와 상관성이 높은 특성(Features)을 추출하기 위해 4개의 복합 알고리즘을 적용하고, 차량 CAN 데이터 특성을 잘 반영하는 앙상블 모델(Ensemble model)을 적용할 수 있다. 첫째, Jenson-Shannon Divergence(JSD) 방법의 적용이다. Jenson-Shannon Divergence(JSD)는 Kullback- Keibler Divergence(KLD)를 응용한 것으로, KLD는 모집단의 확률 분포와 근사한 표본 집단의 확률 분포 모델이 실제(모집단)의 모델과 얼마나 닮았는지 알기 위한 정량적인 척도가 필요하다. 즉 딥러닝을 통해 추정한 모델이 실제 모델과 얼마나 닮았는지에 대한 정량적인 척도로 사용된다. 반면, Jenson-Shannon Divergence(JSD)는 KLD 를 대칭(symmetric)되도록 변형한 방법으로, 특성(Features)의 클래스(class) 별 JSD를 측정하여 분포간 거리를 계산한다. JSD를 활용해 수집된 데이터의 특성(Features) 별로 클래스(class) 간의 분포들 간의 거리계산으로부 터 상관관계의 유추에도 사용할 수 있다. 즉, JSD 값이 높을수록 클래스 간 구분이 명확해 유용한 특성 (Features)을 갖는다. 각 특성(Features)의 JSD 점수를 이용해 최종 특성(Features) 및 차원(Dimension)이 선 정된다. 둘째, 셀프 어텐션(Self-Attention) 방법의 적용이다. 어텐션은 인간의 시각적 집중 현상을 구현하기 위한 신경 망 방법인데, 본 발명에서 불규칙 진동에 관한 데이터에 적용한다. 본 발명에서 셀프 어텐션 방법을 적용하면, 타 데이터가 아닌 CAN 데이터 자체로부터 딥러닝 모델을 사용하여 각 특성(Features)과 타겟(Target) 간의 집중 점수(attention score)를 계산하여 주요 특성(Features)을 선별한다. 셋째, 피어슨 상관분석(Pearson correlation) 방법이다. 2개의 변수간의 상관관계를 분석하는 방법 중 하나로서, 각 특성(Features)와 타겟(Target)과의 상관계수를 나타내는 피어슨 계수로부터 상호 연관성을 판단 한다. 넷째, 코사인 유사도의 적용이다. 코사인 유사도는 수학적으로 벡터의 크기는 고려하지 않고 두 벡터 사이의 각 도만 고려하는 측정법을 의미하며, 방향이 얼마나 유사한 지를 1부터 -1사이의 값으로 표현한다. 딥러닝 학습을 위한 CAN 신호로부터 타겟 특성(Target Features)을 추출하되 최적화가 필요함에 따라 차원 축소 기법을 적용하는 실시예를 설명한다. 먼저, 타겟 특성(Target Features)을 추출하는 1차 선별과정으로, 전체 수집된 CAN 데이터 특성 중 분산값과 평 균값을 이용해 타겟 레이블(Target Label)에 대한 영향도가 낮은 인자를 제거할 수 있다. 데이터의 분산값이 0 이라는 것은 데이터로서의 변별력이 낮음을 의미하기 때문이다. 도 7은 전체 55개의 특성(Features)에 대해 분 산값이 0인 경우에 제거된 결과의 예시이다. JSD방법을 적용해 타겟 특성(Target Features)을 추출하는 2차 선별과정으로 JSD 값이 높을수록 클래스(class) 간 구분이 명확해서 유용한 특성 (Features)이라 할 수 있다. 도 8(a)는 높은 JSD 값을 갖는 특성(Features)에 대한 히스토그램으로, 전체적으로 개수 비율이 낮지만, low NVH와 high NVH에 대해 구별이 된다. 도 8(b)는 낮 은 JSD를 갖는 특성(Features)에 대한 히스토그램으로, 전체적으로 개수 비율이 커서, low NVH와 high NVH에 대 해 구별이 어렵다. JSD방법을 적용하고, CAN 데이터 중 최소값과 최대값이 같은 특성(Features)에 대해서는 변 별력이 낮아 제거할 수 있다. 타겟 특성(Target Features)을 추출하는 3차 선별과정에서는 피어슨 상관분석 방법은 CAN 데이터의 물리적인 특 징을 이용해 특성(Features)을 축소할 수 있다. 진동에 대한 타겟 레이블(Target Label) 특성과 영향이 높은 CAN 데이터 중 물리적인 의미가 유사한 특성(Features)들을 군집화하고, 군집화 데이터를 하나의 대표값으로 선 택하는 과정이다. 도9(a)는 엔진오일온도(x축)과 엔진 냉각수온도(y축) 간의 물리적인 연관성, 도 9(b)는 실린 더2의 점화시기 제어값과 실린더3의 점화시기 제어값 간의 물리적인 연관성을 나타내며, 도 9(c)은 피어슨 상관분석을 통해 물리적인 연관성이 높고 낮음을 진하기로 표시한 피어슨 히트맵이다. 도 10은 본 발명의 전체를 도시화 한 것으로, 진동에 관한 타겟 신호에 대한 전처리 과정 및 CAN 데이터 중 타 겟 특성(Target Features)을 추출하는 과정이며, 이러한 2개의 과정을 거친 입력(Input) 신호에 어텐션 레이어 (Attention layer) 및 깊은 Dense layer에서의 학습을 통해 진단 정확도 90% 수준의 진단 모델의 제공이 가능하 다. 신경망이 훈련 데이터에만 적응해서 그외의 데이터에는 제대로 적응하지 못하는 상태를 오버피팅이라 하는데, 오버피팅(overfitting) 방지를 위해 각 단계별로 드롭아웃(Dropout)을 적용한다. 드롭아웃은 학습 과정에서 은 닉층의 뉴런을 무작위로 골라 삭제하면서 학습하는 방법으로, 실제 적용 시에는 모든 뉴런에 신호를 전달한다. Dense 레이어는 입력과 출력을 모두 연결해주며, 입력과 출력을 각각 연결해주는 가중치를 포함하고 있다. Dense 레이어(fully connected) 학습 구조의 장점은 많은 입력 데이터가 각각은 조건 별 영향도를 가지는 특성 (Features)인 경우, 즉 자동차 제어 인자와 같은 특성을 가지며, 입력 데이터의 정보가 직렬형태가 아닌 다양한 경로고 적용되어 중요 정보를 소실하지 않고, 모델의 진단 정확도를 향상시키는 장점이 있다. 도 11은 본 발명이 적용된 실시예를 나타낸다. 도 11(a)는 오프라인 서비스 센터의 진단기에 적용한 실시예로, 모바일 진단기에 딥러닝 학습모델이 적용된 함 수를 UI 타입으로 개발하여 적용한다. 점검대상 차량과 CAN 통신을 통해 아이들 조건의 입력 데이터를 CAN 데이 터로부터 취득하고, 딥러닝 학습모델을 통해 진단 결과를 출력함으로서, 진도 센서 없이 기존 진단기 모듈만으 로 정확한 진단이 가능하다. 도 11(b)는 엔진 ECU 및 TCU에서 차량 내 모든 CAN 신호를 모니터링 하는 제어기에 적용가능하며, 실시간으로 차량의 CAN 데이터를 아이들 불규칙 진동현상 진단에 필요한 입력 특성(Features)으로 사용한다. 실시간으로 진 단 결과에 대한 데이터 처리를 통해 불규칙 진동이 안정화되도록 제어기에서 제어인자의 변경이 가능하다. 제어 인자를 변경한 후, 재진단이 되는 반복과정을 통해 차량의 실시간 진단 및 제어가 가능하다. 제어 인자의 변경 은 각각의 모델에 기초한 제어전략을 달리하도록 별도 알고리즘을 통해 가능하다."}
{"patent_id": "10-2021-0022704", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1(a)(b)(c)는 불규칙 진동의 분류이며, 도 1(a)는 강하고 지속시간이 긴 불규칙 진동, 도 1(b)는 연속적으로 발생하는 불규칙 진동, 도 1(c)는 지속시간이 짧은 불규칙 진동을 나타낸다. 도 2는 진동 레벨과 범위 별 개수에 대한 데이터 분포를 나타내기 위한 히스토그램이며, 도 2(a)는 1차 오더, 도2(b)는 0.5차 오더 성분에서의 분포이다. 도 3(a)의 불규칙 진동에 대한 시간 간격 분포이고, 도 3(b)는 취득된 진동 데이터에 대한 최초 데이터 레이블 링(Original Data Labeling)이 본 발명에서의 데이터 전처리에 의해 새로운 데이터 레이블링(New Data Labeling)으로 변환된 그림이다. 도 4(a)는 통합 처리된 새로운 레이블을 나타내며, 도 4(b)로 레이블이 변화됨 나타내는 그림이다. 도 5는 불규칙 진동의 최초 레이블로부터 지속시간이 짧은 불규칙 진동의 레이블을 제거(delete)하는 과정을 나 타낸다. 도 6은 전처리 과정을 통합그림이다.도 7은 전체 55개의 특성(Features)에 대해 분산값이 0인 경우에 제거된 결과의 예시이다. 도 8(a)는 높은 JSD 값을 갖는 특성(Features)에 대한 히스토그램이고, 도 8(b)는 낮은 JSD를 갖는 특성 (Features)에 대한 히스토그램이다. 도 9(a)는 엔진오일온도(x축)과 엔진 냉각수온도(y축) 간의 물리적인 연관성, 도 9(b)는 실린더2의 점화시기 제 어값과 실린더3의 점화시기 제어값 간의 물리적인 연관성을 나타내며, 도 9(c)은 피어슨 상관분석을 통해 물리 적인 연관성이 높고 낮음을 진하기로 표시한 피어슨 히트맵이다. 도 10(a)(b)(c)은 본 발명의 전체를 도시화한 그림이다. 도 11은 본 발명이 적용된 실시예로, 도 11(a)는 진단기, 도 11(b)는 진단제어장치의 개념도이다."}
