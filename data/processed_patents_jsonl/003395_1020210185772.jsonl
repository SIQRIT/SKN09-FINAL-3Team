{"patent_id": "10-2021-0185772", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2023-0096358", "출원번호": "10-2021-0185772", "발명의 명칭": "인공지능을 활용한 좌심실 비후 심장 초음파 영상의 분석 방법 및 장치", "출원인": "서울대학교병원", "발명자": "황인창"}}
{"patent_id": "10-2021-0185772", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "대상자의 심장 초음파 영상을 입력받는 입력부; 및딥러닝 기반의 학습된 예측 모델로서, 입력된 대상자의 심장 초음파 영상에 기초하여 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하는 예측 모델을 포함하는, 인공지능을 활용한좌심실 비후 심장 초음파 영상의 분석 장치."}
{"patent_id": "10-2021-0185772", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 대상자는 좌심실 비후 증상이 보이는 것을 특징으로 하는, 인공지능을 활용한 좌심실 비후 심장 초음파 영상의 분석 장치."}
{"patent_id": "10-2021-0185772", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1항에 있어서,상기 심장 초음파 영상은 흉골연장축단면 영상(PLAX), 흉골연단축단면 영상(PSAX), 심첨4방 영상(A4C), 심첨2방영상(A2C) 및 심첨3방 영상(A3C)을 포함하는, 인공지능을 활용한 좌심실 비후 심장 초음파 영상의 분석 장치."}
{"patent_id": "10-2021-0185772", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제3항에 있어서,상기 예측 모델은,입력된 흉골연장축단면 영상(PLAX)을 기초로 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장아밀로이드증 확률을 각각 산출하도록 학습된 제1 서브 네트워크, 입력된 흉골연단축단면 영상(PSAX)을 기초로대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하도록 학습된 제2 서브 네트워크, 입력된 심첨4방 영상(A4C)을 기초로 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하도록 학습된 제3 서브 네트워크, 입력된 심첨2방 영상(A2C)을기초로 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하도록 학습된 제4 서브 네트워크 및 입력된 심첨3방 영상(A3C)을 기초로 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하도록 학습된 제5 서브 네트워크를 포함하는 제1 네트워크; 및상기 제1 내지 제5 서브 네트워크의 출력들을 집합하고, 집합된 출력들을 분석하여 대상자의 고혈압성 좌심실비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하도록 구성되는 제2 네트워크를 포함하는, 인공지능을 활용한 좌심실 비후 심장 초음파 영상의 분석 장치."}
{"patent_id": "10-2021-0185772", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제4항에 있어서,상기 제1 내지 제5 서브 네트워크는 콘볼루션 신경망 기반의 추출부 및 양방향 콘볼루션 LSTM 기반의 분석부를포함하는, 인공지능을 활용한 좌심실 비후 심장 초음파 영상의 분석 장치.공개특허 10-2023-0096358-3-청구항 6 제4항에 있어서,상기 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하는 것과 연관된 정보를 시각화한 클래스 활성화 맵을 제공하는 데이터 시각화부를 더 포함하는, 인공지능을 활용한좌심실 비후 심장 초음파 영상의 분석 장치."}
{"patent_id": "10-2021-0185772", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "대상자의 심장 초음파 영상을 입력받는 단계; 딥러닝 기반의 학습된 예측 모델을 통해 입력된 대상자의 심장 초음파 영상에 기초하여 상기 대상자의 고혈압성좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하는 단계를 포함하는, 인공지능을 활용한 좌심실 비후 심장 초음파 영상의 분석 방법."}
{"patent_id": "10-2021-0185772", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제7항에 있어서,상기 대상자는 좌심실 비후 증상이 보이는 것을 특징으로 하는, 인공지능을 활용한 좌심실 비후 심장 초음파 영상의 분석 방법."}
{"patent_id": "10-2021-0185772", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제7항에 있어서,상기 심장 초음파 영상은 흉골연장축단면 영상(PLAX), 흉골연단축단면 영상(PSAX), 심첨4방 영상(A4C), 심첨2방영상(A2C) 및 심첨3방 영상(A3C)을 포함하는, 인공지능을 활용한 좌심실 비후 심장 초음파 영상의 분석 방법."}
{"patent_id": "10-2021-0185772", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제9항에 있어서,상기 예측 모델은,입력된 흉골연장축단면 영상(PLAX)을 기초로 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장아밀로이드증 확률을 각각 산출하도록 학습된 제1 서브 네트워크, 입력된 흉골연단축단면 영상(PSAX)을 기초로대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하도록 학습된 제2 서브 네트워크, 입력된 심첨4방 영상(A4C)을 기초로 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하도록 학습된 제3 서브 네트워크, 입력된 심첨2방 영상(A2C)을기초로 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하도록 학습된 제4 서브 네트워크 및 입력된 심첨3방 영상(A3C)을 기초로 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하도록 학습된 제5 서브 네트워크를 포함하는 제1 네트워크; 및상기 제1 내지 제5 서브 네트워크의 출력들을 집합하고, 집합된 출력들을 분석하여 대상자의 고혈압성 좌심실비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하도록 구성되는 제2 네트워크를 포함하는, 인공지능을 활용한 좌심실 비후 심장 초음파 영상의 분석 방법. 공개특허 10-2023-0096358-4-청구항 11 제10항에 있어서,상기 제1 내지 제5 서브 네트워크는 콘볼루션 신경망 기반의 추출부 및 양방향 콘볼루션 LSTM 기반의 분석부를포함하는, 인공지능을 활용한 좌심실 비후 심장 초음파 영상의 분석 방법."}
{"patent_id": "10-2021-0185772", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제10항에 있어서,상기 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하는 것과 연관된 정보를 시각화한 클래스 활성화 맵을 제공하는 단계를 더 포함하는, 인공지능을 활용한 좌심실 비후심장 초음파 영상의 분석 방법."}
{"patent_id": "10-2021-0185772", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "제7항 내지 제12항 중 어느 한 항에 따른 인공지능을 활용한 좌심실 비후 심장 초음파 영상의 분석 방법을 구현하기 위한, 컴퓨터로 판독 가능한 기록 매체에 저장된 컴퓨터 프로그램."}
{"patent_id": "10-2021-0185772", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "인공지능을 활용한 좌심실 비후 심장 초음파 영상의 분석 장치 및 방법이 제공된다. 실시예에 따른 인공지능을 활용한 좌심실 비후 심장 초음파 영상의 분석 장치는 대상자의 심장 초음파 영상을 입력받는 입력부; 및 딥러닝 기반의 학습된 예측 모델로서, 입력된 대상자의 심장 초음파 영상에 기초하여 고혈압성 좌심실 비후 확률, 비후 성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하는 예측 모델을 포함한다."}
{"patent_id": "10-2021-0185772", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 인공지능을 활용한 좌심실 비후 심장 초음파 영상의 분석 방법 및 장치에 관한 것으로, 더욱 상세하 게는 딥러닝 기반의 예측 모델을 이용하여 좌심실 비후 소견을 보이는 대상자의 심장 초음파 영상을 분석하여 의료인이 좌심실 비후 원인 질환을 진단하는 것을 지원할 수 있는 시스템 및 방법에 관한 것입니다."}
{"patent_id": "10-2021-0185772", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "심장 초음파에서 관찰되는 좌심실 심근의 비후는 다양한 원인에 의해 발생할 수 있다. 임상적으로 가장 흔한 원 인은 고혈압으로서, 지속적인 후부하(afterload)의 증가로 인해 좌심실의 재형성(remodeling)이 발생하여 좌심 실의 구심성 비후(concentric hypertrophy)를 유발하고, 오랜 기간에 걸친 고혈압성 변화는 좌심실의 섬유화를 유발하는 것으로 알려져 있다. 좌심실의 비후를 유발하는 다른 원인질환으로 유전성 심장질환에 해당되는 비후 성 심근병증(hypertrophic cardiomyopathy; HCM)과 침윤성 심근병증(infiltrative cardiomyopathy)에 해당되는 심장 아밀로이드증(cardiac amyloidosis; CA) 등이 있다. 비후성 심근병증은 유전적 원인으로 인해 심근 세포의 disarray가 발생하면서 심근의 비후를 유발하고, 심부전과 치명적인 부정맥을 유발할 수 있으며, 확진을 위해 심장 MRI 검사 및 유전자 검사를 시행하는 것이 일반적이다. 심장 아밀로이드증의 경우, 임상에서 가장 흔히 접 하는 light chain 아밀로이드증 (AL amyloidosis)의 진단을 위해 혈청과 소변의 단백 면역 검사를 시행하고, 심 장 MRI와 심근 조직검사를 시행해야 한다. 좌심실 심근의 비후를 유발하는 고혈압성 좌심실 비후, 비후성 심근병증, 심장 아밀로이드증은 각각 임상 경과 와 치료 방침이 상이하기 때문에 감별 진단이 중요하며, 적절한 진단을 하지 못할 경우 급격한 악화를 보이며 불량한 예후를 보인다. 하지만, 이 질환들을 감별하고 확진하기 위해서는 심장 MRI와 유전자 검사 등의 고가의 여러 검사가 필요하기에 조기 진단이 어렵고, 환자의 진단에 소요되는 시간과 비용이 크게 발생한다는 문제가 있다. 최근 빠른 속도로 발전하고 있는 기계학습(machine learning) 기반 인공지능 기술로 인해, 환자들의 데이터를 활용하여 특정 질병의 발생을 예측하거나 관리하는 것이 가능해졌다. 특히, 기계학습 모델은 기존의 회귀 모델 (regression models)과 비교하여 많은 기능을 통합할 수 있으므로 비선형 알고리즘을 사용할 수 있게 하고, 그 결과 다양한 질병 발생 예측 분야에서 신경망(neural network) 모델과 같은 기계학습 방법을 채택한 다양한 연 구가 보고되고 있다. 이에, 본 출원의 발명자들은 딥러닝 기반의 예측 모델을 이용하여 좌심실 비후 소견을 보이는 대상자의 심장 초 음파 영상을 분석하여 의료인이 좌심실 비후 원인 질환을 진단하는 것을 지원할 수 있는 기술을 제안하고자 한다. 선행기술문헌 특허문헌 (특허문헌 0001) KR 10-2019-0069047"}
{"patent_id": "10-2021-0185772", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은, 딥러닝 기반의 예측 모델을 이용하여 좌심실 비후 소견을 보이는 대상자의 심장 초음파 영상을 분석 하여 의료인이 좌심실 비후 원인 질환을 진단하는 것을 지원할 수 있는 시스템 및 방법을 제공하는 것을 목적으 로 한다."}
{"patent_id": "10-2021-0185772", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명의 실시예에 따른 인공지능을 활용한 좌심실 비후 심장 초음파 영상의 분석 장치는 대상자의 심장 초음 파 영상을 입력받는 입력부; 및 딥러닝 기반의 학습된 예측 모델로서, 입력된 대상자의 심장 초음파 영상에 기 초하여 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하는 예측 모델 을 포함한다. 실시예에서, 상기 대상자는 좌심실 비후 증상이 보일 수 있다. 실시예에서, 상기 심장 초음파 영상은 흉골연장축단면 영상(parasternal long-axis view; PLAX), 흉골연단축단 면 영상(parasternal short-axis view; PSAX), 심첨4방 영상(apical 4-chamber view; A4C), 심첨2방 영상 (apical 2-chamber view; A2C) 및 심첨3방 영상(apical 3-chamber view; A3C)을 포함할 수 있다. 실시예에서, 상기 예측 모델은 입력된 흉골연장축단면 영상(PLAX)을 기초로 대상자의 고혈압성 좌심실 비후 확 률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하도록 학습된 제1 서브 네트워크, 입력된 흉골 연단축단면 영상(PSAX)을 기초로 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드 증 확률을 각각 산출하도록 학습된 제2 서브 네트워크, 입력된 심첨4방 영상(A4C)을 기초로 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하도록 학습된 제3 서브 네트워 크, 입력된 심첨2방 영상(A2C)을 기초로 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아 밀로이드증 확률을 각각 산출하도록 학습된 제4 서브 네트워크 및 입력된 심첨3방 영상(A3C)을 기초로 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하도록 학습된 제5 서 브 네트워크를 포함하는 제1 네트워크; 및 상기 제1 내지 제5 서브 네트워크의 출력들을 집합하고, 집합된 출력 들을 분석하여 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산 출하도록 구성되는 제2 네트워크를 포함할 수 있다. 실시예에서, 상기 제1 내지 제5 서브 네트워크는 콘볼루션 신경망 기반의 추출부 및 양방향 콘볼루션 LSTM 기반 의 분석부를 포함할 수 있다. 실시예에서, 상기 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하는 것과 연관된 정보를 시각화한 클래스 활성화 맵을 제공하는 데이터 시각화부를 더 포함할 수 있다. 본 발명의 실시예에 따른 인공지능을 활용한 좌심실 비후 심장 초음파 영상의 분석 방법은 대상자의 심장 초음 파 영상을 입력받는 단계; 딥러닝 기반의 학습된 예측 모델을 통해 입력된 대상자의 심장 초음파 영상에 기초하 여 상기 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하는 단계를 포함한다. 실시예에서, 상기 대상자는 좌심실 비후 증상이 보일 수 있다. 실시예에서, 상기 심장 초음파 영상은 흉골연장축단면 영상(PLAX), 흉골연단축단면 영상(PSAX), 심첨4방 영상 (A4C), 심첨2방 영상(A2C) 및 심첨3방 영상(A3C)을 포함할 수 있다.실시예에서, 상기 예측 모델은 입력된 흉골연장축단면 영상(PLAX)을 기초로 대상자의 고혈압성 좌심실 비후 확 률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하도록 학습된 제1 서브 네트워크, 입력된 흉골 연단축단면 영상(PSAX)을 기초로 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드 증 확률을 각각 산출하도록 학습된 제2 서브 네트워크, 입력된 심첨4방 영상(A4C)을 기초로 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하도록 학습된 제3 서브 네트워 크, 입력된 심첨2방 영상(A2C)을 기초로 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아 밀로이드증 확률을 각각 산출하도록 학습된 제4 서브 네트워크 및 입력된 심첨3방 영상(A3C)을 기초로 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하도록 학습된 제5 서 브 네트워크를 포함하는 제1 네트워크; 및 상기 제1 내지 제5 서브 네트워크의 출력들을 집합하고, 집합된 출력 들을 분석하여 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산 출하도록 구성되는 제2 네트워크를 포함할 수 있다. 실시예에서, 상기 제1 내지 제5 서브 네트워크는 콘볼루션 신경망 기반의 추출부 및 양방향 콘볼루션 LSTM 기반 의 분석부를 포함할 수 있다. 실시예에서, 상기 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하는 것과 연관된 정보를 시각화한 클래스 활성화 맵을 제공하는 단계를 더 포함할 수 있다.본 발명의 실시 예에 따른 컴퓨터 프로그램 상기 인공지능을 활용한 좌심실 비후 심장 초음파 영상의 분석 방법을 구현하기 위 한, 컴퓨터로 판독 가능한 기록 매체에 저장된다."}
{"patent_id": "10-2021-0185772", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "실시예에 따른 인공지능을 활용한 좌심실 비후 심장 초음파 영상의 분석 장치 및 방법은 딥러닝 기반의 예측 모 델을 이용하여 환자의 심장 초음파 영상으로부터 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀 로이드증 확률을 각각 산출할 수 있고, 예측 모델의 결과에 영향을 미치는 특징 변수들과 결과 간의 관계를 시 각적으로 나타내는 얼굴 영역의 클래스 활성화 맵을 제공하여 임상의에게 변수들이 예측 결과에 어떻게 영향을 미치는지에 대한 통찰력을 제공할 수 있다."}
{"patent_id": "10-2021-0185772", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하 첨부 도면들 및 첨부 도면들에 기재된 내용들을 참조하여 실시예를 상세하게 설명하지만, 청구하고자 하는 범위는 실시예들에 의해 제한되거나 한정되는 것은 아니다.본 명세서에서 사용되는 용어는 기능을 고려하면서 가능한 현재 널리 사용되는 일반적인 용어를 선택하였으나, 이는 당 분야에 종사하는 기술자의 의도 또는 관례 또는 새로운 기술의 출현 등에 따라 달라질 수 있다. 또한, 특정한 경우는 출원인이 임의로 선정한 용어도 있으며, 이 경우 해당되는 명세서의 설명 부분에서 그 의미를 기 재할 것이다. 따라서 본 명세서에서 사용되는 용어는, 단순한 용어의 명칭이 아닌 그 용어가 가지는 실질적인 의미와 본 명세서의 전반에 걸친 내용을 토대로 해석되어야 함을 밝혀두고자 한다. 또한, 본 명세서에 기술된 실시예는 전적으로 하드웨어이거나, 부분적으로 하드웨어이고 부분적으로 소프트웨어 이거나, 또는 전적으로 소프트웨어인 측면을 가질 수 있다. 본 명세서에서 \"부(unit)\", “모듈(module)\", \"장치 (device)\" 또는 \"시스템(system)\" 등의 용어는 하드웨어, 하드웨어와 소프트웨어의 조합, 또는 소프트웨어 등 컴퓨터 관련 엔티티(entity)를 지칭한다. 예를 들어, 부, 모듈, 장치 또는 시스템은 플랫폼(platform)의 일부 또는 전부를 구성하는 하드웨어 및/또는 상기 하드웨어를 구동하기 위한 애플리케이션(application) 등의 소프 트웨어를 지칭하는 것일 수 있다. 이하에서는 도면들을 참조하여 본 발명의 바람직한 실시예들에 대하여 상세히 살펴본다. 도 1은 일 실시예에 따른 심장 초음파 영상의 분석 장치의 구성을 나타낸 블록도이다. 도 2는 심장 초음파 영상 의 예시적인 화면을 도시한다. 도 3은 제1 네트워크의 예시적인 구조를 도시한다. 도 4는 양방향 콘볼루션 LSTM 계층의 예시적인 구조를 도시한다. 도 5는 제2 네트워크의 예시적인 구조를 도시한다. 좌심실 심근의 비후를 유발하는 주요 병증인 고혈압(Hypertensive heart disease, HHD), 비후성 심근병증 (Hypertrophic cardiomyopathy, HCM), 심장 아밀로이드증(Cardiac amyloidosis, CA)은 각각 임상 경과와 치료 방침이 상이하기 때문에 감별 진단이 중요하며, 적절한 진단을 하지 못할 경우 급격한 악화를 보이며 불량한 예 후를 보일 수 있다. 고혈압성 좌심실 비대 환자들은 혈압조절만으로 호전되고, 대체로 양호한 예후를 보이는 반 면, 비후성 심근병증 환자들은 환자의 상태에 따라 다양한 치료법을 적용해야 하고, 심장아밀로이드증 환자들은 항암치료 및 조혈모세포 이식(stem cell transplantation; SCT)과 같은 치료가 필요하다. 하지만 이러한 질환들을 감별하고 확진하기 위해서는 심장 MRI와 유전자 검사 등의 고가의 여러 검사가 필요하 고, 검사 결과가 모호한 경우도 종종 접하게 된다. 하지만 발생 기전 및 좌심실 비후의 기전이 뚜렷한 차이를 보이기 때문에, 심장 초음파 영상만으로도 차이를 보일 가능성이 있다. 심근의 조직학적 차이는 심장 초음파의 에코 반향에 영향을 주어 심장 초음파 영상에서의 심근의 조직(texture) 및 움직임에 영향을 주게 된다. 하지만, 심장 초음파 영상을 육안으로 평가하여 좌심실 비후를 감별 진단하는 방식은 전문 의료인의 오랜 기간 수련과 임상 경험을 필요하다. 심장 초음파 영상을 육안으로 평가할 때에는 고혈압(Hypertensive heart disease, HHD), 비후성 심근병증 (Hypertrophic cardiomyopathy, HCM), 심장 아밀로이드증(Cardiac amyloidosis, CA)에 대한 감별 진단이 쉽지 않지만, 실제 영상에서는 미세한 차이가 존재할 가능성이 높으며, 인공지능을 통한 분석이 도움이 될 수 있는 대표적인 영역에 해당한다. 본 발명의 실시예에 따른 인공지능을 활용한 좌심실 비후 심장 초음파 영상의 분석 방법 및 장치는 입력된 대상 자의 심장 초음파 영상에 기초하여 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률 을 각각 산출하는 예측 모델을 통해 대상자의 감별 진단을 지원할 수 있다. 이에 따라, 환자의 진단에 소요되는 시간과 비용을 크게 절감할 수 있으며, 조기에 적절한 치료를 적용할 수 있게 되어 예후를 개선시키는 데에도 기여할 수 있다. 도 1 내지 도 5를 참조하면, 실시예에 따른 심장 초음파 영상의 분석 장치은 데이터 입력부 및 예측 모델을 포함한다. 데이터 입력부는 대상자의 심장 초음파 영상을 입력 받는다. 여기서, 대상자는 좌심실 비후 증상을 보이는 상태로, 좌심실 비후를 유발한 질환의 파악과 이에 대한 적절한 치료가 필요한 환자일 수 있다. 대상자는 심장 초음파 검사 장치를 통해 심장 초음파 검사를 수행하게 된다. 심장 초음파 검사 장치는 초음파 프로브를 포함하 며, 초음파 프로브를 대상자에게 송신하고 대상자로부터 반사된 초음파 에코 신호를 수신하며, 초음파 에코 신 호를 아날로그/디지털 변환을 통해 심장 초음파 영상으로 생성할 수 있다. 대상자의 한번의 심장 주기(cardiac cycle)에 대응되도록 심장 초음파 영상이 생성될 수 있다. 여기서, 심장 초 음파 검사 장치가 접촉되는 대상자의 신체의 위치에 따라 생성되는 심장 초음파 영상의 유형이 달라질 수 있다. 대상자의 흉곽의 전면부에서 심장의 장축에 평행한 방향으로 프로브를 위치하여 흉골연장축단면도 영상(PLAX)을획득하고, 대상자의 흉곽의 전면부에서 심장의 장축에 수직 방향으로 프로브를 위치하여 흉골연단축단면 영상 (PSAX)을 획득할 수 있다. 또한, 대상자의 흉곽의 좌측 하단에서 심장의 끝부분, 심첨부(apex) 방향으로 프로브 를 위치하여 영상을 생성할 수 있다. 심첨4방 영상(A4C)는 심장의 4개 챔버(좌심방, 좌심실, 우심방, 우심실)가 모두 보이도록 획득하는 영상이며, 심첨2방 영상(A2C)는 심장의 2개 챔버(좌심방, 좌심실)가 보이도록 회전시켜 서 획득하는 영상이고, 심첨3방 영상(A3C)는 심장의 3개 챔버(좌심방, 좌심실, 대동맥)이 보이도록 회전시켜서 획득하는 영상이다. 심장 초음파 검사 장치로부터 생성된 심장 초음파 영상은 데이터 입력부로 제공될 수 있다. 데이터 입력부 가 입력받는 심장 초음파 영상은 흉골연장축단면 영상(PLAX), 흉골연단축단면 영상(PSAX), 심첨4방 영상 (A4C), 심첨2방 영상(A2C) 및 심첨3방 영상(A3C)을 포함한다. 예측 모델은 딥러닝 기반의 미리 학습된 예측 모델로서, 입력된 심장 초음파 영상에 기초하여 대상자의 고 혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하도록 미리 학습된 상태 일 수 있다. 예측 모델은 제1 네트워크와 제2 네트워크를 포함한다. 제1 네트워크는 흉골연장축단면 영 상(PLAX), 흉골연단축단면 영상(PSAX), 심첨4방 영상(A4C), 심첨2방 영상(A2C) 및 심첨3방 영상(A3C) 각각을 기 초로 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하도록 구성될 수 있다. 구체적으로, 제1 네트워크는 입력된 흉골연장축단면 영상(PLAX)을 기초로 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하도록 학습된 제1 서브 네트워크(112A), 입 력된 흉골연단축단면 영상(PSAX)을 기초로 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하도록 학습된 제2 서브 네트워크(112B), 입력된 심첨4방 영상(A4C)을 기초로 대 상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하도록 학습된 제3 서브 네트워크(112C), 입력된 심첨2방 영상(A2C)을 기초로 대상자의 고혈압성 좌심실 비후 확률, 비후성 심 근병증 확률, 심장 아밀로이드증 확률을 각각 산출하도록 학습된 제4 서브 네트워크(112D) 및 입력된 심첨3방 영상(A3C)을 기초로 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각 각 산출하도록 학습된 제5 서브 네트워크(112E)를 포함할 수 있다. 제1 내지 제5 서브 네트워크(112A 내지 112E) 각각은 선택된 복수의 심장 초음파 이미지의 특징 벡터를 추출하 는 추출부, 추출된 특징 벡터 사이의 시계열적인 관계를 분석하여 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하도록 구성되는 분석부를 포함할 수 있다. 여기서, 추출부는 이미지 데이터와 같은 2차원 데이터의 학습에 적합한 콘볼루션 신경망(Convolution Neural Network, CNN)을 이용하여 구현될 수 있다. 복수의 심장 초음파 영상은 시계열적으로 연결된 정지 이미지에 해 당하는 복수의 심장 초음파 이미지로 구성된다. 이러한, 복수의 심장 초음파 이미지, 정지 이미지를 기준으로 분석이 수행될 수 있다. 추출부를 구성하는 CNN의 개수에 대응하는 개수로 입력되는 심장 초음파 영상에서 심장 초음파 이미지가 선택될 수 있다. 제1 내지 제5 서브 네트워크(112A 내지 112E) 각각은 대응되어 입력되는 심장 초음파 영상에서 일정 프레임 간 격을 기준으로 복수의 심장 초음파 이미지를 선택할 수 있다. 즉, 제1 서브 네트워크(112A)는 흉골연장축단면 영상(PLAX)에서 복수의 심장 초음파 이미지를 선택하고, 제2 서브 네트워크(112B)는 입력된 흉골연단축단면 영 상(PSAX)에서 복수의 심장 초음파 이미지를 선택하며, 제3 서브 네트워크(112C)는 입력된 심첨4방 영상(A4C)에 서 복수의 심장 초음파 이미지를 선택하고, 제4 서브 네트워크(112D)는 입력된 심첨 2방 영상(A2C)에서 복수의 심장 초음파 이미지를 선택하며, 제5 서브 네트워크(112E)는 입력된 심첨3방 영상(A3C)에서 복수의 심장 초음파 이미지를 선택할 수 있다. 또한, 제1 내지 제5 서브 네트워크(112A 내지 112E) 각각은 선택된 복수의 심장 초음 파 이미지를 네트워크 입력에 적합한 크기로 크롭핑하고, 해상도를 조절하는 전처리를 더 수행할 수 있다. 추출부의 CNN에서 추출된 특징 벡터는 분석부로 입력될 수 있다. 분석부는 양방향 콘볼루션 LSTM 계층을 포함하 도록 구성될 수 있으며, 양방향 콘볼루션 LSTM 계층에서 출력되는 결과에 따라, 고혈압성 좌심실 비후 확률, 비 후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 출력할 수 있다. 도 2를 참조하면, 제1 서브 네트워크(112A)는 CNN의 개수인 12개에 대응하도록 입력된 흉골연장축단면 영상 (PLAX)에서 12개의 심장 초음파 이미지를 선택할 수 있다. 선택된 12개의 심장 초음파 이미지는 동일한 프레임 간격을 가질 수 있으며, 하나의 심장 주기를 구성하는 이미지로서 시계열적인 특징을 공유할 수 있다. 도 3을 참조하면, 도 2에서 선택된 12개의 심장 초음파 이미지가 각각의 콘볼루션 신경망(CNN)에 입력되며, 각 이미지의 특징 벡터가 추출되어 양방향 콘볼루션 LSTM 계층으로 입력되는 것을 알 수 있다. LSTM 계층 또한 입 력되는 특징 벡터의 수에 대응하는 복수의 LSTM 셀을 포함할 수 있다. LSTM 계층은 이전 LSTM 셀에서 출력된 출력 값은 다음 LSTM 셀이 입력으로 수신하도록 구성된 구조이다. 즉, 이 전 단계에서의 LSTM 셀의 출력 값이 다음 단계의 LSTM 셀로 입력되므로 복수의 특징 벡터들의 시계열적인 특징 이 추출될 수 있다. 여기서, 본 실시예에 따른 분석부는 양방향 콘볼루션 LSTM 계층으로 구성되므로, 도 4에 도 시된 바와 같이, 상술한 순방향과 반대인 역방향을 따라 연결된 LSTM 셀을 더 포함할 수 있다. 즉, 복수의 특징 벡터는 순방향에 따른 LSTM 셀과 역방향에 따른 LSTM 셀에 순차적으로 입력될 수 있으며, 이전 LSTM 셀의 출력 값도 입력받을 수 있다. 최종적으로, N개의 LSTM 셀이 구성된 경우, 순방향의 t번째 LSTM 셀과 역방향의 N-t 번 째 LSTM 셀의 출력이 조합(concatenation)되어 특징맵으로 출력될 수 있다. 분석부는 양방향 콘볼루션 LSTM 계층에서 출력된 특징맵을 입력받고 이의 공간을 축소하여 결과를 출력하는 글 로벌 평균 풀링 계층(Global average pooling), 글로벌 평균 풀링 계층에서 출력되는 결과를 기초로 클래스(고 혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률)를 분류하는 전연결층(Fully connected layer) 및 전열결층과 연결되어 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드 증 확률값을 각각 출력하는 활성화 함수 계층을 포함한다. 활성화 함수 계층에서 가장 높은 값을 가진 클래스가 대상자의 심장 초음파 영상을 통해 예측된 대상자의 질병에 해당한다. 제1 내지 제5 서브 네트워크(112A 내지 112E)는 예측하고자 하는 클래스의 이미지를 추정하도록 파라미터가 최 적화된 상태일 수 있다. 예시적으로, 제1 내지 제5 서브 네트워크(112A 내지 112E)는 교차 엔트로피 손실(Cross Entropy Loss) 함수와 RMSprop 최적화(Root Mean Square Propagation)을 통해 학습될 수 있다. 제1 내지 제5 서브 네트워크(112A 내지 112E)를 통해서도 입력된 대상자의 심장 초음파 영상에 따른 대상자의 질병의 예측이 가능할 수 있다. 여기서, 본 실시예에 따른 예측 모델은 더욱 정확한 예측 결과의 출력을 위해 제2 네트워크가 구성된다. 제2 네트워크는 제1 내지 제5 서브 네트워크(112A 내지 112E)의 출력 들을 집합하고, 집합된 출력들을 기초로 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아 밀로이드증 확률을 각각 산출하도록 구성될 수 있다. 도 5를 참조하면, 제2 네트워크는 집합 네트워크(Aggregate network)로 구성될 수 있다. 제2 네트워크 는 제1 네트워크의 각 서브 네트워크의 글로벌 평균 풀링 계층으로부터 결과를 모두 수신하고, 조합 (Concatenate)된 결과를 생성하는 조합 계층(Concatenate), 조합 계층에서 출력되는 결과를 기초로 클래스(고혈 압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률)를 분류하는 전연결층(Fully connected layer) 및 전열결층과 연결되어 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률값 을 각각 출력하는 활성화 함수 계층을 포함한다. 즉, 제2 네트워크를 통해 5개 뷰에 따른 심장 초음파 영 상(PLAX, PSAX, A4C, A2C, A3C)에 대한 통합적인 분석 및 이에 따른 좌심실 비후의 원인의 감별이 더욱 정확하 게 수행될 수 있다. 인공지능 기술의 발전으로 인해 질환 예측 시스템들의 성능은 향상되고 있지만 신경망 모델의 블랙박스 특성으 로 인해 현장 의료진의 임상의사 결정에 직접적인 도움을 주는 것에 한계가 존재한다. 이는 기계학습 기반 모델 이 복잡한 다중 은닉 계층과 가중치 매개 변수를 통해 한 번에 많은 양의 입력 데이터를 처리하기 때문에 사용 자가 어떠한 기준과 방식으로 결과가 도출되었는지 해석하기 어렵기 때문이다. 이는 사용자가 예측 모델의 결과 를 전적으로 신뢰할 수 없게 하고, 단순한 수치의 나열만으로는 의료진이 어떠한 조치를 취해야 하는지 결정하 기 어렵게 만들기 때문이다. 따라서 실제 의료 현장에서 예측 결과를 적용하려면 임상의가 예측 모델의 위험 평가가 어떻게 도출되는지에 대 해 파악할 수 있는 자료, 특히, 시각화된 자료가 필요하다. 이에, 본 발명의 실시예에 따른 인공지능을 활용한 좌심실 비후 심장 초음파 영상의 분석 장치은 예측 모델의 결과를 해석할 수 있도록 하고 직관적인 분석을 제공하여 임상의사 결정을 지원할 수 있는 시각화된 자료를 더 제공할 수 있다. 예측 모델은 데이터 시각화부를 더 포함할 수 있다. 데이터 시각화부는 대상자의 고혈압성 좌심 실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하는 것과 연관된 정보를 시각화한 클래스 활성화 맵을 제공할 수 있다. 데이터 시각화부는 제1 네트워크의 각각의 서브 네트워크의 추 출부와 분석부가 결과를 얻기 위해 특정 레이어의 어떤 위치에 있는 특징들을 이용했는지 확인한 정보를 시각화 하여 제공할 수 있다. 또한, 데이터 시각화부는 제2 네트워크가 결과를 얻기 위해 특정 레이어의 어떤 위치에 있는 특징들을 이용했는지 확인한 정보를 시각화하여 제공할 수 있다. 데이터 시각화부는 결과 값(class score)과 추출부의 최종 피처 맵 사이의 변화량을 추적하여, 입력된 심장 초음파 영상과 동일한 크기 를 갖는 히트맵(heatmap)을 생성할 수 있으며, 생성된 히트맵을 원본 심장 초음파 영상과 함께 표시한 클래스 활성화 맵(CAM, Class Activation Map)을 시각화한 정보로서 제공할 수 있다. 일 실시예에서, 데이터 시각화부 는 Grad-CAM(Gradient-weighted class activation mapping)을 통해 히트맵을 생성할 수 있다. Grad-CAM은 신경망이 결과를 얻기 위해 특정 레이어의 어떤 위치에 있는 특징들을 이용했는지 확인할 수 있는 시각화 방법 으로서, 그래디언트(gradients)를 사용하여 컨볼루션 레이어들에서 활성화된 공간 영역(spatial region)을 나타 낼 수 있다. 상술한 과정을 통해 생성된 히트맵에서 강조되는 영역은 컨볼루션 레이어들에서 활성화된 공간 영 역에 해당한다. 예시적으로, 히트맵은 활성화된 공간 영역을 적색으로 표시할 수 있으며, 비활성화된 공간 영역 을 청색으로 나타낼 수 있으며, 이의 사이 영역은 적색과 청색 사이의 색상 그라데이션을 나타낼 수 있다. 생성 된 히트맵을 원본 심장 초음파 영상과 함께 표시한 클래스 활성화 맵(CAM, Class Activation Map)을 통해 원본 심장 초음파 영상에서 신경망이 중요하게 고려하는 영역의 확인이 가능하다. 도 6은 본 발명의 실시예에 따른 인공지능을 활용한 좌심실 비후 심장 초음파 영상의 분석 방법의 각 단계를 나 타내는 순서도이다. 각 단계의 일부 또는 전부는 컴퓨터 프로그램으로 구현될 수 있으며, 컴퓨터 프로세서에 의 해 실행될 수 있다. 인공지능을 활용한 좌심실 비후 심장 초음파 영상의 분석 방법은 심장 초음파 영상의 분석 장치에서 수행될 수 있으며, 본 실시예의 설명을 위해 도 1 내지 도 5, 관련된 설명 내용이 참조될 수 있다. 도 6을 참조하면, 본 발명의 실시예에 따른 인공지능을 활용한 좌심실 비후 심장 초음파 영상의 분석 방법은 대 상자의 심장 초음파 영상을 입력 받는 단계(S100); 및 상기 입력된 심장 초음파 영상에 따른 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 딥러닝 기반의 미리 학습된 예측 모델을 통해 각각 산출하는 단계(S110)를 포함한다. 먼저, 대상자의 심장 초음파 영상을 입력 받는다(S100). 여기서, 대상자는 좌심실 비후 증상을 보이는 상태로, 좌심실 비후를 유발한 질환의 파악과 이에 대한 적절한 치료가 필요한 환자일 수 있다. 심장 초음파 검사 장치로부터 생성된 심장 초음파 영상은 데이터 입력부로 제공될 수 있다. 데이터 입력부가 입력받는 심장 초음파 영상은 흉골연장축단면 영상(PLAX), 흉골연단축단 면 영상(PSAX), 심첨4방 영상(A4C), 심첨2방 영상(A2C) 및 심첨3방 영상(A3C)을 포함한다. 다음으로, 상기 입력된 심장 초음파 영상에 따른 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 딥러닝 기반의 미리 학습된 예측 모델을 통해 각각 산출한다(S110). 본 단계(S110)에서, 예측 모델은 딥러닝 기반의 미리 학습된 예측 모델로서, 입력된 심장 초음파 영상에 기초하여 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출한 다. 예측 모델은 입력된 흉골연장축단면 영상(PLAX)을 기초로 대상자의 고혈압성 좌심실 비후 확률, 비후 성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하도록 학습된 제1 서브 네트워크, 입력된 흉골연단축단 면 영상(PSAX)을 기초로 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률 을 각각 산출하도록 학습된 제2 서브 네트워크, 입력된 심첨4방 영상(A4C)을 기초로 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하도록 학습된 제3 서브 네트워크, 입력 된 심첨2방 영상(A2C)을 기초로 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드 증 확률을 각각 산출하도록 학습된 제4 서브 네트워크 및 입력된 심첨3방 영상(A3C)을 기초로 대상자의 고혈압 성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하도록 학습된 제5 서브 네트 워크를 포함하는 제1 네트워크; 및 상기 제1 내지 제5 서브 네트워크의 출력들을 집합하고, 집합된 출력들을 분 석하여 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하도 록 구성되는 제2 네트워크를 포함한다. 구체적으로, 제1 네트워크의 제1 내지 제5 서브 네트워크를 통해 각각의 결과 값이 산출된 이후, 제2 네트워크 를 통해 종합적인 결과 값이 산출될 수 있다. 실시예에서, 제1 내지 제5 서브 네트워크(112A 내지 112E) 각각은 선택된 복수의 심장 초음파 이미지의 특징 벡터를 추출하는 추출부, 추출된 특징 벡터 사이의 시계열적인 관계 를 분석하여 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출 하도록 구성되는 분석부를 포함할 수 있다. 여기서, 추출부는 이미지 데이터와 같은 2차원 데이터의 학습에 적 합한 콘볼루션 신경망(Convolution Neural Network, CNN)을 이용하여 구현될 수 있다. CNN은 선택된 복수의 심 장 초음파 이미지 각각에 대응하도록 구성될 수 있다. 추출부의 CNN에서 추출된 특징 벡터는 분석부로 입력될수 있다. 분석부는 양방향 콘볼루션 LSTM 계층을 포함하도록 구성될 수 있으며, 양방향 콘볼루션 LSTM 계층에서 출력되는 결과에 따라, 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 출 력할 수 있다. 제2 네트워크는 집합 네트워크(Aggregate network)로 구성될 수 있다. 제2 네트워크는 제1 네트워크 의 각 서브 네트워크의 글로벌 평균 풀링 계층으로부터 결과를 모두 수신하고, 조합(Concatenate)된 결과 를 생성하는 조합 계층(Concatenate), 조합 계층에서 출력되는 결과를 기초로 클래스(고혈압성 좌심실 비후 확 률, 비후성 심근병증 확률, 심장 아밀로이드증 확률)를 분류하는 전연결층(Fully connected layer) 및 전열결층 과 연결되어 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률값을 각각 출력하는 활 성화 함수 계층을 포함한다. 즉, 제2 네트워크를 통해 5개 뷰에 따른 심장 초음파 영상(PLAX, PSAX, A4C, A2C, A3C)에 대한 통합적인 분석 및 이에 따른 좌심실 비후의 원인의 감별이 더욱 정확하게 수행될 수 있다. 도 6을 참조하면, 본 발명의 실시예에 따른 방법은, 상기 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병 증 확률, 심장 아밀로이드증 확률을 각각 산출하는 것과 연관된 정보를 시각화한 클래스 활성화 맵을 제공하는 단계(S120)를 더 포함할 수 있다. 본 단계(S120)에서, 제1 네트워크의 각각의 서브 네트워크의 추출부와 분석부가 결과를 얻기 위해 특정 레이어의 어떤 위치에 있는 특징들을 이용했는지 확인한 정보가 시각화되어 제 공될 수 있다. 또한, 제2 네트워크가 결과를 얻기 위해 특정 레이어의 어떤 위치에 있는 특징들을 이용했 는지 확인한 정보가 시각화되어 제공될 수 있다. 결과 값(class score)과 추출부의 최종 피처 맵 사이의 변화량 을 추적하여, 입력된 심장 초음파 영상과 동일한 크기를 갖는 히트맵(heatmap)이 생성될 수 있으며, 생성된 히 트맵을 원본 심장 초음파 영상과 함께 표시한 클래스 활성화 맵(CAM, Class Activation Map)을 시각화한 정보로 서 제공될 수 있다. 이러한 실시예들에 따른 인공지능을 활용한 좌심실 비후 심장 초음파 영상의 분석 방법은, 애플리케이션으로 구 현되거나 다양한 컴퓨터 구성요소를 통하여 수행될 수 있는 프로그램 명령어의 형태로 구현되어 컴퓨터 판독 가 능한 기록 매체에 기록될 수 있다. 상기 컴퓨터 판독 가능한 기록 매체는 프로그램 명령어, 데이터 파일, 데이 터 구조 등을 단독으로 또는 조합하여 포함할 수 있다. 컴퓨터 판독 가능한 기록 매체의 예에는, 하드 디스크, 플로피 디스크 및 자기 테이프와 같은 자기 매체, CD- ROM, DVD와 같은 광기록 매체, 플롭티컬 디스크(floptical disk)와 같은 자기-광 매체(magneto-optical media), 및 ROM, RAM, 플래시 메모리 등과 같은 프로그램 명령어를 저장하고 수행하도록 특별히 구성된 하드웨 어 장치가 포함된다. 프로그램 명령어의 예에는, 컴파일러에 의해 만들어지는 것과 같은 기계어 코드뿐만 아니라 인터프리터 등을 사 용해서 컴퓨터에 의해서 실행될 수 있는 고급 언어 코드도 포함된다. 상기 하드웨어 장치는 본 발명에 따른 처 리를 수행하기 위해 하나 이상의 소프트웨어 모듈로서 작동하도록 구성될 수 있으며, 그 역도 마찬가지이다. 실험예 상술한 실시예에 따른 인공지능을 활용한 좌심실 비후 심장 초음파 영상의 분석 장치 및 방법의 예측 모델을 여 러 학습 데이터를 통해 구축하고, 구축된 예측 모델을 검증하는 실험을 수행하였다. 분당서울대학교병원 및 서울대학교병원에서 대상 환자군을 선별하였으며, 최종 930명[고혈압성 좌심실 비후 (HHD) 112명, 비후성 심근병증(HCM) 191명, 심장 아밀로이드증(CA) 81명, 정상 대조군(Normal) 546명]이 분석 에 포함되었다. 상기 환자군의 흉골연장축단면도(PLAX), 흉골연단축단면도(PSAX), 심첨4방도(A4C), 심첨2방도 (A2C), 심첨3방도(A3C)의 심장 초음파 영상을 DICOM(Digital Imaging and Communications in Medicine) 서식으 로 준비하였다. 심장 초음파 영상은 1 cardiac cycle로 한정하여 추출하였고, 930명의 환자에서 5개 뷰를 각각 1 cardiac cycle씩 추출하여, 전체 4650개의 동영상을 확보하였다. 전체 환자군을 6개의 그룹으로 나누어, 그룹 1 내지 4는 학습 세트(training set)로, 그룹 5는 조정 세트 (validation set)으로, 그룹 6은 테스트 세트(test set)로 활용하였으며, 표 1과 같이 분류되었다. 표 1을 참조 하면, 각 그룹의 환자 수는 155명으로 동일하게 배분하였으며, 각각의 그룹 에 정상 대조군(Normal), 고혈압성 좌심실 비후(HHD), 비후성 심근병증(HCM), 심장 아밀로이드증(CA) 분포 역시 유의한 차이가 없도록 배정하였다.표 1 그룹 데이터 분류 Normal HHD HCM CA 1 학습 세트 91 19 32 13 2 91 19 32 13 3 91 18 32 14 4 91 19 31 14 5 조정 세트 91 19 32 13 6 테스트 세트 91 18 32 14 합계 (n=930) 545 112 191 81 예측 모델은 제1 내지 제5 서브 네트워크를 포함하는 제1 네트워크와 제1 내지 제5 서브 네트워크의 출력을 입 력받고 종합적인 결과를 출력하는 제2 네트워크, 및 클래스 활성화 맵을 출력하는 데이터 시각화부로 구성되었 다. 실험예에서, 제1 서브 네트워크는 흉골연장축단면 영상(PLAX)을 기초로 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하도록 학습되었고, 제2 서브 네트워크는 흉골연단 축단면 영상(PSAX)을 기초로 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하도록 학습되었으며, 제3 서브 네트워크는 심첨4방 영상(A4C)을 기초로 대상자의 고혈압성 좌 심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하도록 학습되었고, 제4 서브 네트 워크는 심첨2방 영상(A2C)을 기초로 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로 이드증 확률을 각각 산출하도록 학습되었으며, 제5 서브 네트워크는 심첨3방 영상(A3C)을 기초로 대상자의 고혈 압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하도록 학습되었다. 제1 내 지 제5 서브 네트워크 각각은 콘볼루션 신경망 기반의 추출부와 양방향 콘볼루션 LSTM 계층 기반의 분석부로 구 성되었다. 각 서브 네트워크에서 콘볼루션 신경망은 12개로 구성되었으며, 1개의 심장 초음파 영상에서 같은 프 레임 간격으로 12장의 정지 이미지가 추출되었다. 또한, 추출된 영상은 12×12cm2 크기로 크롭핑(cropping)하였 으며, 256×256 픽셀의 해상도로 조정하였다. 실험예에서, 제2 서브 네트워크는 제1 내지 제5 서브 네트워크의 출력들을 집합하고, 집합된 출력들을 분석하여 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하도록 학습 되며, 집합 네트워크(Aggregate network)로 구성되었다. 실험예에서, 데이터 시각화부는 제1 네트워크의 각각의 서브 네트워크의 추출부와 분석부가 결과를 얻기 위해 특정 레이어의 어떤 위치에 있는 특징들을 이용했 는지 확인한 정보를 클래스 활성화 맵으로 출력하도록 학습되었다. 실험 1: AUC 값 평가 상기와 같이 구축한 예측 모델의 성능 평가를 위해, 4개의 감별에 대한 Area under the ROC curve (AUC) 값을 평가하였으며, 이에 대한 결과가 하기 표 2와 같이 나타났다. 표 2 조정 세트 테스트 세트 네트워크 종류AUC For HHDAUC For HCMAUC For CAAUC For HHDAUC For HCMAUC For CA PLAX (제1 서브 네트 워크)0.954 0.974 0.976 0.949 0.968 0.951 PSAX(제2 서브 네트워크)0.894 0.970 0.871 0.892 0.959 0.929 A4C(제3 서브 네트워크)0.931 0.954 0.953 0.908 0.973 0.989A2C(제4 서브 네트워크)0.905 0.925 0.916 0.917 0.974 0.978 A3C(제5 서브 네트워크)0.908 0.983 0.924 0.907 0.937 0.986 Aggregate(제2 네트워크)0.958 0.988 0.993 0.962 0.982 0.996 5개의 심장 초음파 영상(PLAX, PSAX, A4C, A2C, A3C) 각각을 분석하는 제1 내지 제5 서브 네트워크는 좌심실 비 후의 주된 원인 감별에 대해 우수한 정확도를 보였으며, 이를 취합한 제2 네트워크의 결과는 더 우수한 것으로 확인되었다. 제2 네트워크는 테스트 세트에서 고혈압성 좌심실 비후(HHD)에 대한 AUC가 0.962, 비후성 심근병증 에 대한 AUC가 0.982, 심장 아밀로이드증(CA)에 대한 AUC가 0.996으로 매우 정확한 결과를 출력하는 것이 확인 되었다. 실험 2: 컨퓨젼 매트릭스(Confusion matrix) 도 7a 내지 도 7c는 본 실험예에 따른 예측 모델의 감별 정확도와 심장 초음파 전문의 감별 정확도를 비교하여 확인한 컨퓨젼 매트릭스를 나타낸다. 도 7a를 참조하면, 테스트 세트로 예측 모델을 평가한 결과, 정확도는 92.3%, Cohen's kappa 계수는 0.869 로 확인되었다. 심장 초음파 전문의 2명에서 동일한 test set 영상들을 대상으로 진단을 수행하였다. 도 7b를 참조 하면, 심장 초음파 전문의 #1의 진단 정확도는 80.0%, Cohen's kappa 계수 0.674로 나타났다. 도 7c를 참조하면, 심장 초음파 전문의 #2의 진단 정확도는 80.6%, Cohen's kappa 계수는 0.687로 확인되었다. 본 실시 예에 따른 예측 모델이 심장 초음파 전문의의 진단보다 상회하는 감별 정확도를 나타내는 것을 확인할 수 있다. 즉, 본 실시예에 따른 예측 모델은 심장 초음파 전문의가 초음파 영상을 통해 대상자의 원인 질환을 진단하는 것을 충분히 지원할 수 있는 것을 확인할 수 있다. 이에 따라, 환자의 진단에 소요되는 시간과 비용을 크게 절 감할 수 있으며, 조기에 적절한 치료를 적용할 수 있게 되어 예후를 개선시키는 데에도 기여할 수 있는 것을 확 인할 수 있다. 실험 3: 클래스 활성화 맵 도 8a 내지 도 8o은 제1 내지 제5 서브 네트워크의 결과 도출에 관여한 영역을 도시한 클래스 활성화 맵을 예시 적으로 도시한다. 각각의 도면에는 입력된 심장 초음파 영상에 대응하여 상기 대상자의 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출하는 것과 연관된 정보를 시각화한 클래스 활 성화 맵이 도시되어있다. 도 8a 내지 도 8c는 제1 서브 네트워크, 즉, 흉골연장축단면 영상(PLAX)에 대해 클래스 활성화 맵을 도시하며, 도 8a는 고혈압성 좌심실 비후증(HHD)이 가장 높은 확률, 도 8b는 비후성 심근병증(HCM)이 가장 높은 확률, 도 8c는 심장 아밀로이드증(CA)이 가장 높은 확률로 나타난 상태이다. 도 8d 내지 도 8f는 제2 서브 네트워크, 즉, 흉골연단축단면 영상(PSAX)에 대해 클래스 활성화 맵을 도시하며, 도 8d는 고혈압성 좌심실 비후증(HHD)이 가장 높은 확률, 도 8e는 비후성 심근병증(HCM)이 가장 높은 확률, 도 8f는 심장 아밀로이드증(CA)이 가장 높은 확률로 나타난 상태이다. 도 8g 내지 도 8i는 제3 서브 네트워크, 즉, 심첨4방 영상(A4C)에 대해 클래스 활성화 맵을 도시하며, 도 8g는 고혈압성 좌심실 비후증(HHD)이 가장 높은 확률, 도 8e는 비후성 심근병증(HCM)이 가장 높은 확률, 도 8h는 심 장 아밀로이드증(CA)이 가장 높은 확률로 나타난 상태이다. 도 8i는 심장 아밀로이드증(CA)이 가장 높은 확률로 나타난 상태이다. 도 8j 내지 도 8l는 제4 서브 네트워크, 즉, 심첨2방 영상(A2C)에 대해 클래스 활성화 맵을 도시하며, 도 8j는 고혈압성 좌심실 비후증(HHD)이 가장 높은 확률, 도 8e는 비후성 심근병증(HCM)이 가장 높은 확률, 도 8k는 심 장 아밀로이드증(CA)이 가장 높은 확률로 나타난 상태이다. 도 8l는 심장 아밀로이드증(CA)이 가장 높은 확률로 나타난 상태이다. 도 8m 내지 도 8o는 제5 서브 네트워크, 즉, 심첨3방 영상(A3C)에 대해 클래스 활성화 맵을 도시하며, 도 8m는 고혈압성 좌심실 비후증(HHD)이 가장 높은 확률, 도 8n는 비후성 심근병증(HCM)이 가장 높은 확률, 도 8o는 심 장 아밀로이드증(CA)이 가장 높은 확률로 나타난 상태이다. 클래스 활성화 맵에서는 활성화된 부위가 밝게 표시되는데, 일반적으로 좌심실 비후 환자들의 심장 초음파 영상 에서 감별진단에 도움이 되는 것으로 알려져 있는 특징적인 심장 초음파 소견들이 클래스 활성화 맵에서 활성화 되는 양상이 확인되었다. 고혈압성 좌심실 비후(HHD)가 발생한 환자는 이전 연구들을 통해 좌심실과 우심실의 연접부위(Right ventricular insertion point) 및 대동맥의 확장 정도 등이 감별진단에 활용될 수 있다고 알려져 있다. 도 8a, 도 8d, 도 8g, 도 8j 및 도 8m에서 확인되는 바와 같이, 해당 부위가 활성화되는 특성을 보여서, 이전 연구들에 서 제시된 형태학적 특성이 본 실시예에 따른 예측 모델에서 확인되는 것을 알 수 있다. 비후성 심근병증(HCM)은 심실 중격과 후벽이 특징적으로 두꺼워지게 된다. 도 8b, 도 8e, 도 8h, 도 8k 및 도 8n에서 확인되는 바와 같이, 해당 부위가 활성화되는 특성을 보여서, 비후성 심근병증의 형태학적 특성이 본 실 시예에 따른 예측 모델에서 확인되는 것을 알 수 있다. 심장 아밀로이드증(CA) 환자들의 심초음파 영상에서는 좌심실의 에코 음영(echogenicity)이 전반적으로 증가하 면서 판막과 좌심방이 두꺼워지고, 소량의 심낭삼출을 동반되게 된다. 도 8c, 도 8f, 도 8i, 도 8l 및 도 8o에 서 확인되는 바와 같이, 해당 부위가 활성화되는 특성을 보여서, 심장 아밀로이드증의 형태학적 특성이 본 실시 예에 따른 예측 모델에서 확인되는 것을 알 수 있다. 이상에서 설명한 심장 초음파 영상의 분석 장치 및 방법의 실시예들에 의하면, 딥러닝 기반의 예측 모델을 이용 하여 환자의 심장 초음파 영상으로부터 고혈압성 좌심실 비후 확률, 비후성 심근병증 확률, 심장 아밀로이드증 확률을 각각 산출할 수 있고, 예측 모델의 결과에 영향을 미치는 특징 변수들과 결과 간의 관계를 시각적으로 나타내는 얼굴 영역의 클래스 활성화 맵을 제공하여 임상의에게 변수들이 예측 결과에 어떻게 영향을 미치는지 에 대한 통찰력을 제공할 수 있다. 이상에서는 실시예들을 참조하여 설명하였지만, 해당 기술 분야의 숙련된 당업자는 하기의 특허 청구의 범위에 기재된 본 발명의 사상 및 영역으로부터 벗어나지 않는 범위 내에서 본 발명을 다양하게 수정 및 변경시킬 수 있음을 이해할 수 있을 것이다."}
{"patent_id": "10-2021-0185772", "section": "도면", "subsection": "도면설명", "item": 1, "content": "본 발명 또는 종래 기술의 실시예의 기술적 해결책을 보다 명확하게 설명하기 위해, 실시예에 대한 설명에서 필 요한 도면이 아래에서 간단히 소개된다. 아래의 도면들은 본 명세서의 실시예를 설명하기 목적일 뿐 한정의 목 적이 아니라는 것으로 이해되어야 한다. 또한, 설명의 명료성을 위해 아래의 도면들에서 과장, 생략 등 다양한 변형이 적용된 일부 요소들이 도시될 수 있다. 도 1은 일 실시예에 따른 심장 초음파 영상의 분석 장치의 구성을 나타낸 블록도이다. 도 2는 심장 초음파 영상의 예시적인 화면을 도시한다. 도 3은 제1 네트워크의 예시적인 구조를 도시한다. 도 4는 양방향 콘볼루션 LSTM 계층의 예시적인 구조를 도시한다. 도 5는 제2 네트워크의 예시적인 구조를 도시한다. 도 6은 본 발명의 실시예에 따른 인공지능을 활용한 좌심실 비후 심장 초음파 영상의 분석 방법의 각 단계를 나 타내는 순서도이다. 도 7a 내지 도7c는 본 실험예에 따른 예측 모델의 감별 정확도와 심장 초음파 전문의 감별 정확도를 비교하여 확인한 컨퓨젼 매트릭스를 나타낸다. 도 8a 내지 도 8o은 제1 내지 제5 서브 네트워크의 결과 도출에 관여한 영역을 도시한 클래스 활성화 맵을 예시 적으로 도시한다."}
