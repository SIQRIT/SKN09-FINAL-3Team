{"patent_id": "10-2017-0019750", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2018-0093525", "출원번호": "10-2017-0019750", "발명의 명칭": "영상 데이터 복구 방법", "출원인": "한화에어로스페이스 주식회사", "발명자": "이송호"}}
{"patent_id": "10-2017-0019750", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "외부로부터 전송되는 영상 데이터를 저장하는 영상 감시 시스템의 영상 데이터 복구 방법에 있어서,상기 영상 데이터가 전송되면, 상기 영상 데이터를 저장 장치 및 보조 저장 장치에 저장하는 단계;상기 저장 장치와 호스트 기기 사이에 통신 오류가 발생하는 경우, 상기 저장 장치를 재부팅하는 단계;상기 통신 오류로 인해 상기 저장 장치에서 상기 영상 데이터의 기록이 누락된 구간을 검출하는 단계; 및상기 보조 저장 장치에 저장된 영상 데이터 중 상기 기록이 누락된 구간에 대응되는 부분을 추출하고 상기 추출된 부분에 의해 상기 저장 장치에 저장된 영상 데이터를 복구하는 단계; 를 포함하는 영상 데이터 복구 방법."}
{"patent_id": "10-2017-0019750", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서, 상기 영상 데이터를 저장하는 단계는,상기 저장되는 영상 데이터를 구성하는 프레임들 중에서 적어도 일부의 프레임에 타임 스탬프를 부가하는 단계;를 더 포함하는 영상 데이터 복구 방법."}
{"patent_id": "10-2017-0019750", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제2항에 있어서, 상기 기록이 누락된 구간을 검출하는 단계는,상기 통신 오류가 발생한 시점의 타임 스탬프 및 재부팅이 완료된 시점의 타임 스탬프를 참조하여 상기 기록이누락된 구간을 검출하는 영상 데이터 복구 방법."}
{"patent_id": "10-2017-0019750", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제2항에 있어서, 상기 영상 데이터를 저장하는 단계는,상기 영상 데이터의 각 프레임을 순차적으로 카운트하는 단계;를 더 포함하는 영상 데이터 복구 방법."}
{"patent_id": "10-2017-0019750", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제4항에 있어서, 상기 기록이 누락된 구간을 검출하는 단계는,상기 통신 오류가 발생한 시점의 타임 스탬프를 기준으로, 상기 기록이 누락된 구간의 시점을 검출하는 단계;및상기 통신 오류가 발생하기 전 상기 저장 장치에 저장된 프레임의 수와 상기 통신 오류가 발생한 시점의 타임스탬프의 프레임의 카운트 수를 비교하여 상기 기록이 누락된 구간의 시점을 보정하는 단계;를 포함하는 영상 데이터 복구 방법."}
{"patent_id": "10-2017-0019750", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제1항에 있어서, 상기 저장 장치를 리부팅하는 단계는,상기 저장 장치를 장착해제(unmount)하는 단계;상기 저장 장치로 공급되는 전원을 리셋하는 단계; 및상기 저장 장치를 재장착(mount)하는 단계;를 포함하는 영상 데이터 복구 방법.공개특허 10-2018-0093525-3-"}
{"patent_id": "10-2017-0019750", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명의 일 실시예에 따른 영상 복구 방법은 외부로부터 전송되는 영상 데이터를 저장하는 영상 감시 시스템의 영상 데이터 복구 방법에 있어서, 상기 영상 데이터가 전송되면, 상기 영상 데이터를 저장 장치 및 보조 저장 장 치에 저장하는 단계, 상기 저장 장치와 호스트 기기 사이에 통신 오류가 발생하는 경우, 상기 저장 장치를 재부 팅하는 단계, 상기 통신 오류로 인해 상기 저장 장치에서 상기 영상 데이터의 기록이 누락된 구간을 검출하는 단 계 및 상기 보조 저장 장치에 저장된 영상 데이터 중 상기 기록이 누락된 구간에 대응되는 부분을 추출하고 상기 추출된 부분에 의해 상기 저장 장치에 저장된 영상 데이터를 복구하는 단계를 포함한다."}
{"patent_id": "10-2017-0019750", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 영상 데이터 복구 방법에 대한 것으로, 보다 구체적으로, 영상 감시 시스템에서 영상 데이터를 저장 하는 저장 장치와 프로세서 사이에 통신 오류가 발생하는 경우, 통신 상태를 복구하고, 상기 통신 상태의 복구 시간동안 발생한 영상 데이터의 기록 빠짐 부분을 저장 장치에 채워 넣을 수 있는 영상 데이터 복구 방법에 관 한 것이다."}
{"patent_id": "10-2017-0019750", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "최근, CCTV 감시카메라는 기존 아날로그 방식에서 네트워크를 기반으로 하는 IP 카메라와 이를 통한 지능형 영 상분석 기술로 빠르게 발전하고 있다. 지능형 영상분석 기술이란 기존의 단순한 모니터링에서 나아가 기상조건 이나 주변의 조명상태에 따른 자동 영상인식 기술과 지능적으로 영상을 분석할 수 있는 고도화된 기술을 말한다. 지능형 영상보안 시스템은 카메라를 통해 획득한 영상정보를 실시간으로 분석해 자동으로 목표물을 탐지/추적/ 식별/행위분석/검색하여 컴퓨터의 시각처리/패턴 분석/인공지능 및 데이터관리 기술들과 결합해 객체의 행위나 상호작용을 분석하는 것을 목표로 한다. IP 카메라는 보안장비의 특성상 1년 365일, 하루 24시간 문제없이 작동하여야 하며 카메라의 화질, 촬영 기술, 각종 지능형 솔루션뿐만 아니라 감시 영상을 잘 관리할 수 있는 보안 시스템 또한 고려해야 한다. 네트워크를 기반으로 하여 보안 위험이 발생할 확률이 높기 때문이다. 이와 같이 IP 카메라는 다양한 기능을 가지고 장시간 안정적으로 작동하여야 하는 고(高) 신뢰도를 요구하는 시 스템이라 할 수 있다. 따라서 이러한 IP 카메라의 안정적인 작동을 보장하기 위해 영상 데이터를 저장하는 저장 장치의 안정성은 매우 중요한 역할을 한다. 일반적으로, IP 카메라의 영상 데이터를 저장하기 위해 SD 메모리 카드가 이용되고 있다. 그러나, 이러한 SD 메 모리 카드는 영상 데이터 저장 도중 프로세서와 Cmd 통신 에러가 발생하는 경우, 기록이 누락되는 문제점이 있 다. 또한, SD 메모리 카드의 통신 에러가 발생하여 리부팅하는 경우, 리부팅하는 시간 동안 영상 데이터의 기록 빠짐이 발생하게 되는 문제점이 있다. 선행기술문헌 특허문헌 (특허문헌 0001) 한국 등록특허공보 제1393364호 (2014.05.12 공개됨)"}
{"patent_id": "10-2017-0019750", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은 상기한 종래 기술의 문제점을 해결하기 위한 것으로써, 영상 감시 시스템에서 영상 데이터를 저장하 는 저장 장치와 프로세서 사이에 통신 오류가 발생하는 경우, 통신 상태를 복구하고, 상기 통신 상태의 복구 시 간동안 발생한 영상 데이터의 기록 빠짐 부분을 저장 장치에 채워 넣을 수 있는 영상 데이터 복구 방법을 제공 한다. 또한, 타임 스탬프와 프레임 카운트를 이용하여 보다 정확한 기록 누락 구간을 검출함으로써, 기록 누락 구간의 영상 데이터를 완벽하게 복구할 수 있는 영상 데이터 복구 방법을 제공한다."}
{"patent_id": "10-2017-0019750", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명의 일 실시예에 따른 영상 복구 방법은 외부로부터 전송되는 영상 데이터를 저장하는 영상 감시 시스템 의 영상 데이터 복구 방법에 있어서, 상기 영상 데이터가 전송되면, 상기 영상 데이터를 저장 장치 및 보조 저 장 장치에 저장하는 단계, 상기 저장 장치와 호스트 기기 사이에 통신 오류가 발생하는 경우, 상기 저장 장치를재부팅하는 단계, 상기 통신 오류로 인해 상기 저장 장치에서 상기 영상 데이터의 기록이 누락된 구간을 검출하 는 단계 및 상기 보조 저장 장치에 저장된 영상 데이터 중 상기 기록이 누락된 구간에 대응되는 부분을 추출하 고 상기 추출된 부분에 의해 상기 저장 장치에 저장된 영상 데이터를 복구하는 단계를 포함한다. 일 실시예에서, 상기 영상 데이터를 저장하는 단계는 상기 저장되는 영상 데이터를 구성하는 프레임들 중에서 적어도 일부의 프레임에 타임 스탬프를 부가하는 단계를 더 포함할 수 있다. 여기서, 상기 기록이 누락된 구간을 검출하는 단계는 상기 통신 오류가 발생한 시점의 타임 스탬프 및 재부팅이 완료된 시점의 타임 스탬프를 참조하여 상기 기록이 누락된 구간을 검출할 수 있다. 일 실시예에서, 상기 영상 데이터를 저장하는 단계는 상기 영상 데이터의 각 프레임을 순차적으로 카운트하는 단계를 더 포함할 수 있다. 여기서, 상기 기록이 누락된 구간을 검출하는 단계는 상기 통신 오류가 발생한 시점의 타임 스탬프를 기준으로, 상기 기록이 누락된 구간의 시점을 검출하는 단계 및 상기 통신 오류가 발생하기 전 상기 저장 장치에 저장된 프레임의 수와 상기 통신 오류가 발생한 시점의 타임 스탬프의 프레임의 카운트 수를 비교하여 상기 기록이 누 락된 구간의 시점을 보정하는 단계를 포함할 수 있다. 일 실시예에서, 상기 저장 장치를 리부팅하는 단계는 상기 저장 장치를 장착해제(unmount)하는 단계, 상기 저장 장치로 공급되는 전원을 리셋하는 단계 및 상기 저장 장치를 재장착(mount)하는 단계를 포함할 수 있다."}
{"patent_id": "10-2017-0019750", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명의 일 실시형태에 의하면, 영상 감시 시스템에서 영상 데이터를 저장하는 저장 장치와 프로세서 사이에 통신 오류가 발생하는 경우, 통신 상태를 복구하고, 상기 통신 상태의 복구 시간동안 발생한 영상 데이터의 기 록 빠짐 부분을 저장 장치에 채워 넣을 수 있는 효과가 있다. 또한, 타임 스탬프와 프레임 카운트를 이용하여 보다 정확한 기록 누락 구간을 검출함으로써, 기록 누락 구간의 영상 데이터를 완벽하게 복구할 수 있는 효과가 있다."}
{"patent_id": "10-2017-0019750", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "본 발명의 이점 및 특징, 그리고 그것들을 달성하는 방법은 부가되는 도면과 함께 상세하게 후술되어 있는 실시 예들을 참조하면 명확해질 것이다. 그러나 본 발명은 이하에서 개시되는 실시예들에 한정되는 것이 아니라 서로 다른 다양한 형태로 구현될 수 있으며, 단지 본 실시예들은 본 발명의 개시가 완전하도록 하고, 본 발명이 속하"}
{"patent_id": "10-2017-0019750", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "는 기술분야에서 통상의 지식을 가진 자에게 발명의 범주를 완전하게 알려주기 위해 제공되는 것이며, 본 발명 은 청구항의 범주에 의해 정의될 뿐이다. 명세서 전체에 걸쳐 동일 참조 부호는 동일 구성 요소를 지칭한다. 다른 정의가 없다면, 본 명세서에서 사용되는 모든 용어(기술 및 과학적 용어를 포함)는 본 발명이 속하는 기술 분야에서 통상의 지식을 가진 자에게 공통적으로 이해될 수 있는 의미로 사용될 수 있을 것이다. 또 일반적으로 사용되는 사전에 정의되어 있는 용어들은 명백하게 특별히 정의되어 있지 않는 한 이상적으로 또는 과도하게 해석되지 않는다. 또한, 본 명세서에서 기술하는 실시예들은 본 발명의 이상적인 예시도인 단면도 및/또는 개략도들을 참고하여 설명될 것이다. 따라서, 제조 기술 및/또는 허용 오차 등에 의해 예시도의 형태가 변형될 수 있다. 또한 본 발 명에 도시된 각 도면에 있어서 각 구성 요소들은 설명의 편의를 고려하여 다소 확대 또는 축소되어 도시된 것일 수 있다. 명세서 전체에 걸쳐 동일 참조 부호는 동일 구성 요소를 지칭하며, \"및/또는\"은 언급된 아이템들의 각 각 및 하나 이상의 모든 조합을 포함한다. 이하, 부가된 도면을 참조하여 본 발명의 바람직한 실시예의 구성을 상세히 설명하기로 한다. 도 1은 본 발명의 일 실시예에 따른 영상 감시 시스템을 설명하기 위한 구성도이다. 도 1을 참조하면, 본 발명의 일 실시예에 따른 영상 감시 시스템은 적어도 하나의 카메라, 호스트 기기 및 디스플레이를 포함할 수 있다. 호스트 기기는 적어도 하나의 카메라와 무선 또는 유선 통신을 통해 연결될 수 있으며, 상기 적어도 하 나의 카메라로부터 영상 데이터를 수신하여 저장할 수 있고, 상기 영상 데이터를 디스플레이에 표시할 수 있다. 여기서, 적어도 하나의 카메라는 TCP/IP 네트워크를 통해 호스트 기기으로 영상 데이터를 전 송할 수 있는 IP 카메라일 수 있다. 카메라에 의해 촬영된 영상은 실시간으로 연속적으로 호스트 기기 에 전송될 수 있다. 일 실시예에서, 호스트 기기는 프로세서, 저장 장치, 및 보조 저장 장치를 포함할 수 있다. 프로세서는 호스트 기기의 전반적인 동작을 제어할 수 있다. 구체적으로, 프로세서는 저장 장치 가 연결되면, 상기 저장 장치와 데이터 통신을 수행하기 위해 먼저 장치를 장착(mount)할 수 있다. 여기서, 장착이란, 저장 장치를 인식하고, 데이터 통신을 수행할 수 있는 준비상태 완료하는 것을 의미한 다. 프로세서는 장착이 완료되면, 카메라로부터 수신한 영상 데이터를 저장 장치 및 보조 저장 장치에 저장할 수 있다. 또한, 프로세서는 저장 장치로 상기 영상 데이터를 저장하기 위한 데이터 송수신 과정에서, 통신 오 류가 발생하는 경우, 저장 장치를 재부팅하여 통신 상태를 복구 할 수 있다. 이때, 저장 장치를 재부팅하는 동안 카메라로부터 전송되는 영상 데이터의 기록이 누락되는 구간이 발 생할 수 있다. 여기서, 프로세서는 통신 상태가 복구되면, 복구 시점 이후의 영상 데이터를 저장 장치 에 저장하되, 상기 기록이 누락되는 구간을 검출하고, 이를 보조 저장 장치에서 추출하여, 저장 장치 의 상기 기록이 누락된 구간에 저장할 수 있다. 또한, 프로세서는 상기 영상 데이터를 디스플레이 를 통해 표시할 수 있다. 일 실시예에서, 프로세서는, 예를 들어 중앙처리장치(CPU), 그래픽처리장치(GPU), 마이크로프로세서, 주문 형 반도체(Application Specific Integrated Circuit, ASIC), Field Programmable Gate Arrays(FPGA) 등을 포 함할 수 있으며, 복수의 코어를 가질 수 있다. 이러한 프로세서에 대해서는 도 2 및 도 3을 참조하여 이하에서 보다 자세히 설명한다. 저장 장치는 프로세서의 제어에 의해 영상 데이터를 저장할 수 있다. 여기서, 저장 장치는 SD(Secure Digital) 메모리 카드, Mini SD 메모리 카드, Micro SD 메모리 카드 또는 USB(Universal Serial Bus)일 수 있다. 보조 저장 장치는 프로세서의 제어에 의해 영상 데이터를 저장할 수 있다. 보조 저장 장치에 저 장되는 영상 데이터는 저장 장치에 저장되는 영상 데이터와 동일한 데이터며, 상기 영상 데이터는 보조 저 장 장치와 저장 장치에 병렬적으로 저장될 수 있다. 여기서, 보조 저장 장치는 휘발성 메모리, 비휘 발성 메모리 또는 이들의 조합일 수 있다. 도 2는 도 1에 도시된 프로세서의 일 실시예를 설명하기 위한 구성도이다. 도 2를 참조하면, 본 발명의 일 실시예에 따른 프로세서는 데이터 송수신부, 타임 스탬프 생성부 , 통신 오류 검출부, 저장 장치 관리부, 기록 누락 구간 검출부 및 영상 데이터 복구부 를 포함할 수 있다. 데이터 송수신부는 외부로부터 전송된 영상 데이터를 저장 장치 및 보조 저장 장치에 저장하기 위해 데이터 송수신을 수행할 수 있다. 여기서, 데이터 송수신부는 저장 장치가 연결되는 경우, 저장 장치를 장착하기 위해, 저장 장치로 데이터 통신을 위해 필요한 정보를 포함하는 디바이스 디스크립 터(Device descriptor)를 요청하여 수신하고, 상기 디바이스 디스크립터를 기반으로 저장 장치에 주소를 할당할 수 있다. 타임 스탬프 생성부는 저장 장치에 저장되는 영상 데이터의 프레임 각각에 대하여 저장되는 시간 정 보를 포함하는 타임 스탬프를 생성하여 부가할 수 있다. 통신 오류 검출부는 데이터 송수신부와 저장 장치 사이의 통신 오류를 검출할 수 있다. 여기서, 통신 오류 검출부는 데이터 송수신부와 저장 장치 사이에 데이터가 송수신될 때, 소정의 요건이 만족되는 경우, 통신 오류가 발생한 것으로 판단하고, 이를 저장 장치 관리부로 알릴 수 있다. 일 실시예 에서, 통신 오류 검출부는 데이터 송수신부가 저장 장치로 Cmd 신호를 송신했을 때, Cmd Ack 신 호 즉, 응답(response)이 오지 않는 경우, Cmd 신호를 기 설정된 횟수까지 요청할 수 있고, 상기 기 설정된 횟 수의 Cmd 신호에 대해 Cmd Ack 신호가 오지 않는 경우, 통신 오류가 발생한 것으로 판단할 수 있다. 저장 장치 관리부는 통신 오류가 발생한 경우, 저장 장치를 리셋하여 통신 상태를 복구할 수 있다. 구체적으로, 저장 장치 관리부는 먼저, 저장 장치를 장착해제(unmount)하고, 저장 장치에 공급 하는 전원을 리셋한 후, 저장 장치를 재장착(mount)함으로써, 저장 장치를 리셋하여 통신 상태를 복 구할 수 있다. 기록 누락 구간 검출부는 데이터 송수신부와 저장 장치 사이에 통신 오류가 발생하여, 저장 장 치가 재부팅된 경우, 상기 저장 장치가 재부팅되는 동안 저장 장치에 저장 되지 않은 영상 데이터 구 간 즉, 기록 누락 구간을 검출할 수 있다. 여기서, 기록 누락 구간 검출부는 통신 오류가 발생한 시점과, 재부팅이 완료되어 통신이 복구된 시점의 타임 스탬프를 참조하여 검출할 수 있다. 예컨대, 기록 누락 구간 검 출부는 통신 오류가 발생한 시간에 대응되는 타임 스탬프와 통신이 복구된 시간에 대응되는 타임 스탬프를 검출하여, 상기 타임 스탬프 사이의 구간을 기록 누락 구간으로 검출할 수 있다. 영상 데이터 복구부는 기록 누락 구간 검출부에서 검출한 기록 누락 구간에 대응하는 영상 데이터를 보조 저장 장치에서 추출하여 저장 장치에 저장할 수 있다. 여기서, 영상 데이터 복구부는 기록 누락 구간에 대응되는 영상 데이터를 통신 오류가 발생하기 이전에 저장된 영상 데이터와 통신 상태 복구 시점 부터 저장되는 영상 데이터 사이에 저장할 수 있다. 도 3은 도 1에 도시된 프로세서의 다른 일 실시예를 설명하기 위한 구성도이다. 도 3의 실시예는 도 2의 실시예와 기본적인 구성은 동일하나, 저장 장치 및 보조 저장 장치에 저장되 는 영상 데이터의 프레임을 카운트하는 프레임 카운팅부를 더 포함한다는 점에서 차이가 있다. 프레임 카운팅부는 외부로부터 전송되는 영상 데이터에 포함된 프레임을 카운팅할 수 있다. 여기서, 프레 임 카운팅부는 상기 영상 데이터가 H.264 방식으로 압축되는 경우, 영상 데이터에 포함되는 적어도 하나의 I 프레임과, 상기 I 프레임에 종속되는 복수개의 P 프레임을 각각 개별적으로 카운팅할 수 있다. 이는 타임 스탬프를 이용하여 기록 누락 구간을 검출하는 경우, 통신 오류가 발생한 시점과 저장 장치에 최종적으로 저장된 영상의 타임 스탬프가 일치하지 않는 경우, 상기 기록 누락 구간을 추출하여 복구하게 되면, 영상 데이터가 완벽하게 복구되지 못하고, 상기 시간 차이 동안의 프레임이 빠지게 되는 문제점이 발생한다. 이 러한 문제점은 I 프레임으로만 구성된 Jpeg의 경우에는 크게 문제되지 않으나, I 프레임과 P 프레임으로 구성되 는 H.264의 경우, 화면이 재생되지 않거나, 빠른 움직임을 표현하는 영상 데이터의 경우, 동작이 어색하게 점프 되는 등의 현상이 발생할 수 있다. 이러한 문제점을 해결하기 위해, 본 발명의 일 실시예에서, 기록 누락 구간 검출부는 타임 스탬프를 이용 하여 기록 누락 구간을 검출하되, 저장 장치에 저장된 영상 데이터 중 통신 오류가 발생한 시점의 프레임 셋트의 프레임 수를 카운트하여, 상기 통신 오류가 발생한 시점의 타임 스탬프의 프레임 카운트 수를 비교하여 상기 검출한 기록 누락 구간의 시점을 보정할 수 있다. 예컨대, 통신 오류가 발생한 시점의 타임 스탬프의 프레임 카운트 수가 P6(6번째 P 프레임)이고, 저장 장치 에 저장된 영상 데이터에 저장된 P 프레임의 수가 P3인 경우, P6부터 영상 데이터를 복구하게 되면, 저장 장치에 저장되는 영상 데이터의 프레임 중 P4 및 P5가 복구되지 않고, 유실되는 문제점이 발생하게 된다. 이를 위해 기록 누락 구간 검출부는 통신 오류가 발생한 시점의 타임 스탬프의 프레임 카운트 수를 저장 장치에 저장된 영상 데이터에 저장된 프레임 수를 비교하여, 차이가 있는 경우, 상기 기록 누락 구간의 시 점을 상기 저장 장치에 저장된 마지막 프레임(P3)으로 보정할 수 있다. 도 4는 본 발명의 일 실시예에 따른 영상 시스템에서 데이터를 복구하는 경우, 저장 장치에 저장된 영상 데이터 를 설명하기 위한 도면이다. 도 4를 참조하면, 본 발명의 일 실시예에 따른 프로세서는 저장 장치에 저장된 영상 데이터의 검색 속도를 향상하기 위해 기 설정된 시간 단위로 나누어서 영상 데이터를 저장할 수 있다. 도 4에서, (A)에서, a는 기록 누락 시점이고, b는 통신 복구 시점이다. 여기서, a에서 b 사이의 구간이 기록 누 락 구간이다. 본 발명의 일 실시예에 의한 프로세서는 상기 기록 누락 구간을 검출하고, 보조 저장 장치에서 상기 기록 누락 구간에 대응되는 영상 데이터를 추출하여, (B)와 같이, 저장 장치에 저 장하여 영상 데이터를 복구할 수 있다. 여기서, 복구된 영상 데이터는 통신 오류가 발생하기 이전에 저장된 영상 데이터, 복구된 기록 누락 구간의 영상 데이터(1') 및 통신 상태가 복구된 이후에 저장된 영상 데이터 조각(segment)들로 형성될 수 있다. 도 5는 본 발명의 일 실시예에 따른 영상 복구 방법을 설명하기 위한 흐름도이다. 도 5에 도시된 영상 복구 방법은 도 1 및 도 2를 참조하여 상술한 도시된 호스트 기기에서 수행되므로, 상 술한 내용과 동일하거나 또는 그에 상응하는 내용에 대해서는 중복적으로 서술하지 아니한다. 도 5를 참조하면, 외부로부터 영상 데이터가 전송되는 경우, 프로세서는 영상 데이터를 저장 장치와 보조 저장 장치에 병렬적으로 저장할 수 있다(S110). 여기서, 상기 전송되는 영상 데이터는 카메라에 의해 촬영된 감시 영상의 영상 데이터일 수 있고, 상기 영상 데이터는 카메라로부터 시간순서에 따라 연속 적으로 전송될 수 있다. 일 실시예에서, 프로세서는 상기 전송되는 영상 데이터를 기 설정된 시간 단위로 나누어서 저장 장치 및 보조 저장 장치에 저장할 수 있다. 프로세서가 저장 장치에 영상 데이터를 저장하는 도중에 통신 오류가 발생하는 경우(S120), 프로세서 는 저장 장치를 재부팅하여 통신 상태를 복구할 수 있다(S130). 프로세서는 저장 장치와 통신 상태가 복구되면, 복구 시점 이후로 전송되는 영상 데이터를 저장 장치와 보조 저장 장치에 순 차적으로 저장하되, 저장 장치가 재부팅되는 동안 기록이 누락된 구간을 검출하여(S140), 저장 장치 에 복구시킬 수 있다(S150). 여기서, 프로세서는 저장 장치에서 기록 누락 구간을 검출할 수 있으며, 상기 기록 누락 구간에 대응 되는 영상 데이터를 보조 저장 장치에서 추출하여, 상기 저장 장치의 기록 누락 구간에 저장함으로써, 저장 장치가 재부팅되는 동안 저장되지 않은 영상 데이터를 복구할 수 있다. 일 실시예에서, 프로세서는 타임 스탬프를 이용하거나, 다른 일 실시예에서, 타임 스탬프와 프레임 카운트 수를 이용하여 기록 누락 구간을 검출할 수 있다. 이러한 기록 누락 구간을 검출하는 방법에 대한 다양한 실시예를 도 5 및 도 6을 참조하여 이하에서 보다 자세 히 설명한다. 도 6은 본 발명의 다른 일 실시예에 따른 영상 복구 방법을 설명하기 위한 흐름도이다. 도 6을 참조하면, 본 발명의 다른 일 실시예에 따른 영상 데이터 복구 방법은 프로세서가 외부로부터 전송 된 영상 데이터의 각 프레임에 타임 스탬프를 부가하는 단계(S100), 상기 영상 데이터를 저장 장치 및 보 조 저장 장치에 저장하는 단계(S110), 프로세서와 저장 장치 사이에 통신 오류가 발생하는 경우 (S120), 프로세서가 저장 장치를 재부팅하여 통신 상태를 복구하는 단계(S130), 상기 저장 장치(20 0)가 재부팅되는 동안 기록 누락 구간을 검출하는 단계(S140) 및 보조 저장 장치에서 상기 기록 누락 구간 에 대응되는 영상 데이터를 추출하여 저장 장치에 저장함으로써, 영상 데이터를 복구하는 단계(S150)를 포 함할 수 있다. 여기서, 타임 스탬프를 부가하는 단계(S100)는 저장 장치 및 보조 저장 장치에 저장되는 영상 데이터 의 프레임 각각에 대하여 저장되는 시간 정보를 포함하는 타임 스탬프를 생성하여 부가할 수 있다. 이 경우, 기록 누락 구간을 검출하는 단계(S140)는 프로세서와 저장 장치 사이에 통신 오류가 발생하 여, 저장 장치가 재부팅된 경우, 상기 저장 장치가 재부팅되는 동안 저장 장치에 저장 되지 않은 영 상 데이터 구간 즉, 기록 누락 구간을 검출할 수 있다. 여기서, 프로세서는 통신 오류가 발생한 시점과, 재부팅이 완료되어 통신이 복구된 시점의 타임 스탬프를 참조하여 검출할 수 있다. 예컨대, 프로세서는 통 신 오류가 발생한 시간에 대응되는 타임 스탬프와 통신이 복구된 시간에 대응되는 타임 스탬프를 검출하여, 상 기 타임 스탬프 사이의 구간을 기록 누락 구간으로 검출할 수 있다. 도 7은 본 발명의 또 다른 일 실시예에 따른 영상 복구 방법을 설명하기 위한 흐름도이며, 도 8은 도 7의 기록 누락 구간을 검출하는 단계의 일 실시예를 설명하기 위한 흐름도이다. 도 7을 참조하면, 본 발명의 또 다른 일 실시예에 따른 영상 데이터 복구 방법은 프로세서가 외부로부터 전송된 영상 데이터의 각 프레임에 타임 스탬프를 부가하는 단계(S100), 상기 영상 데이터의 각 프레임을 순차 적으로 카운트 하는 단계(S102), 상기 영상 데이터를 저장 장치 및 보조 저장 장치에 저장하는 단계 (S110), 프로세서와 저장 장치 사이에 통신 오류가 발생하는 경우(S120), 프로세서가 저장 장치 를 재부팅하여 통신 상태를 복구하는 단계(S130), 상기 저장 장치가 재부팅되는 동안 기록 누락 구간 을 검출하는 단계(S140) 및 보조 저장 장치에서 상기 기록 누락 구간에 대응되는 영상 데이터를 추출하여 저장 장치에 저장함으로써, 영상 데이터를 복구하는 단계(S150)를 포함할 수 있다. 일 실시예에서, 프레임 카운트 하는 단계(S102)는 외부로부터 전송되는 영상 데이터에 포함된 프레임을 카운팅 할 수 있다. 여기서, 프레임 카운트 하는 단계(S102)는 상기 영상 데이터가 H.264 방식으로 압축되는 경우, 영 상 데이터에 포함되는 적어도 하나의 I 프레임과, 상기 I 프레임에 종속되는 복수개의 P 프레임을 각각 개별적 으로 카운팅할 수 있다. 여기서, 타임 스탬프를 부가하는 단계(S100)와 프레임을 카운트 하는 단계(S102)는 도면에 도시된 예와 달리, 동시 또는 순차적으로 수행될 수 있다. 즉, 반드시 타임 스탬프를 부가하는 단계(S100)의 수행 후에 프레임을 카운트 하는 단계(S102)가 수행되어야 하는 것은 아니다. 일 실시예에서, 기록 누락 구간을 검출하는 단계(S140)는 타임 스탬프를 이용하여 기록 누락 구간을 검출하는 경우, 통신 오류가 발생한 시점과 저장 장치에 최종적으로 저장된 영상의 타임 스탬프가 일치하지 않는 경 우, 영상 데이터가 완벽하게 복구되지 못하고, 상기 시간 차이 동안의 프레임이 빠지게 되는 문제점을 해결하기 위한 것으로, 도 8에서와 같이, 타임 스탬프를 이용하여 기록 누락 구간을 검출하되(S142), 저장 장치에 저장된 영상 데이터 중 통신 오류가 발생한 시점의 프레임 셋트의 프레임 수를 카운트하여, 상기 통신 오류가 발생한 시점의 타임 스탬프의 프레임 카운트 수를 비교하여 상기 검출한 기록 누락 구간의 시점을 보정할 수 있 다(S144). 예컨대, 통신 오류가 발생한 시점의 타임 스탬프의 프레임 카운트 수가 P6(6번째 P 프레임)이고, 저장 장치 에 저장된 영상 데이터에 저장된 P 프레임의 수가 P3인 경우, 상기 저장 장치에 저장된 마지막 프레 임(P3)을 상기 기록 누락 구간의 시점으로 보정할 수 있다. 여기서, 통신 오류가 발생한 시점의 시간 정보와, 통신 오류가 발생하기 이전에 저장 장치에 저장된 마지 막 프레임의 프레임 카운트 정보는 버퍼(buffer) 단위로 기록하여 비휘발성 메모리(예컨대, Nand Memory)에 저 장하여, 전원이 갑자기 차단되는 경우를 대비할 수 있다. 도 9는 저장 장치를 재부팅하는 단계의 일 실시예를 설명하기 위한 흐름도이다. 도 9를 참조하면, 저장 장치를 재부팅하는 단계는 먼저, 저장 장치를 장착해제(unmount)할 수 있다 (S132). 다음으로, 프로세서가 저장 장치에 공급하는 전원을 리셋하여 저장 장치를 초기화시킬 수 있다(S134). 다음으로, 저장 장치를 재장착(mount)함으로써, 저장 장치와 프로세서 사이의 통신 상태를 복구할 수 있다. 이상에서 설명한 본 발명은 전술한 실시예 및 부가된 도면에 의해 한정되는 것이 아니고 후술하는 특허청구범위 에 의해 한정되며, 본 발명의 구성은 본 발명의 기술적 사상을 벗어나지 않는 범위 내에서 그 구성을 다양하게 변경 및 개조할 수 있다는 것을 본 발명이 속하는 기술 분야에서 통상의 지식을 가진 자는 쉽게 알 수 있다."}
{"patent_id": "10-2017-0019750", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 일 실시예에 따른 영상 감시 시스템을 설명하기 위한 구성도이다. 도 2는 도 1에 도시된 프로세서의 일 실시예를 설명하기 위한 구성도이다. 도 3은 도 1에 도시된 프로세서의 다른 일 실시예를 설명하기 위한 구성도이다. 도 4는 본 발명의 일 실시예에 따른 영상 감시 시스템에서 데이터를 복구하는 경우, 저장 장치에 저장된 영상 데이터를 설명하기 위한 도면이다. 도 5는 본 발명의 일 실시예에 따른 영상 복구 방법을 설명하기 위한 흐름도이다. 도 6은 본 발명의 다른 일 실시예에 따른 영상 복구 방법을 설명하기 위한 흐름도이다. 도 7은 본 발명의 또 다른 일 실시예에 따른 영상 복구 방법을 설명하기 위한 흐름도이다. 도 8은 도 7의 기록 누락 구간을 검출하는 단계의 일 실시예를 설명하기 위한 흐름도이다. 도 9는 저장 장치를 재부팅하는 단계의 일 실시예를 설명하기 위한 흐름도이다."}
