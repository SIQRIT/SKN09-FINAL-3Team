{"patent_id": "10-2022-0101583", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2023-0161309", "출원번호": "10-2022-0101583", "발명의 명칭": "깊이 정보를 획득하는 증강 현실 디바이스 및 그 동작 방법", "출원인": "삼성전자주식회사", "발명자": "신승학"}}
{"patent_id": "10-2022-0101583", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "카메라(110);중력 방향을 측정하도록 구성되는 IMU 센서(Inertial Measurement Unit)(120); 적어도 하나의 명령어들(instructions)를 저장하는 메모리(140); 및상기 적어도 하나의 명령어들을 실행하는 적어도 하나의 프로세서(130); 를 포함하고, 상기 적어도 하나의 프로세서(130)는, 상기 카메라(110)를 이용하여 획득한 이미지로부터 깊이 맵(depth map)을 획득하고, 상기 깊이 맵에 포함된 적어도 하나의 픽셀의 법선 벡터(normal vector)를 획득하고,상기 IMU 센서(120)에 의해 측정된 중력 방향에 기초하여 상기 적어도 하나의 픽셀의 법선 벡터의 방향을 보정하고, 상기 보정된 법선 벡터의 방향에 기초하여 상기 적어도 하나의 픽셀의 깊이 값을 보정하는, 증강 현실 디바이스(100)."}
{"patent_id": "10-2022-0101583", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1 항에 있어서,상기 적어도 하나의 프로세서(130)는, 상기 깊이 맵에 포함된 적어도 하나의 픽셀의 방향 벡터 및 상기 적어도 하나의 픽셀의 깊이 값에 기초하여 상기 적어도 하나의 픽셀을 3차원 좌표값으로 변환하고, 상하좌우 방향으로 인접한 복수의 인접 픽셀들의 3차원 좌표값의 외적(cross-product)을 계산함으로써, 상기 법선 벡터를 획득하는, 증강 현실 디바이스(100)."}
{"patent_id": "10-2022-0101583", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1 항 및 제2 항 중 어느 하나의 항에 있어서,상기 카메라(110)는 좌안 이미지를 획득하는 좌안 카메라 및 우안 이미지를 획득하는 우안 카메라를 포함하고, 상기 적어도 하나의 프로세서(130)는,상기 좌안 이미지 및 상기 우안 이미지를 인공지능 모델에 입력으로 적용하고, 상기 인공지능 모델을 이용하여 상기 좌안 이미지와 상기 우안 이미지의 픽셀 휘도값 유사도에 따른 시차(disparity)를 계산함으로써, 상기 깊이 맵을 획득하는, 증강 현실 디바이스(100)."}
{"patent_id": "10-2022-0101583", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제3 항에 있어서,상기 적어도 하나의 프로세서(130)는,공개특허 10-2023-0161309-3-상기 보정된 법선 벡터에 의해 정의되는 평면 상의 픽셀 및 상기 픽셀과 위치 상으로 인접한 복수의 인접 픽셀들의 깊이 값에 기초하여, 상기 인공지능 모델에 의해 획득된 깊이 맵의 손실값(loss)을 산출하고, 상기 산출된 손실값을 상기 인공지능 모델에 적용하는 트레이닝(training)을 수행함으로써, 상기 적어도 하나의픽셀의 깊이 값을 보정하는, 증강 현실 디바이스(100)."}
{"patent_id": "10-2022-0101583", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제4 항에 있어서,상기 적어도 하나의 프로세서(130)는,상기 보정된 법선 벡터를 갖는 픽셀 및 상기 픽셀에 위치적으로 인접한 상기 복수의 인접 픽셀들로 구성된 평면을 정의하고, 상기 정의된 평면과 상기 카메라(110)의 광선 벡터(ray vector)가 만나는 복수의 포인트에 기초하여 상기 복수의 인접 픽셀들의 깊이 값을 획득하고, 상기 획득된 픽셀의 깊이 값과 상기 복수의 인접 픽셀들의 깊이 값 간의 차이값을 각각 산출하고, 상기 복수의 인접 픽셀들 별로 산출된 차이값에 가중치를 적용하는 가중합(weighted sum) 연산을 수행함으로써,상기 손실값을 획득하는, 증강 현실 디바이스(100)."}
{"patent_id": "10-2022-0101583", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제5 항에 있어서,상기 가중치는, 상기 깊이 맵에서의 복수의 인접 픽셀들 각각의 상기 카메라(110)와의 거리에 기초하여 결정되는 제1 가중치 및 상기 깊이 맵에서의 상기 픽셀과 상기 복수의 인접 픽셀들 간의 휘도값 차이에 기초하여 결정되는 제2 가중치를 포함하는, 증강 현실 디바이스(100)."}
{"patent_id": "10-2022-0101583", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제3 항 내지 제6 항 중 어느 하나의 항에 있어서,상기 적어도 하나의 프로세서(130)는,상기 트레이닝된 인공지능 모델에 상기 좌안 이미지 및 상기 우안 이미지를 입력하는 추론을 수행함으로써, 보정된 깊이 맵을 획득하는, 증강 현실 디바이스(100)."}
{"patent_id": "10-2022-0101583", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제1 항에 있어서, 상기 카메라(110)는 좌안 이미지를 획득하는 좌안 카메라 및 우안 이미지를 획득하는 우안 카메라를 포함하고, 상기 적어도 하나의 프로세서(130)는,상기 중력 방향 또는 중력 방향에 수직한 방향에 따라 상기 좌안 이미지 및 상기 우안 이미지의 법선 벡터의 방향을 보정하고, 상기 보정된 법선 벡터의 방향 또는 상기 보정된 법선 벡터의 방향에 수직하는 방향을 따라 평면 가정(planehypothesis)을 수행하고, 상기 평면 가정에 의해 정의된 평면을 따라 플레인 스윕(plane sweep)을 수행함으로써, 상기 적어도 하나의 픽셀의 깊이 값을 획득하고,공개특허 10-2023-0161309-4-상기 획득된 깊이 값을 이용하여 상기 적어도 하나의 픽셀의 깊이 값을 보정하는, 증강 현실 디바이스(100)."}
{"patent_id": "10-2022-0101583", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제1 항에 있어서,상기 카메라(110)는 ToF 카메라(Time-of-Flight camera)로 구성되고, 상기 적어도 하나의 프로세서(130)는,상기 ToF 카메라를 이용하여 상기 깊이 맵을 획득하는, 증강 현실 디바이스(100)."}
{"patent_id": "10-2022-0101583", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제9 항에 있어서,상기 적어도 하나의 프로세서(130)는,상기 보정된 법선 벡터에 기초하여 픽셀 별 평면을 정의하고, RGB 이미지의 색상 정보에 따라 분할된 영역에 기초하여 상기 깊이 맵에서 정의된 평면의 평면 영역을식별하고, 상기 식별된 평면 영역 내의 인접 픽셀들의 깊이 값에 기초하여 상기 깊이 값을 보정하는, 증강 현실 디바이스(100)."}
{"patent_id": "10-2022-0101583", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "증강 현실 디바이스(100)가 깊이 값을 보정하는 방법에 있어서, 카메라(110)를 이용하여 획득한 이미지로부터 깊이 맵(depth map)을 획득하는 단계(S310); 상기 깊이 맵에 포함된 적어도 하나의 픽셀의 법선 벡터(normal vector)를 획득하는 단계(S320);IMU 센서(120)에 의해 측정된 중력 방향에 기초하여 상기 적어도 하나의 픽셀의 법선 벡터의 방향을 보정하는단계(S330); 및상기 보정된 법선 벡터의 방향에 기초하여 상기 적어도 하나의 픽셀의 깊이 값을 보정하는 단계(S340);를 포함하는, 방법."}
{"patent_id": "10-2022-0101583", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제11 항에 있어서,상기 깊이 맵을 획득하는 단계(S310)는,좌안 카메라를 이용하여 획득된 좌안 이미지 및 우안 카메라를 이용하여 획득된 우안 이미지를 인공지능 모델에입력하는 단계; 및 상기 인공지능 모델을 이용하여 상기 좌안 이미지와 상기 우안 이미지의 픽셀 휘도값 유사도에 따른 시차(disparity)를 계산함으로써, 상기 깊이 맵을 획득하는 단계;를 포함하는, 방법."}
{"patent_id": "10-2022-0101583", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "공개특허 10-2023-0161309-5-제12 항에 있어서,상기 깊이 맵의 픽셀 별 깊이 값을 보정하는 단계(S340)는, 상기 보정된 법선 벡터에 의해 정의되는 평면 상의 픽셀 및 상기 픽셀과 위치 상으로 인접한 복수의 인접 픽셀들의 깊이 값에 기초하여, 상기 인공지능 모델에 의해 획득된 깊이 맵의 손실값(loss)을 산출하는 단계(S810);및 상기 산출된 손실값을 상기 인공지능 모델에 적용하는 트레이닝(training)을 수행함으로써, 상기 적어도 하나의픽셀의 깊이 값을 보정하는 단계(S820);를 포함하는, 방법."}
{"patent_id": "10-2022-0101583", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_14", "content": "제13 항에 있어서,상기 손실값을 산출하는 단계(S810)는,상기 보정된 법선 벡터를 갖는 픽셀 및 상기 픽셀에 위치적으로 인접한 상기 복수의 인접 픽셀들로 구성된 평면을 정의하는 단계(S910);상기 정의된 평면과 상기 카메라(110)의 광선 벡터(ray vector)가 만나는 복수의 포인트에 기초하여 상기 복수의 인접 픽셀들의 깊이 값을 획득하는 단계(S920); 상기 획득된 픽셀의 깊이 값과 상기 복수의 인접 픽셀들의 깊이 값 간의 차이값을 각각 산출하는 단계(S930);및상기 복수의 인접 픽셀들 별로 산출된 차이값에 가중치를 적용하는 가중합(weighted sum) 연산을 수행함으로써,상기 손실값을 획득하는 단계(S940); 를 포함하는, 방법."}
{"patent_id": "10-2022-0101583", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_15", "content": "제14 항에 있어서,상기 가중치는, 상기 깊이 맵에서의 복수의 인접 픽셀들 각각의 상기 카메라(110)와의 거리에 기초하여 결정되는 제1 가중치 및 상기 깊이 맵에서의 상기 픽셀과 상기 복수의 인접 픽셀들 간의 휘도값 차이에 기초하여 결정되는 제2 가중치를 포함하는, 방법."}
{"patent_id": "10-2022-0101583", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_16", "content": "제12 항 내지 제15 항 중 어느 하나의 항에 있어서,상기 트레이닝된 인공지능 모델에 상기 좌안 이미지 및 상기 우안 이미지를 입력하는 추론을 수행함으로써, 보정된 깊이 맵을 획득하는 단계;를 더 포함하는, 방법."}
{"patent_id": "10-2022-0101583", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_17", "content": "제11 항에 있어서, 상기 픽셀 별 법선 벡터의 방향을 보정하는 단계(S330)는, 상기 중력 방향 또는 중력 방향에 수직한 방향에 따라 좌안 카메라를 이용하여 획득된 좌안 이미지 및 우안 카공개특허 10-2023-0161309-6-메라를 이용하여 획득된 우안 이미지의 법선 벡터의 방향을 보정하는 단계;를 포함하고, 상기 적어도 하나의 픽셀의 깊이 값을 보정하는 단계(S340)는, 상기 보정된 법선 벡터의 방향 또는 상기 보정된 법선 벡터의 방향에 수직하는 방향을 따라 평면 가정(planehypothesis)을 수행하는 단계(S1220); 및 상기 평면 가정에 의해 정의된 평면을 따라 플레인 스윕(plane sweep)을 수행함으로써, 상기 깊이 값을 획득하는 단계(S1230); 및상기 획득된 깊이 값을 이용하여 상기 적어도 하나의 픽셀의 깊이 값을 보정하는 단계(S1240); 를 포함하는, 방법."}
{"patent_id": "10-2022-0101583", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_18", "content": "제11 항에 있어서,상기 깊이 맵을 획득하는 단계(S310)는, ToF 카메라(Time-of-Flight camera)를 이용하여 상기 깊이 맵을 획득하는, 방법."}
{"patent_id": "10-2022-0101583", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_19", "content": "제18 항에 있어서,상기 적어도 하나의 픽셀의 깊이 값을 보정하는 단계(S340)는, 상기 보정된 법선 벡터에 기초하여 픽셀의 평면을 정의하는 단계(S1410); RGB 이미지의 색상 정보에 따라 분할된 영역에 기초하여 상기 깊이 맵에서 정의된 평면의 평면 영역을 식별하는단계(S1420); 및상기 식별된 평면 영역 내의 인접 픽셀들의 깊이 값에 기초하여 적어도 하나의 픽셀의 깊이 값을 보정하는 단계(S1430);를 포함하는, 방법."}
{"patent_id": "10-2022-0101583", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_20", "content": "제11 항 내지 제19 항 중 어느 하나의 항에 기재된 방법을 구현하기 위한 적어도 하나의 프로그램이 기록된 컴퓨터로 판독 가능한 기록 매체."}
{"patent_id": "10-2022-0101583", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "추가 하드웨어 모듈없이 높은 정확도를 갖는 깊이 맵을 획득하기 위하여 IMU 센서에 의해 측정된 중력 방향에 기 초하여 깊이 값을 보정하는 증강 현실 디바이스 및 그 동작 방법을 제공한다. 본 개시의 일 실시예에 따른 증강 현실 디바이스는 카메라를 이용하여 획득한 이미지로부터 깊이 맵(depth map)을 획득하고, 깊이 맵으로부터 적어 도 하나의 픽셀의 법선 벡터(normal vector)를 획득하고, IMU 센서(Inertial Measurement Unit)에 의해 측정된 중력 방향에 기초하여 적어도 하나의 픽셀의 법선 벡터의 방향을 보정하고, 보정된 법선 벡터의 방향에 기초하여 깊이 맵의 깊이 값을 보정할 수 있다."}
{"patent_id": "10-2022-0101583", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 개시는 깊이 정보를 획득하는 증강 현실 디바이스(augment reality device) 및 그 동작 방법에 관한 것이다. 구체적으로, 본 개시는 중력 방향에 기초하여 깊이 맵(depth map)의 픽셀 별 깊이 값을 보정하는 증강 현실 디 바이스 및 그 동작 방법에 관한 것이다."}
{"patent_id": "10-2022-0101583", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "증강 현실(Augmented Reality)은 현실 세계의 물리적 환경 공간이나 현실 객체(real world object) 상에 가상 이미지를 오버레이(overlay)하여 함께 보여주는 기술로서, 증강 현실 기술을 활용한 증강 현실 디바이스(예를들어, 스마트 글래스(Smart Glass))가 정보 검색, 길 안내, 카메라 촬영과 같이 일상 생활에서 유용하게 사용되 고 있다. 특히, 스마트 글래스는 패션 아이템으로도 착용되고, 실외 활동에 주로 사용되고 있다. 최근에는 사용자에게 몰입감을 주기 위하여, 3차원 입체 공간으로 구성된 현실 공간에 포함되는 객체의 공간감 을 나타내는 깊이 정보를 획득하는 깊이 센서(depth sensor)를 포함하는 디바이스가 널리 사용되고 있다. 종래 의 깊이 센서를 이용한 깊이 정보 획득 기술은 예를 들어, 구조광 방식(Structured Light), 스테레오 비전 방식 (Stereo Vision), 또는 ToF 방식(Time of Flight) 등이 있다. 상기 깊이 정보 획득 기술 중 구조광 방식, 스테 레오 비전 방식, ToF 방식은 카메라 기반의 깊이 추정 방식으로서, 카메라로부터의 거리가 멀어지면 멀어질수록 깊이 값의 정확도가 낮아진다. 거리에 관한 깊이 값의 정확도가 상대적으로 높은 구조광 방식 또는 ToF 방식의 경우 발광부(illuminator) 등 하드웨어 모듈이 추가로 필요하고, 하드웨어 모듈에 의한 전력 소모 및 추가 비용 발생의 문제점이 있다. 또한, 증강 현실 디바이스에 의해 실행되는 증강 현실 애플리케이션은 대부분 상시 깊이 정보를 필요로 하므로 전력 소모량이 증가하고, 소형 폼팩터를 갖는 휴대용 디바이스인 증강 현실 디바이스의 특성 상 발열 및 전력 소모량은 디바이스 이용 가능 시간에 크게 영향을 미친다."}
{"patent_id": "10-2022-0101583", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "상술한 기술적 과제를 해결하기 위하여 본 개시는 중력 방향에 기초하여 깊이 값을 보정하는 증강 현실 디바이 스를 제공한다. 본 개시의 일 실시예에 따른 증강 현실 디바이스는 카메라, IMU 센서(Inertial Measurement Unit), 적어도 하나의 프로세서, 및 메모리를 포함할 수 있다. 적어도 하나의 프로세서는 메모리에 저장된 적어 도 하나의 명령어들을 실행함으로써, 카메라를 이용하여 획득한 이미지로부터 깊이 맵(depth map)을 획득할 수 있다. 적어도 하나의 프로세서는 깊이 맵에 포함된 적어도 하나의 픽셀의 법선 벡터(normal vector)를 획득할 수 있다. 적어도 하나의 프로세서는 IMU 센서에 의해 측정된 중력 방향에 기초하여 상기 적어도 하나의 픽 셀의 법선 벡터의 방향을 보정할 수 있다. 적어도 하나의 프로세서는 보정된 법선 벡터의 방향에 기초하여 상기 적어도 하나의 픽셀의 깊이 값을 보정할 수 있다. 상술한 기술적 과제를 해결하기 위하여 본 개시는 증강 현실 디바이스가 깊이 값을 보정하는 방법을 제공한다. 본 개시의 일 실시예에서, 상기 방법은 카메라를 이용하여 획득한 이미지로부터 깊이 맵(depth map)을 획득하는 단계를 포함할 수 있다. 상기 방법은 깊이 맵에 포함된 적어도 하나의 픽셀의 법선 벡터(normal vector)를 획득 하는 단계를 포함할 수 있다. 상기 방법은 IMU 센서에 의해 측정된 중력 방향에 기초하여 상기 적어도 하나의 픽셀의 법선 벡터의 방향을 보정하는 단계를 포함할 수 있다. 상기 방법은 보정된 법선 벡터의 방향에 기초하여 상기 적어도 하나의 픽셀의 깊이 값을 보정하는 단계를 포함할 수 있다. 상술한 기술적 과제를 해결하기 위하여, 본 개시는 컴퓨터로 읽을 수 있는 저장 매체를 포함하는 컴퓨터 프로그 램 제품(Computer Program Product)를 제공한다. 상기 저장 매체는 카메라를 이용하여 획득한 이미지로부터 깊 이 맵(depth map)을 획득하는 동작과 관련된 명령어들(instructions)을 저장할 수 있다. 상기 저장 매체는 깊이 맵에 포함된 적어도 하나의 픽셀의 법선 벡터(normal vector)를 획득하는 동작과 관련된 명령어들을 저장할 수 있다. 상기 저장 매체는 IMU 센서에 의해 측정된 중력 방향에 기초하여 적어도 하나의 픽셀의 법선 벡터의 방향 을 보정하는 동작과 관련된 명령어들을 저장할 수 있다. 상기 저장 매체는 보정된 법선 벡터의 방향에 기초하여 깊이 맵의 적어도 하나의 픽셀의 깊이 값을 보정하는 동작과 관련된 명령어들을 저장할 수 있다."}
{"patent_id": "10-2022-0101583", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "본 명세서의 실시예들에서 사용되는 용어는 본 개시의 기능을 고려하면서 가능한 현재 널리 사용되는 일반적인 용어들을 선택하였으나, 이는 당 분야에 종사하는 기술자의 의도 또는 판례, 새로운 기술의 출현 등에 따라 달 라질 수 있다. 또한, 특정한 경우는 출원인이 임의로 선정한 용어도 있으며, 이 경우 해당되는 실시예의 설명 부분에서 상세히 그 의미를 기재할 것이다. 따라서 본 명세서에서 사용되는 용어는 단순한 용어의 명칭이 아닌, 그 용어가 가지는 의미와 본 개시의 전반에 걸친 내용을 토대로 정의되어야 한다. 단수의 표현은 문맥상 명백하게 다르게 뜻하지 않는 한, 복수의 표현을 포함할 수 있다. 기술적이거나 과학적인 용어를 포함해서 여기서 사용되는 용어들은 본 명세서에 기재된 기술 분야에서 통상의 지식을 가진 자에 의해 일반적으로 이해되는 것과 동일한 의미를 가질 수 있다. 본 개시 전체에서 어떤 부분이 어떤 구성요소를 \"포함\"한다고 할 때, 이는 특별히 반대되는 기재가 없는 한 다 른 구성요소를 제외하는 것이 아니라 다른 구성요소를 더 포함할 수 있음을 의미한다. 또한, 본 명세서에 기재 된 \"...부\", \"...모듈\" 등의 용어는 적어도 하나의 기능이나 동작을 처리하는 단위를 의미하며, 이는 하드웨어 또는 소프트웨어로 구현되거나 하드웨어와 소프트웨어의 결합으로 구현될 수 있다. 본 개시에서 사용된 표현 \"~하도록 구성된(또는 설정된)(configured to)\"은 상황에 따라, 예를 들면, \"~에 적합 한(suitable for)\", \"~하는 능력을 가지는(having the capacity to)\", \"~하도록 설계된(designed to)\", \"~하도 록 변경된(adapted to)\", \"~하도록 만들어진(made to)\", 또는 \"~를 할 수 있는(capable of)\"과 바꾸어 사용될 수 있다. 용어 \"~하도록 구성된(또는 설정된)\"은 하드웨어적으로 \"특별히 설계된(specifically designed to)\" 것만을 반드시 의미하지 않을 수 있다. 대신, 어떤 상황에서는, \"~하도록 구성된 시스템\"이라는 표현은, 그 시 스템이 다른 장치 또는 부품들과 함께 \"~할 수 있는\" 것을 의미할 수 있다. 예를 들면, 문구 \"A, B, 및 C를 수 행하도록 구성된(또는 설정된) 프로세서\"는 해당 동작을 수행하기 위한 전용 프로세서(예: 임베디드 프로세서), 또는 메모리에 저장된 하나 이상의 소프트웨어 프로그램들을 실행함으로써, 해당 동작들을 수행할 수 있는 범용 프로세서(generic-purpose processor)(예: CPU 또는 application processor)를 의미할 수 있다. 또한, 본 개시에서 일 구성요소가 다른 구성요소와 \"연결된다\" 거나 \"접속된다\" 등으로 언급된 때에는, 상기 일 구성요소가 상기 다른 구성요소와 직접 연결되거나 또는 직접 접속될 수도 있지만, 특별히 반대되는 기재가 존 재하지 않는 이상, 중간에 또 다른 구성요소를 매개하여 연결되거나 또는 접속될 수도 있다고 이해되어야 할 것 이다. 아래에서는 첨부한 도면을 참고하여 본 개시의 실시예에 대하여 본 개시가 속하는 기술 분야에서 통상의 지식을 가진 자가 용이하게 실시할 수 있도록 상세히 설명한다. 그러나 본 개시는 여러 가지 상이한 형태로 구현될 수 있으며 여기에서 설명하는 실시 예에 한정되지 않는다. 이하에서는 도면을 참조하여 본 개시의 실시예들을 상세하게 설명한다. 도 1a는 본 개시의 일 실시예에 따른 증강 현실 디바이스가 깊이 값을 보정하는 방법을 설명하기 위한 개념도이 다. 도 1a를 참조하면, 증강 현실 디바이스는 카메라를 이용하여 획득된 이미지를 통해 실제 바닥면의 깊 이 값을 추정할 수 있다. 추정된 깊이 값은 실제 바닥면과 카메라 간의 물리적 거리 또는 높 이 차이 등 위치 관계에 따라 실제 바닥면의 깊이 값과는 다른 값으로 추정될 수 있다. 예를 들어, 카메라 가 좌안 카메라 및 우안 카메라를 포함하고, 증강 현실 디바이스가 좌안 카메라로부터 획득된 좌안 이미지 및 우안 카메라로부터 획득된 우안 이미지를 이용하여 스테레오 비전 방식을 통해 깊이 값을 추정하는 경우, 카메라로부터의 거리가 멀면 멀수록 좌안 이미지와 우안 이미지 간의 대응점 사이의 간격, 즉 시차 (disparity)의 오차가 커질 수 있다. 예를 들어, 증강 현실 디바이스가 ToF(Time-of-Flight) 방식을 통해 깊이 값을 추정하는 경우에도 카메라로부터의 거리가 멀면 멀수록 추정된 깊이 값의 정확도는 떨어지게 된다. 도 1a에 도시된 실시예에서, 추정된 깊이 값은 카메라와의 거리가 가까운 영역은 실제 바닥면의 깊이 값과 유사한 값으로 획득되었지만, 카메라와의 거리가 멀면 멀수록 실제 바닥면의 깊이 값과는 달리 위로 기울어진 경사 형태의 깊이 값으로 획득될 수 있다. 증강 현실 디바이스는 IMU 센서(Inertial Measurement Unit)를 통해 측정된 측정값에 기초하여 중력 방향 (G)에 관한 정보를 획득할 수 있다. 본 개시의 일 실시예에서, IMU 센서는 자이로 센서(gyroscope)를 포함 하고, 증강 현실 디바이스는 IMU 센서에 포함된 자이로 센서를 이용하여 중력 방향(G) 정보를 획득할 수 있다. 증강 현실 디바이스는 중력 방향(G)에 기초하여 추정된 깊이 값을 보정함으로써, 보정된 깊이 값(3 0)을 획득할 수 있다. 도 1a에 도시된 실시예에서, 보정된 깊이 값은 실제 바닥면과 같이 평평한 경사 도를 갖고, 실제 바닥면과 동일한 깊이 값을 가질 수 있다. 증강 현실 디바이스가 IMU 센서를 통해 획 득한 중력 방향(G)에 관한 정보에 기초하여 깊이 값을 보정하는 구체적인 방법은 도 1b에서 설명하기로 한다. 도 1b는 본 개시의 증강 현실 디바이스가 IMU 센서에 의해 측정된 중력 방향(G)에 따라 깊이 값을 보정하는 방 법을 설명하기 위한 개념도이다. 도 1b를 참조하면, 증강 현실 디바이스는 픽셀의 깊이 값을 획득한다(동작 ①). 증강 현실 디바이스는 카메라 를 이용하여 획득된 이미지에 기초하여 깊이 값(depth value)을 갖는 복수의 픽셀들(p1 내지 pn)을 포함하 는 깊이 맵(depth map)을 획득할 수 있다. 본 개시의 일 실시예에서, 카메라는 좌안 카메라 및 우안 카메 라를 포함하고, 증강 현실 디바이스는 좌안 카메라로부터 획득된 좌안 이미지 및 우안 카메라로부터 획득된 우 안 이미지를 이용하여 스테레오 비전 방식을 통해 깊이 맵을 획득할 수 있다. 본 개시의 일 실시예에서, 카메라 는 ToF(Time-of-Flight) 카메라로 구성되고, 증강 현실 디바이스는 ToF 카메라를 이용하여 깊이 맵을 획득 할 수 있다. 그러나, 이에 한정되는 것은 아니고, 본 개시의 다른 실시예에서 증강 현실 디바이스는 구조광 방 식(structured light)을 통해서 깊이 맵을 획득할 수도 있다. 깊이 맵에 포함되는 픽셀들의 깊이 값은 카메라로부터의 거리에 기초하여 실제 바닥면과는 다른 값을 가질 수 있다. 도 1b에 도시된 실시예에서, 복수의 픽셀들(p1 내지 pn) 중 상대적으로 카메라와 인접한 영 역(near)에 위치하는 제1 픽셀(p1) 및 제2 픽셀(p2)의 깊이 값은 실제 바닥면의 깊이 값과 동일 또는 유사하 지만, 카메라와의 거리가 먼 영역(far)에 위치하는 픽셀들(pn-1, pn)의 깊이 값은 실제 바닥면의 깊이 값과는 차이가 있을 수 있다. 증강 현실 디바이스는 픽셀의 법선 벡터(normal vector)(N1 내지 Nn)를 획득한다 (동작 ②). 본 개시의 일 실시 예에서, 증강 현실 디바이스는 깊이 맵에 포함된 복수의 픽셀들(p1 내지 pn)의 방향 벡터 및 깊이 값에 기초하여 복수의 픽셀들(p1 내지 pn)을 3차원 좌표값으로 변환할 수 있다. 증강 현실 디바이스는 어느 하나의 픽셀을 기준 으로 상하좌우 방향으로 인접한 위치에 배치된 인접 픽셀들의 3차원 좌표값의 외적(cross-product)을 계산함으 로써, 복수의 픽셀들(p1 내지 pn) 각각의 법선 벡터(N1 내지 Nn)를 획득할 수 있다. 증강 현실 디바이스는 중력 방향에 기초하여 법선 벡터(N1 내지 Nn)를 보정한다 (동작 ③). 증강 현실 디바이스 는 IMU 센서(120, 도 1a 참조)를 포함하고, IMU 센서의 자이로 센서(gyroscope)를 이용하여 측정된 측정값 에 기초하여 중력 방향(G)에 관한 정보를 획득할 수 있다. 증강 현실 디바이스는 픽셀 별 법선 벡터(N1 내지 N n)의 방향을 중력 방향(G) 또는 중력 방향(G)에 수직하는 방향에 따라 보정할 수 있다. 보정 결과, 증강 현실 디바이스는 보정된 법선 벡터(N1' 내지 Nn')를 획득할 수 있다. 증강 현실 디바이스는 보정된 법선 벡터(N1' 내지 Nn')에 기초하여 픽셀 별 깊이 값을 보정한다 (동작 ④). 증강 현실 디바이스는 보정된 법선 벡터(N1' 내지 Nn')의 방향에 따라 픽셀 별 평면을 정의하고, 픽셀 별 평면에 기초 하여 픽셀의 깊이 값을 보정할 수 있다. 본 개시의 일 실시예에서, 증강 현실 디바이스는 인공지능 모델 (Artificial Intelligence, AI)을 이용하여 깊이 맵을 획득하고, 보정된 법선 벡터(N1' 내지 Nn')에 의해 정의 되는 평면 상의 픽셀과 인접 픽셀들의 깊이 값에 기초하여 손실값(loss)을 산출하며, 산출된 손실값을 인공지능 모델에 적용하는 트레이닝(training)을 수행함으로써, 픽셀 별 깊이 값을 보정할 수 있다. 본 개시의 일 실시예 에서, 증강 현실 디바이스는 보정된 법선 벡터(N1' 내지 Nn')의 방향에 기초하여 정의된 픽셀 별 평면에 따라 플 레인 스윕(plane sweep)을 수행함으로써, 픽셀 별 깊이 값을 보정할 수 있다. 본 개시의 일 실시예에서, 보정된 법선 벡터(N1' 내지 Nn')에 기초하여 정의된 평면으로부터 RGB 이미지의 색상 정보에 기초하여 평면 영역을 식별 하고, 식별된 평면 영역 내의 인접 픽셀들의 깊이 값에 기초하여 픽셀 별 깊이 값을 보정할 수 있다. 증강 현실 디바이스는 보정된 깊이 값을 갖는 복수의 픽셀들(p1' 내지 pn')을 획득할 수 있다. 복수의 픽셀들 (p1' 내지 pn') 각각은 실제 바닥면의 깊이와 동일 또는 유사한 깊이 값을 가질 수 있다. 카메라를 통해 획득한 이미지를 이용하는 이미지 기반 깊이 값 획득 방식, 예를 들어 구조광 방식 (structure light), 스테레오 비전 방식(stereo vision), 또는 ToF 방식(Time-of-Flight)은 카메라로부터 의 거리가 멀어지면 멀어질수록 깊이 값의 정확도가 낮아지는 문제점이 있다. 거리에 관한 깊이 값의 정확도가 상대적으로 높은 구조광 방식 또는 ToF 방식의 경우 발광부(illuminator) 등 하드웨어 모듈이 추가로 필요하고, 하드웨어 모듈에 의한 전력 소모 및 추가 비용이 발생될 수 있다. 또한, 증강 현실 애플리케이션은 대부분 상시 깊이 정보를 필요로 하므로 증강 현실 디바이스의 전력 소모량이 증가하는 문제점이 있다. 소형 폼팩터를 갖는 휴대용 디바이스인 증강 현실 디바이스의 특성 상 발열 및 전력 소모량은 디바이스 이용 가능 시간에 크게 영향 을 미칠 수 있다. 본 개시는 IMU 센서(120, 도 1a 참조)를 통해 획득된 중력 방향(G) 정보를 이용하여 추가 하드웨어 모듈(예를 들어, 발광부 모듈)에 의한 불필요한 전력 소모 없이 높은 정확도를 갖는 깊이 값을 획득하는 증강 현실 디바이 스 및 그 동작 방법을 제공하는 데 목적이 있다. 도 1a 및 도 1b에 도시된 실시예에서, 증강 현실 디바이스는 IMU 센서를 이용하여 획득된 중력 방향(G) 정 보에 기초하여 픽셀 별 법선 벡터(N1 내지 Nn)의 방향을 보정하고, 보정된 법선 벡터(N1' 내지 Nn')에 기초하여 픽셀 별 깊이 값을 보정함으로써, 높은 정확도를 갖는 깊이 맵을 획득하고, 전력 소모량을 감소시킬 수 있다. 또한, 일반적으로 증강 현실 디바이스에는 IMU 센서가 필수 구성 요소로서 포함되는 바, 본 개시의 일 실 시예에 따른 증강 현실 디바이스는 소형 폼팩터를 유지하면서도 낮은 전력 소모량을 구현하고, 이로 인하여 휴 대성 및 디바이스 사용 시간을 증가시키는 기술적 효과를 제공할 수 있다. 도 2는 본 개시의 일 실시예에 따른 증강 현실 디바이스의 구성 요소를 도시한 블록도이다. 증강 현실 디바이스는 사용자의 안면부에 착용하는 안경 형태의 증강 현실 글래스(Augmented Reality Glass)일 수 있다. 증강 현실 디바이스는 애플리케이션을 실행함으로써, 시야(Field Of View, FOV) 내의 현실 객체 뿐만 아니라, 웨이브 가이드(waveguide)에 표시되는 가상 이미지 컨텐트를 제공할 수 있다. 증강 현 실 디바이스는 예를 들어, 무비 애플리케이션, 뮤직 애플리케이션, 포토 애플리케이션, 갤러리 애플리케이 션, 웹 브라우저 애플리케이션, 전자책(e-book reader) 애플리케이션, 게임 애플리케이션, 증강 현실 애플리케 이션, SNS 애플리케이션, 메신저 애플리케이션, 오브젝트 인식 애플리케이션 등을 실행함으로써, 각각의 애플리 케이션에서 표시되는 가상 이미지 콘텐트를 사용자에게 제공할 수 있다. 그러나, 이에 한정되는 것은 아니고, 증강 현실 디바이스는 사용자의 두부(頭部)에 착용하는 헤드 마운트 디스플레이 장치(HMD: Head Mounted Display Apparatus), 또는 증강 현실 헬멧(Augmented Reality Helmet) 등 으로 구현될 수도 있다. 그러나, 본 개시의 증강 현실 디바이스가 전술한 예시로 한정되는 것은 아니다. 본 개시의 일 실시예에서, 증강 현실 디바이스는 모바일 디바이스, 스마트 폰(smart phone), 노트북 컴퓨 터(laptop computer), 태블릿 PC, 전자책 단말기, 디지털 방송용 단말기, PDA(Personal Digital Assistants), PMP(Portable Multimedia Player), 네비게이션, MP3 플레이어, 캠코더, IPTV(Internet Protocol Television), DTV(Digital Television), 또는 착용형 기기(wearable device) 등과 같은 다양한 디바이스로 구현될 수도 있다. 도 2를 참조하면, 증강 현실 디바이스는 카메라, IMU 센서, 프로세서, 및 메모리를 포함할 수 있다. 카메라, IMU 센서, 프로세서, 및 메모리는 각각 전기적 및/또는 물리적으 로 서로 연결될 수 있다. 도 2에는 증강 현실 디바이스의 동작을 설명하기 위한 필수적 구성 요소만이 도 시되었고, 증강 현실 디바이스가 포함하는 구성 요소가 도 2에 도시된 바와 같이 한정되는 것은 아니다. 본 개시의 일 실시예에서, 증강 현실 디바이스는 시선 추적 센서 또는 디스플레이 엔진 등을 더 포함할 수 있다. 카메라는 현실 공간의 객체를 촬영함으로써, 객체에 관한 이미지를 획득하도록 구성된다. 본 개시의 일 실 시예에서, 카메라는 렌즈 모듈, 이미지 센서, 및 영상 처리 모듈을 포함할 수 있다. 카메라는 이미지 센서(예를 들어, CMOS 또는 CCD)에 의해 얻어지는 정지 이미지 또는 동영상을 획득할 수 있다. 영상 처리 모듈 은 이미지 센서를 통해 획득된 정지 이미지 또는 동영상을 가공하여, 필요한 정보를 추출하고, 추출된 정보를 프로세서에 전달할 수 있다. 본 개시의 일 실시예에서, 카메라는 좌안 카메라 및 우안 카메라를 포함하고, 두 개의 카메라를 이용하여 객체에 관한 3차원 입체 이미지를 획득하는 스테레오 카메라(Stereo camera)일 수 있다. 그러나, 이에 한정되는 것은 아니고, 카메라는 단일 카메라 또는 3개 이상의 멀티 카메라를 포함할 수 있다. 본 개시의 일 실시예예서, 카메라는 객체에 광을 조사하고, 객체로부터 반사된 반사광을 검출하며, 반사광 이 검출된 시점과 광이 조사된 시점 간의 시간 차이인 비행 시간(time of flight)에 기초하여 객체의 깊이 값을 획득하는 ToF 카메라일 수 있다. ToF 카메라로 구현되는 경우, 카메라는 객체의 RGB 이미지(1500, 도 15 참조) 및 깊이 맵 이미지(1510, 도 15 참조)를 함께 획득할 수 있다. IMU 센서(Inertial Measurement Unit)는 가속도 센서(accelerometer), 자이로 센서(gyroscope), 및 자력 센서(magnetometer)의 조합을 통해 증강 현실 디바이스의 이동 속도, 방향, 각도, 및 중력 가속도를 측정 하도록 구성되는 센서이다. 본 개시의 일 실시예에서, IMU 센서는 행 방향, 횡 방향, 및 높이 방향의 가속도를 측정하는 3축 가속도계와 롤(roll), 피치(pitch), 및 요(yaw) 각속도를 측정하는 3축 각속도계를 포함할 수 있다. 본 개시의 일 실시예에서, IMU 센서는 자이로 센서를 이용하여 각속도를 측정하고, 측정된 각속 도에 기초하여 중력 방향을 감지할 수 있다. IMU 센서는 중력 방향에 관한 정보를 프로세서에 제공할 수 있다. 프로세서는 메모리에 저장된 프로그램의 하나 이상의 명령어들(instructions)을 실행할 수 있다. 프 로세서는 산술, 로직 및 입출력 연산과 시그널 프로세싱을 수행하는 하드웨어 구성 요소로 구성될 수 있다. 프로세서는 예를 들어, 중앙 처리 장치(Central Processing Unit), 마이크로 프로세서 (microprocessor), 그래픽 프로세서(Graphic Processing Unit), ASICs(Application Specific Integrated Circuits), DSPs(Digital Signal Processors), DSPDs(Digital Signal Processing Devices), PLDs(Programmable Logic Devices), 및 FPGAs(Field Programmable Gate Arrays) 중 적어도 하나로 구성될 수 있으나, 이에 한정되는 것은 아니다. 본 개시의 일 실시예에서, 프로세서는 인공 지능(Artificial Intelligence, AI) 학습을 수행하는 AI 프로 세서를 포함할 수 있다. AI 프로세서는, 인공 지능(AI)을 위한 전용 하드웨어 칩 형태로 제작될 수도 있고, 또 는 기존의 범용 프로세서(예: CPU 또는 application processor) 또는 그래픽 전용 프로세서(예: GPU)의 일부로 제작되어 증강 현실 디바이스에 탑재될 수도 있다. 도 2에는 프로세서가 하나의 엘리먼트로 도시되었으나, 이에 한정되는 것은 아니다. 본 개시의 일 실시예 에서, 프로세서는 하나 이상의 복수 개의 엘리먼트들로 구성될 수 있다. 메모리는 예를 들어, 플래시 메모리 타입(flash memory type), 하드디스크 타입(hard disk type), 멀티미 디어 카드 마이크로 타입(multimedia card micro type), 카드 타입의 메모리(예를 들어 SD 또는 XD 메모리 등), 램(RAM, Random Access Memory) SRAM(Static Random Access Memory), 롬(ROM, Read-Only Memory), EEPROM(Electrically Erasable Programmable Read-Only Memory), PROM(Programmable Read-Only Memory), 또는 광 디스크 중 적어도 하나의 타입의 저장매체로 구성될 수 있다. 메모리에는 증강 현실 디바이스가 객체의 깊이 값 정보를 획득하는 기능 또는 동작들과 관련된 명령 어들(instructions)이 저장될 수 있다. 본 개시의 일 실시예에서, 메모리에는 프로세서가 판독할 수 있는 명령어들, 알고리즘(algorithm), 데이터 구조, 프로그램 코드(program code), 및 애플리케이션 프로그램 (application program) 중 적어도 하나가 저장될 수 있다. 메모리에 저장되는 명령어들, 알고리즘, 데이터 구조, 및 프로그램 코드는 예를 들어, C, C++, 자바(Java), 어셈블러(assembler) 등과 같은 프로그래밍 또는 스크립팅 언어로 구현될 수 있다. 메모리에는 깊이 맵 획득 모듈, 법선 벡터 보정 모듈, 및 깊이 값 보정 모듈에 관한 명령 어들, 알고리즘, 데이터 구조, 또는 프로그램 코드가 저장되어 있을 수 있다. 메모리에 포함되는 '모듈'은 프로세서에 의해 수행되는 기능이나 동작을 처리하는 단위를 의미하고, 이는 명령어들, 알고리즘, 데이터 구조, 또는 프로그램 코드와 같은 소프트웨어로 구현될 수 있다. 이하의 실시예에서, 프로세서는 메모리에 저장된 명령어들 또는 프로그램 코드들을 실행함으로써 구 현될 수 있다. 깊이 맵 획득 모듈은 카메라를 이용하여 획득된 이미지에 기초하여 객체에 관한 깊이 맵(depth map) 을 획득하는 기능 및/또는 동작과 관련된 명령어들 또는 프로그램 코드로 구성된다. 본 개시의 일 실시예에서, 깊이 맵 획득 모듈은 인공지능 모델을 이용하여 깊이 맵을 획득하도록 구성될 수 있다. 프로세서는 깊이 맵 획득 모듈과 관련된 명령어들 또는 프로그램 코드를 실행함으로써, 깊이 맵을 획득할 수 있다. 본 개시의 일 실시예에서, 카메라는 좌안 카메라 및 우안 카메라를 포함하는 스테레오 카메라(stereo camer a)일 수 있다. 이 경우, 프로세서는 좌안 카메라를 이용하여 획득된 좌안 이미지 및 우안 카메라를 이용하 여 획득된 우안 이미지를 인공지능 모델에 입력하고, 인공지능 모델을 이용하여 좌안 이미지와 우안 이미지의 픽셀 휘도값 유사도에 따른 시차(disparity)를 계산함으로써 깊이 맵을 획득할 수 있다. 인공지능 모델은 심층 신경망 모델(deep neural network model)로 구현될 수 있다. 심층 신경망 모델은 컨볼루션 신경망 모델 (Convolutional Neural Network; CNN), 순환 신경망 모델(Recurrent Neural Network; RNN), RBM(Restricted Boltzmann Machine), DBN(Deep Belief Network), BRDNN(Bidirectional Recurrent Deep Neural Network) 또는 심층 Q-네트워크 (Deep Q-Networks) 등 공지의 인공지능 모델로 구현될 수도 있다. 깊이 맵을 획득하는데 이용 되는 심층 신경망 모델은 예를 들어, DispNet일 수 있으나, 이에 한정되는 것은 아니다.본 개시의 일 실시예에서, 프로세서는 플레인 스윕(plane sweep) 방식을 통해 좌안 이미지와 우안 이미지 간의 시차(disparity)를 계산함으로써, 깊이 맵을 획득할 수 있다. 본 개시의 일 실시예에서, 카메라는 ToF 카메라로 구성되고, 프로세서는 ToF 카메라를 이용하여 획득 된 반사광이 검출된 시점과 클럭 신호가 입력된 시점 간의 시간 차이인 광의 비행 시간(time of flight)을 계산 하고, 비행 시간과 빛의 속도 간의 연산을 통해 반사광이 검출된 위치와 증강 현실 디바이스 간의 거리, 즉 깊이 값을 산출할 수 있다. 프로세서는 광이 조사되고, 반사광이 검출된 위치에 관한 정보를 획득하고, 획득된 위치 정보에 산출된 깊이 값을 매핑함으로써 깊이 맵을 획득할 수 있다. 법선 벡터 보정 모듈은 깊이 맵에 포함되는 복수의 픽셀들 각각의 법선 벡터(normal vector)를 획득하고, IMU 센서에 의해 획득된 중력 방향에 따라 법선 벡터를 보정하는 기능 및/또는 동작과 관련된 명령어들 또 는 프로그램 코드로 구성된다. 프로세서는 법선 벡터 보정 모듈과 관련된 명령어들 또는 프로그램 코 드를 실행함으로써, 적어도 하나의 픽셀의 법선 벡터를 획득하고, 획득된 법선 벡터의 방향을 보정할 수 있다. 본 개시의 일 실시예에서, 프로세서는 깊이 맵에 포함된 복수의 픽셀들의 방향 벡터 및 복수의 픽셀들의 깊이 값에 기초하여 복수의 픽셀들 각각을 3차원 좌표값으로 변환하고, 변환된 픽셀들 각각을 기준으로 상하좌 우 방향으로 인접한 인접 픽셀들의 3차원 좌표값의 외적(cross-product)을 계산함으로써, 픽셀 별 법선 벡터를 획득할 수 있다. 프로세서는 IMU 센서의 자이로 센서에 의해 측정된 측정값에 기초하여 중력 방향에 관한 정보를 획득 하고, 중력 방향에 기초하여 픽셀 별 법선 벡터의 방향을 보정할 수 있다. 본 개시의 일 실시예에서, 프로세서 는 중력 방향 뿐만 아니라, 중력 방향에 대하여 수직하는 방향을 따라 픽셀 별 법선 벡터의 방향을 보정할 수 있다. 예를 들어, 수직 방향에 가까운 법선 벡터를 갖는 픽셀에 대하여 프로세서는 법선 벡터의 방향을 중력 방향과 평행한 방향으로 보정할 수 있다. 예를 들어, 지면에 대하여 수평 방향에 가까운 법선 벡터를 갖는 픽셀(예를 들어, 벽, 기둥 등 객체를 나타내는 픽셀)에 대하여 프로세서는 중력 방향에 대하여 수직하는 방향으로 법선 벡터의 방향을 보정할 수 있다. 프로세서가 픽셀 별 법선 벡터를 획득하고, 획득된 법선 벡터의 방향을 보정하는 구체적인 실시예는 도 4, 도 5, 도 6a, 및 도 6b에서 상세하게 설명하기로 한다. 깊이 값 보정 모듈은 보정된 법선 벡터의 방향에 기초하여 깊이 맵의 적어도 하나의 픽셀의 깊이 값을 보 정하는 기능 및/또는 동작과 관련된 명령어들 또는 프로그램 코드로 구성된다. 프로세서는 깊이 값 보정 모듈과 관련된 명령어들 또는 프로그램 코드를 실행함으로써, 적어도 하나의 픽셀의 깊이 값을 보정할 수 있다. 본 개시의 일 실시예에서, 프로세서는 인공지능 모델의 트레이닝(training) 과정에서 출력된 깊이 맵의 손실값(loss)을 산출하고, 산출된 손실값을 인공지능 모델에 적용하는 트레이닝을 수행함으로써, 깊이 맵 의 적어도 하나의 픽셀의 깊이 값을 보정할 수 있다. 프로세서는 보정된 법선 벡터에 의해 정의되는 평면 상의 픽셀의 깊이 값 및 위치 상으로 인접한 인접 픽셀들의 깊이 값에 기초하여 손실값을 산출할 수 있다. 본 개시의 일 실시예에서, 프로세서는 정의된 평면과 카메라의 광선 벡터(ray vector)가 만나는 복수의 포인트에 기초하여 인접 픽셀들의 깊이 값을 획득하고, 픽셀의 깊이 값과 인접 픽셀들의 깊이 값 간의 차이값을 각각 산출하며, 인접 픽셀들 별로 산출된 차이값에 가중치를 적용하는 가중합(weighted sum) 연산을 통해 손실 값을 산출할 수 있다. 본 개시의 일 실시예에서, 가중합 연산에 적용되는 가중치는 깊이 맵에서의 인접 픽셀들의 위치와 카메라 의 위치 간의 거리에 기초하여 결정되는 제1 가중치 및 깊이 맵 내의 픽셀과 인접 픽셀들 간의 휘도값 차이에 기초하여 결정되는 제2 가중치를 포함할 수 있다. 프로세서가 보정된 법선 벡터에 의해 정의되는 평면과 카메라의 위치 관계에 따라 손실값을 산출하고, 산출된 손실값을 이용하여 인공지능 모델을 트레이닝함으 로써 적어도 하나의 픽셀의 깊이 값을 보정하는 구체적인 실시예에 대해서는 도 7 내지 도 10에서 상세하게 설 명하기로 한다. 본 개시의 일 실시예에서, 프로세서는 보정된 법선 벡터의 방향 또는 보정된 법선 벡터의 방향에 수직하는 방향을 따라 픽셀 별 평면을 가정(plane hypothesis)하고, 가정된 평면에 따라 플레인 스윕(plane sweep)을 수 행함으로써 적어도 하나의 픽셀의 깊이 값을 획득할 수 있다. 프로세서는 획득된 깊이 값을 이용하여 깊이 맵의 적어도 하나의 픽셀의 깊이 값을 보정할 수 있다. 프로세서가 보정된 법선 벡터에 기초하여 정의된 평면을 따라 플레인 스윕을 수행함으로써 적어도 하나의 픽셀의 깊이 값을 보정하는 구체적인 실시예에 대해서 는 도 12 및 도 13에서 상세하게 설명하기로 한다.본 개시의 일 실시예에서, 프로세서는 ToF 카메라를 이용하여 RGB 이미지 및 깊이 맵 이미지를 획득할 수 있다. 프로세서는 보정된 법선 벡터에 기초하여 깊이 맵 이미지에서 픽셀 별 평면을 정의하고, RGB 이미지 의 색상 정보에 따라 분할된 영역에 기초하여 깊이 맵 이미지에서의 평면 영역을 식별할 수 있다. 프로세서 는 식별된 평면 영역 내에서 보정 대상 픽셀의 깊이 값을 동일 평면 영역 내의 인접 픽셀들의 깊이 값에 기초하여 픽셀의 깊이 값을 보정할 수 있다. 여기서, '보정 대상 픽셀'은 깊이 값의 보정이 필요한 픽셀로서, 평면 영역 내에서 깊이 값을 갖지 않은 픽셀(깊이 값이 미획득된 픽셀) 또는 평면 영역 내의 인접 픽셀들과의 깊이 값 차이가 기 설정된 임계치를 초과하는 픽셀을 의미한다. 프로세서가 ToF 카메라를 이용하여 획득된 깊이 맵 이미지에서 RGB 이미지에 의해 평면 영역을 식별하고, 식별된 평면 영역 내에서 적어도 하나의 픽셀의 깊이 값을 보정하는 구체적인 실시예에 대해서는 도 14 및 도 15에서 상세하게 설명하기로 한다. 도 3은 본 개시의 일 실시예에 따른 증강 현실 디바이스의 동작 방법을 도시한 흐름도이다. 단계 S310에서, 증강 현실 디바이스는 카메라를 이용하여 획득한 이미지로부터 깊이 맵(depth map)을 획득 한다. 본 개시의 일 실시예에서, 카메라는 좌안 카메라 및 우안 카메라를 포함하는 스테레오 카메라(stereo camera)일 수 있고, 증강 현실 디바이스는 좌안 카메라를 이용하여 획득된 좌안 이미지 및 우안 카메라를 이용하여 획득된 우안 이미지를 인공지능 모델에 입력하고, 인공지능 모델을 이용하여 좌안 이미지와 우안 이미 지의 픽셀 휘도값 유사도에 따른 시차(disparity)를 계산함으로써 깊이 맵을 획득할 수 있다. 인공지능 모델은 심층 신경망 모델(deep neural network model)로 구현될 수 있다. 깊이 맵을 획득하는데 이용되는 심층 신경망 모델은 예를 들어, DispNet일 수 있으나, 이에 한정되는 것은 아니다. 본 개시의 일 실시예에서, 증강 현실 디바이스는 플레인 스윕(plane sweep) 방식을 통해 좌안 이미지와 우 안 이미지 간의 시차(disparity)를 계산함으로써, 깊이 맵을 획득할 수 있다. 본 개시의 일 실시예에서, 카메라는 ToF 카메라로 구성되고, 증강 현실 디바이스는 ToF 카메라를 이용하여 획득된 광의 비행 시간(time of flight)에 기초하여 깊이 맵을 획득할 수 있다. 단계 S320에서, 증강 현실 디바이스는 깊이 맵에 포함된 적어도 하나의 픽셀의 법선 벡터(normal vector) 를 획득한다. 본 개시의 일 실시예에서, 증강 현실 디바이스는 깊이 맵에 포함된 복수의 픽셀들 각각의 방 향 벡터 및 깊이 값에 기초하여 복수의 픽셀들을 3차원 좌표값으로 변환할 수 있다. 증강 현실 디바이스는 변환된 3차원 좌표값을 이용하여 픽셀 별 법선 벡터를 획득할 수 있다. 단계 S330에서, 증강 현실 디바이스는 IMU 센서에 의해 측정된 중력 방향에 기초하여 적어도 하나의 픽셀 의 법선 벡터의 방향을 보정한다. 수직 방향에 가까운 법선 벡터를 갖는 픽셀의 경우 증강 현실 디바이스 는 법선 벡터의 방향을 중력 방향과 평행한 방향으로 보정할 수 있다. 지면에 대하여 수평 방향에 가까운 법선 벡터를 갖는 픽셀의 경우 증강 현실 디바이스는 중력 방향에 수직하는 방향으로 법선 벡터의 방향을 보정 할 수 있다. 단계 S340에서, 증강 현실 디바이스는 보정된 법선 벡터의 방향에 기초하여 깊이 맵의 적어도 하나의 픽셀 의 깊이 값을 보정한다. 단계 S310에서 인공지능 모델을 이용하여 깊이 맵을 획득한 경우, 증강 현실 디바이스 는 인공지능 모델의 트레이닝(training) 과정에서 획득된 깊이 맵의 손실값(loss)을 산출하고, 산출된 손 실값을 인공지능 모델에 적용하는 트레이닝을 수행함으로써 깊이 맵에 포함되는 적어도 하나의 픽셀의 깊이 값 을 보정할 수 있다. 증강 현실 디바이스는 보정된 법선 벡터에 의해 정의되는 평면 상의 픽셀의 깊이 값 및 위치 상으로 인접한 인접 픽셀들의 깊이 값에 기초하여 손실값을 산출할 수 있다. 본 개시의 일 실시예에서, 증강 현실 디바이스는 정의된 평면과 카메라의 광선 벡터(ray vector)가 만나는 복수의 포인트에 기초하여 인접 픽셀들의 깊이 값을 획득하고, 픽셀의 깊이 값과 인접 픽셀들의 깊이 값 간의 차이값을 각각 산출하며, 인 접 픽셀들 별로 산출된 차이값에 가중치를 적용하는 가중합(weighted sum) 연산을 통해 손실값을 산출할 수 있 다. 본 개시의 일 실시예에서, 증강 현실 디바이스는 깊이 맵 내의 인접 픽셀들의 위치와 카메라의 위치 간의 거리에 기초하여 결정되는 제1 가중치 및 깊이 맵 내의 픽셀과 인접 픽셀들 간의 휘도값 차이에 기초하여 결정되는 제2 가중치를 이용하는 가중합 연산을 통해 손실값을 획득할 수 있다. 본 개시의 일 실시예에서, 증강 현실 디바이스는 보정된 법선 벡터의 방향 또는 보정된 법선 벡터의 방향 에 수직하는 방향을 따라 픽셀 별 평면을 정의하는 평면 가정(plane hypothesis)을 수행할 수 있다. 증강 현실 디바이스는 평면 가정에 의해 정의된 평면을 따라 플레인 스윕(plane sweep)을 수행함으로써 적어도 하나 의 픽셀의 깊이 값을 획득할 수 있다. 증강 현실 디바이스는 획득된 깊이 값을 이용하여 깊이 맵에 포함된적어도 하나의 픽셀의 깊이 값을 보정할 수 있다. 단계 S310에서 ToF 카메라를 이용하여 깊이 맵을 획득한 경우, 증강 현실 디바이스는 ToF 카메라를 이용하 여 RGB 이미지를 획득할 수 있다. 본 개시의 일 실시예에서, 증강 현실 디바이스는 보정된 법선 벡터에 기 초하여 깊이 맵에서 픽셀 별 평면을 정의하고, RGB 이미지의 색상 정보에 따라 분할된 영역에 기초하여 깊이 맵 에서의 평면 영역을 식별할 수 있다. 증강 현실 디바이스는 식별된 평면 영역 내의 보정 대상 픽셀의 깊이 값을 동일 평면 내의 인접 픽셀들의 깊이 값에 기초하여 보정할 수 있다. 도 4는 본 개시의 일 실시예에 따른 증강 현실 디바이스가 픽셀 별 법선 벡터(normal vector)를 획득하는 방법을 도시한 흐름도이다. 도 4에 도시된 단계 S410 및 S420은 도 3에 도시된 단계 S320을 구체화한 단계들이다. 도 4에 도시된 단계 S410 은 도 3의 단계 S310이 수행된 이후에 수행될 수 있다. 도 4에 도시된 단계 S420이 수행된 이후에는 도 3의 단 계 S330이 수행될 수 있다. 도 5는 본 개시의 일 실시예에 따른 증강 현실 디바이스가 깊이 맵으로부터 픽셀 별 법선 벡터를 획득하는 동작을 도시한 도면이다. 이하에서는, 도 4 및 도 5를 함께 참조하여 증강 현실 디바이스의 동작에 대하여 설명한다. 도 4의 단계 S410을 참조하면, 증강 현실 디바이스는 깊이 맵에 포함된 픽셀들의 방향 벡터 및 픽셀들의 깊이 값에 기초하여, 픽셀들을 3차원 좌표값으로 변환한다. 도 5를 함께 참조하면, 증강 현실 디바이스의 프로세서(130, 도 2 참조)는 깊이 맵으로부터 제1 픽셀의 방향 벡터와 깊이 값(Di,j), 복수의 인접 픽 셀들(502 내지 505) 각각의 방향 벡터와 깊이 값(Di-1, j, Di+1, j, Di, j-1, Di, j+1)을 획득할 수 있다. 도 5에 도시 된 실시예에서, 제1 픽셀은 깊이 맵에 포함되는 복수의 픽셀들 중 i열(i-th column)과 j행(j-th row)에 배치된 픽셀을 나타내고, Di,j의 깊이 값을 가질 수 있다. 복수의 인접 픽셀들(501 내지 505)은 제1 픽셀 을 기준으로 상하좌우 방향으로 인접하게 배치되는 픽셀들로서, 각각 Di-1, j, Di+1,j, Di, j-1, 및 Di, j+1의 깊 이 값을 가질 수 있다. 예를 들어, 제2 픽셀은 i-1열, j행에 배치되는 픽셀로서, Di-1, j의 깊이 값을 가지 고, 제3 픽셀은 i+1열, j행에 배치되는 픽셀로서, Di+1, j의 깊이 값을 가질 수 있다. 제4 픽셀 및 제5 픽셀은 각각 Di, j-1, 및 Di, j+1의 깊이 값을 가질 수 있다. 프로세서는 제1 픽셀의 방향 벡터 및 깊이 값(Di,j)과 복수의 인접 픽셀들(502 내지 505) 각각의 방향 벡터 및 깊이 값(Di-1, j, Di+1, j, Di, j-1, Di, j+1)에 기초하여 제1 픽셀과 복수의 인접 픽셀들(502 내지 505) 을 3차원 공간 상의 3차원 좌표값(Pi,j, Pi-1, j, Pi+1, j, Pi, j-1, Pi, j+1)으로 변환할 수 있다. 본 개시의 일 실시예에서, 프로세서는 하기의 수식 1을 통해 제1 픽셀 및 복수의 인접 픽셀들(502 내지 505)을 3차 원 공간 내의 3차원 좌표값으로 변환할 수 있다. 수학식 1"}
{"patent_id": "10-2022-0101583", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "item": 2, "content": "도 5에 도시된 실시예에서, 프로세서는 상기 수식 1의 연산을 통해, 제1 픽셀을 Pi, j로 변환하고, 복 수의 인접 픽셀들(502 내지 505)을 Pi-1, j, Pi+1, j, Pi, j-1, Pi, j+1로 각각 변환할 수 있다. 도 4의 단계 S420을 참조하면, 증강 현실 디바이스는 상하좌우 방향으로 인접한 복수의 인접 픽셀들의 3차 원 좌표값의 외적(cross-product)을 계산함으로써, 픽셀 별 법선 벡터를 획득한다. 도 5를 함께 참조하면, 증강현실 디바이스의 프로세서는 제1 픽셀의 3차원 좌표값(Pi,j)을 기준으로 상하좌우 방향으로 인접한 복 수의 인접 픽셀들의 3차원 좌표값(Pi-1, j, Pi+1, j, Pi, j-1, Pi, j+1)의 외적을 계산할 수 있다. 본 개시의 일 실시예 에서, 프로세서는 수식 2의 연산을 통해 제1 픽셀에 관한 법선 벡터(Ni,j)를 획득할 수 있다. 수학식 2"}
{"patent_id": "10-2022-0101583", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "item": 3, "content": "도 5에 도시된 실시예에서, 프로세서는 상기 수식 2의 연산을 통해, 제1 픽셀에 대하여 좌우 방향으로 인 접한 제2 픽셀 및 제3 픽셀의 3차원 좌표값(Pi-1, j, Pi+1, j)의 차와 제1 픽셀에 대하여 상하 방향으로 인접한 제4 픽셀 및 제5 픽셀의 3차원 좌표값(Pi, j-1, Pi, j+1)의 차를 계산하고, 차의 벡터 곱을 연산함으로써, 제1 픽셀의 법선 벡터(Ni,j)를 획득할 수 있다. 법선 벡터(Ni,j)는 제1 픽셀 내지 제5 픽셀로 구성된 평면을 정의하는 벡터일 수 있다. 도 6a는 본 개시의 일 실시예에 따른 증강 현실 디바이스가 중력 방향(G)에 따라 법선 벡터(Ni,j)의 방향을 보정하는 동작을 도시한 도면이다. 도 6a를 참조하면, 증강 현실 디바이스는 IMU 센서, 프로세서, 및 법선 벡터 보정 모듈을 포함할 수 있다. 도 6a에 도시된 구성 요소들은 증강 현실 디바이스가 법선 벡터(Ni,j)의 방향을 보정하는 동작을 설명하기 위한 필수적인 구성만을 도시한 것으로서, 증강 현실 디바이스가 포함하는 구성이 도 6a 에 도시된 바와 같이 한정되는 것은 아니다. IMU 센서는 자이로 센서(gyroscope)를 이용하여 측정한 측정값에 기초하여 중력 방향(G)에 관한 정보를 획 득하고, 중력 방향(G)에 관한 정보를 프로세서에 제공할 수 있다. 프로세서는 법선 벡터 보정 모듈 의 명령어들 또는 프로그램 코드를 실행함으로써, IMU 센서로부터 획득한 중력 방향(G)에 관한 정보 에 기초하여 법선 벡터(Ni,j)의 방향을 보정할 수 있다. 본 개시의 일 실시예에서, 프로세서는 법선 벡터 (Ni,j)의 방향이 수직 방향에 가까운지 또는 수평 방향에 가까운지 여부를 판단하고, 수직 방향에 가까운 경우 중력 방향(G)과 평행한 방향을 갖는 중력 법선 벡터(-NG)에 따라 법선 벡터(Ni,j)의 방향을 보정할 수 있다. 도 6a에 도시된 실시예에서, 법선 벡터(Ni,j)의 방향이 수직 방향과 가까우므로, 프로세서는 법선 벡터(Ni,j)의 방향을 중력 법선 벡터(-NG)에 따라 평행한 방향으로 보정할 수 있다. 보정 결과, 프로세서는 보정된 법선 벡터(N'i,j)를 획득할 수 있다. 프로세서는 보정된 법선 벡터(N'i,j)의 방향에 따라 제1 픽셀의 3차원 좌표값(Pi,j)으로 정의되는 평면의 방 향을 보정할 수 있다. 본 개시의 일 실시예에서, 프로세서는 보정된 법선 벡터(N'i,j)와 보정 전의 법선 벡 터(Ni,j) 사이의 각도 차이만큼 평면의 방향을 보정할 수 있다. 도 6b는 본 개시의 일 실시예에 따른 증강 현실 디바이스가 중력 방향(G)에 대하여 수직 방향으로 법선 벡 터(Ni,j)의 방향을 보정하는 동작을 도시한 도면이다. 도 6b에 도시된 실시예는 제1 픽셀의 법선 벡터(Ni,j)의 방향 및 보정된 법선 벡터(N'i,j)의 방향을 제외하고는 도 6a에 도시된 실시예와 동일하므로, 중복되는 설명은 생략한다. 프로세서는 법선 벡터 보정 모듈의 명령어들 또는 프로그램 코드를 실행함으로써, IMU 센서로부 터 획득한 중력 방향(G)에 관한 정보에 기초하여 법선 벡터(Ni,j)의 방향을 보정할 수 있다. 본 개시의 일 실시 예에서, 프로세서는 법선 벡터(Ni,j)의 방향이 수직 방향에 가까운지 또는 수평 방향에 가까운지 여부를 판 단할 수 있다. 법선 벡터(Ni,j)의 방향이 수평 방향에 가까운 픽셀은 예를 들어, 벽, 기둥 등을 나타내는 픽셀이 거나, 또는 수직 방향으로 배열된 객체를 나타내는 픽셀일 수 있다. 법선 벡터(Ni,j)의 수평 방향에 가깝다고 판 단한 경우, 프로세서는 중력 방향(G)에 수직하는 방향에 따라 법선 벡터(Ni,j)의 방향을 보정할 수 있다. 도 6b에 도시된 실시예에서, 법선 벡터(Ni,j)의 방향은 수평 방향에 가까우므로, 프로세서는 법선 벡터 (Ni,j)의 방향을 중력 방향(G)에 대하여 수직 방향으로 법선 벡터(Ni,j)의 방향을 보정할 수 있다. 보정 결과, 프 로세서는 보정된 법선 벡터(N'i,j)를 획득할 수 있다. 프로세서는 보정된 법선 벡터(N'i,j)의 방향에 따라 제1 픽셀의 3차원 좌표값(Pi,j)으로 정의되는 평면의 방 향을 보정할 수 있다. 본 개시의 일 실시예에서, 프로세서는 보정된 법선 벡터(N'i,j)와 보정 전의 법선 벡 터(Ni,j) 사이의 각도 차이만큼 평면의 방향을 보정할 수 있다. 도 7은 본 개시의 일 실시예에 따른 증강 현실 디바이스가 인공지능 모델을 이용하여 깊이 맵을 획득하는 트레이닝(training) 동작을 도시한 도면이다. 도 7을 참조하면, 증강 현실 디바이스는 좌안 카메라 및 우안 카메라로 구성된 스테레오 카메라(stereo camera)를 포함할 수 있다. 증강 현실 디바이스는 좌안 카메라를 이용하여 획득된 좌안 이미지(710L) 및 우안 카메라를 이용하여 획득된 우안 이미지(710R)를 인공지능 모델에 입력할 수 있다. 증강 현실 디바이 스는 인공지능 모델을 이용하여 좌안 이미지(710L)와 우안 이미지(710R) 간의 픽셀 간 휘도값 유사도 에 따른 시차(disparity)를 계산함으로써, 깊이 맵을 획득할 수 있다. 본 개시의 일 실시예에서, 인공지능 모델은 심층 신경망 모델(deep neural network model)로 구현될 수 있 다. 심층 신경망 모델은 컨볼루션 신경망 모델(Convolutional Neural Network; CNN), 순환 신경망 모델 (Recurrent Neural Network; RNN), RBM(Restricted Boltzmann Machine), DBN(Deep Belief Network), BRDNN(Bidirectional Recurrent Deep Neural Network) 또는 심층 Q-네트워크 (Deep Q-Networks) 등 공지의 인 공지능 모델로 구현될 수도 있다. 예를 들어, 깊이 맵을 획득하는데 이용되는 심층 신경망 모델은 DispNet 일 수 있으나, 이에 한정되지 않는다. 예를 들어, 인공지능 모델이 DispNet과 같은 컨볼루션 신경망 모델로 구현되는 경우, 인공지능 모델 은 좌안 이미지(701L) 및 우안 이미지(710R) 각각을 컨볼루션함으로써 특징 맵(feature map)을 추출할 수 있다. 좌안 이미지(710L)와 우안 이미지(710R) 각각의 특징 맵 추출 과정에서 가중치들(weights)은 같은 값으로 서로 공유될 수 있다. 인공지능 모델은 좌안 이미지(710L) 및 우안 이미지(710R)로부터 각각 추출된 특징 맵 간 의 차이값을 3차원 코스트 볼륨(3D cost volume)으로서 누적하고, 누적된 3차원 코스트 볼륨을 업 컨볼루션(up- convolution)하는 계층적 정제(hierarchical refinement)를 수행함으로써 깊이 맵을 출력하도록 트레이닝 (training)될 수 있다. 본 개시의 일 실시예에서, 인공지능 모델에는 IMU 센서 측정값이 입력으로 적 용되고, IMU 센서 측정값은 3차원 코스트 볼륨에 입력될 수 있다. 트레이닝 과정에서 출력된 깊이 맵(73 0)과 좌안 이미지(710L)와 우안 이미지(710R)의 픽셀 휘도값 유사도에 따른 시차(disparity)의 정답값 (groundtruth) 간에는 오차(error)가 존재할 수 있고, 증강 현실 디바이스는 깊이 맵의 오차를 보정 하기 위하여 손실값(loss)을 이용하여 인공지능 모델을 트레이닝할 수 있다. 증강 현실 디바이스는 IMU 센서 측정값에 기초하여 중력 방향에 관한 정보를 획득하고, 중력 방향 또 는 중력 방향에 대하여 수직 방향에 따라 보정된 법선 벡터(N'i,j, 도 6a 및 도 6b 참조)에 의해 정의되는 평면 상의 픽셀들의 깊이 값에 기초하여 손실값을 산출할 수 있다. 증강 현실 디바이스가 손실값을 산출하는 구체적인 실시예에 대해서는 도 8 내지 도 10에서 상세하게 설명하기로 한다. 도 8은 본 개시의 일 실시예에 따른 증강 현실 디바이스가 깊이 맵의 픽셀 별 깊이 값을 보정하는 방법을 도시한 흐름도이다. 도 8에 도시된 단계 S810 및 S820은 도 3에 도시된 단계 S340을 구체화한 단계들이다. 도 8에 도시된 단계 S810 은 도 3의 단계 S330이 수행된 이후에 수행될 수 있다. 단계 S810에서, 증강 현실 디바이스는 보정된 법선 벡터(N'i,j, 도 6a 및 도 6b 참조)에 의해 정의되는 평 면 상의 픽셀 및 복수의 인접 픽셀들의 깊이 값에 기초하여 손실값(loss)(740, 도 7 참조)을 산출한다. 증강 현 실 디바이스가 손실값을 산출하는 구체적인 실시예에 대해서는 도 9 및 도 10을 참조하여 상세하게 설명하기로 한다. 도 9는 본 개시의 일 실시예에 따른 증강 현실 디바이스가 손실값를 산출하는 방법을 도시한 흐름도 이다. 도 9에 도시된 단계 S910 내지 S940은 도 8에 도시된 단계 S810을 구체화한 단계들이다. 도 9에 도시된 단계 S940이 수행된 이후, 도 8의 단계 S820이 수행될 수 있다. 도 10은 본 개시의 일 실시예에 따른 증강 현실 디바이스가 손실값을 산출하는 동작을 도시한 도면이 다. 이하에서는, 도 8의 단계 S810을 도 9 및 도 10을 함께 참조하여 설명한다. 도 9의 단계 S910을 참조하면, 증강 현실 디바이스는 보정된 법선 벡터를 갖는 픽셀 및 픽셀에 위치적으로 인접한 복수의 인접 픽셀들로 구성된 평면을 정의한다. 도 10을 함께 참조하면, 증강 현실 디바이스의 프 로세서(130, 도 2 참조)는 보정된 법선 벡터(N'i,j)를 갖는 제1 픽셀의 3차원 좌표값(Pi,j)과 제1 픽셀과 상하좌 우 방향으로 인접한 위치에 배치되는 복수의 인접 픽셀들의 3차원 좌표값(Pi-1, j, Pi+1, j, Pi, j-1, Pi, j+1)으로 구성 된 평면을 정의할 수 있다. 제1 픽셀의 3차원 좌표값(Pi,j)과 복수의 인접 픽셀들 각각의 3차원 좌표값(Pi-1, j, Pi+1, j, Pi, j-1, Pi, j+1)은 서로 다른 깊이 값을 가질 수 있다. 도 9의 단계 S920에서, 증강 현실 디바이스는 정의된 평면과 카메라의 광선 벡터(ray vector)가 만나는 복 수의 포인트에 기초하여 복수의 인접 픽셀들의 깊이 값을 획득한다. 도 10을 함께 참조하면, 프로세서는 단계 S910에서 정의된 평면과 카메라의 광선 벡터(R)가 만나는 복수의 포인트를 식별할 수 있다. 카메라 의 광선 벡터(R)는 카메라와 평면 간의 거리 또는 높이 중 적어도 하나를 포함하는 위치 관계 및 카 메라의 방향에 기초하여 결정될 수 있다. 프로세서는 식별된 복수의 포인트들의 깊이 값(D'i,j, D'i-1, j, D'i+1, j, D'i, j-1, D'i, j+1)을 획득할 수 있다. 도 10에 도시된 실시예에서, 제1 깊이 값(D'i,j)은 제1 픽셀의 3 차원 좌표값(Pi,j)의 깊이 값과 동일할 수 있다. 제2 깊이 값(D'i-1, j)은 제2 픽셀의 3차원 좌표값(Pi-1, j)과 동일 한 깊이 값을 가질 수 있다. 그러나, 제2 깊이 값(D'i-1, j)을 갖는 제2 포인트의 위치는 제2 픽셀의 3차원 좌표 값(Pi-1, j)의 위치와는 다를 수 있다. 마찬가지로, 제3 깊이 값(D'i+1, j)은 제3 픽셀의 3차원 좌표값(Pi+1, j)과 동 일한 깊이 값을 갖지만, 제3 포인트의 위치는 제3 픽셀의 3차원 좌표값(Pi+1, j)의 위치와는 다를 수 있다. 도 9의 단계 S930에서, 증강 현실 디바이스는 픽셀의 깊이 값과 복수의 인접 픽셀들의 깊이 값 간의 차이 값을 각각 산출한다. 도 10을 함께 참조하면, 프로세서는 하기의 수식 3에 기초하여 제1 픽셀의 깊이 값 (D'i,j)과 복수의 인접 픽셀들의 깊이 값(D'i-1, j, D'i+1, j, D'i, j-1, D'i, j+1) 간의 차이값(dpq)을 각각 산출할 수 있다. 수학식 3"}
{"patent_id": "10-2022-0101583", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "상기 수식 3에서 D'p는 보정된 법선 벡터(N'i,j)를 갖는 기준 픽셀인 제1 픽셀의 깊이 값(D'i,j)를 나타내고, D'q 는 제1 픽셀과 위치적으로 인접한 복수의 인접 픽셀들 각각의 깊이 값(D'i-1, j, D'i+1, j, D'i, j-1, D'i, j+1)을 나타 낸다. 수식 3에 따르면, 프로세서는 D'i,j - D'i-1, j, D'i,j - D'i+1, j, D'i,j - D'i, j-1, 및 D'i,j - D'i, j+1을 각 각 계산함으로써, dpq를 획득할 수 있다. 도 9의 단계 S940에서, 증강 현실 디바이스는 산출된 차이값에 가중치를 적용하는 가중합(weighted sum) 연산을 통해 손실값을 획득한다. 도 10을 함께 참조하면, 프로세서는 산출된 차이값 dpq에 제1 가중치(wqD) 및 제2 가중치(wpqC)를 적용하는 가중합 연산을 통해 손실값(Lossg)을 획득할 수 있다. 본 개시의 일 실시예에서, 손실값(Lossg)은 하기의 수식 4에 의해 산출될 수 있다. 수학식 4"}
{"patent_id": "10-2022-0101583", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 5, "content": "상기 수식 4에서 제1 가중치(wqD)는 깊이 맵(730, 도 7 참조)에서의 복수의 인접 픽셀들의 위치와 카메라의 위치 사이의 거리에 기초하여 결정될 수 있다. 본 개시의 일 실시예에서, 제1 가중치(wqD)는 하기 수식 5와 같이 깊이 맵에서의 복수의 인접 픽셀들의 깊이 값(Di-1, j, Di+1, j, Di, j-1, Di, j+1)에 기초하여 산출될 수 있다. 수학식 5"}
{"patent_id": "10-2022-0101583", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 6, "content": "상기 수식 5를 참조하면, Dq는 깊이 맵 내의 복수의 인접 픽셀들의 깊이 값(Di-1, j, Di+1, j, Di, j-1, Di, j+1)을 나타내고, 복수의 인접 픽셀들의 깊이 값(Di-1, j, Di+1, j, Di, j-1, Di, j+1)이 작으면 작을수록 제1 가중치(wqD)의 값 은 커지게 된다. 복수의 인접 픽셀들의 깊이 값(Di-1, j, Di+1, j, Di, j-1, Di, j+1), 즉 인접 픽셀들과 카메라 간의 거리가 가까울수록 제1 가중치(wqD)의 값이 커질 수 있다. 스테레오 카메라(stereo camera)를 이용하는 깊 이 맵 추출 방식에서 거리가 멀어질수록 깊이 값의 정확도가 떨어지므로, 수식 5는 카메라와의 거리 가 가까운 픽셀에 가중치를 더 부여하도록 설계되었다. 상기 수식 4에서 제2 가중치(wpqC)는 깊이 맵에서의 제1 픽셀과 복수의 인접 픽셀들 간의 픽셀 휘도값 차이 에 기초하여 결정될 수 있다. 본 개시의 일 실시예에서, 제2 가중치(wpqC)는 하기 수식 6과 같이 깊이 맵에 서의 픽셀 간 휘도값 차이에 기초하여 산출될 수 있다. 수학식 6"}
{"patent_id": "10-2022-0101583", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 7, "content": "상기 수식 6을 참조하면, Ip는 깊이 맵 내의 제1 픽셀의 휘도값을 나타내고, Iq는 복수의 인접 픽셀들의 휘 도값을 나타낸다. 제1 픽셀의 휘도값과 복수의 인접 픽셀들 휘도값 각각의 차이값이 작을수록 제2 가중치(wpqC) 의 값은 커지게 된다. 깊이 맵 상에서 픽셀의 휘도값이 유사할수록 동일 또는 유사한 깊이 값을 가질 확률 이 높으므로, 수식 6은 깊이 맵에서의 픽셀의 휘도값의 차이값에 가중치를 더 부여하도록 설계되었다. 다시 도 8을 참조하면, 단계 S820에서 증강 현실 디바이스는 산출된 손실값(Lossg, 도 10 참조)을 인공지 능 모델에 적용하는 트레이닝을 수행함으로써, 깊이 맵의 적어도 하나의 픽셀의 깊이 값을 보정한다. 도 8 내지 도 10에 도시된 실시예에서, 손실값(Lossg)은 보정된 법선 벡터(N'i,j, 도 6a 및 도 6b 참조)에 의해 정의된 평면과 카메라의 광선 벡터(R)에 의한 깊이 값(D'i,j, D'i-1, j, D'i+1, j, D'i, j-1, D'i, j+1)에 기초하여 결정될 수 있다. 특히, 손실값(Lossg)은 깊이 맵에서의 카메라와의 거리에 기초하여 결정되는 제1 가중치 (wqD) 및 깊이 맵의 픽셀 별 휘도값 차이에 기초하여 결정되는 제2 가중치(wpqC)가 적용되어 산출되는 바, 손실값 (Lossg)을 인공지능 모델에 적용하는 트레이닝을 통해 깊이 값의 정확도가 향상될 수 있다. 도 11은 본 개시의 일 실시예에 따른 증강 현실 디바이스가 인공지능 모델을 이용하여 깊이 맵 을 획득하는 동작을 도시한 도면이다. 도 11을 참조하면, 증강 현실 디바이스는 좌안 카메라 및 우안 카메라로 구성된 스테레오 카메라(stereo camera)를 포함할 수 있다. 증강 현실 디바이스는 좌안 카메라를 이용하여 획득된 좌안 이미지(1110L), 우 안 카메라를 이용하여 획득된 우안 이미지(1110R), 및 IMU 센서 측정값을 인공지능 모델에 입력하 고, 인공지능 모델을 이용하는 추론을 수행함으로써 깊이 맵을 획득할 수 있다. 인공지능 모델은 도 7에 도시된 실시예와 같이, 손실값(740, 도 7 참조)을 적용하여 트레이닝된(trained) 모델일 수 있다. 증강 현실 디바이스는 IMU 센서(120, 도 2 참조)에 의해 측정된 IMU 센서 측정값을 인공지능 모델에 입력하고, 입력된 IMU 센서 측정값은 3차원 코스트 볼륨에 적용될 수 있다. 인공 지능 모델의 추론 과정에서, 3차원 코스트 볼륨의 업 컨볼루션 등 계층적 정제(hierarchical refinemen t)를 거쳐 깊이 맵이 출력될 수 있다. 도 11에 도시된 실시예에서, 증강 현실 디바이스는 중력 방향에 관한 정보를 포함하는 IMU 센서 측정값 을 이용하여 트레이닝된 인공지능 모델을 이용하여 깊이 맵을 획득하는 바, 깊이 맵의 깊이 값 정확도를 향상시킬 수 있다. 또한, 본 개시의 일 실시예에 따른 증강 현실 디바이스는 필수 구성 요소인 IMU 센서로부터 획득된 IMU 센서 측정값을 이용하여 인공지능 모델을 트레이닝하므로, 추가 하드웨어 모듈이 필요하지 않고, 이로 인하여 소형 폼팩터를 유지하면서도 낮은 전력 소모량을 구현하는 기술적 효과를 제공할 수 있다. 도 12는 본 개시의 일 실시예에 따른 증강 현실 디바이스가 깊이 맵의 픽셀 별 깊이 값을 보정하는 방법을 도시한 흐름도이다. 도 12에 도시된 단계 S1210은 도 3에 도시된 단계 S330에 포함되는 단계이다. 도 12에 도시된 단계 S1220 내지 S1240은 도 3에 도시된 단계 S340을 구체화한 단계들이다. 도 13은 본 개시의 일 실시예에 따른 증강 현실 디바이스가 플레인 스윕(plane sweep) 방식을 통해 깊이 맵의 픽셀 별 깊이 값을 보정하는 동작을 도시한 도면이다. 이하에서는, 도 12 및 도 13을 함께 참조하여 증강 현실 디바이스가 깊이 맵의 픽셀 별 깊이 값을 보정하는 동작을 설명한다. 도 12를 참조하면, 단계 S1210에서 증강 현실 디바이스는 IMU 센서(120, 도 2 참조)에 의해 측정된 중력 방향에 기초하여 좌안 이미지 및 우안 이미지의 법선 벡터의 방향을 보정한다. 도 13을 함께 참조하면, 증강 현 실 디바이스는 좌안 카메라 및 우안 카메라를 포함하는 스테레오 카메라(stereo camera)를 포함할 수 있다. 증강 현실 디바이스의 프로세서(130, 도 2 참조)는 IMU 센서(120, 도 2 참조)의 자이로 센서 (gyroscope)로부터 중력 방향 정보를 획득하고, 획득된 중력 방향 정보에 기초하여 좌안 카메라를 이용하여 획 득된 좌안 이미지(1310L) 및 우안 카메라를 이용하여 획득된 우안 이미지(1310R)의 픽셀 별 법선 벡터의 방향을 보정할 수 있다. 본 개시의 일 실시예에서, 프로세서는 중력 방향 또는 중력 방향에 수직하는 방향으로 픽 셀 별 법선 벡터의 방향을 보정할 수 있다. 법선 벡터의 방향을 보정하는 구체적인 방법은 도 6a 및 도 6b에서 설명한 것과 동일하므로, 중복되는 설명은 생략한다. 도 12를 참조하면, 단계 S1220에서 증강 현실 디바이스는 보정된 법선 벡터의 방향 또는 보정된 법선 벡터 의 방향에 대한 수직 방향을 따라 평면 가정(plane hypothesis)을 수행한다. 도 13을 함께 참조하면, 프로세서 는 좌안 이미지(1310L) 및 우안 이미지(1310R) 각각에 대한 평면 가정(plane hypothesis)을 통해 픽셀 별 로 평면을 정의할 수 있다. 프로세서는 좌안 이미지(1310L)에 포함되는 픽셀들 각각의 보정된 법선 벡터의 방향 또는 보정된 법선 벡터의 방향에 대한 수직 방향에 따라 평면 가정을 수행함으로써, 좌안 이미지(1310L)에 서 픽셀 별 평면을 정의할 수 있다. 동일한 방식으로, 프로세서는 우안 이미지(1310R)에 포함되는 픽셀들 각각의 보정된 법선 벡터의 방향 또는 보정된 법선 벡터의 방향에 대한 수직 방향에 따라 평면 가정을 수행함으 로써, 우안 이미지(1310R)에서 픽셀 별 평면을 정의할 수 있다. 도 12를 참조하면, 단계 S1230에서 증강 현실 디바이스는 평면 가정에 의해 정의된 평면을 따라 플레인 스 윕(plane sweep)을 수행함으로써, 픽셀 별 깊이 값을 획득한다. 도 13을 함께 참조하면, 프로세서는 좌안 이미지(1310L)에서 정의된 평면에서의 기준 픽셀의 2차원 위치 좌표값(x, y)을 기준으로 우안 이미지(1310R)에 서의 정합점을 서치하는 플레인 스윕을 수행할 수 있다. 본 개시의 일 실시예에서, 프로세서는 평면 가정 을 통해 좌안 이미지(1310L)에서 정의된 평면과 대응되는 평면을 우안 이미지(1310R)에서 식별하고, 우안 이미 지(1310R)에서 식별된 평면 내에서 정합점을 서치할 수 있다. 본 개시의 일 실시예에서, 프로세서는 우안 이미지(1310R)에서 정의된 평면 내의 픽셀들 중 d0 내지 dmax의 시차 서치 범위(disparity search range) 내에서 좌안 이미지(1310L)의 기준 픽셀에 대응되는 정합점을 서치할 수 있다. 프로세서는 좌안 이미지(1310L)의 평면 내 기준 픽셀과 우안 이미지(1310R)의 대응되는 평면 내의 픽셀들 간의 휘도값 유사도를 측정하고, 픽셀 간 휘도값 비유사도(dissimilarity)와 시차(disparity) 간의 관계를 나타내는 그래프에 기초하여 우안 이 미지(1310R)에서 휘도값 비유사도가 가장 낮은 픽셀을 정합점으로서 식별할 수 있다. 프로세서는 좌안 이 미지(1310L)의 기준 픽셀의 위치와 우안 이미지(1310R)에서 정합점으로서 식별된 픽셀 간의 거리(dx)를 시차로 결정할 수 있다. 프로세서는 전술한 방식으로 좌안 이미지(1310L) 및 우안 이미지(1310R)의 모든 픽셀에 대하여 플레인 스윕을 수행함으로써, 픽셀 별 깊이 값을 획득할 수 있다. 도 12를 참조하면, 단계 S1240에서 증강 현실 디바이스는 획득된 깊이 값을 이용하여 깊이 맵의 적어도 하 나의 픽셀의 깊이 값을 보정한다. 도 13을 함께 참조하면, 증강 현실 디바이스의 프로세서는 획득된 픽셀 별 깊이 값을 이용하여 깊이 맵의 깊이 값을 보정할 수 있다. 도 12 및 도 13에 도시된 실시예에서, 증강 현실 디바이스는 중력 방향으로 픽셀 별 법선 벡터를 보정하고, 보정된 법선 벡터에 따라 정의된 평면으로 플레인 스윕을 수행함으로써, 높은 정확도를 갖는 깊이 맵 을 획득할 수 있다. 도 14는 본 개시의 일 실시예에 따른 증강 현실 디바이스가 깊이 맵의 픽셀 별 깊이 값을 보정하는 방법을 도시한 흐름도이다. 도 14에 도시된 단계 S1410 내지 S1430은 도 3에 도시된 단계 S340을 구체화한 단계들이다. 도 14에 도시된 단 계 S1410은 도 3의 단계 S330이 수행된 이후에 수행될 수 있다. 도 15는 본 개시의 일 실시예에 따른 증강 현실 디바이스가 ToF(Time-of-Flight) 방식을 통해 획득된 깊이 맵 이미지의 픽셀 별 깊이 값을 보정하는 동작을 도시한 도면이다. 도 14를 참조하면, 단계 S1410에서 증강 현실 디바이스는 보정된 법선 벡터에 기초하여 깊이 맵에서 픽셀 별 평면을 정의한다. 본 개시의 일 실시예에서, 증강 현실 디바이스는 ToF 카메라를 포함할 수 있다. ToF 카메라는 광원을 이용하여 객체에 광을 조사하고, 객체로부터 반사된 반사광을 검출하며, 반사광이 검출된 시점 과 광이 조사된 시점 간의 시간 차이인 비행 시간(time of flight)에 기초하여 객체의 깊이 값을 획득하도록 구 성될 수 있다. 도 15를 함께 참조하면, 증강 현실 디바이스는 ToF 카메라를 이용하여 객체의 RGB 이미지 및 깊이 맵 이미지를 획득할 수 있다. 증강 현실 디바이스의 프로세서(130, 도 2 참조)는 깊 이 맵 이미지에서 픽셀 별 법선 벡터를 획득하고, 중력 방향 또는 중력 방향에 대하여 수직하는 방향을 따라 법선 벡터의 방향을 보정할 수 있다. 프로세서는 보정된 법선 벡터의 방향에 기초하여 깊이 맵 이미 지에서의 픽셀 별 평면을 정의할 수 있다. 본 개시의 일 실시예에서, 프로세서는 보정된 법선 벡터 를 갖는 픽셀과 상기 픽셀과 위치적으로 인접한 복수의 인접 픽셀들로 구성된 평면을 정의할 수 있다. 도 14를 참조하면, 단계 S1420에서 증강 현실 디바이스는 RGB 이미지의 색상 정보에 따라 분할된 영역에 기초하여 깊이 맵에서의 평면 영역을 식별한다. 도 15를 함께 참조하면, 증강 현실 디바이스의 프로세서 는 RGB 이미지에 포함되는 복수의 픽셀들 각각의 색상 정보에 기초하여 RGB 이미지를 복수의 영역(1501 내지 1506)으로 분할할 수 있다. 본 개시의 일 실시예에서, 프로세서는 RGB 이미지의 복 수의 픽셀들의 픽셀 별 휘도값에 기초하여 RGB 이미지를 복수의 영역(1501 내지 1506)으로 분할할 수 있 다. 프로세서는 RGB 이미지의 복수의 픽셀들 각각의 휘도값의 차이값을 산출하고, 산출된 차이값이 기 설정된 임계값 이하인 픽셀들을 그룹핑(grouping)함으로써, RGB 이미지를 복수의 영역(1501 내지 1506)으로 분할할 수 있다. 프로세서는 RGB 이미지의 분할된 복수의 영역(1501 내지 1506)의 위치, 형태, 및 크기 중 적어도 하나의 정보에 기초하여 깊이 맵 이미지에서의 평면 영역을 식별할 수 있다. 도 15에 도시된 실시예에서, 프로세서는 깊이 맵 이미지로부터 RGB 이미지의 분할된 복수의 영역 (1501 내지 1506)에 대응되는 복수의 평면 영역(1511 내지 1516)을 식별할 수 있다. 도 14를 참조하면, 단계 S1430에서 증강 현실 디바이스는 식별된 평면 영역 내의 픽셀의 깊이 값을 인접 픽셀들의 깊이 값에 기초하여 보정한다. 본 개시의 일 실시예에서, 증강 현실 디바이스는 깊이 맵 내의 평 면 영역에서 보정 대상 픽셀을 식별하고, 식별된 보정 대상 픽셀의 깊이 값을 동일 평면 영역 내의 인접 픽셀들 의 깊이 값에 기초하여 보정할 수 있다. 본 개시에서, '보정 대상 픽셀'은 깊이 값의 보정이 필요한 픽셀로서, 평면 영역 내에서 깊이 값이 미획득된 픽셀 또는 평면 영역 내의 인접 픽셀들과의 깊이 값 차이가 기 설정된 임 계치를 초과하는 픽셀을 의미한다. 도 15에 도시된 실시예에서, 깊이 맵 이미지로부터 식별된 복수의 평 면 영역(1511 내지 1516) 중에서 제1 평면 영역 내지 제5 평면 영역에는 깊이 값이 미획득된 픽셀 또는 깊이 값의 차이가 기 설정된 임계치를 초과하는 픽셀들이 식별되지 않을 수 있다. 복수의 평면 영역(1511 내지 1516) 중 제6 평면 영역에는 깊이 값이 획득되지 않은 적어도 하나의 보정 대상 픽셀이 식별 될 수 있다. 프로세서는 식별된 보정 대상 픽셀의 깊이 값을 제6 평면 내에 포함되는 복수의 픽셀들 중 인접 픽셀들의 깊이 값에 기초하여 보정할 수 있다. 일반적인 ToF 카메라의 경우, 카메라로부터의 거리가 멀어질수록 깊이 값의 정확도가 떨어지거나, 또는 깊이 값 이 획득되지 않는 문제점이 있다. 도 14 및 도 15에 도시된 실시예에서, 증강 현실 디바이스는 깊이 맵 이 미지에서 픽셀 별 법선 벡터를 중력 방향에 기초하여 보정하고, 보정된 법선 벡터에 기초하여 평면을 정 의하며, RGB 이미지의 픽셀 별 색상 정보에 기초하여 깊이 맵 이미지의 평면 영역을 식별하고, 평 면 영역 내의 보정 대상 픽셀의 깊이 값을 보정하는 바, 깊이 맵의 정확도를 향상시킬 수 있다. 도 16은 일반적인 방식으로 획득된 깊이 맵으로 복원한 3차원 공간 모델 과 본 개시의 일 실시예에 따른 증강 현실 디바이스에 의해 획득된 깊이 맵으로 복원된 3차원 공간 모델을 도시한 도면이다. 도 16을 참조하면, 종래의 일반적인 깊이 맵 획득 방식을 통해 획득된 현실 공간의 3차원 공간 모델 을 참조하면, 객체의 표면이 기울어져 있고, 3차원 공간 모델의 정확도가 낮다. 일반적인 깊이 맵 획득 방식은 카메라로부터의 거리가 멀어질수록 깊이 값의 정확도가 낮아지는 문제점이 있다. 본 개시의 일 실시예에 따른 증강 현실 디바이스는 IMU 센서(120, 도 2 참조)에 의해 측정된 중력 방향 또 는 중력 방향에 수직하는 방향을 따라 픽셀 별 법선 벡터의 방향을 보정하고, 보정된 법선 벡터에 기초하여 픽 셀 별 깊이 값을 보정하므로, 획득된 깊이 맵의 정확도 및 해상도가 일반적인 방식으로 획득된 깊이 맵에 비하여 향상될 수 있다. 또한, 본 개시의 일 실시예에 따른 증강 현실 디바이스에 의해 획득된 깊이 맵으로 복 원된 3차원 공간 모델은 객체의 방향이 중력 방향과 수직 또는 수평한 방향으로 보정되었음을 알 수 있다. 또한, 본 개시의 일 실시예에 따른 증강 현실 디바이스는 필수 구성 요소인 IMU 센서를 이용하여 중 력 방향 정보를 획득하는 바, 소형 폼팩터를 유지하면서도 낮은 전력 소모량을 구현할 수 있다. 이로 인하여 본 개시의 증강 현실 디바이스는 휴대성 및 디바이스 사용 시간을 증가시키고, 사용자 편의성을 향상시키는 기술적 효과를 제공할 수 있다. 본 개시는 중력 방향에 기초하여 깊이 값을 보정하는 증강 현실 디바이스를 제공한다. 본 개시의 일 실시 예에 따른 증강 현실 디바이스는 카메라(110, 도 2 참조), IMU 센서(Inertial Measurement Unit)(120, 도 2 참조), 적어도 하나의 프로세서(130, 도 2 참조), 및 메모리(140, 도 2 참조)를 포함할 수 있다. 적어도 하나 의 프로세서는 메모리에 저장된 적어도 하나의 명령어들을 실행함으로써, 카메라를 이용하여 획 득한 이미지로부터 깊이 맵(depth map)을 획득할 수 있다. 적어도 하나의 프로세서는 깊이 맵에 포함된 적 어도 하나의 픽셀의 법선 벡터(normal vector)를 획득할 수 있다. 적어도 하나의 프로세서는 IMU 센서 에 의해 측정된 중력 방향에 기초하여 상기 적어도 하나의 픽셀의 법선 벡터의 방향을 보정할 수 있다. 적 어도 하나의 프로세서는 보정된 법선 벡터의 방향에 기초하여 상기 적어도 하나의 픽셀의 깊이 값을 보정 할 수 있다. 본 개시의 일 실시예에서, 적어도 하나의 프로세서는 깊이 맵에 포함된 적어도 하나의 픽셀의 방향 벡터 및 상기 적어도 하나의 픽셀의 깊이 값에 기초하여 적어도 하나의 픽셀을 3차원 좌표값으로 변환하고, 상하좌우 방향으로 인접한 복수의 인접 픽셀들의 3차원 좌표값의 외적(cross-product)을 계산함으로써, 법선 벡터를 획득 할 수 있다. 본 개시의 일 실시예에서, 카메라는 좌안 이미지를 획득하는 좌안 카메라 및 우안 이미지를 획득하는 우안 카메라를 포함할 수 있다. 적어도 하나의 프로세서는 좌안 이미지 및 우안 이미지를 인공지능 모델에 입력 으로 적용하고, 인공지능 모델을 이용하여 좌안 이미지와 우안 이미지의 픽셀 휘도값 유사도에 따른 시차 (disparity)를 계산함으로써 깊이 맵을 획득할 수 있다. 본 개시의 일 실시예에서, 적어도 하나의 프로세서는 보정된 법선 벡터에 의해 정의되는 평면 상의 픽셀 및 픽셀과 위치 상으로 인접한 복수의 인접 픽셀들의 깊이 값에 기초하여, 인공지능 모델에 의해 획득된 깊이 맵의 손실값(loss)을 산출할 수 있다. 적어도 하나의 프로세서는 산출된 손실값을 인공지능 모델에 적용하 는 트레이닝(training)을 수행함으로써, 적어도 하나의 픽셀의 깊이 값을 보정할 수 있다. 본 개시의 일 실시예에서, 적어도 하나의 프로세서는 보정된 법선 벡터를 갖는 픽셀 및 픽셀에 위치적으로 인접한 상기 복수의 인접 픽셀들로 구성된 평면을 정의하고, 정의된 평면과 카메라의 광선 벡터(ray vector)가 만나는 복수의 포인트에 기초하여 복수의 인접 픽셀들의 깊이 값을 획득할 수 있다. 적어도 하나의 프로세서는 획득된 픽셀의 깊이 값과 복수의 인접 픽셀들의 깊이 값 간의 차이값을 각각 산출할 수 있다. 적어도 하나의 프로세서는 복수의 인접 픽셀들 별로 산출된 차이값에 가중치를 적용하는 가중합(weighted sum) 연산을 수행함으로써, 손실값을 획득할 수 있다. 본 개시의 일 실시예에서, 가중치는 깊이 맵에서의 복수의 인접 픽셀들 각각의 카메라와의 거리에 기초하여 결 정되는 제1 가중치 및 깊이 맵에서의 픽셀과 복수의 인접 픽셀들 간의 휘도값 차이에 기초하여 결정되는 제2 가 중치를 포함할 수 있다. 본 개시의 일 실시예에서, 적어도 하나의 프로세서는 트레이닝된 인공지능 모델에 좌안 이미지 및 우안 이 미지를 입력하는 추론을 수행함으로써, 보정된 깊이 맵을 획득할 수 있다. 본 개시의 일 실시예에서, 적어도 하나의 프로세서는 카메라는 좌안 이미지를 획득하는 좌안 카메라 및 우안 이미지를 획득하는 우안 카메라를 포함할 수 있다. 적어도 하나의 프로세서는 중력 방향 또는 중 력 방향에 수직한 방향에 따라 좌안 이미지 및 우안 이미지의 적어도 하나의 픽셀의 법선 벡터의 방향을 보정하 고, 보정된 법선 벡터의 방향 또는 보정된 법선 벡터의 방향에 수직하는 방향을 따라 평면 가정(plane hypothesis)을 수행할 수 있다. 적어도 하나의 프로세서는 평면 가정에 의해 정의된 평면을 따라 플레인 스윕(plane sweep)을 수행함으로써, 적어도 하나의 픽셀의 깊이 값을 획득할 수 있다. 적어도 하나의 프로세서는 획득된 깊이 값을 이용하여 깊이 맵의 적어도 하나의 픽셀의 깊이 값을 보정할 수 있다. 본 개시의 일 실시예에서, 카메라는 ToF 카메라(Time-of-Flight camera)로 구성되고, 적어도 하나의 프로 세서는 ToF 카메라를 이용하여 깊이 맵을 획득할 수 있다. 본 개시의 일 실시예에서, 적어도 하나의 프로세서는 보정된 법선 벡터에 기초하여 픽셀 별 평면을 정의할 수 있다. 적어도 하나의 프로세서는 RGB 이미지의 색상 정보에 따라 분할된 영역에 기초하여 깊이 맵에서 정의된 평면의 평면 영역을 식별할 수 있다. 적어도 하나의 프로세서는 식별된 평면 영역 내의 인접 픽셀 들의 깊이 값에 기초하여 깊이 맵의 적어도 하나의 픽셀의 깊이 값을 보정할 수 있다. 본 개시는 증강 현실 디바이스가 깊이 값을 보정하는 방법을 제공한다. 본 개시의 일 실시예에서, 상기 방 법은 카메라를 이용하여 획득한 이미지로부터 깊이 맵(depth map)을 획득하는 단계(S310)를 포함할 수 있 다. 상기 방법은 깊이 맵에 포함된 적어도 하나의 픽셀의 법선 벡터(normal vector)를 획득하는 단계(S320)를 포함할 수 있다. 상기 방법은 IMU 센서에 의해 측정된 중력 방향에 기초하여 적어도 하나의 픽셀의 법선 벡터의 방향을 보정하는 단계(S330)를 포함할 수 있다. 상기 방법은 보정된 법선 벡터의 방향에 기초하여 적어 도 하나의 픽셀의 깊이 값을 보정하는 단계(S340)를 포함할 수 있다. 본 개시의 일 실시예에서, 상기 깊이 맵을 획득하는 단계(S310)는 좌안 카메라를 이용하여 획득된 좌안 이미지 및 우안 카메라를 이용하여 획득된 우안 이미지를 인공지능 모델에 입력하는 단계, 및 인공지능 모델을 이용하 여 좌안 이미지와 우안 이미지의 픽셀 휘도값 유사도에 따른 시차(disparity)를 계산함으로써 깊이 맵을 획득하 는 단계를 포함할 수 있다. 본 개시의 일 실시예에서, 상기 적어도 하나의 픽셀의 깊이 값을 보정하는 단계(S340)는 보정된 법선 벡터에 의 해 정의되는 평면 상의 픽셀 및 픽셀과 위치 상으로 인접한 복수의 인접 픽셀들의 깊이 값에 기초하여, 인공지 능 모델에 의해 획득된 깊이 맵의 손실값(loss)을 산출하는 단계(S810)를 포함할 수 있다. 상기 적어도 하나의 픽셀의 깊이 값을 보정하는 단계(S340)는 산출된 손실값을 상기 인공지능 모델에 적용하는 트레이닝(training) 을 수행함으로써, 깊이 맵의 적어도 하나의 픽셀의 깊이 값을 보정하는 단계(S820)를 포함할 수 있다. 본 개시의 일 실시예에서, 상기 손실값을 산출하는 단계(S810)는 보정된 법선 벡터를 갖는 픽셀 및 픽셀에 위치 적으로 인접한 복수의 인접 픽셀들로 구성된 평면을 정의하는 단계(S910), 및 정의된 평면과 카메라의 광 선 벡터(ray vector)가 만나는 복수의 포인트에 기초하여 복수의 인접 픽셀들의 깊이 값을 획득하는 단계(S92 0)를 포함할 수 있다. 상기 손실값을 산출하는 단계(S810)는 획득된 픽셀의 깊이 값과 복수의 인접 픽셀들의 깊 이 값 간의 차이값을 각각 산출하는 단계(S930)를 포함할 수 있다. 상기 손실값을 산출하는 단계(S810)는 복수 의 인접 픽셀들 별로 산출된 차이값에 가중치를 적용하는 가중합(weighted sum) 연산을 수행함으로써, 손실값을 획득하는 단계(S940)를 포함할 수 있다. 본 개시의 일 실시예에서, 가중치는 깊이 맵에서의 복수의 인접 픽셀들 각각의 카메라와의 거리에 기초하 여 결정되는 제1 가중치 및 깊이 맵에서의 픽셀과 복수의 인접 픽셀들 간의 휘도값 차이에 기초하여 결정되는 제2 가중치를 포함할 수 있다. 본 개시의 일 실시예에서, 상기 방법은 트레이닝된 인공지능 모델에 좌안 이미지 및 우안 이미지를 입력하는 추 론을 수행함으로써, 보정된 깊이 맵을 획득하는 단계를 더 포함할 수 있다. 본 개시의 일 실시예에서, 상기 적어도 하나의 픽셀의 법선 벡터의 방향을 보정하는 단계(S330)는 중력 방향 또 는 중력 방향에 수직한 방향에 따라 좌안 카메라를 이용하여 획득된 좌안 이미지 및 우안 카메라를 이용하여 획 득된 우안 이미지의 법선 벡터의 방향을 보정하는 단계를 포함할 수 있다. 상기 적어도 하나의 픽셀의 깊이 값 을 보정하는 단계(S340)는 보정된 법선 벡터의 방향 또는 보정된 법선 벡터의 방향에 수직하는 방향을 따라 평 면 가정(plane hypothesis)을 수행하는 단계(S1220)를 포함할 수 있다. 상기 적어도 하나의 픽셀의 깊이 값을 보정하는 단계(S340)는 평면 가정에 의해 정의된 평면을 따라 플레인 스윕(plane sweep)을 수행함으로써, 적어 도 하나의 픽셀의 깊이 값을 획득하는 단계(S1230)를 포함할 수 있다. 상기 적어도 하나의 픽셀의 깊이 값을 보 정하는 단계(S340)는 획득된 깊이 값을 이용하여 적어도 하나의 픽셀의 깊이 값을 보정하는 단계(S1240)를 포함 할 수 있다. 본 개시의 일 실시예에서, 상기 깊이 맵을 획득하는 단계(S310)는 ToF 카메라(Time-of-Flight camera)를 이용하 여 깊이 맵을 획득할 수 있다. 본 개시의 일 실시예에서, 상기 적어도 하나의 픽셀의 깊이 값을 보정하는 단계(S340)는 보정된 법선 벡터에 기 초하여 픽셀의 평면을 정의하는 단계(S1410)를 포함할 수 있다. 상기 적어도 하나의 픽셀의 깊이 값을 보정하는 단계(S340)는 RGB 이미지의 색상 정보에 따라 분할된 영역에 기초하여 깊이 맵에서 정의된 평면의 평면 영역을 식별하는 단계(S1420)를 포함할 수 있다. 상기 적어도 하나의 픽셀의 깊이 값을 보정하는 단계(S340)는 식별된 평면 영역 내의 인접 픽셀들의 깊이 값에 기초하여 적어도 하나의 픽셀의 깊이 값을 보정하는 단계(S1430)를 포 함할 수 있다. 본 개시는 컴퓨터로 읽을 수 있는 저장 매체를 포함하는 컴퓨터 프로그램 제품(Computer Program Product)를 제 공한다. 상기 저장 매체는 카메라를 이용하여 획득한 이미지로부터 깊이 맵(depth map)을 획득하는 동작과 관련된 명령어들(instructions)을 저장할 수 있다. 상기 저장 매체는 깊이 맵에 포함된 적어도 하나의 픽셀의 법선 벡터(normal vector)를 획득하는 동작과 관련된 명령어들을 저장할 수 있다. 상기 저장 매체는 IMU 센서에 의해 측정된 중력 방향에 기초하여 적어도 하나의 픽셀의 법선 벡터의 방향을 보정하는 동작과 관련된 명령어들 을 저장할 수 있다. 상기 저장 매체는 보정된 법선 벡터의 방향에 기초하여 깊이 맵의 적어도 하나의 픽셀의 깊 이 값을 보정하는 동작과 관련된 명령어들을 저장할 수 있다. 본 개시에서 설명된 증강 현실 디바이스에 의해 실행되는 프로그램은 하드웨어 구성요소, 소프트웨어 구성 요소, 및/또는 하드웨어 구성요소 및 소프트웨어 구성요소의 조합으로 구현될 수 있다. 프로그램은 컴퓨터로 읽 을 수 있는 명령어들을 수행할 수 있는 모든 시스템에 의해 수행될 수 있다. 소프트웨어는 컴퓨터 프로그램(computer program), 코드(code), 명령어(instruction), 또는 이들 중 하나 이상 의 조합을 포함할 수 있으며, 원하는 대로 동작하도록 처리 장치를 구성하거나 독립적으로 또는 결합적으로 (collectively) 처리 장치를 명령할 수 있다. 소프트웨어는, 컴퓨터로 읽을 수 있는 저장 매체(computer-readable storage media)에 저장된 명령어를 포함하 는 컴퓨터 프로그램으로 구현될 수 있다. 컴퓨터가 읽을 수 있는 기록 매체로는, 예를 들어 마그네틱 저장 매체 (예컨대, ROM(read-only memory), RAM(random-access memory), 플로피 디스크, 하드 디스크 등) 및 광학적 판 독 매체(예컨대, 시디롬(CD-ROM), 디브이디(DVD: Digital Versatile Disc)) 등이 있다. 컴퓨터가 읽을 수 있 는 기록 매체는 네트워크로 연결된 컴퓨터 시스템들에 분산되어, 분산 방식으로 컴퓨터가 판독 가능한 코드가 저장되고 실행될 수 있다. 매체는 컴퓨터에 의해 판독 가능하며, 메모리에 저장되고, 프로세서에서 실행될 수 있다. 컴퓨터로 읽을 수 있는 저장매체는, 비일시적(non-transitory) 저장매체의 형태로 제공될 수 있다. 여기서, '비 일시적'은 저장매체가 신호(signal)를 포함하지 않으며 실재(tangible)한다는 것을 의미할 뿐 데이터가 저장매 체에 반영구적 또는 임시적으로 저장되는 경우를 구분하지 않는다. 예를 들어, '비일시적 저장매체'는 데이터가 임시적으로 저장되는 버퍼를 포함할 수 있다. 또한, 본 명세서에 개시된 실시예들에 따른 프로그램은 컴퓨터 프로그램 제품(computer program product)에 포 함되어 제공될 수 있다. 컴퓨터 프로그램 제품은 상품으로서 판매자 및 구매자 간에 거래될 수 있다. 컴퓨터 프로그램 제품은 소프트웨어 프로그램, 소프트웨어 프로그램이 저장된 컴퓨터로 읽을 수 있는 저장 매체 를 포함할 수 있다. 예를 들어, 컴퓨터 프로그램 제품은 증강 현실 디바이스의 제조사 또는 전자 마켓(예 를 들어, 삼성 갤럭시 스토어)을 통해 전자적으로 배포되는 소프트웨어 프로그램 형태의 상품(예를 들어, 다운 로드 가능한 애플리케이션(downloadable application))을 포함할 수 있다. 전자적 배포를 위하여, 소프트웨어 프로그램의 적어도 일부는 저장 매체에 저장되거나, 임시적으로 생성될 수 있다. 이 경우, 저장 매체는 증강 현 실 디바이스의 제조사의 서버, 전자 마켓의 서버, 또는 소프트웨어 프로그램을 임시적으로 저장하는 중계 서버의 저장 매체가 될 수 있다. 컴퓨터 프로그램 제품은, 증강 현실 디바이스 및/또는 서버로 구성되는 시스템에서, 서버의 저장매체 또는 증강 현실 디바이스의 저장매체를 포함할 수 있다. 또는, 증강 현실 디바이스와 통신 연결되는 제3 장치(예를 들어, 모바일 디바이스)가 존재하는 경우, 컴퓨터 프로그램 제품은 제3 장치의 저장매체를 포함할 수 있다. 또는, 컴퓨터 프로그램 제품은 증강 현실 디바이스로부터 제3 장치로 전송되거나, 제3 장치로부터 전자 장치로 전송되는 소프트웨어 프로그램 자체를 포함할 수 있다. 이 경우, 증강 현실 디바이스 또는 제3 장치 중 하나가 컴퓨터 프로그램 제품을 실행하여 개시된 실시예들 에 따른 방법을 수행할 수 있다. 또는, 증강 현실 디바이스 및 제3 장치 중 적어도 하나 이상이 컴퓨터 프로그램 제품을 실행하여 개시된 실시예들에 따른 방법을 분산하여 실시할 수 있다. 예를 들면, 증강 현실 디바이스가 메모리(140, 도 2 참조)에 저장된 컴퓨터 프로그램 제품을 실행하여, 증 강 현실 디바이스와 통신 연결된 타 전자 장치(예를 들어, 모바일 디바이스)가 개시된 실시예들에 따른 방 법을 수행하도록 제어할 수 있다. 또 다른 예로, 제3 장치가 컴퓨터 프로그램 제품을 실행하여, 제3 장치와 통신 연결된 전자 장치가 개시된 실시 예에 따른 방법을 수행하도록 제어할 수 있다. 제3 장치가 컴퓨터 프로그램 제품을 실행하는 경우, 제3 장치는 증강 현실 디바이스로부터 컴퓨터 프로그 램 제품을 다운로드하고, 다운로드된 컴퓨터 프로그램 제품을 실행할 수 있다. 또는, 제3 장치는 프리로드(pre- load)된 상태로 제공된 컴퓨터 프로그램 제품을 실행하여 개시된 실시예들에 따른 방법을 수행할 수도 있다."}
{"patent_id": "10-2022-0101583", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 8, "content": "이상과 같이 실시예들이 비록 한정된 실시예와 도면에 의해 설명되었으나, 해당 기술분야에서 통상의 지식을 가 진 자라면 상기의 기재로부터 다양한 수정 및 변형이 가능하다. 예를 들어, 설명된 기술들이 설명된 방법과 다 른 순서로 수행되거나, 및/또는 설명된 컴퓨터 시스템 또는 모듈 등의 구성요소들이 설명된 방법과 다른 형태로 결합 또는 조합되거나, 다른 구성요소 또는 균등물에 의하여 대치되거나 치환되더라도 적절한 결과가 달성될 수 있다. 도면 도면1a 도면1b 도면2 도면3 도면4 도면5 도면6a 도면6b 도면7 도면8 도면9 도면10 도면11 도면12 도면13 도면14 도면15 도면16"}
{"patent_id": "10-2022-0101583", "section": "도면", "subsection": "도면설명", "item": 1, "content": "본 개시는, 다음의 자세한 설명과 그에 수반되는 도면들의 결합으로 쉽게 이해될 수 있으며, 참조 번호 (reference numerals)들은 구조적 구성요소(structural elements)를 의미한다.도 1a는 본 개시의 증강 현실 디바이스가 깊이 값을 보정하는 방법을 설명하기 위한 개념도이다. 도 1b는 본 개시의 증강 현실 디바이스가 IMU 센서에 의해 측정된 중력 방향에 따라 깊이 값을 보정하는 방법을 설명하기 위한 개념도이다. 도 2는 본 개시의 일 실시예에 따른 증강 현실 디바이스의 구성 요소를 도시한 블록도이다. 도 3은 본 개시의 일 실시예에 따른 증강 현실 디바이스의 동작 방법을 도시한 흐름도이다. 도 4는 본 개시의 일 실시예에 따른 증강 현실 디바이스가 픽셀 별 법선 벡터(normal vector)를 획득하는 방법 을 도시한 흐름도이다. 도 5는 본 개시의 일 실시예에 따른 증강 현실 디바이스가 깊이 맵으로부터 픽셀 별 법선 벡터를 획득하는 동작 을 도시한 도면이다. 도 6a는 본 개시의 일 실시예에 따른 증강 현실 디바이스가 중력 방향에 따라 법선 벡터의 방향을 보정하는 동 작을 도시한 도면이다. 도 6b는 본 개시의 일 실시예에 따른 증강 현실 디바이스가 중력 방향에 대하여 수직 방향으로 법선 벡터의 방 향을 보정하는 동작을 도시한 도면이다. 도 7은 본 개시의 일 실시예에 따른 증강 현실 디바이스가 인공지능 모델을 이용하여 깊이 맵을 획득하는 트레 이닝(training) 동작을 도시한 도면이다. 도 8은 본 개시의 일 실시예에 따른 증강 현실 디바이스가 깊이 맵의 픽셀 별 깊이 값을 보정하는 방법을 도시 한 흐름도이다. 도 9는 본 개시의 일 실시예에 따른 증강 현실 디바이스가 손실값(loss)를 산출하는 방법을 도시한 흐름도이다. 도 10은 본 개시의 일 실시예에 따른 증강 현실 디바이스가 손실값을 산출하는 동작을 도시한 도면이다. 도 11은 본 개시의 일 실시예에 따른 증강 현실 디바이스가 인공지능 모델을 이용하여 깊이 맵을 획득하는 동작 을 도시한 도면이다. 도 12는 본 개시의 일 실시예에 따른 증강 현실 디바이스가 깊이 맵의 픽셀 별 깊이 값을 보정하는 방법을 도시 한 흐름도이다. 도 13은 본 개시의 일 실시예에 따른 증강 현실 디바이스가 플레인 스윕(plane sweep) 방식을 통해 깊이 맵의 픽셀 별 깊이 값을 보정하는 동작을 도시한 도면이다. 도 14는 본 개시의 일 실시예에 따른 증강 현실 디바이스가 깊이 맵의 픽셀 별 깊이 값을 보정하는 방법을 도시 한 흐름도이다. 도 15는 본 개시의 일 실시예에 따른 증강 현실 디바이스가 ToF(Time-of-Flight) 방식을 통해 획득된 깊이 맵의 픽셀 별 깊이 값을 보정하는 동작을 도시한 도면이다. 도 16은 일반적인 방식으로 획득된 깊이 맵으로 복원된 공간 모델과 본 개시의 일 실시예에 따른 증강 현실 디 바이스에 의해 획득된 깊이 맵으로 복원된 공간 모델을 도시한 도면이다."}
