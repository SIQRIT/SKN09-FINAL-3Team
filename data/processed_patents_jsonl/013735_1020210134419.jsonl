{"patent_id": "10-2021-0134419", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2023-0050978", "출원번호": "10-2021-0134419", "발명의 명칭": "다중 도메인 이미지에 대한 주의집중 기반 어뎁터 교차 학습 장치 및 방법", "출원인": "한국과학기술원", "발명자": "윤찬현"}}
{"patent_id": "10-2021-0134419", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "백본 네트워크에 부착되는 형태로써, 주어진 다중 도메인으로부터의 훈련 데이터에 대하여, 주의집중 기반 어뎁터 모듈들은 각 도메인의 도메인 특화 특징을 획득하는 어뎁터 교차 학습 장치."}
{"patent_id": "10-2021-0134419", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "백본 네트워크에 부착되는 형태로써, 주어진 다중 도메인으로부터의 훈련 데이터에 대하여, 주의집중 기반 어뎁터 모듈들은 각 도메인의 도메인 특화 특징을 획득하는 어뎁터 교차 학습 방법."}
{"patent_id": "10-2021-0134419", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제 2 항에 있어서,백본 네트워크는 도메인 불변 특징을 추출하는어뎁터 교차 학습 방법."}
{"patent_id": "10-2021-0134419", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "백본 네트워크에 부착되는 형태로써, 주어진 다중 도메인으로부터의 훈련 데이터에 대하여, 주의집중 기반 어뎁터 모듈들은 각 도메인의 도메인 특화 특징을 획득하고,백본 네트워크는 도메인 불변 특징을 추출하는교차 학습 시스템."}
{"patent_id": "10-2021-0134419", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제 4 항에 있어서,상기 어뎁터 모듈과 상기 백본 네트워크를 번갈아가며 동결(Freezing)하는 방식으로 학습되는교차 학습 시스템."}
{"patent_id": "10-2021-0134419", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명의 실시예에 따른 주의집중 기반 어뎁터 교차 학습 장치는 백본 네트워크에 부착되는 형태로써, 주어진 다중 도메인으로부터의 훈련 데이터에 대하여, 주의집중 기반 어뎁터 모듈들은 각 도메인의 도메인 특화 특징을 획득한다."}
{"patent_id": "10-2021-0134419", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 다중 도메인 위성 이미지의 시각 설명성을 높이기 위한 주의집중 기반 어뎁터의 교차 학습 방법 및 상기 방법을 수행하는 어뎁터 교차 학습 장치에 관한 것이다."}
{"patent_id": "10-2021-0134419", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "최근 합성곱신경망(Convolutional Neural Network, CNN)을 기반으로 한 위성 이미지 분석이 활발하게 연구되고 있으나, 이를 실제 시스템에 적용하기 위해서는 다음의 문제들이 해결되어야 한다. 첫째, 다양한 이미지 센서를 가지는 위성들로부터 수집된 이미지들 간의 도메인 변화(Domain Shift)를 해결하여야 한다. 둘째, 예측 결과의 근거를 제공함으로써 인공지능 시스템의 신뢰성을 향상시키기 위한 모델 설명성(Modeal Explanability)이 보장 되어야 한다. 재해 예측 등과 같이 위성 이미지 분석과 관련된 인공지능 응용의 경우, 그 정확도가 매우 중요한 이슈로 작용 하며, 해당 인공지능 시스템이 잘못된 결정을 도출하였을 시 큰 문제로 연결될 수 있다. 따라서 이 경우 인공지능 시스템의 신뢰성(Reliability)는 굉장히 중요한 이슈로써 작용하며, 예측 결과에 대해서 해당 결과가 어떻게 도출되었는지에 대한 설명이 제공되어야 한다. 이와 관련하여, 본 발명에서는 특히 딥네트워크의 시각 설명성을 다룬다. 기존 규칙 기반 시스템(Rule-based System) 등 고전적인 지능형 시스템의 경우 판단이 분리가능한 파이 프라인(Decomposable Pipeline)으로 이루어지기 때문에 각각의 개별 컴포넌트(Component)들이 직관적인 설명을 제공하는 것이 가능하다. 하지만, 딥네트워크 모델의 경우 기존 시스템보다 더 뛰어난 태스크 성능(Task Performance)을 제공할 수 있음에도 불구하고, 다수의 레이어를 쌓음으로써 발생하는 추상성 및 복잡성은 해당 네트워크에서의 해석성 제공을 어렵게 한다. 이를 극복하기 위하여 CAM, Grad-CAM, Grad-CAM++ 등의 기법들이 개발되었으며, 해당 기법들은 합성곱 레이어들(Convolutional Layers)에서 도출된 특징맵들(Feature Maps)에 대 하여 채널(Channel) 별 가중치 평균화를 수행함으로써 시각적 설명을 제공하는 방식을 취하며, 여기서 평균화를 위하여 채널 별 가중치를 주는 방식은 각 기법 별로 상이하다. 상술한 활성(Activation) 기반 시각적 설명 제공 기법들에 더불어, 섭동 기반 접근들(Perturbation-based Approaches) 또한 활발하게 연구되었으며, 해당 기법들은 입력 데이터의 어떤 부분이 딥네트워크의 예측에 영향 을 많이 주는지를 분석하는 방식을 취한다. 해당 섭동 기반 접근들의 예로써는 LIME, SHAP, 통합 그래디언트 (Integrated Gradients) 등을 들 수 있다. 더불어, 다중 도메인 학습은 소스 도메인들간의 정확도(Accuracy) 등 태스크 성능을 향상시키기 위한 모델을 학 습시키는 데 그 목적이 있다. 이를 위하여 도메인 특화 태스크 성능을 보장하는 동시에, 도메인 불일치(Domain Discrepancy)를 최소화 하기 위한 도메인 불변 특징을 추출하기 위한 기법들이 개발되었으나, 해당 기법들은 각 도메인의 도메인 특화 특징을 추출하기 위하여 큰 파라메터 공간(Parameter Space)을 요구한다. 따라서, 그 대신에 도메인 특화 컴포넌트의 파라메터 양(Size)을 감소시키기 위하여 경량 어뎁터 기반의 방법들 이 연구되었다. 배치 정규화 및 인스턴스 정규화 레이어들의 파라메터를 도메인 어뎁터로써 사용하고, 나머지 모델 파라메터들은 모든 도메인에 대하여 공유되도록 하는 방법이 제시되었다. 또한, 직렬 잔여(Serial Residual) 어뎁터 모듈이 제시되어, 해당 직렬 잔여 어뎁터 모듈은 1 x 1 필터 은행(Filter Bank)로 구성되어 있으며, 만약 특정 합성곱 레이어에서의 중간 특징맵(Intermediate Feature Map)을 로 표현하였을 때 해당 직렬 잔여 어뎁터를 적용한 수정된 특징맵은 가 되며 여기서 는 어뎁터 모듈을, 는 대각(Diagonal) 필터 은행에서 입력 행렬을 재구성하기 위한 오퍼레이터(Operator)를 의미한 다. 한편, 종래 기술로 병렬 잔여(Parallel Residual) 어뎁터 모듈이 제시되어, 기존 백본 네트워크에서의 합성곱 필터 은행을 로, 그리고 이전 합성곱 레이어에서의 특징맵을 로 표현하였을 때, 해당 병렬 잔여 어뎁터를 적 용한 수정된 특징맵은 로써 표현되며, 여기서 가 만족된다. 이외에도 이러한 배치 정규화 및 인스턴스 정규화 레이어 파라메터들을 활용한 어뎁터, 직렬 잔여 어뎁터, 병렬 잔여 어뎁터를 활용한 다양한 기술들이 개발되었다."}
{"patent_id": "10-2021-0134419", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명이 해결하고자 하는 과제는, 주의집중 기반 어뎁터 교차 학습 방법을 제공하는 것이다. 다만, 본 발명이 해결하고자 하는 과제는 이상에서 언급한 것으로 제한되지 않으며, 언급되지 않은 또 다른 해 결하고자 하는 과제는 아래의 기재로부터 본 발명이 속하는 통상의 지식을 가진 자에게 명확하게 이해될 수 있 을 것이다."}
{"patent_id": "10-2021-0134419", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "합성곱신경망의 모델 설명성 향상을 도모하기 위하여 본 발명에서는 주의집중(Attention) 기반 도메인 어뎁터 를 이용하여, 도메인 공통(Domain-Agnostic) 백본 네트워크(Backbone Network)의 플러그인으로 동작하며, 각 소스 도메인 별로 도메인 특화 특징(Domain-Specific Features)을 추출한다. 백본 네트워크에 부착되는 형태로써, 해당 어뎁터 모듈들은 입력 이미지의 시각적 주의집중을 개선하기 위하여 도메인 특화 특징을 추출할 뿐만 아니라 입력 이미지의 채널 주의집중(Channel Attention) 및 공간적 주의집중 (Spatial Attention)을 개선할 수 있도록 한다. 즉, 주어진 다중 도메인으로부터의 훈련 데이터에 대하여, 해당 어뎁터 모듈들은 각 도메인의 도메인 특화 특징을 획득하는 것을, 백본 네트워크는 도메인 불변 특징을 추출하 도록 디자인된다. 또한, 본 발명에서는 백본 네트워크에 도메인 불변 특징(Domain-Invariant Features)를 추출하기 위한 교차 학 습 방법(Alternating Training Method)을 제시한다. 해당 교차 학습 방법에서의 학습은 해당 두 가지 컴포넌트를 번갈아가며 동결(Freezing)하는 방식으로 이루어지 며, 이러한 반복(Iteration)을 통하여, 도메인 불변 특징과 도메인 특화 특징을 효과적으로 분리할 수 있도록 한다."}
{"patent_id": "10-2021-0134419", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명의 실시예에 따라, 입력 이미지의 어떤 부분을 주목할 것인지에 대한 추가적인 주의집중 어뎁터 모듈을 도입하며, 각 합성곱 레이어에 대한 어뎁터들은 채널 및 공간적 정보에 대한 두 가지 주의집중 프로세스가 가능 하도록 설계된다. 또한, 도메인 불변 특징 및 도메인 특화 특징의 분리를 위한 교차 학습 방법을 이용하여, 매 이터레이션 (Iteration)에서 도메인 공통 백본 네트워크 및 도메인 특화 어뎁터들은 서로를 동결시키며 교차로 업데이트 되 도록 함으로써 도메인 특화 특징을 추출하게 할 뿐만 아니라 나머지 도메인 불변 특징을 백본 네트워크가 효과 적으로 획득할 수 있다."}
{"patent_id": "10-2021-0134419", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "item": 1, "content": "도 1은 본 발명에서의 다중 도메인 위성 이미지 분석에 대한 시나리오를 나타낸다. 본 발명에서는 다중 위성이 다양한 지역에 대한 원격 탐사(Remote Sensing)를 수행한다고 가정한다. 또한 수집된 이미지의 공간 해상도 (Spatial Resolution) 등이 위성 종류에 따라 다양하다고 상정하며, 따라서 그들 사이에 도메인 이동이 존재하 게 된다. 이에 따라 각 위성은 서로 다른 도메인의 이미지를 가지게 된다. 주기적으로, 각 위성은 수집된 이미지를 지상으로 내려 보내며, 지상에서 수집된 이미지들은 태풍 예측 및 장면 인식(Scene Recognition) 등 구체적인 작업을 위하여 분석될 뿐만 아니라, 해당 프로세스들을 자동화하기 위한 기계 학습 모델을 훈련시키는데 사용된다. 본 발명에서는 해당 자동화 프로세스를 위하여 합성곱신경망 기반의 딥네트워크를 고려하며, 해당 딥네트워크 학습을 수행하기에 충분한 크기의 이미지가 수집된 상황을 상정한다. 본 발명에서는 판독관과 더불어 상술된 딥네트워크가 위성들로부터 앞으로 수집될 이미지들에 대한 분석을 수행 하며, 해당 딥네트워크가 도출한 결과에 대한 시각적 증거(Visual Evidence) 또한 제공한다고 가정한다. 따라서 고려되는 딥네트워크는 설명성을 지원할 기능들이 포함되어 있어야 한다. 이러한 상황에서 본 발명에서 고려하는 다중 도메인 문제는 다음과 같이 정의된다. 주어진 개의 도메인에 대 하여, 는 각 도메인 의 분포를 나타내며 는 모든 소스 도메인에 대한 합성 분포를 나타낸다. 여기서 본 발명은 이미지 분류(Image Classification) 문제를 고려하며, 각 도메인 분포가 의 공간에 놓이게 되고, 와 는 각각 입력 공간(Input Space) 및 레이블 공간(Label Space)를 의미한다.는 각 도메인 k에 대한 데이터셋을 나타내며, 는 각각의 데이터 샘플을, 는 훈련 샘플들의 수를 의미한다. 또한 본 발명에서 는 단일 도메인 데이터셋들의 전체 집합을 의미하며, N은 D 내의 전체 훈련 샘플들의 개수를 나타낸다. 상술한 환경 하에서 본 발명에서 고려되는 다중 도 메인 학습 문제는 타겟 리스크(Target Risk) 의 최소화를 목적으로 가지게 되고, 는 상응 가설을 나타내며, 는 에 대한 확률 심플렉스(Probability Simplex)를 의미한다. 더불 어, 해당 가설은 시각 설명성을 개선하기 위하여 향상된 시각적 주의집중을 제공하도록 구성되어야 한다. 본 발명에서는 상술하였듯이 객체 인식에 대한 근거 해석을 위한 모델로써 설명 시각화를 제공하는 형상을 고려 하며, 데이터 결측이 발생하는 도메인의 학습 데이터 문제를 해결하기위해, 다중 도메인으로부터 획득되는 위성 이미지에 대해 개별적으로 적용되어 정확도 및 설명 성능을 향상시키기 위한 효과적인 기법을 제시하며, 이는 크게 주의집중(attention) 모듈 기반의 어뎁터 모델 구조와 도메인 별 공통 및 특이 정보를 각 모델 모듈에 효 과적으로 반영하기 위한 교차 학습으로 구분된다. 도 2는 본 발명에서 제안하는 네트워크 구조를 나타내는 도면이다. 본 발명에서는 다중 도메인 학습을 위하여 백본 네트워크의 학습 뿐만 아니라 각 위성 이미지 도메인에 대하여 상응하는 다수의 어뎁터들을 훈련시키는 접 근을 취하였다. 즉, wk={w,mk}는 도메인 k에 대한 모델 파라메터를 나타내며, w는 모든 도메인에 대하여 공유되 는 도메인 공통 컴포넌트를, mk는 각각의 도메인 특화 컴포넌트로써 어댑터를 나타낸다. 이전 어댑터 연구들과 달리 본 연구에서는 CBAM을 도입하여 입력 이미지에 대한 채널 주의집중(channel attention) 및 공간적 주의집 중(spatial attention)을 개선하고자 하였다. 여기서 각 합성곱 레이어(convolutional layer)에서 추출한 중간 특징맵(feature map)을 라고 칭하고, 및 를 각각 1-D 채널 및 2-D 공 간적 주의집중 맵이라고 할 때, 해당 CBAM의 전체 주의집중 과정을 다음과 같이 나타낼 수 있으며, 여기서 는 하다마드(Hadamard) 곱을 나타낸다. 수학식 1"}
{"patent_id": "10-2021-0134419", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "하지만, CBAM과는 달리 본 연구에서의 어댑터에서 각 합성곱 레이어에서의 최종 주의집중 결과는 다음과 같이 처음의 중간 특징맵을 더하여 얻어지는 구조를 가지며, 이는 뒤에서 서술할 번갈아가기 학습 방법에서의 도메인 특화 특징 및 도메인 공통 특징을 효과적으로 분리할 수 있도록 하는 역할을 한다. 수학식 2"}
{"patent_id": "10-2021-0134419", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "여기서 채널 주의집중 맵 은 합성곱 레이어로 얻어지는 특징의 채널 간 관계(Inter-Channel Relationship)을 분석함으로써 구성된다. 즉, 입력 이미지에 대하여 더 많은 주의집중을 제공할 채널들을 찾기 위하여, 중간 특징 맵의 공간적 정보가 평균치 풀링(Average Pooling) 및 최대치 풀링(Max Pooling)으로부터 취 합되고, 각 풀링 작업의 결과는 다층 퍼셉트론(Multi-Layer Perceptron)을 거치게 된다. 해당 과정은 다음 수학 식으로 표현될 수 있으며, 여기서 와 는 각각 해당 중간 특징맵에 대한 평균치 풀링 및 최대치 풀링을, 는 시그모이드(Sigmoid) 함수를, W0 및 W1은 해당 다층 퍼셉트론의 모델 파라메터를 나타낸다.수학식 3"}
{"patent_id": "10-2021-0134419", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "채널 주의집중의 결과로써 얻어진 특징들에 대하여 공간적 주의집중 모듈은 해당 특징들의 공간 사이의 관계 (Inter-Spatial Relationship)으로부터 공간적 주의집중 맵 을 생성한다. 이를 위하여, 상술한 채널 주의집 중 프로세스와 마찬가지로 평균치 풀링 및 최대치 풀링이 먼저 적용되게 되고, 이후 합성곱 작업 을 거치게 된 다. 다음 수학식은 이를 나타낸다. 수학식 4"}
{"patent_id": "10-2021-0134419", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "item": 5, "content": "도 3은 본 발명에서 백본 네트워크와 도메인 어뎁터들에 대하여 도메인 분별 특징과 도메인 특화 특징을 효과적 으로 분리하기 위한 교차 학습 알고리즘의 순서도를 나타낸다. 본 발명에서 제안하는 네트워크 구조는 도메인 불변 특징이 백본 네트워크에서 추출되도록 하고, 어뎁터 모듈들이 도메인 특화 특징을 획득하도록 설계되었다. 이를 달성하기 위하여 본 발명에서는 교차 최적화(Alternating Optimization) 기반의 학습 알고리즘을 제안하며, 해당 교차 최적화는 개별 변수에 대하여 교차하면서 최적화를 수행함으로써 전체 변수에 대한 최적화 를 달성하기 위한 반복적 절차를 의미한다. 본 발명에서 제안하는 교차 학습 알고리즘은 다음 수학식과 같이 목적 함수"}
{"patent_id": "10-2021-0134419", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 6, "content": "(예: 교차 엔트로피(Cross-Entropy) 손실 함수)에 대한 최소화를 목적으로 하며, 여기서 는 하에서의 미 니배치(Minibatch) 생성에서의 비편향 무작위성(Unbiased Randomness)을 의미한다. 수학식 5"}
{"patent_id": "10-2021-0134419", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 7, "content": "해당 교차 학습 알고리즘에서는 각 이터레이션(Iteration)에서 백본 네트워크와 도메인 어뎁터가 번갈아가며 파 라메터들을 업데이트하도록 하여, 도메인 어뎁터에서 학습된 도메인 특화 특징 위에서 나머지 도메인 공통 특징 이 효과적으로 백본 네트워크에서 추출될 수 있도록 하며, 이에 대한 세부 단계는 다음과 같이 구성된다. i. {mk} 고정 및 w 업데이트: 각각의 wk에 대하여 손실값 을 구한다. 여기서 는 전체 도메인 데이 터셋을 의미하며, 는 해당 데이터셋에서의 미니배치 구성에서의 무작위성을 의미한다. 여기서 w는 다음과 같이 업데이트 되며, 이때 는 학습률(Learning Rate)을 의미한다. ii.w 고정 및 {mk} 업데이트: 각각의 wk에 대하여 손실값 을 구한다. 이후, mk는 다음과 같이 업 데이트 된다.수학식 6"}
{"patent_id": "10-2021-0134419", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "item": 8, "content": "도 4는 학습된 백본 네트워크 및 도메인 어뎁터에서의 입력 이미지에 대한 시각적 설명 제공을 나타내는 도면이 며, 본 발명에서는 이에 대한 시각 설명 도구로써 Grad-CAM을 이용한다. Grad-CAM은 합성곱신경망의 시각 설명 성을 개선하기 위한 그래디언트 가중치 기반 클래스 활성(Gradient-Weighted Class Activation) 방법으로써 합 성곱 레이어의 그래디언트 정보를 특징 맵에 대한 중요도를 할당하는데 사용한다. Grad-CAM의 동작 과정은 다음과 같다. 첫째, 의 그래디언트가 계산되며, 이는 각 채널 인덱스 u의 특징맵"}
{"patent_id": "10-2021-0134419", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 9, "content": "에서의 클래스 c에 대한 점수를 의미한다. 계산된 그래디언트는 뉴런 중요도 가중치(Neuron Importance Weigh t)를 산출하기 위하여 다음 수학식과 같이 전역 평균치 풀링 과정을 거치게 되며, 여기서 i와 j는 각각 높이 및 너비에 대한 차원을 나타낸다. 수학식 7"}
{"patent_id": "10-2021-0134419", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 10, "content": "둘째, 뉴런 중요도 가중치 가 결정된 뒤, 특징 맵에 대한 가중 선형 결합(Weighted Linear Combination)은 와 같이 계산되며, 해당 결과는 입력 이미지에 대한 중요 지역을 시각화 하기 위한 클래스 구 분적(Class-Discriminative) 지역화(Localization) 맵을 생성하는데 사용된다."}
{"patent_id": "10-2021-0134419", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 일 실시예에 따른 다중 도메인 위성 이미지 분석 방법을 나타낸다. 도 2는 일 실시예에 따른 도메인 공통 백본 네트워크로는 합성곱 신경망이 사용되며, 도메인 특화 컴포넌트에 대해서는 각 합성곱 레이어에 대한 두 가지 주의집중 모듈이 사용된다. 도 3은 본 발명에서 백본 네트워크와 도메인 어뎁터들에 대하여 도메인 분별 특징과 도메인 특화 특징을 효과적 으로 분리하기 위한 교차 학습 알고리즘의 순서도를 나타낸다. 도 4는 학습된 백본 네트워크 및 도메인 어뎁터에서의 입력 이미지에 대한 시각적 설명 제공을 나타내는 도면이 다."}
