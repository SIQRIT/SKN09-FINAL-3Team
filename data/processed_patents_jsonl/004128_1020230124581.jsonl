{"patent_id": "10-2023-0124581", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2025-0042227", "출원번호": "10-2023-0124581", "발명의 명칭": "인공지능 아바타와 도메인 특화 언어모델 기반의 AI 휴먼형 챗봇 시스템", "출원인": "주식회사 큐버", "발명자": "나영문"}}
{"patent_id": "10-2023-0124581", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "휴먼형 챗봇을 위한 동적 아바타를 생성하는 동적 아바타 생성부(110)와, 미리 훈련된 신경망 언어 모델을 특정도메인에 파인튜닝하는 도메인 특화 학습부(120)를 구비하는 챗봇 생성학습 처리부(100); 및 사용자의 질문이나 요청을 입력받아 입력 텍스트 데이터를 구성하는 사용자 입력부(210)와, 상기 입력 텍스트데이터를 상기 파인튜닝한 신경망 언어 모델에 입력하여 챗봇 응답 텍스트를 획득하는 챗봇 응답생성부(220)와, 상기 동적 아바타에 상기 챗봇 응답 텍스트를 합성하여 아바타 응답 동영상을 생성하는 아바타응답 생성부(230)와, 상기 아바타 응답 동영상을 사용자에게 제공하는 챗봇 응답 출력부(240)를 구비하는 챗봇실시간 처리부(200);를 포함하여 구성되는 인공지능 아바타와 도메인 특화 언어모델 기반의 AI 휴먼형 챗봇 시스템."}
{"patent_id": "10-2023-0124581", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "청구항 1에 있어서, 상기 동적 아바타 생성부(110)는, 동적 아바타의 기본 이미지가 되는 정적 아바타 이미지를 저장하는 아바타 이미지 저장부(111); 정적 아바타 이미지에 부여하려는 행동 정보가 포함된 모션 영상을 저장하는 모션 영상 저장부(112); 상기 정적 아바타 이미지의 키 포인트가 상기 모션 영상의 동영상 프레임마다의 키 포인트의 특성 영역으로 이동하도록 상기 모션 영상과 상기 정적 아바타 이미지를 워핑 합성하는 이미지 워핑 처리부(113); 및 상기 이미지 워핑 처리부(113)가 생성하는 워핑 합성 결과물에 비선형 보간을 적용하여 이미지 워핑에서 생성된각 이미지 프레임의 누락된 픽셀 값을 보정하는 이미지 왜곡 보정부(114);를 포함하여 구성되는 것을 특징으로 하는 인공지능 아바타와 도메인 특화 언어모델 기반의 AI 휴먼형 챗봇 시스템."}
{"patent_id": "10-2023-0124581", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "청구항 1에 있어서, 상기 도메인 특화 학습부(120)는, 자연어 처리를 위해 미리 훈련된 신경망 언어 모델을 저장하는 신경망 모델 저장부(121); 및 상기 신경망 모델 저장부(121)에 저장된 상기 미리 훈련된 신경망 언어 모델에 특정 도메인의 채팅 데이터셋을이용한 머신러닝 학습을 추가 적용함으로써 상기 신경망 언어 모델의 파라미터를 특정 도메인의 데이터 분포 및데이터 특성에 맞게 미세 조정하는 신경망 모델 튜닝부(122); 를 포함하여 구성되는 것을 특징으로 하는 인공지능 아바타와 도메인 특화 언어모델 기반의 AI 휴먼형 챗봇 시스템."}
{"patent_id": "10-2023-0124581", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "청구항 3에 있어서, 공개특허 10-2025-0042227-3-상기 신경망 모델 저장부(121)는 에 따른 어텐션 메커니즘을 적용한 거대언어 모델(LLM)을 상기 신경망 언어 모델로 저장하도록 구성되고(이때, Q는 입력 단어 쿼리, K는 비교대상 단어키, V는 각 단어를 나타내는 정보 값, d_k는 비교대상 단어 키에 해당하는 K의 차원), 상기 챗봇 응답 생성부(220)는 도메인별로 각각의 상황에 맞는 양호한 프롬프트 템플릿을 준비하고,에 따라 상기 입력 텍스트 데이터에 상기 프롬프트 템플릿을추가하여 상기 신경망 언어 모델에 입력하여 챗봇 응답 텍스트를 획득하도록 구성되는 것을 특징으로 하는 인공지능 아바타와 도메인 특화 언어모델 기반의 AI 휴먼형 챗봇 시스템."}
{"patent_id": "10-2023-0124581", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "청구항 1에 있어서, 상기 아바타 응답 생성부(230)는 TTS(Text-to-speech)를 통해 상기 챗봇 응답 텍스트로부터 챗봇 음성 데이터를생성하고, 상기 동적 아바타에서 동영상 프레임 별로 얼굴 영역과 입 모양의 키 포인트를 예측하여 해당 좌표정보를 제 1 벡터로 생성하고, 상기 챗봇 음성 데이터를 음성 인코딩 모델을 통해 입 모양과 동기화가 필요한정보를 포함하는 제 2 벡터로 생성하고, 상기 제 1 및 제 2 벡터를 역합성곱(deconvolution) 연산을 통해 음성에 알맞은 입 모양을 상기 동영상 프레임마다 결합하여 입 모양이 동기화된 아바타 동영상을 생성하고, 상기 아바타 동영상에 챗봇 음성 데이터를 합성하여 아바타 음성 동영상을 생성하도록 구성되는 것을 특징으로 하는 인공지능 아바타와 도메인 특화 언어모델 기반의 AI 휴먼형 챗봇 시스템."}
{"patent_id": "10-2023-0124581", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 일반적으로 사용자와 대화하는 AI 휴먼형 챗봇 시스템에 관한 것이다. 특히, 본 발명은 이미지 워핑과 GAN 알고리즘에 의해 자연스러운 동적 아바타를 생성하고 아바타의 동작을 정의할 신경망 모델을 거대 언어 모델 (LLM)에 의해 특정 도메인에 특화시켜 파인튜닝 학습시킴으로써 사용자에게 다양하면서도 상황에 적합한 응답을 생성함으로써 인간 친화적인 챗봇 서비스를 구현하는 AI 휴먼형 챗봇 시스템에 관한 것이다. 기존의 챗봇은 사전 에 정의된 규칙과 패턴을 기반으로 동작하기 때문에 획일화된 영상과 응답을 출력하였다. 반면, 본 발명에 따르 면 아바타의 자연스러움을 연출해주고 LLM에 의해 사용자에게 친근하고 다양한 응답을 생성함으로써 인간 친화적 인 챗봇 서비스를 제공할 수 있는 장점이 있다."}
{"patent_id": "10-2023-0124581", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 일반적으로 사용자와 대화하는 AI 휴먼형 챗봇 시스템에 관한 것이다. 특히, 본 발명은 이미지 워핑과 GAN 알고리즘에 의해 자연스러운 동적 아바타를 생성하고 아바타의 동작을 정의 할 신경망 모델을 거대 언어 모델(LLM)에 의해 특정 도메인에 특화시켜 파인튜닝 학습시킴으로써 사용자에게 다 양하면서도 상황에 적합한 응답을 생성함으로써 인간 친화적인 챗봇 서비스를 구현하는 AI 휴먼형 챗봇 시스템 에 관한 것이다."}
{"patent_id": "10-2023-0124581", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "일반적으로 챗봇(Chatbot)은 사전에 정의된 규칙과 패턴을 사용하여 대화한다. 이러한 챗봇은 일반적으로 구조 화된 데이터와 규칙을 기반으로 사용자의 입력을 처리하고 응답을 생성한다. 종래의 챗봇 작동 방식은 간단하다. 운영자가 챗봇에게 규칙을 정의한다. 이러한 규칙은 if-then 형식으로 구성 될 수 있다. 예를 들어 \"만약 사용자가 '안녕'이라고 말하면 '안녕하세요!'라고 답변한다\"와 같은 형태이다. 사 용자가 채팅창에 내용을 입력하면, 챗봇은 입력 내용을 이해하고 규칙 및 패턴과 일치하는지 확인한다. 만일 일 치하는 규칙이나 패턴이 있으면 챗봇은 그에 관련된 응답을 제공한다. 이처럼 종래의 챗봇은 구조가 단순하고 미리 정의된 규칙에 따라 작동하기 때문에 구현과 유지보수의 측면에서 유리하다. 반면, 종래의 챗봇은 미리 정의된 규칙과 패턴에 따라 동작하기 때문에 유연성이 낮아 대화의 복잡성과 다양성 에 제한이 있고 대화가 자연스럽지 못하며 대화의 일관성이 떨어진다. 또한, 문맥을 잘 파악하지 못하여 대화의 흐름을 이해하거나 긴 문장을 적절히 처리하지 못하며, 그로 인해 엉뚱한 응답을 출력하는 경우가 발생한다. 또한, 종래의 챗봇은 새로운 데이터를 학습하거나 사용자의 입력에 대해 실시간으로 학습하는 성능이 떨어져 실 제 대화 상황에서 발생하는 새로운 표현이나 문맥을 적절하게 처리하지 못한다. 마지막으로, 새로운 규칙을 추 가하거나 기존 규칙을 수정하려면 개발자가 직접 수작업으로 처리해야 하므로 개발 비용과 개발 기간에 있어서불리하다. 선행기술문헌 특허문헌 (특허문헌 0001) 대한민국 등록특허 10-2119404호 \"복수 챗봇의 협업에 의한 대화형 정보제공 시스템 및 그 방 법\" (특허문헌 0002) 대한민국 공개특허 10-2022-0130000호 \"인공지능 아바타에 기초한 인터랙션 서비스 방법 및 장 치\" (특허문헌 0003) 대한민국 공개특허 10-2022-0094008호 \"인공지능을 이용한 디지털 휴먼 기반 콘텐츠 생성 장치 및 방법\""}
{"patent_id": "10-2023-0124581", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명의 목적은 일반적으로 사용자와 대화하는 AI 휴먼형 챗봇 시스템을 제공하는 것이다. 특히, 본 발명의 목적은 이미지 워핑과 GAN 알고리즘에 의해 자연스러운 동적 아바타를 생성하고 아바타의 동작 을 정의할 신경망 모델을 거대 언어 모델(LLM)에 의해 특정 도메인에 특화시켜 파인튜닝 학습시킴으로써 사용자 에게 다양하면서도 상황에 적합한 응답을 생성함으로써 인간 친화적인 챗봇 서비스를 구현하는 AI 휴먼형 챗봇 시스템을 제공하는 것이다. 본 발명의 해결 과제는 이 사항에 제한되지 않으며 본 명세서의 기재로부터 다른 해결 과제가 이해될 수 있다."}
{"patent_id": "10-2023-0124581", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "상기의 목적을 달성하기 위하여 본 발명에 따른 인공지능 아바타와 도메인 특화 언어모델 기반의 AI 휴먼형 챗 봇 시스템은, 휴먼형 챗봇을 위한 동적 아바타를 생성하는 동적 아바타 생성부와, 미리 훈련된 신경망 언 어 모델을 특정 도메인에 파인튜닝하는 도메인 특화 학습부를 구비하는 챗봇 생성학습 처리부; 및 사 용자의 질문이나 요청을 입력받아 입력 텍스트 데이터를 구성하는 사용자 입력부와, 입력 텍스트 데이터를 위 파인튜닝한 신경망 언어 모델에 입력하여 챗봇 응답 텍스트를 획득하는 챗봇 응답 생성부와, 동적 아바 타에 챗봇 응답 텍스트를 합성하여 아바타 응답 동영상을 생성하는 아바타 응답 생성부와, 아바타 응답 동 영상을 사용자에게 제공하는 챗봇 응답 출력부를 구비하는 챗봇 실시간 처리부;를 포함하여 구성될 수 있다. 본 발명에서 동적 아바타 생성부는, 동적 아바타의 기본 이미지가 되는 정적 아바타 이미지를 저장하는 아 바타 이미지 저장부; 정적 아바타 이미지에 부여하려는 행동 정보가 포함된 모션 영상을 저장하는 모션 영 상 저장부; 정적 아바타 이미지의 키 포인트가 모션 영상의 동영상 프레임마다의 키 포인트의 특성 영역으 로 이동하도록 모션 영상과 정적 아바타 이미지를 워핑 합성하는 이미지 워핑 처리부; 및 이미지 워핑 처 리부가 생성하는 워핑 합성 결과물에 비선형 보간을 적용하여 이미지 워핑에서 생성된 각 이미지 프레임의 누락된 픽셀 값을 보정하는 이미지 왜곡 보정부;를 포함하여 구성될 수 있다. 또한, 본 발명에서 도메인 특화 학습부는, 자연어 처리를 위해 미리 훈련된 신경망 언어 모델을 저장하는 신경망 모델 저장부; 및 신경망 모델 저장부에 저장된 미리 훈련된 신경망 언어 모델에 특정 도메인 의 채팅 데이터셋을 이용한 머신러닝 학습을 추가 적용함으로써 신경망 언어 모델의 파라미터를 특정 도메인의 데이터 분포 및 데이터 특성에 맞게 미세 조정하는 신경망 모델 튜닝부;를 포함하여 구성될 수 있다. 또한, 본 발명에서 신경망 모델 저장부는 에 따른 어텐션 메커니즘을 적용한 거대 언어 모델(LLM)을 신경망 언어 모 델로 저장하도록 구성되고(이때, Q는 입력 단어 쿼리, K는 비교대상 단어 키, V는 각 단어를 나타내는 정보 값, d_k는 비교대상 단어 키에 해당하는 K의 차원), 챗봇 응답 생성부는 도메인별로 각각의 상황에 맞는 양호한 프롬프트 템플릿을 준비하고, 에 따라 입력 텍스트 데이터에 프롬프트 템플릿을 추가하여 신 경망 언어 모델에 입력하여 챗봇 응답 텍스트를 획득하도록 구성될 수 있다. 또한, 본 발명에서 아바타 응답 생성부는 TTS(Text-to-speech)를 통해 챗봇 응답 텍스트로부터 챗봇 음성 데이터를 생성하고, 동적 아바타에서 동영상 프레임 별로 얼굴 영역과 입 모양의 키 포인트를 예측하여 해당 좌 표 정보를 제 1 벡터로 생성하고, 챗봇 음성 데이터를 음성 인코딩 모델을 통해 입 모양과 동기화가 필요한 정 보를 포함하는 제 2 벡터로 생성하고, 제 1 및 제 2 벡터를 역합성곱(deconvolution) 연산을 통해 음성에 알맞 은 입 모양을 동영상 프레임마다 결합하여 입 모양이 동기화된 아바타 동영상을 생성하고, 아바타 동영상에 챗 봇 음성 데이터를 합성하여 아바타 음성 동영상을 생성하도록 구성될 수 있다. 한편, 본 발명에 따른 컴퓨터프로그램은 컴퓨터에 이상과 같은 인공지능 아바타와 도메인 특화 언어모델 기반의 AI 휴먼형 챗봇 시스템의 동작 방법을 실행시키기 위하여 비휘발성 저장매체에 저장된 것이다."}
{"patent_id": "10-2023-0124581", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "기존의 챗봇은 사전에 정의된 규칙과 패턴을 기반으로 동작하기 때문에 획일화된 영상과 응답을 출력하였다. 반 면, 본 발명에 따르면 이미지 워핑 기술과 GAN 알고리즘에 의해 아바타의 자연스러움을 연출해주고 LLM에 의해 사용자에게 친근하고 다양한 응답을 생성함으로써 인간 친화적인 챗봇 서비스를 제공할 수 있는 장점이 있다."}
{"patent_id": "10-2023-0124581", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하에서는 도면을 참조하여 본 발명을 상세하게 설명한다. 본 발명을 설명함에 있어서 종래기술과 중복되는 부분에 대해서는 자세한 설명을 생략할 수 있다. [도 1]은 본 발명에 인공지능 아바타와 도메인 특화 언어모델 기반의 AI 휴먼형 챗봇 시스템의 전체 구성도이다. 본 발명의 인공지능 휴먼형 챗봇(AI Human Chatbot) 시스템은 사용자 장치와 통신하면서 눈 깜빡임, 얼굴 움직임, 입 움직임 등이 수반된 동적인 아바타를 생성하여 사용자에게 제공하는 AI 챗봇 서비스를 제공한다. 본 발명에 따른 AI 휴먼형 챗봇 시스템은 챗봇 생성학습 처리부와 챗봇 실시간 처리부를 포함하여 구 성된다. 챗봇 생성학습 처리부는 휴먼형 챗봇을 위한 동적 아바타를 생성하고 챗봇 동작을 위한 신경망 언어 모델 (예: LLM)을 특정 도메인(예: 스마트 홈 환경)에 파인튜닝한다. 챗봇 실시간 처리부는 사용자의 질문이나 요청을 입력받아 앞서 파인튜닝한 신경망 언어 모델에 입력하여 챗봇 응답을 생성하고 미리 생성한 동적 아바타에 챗봇 응답을 음성 영상 동기화 및 합성함으로써 아바타가 실 제 말하는 것과 같은 동영상을 사용자에게 제공한다. 먼저, 챗봇 생성학습 처리부의 세부 구성에 대해 살펴본다. 챗봇 생성학습 처리부는 동적 아바타 생성부와 도메인 특화 학습부를 포함하여 구성된다. 동적 아바타 생성부는 미리 저장된 가상의 아바타 이미지(source image)와 아바타의 행동 정보가 포함된 모션 영상(driving video)을 합성함으로써 동적 아바타(dynamic avatar), 즉 동적인 움직임을 갖는 아바타 영상 을 생성한다. 아바타 이미지는 정적 아바타(static avatar)라고 볼 수 있다. 정적 아바타 이미지에 모션 영상 합성을 통해 움 직임을 부여하여 동적 아바타를 생성하는 기술은 비선형 보간(non-linear interpolation)(예: Thin-plate spline Motion Estimation), 이미지 워핑(예: 아핀 변환(Affine transformation)), 합성곱(convolution) 연산 등을 사용한다. 이때, 영상 합성 과정에서 인공지능 신경망을 활용할 수도 있다. 이렇게 생성된 동적 아바타는 휴먼형 챗봇을 위한 아바타로 설정된다. [도 2]는 본 발명에서 동적 아바타 생성부의 세부 구성 블록도이다. [도 2]를 참조하면, 동적 아바타 생성 부는 아바타 이미지 저장부, 모션 영상 저장부, 이미지 워핑 처리부, 이미지 왜곡 보정부 를 포함하여 구성된다. 아바타 이미지 저장부는 동적 아바타의 기본 이미지가 되는 정적 아바타 이미지를 저장한다. 모션 영상 저장부는 정적 아바타 이미지에 부여하려는 행동 정보가 포함된 모션 영상을 저장한다. 이미지 워핑 처리부는 정적 아바타 이미지의 키 포인트가 모션 영상의 동영상 프레임마다의 키 포인트의 특성 영역으로 이동하도록 모션 영상과 정적 아바타 이미지를 워핑 합성한다. 일반적으로 이미지 워핑(image warping)은 이미지를 왜곡시키는 것을 말하는데, [도 3]은 이미지 워핑의 예시도 이다. 이미지 워핑에서는 원본 이미지의 특정 포인트를 결과 이미지에서의 특정 위치로 이동시키는 이동변환 함 수와 특정 크기나 방향으로 변환하는 선형변환 함수를 정의(예: 변환벡터)하고, 그 이동변환 함수와 선형변환 함수에 의해 [도 3] (a)와 같은 원본 이미지의 각 픽셀 위치의 방향과 위치를 이동하여 [도 3] (b)와 같은 이미 지 워핑 결과를 얻는다. 본 발명에서 이미지 워핑 처리부는 정적 아바타 이미지에서 인체 관절 포인트 또는 얼굴 랜드마크에 해당 하는 키 포인트(key point)를 감지한다. 그리고, 정적 아바타 이미지에 특정의 행동을 부여하려는 경우에, 그 행동에 해당하는 모션 영상을 모션 영상 저장부로부터 얻고, 해당 모션 영상의 각 동영상 프레임에서 인체 관절 포인트 또는 얼굴 랜드마크에 해당하는 키 포인트를 감지한다. 그리고 나서, 정적 아바타 이미지의 각각의 키 포인트가 동영상 프레임마다의 해당 키 포인트의 특성 영역으로 이동하도록 이미지 워핑을 수행한다. 이를 통해, 해당 모션 영상의 각 동영상 프레임에서 모션 영상의 표정이나 행동이 반영되면서 정적 아바타 이미지가 덧씌워진 영상이 워핑 합성 결과물로서 생성된다. 이미지 왜곡 보정부는 이미지 워핑 처리부가 생성하는 워핑 합성 결과물에 비선형 보간을 적용하여 이미지 워핑 과정에서 생성된 각 이미지 프레임의 누락된 픽셀 값을 보정한다. 이미지 워핑에서는 특성 영역으로 왜곡된 새로운 이미지 프레임에는 누락되는 정보가 생길 수 있다. 이미지 워 핑으로 왜곡시켜 생겨난 벡터에서 스칼라 값 간의 왜곡 여부를 확인하고, 두 점 사이에 보간법을 적용하여 두 점간의 비선형 방정식을 추정하여 그 누락된 스칼라를 예측하여 복원한다. 도메인 특화 학습부는 챗봇 동작을 위한 신경망 언어 모델(Neural Network Language Model, NNLM)을 특정 도메인에 맞게 추가적으로 머신러닝을 수행하여 파인튜닝한다. 신경망 언어 모델로는 거대 언어 모델(Large Language Model, LLM)이 바람직하게 사용될 수 있다. 신경망 언어 모델은 일반적인 챗봇 동작을 위해 미리 사전에 훈련되어 있는데, 도메인 특화 학습부는 그 사전 학습된 신경망 언어 모델에 특정 도메인(예: 스마트 홈 환경)의 채팅 데이터셋을 이용한 머신러닝 학습을 적용하여 파인튜닝한다. 그에 따라, 본 발명에 따른 AI 휴먼형 챗봇은 대화형 텍스트 데이터로 파인튜닝(fine- tuning)한 LLM(Large Language Model)을 활용한다. [도 4]는 본 발명에서 도메인 특화 학습부의 세부 구성 블록도이다. [도 4]를 참조하면, 도메인 특화 학습 부는 신경망 모델 저장부와 신경망 모델 튜닝부를 포함하여 구성된다. 신경망 모델 저장부는 자연어 처리를 위해 미리 훈련된(pre-trained) 신경망 언어 모델(NNLM)을 저장한다. 본 발명에서 신경망 언어 모델로는 거대 언어 모델(Large Language Model, LLM)(예: Transformer, GPT, …)이 바람직하게 사용될 수 있다. 거대 언어 모델(LLM)은 대량의 텍스트 데이터(예: 수십억 단어)로 훈련시켜 자연어 입력을 이해하고 자연어 응답을 생성하도록 머신러닝 학습이 이루어진 신경망 모델이다. 즉, 방대한 양의 자연언어를 처리해서 사람이 생성한 것과 구별할 수 없을 정도의 자연어 응답을 생성할 수 있는 인공지능 신경망이 다. LLM의 대표적인 예는 OPEN AI 사에서 개발한 Chat GPT이다. Chat GPT-4는 1750억개의 파라미터를 활용하여 자연어를 처리한다. 신경망 모델 튜닝부는 신경망 모델 저장부에 저장되어 있는 그 미리 훈련된 신경망 언어 모델(the pre-trained NNLM)에 특정 도메인(예: 해당 사용자의 스마트 홈 환경)의 채팅 데이터셋을 이용한 머신러닝 학습 을 추가 적용함으로써 신경망 언어 모델을 특정 도메인에 파인튜닝한다. 본 발명에서 '파인튜닝(fine-tuning)'은 자연어 처리를 위해 범용적으로 미리 훈련되어 있는 신경망 언어 모델 을 특정한 과제에 맞도록 머신러닝 학습을 추가 수행하는 과정을 의미한다. 신경망 모델 저장부에 저장되 어 있는 신경망 언어 모델은 기존에 다른 대규모 자연어 데이터셋에서 사전 훈련이 이루어진 상태이다. 이러한 신경망 언어 모델의 파라미터를 초기값으로 설정하고, 특정 도메인을 위한 새로운 데이터셋에서 추가로 머신러 닝 학습을 진행한다. 이렇게 되면, 신경망 언어 모델은 기존의 대규모 데이터셋에서 학습된 언어 모델의 특성을 유지하면서도, 특정 도메인의 데이터 분포 및 데이터 특성에 맞게 신경망 언어 모델의 파라미터를 미세하게 조정할 수 있다. 특정 도메인에 사용되는 데이터(예: 해당 사용자의 홈 환경에서의 대화 데이터)를 통해 신경망 언어 모델에 대한 도 메인 특정화(domain specification)가 이루어지면서 사용자의 환경에 최적화된 답변을 생성하도록 튜닝될 수 있 다. 거대 언어 모델(LLM)은 입력 텍스트가 있을 때 다음 단어나 토큰이 나올 확률을 예측하는 오토 리그레션(Auto- Regression) 구조를 갖는다. 본 발명에서는 거대 언어 모델(LLM)에 어텐션 메커니즘(attention mechanism)을 적용함으로써 입력 시퀀스가 길어지는 경우에 거대 언어 모델(LLM)의 응답 출력의 정확도가 저하되는 것을 어느 정도 방지할 수 있다. 어텐션 메커니즘은 자연어 처리에 있어서 입력 데이터 사이의 상대적인 중요도를 계산하는 메커니즘이다. 모든 단어들 사이의 관계를 동시에 계산하고 고려한다. 각 단어 또는 토큰에 가중치를 부여함으로써 문장이나 문단의 전체적인 맥락을 파악하는 성능을 향상시킨다. 해당 가중치는 해당 단어가 문장 내에서 얼마나 중요한지 또는 어떤 단어들과 더 밀접한 관련이 있는지를 나타낸다. 본 발명에서 거대 언어 모델(LLM)에 어텐션 메커니즘(attention mechanism)을 적용함으로써 입력 텍스트에서 각 단어나 토큰이 주변의 문맥(context)과 얼마나 관련이 있는지를 반영한 정보를 활용할 수 있다. 이를 통해 실제 사람과 마찬가지로 입력 문장을 처리할 때에 집중 대상 단어와 맥락을 분별하여 처리하게 된다. 어텐션 메커니 즘에 의하면 입력 시퀀스가 길어지는 경우에도 거대 언어 모델(LLM)의 응답 출력의 정확도를 유지할 수 있다. 어텐션 메커니즘의 기본 아이디어는 응답 출력 단어를 예측하는 매 시점(time step)마다 전체 입력 텍스트를 다 시 한 번 참고한다는 것이다. 이때, 전체 입력 텍스트를 모두 동일 비율로 참고하는 것이 아니라, 해당 시점에 서 예측해야할 단어와 연관이 있는 입력 단어 부분을 좀 더 집중(attention)해서 본다. 입력 단어 쿼리(Query)를 Q, 비교대상 단어 키(Key)를 K, 각 단어를 나타내는 정보 값을 V, 비교대상 단어 키 (Key)에 해당하는 K의 차원(dimension)을 d_k라고 할 때, 어텐션 메커니즘은 다음의 [수학식 1]로 나타낼 수 있 다. 수학식 1"}
{"patent_id": "10-2023-0124581", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "종래의 챗봇 시스템은 정해진 규칙 범위에만 국한되어 일정한 대한만을 수행하였다. 반면, 특정 도메인에 파인 튜닝이 이루어진 신경망 언어 모델을 갖는 본 발명의 AI 휴먼형 챗봇은 다양한 어조, 어투의 대화가 가능해지고 사용자에게 조금 더 생동감 있는 대화도 가능하다. 파인튜닝 과정에서 새롭게 학습시키는 훈련 데이터셋을 다양 한 어조와 어투가 포함된 데이터로 구성하고, 예측 출력 분포의 파라미터를 조정하여 균일분포(uniform distribution)를 따르도록 하여 신경망 언어 모델의 응답 방식에 다양성을 갖게 한다. 다음으로, 챗봇 실시간 처리부의 세부 구성에 대해 살펴본다. 챗봇 실시간 처리부는 사용자 입력부와 챗봇 응답 생성부와 아바타 응답 생성부와 챗봇 응 답 출력부를 포함하여 구성된다. 사용자 입력부는 사용자의 질문이나 요청이 포함된 음성이나 문자를 실시간으로 입력받아 입력 텍스트 데 이터를 구성한다. 사용자 입력이 음성으로 들어오는 경우에는 STT(Sppech-to-Text)를 통해 텍스트 데이터로 변 환한다. 챗봇 응답 생성부는 사용자의 입력 텍스트 데이터를 신경망 모텔 튜닝부에 의해 파인튜닝된 신경망 언어 모델에 입력하여 챗봇 응답 텍스트를 획득한다. 신경망 언어 모델은 텍스트가 입력되면 그에 따른 응답 텍 스트를 생성하여 출력한다. 챗봇 응답 생성부는 신경망 언어 모델을 활용하여 사용자의 입력 텍스트 데이 터에 대응하는 챗봇 응답 텍스트를 획득한다. 한편, 챗봇 응답 생성부는 신경망 언어 모델에 프롬프트 엔지니어링을 적용하여 사용자의 입력 텍스트(질 문, 요청)에 적절히 응답할 수 있도록 구성하는 것이 바람직하다. 일반적으로 프롬프트 엔지니어링(Prompt Engineering)은 인공지능 언어 모델을 사용할 때, 원하는 결과를 얻기 위해 적절한 입력(프롬프트)을 설정하는 기술이다. 신경망 모델의 특성과 한계를 이해하고, 원하는 작업을 정확 하게 지시하는 프롬프트를 구성하여 신경망 모델의 출력을 조작하거나 개선한다. 프롬프트 엔지니어링에서는 명 령어, 맥락 설명, 역할 부여, 퓨샷 예시들(Few-shot Examples)을 적절하게 구성하여 개체명과 의도 인식을 통합 한다. 사용자의 대화에서 느껴지는 의도를 예측하고, 해당 텍스트에서 가지는 개체들을 파악하는 성능이 프롬프 트 엔지니어링에 의해 개선된다. 이에, 챗봇 응답 생성부는 도메인별로 각각의 상황에 맞는 양호한 프롬프트 템플릿을 준비하고, 입력 텍스 트 데이터에 프롬프트 템플릿을 추가하여 신경망 언어 모델에 입력하는 것이 바람직하다. 이 경우에 신경망 언 어 모델은 훨씬 양호한 챗봇 응답 텍스트를 생성하여 출력할 것으로 기대된다. [도 5]는 본 발명에서 프롬프트 엔지니어링의 적용 예시도이다. 본 발명의 챗봇 응답 생성 구성에서 프롬프트 엔지니어링 기술이 효과적으로 작동하는 이유는 어텐션 메커니즘 이 적용된 거대 언어 모델(LLM)의 특성 및 각각의 도메인별로 채팅 테이터셋을 활용하여 파인튜닝된 거대 언어 모델(LLM)의 특성 때문이다. 어텐션 메커니즘은 자연어 처리에 있어서 단어들 사이의 관계를 계산함으로써 전체적인 맥락을 파악할 수 있게 해준다. 그에 따라, 어텐션 메커니즘은 프롬프트 엔지니어링에서 프롬프트 부분의 단어와 토큰들의 맥락에 부합 하는 적절한 챗봇 응답이 생성되는 성능을 개선한다. 신경망 언어 모델이 각각의 도메인별로 채팅 테이터셋을 활용하여 파인튜닝되어 있기 때문에 도메인별로 각각의 상황에 맞게 양호한 프롬프트 템플릿을 준비하여 활용한다면 어텐션 메커니즘과의 결합에 의해 챗봇 응답의 적 절함과 자연스러움을 개선할 수 있다. 신경망 모델 튜닝부에 의해 각 도메인에 맞게 파인튜닝으로 학습된 거대 언어 모델(LLM)의 파라미터 θ는 해당 파인튜닝에서 사용된 특정 도메인 데이터 분포가 반영된 파라미터 θ 값이며, 해당 θ는 예측값의 확률 분 포를 결정하게 된다. 즉, 사용자 입력 X가 들어오면 특정 도메인 데이터의 분포가 반영된 파라미터 θ를 통해 출력 Y가 결정된다. 따라서, 특정 도메인 데이터 분포와 관련성 있는 적절한 프롬프트 템플릿을 선별하여 입력 X와 함께 넣어주면 신경망 언어 모델(LLM)은 최적화된 θ를 통해 더 정확한 예측값 Y를 출력할 수 있다. 이는 [수학식 2]로 나타낼 수 있다. 수학식 2"}
{"patent_id": "10-2023-0124581", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "아바타 응답 생성부는 동적 아바타에 챗봇 응답 텍스트를 합성하여 아바타 응답 동영상을 생성한다. 본 발명에서 아바타 응답 생성부가 아바타 응답 동영상을 생성하는 일 실시예를 기술한다. TTS(Text-to- speech)를 통해 챗봇 응답 텍스트로부터 챗봇 음성 데이터를 생성하고, 음성과 동영상을 동기화 합성하여 동적아바타 동영상에 립싱크 입 모양과 음성을 삽입함으로써 아바타가 챗봇 응답 텍스트를 말하는 것과 같은 모습의 동영상을 생성한다. 이때, 음성과 동영상을 동기화 합성하는 일 실시예는 다음과 같다. 먼저, 동적 아바타 동영상에서 동영상 프레 임 별로 얼굴 영역과 입 모양의 키 포인트를 예측하여 해당 좌표 정보를 벡터(이하, '제 1 벡터'라 함)로 표현 한다. 그리고, 챗봇 음성 데이터를 음성 인코딩 모델을 통해 벡터(이하, '제 2 벡터'라 함)로 표현한다. 이 제 2 벡터에는 입 모양과 동기화가 필요한 정보를 담고 있게 된다. 그리고 나서, 이들 제 1 및 제 2 벡터를 역합성 곱(deconvolution) 연산을 통해 음성에 알맞은 입 모양을 위 인식된 동영상 프레임마다 결합하여 입 모양이 동 기화된 아바타 동영상을 생성한다. 마지막으로, 이 아바타 동영상에 챗봇 음성 데이터를 합성한다. 바람직하게는 적대적 생성 신경망(Generative Adversarial Network, GAN)의 음성 및 영상 동기화 기술을 통해 사용자와의 상호 대화를 진행할 수 있게 된다. 일반적으로 GAN 알고리즘에서는 두 개의 신경망, 생성기 G와 판 별기 D가 적대적인 관계로 작동한다. 생성기 G는 실제 데이터와 유사한 가짜 데이터를 만들어내고, 판별기 D는 그 입력된 데이터가 실제 데이터인지 아니면 생성기 G가 만들어낸 가짜 데이터인지를 판별한다. 이런 학습 과정 을 통하여 GAN 모델의 생성기 G는 점점 실제 데이터와 유사한 가짜 데이터(가상 이미지)를 만들어낼 수 있게 된 다. 챗봇 응답 출력부는 아바타 응답 동영상을 사용자 장치로 전송하여 사용자에게 제공한다. 한편, 본 발명은 컴퓨터가 읽을 수 있는 비휘발성 기록매체에 컴퓨터가 읽을 수 있는 코드의 형태로 구현되는 것이 가능하다. 이러한 비휘발성 기록매체로는 다양한 형태의 스토리지 장치가 존재하는데 예컨대 하드디스크, SSD, CD-ROM, NAS, 자기테이프, 웹디스크, 클라우드 디스크 등이 있다. 또한, 본 발명은 하드웨어와 결합되어 특정의 절차를 실행시키기 위하여 매체에 저장된 컴퓨터프로그램의 형태로 구현될 수도 있다."}
{"patent_id": "10-2023-0124581", "section": "도면", "subsection": "도면설명", "item": 1, "content": "[도 1]은 본 발명에 인공지능 아바타와 도메인 특화 언어모델 기반의 AI 휴먼형 챗봇 시스템의 전체 구성도. [도 2]는 본 발명에서 동적 아바타 생성부의 세부 구성 블록도. [도 3]은 이미지 워핑의 예시도. [도 4]는 본 발명에서 도메인 특화 학습부의 세부 구성 블록도. [도 5]는 본 발명에서 프롬프트 엔지니어링의 적용 예시도."}
