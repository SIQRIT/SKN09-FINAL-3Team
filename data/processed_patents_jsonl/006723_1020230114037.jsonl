{"patent_id": "10-2023-0114037", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2025-0031940", "출원번호": "10-2023-0114037", "발명의 명칭": "스마트홈 환경에서 가상 의류를 활용한 패션상품 추천 방법", "출원인": "주식회사 큐버", "발명자": "박현용"}}
{"patent_id": "10-2023-0114037", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "스마트홈 환경에서 사용자에게 패션상품을 추천하기 위해 상품 추천 서버(100)가 수행하는 스마트홈 환경에서가상 의류를 활용한 패션상품 추천 방법으로서, 착용 이미지 수신부(110)가 스마트홈 디바이스(10)로부터 사용자의 의상착용 이미지(W)를 수신하는 제 1 단계; 이미지 특징 추출부(130)의 이미지 특징분류 신경망(130N)이 상기 의상착용 이미지(W)에 대해 다중 라벨 분류를수행하여 이미지 특징으로서 복수의 패션 속성에 대응하는 복수의 클래스 벡터를 생성하는 제 2 단계; 이미지 벡터 생성부(140)의 시멘틱 세그먼테이션 신경망(140N)이 상기 의상착용 이미지(W)에 대해 픽셀 단위로의상 카테고리 분류를 수행하여 세그먼트 특징 맵()을 생성하는 제 3 단계; 특징벡터 생성부(150)가 상기 이미지 특징 추출부(130)가 추출한 이미지 특징의 메인 클래스 정보 라벨의 텍스트 벡터 및 서브 클래스 정보 라벨의 텍스트 벡터, 그리고 상기 이미지 특징 추출부(130)가 생성한 복수의 클래스 벡터를 연결 구성한 이미지 특징 벡터 로부터 상기 의상착용 이미지(W)에 대한 특징 벡터()를 생성하는제 4 단계; 가상벡터 생성부(160)가 상기 세그먼트 특징 맵()과 상기 특징 벡터()과 가우시안 노이즈 벡터()를 연결하고 컨볼루션 연산을 수행하여 가상 벡터()를 생성하는 제 5 단계; 가상 이미지 생성부(170)가 상기 가상 벡터()와 상기 특징 벡터()와 가우시안 노이즈 벡터()를 연결하고역컨볼루션 연산을 수행하여 가상 이미지 벡터()를 생성하는 제 6 단계; 상기 가상 이미지 생성부(170)의 가상이미지 생성 신경망(170N)이 가상 이미지 벡터()로부터 가상 의류의 이미지인 가상의상 이미지(WV)를 복수 개 생성하는 제 7 단계; 사용자 선택 획득부(180)가 상기 가상의상 이미지(WV)를 사용자 단말(20)에 제공하여 사용자 선택에 따른 선택의상 이미지(S)를 식별하는 제 8 단계; 유사상품 추출부(190)가 입점 상품 DB(330)에 저장된 다수의 입점 브랜드 상품의 이미지와 상기 선택의상 이미지(S) 간의 유사도에 기초하여 입점 상품 DB(330)로부터 추천 대상 상품(R)을 선별하는 제 9 단계; 상품추천 제공부(200)가 상기 추천 대상 상품(R)을 사용자 단말(20)에 제공하여 사용자에게 추천하는 제 10 단계; 를 포함하여 구성되는 스마트홈 환경에서 가상 의류를 활용한 패션상품 추천 방법."}
{"patent_id": "10-2023-0114037", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "청구항 1에 있어서, 패션 텍스트 수신부(120)가 스마트홈 디바이스(10)로부터 사용자가 원하는 의류에 대한 묘사적인 설명인 패션요구 텍스트(T)를 수신하는 단계; 를 상기 제 4 단계 이전에 더 포함하여 구성되고, 상기 제 4 단계는, 특징벡터 생성부(150)가 상기 이미지 특징 추출부(130)가 추출한 이미지 특징의 여러 라벨들 중에서 메인 클래스 정보의 라벨을 텍스트 벡터로 인코딩하여 특징 벡터()로 설정하는 단계; 공개특허 10-2025-0031940-3-상기 특징벡터 생성부(150)가 상기 이미지 특징 추출부(130)가 추출한 이미지 특징의 여러 라벨들 중에서 서브클래스 정보의 라벨을 텍스트 벡터로 인코딩하여 텍스트 임베딩 벡터( )로 생성하는 단계; 상기 특징벡터 생성부(150)가 상기 패션요구 텍스트(T)를 텍스트 벡터로 인코딩하고 상기 텍스트 임베딩 벡터에 추가하는 단계; 상기 특징벡터 생성부(150)가 이미지 특징 추출부(130)가 생성한 복수의 클래스 벡터를 연결하여 이미지 특징벡터()를 구성하는 단계; 상기 특징벡터 생성부(150)가 상기 이미지 특징 벡터()와 상기 텍스트 임베딩 벡터( )를 연결하여 상기특징 벡터()를 추가 생성하는 단계; 를 포함하여 구성되는 것을 특징으로 하는 스마트홈 환경에서 가상 의류를 활용한 패션상품 추천 방법."}
{"patent_id": "10-2023-0114037", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "청구항 1에 있어서, 상기 가상 이미지 생성부(170)는 가상이미지 생성 신경망(170N)의 생성기 G와 판별기 D에 대해 목적 함수에 의해 원래의상기 특징 벡터()와 업데이트 이후의 특징 벡터() 간의 차이가 최소화하도록 머신러닝 학습을 수행하는 것을 특징으로 하는 스마트홈 환경에서 가상 의류를 활용한 패션상품 추천 방법. (이때, λ는 목적 함수에서의 중요도를 조정하기 위한 가중치 하이퍼 파라미터)"}
{"patent_id": "10-2023-0114037", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "청구항 1에 있어서, 상기 제 9 단계는, 유사상품 추출부(190)가 입점 상품 DB(330)에 저장된 다수의 입점 브랜드 상품의 이미지인 입점상품 이미지(P)를 임베딩 모델(190A)에 입력하여 입점상품 이미지 벡터(PV)로 변환하고 상기 입점 상품 DB(330)에 저장하는 단계; 상기 유사상품 추출부(190)가 상기 선택의상 이미지(S)를 임베딩 모델(190B)에 입력하여 선택의상 이미지 벡터(SV)로 변환하는 단계; 상기 유사상품 추출부(190)가 상기 입점 상품 DB(330)에 저장된 다수의 선택의상 이미지 벡터(SV)에 대해 상기입점상품 이미지 벡터(PV)와의 유사도를 거리 기반으로 산출하는 단계; 상기 유사상품 추출부(190)가 유사도 기반으로 입점 브랜드 상품 중에서 추천 대상 상품(R)을 선별하는 단계; 를 포함하여 구성되는 것을 특징으로 하는 스마트홈 환경에서 가상 의류를 활용한 패션상품 추천 방법."}
{"patent_id": "10-2023-0114037", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "청구항 1에 있어서, 상기 제 9 단계는, 유사상품 추출부(190)가 상기 선택의상 이미지(S)를 임베딩 모델(190B)에 입력하여 선택의상 이미지 벡터(SV)로변환하는 단계; 상기 유사상품 추출부(190)가 입점 상품 DB(330)에 저장된 다수의 입점 브랜드 상품의 이미지인 입점상품 이미공개특허 10-2025-0031940-4-지(P)를 임베딩 모델(190A)에 입력하여 입점상품 이미지 벡터(PV)로 변환하는 단계; 상기 유사상품 추출부(190)가 상기 다수의 선택의상 이미지 벡터(SV)에 대해 상기 입점상품 이미지 벡터(PV)와의 유사도를 거리 기반으로 산출하는 단계; 상기 유사상품 추출부(190)가 유사도 기반으로 입점 브랜드 상품 중에서 추천 대상 상품(R)을 선별하는 단계; 를 포함하여 구성되는 것을 특징으로 하는 스마트홈 환경에서 가상 의류를 활용한 패션상품 추천 방법."}
{"patent_id": "10-2023-0114037", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "컴퓨터에 청구항 1 내지 5 중 어느 하나의 항에 따른 스마트홈 환경에서 가상 의류를 활용한 패션상품 추천 방법을 실행시키기 위하여 저장매체에 저장된 컴퓨터프로그램."}
{"patent_id": "10-2023-0114037", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 스마트홈 디바이스에 설치된 카메라를 통해 수집되는 의상착용 이미지에 내재된 스타일, 색상 등의 특 징 정보를 통해 가상 의류를 생성하고, 그 생성된 가상 의류를 입점 상품 데이터베이스에 있는 이미지들과 유사 한 실제 브랜드 상품들을 사용자에게 추천해주는 스마트홈 환경에서 가상 의류를 활용한 패션상품 추천 기술에 (뒷면에 계속)"}
{"patent_id": "10-2023-0114037", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 일반적으로 스마트홈 환경에서 온라인 쇼핑을 위하여 패션상품을 추천해주는 기술에 관한 것이다. 특히, 본 발명은 스마트홈 디바이스에 설치된 카메라를 통해 수집되는 의상착용 이미지에 내재된 스타일, 색상 등의 특징 정보를 통해 가상 의류를 생성하고, 그 생성된 가상 의류를 입점 상품 데이터베이스에 있는 이미지들 과 유사한 실제 브랜드 상품들을 사용자에게 추천해주는 스마트홈 환경에서 가상 의류를 활용한 패션상품 추천 기술에 관한 것이다."}
{"patent_id": "10-2023-0114037", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "통신망의 발달과 이동통신 기기의 보급으로 온라인 쇼핑(모바일 쇼핑) 분야는 급격하게 성장하였다. 온라인 쇼 핑은 공간 제약을 받지 않고 사실상 무제한의 제품을 고객들에게 제공할 수 있어 오프라인 쇼핑에 비해 확실한 우위가 있다. 시장 규모가 커짐에 따라 온라인 쇼핑 업체의 수도 엄청나게 증가하고 이들 간의 경쟁도 날로 치열해지고 있다. 온라인 쇼핑 사이트의 경쟁력을 높이기 위한 여러 노력이 있어왔는데 상품 추천 기능은 온라인 쇼핑 경쟁력의 핵심이 되었다. 온라인 쇼핑 사이트의 화면에 제시되는 상품의 목록을 개별 고객에게 특화하여 구성하는 것이다. 종래의 일반적인 상품 추천 방식은 고객 개인 정보와 상품 특징 정보를 매칭하여 추천대상 상품을 선별하였다. 이 과정은 벡터 기반의 선형대수(linear algebra) 이론에 의해 고객 개인 정보와 상품 특징 정보 간의 상호작용 을 모델링하여 이루어질 수 있다. 고객 개인 정보(예: 연령, 성별, 취향, 구매이력 등)와 상품 특징 정보(예: 스타일, 색상, 패턴 등)를 각각 다차원 공간에서의 벡터(vector)로 표현하고, 다차원 공간에서 이들 벡터들 간 의 거리 또는 각도에 의해 컨텐츠 기반, 유저 기반, 하이브리드 기반 추천 알고리즘을 적용한다. 고객 개인 정보와 상품 특징 정보 간의 상호작용을 모델링하기 위해 인공지능 기술이 적용될 수 있다. 예를 들 어, 그래프 신경망(Graph Neural Network, GNN)을 활용한 딥러닝 추천 알고리즘은 사용자와 상품 간의 복잡한 상호관계를 세밀하게 모델링할 수 있다. GNN에서는 사용자와 상품을 노드(node)로 하고 이들 간의 상호작용을 엣지(edge)로 하는 그래프를 구성한 후에, 이 그래프 위에서 사람들의 구매 데이터를 이용하여 그래프를 훈련시 킨다. 한편, 패션 상품 분야는 온라인 쇼핑의 중요한 부문이므로 패션상품 추천에 특화된 여러 아이디어가 제시되고 있다. 예를 들어, 대한민국 등록특허 10-1418372호 \"가상피팅을 이용한 패션상품 추천 시스템 및 추천 방법\"은 사용자의 상품 구매 취향을 분석하여 입고 상품들 중에서 사용자에게 어울리는 추천 상품을 선별하고, 이들 추 천 상품의 영상과 고객 아바타 영상을 조합한 가상 피팅(virtual fitting) 영상을 생성하며 사용자 단말기로 전 송하는 기술이다. 이와 같은 종래의 상품 추천 기술은 여러가지 문제점을 가지고 있다. 먼저, 해당 고객의 구매 이력이나 브라우징 패턴, 그리고 유사 사용자의 행동 등을 기반으로 설계되기 때문에 과거 데이터에 과도하게 의존한다. 또한, 사용자의 독특한 스타일과 선호도를 완벽하게 이해하고 반영하는데 한계가 있다. 사용자의 개인 정보와 상품의 특징 정보를 바탕으로 추천을 제공하는 방식은 어느 정도 사용자의 취향을 반영할 수 있지만, 사용자의 스타일이 시간에 따라 변하거나 다양한 패션 트렌드에 민감하게 반응하는 경우 이를 충분히 반영하기 어렵다. 또한, 사용자의 개인정보는 민감한 속성이 있어 항상 법적인 리스크가 내재되어 있다. 법적 리스크를 낮추기 위 해 개인정보의 수집을 엄격하게 운용하는 경우에는 선호도 데이터가 충분히 확보되지 못하여 콜드-스타트(cold- start) 문제에 직면하게 되는데, 이 경우에는 상품 추천 성능이 저하된다. 선행기술문헌 특허문헌 (특허문헌 0001) 대한민국 공개특허 10-2022-0094824호 \"인공지능 스타일리스트를 이용한 패션 상품 추천 방법\" (특허문헌 0002) 대한민국 공개특허 10-2020-0066970호 \"고객의 보유 패션 아이템 기반 맞춤형 자동 코디 제안 과 패션상품 추천 시스템과 서비스 방법 및 정보 관리 시스템\" (특허문헌 0003) 대한민국 등록특허 10-2507719호 \"협업형 다중 에이전트 강화학습 방법을 이용한 패션상품 추 천시스템\" (특허문헌 0004) 대한민국 등록특허 10-2392674호 \"패션 상품 추천 방법, 장치 및 시스템\" (특허문헌 0005) 대한민국 등록특허 10-2153410호 \"주얼리 상품 추천 방법 및 주얼리 상품 추천 장치\" (특허문헌 0006) 대한민국 등록특허 10-1418372호 \"가상피팅을 이용한 패션상품 추천 시스템 및 추천 방법\""}
{"patent_id": "10-2023-0114037", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명의 목적은 일반적으로 스마트홈 환경에서 온라인 쇼핑을 위하여 패션상품을 추천해주는 기술을 제공하는 것이다. 특히, 본 발명의 목적은 스마트홈 디바이스에 설치된 카메라를 통해 수집되는 의상착용 이미지에 내재된 스타일, 색상 등의 특징 정보를 통해 가상 의류를 생성하고, 그 생성된 가상 의류를 입점 상품 데이터베이스에 있는 이미지들과 유사한 실제 브랜드 상품들을 사용자에게 추천해주는 스마트홈 환경에서 가상 의류를 활용한 패션상품 추천 기술을 제공하는 것이다. 본 발명의 해결 과제는 이 사항에 제한되지 않으며 본 명세서의 기재로부터 다른 해결 과제가 이해될 수 있다."}
{"patent_id": "10-2023-0114037", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "상기의 목적을 달성하기 위하여 본 발명은 스마트홈 환경에서 사용자에게 패션상품을 추천하기 위해 상품 추천 서버가 수행하는 스마트홈 환경에서 가상 의류를 활용한 패션상품 추천 방법을 제시한다. 본 발명에 따른 스마트홈 환경에서 가상 의류를 활용한 패션상품 추천 방법은, 착용 이미지 수신부가 스마 트홈 디바이스로부터 사용자의 의상착용 이미지(W)를 수신하는 제 1 단계; 이미지 특징 추출부의 이미 지 특징분류 신경망(130N)이 의상착용 이미지(W)에 대해 다중 라벨 분류를 수행하여 이미지 특징으로서 복수의 패션 속성에 대응하는 복수의 클래스 벡터를 생성하는 제 2 단계; 이미지 벡터 생성부의 시멘틱 세그먼테 이션 신경망(140N)이 의상착용 이미지(W)에 대해 픽셀 단위로 의상 카테고리 분류를 수행하여 세그먼트 특징 맵 ()을 생성하는 제 3 단계; 특징벡터 생성부가 이미지 특징 추출부가 추출한 이미지 특징의 메인 클 래스 정보 라벨의 텍스트 벡터 및 서브 클래스 정보 라벨의 텍스트 벡터, 그리고 이미지 특징 추출부가 생 성한 복수의 클래스 벡터를 연결 구성한 이미지 특징 벡터 로부터 의상착용 이미지(W)에 대한 특징 벡터()를 생성하는 제 4 단계; 가상벡터 생성부가 세그먼트 특징 맵()과 특징 벡터()과 가우시안 노이즈 벡터 ()를 연결하고 컨볼루션 연산을 수행하여 가상 벡터()를 생성하는 제 5 단계; 가상 이미지 생성부가 가상 벡터()와 특징 벡터()와 가우시안 노이즈 벡터()를 연결하고 역컨볼루션 연산을 수행하여 가상 이미지 벡터()를 생성하는 제 6 단계; 가상 이미지 생성부의 가상이미지 생성 신경망(170N)이 가상 이미지 벡터()로부터 가상 의류의 이미지인 가상의상 이미지(WV)를 복수 개 생성하는 제 7 단계; 사용자 선택 획득부 가 가상의상 이미지(WV)를 사용자 단말에 제공하여 사용자 선택에 따른 선택의상 이미지(S)를 식별하 는 제 8 단계; 유사상품 추출부가 입점 상품 DB에 저장된 다수의 입점 브랜드 상품의 이미지와 선택 의상 이미지(S) 간의 유사도에 기초하여 입점 상품 DB로부터 추천 대상 상품(R)을 선별하는 제 9 단계; 상 품추천 제공부가 추천 대상 상품(R)을 사용자 단말에 제공하여 사용자에게 추천하는 제 10 단계; 를 포함하여 구성된다. 본 발명에 따른 스마트홈 환경에서 가상 의류를 활용한 패션상품 추천 방법은, 패션 텍스트 수신부가 스마 트홈 디바이스로부터 사용자가 원하는 의류에 대한 묘사적인 설명인 패션요구 텍스트(T)를 수신하는 단계; 를 더 포함하여 구성될 수 있다. 본 발명에서 제 4 단계는, 특징벡터 생성부가 이미지 특징 추출부가 추출한 이미지 특징의 여러 라벨 들 중에서 메인 클래스 정보의 라벨을 텍스트 벡터로 인코딩하여 특징 벡터()로 설정하는 단계; 특징벡터 생 성부가 이미지 특징 추출부가 추출한 이미지 특징의 여러 라벨들 중에서 서브 클래스 정보의 라벨을 텍스트 벡터로 인코딩하여 텍스트 임베딩 벡터( )로 생성하는 단계; 특징벡터 생성부가 패션요구 텍스트(T)를 텍스트 벡터로 인코딩하고 텍스트 임베딩 벡터 에 추가하는 단계; 특징벡터 생성부가 이미지 특징 추출부가 생성한 복수의 클래스 벡터를 연결하여 이미지 특징 벡터()를 구성하는 단계; 특징 벡터 생성부가 이미지 특징 벡터()와 텍스트 임베딩 벡터( )를 연결하여 특징 벡터()를 추가 생성하는 단계;를 포함하여 구성될 수 있다. 본 발명에서 가상 이미지 생성부는 가상이미지 생성 신경망(170N)의 생성기 G와 판별기 D에 대해 목적 함 수 에 의해 원래 의 특징 벡터()와 업데이트 이후의 특징 벡터() 간의 차이가 최소화하도록 머신러닝 학습을 수행하도록 구 성될 수 있다.(이때, λ는 목적 함수에서 의 중요도를 조정하기 위한 가중치 하이퍼 파라미터) 본 발명에서 제 9 단계는, 유사상품 추출부가 입점 상품 DB에 저장된 다수의 입점 브랜드 상품의 이 미지인 입점상품 이미지(P)를 임베딩 모델(190A)에 입력하여 입점상품 이미지 벡터(PV)로 변환하고 입점 상품 DB에 저장하는 단계; 유사상품 추출부가 선택의상 이미지(S)를 임베딩 모델(190B)에 입력하여 선택의 상 이미지 벡터(SV)로 변환하는 단계; 유사상품 추출부가 입점 상품 DB에 저장된 다수의 선택의상 이 미지 벡터(SV)에 대해 입점상품 이미지 벡터(PV)와의 유사도를 거리 기반으로 산출하는 단계; 유사상품 추출부 가 유사도 기반으로 입점 브랜드 상품 중에서 추천 대상 상품(R)을 선별하는 단계;를 포함하여 구성될 수 있다. 본 발명에서 제 9 단계는, 유사상품 추출부가 선택의상 이미지(S)를 임베딩 모델(190B)에 입력하여 선택의 상 이미지 벡터(SV)로 변환하는 단계; 유사상품 추출부가 입점 상품 DB에 저장된 다수의 입점 브랜드 상품의 이미지인 입점상품 이미지(P)를 임베딩 모델(190A)에 입력하여 입점상품 이미지 벡터(PV)로 변환하는 단 계; 유사상품 추출부가 다수의 선택의상 이미지 벡터(SV)에 대해 입점상품 이미지 벡터(PV)와의 유사도를 거리 기반으로 산출하는 단계; 유사상품 추출부가 유사도 기반으로 입점 브랜드 상품 중에서 추천 대상 상 품(R)을 선별하는 단계;를 포함하여 구성될 수 있다. 한편, 본 발명에 따른 컴퓨터프로그램은 컴퓨터에 이상과 같은 스마트홈 환경에서 가상 의류를 활용한 패션상품 추천 방법을 실행시키기 위하여 비휘발성 저장매체에 저장된 것이다."}
{"patent_id": "10-2023-0114037", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "종래의 패션상품 추천 방식에서는 사용자의 히스토리 데이터와 구매후기 및 이벤트 로그에 따라서 사용자가 선 호할만한 상품들을 추천한다. 이러한 종래 방식은 비교적 민감한 정보인 사용자의 개인정보가 다수 필요하고 구 매이력, 구매후기 등의 히스토리 정보가 충분히 쌓여야만 상품 추천의 정확도가 보장되는 단점이 있었다. 반면, 본 발명에서는 사용자의 개인정보를 이용하지 않으므로 종래 방식의 단점으로부터 자유롭다. 본 발명에서 는 쇼핑 의도가 있는 상황에서 스마트홈 디바이스를 통해 의상착용 이미지만 제공되면 스타일, 색상, 연령, 계절성 등의 여러 특징을 자동으로 감지하여 패션상품의 추천을 수행한다. 또한, 본 발명에서는 사용자가 추가 정보(예: 스피치, 텍스트)를 제공해줄수록 사용자의 니즈를 더욱 충족시킬 수 있는 추천 결과를 도출할 수 있는 방식이므로 구매이력, 구매후기 등의 히스토리 정보가 충분히 쌓이지 않더 라도 상품 추천의 정확도를 보장할 수 있는 장점이 있다."}
{"patent_id": "10-2023-0114037", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하에서는 도면을 참조하여 본 발명을 상세하게 설명한다. 본 발명을 설명함에 있어서 종래기술과 중복되는 부분에 대해서는 자세한 설명을 생략할 수 있다. [도 1]과 [도 2]는 본 발명에서 패션상품 추천 과정을 개념적으로 나타내는 도면이다. 본 발명은 스마트홈 디바이스, 사용자 단말, 상품 추천 서버, 정보수집 데이터베이스가 네트 워크를 통해 협조 동작하는 구조이다. 스마트홈 디바이스는 사용자의 댁내 공간에 설치된 장치로서 예컨대 스마트 미러(smart mirror)로 구현될 수 있다. 사용자 단말은 사용자가 조작 가능한 장치로서 예컨대 스마트폰으로 구현될 수 있다. 구현 예에 따라서는 스마트홈 디바이스와 사용자 단말이 동일 장치로 구현될 수 있다. 상품 추천 서버는 수집 정보에 기초하여 패션상품 추천을 수행하는 장치이고, 정보수집 데이터베이스(30 0)는 각종 데이터를 저장하는 장치이다. 구현 예에 따라서는 상품 추천 서버와 정보수집 데이터베이스 도 동일 장치로 구현될 수 있다. 이하에서는 본 발명에서 사용자에게 패션상품을 추천하는 과정에 대해 기술한다. 먼저, 스마트홈 디바이스가 내장 카메라를 이용하여 사용자를 촬영하여 해당 사용자의 의상착용 이미지(W) (예: 상의를 입고 있는 상반신 이미지)를 획득한다(S10). 이 과정은 스마트홈 디바이스에 대한 사용자 조작 에 의해 수행될 수도 있고 스마트홈 디바이스의 작동 프로그램에 의해 자체 수행될 수도 있다. 이때, 스마 트홈 디바이스는 사용자가 원하는 의류에 대한 묘사적인 설명('패션요구 텍스트')을 수신할 수 있다(S20). 스마트홈 디바이스는 의상착용 이미지(W)와 패션요구 텍스트를 상품 추천 서버로 전달한다(S30). 상품 추천 서버는 스마트홈 디바이스로부터 의상착용 이미지(W)와 패션요구 텍스트(T)를 수신하여 데이터베 이스에 저장한다(S40, S50, S51). 상품 추천 서버는 의상착용 이미지(W)로부터 이미지 특징을 추출한다. 후술하는 바와 같이, 상품 추천 서 버의 이미지 특징분류 신경망(130N)이 의상착용 이미지(W)에 대해 다중 라벨 분류를 수행하여 복수의 패션 속성에 대응하는 복수의 클래스 벡터를 생성한다. 상품 추천 서버는 그 추출한 이미지 특징을 데이터베이 스에 저장한다(S60, S61). 상품 추천 서버는 그 수집한 의상착용 이미지(W)로부터 세그먼트 특징 맵(segment feature map)을 생성한 다(S70). 상품 추천 서버는 그 수집한 의상착용 이미지(W)에서 느껴지는 스타일, 계절성, 성별, 색상 등의 정보를 인식하여 특징 벡터를 생성한다(S80). 또한, 상품 추천 서버는 패션요구 텍스트(T)로부터 특징 벡터를 추 가 획득할 수 있다(S90). 상품 추천 서버는 모든 벡터들을 연결 및 연산하여 가상의 의류 상품 이미지(가상의상 이미지(WV))를 복수 개 생성하고(S100), 이들 가상의상 이미지(WV)를 사용자 단말로 제공한다(S110). 사용자는 사용자 단말 상에서 가상의상 이미지들(WV) 중 마음에 드는 상품 이미지가 있다면 선택하게 된다. 그에 따라, 상품 추천 서버는 사용자 단말에서의 사용자 조작에 대응하여 사용자가 선택한 이미지, 즉 선택의상 이미지(S)를 식별한다(S120, S130). 상품 추천 서버는 실제 브랜드입점 상품들 중에서 위 선택의상 이미지(S)에 기초하여 추천 알고리즘에 따 른 추천 대상 상품(R)을 선별하고 사용자 단말에 상품 추천을 제공하여 제품 구매를 유도한다(S140, S141, S150). 이상의 과정을 통해 스마트홈 환경에서 사용자에게 개인화된 추천에 따른 온라인 홈쇼핑을 구현할 수 있다. 사 용자는 스마트홈 디바이스를 통해 상품 추천에 참고할만한 의상착용 이미지(W)를 제공하며, 상품 추천 서버 가 인공지능(AI) 기반으로 가상의 패션아이템 후보들을 생성하여 제시한다. 이들 가상의 패션아이템 후보 들 중에서 사용자가 어느 하나를 선택하면 그 선택된 패션아이템을 기반으로 실제 입점 브랜드 상품이 선별되어 추천된다. [도 3]은 본 발명에 따른 스마트홈 환경에서 가상 의류를 활용한 패션상품 추천 시스템의 전체 구성도이고, [도 4]는 본 발명에서 상품 추천 서버가 사용하는 인공지능 신경망의 구성도이다. 본 발명에서는 스마트홈 디바이스, 사용자 단말, 상품 추천 서버, 정보수집 데이터베이스가 협조 동작한다. 상품 추천 서버는 스마트홈 디바이스로부터 제공받은 사용자의 이미지로부터 특징을 추출하고 이에 기 반하여 가상의상 이미지들(WV)을 생성한다. 이들 가상의상 이미지(WV)는 사용자 단말로 제공되어 사용자에 게 노출되며, 사용자가 이들 중에서 원하는 가상 의상을 선택하면, 상품 추천 서버는 그 선택 정보에 기초 하여 패션상품 추천을 달성한다. 이때, 스마트홈 디바이스와 사용자 단말은 동일 장치로 구현될 수 있 다. 이를 위해, 상품 추천 서버는 착용 이미지 수신부, 패션 텍스트 수신부, 이미지 특징 추출부 , 이미지 벡터 생성부, 특징벡터 생성부, 가상벡터 생성부, 가상 이미지 생성부, 사 용자 선택 획득부, 유사상품 추출부, 상품추천 제공부를 포함하여 구성된다. 이중에서 이미지 특징 추출부, 이미지 벡터 생성부, 가상 이미지 생성부는 머신러닝 기반의 인 공지능 신경망(AI Neural Network)을 활용하는데 이들을 각각 이미지 특징분류 신경망(130N), 시멘틱 세그먼테 이션 신경망(140N), 가상이미지 생성 신경망(170N)이라고 부른다. 정보수집 데이터베이스는 상품 추천 서버가 수집 또는 생성하는 각종 데이터를 저장하는 스토리지 공 간을 제공하는데, 일 실시예로서 착용이미지 데이터베이스, 이미지특징 데이터베이스, 입점 상품 데 이터베이스를 포함하여 구성된다. 이하에서는 상품 추천 서버의 각 구성요소를 중심으로 패션상품 추천 시스템의 동작을 설명한다. 먼저, 착용 이미지 수신부에 대해 기술한다. 사용자 공간에 위치한 스마트홈 디바이스가 내장 카메라(11a)를 이용하여 해당 사용자의 의상착용 이미지 (W)를 생성하고 데이터 전송부를 통해 상품 추천 서버로 전송한다. 착용 이미지 수신부는 스마트 홈 디바이스가 제공하는 의상착용 이미지(W)를 수신하여 착용이미지 DB에 저장한다. 즉, 사용자는 패 션상품(예: 의상) 구매를 위해 스마트홈 디바이스(예: 디지털 미러) 앞에서 자신의 이미지를 촬영하는데, 해당 이미지, 즉 의상착용 이미지(W)는 착용 이미지 수신부에 의해 수집되어 착용이미지 DB에 저장된 다. 다음으로, 패션 텍스트 수신부에 대해 기술한다. 사용자 공간에 위치한 스마트홈 디바이스는 내장 마이크(11b)나 키보드(11c)를 이용하여 사용자로부터 자신 이 원하는 패션 결과물에 대한 묘사적 표현(예: \"엘레강스 느낌의 핑크 원피스\")을 입력받는 경우에 이를 패션요구 텍스트(T)로 변환하고 데이터 전송부를 통해 상품 추천 서버로 전송한다. 패션 텍스트 수신부 는 스마트홈 디바이스가 제공하는 패션요구 텍스트(T)를 수신한다. 다음으로, 이미지 특징 추출부에 대해 기술한다. 이미지 특징 추출부는 의상착용 이미지(W)로부터 이미지 특징을 추출한다. 이미지 특징으로 먼저 스타일, 색상, 계절성, 성별 등의 패션 속성이 정의되는데, 이들 패션 속성 각각에 대해 메인 클래스(main class)와 서 브 클래스(sub class)가 정의된다. 즉, 사용자의 의상착용 이미지(W)에서 느껴지는 스타일과 계절성, 의류 자체 의 색상과 성별 등을 인식한 후에 라벨(label)을 추출하여 이미지특징 DB에 저장한다. 이미지 특징 추출부는 이미지 특징분류 신경망(130N) 에 의해 의상착용 이미지(W)에 대해 다중 라벨 분 류(multi-label classification)를 수행한다. 이를 통해, 의상착용 이미지(W)로부터 스타일(main, sub), 색상 (main, sub), 계절성(main), 성별(main) 속성에 대해 클래스를 분류해낼 수 있다. 이때, 스타일 속성에 대한 클래스 벡터(스타일 클래스 벡터)는 , 색상 속성에 대한 클래스 벡터(색상 클래 스 벡터)는 , 계절성 속성에 대한 클래스 벡터(계절성 클래스 벡터)는 , 성별 속성에 대한 클래스 벡 터(성별 클래스 벡터)는 라고 할 때, 그 범위와 내용은 [수학식 1]과 같다. 수학식 1"}
{"patent_id": "10-2023-0114037", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "여기에서 n1은 스타일 종류의 갯수이고, n2는 색상 종류의 갯수이다. [수학식 1]에서는 0 또는 1 값을 갖는 집합 공간으로 이미지 특징(패션 속성)을 정의하였는데, 이는 이미지 특 징이 원핫 벡터(One-Hot vector)임을 의미한다. 일반적으로 '원핫 벡터'는 클래스형 데이터를 이진화하여 1 x N 행렬(즉, 벡터) 형태로 표현하는 기법이다. 클래스별로 하나의 요소를 가지며, 해당 클래스의 요소는 1로 표시 하고 다른 요소는 0으로 표시한다. 예를 들어, 동물 종류를 표현하기 위한 클래스 변수를 가정한다. \"고양이\", \"개\", \"말\"의 클래스가 있다고 하면, \"고양이\"를 나타내는 원핫 벡터는 [1, 0, 0]이고 \"개\"를 나타내는 원핫 벡 터는 [0, 1, 0]이고 \"말\"을 나타내는 원핫 벡터는 [0, 0, 1]이 된다. 이처럼 클래스 개수만큼의 차원을 가진 벡 터를 생성하여 각 클래스를 구분 표현한다. 이미지 특징 분류 신경망(130N) 은 의상착용 이미지(W)로부터 [수학식 1]과 같이 복수의 패션 속성에 대응하 는 복수의 클래스 벡터(예: , , , )를 출력한다. 또한, 이미지 특징 분류 신경망(130N) 은 의상착용 이미지(W) 로부터 [수학식 2]와 같이 각각의 패션 속성에 대하여 메인 클래스(main class) 정 보와 서브 클래스(sub class) 정보를 출력한다. 수학식 2"}
{"patent_id": "10-2023-0114037", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "메인 클래스는 패션 속성(스타일, 색상, 계절성, 성별) 각각에 대해 의상착용 이미지(W)와 관련성이 가장 크다 고 이미지 특징 분류 신경망(130N)이 도출한 클래스이다. 서브 클래스는 일부 패션 속성(스타일, 색상) 각각에 대해 의상착용 이미지(W)와 관련성이 두번째로 크다고 이미지 특징 분류 신경망(130N)이 도출한 클래스이다. 패 션상품은 한가지의 스타일이나 색상이 고려되는 것이 아니라 여러가지 특징이 고려되는 것이 일반적이다. 그에 따라, 본 발명은 멀티클래스 분류 문제로 접근하며, 이에 따라 상기와 같이 다중 라벨 분류를 수행할 수 있는 이미지 특징 분류 신경망(130N) 을 이용한다. 다음으로, 이미지 벡터 생성부에 대해 기술한다. 이미지 벡터 생성부는 의상착용 이미지(W)에서 의상 영역을 픽셀 단위로 감지하여 세그먼트 특징 맵으로 변환한다. 이를 위해, 이미지 벡터 생성부는 시멘틱 세그먼테이션 신경망(140N)을 통해 사용자의 의상착용 이미지(W)에 대해 픽셀 단위로 의상 카테고리 분류(예: 티셔츠, 가디건, 자켓, …)를 수행한다. 일반적으로 시멘틱 세그먼테이션(semantic segmentation)은 '의미적 분할'이라고도 불리는 기술로서 디지털 이 미지를 여러 개의 픽셀 집합(픽셀 덩어리)로 분할하는 과정이며 이를 통해 이미지의 표현을 해석하기 쉬운 것으 로 단순화시킨다. [도 5]는 시멘틱 세그먼테이션의 개념도이다. [도 5] (a)는 시멘틱 세그먼테이션을 객체 인식 과 비교하여 나타낸 것이고, [도 5] (b)는 차량 자율주행에 시멘틱 세그먼테이션을 적용한 예시도이다. [도 5] (a) 좌측은 객체 인식 결과를 나타낸 것으로, 객체 인식에 의하면 이미지 내에 존재하는 일부 영역에 대 한 클래스 분류 결과를 얻는다. [도 5] (a) 우측은 시멘틱 세그먼테이션 결과를 나타낸 것으로, 시멘틱 세그먼 테이션에 의하면 이미지 내에 존재하는 각각의 픽셀에 대한 클래스 분류 결과를 얻는다. [도 5] (a)로부터 객체 인식 기술과 시멘틱 세그먼테이션 기술의 개념 차이가 분명하게 드러난다. [도 5] (b)의 좌측은 차량용 카메라 영상이고 [도 5] (b)의 우측은 이 카메라 영상에 시멘틱 세그먼테이션을 적용한 결과이다. 이와 같은 시멘틱 세그먼테이션은 디지털 영상 처리 분야, 예컨대 자율주행, 무인로봇, 보안, 이상 상황 감지, 공장 자동화, 의료 등에서 활용되고 있다. 최근에는 딥러닝 기반의 인공지능 신경망, 특히 컨볼루션 신경망 (Convolution Neural Network, CNN)에 의해 시멘틱 세그먼테이션을 효율적으로 수행한다. 이미지 벡터 생성부는 시멘틱 세그먼테이션 신경망(140N)을 통해 의상착용 이미지(W)에 대해 픽셀 단위로 의상 카테고리 분류(예: 티셔츠, 가디건, 자켓, …)를 수행한다. 이 과정에서 추출된 벡터들의 집합을 본 발명 에서는 '세그먼트 특징 맵(segment feature map)'이라고 정의한다. 세그먼트 특징 맵 는 [수학식 3]과 같은 형태를 갖는다. 수학식 3"}
{"patent_id": "10-2023-0114037", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "이때, w와 h는 각각 의상착용 이미지(W)의 폭(width)과 높이(height)이고, c는 의상 카테고리의 갯수이다. 세그먼트 특징 맵 는 c개의 의상 카테고리(예: 티셔츠, 가디건, 자켓, … , )로 머신러닝 학습된 시멘틱 세 그먼테이션 신경망(140N)을 (w x h)개의 픽셀에 적용하여 생성한 벡터 집합이다. 이때, c개의 의상 카테고리는 c개의 채널에 대응되며, 각 채널마다 (w×h) 크기를 갖는 벡터의 스칼라 원소들은 각각의 픽셀이 해당 채널의 대응하는 클래스에 속할 확률 값을 가지게 된다. 세그먼트 특징 맵 의 스칼라 원소를 라고 할 때, 세그먼트 특징 맵 은 [수학식 4]와 같이 나타낼 수 있 다. 수학식 4"}
{"patent_id": "10-2023-0114037", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 5, "content": "다음으로, 특징벡터 생성부에 대해 기술한다. 특징벡터 생성부는 이미지 특징 추출부에서 생성된 정보들을 이용하여 특징 벡터(feature vector) 를 생성한다. 특징 벡터 는 사용자의 의상착용 이미지(W)에 나타난 평소의 스타일, 색상, 계절성 등의 특징과 사용자가 원하는 취향에 대한 중요한 정보를 포함하고 있기 때문에 가상 의상을 만드는데 있어 중요한 정보이다. 먼저, 특징벡터 생성부는 이미지 특징 추출부에서 추출된 이미지 특징의 여러 라벨들 중에서 메인 클 래스 정보의 라벨을 텍스트 벡터로 인코딩하여 특징 벡터 로 설정한다. 다음으로, 특징벡터 생성부는 이미지 특징 추출부에서 추출된 이미지 특징의 여러 라벨들 중에서 서 브 클래스 정보의 라벨을 텍스트로 간주하여 텍스트 벡터로 인코딩한다. 패션상품에 있어서 서브 클래스 정보 (예: 서브 스타일, 서브 색상)는 메인 클래스 정보(예: 메인 스타일, 메인 색상)와 어느 정도 관계가 인정된다. 색상의 경우를 예로 들면, 사용자가 현재는 메인 색상(예: 파란 색)의 의상을 가지고 있지만 서브 색상(예: 흰 색)의 의상에 대해서도 구매 욕구를 가질 수 있기 때문이다. 이러한 점을 고려하여 서브 클래스 정보를 문장으 로 구성하여 텍스트 벡터로 인코딩하고 이를 텍스트 임베딩 벡터 로 생성한다. 한편, 패션 텍스트 수신부가 패션요구 텍스트(T)를 수신한 경우에는, 특징벡터 생성부는 패션요구 텍 스트(T)를 인코딩하여 시멘틱 임베딩 벡터(semantic embedding vector)를 생성한다. 즉, 패션요구 텍스트(T)를 텍스트 벡터로 인코딩하고 텍스트 임베딩 벡터 에 추가한다. 또한, 이미지 특징 추출부에서 생성된 복수의 클래스 벡터(예: , , , )를 연결하여 (concatenate) 이미지 특징 벡터 를 구성한다. 특징벡터 생성부는 이미지 특징 벡터 와 텍스트 임베딩 벡터 는 [수학식 5]와 같이 연결하여 특 징 벡터 를 추가로 얻을 수 있다. 수학식 5"}
{"patent_id": "10-2023-0114037", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 6, "content": "다음으로, 가상벡터 생성부에 대해 기술한다. 가상벡터 생성부는 이상의 과정을 통해 생성된 세그먼트 특징 맵 와 특징 벡터 를 가우시안 노이즈 벡 터(gaussian noise vector) 와 함께 연결한 후에 컨볼루션(convolution) 연산을 수행함으로써 가상 벡터 를 생성한다. 이때, 가우시안 노이즈 벡터 를 추가 연결하는 것은 가상 의상의 모양(shape)을 다양하게 변형 시키기 위한 것이다. 가상 벡터를 , 생성자 함수를 라고 정의하면 가상 벡터 를 생성하는 수식은 [수학식 6]과 같다. 수학식 6"}
{"patent_id": "10-2023-0114037", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 7, "content": "이렇게 생성되는 가상 벡터 는 기존 세그먼트 특징 맵 과 동일한 크기를 갖는데, 기존 의상(사용자의 의상 착용 이미지)의 특징과 사용자가 원하는 결과 정보에 부합할 수 있도록 옷의 형상을 잡아주면서도 가우시안 랜 덤 분포를 따르는 노이즈 벡터 에 의해 매번 다양한 모양으로 생성된다. 다음으로, 가상 이미지 생성부에 대해 기술한다. [도 6]은 본 발명에서 가상 이미지 생성부의 데이터 처리 개념도이다. 가상 이미지 생성부는 가상벡터 생성부가 생성한 가상 벡터 를 역컨볼루션 처리부(170D)에 입력하 여 역컨볼루션(deconvolution) 연산을 통해 디코딩하여 가상의상 이미지(WV)를 생성한다. 먼저, 가상벡터 생성부가 생성한 가상 벡터 에 의상착용 이미지(W)의 특징 벡터 와 가우시안 노이즈 벡터 를 연결한 후에 역컨볼루션 연산을 수행함으로써 가상 이미지 벡터 를 생성한다. 가상 이미지 벡터를, 두 번째 생성자 함수를 라고 정의하면 가상 이미지 벡터 를 생성하는 수식은 [수학식 7]과 같다. 수학식 7"}
{"patent_id": "10-2023-0114037", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 8, "content": "가상 이미지 벡터 는 가상 벡터 를 의상착용 이미지(W)의 특징 벡터 의 정보에 충족되는 방향으로 질감과 패턴을 부여하면서도 가우시안 노이즈 벡터 에 의해 매 입력마다 다양한 결과를 생성한다. 다음으로, 가상 이미지 생성부는 가상 이미지 벡터 로부터 가상의상 이미지(WV)를 생성한다. 일반적으로 가상의 이미지를 생성하는 기술은 이미지-이미지 변환(Img2Img), 텍스트-이미지 변환(Text2Img) 등 다양한 형태의 입력 데이터를 활용하여 새로운 이미지를 만들어내었다. 이러한 과정에는 오토인코더 (Autoencoder), 적대적 생성 신경망(GAN, Generative Adversarial Network), 디퓨전(Diffusion) 모델과 같은 비지도 학습 기반의 생성형 AI 알고리즘이 사용되며, 이들은 복잡한 데이터 분포를 학습하여 실제와 유사한 이 미지를 생성하는 역할을 한다. GAN 모델에서는 두 개의 신경망, 생성기 G와 판별기 D가 적대적인 관계로 작동한다. 생성기 G는 실제 데이터와 유사한 가짜 데이터를 만들어내고, 판별기 D는 그 입력된 데이터가 실제 데이터인지 아니면 생성기 G가 만들어 낸 가짜 데이터인지를 판별한다. 이런 학습 과정을 통하여 GAN 모델의 생성기 G는 점점 실제 데이터와 유사한 가짜 데이터(가상 이미지)를 만들어낼 수 있게 된다. 디퓨전 모델에서는 데이터의 복잡한 분포를 학습하는 데 있어서 확률적인 방법을 사용한다. 초기의 노이즈 (noise) 분포에서 시작하여 여러 단계의 디퓨전 과정을 거치면서 정답 데이터 분포에 점점 가까워지는 방식으로 학습한다. 이상과 같은 비지도 학습 기반의 생성형 인공지능(AI) 알고리즘을 수행하는 구성요소를 본 발명에서는 가상이미 지 생성 신경망(170N)이라고 부른다. 그에 따라, 가상 이미지 생성부는 가상 이미지 벡터 를 가상이미지 생성 신경망(170N)에 입력하여 가상 의상 이미지(WV)를 얻는다. 이렇게 생성된 가상의상 이미지(WV)는 실제 의류(physical clothing)의 이미지가 아 니라 가상 의류(virtual clothing)의 이미지이다. 가상의류 이미지(WV)는 복수 개가 생성되는 것이 일반적인데, 이들은 사용자의 평소 패션 취향이 반영되어 있으면서도 다양한 변화가 가해져있다. 한편, 본 발명에서 가상이미지 생성 신경망(170N)을 머신러닝 학습하기 위한 목적 함수(object function)의 바 람직한 일 실시예는 [수학식 8]과 같다. 수학식 8"}
{"patent_id": "10-2023-0114037", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 9, "content": "[수학식 8]을 살펴보면, 원래의 특징 벡터 와 업데이트 이후의 특징 벡터 간의 차이가 크다면 목적 함수의 전체 값이 커지므로, 가상 이미지 생성부는 가상이미지 생성 신경망(170N)의 생성기 G와 판별기 D에 대해 이들 두 벡터(, ) 간의 차이가 최소화하도록 머신러닝 학습을 수행한다. [수학식 8]에서 함수 G(z)는 가상 이미지 벡터 와 같은 의미이나 포괄적인 표현으로 사용되었다. 목적 함수에서 D와 G의 구분을 위한 표현이다. 이때, 하이퍼 파라미터인 λ는 [수학식 8]의 목적 함수에서 원래의 특징 벡터 와 업데이트 이후의 특징 벡터 간의 차이를 계산하는 항의 중요도를 조정하기 위한 가중치 하이퍼 파라미터이다. [수학식 8]의 목적 함수에 대해 좀더 기술한다. [수학식 8]의 목적 함수는 GAN 알고리즘에서 원래 사용되던 목 적 함수에서 특징 벡터 의 중요도를 조정할 수 있도록 L2 norm의 제곱항을 추가한 변형식이다. 생성자 G의 목적 함수 를 살펴본다. 잠재공간에서 뽑힌 z를 사용 하여 생성된 이미지 G(z)에 대한 판별자 D의 출력에 기반하여, 가짜 이미지 G(z)를 판별자 D가 진짜(입력 데이 터 분포와 유사)라고 예측할 확률을 최대화하여 해당 생성자 G의 목적 함수 값을 최소화(min_G)한다. 이때, 최 소화는 0에 가까운 값으로 만드는 것을 의미한다. 이러한 구성을 통해 가상이미지 생성 신경망(170N)에서 생성 자 G는 진짜와 같은 가상 이미지를 생성할 능력을 극대화하는 방향으로 머신러닝 학습된다. 판별자 D의 목적 함수 에서는 판별자 D가 입력 이미지 I를 진짜 라고 판별할 확률을 최대화하는 동시에 생성자 G가 생성한 가짜 이미지 G(z)를 판별자 D가 가짜라고 예측할 확 률을 최대화한다. 이러한 구성을 통해 가상이미지 생성 신경망(170N)에서 판별자 D는 원래 이미지에 대해서 진 짜라고 판단하는 능력과 생성자 G가 생성해내는 가짜 이미지를 가짜라고 정확히 구분할 능력을 극대화(max_D)하 는 방향으로 학습된다. 본 발명에서 가상이미지 생성 신경망(170N)은 특징 벡터 를 기반으로 추천대상 의상 이미지를 생성한다. 특징 벡터에 의하여 사용자가 평소 입는 옷 스타일, 색상 등의 특징과 원하는 결과에 대한 설명 정보를 기반으로 사 용자 요구를 충족시킬 수 있도록 가상이미지 생성 신경망(170N)은 머신러닝 학습된다. 다음으로, 사용자 선택 획득부에 대해 기술한다. 가상 이미지 생성부가 생성한 복수의 가상의상 이미지(WV)는 사용자 단말에 제공되어 사용자가 볼 수 있도록 표시된다. 사용자는 사용자 단말 상에서 가상의상 이미지들(WV) 중에서 마음에 드는 상품을 선택하 며, 그 선택 내용은 상품 추천 서버로 전달된다. 사용자 선택 획득부는 가상의상 이미지들(WV)을 사용자 단말에 제공하고, 사용자 단말로부터 사용 자가 선택한 이미지를 식별한다. 가상의상 이미지들(WV) 중에서 사용자가 선택한 이미지를 본 명세서에서는 선 택의상 이미지(S)라고 부른다. 다음으로, 유사상품 추출부에 대해 기술한다. [도 7]과 [도 8]은 본 발명에서 유사상품 추출부의 데 이터 처리 개념도이다. 유사상품 추출부는 입점 상품 DB에 저장된 다수의 입점 브랜드 상품의 이미지와 선택의상 이미지(S) 간의 유사도에 기초하여 입점 상품 DB로부터 추천 대상 상품(R)을 선별한다. 선택의상 이미지(S)는 가상 이미지 생성부가 생성한 가상의상 이미지(WV) 중의 하나로서 실제 현실 세계에 존재하는 상품이 아니다. 유사상품 추출부는 입점 브랜드 상품들 중에서 이와 같은 가상의 선택의상 이미지(S)와 유사한 상품을 하 나이상 선별하는 기능을 수행한다. [도 7]을 참조하여 유사상품 추출부의 데이터 처리의 제 1 실시예를 살펴본다. 먼저, 유사상품 추출부는 입점 상품 DB의 상품정보 DB부(330A)에 저장되어 있는 다수의 입점 브랜드 상품의 이미지인 입점상품 이미지(P)를 읽어들인다. 그리고 나서, 각각의 입점상품 이미지(P)를 임베딩 모델 (190A)에 입력하여 입점상품 이미지 벡터(PV)로 변환한 후에, 입점 상품 DB의 이미지벡터 DB부(330B)에 저 장한다. 이를 통해, 입점 브랜드 상품의 이미지는 미리 벡터화시켜서 입점 상품 DB에 저장해둔다. 일반적으로 임베딩(embedding)이란 고차원 공간의 데이터를 저차원 공간으로 변환하는 것을 의미한다. 예를 들 어, 자연언어 처리 분야에서 '임베딩'은 자연언어를 벡터로 바꾸는 변환한다. 본 발명에서 '임베딩'은 이미지를 벡터로 변환한다. 임베딩의 일 실시예는 이미지의 속성(attribute)마다 벡터 값을 부여하는 원핫 벡터(one-hot vector)를 생성하는 방식이다. 임베딩의 다른 실시예는 이미지를 원-핫 벡터(one-hot vector)로 변환한 후에 특 정의 가중치 행렬을 행렬곱 연산하여 밀집 벡터(dense vector)를 생성하는 방식이다. 본 발명에서 임베딩 모델 로는 이미지간의 유사성을 잘 고려할 수 있는 얼굴인식 알고리즘(예: Arcface, Cosface)이 바람직하게 적용될 수 있다. 다음으로, 유사상품 추출부는 사용자 선택 획득부로부터 선택의상 이미지(S)를 제공받으면, 이를 임 베딩 모델(190B)에 입력하여 선택의상 이미지 벡터(SV)로 변환한다. 그리고 나서, 유사상품 추출부는 입점 상품 DB에 저장해두었던 다수의 선택의상 이미지 벡터(SV)에 대해 입점상품 이미지 벡터(PV)와의 유사도를 거리 기반으로 산출한다. 예를 들어, 거리 기반의 유사도 산출 알 고리즘(예: KNN, ANN)이 바람직하게 적용될 수 있다. 마지막으로, 유사상품 추출부는 유사도 기반으로 입점 브랜드 상품 중에서 추천 대상 상품(R)을 선별한다. 예를 들어, 유사도 값이 미리 설정된 임계치 이상이거나 혹은 유사도 순위가 미리 설정된 임계순위 이내인 입점 브랜드 상품, 즉 선택의상 이미지(S)와 비교적 유사하다고 판단된 입점 브랜드 상품을 추천 대상 상품(R)으로 선별한다. [도 8]을 참조하여 유사상품 추출부의 데이터 처리의 제 2 실시예를 살펴본다. 위의 제 1 실시예와 중복되 는 부분에 대해서는 구체적인 설명을 생략할 수 있다. 먼저, 유사상품 추출부는 사용자 선택 획득부로부터 선택의상 이미지(S)를 제공받으면, 이를 임베딩 모델(190B)에 입력하여 선택의상 이미지 벡터(SV)로 변환한다. 그리고 나서, 유사상품 추출부는 입점 상품 DB에 저장된 다수의 입점 브랜드 상품의 이미지인 입점상 품 이미지(P)를 읽어들인 후, 임베딩 모델(190A)에 입력하여 입점상품 이미지 벡터(PV)로 변환한다. 그리고 나서, 유사상품 추출부는 다수의 선택의상 이미지 벡터(SV)에 대해 입점상품 이미지 벡터(PV)와의 유사도를 거리 기반으로 산출한다. 마지막으로, 유사상품 추출부는 유사도 기반으로 입점 브랜드 상품 중에서 추천 대상 상품(R)을 선별한다. 다음으로, 상품추천 제공부에 대해 기술한다. 상품추천 제공부는 유사상품 추출부가 추출한 추천 대상 상품(R)을 사용자 단말에 제공하여 사용 자의 상품 구매를 유도한다. 이상에서 기술한 바와 같이, 본 발명에서는 스마트홈 디바이스에 설치된 카메라를 통해 획득되는 의상착용 이미지(W)에 내재된 의류의 스타일, 색상 등의 특징 정보 및 사용자가 원하는 의상 스타일에 대한 설명을 통해 가상 의류를 생성하고, 이들 가상 의류에 대한 사용자의 선호 선택에 기초하여, 입점 브랜드 상품들 중에서 이 가상 의류와 유사한 상품을 선별하여 추천한다. 이 과정에서 사용자의 민감한 개인정보는 수집하지 않는다. 사용자의 의상착용 이미지(W)에서 감지되는 의상 스타일, 색상, 계절성, 성별 등의 패션 속성 정보와 사용자가 원하는 상품에 대한 묘사적인 텍스트 정보를 결합하여 멀티모달(Multi Modal) 생성형 AI 알고리즘을 사용하여 가상 의류를 생성하기 때문에 개인화된 추천이 가능하다. 한편, 본 발명은 컴퓨터가 읽을 수 있는 비휘발성 기록매체에 컴퓨터가 읽을 수 있는 코드의 형태로 구현되는 것이 가능하다. 이러한 비휘발성 기록매체로는 다양한 형태의 스토리지 장치가 존재하는데 예컨대 하드디스크, SSD, CD-ROM, NAS, 자기테이프, 웹디스크, 클라우드 디스크 등이 있다. 또한, 본 발명은 하드웨어와 결합되어 특정의 절차를 실행시키기 위하여 매체에 저장된 컴퓨터프로그램의 형태로 구현될 수도 있다."}
{"patent_id": "10-2023-0114037", "section": "도면", "subsection": "도면설명", "item": 1, "content": "[도 1]은 본 발명에 따른 패션상품 추천 과정의 순서도. [도 2]는 본 발명에 따른 패션상품 추천 과정의 개념도. [도 3]은 본 발명에 따른 패션상품 추천 시스템의 전체 구성도. [도 4]는 본 발명에서 상품 추천 서버가 사용하는 인공지능 신경망의 구성도. [도 5]는 시멘틱 세그먼테이션의 개념도. [도 6]은 본 발명에서 가상 이미지 생성부의 데이터 처리 개념도. [도 7]은 본 발명에서 유사상품 추출부의 제 1 실시예에 따른 데이터 처리 개념도. [도 8]은 본 발명에서 유사상품 추출부의 제 2 실시예에 따른 데이터 처리 개념도."}
