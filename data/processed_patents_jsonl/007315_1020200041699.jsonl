{"patent_id": "10-2020-0041699", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2021-0123898", "출원번호": "10-2020-0041699", "발명의 명칭": "멀티 레이블 분류 기반 상표 이미지 검색 방법과 이 방법을 적용한 상표 이미지 검색 시스템", "출원인": "(주)비타소프트", "발명자": "홍순기"}}
{"patent_id": "10-2020-0041699", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "본 발명의 일 실시예에 따르면, 딥러닝을 활용한 상표 이미지 검색 방법에 있어서, 상표 이미지와 개별 상표 이미지에 포함된 여러 도형의 종류 및 유형을 분류하는 분류기준에 따라 복수의 레이블을 부여하여 학습데이터를 확보하는 학습데이터 구축단계와, 신경망(Neural Network) 알고리즘을 기준으로 학습데이터를 학습하는 신경망 학습 단계와, 상기 학습 신경망과 학습 결과물인 가중치(Weights)를 기준으로 검색 대상 상표 이미지 전체에 대한 멀티 레이블 분류 벡터(Multi Labeled Classification Vector)를 생성하는 검색 인덱스 생성 단계와, 쿼리 이미지를 입력받는 단계와,쿼리 이미지를 상기 신경망 모델 및 가중치를 기준으로 멀티 레이블 분류 벡터를 생성하는 쿼리 이미지 분석 단계와,상기 쿼리 이미지에 대한 멀티 레이블 분류 벡터와 검색 대상 상표 이미지 전체에 대한 멀티 레이블 분류 벡터들 사이의 유사도를 연산하는 유사도 연산 단계와,상기 유사도 연산 단계로부터 얻은 유사도 순서대로 검색 대상 상표 이미지 전체를 표시하는 이미지 검색 결과표시 단계를 포함하는 것을 특징으로 하는 딥러닝을 활용한 멀티 레이블 분류 기반 상표 이미지 검색 방법과 이 방법을 적용한 상표 이미지 검색 시스템"}
{"patent_id": "10-2020-0041699", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에서, 상기 학습 데이터 구축 단계에서의 상표에 포함된 도형을 분류하는 도형 분류 기준은 비엔나 코드(Vienna Code)인 것을 특징으로 하는 멀티 레이블 분류 기반 상표 이미지 검색 방법과 이 방법을 적용한 상표이미지 검색 시스템"}
{"patent_id": "10-2020-0041699", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1항 또는 제2항에서, 상기 학습 데이터 구축 단계는 상표에 포함된 도형의 영역 정보를 추가로 포함하도록 하며, 검색 인덱스 생성단계는 멀티 레이블 분류 벡터 이외에 영역 정보 벡터를 추가로 생성하며, 유사도 연산 단계는 상기 쿼리 이미지의 영역정보 벡터와 검색 대상 상표 이미지로부터 도출한 영역 정보 벡터들 사이의 유사도 정보를 추가로 연산하는 것을 특징으로 하는 멀티 레이블 분류 기반 상표 이미지 검색 방법과 이 방법을 적용한 상표 이미지 검색 시스템"}
{"patent_id": "10-2020-0041699", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제1항 내지 제3항 중 어느 한 항에서상기 검색 인덱스 생성 단계와 상기 쿼리 이미지 분석 단계에서 생성하는 멀티 레이블 분류 벡터는 상기 신경망의 최종단인 FC단(Fully Connected Layer)으로의 입력단에서 추출한 임베디드 벡터(Embedded Vector)인 것을특징으로 하는 멀티 레이블 분류 기반 상표 이미지 검색 방법과 이 방법을 적용한 상표 이미지 검색 시스템"}
{"patent_id": "10-2020-0041699", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "상기 유사도 연산단계에서의 유사도 연산은 벡터들 사이의 코사인 거리(Cosine Distance)를 구하는 코사인 유사도 알고리즘(Cosine Similarity)을 적용하는 것을 특징으로 하는 멀티 레이블 분류 기반 상표 이미지 검색 방법과 이 방법을 적용한 상표 이미지 검색 시스템공개특허 10-2021-0123898-3-청구항 6 제1항 내지 제5항 중 어느 한 항에서상기 유사도 연산단계에서의 유사도 연산은 벡터들 사이의 유클리드 거리(Euclidean Distance)를 구하는 유클리드 유사도 알고리즘(Euclidean Similarity)을 적용하는 것을 특징으로 하는 멀티 레이블 분류 기반 상표 이미지검색 방법과 이 방법을 적용한 상표 이미지 검색 시스템"}
{"patent_id": "10-2020-0041699", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제1항 내지 제6항 중 어느 한 항에서, 상기 유사도 연산 단계는 검색 대상 상표 이미지 전체에 대한 멀티 레이블 분류 벡터들을 모두 적어도 하나의GPU에 올려놓는 단계를 추가로 포함하며, 이 GPU에서 쿼리 이미지의 멀티 레이블 분류 벡터와의 유사도를 연산하도록 하는 것을 특징으로 하는 멀티 레이블 분류 기반 상표 이미지 검색 방법과 이 방법을 적용한 상표 이미지 검색 시스템"}
{"patent_id": "10-2020-0041699", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 도형 상표를 검색하기 위한 상표 이미지 검색 시스템에 대한 것이며, 특히 딥러닝 기술을 응용하여 쿼 리 이미지와 유사한 결과 이미지를 찾아 유사한 순서로 표시하기 위한 기술에 대한 것이다. 본 발명의 일 실시예에 따르면, 딥러닝을 활용한 상표 이미지 검색 방법에서, 상표 이미지와 개별 상표 이미지 (뒷면에 계속)"}
{"patent_id": "10-2020-0041699", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 도형 상표를 검색하기 위한 상표 이미지 검색 시스템에 대한 것이며, 특히 딥러닝 기술을 응용하여 쿼리 이미지와 유사한 결과 이미지를 찾아 유사한 순서로 표시하기 위한 기술에 대한 것이다."}
{"patent_id": "10-2020-0041699", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "상표법상 상표란 자기 상품(또는 서비스)을 타인의 상품과 식별하기 위해 사용하는 상품 출처 표시 표장(Brand 또는 Trademark)을 의미하며, 상표법은 식별력 있는 상표 등록 출원에 대해 지정상품별로 상표권을 부여하여 독 점권을 인정하고 있다. 이때, 상표 등록 출원에 대해서는 엄정한 심사를 통해 권리의 중복이 발생하기 않도록 하고 있으며, 이를 위해 서는 기존의 등록 상표 표장과 동일 또는 유사한 상표 등록 출원의 등록을 거절한다. 또한, 타인의 등록상표와 동일 또는 유사한 상표를 등록 상표의 지정상품과 동일 유사한 상품에 사용한 경우에는 타인의 상표권을 침해하 게 되어 민형사상의 책임이 뒤따른다. 따라서, 상표 등록 출원에 대한 심사, 상표권의 침해 여부에 대한 판단 및 상표권 간의 권리 충돌에 대한 판단을 할 때, 상표의 유사 여부 판단은 선행되어야 할 매우 중요한 활동이다. 상표 유사 심사기준에 따르면, 상표의 유사 여부의 판단은 상표의 모양, 발음, 관념 또는 이들의 결합 상태를 기준으로 판단하는데, 수많은 등록 상표 중에서 특정 상표와 동일 또는 유사한 상표를 찾기 위해서는 검색 시스 템을 활용하는 것이 필수이다. 기존의 상표 검색 시스템은 유사 판단 기준의 하나인 상표의 발음의 유사 여부를 텍스트로 표현한 문장을 검색 엔진을 이용하여 검색함으로써 정확도가 높은 결과를 제시하고 있다. 그러나, 상표 이미지에 포함된 도형 또는 관념의 유사성 판단은 아직 정확도가 높지 않다. 그래서, 상표에 포함된 도형 또는 관념의 유사성 판단을 지원 하기 위한 수단으로 각국 특허청은 국제 협약에 따른 비엔나 코드( Vienna Code) 등의 분류 기준을 두어, 출원 상표 전체에 대한 도형 분류 코드를 정보로 부가하고 있다. 따라서, 도형 상표에 대한 검색을 할 때에는 해당 상표에 포함된 도형 분류 코드를 지정하여 검색 대상 범위를 좁힐 수 있도록 함으로써, 검색 결과를 쉽게 찾을 수 있도록 하고 있다. 이미지 처리와 관련된 기술의 진보로 이미지와 이미지에 대한 직접적 비교를 통해 상표 이미지의 유사판단을 위 한 다양한 시도들이 있어 왔다. 기존의 이미지 처리를 통한 검색 기술은 근본적으로는 해당 도형에 포함된 특징 벡터를 추출하여 이를 다른 이미지에서 추출한 특징벡터들과 비교하는 방법을 사용한다. 하지만, 현실적으로는 해당 특징 벡터의 추출이 동일한 수준에서는 잘 찾지만, 유사한 도형 또는 관념에 대해서는 검색 결과가 좋지 못하다. 그래서, 여전히 (출원) 도형 상표와 유사한 등록 상표를 찾는 것은 해당 분야에서 오랜 경험(심사)을 해 온 심사관의 노하우에 의존해왔다. 선행기술문헌특허문헌 (특허문헌 0001) 본 발명과 관련한 종래 기술로는 대한민국 특허 출원 공개 제10-2009-0005684호에 공개한 기술 이 있다. 이 출원 공개에는 동일 출원인의 도형 동일 상표에 대해서는 도형 코드를 이용하여 선택적으로 중복되 는 도형 상표는 배제하고 대표 상표만을 디스플레이하도록 하여 검색 편의를 개선한 도형상표 검색 시스템 및 방법이 공개되어 있다. (특허문헌 0002) 또한, 대한민국 특허 출원 공개 제10-2019-0098801호는 상표 이미지(썸네일 이미지)와 상표 이 미지에 부여된 도형 코드에 기초하여 생성된 레이블을 이용하여, CNN (Convolutional Neural Network) 알고리즘 으로 학습 데이터의 카테고리를 분류하는 방법을 공개하고 있다. 이 출원 기술은 딥러닝을 위한 널리 공개된 CNN 알고리즘을 사용하고 있고, 도형 코드에 생성된 레이블을 이용해 학습 데이터의 카테고리를 분류하는 기술 을 공개하고 있지만, 검색된 결과의 유사도의 순서를 어떻게 정할지 등에 대해서는 충분히 만족스러운 결과를 공개하고 있지 않다. 비특허문헌 (비특허문헌 0001) 딥러닝 기반의 신경망인 CNN (Convolutional Neural Network)을 이용한 이미지의 분류 (Image Classification), 딥러닝 기반 객체 인식(Object Detection) 기술 및 멀티 레이블 분류(Multi Label Classification) 알고리즘이 본 발명을 구현을 위해 사용하는 기반 기술이다. 관련된 기술은 본 발명 이전에 널 리 공개된 기술이며, 관련된 기술을 적용하기 위한 소프트웨어 프로그램 소스들도 깃 허브 등에 공개되어 있다."}
{"patent_id": "10-2020-0041699", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은 위와 같은 이미지 검색에서의 어려움을 극복하기 위한 것으로서, 딥러닝 기술을 응용하여, 특정 상표 이미지(이하, 쿼리 이미지)를 제시하면 검색 대상 상표 이미지들 중 이 쿼리 이미지와 형태 및 관념에서 동일 또는 유사한 상표를 유사도 순서로 표시할 수 있도록 하는 이미지 검색 시스템의 검색 성능을 향상시키기 위한 기술을 제공하는 것을 기술적 과제로 한다."}
{"patent_id": "10-2020-0041699", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명의 일 실시예에 따르면, 딥러닝을 활용한 상표 이미지 검색 방법에 있어서, 상표 이미지와 개별 상표 이 미지에 포함된 여러 도형의 종류 및 유형을 분류하는 분류기준에 따라 복수의 레이블을 부여하여 학습데이터를 확보하는 학습데이터 구축단계와, 신경망(Neural Network) 알고리즘을 기준으로 학습데이터를 학습하는 신경망 학습 단계와, 상기 학습 신경망과 학습 결과물인 가중치(Weights)를 기준으로 검색 대상 상표 이미지 전체에 대 한 멀티 레이블 분류 벡터(Multi Labeled Classification Vector)를 생성하는 검색 인덱스 생성 단계와, 쿼리 이미지를 입력받는 단계와, 쿼리 이미지를 상기 신경망 모델 및 가중치를 기준으로 멀티 레이블 분류 벡터를 생 성하는 쿼리 이미지 분석 단계와, 상기 쿼리 이미지에 대한 멀티 레이블 분류 벡터와 검색 대상 상표 이미지 전 체에 대한 멀티 레이블 분류 벡터들 사이의 유사도를 연산하는 유사도 연산 단계와, 상기 유사도 연산 단계로부 터 얻은 유사도 순서대로 검색 대상 상표 이미지 전체를 표시하는 이미지 검색 결과 표시 단계를 포함하는 것을 특징으로 하는 딥러닝을 활용한 멀티 레이블 분류 기반 상표 이미지 검색 방법과 이 방법을 적용한 상표 이미지 검색 시스템을 제공한다. 또한, 본 발명에 따른 다른 실시예에 따르면, 상기 학습 데이터 구축 단계에서의 상표에 포함된 도형을 분류하 는 도형 분류 기준은 비엔나 코드(Vienna Code)인 것을 특징으로 하는 멀티 레이블 분류 기반 상표 이미지 검색 방법과 이 방법을 적용한 상표 이미지 검색 시스템을 제공한다. 또한, 본 발명에 따른 다른 실시예에 따르면, 상기 학습 데이터 구축 단계는 상표에 포함된 도형의 영역 정보를 추가로 포함하도록 하며, 검색 인덱스 생성 단계는 멀티 레이블 분류 벡터 이외에 영역 정보 벡터를 추가로 생성하며, 유사도 연산 단계는 상기 쿼리 이미지의 영역정보 벡터와 검색 대상 상표 이미지로부터 도출한 영역 정 보 벡터들 사이의 유사도 정보를 추가로 연산하는 것을 특징으로 하는 멀티 레이블 분류 기반 상표 이미지 검색 방법과 이 방법을 적용한 상표 이미지 검색 시스템을 제공한다. 또한, 본 발명에 따른 또 다른 실시예에 따르면, 상기 검색 인덱스 생성 단계와 상기 쿼리 이미지 분석 단계에 서 생성하는 멀티 레이블 분류 벡터는 상기 신경망의 최종단인 FC단(Fully Connected Layer)으로의 입력단에서 추출한 임베디드 벡터(Embedded Vector)인 것을 특징으로 하는 멀티 레이블 분류 기반 상표 이미지 검색 방법과 이 방법을 적용한 상표 이미지 검색 시스템을 제공한다. 또한, 본 발명에 따른 또 다른 실시예에 따르면, 상기 유사도 연산단계에서의 유사도 연산은 벡터들 사이의 코 사인 거리(Cosine Distance)를 구하는 코사인 유사도 알고리즘(Cosine Similarity)을 적용하는 것을 특징으로 하는 멀티 레이블 분류 기반 상표 이미지 검색 방법과 이 방법을 적용한 상표 이미지 검색 시스템을 제공한다. 또한, 본 발명에 따른 또 다른 실시예에 따르면, 상기 유사도 연산단계에서의 유사도 연산은 벡터들 사이의 유 클리드 거리(Euclidean Distance)를 구하는 유클리드 유사도 알고리즘(Euclidean Similarity)을 적용하는 것을 특징으로 하는 멀티 레이블 분류 기반 상표 이미지 검색 방법과 이 방법을 적용한 상표 이미지 검색 시스템을 제공한다. 또한, 본 발명에 따른 또 다른 실시예에 따르면, 상기 유사도 연산 단계는 검색 대상 상표 이미지 전체에 대한 멀티 레이블 분류 벡터들을 모두 적어도 하나의 GPU에 올려놓는 단계를 추가로 포함하며, 이 GPU에서 쿼리 이미 지의 멀티 레이블 분류 벡터와의 유사도를 연산하도록 하는 것을 특징으로 하는 멀티 레이블 분류 기반 상표 이 미지 검색 방법과 이 방법을 적용한 상표 이미지 검색 시스템을 제공한다."}
{"patent_id": "10-2020-0041699", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "이와 같은 기술적 구성의 본 발명을 제공함으로써 상표 이미지의 유사성에 대한 검색 결과의 정확도를 높이고 더불어 그 응답속도도 매우 빠르게 할 수 있게 되었다."}
{"patent_id": "10-2020-0041699", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하 도면을 참고하며 본 발명에 따른 실시예를 상세히 설명하도록 한다. 도 1은 딥러닝 기반의 이미지 검색 시스템의 일반적인 데이터 처리 과정을 설명하기 위한 전체적인 프로세스 흐 름도이다. 이를 단계별로 설명한다. 제1단계는 딥러닝 학습을 위해 사용할 데이터를 입수하여 간단한 리사이징, 포맷 변환, 해상도 증강 등의 전처 리를 수행하고, 이들을 그룹화하여 정리한다. 제2단계는 이렇게 정리된 데이터를 가공하여 지도학습용 레이블을 부여(Annotation 작업)하고, 전체 데이터를 트레인 셋과 테스트 셋으로 분리하여, 학습용 데이터 셋을 준비한다. 제3단계는 학습용 데이터 셋으로 학습을 실행하는 것인데, 딥러닝 학습을 위한 신경망을 선택하여 딥러닝 모델 을 구성하고, 이를 기준으로 학습과 평가를 반복 실행하고 학습을 종료하면 학습 모델과 학습 결과로서의 가중 치(weights)를 저장한다. 제4단계는 이후, 검색 시스템에 적용하는 것인데, 위의 학습 결과 모델과 가중치(Weight)로 검색대상 이미지에 대해서 특징 벡터를 추출하여 검색 인덱스를 만들어 저장합니다. 이후, 쿼리 이미지가 들어오면, 쿼리 이미지에 대해서 분류 및 특징 벡터를 추출하여 저장해둔 검색 인덱스와 비교하여 이미지 유사도를 연산하고 연산된 유사 도 순서로 표시한다. 도 2는 신경망 알고리즘을 적용하여, 특징 추출과 분류가 이루어지는 과정을 설명하기 위한 모식도이다. 신경망 모델은 특징 추출(Feature Extraction)과 이미지 분류 및 벡터생성 (Classification & Vector Generation) 작 업을 수행하며, 특징 추출은 Convolution Network가 수행하고, 벡터 생성은 FC 레이어(Fully Connected Laye r)에서 수행한다. 통상의 분류는 FC 레이어의 출력 벡터값을 기준으로 데이터의 분류 결과를 확인할 수 있다. 도 3은 본 발명에 따른 멀티 레이블 분류(MLC: Multi Label Classification) 알고리즘 기반의 상표 이미지 검 색 방법을 실행하기 위한 주요 프로세스를 순차적으로 설명하는 프로세스 흐름도이다. 도면에 도시한 바와 같이, 검색 시스템을 준비하는 단계(S1 ~ S3)와 검색 서비스를 수행하는 단계(S4 ~ S7)로 구분될 수 있다. 검색 시스템을 준비하는 단계는 분류 코드를 다중으로 부여하는 Multi-Labelling을 통해 학습 데이터를 구축하고(S1), 멀티 라벨 분류(MLC: Multi Label Classification) 기반의 신경망 학습을 진행 한 후 (S2) 그 학습 결과물로 검색 대상 상표에 대한 검색 인덱스로서 멀티 라벨 분류 벡터(MLC Vector)를 생성하여 저장하는 과정(S3)으로 구성된다. 또한, 검색 서비스 단계는 사용자가 쿼리 이미지를 입력하고 검색 결과를 요청하면(S4), 검색 대상 상표 이미지 로부터 멀티 라벨 분류 벡터(MLC Vector)를 생성한 것과 동일한 학습 결과물로 쿼리 이미지에 대해서 멀티 라벨 분류 벡터(MLC Vector)를 분석하고(S5) 그 결과를 검색 대상 상표에 대한 검색 인덱스의 멀티 라벨 분류 벡터와 비교해서 유사도를 연산하고(S6), 유사도 순서대로 검색 결과를 보여준다(S7). 도 4는 본 발명에 따른 멀티 레이블 분류 알고리즘 기반의 상표 이미지 검색 방법을 전체적으로 설명하기 위한 개념도이다. 도 3에 따른 처리 과정과 프로세스는 근본적으로 동일하다. 도 4에 도시한 실시예에서와 같이, 도형 분류 코드는 기존의 비엔나 코드 분류를 사용한다. 특허청에 출원된 상 표 이미지에 대해서는 사전 분류 단계에서 출원 상표 이미지에 포함된 도형을 사람이 직접 식별하고, 해당 출원 상표 이미지에 포함된 도형의 해당 코드를 부가하여 기록하고 있으므로, 별도의 데이터 어노테이션(데 이터 분류 및 Labeling)을 위한 절차를 생략할 수 있다는 장점이 있다. 따라서, 상표 이미지 별로 비엔나 코드 가 무엇인지에 대한 정보가 있으므로 이를 기초로 도 4의 분류 코드 벡터를 생성할 수 있다. 신경망의 학습은 멀티 레이블 분류(MLC: Multi Label Classification) 알고리즘에 기반을 둔다. 멀티 라벨 분류 란 이진 분류(Binary Classification), 다중 분류(Multi Classification) 등과 비교할 때, 레이블을 하나가 아 닌 복수로 부여하는 것을 허락한다는 것을 의미한다. 도 5면에 도시한 바와 같이 해, 달, 별 이 포함된 이미지 라면, 두 개 이상의 도형이 포함될 경우에 이들에 대해서 포함된 도형에 대해서 코드를 모두 ‘1’로 표기하는 것과 같다. 멀티 라벨은 하나의 입력값에 대해 여러 개의 출력 값을 가진다는 점에서는 다중 분류와 동일하지만, 여러 가지 출력값이 활성화된다는 점에서 출력값 중에서 하나만 활성화되는 다중 분류 기법과 구별 된다. 그래서 손실함수도 다중 분류에서는 logistic Cross Entropy를 가지지만, 멀티 레이블 분류는 Binary Cross Entropy를 사용한다. 도 6은 본 발명에 따른 멀티 레이블 분류에서 분류 기준으로 사용하는 국제기준인 비엔나 코드(Vienna Code)의 구성을 예시한 것이다. 도시한 바와 같이 비엔나 코드는 상표 이미지에 포함될 수 있는 도형을 전체 30개의 대 분류로 분류하고, 중분류 및 세분류로 구체화하고 있다. 분류의 종류는 세분류 기준으로는 2015개 이상이다. 도 7은 비엔나 코드 기반의 멀티 레이블의 구성을 벡터 형식으로 도시한 것이다. 상표 이미지에 대한 레이블은 [출원번호][비엔나 코드]와 같은 형식으로 레이블의 수만큼 다중으로 기록하고, 이것을 벡터 형식으로 표현하면 도 7의 우측에 표시한 행렬 형식(상표출원번호를 행으로 정의하고, 비엔나 코드의 세분류 기준을 열로 정의)의 이진 벡터(Bianary Vector)를 얻을 수 있다. 도 4에 도시한 구성에서 학습을 실행할 신경망은 CNN(Convolutional Neural Network) 신경망으로 선정한다. CNN 신경망은 다양한 공개 알고리즘/모델이 있으므로, Resnet, Densenet 등의 공개된 신경망 중의 하나를 선정 하여 학습할 수 있고, 객체의 영역정보를 포함하도록 레이블을 만드는 경우라면 Faster R-CNN, Yolo 등의 신경 망을 사용할 수도 있다. 본 발명에서는 신경망 알고리즘에 대해서는 구체적인 한정은 하지 않는다. 학습 데이터를 기준으로 학습의 실행을 위한 도구 및 방법은 특정하지 않으며, 일반적인 학습 도구인 Keras, Tensorflow, pytorch 등의 어떤 도구를 사용할 수 있다. 비엔나 코드 등의 분류 기준이 멀티 레이블로 부여된 상표 이미지 학습 데이터로 CNN 등의 신경망을 통해 학습 을 완료하고 나면, 학습 결과로서 가중치(Weight : 4)를 생성하게 된다. 이후, 학습을 마친 결과물로 이미지 검 색을 위한 검색 시스템을 구축하게 된다. 이미지 검색 시스템은 도 4에 도시한 바와 같이, 사용자가 검색할 쿼리 이미지를 제시하면 보유하고 있는 검색 대상 상표 이미지들 중에 쿼리 이미지와의 유사도를 연산하고, 유사도 순서대로 검색 결 과 이미지를 표시한다. 유사도의 비교는 쿼리 이미지의 특징 벡터와 검색 대상 상표 이미지의 특징 벡터들 사이에서 유사도를 연 산하는 과정인데, 쿼리 이미지와 검색 대상 상표 이미지 모두에 대해서 학습단계의 신경망 학습에 의해 얻은 동 일한 신경망 모델(model)을 사용하여 특징벡터를 생성한다. 이때의 신경망에서 사용할 가중치는 학습 결과로서 결정한 가중치(Weight)를 적용한다. 검색 서비스를 위해서, 먼저 검색 대상 검색 대상 상표 이미지 들은 학습 결과물인 동일한 신경망 모델에 학 습 결과물인 가중치를 적용하여 특징 벡터를 추출하고, 이렇게 추출된 특징벡터들을 특징벡터 세트로서 검색 서버 내의 저장소에 인덱스 파일 형식으로 저장한다. 그러면, 검색 서비스를 위한 준비가 완료된 상태가 된다. 이후, 사용자가 검색할 쿼리 이미지를 업로드 하고 이미지 검색을 요청하면, 대상 쿼리 이미지에 대해서 동일한 신경망 모델과 가중치를 사용하여 쿼리 이미지에 대한 특징 벡터를 추출한다. 이때 특징벡터는 도 2를 참고하면, CNN 신경망 모델의 최종단인 FC Layer의 출력단으로부터 결정할 수도 있 지만, FC Layer의 입력단 다시 말해 특징 추출(Feature Extraction) 출력단으로부터 출력된 벡터(이를 임베디드 벡터(Embedded Vector)라고 함)를 채용할 수도 있다. 이렇게 하면 특징 추출의 결과물을 최종 분류하여 벡터값 으로 생성 하는 과정을 생략하는 것이 된다. 쿼리 이미지로부터 특징벡터를 추출한 후, 서버에 미리 저장된 검색 대상 상표 이미지에 대한 특징벡터 사이의 유사도 연산은 쿼리 이미지 업로드 후 즉시 이루어지는데, 이때, 유사도의 연산은 유사도 비교를 위한 알고리즘이 사용된다. 유사도 비교 연산을 위한 알고리즘으로는 벡터들 사이의 코사인 거리(Cosine Distance) 또는 유클리드 거리(Euclidean Distance) 등의 알고리즘을 사용할 수 있다. 도 8은 본 발명에 따른 유사도 연산을 위해 사용되는 예시로서, 코사인 거리 및 유클리드 거리의 연산의 원리 및 관련 수식을 설명하기 위한 것이다. 도면에 도시한 것처럼. 유클리드 거리는 두 점의 좌표 사이의 기하학적인 거리를 계산하는 방식이고, 코사인 거 리는 원점에서 두 점 좌표 사이를 잇는 두 선이 이루는 각에 코사인을 취해 값을 정하는 일종의 각거리로서 정 의한다. 물론, 예시된 도면은 단순히 3차원으로 예시하였지만, 본 발명에서처럼, 복수 차원도 벡터값으로 표시 하면 동일한 수식을 적용할 수 있다. 검색 결과는 쿼리 이미지의 특징 벡터와 미리 저장된 검색 대상 상표 이미지의 특징벡터(인덱스 파일) 사이의 유사도 연산 결과의 순위를 구하여, 유사도가 가까운 순서대로 검색 대상 상표 이미지를 표시하는 형식으로 이 루어진다. 이때, 쿼리 이미지의 특징 벡터와 검색 대상 상표 이미지의 특징 벡터와의 유사도 연산은 통상 CPU를 상정할 수 있으나, CPU에서의 연산을 위해서는 통상 100만 건 이상에 달하는 검색 대상 상표 이미지의 특징벡터를 하나씩 불려와 비교하고 그 결과를 순서대로 표시해야 하기 때문에 상당한 시간이 소요된다는 문제가 있다. 그래서, 이 런 응답 속도 문제를 해결하기 위한 방안으로 검색 대상 상표 이미지의 특징벡터를 Memory DB에 올리고, 메 모리 DB로 쿼리 이미지의 특징벡터를 보내 유사도를 연산하도록 하는 방법을 고려할 수도 있다. 그러나 이 경우도 검색 응답 속도가 그리 높지 못하고 무엇보다 메모리 가격이 고가이므로, 연산을 위한 비용이 너무 많다 는 문제가 있다. 본 발명에서는 이러한 문제를 해결하기 위해서, GPU(Graphics Processing Units)를 사용한다. CPU(Central Processing Unit)의 그래픽 처리 작업을 보조하기 위한 장치로서 고도 병렬 처리(massively parallel processing)에 적합하며, 단일 명령어의 다중의 데이터를 처리할 수 있는 구조(SIMD, Single Instruction Multiple Data)를 가지고 있어서 병렬 처리에 매우 유리한 구조로 되어 있는 하드웨어 플랫폼이다. 이러한 GPU 의 뛰어난 병렬 처리 능력 및 빠른 데이터 전송 능력을 활용해서, 비트코인의 채굴 연산 등 소량의 반복된 병렬 연산이 필요한 경우에 응용되고 있다. 이러한 GPU를 활용하기 위해서, 본 발명의 바람직한 실시예에 따르면 검색 인덱스 데이터로서 검색 대상 상표 이미지에 대한 특징 벡터를 모두 적어도 하나 이상의 GPU에 나누어 올리고, 검색할 쿼리 이미지의 특징벡 터를 GPU로 보내 전체 검색 대상 상표 이미지 특징벡터와의 유사도를 연산하도록 하였다. 그 결과 100만 건에 이상의 상표 이미지들과의 유사도 연산 결과를 최대 1초 이내에 얻을 수 있게 되었다. 특히, 복수의 GPU로 나누어 저장하고 연산 결과를 병렬로 얻을 수 있으므로, 검색 대상이 아무리 많아도 병렬 처리 연산을 할 수 있 어 검색 속도는 지연되지 않는다는 효과를 얻을 수 있게 되었다. 도 9는 본 발명에 따른 이미지 검색 시스템의 구성을 도시한 시스템 구성도 있다. 도면에 도시한 바와 같이, 프 로그램 처리를 위한 처리 시스템은 학습용 시스템과 검색 서비스 시스템으로 구성되며, 데이터는 학습 용 데이터와 검색 대상 데이터로 구분된다. 학습용 시스템은 학습을 위한 도구(프로그램)와 학습 신경망 모델을 설치하여, 학습용 데이터로 딥러 닝 학습을 수행하고 그 결괏값인 가중치(Weight)를 기록해 둔다. 검색용 시스템은 검색 서비스를 위한 웹 인터페이스를 설치하여 사용자로부터의 검색 요청을 받아 결과를 돌려주며, 학습용 시스템으로부터 결과물 인 학습 신경망 모델과 딥러닝 학습 결과를 가지고 있어, 이를 가지고, 검색 대상 상표 이미지 전부에 대 해서, 특징 벡터를 생성하여 인덱스 데이터로서 기록하여 두며, 서비스 사용자로부터 쿼리 이미지를 입력받은 경우 해당 쿼리 이미지에 대해서도 동일하게 특징 벡터를 생성한다. 학습용 시스템과 검색 서비스 시스템 모두 GPU(113, 123)를 포함하고 있으며, 학습용 시스템의 GPU에는 신경망 모델을 올려놓고 대량의 학습을 위한 반복 연산을 수행하기 위해 필요한 연산을 수행하며, 검색용 시스템의 GPU에는 대량의 검색 대상 상표 이미지의 특징벡터를 올려놓고 쿼리 이미지의 특징벡터 사이의 유사도 연산을 병렬 처리 한다. 본 발명에 따른 멀티 레이블 분류 기반 상표 이미지 검색 방법의 또 다른 실시 예로서, 보통 객체 인식 (Objective Recognition)이라는 기법을 적용하는 경우를 설명한다. 지금까지의 실시 예는 주로 멀티 레이블 분류의 기준으로 상표의 도형 분류 기준으로 널리 사용하는 비엔나 코 드(Vienna Code)를 적용하는 경우를 주요 방법으로 설명하였다. 그러나 이러한 분류 기준은 반드시 비엔나 코드 를 기준으로 할 필요는 없고, 이와 독립된 또는 이로부터 파생한 다른 분류 기준을 적용할 수도 있다. 기존의 비엔나 코드 분류에는 세분류가 부족한 경우가 많아 그에 맞게 분류기준을 세분화 또는 별도로 정하여 운영할 수 있다. 예를 들면, 비엔나 코드 03-01-08은 동물-네발짐승-(개, 늑대, 여우)를 지칭한다. 그러나 세 동물은 다른 동물들과 비교하면 유사한 면이 있지만, 사람들은 상표 이미지 속의 여우를 개나 늑대와 명백히 구분하는 경우가 많다. 또한, 객체인식 기법에 따르면, 이미지에 대한 레이블링(또는 어노테이션) 과정에서, 상표 내에 포함된 도형의 위치 및 영역에 대한 정보를 추가로 지정한다. 도 10은 상표 이미지 내에서 객체의 종류 지정하고, 위치 영역을 지정하여 레이블을 부여하는 방법을 예로서 보여주는 것이다. 하나의 이미지 안에 여러 객체가 있을 때는 다른 색상으로 객체의 종류와 영역을 지정할 수 있다. 이 영역 정보는 이미지 속의 객체가 어떤 것인지를 명확히 지 정하므로, 어떤 것이 어떤 객체인지를 지도해서 학습하는 방법으로 널리 사용되고 있다. 기존의 비엔나 코드를 이용한 레이블 지정이 상표 이미지가 포함하고 있는 객체가 무엇인지 만을 지정할 뿐, 객 체가 어떤 것인지를 명확히 지정하지 못한다는 한계를 가지고 있어, 객체 인식 기법은 위와 같은 문제를 보완하 는 좋은 대안이 될 수 있다. 이미지 내의 객체의 종류 이외에 객체의 영역 정보를 추가로 부여하여 학습을 시행하는 경우, 신경망 모델도 단 순한 CNN이 아니고, 객체 인식에 적합한 신경망으로 변경되어야 한다. Faster-R CNN, Yolo 등의 신경망 모델이 그러한 예이다. 도 11은 본 발명의 실시예에 따라 구성한 상표 이미지 검색 시스템에서 상표 이미지를 검색한 실제 결과를 도시 한 도면이다. 좌측의 상표가 찾고자 하는 상표 이미지이며, 오른쪽의 이미지들이 검색 대상 이미지들 중에 유사 한 이미지들이며, 유사도의 순서대로 위의 왼쪽부터 표시하였다. 제시된 상표에 대해서는 기존에 분류된 비엔나 코드는 260304, 260307, 260703이며, 이에 대해 분석된 결과는 하단 왼쪽에 표시한 바와 같이, 260307, 260304, 260106, 260703, 261325 등으로 순위가 매겨져 있으며, 어떤 도형이 포함되어 있는지를 잘 분류한 것을 확인할 수 있다. 오른쪽의 유사도 순서대로 표시한 상표 이미지에 대 해서는 이미 위와 같은 분석이 이루어져 저장된 상태이고, 검색 결과는 이미 만들어진 분석 결과로서 얻은 특징 벡터가 즉시 비교되어 결과로서 유사도 순서대로 표시된다. 검색 결과의 정확도 여부는 사용자에 따라 다를 수 있으나, 전체적으로는 유사한 개념과 유사한 외형의 이미지들이 첫 번째 페이지인 상위에 표시된 것을 확인할 수 있다."}
{"patent_id": "10-2020-0041699", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 딥러닝 기반의 이미지 검색 시스템의 데이터 처리 과정을 보여주기 위한 전체적인 프로세스 흐름도. 도 2는 신경망 알고리즘을 통해 특징 추출과 분류가 이루어지는 과정을 설명하기 위한 모식도. 도 3은 본 발명에 따른 멀티 레이블 분류(Multi Label Classification) 알고리즘 기반의 상표 이미지 검색 방법 의 주요 프로세스를 순차적으로 설명하기 위한 프로세스 흐름도. 도 4는 본 발명에 따른 멀티 레이블 분류 알고리즘 기반의 상표 이미지 검색 방법을 전체적으로 설명하기 위한 개념도. 도 5는 본 발명에 따른 멀티 레이블 분류 알고리즘을 멀티 분류 알고리즘과 비교 설명하기 위한 개념도. 도 6은 상표 이미지 내에 포함된 도형을 분류하기 위한 국제 분류 코드인 비엔나 코드의 구성을 설명하기 위한 도면. 도 7은 비엔나 코드 기반의 다중 레이블을 기준으로 만든 벡터의 구성을 설명하기 위한 도면. 도 8은 본 발명에 따른 유사도 연산을 위한 연산 수식을 설명하기 위한 도면. 도 9는 본 발명에 따른 또 다른 실시예에서 이미지 내에 포함된 객체의 분류 정보 이외에, 영역 정보를 추가로 지정하여 경우의 데이터 레이블 과정을 설명하기 위한 도면. 도 10은 본 발명에 따른 멀티 레이블 분류 기반 상표 이미지 검색 시스템의 구성을 설명하기 위한 도면. 그리고, 도 11은 본 발명에 따라 구현된 멀티 레이블 분류 기반 상표 이미지 검색 시스템의 실제 검색 결과를 도시한 도면이다."}
