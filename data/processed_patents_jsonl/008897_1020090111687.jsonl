{"patent_id": "10-2009-0111687", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2011-0054886", "출원번호": "10-2009-0111687", "출원인": "원광대학교산학협력단", "발명자": "정성태"}}
{"patent_id": "10-2009-0111687", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "입력된 얼굴 영상의 얼굴 영역 내에서 얼굴을 검출하는 단계;상기 검출된 얼굴의 얼굴 영상에 히스토그램 매칭을 이용하여 조명의 정규화를 실행하는 단계; 및상기 히스토그램 매칭된 얼굴 영상에 인공 신경망 알고리즘을 적용하여 얼굴 표정을 인식하는 단계를 포함하는것을 특징으로 하는 조명변화에 견고한 얼굴 표정 인식방법."}
{"patent_id": "10-2009-0111687", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "청구항 1에 있어서,상기 조명 정규화 단계는,상기 검출된 얼굴 영상과 표준 영상의 히스토그램을 계산하는 제 1 단계;상기 얼굴 영상과 표준 영상의 누적 히스토그램을 계산하는 제 2 단계;상기 얼굴 영상과 표준 영상의 누적 히스토그램을 생성한 다음 이을 통해서 명암도를 변환하는 매핑 함수를 생성하는 제 3 단계; 및상기 얼굴 영상의 각각의 픽셀에 대하여 명암도 매핑 함수를 적용하여 히스토그램 매칭된 영상을 구하는 제 4단계를 포함하는 것을 특징으로 하는 조명변화에 견고한 얼굴 표정 인식방법."}
{"patent_id": "10-2009-0111687", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "청구항 2에 있어서,상기 제 1 단계에서, 을 이용하여 상기 히스토그램을 계산하고,(여기에서, 이고, ω는 영상의 넓이이고, h는 영상의 높이이고, 는 영상의 명암 값 의 히스토그램 값이며, I(j, i)는 영상 픽셀의 명암 값임)상기 제 2 단계에서, 를 이용하여 누적 히스토그램을 계산하고,상기 제 3 단계에서, 을 이용하여 매핑 함수를 생성하며,(여기서, 는 명암도 매핑 함수를 표시하고, 과 는 표준 영상과 입력공개특허 10-2011-0054886-3-영상의 명암도 누적 히스토그램을 표시함)상기 제 4 단계에서, 상기 명암도 매핑 함수를 이용하여 히스토그램 매칭된 영상을 구하는 것을 특징으로 하는 조명변화에 견고한 얼굴 표정 인식방법."}
{"patent_id": "10-2009-0111687", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "청구항 1에 있어서,상기 얼굴 표정을 인식하는 단계에서,상기 인공 신경망 알고리즘은 입력층과 은닉층 및 출력층의 세 개 층으로 이루어진 백-프로파게이션(Back-Propagation) 알고리즘이며,PCA 주성분 분석법을 통하여 상기 히스토그램 매칭된 얼굴 영상의 분포 및 특징을 표현할 수 있는 주요 성분을구하고, 이를 상기 인공 신경망 알고리즘의 입력층 노드로 사용하여 얼굴 표정을 인식하는 것을 특징으로 하는조명변화에 견고한 얼굴 표정 인식방법.명 세 서발명의 상세한 설명 기 술 분 야본 발명은 조명변화에 견고한 얼굴 표정 인식방법에 관한 것으로, 특히 히스토그램 매칭을 통하여 조명변화에 [0001]의한 민감도를 줄일 수 있도록 한 얼굴 표정 인식방법에 관련한다. 배 경 기 술얼굴 표정은 인간의 감정을 표현하는 기본 방식이며, 사람 간의 비언어적인 의사소통에서 효율적인 방식 중 하 [0002]나이다. 가령, 심리학 전문가 Mehrabian는 인간의 감정을 전달과정에서 표정 정보에 대한 영향을 아래 공식으로제안하고 있다.인간의 감정 = 언어(7%)+음성(38%)+얼굴표정(55%) [0003]인공 지능과 패턴 인식 기술이 발전함에 따라서 얼굴 표정 인식은 HCI(Human Computer Interface)에서 중요한 [0004]기술중 하나이며, 이에 관련된 많은 연구가 진행되고 있다. Ekman의 연구에 따르면 사람의 얼굴 표정은 기본적으로 놀람, 두려움, 슬픔, 화남, 역겨움, 웃음 6개의 표정으로 나눌 수 있지만, 특히 웃음 표정은 사람들 간의교류에서 중요한 역할 담당하고 있으며, 서비스업, 예방의학, 헬스 케어 등의 분야에서 널리 응용할 수 있기 때문에 웃음 표정에 대한 연구는 다른 표정보다 더 유용하게 활용될 수 있어 많은 각광을 받고 있다.기존의 표정 인식 연구 방법으로는 얼굴 표정 변화에 따른 광학적 흐름 추정을 통한 얼굴 근육 움직임 정보를 [0005]이용하여 인식하는 광학적 흐름 분석(Optic Flow Analysis)방법, 얼굴 국부적인 특징 점(눈, 코, 입 등)의 위치를 찾아서 특징 부분의 변화와 비교하여 인식하는 국부적인 표현 방법, 그리고 PCA(Principal ComponentAnalysis)와 LDA(Linear Discriminant Analysis), 및 ICA(Independent Component Analysis) 등을 통해서 얼굴전체에 대한 분석으로 얼굴 영상에 대해 통계적으로 학습시키고 인식하는 홀리스틱 분석(Holistic Analysis) 방법 등이 있다.이 중에서 PCA를 이용하는 방법의 경우, 영상에 대한 조명 정규화가 중요하다. [0006]이에 따라, \"PCA를 이용한 얼굴 표정의 감정 인식방법\"(Proceedings of KFIS Autumn Conference 2006, Vol. [0007]16, No.2)에서는 영상 조명 표준화 방법을 제안하였고, \"PCA 표정을 이용한 강인한 얼굴 표정 인식\"(한국인지과학회 논문지 제16권, 제4호, pp. 323-331, 2005)에서는 백색화(Whitening) 조명 정규화 방법을 제안하였다.그러나, 이들 방법에 의할 경우, 얼굴 표정에 대한 인식률이 떨어진다는 문제점을 갖는다. [0008]공개특허 10-2011-0054886-4- 발명의 내용 해결 하고자하는 과제따라서, 본 발명의 목적은 얼굴 표정에 대한 인식률을 향상시킬 수 있는 얼굴 표정 인식방법을 제공하는 [0009]것이다. 과제 해결수단상기의 목적은, 입력된 얼굴 영상의 얼굴 영역 내에서 얼굴을 검출하는 단계; 상기 검출된 얼굴의 얼굴 영상에 [0010]히스토그램 매칭을 이용하여 조명의 정규화를 실행하는 단계; 및 상기 히스토그램 매칭된 얼굴 영상에 인공 신경망 알고리즘을 적용하여 얼굴 표정을 인식하는 단계를 포함하는 얼굴 표정 인식방법에 의해 달성된다. 효 과상기한 구성에 의하면, 종래 조명의 정규화에 있어서 표준화 방법에 의한 경우의 인식률이나, 백색화 방법에 의 [0011]한 경우의 인식률에 비하여 향상된 인식률을 얻을 수 있다 발명의 실시를 위한 구체적인 내용이하, 첨부한 도면을 참조하여 본 발명의 실시 예를 상세하게 설명한다. [0012]도 1은 본 발명에 따른 얼굴 표정 인식방법을 설명하는 플로차트이다. [0013]본 발명의 얼굴 표정 인식방법에 의하면, 영상 입력단계(S10), 얼굴 영상 검출단계(S11), 조명 정규화 단계 [0014](S12), 및 얼굴 표정 인식단계(S13)로 이루어진다.영상 입력단계(S10) [0015]카메라 등을 통하여 촬영된 얼굴 영상이 실시간으로 입력된다. [0016]얼굴 영상 검출단계(S11) [0017]얼굴 영상 검출단계(S11)에서는 얼굴 영역 내에서 간단하면서 객체 간의 구별 능력이 있는 특징을 이용하여 얼 [0018]굴을 검출할 수 있다. 도 2는 Harr-like 특징을 이용하여 얼굴 영상을 검출하는 것을 나타낸다.Harr-like 특징은 Papageoriou et al.에 의해 제안된 인테그랄(integral) 이미지를 이용하여 간단하면서도 빠 [0019]르게 연산을 수행할 수 있다. 이러한 Harr-like 특징과 인테그랄 이미지의 사용은 복잡한 연산을 줄이고, 높은검출 성능이 요구되는 실시간 객체 검출에 효과적으로 적용된다.또한, 본 발명에 따르면, 도 3과 같이 얼굴 영상이 잘못 검출되는 경우에 대비하여, 얼굴 영상 검출단계(S11)에 [0020]서 SVM 분류를 이용하여 얼굴 영상과 비얼굴 영상을 분류함으로써 정확한 얼굴 영상을 얻을 수 있다.도 4는 SVM 분류를 이용한 얼굴과 비얼굴 학습 영상들이다. [0021]SVM은 1995년 Vapnik에 의해 이진 패턴 분류 문제를 해결하기 위해 제안된 학습방법으로 각 범주의 대표적인 특 [0022]징을 갖는 벡터를 이용하여 최적의 하이퍼분리면(Hyperplane)을 찾아서 두 범주를 분류하는 기법이다.조명 정규화 단계(S12) [0023]상기한 바와 같이, PCA를 이용하여 얼굴 표정을 인식할 때, 영상의 조명 차이에 따라 인식률에 차이를 보일 수 [0024]있기 때문에 표정을 인식하기 전에 조명에 대한 정규화를 실행한다. 본 발명에 의하면, 조명에 강인한 영상을 얻기 위해 얼굴 영상에 히스토그램 매칭을 이용하여 조명의 정규화를 [0025]실행한다. 이 방법은 선형 조명 차이를 정규화할 수 있을 뿐만 아니라 감마(Gamma) 효과처럼 비선형 조명 차이를 제거할 수도 있다.공개특허 10-2011-0054886-5-도 5는 히스토그램 매칭 과정을 설명하는 다이어그램이다. [0026]히스토그램 매칭 과정에서 첫 번째 단계에서 입력 영상, 즉 얼굴 영상 검출단계(S11)에서 검출한 얼굴 영상과 [0027]표준 영상의 히스토그램을 식 (1)을 이용하여 계산한다.수학식 1[0028]여기에서, [0029][0030]식 (1)에서 ω는 영상의 넓이이고, h는 영상의 높이이다. 또한, 는 영상의 명암 값 의 히스토 [0031]그램 값이며, I(j, i)는 영상 픽셀의 명암 값이다.두 번째 단계는 각 영상의 히스토그램에 대해 누적하는 과정을 식 (2)을 이용해 계산한다. [0032]수학식 2[0033]표준 영상과 입력 영상의 누적 히스토그램을 생성한 다음 이을 통해서 명암도를 변환하는 매핑(mapping) 함수가 [0034]만들어진다. 매핑 함수는 식 (3)를 이용하여 생성한다.수학식 3[0035]여기서, 는 명암도 매핑 함수를 표시하고, 과 는 표준 영상과 입력 [0036]영상의 명암도 누적 히스토그램을 표시한다. 조건이 만족할 때 입력 영상에서 명암도 값이 보다 작거나 같 [0037]은 계수는 표준 영상에서 명암도 값이 보다 작거나 같은 계수와 근사하는 것을 알 수 있다. 다음, 입력 영상의 각각의 픽셀에 대하여 식 (4)와 같이 명암도 매핑 함수를 적용하여 히스토그램 매칭된 영상 [0038]을 구하게 된다.수학식 4[0039]도 6a와 6b는 각각 히스토그램 매칭 실행 전과 후에 대한 얼굴 영상들을 보여주고 있다. 도 6을 참조하면, 히스 [0040]토그램 매칭 단계를 통하여 조명 변화에 의한 민감도를 줄일 수 있음을 알 수 있다.공개특허 10-2011-0054886-6-얼굴 표정 인식단계(S13) [0041]얼굴 영상은 고차원 특징 벡터로 이루어진 데이터이기 때문에 이를 그대로 입력 층으로 인공신경망을 이용하여 [0042]얼굴을 인식하는 데에는 오랜 시간이 걸린다. 따라서, 얼굴 인식 단계(S13)에서는 차원 축소 방법의 대표적인PCA를 이용해 입력 영상의 특징 벡터의 차원을 줄일 수 있다. 1) PCA 주성분 분석법을 이용하여 특징 얼굴 검출 [0043]주성분 분석은 고차원 특징 벡터를 몇 개의 주성분 값으로 나타내어 저차원의 특징 벡터로 표현해주는 [0044]방법이다. 즉 PCA는 원래 고차원 데이터의 분포 및 특징을 표현할 수 있는 몇 개의 주요 성분들을 찾는 과정이다.도 7은 실험에 사용된 영상에 대해 구한 고유 얼굴 영상들이다. [0045]2) 인공신경망을 이용하여 얼굴 표정 인식 [0046]얼굴 특징 벡터와 얼굴 표정은 비선형 관계이다. 인공신경망은 이론적으로 강한 비선형 능력과 적응 능력을 가 [0047]지고 있기 때문에 임의 비선형 모델에서 이용할 수 있다. 이 특성에 근거하여 본 발명에서는 세 개 층으로 이루어진 인공신경망 Back-Propagation 알고리즘을 이용하여 얼굴 표정을 인식하는 방법을 사용한다.주성분 분석으로 구한 특징 벡터는 인공신경망의 입력층 노드로 사용되었으며, 은닉층의 계수는 입력층의 계수 [0048]와 같이 설정하고, 출력층은 무표정과 웃음 표정을 구별하기 위해서 2개로 나눈다.Back-Propagation 알고리즘은 학습 전향 단계와 후향 단계로 이루어진다. 전향 단계는 각 입력 층 노드에 대해 [0049]서 입력 함수와 활성화 함수를 이용하여 출력을 산출하는 단계이다. 후향 단계는 목표 출력과 실제 출력의 차이를 계산하여 오차를 구하고, 은닉층에 역 전파하여 출력층에서 입력층으로 순서대로 층과 층 사이의 가중치를갱신하는 단계이다. 가중치 갱신은 일반화된 델타 규칙(Generalized Delta Rule)으로 수행하게 된다. 총 오차의합이 정해진 오차의 기준치에 도달할 때까지 계속 실행하다가 원하는 값에 수렴되면 동작을 멈추게 된다. <실험 예> [0050]제안된 표정 인식 시스템의 성능을 평가하기 위해 도 8과 같이 여러 조명 조건하에서 128 × 128의 해상도를 갖 [0051]는 21명 학생의 웃음, 무표정 영상 각 10장씩 총 210장을 사용하여 실험하였다. 그 중에 17명 학생 영상은 학습 영상으로 사용하고, 나머지 4명 학생은 테스트 영상으로 사용하였다. 도 8(a)은 [0052]학습 영상이고, 도 8(b)은 테스트 영상이며, 도 8(c)은 본 실험에서 이용하는 조명 표준 영상이다.아래의 표 1은 제안된 알고리즘을 이용하여 조명 표준화, 백색화(Whitening), 및 히스토그램 매칭 세 가지 조명 [0053]정규화 방법을 사용해 실험한 결과를 비교한 표이다.방 법 [0054] 조명 정규화 않음 표준화 백색화 히스토그램 매칭전체인식률 80% 83.75% 85% 88.75%표 1을 참조하면, 본 발명의 히스토그램 매칭을 통한 조명 정규화 방법을 사용한 경우 88.75%의 인식률을 얻을 [0055]수 있었으며, 이는 표준화 방법에 의할 경우의 83.75%의 인식률이나, 백색화 방법에 의할 경우의 85% 인식률에비하여 향상된 인식률을 보여주고 있다. 다시 말해, 다른 조명 정규화 방법보다 조명 변화에 영향을 더 효과적으로 줄여 인식률을 향상시킬 수 있다는 것을 알 수 있었다. 이상에서는 본 발명의 실시 예를 중심으로 설명하였지만, 당업자의 수준에서 다양한 변경을 가할 수 있음은 물 [0056]론이다. 따라서, 본 발명의 권리범위는 상기한 실시 예에 한정되어 해석될 수 없으며, 이하에 기재되는 특허청구범위에 의해 해석되어야 한다.도면의 간단한 설명도 1은 본 발명에 따른 얼굴 표정 인식방법을 설명하는 플로차트이다. [0057]도 2는 Harr-like 특징을 이용하여 얼굴 영상을 검출하는 것을 나타낸다. [0058]공개특허 10-2011-0054886-7-도 3은 얼굴을 잘못 검출하는 경우를 설명하는 도면이다. [0059]도 4는 SVM 분류를 이용한 얼굴과 비얼굴 학습 영상들이다. [0060]도 5는 히스토그램 매칭 과정을 설명하는 다이어그램이다. [0061]도 6a와 6b는 각각 히스토그램 매칭 실행 전과 후에 대한 얼굴 영상들을 보여주고 있다. [0062]도 7은 실험에 사용된 영상에 대해 구한 고유 얼굴 영상들이다. [0063]도 8(a)은 학습 영상이고, 도 8(b)은 테스트 영상이며, 도 8(c)은 본 실험에서 이용하는 조명 표준 영상이다. [0064]도면 도면1 도면2공개특허 10-2011-0054886-8- 도면3 도면4 도면5공개특허 10-2011-0054886-9- 도면6a공개특허 10-2011-0054886-10- 도면6b 도면7공개특허 10-2011-0054886-11- 도면8공개특허 10-2011-0054886-12-"}
{"patent_id": "10-2009-0111687", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "조명변화에 견고한 얼굴 표정 인식방법이 개시된다. 상기 인식방법은, 입력된 얼굴 영상의 얼굴 영역 내에서 얼 굴을 검출하는 단계; 상기 검출된 얼굴의 얼굴 영상에 히스토그램 매칭을 이용하여 조명의 정규화를 실행하는 단 계; 및 상기 히스토그램 매칭된 얼굴 영상에 인공 신경망 알고리즘을 적용하여 얼굴 표정을 인식하는 단계를 포 함한다."}
{"patent_id": "10-2009-0111687", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 조명변화에 견고한 얼굴 표정 인식방법에 관한 것으로, 특히 히스토그램 매칭을 통하여 조명변화에 의한 민감도를 줄일 수 있도록 한 얼굴 표정 인식방법에 관련한다."}
{"patent_id": "10-2009-0111687", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "얼굴 표정은 인간의 감정을 표현하는 기본 방식이며, 사람 간의 비언어적인 의사소통에서 효율적인 방식 중 하 나이다. 가령, 심리학 전문가 Mehrabian는 인간의 감정을 전달과정에서 표정 정보에 대한 영향을 아래 공식으로 제안하고 있다. 인간의 감정 = 언어(7%)+음성(38%)+얼굴표정(55%) 인공 지능과 패턴 인식 기술이 발전함에 따라서 얼굴 표정 인식은 HCI(Human Computer Interface)에서 중요한 기술중 하나이며, 이에 관련된 많은 연구가 진행되고 있다. Ekman의 연구에 따르면 사람의 얼굴 표정은 기본적 으로 놀람, 두려움, 슬픔, 화남, 역겨움, 웃음 6개의 표정으로 나눌 수 있지만, 특히 웃음 표정은 사람들 간의 교류에서 중요한 역할 담당하고 있으며, 서비스업, 예방의학, 헬스 케어 등의 분야에서 널리 응용할 수 있기 때 문에 웃음 표정에 대한 연구는 다른 표정보다 더 유용하게 활용될 수 있어 많은 각광을 받고 있다. 기존의 표정 인식 연구 방법으로는 얼굴 표정 변화에 따른 광학적 흐름 추정을 통한 얼굴 근육 움직임 정보를 이용하여 인식하는 광학적 흐름 분석(Optic Flow Analysis)방법, 얼굴 국부적인 특징 점(눈, 코, 입 등)의 위치 를 찾아서 특징 부분의 변화와 비교하여 인식하는 국부적인 표현 방법, 그리고 PCA(Principal Component Analysis)와 LDA(Linear Discriminant Analysis), 및 ICA(Independent Component Analysis) 등을 통해서 얼굴 전체에 대한 분석으로 얼굴 영상에 대해 통계적으로 학습시키고 인식하는 홀리스틱 분석(Holistic Analysis) 방 법 등이 있다. 이 중에서 PCA를 이용하는 방법의 경우, 영상에 대한 조명 정규화가 중요하다. 이에 따라, \"PCA를 이용한 얼굴 표정의 감정 인식방법\"(Proceedings of KFIS Autumn Conference 2006, Vol. 16, No.2)에서는 영상 조명 표준화 방법을 제안하였고, \"PCA 표정을 이용한 강인한 얼굴 표정 인식\"(한국인지과 학회 논문지 제16권, 제4호, pp. 323-331, 2005)에서는 백색화(Whitening) 조명 정규화 방법을 제안하였다."}
{"patent_id": "10-2009-0111687", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 2, "content": "그러나, 이들 방법에 의할 경우, 얼굴 표정에 대한 인식률이 떨어진다는 문제점을 갖는다. 발명의 내용 해결 하고자하는 과제 따라서, 본 발명의 목적은 얼굴 표정에 대한 인식률을 향상시킬 수 있는 얼굴 표정 인식방법을 제공하는 것이다. 과제 해결수단 상기의 목적은, 입력된 얼굴 영상의 얼굴 영역 내에서 얼굴을 검출하는 단계; 상기 검출된 얼굴의 얼굴 영상에 히스토그램 매칭을 이용하여 조명의 정규화를 실행하는 단계; 및 상기 히스토그램 매칭된 얼굴 영상에 인공 신 경망 알고리즘을 적용하여 얼굴 표정을 인식하는 단계를 포함하는 얼굴 표정 인식방법에 의해 달성된다. 효 과 상기한 구성에 의하면, 종래 조명의 정규화에 있어서 표준화 방법에 의한 경우의 인식률이나, 백색화 방법에 의 한 경우의 인식률에 비하여 향상된 인식률을 얻을 수 있다 발명의 실시를 위한 구체적인 내용 이하, 첨부한 도면을 참조하여 본 발명의 실시 예를 상세하게 설명한다. 도 1은 본 발명에 따른 얼굴 표정 인식방법을 설명하는 플로차트이다. 본 발명의 얼굴 표정 인식방법에 의하면, 영상 입력단계(S10), 얼굴 영상 검출단계(S11), 조명 정규화 단계 (S12), 및 얼굴 표정 인식단계(S13)로 이루어진다. 영상 입력단계(S10) 카메라 등을 통하여 촬영된 얼굴 영상이 실시간으로 입력된다. 얼굴 영상 검출단계(S11) 얼굴 영상 검출단계(S11)에서는 얼굴 영역 내에서 간단하면서 객체 간의 구별 능력이 있는 특징을 이용하여 얼 굴을 검출할 수 있다. 도 2는 Harr-like 특징을 이용하여 얼굴 영상을 검출하는 것을 나타낸다. Harr-like 특징은 Papageoriou et al.에 의해 제안된 인테그랄(integral) 이미지를 이용하여 간단하면서도 빠 르게 연산을 수행할 수 있다. 이러한 Harr-like 특징과 인테그랄 이미지의 사용은 복잡한 연산을 줄이고, 높은 검출 성능이 요구되는 실시간 객체 검출에 효과적으로 적용된다. 또한, 본 발명에 따르면, 도 3과 같이 얼굴 영상이 잘못 검출되는 경우에 대비하여, 얼굴 영상 검출단계(S11)에 서 SVM 분류를 이용하여 얼굴 영상과 비얼굴 영상을 분류함으로써 정확한 얼굴 영상을 얻을 수 있다. 도 4는 SVM 분류를 이용한 얼굴과 비얼굴 학습 영상들이다. SVM은 1995년 Vapnik에 의해 이진 패턴 분류 문제를 해결하기 위해 제안된 학습방법으로 각 범주의 대표적인 특 징을 갖는 벡터를 이용하여 최적의 하이퍼분리면(Hyperplane)을 찾아서 두 범주를 분류하는 기법이다. 조명 정규화 단계(S12) 상기한 바와 같이, PCA를 이용하여 얼굴 표정을 인식할 때, 영상의 조명 차이에 따라 인식률에 차이를 보일 수 있기 때문에 표정을 인식하기 전에 조명에 대한 정규화를 실행한다. 본 발명에 의하면, 조명에 강인한 영상을 얻기 위해 얼굴 영상에 히스토그램 매칭을 이용하여 조명의 정규화를 실행한다. 이 방법은 선형 조명 차이를 정규화할 수 있을 뿐만 아니라 감마(Gamma) 효과처럼 비선형 조명 차이 를 제거할 수도 있다.도 5는 히스토그램 매칭 과정을 설명하는 다이어그램이다. 히스토그램 매칭 과정에서 첫 번째 단계에서 입력 영상, 즉 얼굴 영상 검출단계(S11)에서 검출한 얼굴 영상과 표준 영상의 히스토그램을 식 을 이용하여 계산한다. 수학식 1"}
{"patent_id": "10-2009-0111687", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 3, "content": "여기에서,"}
{"patent_id": "10-2009-0111687", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 4, "content": "식 에서 ω는 영상의 넓이이고, h는 영상의 높이이다. 또한, 는 영상의 명암 값 의 히스토 그램 값이며, I(j, i)는 영상 픽셀의 명암 값이다. 두 번째 단계는 각 영상의 히스토그램에 대해 누적하는 과정을 식 을 이용해 계산한다. 수학식 2"}
{"patent_id": "10-2009-0111687", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 5, "content": "표준 영상과 입력 영상의 누적 히스토그램을 생성한 다음 이을 통해서 명암도를 변환하는 매핑(mapping) 함수가 만들어진다. 매핑 함수는 식 를 이용하여 생성한다. 수학식 3"}
{"patent_id": "10-2009-0111687", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 6, "content": "여기서, 는 명암도 매핑 함수를 표시하고, 과 는 표준 영상과 입력 영상의 명암도 누적 히스토그램을 표시한다. 조건이 만족할 때 입력 영상에서 명암도 값이 보다 작거나 같 은 계수는 표준 영상에서 명암도 값이 보다 작거나 같은 계수와 근사하는 것을 알 수 있다. 다음, 입력 영상의 각각의 픽셀에 대하여 식 와 같이 명암도 매핑 함수를 적용하여 히스토그램 매칭된 영상 을 구하게 된다. 수학식 4"}
{"patent_id": "10-2009-0111687", "section": "발명의_설명", "subsection": "배경기술", "item": 7, "content": "도 6a와 6b는 각각 히스토그램 매칭 실행 전과 후에 대한 얼굴 영상들을 보여주고 있다. 도 6을 참조하면, 히스 토그램 매칭 단계를 통하여 조명 변화에 의한 민감도를 줄일 수 있음을 알 수 있다.얼굴 표정 인식단계(S13) 얼굴 영상은 고차원 특징 벡터로 이루어진 데이터이기 때문에 이를 그대로 입력 층으로 인공신경망을 이용하여 얼굴을 인식하는 데에는 오랜 시간이 걸린다. 따라서, 얼굴 인식 단계(S13)에서는 차원 축소 방법의 대표적인 PCA를 이용해 입력 영상의 특징 벡터의 차원을 줄일 수 있다. 1) PCA 주성분 분석법을 이용하여 특징 얼굴 검출 주성분 분석은 고차원 특징 벡터를 몇 개의 주성분 값으로 나타내어 저차원의 특징 벡터로 표현해주는 방법이다. 즉 PCA는 원래 고차원 데이터의 분포 및 특징을 표현할 수 있는 몇 개의 주요 성분들을 찾는 과정이 다. 도 7은 실험에 사용된 영상에 대해 구한 고유 얼굴 영상들이다. 2) 인공신경망을 이용하여 얼굴 표정 인식 얼굴 특징 벡터와 얼굴 표정은 비선형 관계이다. 인공신경망은 이론적으로 강한 비선형 능력과 적응 능력을 가 지고 있기 때문에 임의 비선형 모델에서 이용할 수 있다. 이 특성에 근거하여 본 발명에서는 세 개 층으로 이루 어진 인공신경망 Back-Propagation 알고리즘을 이용하여 얼굴 표정을 인식하는 방법을 사용한다. 주성분 분석으로 구한 특징 벡터는 인공신경망의 입력층 노드로 사용되었으며, 은닉층의 계수는 입력층의 계수 와 같이 설정하고, 출력층은 무표정과 웃음 표정을 구별하기 위해서 2개로 나눈다. Back-Propagation 알고리즘은 학습 전향 단계와 후향 단계로 이루어진다. 전향 단계는 각 입력 층 노드에 대해 서 입력 함수와 활성화 함수를 이용하여 출력을 산출하는 단계이다. 후향 단계는 목표 출력과 실제 출력의 차이 를 계산하여 오차를 구하고, 은닉층에 역 전파하여 출력층에서 입력층으로 순서대로 층과 층 사이의 가중치를 갱신하는 단계이다. 가중치 갱신은 일반화된 델타 규칙(Generalized Delta Rule)으로 수행하게 된다. 총 오차의 합이 정해진 오차의 기준치에 도달할 때까지 계속 실행하다가 원하는 값에 수렴되면 동작을 멈추게 된다. <실험 예> 제안된 표정 인식 시스템의 성능을 평가하기 위해 도 8과 같이 여러 조명 조건하에서 128 × 128의 해상도를 갖 는 21명 학생의 웃음, 무표정 영상 각 10장씩 총 210장을 사용하여 실험하였다. 그 중에 17명 학생 영상은 학습 영상으로 사용하고, 나머지 4명 학생은 테스트 영상으로 사용하였다. 도 8(a)은 학습 영상이고, 도 8(b)은 테스트 영상이며, 도 8(c)은 본 실험에서 이용하는 조명 표준 영상이다. 아래의 표 1은 제안된 알고리즘을 이용하여 조명 표준화, 백색화(Whitening), 및 히스토그램 매칭 세 가지 조명 정규화 방법을 사용해 실험한 결과를 비교한 표이다. 방 법 조명 정규화 않음 표준화 백색화 히스토그램 매칭 전체인식률 80% 83.75% 85% 88.75% 표 1을 참조하면, 본 발명의 히스토그램 매칭을 통한 조명 정규화 방법을 사용한 경우 88.75%의 인식률을 얻을 수 있었으며, 이는 표준화 방법에 의할 경우의 83.75%의 인식률이나, 백색화 방법에 의할 경우의 85% 인식률에 비하여 향상된 인식률을 보여주고 있다. 다시 말해, 다른 조명 정규화 방법보다 조명 변화에 영향을 더 효과적 으로 줄여 인식률을 향상시킬 수 있다는 것을 알 수 있었다. 이상에서는 본 발명의 실시 예를 중심으로 설명하였지만, 당업자의 수준에서 다양한 변경을 가할 수 있음은 물 론이다. 따라서, 본 발명의 권리범위는 상기한 실시 예에 한정되어 해석될 수 없으며, 이하에 기재되는 특허청 구범위에 의해 해석되어야 한다."}
