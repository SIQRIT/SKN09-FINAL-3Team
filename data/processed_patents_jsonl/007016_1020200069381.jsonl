{"patent_id": "10-2020-0069381", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2021-0105793", "출원번호": "10-2020-0069381", "발명의 명칭": "인공 지능 학습 기반의 사용자 이탈율 예측 시스템 및 그것의 동작 방법", "출원인": "(주)뤼이드", "발명자": "이영남"}}
{"patent_id": "10-2020-0069381", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "복수의 인코더 신경망과 복수의 디코더 신경망을 포함하는 사용자 이탈율 예측 시스템의 동작 방법에 있어서,제k 인코더 신경망에 문제 정보를 입력하고, 제k 디코더 신경망에 응답 정보를 입력하는 단계;상기 응답 정보에 가중치를 반영하여, 사용자의 이탈 여부를 알고자 하는 대상 문제에 대한 정보인 쿼리 데이터를 생성하고, 상기 문제 정보에 가중치를 반영하여 상기 쿼리 데이터에 대한 가중치로 사용될 어텐션 정보를 생성하는 단계; 및상기 어텐션 정보를 상기 쿼리 데이터에 대한 가중치로 사용하여 상기 사용자 이탈율 예측 시스템을 학습하는단계를 포함하는 사용자 이탈율 예측 시스템의 동작 방법."}
{"patent_id": "10-2020-0069381", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서, 상기 사용자의 이탈 여부는,사용자가 어떠한 활동도 하지 않는 상태가 미리 설정된 시간을 초과하는지 여부에 따라 결정되는 사용자 이탈율예측 시스템의 동작 방법."}
{"patent_id": "10-2020-0069381", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제2항에 있어서, 상기 미리 설정된 시간은,문제 유형 또는 문제 카테고리에 따라, 문제마다 서로 다르게 설정되는 사용자 이탈율 예측 시스템의 동작방법."}
{"patent_id": "10-2020-0069381", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제1항에 있어서, 상기 사용자의 이탈 여부는,학습 프로그램이 사용자의 의지로 종료되는 경우, 모바일 장치의 화면이 꺼지거나, 다른 어플리케이션이 켜지면서 상기 학습 프로그램이 백그라운드 상태로 전환되거나, 또는 상기 모바일 장치의 전원이 꺼지는 경우를 포함하는 사용자 이탈율 예측 시스템의 동작 방법."}
{"patent_id": "10-2020-0069381", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제1항에 있어서,상기 복수의 인코더 신경망과 상기 복수의 디코더 신경망이 각각 스택된 개수가 N일 때, k가 상기 스택된 개수N보다 작으면, 상기 어텐션 정보를 생성하는 단계 및 상기 사용자 이탈율 예측 시스템을 학습하는 단계를 반복하는 단계를 더 포함하는 사용자 이탈율 예측 시스템의 동작 방법."}
{"patent_id": "10-2020-0069381", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제5항에 있어서,상기 k가 상기 스택된 개수 N보다 같거나 크면, 상기 사용자 이탈율 예측 시스템의 학습을 종료하고, 상기 학습공개특허 10-2021-0105793-3-된 사용자 이탈율 예측 시스템으로부터, 사용자가 문제를 맞출 확률인 정답 확률 정보를 출력하는 단계를 더 포함하는 사용자 이탈율 예측 시스템의 동작 방법."}
{"patent_id": "10-2020-0069381", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제1항에 있어서, 상기 어텐션 정보를 생성하는 단계는,선택 사항으로 값이 없는 값(제로 패딩)에 패널티를 부과하여 어텐션이 수행되지 못하게 하는 동작인 키-쿼리마스킹(key-query masking)을 수행하는 단계; 및다음 문제의 예측을 위해 미래 위치에 해당하는 정보가 어텐션이 수행되지 못하게 하기 위한 동작인 상부 삼각마스킹(upper triangular masking)을 수행하는 단계를 포함하는 사용자 이탈율 예측 시스템의 동작 방법."}
{"patent_id": "10-2020-0069381", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "복수의 인코더 신경망과 복수의 디코더 신경망을 포함하는 사용자 이탈율 예측 시스템에 있어서,문제 정보를 수신하고, 상기 문제 정보에 가중치를 반영하여 쿼리 데이터에 대한 가중치로 사용될 어텐션 정보를 생성하는 제k 인코더 신경망; 및응답 정보를 수신하고, 상기 응답 정보에 가중치를 반영하여 사용자의 이탈 여부를 알고자 하는 대상 문제에 대한 정보인 상기 쿼리 데이터를 생성하고, 상기 어텐션 정보를 상기 쿼리 데이터에 대한 가중치로 사용하여 상기사용자 이탈율 예측 시스템을 학습하는 제k 디코더 신경망을 포함하는 사용자 이탈율 예측 시스템."}
{"patent_id": "10-2020-0069381", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 보다 향상된 정확성을 가지는 사용자 지식 추적 방법에 관한 발명으로, 복수의 인코더 신경망과 복수 의 디코더 신경망을 포함하는 사용자 이탈율 예측 시스템의 동작 방법에 있어서, 제k 인코더 신경망에 문제 정보 를 입력하고, 제k 디코더 신경망에 응답 정보를 입력하는 단계, 상기 응답 정보에 가중치를 반영하여 사용자가 정답 확률을 예측하고자 하는 문제에 대한 정보인 쿼리 데이터를 생성하고, 상기 문제 정보에 가중치를 반영하여 상기 쿼리 데이터에 대한 가중치로 사용될 어텐션 정보를 생성하는 단계 및 상기 어텐션 정보를 상기 쿼리 데이 터에 대한 가중치로 사용하여 상기 사용자 이탈율 예측 시스템을 학습하는 단계를 포함한다."}
{"patent_id": "10-2020-0069381", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 인공 지능 학습을 기반으로 사용자의 이탈율을 예측하기 위한 시스템 및 그것의 동작 방법에 관한 것 이다. 구체적으로, 트랜스포머 구조의 인코더 신경망에 문제 정보를, 디코더 신경망에 응답 정보를 입력하여 사 용자의 이탈율을 예측하기 위한 사용자 이탈율 예측 시스템에 관한 발명이다."}
{"patent_id": "10-2020-0069381", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "최근 인터넷과 전자장치의 활용이 각 분야에서 활발히 이루어지며 교육 환경 역시 빠르게 변화하고 있다. 특히, 다양한 교육 매체의 발달로 학습자는 보다 폭넓은 학습 방법을 선택하고 이용할 수 있게 되었다. 그 중에서도 인터넷을 통한 교육 서비스는 시간적, 공간적 제약을 극복하고 저비용의 교육이 가능하다는 이점 때문에 주요한 교수 학습 수단으로 자리매김하게 되었다. 이러한 온라인 교육 서비스는 다양한 모델의 인공지능과 접목하여 기존에 오프라인 교육 환경에서는 불가능했던 임의의 문제에 대한 사용자의 정답 확률을 예측하여 보다 효율적인 학습 컨텐츠를 제공할 수 있게 되었다. 그러 나 모바일 환경의 사용자는 학습 도중 온라인 학습환경에서 이탈을 야기하는 다양한 요인에 더욱 취약하게 노출 되어 있기 때문에 온라인 환경에서의 이탈은 오프라인 환경에서의 이탈보다 더 빈번하게 발생될 수 있다. 예를 들어, 전화가 오거나, 문자를 수신하거나, 페이스북, 인스타그램과 같은 SNS 알림을 수신하거나, 그 외에 각종 알림을 수신할 때마다 사용자는 이들 정보를 확인하기 위해 학습 프로그램에서 이탈하게 되고, 이는 결국 학습 효율을 떨어뜨리는 결과를 야기한다. 오프라인 환경에서 사용자 이탈을 막기위한 방법들은 꾸준하게 연구되었으 나 이처럼 온라인 환경에서의 학습 도중 이탈에 대한 연구는 아직 진행되지 않고 있다. 최근 다양한 인공지능 모델 중 트랜스포머 모델은 RNN을 쓰지 않고 어텐션만을 사용하여 인코더-디코더 구조를 만듦으로써 학습 속도가 무척 빠르고 성능 또한 RNN보다 우수하다는 장점이 있어 온라인 교육 분야에 적용되기 시작하였다. 트랜스포머 모델을 이용하여 온라인 학습 환경에서 사용자가 도중에 이탈할 확률을 예측할 수 있는데, 트랜스포 머 모델의 인코더와 디코더에 각각 입력되는 데이터를 어떻게 구성해야 온라인 학습환경에서 사용자 이탈율 예 측에 최적화된 추론 결과를 얻을 수 있는지, 학습 컨텐츠 특성상 사용자가 아직 풀지 않은 문제를 기초로 이탈 율이 예측되는 것을 방지하기 위해 어떤 방법을 사용할 수 있는지 등 트랜스포머 모델을 사용하여 보다 효과적 으로 이탈율을 예측하기 위한 방법이 요구된다."}
{"patent_id": "10-2020-0069381", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은 전술한 문제를 해결하기 위한 발명으로, 이탈율 예측에 최적화화된 트랜스포머 구조 기반의 인공지능 모델과 입력 데이터의 포맷을 제안하고, 이를 통해, 모바일 환경에서 학습하는 사용자의 이탈율을 보다 높은 정 확도로 예측할 수 있는 효과가 있다."}
{"patent_id": "10-2020-0069381", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명은 보다 향상된 정확성을 가지는 사용자 지식 추적 방법에 관한 발명으로, 복수의 인코더 신경망과 복수 의 디코더 신경망을 포함하는 사용자 이탈율 예측 시스템의 동작 방법에 있어서, 제k 인코더 신경망에 문제 정 보를 입력하고, 제k 디코더 신경망에 응답 정보를 입력하는 단계, 상기 응답 정보에 가중치를 반영하여 사용자 가 정답 확률을 예측하고자 하는 문제에 대한 정보인 쿼리 데이터를 생성하고, 상기 문제 정보에 가중치를 반영 하여 상기 쿼리 데이터에 대한 가중치로 사용될 어텐션 정보를 생성하는 단계 및 상기 어텐션 정보를 상기 쿼리 데이터에 대한 가중치로 사용하여 상기 사용자 이탈율 예측 시스템을 학습하는 단계를 포함한다."}
{"patent_id": "10-2020-0069381", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명의 실시 예에 따른 인공지능 학습 기반의 사용자 이탈율 예측 시스템 및 그것의 동작 방법은, 이탈율 예 측에 최적화화된 트랜스포머 구조 기반의 인공지능 모델과 입력 데이터의 포맷을 제안하고, 이를 통해, 모바일 환경에서 학습하는 사용자의 이탈율을 보다 높은 정확도로 예측할 수 있는 효과가 있다."}
{"patent_id": "10-2020-0069381", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "본 명세서 또는 출원에 개시되어 있는 본 발명의 개념에 따른 실시 예들에 대해서 특정한 구조적 내지 단계적 설명들은 단지 본 발명의 개념에 따른 실시 예를 설명하기 위한 목적으로 예시된 것으로, 본 발명의 개념에 따 른 실시 예들은 다양한 형태로 실시될 수 있으며 본 발명의 개념에 따른 실시 예들은 다양한 형태로 실시될 수 있으며 본 명세서 또는 출원에 설명된 실시 예들에 한정되는 것으로 해석되어서는 아니 된다. 본 발명의 개념에 따른 실시 예는 다양한 변경을 가할 수 있고 여러 가지 형태를 가질 수 있으므로 특정 실시 예들을 도면에 예시하고 본 명세서 또는 출원에 상세하게 설명하고자 한다. 그러나, 이는 본 발명의 개념에 따 른 실시 예를 특정한 개시 형태에 대해 한정하려는 것이 아니며, 본 발명의 사상 및 기술 범위에 포함되는 모든 변경, 균등물 내지 대체물을 포함하는 것으로 이해되어야 한다. 제1 및/또는 제2 등의 용어는 다양한 구성 요소들을 설명하는데 사용될 수 있지만, 상기 구성 요소들은 상기 용 어들에 의해 한정되어서는 안 된다. 상기 용어들은 하나의 구성 요소를 다른 구성 요소로부터 구별하는 목적으 로만, 예컨대 본 발명의 개념에 따른 권리 범위로부터 이탈되지 않은 채, 제1 구성요소는 제2 구성요소로 명명 될 수 있고, 유사하게 제2 구성요소는 제1 구성요소로도 명명될 수 있다. 어떤 구성요소가 다른 구성요소에 \"연결되어\" 있다거나 \"접속되어\" 있다고 언급된 때에는, 그 다른 구성요소에 직접적으로 연결되어 있거나 또는 접속되어 있을 수도 있지만, 중간에 다른 구성요소가 존재할 수도 있다고 이 해되어야 할 것이다. 반면에, 어떤 구성요소가 다른 구성요소에 \"직접 연결되어\" 있다거나 \"직접 접속되어\" 있 다고 언급된 때에는, 중간에 다른 구성요소가 존재하지 않는 것으로 이해되어야 할 것이다. 구성요소들 간의 관 계를 설명하는 다른 표현들, 즉 \"~사이에\"와 \"바로 ~사이에\" 또는 \"~에 이웃하는\"과 \"~에 직접 이웃하는\" 등도 마찬가지로 해석되어야 한다. 본 명세서에서 사용한 용어는 단지 특정한 실시 예를 설명하기 위해 사용된 것으로, 본 발명을 한정하려는 의도 가 아니다. 단수의 표현은 문맥상 명백하게 다르게 뜻하지 않는 한, 복수의 표현을 포함한다. 본 명세서에서, \"포함하다\" 또는 \"가지다\" 등의 용어는 서술된 특징, 숫자, 단계, 동작, 구성요소, 부분품 또는 이들을 조합한 것이 존재함을 지정하려는 것이지, 하나 또는 그 이상의 다른 특징들이나 숫자, 단계, 동작, 구성요소, 부분품 또는 이들을 조합한 것들의 존재 또는 부가 가능성을 미리 배제하지 않는 것으로 이해되어야 한다. 다르게 정의되지 않는 한, 기술적이거나 과학적인 용어를 포함해서 여기서 사용되는 모든 용어들은 본 발명이 속하는 기술 분야에서 통상의 지식을 가진 자에 의해 일반적으로 이해되는 것과 동일한 의미를 가지고 있다. 일 반적으로 사용되는 사전에 정의되어 있는 것과 같은 용어들은 관련 기술의 문맥상 가지는 의미와 일치하는 의미 를 가지는 것으로 해석되어야 하며, 본 명세서에서 명백하게 정의하지 않는 한, 이상적이거나 과도하게 형식적 인 의미로 해석되지 않는다. 실시 예를 설명함에 있어서 본 발명이 속하는 기술 분야에 익히 알려져 있고 본 발명과 직접적으로 관련이 없는 기술 내용에 대해서는 설명을 생략한다. 이는 불필요한 설명을 생략함으로써 본 발명의 요지를 흐리지 않고 더 욱 명확히 전달하기 위함이다. 이하, 첨부한 도면을 참조하여 본 발명의 바람직한 실시 예를 설명함으로써, 본 발명을 상세히 설명한다. 이하, 본 발명의 실시 예를 첨부된 도면을 참조하여 상세하게 설명한다. 도 1은 본 발명의 실시 예에 따른 사용자 이탈율 예측 시스템을 설명하기 위한 도면이다. 도 1을 참조하면, 사용자 이탈율 예측 시스템은 임베딩 수행부(10, 30), 인코더 신경망 및 디코더 신경 망을 포함할 수 있다. 트랜스포머(Transformer) 모델은 기존의 seq2seq의 구조인 인코더-디코더를 따르면서도, 어텐션(Attention)만으 로 구현한 모델이다. 트랜스포머 모델은 RNN을 사용하지 않지만 기존의 seq2seq처럼 인코더에서 입력 시퀀스를 입력받고, 디코더에서 출력 시퀀스를 출력하는 인코더-디코더 구조를 유지하며, 인코더와 디코더의 단위가 N개 씩 존재할 수 있다는 특징이 있다. 어텐션 메커니즘은 RNN에 기반한 seq2seq의 문제점으로 지적받던 하나의 고정된 크기의 벡터에 모든 정보를 압 축하는 데서 오는 정보 손실과, 기울기 소실(Vanishing Gradient) 문제를 해결하기 위해 제안되었다. 어텐션 메커니즘에 따르면, 디코더에서 출력 단어를 예측하는 매 시점(time step)마다, 인코더에서의 전체 입력 데이터를 다시 한번 참고한다. 단, 전체 입력 데이터를 전부 다 동일한 비율로 참고하는 것이 아니라, 해당 시 점에서 예측해야 할 데이터와 연관이 있는 입력 데이터 부분을 좀 더 집중(attention)하게 된다.다시 도 1을 참조하면, 본 발명의 실시 예에 따른 사용자 이탈율 예측 시스템은, 모바일 환경에서 학습 중인 사용자가 학습 프로그램을 종료할지에 대한 확률(이탈율)을 예측할 수 있다. 이러한 이탈율에 대한 정보는 이탈 율 정보일 수 있다. 이탈율 정보는 시간을 기초로 생성될 수 있다. 학습 중인 사용자가 학습 프로그램을 종료하고자 하는 의지는 시 간에 따라 가변적이므로 이탈율 정보는 학습 중인 매시간마다 서로 다른 값으로 업데이트될 수 있다. 나아가, 이탈율 정보는 문제의 난이도와 같은 문제 자체의 특성 뿐만 아니라, 현재까지 풀이한 문제들의 정답률, 평균 문제풀이 시간, 평소의 학습 시간 등 사용자의 학습 특성을 기초로 생성될 수도 있다. 모바일 환경의 사용자는 이탈을 야기하는 다양한 요인에 더욱 취약하게 노출되어 있기 때문에 온라인 환경에서 의 이탈은 오프라인 환경에서의 이탈보다 더 빈번하게 발생될 수 있다. 예를 들어, 전화가 오거나, 문자를 수신하거나, 페이스북, 인스타그램과 같은 SNS 알림을 수신하거나, 그 외에 각종 알림을 수신할 때마다 사용자는 이들 정보를 확인하기 위해 학습 프로그램에서 이탈하게 되고, 이는 결국 학습 효율을 떨어뜨리는 결과를 야기할 수 있다. 기존에 오프라인에서의 학습 이탈을 막고 학생의 집중력을 높이기 위한 다양한 방법들이 고안되었으나, 이 방법 들은 오프라인 환경에 국한되어 온라인 환경에서 그대로 적용되기 어려운 문제가 있기 때문에 온라인 환경에서 사용자 개개인의 특성을 반영하여 이탈율을 예측하고 집중력을 높일 수 있는 방안이 필요하게 되었다. 본 발명의 실시 예에 따른 사용자 이탈율 예측 시스템은, 온라인 학습환경에 최적화된 트랜스포머 구조를 기 반으로 이탈율을 예측하고, 입력 데이터를 이탈율 예측에 최적화된 포맷을 사용함으로써, 보다 향상된 정확도로 이탈율을 예측할 수 있다. 다시 도 1을 참조하면, 임베딩 수행부(10, 30)는 입력 데이터에 대해 임베딩을 수행할 수 있다. 본 발명의 실시 예에서, 입력 데이터는 문제 정보, 응답 정보를 포함할 수 있다. 문제 정보는 사용자의 지식 수준을 측정하기 위해 제공되는 다양한 유형과 난이도를 가지는 문제에 대한 정보일 수 있다. 문제 정보는 문제 정보의 메타 데이터 및/또는 각 세션에서 해당 문제의 상대적인 위치를 포함할 수 있다. 세션은 사용자의 이탈이 일어난 시점을 기준으로 시간에 따라 구분된 학습 단위일 수 있다. 응답 정보는 상기 문제 정보에 응답하여 사용자가 선택한 답에 대한 정보일 수 있다. 응답 정보는 문제에 대한 사용자의 정답 그 자체뿐만 아니라, 사용자에게 주어진 문제를 푸는데 걸린 시간에 관한 정보를 포함할 수 있다. 실시 예에 따라, 이러한 문제 정보와 응답 정보는 문제-응답 로그 데이터의 세트를 구성할 수 있다. 문제 정보 와 이에 대응되는 응답 정보는 문제-응답 로그 데이터로 매칭되어, 하나의 데이터 단위로 사용자 이탈율 예측 시스템에 입력될 수 있다. 실시 예에서, 문제 정보는 Example의 약자로 'E', 응답 정보는 Response의 약자로 'R', 이탈율 정보는 Drop out의 약자로 'd'로 표현될 수 있다. 문제-응답 로그 데이터는 Interaction의 약자로 'I'로 표현될 수 있다. 임베딩 수행부(10, 30)는 입력 데이터, 예를 들어 문제, 응답, 또는 문제와 응답의 세트를 벡터로 표현하여 사 용자 지식 추적 시스템에 임베딩하는 기능을 수행할 수 있다. 입력 데이터를 잠재 공간에 대한 벡터로 표현 하는 방법은 다양할 수 있다. 예를 들어, 인공지능 안에서 단어를 수치화하여 사용하는 방법 중 하나일 수 있다. 사용자가 입력한 표현이나 형태가 다르더라도, 연관성을 계산, 수치를 통해 이를 나타내면서 단어, 문장, 글의 의미를 작성할 수 있다. 도 5에 대한 설명에서 후술하는 바와 같이, 문제 정보는 문제 식별 정보, 카테고리 정보, 시작 시간 정보, 입력 시퀀스 위치 정보, 세션 위치 정보 중 적어도 어느 하나 이상의 정보의 임베딩을 합산하여 연산될 수 있다. 응 답 정보는 시작 시간 정보, 입력 시퀀스 위치 정보, 세션 위치 정보, 응답 정확성 정보, 소요 시간 정보, 시간 내 풀이 정보, 이탈율 정보 중 적어도 어느 하나 이상의 정보의 임베딩을 합산하여 연산될 수 있다. 벡터로 표현된 문제 정보는 임베딩 수행부에서 임베딩 되어 인코더 신경망으로 입력될 수 있다. 벡터로 표현된 응답 정보는 임베딩 수행부에서 임베딩 되어 디코더 신경망으로 입력될 수 있다. 인코더 신경망은 임베딩된 문제 정보를 기초로 어텐션 정보를 생성할 수 있다. 어텐션 정보는 인코더 신경 망의 복수의 레이어를 거치면서 가중치가 부여된 문제 정보일 수 있다. 특히, 어텐션 정보는 인코더 신경망에서 자기 어텐션(self-attention)을 거쳐 생성된 정보일 수 있다. 어텐션 정보는 수학적으로 확률로 표현될 수 있으며, 모든 어텐션 정보의 합은 1이다. 어텐션 정보는 디코더 신경망에 입력되어 디코더 신경망의 쿼리 데이터에 대한 가중치로 사용되어 사용 자 이탈율 예측 시스템을 학습시키는데 사용될 수 있다. 인공 신경망은 어느 부분이 중요한지 목적함수에 맞게 학습하기 위해 어텐션 정보를 활용할 수 있다. 특히, 자 기 어텐션(self-attention)은 어텐션을 자기 자신에게 수행한다는 의미로, 특정 데이터 자체에서 중요하게 고려 되어야 할 부분에 가중치를 부여하고, 이를 다시 자기 자신에게 반영하는 동작일 수 있다. 기존의 seq2seq에서 의 어텐션에서는 인코더 측의 데이터와 디코더 측의 데이터라는 서로 다른 데이터들의 정보들을 가지고 연관성 을 찾아냈기 때문에, 자기 어텐션에 따른 정보는 기존의 seq2seq의 어텐션 구조로는 찾을 수 없던 정보이다. 사용자 이탈율 예측 시스템은 디코더 신경망에 출력 결과(rk*)를 예측하는 매 시점마다 인코더 신경망 에 전체 입력 데이터(E1, E2, …, Ek, R1, R2, …, Rk-1)를 다시 참고할 수 있는데, 어텐션 정보에 따라 해당 출력 결과에 연관된 데이터에 집중(attention)할 수 있다. 디코더 신경망은 임베딩된 응답 정보와 어텐션 정보를 기초로 이탈율 정보를 생성할 수 있다. 디코더 신경 망은 응답 정보에, 전술한 자기 어텐션(self-attention)을 적어도 한 번 이상 수행하는 멀티 헤드 어텐션 (Multi head attention)을 수행할 수 있다. 이처럼, 디코더 신경망은 인코더 신경망에서 문제 정보에서 중요도에 따라 가중치가 부여된 어텐션 정 보를 기초로, 응답 정보로부터 생성된 쿼리 데이터에 대해 멀티 헤드 어텐션을 수행하여 이탈율 정보를 생성할 수 있다. 본 발명의 실시 예에 따르면, 사용자 이탈율 예측에 최적화된 입력 데이터로서 인코더에는 문제 정보를, 디코더 에는 응답 정보를 사용함으로써, 보다 향상된 성능을 가지는 사용자 이탈율 예측 시스템을 구현할 수 있다. 또한, 본 발명은 온라인 학습 환경에 최적화된 트랜스포머 구조의 인코더 신경망과 디코더 신경망에 상부 삼각 마스킹(Upper triangular masking)을 사용함으로써 사용자가 아직 풀이하지 않은 문제로부터 이탈율이 예측되는 것을 방지할 수 있는 사용자 이탈율 예측 시스템을 구현할 수 있다. 도 2는 도 1의 사용자 이탈율 예측 시스템의 동작을 상세하게 설명하기 위한 도면이다. 도 2를 참조하면, 사용자 이탈율 예측 시스템은 인코더 신경망, 디코더 신경망을 포함할 수 있다. 다시, 인코더 신경망은 문제 정보 처리부와 비선형화 수행부를, 디코더 신경망은 제1 응답 정 보 처리부, 제2 응답 정보 처리부 및 비선형화 수행부을 포함할 수 있다. 도 2에는 도 1의 임베딩 수행부가 생략되었으나, 입력 데이터의 임베딩 동작은 전술한 도 1에 대한 설명을 참고 하여 이해될 수 있다. 문제 정보는 벡터로 표현된 복수의 문제들(E1, E2, …, Ek)로 구성될 수 있다. 응답 정보는 벡터로 표현된 복수 의 문제들(E1, E2, …, Ek) 각각에 대한 사용자의 응답(R1, R2, …, Rk-1)으로 구성될 수 있다. 이탈율 정보는 벡터로 표현된 각 문제들에 대한 사용자의 이탈 확률을 나타낸 개별 이탈율 정보(d1, d2, …, dk)로 구성될 수 있다. 실시 예에서, 이탈율 정보 dk는, 문제 E1에 대한 사용자 응답이 R1, 문제 E2에 대한 사용자 응답이 R2, …, 문 제 Ek-1에 대한 사용자 응답이 Rk-1일 때, 사용자가 문제 따를 풀이 중일 때 학습 프로그램을 이탈할 확률에 관 한 정보일 수 있다. 문제 풀이 중에 사용자가 학습 프로그램을 종료할 확률에 관한 정보를 이탈율 정보라고 설명하였지만, 실시 예 에 따라 이탈율 정보는 사용자가 푼 문제에 대한 설명을 읽거나, 강의를 보는 중에 학습 프로그램을 종료할 확 률이 포함될 수도 있다. 이때는 사용자에게 문제가 제공된 시간으로부터 문제 풀이가 완료된 시간을 초과한 시간에, 사용자가 학습 프로 그램을 이탈할 확률로서의 이탈율 정보가 생성될 수 있다. 이는 후술되는 도 3에 대한 설명에서 자세히 설명하 도록 한다. 문제 정보 처리부는 문제 정보를 입력받고 자기 어텐션과 관련된 일련의 동작을 수행할 수 있다. 이러한 동 작에는 문제 정보를 쿼리, 키, 벨류로 구분하고, 각각의 값에 대한 복수의 헤드값을 생성하며, 복수의 쿼리 헤드값과 복수의 키 헤드값으로부터 가중치를 생성하고, 생성된 가중치에 마스킹을 수행하고, 마스킹이 수행된 가 중치를 복수의 벨류 헤드값에 적용하여 예측 데이터를 생성하는 과정을 포함할 수 있다. 문제 정보 처리부에서 생성된 예측 데이터는 어텐션 정보일 수 있다. 특히, 문제 정보 처리부는 마스킹 동작시 키-쿼리 마스킹(key-query masking) 뿐만 아니라 상부 삼각 마스 킹(upper triangular masking)을 수행할 수 있다. 키-쿼리 마스킹(key-query masking)과 상부 삼각 마스킹 (upper triangular masking)은 후술되는 도 4에 대한 설명에서 자세하게 설명하도록 한다. 비선형화 수행부는 문제 정보 처리부에서 출력된 예측 데이터를 비선형화 시키는 동작을 수행할 수 있 다. 비선형화에는 ReLU 함수가 사용될 수 있다. 도면에는 도시되지 않았지만, 인코더 신경망은 적어도 하나 이상 존재할 수 있다. 인코더 신경망에서 생성된 어텐션 정보는 다시 인코더 신경망에 입력되어 자기 어텐션과 비선형화와 관련된 일련의 동작이 수 차례 반복될 수 있다. 이후, 어텐션 정보는 키와 벨류 값으로 나뉘어 제2 응답 정보 처리부에 입력될 수 있다. 어텐션 정보는 제2 응 답 정보 처리부에 입력되는 쿼리 데이터에 대한 가중치로 사용되어 사용자 지식 이탈율 예측 시스템을 학습 시키는데 사용될 수 있다. 제1 응답 정보 처리부는 응답 정보를 입력 받고, 문제 정보 처리부와 유사한 자기 어텐션과 관련된 일 련의 동작을 수행할 수 있다. 이러한 동작에는 문제 정보를 쿼리, 키, 벨류로 구분하고, 각각의 값에 대한 복수 의 헤드값을 생성하며, 복수의 쿼리 헤드값과 복수의 키 헤드값으로부터 가중치를 생성하고, 생성된 가중치에 마스킹을 수행하고, 마스킹이 수행된 가중치를 복수의 벨류 헤드값에 적용하여 예측 데이터를 생성하는 과정을 포함할 수 있다. 제1 응답 정보 처리부에서 생성된 예측 데이터는 쿼리 데이터일 수 있다. 제2 응답 정보 처리부는 제1 응답 정보 처리부로부터 쿼리 데이터를, 인코더 신경망으로부터 어텐션 정 보를 입력 받고, 이탈율 정보를 출력할 수 있다. 어텐션 정보는 디코더 신경망에 입력되어 디코더의 쿼리 데이터에 대한 가중치로 사용되어 사용자 이탈율 예측 시스템을 학습시키는데 사용될 수 있다. 어텐션 정보는 쿼리 데이터의 특정 영역을 중점적으로 고려하기 위해 부여되는 가중치에 관한 정보일 수 있다. 구체적으로, 사용자 이탈율 예측 시스템은 디코더 신경망에 출력 결과(d)를 예측하는 매 시점마다 인코 더 신경망에 전체 입력 데이터(E1, E2, …, Ek, R1, R2, …, Rk-1)를 다시 참고할 수 있는데, 해당 출력 결과에 연관된 데이터에 집중(attention)할 수 있다. 제2 응답 정보 처리부는 상기 동작에 따라 문제 정보 Ek에 대한 사용자의 이탈율 정보인 dk를 생성할 수 있 다. 도면에는 도시되지 않았지만, 디코더 신경망은 적어도 하나 이상 존재할 수 있다. 디코더 신경망에서 생성된 정답 확률 정보는 다시 디코더 신경망에 입력되어 자기 어텐션, 멀티 헤드 어텐션 및 비선형화와 관 련된 일련의 동작이 수차례 반복될 수 있다. 문제 정보 처리부와 마찬가지로, 제1 응답 정보 처리부 및 제2 응답 정보 처리부는 마스킹 동작시 키- 쿼리 마스킹(key-query masking) 뿐만 아니라 상부 삼각 마스킹(upper triangular masking)을 수행할 수 있다. 도 3은 본 발명의 실시 예에 따른 이탈(drop out)을 설명하기 위한 도면이다. 도 3을 참조하면, 사용자는 주어진 문제(문제1, 문제2, 문제3)를 풀이하고(Solve), 각 문제에 대한 설명(설명1, 설명2, 설명3)을 읽고(Read), 강의(강의1, 강의2)를 볼 수 있다(Watch). 도 3에서, 문제1에 대한 설명과 강의는 설명1, 강의1,2이고, 문제2에 대한 설명은 설명2, 문제3에 대한 설명은 설명3일 수 있다. 각 문제에 대해 설명과 강의의 개수는 제한되지 않으며, 설명과 강의 중 어느 하나가 생략될 수도, 복수 개의 설명 또는 강의가 제공될 수도 있다. 또한, 설명은 읽고(Read), 강의는 보는(Watch) 것으로 도시되었지만, 실시 예에 따라 학습 효율을 고려한 사람 의 오감이 다양하게 활용될 수 있다.도 3에서, 시간 정보는 각각의 활동이 시작된 시간일수도, 활동이 종료된 시간일수도, 시작과 종료시간의 중간 지점일수도, 시작과 종료 사이에서 미리 설정된 기준에 따라 선정된 시간일수도 있다. 이하, 시간 정보는 각각 의 활동이 시작된 시간으로 가정하고 설명하도록 한다. 실시 예에서, t1에 문제1에 대한 사용자의 문제 풀이가 시작될 수 있다. 문제1의 풀이가 t2에서 종료된 후 학습 프로그램은 설명1과 강의1을 제공할 수 있다. 설명1이 t3까지 제공된 후, 강의1이 제공될 수 있다. 사용자는 t4에서 학습 프로그램을 이탈(drop out)할 수 있다. 이탈하는 동작은 학습 프로그램을 사용자의 의지 로 종료하는 경우 뿐만 아니라, 모바일 장치의 화면이 꺼지거나, 다른 어플리케이션이 켜지면서 학습 프로그램 이 백그라운드 상태로 전환되거나, 모바일 장치의 전원이 꺼지는 등 사용자가 학습 프로그램을 더 이상 이용하 지 않는 다양한 상황을 포함할 수 있다. 또한, 사용자가 어떠한 활동을 하지 않는 상태가 미리 설정된 시간 이상 지속되는 경우에도 이탈(drop out)로 판단될 수 있다. 사용자의 이탈을 사용자가 아무런 활동을 하지 않는 시간을 기준으로 정의할 경우, 세션은 사 용자의 이탈이 일어난 시점을 기준으로 시간에 따라 구분된 학습 단위로 정의될 수 있다. 예를 들어, 도 3의 실시 예는 미리 설정된 시간이 1시간이 경우를 예시하고 있는데, 이때 세션은 인접한 활동들 사이의 시간 간격이 1시간 미만인 일련의 학습 활동으로 정의될 수 있고, 이탈은 사용자가 아무런 활동을 하지 않은 시간이 1시간 이상 지속된 경우로 정의될 수 있다. 미리 설정된 시간은 1시간 이외에도 다양하게 설정될 수 있고, 문제 유형(또는 카테고리)에 따라 문제마다 서로 다르게 설정될 수도 있다. 예를 들어, 토익 시험에서 듣기 파트는 읽기 파트보다 짧은 시간으로 설정될 수 있고, 같은 듣기 파트에서도 지문이 길수록 시간은 길게 설정될 수도, 같은 읽기 파트에서도 지문이 짧을수록 시간도 짧게 설정될 수도 있다. t4에서 사용자가 학습 프로그램을 이탈하면, 학습 프로그램은 이탈 시점(t4)에 재생 중이던 강의1의 상태를 저 장해둘 수 있다. 이후, 사용자가 다시 학습 프로그램을 실행시키면 자동으로 저장해둔 강의를 이탈된 시점(t4) 부터 재생시킬 수 있다. 다시 재생되는 강의는 강의2일 수 있다. 전술한 과정에 따라 강의2, 문제2, 설명2, 문제3이 사용자에게 제공될 수 있다. 문제3이 제공된 t7이후 다음 활 동으로 설명3이 제공되는 t8까지 1시간 이상의 시간이 경과되었으므로, 사용자 이탈율 예측 시스템은 사용자가 이탈했다고 판단할 수 있다. 사용자 이탈율 예측 시스템은 이러한 사용자의 이탈을 인공지능 모델을 사용하여 사전에 예측하고 사용자 맞춤 형 학습 데이터를 제공할 수 있다. 전술한 바와 같이, 사용자의 이탈은 문제 풀이가 종료되고 설명 또는 강의가 제공되는 도중에도 발생할 수 있으므로, 사용자 이탈율 예측 시스템은 사용자의 문제풀이 시간에 제한되지 않고 이탈 시간을 예측할 수 있다. 도 4는 키-쿼리 마스킹(key-query masking)과 상부 삼각 마스킹(upper triangular masking)을 설명하기 위한 도면이다. 도 4는 키-쿼리 마스킹 이후 상부 삼각 마스킹이 수행되는 것으로 도시되었지만, 양자는 동시에 수행될 수 있고, 상부 삼각 마스킹이 먼저 수행될 수도 있다. 키-쿼리 마스킹은 선택 사항으로 값이 없는 값(제로 패딩)에 패널티를 부과하여 어텐션이 수행되지 못하게 하는 동작일 수 있다. 키-쿼리 마스킹이 수행된 예측 데이터의 값은 0으로, 나머지 부분은 1로 표현될 수 있다. 도 4의 키-쿼리 마스킹은 설명의 편의를 위해 쿼리와 키의 마지막 값들이 마스킹된 것으로 도시되었지만, 이는 실시 예에 따라 다양하게 변경될 수 있다. 상부 삼각 마스킹(upper triangular masking)은 다음 문제의 예측을 위해 미래 위치(포지션)에 해당하는 정보가 어텐션이 수행되지 못하게 하기 위한 동작일 수 있다. 예를 들어, 아직 사용자가 풀지 않은 문제로부터 예측값 이 연산되는 것을 방지하기 위해 마스킹하는 동작일 수 있다. 키-쿼리 마스킹과 마찬가지로, 상부 삼각 마스킹 이 수행된 예측 데이터의 값은 0으로, 나머지 부분은 1로 표현될 수 있다. 마스킹된 예측 데이터의 값들은 이후 임의의 큰 음수값이 반영되어 소프트맥스 함수를 통해 확률적으로 표현될 때 0에 가까운 확률을 가지도록 제어될 수 있다. 종래 트랜스포머 구조에서는 인코더 신경망에서는 키-쿼리 마스킹이 수행되고, 디코더 신경망에서는 키-쿼리 마 스킹과 더불어 상부 삼각 마스킹이 수행되었다. 본 발명의 사용자 이탈율 예측 시스템에서는, 인코더 신경망과 디코더 신경망 모두에서 상부 삼각 마스킹을 수행하여, 이탈율 정보가 오직 사용자에게 기 제공된 문제 정보들 (E1, E2, …, Ek)과 사용자가 이미 제출한 응답 정보(R1, R2, …, Rk-1)에만 의존하도록 제어될 수 있다. 도 5는 본 발명의 실시 예에 따른, 입력 데이터의 구성을 설명하기 위한 도면이다. 도 5를 참조하면, 입력 데이터는 문제 정보(E)와 응답 정보(R)를 포함할 수 있다. 이때, 사용자 이탈율 예측 시 스템의 인코더 신경망에는 문제 정보(E)가 입력되고, 디코더 신경망에는 응답 정보(R)가 입력될 수 있다. 문제 식별 정보는 문제마다 부여되는 고유값일 수 있다. 사용자 또는 컴퓨터는 문제 식별 정보를 통해 해당 문 제가 어떤 문제인지 판별할 수 있다. 문제 카테고리 정보는 해당 문제가 어떤 유형의 문제인지 알려주는 정보일 수 있다. 예를 들어, 토익 시험 문제 에서 문제 카테고리는 듣기 파트인지 또는 읽기 파트인지를 알려주는 정보일 수 있다. 시작 시간 정보는 사용자가 주어진 문제를 처음 접하는 시간일 수 있다. 즉, 사용자에게 문제가 제공된 시간일 수 있다. 입력 시퀀스 위치 정보는 해당 문제 또는 응답이 전체 문제 또는 응답 시퀀스 내에서 어디에 위치하는지에 관한 정보일 수 있다. 트랜스포머 구조는 RNN 구조와 다르게 입력 데이터의 순서가 표시되지 않기 때문에 순서를 구 분하기 위해 각각의 데이터가 전체 데이터 시퀀스 내에서 어디에 위치하는지를 별도로 표시할 필요가 있다. 입 력 시퀀스 위치 정보는 입력 데이터와 함께 임베딩 되고, 임베딩된 입력 데이터에 더해져 인코딩 신경망과 디코 딩 신경망에 입력될 수 있다. 세션 위치 정보는 세션에서 문제 또는 응답이 어디에 위치하는지에 관한 정보일 수 있다. 입력 시퀀스 위치 정 보는 문제마다 1만큼 카운트될 수 있고, 다음 세션으로 넘어가면 입력 시퀀스 위치 정보는 1로 초기화되어 1부 터 다시 카운트될 수 있다. 응답 정확성 정보는 사용자의 응답이 정답인지 또는 오답인지를 나타내는 정보일 수 있다. 예를 들어, 사용자의 응답이 정답이면 '1', 반대로 사용자의 응답이 오답이면 '0'의 인덱스를 가지고 이 인덱스를 벡터로 맵핑할 수 있다. 소요 시간 정보는 사용자가 문제를 푸는데 소요된 시간을 벡터로 나타낸 정보일 수 있다. 소요 시간 정보는 초, 분, 시간 등으로 표현될 수 있으며, 일정 시간(예를 들어 300초)을 초과한 시간에 대해서는 해당 시간(300초)만 큼 소요됐다고 판단할 수도 있다. 시간내 풀이 정보는 도메인 전문가가 제안한 시간 제한 내에 사용자가 응답했는지 여부에 관한 정보일 수 있다. true이면 '1', 그렇지 않으면 '0'의 인덱스를 가지고 이 인덱스를 벡터로 맵핑할 수 있다. 이탈율 정보는 해당 문제 풀이를 진행하는 도중 또는 설명을 읽거나 강의를 보는 도중에 사용자가 이탈했는지 여부를 나타내는 정보일 수 있다. true이면 '1', 그렇지 않으면 '0'의 인덱스를 가지고 이 인덱스를 벡터로 맵 핑할 수 있다. 문제 정보(E)는 문제 식별 정보, 문제 카테고리 정보, 시작 시간 정보, 입력 시퀀스 위치 정보, 세션 위치 정보 를 포함할 수 있다. 다만, 이에 한정되는 것은 아니며, 실시 예에 따라 어느 하나가 생략될 수도 있으며 다른 정보가 더 추가될 수도 있다. 응답 정보(R)는 시작 시간 정보, 입력 시퀀스 위치 정보, 세션 위치 정보, 응답 정확성 정보, 소요 시간 정보, 시간내 풀이 정보, 이탈율 정보를 포함할 수 있다. 다만, 이에 한정되는 것은 아니며, 실시 예에 따라 어느 하 나가 생략될 수도 있으며 다른 정보가 더 추가될 수도 있다. 표에 도시되지는 않았지만, 문제-응답 로그 데이터(I)는 문제 식별 정보, 문제 카테고리 정보, 시작 시간 정보, 입력 시퀀스 위치 정보, 세션 위치 정보, 응답 정확성 정보, 소요 시간 정보, 시간내 풀이 정보, 이탈율 정보를 포함할 수 있다. 다만, 이에 한정되는 것은 아니며, 실시 예에 따라 어느 하나가 생략될 수도 있으며 다른 정보 가 더 추가될 수도 있다. 본 발명의 실시 예에 따른 사용자 이탈율 예측 시스템은, 전술한 데이터 포맷으로 구성된 문제 정보(E)를 사용 자 이탈율 예측 시스템의 인코더 신경망에 입력하고, 응답 정보(R)를 디코더 신경망에 입력하여 이탈율 정보를 생성함으로써, 보다 향상된 정확도를 가지는 이탈율 예측 결과를 알 수 있는 효과가 있다.도 6은 본 발명의 실시 예에 따른 사용자 이탈율 예측 시스템의 AUC를 설명하기 위한 표이다. DAS(Deep Attentive Study Session Dropout Prediction in Mobile Learning Environment)는 본 발명의 사용자 이탈율 예측 시스템을 지칭하는 용어일 수 있다. AUC(area under the receiver operating characteristic curve)는 전체 예측에 대한 올바른 예측의 비율을 나타내는 값이다. AUC는 특이도에 따른 민감도를 나타내는 값 으로, AUC가 높을수록 예측의 정확도는 높다. 도 6을 참조하면, 다양한 인공 신경망 모델(LSTM, GRU)과 비교하여, DAS의 AUC가 높은 것을 확인할 수 있다. 특히, 시퀀스 크기(sequence size)가 5일 때(DAS-5) AUC는 0.7379로, 시퀀스 사이즈가 25일 때(DAS-25) AUC는 0.6856로, DAS-5일 때가 DAS-25일 때보다 정확도가 높은 것을 확인할 수 있다. 도 7은 입력 데이터의 시퀀스 크기(sequence size)에 따른 사용자 이탈율 예측 시스템의 AUC를 설명하기 위한 그래프이다. 입력 데이터로서 문제 정보와 응답 정보는 다양한 시퀀스 크기로 구성될 수 있다. 도 7은 시퀀스 크기에 따른 AUC를 나타낸 그래프이다. 도 7을 보면, 시퀀스 크기가 5일 때 AUC가 0.7379로, 가장 높은 정확도를 갖는 사용자 이탈율 예측 시스템을 구 현할 수 있음을 알 수 있다. 도 8은 입력 데이터의 포맷에 따른 사용자 이탈율 예측 시스템의 AUC를 설명하기 위한 그래프이다. 전술한 도 5를 참고하여 도 8의 약어가 이해될 수 있다. 구체적으로, Id는 문제 식별 정보를, c는 문제 카테고 리 정보를, st는 시작 시간 정보를, p는 입력 시퀀스 위치 정보를, sp는 세션 위치 정보를, r은 응답 정확성 정 보를, et는 소요 시간 정보를, iot는 시간내 풀이 정보를, d는 이탈율 정보를 의미할 수 있다. 도 5를 참조하면, Base에서, 인코더 신경망에 입력되는 문제 정보가 문제 식별 정보, 문제 카테고리 정보, 입력 시퀀스 위치 정보를 포함하고, 디코더 신경망에 입력되는 응답 정보가 응답 정확성 정보, 입력 시퀀스 위치 정 보를 포함할 때 AUC는 0.6346일 수 있다. 이때, 문제 정보에 시작 시간 정보가 더 추가되고, 응답 정보에 시작 시간 정보, 시간내 풀이 정보, 소요 시간 정보가 순차적으로 추가될 때, AUC는 각각 0.6653, 0.6819, 0.7017일 수 있다. 여기서, 문제 정보에 세션 위치 정보가, 응답 정보에 세션 위치 정보와 이탈율 정보가 추가될 때, AUC는 0.7379 일 수 있다. 전술한 내용을 종합하면, 문제 정보는 문제 식별 정보, 문제 카테고리 정보, 시작 시간 정보, 입력 시퀀스 위치 정보, 세션 위치 정보를 포함하고, 응답 정보는 시작 시간 정보, 입력 시퀀스 위치 정보, 세션 위치 정보, 응답 정확성 정보, 소요 시간 정보, 시간내 풀이 정보, 이탈율 정보를 포함할 때, 가장 높은 정확도를 가지는 사용자 이탈율 예측 시스템을 구현할 수 있음을 알 수 있다. 도 9는 본 발명의 실시 예에 따른, 사용자 이탈율 예측 시스템의 동작을 설명하기 위한 순서도이다. 도 9를 참조하면, S901 단계에서, 사용자 이탈율 예측 시스템은 제k 인코더 신경망에 문제 정보를, 제k 디코더 신경망에 응답 정보를 각각 입력할 수 있다. 문제 정보는 문제 식별 정보, 문제 카테고리 정보, 시작 시간 정보, 입력 시퀀스 위치 정보, 세션 위치 정보를 포함할 수 있다. 응답 정보는 시작 시간 정보, 입력 시퀀스 위치 정보, 세션 위치 정보, 응답 정확성 정보, 소 요 시간 정보, 시간내 풀이 정보, 이탈율 정보를 포함할 수 있다. 다만, 이에 한정되는 것은 아니며, 실시 예에 따라 일부 정보가 생략될 수도 있으며 다른 정보가 더 추가될 수도 있다. S903 단계에서, 사용자 이탈율 예측 시스템은 문제 정보에 가중치를 반영해 어텐션 정보를 생성하고, 응답 정보 에 가중치를 반영해 쿼리 데이터를 생성할 수 있다. 구체적으로, 문제 정보는 자기 어텐션(self-attention)을 통해 문제 정보에 가중치를 반영할 수 있다. 자기 어 텐션은 특정 데이터 자체에서 중요하게 고려되어야 할 부분에 가중치를 부여하고, 이를 다시 자기 자신에게 반 영하는 동작일 수 있다. 응답 정보는 자기 어텐션(self-attention) 뿐만 아니라, 어텐션 정보를 기초로 멀티 헤드 어텐션(multi head attention)이 수행되어 가중치가 반영될 수 있다.S905 단계에서, 제k 디코더 신경망의 제1 응답 정보 처리부로부터 출력된 쿼리 데이터를 제2 응답 정보 처리부 에 입력할 수 있다. 쿼리 데이터는 제1 응답 정보 처리부에서 출력된 예측 데이터 일 수 있다. S907 단계에서, 사용자 이탈율 예측 시스템은 어텐션 정보를 제2 응답 정보 처리부의 쿼리 데이터에 대한 가중 치로 사용하여 사용자 이탈율 예측 시스템을 학습시킬 수 있다. S909 단계에서, 사용자 이탈율 예측 시스템은 k와 N을 비교하여, k가 N보다 크거나 같으면 S911 단계를 수행하 고, 작으면 다시 S903 단계로 돌아가 S903 단계 내지 S907 단계를 반복할 수 있다. 인코더 신경망과 디코더 신경망은 N개 만큼 스택될 수 있으므로, 스택된 모든 인코더 신경망과 디코더 신경망에 대해 자기 어텐션과 멀티 헤드 어텐션을 포함하는 일련의 동작이 종료될 때까지 위 과정이 반복될 수 있다. S911 단계에서, 사용자 이탈율 예측 시스템은 학습된 사용자 이탈율 예측 시스템으로부터 이탈율 정보를 출력할 수 있다. 이는 추론 과정(inference)으로, 학습 과정에서 결정된 가중치에 따라 입력 데이터를 처리하여, 사용자가 해당 문제를 풀이하는 도중, 설명이나 강의를 듣거나 보는 도중 등에 이탈할 확률을 나타내는 이탈율 정보를 출력할 수 있다. 도 10은 본 발명의 실시 예에 따른, 문제 정보 처리부 또는 응답 정보 처리부의 동작을 상세하게 설명하기 위한 순서도이다. 도 10을 참조하면, S1001 단계에서, 각 구성은 문제 정보 또는 응답 정보에 대한 쿼리, 키, 벨류를 수신할 수 있다. 각각의 값은 벡터로 표현된 값일 수 있으며, 사용되는 역할에 따라 구분된 값일 수 있다. S1003 단계에서, 각 구성은 쿼리, 키, 벨류 각각에 대한 복수의 헤드값을 생성할 수 있다. S1005 단계에서, 각 구성은 복수의 쿼리 헤드값과 복수의 키 헤드값으로부터 가중치를 생성하고, S1007 단계에 서 키-쿼리 마스킹(key-query masking)과 상부 삼각 마스킹(upper triangular masking)을 포함하는 마스킹 동 작이 수행될 수 있다. 키-쿼리 마스킹은 선택 사항으로 값이 없는 값(제로 패딩)에 패널티를 부과하여 어텐션이 수행되지 못하게 하는 동작일 수 있다. 키-쿼리 마스킹이 수행된 예측 데이터의 값은 0으로, 나머지 부분은 1로 표현될 수 있다. 상부 삼각 마스킹(upper triangular masking)은 다음 문제에 대한 이탈율의 예측을 위해 미래 위치(포지션)에 해당하는 정보가 어텐션이 수행되지 못하게 막는 동작일 수 있다. 예를 들어, 아직 사용자가 풀지 않은 문제로부터 이탈율 정보가 예측되는 것을 방지하기 위해 아직 풀이하지 않 은 문제에 대해 어텐션이 수행되는 것을 마스킹하는 동작일 수 있다. 키-쿼리 마스킹과 마찬가지로, 상부 삼각 마스킹이 수행된 예측 데이터의 값은 0으로, 나머지 부분은 1로 표현될 수 있다. 이후, S1009 단계에서, 마스킹이 수행된 가중치를 복수의 벨류 헤드값에 적용하여 예측 데이터를 생성할 수 있 다. 문제 정보 처리부에서 생성된 예측 데이터는 어텐션 정보, 제1 응답 정보 처리부에서 생성된 예측 데이터는 쿼 리 데이터, 제2 응답 정보 처리부에서 생성된 예측 데이터는 이탈율 정보일 수 있다. 본 발명에 따른 사용자 이탈율 예측 시스템은, 최적화된 입력 데이터 포맷을 사용하고, 트랜스포머 구조의 인코 더 신경망과 디코더 신경망 모두에 상부 삼각 마스킹(Upper triangular masking)을 사용함으로써 향상된 성능을 가질 수 있다. 본 명세서와 도면에 게시된 본 발명의 실시 예들은 본 발명의 기술내용을 쉽게 설명하고 본 발명의 이해를 돕기 위해 특정 예를 제시한 것뿐이며, 본 명의 범위를 한정하고자 하는 것은 아니다. 여기에 게시된 실시 예들 이외 에도 발명의 기술적 사상에 바탕을 둔 다른 변형 예들이 실시 가능하다는 것은 본 발명이 속하는 기술 분야에서 통상의 지식을 가진 자에게 자명한 것이다."}
{"patent_id": "10-2020-0069381", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 실시 예에 따른 사용자 이탈율 예측 시스템을 설명하기 위한 도면이다. 도 2는 도 1의 사용자 이탈율 예측 시스템의 동작을 상세하게 설명하기 위한 도면이다. 도 3은 본 발명의 실시 예에 따른 이탈(drop out)을 설명하기 위한 도면이다. 도 4는 키-쿼리 마스킹(key-query masking)과 상부 삼각 마스킹(upper triangular masking)을 설명하기 위한 도면이다. 도 5는 입력 데이터의 구성을 설명하기 위한 도면이다. 도 6은 본 발명의 실시 예에 따른 사용자 이탈율 예측 시스템의 AUC를 설명하기 위한 표이다. 도 7은 입력 데이터의 시퀀스 크기(sequence size)에 따른 사용자 이탈율 예측 시스템의 AUC를 설명하기 위한 그래프이다. 도 8은 입력 데이터의 포맷에 따른 사용자 이탈율 예측 시스템의 AUC를 설명하기 위한 그래프이다. 도 9는 본 발명의 실시 예에 따른, 사용자 이탈율 예측 시스템의 동작을 설명하기 위한 순서도이다. 도 10은 본 발명의 실시 예에 따른, 문제 정보 처리부 또는 응답 정보 처리부의 동작을 상세하게 설명하기 위한 순서도이다."}
