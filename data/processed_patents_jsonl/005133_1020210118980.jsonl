{"patent_id": "10-2021-0118980", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2023-0036295", "출원번호": "10-2021-0118980", "발명의 명칭": "플로우 데이터 기반 스팸 메일 서버 탐지 방법 및 장치", "출원인": "주식회사 케이티", "발명자": "권정현"}}
{"patent_id": "10-2021-0118980", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "적어도 하나의 프로세서에 의해 동작하는 스팸 메일 서버 탐지 장치의 동작 방법으로서,메일 서버들 간에 전송되는 플로우들의 출발지와 목적지를 기초로 메일 서버 연결 그래프를 생성하는 단계,상기 메일 서버 연결 그래프를 기초로 상기 메일 서버들 사이의 연결 관계를 반영한 각 메일 서버의 신뢰 점수를 평가하는 단계,상기 메일 서버 연결 그래프에서, 신뢰 점수가 기준 이상인 메일 서버들 및 신뢰 점수가 기준 이상인 메일 서버들에 연결된 간선들을 제거해서, 기준 이하의 신뢰 점수를 가진 후보 스팸 메일 서버들로 구성된 그래프를 생성하는 단계,상기 후보 스팸 메일 서버들로 구성된 그래프 기초로, 각 후보 스팸 메일 서버의 발신차수(outdegree)를 계산하고, 상기 발신차수가 이상치인지 판단하는 단계, 그리고상기 후보 스팸 메일 서버들 중에서, 상기 발신차수가 이상치에 해당하는 메일 서버를 이상치 메일 서버로 탐지하는 단계를 포함하는 동작 방법."}
{"patent_id": "10-2021-0118980", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에서,상기 각 메일 서버의 신뢰 점수를 평가하는 단계는출발지 메일 서버가 높은 신뢰 점수를 가진 목적지 메일 서버와 연결될수록 상기 출발지 메일 서버의 신뢰 점수를 높게 평가하는 알고리즘을 이용하여, 각 메일 서버의 신뢰 점수를 평가하는, 동작 방법."}
{"patent_id": "10-2021-0118980", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1항에서,상기 각 메일 서버의 신뢰 점수를 평가하는 단계는샘플링 레이트에 따라 조정되는 댐핑 계수를 기초로, 상기 샘플링 레이트에 의해 수집이 누락된 플로우 영향을보정하여, 각 메일 서버의 신뢰 점수를 평가하는, 동작 방법."}
{"patent_id": "10-2021-0118980", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제1항에서,상기 발신차수는 상기 후보 스팸 메일 서버로 구성된 그래프에서 각 후보 스팸 메일 서버가 출발지인 플로우들의 목적지 메일 서버 수로 계산되는, 동작 방법."}
{"patent_id": "10-2021-0118980", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제1항에서,상기 발신차수가 이상치인지 판단하는 단계는각 후보 스팸 메일 서버의 현재 시점 발신차수가 상기 이전 시점들의 발신차수들로부터 일정 거리 이상 떨어진이상치인지 판단하는, 동작 방법."}
{"patent_id": "10-2021-0118980", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제1항에서,공개특허 10-2023-0036295-3-상기 이상치 메일 서버가 탐지되면, 상기 이상치 메일 서버의 발신 플로우들을 기초로, 현재 시점에서 이상치메일 서버의 발신 플로우 수가 급등했는지 판단하는 단계를 더 포함하는 동작 방법."}
{"patent_id": "10-2021-0118980", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제1항에서,상기 이상치 메일 서버가 탐지되면, 상기 이상치 메일 서버의 발신 플로우들을 기초로, 기계학습 모델의 입력인플로우 특징들을 생성하는 단계, 그리고상기 기계학습 모델을 이용하여 상기 플로우 특징들에 대응하는 스팸 메일 서버 확률을 획득하는 단계를 더 포함하는 동작 방법."}
{"patent_id": "10-2021-0118980", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제7항에서,상기 플로우 특징들은상기 이상치 메일 서버의 발신차수가 기준값에서 벗어난 정도를 포함하는, 동작 방법."}
{"patent_id": "10-2021-0118980", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제7항에서,상기 플로우 특징들은상기 이상치 메일 서버의 발신 플로우 수 급등 여부, 그리고 상기 이상치 메일 서버의 발신 플로우 수가 임계치를 벗어난 정도 중 적어도 하나를 포함하는, 동작 방법."}
{"patent_id": "10-2021-0118980", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "적어도 하나의 프로세서에 의해 동작하는 스팸 메일 서버 탐지 장치의 동작 방법으로서,후보 스팸 메일 서버들 사이에서 전송되는 플로우들을 기초로, 각 후보 스팸 메일 서버의 발신차수(outdegree)를 계산하고, 상기 발신차수가 이상치인지 판단하는 단계, 상기 후보 스팸 메일 서버들 중에서, 상기 발신차수가 이상치에 해당하는 메일 서버를 이상치 메일 서버로 탐지하는 단계, 상기 이상치 메일 서버의 발신 플로우들을 기초로, 현재 시점에서 이상치 메일 서버의 발신 플로우 수가 급등했는지 판단하는 단계, 그리고상기 이상치 메일 서버의 발신차수 및 상기 이상치 메일 서버의 플로우 급등 여부를 기초로 생성된 플로우 특징들을 기초로, 상기 이상치 메일 서버의 스팸 메일 서버 확률을 획득하는 단계를 포함하는 동작 방법."}
{"patent_id": "10-2021-0118980", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "제10항에서,상기 플로우 특징들은상기 이상치 메일 서버의 발신차수가 기준값에서 벗어난 정도, 상기 이상치 메일 서버의 발신 플로우 수 급등여부, 그리고 상기 이상치 메일 서버의 발신 플로우 수가 임계치를 벗어난 정도를 포함하는, 동작 방법."}
{"patent_id": "10-2021-0118980", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제11항에서,상기 스팸 메일 서버 확률을 획득하는 단계는공개특허 10-2023-0036295-4-스팸 메일 서버 여부가 레이블링된 복수의 플로우 특징들을 이용하여 스팸서버 확률을 예측하도록 지도 학습된기계학습 모델을 이용하여, 상기 이상치 메일 서버의 스팸 메일 서버 확률을 획득하는, 동작 방법."}
{"patent_id": "10-2021-0118980", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "제10항에서,상기 발신차수는 각 후보 스팸 메일 서버가 출발지인 플로우들의 목적지 메일 서버 수로 계산되는, 동작 방법."}
{"patent_id": "10-2021-0118980", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_14", "content": "제10항에서,상기 발신차수가 이상치인지 판단하는 단계는각 후보 스팸 메일 서버의 현재 시점 발신차수가 이전 시점들의 발신차수들로부터 일정 거리 이상 떨어진 이상치인지 판단하는, 동작 방법."}
{"patent_id": "10-2021-0118980", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_15", "content": "제10항에서,메일 서버들 간에 전송되는 플로우들의 출발지와 목적지를 기초로 메일 서버 연결 그래프를 생성하는 단계,상기 메일 서버 연결 그래프를 기초로 상기 메일 서버들 사이의 연결 관계를 반영한 각 메일 서버의 신뢰 점수를 평가하는 단계, 그리고상기 메일 서버 연결 그래프에서, 기준 이하의 신뢰 점수를 가진 상기 후보 스팸 메일 서버들을 추출하는 단계를 더 포함하는, 동작 방법."}
{"patent_id": "10-2021-0118980", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_16", "content": "적어도 하나의 프로세서에 의해 동작하는 스팸 메일 서버 탐지 장치로서,후보 스팸 메일 서버들 사이에서 전송되는 플로우들을 기초로, 출발지 후보 스팸 메일 서버에서 플로우로 연결되는 목적지 메일 서버 수가 이상치(outlier)인지 판단하고, 상기 후보 스팸 메일 서버들 중에서, 상기 이상치를 가진 메일 서버를 이상치 메일 서버로 탐지하는 이상치 판단부,상기 이상치 판단부에서 상기 이상치 메일 서버가 탐지되면, 상기 이상치 메일 서버의 발신 플로우들을 기초로,현재 시점에서 이상치 메일 서버의 발신 플로우 수가 급등했는지 판단하는 플로우 급등 탐지부, 상기 이상치 판단부에서 상기 이상치 메일 서버가 탐지되면, 상기 이상치 메일 서버의 발신 플로우들을 기초로플로우 특징들을 생성하고, 기계학습 모델을 이용하여 상기 플로우 특징들에 대응하는 스팸 메일 서버 확률을획득하는 스팸 메일 서버 확률 예측부, 그리고상기 이상치 메일 서버의 탐지 결과, 상기 이상치 메일 서버의 플로우 급등 여부, 그리고 상기 이상치 메일 서버의 스팸 메일 서버 확률을 포함하는 탐지 결과를 제공하는 탐지 결과 출력부를 포함하는 스팸 메일 서버 탐지 장치."}
{"patent_id": "10-2021-0118980", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_17", "content": "제16항에서,상기 이상치 판단부는상기 이상치 메일 서버의 식별 정보, 탐지 시각, 상기 이상치 메일 서버에서 발신된 플로우 정보를 포함하는 상기 탐지 결과를 상기 탐지 결과 출력부로 제공하는, 스팸 메일 서버 탐지 장치."}
{"patent_id": "10-2021-0118980", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_18", "content": "제16항에서,공개특허 10-2023-0036295-5-상기 플로우 급등 탐지부는상기 이상치 메일 서버의 발신 플로우들을 일정 시간 간격으로 그룹핑하고, 시간 그룹별 플로우 수 변화를 기초로 상기 현재 시점에서 플로우 급등 여부를 판단하는, 스팸 메일 서버 탐지 장치."}
{"patent_id": "10-2021-0118980", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_19", "content": "제16항에서,상기 기계학습 모델은스팸 메일 서버 여부가 레이블링된 복수의 플로우 특징들을 이용하여 스팸서버 확률을 예측하도록 지도 학습된모델인, 스팸 메일 서버 탐지 장치."}
{"patent_id": "10-2021-0118980", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_20", "content": "제16항에서,상기 플로우 특징들은상기 이상치 메일 서버의 목적지 메일 서버 수가 기준값에서 벗어난 정도, 상기 이상치 메일 서버의 발신 플로우 수 급등 여부, 그리고 상기 이상치 메일 서버의 발신 플로우 수가 임계치를 벗어난 정도를 포함하는, 스팸메일 서버 탐지 장치."}
{"patent_id": "10-2021-0118980", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "적어도 하나의 프로세서에 의해 동작하는 스팸 메일 서버 탐지 장치의 동작 방법으로서, 메일 서버들 간에 전송 되는 플로우들의 출발지와 목적지를 기초로 메일 서버 연결 그래프를 생성하는 단계, 상기 메일 서버 연결 그래 프를 기초로 상기 메일 서버들 사이의 연결 관계를 반영한 각 메일 서버의 신뢰 점수를 평가하는 단계, 상기 메 일 서버 연결 그래프에서, 신뢰 점수가 기준 이상인 메일 서버들 및 신뢰 점수가 기준 이상인 메일 서버들에 연 결된 간선들을 제거해서, 기준 이하의 신뢰 점수를 가진 후보 스팸 메일 서버들로 구성된 그래프를 생성하는 단 계, 상기 후보 스팸 메일 서버들로 구성된 그래프 기초로, 각 후보 스팸 메일 서버의 발신차수(outdegree)를 계 산하고, 상기 발신차수가 이상치인지 판단하는 단계, 그리고 상기 후보 스팸 메일 서버들 중에서, 상기 발신차수 가 이상치에 해당하는 메일 서버를 이상치 메일 서버로 탐지하는 단계를 포함한다."}
{"patent_id": "10-2021-0118980", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 개시는 스팸 메일 서버 탐지에 관한 것이다."}
{"patent_id": "10-2021-0118980", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "스팸(Spam) 메일은 다수의 수신자들에게 대량으로 보내는 메일로서, 메일 제목, 본문 그리고 첨부 파일 등의 메 일 내용을 기초로 스팸 메일을 탐지할 수 있다. 하지만, 메일 내용 기반 스팸 탐지 기술은 개인 정보 활용이 문 제될 수 있고 또한, 메일이나 패킷이 많아질수록 리소스가 많이 필요하므로 확장성(Scalability)을 제공하지 못 하는 문제가 있다. 이러한 문제를 해결하기 위해, 넷플로우(Netflow)를 기초로 스팸 메일 서버를 탐지하려는 연구가 있다. 네트워 크 트래픽을 기초로 네트워크 흐름(Flow)을 분석함으로써, 비정상 행동을 탐지할 수 있으므로, 네트워크 관리 및 보안에 사용될 수 있다. 한편, 라우터의 부하를 줄이기 위해 패킷을 샘플링해서 플로우를 분석하므로, 일부 플로우가 누락될 수 있는데, 종래 기술은 이러한 샘플링 레이트(sampling rate)을 고려하지 않아서, 샘플링 레이트에 의한 영향을 고려하지 않는다. 또한, 종래 기술은 일시적으로 발송량이 증가한 정상 메일 서버와 스팸 메일 서버를 구분하지 않아서, 운용자가 탐지 결과를 기초로 실제 스팸 메일 서버 여부를 파악하는데 시간이 걸린다."}
{"patent_id": "10-2021-0118980", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 개시는 플로우 데이터를 이용한 스팸 메일 서버 탐지 방법 및 장치에 관한 것이다. 본 개시는 플로우 데이터를 기초로 생성된 메일 서버 연결 그래프를 기초로 메일 서버들의 신뢰 점수를 평가하 고, 기준 이하의 신뢰 점수를 가진 후보 스팸 메일 서버들의 이상치 여부, 플로우 급등 여부, 그리고 스팸 메일 서버 확률을 기초로, 스팸 메일 서버를 탐지한다."}
{"patent_id": "10-2021-0118980", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "한 실시예에 따라 적어도 하나의 프로세서에 의해 동작하는 스팸 메일 서버 탐지 장치의 동작 방법으로서, 메일 서버들 간에 전송되는 플로우들의 출발지와 목적지를 기초로 메일 서버 연결 그래프를 생성하는 단계, 상기 메 일 서버 연결 그래프를 기초로 상기 메일 서버들 사이의 연결 관계를 반영한 각 메일 서버의 신뢰 점수를 평가 하는 단계, 상기 메일 서버 연결 그래프에서, 신뢰 점수가 기준 이상인 메일 서버들 및 신뢰 점수가 기준 이상 인 메일 서버들에 연결된 간선들을 제거해서, 기준 이하의 신뢰 점수를 가진 후보 스팸 메일 서버들로 구성된 그래프를 생성하는 단계, 상기 후보 스팸 메일 서버들로 구성된 그래프 기초로, 각 후보 스팸 메일 서버의 발신 차수(outdegree)를 계산하고, 상기 발신차수가 이상치인지 판단하는 단계, 그리고 상기 후보 스팸 메일 서버들 중에서, 상기 발신차수가 이상치에 해당하는 메일 서버를 이상치 메일 서버로 탐지하는 단계를 포함한다. 상기 각 메일 서버의 신뢰 점수를 평가하는 단계는 출발지 메일 서버가 높은 신뢰 점수를 가진 목적지 메일 서 버와 연결될수록 상기 출발지 메일 서버의 신뢰 점수를 높게 평가하는 알고리즘을 이용하여, 각 메일 서버의 신 뢰 점수를 평가할 수 있다. 상기 각 메일 서버의 신뢰 점수를 평가하는 단계는 샘플링 레이트에 따라 조정되는 댐핑 계수를 기초로, 상기 샘플링 레이트에 의해 수집이 누락된 플로우 영향을 보정하여, 각 메일 서버의 신뢰 점수를 평가할 수 있다. 상기 발신차수는 상기 후보 스팸 메일 서버로 구성된 그래프에서 각 후보 스팸 메일 서버가 출발지인 플로우들 의 목적지 메일 서버 수로 계산될 수 있다. 상기 발신차수가 이상치인지 판단하는 단계는 각 후보 스팸 메일 서버의 현재 시점 발신차수가 상기 이전 시점 들의 발신차수들로부터 일정 거리 이상 떨어진 이상치인지 판단할 수 있다. 상기 동작 방법은 상기 이상치 메일 서버가 탐지되면, 상기 이상치 메일 서버의 발신 플로우들을 기초로, 현재 시점에서 이상치 메일 서버의 발신 플로우 수가 급등했는지 판단하는 단계를 더 포함할 수 있다. 상기 동작 방법은 상기 이상치 메일 서버가 탐지되면, 상기 이상치 메일 서버의 발신 플로우들을 기초로, 기계 학습 모델의 입력인 플로우 특징들을 생성하는 단계, 그리고 상기 기계학습 모델을 이용하여 상기 플로우 특징 들에 대응하는 스팸 메일 서버 확률을 획득하는 단계를 더 포함할 수 있다. 상기 플로우 특징들은 상기 이상치 메일 서버의 발신차수가 기준값에서 벗어난 정도를 포함할 수 있다. 상기 플로우 특징들은 상기 이상치 메일 서버의 발신 플로우 수 급등 여부, 그리고 상기 이상치 메일 서버의 발 신 플로우 수가 임계치를 벗어난 정도 중 적어도 하나를 포함할 수 있다. 다른 실시예에 따라 적어도 하나의 프로세서에 의해 동작하는 스팸 메일 서버 탐지 장치의 동작 방법으로서, 후 보 스팸 메일 서버들 사이에서 전송되는 플로우들을 기초로, 각 후보 스팸 메일 서버의 발신차수(outdegree)를 계산하고, 상기 발신차수가 이상치인지 판단하는 단계, 상기 후보 스팸 메일 서버들 중에서, 상기 발신차수가 이상치에 해당하는 메일 서버를 이상치 메일 서버로 탐지하는 단계, 상기 이상치 메일 서버의 발신 플로우들을 기초로, 현재 시점에서 이상치 메일 서버의 발신 플로우 수가 급등했는지 판단하는 단계, 그리고 상기 이상치 메일 서버의 발신차수 및 상기 이상치 메일 서버의 플로우 급등 여부를 기초로 생성된 플로우 특징들을 기초로, 상기 이상치 메일 서버의 스팸 메일 서버 확률을 획득하는 단계를 포함한다. 상기 플로우 특징들은 상기 이상치 메일 서버의 발신차수가 기준값에서 벗어난 정도, 상기 이상치 메일 서버의 발신 플로우 수 급등 여부, 그리고 상기 이상치 메일 서버의 발신 플로우 수가 임계치를 벗어난 정도를 포함할 수 있다. 상기 스팸 메일 서버 확률을 획득하는 단계는 스팸 메일 서버 여부가 레이블링된 복수의 플로우 특징들을 이용 하여 스팸서버 확률을 예측하도록 지도 학습된 기계학습 모델을 이용하여, 상기 이상치 메일 서버의 스팸 메일 서버 확률을 획득할 수 있다. 상기 발신차수는 각 후보 스팸 메일 서버가 출발지인 플로우들의 목적지 메일 서버 수로 계산될 수 있다. 상기 발신차수가 이상치인지 판단하는 단계는 각 후보 스팸 메일 서버의 현재 시점 발신차수가 이전 시점들의 발신차수들로부터 일정 거리 이상 떨어진 이상치인지 판단할 수 있다. 상기 동작 방법은 메일 서버들 간에 전송되는 플로우들의 출발지와 목적지를 기초로 메일 서버 연결 그래프를 생성하는 단계, 상기 메일 서버 연결 그래프를 기초로 상기 메일 서버들 사이의 연결 관계를 반영한 각 메일 서 버의 신뢰 점수를 평가하는 단계, 그리고 상기 메일 서버 연결 그래프에서, 기준 이하의 신뢰 점수를 가진 상기 후보 스팸 메일 서버들을 추출하는 단계를 더 포함할 수 있다. 또 다른 실시예에 따라 적어도 하나의 프로세서에 의해 동작하는 스팸 메일 서버 탐지 장치로서, 후보 스팸 메 일 서버들 사이에서 전송되는 플로우들을 기초로, 출발지 후보 스팸 메일 서버에서 플로우로 연결되는 목적지 메일 서버 수가 이상치(outlier)인지 판단하고, 상기 후보 스팸 메일 서버들 중에서, 상기 이상치를 가진 메일 서버를 이상치 메일 서버로 탐지하는 이상치 판단부, 상기 이상치 판단부에서 상기 이상치 메일 서버가 탐지되 면, 상기 이상치 메일 서버의 발신 플로우들을 기초로, 현재 시점에서 이상치 메일 서버의 발신 플로우 수가 급 등했는지 판단하는 플로우 급등 탐지부, 상기 이상치 판단부에서 상기 이상치 메일 서버가 탐지되면, 상기 이상 치 메일 서버의 발신 플로우들을 기초로 플로우 특징들을 생성하고, 기계학습 모델을 이용하여 상기 플로우 특 징들에 대응하는 스팸 메일 서버 확률을 획득하는 스팸 메일 서버 확률 예측부, 그리고 상기 이상치 메일 서버 의 탐지 결과, 상기 이상치 메일 서버의 플로우 급등 여부, 그리고 상기 이상치 메일 서버의 스팸 메일 서버 확 률을 포함하는 탐지 결과를 제공하는 탐지 결과 출력부를 포함한다. 상기 이상치 판단부는 상기 이상치 메일 서버의 식별 정보, 탐지 시각, 상기 이상치 메일 서버에서 발신된 플로 우 정보를 포함하는 상기 탐지 결과를 상기 탐지 결과 출력부로 제공할 수 있다. 상기 플로우 급등 탐지부는 상기 이상치 메일 서버의 발신 플로우들을 일정 시간 간격으로 그룹핑하고, 시간 그 룹별 플로우 수 변화를 기초로 상기 현재 시점에서 플로우 급등 여부를 판단할 수 있다. 상기 기계학습 모델은 스팸 메일 서버 여부가 레이블링된 복수의 플로우 특징들을 이용하여 스팸서버 확률을 예 측하도록 지도 학습된 모델일 수 있다. 상기 플로우 특징들은 상기 이상치 메일 서버의 목적지 메일 서버 수가 기준값에서 벗어난 정도, 상기 이상치 메일 서버의 발신 플로우 수 급등 여부, 그리고 상기 이상치 메일 서버의 발신 플로우 수가 임계치를 벗어난 정 도를 포함할 수 있다."}
{"patent_id": "10-2021-0118980", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 개시에 따르면, 메일 서버 간에 전송되는 플로우들을 기초로 스팸 메일 서버를 탐지할 수 있다. 본 개시에 따르면, 메일 서버의 신뢰 점수를 기초로 후보 스팸 메일 서버를 분류할 수 있고, 패킷 샘플링 레이 트를 반영하여 메일 서버의 신뢰 점수를 계산하므로, 다양한 샘플링 레이트로 패킷을 수집하는 라우터 환경에 유연하게 적용할 수 있다. 본 개시에 따르면, 발신차수를 기초로 메일을 대량 발신한 이상치 메일 서버를 탐지할 수 있고, 이상치 메일 서 버의 발신 플로우 급등 여부, 스팸 메일 서버 확률 등을 기초로 이상치 메일 서버가 스팸 메일 서버인지 정확히 판단할 수 있다."}
{"patent_id": "10-2021-0118980", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "아래에서는 첨부한 도면을 참고로 하여 본 개시의 실시예에 대하여 본 개시가 속하는 기술 분야에서 통상의 지 식을 가진 자가 용이하게 실시할 수 있도록 상세히 설명한다. 그러나 본 개시는 여러 가지 상이한 형태로 구현 될 수 있으며 여기에서 설명하는 실시예에 한정되지 않는다. 그리고 도면에서 본 개시를 명확하게 설명하기 위 해서 설명과 관계없는 부분은 생략하였으며, 명세서 전체를 통하여 유사한 부분에 대해서는 유사한 도면 부호를 붙였다. 본 개시에서, 어떤 부분이 어떤 구성요소를 \"포함\"한다고 할 때, 이는 특별히 반대되는 기재가 없는 한 다른 구 성요소를 제외하는 것이 아니라 다른 구성요소를 더 포함할 수 있는 것을 의미한다. 네트워크를 구성하는 장치 들은 하드웨어나 소프트웨어 또는 하드웨어 및 소프트웨어의 결합으로 구현될 수 있다. 도 1은 실시예에 따른 스팸 메일 서버 탐지 장치를 설명하는 도면이고, 도 2는 실시예에 따른 발신차수 (outdegree)를 설명하는 도면이다. 도 1을 참고하면, 스팸 메일 서버 탐지 장치는 플로우 데이터 수집기를 통해, 메일 서버들(300-1, 300-2, …, 300-N) 간에 메일 전송 프로토콜로 전송되는 플로우들을 수집하고, 플로우 데이터를 기초로, 메일 서버들 중에서 스팸 메일 서버를 탐지한다. 이를 위해, 적어도 하나의 프로세서에 의해 동작하는 스팸 메일 서버 탐지 장치는 플로우 데이터 관리부 , 메일 서버 연결 그래프 생성부, 메일 서버 평가부, 이상치 판단부, 플로우 급등 탐지부 , 스팸 메일 서버 확률 예측부, 그리고 탐지 결과 출력부를 포함할 수 있다. 플로우 데이터 관리부는 플로우 데이터 수집기를 통해, 메일 서버들(300-1, 300-2, …, 300-N) 간에 메일 전송 프로토콜로 전송되는 플로우들을 수집하고, 플로우 데이터를 저장한다. 메일 전송 프로토콜은 간이 전자 우편 전송 프로토콜(Simple Mail Transfer Protocol, SMTP)일 수 있고, 플로우는 SMTP 플로우일 수 있다. SMTP에서 사용하는 TCP 포트번호는 25번이므로, 플로우 데이터 관리부는 목적지 포트번호가 25이고 프로토 콜이 TCP인 플로우들을 수집할 수 있다. 이때, 플로우 수집 시간이 짧으면 메일 서버 연결 그래프를 구성하는 서버 노드들이 충분히 추출되지 않으므로, 플로우 데이터 관리부는 메일 서버 연결 그래프 생성에 필요한 일정 시간 동안 플로우들을 수집할 수 있다. 플로우는 출발지에서 목적지로 전송되는 패킷 흐름으로서, 플로우 데이터는 출발지 IP 주소/포트, 목적지 IP 주 소/포트, 패킷 길이, 플로우 발생 시각 등을 포함할 수 있다. 메일 서버 연결 그래프 생성부는 플로우 데이터의 출발지와 목적지가 노드인 메일 서버 연결 그래프를 생 성한다. SMTP 플로우의 출발지와 목적지 각각은 임의의 메일 서버이므로, 메일 서버 연결 그래프는 메일 서버 노드 사이를 간선(edge)으로 연결한 그래프로 표현될 수 있다. 여기서 간선은 발신/수신의 방향성을 포함할 수 있다. 메일 서버 연결 그래프 생성부는 일정 주기(예를 들면, 일주일)로 메일 서버 연결 그래프를 갱신할 수 있다. 메일 서버 평가부는 메일 서버 연결 그래프를 기초로 메일 서버들의 신뢰 점수를 평가하고, 신뢰 점수가 기준 이상인 메일 서버들을 식별한다. 그리고, 메일 서버 평가부는 메일 서버 연결 그래프에서, 신뢰 점수 가 기준 이상인 메일 서버들 및 신뢰 점수가 기준 이상인 메일 서버들에 연결된 간선들을 제거해서, 기준 이하 의 신뢰 점수를 가진 후보 스팸 메일 서버들로 구성된 그래프를 생성한다. 후보 스팸 메일 서버들로 구성된 그 래프를 후보 스팸 메일 서버의 연결 그래프라고 부를 수 있다. 메일 서버 평가부는 메일 서버 노드 사이의 연결 관계를 반영한 신뢰 점수를 계산하는 데, 높은 신뢰 점수 를 가진 메일 서버와 연결되는 플로우가 많을수록 신뢰 점수를 높게 평가할 수 있다. 예를 들면, 메일 서버 평 가부는 수학식 1과 같이, 페이지랭크(PageRank, PR) 알고리즘 기반으로 각 메일 서버 Pi의 신뢰 점수 PR(Pi)를 계산할 수 있다. 수학식 1"}
{"patent_id": "10-2021-0118980", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "수학식 1에서, 는 댐핑 계수(damping factor)이고, d는 0과 1사이의 실수이고, N은 메일 서버 연결 그 래프에 포함된 모든 메일 서버의 수이다. Pi는 i번째 메일 서버이고, PR(Pi)는 i번째 메일 서버의 신뢰 점수이다. M(Pi)는 i번째 메일 서버 Pi에 도착한 플로우의 출발지 메일 서버들 Pj의 집합이다. L(Pj)는 메일 서 버 Pj에서 출발한 플로우의 목적지 메일 서버들의 수이다. 수학식 1을 참고하면, 높은 신뢰 점수를 가진 메일 서버는 다수의 메일 서버들로부터 플로우를 받았거나, 신뢰 점수가 높은 메일 서버로부터 플로우를 받았음을 의미한다. 반면 소수의 메일 서버나 신뢰 점수가 낮은 메일 서버로부터 플로우를 받는다면, 메일 서버의 신뢰 점수는 낮게 평가된다. 메일 서버 평가부는 메일 서버 연결 그래프에 포함된 메일 서버들의 평가 점수가 수렴할 때까지, 메일 서 버들의 평가 점수를 계산하고, 계산된 평가 점수를 이용하여 메일 서버들의 평가 점수를 재계산하는 절차를 반 복한다. 메일 서버 평가부는 댐핑 계수를 통해, 다른 메일 서버로부터 플로우를 수신하기만 한 메일 서버에게 일정 의 신뢰 점수를 부여할 수 있다. 또한, 메일 서버 평가부는 댐핑 계수를 통해, 플로우 데이터 수집기에서의 샘플링 레이트(sampling rate)의 영향을 보정할 수 있다. 플로우 데이터 수집기는 부하를 줄이기 위해 패킷을 샘플링해서 플로우를 수집하므로, 일부 플로우가 누락될 수 있다. 따라서, 샘플링 레이트에 따라 M(Pi) 및 L(Pj)가 적게 카운트될 수 있고, 결과적으로 각 메일 서버의 신뢰 점수가 낮게 측정되거나, 오류가 발생할 수 있다. 따라서 메일 서버 평 가부는 샘플링 레이트에 따라 댐핑 계수를 조정하여, 누락된 플로우에 의한 신뢰 점수를 보정할 수 있다. 수집되는 패킷 수가 적을 수록 댐핑 계수를 높게 설정할 수 있다. 예를 들어, 라우터가 설정된 one-out-of sampling-rate에 따라 패킷을 수집하는 경우, 샘플링 레이트가 크게 설정될수록 적은 패킷들이 샘플링되므로, 메일 서버 평가부는 샘플링 레이트의 영향을 댐핑 계수로 보정하여 신뢰 점수를 평가할 수 있다. 이상치 판단부는 메일 서버 평가부에서 추출된 후보 스팸 메일 서버들 각각의 발신차수(outdegree)를 계산한다. 일반적으로, 발신차수는 노드에서 다른 노드로 나가는 화살표의 수를 의미하는 데, 후보 스팸 메일 서버의 연결 그래프에서 각 후보 스팸 메일 서버가 출발지인 플로우들의 목적지 메일 서버 수를 의미한다. 도 2를 참고하면, 후보 스팸 메일 서버인 메일 서버#1, 메일 서버#2, 메일 서버#3, 메일 서버#4가 연결된 경우, 각 메일 서버의 발신차수는 표 1과 같이 계산된다. 각 출발지 메일 서버에서 플로우로 연결되는 목적지 메일 서 버 수가 그래프에서의 발신차수로 계산될 수 있다. 표 1 메일 서버 메일 서버#1 메일 서버#2 메일 서버#3 메일 서버#4 발신차수 3 1 1 0 이상치 판단부는 일정 주기(예를 들면, 일주일)로 각 후보 스팸 메일 서버의 발신차수를 계산하여, 데이터 베이스에 저장한다. 이상치 판단부는 최근 일정 기간 동안 저장된 후보 스팸 메일 서버의 발신차수 편차를 기초로, 탐지 시점의 발신차수가 이상치(outlier)인지 판단한다. 이상치 판단부는 저장된 발신차수를 통해 발신차수 중앙값 및 중앙값 절대 편차를 업데이트한다. 이상치 판단은 기준값으로부터 일정 거리 이상 떨어진 값인지 판단하는 다양한 통계 기법으로 계산될 수 있다. 예를 들면, 수학식 2와 같이, 중앙값 절대 편차(median absolute deviation MAD)가 거리 기준인 발신차수 편차 로 사용될 수 있다. 수학식 2"}
{"patent_id": "10-2021-0118980", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "수학식 2에서, x는 메일 서버의 발신차수이고, MAD(x)는 발신차수의 중앙값 절대 편차이고, n은 저장된 발신차 수의 수이며, median(x)는 발신차수의 중앙값이다. 탐지 시점의 발신차수가 이상치인지 판단하는 기준은 다양하게 정의될 수 있는데, 예를 들면, 수학식 3과 같이, 탐지 시점의 발신차수가 중앙값 median(x)에서 중앙값 절대 편차 MAD(x)의 t배 이상을 벗어나면, 이상치라고 정 의할 수 있다. 수학식 3에서, t는 3으로 설정될 수 있다. 수학식 3"}
{"patent_id": "10-2021-0118980", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "이렇게, 이상치 판단부는 후보 스팸 메일 서버들 중에서, 탐지 시점의 발신차수가 이상치에 해당하는 메일 서버, 예를 들면 메일 서버#1(300-1)를 이상치 메일 서버로 탐지한다. 이상치 판단부는 이상치 메일 서버의 탐지를 탐지 결과 출력부로 알린다. 이상치 판단부는 이상 치 메일 서버의 식별 정보(예를 들면, IP 주소), 탐지 시각, 이상치 메일 서버에서 발신된 플로우 정보(플로우 수, 목적지 메일 서버 등) 등의 탐지 결과를 탐지 결과 출력부로 제공할 수 있다. 또한, 이상치 판단부는 플로우 급등 탐지부와 스팸 메일 서버 확률 예측부로 이상치 메일 서버 의 탐지를 알리고, 플로우 급등 탐지부와 스팸 메일 서버 확률 예측부에서 필요한 정보를 제공할 수 있다. 발신차수를 기초로 메일을 대량 발신한 메일 서버인지 판단할 수 있는데, 이상치 메일 서버가 스팸 메일 서버인지, 일시적으로 발송량이 증가한 정상 메일 서버인지에 대해 정확히 판단할 필요가 있다. 따라서, 스팸 메일 서버 탐지 장치는 이상치 메일 서버의 플로우 급등 여부, 플로우 특징들로 예측된 스팸 메일 서버 확 률을 다각도로 확인할 수 있다. 플로우 급등 탐지부는 이상치 판단부에서 이상치 메일 서버가 탐지되면, 이상치 탐지 시점에서 발신 플로우가 급등했는지 판단한다. 플로우 급등 탐지부는 플로우 데이터 관리부로부터, 이상치 메일 서 버로 탐지된 메일 서버#1(300-1)의 시계열 데이터인 발신 플로우들을 가져온다. 즉, 플로우 급등 탐지부는 이상치 메일 서버의 IP 주소가 출발지 IP 주소인 플로우들을 가져올 수 있다. 플로우 급등 탐지부는 최근 메일 발송량 트렌드를 반영하기 위해 최근 일정 기간(예를 들면, 2주) 동안의 발신 플로우들을 추출할 수 있다. 플로우 급등 탐지부는 이상치 메일 서버의 발신 플로우들을 일정 시간 간격(예를 들면, N분 간격)으로 그 룹핑하고, 시간 그룹별 플로우 수를 계산한다. 플로우 급등 탐지부는 시간 그룹별 플로우 수 변화를 기초 로 이상치 탐지 시점에서 플로우가 급등했는지 판단할 수 있다. 플로우 급등 여부를 판단하는 알고리즘은 변화 지점 감지(Change point detection) 알고리즘이 사용될 수 있고, 예를 들면, 수학식 4와 같이, 누적합을 이용하여 변화를 감지하는 CUSUM(cumulative sum) 알고리즘이 사용될 수 있다. [수학식 4] If g+[t]>threshold, alarm and g+[t]=0 g+[t]=max(g+[t-1] + s[t] - drift, 0) s[t]=flow[t] - flow[t-1] 수학식 4에서, g+[t]는 t 시점의 플로우 급등 지표이고, g+[t]가 임계값(threshold) 이상인 경우, t 시점에서 플로우 급등 탐지 알람이 발생할 수 있다. flow[t]는 t 시점의 플로우 수이고, s[t]는 t 시점과 직전 시점인 t- 1 시점 사이의 플로우 수 차이이며, drift는 조정값이다. drift와 임계값을 높게 설정하면, 플로우 급등 여부의 오탐을 줄일 수 있지만, 플로우 급등 여부를 탐지하지 못할 수 있다. drift는 예를 들면, 플로우 수 평균값의 절반으로 설정될 수 있다. 임계값은 “플로우 수 중앙값+k*중앙값 절대 편차”로 설정될 수 있다. 스팸 메일 서버 확률 예측부는 복수의 플로우 특징들(features)을 기초로 스팸서버 확률을 예측하도록 학 습된 기계학습 모델을 이용하여, 이상치 메일 서버의 스팸 메일 서버 확률을 출력한다. 이를 위해, 스팸 메일 서버 확률 예측부는 플로우 데이터 관리부에서 가져온 이상치 메일 서버의 발신 플로우들을 기초로 플로우 특징을 생성할 수 있고, 이상치 판단부와 플로우 급등 탐지부에서 출력된 결과를 이용하여 플 로우 특징을 생성할 수 있다. 예를 들면, 복수의 플로우 특징들은 표 2와 같이 정의될 수 있고, 이외에도 다양 한 플로우 특징들이 사용될 수 있다. 탐지 시점은 이상치 메일 서버로 탐지된 시점이거나, 스팸 메일 서버 확률 예측부가 확률을 예측하는 기준 시점일 수 있다.표 2 플로우 특징 설명 최초 발신과의시간 차이- time_delta - 탐지 시점과 플로우 데이터 관리부에 저장된 최초 발신 플로우의 시간 차이 - 단위: 초 발신차수 거리 - distance_MAD- 탐지 시점의 발신차수가 기준값에서 벗어난 정도 - 단위: 배 플로우 급등 여부 - is_abrupt_change- 탐지 시점에서의 발신 플로우 수 급등 여부 - 단위: True/False 플로우 급등 거리 - distance_abrupt_change- 탐지 시점의 발신 플로우 수가 임계치에서 벗어난 정도 - 단위: 배 목적지별 패킷 길이 분포- distribution- 목적지별 패킷 길이 편차 표 2를 참고하면, 최초 발신과의 시간 차이는 탐지 시점과 플로우 데이터 관리부에 저장된 최초 발신 플로우의 시간 차이로서, 최초 발신 플로우의 발신이 탐지 시점에 가까울수록 이상치 메일 서버가 스팸 메일 서버일 가능 성이 높을 수 있다. 발신차수 거리는 탐지 시점의 발신차수가 기준값에서 벗어난 정도로서, 이상치 판단부에서 계산한 이상치 메일 서버의 발신차수가 중앙값에서 벗어난 정보를 나타낼 수 있다. 예를 들면, 이상치 메일 서버의 발신차수가 10이고, 중앙값이 5라면, 발신차수 거리는 2(=10/5)로 표시될 수 있다. 발신차수 거리가 멀수록 이상치 메일 서 버가 스팸 메일 서버일 가능성이 높을 수 있다. 플로우 급등 여부는 탐지 시점에서의 발신 플로우 급등 여부로서, 플로우 급등 탐지부의 탐지 결과가 사용 될 수 있고, 급등인 경우 True, 그렇지 않은 경우 False로 표시될 수 있다. 플로우 급등일수록 이상치 메일 서 버가 스팸 메일 서버일 가능성이 높을 수 있다. 플로우 급등 거리는 탐지 시점의 발신 플로우 수가 임계치에서 벗어난 정도로서, 플로우 급등 탐지부의 탐 지 결과가 사용될 수 있다. 예를 들면, 이상치 메일 서버의 플로우 급증 지표 g+[t]가 200이고, 임계값이 20이 라면, 플로우 급등 거리는 10(=200/20)으로 표시될 수 있다. 플로우 급등 거리가 멀수록 이상치 메일 서버가 스 팸 메일 서버일 가능성이 높을 수 있다. 목적지별 패킷 길이 분포는 목적지별 패킷 길이 편차로서, 스팸 메일는 동일한 이메일을 다수의 목적지 메일 서 버로 발신하므로, 편차가 적을수록 이상치 메일 서버가 스팸 메일 서버일 가능성이 높을 수 있다. 목적지별 패 킷 길이 분포는 발신 플로우들을 목적지로 그룹핑하고, 그룹별 패킷 길이 합의 편차를 계산할 수 있다. 기계학습 모델은 스팸 메일 서버 여부가 레이블링된 복수의 플로우 특징들을 이용하여 스팸서버 확률을 예측하 도록 지도 학습할 수 있다. 기계학습 모델은 Random forest, XGBoost, Logistic regression 알고리즘 등과 같 이 다양한 예측 모델들 중에서 선택될 수 있다. 기계학습 모델은 별도의 장치에 의해 학습된 후, 스팸 메일 서 버 확률 예측부에 탑재될 수 있고, 또는 스팸 메일 서버 확률 예측부에 의해 학습된 후 사용될 수 있 다. 한편, 스팸 메일 서버 확률 예측부는 이상치 메일 서버의 스팸 메일 서버 여부를 사용자에 의해 입력받는 경우, 이상치 메일 서버의 플로우 특징들에 스팸 메일 서버 여부를 레이블링하여, 학습데이터로 저장할 수 있다. 이후 저장된 학습데이터는 기계학습 모델의 재학습에 사용되거나, 새로운 기계학습 모델의 학습에 사용될 수 있다. 탐지 결과 출력부는 이상치 판단부로부터 이상치 메일 서버의 탐지 결과를 수신한다. 탐지 결과는 이 상치 메일 서버의 식별 정보(예를 들면, IP 주소), 탐지 시각, 이상치 메일 서버에서 발신된 플로우 정보(플로 우 수, 목적지 메일 서버 등) 등을 포함할 수 있다. 탐지 결과 출력부는 플로우 급등 탐지부로부터 이상치 메일 서버의 플로우 급등 여부를 수신할 수 있 다. 탐지 결과 출력부는 스팸 메일 서버 확률 예측부로부터 이상치 메일 서버의 스팸 메일 서버 확률을 수신할 수 있다. 탐지 결과 출력부는 스팸 메일 서버 확률 예측부로부터 이상치 메일 서버의 스팸 메 일 서버 확률 예측에 사용된 플로우 특징들을 수신할 수 있다. 탐지 결과 출력부는 이상치 메일 서버의 탐지 결과, 플로우 급등 여부, 스팸 메일 서버 확률을 비롯하여 이상치 메일 서버에 관련된 다양한 정보를 화면에 표시할 수 있다. 탐지 결과 출력부는 이상치 메일 서버 의 탐지 결과에 따라 이상치 메일 서버를 등급화(예를 들면, minor, major, critical)할 수 있고, 사용자가 원 하는 탐지 이벤트만 확인할 수 있도록 이상치 메일 서버에 관련된 각종 결과에 대한 필터링 조건을 설정할 수 있다. 예를 들어, 탐지 결과 출력부는 플로우 급등이고 스팸 메일 서버 확률이 0.8 이상일 경우, 이상치 메일 서버를 Major로 지정하고, 외부 평판 서비스에 등록된 IP 주소인 경우 Critical로 지정할 수 있다. 또한, 탐지 결과 출력부는 사용자로부터 입력을 받을 수 있은 인터페이스 화면을 제공하고, 이를 통해 플 로우 데이터 관리부, 메일 서버 연결 그래프 생성부, 메일 서버 평가부, 이상치 판단부, 플로우 급등 탐지부, 스팸 메일 서버 확률 예측부로부터 사용자 요청된 정보를 획득할 수 있고, 스팸 메일 서버 탐지 장치에서 필요한 각종 설정을 할 수 있다. 도 3과 도 4 각각은 실시예에 따른 스팸 메일 서버 탐지 방법의 흐름도이다. 도 3을 참고하면, 스팸 메일 서버 탐지 장치는 메일 서버들(300-1, 300-2, …, 300-N) 간에 메일 전송 프 로토콜로 전송되는 플로우들을 수집한다(S110). 스팸 메일 서버 탐지 장치는 일정 기간동안 수집한 플로우들을 기초로, 플로우 데이터의 출발지와 목적지 가 노드인 메일 서버 연결 그래프를 생성한다(S120). 스팸 메일 서버 탐지 장치는 메일 서버 연결 그래프를 기초로 메일 서버들의 신뢰 점수를 평가한다(S130). 스팸 메일 서버 탐지 장치는 메일 서버들 사이의 연결 관계를 반영한 신뢰 점수를 계산하는 데, 높은 신뢰 점수를 가진 메일 서버와 연결되는 플로우가 많을수록 신뢰 점수를 높게 평가할 수 있다. 스팸 메일 서버 탐지 장치는 메일 서버 연결 그래프에 포함된 메일 서버들의 평가 점수가 수렴할 때까지, 메일 서버들의 평가 점수를 계산하고, 계산된 평가 점수를 이용하여 메일 서버들의 평가 점수를 재계산하는 절차를 반복한다. 스팸 메일 서버 탐지 장치는 수학식 1과 같이, 페이지랭크 알고리즘 기반으로 각 메일 서버의 신뢰 점수를 계산 할 수 있다. 스팸 메일 서버 탐지 장치는 메일 서버의 신뢰 점수를 계산할 때, 댐핑 계수를 설정하여, 패 킷 샘플링 레이트에 의해 수집이 누락된 플로우 영향을 보정할 수 있다. 스팸 메일 서버 탐지 장치는 메일 서버 연결 그래프에서, 신뢰 점수가 기준 이상인 메일 서버들 및 신뢰 점수가 기준 이상인 메일 서버들에 연결된 간선들을 제거해서, 기준 이하의 신뢰 점수를 가진 후보 스팸 메일 서버들로 구성된 그래프를 생성한다(S132). 스팸 메일 서버 탐지 장치는 후보 스팸 메일 서버들로 구성된 그래프 기초로, 각 후보 스팸 메일 서버의 현재 시점 발신차수를 계산한다(S140). 현재 시점의 발신차수는 저장되고, 이를 통해 발신차수 중앙값 및 중앙 값 절대 편차가 업데이트된다. 스팸 메일 서버 탐지 장치는 각 후보 스팸 메일 서버의 이전 시점들의 발신차수들과 비교하여, 해당 후보 스팸 메일 서버의 현재 시점 발신차수가 이상치(outlier)인지 판단한다(S142). 이상치 판단은 기준값으로부터 일정 거리 이상 떨어진 값인지 판단하는 다양한 통계 기법으로 계산될 수 있는데, 예를 들면, 수학식 2와 같이, 중앙값과 중앙값 절대 편차(median absolute deviation MAD)로 계산될 수 있다. 스팸 메일 서버 탐지 장치는 후보 스팸 메일 서버들 중에서, 현재 시점의 발신차수가 이상치에 해당하는 메일 서버를 이상치 메일 서버로 탐지한다(S144). 도 4를 참고하면, 스팸 메일 서버 탐지 장치는 후보 스팸 메일 서버들 사이에서 전송되는 플로우들을 기초 로, 각 후보 스팸 메일 서버의 발신차수(outdegree)를 계산하고, 발신차수가 이상치(outlier)인지 판단한다 (S210). 스팸 메일 서버 탐지 장치는 후보 스팸 메일 서버들 중에서, 현재 시점의 발신차수가 이상치에 해당하는 메일 서버를 이상치 메일 서버로 탐지한다(S212). 스팸 메일 서버 탐지 장치는 이상치 메일 서버의 발신 플로우들을 기초로, 현재 시점에서 이상치 메일 서 버의 발신 플로우가 급등했는지 판단한다(S220). 스팸 메일 서버 탐지 장치는 이상치 메일 서버의 발신 플 로우들을 일정 시간 간격(예를 들면, N분 간격)으로 그룹핑하고, 시간 그룹별 플로우 수를 계산한다. 스팸 메일서버 탐지 장치는 시간 그룹별 플로우 수 변화를 기초로 이상치 탐지 시점에서 플로우가 급등했는지 판단 할 수 있다. 플로우 급등 여부는 수학식 3과 같이, 누적합을 이용하여 변화를 감지하는 CUSUM(cumulative sum) 알고리즘으로 판단될 수 있다. 스팸 메일 서버 탐지 장치는 이상치 메일 서버의 발신 플로우들을 기초로, 기계학습 모델의 입력인 플로우 특징들을 생성한다(S230). 복수의 플로우 특징들은 표 2와 같이 정의될 수 있고, 이외에도 다양한 플로우 특징 들이 사용될 수 있다. 스팸 메일 서버 탐지 장치는 기계학습 모델을 이용하여 플로우 특징들에 대응하는 스팸 메일 서버 확률을 획득한다(S232). 기계학습 모델은 입력된 플로우 특징들을 기초로 스팸서버 확률을 예측하도록 학습된 인공지능 모델이다. 스팸 메일 서버 탐지 장치는 이상치 메일 서버의 탐지 결과, 플로우 급등 여부, 스팸 메일 서버 확률을 포 함하는 탐지 결과를 제공한다(S240). 도 5는 한 실시예에 따른 스팸 메일 서버 탐지 장치 하드웨어 구성도이다. 도 5를 참고하면, 스팸 메일 서버 탐지 장치는 적어도 하나의 프로세서, 메모리, 저장 장치 , 네트워크 인터페이스를 포함할 수 있고, 버스를 통해 연결될 수 있다. 이외에도 입력 장치 및 출력 장치 등의 하드웨어가 포함될 수 있다. 스팸 메일 서버 탐지 장치에 구현된 플로우 데이터 관리부, 메일 서버 연결 그래프 생성부, 메일 서버 평가부, 이상치 판단부, 플로우 급등 탐지부, 스팸 메일 서버 확률 예측부, 그리고 탐지 결과 출력부는 기능에 따라 하드웨어 분리되어 구현될 수 있고, 통합적으로 구현될 수 있다. 프로세서는 스팸 메일 서버 탐지 장치의 동작을 제어하는 장치로서, 컴퓨터 프로그램에 포함된 명령 들을 처리하는 다양한 형태의 프로세서일 수 있고, 예를 들면, CPU(Central Processing Unit), MPU(Micro Processor Unit), MCU(Micro Controller Unit), GPU(Graphic Processing Unit) 등 일 수 있다. 또한, 프로세서 는 위에서 설명한 방법을 실행하기 위한 컴퓨터 프로그램에 대한 연산을 수행할 수 있다. 메모리는 각종 데이터, 명령 및/또는 정보를 저장한다. 메모리는 본 개시의 동작을 실행하도록 기술 된 명령어들이 프로세서에 의해 처리되도록 해당 컴퓨터 프로그램을 저장 장치로부터 로드할 수 있다. 메모리는 예를 들면, ROM(read only memory), RAM(random access memory) 등 일 수 있다. 저장 장치는 본 개시의 동작을 실행하는데 요구되는 각종 데이터, 컴퓨터 프로그램 등을 저장할 수 있다. 저장 장치는 컴퓨터 프로그램을 비임시적으로 저장할 수 있다. 저장 장치는 비휘발성 메모리로 구현 될 수 있다. 네트워크 인터페이스는 유/무선 통신 모듈일 수 있다. 스팸 메일 서버 탐지 장치는 운영 체제를 비롯한 각종 소프트웨어, 컴퓨터 프로그램들을 탑재하고, 이를 실행할 수 있다. 이와 같이, 본 개시에 따르면, 메일 서버 간에 전송되는 플로우들을 기초로 스팸 메일 서버를 탐지할 수 있다. 본 개시에 따르면, 메일 서버의 신뢰 점수를 기초로 후보 스팸 메일 서버를 분류할 수 있고, 패킷 샘플링 레이 트를 반영하여 메일 서버의 신뢰 점수를 계산하므로, 다양한 샘플링 레이트로 플로우를 수집하는 라우터 환경에 유연하게 적용할 수 있다. 본 개시에 따르면, 발신차수를 기초로 메일을 대량 발신한 이상치 메일 서버를 탐지할 수 있고, 이상치 메일 서 버의 발신 플로우 급등 여부, 스팸 메일 서버 확률 등을 기초로 이상치 메일 서버가 스팸 메일 서버인지 정확히 판단할 수 있다. 이상에서 설명한 본 개시의 실시예는 장치 및 방법을 통해서만 구현이 되는 것은 아니며, 본 개시의 실시예의 구성에 대응하는 기능을 실현하는 프로그램 또는 그 프로그램이 기록된 기록 매체를 통해 구현될 수도 있다. 이상에서 본 개시의 실시예에 대하여 상세하게 설명하였지만 본 개시의 권리범위는 이에 한정되는 것은 아니고 다음의 청구범위에서 정의하고 있는 본 개시의 기본 개념을 이용한 당업자의 여러 변형 및 개량 형태 또한 본 개시의 권리범위에 속하는 것이다.도면 도면1 도면2 도면3 도면4 도면5"}
{"patent_id": "10-2021-0118980", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 실시예에 따른 스팸 메일 서버 탐지 장치를 설명하는 도면이다. 도 2는 실시예에 따른 발신차수(outdegree)를 설명하는 도면이다. 도 3과 도 4 각각은 실시예에 따른 스팸 메일 서버 탐지 방법의 흐름도이다. 도 5는 한 실시예에 따른 스팸 메일 서버 탐지 장치 하드웨어 구성도이다."}
