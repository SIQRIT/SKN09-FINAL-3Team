{"patent_id": "10-2022-0013092", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2023-0116315", "출원번호": "10-2022-0013092", "발명의 명칭": "인공지능 기반의 뇌병변 검출 방법 및 인공지능 기반의 뇌병변 검출 장치", "출원인": "주식회사 휴런", "발명자": "송지우"}}
{"patent_id": "10-2022-0013092", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "뇌를 촬영한 뇌영상을 획득하는 단계;제1 신경망 모델을 이용하여 상기 뇌영상으로부터 병변 영역을 포함한 정보를 획득하는 단계;제2 신경망 모델을 이용하여 상기 뇌영상으로부터 혈관 영역을 포함한 정보를 획득하는 단계;상기 병변 영역과 상기 혈관 영역이 결합된 결합 영상을 생성하는 단계; 및상기 결합 영상을 기초로 상기 뇌영상을 뇌병변 영상으로 분류하는 단계;를 포함하는, 인공지능 기반의 뇌병변 검출 방법."}
{"patent_id": "10-2022-0013092", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제 1항에 있어서,상기 제1 신경망 모델 및 상기 제2 신경망 모델 중 적어도 하나는 3D CNN(Convolution Neural Networks)을 이용한 학습용 뇌영상의 학습을 통해 획득되는,인공지능 기반의 뇌병변 검출 방법."}
{"patent_id": "10-2022-0013092", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제 2항에 있어서,상기 3D CNN은 복수의 3D 컨볼루션 층에 기반해 상기 학습용 뇌영상에 대한 인코딩을 수행하기 위한인코더블록, 복수의 3D 디컨볼루션 층에 기반해 디코딩을 수행하기 위한 디코더블록, 및 상기 인코더블록과 상기 디코더블록 사이에 배치되어 상기 학습용 뇌영상에 대한 상황 정보를 통합 적용하기 위한 통합적응블록을 포함하는,인공지능 기반의 뇌병변 검출 방법."}
{"patent_id": "10-2022-0013092", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제 3항에 있어서, 상기 통합적응블록은 상기 인코더블록의 출력값인 인코딩된 학습용 뇌영상을 입력받아 컨볼루션을 수행하여 출력한 영상에 상기 인코딩된 학습용 뇌영상을 적용한 결과 영상을 출력하기 위한 잔여블록 및 상기 결과 영상을입력받아 상기 학습용 뇌영상에 대한 상황 정보를 통합 적용하기 위한 이중처리블록을 포함하는,인공지능 기반의 뇌병변 검출 방법."}
{"patent_id": "10-2022-0013092", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제 4항에 있어서, 상기 이중처리블록은 상기 결과 영상 내 국소 위치의 피쳐들을 선택적으로 집계하기 위한 공간적용모듈과 상기피쳐들에 상기 상황 정보를 통합 적용하기 위한 채널적용모듈을 포함하는,공개특허 10-2023-0116315-3-인공지능 기반의 뇌병변 검출 방법."}
{"patent_id": "10-2022-0013092", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제 5항에 있어서, 상기 이중처리블록의 출력값은 디컨볼루셔널 층에 적용되어 업샘플링이 수행되는, 인공지능 기반의 뇌병변 검출 방법."}
{"patent_id": "10-2022-0013092", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제 1항에 있어서,상기 뇌영상은 MRA(Magnetic Resonance Angiography) 및 CTA(Computed Tomography Angiography) 중 적어도 하나를 포함하는, 인공지능 기반의 뇌병변 검출 방법."}
{"patent_id": "10-2022-0013092", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제 7항에 있어서,상기 뇌영상이 상기 CTA(Computed Tomography Angiography)에 해당하는 지 여부를 판단하는 단계; 및 상기 CTA에 해당하는 것으로 판단하는 경우, 응급 상황임을 나타내는 메시지를 출력하는 단계;를 더 포함하는,인공지능 기반의 뇌병변 검출 방법."}
{"patent_id": "10-2022-0013092", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제 1항에 있어서,상기 분류 단계는,상기 결합 영상의 상기 병변 영역에 포함된 복셀에 소정의 가중치를 부여하는 단계; 및 상기 가중치 부여 결과를 기초로 상기 뇌영상을 상기 뇌병변 영상으로 분류하는 단계;를 포함하는, 인공지능 기반의 뇌병변 검출 방법."}
{"patent_id": "10-2022-0013092", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제 1항에 있어서, 상기 병변 영역을 포함한 정보는 병변 좌표, 병변 크기, 병변 부피, 검출 확률, 및 뇌동맥류 유무 중 적어도 하나를 포함하는,인공지능 기반의 뇌병변 검출 방법."}
{"patent_id": "10-2022-0013092", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "제 1항에 있어서,상기 혈관 영역을 포함한 정보는 혈관 좌표, 혈관의 중심선, 중심선의 특징, 혈관 단면, 혈관 줄기, 혈관벽, 및공개특허 10-2023-0116315-4-분기점 정보 중 적어도 하나를 포함하는,인공지능 기반의 뇌병변 검출 방법."}
{"patent_id": "10-2022-0013092", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "프로세서; 및 상기 프로세서에 의해 실행 가능한 명령어들을 저장하는 메모리;를 포함하고,상기 프로세서는,상기 명령어들을 실행함으로써,뇌를 촬영한 뇌영상을 획득하고, 제1 신경망 모델을 이용하여 상기 뇌영상으로부터 병변 영역을 포함한 정보를획득하고, 제2 신경망 모델을 이용하여 상기 뇌영상으로부터 혈관 영역을 포함한 정보를 획득하며, 상기 병변영역과 상기 혈관 영역이 결합된 결합 영상을 생성하고, 상기 결합 영상을 기초로 상기 뇌영상을 뇌병변 영상으로 분류하는,인공지능 기반의 뇌병변 검출 장치."}
{"patent_id": "10-2022-0013092", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "제 12항에 있어서, 상기 프로세서는, 3D CNN(Convolution Neural Networks)을 이용한 학습용 뇌영상의 학습을 통해 상기 제1 신경망 모델 및 상기제2 신경망 모델 중 적어도 하나를 획득하는, 인공지능 기반의 뇌병변 검출 장치."}
{"patent_id": "10-2022-0013092", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_14", "content": "제 13항에 있어서, 상기 프로세서는, 상기 학습용 뇌영상을 상기 3D CNN의 인코더블록에 입력시켜 상기 학습용 뇌영상에 대한 인코딩을 수행하고, 상기 인코딩된 뇌영상을 상기 3D CNN의 통합적응블록에 입력시켜 상기 인코딩된 뇌영상에 대한 상황 정보가 통합적용된 영상을 출력하고, 상기 상황 정보가 통합 적용된 영상을 상기 3D CNN의 디코더블록에 입력시켜 디코딩을수행함으로써 상기 학습을 수행하는,인공지능 기반의 뇌병변 검출 장치."}
{"patent_id": "10-2022-0013092", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "실시예에 따른 인공지능 기반의 뇌병변 검출 방법은, 뇌를 촬영한 뇌영상을 획득하는 단계, 제1 신경망 모델을 이용하여 상기 뇌영상으로부터 병변 영역을 포함한 정보를 획득하는 단계, 제2 신경망 모델을 이용하여 상기 뇌 영상으로부터 혈관 영역을 포함한 정보를 획득하는 단계, 상기 병변 영역과 상기 혈관 영역이 결합된 결합 영상 을 생성하는 단계 및 상기 결합 영상을 기초로 상기 뇌영상을 뇌병변 영상으로 분류하는 단계를 포함할 수 있다."}
{"patent_id": "10-2022-0013092", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 인공지능 기반의 뇌병변 검출 방법 및 인공지능 기반의 뇌병변 검출 장치에 관한 것으로, 보다 구체 적으로 동일 뇌영상을 이용하여 병변 영역과 혈관 영역을 각각 획득하고, 획득된 각 병변 영역이 결합된 결합 영상을 이용하여 뇌병변을 판독할 수 있도록 함으로써, 뇌병변 검출의 정밀도를 보다 향상시키고자 하는, 인공 지능 기반의 뇌병변 검출 방법 및 인공지능 기반의 뇌병변 검출 장치에 관한 것이다."}
{"patent_id": "10-2022-0013092", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "뇌질환, 즉 뇌혈관 질환은 뇌혈관이 터지는 뇌출혈, 뇌혈관이 혈전 등에 의해 막히는 뇌경색, 뇌혈관이 비정상 적으로 부풀어 오르는 뇌동맥류 등이 있고, 뇌출혈과 뇌경색을 아울러서 '뇌졸중'이라 한다. 이와 같은 뇌질환을 진단하기 위해, 초음파진단, 뇌 CT, 뇌 MRI (Magnetic Resonance Imaging)와 같은 비침습 적 기법들이 이용되고 있다. 초음파진단 방법은 경동맥 초음파진단으로 경동맥의 죽상 동맥경화증성 병변을 비침습적으로 쉽게 진단 가능하 다. 또한, 경두개 도플러 검사 (transcranial Doppler)로 두개강 내의 뇌혈류를 측정하여 임상에 응용한다. 뇌 CT를 이용하는 진단 방법은 출혈성 질환 진단에 좋으며 최근에 발달된 기술로 뇌 혈류상태, 뇌혈관 촬영을 하여 뇌졸중 환자 치료(특히, 허혈성 환자 치료)에 큰 도움이 된다. 뇌 MRI를 이용하는 진단 방법은 뇌 CT에 비하여 두개골에 의한 인공음영 영향이 없어서 뇌간, 소뇌, 측두엽 부 위의 병소를 소상히 진단할 수 있고, 뇌경색의 조기 발견, 뇌관류 상태의 미세진단이 가능하다. 특히, 뇌졸중(Stroke)은 뇌에 혈액을 공급하는 혈관이 막히거나 파열되어 뇌 손상이 오고, 이에 따른 신체장애 를 발생시키는 질환으로서, 전세계적으로 가장 중요한 사망 원인이며, 사망에 이르지 않더라도 영구적 장애를 일으키는 고위험성 질환으로 분류된다. 종래에 뇌졸중은 주로 노인 질환으로 인식되었으나, 최근에는 30, 40대에서도 뇌졸중이 흔히 발병함에 따라, 노 년뿐만 아니라, 청장년에게도 광범위하게 발생하는 매우 위험한 질환으로 인식되고 있다. 한편, 뇌졸중 중에서도 뇌혈관에서 혈관벽이 약해진 부위의 혈관이 풍선처럼 부풀어 새로운 혈관 내 공간이 형 성되는 뇌동맥류의 경우, 치사율이 상당히 높아 매우 위험한 질환으로 인식되고 있다. 반면, 뇌혈관의 경우, 보는 방향에 따라, 또는 주변 장애물에 따라 그 형상이 다르게 나타나고 있어, 뇌동맥류 의 경우 판독의 정확성을 높이는 데 어려움이 있다."}
{"patent_id": "10-2022-0013092", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은 전술한 문제점을 해결하기 위해 도출된 것으로, 의료 영상 판독의 정확성을 높이고자 하는 데에 그 목적이 있다. 본 발명은 특히, 병변 영역과 혈관 영역을 별도의 프로세스로 각각 획득하고, 획득된 병변 영역과 혈관 영역을 기초로 생성된 결합 영상을 뇌병변 판독에 이용하도록 함으로써 판독의 정확성을 높이고자 하는 데에 그 목적이 있다. 본 발명은 또한, 응급 상황에 적합한 영상 획득 장치로부터 획득된 영상에 위 방법을 적용하도록 함으로써 판독 의 정확성을 높임과 동시에 응급 상황에 보다 빠르고 적합하게 대처할 수 있는 방법을 제공하기 위한 데에 그 목적이 있다."}
{"patent_id": "10-2022-0013092", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "실시예에 따른 인공지능 기반의 뇌병변 검출 방법은, 뇌를 촬영한 뇌영상을 획득하는 단계, 제1 신경망 모델을 이용하여 상기 뇌영상으로부터 병변 영역을 포함한 정보를 획득하는 단계, 제2 신경망 모델을 이용하여 상기 뇌 영상으로부터 혈관 영역을 포함한 정보를 획득하는 단계, 상기 병변 영역과 상기 혈관 영역이 결합된 결합 영상 을 생성하는 단계 및 상기 결합 영상을 기초로 상기 뇌영상을 뇌병변 영상으로 분류하는 단계를 포함할 수 있다. 상기 제1 신경망 모델 및 상기 제2 신경망 모델 중 적어도 하나는 3D CNN(Convolution Neural Networks)을 이 용한 학습용 뇌영상의 학습을 통해 획득될 수 있다. 상기 3D CNN은 복수의 3D 컨볼루션 층에 기반해 상기 학습용 뇌영상에 대한 인코딩을 수행하기 위한 인코더블록, 복수의 3D 디컨볼루션 층에 기반해 디코딩을 수행하기 위한 디코더블록, 및 상기 인코더블록과 상 기 디코더블록 사이에 배치되어 상기 학습용 뇌영상에 대한 상황 정보를 통합 적용하기 위한 통합적응블록을 포 함할 수 있다. 상기 통합적응블록은 상기 인코더블록의 출력값인 인코딩된 학습용 뇌영상을 입력받아 컨볼루션을 수행하여 출 력한 영상에 상기 인코딩된 학습용 뇌영상을 적용한 결과 영상을 출력하기 위한 잔여블록 및 상기 결과 영상을 입력받아 상기 학습용 뇌영상에 대한 상황 정보를 통합 적용하기 위한 이중처리블록을 포함할 수 있다. 상기 뇌영상은 MRA(Magnetic Resonance Angiography) 및 CTA(Computed Tomography Angiography) 중 적어도 하 나를 포함할 수 있다. 상기 뇌영상이 상기 CTA(Computed Tomography Angiography)에 해당하는 지 여부를 판단하는 단계 및 상기 CTA 에 해당하는 것으로 판단하는 경우, 응급 상황임을 나타내는 메시지를 출력하는 단계를 더 포함할 수 있다. 상기 분류 단계는, 상기 결합 영상의 상기 병변 영역에 포함된 복셀에 소정의 가중치를 부여하는 단계 및 상기 가중치 부여 결과를 기초로 상기 뇌영상을 상기 뇌병변 영상으로 분류하는 단계를 포함할 수 있다. 상기 병변 영역을 포함한 정보는 병변 좌표, 병변 크기, 병변 부피, 검출 확률, 및 뇌동맥류 유무 중 적어도 하 나를 포함할 수 있다. 상기 혈관 영역을 포함한 정보는 혈관 좌표, 혈관의 중심선, 중심선의 특징, 혈관 단면, 혈관 줄기, 혈관벽, 및 분기점 정보 중 적어도 하나를 포함할 수 있다. 실시예에 따른 인공지능 기반의 뇌병변 검출 장치는, 프로세서 및 상기 프로세서에 의해 실행 가능한 명령어들 을 저장하는 메모리를 포함하고, 상기 프로세서는, 상기 명령어들을 실행함으로써, 뇌를 촬영한 뇌영상을 획득 하고, 제1 신경망 모델을 이용하여 상기 뇌영상으로부터 병변 영역을 포함한 정보를 획득하고, 제2 신경망 모델 을 이용하여 상기 뇌영상으로부터 혈관 영역을 포함한 정보를 획득하며, 상기 병변 영역과 상기 혈관 영역이 결 합된 결합 영상을 생성하고, 상기 결합 영상을 기초로 상기 뇌영상을 뇌병변 영상으로 분류할 수 있다. 상기 프로세서는, 3D CNN(Convolution Neural Networks)을 이용한 학습용 뇌영상의 학습을 통해 상기 제1 신경 망 모델 및 상기 제2 신경망 모델 중 적어도 하나를 획득할 수 있다. 상기 프로세서는, 상기 학습용 뇌영상을 상기 3D CNN의 인코더블록에 입력시켜 상기 학습용 뇌영상에 대한 인코 딩을 수행하고, 상기 인코딩된 뇌영상을 상기 3D CNN의 통합적응블록에 입력시켜 상기 인코딩된 뇌영상에 대한 상황 정보가 통합 적용된 영상을 출력하고, 상기 상황 정보가 통합 적용된 영상을 상기 3D CNN의 디코더블록에 입력시켜 디코딩을 수행함으로써 상기 학습을 수행할 수 있다."}
{"patent_id": "10-2022-0013092", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명에 따르면, 병변 영역과 혈관 영역을 별도의 프로세스로 각각 획득하고, 획득된 병변 영역과 혈관 영역 을 기초로 생성된 결합 영상을 뇌병변 판독에 이용하도록 함으로써 판독의 정밀도를 보다 향상시킬 수 있게 된 다. 본 발명에 따르면, 특히, 응급 상황에 적합한 영상 획득 장치로부터 획득된 뇌영상에 위 방법을 적용하도록 함 으로써 판독의 정확성을 높임과 동시에 응급 상황에 보다 빠르고 적합하게 대처할 수 있게 된다."}
{"patent_id": "10-2022-0013092", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "후술하는 본 발명에 대한 상세한 설명은, 본 발명이 실시될 수 있는 특정 실시예를 예시로서 도시하는 첨부 도 면을 참조한다. 이들 실시예는 당업자가 본 발명을 실시할 수 있기에 충분하도록 상세히 설명된다. 본 발명의 다양한 실시예는 서로 다르지만 상호 배타적일 필요는 없음이 이해되어야 한다. 예를 들어, 여기에 기재되어 있는 특정 형상, 구조 및 특성은 일 실시예에 관련하여 본 발명의 정신 및 범위를 벗어나지 않으면서 다른 실시 예로 구현될 수 있다. 또한, 각각의 개시된 실시예 내의 개별 구성요소의 위치 또는 배치는 본 발명의 정신 및 범위를 벗어나지 않으면서 변경될 수 있음이 이해되어야 한다. 따라서, 후술하는 상세한 설명은 한정적인 의미 로서 취하려는 것이 아니며, 본 발명의 범위는, 적절하게 설명된다면, 그 청구항들이 주장하는 것과 균등한 모 든 범위와 더불어 첨부된 청구항에 의해서만 한정된다. 도면에서 유사한 참조부호는 여러 측면에 걸쳐서 동일하 거나 유사한 기능을 지칭한다. 도 1은 실시예에 따른 인공지능 기반의 뇌병변 검출 장치의 블록도이다. 도 1에 도시한 바와 같이, 실시예에 따른 인공지능 기반의 뇌병변 검출 장치는 프로세서와 메모리를 포함할 수 있다. 메모리는 인공지능 기반의 뇌병변 검출 장치의 동작에 필요한 각종 프로그램 및 데이터 등을 저장할 수 있다. 실시예에 따른 메모리는 제1 신경망 모델, 제2 신경망 모델, 및 뇌영상 DB를 저장할 수 있다. 구체적으로, 제1 신경망 모델은 병변 영역이 레이블링된 학습용 뇌영상의 소정의 신경망을 이용한 학습을 통해 획득된 모델일 수 있다. 그리고, 제2 신경망 모델은 혈관 영역이 레이블링된 학습용 뇌영상의 소정의 신경망을 이용한 학습을 통해 획득된 모델일 수 있다. 뇌영상 DB는 뇌 CT, MRI, MRA, CTA 등 다양한 의료 영상을 저장할 수 있으며, 환자 또는 질병에 관련된 메타 데이터를 더 저장할 수도 있다. 메타 데이터는 예를 들면, 촬영 프로토콜, 환자 나이, 환자 성별, 환자 인종, 환자 체중, 환자 신장, 환자 생체 정보, 질병 정보, 질병 이력, 가족력, 진단 정보 등의 추가 정보를 포함할 수 있다. 출력부는 프로세서의 처리 결과를 3D 영상으로 시각화하여 제공할 수 있다. 출력부는 병변 영역과 혈관 영역이 결합된 결합 영상을 3D 영상으로 시각화하여 출력할 수 있다. 프로세서는 인공지능 기반의 뇌병변 검출 장치의 전반적인 동작을 제어할 수 있다. 구체적으로, 프로세서는 뇌를 촬영한 뇌영상을 획득하고, 제1 신경망 모델을 이용하여 뇌영상으로부터 병변 영역을 포함한 정보를 획득하고, 제2 신경망 모델을 이용하여 뇌영상으로부터 혈관 영역을 포함한 정 보를 획득하며, 병변 영역과 혈관 영역이 결합된 결합 영상을 생성하고, 결합 영상을 기초로 뇌영상을 뇌병변 영상으로 분류할 수 있다. 실시예에 따르면, 프로세서는 인공지능 기반의 뇌병변 검출 장치의 내부에 구비된 제1 신경망 모델 과 제2 신경망 모델을 이용해 입력된 뇌영상으로부터 병변 영역을 포함한 정보와 혈관 영역을 포함한 정보 를 획득할 수 있다. 이 때, 프로세서와 제1 신경망 모델 및 제2 신경망 모델은 하나의 IC 칩내에 구비될 수 있다. 또는, 다른 실시예에 따르면 프로세서와 제1 신경망 모델 및 제2 신경망 모델이 서로 별개의 IC 칩으로 구현될 수도 있다. 다른 실시예에 따르면, 프로세서는 인공지능 기반의 뇌병변 검출 장치의 외부에 배치된 제1 신경망 모델 과 제2 신경망 모델을 이용해 입력된 뇌영상으로부터 병변 영역을 포함한 정보와 혈관 영역을 포함한 정보를 획득할 수 있다. 이 때, 프로세서는 외부에 배치된 제1 신경망 모델과 제2 신경망 모델에 뇌영상을 전달하고, 제1 신경망 모델과 제2 신경망 모델로부터 출력된 병변 영역을 포함한 정보와 혈관 영역을 포함한 정보를 수신할 수 있다. 실시예에 따르면, 프로세서, 제1 신경망 모델, 및/또는 제2 신경망 모델은 소프트웨어 모듈로 구현 되거나 적어도 하나의 하드웨어 칩 형태로 제작되어 인공지능 기반의 뇌병변 검출 장치에 탑재될 수 있다. 예를 들어, NPU(Neural Processing Unit)와 같은 인공 지능(AI; artificial intelligence)을 위한 전용 하드웨 어 칩 형태로 제작되거나, 기존의 범용 프로세서(예: CPU 또는 Application Processor) 또는 그래픽 전용 프로 세서(예: GPU(Graphic Processing Unit) 또는 VPU(Visual Processing Unit))의 일부로 제작되어 인공지능 기반 의 뇌병변 검출 장치에 탑재될 수 있다. 참고로, 본 발명의 각 순서도에 있어서, 각 단계는 일예이며, 각 순서를 다르게 변경 및/또는 조합한 경우에도 본 발명이 동일/유사하게 적용될 수 있다. 도 2 내지 도 4는 실시예에 따른 인공지능 기반의 뇌병변 검출 방법을 설명하는 순서도이고, 도 5 내지 도 10은 도 2 내지 도 4의 방법을 설명하기 위해 참조되는 도면이다. 도 2 내지 도 10을 함께 참조하면, 프로세서는 뇌를 촬영한 뇌영상을 획득할 수 있다(s1). 구체적으로, 프 로세서는 뇌 CT, MRI, MRA, CTA 등 다양한 의료 영상을 촬영하는 촬영장비로부터 영상을 획득할 수 있다. 실시예에 따르면, 뇌 MRA는 뇌혈관을 정면, 배면, 좌면, 우면, 평면, 및 저면의 6 방향에서 프로젝션하여 획득 된 것일 수 있다. 실시예에 따르면, 프로세서는, 환자와 관련된 DICOM 정보, 혈관조영(Angiography) 이미지 정보, 관류 이미 지(Perfusion image) 정보, 확산 이미지(diffusion image) 정보 등을 수집할 수 있다. 더불어, 성별, 나이 등 의 정보, 혈압 정보, 발병 시간 정보 등 환자와 관련된 신체 정보를 획득하는 것도 가능하다. 프로세서는 대상체를 촬영하여 TOF(time-of-flight) 영상 등의 다양한 영상 출력물을 출력할 수 있다. 실시예에 따르면, 촬영장비로부터 획득된 영상이나 상기 각 정보는 미리 메모리에 저장되고, 프로세서 가 메모리로부터 독출하여 획득할 수도 있다. 실시예에 따르면, 프로세서는 획득한 뇌영상에 대한 전처리를 수행할 수 있다(s2). 도 5를 참조하면, 프로세서는 전처리 과정에서 의료 영상을 정규화하고 미리 세팅된 표준 마스크 템플릿을 이용해서 관심 영역(VOI, Volume of Interest)을 분할 및 추출할 수 있다. 구체적으로, 의료 영상에서 관심 영 역을 분할 및 추출하기 위한 표준 마스크 템플릿 (Mask Template)을 세팅할 수 있다. 예를 들어, 복수의 정상인과 뇌질환 환자로부터 획득된 복수의 의료영상을 수집하고, 2차원과 3차원의 정규화 영상을 생성하며, 3차원 정규화 영상 기반으로 복셀 (Voxel) 설정에 따라 특정 축을 기준으로 Slicing하여 2차 원 정규화 영상을 생성할 수 있다. 프로세서는 의료영상의 노이즈를 제거하는 동작을 수행할 수 있다. 또한, 해부학적인 구조물 정렬을 위해 이미지를 정렬하는 것으로, 영상 촬영시 피험자의 움직임에 의한 기울어짐이나 뇌 모양의 차이 등에 따른 개체 내 또는 개체 간의 이미지들을 공간적으로 정렬하는 Co-registration 기능을 수행할 수 있다. 프로세서는 또한, 의료 영상에 비정규 바이어스를 정정하고 (Non-uniform bias correction), 공간적 정렬 (Spatial align)을 통해 등록 (Co-registration)하며, 표준 정위 공간(Standard stereotaxic space)으로 적용 하여 공간적 정규화 (Spatial normalization)를 수행하는 과정을 통해 영상을 정규화할 수 있다. 또한, 영상에서 뇌 구조물이 아닌 부분을 제거하기 위한 기능을 제공하는 스컬-스티리핑(Skull-stripping) 기능 을 제공할 수도 있다. 실시예에 따르면, 뇌혈관 영상, 예를 들어, TOF MRA/TOF CTA 이미지를 등방성 공간으로 보간하고 신호강도를 표 준화할 수 있다. 구체적으로, 3차원 TOF MRA 이미지의 머리의 위 아래 범위(z 축) 방향 커버리지를 맞추기 위해 z 축의 중간대뇌 동맥(MCA)의 위치를 검출하고, 검출된 중간대뇌 동맥(MCA)의 위치를 중심으로 소정 크기의 영 상을 잘라내며, 상기 잘라낸 소정 크기의 영상(slab)을 보간하여 데이터 크기를 줄일 수 있다. 이외에도, 이미지 표현에 사용되는 색상의 비트 값을 줄이는 처리로 이미지를 8 비트 정수 형태로 변환시키는 처리, 이미지의 엣지를 찾아 이진화 시키는 처리, 이미지의 픽셀 값을 반전시켜주는 처리, 픽셀간 거리의 정보 를 사용하여 이미지의 크기를 조정하는 리샘플링 처리, 이미지 샘플 영역, 예컨대, 프로파일 또는 전체 영상에 위치하는 픽셀 값의 범위를 변경하는 리스케일 처리, 이미지의 크기를 확대 또는 축소시키는 리사이즈 처리, 이 미지의 엣지를 강조하는 효과를 주는 샤프닝 처리, 이미지에 흐림 효과를 주어 번지게 하는 스무딩 처리, 원본 이미지에 0인 값으로 이루어진 정사각형 모양을 붙이는 제로-패딩 처리 등을 수행할 수도 있다. 프로세서는 제1 신경망 모델을 이용하여 뇌영상으로부터 병변 영역을 포함한 정보를 획득할 수 있다 (s3). 실시예에 따르면, 프로세서는 제1 신경망 모델을 이용하여 전처리된 뇌영상으로부터 병변 영역을 포함 한 정보를 획득할 수 있다. 예를 들어, 도 6의 (a)와 같이, 프로세서는 제1 신경망 모델을 이용하여 전처리된 복수의 뇌영상 각각 으로부터 이에 대응되는 병변 영역과 해당 병변 영역과 관련된 정보를 획득할 수 있다. 실시예에 따르면, 병변 영역과 관련된 정보는 병변 좌표, 병변 크기, 병변 부피, 검출 확률, 및/또는 뇌동맥류 유무 등을 포함할 수 있다. 실시예에 따르면, 병변 영역은 뇌영상(MRA/CTA)의 복셀 정보(예> 복셀 당 좌표)로표현될 수 있다. 프로세서는 레이블링된 학습용 뇌영상의 소정의 신경망을 이용한 학습을 통해 제1 신경망 모델을 획득 할 수 있으며, 이에 대해서는 도 8과 도 9를 통해 후술한다. 본 발명에서는 3D CNN(21a)을 이용한 학습을 통해 제1 신경망 모델을 획득한 것을 예시하였으나, 2D CNN이 나 YOLO(You Only Look Once), SSD(Single Shot Multibox detection), Centernet 등 기타 다른 종류의 인공 지 능 기반의 신경망을 이용하는 경우에도 본 발명이 동일/유사하게 적용될 수 있다. 프로세서는 제2 신경망 모델을 이용하여 뇌영상으로부터 혈관 영역을 포함한 정보를 획득할 수 있다 (s4). 참고로, 제2 신경망 모델에 이용되는 뇌영상은 제1 신경망 모델에 이용되는 뇌영상과 동일한 영 상일 수 있다. 실시예에 따르면, 프로세서는 제2 신경망 모델을 이용하여 전처리된 뇌영상으로부터 혈관 영역을 포함 한 정보를 획득할 수 있다. 예를 들어, 도 6의 (b)와 같이, 프로세서는 제2 신경망 모델을 이용하여 전처리된 복수의 뇌영상 각각 으로부터 이에 대응되는 혈관 영역과 해당 혈관 영역과 관련된 정보를 획득할 수 있다. 실시예에 따르면, 혈관 영역과 관련된 정보는 혈관 좌표, 혈관의 중심선, 중심선의 특징(혈관의 지름 길이, 위 치, 분기점의 위치, 경계라인 정보 등), 혈관 단면, 혈관 줄기, 혈관벽, 및 분기점 정보(위치, 곡률 등) 중 적 어도 하나를 포함할 수 있다. 실시예에 따르면, 혈관 영역과 해당 혈관 영역과 관련된 정보는 혈관맵 형태로 작 성되어 메모리에 저장될 수 있다. 프로세서는 레이블링된 학습용 뇌영상의 소정의 신경망을 이용한 학습을 통해 제2 신경망 모델을 획득 할 수 있으며, 이에 대해서는 도 8과 도 10을 통해 후술한다. 본 발명에서는 3D CNN(22a)을 이용한 학습을 통해 제2 신경망 모델을 획득한 것을 예시하였으나, 2D CNN이 나 YOLO(You Only Look Once), SSD(Single Shot Multibox detection), Centernet 등 기타 다른 종류의 인공 지 능 기반의 신경망을 이용하는 경우에도 본 발명이 동일/유사하게 적용될 수 있다. 프로세서는 제1 신경망 모델로부터 출력된 병변 영역과 제2 신경망 모델로부터 출력된 혈관 영역을 결합하여 결합 영상을 생성할 수 있다(s5). 구체적으로, 프로세서는 전처리된 복수의 뇌영상 각각에 대응되는 결합 영상을 생성할 수 있다. 그리고, 생 성된 결합 영상은 출력부에 의해 시각화되어 표현됨으로써 사용자에게 제공될 수 있다. 본 발명에 따르면, 뇌영상을 뇌병변 영상으로 분류하기 위해 결합 영상을 생성함으로써, 뇌병변 검출의 정밀도 가 향상될 수 있다. 즉, 병변 영역과 혈관 영역을 결합하여, 결합 영상 중 겹치는 부분(A)만 뇌병변으로 검출하 고, 겹치지 않는 부분은 뇌병변으로 검출하지 않도록 함으로써, 뇌병변 검출 위치의 정밀도가 보다 향상될 수 있다. 구체적으로, 겹치지 않는 부분도 석회화 등의 영향으로 뇌병변으로 오판단될 수도 있으나, 최종 결합 영 상 상에서 겹치지 않는 부분은 제외하도록 함으로써, 정밀도가 향상될 수 있는 것이다. 프로세서는 생성된 결합 영상을 기초로 뇌영상을 뇌병변 영상으로 분류할 수 있다(s6). 구체적으로, 프로세서는 생성된 결합 영상 중 병변 영역과 혈관 영역이 겹치는 부분의 각 복셀을 추출하고 (s61), 각 복셀이 양성인지 음성인지 여부에 따라 상이한 가중치를 부여하며(s62), 가중치 합산에 기초하여 뇌 영상을 뇌병변 영상으로 분류할 수 있다(s63). 예를 들어, 양성으로 판단되는 복셀에는 가중치를 1로 부여하고, 음성으로 판단되는 복셀에는 가중치를 -1로 부 여하며, 각각의 복셀에 대한 가중치 부여 결과를 합산한 결과가 소정의 임계치를 초과한 경우 뇌영상을 뇌병변 영상으로 분류할 수 있다. 본 발명에 따르면, 양성으로 판단되는 복셀의 가중치 부여 결과는 겹치는 부분에서 증가하고, 음성으로 판단되 는 복셀의 가중치 부여 결과는 겹치는 부분에서 감소하게 됨으로써, 임계치 미만의 영역은 뇌병변에서 제거하도 록 하여 뇌병변 발생 위치를 보다 정밀하게 검출할 수 있게 된다. 실시예에 따르면, 프로세서는 입력된 뇌영상의 종류를 더 판단하여, 해당 판단 결과에 따른 응급 상황 메시 지를 더 출력할 수 있다(s7). 구체적으로, 프로세서는 뇌영상이 CTA인지 여부를 더 판단하고(s71), CTA인 것으로 판단한 경우, 뇌병변 영 상 분류 결과와 함께 응급 상황임을 나타내는 메시지를 더 출력하고(s72), CTA가 아닌 것으로 판단한 경우에는 뇌병변 영상 분류 결과만을 디폴트로 출력할 수 있다(s73). 일반적으로, 응급 상황에서는 MRA보다 CTA 영상으로 뇌병변을 판단하게 되며, 이에 따라, 입력된 뇌병변 영상이 CTA인 경우, 응급 상황임을 나타내는 메시지를 더 출력하도록 설정될 수 있다. 또한, 본 발명의 경우, 특히 뇌 영상이 CTA인 경우, 전술한 신경망 모델과 결합 영상을 이용하여 뇌병변 영상을 분류하도록 함으로써, 분류의 정밀도 향상과 함께 응급 상황에 보다 적합하게 인공지능 기반의 뇌병변 검출 장치를 이용할 수 있게 된다. 이하, 도 8 내지 도 10을 참조하여, 실시예에 따른 학습 과정을 설명한다. 실시예에 따른 제1 신경망 모델 및/또는 제2 신경망 모델은 도 9 내지 도 10에 도시한 형태의 3D CNN에 기반한 학습을 통해 획득된 모델일 수 있다. 다만, 이는 일 실시예이며, 통상의 기술자에 의해 추가적인 전처리 과정을 수행해 다른 형태의 3D CNN이거나, 2D CNN에 기반한 학습을 통해 획득된 모델인 경우에도 본 발명이 동 일/유사하게 적용될 수 있다. 실시예에 따르면, 3D CNN(21a, 22a)은 복수의 3D 컨볼루션 층에 기반해 학습용 뇌영상에 대한 인코딩을 수행하 기 위한 인코더블록(21a-1, 22a-1), 복수의 3D 디컨볼루션 층에 기반해 디코딩을 수행하기 위한 디코더블록 (21a-2, 22a-2), 및 상기 인코더블록(21a-1, 22a-1)과 상기 디코더블록(21a-2, 22a-2) 사이에 배치되어 상기 병변 영역이 레이블링된 학습용 뇌영상에 대한 상황 정보를 통합 적용하기 위한 통합적응블록(21a-3)/혈관 영역 이 레이블링된 학습용 뇌영상에 대한 상황 정보를 통합 적용하기 위한 통합적응블록(22a-3)을 포함할 수 있다. 구체적으로, 인코더블록(21a-1, 22a-1)은 (확장된) 컨볼루셔널 층((a) 내지 (a-3)/(a)' 내지 (a-3)'))과 3D 최 대 풀링 층을 포함할 수 있고, 디코더블록(21a-2, 22a-2)은 디컨볼루셔널 층((b) 내지 (b-3)/(b)' 내지 (b- 3)'))과 3D 최대 풀링 층을 포함할 수 있다. 상기 층은 선형, tanh, ReLU, PreLU, 시그모이드 등과 같은 다양한 활성화 함수를 사용할 수 있다. 컨볼루셔널 층((a) 내지 (a-3)/(a)' 내지 (a-3)')) 및 디컨볼루셔널 층((b) 내 지 (b-3)/(b)' 내지 (b-3)'))은 필터량, 필터 크기 및 서브 샘플링 파라미터가 다를 수 있다. 실시예에 따르면, 드롭 아웃 (dropout) 층 및/또는 배치 정규화가 구조 전체에 사용될 수 있다. 참고로, 복수의 3D 컨볼루션 층을 통한 합성곱 연산을 이용해 미리 설정된 복수의 필터(혹은 커널)를 이용하여 입력 영상으로부터 피쳐를 추출하여 피쳐맵들을 생성할 수 있고, 3D 최대 풀링층들을 통해 피쳐맵들로부터 피쳐 값들이 추출될 수 있다. 이러한 구조는 다양한 해상도 스케일을 사용할 수 있어서, 컨볼루셔널 층((a) 내지 (a-3)/(a)’내지 (a-3)'))을 통해 효과적으로 다운샘플링이 수행될 수 있다. 또한, 디컨볼루셔널 층((b) 내지 (b-3)/(b)’내지 (b-3)'))을 통해 효과적으로 효과적으로 업샘플링이 수행될 수 있다. 이 때, 컨볼루셔널 층을 통한 출력값을 동일한 해상도로 작용하는 각 층의 디컨볼루셔널 층에 적용함으로써 (예>복사, 연결, 합성) 매우 정확한 예측이 달성될 수 있다. 즉, 본 발명에 따르면 이와 같은 구조를 통해 다양 한 스케일의 특징이 통합적으로 활용될 수 있다. 구체적으로, 스킵 레이어(Skip layer)를 통해 인코더블록(21a- 1, 22a-1)과 디코더블록(21a-2, 22a-2)을 연결하여 3D 최대 풀링 과정에서 발생할 수 있는 정보 손실을 막아줄 수 있게 된다. 그리고, 통합적응블록(21a-3, 22a-3)은 잔여블록(Residual Block)과 이중처리블록(Dual Attention Block)을 포 함할 수 있다. 이중처리블록은 영상 내 국소 위치의 모든 피쳐에 대한 가중치 합산을 사용하여 각 국소 위치의 피쳐를 선택적 으로 집계하는 공간적용모듈(Spatial Attention Module)과 피쳐맵들 사이의 관련 피쳐들을 통합하여 상호 의존 적인 피쳐맵을 선택적으로 강조하도록 함으로써, 국소 위치의 피쳐들이 적응적으로(adaptively) 통합 고려되도 록 하는 채널적용모듈(Channel Attention Module)을 포함할 수 있다. 그리고, 공간적용모듈의 결과와 채널적용 모듈의 결과는 합산될 수 있다. 본 발명에 따르면, 이러한 두 가지 종류의 모듈을 함께 이용하여 피쳐 표현을 개선할 수 있게 되며, 보다 정확한 분할이 수행될 수 있게 된다. 실시예에 따르면, 컨볼루셔널 층((a) 및/또는 (a-3)/(a)’및/또는 (a-3)’))을 통한 출력값이 상황 정보 (contextual information)을 고려한 분할 수행으로 국소 위치의 피쳐가 전반적인 피쳐로 통합 적용된 후, 최종 적으로, 디컨볼루셔널 층((b) 및/또는 (b-3)/(b)’및 (b-3)’))에 적용(예> 복사) 됨으로써 개선된 성능이 달성 될 수 있다. 구체적으로, 잔여블록의 출력값을 이중처리블록에서 입력받아 출력값에 상황 정보가 전반적으로 통합 고려된 출 력값이 디컨볼루셔널 층((b) 및/또는 (b-3)/(b)’및 (b-3)’))에 적용됨으로써 매우 정확한 예측이 달성될 수 있다. 실시예에 따르면, 잔여블록은 인코더블록(21a-1, 22a-1)의 컨볼루셔널 층((a) 내지 (a-3)/(a)’내지 (a-3)’)) 의 출력값인 인코딩된 학습용 뇌영상을 입력받아 잔여블록 내에서 컨볼루셔널 층을 통해 컨볼루션이 수행되어 출력된 영상에, 상기 인코딩된 학습용 뇌영상(잔여블록의 입력값)이 적용된 결과 영상을 출력하여 이중처리블록 에 입력시키기 위해 구현된 블록일 수 있다. 실시예에 따르면, 이중처리블록은 전술한 잔여블록을 통해 출력된 결과 영상 내 국소 위치의 피쳐들을 선택적으 로 집계하기 위한 공간적용모듈과 상기 피쳐들에 상기 상황 정보를 통합 적용하기 위한 채널적용모듈을 포함할 수 있다. 구체적으로, 이중처리블록은, 결과 영상(컨볼루션이 수행되어 출력된 영상에, 인코딩된 학습용 뇌영상(잔여블 록의 입력값)이 적용된 결과 영상)을 입력받아, 공간적용모듈과 채널적용모듈을 적용하고, 적용된 결과 영상을 다시 디컨볼루셔널 층((b) 및/또는 (b-3)/(b)’및 (b-3)’))에 적용(예> 복사, 연결, 합성) 함으로써 학습용 뇌 영상에 대한 병변 영역을 포함한 정보/학습용 뇌영상에 대한 혈관 영역을 포함한 정보에 대한 정확한 분류 예측 결과를 출력하기 위해 구현된 블록일 수 있다. 이 때, 기 설정된 예측 결과와 실제 출력된 예측 결과를 서로 비 교하는 역전파 과정을 수행하면서 3D 신경망의 학습 수행의 정확도를 보다 향상시킬 수 있다. 실시예에 따르면, 상기 구조에 기초하여, 프로세서는 학습용 뇌영상을 인코더블록(21a-1, 22a-1)에 입력시 켜 학습용 뇌영상에 대한 인코딩을 수행하고, 인코딩된 학습용 뇌영상을 통합적응블록(21a-3, 22a-3)에 입력 시켜 상황 정보가 통합 적용된 영상을 출력하며, 상황 정보가 통합 적용된 영상을 디코더블록(21a-2, 22a-2)에 입력시켜 학습용 뇌영상에 대한 병변 영역을 포함한 정보/학습용 뇌영상에 대한 혈관 영역을 포함한 정보를 출 력하도록 학습을 수행할 수 있다. 그리고, 해당 학습 과정에서 정확한 분류 예측 결과를 출력할 수 있다. 구체적으로, 프로세서는 인코딩된 학습용 뇌영상을 잔여블록에 입력시켜 잔여블록 내의 컨볼루셔널 층을 통해 컨볼루션을 수행하여 출력된 영상에 인코딩된 학습용 뇌영상을 적용한 결과 영상을 출력하고, 해당 결과 영상을 이중처리블록에 입력시켜 해당 출력 영상에 상황 정보가 통합 적용된 영상을 출력할 수 있다. 이 때, 프 로세서는 공간적용모듈을 이용해 결과 영상 내 국소 위치의 피쳐들을 선택적으로 집계하고, 채널적용모듈을 이용해 상기 피쳐들에 상기 상황 정보를 통합 적용할 수 있다. 그리고, 상황 정보가 통합 적용된 출력 영상을 디컨볼루셔널 층에 적용하여 업샘플링이 수행되도록 할 수 있다. 실시예에 따르면, Classification에서 성능 검증을 받은 구조를 기반으로 전이 학습(Transfer Learning)을 이용 함으로써 학습을 빠르게 하며, 예측 정확도를 더욱 높일 수 있다. 또한, 컨볼루션 네트워크로 구성되어 입력 영 상의 크기 제한을 받지 않으며, 전체 영상을 한 번에 처리할수 있기 때문에 연산 절감 효과를 얻을 수 있게 되 어 더욱 빠른 처리가 가능하다. 더불어, De-Convolution에 사용되는 필터의 계수도 학습을 통해 결정되기 때문에 Bi-Linear, Non-Linear Upsampling이 가능하며, Upsampling으로 인한 성능 향상에 대한 한계를 개선하기 위해 이전 레이어의 정보를 함 께 사용하여 Coarse Semantic Information과 Fine Appearance Information을 융합하여 더욱 정교한 예측을 가 능하게 한다. 마지막으로, 상황 정보가 통합 적용된 영상을 획득할 수 있게 되어 분할 시 정확도가 향상될 수 있게 된다. 이상 설명된 실시 형태는 다양한 컴퓨터 구성요소를 통하여 실행될 수 있는 프로그램 명령어의 형태로 구현되어 컴퓨터로 판독가능한 기록매체에 기록될 수 있다. 상기 컴퓨터로 판독가능한 기록매체는 프로그램 명령어, 데이 터 파일, 데이터 구조 등을 단독으로 또는 조합하여 포함할 수 있다. 본 명세서의 양상들은 전체적으로 하드웨어, 전체적으로 소프트웨어 (펌웨어, 상주 소프트웨어, 마이크로 코드 등을 포함 함) 또는 컴퓨터 판독 가능 프로그램 코드가 구현 된 하나 이상의 컴퓨터 판독 가능 매체에 구현 된 컴퓨터 프로그램 제품의 형태를 취할 수 있다. 이상에서 실시예들에 설명된 특징, 구조, 효과 등은 본 발명의 하나의 실시예에 포함되며, 반드시 하나의 실시 예에만 한정되는 것은 아니다. 나아가, 각 실시예에서 예시된 특징, 구조, 효과 등은 실시예들이 속하는 분야의 통상의 지식을 가지는 자에 의해 다른 실시예들에 대해서도 조합 또는 변형되어 실시 가능하다. 따라서 이러한 조합과 변형에 관계된 내용들은 본 발명의 범위에 포함되는 것으로 해석되어야 할 것이다.도면 도면1 도면2 도면3 도면4 도면5 도면6 도면7 도면8 도면9 도면10"}
{"patent_id": "10-2022-0013092", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 실시예에 따른 인공지능 기반의 뇌병변 검출 장치의 블록도이다. 도 2 내지 도 4는 실시예에 따른 인공지능 기반의 뇌병변 검출 방법을 설명하는 순서도이다. 도 5 내지 도 10은 도 2 내지 도 4의 방법을 설명하기 위해 참조되는 도면이다."}
