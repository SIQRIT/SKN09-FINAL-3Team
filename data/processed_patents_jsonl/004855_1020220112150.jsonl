{"patent_id": "10-2022-0112150", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2024-0033470", "출원번호": "10-2022-0112150", "발명의 명칭": "훈련을 위한 의료 영상을 생성하기 위한 방법 및 장치", "출원인": "주식회사 온택트헬스", "발명자": "심학준"}}
{"patent_id": "10-2022-0112150", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "훈련을 위한 의료 영상을 생성하기 위한 방법에 있어서,조건 마스크(conditional mask)에 기반하여 초기 합성 샘플(synthetic sample)을 생성하는 단계;초기 합성 샘플에 대응하는 제1 은닉 상태(hidden state)에 기반하여 최종 합성 샘플을 생성하는 단계; 및최종 합성 샘플을 이용하여 CARIM(class activation region influence maximization) 손실 값을 결정하는 단계를 포함하며,상기 최종 합성 샘플의 해상도는, 상기 초기 합성 샘플의 해상도보다 높은 방법."}
{"patent_id": "10-2022-0112150", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "청구항 1에 있어서,상기 초기 합성 샘플을 생성하는 단계는,상기 조건 마스크를 상기 초기 합성 샘플의 해상도에 기반하여 조절하는 단계;잠재 벡터(latent vector)를 입력 형식으로 변환하는 단계;상기 조절된 조건 마스크 및 상기 변환된 잠재 벡터를 연결(concatenate)함으로써 업-샘플링을 위한 입력 데이터를 생성하는 단계; 및상기 입력 데이터를 업-샘플링함으로써 상기 제1 은닉 상태를 생성하는 단계를 포함하는 방법."}
{"patent_id": "10-2022-0112150", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "청구항 1에 있어서,상기 제1 은닉 상태 및 상기 조건 마스크에 기반하여, 중간 합성 샘플에 대응하는 제2 은닉 상태를 생성하는 단계; 및상기 제2 은닉 상태에 기반하여 상기 중간 합성 샘플을 생성하는 단계를 더 포함하며,상기 중간 합성 샘플의 해상도는, 상기 초기 합성 샘플의 해상도보다 높고, 상기 최종 합성 샘플의 해상도보다낮은 방법."}
{"patent_id": "10-2022-0112150", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "청구항 1에 있어서,상기 조건 마스크는, 상기 최종 합성 샘플 내에서 목표 질환의 존재(presence), 위치(location), 크기(size)를특정하는 방법."}
{"patent_id": "10-2022-0112150", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "청구항 4에 있어서,공개특허 10-2024-0033470-3-상기 목표 질환은, 3cm 이하 길이를 가진 구형 병변(globular lesion)을 포함하는 방법."}
{"patent_id": "10-2022-0112150", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "청구항 1에 있어서,상기 CARIM 손실 값은, 상기 최종 합성 샘플에서, 상기 조건 마스크의 바운딩된 영역(bounded region) 내의 위치들에서의 정보가 상기 최종 합성 샘플에 대한 분류 결과에 기여한 정도를 나타내는 정보에 기반하여 결정되는방법."}
{"patent_id": "10-2022-0112150", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "청구항 6에 있어서,상기 CARIM 손실 값은, 상기 기여한 정도가 작을수록 크게 결정되는 방법."}
{"patent_id": "10-2022-0112150", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "청구항 1에 있어서,상기 초기 합성 샘플 및 상기 최종 합성 샘플을 생성하기 위한 인공지능 모델은, 상기 CARIM 손실 값 없이 1차적으로 훈련된 후, 상기 CARIM 손실 값을 이용하여 2차적으로 훈련되는 방법."}
{"patent_id": "10-2022-0112150", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "훈련을 위한 의료 영상을 생성하기 위한 장치에 있어서,상기 장치의 동작을 위한 명령어 집합을 저장하는 저장부; 및상기 저장부와 연결된 적어도 하나의 프로세서를 포함하며,상기 적어도 하나의 프로세서는, 조건 마스크(conditional mask)에 기반하여 초기 합성 샘플(synthetic sample)을 생성하고,초기 합성 샘플에 대응하는 제1 은닉 상태(hidden state)에 기반하여 최종 합성 샘플을 생성하고,최종 합성 샘플을 이용하여 CARIM(class activation region influence maximization) 손실 값을 결정하도록 제어하며,상기 최종 합성 샘플의 해상도는, 상기 초기 합성 샘플의 해상도보다 높은 장치."}
{"patent_id": "10-2022-0112150", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "프로세서에 의해 동작되면 제1항 내지 제8항 중의 어느 한 항에 따른 방법을 실행하기 위해 매체에 저장된 프로그램."}
{"patent_id": "10-2022-0112150", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 훈련을 위한 의료 영상을 생성하기 위한 것으로, 훈련을 위한 의료 영상을 생성하기 위한 방법은, 조 건 마스크(conditional mask)에 기반하여 초기 합성 샘플(synthetic sample)을 생성하는 단계, 초기 합성 샘플 에 대응하는 제1 은닉 상태(hidden state)에 기반하여 최종 합성 샘플을 생성하는 단계, 및 최종 합성 샘플을 이 용하여 CARIM(class activation region influence maximization) 손실 값을 결정하는 단계를 포함할 수 있다. 여기서, 상기 최종 합성 샘플의 해상도는, 상기 초기 합성 샘플의 해상도보다 높을 수 있다."}
{"patent_id": "10-2022-0112150", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 의료 영상의 생성에 대한 것으로, 특히, 훈련을 위한 의료 영상을 생성하기 위한 방법 및 장치에 대 한 것이다."}
{"patent_id": "10-2022-0112150", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "질병은 인간의 심신에 장애를 일으켜서 정상적인 기능을 저해하는 상태를 의미하는 것으로, 질병에 따라 인간은 고통을 받고 심지어 생을 유지하지 못할 수 있다. 따라서, 질병을 진단하고, 치료하고 나아가 예방하기 위한 다 양한 사회적 시스템 및 기술들이 인류의 역사와 함께 발전해왔다. 질병의 진단 및 치료에 있어서, 기술의 눈부 신 발전에 따라 다양한 도구들 및 방식들이 개발되어 왔지만, 아직까지, 종국적으로는 의사의 판단에 의존하고 있는 현실이다. 한편, 최근 인공지능(artificial intelligence, AI) 기술이 크게 발전하면서 다양한 분야에서 주목되고 있다. 특히, 방대한 양의 누적된 의료 데이터와, 영상 위주의 진단 데이터 등의 환경으로 인해, 의료 분야에 인공지능 알고리즘을 접목하려는 다양한 시도와 연구가 진행 중이다. 구체적으로, 질병을 진단, 예측하는 등 종래의 임상 적 판단에 머물러 있던 작업들을 인공지능 알고리즘을 이용하여 해결하려는 다양한 연구가 이루어지고 있다. 또 한, 진단 등을 위한 중간 과정으로서 의료 데이터를 처리하고 분석하는 작업을 인공지능 알고리즘을 이용하여 해결하려는 다양한 연구가 이루어지고 있다. 선행기술문헌 미국공개특허 US 2019/0261945 (2019.08.29) 유럽공개특허 EP 3804624 (2021.04.14)"}
{"patent_id": "10-2022-0112150", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은 인공지능(artificial intelligence, AI) 알고리즘을 이용하여 훈련을 위한 의료 영상을 효과적으로 생성하기 위한 방법 및 장치를 제공하기 위한 것이다. 본 발명은 작은 크기의(small-sized) 질환을 표현하는 의료 영상을 생성하기 위한 방법 및 장치를 제공하기 위 한 것이다. 본 발명은 의도한 위치에 질환을 포함하는 의료 영상을 생성하기 위한 방법 및 장치를 제공하기 위한 것이다. 본 발명은 의도한 위치에 작은 크기의 질환을 포함하는 의료 영상을 생성하는 것을 유도하는 손실(loss) 값을 결정하기 위한 방법 및 장치를 제공하기 위한 것이다. 본 발명은 마스크(mask)에 의해 특정된 영역이 질환 여부 분류에 크게 영향을 미치도록 인공지능 모델을 훈련시 키기 위한 방법 및 장치를 제공하기 위한 것이다. 본 발명에서 이루고자 하는 기술적 과제들은 이상에서 언급한 기술적 과제들로 제한되지 않으며, 언급하지 않은"}
{"patent_id": "10-2022-0112150", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 2, "content": "또 다른 기술적 과제들은 아래의 기재로부터 본 발명이 속하는 기술분야에서 통상의 지식을 가진 자에게 명확하 게 이해될 수 있을 것이다."}
{"patent_id": "10-2022-0112150", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명의 일 실시 예에 따른, 훈련을 위한 의료 영상을 생성하기 위한 방법은, 조건 마스크(conditional mas k)에 기반하여 초기 합성 샘플(synthetic sample)을 생성하는 단계, 초기 합성 샘플에 대응하는 제1 은닉 상태 (hidden state)에 기반하여 최종 합성 샘플을 생성하는 단계, 및 최종 합성 샘플을 이용하여 CARIM(class activation region influence maximization) 손실 값을 결정하는 단계를 포함할 수 있다. 여기서, 상기 최종 합성 샘플의 해상도는, 상기 초기 합성 샘플의 해상도보다 높을 수 있다. 본 발명의 일 실시 예에 따르면, 상기 초기 합성 샘플을 생성하는 단계는, 상기 조건 마스크를 상기 초기 합성 샘플의 해상도에 기반하여 조절하는 단계, 잠재 벡터(latent vector)를 입력 형식으로 변환하는 단계, 상기 조 절된 조건 마스크 및 상기 변환된 잠재 벡터를 연결(concatenate)함으로써 업-샘플링을 위한 입력 데이터를 생 성하는 단계, 및 상기 입력 데이터를 업-샘플링함으로써 상기 제1 은닉 상태를 생성하는 단계를 포함할 수 있다. 본 발명의 일 실시 예에 따르면, 상기 제1 은닉 상태 및 상기 조건 마스크에 기반하여, 중간 합성 샘플에 대응 하는 제2 은닉 상태를 생성하는 단계, 및 상기 제2 은닉 상태에 기반하여 상기 중간 합성 샘플을 생성하는 단계 를 더 포함하며, 상기 중간 합성 샘플의 해상도는, 상기 초기 합성 샘플의 해상도보다 높고, 상기 최종 합성 샘플의 해상도보다 낮을 수 있다. 본 발명의 일 실시 예에 따르면, 상기 조건 마스크는, 상기 최종 합성 샘플 내에서 목표 질환의 존재 (presence), 위치(location), 크기(size)를 특정할 수 있다. 본 발명의 일 실시 예에 따르면, 상기 목표 질환은, 3cm 이하 길이를 가진 구형 병변(globular lesion)을 포함 할 수 있다. 본 발명의 일 실시 예에 따르면, 상기 CARIM 손실 값은, 상기 최종 합성 샘플에서, 상기 조건 마스크의 바운딩 된 영역(bounded region) 내의 위치들에서의 정보가 상기 최종 합성 샘플에 대한 분류 결과에 기여한 정도를 나 타내는 정보에 기반하여 결정될 수 있다. 본 발명의 일 실시 예에 따르면, 상기 CARIM 손실 값은, 상기 기여한 정도가 작을수록 크게 결정될 수 있다. 본 발명의 일 실시 예에 따르면, 상기 초기 합성 샘플 및 상기 최종 합성 샘플을 생성하기 위한 인공지능 모델 은, 상기 CARIM 손실 값 없이 1차적으로 훈련된 후, 상기 CARIM 손실 값을 이용하여 2차적으로 훈련될 수 있다. 본 발명의 일 실시 예에 따른, 훈련을 위한 의료 영상을 생성하기 위한 장치는, 상기 장치의 동작을 위한 명령 어 집합을 저장하는 저장부, 및 상기 저장부와 연결된 적어도 하나의 프로세서를 포함하며, 상기 적어도 하나의 프로세서는, 조건 마스크(conditional mask)에 기반하여 초기 합성 샘플(synthetic sample)을 생성하고, 초기 합성 샘플에 대응하는 제1 은닉 상태(hidden state)에 기반하여 최종 합성 샘플을 생성하고, 최종 합성 샘플을 이용하여 CARIM(class activation region influence maximization) 손실 값을 결정하도록 제어하며, 상기 최종 합성 샘플의 해상도는, 상기 초기 합성 샘플의 해상도보다 높을 수 있다. 본 발명의 일 실시 예에 따른, 매체에 저장된 프로그램은, 프로세서에 의해 동작되면 전술한 방법을 실행할 수 있다."}
{"patent_id": "10-2022-0112150", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 2, "content": "본 발명에 대하여 위에서 간략하게 요약된 특징들은 후술하는 본 발명의 상세한 설명의 예시적인 양상일 뿐이며, 본 발명의 범위를 제한하는 것은 아니다."}
{"patent_id": "10-2022-0112150", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명에 따르면, 인공지능 모델의 훈련을 위한 의료 영상이 보다 효과적으로 생성될 수 있다. 본 발명에서 얻을 수 있는 효과는 이상에서 언급한 효과들로 제한되지 않으며, 언급하지 않은 또 다른 효과들은"}
{"patent_id": "10-2022-0112150", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 2, "content": "아래의 기재로부터 본 발명이 속하는 기술분야에서 통상의 지식을 가진 자에게 명확하게 이해될 수 있을 것이다."}
{"patent_id": "10-2022-0112150", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하에서는 첨부한 도면을 참고로 하여 본 발명의 실시 예에 대하여 본 발명이 속하는 기술 분야에서 통상의 지 식을 가진 자가 용이하게 실시할 수 있도록 상세히 설명한다. 그러나, 본 발명은 여러 가지 상이한 형태로 구현 될 수 있으며 여기에서 설명하는 실시 예에 한정되지 않는다. 본 발명의 실시 예를 설명함에 있어서 공지 구성 또는 기능에 대한 구체적인 설명이 본 발명의 요지를 흐릴 수 있다고 판단되는 경우에는 그에 대한 상세한 설명은 생략한다. 그리고, 도면에서 본 발명에 대한 설명과 관계없 는 부분은 생략하였으며, 유사한 부분에 대해서는 유사한 도면 부호를 붙였다. 본 발명은 훈련을 위한 의료 영상을 생성하기 위한 것이다. 구체적으로, 본 발명은 GAN(generative adversarial network) 기반 인공지능 모델에서 생성자(generator)를 이용하여 의료 영상을 생성하는 기술에 관한 것으로, 질 환의 위치 등을 지시하는 마스크(mask)에 기반하여 의료 영상을 효과적으로 생성하기 위한 다양한 실시 예들을 설명한다. 도 1은 본 발명의 일 실시 예에 따른 시스템을 도시한다. 도 1을 참고하면, 시스템은 서비스 서버, 데이터 서버, 적어도 하나의 클라이언트 장치를 포함 한다. 서비스 서버는 인공지능 모델 기반의 서비스를 제공한다. 즉, 서비스 서버는 인공지능 모델을 이용하 여 학습 및 예측 동작을 수행한다. 서비스 서버는 네트워크를 통해 데이터 서버 또는 적어도 하나의 클라이언트 장치와 통신을 수행할 수 있다. 예를 들어, 서비스 서버는 데이터 서버로부터 인공 지능 모델을 훈련하기 위한 학습 데이터를 수신하고, 훈련을 수행할 수 있다. 서비스 서버는 적어도 하나 의 클라이언트 장치로부터 학습 및 예측(prediction) 동작에 필요한 데이터를 수신할 수 있다. 또한, 서비 스 서버는 적어도 하나의 클라이언트 장치에게 예측 결과에 대한 정보를 송신할 수 있다. 데이터 서버는 서비스 서버에 저장된 인공지능 모델의 훈련을 위한 학습 데이터를 제공한다. 다양한 실시 예들에 따라, 데이터 서버는 누구나 접근 가능한 공공 데이터를 제공하거나 또는 허가를 필요로 하는 데이터를 제공할 수 있다. 필요에 따라, 학습 데이터는 데이터 서버에 의해 또는 서비스 서버에 의해 전처리할 수 있다. 다른 실시 예에 따라, 데이터 서버는 생략될 수 있다. 이 경우, 서비스 서버는 외 부에서 훈련된 인공지능 모델을 사용하거나 또는 서비스 서버에 오프라인으로 학습 데이터가 제공될 수 있 다. 적어도 하나의 클라이언트 장치는 서비스 서버에 의해 운용되는 인공지능 모델에 관련된 데이터를 서 비스 서버와 송신 및 수신한다. 적어도 하나의 클라이언트 장치는 사용자에 의해 사용되는 장비이며, 사용자에 의해 입력되는 정보를 서비스 서버에게 송신하고, 서비스 서버로부터 수신되는 정보를 저장 하거나 사용자에게 제공(예: 표시)할 수 있다. 경우에 따라, 어느 하나의 클라이언트로부터 송신된 데이터에 기 반하여 예측 동작이 수행되고, 예측의 결과에 관련된 정보가 다른 클라이언트에게 제공될 수 있다. 적어도 하나 의 클라이언트 장치는 데스크탑 컴퓨터, 랩탑 컴퓨터, 스마트폰, 타블렛, 웨어러블 기기 등 다양한 형태의 컴퓨팅 장치일 수 있다. 도 1에 도시되지 아니하였으나, 시스템은 서비스 서버를 관리하기 위한 관리 장치를 더 포함할 수 있다. 관리 장치는 서비스를 관리하는 주체에 의해 사용되는 장치로서, 서비스 서버의 상태를 모니터링하거나, 서비스 서버의 설정을 제어한다. 관리 장치는 네트워크를 통해 서비스 서버에 접속하거나 또는 케이 블 연결을 통해 직접 연결될 수 있다. 관리 장치의 제어에 따라, 서비스 서버는 동작을 위한 파라미터를 설정할 수 있다. 도 1을 참고하여 설명한 바와 같이, 서비스 서버, 데이터 서버, 적어도 하나의 클라이언트 장치 , 관리 장치 등이 네트워크를 통해 연결되고, 상호작용할 수 있다. 여기서, 네트워크는 유선 네트워크 및 무선 네트워크 중 적어도 하나를 포함할 수 있고, 셀룰러 네트워크, 근거리 네트워크, 광역 네트워크 중 어느 하나 또는 둘 이상의 조합으로 이루어질 수 있다. 예를 들어, 네트워크는 LAN(local area network), WLAN(wireless LAN), 블루투스(bluetooth), LTE(long term evolution), LTE-A(LTE-advanced), 5G(5thgeneration) 중 적어도 하나에 기반하여 구현될 수 있다. 도 2는 본 발명의 일 실시 예에 따른 질병 발생 가능성을 예측하는 장치의 구조를 도시한다. 도 2에 예시된 구 조는 도 1의 서비스 서버, 데이터 서버, 적어도 하나의 클라이언트 장치의 구조로 이해될 수 있 다. 도 2를 참고하면, 장치는, 통신부, 저장부, 제어부를 포함한다. 통신부는 네트워크에 접속하고, 다른 장치와 통신을 수행하기 위한 기능을 수행한다. 통신부는 유선 통신 및 무선 통신 중 적어도 하나를 지원할 수 있다. 통신을 위해, 통신부는 RF(radio frequency) 처리 회로, 디지털 데이터 처리 회로 중 적어도 하나를 포함할 수 있다. 경우에 따라, 통신부는 케이블을 연결 하기 위한 단자를 포함하는 구성요소로 이해될 수 있다. 통신부는 데이터, 신호를 송신 및 수신하기 위한 구성요소이므로, '송수신부(transceiver)'라 지칭될 수 있다. 저장부는 장치의 동작을 위해 필요한 데이터, 프로그램, 마이크로 코드, 명령어 집합, 어플리케이션 등을 저장한다. 저장부는 일시적 또는 비일시적 저장 매체로 구현될 수 있다. 또한, 저장부는 장치에 고정 되어 있거나, 또는 분리 가능한 형태로 구현될 수 있다. 예를 들어, 저장부는 콤팩트 플래시(compact flash, CF) 카드, SD(secure digital) 카드, 메모리 스틱(memory stick), 솔리드 스테이트 드라이브(solid- state drive; SSD) 및 마이크로(micro) SD 카드 등과 같은 낸드 플래시 메모리(NAND flash memory), 하드 디스 크 드라이브(hard disk drive; HDD) 등과 같은 마그네틱 컴퓨터 기억 장치 중 적어도 하나로 구현될 수 있다. 제어부는 장치의 전반적인 동작을 제어한다. 이를 위해, 제어부는 적어도 하나의 프로세서, 적어도 하나의 마이크로 프로세서 등을 포함할 수 있다. 제어부는 저장부에 저장된 프로그램을 실행하고, 통 신부를 통해 네트워크에 접속할 수 있다. 특히, 제어부는 후술하는 다양한 실시 예들에 따른 알고리 즘들을 수행하고, 후술하는 실시 예들에 따라 장치가 동작하도록 제어할 수 있다. 도 1 및 도 2를 참고하여 설명한 구조에 기반하여, 본 발명의 다양한 실시 예들에 따른 인공지능 알고리즘 기반 의 서비스가 제공될 수 있다. 여기서, 인공지능 알고리즘을 구현하기 위해 인공 신경망으로 이루어진 인공지능 모델이 사용될 수 있다. 인공 신경망의 구성 단위인 퍼셉트론(perceptron) 및 인공 신경망의 개념은 다음과 같 다. 퍼셉트론은 생물의 신경 세포를 모델링한 것으로서, 다수의 신호들을 입력으로 삼아 하나의 신호를 출력하는 구 조를 가진다. 도 3은 본 발명에 적용 가능한 인공지능 모델을 구성하는 퍼셉트론의 예를 도시한다. 도 3을 참고 하면, 퍼셉트론은 입력 값들(예: x1, x2, x3, …, xn) 각각 대하여 가중치들(302-1 내지 302-n)(예: w1j, w2j, w3j, …, wnj)을 곱한 후, 가중치 곱해진(weighted) 입력 값들을 변환 함수(transfer function)을 이용하여 합산한다. 합산 과정에서, 바이어스(bias) 값(예: bk)이 더해질 수 있다. 퍼셉트론은 변환 함수의 출력인 네트(net) 입력 값(예: netj)에 대하여 활성 함수(activation function)을 적용함으로써, 출력 값(예: o j)를 생성한다. 경우에 따라, 활성 함수은 임계치(예: θj)에 기반하여 동작할 수 있다. 활성 함수는 다양 하게 정의될 수 있다. 본 발명이 이에 제한되는 것은 아니나, 예를 들어, 활성 함수로서, 스텝 함수(step function), 시그모이드(sigmoid), Relu, Tanh 등이 사용될 수 있다. 도 3와 같은 퍼셉트론들이 나열되고, 레이어를 이룸으로써 인공 신경망이 설계될 수 있다. 도 4는 본 발명에 적 용 가능한 인공지능 모델을 구성하는 인공 신경망의 예를 도시한다. 도 4에서, 원으로 표현된 각 노드는 도 3의 퍼셉트론으로 이해될 수 있다. 도 4를 참고하면, 인공 신경망은 입력 레이어(input layer), 복수의 은닉 레이어(hidden layer)들(404a, 404b), 출력 레이어(output layer)를 포함한다. 예측을 수행하는 경우, 입력 레이어의 각 노드로 입력 데이터가 제공되면, 입력 데이터는 입력 레이어 , 은닉 레이어들(404a, 404b)을 이루는 퍼셉트론들에 의한 가중치 적용, 변환 함수 연산 및 활성 함수 연 산 등을 거쳐 출력 레이어까지 순전파(forward propagation)된다. 반대로, 훈련을 수행하는 경우, 출력 레 이어로부터 입력 레이어를 향한 역전파(backward propagation)를 통해 오차가 계산되고, 계산된 오차 에 따라 각 퍼셉트론에 정의된 가중치 값들이 갱신될 수 있다.GAN(generative adversarial network)은 적대적(adversarial) 학습을 수행하도록 설계된 인공지능 네트워크로 서, 생성자(generator) 및 판별자(discriminator)가 경쟁적으로 학습하며 모두 발전하는 방식으로 훈련이 진행 된다. 즉, 생성자는 판별자의 분류 성공 확률을 낮추고자 노력하고, 판별자는 분류 성공 확률을 높이고자 노력 하면서, 서로를 경쟁적으로 발전시킨다. GAN의 구조는 이하 도 5와 같다. 도 5는 본 발명에 적용 가능한 GAN의 예를 도시한다. 도 5는 샘플(예: 영상)을 분류하는 GAN의 구조를 예시한다. 도 5를 참고하면, GAN은 생성자 및 판별자를 포함한다. 생성자 및 판별자 각각 은 인공 신경망을 포함하며, 생성자는 가짜(fake) 샘플을 생성하고, 판별자는 가짜 샘플을 진짜 (real) 샘플과 구분한다. 구체적으로, 생성자는 랜덤 입력(random input)에 기반하여 합성 샘플 (synthetic sample)을 생성한다. 예를 들어, 랜덤 입력은 잠재 벡터(latent vector)를 포함할 수 있다. 판별자 는 실제 샘플(real sample)을 이용하여 사전에 훈련된 상태로서, 실제 샘플 및 합성 샘플을 구분할 수 있 도록 더 훈련된다. 이를 위해, 판별자는 실제 샘플 및 합성 샘플을 학습 데이터로서 이용하고, 적어도 하나의 손실(loss) 값, 예를 들어, 판별자 손실 및 생성자 손실을 출력한다. 판별자 손실은 실제 샘플을 합성 샘플로 오분류 (misclassify)한 경우 또는 합성 샘플을 실제 샘플로 오분류한 경우에 대한 정보를 포함하며, 판별자에게 패널티로 작용한다. 판별자 손실을 이용하여 역전파가 수행되면, 판별자 내의 인공 신경망의 가중치들이 갱신된다. 생성자는 판별자로부터의 피드백(예: 생성자 손실)에 기반하여 훈련된다. 훈련을 통해, 생 성자는 실제 샘플과 더 유사한 합성 샘플을 생성하도록 발전할 수 있다. 생성자 손실은 판별자가 오 류 없이 분류한 경우에 대한 정보를 포함하며, 생성자에게 패널티로 작용한다. 생성자 손실을 이용하여 역 전파가 수행되면, 생성자 내의 인공 신경망의 가중치들이 갱신된다. 딥러닝(deep learning) 알고리즘을 이용한 흉부(thoracic) 질환의 자동 검출 및 분류 기술은 방사선 전문의 (radiologist)의 진단 및 예상(prognosis)을 지원하기 위한 많은 어플리케이션들을 가진다. 그러나, 의료 분야 에서, 질환들 간 유병(prevalence) 상의 차이로 인해, 등급-불균형의(class-imbalanced) 문제가 매우 흔하다 (extremely common). 많은 GAN-기반의 방식이 흉부 엑스레이(chest X-ray, CXR) 데이터 상의 등급-불균형 문제 를 해결하기 위해 제안된 바 있다. 그러나, 적은 개수의 픽셀들에서 충분한 정보를 추출하는 것은 도전적이므로, 해당 모델들은 작은 크기의(small-sized) 질환에 잘 훈련되지 아니하였다. 이에, 본 발명은 새로운 심층 생성 모델(deep generative model)을 제안한다. 본 발명의 다양한 실시 예들에 따 른 네트워크는 제어 가능한 조건 마스크(controllable conditional mask)를 이용하여 목표 질환의 존재 (presence), 위치(location), 크기(size)를 제어할 수 있다. 본 발명은 조건 마스크에 의해 표현되는 바운딩 영 역(bounded region) 내에서 질환 발생 가능성이 최대화하도록 정의된 손실(loss)를 새로이 제안한다. 이하 설명 의 편의를 위해, 제안되는 인공지능 모델은 'CARIM-cGAN(class activation region influence maximization conditional generative adversarial network)'라 지칭되고, 제안되는 손실은 'CARIM(class activation region influence maximization) 손실(loss)'이라 지칭될 수 있다. 하지만, 인공지능 모델, 손실 등의 명칭에 본 발명 이 제한되는 것은 아니며, 다른 다양한 명칭이 사용될 수 있다. 본 발명의 다양한 실시 예들에 따른 기술은 GAN의 생성자에 대한 것으로, 제어 가능한 조건 마스크를 이용하여 목표 질환에 대한 존재, 위치, 크기 등을 제어할 수 있다. 다양한 실시 예들에 따른 네트워크는 다양한 종류들 의 샘플들(예: 정상 샘플, 서로 다른 위치/크기를 가지는 비정상 샘플 등)을 생성하고, 결과적으로 데이터의 다 양항을 크게 증가시키는데 기여한다. 또한, 다양한 실시 예들에 따른 모델은, 주어진 조건 마스크에 의해 바운 딩되는 영역(bounded region)에 대한 부가적인 제약을 부여하는 CARIM 손실을 이용하여, 작은 크기의 목표 질환 을 가지는 샘플들의 생성을 보장할 수 있다. 이러한 손실 함수는 네트워크가 작은 크기의 질환을 실질적으로 서 술하는 특징(realistic descriptive features)을 학습하는 것에 대해 집중할 수 있게 한다. 본 발명의 다양한 실시 예들은 작은 크기의 질병을 가진 고해상도의 합성 샘플(synthetic sample)들을 생성하는 것에 관련된다. 여기서, 합성 샘플은 엑스레이, 초음파, CT(computerized tomography), MRI(magnetic resonance imaging), PET(positron emission tomography), SPET(single photon emission computed tomography) 등 다양한 형태의 의료 영상들 중 하나이다. 이하 설명에서, 주요 흉부 질병들(major thoracic diseases) 중, 폐 혹(lung nodule)이 목표 질병의 일 예로서 설명된다. 여기서, 혹은 약 3cm 길이의 폐 내에 존재하는 미소한(tiny) 구형의 병변(globular lesion)으로 이해될 수 있다. 이하, 다양한 실시 예들에 따른, 제어 가능한 조건 마스크를 이용하는 다중-스케일(multi-scale) cGAN 및 즉, 작은 크기의 질병을 위한 생성 성능을 개선할 수 있는 기술이 설명된다. 도 6a 및 도 6b는 본 발명의 일 실시 예에 따른 인공지능 모델의 구조의 예를 도시한다. 도 6a 및 도 6b는 생성 자 및 판별자를 포함하는 GAN 기반 인공지능 모델의 구조를 예시한다. 도 6a 및 도 6b는 흉부 엑스레이 영상을 다루는 인공지능 모델을 도시하고 있으나, 도 6a 및 도 6b에 예시된 구조는 다른 종류의 의료 영상 다루는 인공 지능 모델에도 적용될 수 있다. 도 6a 및 도 6b을 참고하면, 인공지능 모델은 생성자들, 판별자들(620a 내지 620c), CARIM 블록을 포함한다. 도 6a 및 도 6b에 도시된 인공지능 모델은 입력으로서 조건 마스크 및 잠재 벡터를 취한다. 조건 마 스크는 목표 질병의 존재, 위치, 크기를 지시하는 이진 이미지(binary image)이며, 0 및 1에 의해 표현되 는 경계 영역에 의해 목표 질병의 존재, 위치, 크기가 제어될 수 있다. 잠재 벡터(예: z~N(0,1))는 합성 샘플을 생성하기 위한 기초가 되는 정보로서, 100 이상의 차원들을 가질 수 있다. 생성자들은 조건 마스크 및 잠재 벡터를 이용하여 다중-스케일 기반으로 합성 샘플을 생성한다. 생성자들은 복수의 모듈들(614a, 614b, 614c)를 포함하며, 복수의 모듈들(614a, 614b, 614c) 중 제1 모듈 (614a)의 은닉(hidden) 상태가 제2 모듈(614b)에게, 제2 모듈(614b)의 은닉 상태가 제3 모듈(614c)에게 전달된 다. 여기서, 은닉 상태는 '은닉 표현(hidden representation)', '은닉 특징(hidden feature)' 등으로 지칭될 수 있다. 또한, 복수의 모듈들(614a, 614b, 614c) 각각은 '컨볼루셔널 모듈(convolutional module)'로 지칭될 수 있다. 조건 마스크 및 잠재 벡터는 제1 모듈(614a)로 입력되기 전 재구성(reshape) 모듈에 의해 가공 된다. 재구성(reshape) 모듈은 맥스 풀링(max pooling) 계층 및 재구성을 포함하는 완전 연결(fully connected) 계층(FC with reshape layer)을 포함하며, 맥스 풀링 계층은 조건 마스크를 초기 합성 샘플 (예: 제1 합성 샘플(618a))의 크기에 대응하는 해상도를 가지도록 수정하고, 재구성을 포함하는 완전 연결 계층 은 수정된 조건 마스크 및 잠재 벡터에 기반하여 제1 모듈(614a)를 위한 입력 데이터를 생성한다. 예를 들 어, 재구성을 포함하는 완전 연결 계층은 시퀀셜(sequential)하게 구성된 다차원 잠재 벡터를 공간적인 (spatial) 잠재 벡터로 변환할 수 있다. 제1 모듈(614a)은 초기 합성 샘플을 위한 제1 은닉 상태를 생성한다. 예를 들어, 제1 모듈(614a)은 초기 합성 샘플에 대응하는 스케일에 따라 점진적으로 영상의 표현을 생성할 수 있다. 다시 말해, 제1 모듈(614a)은 복수 의 합성 곱(convolution) 연산들을 수행함으로써 초기 합성 샘플에 대응하는 스케일에 따라 영상의 해상도를 단 계적으로 높일 수 있다. 여기서, 초기 합성 샘플은 생성자들에 의해 생성되는 합성 샘플들 중 가장 낮은 해상도를 가지는 샘플(예: 제1 합성 샘플(618a))을 의미한다. 제1 모듈(614a)은 서로 다른 크기를 가지는 복수 의 업(up) 블록들을 포함할 수 있다. 여기서, 업 블록은 적어도 하나의 컨볼루셔널(convolutional) 계층, 적어 도 하나의 SN(spectral normalization) 계층, 적어도 하나의 GLU(gated linear unit) 계층을 포함하며, 업샘플 링(upsampling) 동작을 수행할 수 있다. 복수의 업 블록들은 입력 데이터의 공간적(spatial) 해상도를 단계적으 로 증가시킴으로써, 초기 합성 샘플에 대응하는 제1 은닉 상태를 생성한다. 제1 은닉 상태는 제2 모듈(614b) 및 제1 컨볼루셔널 계층(616a)로 제공된다. 제1 컨볼루셔널 계층(616a)은 제1 은닉 상태에 기반하여 초기 합성 샘 플인 제1 합성 샘플(618a)을 생성한다. 즉, 제1 컨볼루셔널 계층(616a)은 제1 모듈(614a)에 의해 생성된 제1 은 닉 상태를 미리 정의된 영상의 형식(format)으로 표현함으로써, 제1 합성 샘플(618a)을 생성할 수 있다. 제2 모듈(614b)은 제2 합성 샘플(618b)을 위한 제2 은닉 상태를 생성한다. 여기서, 제2 합성 샘플(618b)는 제1 합성 샘플(618a) 보다 높은 해상도를 가진다. 제2 모듈(614b)은 적어도 하나의 맥스 풀링 계층, 적어도 하나의 업 블록, 적어도 하나의 잔차(residual) 블록을 포함한다. 여기서, 잔차 블록은 적어도 하나의 업 블록, 입력을 마지막 업 블록의 출력과 결합하는 경로로 구성될 수 있다. 제2 모듈(614b)은 제2 합성 샘플(618b)을 위한 제2 은닉 상태를 생성한다. 여기서, 제2 합성 샘플(618b)는 제1 합성 샘플(618a) 보다 높은 해상도를 가진다. 제2 모듈(614b)은 적어도 하나의 맥스 풀링 계층, 적어도 하나의 업 블록, 적어도 하나의 잔차(residual) 블록을 포함한다. 여기서, 잔차 블록은 적어도 하나의 업 블록, 입력을 마지막 업 블록의 출력과 결합하는 경로로 구성될 수 있다. 예를 들어, 제2 모듈(614b)에서, 맥스 풀링 계층,업 블록, 2개의 잔차 블록들, 업 블록이 순차적으로 연결될 수 있으며, 마지막 업 블록에서 제2 은닉 상태가 출 력될 수 있다. 맥스 풀링 계층은 조건 마스크를 제2 합성 샘플(618b)의 크기에 대응하는 해상도를 가지도 록 수정하고, 업 블록들 및 잔차 블록들은 수정된 조건 마스크에 기반하여 제1 은닉 상태를 포함하는 데이터의 공간적(spatial) 해상도를 단계적으로 증가시킴으로써, 제2 합성 샘플(618b)에 대응하는 제2 은닉 상태를 생성 한다. 제2 은닉 상태는 제3 모듈(614c) 및 제2 컨볼루셔널 계층(616b)로 제공된다. 제2 컨볼루셔널 계층(616b) 은 제2 은닉 상태에 기반하여 제2 합성 샘플(618b)을 생성한다. 제3 모듈(614c)은 제3 합성 샘플(618c)을 위한 제3 은닉 상태를 생성한다. 여기서, 제3 합성 샘플(618c)는 제2 합성 샘플(618b) 보다 높은 해상도를 가진다. 제3 모듈(614c)은 적어도 하나의 맥스 풀링 계층, 적어도 하나의 업 블록, 적어도 하나의 잔차 블록을 포함한다. 여기서, 잔차 블록은 적어도 하나의 업 블록, 입력을 마지막 업 블록의 출력과 결합하는 경로로 구성될 수 있다. 예를 들어, 제3 모듈(614c)에서, 맥스 풀링 계층, 업 블록, 2 개의 잔차 블록들, 업 블록이 순차적으로 연결될 수 있으며, 마지막 업 블록에서 제3 은닉 상태가 출력될 수 있 다. 맥스 풀링 계층은 조건 마스크를 제3 합성 샘플(618c)의 크기에 대응하는 해상도를 가지도록 수정하고, 업 블록들 및 잔차 블록들은 수정된 조건 마스크에 기반하여 제2 은닉 상태를 포함하는 데이터의 공 간적(spatial) 해상도를 단계적으로 증가시킴으로써, 제3 합성 샘플(618c)에 대응하는 제3 은닉 상태를 생성한 다. 제3 은닉 상태는 제3 모듈(614c) 및 제3 컨볼루셔널 계층(616c)로 제공된다. 제3 컨볼루셔널 계층(616c)은 제3 은닉 상태에 기반하여 제3 합성 샘플(618c)을 생성한다. 판별자들(620a 내지 620c)은 생성자들에 의해 생성된 스케일 별 합성 샘플들 및 실제 샘플을 분류한다. 이 때, 판별자들(620a 내지 620c)은 조건 마스크를 이용할 수 있다. 판별자들(620a 내지 620c)은 동일한 구조 를 가질 수 있다. 예를 들어, 도 6b와 같이, 제1 판별자(620a)는 복수의 다운(down) 블록들을 포함할 수 있다. 각 다운 블록은 적어도 하나의 컨볼루셔널 계층, 적어도 하나의 SN 계층, 적어도 하나의 약한 ReLU 계층(reaky ReLU layer)를 포함하며, 다운샘플링을 수행할 수 있다. 합성 샘플 및 실제 샘플이 복수의 다운 블록들 중 하나 로 입력되고, 조건 마스크로부터 얻어진 분류 정보(예: 질병 상태 또는 정상 상태를 지시하는 이진 정보)가 복 수의 다운 블록들 중 다른 하나로 입력될 수 있다. 입력된 데이터(예: 합성 샘플, 실제 샘플, 분류 정보 등)에 기반하여, 적어도 하나의 손실 값, 예를 들어, 비조건부 손실(unconditional loss) 및 조건부 손실 (conditional loss)이 결정될 수 있다. 즉, 복수의 다운 블록들 중 일부는 비조건부 손실을 결정하기 위한 제1 경로를 형성하고, 나머지 일부는 조건부 손실을 결정하기 위한 제2 경로를 형성한다. 합성 샘플 및 실제 샘플은 제1 경로 및 제2 경로에 모두 제공되며, 분류 정보는 제2 경로에만 제공될 수 있다. CARIM 블록은 생성자들의 훈련을 위한 CARIM 손실 값을 생성한다. 여기서, CARIM 손실 값은 조건 마 스크에 의해 특정되는 바운딩된 영역(bounded region) 내에서 CAM(class activation map)의 값을 증가시키도록 설계된다. CARIM 손실은 샘플들 중 가장 높은 해상도를 가지는 제3 샘플(618c) 및 조건 마스크에 기반하여 생성된다. 도 6에 도시되지 아니하였으나, 판별자들(620a 내지 620c)에 의해 생성된 손실 값들 및 CARIM 블록 에 의해 생성된 CARIM 손실 값들을 조합함으로써 최종(final) 손실 값이 결정되고, 최종 손실 값은 생성자 들을 훈련하기 위해 사용될 수 있다. 도 6a 및 도 6b에 예시된 구조와 같이, 일 실시 예에 따른 인공지능 모델은 복수의 생성자들 및 판별자들을 트 리-형태 구조로 포함하며, 다중 스케일들(scales)에서 샘플들의 분포(distribution)를 점진적으로 학습한다. 각 브랜치(branch)에서, 생성자는 대응하는 스케일에서의 샘플들을 생성하고, 판별자는 주어진 샘플들이 해당 스케 일의 학습 데이터로부터 획득된 것인지에 대한 확률을 추정한다. 이에 따라, 네트워크는 생성 단계(generation phase) 동안 다중 브랜치들을 통해 저-해상도에서 고-해상도로 샘플들을 지속적으로(progressively) 생성한다. 다양한 실시 예들에 따른 인공지능 모델의 특징을 정리하면 다음과 같다. 첫째, 제안되는 네트워크는 질병의 존 재, 위치, 크기 중 적어도 하나를 제어하기 위한 제어 가능한 마스크를 사용한다. 둘째, 결정 경계(decision boundary)로부터 얼마나 먼지(how far)에 따라 샘플들에게 불이익을 주기 위해(to penalize) 최소 제곱 GAN 손 실(least-square GAN loss)이 사용된다. 셋째, 체크보드 결함(checkboard artifact)의 발생을 제거하기 위해, 최근접-이웃(nearest-neighbor) 기법이 모든 브랜치들에 대하여 업-샘플링 계층으로서 사용된다. 넷째, 훈련을 안정화하기 위해, SN(spectral normalization) 기법이 생성자들 및 판별자들에 대하여 사용된다. 수학식들을 이용하여 전술한 인공지능 모델의 동작을 다시 설명하면 다음과 같다. 이하 설명에서, 스케일 (scale)은 합성 샘플들의 해상도에 대응하며, 브랜치(branch)는 각 스케일에 해당하는 구성요소들의 집합을 의 미한다. 인공지능 모델은 100-차원 잠재 벡터(latent vector)(예: z~N(0,1)) 및 조건 마스크(예: C)를 입력으로서 사용 하고, 다중 스케일들에서 샘플들을 생성한다. 조건 마스크는 이진 이미지이며, 0 및 1에 의해 표현되는 경계 영 역에 의해 목표 질병의 존재, 위치, 크기가 제어될 수 있다. 조건 마스크는 각 브랜치를 위한 대응되는 스케일 로 리사이즈될(resized) 수 있고, 다음 브랜치를 위한 입력으로서 사용되기 위해, 이전 브랜치의 은닉 표현 (hidden representation)과 연결될(concatenated) 수 있다. 이에 따라, i번째 브랜치의 은닉 표현은 이하 [수 학식 1]과 같이 결정될 수 있다. 수학식 1"}
{"patent_id": "10-2022-0112150", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "[수학식 1]에서, hi는 i번째 브랜치의 은닉 표현, Fi는 i번째 브랜치의 컨볼루셔널 모듈(convolutional module), Ci는 i번째 브랜치를 위한 조건 마스크, M은 브랜치들의 총 개수를 나타낸다. [수학식 1]과 같이, i번째 브랜치의 은닉 표현은 i번째 브랜치의 조건 마스크 및 이전 브랜치인 i-1번째 브랜치 의 은닉 표현을 이용하여 i번째 브랜치의 컨볼루셔널 모듈에 의해 결정될 수 있다. 잡음 벡터 z는 1024개 특징 맵들을 가지는 공간적으로 확장된 초기 은닉 표현(spatially extended initial hidden representations)(예: h0)으로 투영된다(projected). 은닉 표현들이 기반하여, 생성자는 다양한 스케일들로 합성 샘플(synthesized sample)들을 생성하며, 스케일들은 저-해상도로부터 고-해상도를 아우른다. i번째 브랜치에서의 합성 샘플은 이 하 [수학식 2]와 같이 표현될 수 있다. 수학식 2"}
{"patent_id": "10-2022-0112150", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "[수학식 2]에서, 는 i번째 브랜치의 생성자에 의해 생성된 합성 샘플, Gi는 i번째 브랜치의 생성자, hi는 i번 째 브랜치의 은닉 표현, M은 브랜치들의 총 개수를 나타낸다. 판별자 Di는 i번째 브랜치의 스케일에서의 실제 샘플 xi 또는 합성 샘플 &i 및 질병 조건을 입력으로서 취하고 (take), 조건부 및 비조건부 관점들(perspectives) 모두를 학습한다. 조건부 관점은 샘플 및 조건이 매칭되는지 여부를 결정하고, 비조건부 관점은 샘플이 실제인지 또는 합성된 것인지 여부를 구분한다. 수학식 3"}
{"patent_id": "10-2022-0112150", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "[수학식 3]에서, 는 i번째 판별자에서 생성된 손실 값, [F]는 분포 Pdata_i에 따르는 샘플 xi에 대한 F의 기대값, ()는 입력 에 대한 i번째 판별자의 출력 값, [F]는 i번째 생성자에 의해 표현되는 분포 PGi를 따르는 에 대한 F의 기대값, 는 i번째 브랜치에 입력된 실제 샘플, 는 i번째 브랜치 의 생성자에 의해 생성된 합성 샘플, 는 조건 마스크로부터 얻어진 클래스(class) 정보를 나타낸다. 는 혹을 1로, 정상 상태를 0으로 표현한다. 생성자 Gi는 i번째 브랜치의 스케일에서의 샘플들의 비조건부 및 조건부 분포들을 결합적으로 근사화한다 (approximates). 여기서, 생성자 Gi는 관련된 손실을 최소화함으로써 최적화될 수 있다. i번째 브랜치에서의 생 성자 Gi 및 판별자 Di는 서로 겨루며(against each other) 번갈아가며 훈련된다. 여기서, 손실은 이하 [수학식 4]와 같이 정의될 수 있다. 수학식 4"}
{"patent_id": "10-2022-0112150", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 5, "content": "[수학식 4]에서, 는 i번째 생성자에 대한 손실 함수, [F]는 i번째 생성자에 의해 표현되는 분포 PGi 를 따르는 에 대한 F의 기대값, ()는 입력 에 대한 i번째 판별자의 출력 값, 는 i번째 브랜치의 생성자에 의해 생성된 합성 샘플, Ci는 i번째 브랜치를 위한 조건 마스크를 나타낸다. CAM은 CNN이 영상 분류에 있어서 무엇을 찾는지를 가시화할 수 있으며, 예측에 대한 영상 영역의 중요성을 강조 한다. 또한, Grad-CAM(gradient-weighted CAM)은 GAP(global average pooling) 계층에 대한 의존성과 같은 단 점을 보상할 수 있다. 이러한 접근은 k번째 컨볼루셔널 계층의 특징 맵들에서 임의의 클래스에 대한 클래스-차 별적 국부화 맵(class-discriminative localization map)을 정의한다. 여기서, 클래스-차별적 국부화 맵은 이 하 [수학식 5]에 따라 정의될 수 있다. 수학식 5"}
{"patent_id": "10-2022-0112150", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 6, "content": "[수학식 5]에서, 는 클래스-차별적 국부화 맵, ReLU()는 정류된 선형(rectified linear unit) 함수, 는 목표 클래스 c에 대한 특징 맵 k의 뉴런 중요도 가중치(neuron importance weight), 는 k번째 컨볼루션 계 층의 특징 맵, 는 목표 클래스에 대한 스코어(score), 는 목표 클래스에 대한 스코어의 변화도 (gradient), w 및 h는 뉴런 중요도 가중치가 속한 차원의 너비 및 높이를 나타낸다. 는 k번째 특징 맵의 각 원소가 클래스 c의 스코어에 기여한 정도의 평균을 의미한다. [수학식 5]를 참고하면, 목표 클래스 c에 대한 특징 맵 k의 뉴런 중요도 가중치(neuron importance weight)는 너비 및 높이 만큼의 차원들에 걸친 글로벌-평균-풀링된(global-average-pooled) 변화도(gradient)로서 정의된 다. 클래스-차별적 국부화 맵은 특징 맵들 및 뉴런 중요도 가중치들의 선형 조합을 수행하고, ReLU 활성 함수를 적용함으로써 결정될 수 있다. ReLU 활성 함수는 목표 클래스에 대한 긍정적인 영향을 고려하기 위해 적용된다. 선명한(fine-grained) 픽셀-스케일 표현들을 획득하기 위해, 활성 맵들이 업-샘플링될 수 있다.본 발명의 다양한 실시 예에 따라, 새로운 손실인 CARIM 손실이 사용될 수 있다. CARIM 손실은 Grad-CAM의 확장 된 버전으로서, 조건 마스크에 의해 정의되는 바운딩된 영역(bounded region) 내에서 질병이 생성되는 가능성을 높인다. CARIM 손실은 바운딩된 영역 내에서 CAM의 값을 최대화한다. 예를 들어, CARIM 손실은 이하 [수학식 6]과 같이 표현될 수 있다. 수학식 6"}
{"patent_id": "10-2022-0112150", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 7, "content": "[수학식 6]에서, 은 CARIM 손실, 는 조건 마스크에 의해 정의되는 바운딩된 영역, 는 바운딩된 영역 내 원소(element)의 개수, 는 바운딩된 영역 내의 위치 인덱스, 는 위치 x에서 의 최대값 에 의해 평준화된(normalized) CAM의 값을 나타낸다. CARIM 손실 함수는 질병을 분류하는데 있어서의 네트워크 어탠션(attention)을 조건 마스크에 의해 바운딩된 영 역으로 이동시키며, 이는 바운딩된 영역이 분류에 현저하게 영향을 주도록 한다. 이를 통해, CARIM 손실 함수는 조건 마스크에 의해 야기된 목표 질병 병변의 우도(likelihood)를 증가시킬 수 있고, 작은-크기의 질병에 대해 실질적으로 서술하는 특징에 대한 학습을 도울 수 있다. CAM의 결정은 추가적인 선-훈련된 목표 질병 분류를 위한 네트워크를 필요로 한다. 일 실시 예에 따라, 최대의 공공 이용 가능한 흉부 엑스레이 데이터셋으로 훈련된 121-계층 밀집(densely) 연결된 CNN(예: CheXNet)이 선- 훈련된 분류 네트워크로서 선택될 수 있다. 선택된 네트워크는 합성 샘플들을 입력으로서 사용하여 CAM(예: [수 학식 5]에 따른 CAM)을 결정할 수 있다. 주어진 조건 마스크에 의해 바운딩된 영역 내의 CAM의 값들은 손실 함 수(예: [수학식 6]에 따른 손실 함수)에 의해 최대화된다. 예를 들어, 도 6a에 도시된 바와 같이, 마지막 스케 일에서의 샘플들만이 CARIM 손실 계산을 위해 사용되며, 이는 낮은-스케일에서의 샘플들이 작은-크기의 질병을 위한 특징들을 적절하게 표현하지 아니하여 불필요한 연산 오버헤드를 야기하기 때문이다. 결론적으로, 생성자 를 위한 최종적인 손실 함수는 다중-스케일 생성 손실 및 CARIM 손실의 가중치 합에 의해 표현된다. 최종 손실 함수는 엔드-투-엔드 방식으로 네트워크를 학습하는 것을 가능하게 하며, 예를 들어, 이하 [수학식 7]와 같이 결정될 수 있다. 수학식 7"}
{"patent_id": "10-2022-0112150", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 8, "content": "[수학식 7]에서, 는 i번째 생성자에 대한 손실 함수 합, [F]는 i번째 생성자에 의해 표현되는 분포 PGi를 따르는 에 대한 F의 기대값, ()는 입력 에 대한 i번째 판별자의 출력 값, 는 i번째 브랜치 의 생성자에 의해 생성된 합성 샘플, C는 조건 마스크, λ는 CARIM 손실에 대한 가중치 파라미터, 은 CARIM 손실을 나타낸다. 결과적으로, 다양한 실시 예들에 따른 인공지능 모델은 다중 스케일에서 데이터 분포를 학습함으로써 흉부 구조 를 상세하게 묘사하는 고-해상도 샘플들을 생성한다. 또한, 전술한 기술은 주어진 조건 마스크에 의해 바운딩된 영역 내에서 풍부한 표현으로 질병을 생성하는 것을 가능케 한다. 도 7은 본 발명의 일 실시 예에 따른 조건 마스크에 기반하여 클래스 활성화 맵(class activation map) 값을 최 대화하는 동작의 개념을 도시한다. 도 7은 도 6a에 예시된 구조에 포함되는 CARIM 블록의 구조를 예시한다. 도 7을 참고하면, CARIM 블록은 선-훈련된 네트워크 및 CARIM 결정부를 포함한다. 선-훈련된 네트워 크는 CNN, 마지막 컨볼루셔널 계층, 완전 연결 계층을 포함하고, CARIM 결정부는 변 화도 및 가중치 계산부, 합산부, ReLU 필터, CARIM 계산부를 포함한다. CNN는 합성된 가짜 이미지를 입력으로 취하고, 분류를 수행한다. 마지막 컨볼루셔널 계층은 특 징 맵들을 생성한다. 마지막 컨볼루셔널 계층은 CNN의 일부일 수 있다. 완전 연결 계층은 특징 맵들에 기반하여 분류 결과를 나타내는 확률 값을 생성한다. 확률 값에 따라, 정상/혹이 판단될 수 있다. 혹으로 판단된 경우, 마지막 컨볼루셔널 계층에 의해 생성된 특징 맵들에 대한 정보가 CARIM 결정부 에게 전달된다. 변화도 및 가중치 계산부는 특징 맵들의 분류 결과에 대한 변화도 또는 가중치를 결정한다. 합산부는 특징 맵들의 변화도 또는 가중치를 합산한다. ReLU 필터는 합산부에 의해 합산된 결과에 대하여 ReLU 필터링을 수행한다. 이를 통해, ReLU 필터는 CAM 정보를 생성한다. CARIM 계산부는CARIM 손실 값을 결정한다. 이를 위해, CARIM 계산부는 CAM 정보 및 조건 마스크를 이용하며, 조건 마스크 에 의해 특정된 영역 내의 위치들에 관련된 CAM 값들에 기반하여 CARIM 손실 값을 결정할 수 있다. 일 실시 예 에 따라, CARIM 손실 값은 CARIM 손실 값을 이용하여 훈련이 수행된 경우 바운딩된 영역 내의 정보가 분류에 미 치는 영향이 다른 영역에 비하여 커지도록 결정될 수 있다. 이를 위해, 조건 마스크에 의해 특정된 영역 내의 위치들에 관련된 CAM 값들이 작을수록, CARIM 손실 값은 커질 수 있다. 도 8은 본 발명의 일 실시 예에 따라 합성 샘플 및 CARIM 손실을 결정하는 절차의 예를 도시한다. 도 8은 연산 능력을 가진 장치(예: 도 1의 서비스 서버)의 동작 방법을 예시한다. 도 8을 참고하면, S801 단계에서, 장치는 조건 마스크에 기반하여 초기 합성 샘플을 생성한다. 초기 합성 샘플 은 생성자들에 의해 생성되는 샘플들 중 가장 낮은 해상도를 가지는 샘플을 의미한다. 초기 합성 샘플은 조건 마스크 및 잡음 벡터(예: 잠재 벡터)를 이용하여 생성된다. 구체적으로, 장치는 조건 마스크를 초기 합성 샘플 의 해상도에 기반하여 조절하고, 잡음 벡터를 입력 형식으로 변환한(transform) 후, 조절된 조건 마스크 및 변 환된 잡음 벡터를 연결한 결과에 대해 업-샘플링을 수행함으로써 초기 합성 샘플에 대응하는 은닉 상태를 생성 한다. 그리고, 장치는 생성된 은닉 상태에 기반하여 초기 합성 샘플을 생성한다. S803 단계에서, 장치는 초기 합성 샘플에 대응하는 은닉 상태에 기반하여 높은 해상도의 최종 합성 샘플을 생성 한다. 최종 합성 샘플은 초기 합성 샘플에 대응하는 은닉 상태에 기반하여 직접적으로 또는 간접적으로 생성될 수 있다. 예를 들어, 최종 합성 샘플을 생성하기 전, 장치는 적어도 하나의 중간 합성 샘플을 생성할 수 있다. 이 경우, 초기 합성 샘플에 대응하는 은닉 상태 및 조건 마스크에 기반하여 중간 합성 샘플이 생성되고, 중간 합성 샘플에 대응하는 은닉 상태에 기반하여 최종 합성 샘플이 생성될 수 있다. 이때, 중간 또는 최종 합성 샘 플의 생성에 사용되는 데이터는 은닉 상태는 물론 조건 마스크를 더 포함할 수 있다. 또한, 초기 합성 샘플과 달리, 중간 또는 최종 합성 샘플의 생성에 사용되는 데이터는 변환된 잡음 벡터를 포함하지 아니할 수 있다. 즉, 장치는 변환된 잡음 벡터를 대신하여 이전 스케일의 은닉 상태를 사용할 수 있다. S805 단계에서, 장치는 최종 합성 샘플을 이용하여 CARIM 손실 값을 결정한다. CARIM 손실 값은 최종 합성 샘플 은 물론 조건 마스크에 기반하여 생성될 수 있다. CARIM 손실 값은 CARIM 손실 값을 이용하여 훈련이 수행된 경 우 바운딩된 영역 내의 정보가 분류에 미치는 영향이 다른 영역에 비하여 커지도록 결정될 수 있다. 일 실시 예 에 따라, CARIM 손실 값은 조건 마스크에 의해 특정되는 바운딩된 영역 내의 각 위치에 대한 평준화된 CAM 값들 에 기반하여 결정될 수 있다. 여기서, CAM 값은 샘플의 분류에 있어서 판별자가 샘플의 어느 부분에 높은 중요 도를 부여하였는지를 나타내는 정보로서, 샘플 내 위치마다 존재할 수 있다. 즉, 장치는 바운딩된 영역 내의 위 치들 각각에 부여된 CAM 값들 확인하고, 확인된 CAM 값들을 이용하여 CARIM 손실을 결정할 수 있다. 이때, 바운 딩된 영역에서의 CAM 값들이 최대화될 수 있도록, CARIM 손실 값이 결정된다. 도 9는 본 발명의 일 실시 예에 따라 인공지능 모델을 훈련하는 절차의 예를 도시한다. 도 9는 연산 능력을 가 진 장치(예: 도 1의 서비스 서버)의 동작 방법을 예시한다.도 9를 참고하면, S901 단계에서, 장치는 CARIM 손실 값 없이 생성자에 대한 훈련을 수행한다. 즉, 장치는 판별 자에 의해 생성된 손실 값들(예: 조건부 손실 및 비조건부 손실)에 기반하여 생성자를 훈련시킨다. 이를 통해, 판별자에 포함되는 인공 신경망의 가중치들이 갱신될 수 있다. S903 단계에서, 장치는 조건 마스크 및 최종 합성 샘플에 기반하여 CARIM 손실 값을 결정한다. 예를 들어, CARIM 손실 값은 S901 단계의 동작 중 생성되는 최종 합성 샘플에 기반하여 생성될 수 있다. 이 경우, S901 단 계가 수행되는 동안, 장치는 CARAM 손실 값을 생성하고, 저장할 수 있다. 다른 예로, CARIM 손실 값은 S901 단 계의 동작과 독립적으로 생성되는 최종 합성 샘플에 기반하여 생성될 수 있다. 이 경우, 장치는 S901 단계를 통 해 훈련된 생성자를 이용하여 최종 합성 샘플을 포함하는 합성 샘플들을 생성한 후, CARIM 값을 생성할 수 있다. S905 단계에서, 장치는 CARIM 손실 값에 기반하여 생성자에 대한 훈련을 수행한다. 즉, 장치는 CARIM 손실 값에 기반하여 조건 마스크에 의해 특정되는 바운딩된 영역 내에서 CAM 값들이 최대화되도록 생성자를 훈련시킨다. 즉, 장치는 CARIM 손실 값을 이용하여 생성자에 포함되는 인공 신경망에 대한 역전파를 수행함으로써 가중치들 을 갱신할 수 있다. 이때, 일 실시 예에 따라, CARIM 손실에 더하여, 장치는 판별자에 의해 생성된 손실 값을 더 이용하여 훈련을 수행할 수 있다. 도 9와 같이, 생성자에 대한 훈련은 2-단계 방식에 기반하여 수행될 수 있다. 도 9에 예시한 방식의 훈련에 의 해, 모델의 안정성(stability)이 증가할 수 있다. CARIM 손실을 이용하지 아니하는 제1 단계에서, 생성자는 샘 플(예: 영상)의 전반적인 구조를 학습할 수 있으며, 제2 단계에서 상세한 서술적 특징(descriptive features)을 학습하기 때문이다. 이를 통해, 인공지능 모델이 각 단계에서 무엇이 완료되어야 하는지를 명확히 하고, 결과적 으로 GAN 훈련의 안정성 및 수렴성(convergence)에 기여할 수 있다. 제1 단계를 통해 충분한 특징 표현을 가진 후, CARIM 손실을 이용하는 제2 단계가 수행됨으로 인해, 훈련이 더 비용-효율적이 될 수 있다. 도 10a 내지 도 10c는 본 발명의 일 실시 예에 따른 인공지능 모델을 이용하여 생성된 합성 샘플들의 예를 도시 한다. 도 10a, 도 10b, 도 10c 각각은 본 발명의 실시 예에 따른 인공지능 모델에 의해 생성된 합성 샘플 쌍(예: 정상 상태 샘플 및 혹을 포함하는 샘플), 사용된 조건 마스크, 합성 샘플 쌍 간 차분 맵(difference map)을 예시한다. 도 10a를 참고하면, 정상 샘플 및 혹을 포함하는 샘플 간 차이를 나타내는 차분 맵을 살펴보 면, 조건 마스크에서 바운딩된 영역에 해당하는 부분이 다른 부부보다 현저히 밝은 색으로 표현되어 있음 이 확인된다. 즉, 조건 마스크에서 바운딩된 영역에 속한 영역에서 정상 샘플 및 혹을 포함하는 샘 플 간 차이가 있음이 확인되며, 그 차이는 혹의 유무에 의한 것이다. 유사하게, 도 10b를 참고하면, 정상 샘플 및 혹을 포함하는 샘플 간 차이를 나타내는 차분 맵을 살펴보면, 조건 마스크에 서 바운딩된 영역에 해당하는 부분이 다른 부부보다 현저히 밝은 색으로 표현되어 있음이 확인된다. 또한, 도 10c를 참고하면, 정상 샘플 및 혹을 포함하는 샘플 간 차이를 나타내는 차분 맵을 살펴보면, 조건 마스크에서 바운딩된 영역에 해당하는 부분이 다른 부부보다 현저히 밝은 색으로 표현되어 있음이 확인된다. 도 10a 내지 도 10c와 같이, 조건 마스크의 바운딩된 영역이 변화하더라도, 바운딩된 영역 내에서 혹 을 포함하는 합성 영상이 생성됨이 확인된다. 본 발명의 예시적인 방법들은 설명의 명확성을 위해서 동작의 시리즈로 표현되어 있지만, 이는 단계가 수행되는 순서를 제한하기 위한 것은 아니며, 필요한 경우에는 각각의 단계가 동시에 또는 상이한 순서로 수행될 수도 있 다. 본 발명에 따른 방법을 구현하기 위해서, 예시하는 단계에 추가적으로 다른 단계를 포함하거나, 일부의 단 계를 제외하고 나머지 단계를 포함하거나, 또는 일부의 단계를 제외하고 추가적인 다른 단계를 포함할 수도 있 다. 본 발명의 다양한 실시 예는 모든 가능한 조합을 나열한 것이 아니고 본 발명의 대표적인 양상을 설명하기 위한 것이며, 다양한 실시 예에서 설명하는 사항들은 독립적으로 적용되거나 또는 둘 이상의 조합으로 적용될 수도 있다. 또한, 본 발명의 다양한 실시 예는 하드웨어, 펌웨어(firmware), 소프트웨어, 또는 그들의 결합 등에 의해 구현 될 수 있다. 하드웨어에 의한 구현의 경우, 하나 또는 그 이상의 ASICs(Application Specific IntegratedCircuits), DSPs(Digital Signal Processors), DSPDs(Digital Signal Processing Devices), PLDs(Programmable Logic Devices), FPGAs(Field Programmable Gate Arrays), 범용 프로세서(general processor), 컨트롤러, 마이크로 컨트롤러, 마이크로 프로세서 등에 의해 구현될 수 있다. 본 발명의 범위는 다양한 실시 예의 방법에 따른 동작이 장치 또는 컴퓨터 상에서 실행되도록 하는 소프트웨어 또는 머신-실행가능한 명령들(예를 들어, 운영체제, 애플리케이션, 펌웨어(firmware), 프로그램 등), 및 이러한 소프트웨어 또는 명령 등이 저장되어 장치 또는 컴퓨터 상에서 실행 가능한 비-일시적 컴퓨터-판독가능 매체 (non-transitory computer-readable medium)를 포함한다."}
{"patent_id": "10-2022-0112150", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 일 실시 예에 따른 시스템을 도시한다. 도 2는 본 발명의 일 실시 예에 따른 질병 발생 가능성을 예측하는 장치의 구조를 도시한다. 도 3은 본 발명에 적용 가능한 인공지능 모델을 구성하는 퍼셉트론(perceptron)의 예를 도시한다. 도 4는 본 발명에 적용 가능한 인공지능 모델을 구성하는 인공 신경망의 예를 도시한다. 도 5는 본 발명에 적용 가능한 GAN(generative adversarial network)의 예를 도시한다. 도 6a 및 도 6b는 본 발명의 일 실시 예에 따른 인공지능 모델의 구조의 예를 도시한다. 도 7은 본 발명의 일 실시 예에 따른 조건 마스크(conditional mask)에 기반하여 클래스 활성화 맵(class activation map) 값을 최대화하는 동작의 개념을 도시한다. 도 8은 본 발명의 일 실시 예에 따라 합성 샘플 및 CARIM(class activation region influence maximization) 손실을 결정하는 절차의 예를 도시한다. 도 9는 본 발명의 일 실시 예에 따라 인공지능 모델을 훈련하는 절차의 예를 도시한다. 도 10a 내지 도 10c는 본 발명의 일 실시 예에 따른 인공지능 모델을 이용하여 생성된 합성 샘플들의 예를 도시 한다."}
