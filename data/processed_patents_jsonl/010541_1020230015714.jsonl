{"patent_id": "10-2023-0015714", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2024-0123136", "출원번호": "10-2023-0015714", "발명의 명칭": "GRU 모델을 활용한 EEG 신호 분류 시스템", "출원인": "건양대학교산학협력단", "발명자": "김웅식"}}
{"patent_id": "10-2023-0015714", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "사용자의 두부에 장착된 복수의 전극을 통해 뇌파신호를 측정하는 측정부(111)와, 행동 또는 생각에 대한 정보를 입력받는 정보입력부(112)를 구비하여 수집된 뇌파 EEG 신호 분류 시스템에 있어서,상기 측정부(111)를 통해 획득한 뇌파 데이터를 텍스트 파일로 포맷 변환하는 변환모듈(120);상기 텍스트 파일 데이터에서 사용하는 전극의 데이터 외 필요없는 부분을 제거하는 전처리부(131)와, 측정된뇌파에 대응하는 각 행동별 라벨을 붙여 라벨링을 진행하는 라벨링부(132)와, 라벨링된 데이터의 셔플을 진행하여 표 형태의 데이터를 저장하는 파일 형식으로 저장하는 저장부(133)를 구비하는 데이터 전처리모듈(130);상기 전처리모듈(130)을 거친 데이터의 학습 및 검증을 진행하는 딥러닝모듈(140);상기 딥러닝모듈(140)의 검증 결과를 출력하는 출력모듈(150); 로 이루어지는 것을 특징으로 하는 GRU 모델을활용한 EEG 신호 분류 시스템."}
{"patent_id": "10-2023-0015714", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 측정부(111)를 통해 획득한 뇌파 데이터는 RAW 데이터로서 BDF 파일인 것을 특징으로 하는 GRU 모델을 활용한 EEG 신호 분류 시스템."}
{"patent_id": "10-2023-0015714", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1항에 있어서,상기 변환모듈(120)은 0.002초 주기로 저장한 데이터를 텍스트 파일로 저장하는 것을 특징으로 하는 GRU 모델을활용한 EEG 신호 분류 시스템."}
{"patent_id": "10-2023-0015714", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제1항에 있어서,상기 표 형태의 데이터는 CSV 형식의 파일인 것을 특징으로 하는 GRU 모델을 활용한 EEG 신호 분류 시스템."}
{"patent_id": "10-2023-0015714", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 뇌파측정 기기를 통해 획득한 뇌파 데이터를 전처리를 통해 활용 가능한 데이터로 변환하고 이를 GRU 인공지능 모델을 통해 분류하는 GRU 모델을 활용한 EEG 신호 분류 시스템에 관한 것이다."}
{"patent_id": "10-2023-0015714", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 EEG(Electro Encephalo Gram, 이하, 'EEG'라 칭함) 신호분류 시스템에 관한 것으로, 자세하게는 뇌 파측정 기기를 통해 획득한 뇌파 데이터를 전처리를 통해 활용 가능한 데이터로 변환하고 이를 GRU 인공지능 모 델을 통해 분류하는 GRU 모델을 활용한 EEG 신호 분류 시스템에 관한 것이다."}
{"patent_id": "10-2023-0015714", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "일반적으로 인간의 뇌는 다수개의 신경세포(Neron)의 상호결합 또는 활동에 의하여 다양한 움직임을 나타내며, 뇌의 활동에 따라 발생하는 미세한 뇌 표면의 신호인 EEG를 통해 뇌의 활동을 외부에서 측정할 수 있다. 이러한 뇌파검사는 종양, 뇌졸중 등 뇌 질환 및 정신질환을 진단하기 위한 방법으로서, 자기공명영상(Magnetic Resonance Imaging, MRI), 컴퓨터단층촬영술(Computed Tomography, CT)에 비해 저렴하고 간단하게 환자 뇌에대한 진단을 수행할 수 있어, 여러 의료기관에서 사용되고 있는 뇌 질환 진단기법 중 하나이며, 뇌파를 이용한 인터페이스 구축으로 두뇌와 컴퓨터의 상호작용인 BCI(Brain Computer Interface) 등 뇌파의 응용 분야가 넓어 지고 있다. 현재 BCI에 관한 많은 연구가 수행되고 있으나, 뇌-컴퓨터 인터페이스 관련 기술은 장기간의 기초기술을 토대로 이루어져야 하기 때문에 우리나라는 선진국들에 비해 아직 연구가 부족하고, 상업화된 실용화 기술을 선보이지 못하고 있다. 이에 정부에서는 '뇌연구촉진법'을 제정하여 법적 토대를 구축하였고, 대학에서는 KAIST를 중심으 로 뇌파로 인간형 로봇을 움직이는 연구, 아바타 로봇 등의 연구가 수행 중이며, 기업에서는 에스엔티글로벌이 마인드셋을 시판중이다. 하지만, 두뇌와 컴퓨터 간의 인터페이스는 개인마다 행동특성이 다르며 사용자의 행동 또는 생각에 따른 뇌파의 불일치로 인해 뇌파를 통해 사용자의 행동 또는 생각을 유추해내는 작업이 어려운 현실이다. 이를 위해 뇌파 측정값에 대한 유효성을 보증하기 위한 보정(Calibration)이 이루어져야 하며, 측정된 뇌파에 대한 객관적인 보정을 통해 정확하게 사용자의 뇌파를 인식할 수 있는 방법이 요구되고 있다. 선행기술문헌 특허문헌 (특허문헌 0001) 대한민국 등록특허 제10-2461647호(2022.10.27)"}
{"patent_id": "10-2023-0015714", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은 상기와 같은 문제를 해결하기 위하여 창출된 것으로, 본 발명의 목적은 대상자가 행동을 취했을 때에 뇌파의 신호가 정확히 어떤 행동인지를 유추함에 있어 높은 수준의 정확도를 확보하기 위해 EEG 신호의 전처리 과정을 통해 보정하여 활용 가능한 데이터로 변환하고 이를 GRU 인공지능 모델을 통해 분류하는 GRU 모델을 활 용한 EEG 신호 분류 시스템을 제공하는 것이다."}
{"patent_id": "10-2023-0015714", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "상기와 같은 목적을 위해 본 발명은 사용자의 두부에 장착된 복수의 전극을 통해 뇌파신호를 측정하는 측정부와, 행동 또는 생각에 대한 정보를 입력받는 정보입력부를 구비하여 수집된 뇌파 EEG 신호 분류 시스템에 있어서, 상기 측정부를 통해 획득한 뇌파 데이터를 텍스트 파일로 포맷 변환하는 변환모듈; 상기 텍스트 파일 데이터에서 사용하는 전극의 데이터 외 필요없는 부분을 제거하는 전처리부와, 측정된 뇌파에 대응하는 각 행동 별 라벨을 붙여 라벨링을 진행하는 라벨링부와, 라벨링된 데이터의 셔플을 진행하여 표 형태의 데이터를 저장하 는 파일 형식으로 저장하는 저장부를 구비하는 데이터 전처리모듈; 상기 전처리모듈을 거친 데이터의 학습 및 검증을 진행하는 딥러닝모듈; 상기 딥러닝모듈의 검증 결과를 출력하는 출력모듈; 로 이루어지는 것을 특징으로 한다. 이때, 상기 측정부를 통해 획득한 뇌파 데이터는 RAW 데이터로서 BDF 파일이 될 수 있다인 것을 특징으로 하는 GRU 모델을 활용한 EEG 신호 분류 시스템. 또한, 상기 변환모듈은 0.002초 주기로 저장한 데이터를 텍스트 파일로 저장할 수 있다. 또한, 상기 표 형태의 데이터는 CSV 형식의 파일이 될 수 있다."}
{"patent_id": "10-2023-0015714", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명을 통해 BCI의 기초 개발 연구를 진행시 각 행동의 뇌파 데이터를 측정하여 GRU 모델을 통해 딥러닝을 진행하여 학습을 한 이후 뇌파를 측정한 데이터를 입력하면 뇌파의 데이터가 어떤 행동을 하였을 때의 뇌파인지 를 효과적으로 분류할 수 있다."}
{"patent_id": "10-2023-0015714", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하 첨부된 도면을 참고하여 본 발명 GRU 모델을 활용한 EEG 신호 분류 시스템의 구성을 구체적으로 설명한다. 도 1은 본 발명의 실시예에 따른 측정장치를 포함하는 전체 시스템 구조도, 도 2는 본 발명의 실시예에 따른 구 성 및 연결관계를 나타낸 블록도, 도 3은 본 발명의 실시예에 따른 데이터 처리 순서도이다. 본 발명은 기본적으로 뇌파측정장치와, 데이터베이스와, 서버를 통해 구성될 수 있다. 상기 뇌파측정장치는 사용자의 두부에 장착된 복수의 전극을 통해 뇌파신호를 측정하는 측정부와, 행 동 또는 생각에 대한 정보를 입력받는 정보입력부를 구비한다. 즉 사용자가 상기 정보입력부를 통해 입력된 행동 또는 생각에 따라 발생하는 뇌파를 상기 측정부를 통해 측정하게 된다. 상기 데이터베이스는 상기 뇌파측정장치로부터 측정된 뇌파신호를 딥러닝을 위한 빅데이터로 저장하 는 구성이므로, 수집된 뇌파 EEG 신호 분류를 위한 데이터 전처리와 딥러닝을 수행하는 핵심 구성인 변환모듈 과, 전처리모듈과, 딥러닝모듈과 출력모듈은 서버에 구비된다. 상기 변환모듈은 상기 측정부를 통해 획득한 뇌파 데이터를 텍스트 파일로 포맷변환하는 구성이다. 본 발명의 실시예에서 상기 측정부를 통해 획득한 뇌파 데이터는 RAW 데이터로서 BDF 파일이 되며, 상기 변환모 듈은 0.002초 주기로 저장한 데이터를 텍스트 파일로 저장한다. 도 4는 본 발명의 실시예에 따른 BDF 파일 형식을 나타낸 예시도로서, 뇌파를 측정시 저장되는 기본 형태를 나 타내고 있다. 뇌파 측정 프로그램을 설치해야 BDF 파일을 사용할 수 있다. 상기 변환모듈은 이러한 BDF 파일에서 데이터-현재화면 TXT로 저장을 누름에 따라 측정된 뇌파 측정데이터 를 0.002초마다 저장한 데이터가 TXT 파일로 변환된다. 상기 전처리모듈은 상기 변환모듈을 통해 변환된 텍스트 파일을 원활한 딥러닝을 위한 데이터로 전처리하 는 구성으로, 세부구성으로 전처리부와, 라벨링부 및 저장부를 구비한다. 상기 전처리부는 상기 텍스트 파일 데이터에서 사용하는 전극의 데이터 외 필요없는 부분을 제거한다. 도 5는 본 발명의 실시예에 따른 TXT 파일 형식을 나타낸 예시도로서, BDF파일에서 txt 파일로 저장된 형태를 나타내고 있으며 0.002초간의 뇌파 데이터가 한줄로 저장되어 있다. 이때 텍스트 파일의 내용 중 위의 6줄(Bioteck text, Sampling Rate, 파일, Trigger Positions)은 사용하지 않 는 불필요한 데이터로서 CSV 파일로 변환전에 상기 전처리부를 통해 삭제하여 저장 및 활용한다. 도 3에서 데이터 전처리 블록에서는 Txt 파일을 csv파일로 변경하는 부분과 쉼표를 없에는 부분을 강조 표시하 였다. ,(쉼표)를 없애는 이유는 천의 자리가 넘어갈 경우 1,0xx 이런 식의 숫자가 나오는데 구분자를 tab 이 아닌 , 로 구분하기 때문에 수에 있는 쉼표를 구분자로 구분하여 1 , 0xx 이런 식으로 숫자를 나누어 변환하기 때문에 , 를 삭제하고 난 후 Tab 을 통한 구분자를 , 를 통한 구분자로 변경하여 사용한다. Txt 파일에서 전처리 과정을 걸쳐 나온 최종 활용 데이터로서, F7(uV), Fp1(uV) .. 등은 뇌파 측정시 전극의 위 치이다.상기 라벨링부는 측정된 뇌파에 대응하는 각 행동별 라벨을 붙여 라벨링을 진행하고, 상기 저장부는 상기 라벨링부를 통해 라벨링된 데이터의 셔플을 진행하여 표 형태의 데이터를 저장하는 파일 형식으로 저 장한다. 본 발명의 실시예에서 상기 표 형태의 데이터는 CSV 형식의 파일이 된다. 도 6은 본 발명의 실시예에 따른 CSV 파일 형식을 나타낸 예시도, Txt 파일에서 파이썬을 통한 인공지능 모델에 서 활용하기 위해 최종 변환된 데이터 형태를 나타내고 있다. 라벨링(label)은 전처리 과정에서 지도 학습을 위해 부여한 데이터의 라벨을 뜻한다. (0=눈뜬 상태, 1=눈감은 상태, 2=왼손을 흔드는 상태, 3=오른손을 흔드는 상태, 4=암산 상태) 데이터를 셔플을 한 이유는 딥러닝 시 같은 패턴이 반복이 되면 학습이 제대로 이루어지지 않기 때문에 전처리 과정에서 셔플을 진행한다. 상기 딥러닝모듈은 상기 전처리모듈을 거친 데이터의 학습 및 검증을 진행하는 구성으로 본 발명에서는 GRU 모델을 활용하며, 상기 출력모듈은 상기 딥러닝모듈의 검증 결과를 출력한다. 도 7은 본 발명의 실시예에 따른 딥러닝 조건을 나타낸 구조도이다. 딥러닝의 학습에서는 최대한 틀리지 않는 방향으로 학습해 나가야 하며, 여기서 얼마나 틀리는지(loss)를 알게 하는 함수가 loss function=손실함수이다. 본 발명의 실시예에서는 이러한 loss function의 최소값을 찾는 것을 학습의 목표로 하며, 여기서 최소값을 찾아가는 것을 최적화=Optimization이라고 하고, 이를 수행하는 알고리즘 이최적화 알고리즘=Optimizer이다. 본 발명의 실시예에서는 이 옵티마이저로 Adam 옵티마이저를 사용한다. 또한, es = EarlyStopping 은 과적합(과도하게 학습된 경우) 을 막기 위해 사용하며, 각 항목을 다음과 같다. - monitor: 학습 조기종료를 위해 관찰하는 항목이다. val_loss 나 val_accuracy 가 주로 사용된 다.(default:val_loss) - min_delta: 개선되고 있다고 판단하기 위한 최소 변화량을 나타낸다. 만약 변화량이 min_delta 보다 적은 경 우에는 개선이 없다고 판단한다.(default=0) - patience: 개선이 안된다고 바로 종료시키지 않고, 개선을 위해 몇 번의 에포크를 기다릴지 설정한 다.(default=0) - mode: 관찰항목에 대해 개선이 없다고 판단하기 위한 기준을 설정한다. monitor에서 설정한 항목이 val_loss 이면 값이 감소되지 않을 때 종료하여야 하므로 min을 설정하고, val_accuracy의 경우에는 max를 설정해야 한다. (default =auto) - auto: monitor에 설정된 이름에 따라 자동으로 지정한다. - min: 관찰값이 감소하는 것을 멈출 때, 학습을 종료한다. - max: 관찰값이 증가하는 것을 멈출 때, 학습을 종료한다. 도 8은 본 발명의 실시예에 따른 데이터 검증 후의 정확도를 나타낸 결과 표이다. 본 발명의 실시예에서는 비침습식 뇌파 측정 기기(CGX-Quick-20r)를 머리에 씌워 22개의 전극에서 30초간 0.002 초간격으로 수집한 EEG 데이터를 활용한다. 데이터는 ① 눈 뜬 상태, ② 눈 감은 상태, ③ 왼손을 들고 흔드는 상태, ④ 오른손을 들고 흔드는 상태, ⑤ 암산하는 상태로 상기 정보입력부를 통해 입력하며 측정이 된다. 데이터의 로우데이터 상태는 직접 데이터를 활용하는데 어려움이 있어 전처리 작업을 진행한다. 데이터에서 필요없는 쓰레기값을 제외 후 사용하는 전극 데이터만 남긴다. 데이터 측정의 정확도를 위해 앞 1.5 초 뒤 1.5초씩 잘라서 사용한다. 데이터의 저장형태가 txt 파일로 되어있어 csv 파일로 변경을 해준다. 구분자를 ,(쉼표)로 사용하여 구분하기 위해 1,000 자리가 넘어가는 데이터의 , 를 삭제해 준다. 이후 탭(띄어쓰기, 공백) 으로 되어있는 구분자를 , 로 바꿔주는 작업을 진행한 후각 데이터 행 마지막에 라벨 을 붙인 후 셔플을 한다. (라벨은 눈뜬 상태 0, 눈감은 상태 1, 왼손 흔들기 2, 오른손 흔들기 3, 암산 4로 한 다.)이후 각 행동 데이터를 하나로 합쳐 하나의 CSV 파일로 만든다. 데이터를 7:3 비율로 나누며, 학습데이터 7, 검증 데이터를 3으로 한다. GRU 구조 모델(input-gru-flatten- dense 구조)에 학습데이터를 넣어 학습을 시킨다. 학습시 Optimizer는 Adam을 사용한다. EarlyStopping 기술을 사용하여 과적합을 막는다. 이때 학습시에는 라벨을 붙인 상태로 학습을 하는 ‘지도학습’을 진행한다. 이후 데이터 검증 시에는 라벨이 없는 데이터를 제시하여 제시한 데이터가 어떤 행동의 데이터인지 맞추는 Classification 을 진행한다. Classification 하였을 때 각 데이터의 개수는 동일하다. 즉 445,500개의 데이터 행을 5로 나누었을 때 각 행동 별 데이터는 89,100행이 존재한다. 성능 평가지표에서 Accuracy(정확도)가 90.98% 가 나온다. 도 8은 Normalized Confusion Matrix로 확인하였을 때, 라벨별로 어떻게 구분하였는지를 보여준다. 짙은 파란색 은 True 일 때 True인 정확도를 나타낸다. 예를 들어 눈뜬 상태로 구분한 데이터가 실제 눈뜬 상태인 데이터의 비율일 경우이다. 본 발명의 권리는 위에서 설명된 실시 예에 한정되지 않고 청구범위에 기재된 바에 의해 정의되며, 본 발명의 분야에서 통상의 지식을 가진 자가 청구범위에 기재된 권리범위 내에서 다양한 변형과 개작을 할 수 있다는 것 은 자명하다."}
{"patent_id": "10-2023-0015714", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 실시예에 따른 측정장치를 포함하는 전체 시스템 구조도, 도 2는 본 발명의 실시예에 따른 구성 및 연결관계를 나타낸 블록도, 도 3은 본 발명의 실시예에 따른 데이터 처리 순서도, 도 4는 본 발명의 실시예에 따른 BDF 파일 형식을 나타낸 예시도, 도 5는 본 발명의 실시예에 따른 TXT 파일 형식을 나타낸 예시도, 도 6은 본 발명의 실시예에 따른 CSV 파일 형식을 나타낸 예시도, 도 7은 본 발명의 실시예에 따른 딥러닝 조건을 나타낸 구조도, 도 8은 본 발명의 실시예에 따른 데이터 검증 후의 정확도를 나타낸 결과 표이다."}
