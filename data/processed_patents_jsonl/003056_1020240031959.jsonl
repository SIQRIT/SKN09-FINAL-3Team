{"patent_id": "10-2024-0031959", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2025-0045436", "출원번호": "10-2024-0031959", "발명의 명칭": "이미지 인식 장치와 방법 및 그에 관련된 프롬프트 튜닝 방법", "출원인": "한국전자통신연구원", "발명자": "김형일"}}
{"patent_id": "10-2024-0031959", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "이미지 인식 장치에 있어서,입력 이미지에 대하여 이미지 특징 정보를 추출하는 제1 인코딩 모듈;상기 입력 이미지의 분할과 관련된 사용자 입력을 인코딩(encoding)하여 프롬프트 정보를 추출하는 제2 인코딩모듈;상기 이미지 특징 정보 및 상기 추출된 프롬프트 정보를 이용하여 지정된 목적에 따라 상기 추출된 프롬프트 정보를 튜닝(tunning)하는 튜닝 모듈; 및상기 이미지 특징 정보 및 상기 튜닝된 프롬프트 정보에 기반하여 분할 마스크(segmentation mask)를 생성하는분할 모듈;을 포함하는 이미지 인식 장치."}
{"patent_id": "10-2024-0031959", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "청구항 1에 있어서, 상기 튜닝 모듈은,상기 추출된 프롬프트 정보 및 상기 이미지 특징 정보 중 적어도 하나의 정보에 자기 집중(self-attention) 연산, 상호 집중(cross-attention) 연산 및 다층 퍼셉트론(multi-layer perceptron)을 적용하여 프롬프트 변화량을 획득하고,상기 프롬프트 변화량과 상기 추출된 프롬프트 정보에 기반하여 상기 튜닝된 프롬프트 정보를 생성하는 것인 이미지 인식 장치."}
{"patent_id": "10-2024-0031959", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "청구항 2에 있어서, 상기 튜닝 모듈은,상기 추출된 프롬프트 정보에 대해 자기 집중 연산을 수행하는 제1 연산기; 상기 제1 연산기의 출력과 상기 이미지 특징 정보에 대해 상호 집중 연산을 수행하는 제2 연산기; 및상기 제2 연산기의 출력에 기반하여 프롬프트 변화량을 추출하는 다층 퍼센트론을 포함하는 것인 이미지 인식장치."}
{"patent_id": "10-2024-0031959", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "청구항 3에 있어서, 상기 제2 연산기는,상기 제1 연산기의 결과를 쿼리(query)로 획득하고, 상기 이미지 특징 정보로부터 키(key) 및 값(value)을 획득하여 상기 상호 집중 연산을 수행하는 것인 이미지 인식 장치."}
{"patent_id": "10-2024-0031959", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "청구항 3에 있어서, 상기 제2 연산기는, 각기 다른 파라미터를 이용하여 상호 집중 연산을 수행하는 복수의 서브 연산부들을 포함하고, 상기 튜닝 모듈은,상기 복수의 서브 연산부들의 출력을 결합하는 특징 연쇄부를 더 포함하는 이미지 인식 장치."}
{"patent_id": "10-2024-0031959", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "청구항 2에 있어서, 상기 튜닝 모듈은,공개특허 10-2025-0045436-3-상기 프롬프트 변화량과 상기 프롬프트 정보를 가중합하여 상기 튜닝된 프롬프트 정보를 생성하는 것인 이미지인식 장치."}
{"patent_id": "10-2024-0031959", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "청구항 1에 있어서, 상기 이미지 특징 정보에 기반하여 상기 분할 마스크의 대표 포인트를 학습하는 추론기를 더 포함하고, 상기 튜닝 모듈은, 상기 추론기의 오차에 기반하여 상기 지정된 목적에 따른 상기 추출된 프롬프트 정보의 튜닝을 학습하는 것인이미지 인식 장치."}
{"patent_id": "10-2024-0031959", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "청구항 7에 있어서, 상기 추론기는, 상기 이미지 특징 정보를 상기 입력 이미지에 대응하도록 스케일 변환하는 변환부;상기 변환된 이미지 특징 정보로부터 복수의 특징들을 추출하는 심층 신경망; 상기 복수의 특징들에 기반하여 상기 대표 포인트로서 상기 분할 마스크의 경계 포인트를 추정하는 추정부; 및상기 추정된 경계 포인트와 정답 간의 오차를 산출하는 산출부를 포함하는 것인 이미지 인식 장치."}
{"patent_id": "10-2024-0031959", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "청구항 8에 있어서, 상기 복수의 특징들은, 제1 특징 및 제2 특징을 포함하고, 상기 심층 신경망은,상기 변환된 이미지 특징 정보로부터 이미지 토큰 단위의 상기 제1 특징을 추출하는 컨볼루션 연산부; 및 상기변환된 이미지 특징 정보에 대해 자기 집중 연산을 수행함에 따라 상기 제2 특징을 추출하는 트랜스포머를 포함하는 것인 이미지 인식 장치."}
{"patent_id": "10-2024-0031959", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "이미지 분할과 관련된 프롬프트 튜닝 방법으로서, 입력 이미지로부터 입력된 프롬프트 정보에 대응하는 분할 마스크를 생성하는 분할 모듈에 의해 생성된 특징 맵을 획득하는 동작;상기 특징 맵에 기반하여 지정된 목적에 따른 상기 분할 마스크의 대표 포인트를 학습하는 동작; 상기 대표 포인트의 학습 오차에 기반하여 상기 프롬프트 정보를 지정된 목적에 따라 튜닝하는 동작; 및상기 튜닝된 프롬프트 정보를 상기 입력 이미지와 관련하여 상기 분할 모듈의 입력으로 제공하는 동작을 포함하는 프롬프트 튜닝 방법."}
{"patent_id": "10-2024-0031959", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "청구항 10에 있어서, 상기 학습하는 동작은, 상기 생성된 특징 맵을 상기 입력 이미지에 대응하도록 스케일 변환하는 동작; 심층 신경망을 이용하여 상기 변환된 특징 맵으로부터 복수의 특징들을 추출하는 동작; 상기 복수의 특징들에 기반하여 상기 분할 마스크의 경계 포인트를 추정하는 동작; 및상기 추정된 경계 포인트와 정답 간의 오차를 최소화하는 동작을 포함하는 프롬프트 튜닝 방법."}
{"patent_id": "10-2024-0031959", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "청구항 11에 있어서, 공개특허 10-2025-0045436-4-상기 복수의 특징들은, 제1 특징 및 제2 특징을 포함하고, 상기 추출하는 동작은,컨볼루션(convolution) 연산을 통해 상기 변환된 이미지 특징 정보로부터 이미지 토큰 단위의 상기 제1 특징을추출하는 동작; 및 트랜스포머(transformer)를 이용하여 상기 변환된 이미지 특징 정보에 대해 자기 집중 연산을 수행함에 따라 상기 제2 특징을 추출하는 동작을 포함하는 것인 프롬프트 튜닝 방법."}
{"patent_id": "10-2024-0031959", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "청구항 11에 있어서, 상기 최소화하는 동작은,상기 추출하는 동작 및 상기 추정하는 동작에 사용되는 제1 파라미터들을 조절하는 동작을 포함하는 프롬프트튜닝 방법."}
{"patent_id": "10-2024-0031959", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_14", "content": "청구항 13에 있어서, 상기 최소화하는 동작은,상기 튜닝하는 동작에 사용되는 제2 파라미터들을 조절하는 동작; 및상기 제2 파라미터의 조절 후 상기 분할 모듈에 의해 상기 입력 이미지로부터 생성된 다른 특징 맵으로부터 복수의 특징들의 획득, 상기 경계 포인트의 추정 및 상기 오차의 산출을 반복함에 따라 상기 오차를 최소화하는동작을 더 포함하는 프롬프트 튜닝 방법."}
{"patent_id": "10-2024-0031959", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_15", "content": "청구항 11에 있어서, 상기 입력된 프롬프트 정보는,포인트, 바운딩 박스, 마스크 및 사용자 음성 중 적어도 하나의 사용자 입력을 인코딩함에 따라 생성된 것인 프롬프트 튜닝 방법."}
{"patent_id": "10-2024-0031959", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_16", "content": "이미지 분할 방법으로서입력 이미지에 대하여 이미지 특징 정보를 추출하는 동작;상기 입력 이미지의 분할과 관련된 사용자 입력을 인코딩하여 프롬프트 정보를 추출하는 동작;상기 이미지 특징 정보 및 상기 추출된 프롬프트 정보를 이용하여 지정된 목적에 따라 상기 추출된 프롬프트 정보를 튜닝하는 동작; 및상기 이미지 특징 정보 및 상기 튜닝된 프롬프트 정보에 기반하여 분할 마스크(segmentation mask)를 생성하는동작을 포함하는 이미지 분할 방법."}
{"patent_id": "10-2024-0031959", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_17", "content": "청구항 16에 있어서, 상기 튜닝하는 동작은,상기 추출된 프롬프트 정보 및 상기 이미지 특징 정보 중 적어도 하나의 정보에 자기 집중(self-attention) 연산, 상호 집중(cross-attention) 연산 및 다층 퍼셉트론(multi-layer perceptron)을 적용하여 프롬프트 변화량을 획득하는 동작; 및상기 프롬프트 변화량과 상기 추출된 프롬프트 정보에 기반하여 상기 튜닝된 프롬프트 정보를 생성하는 동작을포함하는 이미지 분할 방법."}
{"patent_id": "10-2024-0031959", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_18", "content": "청구항 17에 있어서, 상기 획득하는 동작은,상기 자기 집중 연산의 결과를 쿼리(query)로 획득하는 동작;공개특허 10-2025-0045436-5-상기 이미지 특징 정보로부터 키(key) 및 값(value)을 획득하는 동작; 및상기 쿼리, 상기 키, 상기 값에 대해 상호 집중 연산을 수행하는 동작을 포함하는 이미지 분할 방법."}
{"patent_id": "10-2024-0031959", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_19", "content": "청구항 17에 있어서, 상기 생성하는 동작에서 생성된 특징 맵에 기반하여 상기 분할 마스크의 대표 포인트를 학습하는 동작을 더 포함하고, 상기 대표 포인트를 학습하는 동작은, 상기 대표 포인트의 추론 오차가 최소화되도록 상기 지정된 목적에 따른 상기 추출된 프롬프트 정보의 튜닝을학습하는 동작을 포함하는 이미지 분할 방법."}
{"patent_id": "10-2024-0031959", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_20", "content": "청구항 19에 있어서, 상기 대표 포인트를 학습하는 동작은,상기 생성된 특징 맵을 상기 입력 이미지에 대응하도록 스케일 변환하는 동작; 심층 신경망을 통해 상기 변환된 특징 맵으로부터 복수의 특징들을 추출하는 동작;상기 복수의 특징들에 기반하여 상기 분할 마스크의 경계 포인트를 추정하는 동작; 및상기 추정된 경계 포인트와 정답 간의 오차를 산출하는 동작을 더 포함하는 이미지 분할 방법."}
{"patent_id": "10-2024-0031959", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 문서에 개시되는 일 실시 예에 따른 이미지 인식 장치는, 입력 이미지에 대하여 이미지 특징 정보를 추출하는 제1 인코딩 모듈; 상기 입력 이미지의 분할과 관련된 사용자 입력을 인코딩(encoding)하여 프롬프트 정보를 추출 하는 제2 인코딩 모듈; 상기 이미지 특징 정보 및 상기 추출된 프롬프트 정보를 이용하여 지정된 목적에 따라 상 기 추출된 프롬프트 정보를 튜닝(tunning)하는 튜닝 모듈; 및 상기 이미지 특징 정보 및 상기 튜닝된 프롬프트 정보에 기반하여 분할 마스크(segmentation mask)를 생성하는 분할 모듈을 포함할 수 있다."}
{"patent_id": "10-2024-0031959", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 문서에서 개시되는 다양한 실시 예들은, 인공지능 기반 이미지 분할 기술과 관련된다."}
{"patent_id": "10-2024-0031959", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "딥러닝 기반의 기계학습 및 인공지능의 발전을 통해서, 영상 내에서 물체의 위치, 종류 등을 정확하게 인식하는 연구 및 응용들이 발전하고 있다. 최근에 파운데이션 모델(foundation model)이라고 불리는 거대 인공지능 모델 이 발달하면서 범용성 측면에서도 크게 확장되고 있다. 일 예로, 세그먼트 애니씽(Segment Anything) 모델은 과 거의 클래스(class) 기반의 객체 분할을 넘어서 말 그대로 클래스 정보와 관계없이 객체로 인지된 것들은 모두 분할해줄 수 있다. 도 1 및 도 2는 세그먼트 애니씽 모델의 입출력(좌: 입력, 우: 출력)의 예시도이다. 세그먼트 애니씽 모델은 매우 방대한 양의 데이터로 학습되어, 사용자에 의한 추가적인 학습을 없이도 도 1과 같이 프롬프트 입력으로 분할할 객체의 위치 좌표(point prompt, 포인트 프롬프트)가 설정되면 그 위치에서 가 장 객체와 유사한 영역을 출력으로 제공할 수 있다. 뿐만 아니라, 세그먼트 애니씽 모델은 촬영된 사진 이외에도 도 2와 같이, 유화, 해양 이미지, 메디컬 이미지와 같은 복잡한 이미지의 객체 분할에서도 우수한 성능을 제공할 수 있다. 이는 세그먼트 애니씽 모델이 수천 내지 수백 만장 이상의 이미지와 그에 대응하는 10억개 이상의 객체 영역(mask) 정답 데이터를 포함하는 방대한 학습 데이터로 학습되었기 때문이다."}
{"patent_id": "10-2024-0031959", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "그러나, 세그먼트 애니씽 모델은 사용자 입력에 따라서 사용자 의도와 다른 분할 결과를 제공할 수 있다. 도 3 은 세그먼트 애니씽 모델의 사용자 입력된 선택 위치에 따른 출력 결과의 예시도를 나타낸다. 도 3을 참조하면, 세그먼트 애니씽 모델은 자동차 전방 이미지로부터 번호판을 분할할 때, 사용자 입력의 미세한 위치 변화에 따 라 매우 다른 그 분할 결과를 제공할 수 있다. 이러한 문제는 세그먼트 애니씽 모델이 자동차의 번호판을 분할 하고자 하는 사용자 의도를 명확하게 추정하지 못했기 때문에 발생된다. 상세하게는, 세그먼트 애니씽 모델은 범용적인 활용을 위해 개발되었으므로, 번호판 이미지의 특정 부분(예: \"가\" 이미지에서 \"ㄱ\", 번호판, \"ㅏ\")을분할하고자 하는 사용자의 의도를 정확히 파악하지 못할 수 있다. 따라서, 세그먼트 애니씽 모델의 사용자는 원 하는 분할 결과를 얻기 위해 여러 번 입력을 조정하는 불편을 감수해야 한다. 본 문서에 개시되는 다양한 실시 예들은 입력 이미지의 일부를 사용자 의도된 프롬프트 입력에 따라 분할 또는 마스킹할 수 있는 이미지 인식 장치와 방법 및 그에 관련된 프롬프트 튜닝 방법을 제공할 수 있다."}
{"patent_id": "10-2024-0031959", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 문서에 개시되는 일 실시 예에 따른 이미지 인식 장치는, 입력 이미지에 대하여 이미지 특징 정보를 추 출하는 제1 인코딩 모듈; 상기 입력 이미지의 분할과 관련된 사용자 입력을 인코딩(encoding)하여 프롬프 트 정보를 추출하는 제2 인코딩 모듈; 상기 이미지 특징 정보 및 상기 추출된 프롬프트 정보를 이용하여 지정된 목적에 따라 상기 추출된 프롬프트 정보를 튜닝(tunning)하는 튜닝 모듈; 및 상기 이미지 특징 정 보 및 상기 튜닝된 프롬프트 정보에 기반하여 분할 마스크(segmentation mask)를 생성하는 분할 모듈을 포 함할 수 있다. 또한, 본 문서에 개시되는 일 실시 예에 따른 이미지 분할과 관련된 프롬프트 튜닝 방법은, 입력 이미지로부터 입력된 프롬프트 정보에 대응하는 분할 마스크를 생성하는 분할 모듈에 의해 생성된 특징 맵을 획득하는 동작; 상기 특징 맵에 기반하여 지정된 목적에 따른 상기 분할 마스크의 대표 포인트를 학습하는 동작; 상기 대표 포 인트의 학습 오차에 기반하여 상기 프롬프트 정보를 지정된 목적에 따라 튜닝하는 동작; 및 상기 튜닝된 프롬프 트 정보를 상기 입력 이미지와 관련하여 상기 분할 모듈의 입력으로 제공하는 동작을 포함할 수 있다. 또한, 본 문서에 개시되는 일 실시 예에 따른 이미지 분할 방법은, 입력 이미지에 대하여 이미지 특징 정보를 추출하는 동작; 상기 입력 이미지의 분할과 관련된 사용자 입력을 인코딩하여 프롬프트 정보를 추출하는 동작; 상기 이미지 특징 정보 및 상기 추출된 프롬프트 정보를 이용하여 지정된 목적에 따라 상기 추출된 프롬프트 정 보를 튜닝하는 동작; 및 상기 이미지 특징 정보 및 상기 튜닝된 프롬프트 정보에 기반하여 분할 마스크 (segmentation mask)를 생성하는 동작을 포함할 수 있다."}
{"patent_id": "10-2024-0031959", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 문서에 개시되는 다양한 실시 예들에 따르면, 입력 이미지의 일부를 사용자 의도된 프롬프트에 따라 분할 또 는 마스킹할 수 있다. 이 외에, 본 문서를 통해 직접적 또는 간접적으로 파악되는 다양한 효과들이 제공될 수 있다."}
{"patent_id": "10-2024-0031959", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "item": 1, "content": "도 4는 일 실시예에 따른 세그먼트 애니씽 모델의 구성도를 나타낸다. 도 4를 참조하면, 일 실시예에 따른 이미지 인식 장치(예: 세그먼트 애니씽)는 이미지 인코더, 프롬 프트 인코더 및 마스크 디코더를 포함할 수 있다. 일 실시예에 따르면, 이미지 인식 장치는 예를 들면, 이미지 분할 모델(예: SAM(segment anything model))을 통해 이미지 분할을 수행할 수 있다. 세그먼트 애니씽 모델은 컴퓨터 비전 분야에서 세그멘테이션 (segmentation) 과제를 해결하기 위해 개발된 모델로서, 대규모의 데이터셋, 특히 1B개의 segmentation 마스크 를 포함한 11M의 이미지를 학습함에 따라 구성될 수 있다. 이미지 분할 모델은 예컨대, 입력 프롬프트(prompt) 에 따라 다양하게 변화된 출력을 제공할 수 있는 프롬프터블(promptable) 특성을 가지며, 해당 특성에 기반하여 강한 일반화 능력을 제공할 수 있다. 이미지 인코더(Image Encoder)는 입력 이미지에 대한 특징을 추출하는 모듈로서, 시각 트랜스포머(Vision Transformer, ViT) 구조로 구성될 수 있다. 프롬프트 인코더(Prompt Encoder)는 사용자로부터 입력 받은 프롬프트를 처리함에 따라 입력된 또는 의도 정보를 인코딩할 수 있다. 마스크 디코더(Mask Decoder)는 이미지 인코더와 프롬프트 인코더의 출력을 그 입력으로 획득하 고, 각기 획득된 입력에 기반하여 세그먼테이션 마스크(segmentation mask)를 생성할 수 있다. 도 5는 본 발명의 일 실시예에 따른 이미지 인식 장치의 하드웨어 구성도를 나타낸다. 도 5를 참조하면, 일 실시예에 따른 이미지 인식 장치는 버스를 통해 통신하는 프로세서, 메모 리, 입력 인터페이스 장치, 출력 인터페이스 장치 및 저장 장치 중 적어도 하나를 포함할 수 있다. 이미지 인식 장치는 또한 네트워크에 결합된 통신 장치를 더 포함할 수 있다. 입력 인터페이스 장치는 이미지 인식 장치을 사용하는 사용자 입력을 수신할 수 있다. 상기 사용자 입력은 예를 들면, 상기 입력 이미지와 관련된 포인트, 바운딩 박스, 텍스트, 마스크 및 사용자 음성 중 적어도 하나의 프롬프트를 포함할 수 있다. 출력 인터페이스 장치는 프로세서의 제어에 따라 기호, 숫자 또는 문자 중 적어도 하나의 데이터를 시각 또는 청각적으로 출력할 수 있다. 출력 인터페이스 장치는 예를 들면, 액정 디스플레이, OLED, 터치 스크린 디스플레이, 스피커 중 적어도 하나의 출력 장치를 포함할 수 있다. 통신 장치는 이미지 인식 장치와 다른 장치(예: 사용자 단말(미도시)) 간의 통신 채널 또는 무선 통 신 채널의 수립, 및 수립된 통신 채널을 통한 통신 수행을 지원할 수 있다. 상기 통신 채널은 예를 들어, LAN, FTTH, xDSL, Wibro, 무선 랜(Wireless LAN), 와이파이(Wi-Fi), 블루투스(Bluetooth), 지그비(Zigbee), WFD(Wi- Fi Direct), UWB(Ultrawideband), 적외선 통신(IrDA; Infrared Data Association), BLE (Bluetooth Low Energy), NFC(Near Field Communication), 3G, 4G 또는 5G 중 적어도 하나의 통신 채널을 포함할 수 있다. 통 신 장치는 CDMA, GSM, W-CDMA, TD-SCDMA, WiBro, LTE, EPC 등의 공지된 통신 방법으로 통신할 수 있다. 메모리 및 저장 장치는 다양한 형태의 휘발성 또는 비휘발성 저장 매체를 포함할 수 있다. 예를 들어, 메모리는 ROM(read only memory) 및 RAM(random access memory)를 포함할 수 있다. 본 기재의 실시예에 서 메모리는 프로세서의 내부 또는 외부에 위치할 수 있고, 메모리는 이미 알려진 다양한 수단을 통 해 프로세서와 연결될 수 있다. 메모리는 다양한 형태의 휘발성 또는 비휘발성 저장 매체이며, 예를 들어, 메모리는 읽기 전용 메모리(read-only memory, ROM) 또는 랜덤 액세스 메모리(random access memory, RAM)를 포함할 수 있다. 메모리는 이미지 인식 장치의 적어도 하나의 구성요소(예: 프로세서)에 의해 사용되는 다양한 데이터를 저장할 수 있다. 데이터는 예를 들어, 소프트웨어 및 이와 관련된 명령에 대한 입력 데이터 또는 출력 데이터를 포함할 수 있다. 예를 들어, 메모리는 입력 프롬프트 기반 이미지 분할 서비스제공을 위한 적어도 하나의 인스트럭션을 저장할 수 있다. 상기 적어도 하나의 인스트럭션은 예를 들면, 프로세 서 및 도 6의 제1 인코딩 모듈, 제2 인코딩 모듈, 튜닝 모듈 및 분할 모듈 각각의 동작을 위한 인스트럭션을 포함할 수 있다. 프로세서는 메모리 또는 저장 장치에 저장된 명령을 실행하는 반도체 장치일 수 있다. 프로세서 는 이미지 인식 장치의 적어도 하나의 다른 구성요소(예: 하드웨어 또는 소프트웨어 구성요소)를 제 어할 수 있고, 다양한 데이터 처리 또는 연산을 수행할 수 있다. 프로세서는 예를 들어, 중앙처리장치 (CPU), 그래픽처리장치(GPU), 마이크로프로세서, 애플리케이션 프로세서(application processor), 주문형 반도 체(ASIC(application specific integrated circuit), FPGA(field programmable gate arrays)) 중 적어도 하나 를 포함할 수 있으며, 복수의 코어를 가질 수 있다. 도 6은 일 실시예에 따른 이미지 인식 장치의 세부 구성도를 나타낸다. 도 6을 참조하면, 일 실시예에 따른 이미지 인식 장치는 제1 인코딩 모듈, 제2 인코딩 모듈, 튜 닝 모듈 및 분할 모듈를 포함할 수 있다. 일 실시 예에서, 이미지 인식 장치는 일부 구성요소가 생략되거나, 추가적인 구성요소를 더 포함할 수 있다. 또한, 이미지 인식 장치의 구성요소들 중 일부가 결 합되어 하나의 개체로 구성되되, 결합 이전의 해당 구성요소들의 기능을 동일하게 수행할 수 있다. 일 실시예에 서, 제1 인코딩 모듈, 제2 인코딩 모듈, 튜닝 모듈 및 분할 모듈은 프로세서에 포함 된 하드웨어/소프트웨어 모듈 또는 메모리에 저장된 인스트럭션에 기반하여 프로세서에 의해 실행되 는 소프트웨어 모듈일 수 있다. 일 실시예에 따르면, 제1 인코딩 모듈은 입력 이미지에 대하여 이미지 특징 정보를 추출할 수 있다. 예를 들어, 제1 인코딩 모듈은 마스킹된 오토 인코더(Masked Auto Encoder)에 기반한 시각 트랜트포머Vision Transformer (ViT) 구조로 구성될 수 있다. 제1 인코딩 모듈은 ViT-H/16 모델로 구성될 수 있다. 제1 인 코딩 모듈은 지정된 해상도(예: 1024x1024 해상도)의 이미지를 인코딩할 수 있도록 형성될 수 있다. 예를 들면, 제1 인코딩 모듈은 지정된 해상도 이외 해상도의 이미지에 대해서는 패딩(padding) 및 리사이징 (rescaling)을 통해 지정된 해상도로 조절한 후 지정된 해상도로 변환된 이미지에 기반하여 이미지 특징 정보 (이하, '특징 맵'으로 언급될 수 있음)를 추출할 수 있다. 일 실시예에 따르면, 제2 인코딩 모듈은 입력 이미지의 분할과 관련된 사용자 입력을 획득하고, 사용자 입 력을 인코딩(encoding)함에 따라 프롬프트 정보를 생성할 수 있다. 상기 사용자 입력은 예를 들면, 상기 입력 이미지와 관련된 포인트, 바운딩 박스, 텍스트, 마스크 및 사용자 음성 중 적어도 하나의 입력 정보를 포함할 수 있다. 제2 인코딩 모듈은 복수의 정보에 대한 입력을 논리합(AND) 연산하고, 연산 결과에 기반하여 사 용자 의도된 프롬프트 정보를 추출할 수 있다. 한 실시예에 따르면, 제2 인코딩 모듈은 포인트 프롬프트(point prompt)의 경우, 2차원 좌표값과 배경/전 경을 구분하는 레이블(label, 0 또는 1)을 획득할 수 있다. 제2 인코딩 모듈은 바운딩 박스 프롬프트의 경 우, 바운딩 박스의 왼쪽 상단 및 오른쪽 하단 좌표(a, b, c, d)와 배경/전경을 구분하는 레이블을 입력으로 획 득할 수 있다. 제2 인코딩 모듈은 마스크 프롬프트의 경우, 컨볼루션 구조를 통한 입력된 마스크 특징을 추출하고 추출된 마스크 특징을 입력으로 이용할 수 있다. 일 실시예에 따르면, 분할 모듈은 이미지 특징 정보 및 튜닝된 프롬프트 정보에 기반하여 입력 이미지로부 터 분할 마스크(segmentation mask)를 생성할 수 있다. 예를 들어, 분할 모듈은 이미지 특징 정보 및 튜닝 된 프롬프트 정보에 기반하여 입력 이미지에서 사용자 의도에 따른 마스킹 영역(또는, 분할 영역)을 탐색하고, 탐색 영역을 사용자 의도에 따라 마스킹 또는 분할할 수 있다. 일 실시예에 따르면, 튜닝 모듈은 이미지 특징 정보 및 프롬프트 정보를 이용하여 지정된 목적에 따라 프 롬프트 정보를 튜닝(tunning)함에 따라 튜닝된 프롬프트 정보를 생성할 수 있다. 상기 지정된 목적은 예를 들면, 특정 영역에 대한 마스킹 또는 분할 중 적어도 하나를 포함할 수 있다. 한 실시예에 따르면, 튜닝 모듈은 추출된 프롬프트 정보 및 이미지 특징 정보 중 적어도 하나의 정보에 자 기 집중(self-attention) 연산, 상호 집중(cross-attention) 연산 및 다층 퍼셉트론(multi-layer perceptron) 을 적용하여 프롬프트 변화량을 획득하고, 프롬프트 변화량과 상기 추출된 프롬프트 정보에 기반하여 상기 튜닝 된 프롬프트 정보를 생성할 수 있다. 일 실시예에서, 튜닝 모듈은 튜닝된 프롬프트 정보를 입력 이미지와 관련하여 분할 모듈의 입력으로 제공할 수 있다. 이에, 분할 모듈은 튜닝된 프롬프트 정보에 기반하여 사용자 의도에 따른 영역을 정확히탐색하고 탐색 영역을 사용자 의도에 따라 분할 또는 마스킹할 수 있다. 일 실시예에 따르면, 튜닝 모듈은 손실함수에 기반하여 입력된 프롬프트를 학습함에 따라 프롬프트 정보를 튜닝하도록 구성(또는, 모델링)될 수 있다. 튜닝 모듈의 학습에 대해서는 도 9 및 도 10을 참조하여 후술 한다. 이와 같이, 일 실시예에 따른 이미지 인식 장치는 세그먼트 애니씽과 같은 이미지 분할 모델과 동일 또는 유사한 추론 단계를 가지면서, 분할 대상의 도메인에 적합한 데이터 셋(data set)을 바탕으로 입력 프롬프트를 추가 학습 가능한 프롬프트 튜닝 네트워크를 사용하여 사용자 목적과 도메인에 맞도록 이미지 분할 모델을 학습 할 수 있다. 또한, 일 실시예에 따른 이미지 인식 장치는 프롬프트 특징 레벨에서 이미지의 분할 정도나 영역을 조절하 면서 프롬프트 튜닝을 학습함에 따라 사용자 의도를 정확히 반영한 이미지 분할 결과를 제공할 수 있다. 따라서, 일 실시예에 따른 이미지 인식 장치는 종래에 포인트 정보만으로 사용자의 구체적인 의도를 정확 히 인식하지 못하여 사용자의 추가 조정과 개입으로 따라 원하는 결과를 획득할 수 있었던 종래의 세그먼테이션 기법의 한계를 극복할 수 있다. 뿐만 아니라, 일 실시예에 따른 이미지 인식 장치는 대규모 딥러닝 학습 모델의 구조나 학습에 큰 변화를 주지 않으므로, 학습 과정의 시간과 노력을 줄일 수 있다. 도 7은 일 실시예에 따른 튜닝 모듈의 세부 구성도를 나타내고, 도 8은 일 실시예에 따른 튜닝 모듈 중 일부의 세부 구성도를 나타낸다. 도 7을 참조하면, 일 실시예에 따른 튜닝 모듈은 제1 연산기, 제2 연산기, 특징 연쇄부, 다층 퍼셉트론 및 합산부를 포함할 수 있다. 일 실시예에 따르면, 제1 연산기는 제2 인코딩 모듈로부터의 프롬프트 정보에 대해 자기 집중(self- attention) 연산을 수행할 수 있다. 도 8을 참조하면, 제1 연산기는 프롬프트 정보로부터 키(key), 쿼리(query) 및 값(value)을 추출하여 자기 집중 연산을 수행할 수 있다. 일 실시예에 따르면, 제2 연산기는 제1 연산기의 출력(프롬프트 정보에 기반 자기 집중 연산의 결 과)과 이미지 특징 정보에 대해 상호 집중(cross-attention) 연산을 수행할 수 있다. 도 8을 참조하면, 제2 연 산기는 제1 연산기의 결과를 쿼리(query)로 획득하고, 이미지 특징 정보로부터 키(key) 및 값(valu e)을 획득하여 상호 집중 연산을 수행할 수 있다. 일 실시예에서, 제2 연산기는 복수의 서브 연산부들(632_1~632_N, N은 상수)을 포함하고, 복수의 서브 연 산부들(632_1~632_N, N은 상수)에 의하여 각기 다른 파라미터(다중 헤드)를 이용하여 병렬적으로 상호 집중 연 산을 수행할 수 있다. 예를 들어, 입력된 이미지 특징 정보에 기반하여 인코딩된 프롬프트 정보를 얼마나 변형 할지를 판단하기 위하여 상호 집중 연산을 통해서 그 특징값들을 추출할 수 있다. 특징 연쇄부는 복수의 서브 연산부들(632_1~632_N, N은 상수)에 의해 각기 다른 파라미터로 병렬 처리된 상호 연산 결과를 연쇄(concatenation)하여 종합(또는, 결합)할 수 있다. 다층 퍼셉트론(multilayer perceptron)은 특징 연쇄부의 출력(총합 특징값)을 학습함에 따라 프롬프 트 변화량을 추출할 수 있다. 합산부는 추출된 프롬프트 정보와 프롬프트 변화량을 가중합하여 프롬프트 정보에 대한 최종 튜닝 결과(이 하, '튜닝된 프롬프트 정보'로 언급될 수 있음)를 생성할 수 있다. 상술한 실시예에 따르면, 제1 연산기, 제2 연산기, 특징 연쇄부, 다층 퍼셉트론 및 합산부 는 지정된 도메인의 학습 데이터셋(이미지)에 대하여 이미지 분할을 지도 학습함에 따라 구성될 수 있다. 상기 지정된 도메인의 학습 데이터셋은 이미지 인식 장치에 의해 분할될 이미지 종류 또는 분할될 영역이 유사한 이미지들을 포함할 수 있다. 도 9는 일 실시예에 따른 튜닝 모듈의 학습 과정에 대한 개념도를 나타내고, 도 10은 일 실시예에 따른 튜닝 모 듈의 학습 과정에 관련된 세부 구성도를 나타낸다. 도 9를 참조하면, 일 실시예에 따른 튜닝 모듈은 프롬프트 튜닝을 학습하는 단계에서 추론기와 협업 할 수 있다. 일 실시예에 따르면, 추론기는 분할 모듈로부터 이미지 특징 정보(특징 맵)을 획득하고, 특징 맵에 기반하여 분할 마스크의 대표 포인트를 학습할 수 있다. 도 10을 참조하면, 일 실시예에 따른 추론기는 변환부, 심층 신경망, 추정부 및 산출부 를 포함할 수 있다. 일 실시예에 따르면, 변환부는 분할 모듈로부터 획득된 이미지 특징 정보(이하, '특징 맵'으로 언급 될 수 있음)를 입력 이미지의 크기에 대응하도록 스케일 변환할 수 있다. 예를 들어, 입력 이미지가 224*224 크 기일 때 특징 맵의 크기는 입력 이미지보다 작은 56*56크기일 수 있다. 이 경우, 변환부는 특징 맵의 각 특징들이 입력 이미지의 복수의 픽셀들과 그 좌표값이 맵핑될 수 있도록 특징 맵을 입력 이미지의 크기에 맞추 어 스케일 변환할 수 있다(예: 특징 맵의 (10,10) 좌표를 입력 이미지의 (30,30)에 맵핑함). 일 실시예에 따르면, 심층 신경망은 스케일 변환된 특징 맵에서 복수의 특징들을 추출할 수 있다. 예를 들 어, 도 9를 참조하면, 심층 신경망은 스케일 변환된 특징 맵으로부터 이미지 토큰(image token) 단위의 제 1 특징을 추출하는 컨볼루션 연산부(652A)(예: 1*1 컨볼루션, 채널 방향 컨볼루션) 및 스케일 변환된 특징 맵에 대해 자기 집중 연산을 수행함에 따라 제2 특징을 추출하는 트랜스포머(652B)를 포함할 수 있다. 일 실시예에 따르면, 추정부(예: prediction layer)는 복수의 특징들(제1 및 제2 특징)을 획득하고 획득된 복수의 특징들에 기반하여 지정된 개수(예: 64개)의 분할 마스크에 대한 대표 포인트(예: 경계 포인트)를 추정 할 수 있다. 일 실시예에 따르면, 산출부는 추정된 대표 포인트와 정답 (예: 도 9의 포인트 ground truth) 간의 오차 (거리)를 산출할 수 있다. 상기 정답(label)은 사용자(예: 개발자)에 의해 입력될 수 있다. 이후, 추론기(예: 심층 신경망, 추정부), 제1 연산기, 제2 연산기, 특징 연쇄부, 다 층 퍼셉트론 및 합산부는 상기 산출된 오차가 최소화되도록 그 파라미터들이 조절됨에 따라 지정된 목적에 따른 프롬프트 정보를 튜닝할 수 있도록 학습 및 구성될 수 있다. 예를 들어, 추론기(예: 심층 신경망 , 추정부), 제1 연산기, 제2 연산기, 특징 연쇄부, 다층 퍼셉트론 및 합산부 는 특징 맵으로부터 추정된 지정 개수의 대표 포인트와 정답 간의 거리가 최소화되도록 학습 및 구성될 수 있다. 추가적으로, 이미지 인식 장치는 분할 모듈에 의해 생성된 분할 마스크와 정답 마스크를 이용 하여 두 마스크들 간의 focal 손실(loss), dice 손실 및 IoU(Intersection over union) 손실을 산출할 수 있다. 이미지 인식 장치는 산출된 손실들이 최소화되도록 학습 및 구성될 수 있다. 이와 같이, 일 실시예에 따른 이미지 인식 장치는 기존의 딥러닝 모델에서 사용자의 입력(예: point나 box)만으로 사용자의 구체적인 의도를 반영하는 것이 어려운 한계를 극복할 수 있다. 구체적으로, 일 실시예에 따른 이미지 인식 장치는 이미지 분할에 사용될 특정 형태의 객체 데이터셋을 추가 학습함에 따라 범용적 인 파운데이션 모델의 세밀한 기능(또는 granularity)를 사용자의 특정 요구에 맞게 조절할 수 있다. 따라서, 사용자는 대형의 파운데이션 모델을 효율적으로 활용함은 물론, 동시에 더 정확하고 세밀한 결과를 얻을 수 있 다. 도 11은 일 실시예에 따른 이미지 분할 방법의 흐름도를 나타낸다. 도 11을 참조하면, 동작 1110에서, 이미지 인식 장치는 입력 이미지에 대하여 이미지 특징 정보를 추출할 수 있다. 동작 1120에서, 이미지 인식 장치는 입력 이미지의 분할과 관련된 사용자 입력을 인코딩하여 프롬프트 정 보를 추출할 수 있다. 동작 1130에서, 이미지 인식 장치는 이미지 특징 정보 및 상기 추출된 프롬프트 정보를 이용하여 지정된 목적에 따라 상기 추출된 프롬프트 정보를 튜닝할 수 있다. 예를 들어, 이미지 인식 장치는 추출된 프롬프 트 정보 및 상기 이미지 특징 정보 중 적어도 하나의 정보에 자기 집중(self-attention) 연산, 상호 집중 (cross-attention) 연산 및 다층 퍼셉트론(multi-layer perceptron)을 적용하여 프롬프트 변화량을 획득할 수 있다. 이미지 인식 장치는 프롬프트 변화량과 상기 추출된 프롬프트 정보에 기반하여 상기 튜닝된 프롬프 트 정보를 생성할 수 있다. 동작 1140에서, 이미지 인식 장치는 상기 이미지 특징 정보 및 상기 튜닝된 프롬프트 정보에 기반하여 입 력 이미지를 분할함에 따라 분할 마스크(segmentation mask)를 생성할 수 있다. 예를 들어, 이미지 인식 장치 는 입력 이미지 중에서 일부를 마스킹 처리하고 마스킹된 입력 이미지를 출력할 수 있다. 도 12는 일 실시예에 따른 프롬프트 튜닝 학습 방법의 흐름도를 나타낸다. 도 12를 참조하면, 동작 1210에서, 튜닝 모듈은 입력 이미지로부터 프롬프트 정보에 대응하는 분할 마스크 를 생성하는 분할 모듈에 의해 생성된 특징 맵을 획득할 수 있다. 동작 1220에서, 튜닝 모듈은 추론기와 협업하여 특징 맵에 기반하여 지정된 목적에 따른 상기 분할 마스크의 대표 포인트를 학습할 수 있다. 예를 들어, 튜닝 모듈은 생성된 특징 맵을 상기 입력 이미지에 대응하도록 스케일 변환하고, 심층 신경망을 이용하여 상기 변환된 특징 맵으로부터 복수의 특징들을 추출할 수 있다. 추론기 는 상기 복수의 특징들에 기반하여 상기 분할 마스크의 경계 포인트를 추정하고, 추정된 경 계 포인트와 정답 간의 오차가 최소화되도록 상기 대표 포인트를 학습할 수 있다. 추론기 는 학습 과정에 서 복수의 특징들을 추출하는 심층 신경망 및 복수의 특징들에 기반하여 경계 포인트를 추정하는 추정부 의 파라미터들을 조절하면서 상기 오차를 최소화할 수 있다. 추가적으로, 추론기 는 학습 과정에서 인코딩된 프롬프트 정보의 튜닝에 관련된 - 튜닝 모듈에 포함된 - 구성요소들(예: 631~635)의 파라미터들 을 조절하면서 상기 오차를 최소화할 수 있다. 동작 1230에서, 튜닝 모듈은 상기 대표 포인트의 학습 오차에 기반하여 상기 프롬프트 정보를 지정된 목적 에 따라 튜닝할 수 있다. 예를 들어, 튜닝 모듈은 학습 과정에서 및 학습 완료 후에 인코딩된 프롬프트 정 보를 지정된 목적에 따라 튜닝할 수 있다. 동작 1240에서, 튜닝 모듈은 튜닝된 프롬프트 정보를 입력 이미지와 관련하여 분할 모듈의 입력으로 제공할 수 있다. 상술된 실시예에 있어서, 튜닝 모듈은 동작 1210 내지 1240을 반복함에 따라 지정된 목적에 따른 프롬프트 정보의 튜닝을 수행할 수 있도록 구성될 수 있다. 이하, 도 13 내지 15를 참조하여 입력 이미지 내 현수막 영역을 분할하는 실시예를 중심으로 일 실시예에 따른 프롬프트 튜닝의 효과를 설명한다. 도 13 내지 15는 일 실시예에 따른 이미지 인식 장치에 의한 현수막 분할 결 과의 예를 나타낸다. 도 13 내지 15에서는 입력 이미지에서 현수막의 위치 정보를 분할하기 위한 학습 데이터는 웹 크롤링을 통해 수집된 현수막 도안 3,980장(예: 도 13의 1310)일 수 있다. 수집된 이미지들에는 랜덤한 배경 이미지와 합성되어 학습 데이터의 다양성을 높이는 augmentation의 수행 및 이미지에 카메라 왜곡 효과를 반영 하기 위한 기하학적 변형 적용이 수행(전처리)되었다. 이렇게 전처리된 데이터(예: 도 13의 1320) 중 3,000장은 학습 데이터로 나머지 980장을 검증 데이터로 사용되었다. < 학습 단계 > 이미지 인식 장치는 학습 과정에서는 합성된 데이터를 기반으로 현수막의 영역을 마스크하여 출력하도록 학습되었다. 도 13을 참조하면, 합성된 데이터(예: 도 13의 1320)를 활용하여 이미지 인식 장치는 입력 이미지(예: 도 13의 1320)에서 현수막의 영역이 마스크된 이미지를 생성하도록 학습되었다. 예를 들어, 해당 학습 과정에서 튜 닝 모듈의 파라미터만 업데이트되고, 나머지 부분은 기존 모델(예: 세그먼트 애니씽 모델)의 파라미터를 유지할 수 있다. 상술한 학습으로, 이미지 인식 장치는 사용자 입력에 따른 프롬프트 정보의 작은 변화에 따른 분할 결과의 변동을 최소화하고, 사용자의 의도(즉, 현수막의 이미지에서는 현수막 중심의 점이 주어졌을 때, 현수막 전체 영역이 나타나길 원한다가 정답으로 주어지므로)를 정확히 반영할 수 있도록 프롬프트 정보를 튜닝할 수 있다. 이에, 정교한 프롬프트의 입력이 없어도 원하는 분할 결과를 얻을 수 있다. < 추론 단계 > 이미지 인식 장치는 기존 모델과 동일 또는 유사한 접근 방식으로 입력 이미지에 대한 분할을 수행할 수 있다. 예를 들어, 사용자 입력으로 현수막의 중앙 좌표가 입력되면, 이미지 인식 장치는 입력된 중앙 좌표 를 포함하는 객체에 대한 마스킹을 수행한 이미지 분할 결과를 출력할 수 있다. 상기 합성 이미지에 대한 분할 결과를 살펴보면, 도 14와 같이, 기존 모델은 입력 이미지에서 현수막 내부의 로 컬 영역만을 마스킹한 결과 이미지(1410, 1430, 1450, 1470)를 제공하였다. 반면, 일 실시예에 따른 이미지 인 식 장치는 입력 이미지에서 현수막의 전체 영역을 성공적으로 마스킹한 결과(1420, 1440, 1460, 1480)를제공하였다. 실 환경의 촬영 이미지에 대한 분할 결과에서도 일 실시예에 따른 이미지 인식 장치의 분할 성능이 우수하 였다. 도 15를 참조하면, 기존 모델은 입력 이미지에서 현수막 영역의 일부 영역만 마스킹할 뿐이었지만(1510, 1530), 일 실시예에 따른 이미지 인식 장치는 현수막 전체 영역을 마스킹한 결과(1520, 1540)를 제공하였 다. 상술된 검증 데이터셋 980장의 이미지에서 영역을 얼마나 정확하게 분리하는지 평가하기 위해 마스크 IoU를 기 준으로 일 실시예에 따른 이미지 인식 장치의 성능을 측정하였다. 하기 표 1과 같이 일 실시예에 따른 이 미지 인식 장치의 성능 향상이 매우 컸다. 표 1 구분 성능 (mask IoU) 기존 모델 0.301652 일 실시예 모델 0.974402 도 16은 사용자 입력의 포인트 위치에 따른 마스킹 영역 탐지 결과를 비교한 예시도이다.기존 모델은 프롬프트 포인트의 위치에 따라 마스킹 성능이 크게 달라지는 문제가 있었다. 기존 모델은 현수막 내부의 텍스트 영역에 프롬프트가 주어졌을 때 영역 탐지에 실패하는 경우가 있다. 반면, 일 실시예에 따른 이미지 인식 장치는 현수막 내 사용자 입력의 포인트 위치를 변경하여도 현수막 영역을 정확하게 탐지할 수 있다. 도 16을 참조하면, 기존 모델은 현수막 영역 중 텍스트가 포함된 영역을 현수막으로 감지하지 못할 수 있다 ((1610의 녹색 영역에서 가운데 부분 참조). 하지만, 일 실시예에 따른 이미지 인식 장치는 현수막의 가장 자리 일부를 제외한 현수막의 대부분 영역(1620에서 녹색 영역 참조)을 정확히 탐지할 수 있음을 알 수 있다. 도 17 및 도 18은 기존 모델과 일 실시예의 얼굴 이미지 분할 결과를 비교한 예이다. 기존 모델은 입력된 얼굴 이미지에 대하여 머리카락을 제외한 얼굴 부분을 분할하고자 하는 사용자 입력 을 정확히 인식할 수 있다. 도 17을 참조하면, 기존 모델은 입력 위치에 따라 얼굴 영역을 정확히 분할한 결과 를 제공할 수도 있고, \"눈\", \"입\", \"치아\"와 같은 세부 부분만 분할한 모호한 결과(1720, 1730)를 제공할 수 있다. 도 17에서는 눈동자 부분을 분할한 결과 및 입 부분만을 분할한 결과를 예로 들어 도시하 였다. 반면, 도 18을 참조하면, 일 실시예에 따른 이미지 인식 장치는 얼굴 영역내 어떤 위치를 선택하여도 사용 자의 의도에 맞춰 얼굴 영역을 정확히 분할한 결과(1810, 1820, 1830)을 제공할 수 있다. 도 19 및 도 20은 기존 모델과 일 실시예의 차량 번호판 분할 결과를 비교한 예이다. 도 19의 기존 모델의 입출력 이미지와 같이, 기존 모델은 사용자의 의도를 제대로 판단하지 못하여, 입력된 차 량 전방 이미지에서 번호판에 쓰인 글자의 일부 또는 글자 영역만을 분할하였다(1910, 1920). 반면, 도 20의 이미지 인식 장치의 입출력 이미지와 같이, 제안된 이미지 처리 기법에서는 사용자의 의도 를 정확하게 반영하여 학습할 수 있다. 구체적으로, 이미지 인식 장치는 입력된 차량 전방 이미지에 서 번호판 내부의 어느 위치에 점을 선택하더라도, 번호판 전체 영역을 정확하게 분할한 결과를 제공할 수 있다. 상술한 실시예와 같이, 일 실시예에 따른 이미지 인식 장치는 현수막 영역, 얼굴 영역 및 자동차 번호판 영역과 같은 다양한 도메인 이미지의 분할 에서도 사용자 입력 위치에 강인한 분할 결과를 제공함을 알 수 있다. 본 문서의 다양한 실시예들 및 이에 사용된 용어들은 본 문서에 기재된 기술적 특징들을 특정한 실시예들로 한 정하려는 것이 아니며, 해당 실시예의 다양한 변경, 균등물, 또는 대체물을 포함하는 것으로 이해되어야 한다. 도면의 설명과 관련하여, 유사한 또는 관련된 구성요소에 대해서는 유사한 참조 부호가 사용될 수 있다. 아이템 에 대응하는 명사의 단수 형은 관련된 문맥상 명백하게 다르게 지시하지 않는 한, 상기 아이템 한 개 또는 복수 개를 포함할 수 있다. 본 문서에서, \"A 또는 B\", \"A 및 B 중 적어도 하나\",“A 또는 B 중 적어도 하나”, \"A, B또는 C\", \"A, B 및 C 중 적어도 하나” 및 “A, B, 또는 C 중 적어도 하나\"와 같은 문구들 각각은 그 문구들 중 해당하는 문구에 함께 나열된 항목들 중 어느 하나, 또는 그들의 모든 가능한 조합을 포함할 수 있다. \"제1\", \"제2\", 또는 \"첫째\" 또는 \"둘째\"와 같은 용어들은 단순히 해당 구성요소를 다른 해당 구성요소와 구분하기 위 해 사용될 수 있으며, 해당 구성요소들을 다른 측면(예: 중요성 또는 순서)에서 한정하지 않는다. 어떤(예: 제 1) 구성요소가 다른(예: 제2) 구성요소에, “기능적으로” 또는 “통신적으로”라는 용어와 함께 또는 이런 용 어 없이, “커플드” 또는 “커넥티드”라고 언급된 경우, 그것은 상기 어떤 구성요소가 상기 다른 구성요소에 직접적으로(예: 유선으로), 무선으로, 또는 제3 구성요소를 통하여 연결될 수 있다는 것을 의미한다. 본 문서에서 사용된 용어 \"모듈\"은 하드웨어, 소프트웨어 또는 펌웨어로 구현된 유닛을 포함할 수 있으며, 예를 들면, 로직, 논리 블록, 부품, 또는 회로와 같은 용어와 상호 호환적으로 사용될 수 있다. 모듈은, 일체로 구성 된 부품 또는 하나 또는 그 이상의 기능을 수행하는, 상기 부품의 최소 단위 또는 그 일부가 될 수 있다. 예를 들면, 일실시예에 따르면, 모듈은 ASIC(application-specific integrated circuit)의 형태로 구현될 수 있다. 본 문서의 다양한 실시예들은 기기(machine)(예: 이미지 인식 장치) 의해 읽을 수 있는 저장 매체(storage medium)(예: 도 5의 메모리)(예: 내장 메모리 또는 외장 메모리)에 저장된 하나 이상의 명령어들을 포함하 는 소프트웨어(예: 프로그램)로서 구현될 수 있다. 예를 들면, 기기(예: 이미지 인식 장치)의 프로세서(예: 프로세서는, 저장 매체로부터 저장된 하나 이상의 명령어들 중 적어도 하나의 명령을 호출하 고, 그것을 실행할 수 있다. 이것은 기기가 상기 호출된 적어도 하나의 명령어에 따라 적어도 하나의 기능을 수 행하도록 운영되는 것을 가능하게 한다. 상기 하나 이상의 명령어들은 컴파일러에 의해 생성된 코드 또는 인터 프리터에 의해 실행될 수 있는 코드를 포함할 수 있다. 기기로 읽을 수 있는 저장매체는, 비일시적(non- transitory) 저장매체의 형태로 제공될 수 있다. 여기서, ‘비일시적’은 저장매체가 실재(tangible)하는 장치 이고, 신호(signal)(예: 전자기파)를 포함하지 않는다는 것을 의미할 뿐이며, 이 용어는 데이터가 저장매체에 반영구적으로 저장되는 경우와 임시적으로 저장되는 경우를 구분하지 않는다. 일실시예에 따르면, 본 문서에 개시된 다양한 실시예들에 따른 방법은 컴퓨터 프로그램 제품(computer program product)에 포함되어 제공될 수 있다. 컴퓨터 프로그램 제품은 상품으로서 판매자 및 구매자 간에 거래될 수 있 다. 컴퓨터 프로그램 제품은 기기로 읽을 수 있는 저장 매체(예: compact disc read only memory (CD-ROM))의 형태로 배포되거나, 또는 어플리케이션 스토어(예: 플레이 스토어TM)를 통해 또는 두개의 사용자 장치들(예: 스 마트폰들) 간에 직접, 온라인으로 배포(예: 다운로드 또는 업로드)될 수 있다. 온라인 배포의 경우에, 컴퓨터 프로그램 제품의 적어도 일부는 제조사의 서버, 어플리케이션 스토어의 서버, 또는 중계 서버의 메모리와 같은 기기로 읽을 수 있는 저장 매체에 적어도 일시 저장되거나, 임시적으로 생성될 수 있다. 본 문서의 다양한 실시예에 따른 구성 요소들은 소프트웨어 또는 DSP(digital signal processor), FPGA(Field Programmable Gate Array) 또는 ASIC(Application Specific Integrated Circuit)와 같은 하드웨어 형태로 구현 될 수 있으며, 소정의 역할들을 수행할 수 있다. '구성 요소들'은 소프트웨어 또는 하드웨어에 한정되는 의미는 아니며, 각 구성 요소는 어드레싱할 수 있는 저장 매체에 있도록 구성될 수도 있고 하나 또는 그 이상의 프로세 서들을 재생시키도록 구성될 수도 있다. 일 예로서 구성 요소는 소프트웨어 구성 요소들, 객체지향 소프트웨어 구성 요소들, 클래스 구성 요소들 및 태스크 구성 요소들과 같은 구성 요소들과, 프로세스들, 함수들, 속성들, 프로시저들, 서브루틴들, 프로그램 코드의 세그먼트들, 드라이버들, 펌웨어, 마이크로 코드, 회로, 데이터, 데 이터베이스, 데이터 구조들, 테이블들, 어레이들 및 변수들을 포함할 수 있다. 다양한 실시예들에 따르면, 상기 기술한 구성요소들의 각각의 구성요소(예: 모듈 또는 프로그램)는 단수 또는 복수의 개체를 포함할 수 있다. 다양한 실시예들에 따르면, 전술한 해당 구성요소들 중 하나 이상의 구성요소들 또는 동작들이 생략되거나, 또는 하나 이상의 다른 구성요소들 또는 동작들이 추가될 수 있다. 대체적으로 또는 추가적으로, 복수의 구성요소들(예: 모듈 또는 프로그램)은 하나의 구성요소로 통합될 수 있다. 이런 경우, 통 합된 구성요소는 상기 복수의 구성요소들 각각의 구성요소의 하나 이상의 기능들을 상기 통합 이전에 상기 복수 의 구성요소들 중 해당 구성요소에 의해 수행되는 것과 동일 또는 유사하게 수행할 수 있다. 다양한 실시예들에 따르면, 모듈, 프로그램 또는 다른 구성요소에 의해 수행되는 동작들은 순차적으로, 병렬적으로, 반복적으로, 또는 휴리스틱하게 실행되거나, 상기 동작들 중 하나 이상이 다른 순서로 실행되거나, 생략되거나, 또는 하나 이상의 다른 동작들이 추가될 수 있다.도면 도면1 도면2 도면3 도면4 도면5 도면6 도면7 도면8 도면9 도면10 도면11 도면12 도면13 도면14 도면15 도면16 도면17 도면18 도면19 도면20"}
{"patent_id": "10-2024-0031959", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1 및 도 2는 세그먼트 애니씽 모델의 입출력(좌: 입력, 우: 출력)의 예시도이다. 도 3은 세그먼트 애니씽 모델의 사용자 입력된 선택 위치에 따른 출력 결과의 예시도를 나타낸다. 도 4는 세그먼트 애니씽 모델의 구성도를 나타낸다. 도 5는 본 발명의 일 실시예에 따른 이미지 인식 장치의 하드웨어 구성도를 나타낸다. 도 6은 일 실시예에 따른 이미지 인식 장치의 세부 구성도를 나타낸다. 도 7은 일 실시예에 따른 프롬프트 튜닝 모듈의 세부 구성도를 나타낸다. 도 8은 일 실시예에 따른 프롬프트 튜닝 모듈 중 일부의 세부 구성도를 나타낸다. 도 9는 일 실시예에 따른 프롬프트 튜닝 모듈의 학습 과정에 대한 개념도를 나타낸다. 도 10은 일 실시예에 따른 프롬프트 튜닝 모듈의 학습 과정에 관련된 세부 구성도를 나타낸다. 도 11은 일 실시예에 따른 이미지 분할 방법의 흐름도를 나타낸다. 도 12는 일 실시예에 따른 프롬프트 튜닝 학습 방법의 흐름도를 나타낸다. 도 13 내지 15는 일 실시예에 따른 이미지 인식 장치에 의한 현수막 분할 결과의 예를 나타낸다. 도 13 내지 15는 일 실시예에 따른 이미지 인식 장치에 의한 현수막 분할 결과의 예를 나타낸다. 도 16은 사용자 입력의 포인트 위치에 따른 마스킹 영역 탐지 결과를 비교한 예이다.도 17 및 도 18은 기존 모델과 일 실시예의 얼굴 이미지 분할 결과를 비교한 예이다. 도 19 및 도 20은 기존 모델과 일 실시예의 차량 번호판 분할 결과를 비교한 예이다. 도면의 설명과 관련하여, 동일 또는 유사한 구성요소에 대해서는 동일 또는 유사한 참조 부호가 사용될 수 있다."}
