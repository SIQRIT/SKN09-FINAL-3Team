{"patent_id": "10-2024-0060764", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2025-0027203", "출원번호": "10-2024-0060764", "발명의 명칭": "신경망을 이용하여 인루프 필터링을 수행하는 영상 복호화 방법, 영상 복호화 장치, 영상 부", "출원인": "삼성전자주식회사", "발명자": "딘쿠오칸"}}
{"patent_id": "10-2024-0060764", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "영상 복호화 방법에 있어서,현재 영상에 대한 제1 참조 영상에 상응하는 특징맵으로부터 획득된 제1 상태 정보 또는 상기 현재 영상에 대한제2 참조 영상에 상응하는 특징맵으로부터 획득된 제2 상태 정보에 기초하여, 필터링 신경망(720) 내 적어도 하나의 레이어에 이용될 레이어 정보를 생성하는 단계(S1410); 상기 필터링 신경망(720) 내 상기 적어도 하나의 레이어에 상기 현재 영상에 상응하는 정보(710)를 입력하는 단계(S1420); 및 상기 레이어 정보가 이용된 상기 적어도 하나의 레이어에 상기 현재 영상에 상응하는 정보(710)를입력함으로써, 상기 현재 영상에 대해 인루프 필터링이 적용된 영상을 획득하는 단계(S1430);를 포함하고, 상기 현재 영상에 대한 상태 정보(735)는, 상기 현재 영상에 상응하는 특징맵(725)으로부터 획득되고, 상기 현재 영상의 해상도보다 낮은 해상도를가지는, 영상 복호화 방법."}
{"patent_id": "10-2024-0060764", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1 항에 있어서,상기 레이어 정보는,상기 필터링 신경망(720) 내 상기 적어도 하나의 레이어에 적용하기 위한 커널(Kernel) 및 어텐션 맵(AttentionMap) 중 적어도 하나를 포함하는, 영상 복호화 방법."}
{"patent_id": "10-2024-0060764", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1 항 내지 제2 항 중 어느 한 항에 있어서,상기 제1 참조 영상은, 상기 현재 영상의 제1 참조 픽처 리스트에 포함된 영상이며, 상기 제2 참조 영상은, 상기 현재 영상의 제2 참조 픽처 리스트에 포함된 영상이며, 상기 제1 참조 영상의 POC 값은, 상기 현재 영상의 POC 값보다 작고,상기 제2 참조 영상의 POC 값은, 상기 현재 영상의 POC 값보다 큰, 영상 복호화 방법."}
{"patent_id": "10-2024-0060764", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제1 항 내지 제2 항 중 어느 한 항에 있어서,상기 제1 참조 영상 및 제2 참조 영상은, 상기 현재 영상의 제2 참조 픽처 리스트에 포함된 영상이며, 상기 제1 참조 영상의 POC 값 및 제2 참조 영상의 POC 값은, 상기 현재 영상의 POC 값보다 큰, 영상 복호화 방법."}
{"patent_id": "10-2024-0060764", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제1 항 내지 제4 항 중 어느 한 항에 있어서,상기 현재 영상에 대한 상태 정보(735)는,상기 현재 영상에 상응하는 특징맵(725)을 상태 인코딩 신경망(730)에 입력함으로써 획득되며,공개특허 10-2025-0027203-3-상태 정보 버퍼(740)에 저장되는, 영상 복호화 방법."}
{"patent_id": "10-2024-0060764", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제1 항 내지 제5 항 중 어느 한 항에 있어서,상기 제1 상태 정보는,상기 제1 참조 영상에 상응하는 특징맵을 상태 인코딩 신경망(730)에 입력함으로써 획득되고, 상태 정보 버퍼(740)에 저장되며,상기 제2 상태 정보는, 상기 제2 참조 영상에 상응하는 특징맵을 상태 인코딩 신경망(730)에 입력함으로써 획득되고, 상태 정보 버퍼(740)에 저장되는, 영상 복호화 방법."}
{"patent_id": "10-2024-0060764", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제1 항 내지 제6 항 중 어느 한 항에 있어서,상기 필터링 신경망(720)은, 상기 현재 영상에 상응하는 정보로부터 현재 영상의 특징을 추출하여 상기 현재 영상에 상응하는 특징맵을 생성하는 특징 추출 신경망(721) 및 상기 현재 영상에 상응하는 특징맵으로부터 상기 현재 영상에 대해 인루프 필터링이 적용된 영상을 획득하기 위해 이용하는 회귀 신경망(726)을 포함하는, 영상 복호화 방법."}
{"patent_id": "10-2024-0060764", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제1 항 내지 제7 항 중 어느 한 항에 있어서,상기 현재 영상에 상응하는 정보(710)는,상기 현재 영상의 복원 영상, 상기 현재 영상의 예측 영상, 상기 제1 참조 영상, 상기 제2 참조 영상, 상기 현재 영상을 위한 적어도 하나의 양자화 파라미터, 상기 현재 영상에 대한 분할 정보 중 적어도 하나를 포함하는,영상 복호화 방법."}
{"patent_id": "10-2024-0060764", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제1 항 내지 제8 항 중 어느 한 항에 있어서, 상기 현재 영상에 대해 인루프 필터링이 적용된 영상을 획득하는 단계는, 상기 회귀 신경망(726)으로부터 획득한 출력 영상(760)과 상기 현재 영상의 디블록킹 필터링된(Deblock-filtered) 영상에 대해 덧셈 연산을 수행한 것에 기초하여, 상기 현재 영상에 대해 상기 인루프 필터링된 영상을 획득하는 단계를 포함하는, 영상 복호화 방법."}
{"patent_id": "10-2024-0060764", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제1 항 내지 제9 항 중 어느 한 항에 있어서,상기 필터링 신경망(720)은, 심층 신경망(Deep Neural Network), 컨볼루션 신경망(Convolution Neural Network), 및 트랜스포머 신경망(Transformer Neural Network) 중 적어도 하나를 포함하는, 영상 복호화 방법."}
{"patent_id": "10-2024-0060764", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "제7 항 내지 제10 항 중 어느 한 항에 있어서,상기 특징 추출 신경망(721)은, 상기 현재 영상의 해상도보다 낮은 해상도를 갖는 현재 영상에 상응하는 특징맵(725)을 생성하기 위한 적어도하나의 다운 샘플링 레이어(Down Sampling Layer)를 포함하는, 영상 복호화 방법.공개특허 10-2025-0027203-4-청구항 12 제7 항 내지 제11 항 중 어느 한 항에 있어서,상기 회귀 신경망(726)은, 상기 현재 영상에 상응하는 특징맵(725)의 해상도보다 높은 해상도를 갖는 출력 영상을 생성하기 위한 적어도하나의 업 샘플링 레이어(Up Sampling Layer)를 포함하는, 영상 복호화 방법."}
{"patent_id": "10-2024-0060764", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "제5 항 내지 제12 항 중 어느 한 항에 있어서,상기 상태 인코딩 신경망(730)은, 적어도 하나의 다운 샘플링 레이어를 포함하고, 상기 적어도 하나의 다운 샘플링 레이어는, 스트라이드 컨볼루션 레이어(Stride Convolution Layer), 및 풀링 레이어(Pooling Layer) 중 적어도 하나의 레이어를 포함하는, 영상 복호화 방법."}
{"patent_id": "10-2024-0060764", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_14", "content": "제1 항 내지 제13 항 중 어느 한 항에 있어서,상기 레이어 정보를 생성하기 위해 이용하는 레이어 정보 신경망은,스트라이드 컨볼루션 레이어(Stride Convolution Layer), 풀링 레이어(Pooling Layer), 보간 레이어(Interpolation Layer), 디컨볼루션 레이어(Deconvolution Layer), 및 픽셀 셔플 레이어(PixelShuffle Layer)중 적어도 하나를 포함하는, 영상 복호화 방법."}
{"patent_id": "10-2024-0060764", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_15", "content": "제14항에 있어서,상기 필터링 신경망, 상기 상태 인코딩 신경망, 및 상기 레이어 정보 신경망은, 상기 제1 참조 영상에 상응하는 정보 또는 상기 제2 참조 영상에 상응하는 정보를 상기 필터링 신경망에 입력하고, 상기 현재 영상에 상응하는 정보를 상기 필터링 신경망에 입력한 것에 기초하여 함께 훈련되는, 영상 복호화 방법."}
{"patent_id": "10-2024-0060764", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_16", "content": "영상 복호화 장치(1300)에 있어서,적어도 하나의 인스트럭션을 저장하는 적어도 하나의 메모리; 및상기 적어도 하나의 인스트럭션에 따라 동작하는 적어도 하나의 프로세서를 포함하고,상기 적어도 하나의 프로세서는,현재 영상에 대한 제1 참조 영상에 상응하는 특징맵으로부터 획득된 제1 상태 정보 또는 상기 현재 영상에 대한제2 참조 영상에 상응하는 특징맵으로부터 획득된 제2 상태 정보에 기초하여, 필터링 신경망(720) 내 적어도 하나의 레이어에 이용될 레이어 정보를 생성하고,상기 필터링 신경망(720) 내 상기 적어도 하나의 레이어에 상기 현재 영상에 상응하는 정보(710)를 입력하고,상기 레이어 정보가 이용된 상기 적어도 하나의 레이어에 상기 현재 영상에 상응하는 정보(710)를입력함으로써, 상기 현재 영상에 대해 인루프 필터링이 적용된 영상을 획득하고,상기 현재 영상에 대한 상태 정보(735)는, 상기 현재 영상에 상응하는 특징맵(725)으로부터 획득되고, 상기 현재 영상의 해상도보다 낮은 해상도를가지는, 영상 복호화 장치.공개특허 10-2025-0027203-5-청구항 17 영상 부호화 방법에 있어서,현재 영상에 대한 제1 참조 영상에 상응하는 특징맵으로부터 획득된 제1 상태 정보 또는 상기 현재 영상에 대한제2 참조 영상에 상응하는 특징맵으로부터 획득된 제2 상태 정보에 기초하여, 필터링 신경망(720) 내 적어도 하나의 레이어에 이용될 레이어 정보를 생성하는 단계(S1610); 상기 필터링 신경망(720) 내 상기 적어도 하나의 레이어에 상기 현재 영상에 상응하는 정보(710)를 입력하는 단계(S1620); 및상기 레이어 정보가 이용된 상기 적어도 하나의 레이어에 상기 현재 영상에 상응하는 정보(710)를입력함으로써, 상기 현재 영상에 대해 인루프 필터링이 적용된 영상을 획득하는 단계(S1630); 를 포함하고상기 현재 영상에 대한 상태 정보(735)는, 상기 현재 영상에 상응하는 특징맵(725)으로부터 획득되고, 상기 현재 영상의 해상도보다 낮은 해상도를 가지는, 영상 부호화 방법."}
{"patent_id": "10-2024-0060764", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_18", "content": "영상 부호화 장치(1500)에 있어서,적어도 하나의 인스트럭션을 저장하는 적어도 하나의 메모리; 및상기 적어도 하나의 인스트럭션에 따라 동작하는 적어도 하나의 프로세서를 포함하고,상기 적어도 하나의 프로세서는,현재 영상에 대한 제1 참조 영상에 상응하는 특징맵으로부터 획득된 제1 상태 정보 또는 상기 현재 영상에 대한제2 참조 영상에 상응하는 특징맵으로부터 획득된 제2 상태 정보에 기초하여, 필터링 신경망(720) 내 적어도 하나의 레이어에 이용될 레이어 정보를 생성하고,상기 필터링 신경망(720) 내 상기 적어도 하나의 레이어에 상기 현재 영상에 상응하는 정보(710)를 입력하고,상기 레이어 정보가 이용된 상기 적어도 하나의 레이어에 상기 현재 영상에 상응하는 정보(710)를입력함으로써, 상기 현재 영상에 대해 인루프 필터링이 적용된 영상을 획득하고,상기 현재 영상에 대한 상태 정보(735)는, 상기 현재 영상에 상응하는 특징맵(725)으로부터 획득되고, 상기 현재 영상의 해상도보다 낮은 해상도를가지는, 영상 부호화 장치(1500)."}
{"patent_id": "10-2024-0060764", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_19", "content": "비트스트림을 기록한 컴퓨터로 읽을 수 있는 기록 매체에 있어서,상기 비트스트림은, 현재 영상을 예측하기 위해 이용하는 예측 정보를 포함하고, 상기 예측 정보에 기초하여, 상기 제1 참조 영상에 상응하는 특징맵으로부터 획득된 제1 상태 정보 또는 상기제2 참조 영상에 상응하는 특징맵으로부터 획득된 제2 상태 정보에 기초하여, 필터링 신경망(720) 내 적어도 하나의 레이어에 이용될 레이어 정보가 생성되고, 상기 필터링 신경망(720) 내 상기 적어도 하나의 레이어에 상기 현재 영상에 상응하는 정보(710)가 입력되고,상기 레이어 정보가 이용된 상기 적어도 하나의 레이어에 상기 현재 영상에 상응하는 정보(710)가입력됨으로써, 상기 현재 영상에 대해 인루프 필터링이 적용된 영상이 획득되고,상기 현재 영상에 대한 상태 정보(735)는, 상기 현재 영상에 상응하는 특징맵(725)으로부터 획득되고, 상기 현재 영상의 해상도보다 낮은 해상도를 가지는, 기록 매체."}
{"patent_id": "10-2024-0060764", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "현재 영상에 대한 제1 참조 영상에 상응하는 특징맵으로부터 획득된 제1 상태 정보 또는 현재 영상에 대한 제2 참조 영상에 상응하는 특징맵으로부터 획득된 제2 상태 정보에 기초하여, 필터링 신경망 내 적어도 하나의 레이 어에 이용될 레이어 정보를 생성하는 단계; 필터링 신경망 내 적어도 하나의 레이어에 현재 영상에 상응하는 정 보를 입력하는 단계; 및 레이어 정보가 이용된 적어도 하나의 레이어에 현재 영상에 상응하는 정보를 입력함으로 써, 현재 영상에 대해 인루프 필터링이 적용된 영상을 획득하는 단계;를 포함하고, 현재 영상에 대한 상태 정보 는, 현재 영상에 상응하는 특징맵으로부터 획득되고, 현재 영상의 해상도보다 낮은 해상도를 가지는, 영상 복호 화 방법이 제공된다."}
{"patent_id": "10-2024-0060764", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 개시는 영상의 부호화 및 복호화 분야에 관한 것으로서, 현재 영상에 포함된 현재 블록에 대해 신경망을 이 용한 인루프 필터링을 수행함으로써, 영상을 부호화 및 복호화하는 장치 및 방법에 관한 것이다."}
{"patent_id": "10-2024-0060764", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "H.264 AVC(Advanced Video Coding) 및 HEVC(High Efficiency Video Coding)와 같은 코덱에서는, 영상을 블록으 로 분할하고, 인터 예측(inter prediction) 또는 인트라 예측(intraprediction)을 통해 각각의 블록을 예측 부 호화 및 예측 복호화할 수 있다. 인트라 예측은 영상 내의 공간적인 중복성을 제거하여 영상을 압축하는 방법이고, 인터 예측은 영상들 사이의 시간적인 중복성을 제거하여 영상을 압축하는 방법이다. 인터 예측의 대표적인 예로서, 움직임 추정 부호화가 존재한다. 움직임 추정 부호화는 참조 영상을 이용해 현재 영상의 블록들을 예측한다. 소정의 평가 함수를 이용하여 현재 블록과 가장 유사한 참조 블록을 소정의 검색 범 위에서 탐색할 수 있다. 현재 블록을 참조 블록에 기초하여 예측하고, 예측 결과 생성된 예측 블록을 현재 블록 으로부터 감산하여 잔차 블록을 생성 및 부호화한다. 참조 영상 내 참조 블록을 가리키는 움직임 벡터를 도출하기 위해, 이전에 부호화된 블록들의 움직임 벡터가 현 재 블록의 움직임 벡터 예측자(Motion Vector Predictor)로 이용될 수 있다. 현재 블록의 움직임 벡터와 움직임 벡터 예측자 사이의 차이인 잔차 움직임 벡터(Differential Motion Vector)는 소정의 방식을 통해 디코더 측으 로 시그널링된다. 최근, AI(Artificial Intelligent)를 이용하여 영상을 부호화/복호화하는 기술들이 제안되고 있는데, AI, 예를 들어, 신경망을 이용하여 영상을 효과적으로 부호화/복호화하는 방안이 요구된다."}
{"patent_id": "10-2024-0060764", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "일 실시예에서, 영상 복호화 방법은 현재 영상에 대한 제1 참조 영상에 상응하는 특징맵으로부터 획득된 제1 상 태 정보 또는 현재 영상에 대한 제2 참조 영상에 상응하는 특징맵으로부터 획득된 제2 상태 정보에 기초하여, 필터링 신경망 내 적어도 하나의 레이어에 이용될 레이어 정보를 생성하는 단계를 포함할 수 있다. 영상 복호화 방법은, 필터링 신경망 내 적어도 하나의 레이어에 현재 영상에 상응하는 정보를 입력하는 단계를 포함할 수 있 다. 영상 복호화 방법은, 레이어 정보가 이용된 적어도 하나의 레이어에 현재 영상에 상응하는 정보를 입력함으 로써, 현재 영상에 대해 인루프 필터링이 적용된 영상을 획득하는 단계를 포함할 수 있다. 현재 영상에 대한 상 태 정보는, 현재 영상에 상응하는 특징맵으로부터 획득되고, 현재 영상의 해상도보다 낮은 해상도를 가질 수 있 다. 일 실시예에서, 영상 복호화 장치는 적어도 하나의 인스트럭션을 저장하는 적어도 하나의 메모리; 및 적어도 하 나의 인스트럭션에 따라 동작하는 적어도 하나의 프로세서를 포함할 수 있다. 적어도 하나의 프로세서는, 현재 영상에 대한 제1 참조 영상에 상응하는 특징맵으로부터 획득된 제1 상태 정보 또는 현재 영상에 대한 제2 참조 영상에 상응하는 특징맵으로부터 획득된 제2 상태 정보에 기초하여, 필터링 신경망 내 적어도 하나의 레이어에 이용될 레이어 정보를 생성할 수 있다. 적어도 하나의 프로세서는, 필터링 신경망 내 적어도 하나의 레이어에 현재 영상에 상응하는 정보를 입력할 수 있다. 적어도 하나의 프로세서는, 레이어 정보가 이용된 적어도 하나의 레이어에 현재 영상에 상응하는 정보를 입력함으로써, 현재 영상에 대해 인루프 필터링이 적용된 영상을 획득할 수 있다. 현재 영상에 대한 상태 정보는, 현재 영상에 상응하는 특징맵으로부터 획득되고, 현재 영상의 해상도 보다 낮은 해상도를 가질 수 있다. 일 실시예에서, 영상 부호화 방법은, 현재 영상에 대한 제1 참조 영상에 상응하는 특징맵으로부터 획득된 제1 상태 정보 또는 현재 영상에 대한 제2 참조 영상에 상응하는 특징맵으로부터 획득된 제2 상태 정보에 기초하여, 필터링 신경망 내 적어도 하나의 레이어에 이용될 레이어 정보를 생성하는 단계를 포함할 수 있다. 일 실시예에 서, 영상 부호화 방법은, 필터링 신경망 내 적어도 하나의 레이어에 현재 영상에 상응하는 정보를 입력하는 단 계를 포함할 수 있다. 일 실시예에서, 영상 부호화 방법은, 레이어 정보가 이용된 적어도 하나의 레이어에 현재 영상에 상응하는 정보를 입력함으로써, 현재 영상에 대해 인루프 필터링이 적용된 영상을 획득하는 단계를 포함할 수 있다. 현재 영상에 대한 상태 정보는, 현재 영상에 상응하는 특징맵으로부터 획득되고, 현재 영상의 해상 도보다 낮은 해상도를 가질 수 있다. 일 실시예에서, 영상 부호화 장치는 적어도 하나의 인스트럭션을 저장하는 적어도 하나의 메모리; 및 적어도 하 나의 인스트럭션에 따라 동작하는 적어도 하나의 프로세서를 포함할 수 있다. 적어도 하나의 프로세서는, 현재 영상에 대한 제1 참조 영상에 상응하는 특징맵으로부터 획득된 제1 상태 정보 또는 현재 영상에 대한 제2 참조 영상에 상응하는 특징맵으로부터 획득된 제2 상태 정보에 기초하여, 필터링 신경망 내 적어도 하나의 레이어에 이용될 레이어 정보를 생성할 수 있다. 적어도 하나의 프로세서는, 필터링 신경망 내 적어도 하나의 레이어에 현재 영상에 상응하는 정보를 입력할 수 있다. 적어도 하나의 프로세서는, 레이어 정보가 이용된 적어도 하나의 레이어에 현재 영상에 상응하는 정보를 입력함으로써, 현재 영상에 대해 인루프 필터링이 적용된 영상을 획득할 수 있다. 현재 영상에 대한 상태 정보는, 현재 영상에 상응하는 특징맵으로부터 획득되고, 현재 영상의 해상도 보다 낮은 해상도를 가질 수 있다. 일 실시예에서, 비트스트림을 기록한 컴퓨터로 읽을 수 있는 기록 매체가 제공될 수 있다. 비트스트림은, 현재 영상을 예측하기 위해 이용하는 예측 정보를 포함할 수 있다. 예측 정보에 기초하여, 제1 참조 영상에 상응하는 특징맵으로부터 획득된 제1 상태 정보 또는 제2 참조 영상에 상응하는 특징맵으로부터 획득된 제2 상태 정보에 기초하여, 필터링 신경망 내 적어도 하나의 레이어에 이용될 레이어 정보가 생성될 수 있다. 필터링 신경망 내 적어도 하나의 레이어에 현재 영상에 상응하는 정보가 입력될 수 있다. 레이어 정보가 이용된 적어도 하나의 레 이어에 현재 영상에 상응하는 정보가 입력됨으로써, 현재 영상에 대해 인루프 필터링이 적용된 영상이 획득될 수 있다. 현재 영상에 대한 상태 정보는, 현재 영상에 상응하는 특징맵으로부터 획득되고, 현재 영상의 해상도 보다 낮은 해상도를 가질 수 있다."}
{"patent_id": "10-2024-0060764", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 개시에 따라, 신경망을 이용하는 인루프 필터링을 통해, 세부 사항을 복원하고, 영상의 화질을 개선할 수 있 습니다. 또한, 본 개시에 따라, 원본 영상과 복호화된 영상의 차이를 감소시킬 수 있습니다."}
{"patent_id": "10-2024-0060764", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "본 개시에서, \"a, b 또는 c 중 적어도 하나\" 표현은 \" a\", \" b\", \" c\", \"a 및 b\", \"a 및 c\", \"b 및 c\", \"a, b 및 c 모두\", 혹은 그 변형들을 지칭할 수 있다. 본 개시에서 문맥상 명백하게 다르게 지시하지 않는 한, 단수의 형태 \"a,\" \"an,\" 및 \"the\"는 복수의 대상을 포 함한다고 이해될 수 있다. 따라서, 예를 들어, \"구성 표면\"이라는 기재는 그러한 표면들 중 하나 이상을 가리키 는 경우도 포함할 수 있다. 본 개시를 설명함에 있어서 본 개시가 속하는 기술 분야에 익히 알려져 있고 본 개시와 직접적으로 관련이 없는 기술 내용에 대해서는 설명을 생략한다. 이는 불필요한 설명을 생략함으로써 본 개시의 요지를 흐리지 않고 더 욱 명확히 전달하기 위함이다. 그리고 후술되는 용어들은 본 개시에서의 기능을 고려하여 정의된 용어들로서 이 는 사용자, 운용자의 의도 또는 관례 등에 따라 달라질 수 있다. 그러므로 그 정의는 본 명세서 전반에 걸친 내 용을 토대로 내려져야 할 것이다. 마찬가지 이유로 첨부된 도면에 있어서 일부 구성요소는 과장되거나 생략되거나 개략적으로 도시 되었다. 또한, 각 구성요소의 크기는 실제 크기를 전적으로 반영하는 것이 아니다. 각 도면에서 동일한 또는 대응하는 구성 요 소에는 동일한 참조 번호를 부여하였다. 본 개시의 이점 및 특징, 그리고 그것들을 달성하는 방법은 첨부되는 도면과 함께 상세하게 후술 되어 있는 실 시예들을 참조하면 명확해질 것이다. 그러나 본 개시는 이하에서 개시되는 실시예들에 한정되는 것이 아니라 서 로 다른 다양한 형태로 구현될 수 있다. 개시된 실시예들은 본 개시의 개시가 완전하도록 하고, 본 개시가 속하"}
{"patent_id": "10-2024-0060764", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "는 기술분야에서 통상의 지식을 가진 자에게 개시의 범주를 완전하게 알려주기 위해 제공되는 것이다. 본 개시 의 일 실시예는 청구범위에 따라 정의될 수 있다. 명세서 전체에 걸쳐 동일한 참조 부호는 동일한 구성 요소를 나타낸다. 또한, 본 개시의 일 실시예를 설명함에 있어서 관련된 기능 또는 구성에 대한 구체적인 설명이 본 개 시의 요지를 불필요하게 흐릴 수 있다고 판단된 경우 그 상세한 설명은 생략한다. 그리고 후술되는 용어들은 본 개시에서의 기능을 고려하여 정의된 용어들로서 이는 사용자, 운용자의 의도 또는 관례 등에 따라 달라질 수 있 다. 그러므로 그 정의는 본 명세서 전반에 걸친 내용을 토대로 내려져야 할 것이다. 본 개시에서 각각의 순서도에서의 블록들 및 순서도들의 조합들은 컴퓨터 실행 가능 명령어들을 포함하는 하나 이상의 컴퓨터 프로그램들에 의해 수행될 수 있다고 이해되어야 한다. 하나 이상의 컴퓨터 프로그램들은 단일 메모리에 모두 저장되거나, 또는 서로 다른 다수의 메모리들에 분할되어 저장될 수 있다. 일 실시예에서, 흐름도 도면들의 각 블록과 흐름도 도면들의 조합들은 컴퓨터 프로그램 인스트럭션들에 의해 수 행될 수 있다. 컴퓨터 프로그램 인스트럭션들은 범용 컴퓨터, 특수용 컴퓨터 또는 기타 프로그램 가능한 데이터 프로세싱 장비의 프로세서에 탑재될 수 있고, 컴퓨터 또는 기타 프로그램 가능한 데이터 프로세싱 장비의 프로 세서를 통해 수행되는 그 인스트럭션들이 흐름도 블록(들)에서 설명된 기능들을 수행하는 수단을 생성할 수 있 다. 컴퓨터 프로그램 인스트럭션들은 특정 방식으로 기능을 구현하기 위해 컴퓨터 또는 기타 프로그램 가능한 데이터 프로세싱 장비를 지향할 수 있는 컴퓨터 이용 가능 또는 컴퓨터 판독 가능 메모리에 저장되는 것도 가능 하고, 컴퓨터 이용가능 또는 컴퓨터 판독 가능 메모리에 저장된 인스트럭션들은 흐름도 블록(들)에서 설명된 기 능을 수행하는 인스트럭션 수단을 내포하는 제조 품목을 생산하는 것도 가능하다. 컴퓨터 프로그램 인스트럭션 들은 컴퓨터 또는 기타 프로그램 가능한 데이터 프로세싱 장비상에 탑재되는 것도 가능하다. 또한, 흐름도 도면의 각 블록은 특정된 논리적 기능(들)을 실행하기 위한 하나 이상의 실행 가능한 인스트럭션 들을 포함하는 모듈, 세그먼트 또는 코드의 일부를 나타낼 수 있다. 일 실시예에서, 블록들에 언급된 기능들이 순서를 벗어나서 발생하는 것도 가능하다. 예를 들면, 잇달아 도시되어 있는 두 개의 블록들은 실질적으로 동시 에 수행되는 것도 가능하고 또는 기능에 따라 역순으로 수행되는 것도 가능하다. 본 개시에서 설명되는 모든 기능이나 동작은 하나의 프로세서 또는 프로세서들의 조합에 의해 처리될 수 있다. 하나의 프로세서 또는 프로세서들의 조합은 처리를 수행하는 회로 장치(circuitry)로서, AP (Application Processor), CP (Communication Processor), GPU (Graphical Processing Unit), NPU (Neural Processing unit), MPU (Microprocessor Unit), SoC (System on Chip), IC (Integrated Chip) 등과 같은 회로 장치를 포함 할 수 있다. 본 개시의 일 실시예에서 사용되는 '~부'라는 용어는 소프트웨어 또는 FPGA(Field Programmable Gate Array) 또는 ASIC(Application Specific Integrated Circuit)과 같은 하드웨어 구성요소를 나타낼 수 있고, '~부'는 특정한 역할을 수행할 수 있다. 한편, '~부'는 소프트웨어 또는 하드웨어에 한정되는 의미는 아니다. '~부'는 어드레싱할 수 있는 저장 매체에 있도록 구성될 수도 있고 하나 또는 그 이상의 프로세서들을 재생시키도록 구 성될 수도 있다. 일 실시예에서 '~부'는 소프트웨어 구성요소들, 객체지향 소프트웨어 구성요소들, 클래스 구성 요소들 및 태스크 구성요소들과 같은 구성요소들과, 프로세스들, 함수들, 속성들, 프로시저들, 서브루틴들, 프 로그램 코드의 세그먼트들, 드라이버들, 펌웨어, 마이크로코드, 회로, 데이터, 데이터베이스, 데이터 구조들, 테이블들, 어레이들, 및 변수들을 포함할 수 있다. 특정한 구성요소나 특정한 '~부'를 통해 제공되는 기능은 그 개수를 줄이도록 결합되거나 추가적인 구성요소들로 분리될 수 있다. 또한, 일 실시예에서 ‘~부’는 하나 이상 의 프로세서를 포함할 수 있다. 본 개시에서, '영상(image)'은 정지 영상, 픽처, 프레임, 복수의 연속된 정지 영상으로 구성된 동영상, 또는 비 디오를 나타낼 수 있다. 본 개시에서 '신경망(neural network)'은 뇌 신경을 모사한 인공 신경망 모델의 대표적인 예시로서, 특정 알고 리즘을 사용한 인공 신경망 모델로 한정되지 않는다. 신경망은 심층 신경망(Deep Neural Network), 컨볼루션 신 경망(Convolution Neural Network), 및 트랜스포머 신경망(Transformer Neural Network) 중 적어도 하나로 참 조될 수도 있다. 본 개시에서 '현재 영상'은 현재의 처리 대상인 영상을 의미하고, '이전 영상'은 현재 영상 이전의 처리 대상인 영상을 의미한다. 본 개시에서, '샘플'은 영상, 특징 맵 또는 특징 데이터 내 샘플링 위치에 할당된 데이터로서 처리 대상이 되는 데이터를 의미한다. 예를 들어, 샘플은 2차원의 영상 내 픽셀을 포함할 수 있다. 본 개시에서, '상태 정보'는, 소정의 영상에 포함된 주요 객체, 사물의 형태, 선 방향, 색상 분포 등 이미지의 추상적인 특징를 종합적으로 나타내는 정보일 수 있다. 도 1은 본 개시의 일 실시예에 따른 인루프 필터링을 수행하는 영상 부호화 및 복호화 시스템의 블록도를 나타 낸 도면이다. 일 실시예에서, 영상 부호화 장치는 영상에 대한 부호화를 통해 생성된 비트스트림을 영상 복호화 장치 로 전송하고, 영상 복호화 장치는 비트스트림을 수신 및 복호화하여 영상을 복원한다 일 실시예에서, 영상 부호화 장치에서, 예측 부호화부는 인터 예측 및 인트라 예측을 통해 예측 블록 을 출력하고, 변환 및 양자화부는 예측 블록과 현재 블록 사이의 잔차 블록의 잔차 샘플들을 변환 및 양자 화하여 양자화된 변환 계수를 출력한다. 엔트로피 부호화부는 양자화된 변환 계수를 부호화하여 비트스트 림으로 출력한다. 일 실시예에서, 양자화된 변환 계수는 역양자화 및 역변환부을 거쳐 공간 영역의 잔차 샘플들을 포함하는 잔차 블록으로 복원된다. 예측 블록과 잔차 블록이 합해진 복원 블록은 인루프 필터링부를 거쳐 필터링된 블록으로 출력된다. 필터링된 블록을 포함하는 복원 영상은 예측 부호화부에서 다음 입력 영상의 참조 영 상으로 사용될 수 있다. 일 실시예에서, 영상 복호화 장치로 수신된 비트스트림은 엔트로피 복호화부 및 역양자화 및 역변환 부를 거쳐 공간 영역의 잔차 샘플들을 포함하는 잔차 블록으로 복원된다. 예측 복호화부로부터 출력 된 예측 블록과 잔차 블록이 조합되어 복원 블록이 생성되고, 복원 블록은 인루프 필터링부를 거쳐 필터링 된 블록으로 출력된다. 필터링된 블록을 포함하는 복원 영상은 예측 복호화부에서 다음 영상에 대한 참조 영상으로 이용될 수 있다. 일 실시예에서, 영상 부호화 장치의 인루프 필터링부는 사용자 입력 또는 시스템 설정에 따라 입력된 필터 정보를 이용하여 루프 필터링을 수행한다. 인루프 필터링부에 의해 사용된 필터 정보는 엔트로피 부 호화부를 통해 영상 복호화 장치로 전송된다. 영상 복호화 장치의 인루프 필터링부는 엔트 로피 복호화부로부터 입력된 필터 정보에 기초하여 인루프 필터링을 수행할 수 있다. 일 실시예에서, 영상의 부호화 및 복호화 과정에서는 영상이 계층적으로 분할되고, 영상으로부터 분할된 블록에 대해 부호화 및 복호화가 수행된다. 영상으로부터 분할된 블록에 대해 도 2를 참조하여 설명한다. 도 2는 영상으로부터 트리 구조에 따라 분할된 블록들을 도시하는 도면이다. 일 실시예에서, 하나의 영상은 하나 이상의 슬라이스(Slice) 혹은 하나 이상의 타일(Tile)로 분할될 수 있 다. 하나의 슬라이스는 복수의 타일을 포함할 수 있다. 한편, 본 명세서에서, 영상은 이미지 또는 픽처와 동일 한 의미를 나타낼 수 있다. 일 실시예에서, 하나의 슬라이스 혹은 하나의 타일은 하나 이상의 최대 부호화 단위(Maximum Coding Unit; Maximum CU)의 시퀀스일 수 있다. 일 실시예에서, 하나의 최대 부호화 단위는 하나 이상의 부호화 단위로 분할될 수 있다. 부호화 단위는 예측 모 드를 결정하기 위한 기준 블록일 수 있다. 다시 말하면, 각각의 부호화 단위에 대해 인트라 예측 모드가 적용되 는지, 인터 예측 모드가 적용되는지가 결정될 수 있다. 본 개시에서 최대 부호화 단위는 최대 부호화 블록으로 참조될 수 있고, 부호화 단위는 부호화 블록으로 참조될 수 있다. 일 실시예에서, 부호화 단위의 크기는 최대 부호화 단위와 동일하거나, 최대 부호화 단위보다 작을 수 있다. 최 대 부호화 단위는 최대 크기를 가지는 부호화 단위이므로, 부호화 단위로 참조될 수도 있다. 일 실시예에서, 부호화 단위로부터 인트라 예측 또는 인터 예측을 위한 하나 이상의 예측 단위가 결정될 수 있 다. 예측 단위의 크기는 부호화 단위와 동일하거나, 부호화 단위보다 작을 수 있다. 일 실시예에서, 부호화 단위로부터 변환 및 양자화를 위한 하나 이상의 변환 단위가 결정될 수 있다. 변환 단위 의 크기는 부호화 단위와 동일하거나, 부호화 단위보다 작을 수 있다. 변환 단위는 변환 및 양자화를 위한 기준 블록으로서, 부호화 단위의 잔차 샘플들이 부호화 단위 내의 변환 단위별로 변환 및 양자화될 수 있다. 일 실시예에서, 본 개시의 현재 블록은 영상으로부터 분할된 슬라이스, 타일, 최대 부호화 단위, 부호화 단위, 예측 단위 또는 변환 단위일 수 있다. 또한, 현재 블록의 하위 블록은 현재 블록으로부터 분할된 블록일 수 있다. 예를 들어, 현재 블록이 최대 부호화 단위이면, 하위 블록은 부호화 단위, 예측 단위 또는 변환 단위 일 수 있다. 또한, 현재 블록의 상위 블록은 현재 블록을 일부로 포함하는 블록으로서, 예를 들어, 현재 블록이 최대 부호화 단위이면, 상위 블록은 픽처 시퀀스, 픽처, 슬라이스 또는 타일일 수 있다. 도 3은 본 개시의 일 실시예에 따른 픽처 그룹(GOP; Group Of Pictures) 구조를 설명하기 위한 도면이다. 도 3을 참조하면, 복수의 이미지들은 같은 그룹 내 다른 이미지를 참조하여 압축이 수행될 수 있다. 일 실시예에서, 실제 이미지의 순서와 상이하게 압축되는 순서를 결정하여 시간상으로 앞, 뒤에 있는 이미지를 참조 이미지로 사용할 수 있다. 예를 들면, 실제 이미지 순서는 0, 1, 2, .. , 16 번이지만, 압축 순서는 0, 16, 8, .. , 15 순서로 진행될 수 있다. 0번 이미지는 참조할 수 있는 이미지가 없기 때문에 화면내 예측 방법 만 사용 되며, 이후 이미지는 화면 간 예측 방법을 추가로 사용하게 된다. 이때 1번 이미지부터 16번 이미지까 지 16장의 이미지의 구조를 GOP라고 하며 해당 GOP구조를 반복적으로 사용한다. 이때 GOP의 크기는 16이 된다. GOP에 포함된 복수의 이미지들은 압축 순서 또는 참조 관계에 기초하여, 복수의 레이어로 구별될 수 있다. 예를 들면, 16번 이미지를 참조하는 8번, 12번, 14번 이미지는 16번 이미지 보다 높은 레이어인 것으로 결정할 수 있 다. 일 실시예에서, 영상을 압축 할 때 압축의 효율을 높이기 위해 이미지 별로 다른 값의 양자 파라미터 (QP; Quantization Parameter)를 사용할 수 있다. 예를 들어, 참조가 되는 영상은 QP를 낮추어 화질을 좋게 만들어 참조의 효율을 높이고, 참조하는 영상은 QP를 높여 적은 bitrate를 갖게 할 수 있다. 낮은 Layer에 있는 이미지 일수록 참조되는 회수가 많기 때문에 낮은 QP를 사용하고 높은 Layer에 있는 이미지는 상대적으로 높은 QP를 사 용할 수 있다. 가장 높은 Layer에 있는 이미지들은 다른 이미지 압축에서 참조되지 않으며 이에 따라 가장 높은 QP를 사용할 수 있다. 이와 같은 실시예에서 참조하는 이미지는 참조되는 이미지의 좋은 화질을 가져옴으로써 이미지 압축의 효율을 높일 수 있다. 도 4는 본 개시의 일 실시예에 따른 현재 블록과 참조 블록의 관계를 설명하기 위한 도면이다. 도 4를 참조하면, 현재 블록과 참조 블록의 관계가 전방향(Forward) 참조, 양방향(Bi-direction) 참조, 후방향 (Backward) 참조 또는 2 전방향(2 Forward) 참조일 수 있다. 일 실시예에서, 현재 블록과 참조 블록의 관계가 전방향 참조일 수 있다. 현재 영상의 시간 순서를 T라고 할 때, 참조 영상의 시간 순서는 현재 영상 보다 이전인 T -M 일 수 있다. 일 실시예에서, 현재 블록과 참조 블록의 관계가 양방향 참조일 수 있다. 현재 영상의 시간 순서를 T라고 할 때, 참조 영상들의 시간 순서는 현재 영상 보다 이전인 T - M과 현재 영상 보다 이후인 T + N 일 수 있다. 일 실시예에서, 현재 블록과 참조 블록의 관계가 후방향 참조일 수 있다. 현재 영상의 시간 순서를 T라고 할 때, 참조 영상의 시간 순서는 현재 영상 보다 이후인 T + N 일 수 있다. 일 실시예에서, 현재 블록과 참조 블록의 관계가 2 전방향 참조일 수 있다. 현재 영상의 시간 순서를 T라 고 할 때, 참조 영상의 시간 순서는 현재 영상 보다 이전인 T - M, T - N 일 수 있다. 일 실시예에서, 현재 블록과 참조 블록의 관계가 2 후방향 참조(미도시)일 수 있다. 현재 영상의 시간 순서를 T 라고 할 때, 참조 영상의 시간 순서는 현재 영상 보다 이후인 T + M, T + N 일 수 있다. 일 실시예에서, 영상 부호화 장치는, 영상 복호화 장치에서 현재 영상에 대한 참조 영상으로 이용할 영상을 결 정할 수 있고, 현재 영상에 포함된 서브 블록들에 대한 움직임 정보를 결정할 수 있다. 일 실시예에서, 영상 복호화 장치는 현재 영상과 참조 영상 사이의 관계에 기초하여, 움직임 정보를 결정할 수 있다. 예를 들면, 현재 블록의 복수의 서브 블록의 움직임 정보 중에서 현재 영상과 참조 영상이 소정의 조건을 만족하는 움직임 정보를 획득할 수 있다. 일 실시예에서, 참조 영상은 GOP 상에서 현재 영상보다 낮은 레이어인 영상 중에서 결정될 수 있다. 일 실시예에서, 참조 영상은 GOP 상에서 가장 낮은 레이어인 영상 중에서 결정될 수 있다. 예를 들면, 레이어 1 인 0번 영상만 참조 영상으로 결정 될 수 있다. 일 실시예에서, GOP 내 복수의 이미지는 각각 축소 여부가 결정될 수 있다. 예를 들어, 화면 내 예측을 사용하 는 이미지는 축소되지 않고 원본 크기로 복호화되고, 다른 이미지들은 축소되어 복호화될 수 있다. 예를 들어, 화면내 예측을 사용하는 이미지와 특정 레이어(예: 최하위 레이어)에 포함된 이미지들은 축소되지 않고 원본 크 기로 복호화되고, 다른 이미지들은 축소되어 복호화될 수 있다. 일 실시예에서, 영상 복호화 장치는 현재 영상을 복호화 하기 위해, 현재 영상의 POC 값보다 작은 POC 값을 갖 는 적어도 하나의 픽처로 구성된 현재 영상에 대한 제1 참조 픽처 리스트에 포함된 제1 참조 영상을 이용할 수 있다. 또는, 영상 복호화 장치는, 현재 영상을 복호화 하기 위해, 현재 영상의 POC 값보다 큰 POC 값을 갖는 적 어도 하나의 픽처로 구성된 현재 영상에 대한 제2 참조 픽처 리스트에 포함된 제2 참조 영상을 이용할 수 있다. 한편, 개시된 예에 한하지 않고, 제1 참조 영상 및 제2 참조 영상은, 모두 현재 영상의 제1 참조 픽처 리스트에 포함된 영상일 수도 있고, 모두 현재 영상의 제2 참조 픽처 리스트에 포함된 영상일 수도 있다. 도 5는 본 개시의 일 실시예에 따른 인루프 필터링 동작을 나타내는 도면이다. 일 실시예에서, 영상 부호화 장치의 인루프 필터링부 또는 영상 복호화 장치의 인루프 필터링부 (이하, 인루프 필터링부)는 디블록킹 필터링부, 샘플 적응적 오프셋 필터링부, 적응적 루 프 필터링부 중 적어도 하나를 포함할 수 있다. 일 실시예에서, 디블록킹 필터링부는 디블록킹 필터링(Deblocking Filtering)을 수행할지 여부를 결정하고, 디블록킹 필터링을 수행할 수 있다. 샘플 적응적 오프셋 필터링부는 샘플 적응적 오프셋 필터링 (Sample Adaptive Offset Filtering)을 수행할지 여부를 결정하고 샘플 적응적 오프셋을 필터링을 수행할 수 있 다. 적응적 루프 필터링부는 적응적 루프 필터링(Adaptive Loop Filtering)을 수행할지 여부를 결정하고 적응적 루프 필터링을 수행할 수 있다. 일 실시예에서, 인루프 필터링부는 디블록킹 필터링부, 샘플 적응적 오프셋 필터링부, 및 적응 적 루프 필터링부 통해 필터링된 필터링된 픽처를 디코딩된 픽처 버퍼에 저장할 수 있다. 따라서, 디 코딩된 픽처 버퍼에 저장된 적어도 하나의 픽처는 인루프 필터링이 수행된 것일 수 있으며, 인터 예측에서 예측 블록을 생성하기 위해 이용하는 참조 픽처로서 이용될 수 있다. 일 실시예에서, 디블록킹 필터링은 변환, 예측, 양자화의 과정을 수행하는 과정에서 발생하는 블로킹 아티팩트 를 감소시키기 위해 디블록킹 필터를 이용하여 변환 블록의 경계에 적용되는 필터링일 수 있다. 일 실시예에서, 디블록킹 필터링을 위한 필터 길이는 양쪽의 최소 변환 블록의 크기 또는 영상 성분에 따라 결 정될 수 있다. 루마 샘플에 대한 변환 블록에 대해서는 4탭(tap), 8탭, 14탭 필터가 적용될 수 있으며, 크로마 샘플에 대한 변환 블록에 대해서는, 6탭 필터가 적용될 수 있다. 한편, 디블록킹 필터링을 위해 이용하는 탭의 크기, 또는 길이는 개시된 예에 한하지 않는다. 일 실시예에서, 디블록킹 필터링을 위한 필터 길이는 변환 블록들 사이의 경계의 평활도 또는 경계 조건에 따라 결정될 수 있다. 예를 들어, 영상 복호화 장치는 영상 데이터에 대해 필터링을 수행할 때, 객체의 가장자 리가 흐려지는 것을 방지하기 위해, 높은 분산의 샘플들을 포함하는 영역을 가장자리로서 식별하여 디블록킹 필 터링을 수행하지 않을 수 있다. 영상 복호화 장치는 영상 데이터 내에서 평활도를 계산하거나 경계 조건을 만족하는지 식별하여, 변환 블록의 경계가 플랫(flat)한 것으로 식별된 경우에만 변환 블록의 경계를 필터링할 수 있다. 경계 조건은 수직 경계인지 또는 수평 경계인지 여부 및 루마 샘플에 대한 변환 블록인지 여부 또는 크로마 샘플에 대한 변환 블록인지 여부에 따라 상이할 수 있다. 영상 복호화 장치는 경계 조건과 연관된 정보를 비트스트림으로부터 획득할 수 있으며, 경계 조건은 기 설정되어 있을 수 있다. 또한, 디블록킹 필터링 과 연관된 필터 계수는 기 설정되어 있을 수 있다. 일 실시예에서, 샘플 적응적 오프셋 필터링은 링잉 아티팩트를 감소시키기 위해 이웃 블록들의 샘플을 분류하고, 분류된 샘플들에 대한 오프셋을 이용하는 필터링일 수 있다. 예를 들어, 샘플 적응적 오프셋 필터링 은 디블록킹 필터링이 수행된 영상에 포함된 적어도 하나의 샘플에 대해 오프셋을 더하여, 복원 영상과 원본 영 상간의 에러를 감소시키는 필터링일 수 있다. 일 실시예에서, 샘플 적응적 오프셋 필터링은 블록 내의 샘플 특성을 샘플 적응적 오프셋 필터링을 사용하지 않 거나, 에지 오프셋 필터링을 수행하거나, 밴드 오프셋 필터링을 수행하는 것 중 하나로 결정할 수 있다. 일 실시예에서, 에지 오프셋 필터링은 블록에 특정 방향으로 에지가 있고 에지 방향의 샘플들에 대해 에러가 존 재하는 것으로 식별된 경우에 수행되는 필터링이다. 영상 복호화 장치는, 에지 오프셋 필터링을 위해, 블 록에 대응하는 클래스 및 4개의 에지 오프셋 값을 획득하여 블록에 대해 에지 오프셋 필터링을 수행할 수 있다. 일 실시예에서, 밴드 오프셋 필터링은, 블록 내의 샘플들을 유사한 밝기 값을 갖는 밝기 대역으로 분류하고, 연 속하는 복수의 대역에 대한 오프셋을 이용하여 수행되는 필터링이다. 영상 복호화 장치는, 복수의 대역에 대한 정보를 획득하기 위해 대역의 시작 구간에 대한 정보 및 복수의 대역의 각각에 대한 오프셋 값을 획득하여, 밴드 오프셋 필터링을 수행할 수 있다. 일 실시예에서, 영상 복호화 장치는, 주변 블록에 대한 샘플 적응적 오프셋 필터링에 관한 정보를 이용하 여 현재 블록에 대한 샘플 적응적 오프셋 필터링을 수행할 수 있다. 예를 들어, 영상 복호화 장치는 상측 블록 또는 좌측 블록에 대한 샘플 적응적 오프셋 필터링에 관한 정보를 이용하여 현재 블록에 대한 샘플 적응적 오프셋 필터링을 수행할 수 있다. 일 실시예에서, 적응적 루프 필터링은 현재 블록의 특성에 기초하여 적응적으로 결정 또는 획득된 필터를 이용 하여 현재 블록에 적용되는 필터링일 수 있다. 적응적 루프 필터링은 적어도 하나의 사전 정의된 필터 세트, 적 응적 파라미터 세트로부터 획득한 적어도 하나의 APS 필터 세트, 및 현재 블록의 클래스 중 적어도 하나에 기초 하여 결정된 필터를 이용하여 수행되는 필터링일 수 있다. 일 실시예에서, 적응적 루프 필터링은, 비트스트림으로부터 획득한 정보에 기초하여, 사전 정의된 필터 세트 또 는 적응적 파라미터 세트로부터 획득된 적어도 하나의 APS 필터 세트 중 하나의 필터를 결정하여 이용하는 필터 링일 수 있다. 또한, 적응적 루프 필터링에서 이용하는 필터는, 현재 블록 내의 샘플의 방향성 및 활동성 등의 특성에 따라 복수의 클래스 중 하나로 결정될 수 있다. 한편, 현재 블록 내의 샘플의 방향성 및 활동성 등의 특 성은 현재 블록에 대한 기울기(gradient)를 이용하여 결정될 수 있다. 한편, 인루프 필터링부는 개시된 예에 한하지 않고, 디블록킹 필터링부, 샘플 적응적 오프셋 필터링 부, 및 적응적 루프 필터링부 중 적어도 하나의 필터링부와 병렬적으로 영상를 추가 처리하거나, 적 어도 하나의 필터링부의 이전 또는 이후에 부가된 구성을 통해 추가적인 필터링이 수행될 수도 있다. 예를 들어, 인루프 필터링부는 현재 영상에 대해 인루프 필터링이 적용된 영상을 획득하기 위해, 필터링 신경망 으로부터 획득한 출력 영상을 이용할 수 있다. 일 실시예에서, 인루프 필터링부는 상태 정보를 이용하여 영상을 추가적으로 필터링하는 필터링 신경망 을 포함할 수 있다. 예를 들어, 필터링 신경망은 디블록킹 필터링부와 병렬적으로 복원 영상을 추가 처리할 수 있다. 일 실시예에서, 필터링 신경망은 현재 영상에 대한 복원 영상, 디코딩된 픽처 버퍼에 포함된 적어도 하나의 영상, 상태 정보 버퍼에 포함된 적어도 하나의 영상에 각각 대응하는 상태 정보를 이용하여 현재 영상에 대한 필터링을 수행하는 신경망일 수 있다. 일 실시예에서, 필터링 신경망은 현재 영상에 상응하는 정보를 획득한 것에 기초하여, 현재 영상을 위한 출력 영상을 생성할 수 있다. 예를 들어, 필터링 신경망은, 현재 영상에 상응하는 정보로서, 현재 영상의 복원 영상, 현재 영상의 예측 영상, 현재 영상의 제1 참조 영상, 현재 영상의 제2 참조 영상, 현재 영상을 위한 적어도 하나의 양자화 파라미터, 현재 영상에 대한 분할 정보 중 적어도 하나를 획득할 수 있다. 일 실시예에서, 인루프 필터링부는 필터링 신경망에 현재 영상에 상응하는 정보를 입력함으로써, 현 재 영상에 대해 인루프 필터링이 적용된 영상을 획득할 수 있다. 예를 들어, 필터링 신경망은 현재 영상에 상응하는 정보를 입력받은 것에 기초하여, 현재 영상에 상응하는 특징맵을 생성하고, 현재 영상에 상응하는 특 징맵으로부터 출력 영상을 생성할 수 있다. 또한, 인루프 필터링부는 출력 영상을 이용하여, 현재 영상에 대해 인루프 필터링이 적용된 영상을 획득할 수 있다. 일 실시예에서, 인루프 필터링부는, 상태 정보 버퍼에 포함된 적어도 하나의 참조 영상에 대응하는 상태 정보를 이용하여 필터링 신경망 내 적어도 하나의 레이어에 이용될 레이어 정보를 결정 또는 생성할 수 있 다. 예를 들어, 인루프 필터링부는, 상태 정보 버퍼에 저장된 제1 참조 영상에 대응하는 제1 상태 정 보 및 제2 참조 영상에 대응하는 제2 상태 정보에 기초하여 필터링 신경망에 이용하기 위한 커널(Kernel) 또는 어텐션 맵(Attention Map)을 결정 또는 생성할 수 있다. 일 실시예에서, 인루프 필터링부는 레이어 정보에 기초한 필터링 신경망에 현재 영상에 상응하는 정 보를 입력할 수 있다. 인루프 필터링부는 필터링 신경망에 현재 영상에 상응하는 정보를 입력한 것에 기초하여, 필터링 신경망으로부터 현재 영상에 대한 출력 영상을 획득할 수 있다. 일 실시예에서, 영상 복호화 장치는, 디블록킹 필터링부로부터 획득한 디블록킹 필터링된 영상과 필 터링 신경망으로부터 획득한 출력 영상에 대한 덧셈 연산을 수행할 수 있다. 덧셈 연산은, 성분합 (element-wise sum)을 지칭하는 것일 수 있다. 영상 복호화 장치는, 디블록킹 필터링된 영상과 출력 영상 에 대한 덧셈 연산을 수행한 결과를 샘플 적응적 오프셋 필터링부에 입력할 수 있다. 디블록킹 필터링된 영상과 출력 영상에 대한 덧셈 연산을 수행한 결과는 샘플 적응적 오프셋 필터링부 및 적응적 루프 필터링 부를 거쳐 디코딩된 픽처 버퍼에 저장될 수 있다. 또한, 샘플 적응적 오프셋 필터링부 및 적응 적 루프 필터링부를 거쳐 디코딩된 픽처 버퍼에 저장된 영상은, 참조 영상으로 이용될 수 있으며, 상 기 디코딩된 픽처 버퍼에 저장된 영상에 대응하는 상태 정보는 상태 정보 버퍼에 저장될 수 있다. 한편, 상기 필터링 신경망이 디블록킹 필터링부와 병렬적으로 구성되는 것은, 하나의 예시에 불과하며, 개 시된 예에 한하지 않으며, 복수의 필터링부와 병렬적으로 구성되거나 일렬로 연결되어 있을 수 있다. 또한, 디 블록킹 필터링된 영상과 필터링 신경망으로부터 획득한 출력 영상에 대해 단순히 덧셈 연산을 수행하는 것 뿐만 아니라, 디블록킹 필터링된 영상 및 출력 영상에 각각 소정의 가중치를 부여하여 가중합을 수행한 영상을 샘플 적응적 오프셋 필터링부의 입력으로서 입력할 수 있다. 필터링 신경망은, 필터링 신경망이 배치된 위치에 따라 적절하게 훈련될 수 있다. 이하, 필터링 신경망의 훈련과 관련하여, 도 12에서 자세히 설명하고자 한다. 도 6는 본 개시의 일 실시예에 따른 인루프 필터링 동작을 나타내는 도면이다. 일 실시예에서, 영상 부호화 장치의 인루프 필터링부 또는 영상 복호화 장치의 인루프 필터링부 (이하, 인루프 필터링부)는 디블록킹 필터링부, 샘플 적응적 오프셋 필터링부, 적응적 루 프 필터링부 중 적어도 하나를 포함할 수 있다. 일 실시예에서, 디블록킹 필터링부, 샘플 적응적 오프셋 필터링부, 적응적 루프 필터링부는 각 각 도 5의 디블록킹 필터링부, 샘플 적응적 오프셋 필터링부, 적응적 루프 필터링부에 각각 대 응할 수 있으므로, 동일한 내용은 생략한다. 일 실시예에서, 인루프 필터링부는 디블록킹 필터링부, 샘플 적응적 오프셋 필터링부, 및 적응 적 루프 필터링부 중 적어도 하나의 필터링부와 병렬적으로 영상를 추가 처리하거나, 적어도 하나의 필터 링부의 이전 또는 이후에 부가된 구성을 통해 추가적인 필터링이 수행될 수도 있다. 예를 들어, 인루프 필터링 부는 인루프 필터링된 영상을 획득하기 위해 이용하는 출력 영상을 생성하는 필터링 신경망을 포함할 수 있다. 일 실시예에서, 필터링 신경망은 복원 영상, 복원 영상을 디블록킹 필터링부에서 처리하여 획득된 디블록 킹 필터링된 영상, 디코딩된 픽처 버퍼에 포함된 적어도 하나의 영상, 상태 정보 버퍼에 포함된 상태정보를 이용하여 필터링을 수행하는 신경망일 수 있다. 일 실시예에서, 필터링 신경망은 현재 영상에 상응하는 정보를 획득한 것에 기초하여, 현재 영상을 위한 출력 영상을 생성할 수 있다. 예를 들어, 필터링 신경망은, 현재 영상에 상응하는 정보로서, 현재 영상의 복원 영상, 현재 영상의 디블록킹 필터링된 영상, 현재 영상의 예측 영상, 현재 영상의 제1 참조 영상, 현재 영 상의 제2 참조 영상, 현재 영상을 위한 적어도 하나의 양자화 파라미터, 현재 영상에 대한 분할 정보 중 적어도 하나를 획득할 수 있다. 일 실시예에서, 인루프 필터링부는, 상태 정보 버퍼에 포함된 참조 영상에 대응하는 상태 정보를 이 용하여 필터링 신경망에서 이용하기 위한 레이어 정보를 생성 또는 결정할 수 있다. 예를 들어, 인루프 필터링 부는, 상태 정보 버퍼에 저장된 상태 정보에 기초하여 필터링 신경망에 이용하기 위한 커널(Kernel) 또는 어텐션 맵(Attention Map)을 생성 또는 결정할 수 있다. 일 실시예에서, 인루프 필터링부는 레이어 정보에 기초한 필터링 신경망에 현재 영상에 상응하는 정 보를 입력할 수 있다. 인루프 필터링부는 필터링 신경망에 현재 영상에 상응하는 정보를 입력한 것에 기초하여, 필터링 신경망으로부터 현재 영상을 위한 출력 영상을 획득할 수 있다. 일 실시예에서, 인루프 필터링부는 필터링 신경망으로부터 획득한 출력 영상을 샘플 적응적 오프셋 필터링부에 입력할 수 있다. 출력 영상은 샘플 적응적 오프셋 필터링부 및 적응적 루프 필터링부 를 거쳐 인루프 필터링이 적용된 영상으로서, 디코딩된 픽처 버퍼에 저장될 수 있다. 한편, 필터링 신경망이 디블록킹 필터링 이후에 일렬로 연결되어 구성된 것은, 하나의 예시에 불과하며, 개시된 예에 한하지 않는다. 예를 들어, 필터링 신경망은, 샘플 적응적 오프셋 필터링부 및 적응적 루프 필터링부의 사이에 위치할 수 있으며, 배치된 위치에 따라 적절하게 훈련될 수 있다. 도 7는 본 개시의 일 실시예에 따른 필터링 신경망으로부터 출력 영상을 생성하는 과정을 설명하기 위한 도면이 다. 일 실시예에서, 인루프 필터링부는 필터링 신경망을 포함할 수 있다. 필터링 신경망은, 특징 추출 신 경망, 및 회귀 신경망을 포함할 수 있다. 또한, 필터링 신경망은, 인루프 필터링된 영상을 획득 하기 위해 이용하는 출력 영상을 생성하는 신경망일 수 있다. 일 실시예에서, 필터링 신경망은, 현재 영상의 복호화를 위해 제1 참조 영상 또는 제2 참조 영상을 이용하 는 경우, 제1 참조 영상에 대응하는 제1 상태 정보 또는 제2 참조 영상에 대응하는 제2 상태 정보를 이용할 수 있다. 예를 들어, 필터링 신경망은 현재 영상의 복호화를 위해 제1 참조 영상만을 이용할 수 있으며, 이 경우, 제1 상태 정보만을 이용할 수 있다. 한편, 제1 참조 영상에 대응하는 제1 상태 정보는 제1 참조 영상에 상응하는 특징맵으로부터 획득될 수 있다. 또한, 제2 참조 영상에 대응하는 제2 상태 정보는 제2 참조 영상에 상응하는 특징맵으로부터 획득될 수 있다. 일 실시예에서, 현재 영상에 대한 제1 참조 영상 또는 현재 영상에 대한 제2 참조 영상은 제1 참조 픽처 리스트 또는 제2 참조 픽처 리스트에 포함되는 영상일 수 있다. 예를 들어, 제1 참조 영상은 제1 참조 픽처 리스트에 포함되고, 제2 참조 영상은 제2 참조 픽처 리스트에 포함된 영상일 수도 있다. 또는, 제1 참조 영상 및 제2 참 조 영상은 제2 참조 픽처 리스트에 포함된 영상일 수도 있다. 또는, 제1 참조 영상 및 제2 참조 영상은 제1 참 조 픽처 리스트에 포함된 영상일 수도 있다. 한편, 개시된 예에 한하지 않는다. 일 실시예에서, 영상 복호화 장치는 제1 참조 픽처 리스트에 포함되는 제1 참조 영상에 대응하는, 제1 참조 상 태 리스트에 포함되는 제1 상태 정보를 이용하여 현재 영상을 필터링하기 위한 필터링 신경망을 결정 할 수 있다. 예를 들어, 영상 복호화 장치는, 제1 상태 정보 및 제2 상태 정보를 레이어 정보 신경망에 입 력할 수 있다. 영상 복호화 장치는 레이어 정보 신경망에 제1 상태 정보 및 제2 상태 정보를 입력한 것에 기초하여, 필터링 신경망 내 적어도 하나의 신경망에 이용될 레이어 정보를 생성할 수 있다. 한편, 설명의 편의상, 현재 영상을 위한 참조 영상으로서 제1 참조 영상 또는 제2 참조 영상만을 이용하는 경우 를 예로 들어 설명하였으나, 개시된 예에 한하지 않고, 현재 영상을 예측하기 위해 이용하는 적어도 하나의 참 조 영상에 포함된 참조 블록들에 대응하는 상태 정보가 레이어 정보 신경망에 입력될 수 있다. 예를 들어, 현재 영상에 포함된 제1 현재 블록 및 제2 현재 블록에 대해서, 제1 현재 블록이 제1 참조 영상에 포함된 제1 참조 블록을 이용하여 예측되고, 제2 현재 블록이 제2 참조 영상에 포함된 제2 참조 블록을 이용하여 예측되며, 제3 현재 블록이 제3 참조 영상에 포함된 제3 참조 블록을 이용하여 예측되는 경우, 현재 영상은 제1 참조 블록에대응하는 상태 정보, 제2 참조 블록에 대응하는 상태 정보, 및 제3 참조 블록에 대응하는 상태 정보가 레이어 정보 신경망에 입력될 수 있다. 일 실시예에서, 영상 복호화 장치는 현재 영상에 대한 제1 참조 영상에 상응하는 특징맵으로부터 획득된 제1 상 태 정보 또는 현재 영상에 대한 제2 참조 영상에 상응하는 특징맵으로부터 획득된 제2 상태 정보에 기초하여, 필터링 신경망 내 적어도 하나의 레이어에 이용되는 레이어 정보를 생성, 또는 획득할 수 있다. 일 실시예에서, 필터링 신경망은, 현재 영상에 상응하는 정보로부터 현재 영상의 특징을 추출하여 현재 영상에 상응하는 특징맵을 생성하는 특징 추출 신경망 및 현재 영상에 상응하는 특징맵으로부터 현재 영상에 대해 인루 프 필터링이 적용된 영상을 획득하기 위해 이용하는 회귀 신경망을 포함할 수 있다. 레이어 정보는 특징 추출 신경망 및 회귀 신경망에 포함된 적어도 하나의 레이어에서 이용하기 위한 커널, 및 어텐션 맵 중 적어도 하나를 포함할 수 있다. 일 실시예에서, 필터링 신경망은, 심층 신경망(Deep Neural Network), 컨볼루션 신경망(Convolution Neural Network), 및 트랜스포머 신경망(Transformer Neural Network) 중 적어도 하나를 포함할 수 있다. 일 실시예에서, 필터링 신경망은 현재 영상에 상응하는 정보를 획득한 것에 기초하여, 현재 영상을 위한 출력 영상을 생성할 수 있다. 예를 들어, 필터링 신경망은, 현재 영상에 상응하는 정보로서, 현 재 영상의 복원 영상, 현재 영상의 디블록킹 필터링된 영상, 현재 영상의 예측 영상, 현재 영상의 제1 참조 영 상, 현재 영상의 제2 참조 영상, 현재 영상을 위한 적어도 하나의 양자화 파라미터, 현재 영상에 대한 분할 정 보 중 적어도 하나를 획득할 수 있다. 한편, 개시된 예에 한하지 않고, 인루프 필터링부의 구조에 따라, 현재 영상의 샘플 적응적 오프셋 필터링된 영상, 및 적응적 루프 필터링된 영상 중 적어도 하나를 현재 영상에 상응 하는 정보로서 획득할 수 있다. 일 실시예에서, 영상 복호화 장치는 필터링 신경망에 현재 영상에 상응하는 정보를 입력할 수 있다. 영상 복호화 장치는 필터링 신경망 내 적어도 하나의 레이어에 현재 영상에 상응하는 정보를 입력할 수 있다. 영상 복호화 장치는 필터링 신경망에 포함된 특징 추출 신경망은 현재 영상에 상응하는 정보를 획득하여, 현재 영상에 상응하는 특징맵을 획득, 생성, 또는 추출할 수 있다. 필터링 신경망에 포함 된 회귀 신경망은 특징 추출 신경망으로부터 특징맵을 입력으로서 획득할 수 있다. 영상 복호화 장치는, 특징맵을 회귀 신경망에 입력한 것에 기초하여, 출력 영상을 생성 또는 획득할 수 있다. 일 실시예에서, 영상 복호화 장치는, 필터링 신경망으로부터 현재 영상에 대응하는 중간 특징맵을 획 득하여 상태 인코딩 신경망에 입력할 수 있다. 예를 들어, 영상 복호화 장치는, 필터링 신경망에 포함된 특징 추출 신경망으로부터 획득한 또는 추출한 중간 특징맵을 상태 인코딩 신경망에 입력할 수 있다. 일 실시예에서, 영상 복호화 장치는, 필터링 신경망으로부터 획득한 특징맵을 상태 인코딩 신경망 에 입력하여, 상태 인코딩 신경망으로부터, 현재 영상에 대한 상태 정보를 생성 또는 획득할 수 있다. 일 실시예에서, 현재 영상에 대한 상태 정보는 현재 영상에 상응하는 특징맵으로부터 획득되는 정보일 수 있으며, 현재 영상에 대한 상태 정보는, 고해상도의 정보라기보다 추상적인 정보를 내포하고 있기 때문에, 디코딩된 픽처 버퍼에 저장된 영상에 대한 정보보다 적은 메모리 용량을 필요로 할 수 있다. 또한, 상태 정보 는 경사 하강법(Gradient Descent Method)를 사용하여 손실 함수(Loss function)를 최적화하여 학습된 히 든 레이어(Hidden Layers)의 출력이므로, 정확하게 무엇을 나타내는 것인지 불명확하고 추상적인 정보일 수 있 다. 일 실시예에서, 현재 영상에 대한 상태 정보는 현재 영상에 대한 추상적인 정보를 나타내는 특성에 따라, 현재 영상의 해상도보다 낮은 해상도를 가질 수 있다. 일 실시예에서, 영상 복호화 장치는 생성 또는 획득한 상태 정보를 상태 정보 버퍼에 저장할 수 있다. 영상 복호화 장치는, 이후 현재 영상을 참조 영상으로서 이용하는 경우, 상태 정보 버퍼에 저장된 현재 영상에 대한 상태 정보를 함께 이용할 수 있다. 한편, 본 개시의 설명의 편의상, 현재 영상에 상응하는 정보를 필터링 신경망에 입력하여 현재 영상에 대한 출 력 영상을 획득하고, 현재 영상에 대응하는 현재 상태 정보를 획득하기 위한 과정을 중점적으로 설명하였으나,개시된 예에 한하지 않고, 제1 참조 영상 또는 제2 참조 영상에 상응하는 정보를 필터링 신경망에 입력하여 동 일한 동작이 수행될 수 있다. 이하, 도 8a 내지 도 8c 에서는, 필터링 신경망에 적용되는 레이어 정보에 대해 구체적으로 설명하고자 한다. 또한, 도 9 내지 도 11b에서, 본 개시에 따른 신경망에 대해 구체적으로 설명하고자 한다. 도 8a 내지 도 8c는 본 개시의 일 실시예에 따른 레이어 정보를 이용하는 필터링 신경망을 설명하기 위한 도면 이다. 일 실시예에서, 영상 복호화 장치는 레이어 정보에 기초하여 필터링 신경망을 구성할 수 있다. 예를 들어, 영상 복호화 장치는, 레이어 정보 신경망을 이용하여 레이어 정보로서 어텐션 맵을 생성 또는 획득할 수 있다. 어텐 션 맵은, 채널 어텐션 맵(Channel Attention Map), 공간 어텐션 맵(Spatial Attention Map), 및 풀 어텐션 맵(Full Attention Map) 중 적어도 하나일 수 있다. 채널 어텐션 맵은, 1차원의 어텐션 맵이 고, 공간 어텐션 맵은 2차원의 어텐션 맵이며, 풀 어텐션 맵은 3차원의 어텐션 맵일 수 있다. 도 8a를 참조하면, 필터링 신경망에 포함된 적어도 하나의 뉴럴 레이어(Neural Layer)에서 레이어 정보로 서 생성된 채널 어텐션 맵을 이용하여, 특징맵이 출력될 수 있다. 이하, 뉴럴 레이어에 대한 출력은, 출력 특징맵이라고 지칭될 수도 있다. 일 실시예에서, 필터링 신경망에 포함된 뉴럴 레이어는, 레이어 정보 신경망을 통해 획득, 또는 생성, 또 는 출력된 채널 어텐션 맵을 이용하여 어텐션 연산을 수행하는 레이어일 수 있다. 뉴럴 레이어는, 컨 볼루션 연산만이 수행된 특징맵에 채널 어텐션 맵이 적용되는 것을 간단히 도식화한 것일 수 있다. 일 실시예에서, 뉴럴 레이어는, 컨볼루션 연산(Convolution operation) 및 어텐션 연산(Attention Operation)을 수행할 수 있다. 예를 들어, 영상 복호화 장치는 뉴럴 레이어를 통해, 컨볼루션 커널을 이용 하여 입력 특징맵에 대해 가중치 및 바이어스(bias)를 적용함으로써 컨볼루션 연산을 수행하고, 상기 컨볼루션 연산을 수행한 결과에 대해 어텐션 맵과의 성분 곱(element-wise multiplication)을 적용하여 어텐션 연산을 수 행할 수 있다. 컨볼루션 연산 및 어텐션 동작을 수행함으로써, 하나의 뉴럴 레이어를 통해 출력 특징맵이 생성 또는 출력될 수 있다. 이를 하기의 수학식 1과 같이 표현할 수 있다. [수학식 1] 출력 특징맵 = Activation(가중치 * 입력 특징맵 + 바이어스) x 어텐션맵 일 실시예에서, Activation은 활성화 함수를 나타내는 것일 수 있으며, 신경망의 설계에 따라, 시그모이드 함수 (Sigmoid function), ReLu 함수(Rectified Linear Unit function), 하이퍼볼릭 탄젠트 함수(Tanh function), 및 소프트맥스 함수(softmax function) 중 하나일 수 있으며, 개시된 예에 한하지 않고, 기술의 발전에 따라 다 른 활성화 함수를 사용할 수 있다. 일 실시예에서, 채널 어텐션 맵은, 입력 특징맵에 대해 컨볼루션 연산을 수행한 결과에 대해 높이 방 향, 너비 방향, 및 채널 방향 중 1개의 차원 방향으로 집중, 또는 주목할 부분을 강조하기 위해 이용되는 맵일 수 있다. 또한, 채널 어텐션 맵이 입력 특징맵에 대해 컨볼루션 연산을 수행한 결과와 소정의 차원의 크기가 상이한 경우, 입력 특징맵에 대해 컨볼루션 연산을 수행한 결과와 동일 또는 유사한 크기로 조정된 후에 적용될 수 있다. 예를 들어, 입력 특징맵에 대해 컨볼루션 연산을 수행한 결과가 C*W*H의 크기로 표현되고, 채널 어텐션 맵이 c'*1*1인 경우, 채널 어텐션 맵이 C*1*1의 크기로 조정되어 W*H개의 모 든 채널에 대해 적용될 수 있다. 도 8b를 참조하면, 필터링 신경망에 포함된 적어도 하나의 뉴럴 레이어(Neural Layer)에서 레이어 정보로 서 생성된 공간 어텐션 맵을 이용하여, 특징맵이 출력될 수 있다. 일 실시예에서, 필터링 신경망에 포함된 뉴럴 레이어는, 레이어 정보 신경망을 통해 획득, 또는 생성, 또 는 출력된 공간 어텐션 맵을 이용하여 어텐션 연산을 수행하는 레이어일 수 있다. 이하, 도 8b의 뉴럴 레 이어는, 어텐션 맵으로서 공간 어텐션 맵을 사용한다는 점에 있어서 도 8a와 차이가 있을 뿐이므로, 동일한 내용은 중복되므로 생략한다. 일 실시예에서, 공간 어텐션 맵은, 입력 특징맵에 대해 컨볼루션 연산을 수행한 결과에 대해 높이 방 향, 너비 방향, 및 채널 방향 중 2개의 차원 방향으로 집중, 또는 주목할 부분을 강조하기 위해 이용되는 맵일 수 있다. 또한, 공간 어텐션 맵이 입력 특징맵에 대해 컨볼루션 연산을 수행한 결과와 소정의 차원의크기가 상이한 경우, 입력 특징맵에 대해 컨볼루션 연산을 수행한 결과와 동일 또는 유사한 크기로 조정된 후에 적용될 수 있다. 예를 들어, 입력 특징맵에 대해 컨볼루션 연산을 수행한 결과가 C*W*H의 크기로 표 현되고, 공간 어텐션 맵이 1*w'*h'인 경우, 공간 어텐션 맵이 1*W*H의 크기로 조정되어 C개의 W*H크 기의 모든 공간에 대해 적용될 수 있다. 도 8c를 참조하면, 필터링 신경망에 포함된 적어도 하나의 뉴럴 레이어(Neural Layer)에서 레이어 정보로 서 생성된 풀 어텐션 맵을 이용하여, 특징맵이 출력될 수 있다. 일 실시예에서, 필터링 신경망에 포함된 뉴럴 레이어는, 레이어 정보 신경망을 통해 획득, 또는 생성, 또 는 출력된 풀 어텐션 맵을 이용하여 어텐션 연산을 수행하는 레이어일 수 있다. 이하, 도 8c의 뉴럴 레이 어는, 어텐션 맵으로서 풀 어텐션 맵을 사용한다는 점에 있어서 도 8a와 차이가 있을 뿐이므로, 동일 한 내용은 중복되므로 생략한다. 일 실시예에서, 풀 어텐션 맵은, 입력 특징맵에 대해 컨볼루션 연산을 수행한 결과에 대해 높이 방향, 너비 방향, 및 채널 방향의 3차원 방향으로 집중, 또는 주목할 부분을 강조하기 위해 이용되는 맵일 수 있다. 또한, 풀 어텐션 맵이 입력 특징맵에 대해 컨볼루션 연산을 수행한 결과와 소정의 차원의 크기 가 상이한 경우, 입력 특징맵에 대해 컨볼루션 연산을 수행한 결과와 동일 또는 유사한 크기로 조정된 후 에 적용될 수 있다. 예를 들어, 입력 특징맵에 대해 컨볼루션 연산을 수행한 결과인 중간 특징맵이 C*W*H 의 크기로 표현되고, 풀 어텐션 맵이 c'*w'*h'인 경우, 풀 어텐션 맵이 C*W*H의 크기로 조정되어 입 력 특징맵에 대해 컨볼루션 연산을 수행한 결과의 각 위치의 샘플에 대하여, 대응하는 풀 어텐션 맵 의 샘플을 이용하여 성분곱을 수행하여, 출력 특징맵을 획득 또는 생성할 수 있다. 일 실시예에서, 풀 어텐션 맵은 성분곱이 수행되기 위해 중간 특징맵과 동일 또는 유사한 크기로 생성될 수 있다. 한편, 어텐션 맵은, 도 8a 내지 도 8c에 개시된 예에 한하지 않고, 다른 방식으로 적용될 수 있다. 도 9는 본 개시의 일 실시예에 따른, 필터링 신경망에 포함된 특징 추출 신경망의 구조를 예시하는 도면이다. 도 9을 참조하면, 특징 추출 신경망은 입력으로서, 복원 영상, 디블록킹 필터링된 영상, 예측 영상, 제1 참조 영상, 제2 참조 영상, 적어도 하나의 양자화 파라미터, 분할 정보 중 적어도 하나를 포함하는 현재 영상에 상응 하는 정보를 획득할 수 있다. 또한, 특징 추출 신경망은 현재 영상에 상응하는 정보를 획득한 것에 기초하여, 중간 특징맵을 출력할 수 있다. 일 실시예에서, 특징 추출 신경망은, 심층 신경망, 컨볼루션 신경망, 및 트랜스포머 신경망일 수 있으며, 심층 신경망, 컨볼루션 신경망, 및 트랜스포머 신경망의 조합으로 구성될 수 있다. 한편, 도 9은 특징 추출 신경망이 컨볼루션 신경망인 경우를 예시로 설명하였지만, 이에 제한 되지 않고, 여러 뉴럴 네트워크 모델이 이용될 수 있다. 일 실시예에서, 특징 추출 신경망은, 적어도 하나의 뉴럴 레이어를 포함할 수 있다. 한편, 설명의 편의상, 특징 추출 신경망에 포함된 적어도 하나의 뉴럴 레이어는 컨볼루션 레이어만을 포함하는 것처럼 도시되어 있으나, 개시된 예에 한하지 않고, 적어도 하나의 뉴럴 레이어는 컨볼루션 레이어(Convolution layer), 활 성화 레이어(Activation layer), 어텐션 레이어(Attention layer), 풀링 레이어(Pooling layer), 드롭 아웃 레 이어(Dropout layer), 배치 정규화 레이어(Batch Normalization Layer), 순환 레이어(requrrent layer), 및 임 베딩 레이어(Embedding layer) 중 적어도 하나를 포함하도록 구성될 수 있다. 한편, 적어도 하나의 뉴럴 레이어 는 적어도 하나의 레이어로 지칭될 수 있다. 일 실시예에서, 특징 추출 신경망은, 컨볼루션 레이어, 활성화 레이어, 어텐션 레이어의 결합이 반복되는 구조 를 포함하는 신경망일 수 있다. 일 실시예에서, 특징 추출 신경망에 포함된 적어도 하나의 레이어는, 현재 영상에 상응하는 특징맵을 생성하기 위한 적어도 하나의 뉴럴 레이어를 포함할 수 있다. 현재 영상에 상응하는 특징맵은, 현재 영상의 해상도와 동 일한 해상도를 가질 수 있다. 또는, 현재 영상에 상응하는 특징맵은 현재 영상의 해상도보다 높거나 낮은 해상 도를 가질 수 있다. 일 실시예에서, 특징 추출 신경망에 포함된 적어도 하나의 레이어는, 적어도 하나의 다운 샘플링 레이어(Down Sampling Layer)를 포함할 수 있다. 특징 추출 신경망은, 현재 영상의 해상도보다 낮은 해상도를 갖는 현재 영상에 상응하는 특징맵을 생성하기 위한 적어도 하나의 다운 샘플링 레이어를 포함할 수 있다. 일 실시예에서, 영상 복호화 장치는 특징 추출 신경망에 현재 영상에 상응하는 정보를 입력한 것에 기초하여, 현재 영상에 상응하는 특징맵을 획득할 수 있다. 일 실시예에서, 영상 복호화 장치는 특징 추출 신경망에 현재 영상에 상응하는 정보를 입력한 것에 대응하여 현재 영상에 상응하는 특징맵을 획득할 수 있다. 또한, 현재 영 상에 대한 상태 정보는 현재 영상에 상응하는 특징맵으로부터 획득되며, 현재 영상의 해상도보다 낮은 해상도를 가질 수 있다. 이는, 특징 추출 신경망에 포함된 다운 샘플링 레이어에 기초한 것일 수 있다. 한편, 특징 추출 신경망의 출력으로서 생성된 중간 특징맵의 크기는 c*w*h로 나타낼 수 있으며, 이때 w 및 h는 영상의 크기로서의 W및 H와는 각각 상이할 수 있다. 도 10는 본 개시의 일 실시예에 따른, 필터링 신경망에 포함된 회귀 신경망의 구조를 예시하는 도면이다. 도 10을 참조하면, 회귀 신경망은 특징 추출 신경망으로부터 획득한 특징맵을 입력으로서 획득할 수 있다. 또한, 회귀 신경망은, 특징맵을 획득한 것에 기초하여, 인루프 필터링된 영상을 획득하기 위해 이 용하는 출력 영상 생성할 수 있다. 일 실시예에서, 회귀 신경망은, 심층 신경망, 컨볼루션 신경망, 및 트랜스포머 신경망일 수 있으며, 심층 신경 망, 컨볼루션 신경망, 순환 신경망 및 트랜스포머 신경망의 조합으로 구성될 수 있다. 한편, 도 10은 회귀 신경 망이 컨볼루션 신경망인 경우를 예시로 설명하였지만, 이에 제한 되지 않고, 여러 뉴럴 네트워크 모델이 이용될 수 있다. 일 실시예에서, 회귀 신경망은, 적어도 하나의 뉴럴 레이어를 포함할 수 있다. 한편, 설명의 편의상, 회 귀 신경망에 포함된 적어도 하나의 뉴럴 레이어는 컨볼루션 레이어만을 포함하는 것처럼 도시되어 있으나, 개시된 예에 한하지 않고, 적어도 하나의 뉴럴 레이어는 컨볼루션 레이어(Convolution layer), 활성화 레이어(Activation layer), 어텐션 레이어(Attention layer), 풀링 레이어(Pooling layer), 드롭 아웃 레이어(Dropout layer), 배치 정규화 레이어(Batch Normalization Layer), 순환 레이어(requrrent layer), 및 임베딩 레이어(Embedding layer) 중 적어도 하나를 포함하도록 구성될 수 있다. 한편, 적어도 하나의 뉴럴 레이 어는 적어도 하나의 레이어로 지칭될 수 있다. 일 실시예에서 회귀 신경망은, 컨볼루션 레이어, 활성화 레이어, 어텐션 레이어의 결합이 반복되는 구조를 포함 하는 신경망일 수 있다. 일 실시예에서, 회귀 신경망에 포함된 적어도 하나의 레이어는, 현재 영상에 상응하는 특징맵을 입력받아, 출력 영상을 생성할 수 있다. 현재 영상에 상응하는 특징맵의 해상도와 출력 영상의 해상도는 동일할 수 있다. 현재 영상에 상응하는 특징맵의 해상도가 출력 영상의 해상도보다 낮을 수도 있고, 높을 수도 있다. 일 실시예에서, 회귀 신경망에 포함된 적어도 하나의 레이어는, 적어도 하나의 업 샘플링 레이어(Up Sampling Layer)를 포함할 수 있다. 회귀 신경망은, 현재 영상에 상응하는 특징맵의 해상도보다 높은 해상도를 갖는 출력 영상을 생성하기 위한 적어도 하나의 업샘플링 레이어를 포함할 수 있다. 예를 들어, 회귀 신경망은, 특징 추출 신경망이 현재 영상의 해상도보다 낮은 해상도를 갖는 현재 영상에 상응하는 특징맵을 생성하기 위해 적어도 하 나의 다운 샘플링 레이어를 포함하는 경우, 상기 현재 영상에 상응하는 특징맵의 해상도보다 높은 해상도를 갖 는 출력 영상을 생성하기 위한 적어도 하나의 업 샘플링 레이어를 포함할 수 있다. 일 실시예에서, 회귀 신경망은 현재 영상에 상응하는 특징맵을 획득한 것에 기초하여, 현재 영상에 대해 인루프 필터링이 적용된 영상을 획득하기 위해 이용하는 출력 영상을 생성할 수 있다. 영상 복호화 장치는, 회귀 신경 망으로부터 획득한 출력 영상과 현재 영상의 디블록킹 필터링된 영상에 대해 덧셈 연산을 수행한 것에 기초하여, 현재 영상에 대해 인루프 필터링된 영상을 획득할 수 있다. 일 실시예에서, 영상 복호화 장치는, 현재 영상에 상응하는 특징맵을 입력으로 획득한 회귀 신경망으로부터, 출 력 영상을 획득할 수 있다. 또한, 출력 영상은, 현재 영상에 상응하는 특징맵의 해상도보다 높은 해상도를 가질 수 있다. 한편, 회귀 신경망의 출력으로서 생성된 출력 영상의 크기는 C*W*H로 나타낼 수 있으며, 이때 W및 H는 영 상의 크기를 나타내고, c는 색상 채널을 나타내는 정보일 수 있다. 예를 들어, 색상 채널은, RGB 채널 각각(R채 널, G채널, B채널), 또는 YUV 채널 각각(Y채널, U채널, V채널)을 나타내는 정보일 수 있다. 일 실시예에서, 상태 인코딩 신경망은, 도 10의 회귀 신경망과 유사할 수 있다. 예를 들어, 상태 인코딩 신경망 은, 도 10의 회귀 신경망과 동일한 입력을 획득할 수 있다. 다만, 상태 인코딩 신경망의 출력은 영상에 대한 상 태 정보일 수 있다. 그러나, 개시된 예에 한하지 않는다. 일 실시예에서, 상태 인코딩 신경망은, 심층 신경망(Deep Neural Network), 컨볼루션 신경망(Convolution Neural Network), 및 트랜스포머 신경망(Transformer Neural Network) 중 적어도 하나를 포함할 수 있다. 상태 정보의 추상적인 특징을 고려하여 데이터의 크기를 줄이기 위해, 상태 인코딩 신경망은, 스트라이드 컨볼루션 레이어(Convolution Layer) 및 풀링 레이어(Pooling Layer) 와 같은 다운 샘플링 레이어(down-sampling Laye r)를 포함할 수 있다. 도 11a 내지 도 11c는 본 개시의 일 실시예에 따른, 레이어 정보 신경망의 구조를 예시하는 도면이다. 도 11a 및 도 11c을 참조하면, 레이어 정보 신경망은 상태 정보 버퍼에 저장된 영상들에 대응하는 상태 정보를 입력으로 획득할 수 있다. 예를 들어, 레이어 정보 신경망(1120,1122,1124)은 현재 영상에 대한 레이어 정보 를 생성 또는 출력하기 위해서, 현재 영상을 위한 참조 영상에 대응하는 상태 정보를 획득할 수 있다. 이 하, 상기 참조 영상은, 본 개시의 제1 참조 영상 및/또는 제2 참조 영상일 수 있다. 일 실시예에서, 영상 복호화 장치는, 현재 영상에 포함된 블록들에 대한 예측 블록을 생성하기 위해 이용하는 참조 블록들에 대응하는 상태 정보들을 레이어 정보 신경망(1120,1122,1124)에 입력함으로써, 레이어 정보를 생 성 또는 출력할 수 있다. 따라서, 영상 복호화 장치는, 현재 영상에 대한 예측을 수행하기 위해 이용하는 적어 도 하나의 참조 영상에 각각 대응하는 적어도 하나의 상태 정보의 전부 또는 일부를 이용하여 레이어 정보를 생 성 또는 출력할 수 있다. 한편, 레이어 정보는 프레임 단위, 슬라이스 단위, 타일 단위, 최대 부호화 단위, 부 호화 단위, 예측 단위로 생성될 수 있으나, 개시된 예에 한하지 않는다. 다만, 예측 단위의 현재 블록을 예측하기 위해 현재 블록에 대응하는 상태 정보를 이용하는 것을 예로 들어 설 명하였으나, 개시된 예에 한하지 않고, 레이어 정보는 프레임 단위로 생성, 결정 또는 출력될 수 있다. 예를 들 어, 프레임 단위로 레이어 정보가 생성되는 경우에는, 프레임 내에 포함된 블록들에 대한 각각의 참조 블록들에 대응하는 상태 정보를 이용하여 레이어 정보가 생성될 수 있다. 일 실시예에서, 영상 복호화 장치는, 현재 영상에 포함된 현재 블록에 대한 예측 블록을 생성하기 위해 전방향 참조 또는 후방향 참조와 같은 단\"눰* 참조를 통해 인터 예측이 수행되는 경우, 제1 참조 픽처 리스트 내의 참 조 영상에 포함된 참조 블록에 대응하는 제1 참조 상태 리스트에 포함된 상태 정보, 또는 제2 참조 픽처 리스트 내의 참조 영상에 포함된 참조 블록에 대응하는 제2 참조 상태 리스트에 포함된 상태 정보를 레이 어 정보 신경망(1120,1122,1124)의 입력으로서 획득할 수 있다. 일 실시예에서, 영상 복호화 장치는, 현재 영상에 포함된 현재 블록에 대한 예측 블록을 생성하기 위해 양방향 참조, 2 전방향 참조, 2 후방향 참조 등과 같이 쌍 예측이 수행되는 경우, 제1 참조 픽처 리스트, 및 제2 참조 픽처 리스트 내의 참조 영상들 중 2개의 참조 영상들에 각각 포함된 2개의 참조 블록들에 각각 대응하는 상태 정보들을 레이어 정보 신경망(1120,1122,1124)에 입력한 것에 기초하여, 레이어 정보를 생성 또는 출력할 수 있 다. 일 실시예에서, 현재 영상을 예측하기 위해 이용하는 제1 참조 픽처 리스트에 포함된 적어도 하나의 영상은 제1 참조 영상을 포함할 수 있으며, 제1 참조 영상에 대응하는 상태 정보는 제1 상태 정보라고 지칭될 수 있다. 또 한, 현재 영상을 예측하기 위해 이용하는 제2 참조 픽처 리스트에 포함된 적어도 하나의 영상은 제2 참조 영상 을 포함할 수 있으며, 제2 참조 영상에 대응하는 상태 정보는 제2 상태 정보라고 지칭될 수 있다. 또한, 제1 참 조 상태 리스트는, 제1 참조 픽처 리스트에 포함된 영상들에 각각 대응하는 상태 정보를 포함하는 리스트일 수 있다. 제2 참조 상태 리스트는, 제2 참조 픽처 리스트에 포함된 영상들에 각각 대응하는 상태 정보를 포함하는 리스트일 수 있다. 일 실시예에서, 레이어 정보 신경망(1120,1122,1124)은, 상태 정보 버퍼에 저장된 영상들에 대응하는 상태 정보 를 입력으로 획득한 것에 기초하여, 필터링 신경망 내 적어도 하나의 레이어에 적용하기 위한 레이어 정보 를 출력할 수 있다. 일 실시예에서, 도 11a를 참조하면, 레이어 정보 신경망은, c*1*1 크기의 어텐션 맵 또는 커널을 출력할 수 있 다. 예를 들어, 레이어 정보 신경망은, 적어도 하나의 다운 샘플링 레이어를 포함할 수 있다. 적어도 하 나의 다운 샘플링 레이어는 적어도 하나의 스트라이드 컨볼루션 레이어를 포함할 수 있으며, 레이어 정보 신경 망은 채널 어텐션 맵 또는 커널을 출력할 수 있다. 일 실시예에서, 도 11b를 참조하면, 레이어 정보 신경망은, c*1*1 크기의 어텐션 맵 또는 커널을 출력할 수 있다. 예를 들어, 레이어 정보 신경망은 적어도 하나의 다운 샘플링 레이어를 포함할 수 있다. 적어도 하나 의 다운 샘플링 레이어는 적어도 하나의 풀링 레이어를 포함할 수 있다. 도 11b에 따른 레이어 정보 신경망은, 채널 어텐션 맵 또는 커널을 출력할 수 있다. 일 실시예에서, 도 11c를 참조하면, 레이어 정보 신경망은, c*w*h 크기의 어텐션 맵을 출력할 수 있다. 예를 들어, 레이어 정보 신경망은 적어도 하나의 업샘플링 레이어를 포함할 수 있다. 적어도 하나의 업 샘플링 레이어는 보간 레이어, 디컨볼루션 레이어 및 픽셀 셔플 레이어 중 적어도 하나를 포함할 수 있다. 레이어 정보 신경망은, 공간 어텐션 맵 또는 풀 어텐션 맵을 출력할 수 있다. 일 실시예에서, 레이어 정보는 컨볼루션 커널 및 어텐션 맵을 중 적어도 하나를 포함할 수 있다. 예를 들 어, 레이어 정보 신경망은, 컨볼루션 커널만을 출력할 수 있고, 어텐션 맵만을 출력할 수 있으며, 컨볼루션 커 널 및 어텐션 맵 모두를 출력할 수 있다. 또한, 레이어 정보는 필터링 신경망에 포함된 특징 추출 신경망 및 회귀 신경망에 각각 적용되는 레이어 정보를 포함할 수 있으며, 특징 추출 신경망 및 회귀 신경망에 각각 적용되는 레이어 정보는 서로 상이할 수 있다. 일 실시예에서, 레이어 정보 신경망은, 심층 신경망, 컨볼루션 신경망, 및 트랜스포머 신경망일 수 있으며, 심 층 신경망, 컨볼루션 신경망, 순환 신경망 및 트랜스포머 신경망의 조합으로 구성될 수 있다. 한편, 도 11a은 레이어 정보 신경망이 컨볼루션 신경망인 경우를 예시로 설명하였지만, 이에 제한 되지 않고, 여러 뉴럴 네트워 크 모델이 이용될 수 있다. 일 실시예에서, 레이어 정보 신경망은, 적어도 하나의 뉴럴 레이어(1120,1122,1124)를 포함할 수 있다. 한편, 설명의 편의상, 레이어 정보 신경망에 포함된 적어도 하나의 뉴럴 레이어는 스트라이드 컨볼루션 레이어 (Stride Convolution layer)만을 포함하는 것처럼 도시되어 있으나, 개시된 예에 한하지 않고, 적어도 하나의 뉴럴 레이어는 컨볼루션 레이어(Convolution layer), 활성화 레이어(Activation layer), 어텐션 레이어 (Attention layer), 풀링 레이어(Pooling layer), 드롭 아웃 레이어(Dropout layer), 배치 정규화 레이어 (Batch Normalization Layer), 순환 레이어(requrrent layer), 및 임베딩 레이어(Embedding layer) 중 적어도 하나를 포함하도록 구성될 수 있다. 예를 들어, 도 11a 내지 도 11c를 참조하면, 레이어 정보 신경망은, 컨볼루션 레이어, 및 활성화 레이어의 결합 이 반복되는 구조를 포함하는 신경망이거나, 컨볼루션 레이어 및 다운 샘플링 레이어의 결합이 반복되는 구조를 포함하는 신경망일 수도 있고, 컨볼루션 레이어 및 업 샘플링 레이어의 결합이 반복되는 구조를 포함하는 신경 망일 수 있다. 일 실시예에서, 레이어 정보 신경망은, 스트라이드 컨볼루션 레이어(Stride Convolution Layer), 풀링 레이어 (Pooling Layer), 보간 레이어(Interpolation Layer), 디컨볼루션 레이어(Deconvolution Layer), 및 픽셀 셔플 레이어(PixelShuffle Layer) 중 적어도 하나를 포함할 수 있다. 예를 들어, 레이어 정보 신경망은, 입력된 상태 정보에 대해 스캔을 수행하기 위해 비교적 작은 크기를 갖는 커 널의 특성을 고려하여, 스트라이드 컨볼루션 레이어 및 풀링 레이어와 같은 다운 샘플링 레이어를 이용하여 구 성될 수 있다. 또한, 레이어 정보 신경망은 다운 샘플링 레이어를 통해 커널을 생성할 수 있다. 예를 들어, 도 11a 내지 도 11c를 참조하면, 레이어 정보 신경망은 c*1*1의 크기를 갖는 채널 어텐션 맵을 생성 하기 위해 다운 샘플링을 수행하는 레이어를 포함할 수도 있으며, c*w*h의 크기를 갖는 풀 어텐션 맵을 생 성하기 위해 업 샘플링을 수행하는 레이어를 포함할 수도 있다. 또한, 레이어 정보 신경망(1120,1122,1124)은 다운 샘플링 레이어 또는 업 샘플링 레이어를 포함함으로써, 출력되는 레이어 정보의 크기를 적절하게 조 절할 수도 있다. 한편, 다운 샘플링을 수행하는 레이어는 스트라이드 컨볼루션 레이어(Stride Convolution Layer), 및 풀링 레이어(Pooling Layer) 중 적어도 하나를 포함할 수 있으며, 업 샘플링을 수행하는 레이어는 보간 레이어(Interpolation Layer), 디컨볼루션 레이어(Deconvolution Layer), 및 픽셀 셔플 레이어 (PixelShuffle Layer) 중 적어도 하나를 포함할 수 있다. 한편, 스트라이드 컨볼루션 레이어는 컨볼루션 레이어의 일종으로, 컨볼루션 연산을 수행할 때, 커널이 입력 특 징맵을 이동하여 간격을 나타내는 스트라이드(Stride)의 크기가 1보다 큰 레이어를 나타낼 수 있다. 따라서, 스 트라이드의 크기에 따라, 출력 특징맵의 크기가 조절될 수 있으며, 입력 데이터의 차원을 줄이기 위해 사용될 수 있다. 또한, 스트라이드 컨볼루션 레이어를 이용함으로써, 계산량이 줄어들기 때문에 레이어 정보 신경망의 학습 및 추론 속도가 향상될 수 있다. 한편, 풀링 레이어는, 풀링 윈도우 내 가장 큰 값을 선택하여 출력함으로써, 입력에서 가장 두드러진 특성을 강 조하거나, 풀링 윈도우 내의 모든 값의 평균을 계산하여 출력하는 등의 방식으로 입력의 차원을 줄이는 동시에 중요한 정보를 보존하기 위해 이용하는 레이어일 수 있다. 또한, 풀링 레이어는, 학습 가능한 가중치를 포함하 지 않아 네트워크의 계산 복잡성을 줄이고 오버피팅을 방지할 수 있는 레이어일 수 있다. 한편, 보간 레이어는, 입력에 비해 차원이 증가된 출력을 생성하기 위해 사용되는 레이어로서, 입력으로 획득한 데이터의 크기를 스케일링하여 증가시키는 레이어일 수 있다. 한편, 디컨볼루션 레이어는, 컨볼루션 연산의 역과정을 수행하여 이미지의 차원을 확대하는 레이어로서, 학습 가능한 파라미터를 가지는 레이어일 수 있다. 한편, 픽셀 셔플 레이어는, 입력 내의 픽셀을 재배치하여 해상도를 높이는 레이어로서, 입력의 채널 수를 증가 시키고, 채널들을 픽셀 수준에서 재배치하여 이미지의 크기를 확대하는 레이어일 수 있다. 한편, 개시된 예에 한하지 않고, 레이어 정보 신경망의 출력으로서 x*y*z크기(x,y,z는 자연수)의 커널이 생성될 수도 있고, c*w*h 크기(c,w,h는 자연수)의 어텐션 맵이 생성될 수도 있다. 도 12는 본 개시의 일 실시예에 따른, 필터링 신경망을 훈련하는 동작을 나타내는 도면이다. 일 실시예에서, 필터링 신경망은, 참조 관계에 있는 적어도 두 개의 영상에 대한 정보를 획득한 것에 기 초하여, 인루프 필터링부를 통해 획득되는 인루프 필터링된 영상이 원본 영상에 가까워지도록 훈련될 수 있다. 일 실시예에서, 필터링 신경망은, 참조 관계가 있는 적어도 두 개의 영상에 상응하는 정보을 입력 으로서 획득하여, 훈련용 출력 영상을 출력할 수 있다. 필터링 신경망은 훈련용 출력 영상 및 정답 출력 영상을 손실 함수(loss function)를 통해 비교하여, 훈련용 출력 영상이 정답 출력 영상에 가까워 지도록 훈련될 수 있다. 한편, 정답 출력 영상은 필터링 신경망이 포함 된 인루프 필터링부의 구조에 따라 인루프 필터링된 영상이 원본 영상에 가까워지도록 하는 출력 영상이 정답 출력 영상으로 기 결정되어 있을 수 있다. 일 실시예에서, 필터링 신경망, 상태 인코딩 신경망, 및 레이어 정보 신경망은, 제1 참조 영상에 상응하는 정보 또는 제2 참조 영상에 상응하는 정보를 필터링 신경망에 입력하고, 현재 영상에 상응하는 정보를 필터링 신경망 에 입력한 것에 기초하여 함께 훈련될 수 있다. 예를 들어, 필터링 신경망은, 제1 참조 영상에 상응하는 정보 및 현재 영상에 상응하는 정보를 입 력받을 수 있다. 필터링 신경망은, 제1 참조 영상에 상응하는 정보를 이용하여, 제1 참조 영상에 상응하 는 특징맵을 생성할 수 있다. 또한, 인코딩 신경망은, 제1 참조 영상에 상응하는 특징맵을 입력받아, 제1 참조 영상에 대한 제1 상태 정보를 생성할 수 있다. 필터링 신경망은, 제2 참조 영상에 상응하는 정보를 이용 하여, 제2 참조 영상에 상응하는 특징맵을 생성할 수 있다. 또한, 인코딩 신경망은, 제2 참조 영상에 상응하는 특징맵을 입력받아, 제2 참조 영상에 대한 제2 상태 정보를 생성할 수 있다. 또한, 레이어 정보 신경망은, 제1 참조 영상에 대응하는 제1 상태 정보 또는 제2 참조 영상에 대응하는 제2 상태 정보를 이용하여 필터링 신경망 에 적용하기 위한 레이어 정보를 생성할 수 있다. 생성된 레이어 정보가 적용된 적어도 하나의 레이어를 포함하는 필터링 신경망에 현재 영상에 상응하는 정보를 입력하여 출력 영상을 훈련용 출력 영상으 로서 생성할 수 있다. 필터링 신경망은 훈련용 출력 영상과 정답 출력 영상을 비교하여, 훈 련용 출력 영상이 정답 출력 영상에 가까워지도록 훈련될 수 있다. 한편, 설명의 편의상, 필터링 신경망이 훈련되는 것으로 표현 및 도시하였으나, 본 개시의 필터링 신경망 에 포함된 특징 추출 신경망, 회귀 신경망, 상태 인코딩 신경망, 및 레이어 정보 신경망이 전체로서 훈련될 수 있다. 또는, 특징 추출 신경망, 회귀 신경망, 상태 인코딩 신경망, 및 레이어 정보 신경망 각각에 대해 정답 값 을 기 설정하여 신경망을 개별적으로 훈련시킬 수 있다. 도 13는 본 개시의 일 실시예에 따른 영상 복호화 장치의 구성을 도시하는 블록도이다. 도 13을 참조하면, 영상 복호화 장치는 획득부 및 예측 복호화부를 포함할 수 있다. 도 13에 도시된 획득부는 도 1에 도시된 비트스트림 획득부에 대응하고, 예측 복호화부는 도 1에 도시 된 인루프 필터링부 및 예측 복호화부에 대응할 수 있다. 일 실시예에서, 획득부 및 예측 복호화부는 적어도 하나의 프로세서로 구현될 수 있다. 일 실시예 에서, 획득부 및 예측 복호화부는 메모리에 저장된 인스트럭션에 따라 동작할 수 있다. 일 실시예에서, 영상 복호화 장치는 획득부 및 예측 복호화부의 입출력 데이터를 저장하는 메모리를 포함할 수 있다. 또한, 영상 복호화 장치는, 메모리의 데이터 입출력을 제어하는 메모리 제어부 를 포함할 수 있다. 일 실시예에서, 적어도 하나의 프로세서는 이하에서 설명되는 실시예들에 따라 영상 복호화 장치가 동작 하도록 일련의 과정을 제어하는 구성으로서, 하나 또는 복수의 프로세서로 구성될 수 있다. 프로세서에 포함되 는 하나 또는 복수의 프로세서는 SoC (System on Chip), IC (Integrated Circuit) 등과 같은 회로 장치 (circuitry)일 수 있다. 프로세서에 포함되는 하나 또는 복수의 프로세서는 CPU (Central Processing Unit), MPU (Micro Processor Unit), AP (Application Processor), DSP (Digital Signal Processor) 등과 같은 범용 프로세서, GPU (Graphic Processing Unit), VPU (Vision Processing Unit)와 같은 그래픽 전용 프로세서, NPU (Neural Processing Unit)와 같은 인공지능 전용 프로세서 또는 CP (Communication Processor)와 같은 통신 전 용 프로세서일 수 있다. 프로세서에 포함되는 하나 또는 복수의 프로세서가 인공지능 전용 프로세서인 경 우, 해당 인공지능 전용 프로세서는 특정 인공지능 모델의 처리에 특화된 하드웨어 구조로 설계될 수 있다. 일 실시예에서, 프로세서는 메모리에 데이터를 기록하거나, 메모리에 저장된 데이터를 읽을 수 있으며, 특히 메 모리에 저장된 프로그램 또는 적어도 하나의 인스트럭션을 실행함으로써 미리 정의된 동작 규칙 또는 인공지능 모델에 따라 데이터를 처리할 수 있다. 따라서, 프로세서는 본 개시의 실시예들에서 설명되는 동작들을 수행할 수 있으며, 본 개시의 실시예들에서 영상 복호화 장치 또는 영상 복호화 장치에 포함되는 세부 구 성들(도 13의 1310, 및 1330)이 수행한다고 설명되는 동작들은 특별한 설명이 없는 한 프로세서가 수행하는 것으로 볼 수 있다. 일 실시예에서, 메모리는 다양한 프로그램이나 데이터를 저장하기 위한 구성으로서, 롬(ROM), 램(RAM), 하드디 스크, CD-ROM 및 DVD 등과 같은 저장 매체 또는 저장 매체들의 조합으로 구성될 수 있다. 메모리는 별도로 존재 하지 않고 프로세서에 포함되도록 구성될 수도 있다. 메모리는 휘발성 메모리, 비휘발성 메모리 또는 휘발성 메 모리와 비휘발성 메모리의 조합으로 구성될 수도 있다. 메모리에는 이후에서 설명되는 실시예들에 따른 동작들 을 수행하기 위한 프로그램 또는 적어도 하나의 인스트럭션이 저장될 수 있다. 메모리는 프로세서의 요청에 따 라 저장된 데이터를 프로세서에 제공할 수도 있다. 일 실시예에서, 획득부는 영상의 부호화 결과로 생성된 비트스트림을 획득할 수 있다. 일 실시예에서, 비트스트림은 현재 블록에 대한 부호화 결과를 포함할 수 있다. 비트스트림은 현재 블록을 복원 하기 위해 이용되는 정보들을 포함할 수 있다. 현재 블록은 복호화하고자 하는 현재 영상으로부터 분할된 최대 부호화 단위, 부호화 단위, 변환 단위, 예측 단위, 또는 필터링 단위일 수 있다. 또한, 현재 블록은 현재 수행 하는 부호화 또는 복호화 동작에서 처리하는 소정 위치의 블록일 수 있다. 블록을 현재 샘플은 현재 블록에 포 함된 임의의 샘플일 수 있다. 일 실시예에서, 예측 복호화부는 현재 영상을 복원하기 위해 예측 영상을 생성할 수 있으며, 예측 영상을 생성하기 위해 시퀀스 파라미터 세트(sequence parameter set), 픽처 파라미터 세트(picture parameter set), 비디오 파라미터 세트(video parameter set), 슬라이스 헤더(slice header) 및 슬라이스 세그먼트 헤더(slice segment header) 중 적어도 하나의 레벨에 대응하는 비트스트림에 포함된 예측 정보에 기반하여 현재 블록에 대 한 예측 영상을 생성 또는 결정할 수 있다. 예측 정보는, 현재 영상을 예측하기 위해 이용하는 정보일 수 있다. 일 실시예에서, 획득부는 비트스트림을 영상 부호화 장치로부터 네트워크를 통해 수신할 수 있다. 일 실시예에서, 획득부는 하드 디스크, 플로피 디스크 및 자기 테이프와 같은 자기 매체, CD-ROM 및 DVD 와 같은 광기록 매체, 플롭티컬 디스크(floptical disk)와 같은 자기-광 매체(magneto-optical medium) 등을 포함하는 데이터 저장 매체로부터 비트스트림을 획득할 수 있다. 일 실시예에서, 획득부는 비트스트림으로부터 영상의 복호화를 위한 신택스 엘리먼트(syntax element)들 을 획득할 수 있다. 신택스 엘리먼트들에 해당하는 값들은 영상의 계층 구조에 따라 비트스트림에 포함될 수 있 다. 획득부는 비트스트림에 대해 엔트로피 디코딩을 수행하여 신택스 엘리먼트들에 대응하는 빈들을 획득 할 수 있다. 일 실시예에서, 비트스트림은 현재 영상을 예측하기 위해 이용하는 예측 정보를 포함할 수 있다. 예를 들어 비 트스트림은, 현재 영상 내 현재 블록의 예측 모드를 나타내는 정보를 포함할 수 있다. 현재 블록의 예측 모드는 인터(inter) 모드를 포함할 수 있다. 인터 모드는 영상들 사이의 시간적 중복성을 감소시키기 위해 참조 영상에기반하여 현재 블록을 예측 또는 복원하는 모드이다. 또한, 예측 정보는 현재 블록의 예측 모드가 인터 모드인 경우, 참조 블록을 결정하기 위한 정보를 포함할 수 있다. 예를 들어, 참조 블록을 결정하기 위한 정보는 참조 픽처 리스트 내의 참조 영상을 가리키는 인덱스 및 움직임 정보를 포함할 수 있으나, 개시된 예에 한하지 않는 다. 일 실시예에서, 예측 복호화부는 현재 블록의 예측 모드에 따라 현재 블록에 대해 인터 예측을 수행하여 현재 블록의 예측 블록을 생성하고, 예측 블록을 이용하여 현재 블록을 복원할 수 있다. 일 실시예에서, 예측 복호화부는 참조 영상에 기반하여 현재 블록을 복원할 때, 하나의 참조 영상을 이용 (예를 들어, 단방향 예측)할 수도 있고, 두 개의 참조 영상을 이용(예를 들어, 쌍 예측(bi-prediction))할 수도 있다. 현재 블록이 단방향 예측되는지, 쌍 예측되는지 여부는, 비트스트림에 포함된 명시적 정보에 따라 결정될 수도 있고, 현재 블록과 관련된 주변 블록들의 예측 모드로부터 암시적으로 결정될 수도 있다. 일 실시예에서, 예측 복호화부는 현재 블록이 쌍 예측되는 경우, 현재 블록의 참조 블록들을 결정하기 위 해 비트스트림에 포함된 움직임 정보를 이용할 수도 있고, 현재 블록과 관련된 주변 블록들의 참조 블록들로부 터 암시적으로 결정될 수도 있다. 현재 블록의 움직임 정보는 참조 영상 인덱스, 움직임 벡터, 차분 움직임 벡 터 및 참조 방향 중 적어도 하나를 포함할 수 있으며, 현재 블록의 움직임 벡터를 예측하기 위한 모든 정보를 포함할 수 있다. 일 실시예에서, 예측 복호화부는 현재 영상에 대한 복원 영상에 인루프 필터링을 수행하여 현재 영상이 원본 영상과 가까워지도록 할 수 있다. 일 실시예에서, 예측 복호화부는 비트스트림의 시퀀스 파라미터 세트, 영상 파라미터 세트, 슬라이스 헤 더 또는 슬라이스 데이터로부터 필터 정보를 획득할 수 있다. 필터 정보는, 디블록킹 필터링, 샘플 오프셋 적응 적 필터링, 및 적응적 루프 필터링이 각각 수행되는지 여부 및 각각의 필터링을 수행하기 위해 이용하는 필터링 파라미터를 포함할 수 있다. 일 실시예에서, 예측 복호화부는 인루프 필터링부를 포함할 수 있다. 인루프 필터링부는 특징 추출 신경 망 및 회귀 신경망을 포함하는 필터링 신경망을 포함할 수 있다. 또한, 인루프 필터링부는 필터링 신경망 내 적 어도 하나의 레이어에 적용하기 위한 레이어 정보를 생성하기 위해 상태 인코딩 신경망, 및 레이어 정보 신경망 을 이용할 수 있다. 일 실시예에서, 예측 복호화부는 현재 영상의 인루프 필터링된 영상을 획득하기 위해 이용하는 출력 영상 을 생성하기 위해서, 필터링 신경망에 현재 영상에 상응하는 정보를 입력할 수 있다. 예측 복호화부는 필 터링 신경망으로부터 현재 영상의 인루프 필터링이 적용된 영상을 획득하기 위해 이용하는 출력 영상을 획득할 수 있다. 일 실시예에서, 예측 복호화부는 출력 영상을 획득하기 위해서, 현재 영상에 대한 블록들 각각에 대한 참조 블 록에 대응하는 상태 정보를 이용할 수 있다. 예를 들어, 현재 영상을 위한 필터링 신경망에 적용되는 레이어 정 보를 생성하기 위해 레이어 정보 신경망의 입력으로서 획득하는 참조 영상에 대한 상태 정보는, 현재 영상에 포 함된 모든 블록에 대응하는 참조 블록들을 이용하여 결정될 수 있다. 한편, 예측 복호화부가 레이어 정보 신경 망을 이용하여 레이어 정보를 생성하는 동작은 도 7 및 도 11a 내지 도 11c에 자세히 설명되어 있으므로 동일한 내용은 중복되므로 생략한다. 예를 들어, 예측 복호화부는 현재 블록이 쌍 예측되는 경우, 제1 참조 블록 및 제2 참조 블록에 각각 가중치를 적용하여 가중합하여 현재 블록에 대한 예측 블록을 생성할 수 있다. 현재 영상에 포함된 블록들 각각에 대한 참조 블록에 대응하는 상태 정보는, 쌍 예측에 이용되는 두개의 참조 블록에 각각 적용되는 가중치를 두개의 참 조 블록에 각각 대응하는 상태 정보에 적용시켜 가중합하여 획득된 상태 정보를 이용할 수 있다. 한편, 설명의 편의상, 예측 단위의 블록에 대해 참조 블록에 대한 상태 정보를 이용하는 방법에 대해 설명하였 으나, 개시된 예에 한하지 않고, 예측 복호화부는 프레임 단위, 슬라이스 단위, 타일 단위, 최대 부호화 단위, 부호화 단위, 예측 단위로 각 단위를 예측하기 위해 이용하는 참조 블록들에 대응하는 상태 정보를 이용하여 레 이어 정보를 생성할 수 있다. 예를 들어, 예측 복호화부는 프레임 단위의 레이어 정보를 생성하기 위해 현재 영 상에 포함된 블록들에 대한 참조 블록들에 대응하는 상태 정보들을 레이어 정보 신경망에 입력하여 레이어 정보 를 생성할 수 있다. 일 실시예에서, 예측 복호화부는 레이어 정보 신경망으로부터 필터링 신경망에 적용하기 위한 레이어 정보를 획 득할 수 있다. 예측 복호화부는 필터링 신경망에 적용하기 위한 레이어 정보로서, 컨볼루션 커널 및 어텐션 맵 중 적어도 하나를 획득할 수 있다. 예측 복호화부는 획득한 레이어 정보를 필터링 신경망에서 이용할 수 있다. 예를 들어, 예측 복호화부는 필터링 신경망이 레이어 정보에 포함된 컨볼루션 커널 및 어텐션 맵을 이용하는 컨 볼루션 레이어를 포함하도록 구성할 수 있다. 필터링 신경망에 포함된 적어도 하나의 컨볼루션 레이어의 컨볼루 션 커널 및 어텐션 맵은 획득된 레이어 정보에 기초하여 결정될 수 있다. 한편, 예측 복호화 장치가 레이어 정 보를 이용하여 필터링 신경망을 구성하는 동작은 도 7 및 도 8a 내지 도 8c에 자세히 설명되어 있으므로 동일한 내용은 중복되므로 생략한다. 일 실시예에서, 예측 복호화부는 현재 영상의 복원 영상, 현재 영상의 예측 영상, 현재 영상의 제1 참조 영상, 현재 영상의 제2 참조 영상, 현재 영상을 위한 적어도 하나의 양자화 파라미터, 현재 영상에 대한 분할 정보 중 적어도 하나를 포함하는, 현재 영상에 상응하는 정보를 필터링 신경망에 입력할 수 있다. 일 실시예에서, 예측 복호화부는 현재 영상에 상응하는 정보를 필터링 신경망에 입력한 것에 기초하여, 현재 영 상에 상응하는 특징맵을 획득할 수 있다. 예측 복호화부는 현재 영상에 상응하는 정보를 필터링 신경망에 입력 한 것에 기초하여, 인루프 필터링된 영상을 획득하기 위해 이용하는 출력 영상을 획득할 수 있다. 예를 들어, 예측 복호화부는, 필터링 신경망에 포함된 특징 추출 신경망에 현재 영상에 상응하는 정보를 입력하여 현재 영 상에 상응하는 특징맵을 획득할 수 있다. 예측 복호화부는 현재 영상에 상응하는 특징맵을 입력으로서 획득한 필터링 신경망에 포함된 회귀 신경망으로부터 인루프 필터링된 영상을 획득하기 위해 이용하는 출력 영상을 획 득할 수 있다. 한편, 필터링 신경망의 예시적인 구조는 도 7 및, 도 9 내지 도 10에 자세히 설명되어 있으므로 동일한 내용은 중복되므로 생략한다. 일 실시예에서, 예측 복호화부는, 필터링 신경망으로부터 획득한 현재 영상에 대한 현재 영상에 상응하는 특징 맵을 이용하여 현재 영상에 대한 상태 정보를 획득할 수 있다. 예를 들어, 예측 복호화부는, 필터링 신경망에 포함된 특징 추출 신경망으로부터 현재 영상에 상응하는 특징맵을 획득할 수 있다. 또한, 예측 복호화부는, 현 재 영상에 상응하는 특징맵을 상태 인코딩 신경망에 입력하여, 현재 영상의 복원 영상 또는 예측 영상의 해상도 보다 낮은 해상도를 갖는 현재 영상에 대한 상태 정보를 획득할 수 있다. 현재 영상에 대한 상태 정보는 현재 영상에 상응하는 특징맵을 상태 인코딩 신경망에 입력함으로써 획득되며, 상태 정보 버퍼에 저장될 수 있다. 한편, 상태 인코딩 신경망에 대한 구체적인 설명은 도 7에도 개시되어 있으므로, 동일한 내용은 중복되므로 생 략한다. 도 14은 본 개시의 일 실시예에 따른 영상 복호화 방법의 순서도이다. 단계 S1410에서, 영상 복호화 장치는 현재 영상에 대한 제1 참조 영상에 상응하는 특징맵으로부터 획득된 제1 상태 정보 또는 현재 영상에 대한 제2 참조 영상에 상응하는 특징맵으로부터 획득된 제2 상태 정보에 기초 하여, 필터링 신경망 내 적어도 하나의 레이어에 이용될 레이어 정보를 생성할 수 있다. 일 실시예에서, 영상 복호화 장치는, 비트스트림으로부터 획득한 예측 정보를 획득할 수 있다. 예측 정보 는, 현재 영상을 복호화 하기 위해 제1 참조 영상 및/또는 제2 참조 영상을 이용한다는 정보를 포함할 수 있다. 구체적으로, 예측 정보는 현재 영상에 포함된 소정의 블록을 복호화 하기 위해, 제1 참조 영상 및/또는 제2 참 조 영상을 이용한다는 정보를 포함할 수 있으며, 제1 움직임 벡터가 가리키는 제1 참조 블록 및/또는 제2 움직 임 벡터가 가리키는 제2 참조 블록을 이용한다는 정보를 포함할 수 있다. 일 실시예에서, 영상 복호화 장치는, 현재 영상에 대한 제1 참조 영상에 상응하는 특징맵에 기초하여 제1 상태 정보를 획득할 수 있다. 영상 복호화 장치는, 현재 영상에 대한 제2 참조 영상에 상응하는 특징맵에 기초하여 제2 상태 정보를 획득할 수 있다. 영상 복호화 장치는, 제1 참조 영상에 상응하는 특징맵을 상 태 인코딩 신경망에 입력하여, 제1 참조 영상에 대응하는 제1 상태 정보를 획득할 수 있다. 영상 복호화 장치 는, 제2 참조 영상에 상응하는 특징맵을 상태 인코딩 신경망에 입력하여, 제2 참조 영상에 대응하는 제2 상태 정보를 획득할 수 있다. 일 실시예에서, 영상 복호화 장치는, 필터링 신경망에 제1 참조 영상에 상응하는 정보를 입력할 수 있다. 영상 복호화 장치는 제1 참조 영상에 상응하는 정보를 필터링 신경망에 입력한 것에 기초하여, 제1 참조 영상에 상응하는 특징맵을 획득할 수 있다. 예를 들어, 영상 복호화 장치는, 필터링 신경망에 포함된 특 징 추출 신경망으로부터 제1 참조 영상에 상응하는 특징맵을 획득할 수 있다. 영상 복호화 장치는, 제1 참조 영상에 상응하는 특징맵을 상태 인코딩 신경망에 입력하여, 제1 참조 영상에 대한 상태 정보를 나타내는 제1 상태 정보를 획득할 수 있다. 제1 상태 정보는 제1 참조 영상의 해상도보다 낮은 해상도를 가질 수 있다. 일 실시예에서, 영상 복호화 장치는, 필터링 신경망에 제2 참조 영상에 상응하는 정보를 입력할 수 있다. 영상 복호화 장치는 제2 참조 영상에 상응하는 정보를 필터링 신경망에 입력한 것에 기초하여, 제2 참조 영상에 상응하는 특징맵을 획득할 수 있다. 예를 들어, 영상 복호화 장치는, 필터링 신경망에 포함된 특 징 추출 신경망으로부터 제2 참조 영상에 상응하는 특징맵을 획득할 수 있다. 영상 복호화 장치는, 제2 참조 영상에 상응하는 특징맵을 상태 인코딩 신경망에 입력하여, 제2 참조 영상에 대한 상태 정보를 나타내는 제2 상태 정보를 획득할 수 있다. 제2 상태 정보는 제2 참조 영상의 해상도보다 낮은 해상도를 가질 수 있다. 한편, 도 1 내지 도 13에서, 영상 복호화 장치가 현재 영상에 대한 상태 정보를 생성하는 동작에 대해 자 세히 설명하였다. 현재 영상에 대한 상태 정보를 생성하는 동작은, 제1 참조 영상에 대한 제1 상태 정보 및/또 는 제2 참조 영상에 대한 제2 상태 정보를 생성하는 동작에 대응할 수 있으므로 동일한 내용은 생략한다. 일 실시예에서, 영상 복호화 장치는, 제1 상태 정보 및/또는 제2 상태 정보를 상태 정보 버퍼에 저장할 수 있다. 영상 복호화 장치는, 현재 영상에 대한 인루프 필터링이 적용된 영상을 획득하기 위해, 제1 상 태 정보 및/또는 제2 상태 정보를 이용할 수 있다. 일 실시예에서, 영상 복호화 장치는, 현재 영상에 포함된 소정의 블록이 제1 참조 영상 및/또는 제2 참조 영상에 포함된 블록들을 참조 블록들로서 이용하는 경우, 참조 블록들을 이용하여 예측 영상을 생성 또는 획득 할 수 있다. 영상 복호화 장치는, 현재 영상에 대한 예측 영상을 생성하기 위해 이용하는 참조 블록들에 대응하는 상태 정보들을 레이어 정보 신경망에 입력할 수 있다. 일 실시예에서, 영상 복호화 장치는, 레이어 정보 신경망에 제1 상태 정보 및 제2 상태 정보를 입력한 것 에 기초하여, 필터링 신경망 내 적어도 하나의 레이어에 적용될 레이어 정보를 생성할 수 있다. 상기 레이어 정 보는, 필터링 신경망 내 적어도 하나의 레이어에 적용하기 위한 커널 및 어텐션 맵 중 적어도 하나를 포함할 수 있다. 한편, 앞서 도 1 내지 도 13에서 레이어 정보에 대하여 자세하게 설명하였으므로, 자세한 내용은 중복되므로 생 략한다. 단계 S1420에서, 영상 복호화 장치는 필터링 신경망 내 적어도 하나의 레이어에 현재 영상에 상응하는 정 보를 입력할 수 있다. 일 실시예에서, 영상 복호화 장치는 생성된 레이어 정보를 필터링 신경망에적용할 수 있다. 예를 들어, 필터링 신경망에 포함된 특징 추출 신경망은, 레이어 정보에 포함된 컨볼루션 커널을 이용하는 뉴럴 레이어를 포함할 수 있다. 또는, 필터링 신경망에 포함된 회귀 신경망은, 레이어 정보에 포함된 어텐션 맵을 포함하는 뉴 럴 레이어를 포함할 수 있다. 한편, 개시된 예에 한하지 않는다. 또한, 특징 추출 신경망에 적용되는 레이어 정 보와 회귀 신경망에 적용되는 레이어 정보는 각각의 신경망의 목적이 상이하므로, 상이할 수 있다. 일 실시예에서, 영상 복호화 장치는, 레이어 정보가 이용된 필터링 신경망 내 적어도 하나의 레이어에 현 재 영상에 상응하는 정보를 입력할 수 있다. 영상 복호화 장치는, 레이어 정보가 이용된 적어도 하나의 레이어를 포함하는 필터링 신경망에 현재 영상에 상응하는 정보를 입력할 수 있다. 현재 영상에 상응하는 정보 는 현재 영상에 대한 복원 영상, 현재 영상에 대한 디블록킹 필터링된 영상, 현재 영상에 대한 샘플 적응적 오 프셋 필터링된 영상, 현재 영상에 대한 적응적 루프 필터링된 영상, 현재 영상에 대한 예측 영상, 현재 영상에 대한 제1 참조 영상, 현재 영상에 대한 제2 참조 영상, 현재 영상에 대한 적어도 하나의 양자화 파라미터, 현재 영상에 대한 분할 정보 중 적어도 하나를 포함할 수 있다. 일 실시예에서, 영상 복호화 장치는, 필터링 신경망에 포함된 특징 추출 신경망에 현재 영상에 상응하는 정보를 입력할 수 있다. 한편 도 1 내지 도 13에서, 영상 복호화 장치가 생성된 레이어 정보를 필터링 신 경망 및 필터링 신경망 내 적어도 하나의 레이어에 대해 구체적으로 설명하였으므로, 동일한 내용은 생략한다. 단계 S1430에서, 영상 복호화 장치는 레이어 정보가 이용된 적어도 하나의 레이어에 현재 영상에 상응하 는 정보를 입력함으로써, 현재 영상에 대해 인루프 필터링이 적용된 영상을 획득할 수 있다. 일 실시예에서, 영상 복호화 장치는 필터링 신경망으로부터 현재 영상에 대한 인루프 필터링이 수행된 인 루프 필터링된 영상을 획득하기 위해 이용하는 출력 영상을 획득할 수 있다. 일 실시예에서, 영상 복호화 장치가 필터링 신경망에 현재 영상에 상응하는 정보를 입력한 것에 대응하여 필터링 신경망에 포함된 특징 추출 신경망은 현재 영상에 상응하는 특징맵을 생성할 수 있다. 또한, 특징 추출 신경망으로부터 획득된 현재 영상에 상응하는 특징맵은 필터링 신경망에 포함된 회귀 신경망에 입력될 수 있다.영상 복호화 장치는 현재 영상에 상응하는 특징맵을 입력받은 회귀 신경망으로부터 출력 영상을 획득할 수 있다. 일 실시예에서, 영상 복호화 장치는 인루프 필터링부 내에 필터링 신경망 및 디블록킹 필터링부가 병렬로 구성되어 있는 경우, 필터링 신경망의 출력인 출력 영상과 디블록킹 필터링된 영상에 대한 덧셈 연산을 수행한 것에 기초하여, 인루프 필터링된 영상을 획득할 수 있다. 예를 들어, 영상 복호화 장치는 출력 영상과 디 블록킹 필터링된 영상에 대해 덧셈 연산을 수행한 결과에 대해 샘플 적응적 루프 필터링 및 적응적 루프 필터링 을 수행함으로써 인루프 필터링이 적용된 영상을 획득할 수 있다. 일 실시예에서, 영상 복호화 장치는 인루프 필터링부 내에 디블록킹 필터링부 이후에 일렬로 필터링 신경 망이 위치하는 경우, 디블록킹 필터링된 영상을 필터링 신경망에 현재 영상에 상응하는 정보 중 하나로서 입력 할 수 있다. 영상 복호화 장치는, 필터링 신경망으로부터 획득한 출력 영상에 대해 샘플 적응적 오프셋 필터링 및 적응적 루프 필터링을 수행함으로써, 인루프 필터링이 적용된 영상을 획득할 수 있다. 한편, 개시된 예에 한하지 않고, 인루프 필터링부의 설계에 따라, 필터링 신경망의 위치가 조정될 수 있고, 필 터링 신경망의 위치에 따라 적절한 출력 영상을 생성하도록 필터링 신경망이 학습될 수 있다. 한편, 도 1 내지 도 13에서, 필터링 신경망으로부터 출력 영상을 생성하는 동작에 대해 자세히 설명하였으므로, 동일한 내용은 중복되므로 생략한다. 도 15는 본 개시의 일 실시예에 따른 영상 부호화 장치의 구성을 도시하는 블록도이다. 도 15를 참조하면, 영상 부호화 장치는 예측 부호화부 및 생성부를 포함할 수 있다. 도 15에 도시된 예측 부호화부는 도 1에 도시된 예측 부호화부에 대응하고, 생성부은 도 1에 도시된 인루프 필터링부 및 예측 부호화부에 대응할 수 있다. 일 실시예에 따른 예측 부호화부 및 생성부는 적어도 하나의 프로세서로 구현될 수 있다. 일 실시 예에서, 예측 부호화부 및 생성부는 적어도 하나의 메모리에 저장된 적어도 하나의 인스트럭션에 따라 동작할 수 있다. 한편, 영상 부호화 장치의 적어도 하나의 프로세서 및 적어도 하나의 메모리는 영상 복호화 장치의 적어도 하나의 프로세서 및 적어도 하나의 메모리에 각각 대응할 수 있으므로 동일한 내용은 생략한다. 이후의 실시예들에서 영상 부호화 장치 또는 영상 복호화 장치에 포함되는 세부 구성들(도 15의 1510, 및 1530)이 수행한다고 설명되는 동작들은 특별한 설명이 없는 한 프로세서가 수행하는 것으로 볼 수 있다. 일 실시예에서, 영상 부호화 장치는, 영상 복호화 장치 또는 영상 복호화 장치에 포함된 부/ 유닛에서 수행되는 동작들을 수행할 수 있다. 동일한 설명은 중복되므로 생략한다. 일 실시예에서, 영상 부호화 장치는 예측 부호화부 및 생성부의 입출력 데이터를 저장하는 적어도 하나의 메모리를 포함할 수 있다. 또한, 영상 부호화 장치는, 메모리의 데이터 입출력을 제어하는 메모리 제어부를 포함할 수 있다. 일 실시예에서, 예측 부호화부는 현재 영상 내 현재 블록에 대한 예측 블록을 생성하기 위한 예측 정보를 결정할 수 있다. 예를 들어, 예측 정보는 현재 블록의 예측 모드가 인터(inter) 모드라는 정보를 포함할 수 있 다. 인터 모드는 영상들 사이의 시간적 중복성을 감소시키기 위해 참조 영상에 기반하여 현재 블록을 예측 또는 복원하는 모드이다. 현재 블록은 부호화하고자 하는 현재 영상으로부터 분할된 최대 부호화 단위, 부호화 단위, 변환 단위 또는 예측 단위일 수 있다. 또한, 예측 정보는 현재 블록의 예측 모드가 인터 모드인 경우, 참조 블 록을 결정하기 위한 정보를 포함할 수 있다. 예를 들어, 참조 블록을 결정하기 위한 정보는, 참조 픽처 리스트 내의 참조 영상을 가리키는 인덱스 및 움직임 정보를 포함할 수 있으나 개시된 예에 한하지 않는다. 일 실시예에서, 예측 부호화부는 현재 블록에 대한 결정된 예측 정보에 기초하여, 현재 블록에 대해 인터 예측을 수행하고, 인터 예측의 수행 결과로 생성되는 예측 블록을 이용하여 현재 블록을 부호화할 수 있다. 일 실시예에서, 예측 부호화부는 참조 영상에 기반하여 현재 블록을 부호화할 때, 하나의 참조 영상을 이 용(예를 들어, 단방향 예측)할 수도 있고, 두 개의 참조 영상을 이용(예를 들어, 쌍 예측)할 수도 있다. 현재 블록이 단방향 예측되는지, 또는 쌍 예측이 수행되는지 여부도 현재 블록에 대한 결정된 예측 정보로서 비트스 트림에 포함될 수 있으며, 플래그 또는 인덱스로 표현되는 정보일 수 있다. 현재 블록에 대해 단방향 예측이 수 행되는지, 쌍 예측이 수행되는지 여부가 현재 블록과 관련된 주변 블록들의 예측 모드로부터 암시적으로 결정되는 경우, 비트스트림에 주변 블록에 대한 정보가 플래그 또는 인덱스로서 포함될 수 있다. 일 실시예에서, 예측 부호화부는 현재 블록이 쌍 예측되는 경우, 현재 블록의 참조 블록들을 결정하기 위 해 이용하는 움직임 정보가 식별될 수 있으며, 움직임 정보는 예측 정보에 포함될 수 있다. 현재 블록의 움직임 정보는 비트스트림에 포함될 수 있다. 현재 블록의 움직임 정보는 참조 영상 인덱스, 움직임 벡터, 차분 움직임 벡터 및 참조 방향 중 적어도 하나를 포함할 수 있으며, 현재 블록의 움직임 벡터를 예측하기 위한 모든 정보를 포함할 수 있다. 일 실시예에서, 예측 정보는 비트스트림의 시퀀스 파라미터 세트(sequence parameter set), 영상 파라미터 세트 (picture parameter set), 슬라이스 헤더(slice header) 또는 슬라이스 데이터(slice data)에 포함될 수 있다. 일 실시예에서, 현재 블록의 부호화란, 영상 복호화 장치가 현재 블록을 복원할 수 있게 하는 정보를 생 성하는 과정을 의미할 수 있다. 부호화를 통해 생성된 정보는 비트스트림에 포함될 수 있다. 일 실시예에서, 예측 부호화부는 현재 블록에 대한 쌍 예측을 통해 예측 블록이 생성되면, 예측 블록을 이용하여 현재 블록을 부호화할 수 있다. 예측 부호화부는 예측 블록과 현재 블록의 차이에 대응하는 잔 차 데이터를 생성할 수 있다. 예측 블록이 현재 블록으로 결정되는 경우, 잔차 데이터는 생성되지 않을 수도 있 다. 일 실시예에서, 생성부는 영상의 부호화 결과를 포함하는 비트스트림을 생성할 수 있다. 비트스트림은 현 재 블록에 대한 부호화 결과를 포함할 수 있다. 생성부는 비트스트림을 네트워크를 통해 영상 복호화 장 치로 전송할 수 있다. 일 실시예에서, 생성부는 하드 디스크, 플로피 디스크 및 자기 테이프와 같은 자기 매체, CD-ROM 및 DVD 와 같은 광기록 매체, 플롭티컬 디스크(floptical disk)와 같은 자기-광 매체(magneto-optical medium) 등을 포함하는 데이터 저장 매체에 비트스트림을 저장할 수 있다. 생성부는 영상의 부호화를 통해 생성된 신택 스 엘리먼트(syntax element)들을 포함하는 비트스트림을 생성할 수 있다. 신택스 엘리먼트들에 해당하는 값들 은 영상의 계층 구조에 따라 비트스트림에 포함될 수 있다. 생성부가 신택스 엘리먼트들을 엔트로피 인코 딩하여 생성되는 비트열들이 비트스트림에 포함될 수 있다. 일 실시예에서, 예측 부호화부는 예측 복호화부에서 수행되는 인루프 필터링과 동일한 필터링이 수행될 수 있다. 한편, 명시적으로 개시되어 있지는 않으나, 도 1 내지 도 14를 통해 개시된 영상 복호화 장치, 또는 예측 복호화부에서 수행되는 동작은 예측 부호화부에서도 수행될 수 있다. 일 실시예에서, 예측 부호화부는 인루프 필터링부에서 수행되는 필터링을 위한 필터 정보를 결정할 수 있 다. 예를 들어, 필터 정보는, 인루프 필터링부에 포함된 디블록킹 필터링, 샘플 오프셋 적응적 필터링, 적응적 루프 필터링을 수행하기 위해 이용하는 정보를 포함할 수 있다. 필터 정보는 디블록킹 필터링, 샘플 오프셋 적 응적 필터링, 및 적응적 루프 필터링이 각각 수행되는지 여부 및 각 필터링을 수행하기 위한 필터링 파라미터를 포함할 수 있다. 일 실시예에서, 예측 부호화부는 현재 블록 또는 현재 영상에 대해 결정된 필터 정보에 기초하여, 현재 블록 또는 현재 영상에 대한 인루프 필터링을 수행하고, 인루프 필터링의 수행 결과로 생성되는 인루프 필터링 된 블록 또는 인루프 필터링된 영상을 이용하여 현재 블록을 부호화할 수 있다. 예를 들어, 예측 부호화부 는 인루프 필터링된 영상을 픽처 버퍼에 저장하고, 인루프 필터링된 영상을 참조 영상으로 이용하여 영상 을 부호화할 수 있다. 한편, 인루프 필터링된 영상은 인루프 필터링이 적용된 영상일 수 있다. 일 실시예에서, 필터 정보는 비트스트림의 시퀀스 파라미터 세트(sequence parameter set), 영상 파라미터 세트 (picture parameter set), 슬라이스 헤더(slice header) 또는 슬라이스 데이터(slice data)에 포함될 수 있다. 일 실시예에서, 예측 부호화부는 현재 영상의 인루프 필터링된 영상을 획득하기 위해 이용하는 출력 영상 을 생성하기 위해서, 필터링 신경망에 현재 영상에 상응하는 정보를 입력할 수 있다. 예측 부호화부는 필 터링 신경망으로부터 현재 영상을 위한 출력 영상을 획득할 수 있다. 일 실시예에서, 예측 부호화부는 인루프 필터링부를 포함할 수 있다. 인루프 필터링부는 특징 추출 신경 망 및 회귀 신경망을 포함하는 필터링 신경망을 포함할 수 있다. 또한, 인루프 필터링부는 필터링 신경망 내 적 어도 하나의 레이어에 이용하기 위한 레이어 정보를 생성하기 위해 상태 인코딩 신경망, 및 레이어 정보 신경망 을 이용할 수 있다. 일 실시예에서, 예측 부호화부는 출력 영상을 획득하기 위해서, 현재 영상에 대한 블록들 각각에 대한 참 조 블록에 대응하는 상태 정보를 이용할 수 있다. 예를 들어, 현재 영상을 위한 필터링 신경망에 적용되는 레이 어 정보를 생성하기 위해 레이어 정보 신경망의 입력으로서 획득하는 참조 영상에 대한 상태 정보는, 현재 영상 에 포함된 모든 블록에 대응하는 참조 블록들을 이용하여 결정될 수 있다. 한편, 예측 부호화부가 레이어 정보 신경망을 이용하여 레이어 정보를 생성하는 동작은 도 7 및 도 11a 내지 도 11c에 자세히 설명되어 있으므 로 동일한 내용은 중복되므로 생략한다. 예를 들어, 예측 부호화부는 현재 블록이 쌍 예측되는 경우, 제1 참조 블록 및 제2 참조 블록에 각각 가 중치를 적용하여 가중합하여 현재 블록에 대한 예측 블록을 생성할 수 있다. 현재 영상에 포함된 블록들 각각에 대한 참조 블록에 대응하는 상태 정보는, 쌍 예측에 이용되는 두개의 참조 블록에 각각 적용되는 가중치를 두개 의 참조 블록에 각각 대응하는 상태 정보에 적용시켜 가중합하여 획득된 상태 정보를 이용할 수 있다. 한편, 설명의 편의상, 예측 단위의 블록에 대한 참조 블록의 상태 정보를 이용하는 방법에 대해 설명하였으나, 개시된 예에 한하지 않고, 예측 부호화부는 프레임 단위, 슬라이스 단위, 타일 단위, 최대 부호화 단위, 부호화 단위, 예측 단위로 각 단위를 예측하기 위해 이용하는 참조 블록들에 대응하는 상태 정보를 이용하여 레 이어 정보를 생성할 수 있다. 예를 들어, 예측 부호화부는 프레임 단위의 레이어 정보를 생성하기 위해 현재 영상에 포함된 블록들에 대한 참조 블록들에 대응하는 상태 정보들을 레이어 정보 신경망에 입력하여 레이 어 정보를 생성할 수 있다. 일 실시예에서, 예측 부호화부는 레이어 정보 신경망으로부터 필터링 신경망 내 적어도 하난의 레이어에 이용하기 위한 레이어 정보를 획득할 수 있다. 예측 부호화부는 필터링 신경망에 적용하기 위한 레이어 정보로서, 컨볼루션 커널 및 어텐션 맵 중 적어도 하나를 획득할 수 있다. 예측 부호화부는 획득한 레이 어 정보를 필터링 신경망에서 이용할 수 있다. 예를 들어, 예측 부호화부는 및 어텐션 맵을 이용하여, 레 이어 정보에 포함된 컨볼루션 커널 및 어텐션 맵을 이용하는 컨볼루션 레이어를 포함하도록 필터링 신경망을 구 성할 수 있다. 필터링 신경망에 포함된 적어도 하나의 컨볼루션 레이어의 컨볼루션 커널 및 어텐션 맵은 획득된 레이어 정보에 기초하여 결정될 수 있다. 한편, 예측 복호화 장치가 레이어 정보를 이용하여 필터링 신경망을 구성하는 동작은 도 7 및 도 8a 내지 도 8c에 자세히 설명되어 있으므로 동일한 내용은 중복되므로 생략한다. 일 실시예에서, 예측 부호화부는 현재 영상의 복원 영상, 현재 영상의 예측 영상, 현재 영상의 제1 참조 영상, 현재 영상의 제2 참조 영상, 현재 영상을 위한 적어도 하나의 양자화 파라미터, 현재 영상에 대한 분할 정보 중 적어도 하나를 포함하는, 현재 영상에 상응하는 정보를 필터링 신경망에 입력할 수 있다. 일 실시예에서, 예측 부호화부는 현재 영상에 상응하는 정보를 필터링 신경망에 입력한 것에 기초하여, 현재 영상에 상응하는 특징맵을 획득할 수 있다. 예측 부호화부는 현재 영상에 상응하는 정보를 필터링 신경망에 입력한 것에 기초하여, 인루프 필터링이 적용된 영상을 획득하기 위해 이용하는 출력 영상을 획득할 수 있다. 예를 들어, 예측 부호화부는, 필터링 신경망에 포함된 특징 추출 신경망에 현재 영상에 상응하 는 정보를 입력하여 현재 영상에 상응하는 특징맵을 획득할 수 있다. 예측 부호화부는 필터링 신경망에 포함된 회귀 신경망으로부터, 현재 영상에 상응하는 특징맵을 입력으로 획득한 것에 대응하여 출력 영상을 획득 할 수 있다. 한편, 필터링 신경망의 예시적인 구조는 도 7 및, 도 9 내지 도 10에 자세히 설명되어 있으므로 동 일한 내용은 중복되므로 생략한다. 일 실시예에서, 예측 부호화부는, 필터링 신경망으로부터 획득한 현재 영상에 상응하는 특징맵을 이용하 여 현재 영상에 대한 상태 정보를 획득할 수 있다. 예를 들어, 예측 부호화부는, 필터링 신경망에 포함된 특징 추출 신경망으로부터 현재 영상에 상응하는 특징맵을 획득할 수 있다. 또한, 예측 부호화부는, 현재 영상에 상응하는 특징맵을 상태 인코딩 신경망에 입력하여, 현재 영상의 복원 영상 또는 예측 영상의 해상도보 다 낮은 해상도를 갖는 현재 영상에 대한 상태 정보를 획득할 수 있다. 현재 영상에 대한 상태 정보는 현재 영 상에 상응하는 특징맵을 상태 인코딩 신경망에 입력함으로써 획득되며, 상태 정보 버퍼에 저장될 수 있다. 한편, 상태 인코딩 신경망에 대한 구체적인 설명은 도 7에도 개시되어 있으므로, 동일한 내용은 중복되므로 생 략한다. 도 16은 본 개시의 일 실시예에 따른 영상 부호화 방법의 순서도이다. 단계 S1610에서, 영상 부호화 장치는 현재 영상에 대한 제1 참조 영상에 상응하는 특징맵으로부터 획득된 제1 상태 정보 또는 현재 영상에 대한 제2 참조 영상에 상응하는 특징맵으로부터 획득된 제2 상태 정보에 기초 하여, 필터링 신경망 내 적어도 하나의 레이어에 이용될 레이어 정보를 생성할 수 있다. 일 실시예에서, 영상 부호화 장치는 결정한 예측 정보를 이용하여 레이어 정보를 생성할 수 있다. 예측 정보는, 현재 영상을 복호화 하기 위해 제1 참조 영상 및/또는 제2 참조 영상을 이용한다는 정보를 포함할 수 있다. 구체적으로, 예측 정보는 현재 영상에 포함된 소정의 블록을 복호화 하기 위해, 제1 참조 영상 및/또는 제2 참조 영상을 이용한다는 정보를 포함할 수 있으며, 제1 움직임 벡터가 가리키는 제1 참조 블록 및/또는 제2 움직임 벡터가 가리키는 제2 참조 블록을 이용한다는 정보를 포함할 수 있다. 영상 부호화 장치는, 예측 정보를 결정할 수 있으며, 결정된 예측 정보를 포함하는 비트스트림을 생성할 수 있다. 일 실시예에서, 영상 부호화 장치는, 현재 영상에 대한 제1 참조 영상에 상응하는 특징맵에 기초하여 제1 상태 정보를 획득할 수 있다. 영상 부호화 장치는, 현재 영상에 대한 제2 참조 영상에 상응하는 특징맵에 기초하여 제2 상태 정보를 획득할 수 있다. 영상 부호화 장치는, 제1 참조 영상에 상응하는 특징맵을 상 태 인코딩 신경망에 입력하여, 제1 참조 영상에 대응하는 제1 상태 정보를 획득할 수 있다. 영상 부호화 장치 는, 제2 참조 영상에 상응하는 특징맵을 상태 인코딩 신경망에 입력하여, 제2 참조 영상에 대응하는 제2 상태 정보를 획득할 수 있다. 일 실시예에서, 영상 부호화 장치는, 필터링 신경망에 제1 참조 영상에 상응하는 정보를 입력할 수 있다. 영상 부호화 장치는 제1 참조 영상에 상응하는 정보를 필터링 신경망에 입력한 것에 기초하여, 제1 참조 영상에 상응하는 특징맵을 획득할 수 있다. 예를 들어, 영상 부호화 장치는, 필터링 신경망에 포함된 특 징 추출 신경망으로부터 제1 참조 영상에 상응하는 특징맵을 획득할 수 있다. 영상 부호화 장치는, 제1 참조 영상에 상응하는 특징맵을 상태 인코딩 신경망에 입력하여, 제1 참조 영상에 대한 상태 정보를 나타내는 제1 상태 정보를 획득할 수 있다. 제1 상태 정보는 제1 참조 영상의 해상도보다 낮은 해상도를 가질 수 있다. 일 실시예에서, 영상 부호화 장치는, 필터링 신경망에 제2 참조 영상에 상응하는 정보를 입력할 수 있다. 영상 부호화 장치는 제2 참조 영상에 상응하는 정보를 필터링 신경망에 입력한 것에 기초하여, 제2 참조 영상에 상응하는 특징맵을 획득할 수 있다. 예를 들어, 영상 부호화 장치는, 필터링 신경망에 포함된 특 징 추출 신경망으로부터 제2 참조 영상에 상응하는 특징맵을 획득할 수 있다. 영상 부호화 장치는, 제2 참조 영상에 상응하는 특징맵을 상태 인코딩 신경망에 입력하여, 제2 참조 영상에 대한 상태 정보를 나타내는 제2 상태 정보를 획득할 수 있다. 제2 상태 정보는 제2 참조 영상의 해상도보다 낮은 해상도를 가질 수 있다. 한편, 도 1 내지 도 13에서, 영상 부호화 장치가 현재 영상에 대한 상태 정보를 생성하는 동작에 대해 자 세히 설명하였다. 현재 영상에 대한 상태 정보를 생성하는 동작은, 제1 참조 영상에 대한 제1 상태 정보 및/또 는 제2 참조 영상에 대한 제2 상태 정보를 생성하는 동작에 대응할 수 있으므로 동일한 내용은 생략한다. 일 실시예에서, 영상 부호화 장치는, 제1 상태 정보 및/또는 제2 상태 정보를 상태 정보 버퍼에 저장할 수 있다. 영상 부호화 장치는, 현재 영상에 대한 인루프 필터링이 적용된 영상을 획득하기 위해, 제1 상 태 정보 및/또는 제2 상태 정보를 이용할 수 있다. 일 실시예에서, 영상 부호화 장치는, 현재 영상에 포함된 소정의 블록이 제1 참조 영상 및/또는 제2 참조 영상에 포함된 블록들을 참조 블록들로서 이용하는 경우, 참조 블록들을 이용하여 예측 영상을 생성 또는 획득 할 수 있다. 영상 부호화 장치는, 현재 영상에 대한 예측 영상을 생성하기 위해 이용하는 참조 블록들에 대응하는 상태 정보들을 레이어 정보 신경망에 입력할 수 있다. 일 실시예에서, 영상 부호화 장치는, 레이어 정보 신경망에 제1 상태 정보 및 제2 상태 정보를 입력한 것 에 기초하여, 필터링 신경망 내 적어도 하나의 레이어에 적용될 레이어 정보를 생성할 수 있다. 상기 레이어 정 보는, 필터링 신경망 내 적어도 하나의 레이어에 적용하기 위한 커널 및 어텐션 맵 중 적어도 하나를 포함할 수 있다. 한편, 앞서 도 1 내지 도 13에서 레이어 정보에 대하여 자세하게 설명하였으므로, 자세한 내용은 중복되므로 생 략한다. 단계 S1620에서, 영상 부호화 장치는 필터링 신경망 내 적어도 하나의 레이어에 현재 영상에 상응하는 정 보를 입력할 수 있다. 일 실시예에서, 영상 부호화 장치는 생성된 레이어 정보를 필터링 신경망에 적용할 수 있다. 예를 들어, 필터링 신경망에 포함된 특징 추출 신경망은, 레이어 정보에 포함된 컨볼루션 커널을 이용하는 뉴럴 레이어를 포함할 수 있다. 또는, 필터링 신경망에 포함된 회귀 신경망은, 레이어 정보에 포함된 어텐션 맵을 포함하는 뉴 럴 레이어를 포함할 수 있다. 한편, 개시된 예에 한하지 않는다. 또한, 특징 추출 신경망에 적용되는 레이어 정 보와 회귀 신경망에 적용되는 레이어 정보는 각각의 신경망의 목적이 상이하므로, 상이할 수 있다. 일 실시예에서, 영상 부호화 장치는, 레이어 정보가 이용된 필터링 신경망 내 적어도 하나의 레이어에 현 재 영상에 상응하는 정보를 입력할 수 있다. 영상 부호화 장치는, 레이어 정보가 이용된 적어도 하나의 레이어를 포함하는 필터링 신경망에 현재 영상에 상응하는 정보를 입력할 수 있다. 현재 영상에 상응하는 정보 는 현재 영상에 대한 복원 영상, 현재 영상에 대한 디블록킹 필터링된 영상, 현재 영상에 대한 샘플 적응적 오 프셋 필터링된 영상, 현재 영상에 대한 적응적 루프 필터링된 영상, 현재 영상에 대한 예측 영상, 현재 영상에 대한 제1 참조 영상, 현재 영상에 대한 제2 참조 영상, 현재 영상에 대한 적어도 하나의 양자화 파라미터, 현재 영상에 대한 분할 정보 중 적어도 하나를 포함할 수 있다. 일 실시예에서, 영상 부호화 장치는, 필터링 신경망에 포함된 특징 추출 신경망에 현재 영상에 상응하는 정보를 입력할 수 있다. 한편 도 1 내지 도 13에서, 영상 부호화 장치가 생성된 레이어 정보를 필터링 신 경망 및 필터링 신경망 내 적어도 하나의 레이어에 대해 구체적으로 설명하였으므로, 동일한 내용은 생략한다. 단계 S1630에서, 영상 부호화 장치는 레이어 정보가 이용된 적어도 하나의 레이어에 현재 영상에 상응하 는 정보를 입력함으로써, 현재 영상에 대해 인루프 필터링이 적용된 영상을 획득할 수 있다. 일 실시예에서, 영상 부호화 장치는 필터링 신경망으로부터 현재 영상에 대한 인루프 필터링이 수행된 인 루프 필터링된 영상을 획득하기 위해 이용하는 출력 영상을 획득할 수 있다. 일 실시예에서, 영상 부호화 장치가 필터링 신경망에 현재 영상에 상응하는 정보를 입력한 것에 대응하여 필터링 신경망에 포함된 특징 추출 신경망은 현재 영상에 상응하는 특징맵을 생성할 수 있다. 또한, 특징 추출 신경망으로부터 획득된 현재 영상에 상응하는 특징맵은 필터링 신경망에 포함된 회귀 신경망에 입력될 수 있다. 영상 부호화 장치는 현재 영상에 상응하는 특징맵을 입력받은 회귀 신경망으로부터 출력 영상을 획득할 수 있다. 일 실시예에서, 영상 부호화 장치는 인루프 필터링부 내에 필터링 신경망 및 디블록킹 필터링부가 병렬로 구성되어 있는 경우, 필터링 신경망의 출력인 출력 영상과 디블록킹 필터링된 영상에 대한 덧셈 연산을 수행한 것에 기초하여, 인루프 필터링된 영상을 획득할 수 있다. 예를 들어, 영상 부호화 장치는 출력 영상과 디 블록킹 필터링된 영상에 대해 덧셈 연산을 수행한 결과에 대해 샘플 적응적 루프 필터링 및 적응적 루프 필터링 을 수행함으로써 인루프 필터링이 적용된 영상을 획득할 수 있다. 일 실시예에서, 영상 부호화 장치는 인루프 필터링부 내에 디블록킹 필터링부 이후에 일렬로 필터링 신경 망이 위치하는 경우, 디블록킹 필터링된 영상을 필터링 신경망에 현재 영상에 상응하는 정보 중 하나로서 입력 할 수 있다. 영상 부호화 장치는, 필터링 신경망으로부터 획득한 출력 영상에 대해 샘플 적응적 오프셋 필터링 및 적응적 루프 필터링을 수행함으로써, 인루프 필터링이 적용된 영상을 획득할 수 있다. 한편, 개시된 예에 한하지 않고, 인루프 필터링부의 설계에 따라, 필터링 신경망의 위치가 조정될 수 있고, 필 터링 신경망의 위치에 따라 적절한 출력 영상을 생성하도록 필터링 신경망이 학습될 수 있다. 한편, 도 1 내지 도 13에서, 필터링 신경망으로부터 출력 영상을 생성하는 동작에 대해 자세히 설명하였으므로, 동일한 내용은 중복되므로 생략한다. 한편, 도 1 내지 도 15에서, 필터링 신경망으로부터 출력 영상을 생성하는 동작에 대해 자세히 설명하였으므로, 동일한 내용은 중복되므로 생략한다. 또한, 도 16의 동작들은 앞선 도 1 내지 도 14의 개시와 영상 부호화 장치 에서 수행된다는 점에 있어서만 차이가 있을 뿐, 대응할 수 있다. 일 실시예에서, 영상 복호화 방법은 현재 영상에 대한 제1 참조 영상에 상응하는 특징맵으로부터 획득된 제1 상 태 정보 또는 현재 영상에 대한 제2 참조 영상에 상응하는 특징맵으로부터 획득된 제2 상태 정보에 기초하여, 필터링 신경망 내 적어도 하나의 레이어에 이용될 레이어 정보를 생성하는 단계(S1410)를 포함할 수 있다. 영상 복호화 방법은, 필터링 신경망 내 적어도 하나의 레이어에 현재 영상에 상응하는 정보를 입력하 는 단계(S1420)를 포함할 수 있다. 영상 복호화 방법은, 레이어 정보가 이용된 적어도 하나의 레이어에 현재 영 상에 상응하는 정보를 입력함으로써, 현재 영상에 대해 인루프 필터링이 적용된 영상을 획득하는 단계 (S1430)를 포함할 수 있다. 현재 영상에 대한 상태 정보는, 현재 영상에 상응하는 특징맵으로부터 획 득되고, 현재 영상의 해상도보다 낮은 해상도를 가질 수 있다. 일 실시예에서, 레이어 정보는, 필터링 신경망 내 적어도 하나의 레이어에 적용하기 위한 커널(Kernel) 및 어텐션 맵(Attention Map) 중 적어도 하나를 포함할 수 있다. 일 실시예에서, 제1 참조 영상은, 현재 영상의 제1 참조 픽처 리스트에 포함된 영상일 수 있다. 제2 참조 영상 은, 현재 영상의 제2 참조 픽처 리스트에 포함된 영상일 수 있다. 제1 참조 영상의 POC 값은, 현재 영상의 POC 값보다 작을 수 있다. 제2 참조 영상의 POC 값은, 현재 영상의 POC 값보다 클 수 있다. 일 실시예에서, 제1 참조 영상 및 제2 참조 영상은, 현재 영상의 제2 참조 픽처 리스트에 포함된 영상이며, 제1 참조 영상의 POC 값 및 제2 참조 영상의 POC 값은, 현재 영상의 POC 값보다 클 수 있다. 일 실시예에서, 현재 영상에 대한 상태 정보는, 현재 영상에 상응하는 특징맵을 상태 인코딩 신경망 에 입력함으로써 획득될 수 있다. 현재 영상에 대한 상태 정보는 상태 정보 버퍼에 저장될 수 있다. 일 실시예에서, 제1 상태 정보는, 제1 참조 영상에 상응하는 특징맵을 상태 인코딩 신경망에 입력함으로써 획득될 수 있다. 제1 상태 정보는, 상태 정보 버퍼에 저장될 수 있다. 일 실시예에서, 제2 상태 정보는, 제2 참조 영상에 상응하는 특징맵을 상태 인코딩 신경망에 입력함으로써 획득될 수 있다. 제2 상태 정보는, 상태 정보 버퍼에 저장될 수 있다. 일 실시예에서, 필터링 신경망은, 현재 영상에 상응하는 정보로부터 현재 영상의 특징을 추출하여 현재 영 상에 상응하는 특징맵을 생성하는 특징 추출 신경망 및 현재 영상에 상응하는 특징맵으로부터 현재 영상에 대해 인루프 필터링이 적용된 영상을 획득하기 위해 이용하는 회귀 신경망을 포함할 수 있다. 일 실시예에서, 현재 영상에 상응하는 정보는, 현재 영상의 복원 영상, 현재 영상의 예측 영상, 제1 참조 영상, 제2 참조 영상, 현재 영상을 위한 적어도 하나의 양자화 파라미터, 현재 영상에 대한 분할 정보 중 적어 도 하나를 포함할 수 있다. 일 실시예에서, 영상 복호화 방법은, 회귀 신경망으로부터 획득한 출력 영상과 현재 영상의 디블록킹 필터링된(Deblock-filtered) 영상에 대해 덧셈 연산을 수행한 것에 기초하여, 현재 영상에 대해 인루프 필터링 된 영상을 획득할 수 있다. 일 실시예에서, 필터링 신경망은, 심층 신경망(Deep Neural Network), 컨볼루션 신경망(Convolution Neural Network), 및 트랜스포머 신경망(Transformer Neural Network) 중 적어도 하나를 포함할 수 있다. 일 실시예에서, 특징 추출 신경망은, 현재 영상의 해상도보다 낮은 해상도를 갖는 현재 영상에 상응하는 특징맵을 생성하기 위한 적어도 하나의 다운 샘플링 레이어(Down Sampling Layer)를 포함할 수 있다. 일 실시예에서, 회귀 신경망은, 현재 영상에 상응하는 특징맵의 해상도보다 높은 해상도를 갖는 출력 영상을 생성하기 위한 적어도 하나의 업 샘플링 레이어(Up Sampling Layer)를 포함할 수 있다. 일 실시예에서, 상태 인코딩 신경망은, 적어도 하나의 다운 샘플링 레이어를 포함하고, 적어도 하나의 다 운 샘플링 레이어는, 스트라이드 컨볼루션 레이어(Stride Convolution Layer), 및 풀링 레이어(Pooling Layer) 중 적어도 하나의 레이어를 포함할 수 있다. 일 실시예에서, 레이어 정보를 생성하기 위해 이용하는 레이어 정보 신경망은, 스트라이드 컨볼루션 레이어 (Stride Convolution Layer), 풀링 레이어(Pooling Layer), 보간 레이어(Interpolation Layer), 디컨볼루션 레 이어(Deconvolution Layer), 및 픽셀 셔플 레이어(PixelShuffle Layer) 중 적어도 하나를 포함할 수 있다. 일 실시예에서, 필터링 신경망, 상태 인코딩 신경망, 및 레이어 정보 신경망은, 제1 참조 영상에 상응하는 정보 또는 제2 참조 영상에 상응하는 정보를 필터링 신경망에 입력하고, 현재 영상에 상응하는 정보를 필터링 신경망 에 입력한 것에 기초하여 함께 훈련될 수 있다. 일 실시예에서, 영상 복호화 장치는 적어도 하나의 인스트럭션을 저장하는 적어도 하나의 메모리; 및 적 어도 하나의 인스트럭션에 따라 동작하는 적어도 하나의 프로세서를 포함할 수 있다. 적어도 하나의 프로세서는, 현재 영상에 대한 제1 참조 영상에 상응하는 특징맵으로부터 획득된 제1 상태 정보 또는 현재 영상 에 대한 제2 참조 영상에 상응하는 특징맵으로부터 획득된 제2 상태 정보에 기초하여, 필터링 신경망 내 적어도 하나의 레이어에 이용될 레이어 정보를 생성할 수 있다. 적어도 하나의 프로세서는, 필터링 신경망 내 적어도 하나의 레이어에 현재 영상에 상응하는 정보를 입력할 수 있다. 적어도 하나의 프로세서는, 레 이어 정보가 이용된 적어도 하나의 레이어에 현재 영상에 상응하는 정보를 입력함으로써, 현재 영상에 대 해 인루프 필터링이 적용된 영상을 획득할 수 있다. 현재 영상에 대한 상태 정보는, 현재 영상에 상응하는 특징맵으로부터 획득되고, 현재 영상의 해상도보다 낮은 해상도를 가질 수 있다.일 실시예에서, 영상 부호화 방법은, 현재 영상에 대한 제1 참조 영상에 상응하는 특징맵으로부터 획득된 제1 상태 정보 또는 현재 영상에 대한 제2 참조 영상에 상응하는 특징맵으로부터 획득된 제2 상태 정보에 기초하여, 필터링 신경망 내 적어도 하나의 레이어에 이용될 레이어 정보를 생성하는 단계(S1610)를 포함할 수 있다. 일 실시예에서, 영상 부호화 방법은, 필터링 신경망 내 적어도 하나의 레이어에 현재 영상에 상응하는 정 보를 입력하는 단계(S1620)를 포함할 수 있다. 일 실시예에서, 영상 부호화 방법은, 레이어 정보가 이용된 적어도 하나의 레이어에 현재 영상에 상응하는 정보 를 입력함으로써, 현재 영상에 대해 인루프 필터링이 적용된 영상을 획득하는 단계(S1630)를 포함할 수 있 다. 현재 영상에 대한 상태 정보는, 현재 영상에 상응하는 특징맵으로부터 획득되고, 현재 영상의 해 상도보다 낮은 해상도를 가질 수 있다. 일 실시예에서, 영상 부호화 장치는 적어도 하나의 인스트럭션을 저장하는 적어도 하나의 메모리; 및 적 어도 하나의 인스트럭션에 따라 동작하는 적어도 하나의 프로세서를 포함할 수 있다. 적어도 하나의 프로세서는, 현재 영상에 대한 제1 참조 영상에 상응하는 특징맵으로부터 획득된 제1 상태 정보 또는 현재 영상 에 대한 제2 참조 영상에 상응하는 특징맵으로부터 획득된 제2 상태 정보에 기초하여, 필터링 신경망 내 적어도 하나의 레이어에 이용될 레이어 정보를 생성할 수 있다. 적어도 하나의 프로세서는, 필터링 신경망 내 적어도 하나의 레이어에 현재 영상에 상응하는 정보를 입력할 수 있다. 적어도 하나의 프로세서는, 레 이어 정보가 이용된 적어도 하나의 레이어에 현재 영상에 상응하는 정보를 입력함으로써, 현재 영상에 대 해 인루프 필터링이 적용된 영상을 획득할 수 있다. 현재 영상에 대한 상태 정보는, 현재 영상에 상응하는 특징맵으로부터 획득되고, 현재 영상의 해상도보다 낮은 해상도를 가질 수 있다. 일 실시예에서, 비트스트림을 기록한 컴퓨터로 읽을 수 있는 기록 매체가 제공될 수 있다. 비트스트림은, 현재 영상을 예측하기 위해 이용하는 예측 정보를 포함할 수 있다. 예측 정보에 기초하여, 제1 참조 영상에 상응하는 특징맵으로부터 획득된 제1 상태 정보 또는 제2 참조 영상에 상응하는 특징맵으로부터 획득된 제2 상태 정보에 기초하여, 필터링 신경망 내 적어도 하나의 레이어에 이용될 레이어 정보가 생성될 수 있다. 필터링 신경 망 내 적어도 하나의 레이어에 현재 영상에 상응하는 정보가 입력될 수 있다. 레이어 정보가 이용된 적어도 하나의 레이어에 현재 영상에 상응하는 정보가 입력됨으로써, 현재 영상에 대해 인루프 필터링이 적용된 영상이 획득될 수 있다. 현재 영상에 대한 상태 정보는, 현재 영상에 상응하는 특징맵으로부 터 획득되고, 현재 영상의 해상도보다 낮은 해상도를 가질 수 있다. 본 개시의 다양한 실시예들은 하나 이상의 컴퓨터 프로그램들에 의해 구현 또는 지원될 수 있고, 컴퓨터 프로그 램들은 컴퓨터 판독 가능한 프로그램 코드(code)로부터 형성되고, 컴퓨터로 판독 가능한 매체에 수록될 수 있다. 본 개시에서, \"애플리케이션(application)\" 및 \"프로그램(program)\"은 컴퓨터 판독 가능한 프로그램 코드 에서의 구현에 적합한 하나 이상의 컴퓨터 프로그램, 소프트웨어 컴포넌트, 명령어 세트, 프로시저(procedure), 함수, 개체(object), 클래스, 인스턴스, 관련 데이터, 또는 그것의 일부를 나타낼 수 있다. \"컴퓨터 판독 가능 한 프로그램 코드\"는, 소스 코드, 목적 코드, 및 실행 가능한 코드를 포함하는 다양한 유형의 컴퓨터 코드를 포 함할 수 있다. \"컴퓨터 판독 가능한 매체\"는, ROM(read only memory), RAM(random access memory), 하드 디스 크 드라이브(HDD), CD(compact disc), DVD(digital video disc), 또는 다양한 유형의 메모리와 같이, 컴퓨터에 의해 액세스(access)될 수 있는 다양한 유형의 매체를 포함할 수 있다. 또한, 기기로 읽을 수 있는 저장 매체는, 비일시적(non-transitory) 저장 매체의 형태로 제공될 수 있다. 여기 서, ‘비일시적 저장 매체'는 실재(tangible)하는 장치이고, 일시적인 전기적 또는 다른 신호들을 전송하는 유 선, 무선, 광학적, 또는 다른 통신 링크들을 배제할 수 있다. 한편, 이 '비일시적 저장 매체'는 데이터가 저장 매체에 반영구적으로 저장되는 경우와 임시적으로 저장되는 경우를 구분하지 않는다. 예를 들어, '비일시적 저 장 매체'는 데이터가 임시적으로 저장되는 버퍼를 포함할 수 있다. 컴퓨터 판독 가능한 매체는 컴퓨터에 의해 액세스될 수 있는 임의의 가용 매체일 수 있고, 휘발성 및 비휘발성 매체, 분리형 및 비분리형 매체를 모두 포 함할 수 있다. 컴퓨터 판독 가능한 매체는, 데이터가 영구적으로 저장될 수 있는 매체와 데이터가 저장되고 나 중에 덮어쓰기 될 수 있는 매체, 이를테면 재기입 가능한 광 디스크 또는 소거 가능한 메모리 디바이스를 포함 한다. 일 실시예에 따르면, 본 문서에 개시된 다양한 실시예들에 따른 방법은 컴퓨터 프로그램 제품(computer program product)에 포함되어 제공될 수 있다. 컴퓨터 프로그램 제품은 상품으로서 판매자 및 구매자 간에 거래될 수 있 다. 컴퓨터 프로그램 제품은 기기로 읽을 수 있는 저장 매체(예를 들어, compact disc read only memory (CD- ROM))의 형태로 배포되거나, 또는 어플리케이션 스토어를 통해 또는 두 개의 사용자 장치들(예를 들어, 스마트폰) 간에 직접, 온라인으로 배포(예를 들어, 다운로드 또는 업로드)될 수 있다. 온라인 배포의 경우에, 컴퓨터 프로그램 제품(예를 들어, 다운로더블 앱(downloadable app))의 적어도 일부는 제조사의 서버, 어플리케이션 스 토어의 서버, 또는 중계 서버의 메모리와 같은 기기로 읽을 수 있는 저장 매체에 적어도 일시 저장되거나, 임시 적으로 생성될 수 있다."}
{"patent_id": "10-2024-0060764", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "전술한 본 개시의 설명은 예시를 위한 것이며, 본 개시가 속하는 기술분야의 통상의 지식을 가진 자는 본 개시 의 기술적 사상이나 필수적인 특징을 변경하지 않고서 다른 구체적인 형태로 쉽게 변형이 가능하다는 것을 이해 할 수 있을 것이다. 예를 들어, 설명된 기술들이 설명된 방법과 다른 순서로 수행되거나, 및/또는 으로 설명된 시스템, 구조, 장치, 회로 등의 구성요소들이 설명된 방법과 다른 형태로 결합 또는 조합되거나, 다른 구성요소 또는 균등물에 의하여 대치되거나 치환되더라도 적절한 결과가 달성될 수 있다. 그러므로 이상에서 기술한 실시 예들은 모든 면에서 예시적인 것이며 한정적이 아닌 것으로 이해해야만 한다. 예를 들어, 단일형으로 설명되어 있는 각 구성 요소는 분산되어 실시될 수도 있으며, 마찬가지로 분산된 것으로 설명되어 있는 구성 요소들도 결 합된 형태로 실시될 수 있다. 본 개시의 범위는 상기 상세한 설명보다는 후술하는 특허청구범위에 의하여 나타내어지며, 특허청구범위의 의미 및 범위 그리고 그 균등 개념으로부터 도출되는 모든 변경 또는 변형된 형태가 본 개시의 범위에 포함되는 것으 로 해석되어야 한다.도면 도면1 도면2 도면3 도면4 도면5 도면6 도면7 도면8a 도면8b 도면8c 도면9 도면10 도면11a 도면11b 도면11c 도면12 도면13 도면14 도면15 도면16"}
{"patent_id": "10-2024-0060764", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 개시의 일 실시예에 따른 인루프 필터링을 수행하는 영상 부호화 및 복호화 시스템의 블록도를 나타 낸 도면이다. 도 2는 본 개시의 일 실시예에 따른 영상으로부터 트리 구조에 따라 분할된 블록들을 도시하는 도면이다. 도 3은 본 개시의 일 실시예에 따른 픽처 그룹 구조를 설명하기 위한 도면이다. 도 4는 본 개시의 일 실시예에 따른 현재 블록과 참조 블록의 관계를 설명하기 위한 도면이다. 도 5는 본 개시의 일 실시예에 따른 인루프 필터링 동작을 나타내는 도면이다. 도 6는 본 개시의 일 실시예에 따른 인루프 필터링부의 블록도를 예시하는 도면이다. 도 7는 본 개시의 일 실시예에 따른 필터링 신경망으로부터 중간 영상을 출력하는 과정을 설명하기 위한 도면이 다. 도 8a 내지 도 8c는 본 개시의 일 실시예에 따른 레이어 정보를 이용하는 필터링 신경망을 설명하기 위한 도면 이다. 도 9는 본 개시의 일 실시예에 따른, 필터링 신경망에 포함된 특징 추출 신경망의 구조를 예시하는 도면이다. 도 10는 본 개시의 일 실시예에 따른, 필터링 신경망에 포함된 회귀 신경망의 구조를 예시하는 도면이다. 도 11a 내지 도 11c는 본 개시의 일 실시예에 따른, 레이어 정보 신경망의 구조를 예시하는 도면이다. 도 12는 본 개시의 일 실시예에 따른, 필터링 신경망의 학습 방법을 나타내는 도면이다 도 13는 본 개시의 일 실시예에 따른 영상 복호화 장치의 구성을 도시하는 블록도이다. 도 14은 본 개시의 일 실시예에 따른 영상 복호화 방법의 순서도이다. 도 15는 본 개시의 일 실시예에 따른 영상 부호화 장치의 구성을 도시하는 블록도이다.도 16은 본 개시의 일 실시예에 따른 영상 부호화 방법의 순서도이다."}
