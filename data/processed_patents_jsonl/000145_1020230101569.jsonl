{"patent_id": "10-2023-0101569", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2024-0041220", "출원번호": "10-2023-0101569", "발명의 명칭": "캡슐내시경 영상을 이용하여 인공지능 모델의 학습 데이터를 구축하는 전자장치 및 그 구축", "출원인": "동국대학교 산학협력단", "발명자": "임윤정"}}
{"patent_id": "10-2023-0101569", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "캡슐내시경 영상을 이용하여 인공지능 모델의 학습 데이터를 구축하는 전자장치에 있어서,복수의 영상 프레임들로 이루어진 캡슐내시경 영상의 각 영상 프레임을 비병변 영상 또는 병변 영상으로 분류하고, 분류된 복수의 비병변 영상들 및 출혈 영상, 염증성 영상, 혈관성 영상 및 용종성 영상 중 어느 하나의 영상으로 분류된 복수의 병변 영상들 중 잘못 분류된 오류 영상을 식별하고, 상기 복수의 병변 영상들 중 상기 오류 영상을 제외한 나머지 복수의 병변 영상들을 각 병변 별로 생성된 폴더에 분류하여 상기 학습 데이터를 구축하는 프로세서를 포함하는 전자장치."}
{"patent_id": "10-2023-0101569", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 프로세서는, 상기 복수의 병변 영상들의 오류 여부에 대해 수신한 사용자 입력에 기초하여 상기 오류 영상을 식별하는 전자장치."}
{"patent_id": "10-2023-0101569", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제2항에 있어서,상기 프로세서는, 상기 복수의 비병변 영상들 및 상기 복수의 병변 영상들 중 잘못 분류된 오류 영상을 식별하도록 생성된 사용자인터페이스를 통해 상기 사용자 입력을 수신하는 전자장치."}
{"patent_id": "10-2023-0101569", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제3항에 있어서,상기 프로세서는, 복수의 병변 영상들을 출혈 영상, 염증성 영상, 혈관성 영상 및 용종성 영상 별로 나열하고,상기 사용자 인터페이스를 통해 상기 나열된 복수의 병변 영상들 중에서 상기 오류 영상을 선택하는 사용자 입력을 수신하는 전자장치."}
{"patent_id": "10-2023-0101569", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제3항에 있어서,상기 프로세서는, 상기 병변 영상 별 분류를 각각 선택할 수 있는 상기 사용자 인터페이스를 제공하고,상기 사용자 인터페이스를 통해 수신한 사용자 입력에 따라 각 병변 영상의 오류 여부를 확인하는 전자장치."}
{"patent_id": "10-2023-0101569", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제1항에 있어서,상기 프로세서는, 상기 나머지 복수의 병변 영상들이 상기 각 폴더에 균등하게 분류되도록 하여 상기 학습 데이터를 구축하는 전공개특허 10-2024-0041220-3-자장치."}
{"patent_id": "10-2023-0101569", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제1항에 있어서,상기 프로세서는, 입력되는 캡슐내시경 영상이 비병변 영상인지 병변 영상인지 분류하도록 학습된 제1인공지능 모델에 기초하여상기 각 영상 프레임을 비병변 영상 또는 병변 영상으로 분류하는 전자장치."}
{"patent_id": "10-2023-0101569", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "전자장치에 의해 수행되는 캡슐내시경 영상을 이용하여 인공지능 모델의 학습 데이터를 구축하는 방법에있어서,복수의 영상 프레임들로 이루어진 캡슐내시경 영상의 각 영상 프레임을 비병변 영상 또는 병변 영상으로 분류하는 단계;분류된 복수의 비병변 영상들 및 출혈 영상, 염증성 영상, 혈관성 영상 및 용종성 영상 중 어느 하나의 영상으로 분류된 복수의 병변 영상들 중 잘못 분류된 오류 영상을 식별하는 단계;상기 복수의 병변 영상들 중 상기 오류 영상을 제외한 나머지 복수의 병변 영상들을 각 병변 별로 생성된 폴더에 분류하여 상기 학습 데이터를 구축하는 단계를 포함하는 방법."}
{"patent_id": "10-2023-0101569", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제8항에 있어서,상기 오류 영상을 식별하는 단계는, 상기 복수의 병변 영상들의 오류 여부에 대해 수신한 사용자 입력에 기초하여 상기 오류 영상을 식별하는 단계를 포함하는 방법."}
{"patent_id": "10-2023-0101569", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제9항에 있어서,상기 잘못 분류된 오류 영상을 식별하는 단계는,상기 복수의 비병변 영상들 및 상기 복수의 병변 영상들 중 잘못 분류된 오류 영상을 식별하도록 생성된 사용자인터페이스를 통해 상기 사용자 입력을 수신하는 단계를 포함하는 방법."}
{"patent_id": "10-2023-0101569", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "제10항에 있어서,상기 잘못 분류된 오류 영상을 식별하는 단계는,복수의 병변 영상들을 출혈 영상, 염증성 영상, 혈관성 영상 및 용종성 영상 별로 나열하는 단계;상기 사용자 인터페이스를 통해 상기 나열된 복수의 병변 영상들 중에서 상기 오류 영상을 선택하는 사용자 입력을 수신하는 단계를 포함하는 방법."}
{"patent_id": "10-2023-0101569", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제10항에 있어서,상기 잘못 분류된 오류 영상을 식별하는 단계는,상기 병변 영상 별 분류를 각각 선택할 수 있는 상기 사용자 인터페이스를 제공하는 단계;상기 사용자 인터페이스를 통해 수신한 사용자 입력에 따라 각 병변 영상의 오류 여부를 확인하는 단계를 포함하는 방법.공개특허 10-2024-0041220-4-청구항 13 제8항에 있어서,상기 학습 데이터를 구축하는 단계는, 상기 나머지 복수의 병변 영상들이 상기 각 폴더에 균등하게 분류되도록 하여 상기 학습 데이터를 구축하는 단계를 포함하는 방법."}
{"patent_id": "10-2023-0101569", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_14", "content": "제8항에 있어서,상기 각 영상 프레임을 비병변 영상 또는 병변 영상으로 분류하는 단계는, 입력되는 캡슐내시경 영상이 비병변 영상인지 병변 영상인지 분류하도록 학습된 제1인공지능 모델에 기초하여상기 각 영상 프레임을 비병변 영상 또는 병변 영상으로 분류하는 단계를 포함하는 방법."}
{"patent_id": "10-2023-0101569", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명의 일 실시예에 따른 캡슐내시경 영상을 이용하여 인공지능 모델의 학습 데이터를 구축하는 전자장치에 있어서, 복수의 영상 프레임들로 이루어진 캡슐내시경 영상의 각 영상 프레임을 비병변 영상 또는 병변 영상으로 분류하고, 분류된 복수의 비병변 영상들 및 출혈 영상, 염증성 영상, 혈관성 영상 및 용종성 영상 중 어느 하나 의 영상으로 분류된 복수의 병변 영상들 중 잘못 분류된 오류 영상을 식별하고, 상기 복수의 병변 영상들 중 상 기 오류 영상을 제외한 나머지 복수의 병변 영상들을 각 병변 별로 생성된 폴더에 분류하여 상기 학습 데이터를 구축하는 프로세서를 포함한다."}
{"patent_id": "10-2023-0101569", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 캡슐내시경 영상을 이용하여 인공지능 모델의 학습 데이터를 구축하는 전자장치 및 그 구축 방법에 관한 것이다."}
{"patent_id": "10-2023-0101569", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "인공지능 모델을 생성하기 위해 필요한 학습 데이터들을 일일이 분류하고 표식하는 일은 시간이 많이 소요된다. 또한, 다양한 경로를 통해 수집되는 인공지능 학습 데이터들은 특성 별로 데이터가 비대칭적 분포를 이루거나, 동일한 데이터가 불필요하게 중복되거나, 특성에 맞지 않는 학습 데이터가 포함될 수 있다. 이 경우 학습 데이 터의 품질이 낮은 바, 이는 학습 데이터를 통해 생성된 인공지능 모델이나 알고리즘의 성능, 정확도 저하 등으 로 귀결된다. 따라서, 최적화된 인공지능 모델의 기술적 가능성을 객관적으로 평가하기 위해, 인공지능 학습 데이터들을 구축 하는 과정에서 학습 데이터들의 특성별 자료 양이 균질하고, 주요 특성의 다양성이 충분히 반영되고, 동일한 영 상의 반복이 적은 등 학습 데이터의 질이 보장될 필요가 있다. 또한, 많은 기술들이 인공지능 모델을 이용하여 빠르고 쉽게 수행되는 추세에서 학습 데이터의 질을 보장하기 위한 기술이 요구되는 실정이다."}
{"patent_id": "10-2023-0101569", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명의 목적은 학습 데이터의 개인차를 극복하고, 머신러닝의 과적합(overfitting)이 되는 단점을 최소화할 수 있는 양질의 학습데이터를 구축하는 전자장치 및 방법을 제공하는 것이다."}
{"patent_id": "10-2023-0101569", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명의 일 실시예에 따른 캡슐내시경 영상을 이용하여 인공지능 모델의 학습 데이터를 구축하는 전자장치에 있어서, 복수의 영상 프레임들로 이루어진 캡슐내시경 영상의 각 영상 프레임을 비병변 영상 또는 병변 영상으 로 분류하고, 분류된 복수의 비병변 영상들 및 출혈 영상, 염증성 영상, 혈관성 영상 및 용종성 영상 중 어느 하나의 영상으로 분류된 복수의 병변 영상들 중 잘못 분류된 오류 영상을 식별하고, 상기 복수의 병변 영상들 중 상기 오류 영상을 제외한 나머지 복수의 병변 영상들을 각 병변 별로 생성된 폴더에 분류하여 상기 학습 데 이터를 구축하는 프로세서를 포함한다. 상기 프로세서는, 상기 복수의 병변 영상들의 오류 여부에 대해 수신한 사용자 입력에 기초하여 상기 오류 영상 을 식별할 수 있다.상기 프로세서는, 상기 복수의 비병변 영상들 및 상기 복수의 병변 영상들 중 잘못 분류된 오류 영상을 식별하 도록 생성된 사용자 인터페이스를 통해 상기 사용자 입력을 수신할 수 있다. 상기 프로세서는, 복수의 병변 영상들을 출혈 영상, 염증성 영상, 혈관성 영상 및 용종성 영상 별로 나열하고, 상기 사용자 인터페이스를 통해 상기 나열된 복수의 병변 영상들 중에서 상기 오류 영상을 선택하는 사용자 입 력을 수신할 수 있다. 상기 프로세서는, 상기 병변 영상 별 분류를 각각 선택할 수 있는 상기 사용자 인터페이스를 제공하고, 상기 사 용자 인터페이스를 통해 수신한 사용자 입력에 따라 각 병변 영상의 오류 여부를 확인할 수 있다. 상기 프로세서는, 상기 나머지 복수의 병변 영상들이 상기 각 폴더에 균등하게 분류되도록 하여 상기 학습 데이 터를 구축할 수 있다. 상기 프로세서는, 입력되는 캡슐내시경 영상이 비병변 영상인지 병변 영상인지 분류하도록 학습된 제1인공지능 모델에 기초하여 상기 각 영상 프레임을 비병변 영상 또는 병변 영상으로 분류할 수 있다. 본 발명의 일 실시예에 따른 전자장치에 의해 수행되는 캡슐내시경 영상을 이용하여 인공지능 모델의 학습 데이 터를 구축하는 방법에 있어서, 복수의 영상 프레임들로 이루어진 캡슐내시경 영상의 각 영상 프레임을 비병변 영상 또는 병변 영상으로 분류하는 단계; 분류된 복수의 비병변 영상들 및 출혈 영상, 염증성 영상, 혈관성 영 상 및 용종성 영상 중 어느 하나의 영상으로 분류된 복수의 병변 영상들 중 잘못 분류된 오류 영상을 식별하는 단계; 상기 복수의 병변 영상들 중 상기 오류 영상을 제외한 나머지 복수의 병변 영상들을 각 병변 별로 생성된 폴더에 분류하여 상기 학습 데이터를 구축하는 단계를 포함한다. 상기 오류 영상을 식별하는 단계는, 상기 복수의 병변 영상들의 오류 여부에 대해 수신한 사용자 입력에 기초하 여 상기 오류 영상을 식별하는 단계를 포함할 수 있다. 상기 잘못 분류된 오류 영상을 식별하는 단계는, 상기 복수의 비병변 영상들 및 상기 복수의 병변 영상들 중 잘 못 분류된 오류 영상을 식별하도록 생성된 사용자 인터페이스를 통해 상기 사용자 입력을 수신하는 단계를 포함 할 수 있다. 상기 잘못 분류된 오류 영상을 식별하는 단계는, 복수의 병변 영상들을 출혈 영상, 염증성 영상, 혈관성 영상 및 용종성 영상 별로 나열하는 단계; 상기 사용자 인터페이스를 통해 상기 나열된 복수의 병변 영상들 중에서 상기 오류 영상을 선택하는 사용자 입력을 수신하는 단계를 포함할 수 있다. 상기 잘못 분류된 오류 영상을 식별하는 단계는, 상기 병변 영상 별 분류를 각각 선택할 수 있는 상기 사용자 인터페이스를 제공하는 단계; 상기 사용자 인터페이스를 통해 수신한 사용자 입력에 따라 각 병변 영상의 오류 여부를 확인하는 단계를 포함할 수 있다. 상기 학습 데이터를 구축하는 단계는, 상기 나머지 복수의 병변 영상들이 상기 각 폴더에 균등하게 분류되도록 하여 상기 학습 데이터를 구축하는 단계를 포함할 수 있다. 상기 각 영상 프레임을 비병변 영상 또는 병변 영상으로 분류하는 단계는, 입력되는 캡슐내시경 영상이 비병변 영상인지 병변 영상인지 분류하도록 학습된 제1인공지능 모델에 기초하여 상기 각 영상 프레임을 비병변 영상 또는 병변 영상으로 분류하는 단계를 포함할 수 있다."}
{"patent_id": "10-2023-0101569", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명의 일 실시예에 따르면, 인공지능 모델의 학습 데이터의 개인차를 극복하고, 머신러닝의 과적합 (overfitting)이 되는 단점을 최소화할 수 있으며, 양질의 학습자료를 만드는 데 시간과 노력을 줄여주는 바 효 율적이다. 본 발명의 일 실시예에 따르면, 많은 인공지능 모델의 학습 데이터를 구축하는데 필요한 도구로 널리 유용하게 쓰일 수 있으며, 상용화할 수 있는 인공지능 모델 개발에 큰 도움이 될 수 있다."}
{"patent_id": "10-2023-0101569", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하, 본 발명에 따른 바람직한 실시 형태를 첨부된 도면을 참조하여 상세하게 설명한다. 첨부된 도면과 함께 이하에 개시될 상세한 설명은 본 발명의 예시적인 실시형태를 설명하고자 하는 것이며, 본 발명이 실시될 수 있 는 유일한 실시형태를 나타내고자 하는 것이 아니다. 도면에서 본 발명을 명확하게 설명하기 위해서 설명과 관 계없는 부분은 생략할 수 있고, 명세서 전체를 통하여 동일 또는 유사한 구성 요소에 대해서는 동일한 참조 부 호를 사용할 수 있다. 도 1은 본 발명의 일 실시예에 따른 학습 데이터를 구축하는 과정을 도시한 개략도이다. 도 1을 참조하면, 본 발명의 일 실시예에 따른 전자장치는 입력되는 캡슐내시경 영상(pill cam)을 이 용하여 인공지능 모델의 학습 데이터를 구축하는 장치로, 컴퓨터, 서버 등으로 구현될 수 있다. 본 발명의 일 실시예에 따른 캡슐내시경 영상은 입에서 항문까지 전위장관 점막을 촬영한 영상이다. 캡슐내 시경 영상은 소형 카메라가 내장된 알약 크기의 캡슐을 환자가 삼키면, 캡슐이 환자의 입에서 항문까지 소 화기관을 따라 이동하면서 소화기관 내부를 촬영하여 획득될 수 있다. 이때, 전자장치는 캡슐에 내장된 무선 통신 모듈을 통해 캡슐내시경 영상을 바로 수신할 수 있으며, 다만 이에 한정되지 않고 캡슐과 무선 통신하여 영상을 획득하는 서버 등 외부 장치를 통해 수신할 수 있다. 이 하, 설명의 편의를 위해 캡슐내시경 영상은 외부장치로부터 수신하는 것으로 설명한다. 본 발명의 일 실시예에 따르면, 캡슐내시경 영상은 인공지능 모델의 학습 데이터로 아주 다양하게 활용될 수 있다. 인공지능 모델은, 예를 들어, 캡슐내시경 영상을 이용한 병변 검출 모델, 캡슐내시경 영상을 이용한 질병 예후 판단 모델 등일 수 있다. 이러한 인공지능 모델의 정확도를 높이기 위해서는 모델을 학습하는데 이용 되는 품질 높은 학습 데이터의 구축이 선행되어야 한다. 본 발명의 일 실시예에 따르면, 학습 데이터는 비병변 영상 및 병변 영상으로 이루어지며, 병변 영상 은 출혈 영상, 염증성 영상, 혈관성 영상, 용종성 영상으로 분류될 수 있다. 이때, 보다 높은 학습데이터의 질을 보장하기 위해, 각 영상들은 각 카테고리에 맞는 영상이어야 할 뿐 아니라, 각 영상들 간 비율 또한 균일하여야 한다. 한편, 캡슐내시경은 캡슐 내의 소형 카메라를 이용하여 한번 시술 시 5만 내지 10만 프레임의 영상이 획득된다. 따라서 방대한 양의 데이터를 처리하는 과정에서 영상을 분류하기 위해 기 생성된 인공지능 모델이 이용될 수 있다. 다만, 앞서 서술한 바와 같이, 기 생성된 인공지능 모델은 애초에 학습의 기초가 된 학습 데이터의 품질 이 높지 않기 때문에 영상 내 포함된 병변을 잘못 분류하거나, 병변의 분포가 균일하지 못할 수 있다. 따라서, 본 발명에서는 방대한 양을 처리하기 위해 1차적으로 병변을 분류하는 인공지능 모델을 이용하되, 분류 된 데이터를 2차적으로 검증하는 과정을 거쳐 보다 품질 높은 학습 데이터를 구축하는 방안을 제안한다. 이하, 도면들을 참조하여 본 발명의 일 실시예에 따른 전자장치의 구성 및 동작에 대해 구체적으로 설명한다. 도 2는 본 발명의 일 실시예에 따른 전자장치의 구성을 도시한 블럭도이다. 본 발명의 일 실시예에 따른 전자장치는 입력부, 통신부, 표시부, 메모리, 및 프로세 서를 포함한다. 입력부는 전자장치의 사용자 입력에 대응하여 입력데이터를 발생시킨다. 예를 들어, 사용자 입력은 전자장치의 동작을 시작하게 하는 사용자 입력, 복수의 병변 영상들 중 잘못 분류된 오류 영상을 선택하는 사용자 입력, 병변 영상 별 정상 분류, 병변 분류를 각각 선택하는 사용자 입력 등일 수 있으며, 이 외에도 보 다 품질 높은 학습 데이터를 구축하는데 필요한 사용자 입력인 경우 제한하지 않고 적용 가능하다. 입력부는 적어도 하나의 입력수단을 포함한다. 입력부는 키보드(key board), 키패드(key pad), 돔 스 위치(dome switch), 터치패널(touch panel), 터치 키(touch key), 마우스(mouse), 메뉴 버튼(menu button) 등을 포함할 수 있다. 통신부는 캡슐내시경 영상, 병변 분류를 위해 생성된 인공지능 모델 등을 수신하기 위해 캡슐, 서버 등 외 부장치와의 통신을 수행한다. 이를 위해, 통신부는 5G(5th generation communication), LTE-A(long term evolution-advanced), LTE(long term evolution), Wi-Fi(wireless fidelity), 블루투스(Bluetooth) 등의 무선 통신 혹은 LAN(local area network), WAN(Wide Area Network), 전력선 통신 등의 유선 통신을 수행할 수 있다. 표시부는 전자장치의 동작에 따른 표시 데이터를 표시한다. 표시부는 캡슐내시경 영상을 표시하 는 화면, 잘못 분류된 오류 영상을 식별하도록 생성된 사용자 인터페이스를 표시하는 화면, 폴더 별로 분류된 학습데이터를 표시하는 화면, 사용자 입력을 수신하기 위한 화면 등을 표시할 수 있다. 표시부는 액정 디스플레이(LCD; liquid crystal display), 발광 다이오드(LED; light emitting diode) 디 스플레이, 유기 발광 다이오드(OLED; organic LED) 디스플레이, 마이크로 전자기계 시스템(MEMS; micro electro mechanical systems) 디스플레이 및 전자 종이(electronic paper) 디스플레이를 포함한다. 표시부 는 입력부와 결합되어 터치 스크린(touch screen)으로 구현될 수 있다. 메모리는 전자장치의 동작 프로그램들을 저장한다. 메모리는 전원의 제공 유무와 무관하게 데이 터(정보)를 보존할 수 있는 비휘발성 속성의 스토리지(storage)와, 프로세서에 의해 처리되기 위한 데이터 가 로딩되며 전원이 제공되지 않으면 데이터를 보존할 수 없는 휘발성 속성의 메모리(memory)를 포함한다. 스토 리지에는 플래시메모리(flash-memory), HDD(hard-disc drive), SSD(solid-state drive) ROM(Read Only Memory) 등이 있으며, 메모리에는 버퍼(buffer), 램(RAM; Random Access Memory) 등이 있다. 메모리는 외부장치로부터 수신한 캡슐내시경 영상, 분류된 복수의 비병변 영상들, 병변 영상들, 오류 영상 들, 병변을 분류하기 위해 생성된 모델 등을 저장하거나, 캡슐내시경 영상을 복수의 영상 프레임들로 분할, 복 수의 영상 프레임들을 비병변 영상 또는 병변 영상으로 분류, 오류 영상 식별, 학습데이터 구축 등을 수행하는 과정에서 필요한 연산 프로그램 등을 저장할 수 있다. 프로세서는 프로그램 등 소프트웨어를 실행하여 전자장치의 적어도 하나의 다른 구성요소(예: 하드웨 어 또는 소프트웨어 구성요소)를 제어할 수 있고, 다양한 데이터 처리 또는 연산을 수행할 수 있다. 일 실시예 에 따르면, 프로세서는 중앙 처리 장치(CPU) 또는 어플리케이션 프로세서 역할을 수행하는 메인 프로세서 와 이와는 독립적으로 또는 함께 운영 가능한 그래픽 처리 장치(GPU)를 포함할 수 있다. 프로세서는 시간 순서에 따라 복수의 영상 프레임들로 이루어진 캡슐내시경 영상을 수신하여 각 영상 프레 임을 비병변 영상 또는 병변 영상으로 분류하고, 분류된 복수의 비병변 영상들 및 출혈 영상, 염증성 영상, 혈 관성 영상 및 용종성 영상 중 어느 하나의 영상으로 분류된 복수의 병변 영상들 중 잘못 분류된 오류 영상을 식 별하고, 상기 복수의 병변 영상들 중 상기 오류 영상을 제외한 나머지 복수의 병변 영상들을 각 병변 별로 생성 된 폴더에 분류하여 상기 학습 데이터를 구축한다. 이때, 프로세서는 각 영상 프레임을 비병변 영상 또는 병변 영상으로 분류하는 모델을 학습하거나, 기 학 습되어 생성된 모델을 외부로부터 수신 및 저장하여 이용할 수 있으며 어느 하나에 한정되는 것은 아니다. 한편, 프로세서는 상기 동작들을 수행하기 위한 데이터 분석, 처리, 및 결과 정보 생성 중 적어도 일부를 규칙 기반 또는 인공지능(Artificial Intelligence) 알고리즘으로서 기계학습, 신경망 네트워크(neural network), 또는 딥러닝 알고리즘 중 적어도 하나를 이용하여 수행할 수 있다. 신경망 네트워크의 예로는, DCNN(Deep Convolutional Neural Network), CNN (Convolutional Neural Network), DNN (Deep Neural Network), RNN (Recurrent Neural Network), GAN(Generative Adversarial Networks)과 같은 모델을 포괄적으로 포함할 수 있다. 도 3은 본 발명의 일 실시예에 따른 전자장치의 동작 흐름도를 도시한 도면이다. 본 발명의 일 실시예에 따르면, 프로세서는 복수의 영상 프레임들로 이루어진 캡슐내시경 영상의 각 영상 프레임을 비병변 영상 또는 병변 영상으로 분류한다(S10). 이때, 프로세서는 캡슐내시경 영상이 정지 영상인 경우 복수의 영상 프레임들을 외부장치로부터 수신할 수 있다. 반면, 캡슐내시경 영상이 동영상인 경우, 프로세서는 수신한 캡슐내시경 영상을 시간 순서에 따라 복수의 영상 프레임들로 분할하거나, 분할된 복수의 영상 프레임들을 외부장치로부터 수신할 수 있다. 본 발명의 일 실시예에 따르면, 프로세서는 입력되는 캡슐내시경 영상이 비병변 영상인지 병변 영상인지 분류하도록 학습된 제1인공지능 모델에 기초하여 각 영상 프레임을 비병변 영상 또는 병변 영상으로 분류할 수 있다. 이때, 제1인공지능 모델은 기존 학습데이터를 이용하여 생성된 모델로, 제1인공지능 모델은 추후 본 발명을 통 해 구축된 학습데이터를 이용하여 업데이트 될 수 있다. 또한, 제1인공지능 모델은 영상 분류를 위한 모델과 물 체 탐지를 위한 모델이 앙상블되어 생성될 수 있다. 예를 들어, 영상 분류를 위한 Timesformer 모델과 물체 탐 지를 위한 Faster R-CNN, YOLOv4 등이 앙상블 될 수 있다. 본 발명의 일 실시예에 따르면, 프로세서는 각 영상 프레임에 비병변 혹은 병변임을 라벨링하여 분류할 수 있다. 이때 병변인 경우 어느 병변에 해당하는지도 라벨링하여 분류할 수 있다. 본 발명의 일 실시예에 따르면, 비병변은 정상인 경우를 의미하며, 이외에도 병변이 아닌 경우, 예를 들어, 정 상 점막(Normal mucosa), 담즙(Bile predominant), 기포(Air bubbles), 조직파편(혹은 혼탁물, Debris) 등을 포함한다. 본 발명의 일 실시예에 따르면, 병변은 다음 표 1과 같이 분류될 수 있다. 본 발명에서 병변 영상은 크게 출혈 영상, 염증성 영상, 혈관성 영상 및 용종성 영상 중 어느 하나의 영상으로 분류하나, 표 1과 같이 보다 세부적 으로 분류할 수도 있을 것이다. 표 1 병변 분류 출혈 (Bleeding)A Bleeding blood red B blood black C Small blood clot 염증성 (Inflammatory)A erythema, edema, erosion, scar, etc B ulcer 혈관성 (Vascular)A vascular structure, venous distension, etc B angioectasia 용종성 (Polypoidal)A nodule, polyp, tumor, lymphangiectasia, xanthoma, ampulla of vater B cancer 본 발명의 일 실시예에 따르면, 프로세서는 분류된 복수의 비병변 영상들 및 출혈 영상, 염증성 영상, 혈 관성 영상 및 용종성 영상 중 어느 하나의 영상으로 분류된 복수의 병변 영상들 중 잘못 분류된 오류 영상을 식 별한다(S20). 본 발명의 일 실시예에 따르면, 분류된 복수의 비병변 영상들 및 분류된 복수의 병변 영상들은 앞서 획득한 복 수의 영상 프레임들을 분류하여 획득한 영상들이다. 본 발명에서는, 캡슐내시경 영상으로부터 획득한 복수의 영상 프레임을 비병변 영상, 병변 영상으로 1차적으로 분류한다. 앞서 서술한 바와 같이, 기 학습된 인공지능 모델을 이용하여 1차적으로 분류하는 경우, 인공지능 모 델의 성능, 즉 민감도나 특이도에 따라 그 분류의 정확도가 달라질 수 있다. 이를 보완하기 위해, 본 발명의 일 실시예에 따르면 분류된 복수의 비병변 영상들 및 복수의 병변 영상들 중 잘 못 분류된 영상(오류 영상)을 식별한다. 오류 영상이란, 비병변 영상임에도 병변 영상으로, 혹은 반대로 잘못 분류되거나, 병변 영상 중 용종성 영상임 에도 염증성 영상으로 잘못 분류되는 경우의 해당 영상을 의미한다. 본 발명의 일 실시예에 따르면, 프로세서는 복수의 병변 영상들의 오류 여부에 대해 수신한 사용자 입력에 기초하여 오류 영상을 식별할 수 있다. 이를 위해, 프로세서는 복수의 비병변 영상들 및 복수의 병변 영상들 중 잘못 분류된 오류 영상을 식별하 도록 생성된 사용자 인터페이스를 통해 사용자 입력을 수신할 수 있다. 오류 여부에 대한 사용자 입력을 수신하 기 위해 생성된 사용자 인터페이스 및 관련 동작은 도 4 및 도 5를 참조하여 설명한다. 본 발명의 일 실시예에 따르면, 프로세서는 복수의 병변 영상들 중 오류 영상을 제외한 나머지 복수의 병 변 영상들을 각 병변 별로 생성된 폴더에 분류하여 학습 데이터를 구축한다(S30).본 발명의 일 실시예에 따르면, 프로세서는 병변 별로 학습 데이터를 저장할 복수의 폴더를 생성하고, 나 머지 복수의 병변 영상들이 각 폴더에 균등하게 분류되도록 하여 학습 데이터를 구축할 수 있다. 본 발명의 일 실시예에 따르면, 2 단계에 걸쳐 학습 데이터를 구축하는 과정에서, 특성별 학습 데이터의 양은 표식되고 다양한 학습 데이터를 충분하고 비슷한 수로 구축할 수 있다. 프로세서는 분류된 나머지 복수의 병변 영상들을 한번에 내보낼 수 있는 바, 빠르고 효율적으로 작업을 수 행할 수 있다. 한편, 프로세서는 오류 영상에 대해 올바른 분류를 하여 병변 별로 생성된 폴더에 재분류하거나, 재분류하 기 애매한 영상들은 액티브 러닝(active learning) 알고리즘에 입력하여 다시 활용될 수 있도록 한다. 본 발명의 일 실시예에 따르면, 인공지능 모델의 학습 데이터의 개인차를 극복하고, 머신러닝의 과적합 (overfitting)이 되는 단점을 최소화할 수 있으며, 양질의 학습자료를 만드는 데 시간과 노력을 줄여주는 바 효 율적이다. 본 발명의 일 실시예에 따르면, 많은 인공지능 모델의 학습 데이터를 구축하는데 필요한 도구로 널리 유용하게 쓰일 수 있으며, 상용화할 수 있는 인공지능 모델 개발에 큰 도움이 될 수 있다. 도 4는 본 발명의 일 실시예에 따른 사용자 인터페이스를 도시한 도면이다. 도 4는 분류된 복수의 비병변 영상 및 복수의 병변 영상 중 오류 영상을 식별할 수 있는 사용자 인터페이스(제1 사용자 인터페이스라 한다.)를 포함하는 화면을 도시한다. 본 발명의 일 실시예에 따르면, 프로세서는 복수의 병변 영상들을 출혈 영상, 염증성 영상, 혈관성 영상 및 용종성 영상 별로 나열하고, 제1사용자 인터페이스를 통해 나열된 복수의 병변 영상들 중에서 오류 영상을 선택하는 사용자 입력을 수신할 수 있다. 도 4에 나열된 영상은 복수의 용종성 영상이라고 가정한다. 프로세서는 화면에 복수의 용종성 영상을 나열하고, 나열된 복수의 용종성 영상 중 오류 영상을 선택하는 사용자 입력을 수신하면 해당 오류 영상 을 제외시킬 수 있다. 본 발명의 일 실시예에 따르면, 인공지능 모델에 의해 1차적으로 분류된 캡슐 영상들을 보다 빠르게 2차 검증하 여 오류 영상을 식별할 수 있다. 도 5는 본 발명의 일 실시예에 따른 오류 영상 식별 과정을 도시한 도면이다. 도 5에서는 오류 영상을 식별하는 과정에 대해 구체적으로 살펴본다. 이때, 도 3을 참조하여 서술한 내용과 중 복되는 내용에 대해서는 구체적인 설명은 생략한다. 본 발명의 일 실시예에 따르면, 프로세서는 제1인공지능 모델을 이용하여 복수의 영상 프레임을 비병변 영 상 또는 병변 영상으로 분류할 수 있다(S510). 프로세서는 제1인공지능 모델을 이용하여 각 영상 프레임이 비병변 영상에 해당하는지 혹은 출혈 영상, 염 증성 영상, 혈관성 영상 및 용종성 영상 중 어느 하나의 병변 영상에 해당하는지 분류하여 라벨링할 수 있다. 프로세서는 단순히 비병변 혹은 병변임을 라벨링할 수 있으나 이에 한정되지 않으며, 보다 구체적으로 영 상 프레임을 정상 분류, 병변 분류에 대해 라벨링할 수 있다. 이때, 정상 분류는 정상, 음식물, 담즙, 버블, 파 편을 포함하고, 병변 분류는 출혈, 염증성, 혈관성, 용종성을 포함할 수 있다. 이때, 분류 항목이나 각 항목별 구체적인 내용은 본 예시에 한정되지 않는다. 또한, 프로세서는 각 분류 항목의 구체적인 내용에 숫자를 부여하고, 라벨링할 수 있다. 일 예로, 정상 분 류는 정상, 음식물, 담즙, 버블, 파편으로, 병변 분류는 출혈, 염증성, 혈관성, 용종 성로 라벨링할 수 있다. 그리고 각 분류의 어디에도 해당하지 않는 경우 0으로 라벨링할 수 있다. 해당 예시의 라벨링에 따라 어떤 영상 프레임이 혈액 내용물을 포함하는 출혈 영상으로 분류되는 경우, 프로세 서는 제1인공지능 모델을 이용하여 해당 영상 프레임을 라벨링할 수 있다. 그 다음, 프로세서는 복수의 영상 프레임을 비병변 영상 또는 병변 영상으로 분류하는 사용자 입력 수신할 수 있다(S520). 이는 1차적으로 제1인공지능 모델에 의해 분류된 영상을 2차적으로 검증하기 위함이다. 이를 위해 프로세서 는 각 영상 프레임 별로 분류 중 어디에 해당하는지 선택할 수 있는 사용자 인터페이스(제2사용자 인터페 이스라 한다.)를 제공할 수 있다. 프로세서는 제2사용자 인터페이스를 통해 분류를 선택하는 사용자 입력을 수신하면 각 분류 별로 숫자를 부여하여 출력하도록 설정할 수 있다. 그 다음, 프로세서는 제1인공지능 모델의 분류와 사용자 입력이 일치하는지 여부를 식별할 수 있다(S530). 일치하는 경우(S530의 Yes), 프로세서는 해당 영상 프레임을 각 병변 별로 생성된 폴더에 분류하여 학습 데이터를 구축할 수 있다(S540). 일 예로, 앞서 제1인공지능 모델이 라벨링한 영상 프레임에 대해 동일한 사용자 입력을 수신하는 경우, 프로세 서는 양자 분류 결과가 서로 일치하는 것으로 보고 영상을 구축하도록 생성된 폴더에 분류한다. 일치하지 않는 경우(S530의 No), 해당 영상 프레임을 학습 데이터에서 제외할 수 있다(S550). 즉, 프로세서 는 각 영상 프레임에 대해 제1인공지능 모델이 1차적으로 분류한 분류 결과와 사용자 입력에 따른 분류 결 과를 비교하여 일치하지 않는 경우, 해당 영상 프레임을 오류 영상으로 식별할 수 있다. 일 예로, 앞서 제1인공지능 모델이 2로 라벨링한 영상 프레임에 대해, 1의 사용자 입력을 수신하는 경우, 프로 세서는 양자 분류 결과가 서로 일치하지 않는 것으로 본다. 본 발명의 일 실시예에 따르면, 도 4와 같이 오류 영상을 식별할 수 있는 다른 방식을 제안할 수 있으며, 1차적 으로 분류된 영상을 재검증하여 보다 품질 높은 학습데이터를 구축할 수 있다."}
{"patent_id": "10-2023-0101569", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 일 실시예에 따른 학습 데이터를 구축하는 과정을 도시한 개략도이다. 도 2는 본 발명의 일 실시예에 따른 전자장치의 구성을 도시한 블럭도이다.도 3은 본 발명의 일 실시예에 따른 전자장치의 동작 흐름도를 도시한 도면이다. 도 4는 본 발명의 일 실시예에 따른 사용자 인터페이스를 도시한 도면이다. 도 5는 본 발명의 일 실시예에 따른 오류 영상 식별 과정을 도시한 도면이다."}
