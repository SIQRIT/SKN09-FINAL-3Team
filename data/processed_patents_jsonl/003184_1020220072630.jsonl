{"patent_id": "10-2022-0072630", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2023-0172154", "출원번호": "10-2022-0072630", "발명의 명칭": "인공지능을 이용한 이미지 객체를 분할 방법 및 장치", "출원인": "연세대학교 산학협력단", "발명자": "변혜란"}}
{"patent_id": "10-2022-0072630", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "분석장치가 적어도 하나의 객체를 포함하는 이미지를 획득하는 단계;상기 분석장치가 획득한 이미지를 분할모델에 입력하는 단계; 및상기 분석장치가 상기 분할모델이 출력하는 값을 이용하여 상기 획득한 이미지에서 객체를 분할하는 단계;를 포함하되상기 분할모델은학습데이터로 적어도 하나의 객체가 포함된 이미지를 이용하고, 그 학습방법으로 상기 학습데이터에서 객체의크기를 파악하고, 상기 파악된 객체의 크기에 따라 상기 객체를 이루는 픽셀의 가중치를 다르게 부여한 뒤, 상기 부여된 가중치를 고려하는 손실함수를(size-weighted loss function)을 이용하여 학습된 모델을 포함하는 인공지능을 이용한 이미지에서 객체 분할 방법."}
{"patent_id": "10-2022-0072630", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 픽셀의 가중치를 다르게 부여하는 방법은상기 파악된 객체의 상대적 크기가 크면 픽셀의 가중치를 높게 부여하고, 크기가 상대적 작으면 픽셀의 가중치를 낮게 부여하는 방법을 포함하는인공지능을 이용한 이미지에서 객체 분할 방법."}
{"patent_id": "10-2022-0072630", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1항에 있어서,인공지능을 이용한 이미지에서 객체 분할 방법. 가중치의 상한선을 설정하고 상기 상한선을 넘지 않도록 가중치를 부여하는 방법을 포함하는인공지능을 이용한 이미지에서 객체 분할 방법."}
{"patent_id": "10-2022-0072630", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "청구항1항에 있어서,상기 가중치를 고려하는 손실함수는 아래의 수학식의 Lsw을 이용하는 것을 포함하는인공지능을 이용한 이미지에서 객체 분할 방법. [수학식]공개특허 10-2023-0172154-3-H는 이미지의 크기, W는 이미지의 넓이, Yc,x,y는 해당 좌표에서의 클레스 레이블 값, Wx,y는 아래수식에 의하여계산된 해당 좌표에서의 가중치, Pc,x,y는 해당 좌표에서 픽셀이 클래스 c라고 예측될 확률x와y는 각각 픽셀의 x와y좌표, Yx,y는 x,y좌표에서의 클레스레이블, Sc,k는 클래스 c에 속하는 k번째의 인스턴스에 연결요소(connected components)의 픽셀의 개수, K는 해당 클레스에서의 인스턴스의 번호, 는 가중치의상한"}
{"patent_id": "10-2022-0072630", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제1항에 있어서상기 가중치를 고려한 손실함수를 이용하여 학습시키는 방법은상기 학습데이터 중 미리 설정된 기준보다 크기가 작은 객체를 포함하는 이미지를 학습데이터로 하여 학습모델을 먼저 학습시키는 단계; 및 상기 학습된 모델에 상기 학습데이터 중 미리 설정된 기준보다 크기가 큰 객체를 포함하는 이미지를 학습데이터로 하여 연속학습방법으로 학습시켜 최종 학습모델을 만드는 단계;를 포함하는.인공지능을 이용한 이미지에서 객체 분할 방법."}
{"patent_id": "10-2022-0072630", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제1항에 있어서, 상기 이미지에서 객체를 분할하는 단계 이후,상기 분석장치가 상기 분할모델의 성능을 평가하는 단계를 더 포함하는인공지능을 이용한 이미지에서 객체 분할 방법."}
{"patent_id": "10-2022-0072630", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제6항에 있어서상기 분할모델의 성능을 평가하는 단계는 적어도 하나의 객체를 포함하는 이미지에서 클래스(class)와 상기 클래스에 속하는 객체들을 인식하는 단계;상기 객체마다의 IoU(Intersection Over Union)을 계산하여 객체단위IoU 값을 산출한 값을 이용하여 평가하는단계를 포함하는인공지능을 이용한 이미지에서 객체 분할 방법."}
{"patent_id": "10-2022-0072630", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제6항에 있어서상기 분할모델의 성능을 평가하는 단계는아래의 수학식의 IA-mIoU(Instance aware mean Intersection over union)값을 이용하는 것을 포함하는공개특허 10-2023-0172154-4-인공지능을 이용한 이미지에서 객체 분할 방법. [수학식]c는 클래스, i는 클래스내에서 객체의 번호, T는 클래스내부의 객체의 총 개수, PrC,i은 c클래스내에서 i번째의객체의 예측 마스크(Prediction Mask 값), GTc,i는 c 클래스내에서 i번째의 객체의 그라운드-트루스 마스크(Ground-truth Mask) IoUC,i는 클래스 c에서 i번째 객체의 IoU값, Io^Uc 는 클래스 c에서 상기 IoUC,i의 평균값, IA-mIoU는 이미지상모든 클래스의 Io^Uc 의 평균"}
{"patent_id": "10-2022-0072630", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "적어도 하나의 객체를 포함하는 이미지를 획득하는 입력장치;상기 입력장치가 획득한 이미지에서 객체를 분할시키는 분할모델을 저장하는 저장장치; 상기 입력장치가 획득한 이미지를 분할모델에 입력하여 분할모델이 출력한 값을 기준으로 상기 이미지에서 객체를 분할시키는 연산장치;를 포함하되상기 분할모델은 학습데이터로 적어도 하나의 객체가 포함된 이미지를 이용하고, 그 학습방법으로 상기 학습데이터에서 객체의크기를 파악하고, 상기 파악된 객체의 크기에 따라 상기 객체를 이루는 픽셀의 가중치를 다르게 부여한 뒤, 상기 부여된 가중치를 고려하는 손실함수를(size-weighted loss function)을 이용하여 학습된 모델을 포함하는 인공지능을 이용한 이미지에서 객체 분할 장치"}
{"patent_id": "10-2022-0072630", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "인공지능을 이용한 이미지 객체 분할 방은 분석장치가 적어도 하나의 객체를 포함하는 이미지를 획득하는 단계; 상기 분석장치가 획득한 이미지를 분할모델에 입력하는 단계; 및 상기 분석장치가 상기 분할모델이 출력하는 값 을 이용하여 상기 획득한 이미지에서 객체를 분할하는 단계;를 포함하되 상기 분할모델은 학습데이터로 적어도 하나의 객체가 포함된 이미지를 이용하고, 그 학습방법으로 상기 학습데이터에서 객체의 크기를 파악하고, 상기 파악된 객체의 크기에 따라 상기 객체를 이루는 픽셀의 가중치를 다르게 부여한 뒤, 부여된 가중치를 고려한 손 실함수를(size-weighted loss function)을 이용하여 학습된 모델을 포함하는 것을 포함한다."}
{"patent_id": "10-2022-0072630", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "이하 설명하는 기술은 이미지에서 상대적으로 크기가 작은 객체도 파악하여 학습시킴으로써 크기가 작은 물체 도 분할하도록 하는 분할모델과과 분할모델이 작은객체를 얼마나 탐지하는지도 고려한 평가방법에 대한 것이다"}
{"patent_id": "10-2022-0072630", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "컴퓨터가 이미지상에서 물체를 인식하는 기술을 분할(segmenation)이라고 한다. 분할을 통하여 이미지상에서 픽셀이 어떤 객체나 클래스를 의미하는지 알려준다. 항공분야, 의료진단분야, 무인자동차분야, 사람인식분야등의 기술에서 분할은 중요한 기술중에 하나이며, 연구 가 활발이 진행되고 있다. 최근에는 이미지상에서 물체를 인식하기 위해서 인공지능 모델을 이용하는 경우가 많 아지고 있다. 선행기술문헌 특허문헌 (특허문헌 0001) 한국 특허출원 : 10-2020-7002482"}
{"patent_id": "10-2022-0072630", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "이미지로부터 물체를 분할하는 분할모델은 이미지에서 픽셀이 어떠한 객체에 속하는지 예측하고 정답과 비교하 는 방법으로 학습한다. 종래 학습방법은 이미지상 모든 픽셀을 동등하게 취급한다. 따라서 분할모델은 이미지에 서 많은 픽셀을 차지하는 객체를 분할할 수 있으나, 크기가 픽셀이 적은 객체는 분할하기 어렵다.. 분할모델은 크기가 큰 물체를 탐지해야 학습에 더 유리하기 때문이다. 또한 기존에 분할모델을 평가하기 위하여 이용된 mIoU(mean intersection-over-union)는 이미지상 각 객체의 크 기를 전혀 고려하지 못하는 문제점이 있엇다. 즉 상대적으로 크기가 큰 물체를 분할하는지만 고려하고, 작은 물 체를 분할하지는지 여부는 고려하지 아니하였다. 이하 설명하는 기술은 이미지상 객체의 크기에 따라 픽셀에 가중치를 부여한 손실함수(size-weighted loss function)를 이용하여 분할모델을 학습시킴으로써 분할모델이 크기가 작은 물체도 탐지하고 분할 할 수 있게 해 주며, 객체단위로 IoU을 계산하는 IA-mIoU(Instance-aware mean Intersection-over-union)방식의 평가방법을 제시함으로써, 분할모델이 크기가 작은 물체도 탐지하는 여부도 고려하여 분할모델을 평가할 수 있게 한다."}
{"patent_id": "10-2022-0072630", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "인공지능을 이용한 이미지 객체 분할 방은 분석장치가 적어도 하나의 객체를 포함하는 이미지를 획득하는 단계; 상기 분석장치가 획득한 이미지를 분할모델에 입력하는 단계; 및 상기 분석장치가 상기 분할모델이 출력하는 값 을 이용하여 상기 획득한 이미지에서 객체를 분할하는 단계;를 포함하되 상기 분할모델은 학습데이터로 적어도 하나의 객체가 포함된 이미지를 이용하고, 그 학습방법으로 상기 학습데이터에서 객체의 크기를 파악하고, 상기 파악된 객체의 크기에 따라 상기 객체를 이루는 픽셀의 가중치를 다르게 부여한 뒤, 부여된 가중치를 고려한 손 실함수를(size-weighted loss function)을 이용하여 학습된 모델을 포함하는 것을 포함한다."}
{"patent_id": "10-2022-0072630", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "이하 설명하는 기술을 이용하면 큰 물체뿐만 아니라 작은 물체도 탐지할 수 있는 분할모델을 만들 수 있으며, 분할모델을 평가할 때 작은 물체도 탐지하고 분할하는지 여부도 고려하여 평가할 수 있다."}
{"patent_id": "10-2022-0072630", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하 설명하는 기술은 다양한 변경을 가할 수 있고 여러 가지 실시예를 가질 수 있는 바, 특정 실시예들을 도면 에 예시하고 상세하게 설명하고자 한다. 그러나, 이는 이하 설명하는 기술을 특정한 실시 형태에 대해 한정하려 는 것이 아니며, 이하 설명하는 기술의 사상 및 기술 범위에 포함되는 모든 변경, 균등물 내지 대체물을 포함하 는 것으로 이해되어야 한다. 제1, 제2, A, B 등의 용어는 다양한 구성요소들을 설명하는데 사용될 수 있지만, 해당 구성요소들은 상기 용어 들에 의해 한정되지는 않으며, 단지 하나의 구성요소를 다른 구성요소로부터 구별하는 목적으로만 사용된다. 예 를 들어, 이하 설명하는 기술의 권리 범위를 벗어나지 않으면서 제1 구성요소는 제2 구성요소로 명명될 수 있고, 유사하게 제2 구성요소도 제1 구성요소로 명명될 수 있다. 및/또는 이라는 용어는 복수의 관련된 기재된 항목들의 조합 또는 복수의 관련된 기재된 항목들 중의 어느 항목을 포함한다. 본 명세서에서 사용되는 용어에서 단수의 표현은 문맥상 명백하게 다르게 해석되지 않는 한 복수의 표현을 포함 하는 것으로 이해되어야 하고, \"포함한다\" 등의 용어는 설시된 특징, 개수, 단계, 동작, 구성요소, 부분품 또는 이들을 조합한 것이 존재함을 의미하는 것이지, 하나 또는 그 이상의 다른 특징들이나 개수, 단계 동작 구성요 소, 부분품 또는 이들을 조합한 것들의 존재 또는 부가 가능성을 배제하지 않는 것으로 이해되어야 한다. 도면에 대한 상세한 설명을 하기에 앞서, 본 명세서에서의 구성부들에 대한 구분은 각 구성부가 담당하는 주기 능 별로 구분한 것에 불과함을 명확히 하고자 한다. 즉, 이하에서 설명할 2개 이상의 구성부가 하나의 구성부로 합쳐지거나 또는 하나의 구성부가 보다 세분화된 기능별로 2개 이상으로 분화되어 구비될 수도 있다. 그리고 이 하에서 설명할 구성부 각각은 자신이 담당하는 주기능 이외에도 다른 구성부가 담당하는 기능 중 일부 또는 전 부의 기능을 추가적으로 수행할 수도 있으며, 구성부 각각이 담당하는 주기능 중 일부 기능이 다른 구성부에 의 해 전담되어 수행될 수도 있음은 물론이다. 또, 방법 또는 동작 방법을 수행함에 있어서, 상기 방법을 이루는 각 과정들은 문맥상 명백하게 특정 순서를 기 재하지 않은 이상 명기된 순서와 다르게 일어날 수 있다. 즉, 각 과정들은 명기된 순서와 동일하게 일어날 수도 있고 실질적으로 동시에 수행될 수도 있으며 반대의 순서대로 수행될 수도 있다. 이하 설명하는 기술을 설명하는데 앞서 필요한 용어에 대해 설명한다. 이하 설명하는 발명에서 분할(segmentation)은 이미지상에서 객체들을 분리하는 것을 포함한다. 이하 설명하는 발명에서 의미론적 분할(semantic segmentation) 이란 분할의 한 방법으로 이미지상에 있는 모든 픽셀에 대하여 의미있는 단위로 분할하는 방법을 포함한다. 주로 클래스(class)별로 분할 할 수 있다. 이하 설명하는 발명에서 인스턴스 분할(instance segmentation) 이란 분할의 한 방법으로 이미지상에서 객체마 다 찾아낸 bounding box을 기준으로 하여 그 안에 하나의 객체가 있는지 탐지하여 분류하는 방법을 포함한다. 이하 설명하는 발명에서 IoU(Intersection over union)는 분할모델의 성능을 평가하는 과정에서 사용되는 도구 이다. IoU의 값이 높을수록 모델이 객체를 탐지하는 성능이 높다는 것을 보여준다. 이하 설명하는 발명에서 mIoU(mean Intersection over union)는 분할모델의 성능을 평가하는 과정에서 사용되는 도구로, 클래스별로 계산된 IoU결과의 평균을 나타내는 값을 말한다. 이하 설명하는 발명에서 예측 마스크(Prediction mask)란 분할모델이 이미지내에서 객체를 분할하여 예측한 값 을 포함한다. 이하 설명하는 발명에서 그라운드-트루스 마스크(Ground-truth mask)란 이미지내에서 실제 객체가 위치하고 있 는 값을 포함한다. 이하 설명하는 기술에서 학습모델이란 기계학습(merchine learning) 모델을 말하며, 기계 학습모델은 다양한 유 형의 모델을 포함할 수 있다. 예컨데 기계 학습모델은 결정 트리, RF(random forest), KNN(K-nearest neighbor), 나이브 베이즈(Naive Bayes), SVM(support vector machine), ANN(artificial neural network) 등이 포함될 수도 있다. 상기 ANN은 DNN(Deep Neural Network)가 될 수 있으며, 이는 CNN(Convolutional Neural Network), RNN(Recurrent Neural Network), RBM(Restricted Boltzmann Machine), DBN(Deep Belief Network) 및 GAN(Generative Adversarial Network), RL(Relation Networks) 을 포함할 수 있다. 상기 CNN모델은 컨볼루션 층(Convolution layer), 풀링 층(Pooling layer), 드랍 층(Drop layer), 평탄화 층 (Flatten layer)와 완전한 연결 층(fully connected layer, 또는 dense layer)을 포함할 수 있다. 상기 컨볼루션 층(Convolution layer)은 입력된 정보에서 특징을 추출하고 이로 부터 특성 맵(feature map)을 만든다. 상기 풀링 층(Pooling layer)은 컨볼루션층에서 만든 특성맵의 크기를 줄이거나 특정 데이터를 강조하 기 위하여 특징 맵의 값중 가장 큰 값을 추출하거나(맥스 풀링 층, Max Pooling layer) 평균 값을 추출한다(평 균 풀링 층, Average Pooling Layer). 상기 드랍 층(Drop layer)은 딥 러닝 모델에서 과적합(Overfitting)을 방지하기 위하여 훈련과정 중에 신경망모델의 일부분만 이용한다. 상기 플래튼 층(Flatten layer)은 추출한 데 이터의 특징을 하나의 차원으로 만든다. 상기 완전한 연결 층은(fully connected layer)는 각 layer의 노드 (node) 모두 연결해주며, 최종적으로 입력데이터가 어떤 분류에 속하는 것인지 판단한다. 이 과정에서 SoftMAX 함수가 이용될 수도 있다. 이하 설명하는 기술에서 연속학습(continual learning)이란 평생학습, 점진적 학습과 같은 말로서 기존의 학습 데이터로 훈련된 모델에서 학습되지 않은 새로운 데이터가 연속적으로 들어오더라도 기존의 모델을 완전히 새로 학습시키지 않고 들어오는 새로운 데이터를 이용하여 순차적으로 학습하여 모델을 업데이트 시키는 방법을 포함 할 수 있다. 이를 통해 새로운 데이터에 대해서도 실시간으로 대응할 수 있다. 상기 연속학습하는 방법으로는 EWC(Elastic weight consolidation), Generative replay, Dynamic expandable network 및 Synaptic intelligence 중 적어도 하나가 포함될 수 있다."}
{"patent_id": "10-2022-0072630", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "이하 도1을 통하여 분석장치가 이미지에서 객체를 탐지하고 분할하는 전체적인 과정에 대해 설명한다. 도1은 이미지로부터 객체를 분할하는 전체적인 과정에 대해 도시한 것이다. 도1의 분석장치는 입력장치을 통하여 분석 대상 이미지를 획득한다. 상기 분석장치는 상기 획득 한 이미지를 분할모델에 입력한다. 상기 분석장치는 상기 분할모델이 출력한 값을 이용하여 상기 획득한 이미지에서 객체를 분할 할 수 있다. 상기 분석장치는 상기 결과를 출력장치을 통하여 출력할 수 있 다. 도1에서 입력장치를 통해 획득하는 이미지는 분할하고자 하는 객체를 포함한다. 상기 객체는 적어도 하나 이상일 수 있다. 상기 객체는 적어도 하나 이상의 종류(또는 클래스)를 가지는 객체를 포함할 수도 있다. 상기 객체는 여러 크기를 가지는 객체를 포함할 수도 있다. 도1에서 분석장치가 분석에 이용하는 분할모델은 이미지로부터 객체를 탐지하고 분할하는 모델을 포함한다. 상기 분할모델은 적어도 하나의 객체가 포함된 이미지를 이용하여 객체를 분할하도록 학습된 학습모델일 수도 있다. 상기 분할모델은 기존의 모델과는 달리 이미지상에서 크기가 작은 객체도 분할하도록 훈련된 모델일 수도 있다. 이를 위하여 각 픽셀마다 가중치가 부여된 손실함수(Size-Weighted loss function, Lsw)을 이용하여 훈련된 모 델일 수도 있다. 그 구체적인 내용은 아래에서 설명한다. 상기 분할모델은 가중치가 부여된 손실함수(Lsw)를 이용하여 훈련한뒤, 다시 연속훈련한 균형된 손실함수(size- balanced loss function, Lsb)을 이용하여 훈련된 모델일 수도 있다. 그 구체적인 내용은 아래에서 설명한다. 도1에서 출력장치을 통해 출력되는 결과값은 이미지내에서 객체를 분할한 결과를 나타낸다. 상기 결과값은 객체를 나타내는 픽셀이 어떤 객체 또는 어떤 클래스를 나타내는지에 대한 값을 포함할 수도 있 다. 상기 결과값은 객체마다 어떤 클래스에 몇번째 객체에 속하는지 나타내는 값을 포함할 수도 있다. 상기 결과값은 객체마다 서로 다른 색상으로 표시한 결과를 포함할 수도 있다. 도1에서 평가장치는 출력값을 통해 출력되는 결과값을 통하여 해당 상기 분석장치의 분할모델의 성능을 평 가한다. 상기 분할모델을 평가하기 위한 지표로서IA-mIoU(Instance-aware mean Intersection-over-union)가 이용될 수 도 있다. 그 구체적인 내용은 아래에서 설명한다. 이하 본 발명의 실시 예에 따른 분할모델을 학습시키는 과정에 대하여 설명한다. 도2는 분할모델을 학습시키는 과정에 대하여 도시한 것이다. 학습시키는 상기 분할모델을 학습시키는 과정은 크 게 이미지상에서 객체를 탐지하는 단계(S210), 탐지된 객체를 이루는 픽셀마다의 가중치를 부여하는 단계 (S220), 계산된 가중치를 고려한 손실함수을 도출하는 단계(S230), 도출된 손실함수를 이용하여 분할모델을 학 습시키는 단계(S240)을 포함한다. 도2에서 이미지상에서 객체를 탐지하는 단계에 대해 설명한다(S210). 이미지에서 객체를 탐지할 때 Instance 그 라운드-트루스 마스크를 훈련에 이용할 수 없기 떄문에, 먼저 pseudo 그라운드-트루스 마스크를 이용해서 각 클 래스마다의 연결요소(conncted components)을 찾아낸다. 이렇게 찾아낸 c번째 클래스에서 k번째의 연결요소를 Ic,k라고 정의한다. 도3는 학습시 이미지상에서 객체를 탐지한 실시예 중에 하나이다. 도3에서 I6,1는 6번째 클래스(버스)에서 1번째 연결요소를 말하며, I15,2은 15번째 클래스(사람)에서 2번째 연결요소를 말한다. 도2에서 탐지된 객체를 이루는 픽셀을 객체의 크기에 따라 가중치를 부여하는 단계에 대하여 설명한다(S220). 아래의 수학식1은 객체를 이루는 픽셀에 대한 가중치를 부여하는 식을 나타낸 것이다. 수학식 1"}
{"patent_id": "10-2022-0072630", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "상기 수학식1에서 x와y는 픽셀의 x와y좌표, Yx,y는 x,y좌표에서 각 픽셀이 속하는 클레스의 레이블, c는 클래스 의 번호, k는 클래스에서 해당 객체의 번호, K는 해당 클래스에서 전체 객체의 개수, Sc,k는 상기 Ic,k을 구성하 는 픽셀의 개수, τ는 가중치의 상한을 의미할 수 있다.수학식1을 통하여 하나의 클래스에서 픽셀이 속하는 객체의 상대적인 크기에 따라 상기 픽셀에 다른 가중치를 부여할 수 있다. 하나의 클래스에서 객체의 상대적인 크기가 크다면 낮은 가중치, 객체의 상대적인 크기가 작다 면 높은 가중치를 부여할 수 있다. 예를 들어 도3에서 사람이라는 클래스에서 I15, 2객체는 I15,1객체보다 크기가 작으므로 I15,1보다 상대적으로 높은 가중치를 부여 받는다. 반대로 I15,1은 크기가 I15,2보다 크기에 I15,2보다 상대적으로 낮은 가중치를 부여받는다. 버스라는 클래스에서 객체는 I6,1만 존재하기 떄문에 비교대상이 없어 1의 가중치를 부여 받는다. 위와 같은 방법을 통하여, 분할모델은 전체이미지에서 크기가 작은 객체(작은 픽셀을 가지는) 객체의 특징을 효 과적으로 검출할 수 있도록 가중치가 설정될 수 있다. 또한, 수학식1은 픽셀이 가질 수 있는 가중치에 상한(τ)을 지정해 둠으로써, 상대적으로 크기가 작은 객체의 픽셀 가중치가 무제한적으로 커지는 것을 방지할 수도 있다. 도2에서 픽셀별 가중치를 고려한 손실함수(Size-weighted loss function, Lsw)를 도출하는 단계에 대해 설명한 다(S230) 아래의 수학식2은 상기 수학식1에 의하여 도출된 가중치를 고려한 손실함수(Size-weighted loss function, Lsw) 를 나타낸 것이다. 수학식 2"}
{"patent_id": "10-2022-0072630", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "상기 수학식2에서 H는 이미지의 높이, W는 이미지의 넓이, Yc,x,y는 해당 픽셀이 클레스의 레이블, Wx,y는 해당 픽 셀에서 수학식1에 의해 계산된 해당 픽셀의 가중치, Pc,x,y는 해당 좌표에서 픽셀이 클래스 c라고 예측될 확률을 의미할 수 있다. 상기 손실함수(LSW)는 수학식1에서 도출된 가중치를 고려할 수 있다 따라서 작은 픽셀을 가지는 물체도 높은 가 중치가 부여되어 학습시 고려될 수 있다. 상기 손실함수(LSW)를 이용하여 학습모델을 훈련시키면 이미지상에서 상대적으로 작은 객체도 탐지할 수 있다. 이하 분할모델을 연속학습하는 과정에 대해 설명한다. 상기 연속학습은 먼저 학습데이터 중에서 크기가 큰 객체를 포함하는 이미지를 이용하여 분할모델을 학습시킨 후, 크기가 작은 객체를 포함하는 이미지를 이용해서 분할모델을 연속학습 시킬 수 있다. 상기 크기가 큰지 작은지는 일정한 기준에 따라 미리 정해놓을 수 있다. 예를 들어 전체 이미지에서 객체가 차 지하는 픽셀이 60%이상이면 큰 객체를 포함하는 이미지 , 60%이하라고 하면 작은 작은 객체를 포함하는 이미지 라고 정할 수도 있다. 상기 분할모델을 연속학습시킴으로써, 상기 분할모델이 이미지에서 크기가 작은 객체만 분할하도록 훈련하는 것 을 방지하여 크기가 큰 객체, 크키가 객체를 균형있게 분할할 수 있게 한다. 상기 연속학습하는 방법으로는 EWC(Elastic weight consolidation), Generative replay, Dynamic expandable network 및 Synaptic intelligence 중 적어도 하나가 포함될 수 있다. 아래의 수학식3은 EWC하는데 이용되는 손실함수(Sized-Balanced loss function, LSB)를 나타낸 것이다. 수학식 3"}
{"patent_id": "10-2022-0072630", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 5, "content": "수학식3에서 i 는 현재의 i번쨰의 파라미터 값, A,I는 EWC학습하기 전 i번쨰의 파라미터 값, F는 Fisher information matrix를, *는 과거 데이터에 대한 중요도를 나타내는 변수, Lsw는 픽셀별 가중치가 고려된 손 실함수를 의미할 수 있다. 상기 EWC에 의한 연속학습은 크게 2개로 나뉠 수 있다. 첫번째 과정은 기존의 픽셀 와이즈 크로스 엔트로피 (pixel wise cross entropy) 손실함수를 이용하여 Fisher information matrix안의 중요한 파라미터 값을 업데 이트 한다. 이후 가중치가 부여된 손실함수(LSW)을 이용해서 미세조정하여 상기 matrix의 중요한 파라미터값을 정규화(regularize)한다. 위 과정을 통하여 상기 사이즈 균형에 맞는 손실함수(Sized-balanced loss function, Lsb)을 만들 수 있다. 이하 분할모델의 성능을 평가하는 방법에 대해 설명한다. 도4는 분할모델의 성능을 평가하는 위한 방법을 비교한 것이다. 도4에서 검정색 네모상자는 객체가 실제 위치하는 픽셀인 그라운드-트루스 마스크를 나타내며, 색깔이 칠해져 있는 픽셀은 분할모델이 객체가 위치할것으로 예상한 예측 마스크 을 나타낸다. 도4에서 (A)는 종래에 분할모델을 평가하는 방법에 대해 도시한 것이다. 수학식4은 종래의 평가방식에 이용되는 IoU와 mIoU 에 대한 식이다. 수학식 4"}
{"patent_id": "10-2022-0072630", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 6, "content": "상기 식에서 c는 클래스, N은 클래스의 총 개수, PrC는 해당 c 클래스에서의 예측 마스크 값, GTC는 c클래스에서 의 그라운드-트루스 마스크 값, IoUc는 해당 c클래스에서의 IoU값, mIoU는 이미지상에서 클래스의 IoU 의 평균 을 의미할 수 있다. 기존 mIoU을 이용한 방식은 클래스 각각에 대하여 IoU 를 구한 뒤, 전체 클래스에 대한 IoU 의 평균을 계산하여 mIoU 을 구한다. 즉. 하나의 클래스에 대해서 분모에 전체 그라운드-트루스 마스크와 예측 마스크의 합집합 픽 셀의 합의 개수를 두고 분자에는 그라운드-트루스 마스크와 예측 마스크의 교집합에 속하는 픽셀의 개수를 두어 IoU을 계산하고 그 뒤 모든 클래스에 대하여 IoU의 평균을 계산하여 mIoU 을 계산할 수 있다. . 기존의 방식을 이용하면 모든 픽셀을 동등하게 간주하는 문제가 있다. 예를 들어 이미지에서 2개의 객체가 있고 각각 30픽셀과 500픽셀로 구성되어 있는 경우, 기존의 mIOU을 이용하면 30픽셀로 구성된 객체에서 30픽셀만큼이 탐지되지 못해도 30픽셀만큼의 오류가 생기고 500픽셀로 구성된 객체에서 30픽셀만큼 탐지되지 못하더라도 30픽 셀만큼의 오류가 생긴다. 따라서 양자의 mIoU 값은 동일하다. 하지만 후자에 비하여 전자는 작은 객체를 완전히탐지하지 못하는 결과를 발생될 수 있다. 이는 기존의 mIoU 을 이용하면 이미지상에서 상대적으로 작은 객체를 탐지하지 못한다는 것을 의미할 수 있다. 도4에서 (B)는 분할모델이 작은 물체도 탐지할 수 있는지도 고려하여 분할모델을 평가하는 방법에 대한 것을 도 시한 것이다. 수학식4은 작은 물체도 탐지할 수 있는지 고려하여 분할모델을 평가하는데 이용되는 IoU, IoUc, IA-mIoU 에 대 한 식이다. 수학식 5"}
{"patent_id": "10-2022-0072630", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 7, "content": "상기 식에서 c는 클래스, i는 클래스내에서 객체의 번호, T는 클래스내부의 객체의 총 개수, PrC,i은 c클래스내 에서 i번째의 객체의 예측 마스크 값, GTc,i는 c 클래스내에서 i번째의 객체의 그라운드-트루스 마스크, N은 이 미지상 모든 클래스의 개수를 의미 할 수 있다. 객체별로 IoU을 계산하여 분할모델을 평가하는 방식은 각 객체마다의 IoU 을 먼저 계산 한 뒤 평균을 구한다. 즉. 객체마다의 IoU을 계산하고 난뒤 하나의 클래스에서의 모든 객체의 IoU의 평균을 계산하여 클래스단위의 IoUC 을 산출하고, 이미지 전체에서 모든 클래스에 대해 클래스단위의IoUC 의 평균을 산출하여 IA- mIoU(Instance aware-mean Intersection over union)를 구해 이 값을 기초로 모델을 평가할 수 있다. IA-mIoU를 이용하여 분할모델을 평가하는 방식은 모든 픽셀을 동등하게 간주하지 않는다. 예를 들어 이미지에서 2개의 객체가 있고 각각 30픽셀과 500픽셀로 구성되어 있는 경우를 가정해 보자. IA-mIoU를 이용한 평가방식은 객체 각각에 대해서 IoU 을 계산한다. 즉 30픽셀로 구성되어 있는 객체에서 30픽셀만큼을 감지하지 못하는 경우 와 500픽셀로 구성되어 있는 객체에서 30픽셀만큼 감지못하는 경우, 전자의 경우가 훨씬 작은 IoU 값을 가지게 된다. 따라서 IA-mIoU를 이용한 평가방식은 평가모델이 상대적으로 작은 객체도 탐지하고 분할할 수 있는지도 평가할 수 있다. 이하 도5을 통해 IA-mIoU를 이용한 분할모델의 성능평가방법에 대해 구체적으로 설명한다. 도5는 IA-mIoU를 이용해 분할모델을 평가하는 방법을 기존의 평가방식과 비교한 실시예에 대해 도시한 것이다. 도5에서 빨간색 네모상자는 GTc,1 GTc,2을 의미하며 이는 해당 클래스에서 첫번재 객체와 두번재 객체의 그라운 드-트루스 마스크를 나타낸다. 도5에서 색깔이 칠해져 있는 픽셀은Prc,1 Prc,2을 의미하며 해당 클래스에서 첫번째와 두번쨰의 객체를 예측한 예측 마스크 값을 나타낸다. 도5에서 Case1은 분할모델이 1개의 객체를 1개의 예측 마스크로 예측하는 경우를 도시한 것이다. 상기 Case1과 같은 경우, 각 객체에 대해 그라운드-트루스 마스크와 예측 마스크을 계산할수 있다(step 1, 2) 상기 계산된 값으로부터 IA-mIoU를 계산한다. 계산된 IA-mIoU 값을 이용하여 분할모델의 성능을 평가할 수있다. 도5에서 Case2는 분할모델이 2개의 객체를 1개의 예측 마스크로 예측하는 경우를 도시한 것이다. 상기 Case2와 같은 경우, 각각 객체에 대해 예측 마스크값이 정확히 예측한 픽셀의 값을 계산한다(step1). 그 뒤 각 객체에서 정확히 예측한 픽셀의 비율을 계산한다(step2). 이렇게 계산한 비율을 기준으로 상기 예측 마스 크가 예측하지 못한 부분을 나누어 계산한다(step3). 예를 들어 하나의 예측 마스크가 객체1에 대해서는 16개의 픽셀을, 객체2에 대해서는 8개의 픽셀을 맞추었다고 가정한다(step1). 객체1과 2에 대해서 맞춘 정답의 비율은 2:1이다(step2). 상기 예측 마스크가 맞추지 못한 픽 셀을 상기 비율로 나누면 객체1에 대해서는 10개, 객체2에 대해서는 5개의 픽셀을 맞추지 못한것으로 볼 수 있 다(step3). 이를 종합하면 객체 1에 대한 그라운드-트루스 마스크 값은 16, 예측 마스크 값은 26(16+10)이며, 객체 2에 대한 그라운드-트루스 마스크 값은 8, 예측 마스크 값은 13(8+5)이다. 이를 이용하여 IA-mIoU을 계산 할 수 있다. 이하 도6을 통해 IA-mIoU를 이용한 분할모델 평가방법을 기존의 평가방법과 비교해본다. 도6는 IA-mIoU를 이용해 분할모델을 평가하는 방법을 기존의 평가방식(mIoU)과 비교한 실시예에 대해 도시한 것 이다. 도6의 그래프에서 L은 상대적으로 크기가 큰 객체를, S1~3은 상대적으로 크기가 작은 객체를 표시하며, X축은 해 당 객체를 정확히 탐지한 정도를 나타내며, Y축은 상기 평가방법으로 분할모델을 평가한 점수를 나타낸다. 도6의 그래프에서 빨간선은 IA-mIoU를 이용하여 분할모델을 평가한 결과를, 파란선은 기존 평가방식(mIoU)을 이 용하여 분할모델을 평가한 결과를 나타낸다. 도6의 Case A와 B는 하나의 이미지에 큰 객체(L)와 작은 객체(S)가 1개씩 있는 경우에 분할모델의 성능을 평가 한 결과를 나타낸다. 도6의 Case C와 D는 하나의 이미지에 큰 객채(L) 1개와 작은 객체(S) 3개가 있는 경우의 분할모델의 성능을 평 가한 결과를 나타낸다. 기존의 방식(mIoU)을 이용하여 분할모델의 성능을 평가하는 경우, 큰 객체(L)을 탐지할수록 분할모델의 성능이 좋다고 평가하지만 (Case A, C) 작은 객체(S)을 탐지하더라도 분할모델의 성능이 좋다고 평가하지는 않는다 (Case B, D) 반면 IA-mIoU를 이용하여 분할모델의 성능을 평가하는 경우, 큰 객체(L)만 탐지하는 경우 분할모델의 성능이 좋다고 평가하는 것이 기존의 방식보다는 다소 낮지만(CaseA), 작은 물체(S)을 탐지하는 경우에 분할모델의 성 능이 좋다고 평가한다. (Case B,C,D). IA-mIoU를 이용하여 분할모델의 성능을 평가하면 상기 분할모델이 큰 물체뿐만 아니라 작은 물체도 탐지하는지 평가할 수 있다. 이하 객체의 크기별 가중치를 고려하는 손실함수(LSW)를 이용하여 학습된 분할모델의 성능과 IA-mIoU를 이용하여 분할모델의 성능을 평가하는 방법을 기존에 존재하는 분할모델 및 평가방법과 비교한 실험결과에 대해 설명한다. 도7은 모델의 성능을 평가한 실험결과를 나타낸 것이다. 도7에서 Deeplab V2, IRN, CDA, EDAM, NS-ROM, BANA, BBAM은 기존의 분할모델을 나타낸다. +Ours는 기존의 분 할모델을 상기 손실함수(LSW)로 훈련시킨 것을 나타낸다. 도7에서 Method는 분할모델을 평가하는 방법을 나타내며mIoU는 기존의 분할모델을 평가하는 방법을, IA-mIoU는 상기 설명한 IA-mIoU를 이용할 분할모델을 평가하는 방법을 나타낸다. IAL, IAM, IAS는 차례대로 PASCAl VOC 데 이터 셋에서 크기가 큰/중간/작은 객체가 포함된 이미지를 가지고 분할모델의 성능을 평가한 결과를 나타낸다. 도7에서 기존에 존재하는 모델을 상기 손실함수(Lsw)로 훈련시키는 경우, 모두 성능이 향상되는 것을 확인할 수 있다. 이러한 성능향상은 크기가 작은 물체를 탐지하고 분할하는 경우(IAS)에서 더 높다는 것을 확인할 수 있다. 모델의 성능을 평가하는 방식에 있어, BANA와 BBAM은 낮은 IA-mIoU와 높은 IoU을 가지게 된다. 이는 BANA와 BBAM은 큰 물체는 탐지하지만 작은 물체는 탐지하지 못하는 것을 보여준다. 이는 mIoU값이 좋다고 항상 모델의 성능이 좋다고 판단할 수 없는 것을 보여준다. 도8은 객체의 크기별 가중치를 고려하는 손실함수(Lsw)와 이를 연속학습시키는 손실함수(LSB)을 이용한 모델의 성 능을 평가한 Ablation study 실험결과이다. 도8에서 DeepLabV2는 기존에 존재하는 baseline model을 말하며, with Lsw는 가중치를 고려하는 손실함수(Lsw)를 이용하여 훈련시킨 것을, LSB는 연속학습방법으로 학습시킨 모델을 나타낸다. 도8에서 mIoU는 기존의 분할모델을 평가하는 방법을, IA-mIoU는 상기 설명한 IA-mIoU를 이용한 분할모델을 평가 하는 방법을 나타낸다. IAL, IAM, IAS는 차례대로 PASCAl VOC 데이터 셋에서 크기가 큰/중간/작은 객체가 포함된 이미지를 가지고 분할모델의 성능을 평가한 결과를 나타낸다. IAL70-100은 PASCAL VOC 에서 큰 객체를 가지는 이미지(전체 픽셀중에서 객체가 차지하는 픽셀이 60%이상) 중에서 상위 30%을 이용하여 테스트한 결과를 나타낸 다. 도8에서 손실함수로 Lsw와 Lsb을 이용하여 훈련시킨 모델은 기존의 모델과 비교할 때 작은 (IAS)을 객체를 탐지하 는 성능이 좋은 것을 확인할 수 있다. 또한 Lsb모델이 Lsw모델보다 큰 물체(IAL, IAL70~100) 탐지하는 성능이 좋 은 것을 확인할 수 있다. 이하 도9을 통하여 이미지에서 객체를 분할하는 분석장치의 구성에 대해 설명한다. 도9는 이미지로부터 객체를 분할하는 분석장치의 구성에 대해서 도시한 예이다. 상기 분석장치는 전술한 분석장치(도1의 200)에 해당한다. 상기 분석장치는 PC, 노트북, 스마트기기, 서버, 또는 데이터처리 전용 칩셋등과 물리적으로 다양한 형태 로 구현될 수도 있다. 상기 분석장치는 입력장치 저장장치, 연산장치을 포함할 수도 있다. 상기 분석장치는 출력 장치을 더 포함할 수도 있다. 도9의 입력장치는 일정한 명령 또는 데이터를 입력받는 인터페이스 장치(키보드, 마우스, 터치스크린 등) 를 포함할 수도 있다. 상기 입력장치는 전술한 입력장치(도1의 100)에 해당한다. 상기 입력장치는 유선 또는 무선 네트워크를 통해 일정한 정보를 수신하고 전송하는 통신장치를 포함할 수 도 있다. 상기 입력장치는 별도의 저장장치(USB,CD,하드디스크 등)을 통하여 정보를 입력받는 구성을 포함할 수도 있다. 상기 입력장치는 입력받는 데이터를 별도의 측정장치를 통하여 입력받거나, 별도의 DB을 통하여 입력받을 수도 있다. 상기 입력장치는 적어도 하나의 객체가 포함된 이미지를 입력받을 수도 있다. 도9의 저장장치는 상기 입력장치로부터 온 정보를 저장할 수도 있다. 상기 저장장치는 이미지로부터 객체를 분할해주는 분할모델을 저장할 수도 있다. 상기 저장장치는 상기 분할모델이 출력하는 결과값에 대해 저장할 수도 있다. 상기 저장장치는 분할모델을 학습할 때 이용하는 학습데이터를 저장할 수도 있다. 도9의 연산장치는 상기 입력장치로부터 이미지를 상기 분할모델에 입력한 뒤 그 출력값을 기준으로 상기 이미지에서 객체를 분할할 수도 있다. 도9의 출력장치는 일정한 정보를 출력하는 장치가 될 수도 있다. 상기 출력장치은 데이터 과정에 필요한 인터페이스, 입력된 데이터, 분석결과 등을 출력할 수도 있다. 상기 출력장치은 디스플레이어, 문서를 출력하는 장치, 통신장치 등과 같이 물리적으로 다양한 형태로 구 현될 수도 있다."}
{"patent_id": "10-2022-0072630", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도1은 이미지로부터 객체를 분할하는 전체적인 과정에 대해 도시한 것이다. 도2는 분할모델을 학습시키는 과정에 대하여 도시한 것이다. 도3는 학습시 이미지상에서 객체를 탐지한 실시예 중에 하나이다. 도4는 분할모델의 성능을 평가하는 위한 방법을 비교한 것이다. 도5는 IA-mIoU을 이용하여 분할모델의 성능을 평가하는 실시예를 도시한 것이다. 도6는 IA-mIoU를 이용해 분할모델을 평가하는 방법을 기존의 평가방식과 비교한 실시예에 대해 도시한 것이다. 도7은 모델의 성능을 평가한 실험결과를 나타낸 것이다.도8는 모델의 성능을 평가한 실혐결과를 나타낸 것이다. 도9는 이미지로부터 객체를 분할하는 분석장치의 구성에 대해서 도시한 예이다."}
