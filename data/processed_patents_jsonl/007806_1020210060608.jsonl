{"patent_id": "10-2021-0060608", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2022-0057403", "출원번호": "10-2021-0060608", "발명의 명칭": "가변 길이 명령코드를 이용한 알려지지 않은 악성코드 탐지 장치 및 이를 이용한 방법", "출원인": "한국전자통신연구원", "발명자": "김정태"}}
{"patent_id": "10-2021-0060608", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "탐지 대상으로부터 명령코드(OPCODE) 정보를 수집하는 단계;상기 명령코드 정보를 피처 엔지니어링(FEATURE ENGINEERING)하여 가변 길이의 다차원 이미지를 생성하는 단계;및인공지능 기반의 딥러닝 모델로 상기 다차원 이미지를 입력하여 알려지지 않은 악성코드를 탐지하는 단계를 포함하는 것을 특징으로 하는 알려지지 않은 악성코드 탐지 방법."}
{"patent_id": "10-2021-0060608", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "청구항 1에 있어서,상기 다차원 이미지는상기 명령코드 정보에 상응하는 N-GRAM 기반의 다차원 RGB 이미지에 상응하는 것을 특징으로 하는 알려지지 않은 악성코드 탐지 방법."}
{"patent_id": "10-2021-0060608", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "청구항 2에 있어서,상기 다차원 이미지를 생성하는 단계는상기 명령코드 정보를 기반으로 가변 길이 코드인 헥사(HEX) 코드에 대한 N-GRAM 시퀀스를 저장하는 단계; 및상기 N-GRAM 시퀀스를 기반으로 3-GRAM 명령코드에 대한 RGB 코드 매핑을 수행하여 상기 다차원 RGB 이미지를생성하는 단계를 포함하는 것을 특징으로 하는 알려지지 않은 악성코드 탐지 방법."}
{"patent_id": "10-2021-0060608", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "청구항 3에 있어서,상기 수집하는 단계는상기 탐지 대상에 상응하는 실행형 파일에서 텍스트 섹션을 추출하는 단계;바이너리 분석 도구를 이용하여 상기 텍스트 섹션의 로우(RAW) 데이터를 어셈블리 언어 형식의 명령코드로 변환하는 단계; 및상기 명령코드를 기반으로 상기 헥사 코드를 추출하는 단계를 포함하는 것을 특징으로 하는 알려지지 않은 악성코드 탐지 방법."}
{"patent_id": "10-2021-0060608", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "청구항 1에 있어서,상기 악성코드를 탐지하는 단계는학습을 통해 분류된 악성코드 별 특징 정보와 상기 딥러닝 모델에서 출력되는 다차원 특징 정보 간의 유사도를고려하여 상기 알려지지 않은 악성코드를 탐지하는 것을 특징으로 하는 알려지지 않은 악성코드 탐지 방법."}
{"patent_id": "10-2021-0060608", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "청구항 1에 있어서,복수개의 정상코드들 및 복수개의 악성코드들을 기반으로 수집된 명령코드 정보를 이용하여 학습용 다차원 이미공개특허 10-2022-0057403-3-지를 생성하고, 상기 학습용 다차원 이미지를 기반으로 학습데이터를 생성하는 단계; 및상기 학습데이터를 이용하여 상기 딥러닝 모델을 학습시키는 단계를 더 포함하는 것을 특징으로 하는 알려지지않은 악성코드 탐지 방법."}
{"patent_id": "10-2021-0060608", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "청구항 6에 있어서,상기 학습시키는 단계는악성코드 별 복잡도(ENTROPY) 정보, 최초 생성 일자, 최종 수정 일자 및 유포사이트 정보 중 적어도 하나를 획득하여 학습데이터로 사용하는 것을 특징으로 하는 알려지지 않은 악성코드 탐지 방법."}
{"patent_id": "10-2021-0060608", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "청구항 4에 있어서,상기 명령코드는논리 연산, 프로그램 흐름 제어, 메모리 처리 및 산술 연산 중 적어도 하나의 기능을 제공하는 코드인 것을 특징으로 하는 알려지지 않은 악성코드 탐지 방법."}
{"patent_id": "10-2021-0060608", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "청구항 4에 있어서,상기 명령코드는상기 어셈블리 언어 형식에 일대일 대응되는 것을 특징으로 하는 알려지지 않은 악성코드 탐지 방법."}
{"patent_id": "10-2021-0060608", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "청구항 4에 있어서,상기 명령코드는1바이트 또는 2바이트에 상응하는 명령어 및 복수개의 오퍼랜드(OPERAND) 값들로 구성되는 것을 특징으로 하는알려지지 않은 악성코드 탐지 방법."}
{"patent_id": "10-2021-0060608", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "탐지 대상으로부터 명령코드(OPCODE) 정보를 수집하고, 상기 명령코드 정보를 피처 엔지니어링(FEATUREENGINEERING)하여 가변 길이의 다차원 이미지를 생성하고, 인공지능 기반의 딥러닝 모델로 상기 다차원 이미지를 입력하여 알려지지 않은 악성코드를 탐지하는 프로세서; 및상기 명령코드 정보 및 상기 다차원 이미지를 저장하는 메모리를 포함하는 것을 특징으로 하는 알려지지 않은 악성코드 탐지 장치."}
{"patent_id": "10-2021-0060608", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "청구항 11에 있어서,상기 다차원 이미지는상기 명령코드 정보에 상응하는 N-GRAM 기반의 다차원 RGB 이미지에 상응하는 것을 특징으로 하는 알려지지 않은 악성코드 탐지 장치."}
{"patent_id": "10-2021-0060608", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "청구항 12에 있어서,상기 프로세서는상기 명령코드 정보를 기반으로 가변 길이 코드인 헥사(HEX) 코드에 대한 N-GRAM 시퀀스를 저장하고, 상기 N-공개특허 10-2022-0057403-4-GRAM 시퀀스를 기반으로 3-GRAM 명령코드에 대한 RGB 코드 매핑을 수행하여 상기 다차원 RGB 이미지를 생성하는것을 특징으로 하는 알려지지 않은 악성코드 탐지 장치."}
{"patent_id": "10-2021-0060608", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_14", "content": "청구항 13에 있어서,상기 프로세서는상기 탐지 대상에 상응하는 실행형 파일에서 텍스트 섹션을 추출하고, 바이너리 분석 도구를 이용하여 상기 텍스트 섹션의 로우(RAW) 데이터를 어셈블리 언어 형식의 명령코드로 변환하고, 상기 명령코드를 기반으로 상기헥사 코드를 추출하는 것을 특징으로 하는 알려지지 않은 악성코드 탐지 장치."}
{"patent_id": "10-2021-0060608", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_15", "content": "청구항 11에 있어서,상기 프로세서는학습을 통해 분류된 악성코드 별 특징 정보와 상기 딥러닝 모델에서 출력되는 다차원 특징 정보 간의 유사도를고려하여 상기 알려지지 않은 악성코드를 탐지하는 것을 특징으로 하는 알려지지 않은 악성코드 탐지 장치."}
{"patent_id": "10-2021-0060608", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_16", "content": "청구항 11에 있어서,상기 프로세서는복수개의 정상코드들 및 복수개의 악성코드들을 기반으로 수집된 명령코드 정보를 이용하여 학습용 다차원 이미지를 생성하고, 상기 학습용 다차원 이미지에 상응하게 학습데이터를 생성하고, 상기 학습데이터를 이용하여 상기 딥러닝 모델을 학습시키는 것을 특징으로 하는 알려지지 않은 악성코드 탐지 장치."}
{"patent_id": "10-2021-0060608", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_17", "content": "청구항 16에 있어서,상기 프로세서는악성코드 별 복잡도(ENTROPY) 정보, 최초 생성 일자, 최종 수정 일자 및 유포사이트 정보 중 적어도 하나를 획득하여 학습데이터로 사용하는 것을 특징으로 하는 알려지지 않은 악성코드 탐지 장치."}
{"patent_id": "10-2021-0060608", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_18", "content": "청구항 14에 있어서,상기 명령코드는논리 연산, 프로그램 흐름 제어, 메모리 처리 및 산술 연산 중 적어도 하나의 기능을 제공하는 코드인 것을 특징으로 하는 알려지지 않은 악성코드 탐지 장치."}
{"patent_id": "10-2021-0060608", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_19", "content": "청구항 14에 있어서,상기 명령코드는상기 어셈블리 언어 형식에 일대일 대응되는 것을 특징으로 하는 알려지지 않은 악성코드 탐지 장치."}
{"patent_id": "10-2021-0060608", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_20", "content": "청구항 14에 있어서,상기 명령코드는1바이트 또는 2바이트에 상응하는 명령어 및 복수개의 오퍼랜드(OPERAND) 값들로 구성되는 것을 특징으로 하는공개특허 10-2022-0057403-5-알려지지 않은 악성코드 탐지 장치."}
{"patent_id": "10-2021-0060608", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "가변 길이 명령코드를 이용한 알려지지 않은 악성코드 탐지 장치 및 이를 이용한 방법이 개시된다. 본 발명의 일실시예에 따른 알려지지 않은 악성코드 탐지 방법은 탐지 대상으로부터 명령코드(OPCODE) 정보를 수집하는 단 계; 상기 명령코드 정보를 피처 엔지니어링(FEATURE ENGINEERING)하여 가변 길이의 다차원 이미지를 생성하는 단 계; 및 인공지능 기반의 딥러닝 모델로 상기 다차원 이미지를 입력하여 알려지지 않은 악성코드를 탐지하는 단계 를 포함한다."}
{"patent_id": "10-2021-0060608", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 악성코드 탐지 기술에 관한 것으로, 특히 악성코드의 정적 또는 동적 분석 시 활용되는 명령코드인 OPERATION CODE(OPCOE) 정보를 가공하여 인공지능 기반으로 알려지지 않은 악성코드를 탐지하는 기술에 관한 것 이다."}
{"patent_id": "10-2021-0060608", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "종래에는 악성코드로 의심되는 파일에 대하여 악성코드의 특정 코드 섹션의 패턴 정보를 매칭하는 방식(시그니 처 기반 탐지)으로 악성코드를 탐지하였다. 특히, 기존의 안티바이러스 탐지 기법은 악성코드가 사용하는 특정 코드 섹션의 바이트(byte) 정보를 기반으로 탐지하거나, 악성코드가 동적으로 동작하며 발생하는 각종 로그 정 보(DLL, API 함수 호출 정보 등) 및 파일의 구조 정보를 바탕으로 악성여부를 판단하고 있어, 신종 및 변종 악 성코드를 탐지하는데 한계가 있다. 이에 따라, 최근에는 따라서, 악성코드 분석을 위한 다양한 정적/동적 기술이 제안되고, Unknown 파일을 포함한 다양한 악성코드의 종류를 효과적으로 분석 및 탐지하기 위한 시도가 진행중이지만 해당 기술의 정확도 및 성능 의 제약으로 인하여 상용화로 이루어지기 어려운 현실이다. 선행기술문헌 특허문헌 (특허문헌 0001) 한국 등록 특허 제10-1880686호, 2018년 7월 16일 등록(명칭: AI 딥러닝 기반의 악성코드 탐지 시스템)"}
{"patent_id": "10-2021-0060608", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명의 목적은 탐지 정확도 및 성능이 향상 가능한 AI 기반의 Unknown 악성코드 탐지 기술을 제공하는 것이다. 또한, 본 발명의 목적은 가변 길이의 특성을 갖는 특징 정보를 기반으로 Unknown 악성코드 분류 및 탐지가 가능 한 악성코드 탐지 기술을 제공하는 것이다. 또한, 본 발명의 목적은 문서형 및 스크립트형 악성파일의 탐지에도 적용 가능한 악성코드 탐지 기술을 제공하 는 것이다."}
{"patent_id": "10-2021-0060608", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "상기한 목적을 달성하기 위한 본 발명에 따른 알려지지 않은 악성코드 탐지 방법은 탐지 대상으로부터 명령코드 (OPCODE) 정보를 수집하는 단계; 상기 명령코드 정보를 피처 엔지니어링(FEATURE ENGINEERING)하여 가변 길이의 다차원 이미지를 생성하는 단계; 및 인공지능 기반의 딥러닝 모델로 상기 다차원 이미지를 입력하여 알려지지 않은 악성코드를 탐지하는 단계를 포함한다. 이 때, 다차원 이미지는 상기 명령코드 정보에 상응하는 N-GRAM 기반의 다차원 RGB 이미지에 상응할 수 있다. 이 때, 다차원 이미지를 생성하는 단계는 상기 명령코드 정보를 기반으로 가변 길이 코드인 헥사(HEX) 코드에 대한 N-GRAM 시퀀스를 저장하는 단계; 및 상기 N-GRAM 시퀀스를 기반으로 3-GRAM 명령코드에 대한 RGB 코드 매 핑을 수행하여 상기 다차원 RGB 이미지를 생성하는 단계를 포함할 수 있다. 이 때, 수집하는 단계는 상기 탐지 대상에 상응하는 실행형 파일에서 텍스트 섹션을 추출하는 단계; 바이너리 분석 도구를 이용하여 상기 텍스트 섹션의 로우(RAW) 데이터를 어셈블리 언어 형식의 명령코드로 변환하는단계; 및 상기 명령코드를 기반으로 상기 헥사 코드를 추출하는 단계를 포함할 수 있다. 이 때, 악성코드를 탐지하는 단계는 학습을 통해 분류된 악성코드 별 특징 정보와 상기 딥러닝 모델에서 출력되 는 다차원 특징 정보 간의 유사도를 고려하여 상기 알려지지 않은 악성코드를 탐지할 수 있다. 이 때, 악성코드를 기반으로 수집된 명령코드 정보를 기반으로 상기 악성코드에 상응하는 다차원 이미지를 생성 하고, 상기 악성코드에 상응하는 다차원 이미지에 상응하게 학습데이터를 생성하는 단계; 및 상기 학습데이터를 이용하여 상기 딥러닝 모델을 학습시키는 단계를 더 포함할 수 있다. 이 때, 학습시키는 단계는 악성코드 별 복잡도(ENTROPY) 정보, 최초 생성 일자, 최종 수정 일자 및 유포사이트 정보 중 적어도 하나를 획득하여 학습데이터로 사용할 수 있다. 이 때, 명령코드는 논리 연산, 프로그램 흐름 제어, 메모리 처리 및 산술 연산 중 적어도 하나의 기능을 제공하 는 코드일 수 있다. 이 때, 명령코드는 상기 어셈블리 언어 형식에 일대일 대응될 수 있다. 이 때, 명령코드는 1바이트 또는 2바이트에 상응하는 명령어 및 복수개의 오퍼랜드(OPERAND) 값들로 구성될 수 있다. 또한, 본 발명의 일실시예에 따른 알려지지 않은 악성코드 탐지 장치는, 탐지 대상으로부터 명령코드(OPCODE) 정보를 수집하고, 상기 명령코드 정보를 피처 엔지니어링(FEATURE ENGINEERING)하여 가변 길이의 다차원 이미지 를 생성하고, 인공지능 기반의 딥러닝 모델로 상기 다차원 이미지를 입력하여 알려지지 않은 악성코드를 탐지하 는 프로세서; 및 상기 명령코드 정보 및 상기 다차원 이미지를 저장하는 메모리를 포함한다. 이 때, 다차원 이미지는 상기 명령코드 정보에 상응하는 N-GRAM 기반의 다차원 RGB 이미지에 상응할 수 있다. 이 때, 프로세서는 상기 명령코드 정보를 기반으로 가변 길이 코드인 헥사(HEX) 코드에 대한 N-GRAM 시퀀스를 저장하고, 상기 N-GRAM 시퀀스를 기반으로 3-GRAM 명령코드에 대한 RGB 코드 매핑을 수행하여 상기 다차원 RGB 이미지를 생성할 수 있다. 이 때, 프로세서는 상기 탐지 대상에 상응하는 실행형 파일에서 텍스트 섹션을 추출하고, 바이너리 분석 도구를 이용하여 상기 텍스트 섹션의 로우(RAW) 데이터를 어셈블리 언어 형식의 명령코드로 변환하고, 상기 명령코드를 기반으로 상기 헥사 코드를 추출할 수 있다. 이 때, 프로세서는 학습을 통해 분류된 악성코드 별 특징 정보와 상기 딥러닝 모델에서 출력되는 다차원 특징 정보 간의 유사도를 고려하여 상기 알려지지 않은 악성코드를 탐지할 수 있다. 이 때, 프로세서는 복수개의 정상코드들 및 복수개의 악성코드들을 기반으로 수집된 명령코드 정보를 이용하여 학습용 다차원 이미지를 생성하고, 상기 학습용 다차원 이미지에 상응하게 학습데이터를 생성하고, 상기 학습데 이터를 이용하여 상기 딥러닝 모델을 학습시킬 수 있다. 이 때, 프로세서는 악성코드 별 복잡도(ENTROPY) 정보, 최초 생성 일자, 최종 수정 일자 및 유포사이트 정보 중 적어도 하나를 획득하여 학습데이터로 사용할 수 있다. 이 때, 명령코드는 논리 연산, 프로그램 흐름 제어, 메모리 처리 및 산술 연산 중 적어도 하나의 기능을 제공하 는 코드일 수 있다. 이 때, 명령코드는 상기 어셈블리 언어 형식에 일대일 대응될 수 있다. 이 때, 명령코드는 1바이트 또는 2바이트에 상응하는 명령어 및 복수개의 오퍼랜드(OPERAND) 값들로 구성될 수 있다."}
{"patent_id": "10-2021-0060608", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명에 따르면, 탐지 정확도 및 성능이 향상 가능한 AI 기반의 Unknown 악성코드 탐지 기술을 제공할 수 있 다. 또한, 본 발명은 가변 길이의 특성을 갖는 특징 정보를 기반으로 Unknown 악성코드 분류 및 탐지가 가능한 악성 코드 탐지 기술을 제공할 수 있다. 또한, 본 발명은 문서형 및 스크립트형 악성파일의 탐지에도 적용 가능한 악성코드 탐지 기술을 제공할 수 있다."}
{"patent_id": "10-2021-0060608", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "본 발명을 첨부된 도면을 참조하여 상세히 설명하면 다음과 같다. 여기서, 반복되는 설명, 본 발명의 요지를 불 필요하게 흐릴 수 있는 공지 기능, 및 구성에 대한 상세한 설명은 생략한다. 본 발명의 실시형태는 당 업계에서 평균적인 지식을 가진 자에게 본 발명을 보다 완전하게 설명하기 위해서 제공되는 것이다. 따라서, 도면에서의 요소들의 형상 및 크기 등은 보다 명확한 설명을 위해 과장될 수 있다. 이하, 본 발명에 따른 바람직한 실시예를 첨부된 도면을 참조하여 상세하게 설명한다. 도 1은 본 발명의 일실시예에 따른 가변 길이 명령코드를 이용한 알려지지 않은 악성코드 탐지 방법을 나타낸 동작흐름도이다. 도 1을 참조하면, 본 발명의 일실시예에 따른 가변 길이 명령코드를 이용한 알려지지 않은 악성코드 탐지 방법 은 탐지 대상으로부터 명령코드(OPCODE) 정보를 수집한다(S110). 예를 들어, 본 발명은 도 2에 도시된 것처럼 AI 기반 학습 데이터 전처리를 위한 명령코드(Opcode) 기반의 정보 수집 단계, 수집된 정보 가공(FEATURE ENGINEERING)을 위한 특징 정보 최적화(Feature Optimization) 단계 및 결과로 생성된 특징 정보를 기반으로 기반으로 Multi-Class Classification이 가능한 악성코드 분석 및 분류 단 계로 구분할 수 있는데, 단계(S110)은 정보 수집 단계에 해당할 수 있다. 이 때, 탐지 대상에 상응하는 실행형 파일에서 텍스트 섹션을 추출할 수 있다. 이 때, 바이너리 분석 도구를 이용하여 텍스트 섹션의 로우(RAW) 데이터를 어셈블리 언어 형식의 명령코드로 변 환할 수 있다. 이 때, 악성코드의 정적 또는 동적 분석을 위한 명령코드를 추출하기 위해서 다양한 바이너리 분석용 도구 (Disassembler)를 활용할 수 있다. 특히, 분석 시스템의 운영체제(OS)에 따라서 IDA, Objdump, OllyDBG, VisualStudio, PE Explorer 등의 분석 도구를 이용함으로써 정적으로 명령코드 추출을 지원할 수 있다. 또한, 동적 분석 시에는 CPU 또는 가상환경에서도 Processor Tracer 등을 이용하여 실행파일의 명령코드를 추출하고 변환할 수 있다. 이 때, 다양한 바이너리 분석용 도구를 이용하여 실행형 파일(PE, DLL 등)의 텍스트 섹션(text section)을 추출 할 수 있다. 예를 들어, 도 3에 도시된 것 같은 PE 파일에서 SECTION_text 내부에 존재하는 Raw 데이터를 도 4 에 도시된 것처럼 어셈블리 언어 형식의 명령코드로 변환할 수 있다. 이 때, 일반적인 바이너리 분석에 기반한 리버스 엔지니어링은 수동적인 방법으로 파일 종류, 크기, 헤더 정보, 인증서, 내부 구조, 레지스트리, 네트워크 동작, 관련 API 함수 정보 등의 다양한 정적/동적 정보를 모두 참고 하지만, 본 방법에서는 정적/동적 분석 시에 발생되는 명령코드인 Opcode 만을 기본으로 사용한다. 또한, 패킹 및 난독화된 악성코드의 경우, 사전에 복호화 또는 언난독화(Unobfuscation)를 수행하여 명령코드를 수집할 수 있도록 처리해야하며, 이 부분은 본 특허의 핵심에서 벗어나므로 상세히 다루지 않는다. 이 때, 본 발명에 따른 명령코드는 CPU가 처리하는 기계어 명령으로 논리 연산, 프로그램 흐름 제어, 메모리 처 리, 산술 연산의 기능을 제공할 수 있다. 특히 각 명령코드는 각각의 어셈블리어 명령에 1:1로 정확히 대응되는 특징을 가지고 있다. 이러한 명령코드의 구조는 1byte 또는 2byte에 상응하는 명령어(Opcode)와 복수개의 오퍼 랜드(Operand) 값으로 구성될 수 있다. 예를 들어, 도 4를 참조하면, mov, add, push, lea, call 등의 명령 코드는 ebx, eax, ecx 등의 레지스터, 실 제 값 및 참조 값으로 구성될 수 있으며, 특히 명령어의 형식에 따라 오퍼랜드의 개수와 코드 번호가 달라질 수 있다. 즉, 동일한 명령코드라 할지라도 오퍼랜드에 따라서 다른 결과가 나타날 수 있다. 본 발명에서는 이러한 특징의 시맨틱스(Semantics)를 찾아내기 위해서 명령 코드의 HEX 코드 값(인텔사의 X86 Opcode and Instruction Reference)을 활용하도록 한다. 이 때, 명령코드를 기반으로 헥사 코드를 추출할 수 있다. 또한, 본 발명의 일실시예에 따른 가변 길이 명령코드를 이용한 알려지지 않은 악성코드 탐지 방법은 명령코드 정보를 피처 엔지니어링(REATURE ENGINEERING)하여 가변 길이의 다차원 이미지를 생성한다(S120). 이 때, 단계(S120)은 도 2에 도시된 정보 가공 및 최적화 단계에 해당할 수 있다. 이 때, 다차원 이미지는 명령코드 정보에 상응하는 N-GRAM 기반의 다차원 RGB 이미지에 상응할 수 있다. 이 때, 명령코드 정보를 기반으로 가변 길이 코드인 헥사(HEX) 코드에 대한 N-GRAM 시퀀스를 저장할 수 있다. 예를 들어, 도 2에 도시된 명령코드(Opcode) 기반의 정보 수집 단계에서 명령코드의 HEX 코드 값을 추출하면, 도 5 내지 도 6 및 [표 1]과 같이 실행파일 별로 256개의 다양한 길이의 HEX 코드 값을 추출할 수 있다. 표 1 Group Opcode Arithmetic operations add, sub, mul, div Memory manipulation lea, pop, push, mov, store, load Logical operations xor, not, and, or Program flow control call, cmp, rep Condition operation Goto, jmp, if, spa, sna, sza 이 때, 도 7을 참조하면, HEX 코드 값을 N-Gram 시퀀스 분석을 하기 위하여 1, 2, 3 ..., N 그램의 HEX 코드 값을 별도로 저장할 수 있다. 즉, 가변 길이의 HEX 명령 코드 N-Gram 시퀀스를 저장할 수 있다. 이 때, N-GRAM 시퀀스를 기반으로 3-GRAM 명령코드에 대한 RGB 코드 매핑을 수행하여 다차원 RGB 이미지를 생성 할 수 있다. 예를 들어, 1-Gram의 경우에는 Grey Scale로 이미지화 변환이 가능하며, 2-Gram의 경우에는 X, Y 좌표값으로 평 면에 위치정보로써 활용이 가능하다. 이 때, 3-Gram 명령코드 정보의 경우는 도 8에 도시된 것처럼 RGB 코드 매 핑을 통하여 M차원의 이미지(jpg, png, bmp 등)로도 변환할 수 있다. 이 때, M 차원수는 AI 학습 시 사용할 악 성 또는 정상코드들의 평균 3-Gram 제곱근(square root) 개수에 비례할 수 있다. 만약 10만개 악성코드의 3-Gram 시퀀스 평균 개수가 900개이면 30차원의 이미지를 생성할 수 있다. 이 때, 일부 악성코드의 3-Gram 시퀀스가 평균 미만이면 0 패딩을 더함으로써, 이미지 변환 시 Black으로 변환되도록 할 수 있다. 또한, 일부 악성코드의 3-Gram 시퀀스가 평균 이상인 경우에는 평균까지만 이미지 변환이 되도록 제어할 수 있다. 이 때, 변환되는 이미지의 형식은 jpg, png, gif, bmp 등 다양한 형식을 취할 수 있다. 또한, 본 발명의 일실시예에 따른 가변 길이 명령코드를 이용한 알려지지 않은 악성코드 탐지 방법은 인공지능 기반의 딥러닝 모델로 다차원 이미지를 입력하여 알려지지 않은 악성코드를 탐지한다(S130). 이 때, 단계(S130)은 도 2에 도시된 AI 기반 악성코드 분석 및 분류 단계에서 UNKNOWN 악성코드 탐지 단계에 해 당할 수 있다. 이 때, 본 발명에서는 악성코드 타입 별로 생성된 학습데이터를 통해 사전에 인공지능 기반의 딥러닝 모델을 학 습시킬 수 있는데, 해당 내용은 [표 2]를 참고하여 설명하도록 한다. 예를 들어, 본 발명의 일실시예에 따른 딥러닝 모델은 도 9 내지 도 11에 도시된 것과 같은 CNN(Convolution Neural Network) 기반의 모델에 상응할 수 있다. 이러한 CNN 모델의 경우, 가변 길이의 입력을 처리할 수 있는 특성이 있다. 만약, 생성된 특징 정보가 정해진 사이즈보다 작을 경우에는 의미없는 0 패딩을 추가할 수 있고, 생성된 특징 정보가 정해진 사이즈보다 클 경우에는 일부 버려지는 정보에 따른 학습 오류 등을 미리 방지 할 수 있다. 이 때, 학습을 통해 분류된 악성코드 별 특징 정보와 딥러닝 모델에서 출력되는 다차원 특징 정보 간의 유사도 를 고려하여 알려지지 않은 악성코드를 탐지할 수 있다. 예를 들어, 딥러닝 모델에서 출력된 다차원 특징 정보가 학습을 통해 분류된 악성코드 별 특징 정보와 기설정된 유사도 이상 유사한 경우, 탐지 대상이 알려지지 않은 악성코드인 것으로 판단할 수 있다. 즉, 사전에 분류된 악성코드와 동일하지는 않지만 유사한 특징 정보를 포함하고 있는 경우, 알려지지 않은 새로운 변종 악성코드인 것으로 판단할 수 있다. 이 때, 학습을 통해 분류된 악성코드 별 특징 정보와 딥러닝 모델에서 출력되는 다차원 특징 정보 간의 유사도 를 고려하여 사전에 분류된 종류의 악성코드를 탐지할 수 도 있다. 예를 들어, 딥러닝 모델에서 출력된 다차원 특징 정보를 X라 가정하고, 학습을 통해 분류된 악성코드 별 특징 정보로써 A, B, C가 존재한다고 가정할 수 있다. 이 때, 다차원 특징 정보 X가 각각 A, B, C와 얼만큼 유사한지 비교할 수 있다. 만약, X가 A와 기설정된 기준 이상 유사하다면, X가 A 특징 정보에 상응하는 악성코드인 것으로 판단할 수 있다. 또한, 도 1에는 도시하지 아니하였으나, 본 발명의 일실시예에 따른 가변 길이 명령코드를 이용한 알려지지 않 은 악성코드 탐지 방법은 복수개의 정상코드들 및 복수개의 악성코드들을 기반으로 수집된 명령코드 정보를 이 용하여 학습용 다차원 이미지를 생성하고, 학습용 다차원 이미지에 상응하게 학습데이터를 생성한다. 또한, 도 1에는 도시하지 아니하였으나, 본 발명의 일실시예에 따른 가변 길이 명령코드를 이용한 알려지지 않 은 악성코드 탐지 방법은 학습데이터를 이용하여 딥러닝 모델을 학습시킨다. 예를 들어, 악성/정상의 학습데이터를 기 분류된 악성코드 타입 별로 레벨링 하여 AI 기반의 딥러닝 모델에 학 습데이터로 사용이 가능하다. 이 때, 악성코드의 타입 별 분류기준은 각 Anti-Virus 회사마다 상이하므로 일관된 타입 분류는 존재하지 않으 며, 학습을 위한 레벨링 기준도 변수가 될 수 있다. 예를 들어, [표 2]는 이미지로 생성된 학습 데이터 생성시 10가지 악성코드 분류를 위한 레벨링 예시를 보여준다. 표 2 Type Class Label 비고PEBenign 0 정상 파일 APT 1 APT관련 사건에 사용된 악성코드 군 Backdoor 2 Backdoor로 알려진 악성코드 군 Banker 3 Banker(금융정보탈취)로 알려진 악성코드 군 Bot 4 Bot(C&C 통신)로 알려진 악성코드 군 Miner 5 비트코인 마이닝 관련 악성코드(혹은 도구) 군 Ransomware 6 Ransomware로 알려진 악성코드 군 RAT 7 Remote Admin Tool로 알려진 악성코드 군 Spyware 8 스파이웨어로 알려진 악성코드 군 Trojan 9 트로이 목마 계열로 알려진 악성코드 군 ETC 10 기타 악성코드 군 이 때, [표 2]에 해당하는 분류 기준 이외에 다양한 기준(타 백신사 or VirusTotal 등)으로 분류된 학습용 악성 코드 샘플 데이터의 경우, 특정 악성파일 또는 해쉬값에 대한 벤더사별 탐지 정보(백신명/탐지유무/버전/탐지명 결과/업데이트 날짜 등)를 기준으로 M차원 이미지를 생성하여 도 9 내지 도 11에 도시된 CNN 기반 모델과 같은 다양한 AI 기술에 적용함으로써 악성코드의 탐지 및 분류를 수행할 수 있다. 이 때, 악성코드 별 복잡도(ENTROPY) 정보, 최초 생성 일자, 최종 수정 일자 및 유포사이트 정보 중 적어도 하 나를 획득하여 학습데이터로 사용할 수 있다. 예를 들어, 특정 악성코드의 복잡도(Entropy) 정보, 최초 생성 일자, 최종 수정 일자, 인터넷 상에서 유포된 사 이트 정보(IP or Domain) 등은 도 2에 도시된 3-Gram 기반 M차원 특정 정보 최적화 단계에서 추가적으로 획득할 수 있다. 또한, 본 발명에서는 도 2에 도시된 최적화 단계에서 별도로 저장된 다양한 N-Gram 명령코드를 기반으로 다양한 AI 기술에서 결과 활용이 가능하다. 또한, 실행형 파일(PE, DLL 등)뿐만 아니라 다양한 문서형, 스크립트 (Script)형 악성파일에서도 각각의 포렌식 툴을 기반으로 어셈블리 기반의 명령 코드를 추출함으로써 본 발명에 서 제안한 악성코드 탐지 방법을 적용할 수 있다. 특히, 문서형 파일에 실행형 코드나 Script가 내재되어 있는 경우에도 본 발명이 제안한 방안으로 적용이 가능하다. 이와 같은 알려지지 않은 악성코드 탐지 방법을 통해 AI 기반의 Unknown 악성코드 탐지 기술의 탐지 정확도 및 성능을 향상시킬 수 있다. 또한, 가변 길이의 특성을 갖는 특징 정보를 기반으로 Unknown 악성코드 분류 및 탐지가 가능한 악성코드 탐지 기술을 제공할 수 있다. 또한, 문서형 및 스크립트형 악성파일의 탐지에도 적용 가능한 악성코드 탐지 기술을 제공할 수 있다. 도 12는 본 발명의 일실시예에 따른 가변 길이 명령코드를 이용한 알려지지 않은 악성코드 탐지 장치를 나타낸 블록도이다. 도 12를 참조하면, 본 발명의 일실시예에 따른 가변 길이 명령코드를 이용한 알려지지 않은 악성코드 탐지 장치 는 통신부, 프로세서 및 메모리를 포함한다. 통신부는 네트워크와 같은 통신망을 통해 알려지지 않은 악성코드 탐지를 위해 필요한 정보를 송수신하는 역할을 할 수 있다. 이 때, 네트워크는 장치들간에 데이터를 전달하는 통로를 제공하는 것으로서, 기존에 이용 되는 네트워크 및 향후 개발 가능한 네트워크를 모두 포괄하는 개념이다. 예를 들면, 네트워크는 인터넷 프로토콜(IP)을 통하여 대용량 데이터의 송수신 서비스 및 끊기는 현상이 없는 데이터 서비스를 제공하는 아이피망, 아이피를 기반으로 서로 다른 망을 통합한 아이피망 구조인 올 아이피(All IP)망 등일 수 있으며, 유선망, Wibro(Wireless Broadband)망, WCDMA를 포함하는 3세대 이동통신망, HSDPA(High Speed Downlink Packet Access)망 및 LTE 망을 포함하는 3.5세대 이동통신망, LTE advanced를 포함 하는 4세대 이동통신망, 위성통신망 및 와이파이(Wi-Fi)망 중에서 하나 이상을 결합하여 이루어질 수 있다. 또한, 네트워크는 한정된 지역 내에서 각종 정보장치들의 통신을 제공하는 유무선근거리 통신망, 이동체 상호 간 및 이동체와 이동체 외부와의 통신을 제공하는 이동통신망, 위성을 이용해 지구국과 지구국간 통신을 제공하는 위성통신망이거나 유무선 통신망 중에서 어느 하나이거나, 둘 이상의 결합으로 이루어질 수 있다. 한편, 네 트워크의 전송 방식 표준은, 기존의 전송 방식 표준에 한정되는 것은 아니며, 향후 개발될 모든 전송 방식 표준 을 포함할 수 있다. 프로세서는 탐지 대상으로부터 명령코드(OPCODE) 정보를 수집한다. 또한, 프로세서는 명령코드 정보를 피처 엔지니어링(FEATURE ENGINEERING)하여 가변 길이의 다차원 이미 지를 생성한다. 이 때, 다차원 이미지는 명령코드 정보에 상응하는 N-GRAM 기반의 다차원 RGB 이미지에 상응할 수 있다. 이 때, 명령코드 정보를 기반으로 가변 길이 코드인 헥사(HEX) 코드에 대한 N-GRAM 시퀀스를 저장하고, N-GRAM 시퀀스를 기반으로 3-GRAM 명령코드에 대한 RGB 코드 매핑을 수행하여 다차원 RGB 이미지를 생성할 수 있다. 이 때, 탐지 대상에 상응하는 실행형 파일에서 텍스트 섹션을 추출하고, 바이너리 분석 도구를 이용하여 텍스트 섹션의 로우(RAW) 데이터를 어셈블리 언어 형식의 명령코드로 변환하고, 명령코드를 기반으로 헥사 코드를 추출 할 수 있다. 이 때, 명령코드는 논리 연산, 프로그램 흐름 제어, 메모리 처리 및 산술 연산 중 적어도 하나의 기능을 제공하 는 코드일 수 있다. 이 때, 명령코드는 상기 어셈블리 언어 형식에 일대일 대응될 수 있다. 이 때, 명령코드는 1바이트 또는 2바이트에 상응하는 명령어 및 복수개의 오퍼랜드(OPERAND) 값들로 구성될 수 있다. 또한, 프로세서는 인공지능 기반의 딥러닝 모델로 다차원 이미지를 입력하여 알려지지 않은 악성코드를 탐지한다. 이 때, 학습을 통해 분류된 악성코드 별 특징 정보와 딥러닝 모델에서 출력되는 다차원 특징 정보 간의 유사도 를 고려하여 알려지지 않은 악성코드를 탐지할 수 있다. 또한, 프로세서는 복수개의 정상코드들 및 복수개의 악성코드들을 기반으로 수집된 명령코드 정보를 이용 하여 학습용 다차원 이미지를 생성하고, 학습용 다차원 이미지에 상응하게 학습데이터를 생성하고, 학습데이터 를 이용하여 딥러닝 모델을 학습시킬 수 있다. 이 때, 악성코드 별 복잡도(ENTROPY) 정보, 최초 생성 일자, 최종 수정 일자 및 유포사이트 정보 중 적어도 하 나를 획득하여 학습데이터로 사용할 수 있다. 메모리는 명령코드 정보 및 다차원 이미지를 저장한다. 또한, 메모리는 상술한 바와 같이 본 발명의 일실시예에 따른 알려지지 않은 악성코드 탐지 장치에서 발 생하는 다양한 정보를 저장한다. 실시예에 따라, 메모리는 알려지지 않은 악성코드 탐지 장치와 독립적으로 구성되어 알려지지 않은 악성 코드 탐지를 위한 기능을 지원할 수 있다. 이 때, 메모리는 별도의 대용량 스토리지로 동작할 수 있고, 동작 수행을 위한 제어 기능을 포함할 수도 있다. 한편, 알려지지 않은 악성코드 탐지는 메모리가 탑재되어 그 장치 내에서 정보를 저장할 수 있다. 일 구현예의 경우, 메모리는 컴퓨터로 판독 가능한 매체이다. 일 구현 예에서, 메모리는 휘발성 메모리 유닛일 수 있으며, 다른 구현예의 경우, 메모리는 비휘발성 메모리 유닛일 수도 있다. 일 구현예의 경우, 저장장치는 컴퓨터로 판 독 가능한 매체이다. 다양한 서로 다른 구현 예에서, 저장장치는 예컨대 하드디스크 장치, 광학디스크 장치, 혹 은 어떤 다른 대용량 저장장치를 포함할 수도 있다. 이와 같은 알려지지 않은 악성코드 탐지 장치를 이용함으로써 AI 기반의 Unknown 악성코드 탐지 기술의 탐지 정 확도 및 성능을 향상시킬 수 있다. 또한, 가변 길이의 특성을 갖는 특징 정보를 기반으로 Unknown 악성코드 분류 및 탐지가 가능한 악성코드 탐지 기술을 제공할 수 있다.또한, 문서형 및 스크립트형 악성파일의 탐지에도 적용 가능한 악성코드 탐지 기술을 제공할 수 있다. 도 13은 본 발명의 일실시예에 따른 컴퓨터 시스템을 나타낸 도면이다. 도 13을 참조하면, 본 발명의 실시예는 컴퓨터로 읽을 수 있는 기록매체와 같은 컴퓨터 시스템에서 구현될 수 있다. 도 13에 도시된 바와 같이, 컴퓨터 시스템은 버스를 통하여 서로 통신하는 하나 이상의 프 로세서, 메모리, 사용자 입력 장치, 사용자 출력 장치 및 스토리지를 포함할 수 있다. 또한, 컴퓨터 시스템은 네트워크에 연결되는 네트워크 인터페이스를 더 포함할 수 있 다. 프로세서는 중앙 처리 장치 또는 메모리나 스토리지에 저장된 프로세싱 인스트럭션들을 실행하는 반도체 장치일 수 있다. 메모리 및 스토리지는 다양한 형태의 휘발성 또는 비휘발성 저 장 매체일 수 있다. 예를 들어, 메모리는 ROM이나 RAM을 포함할 수 있다. 따라서, 본 발명의 실시예는 컴퓨터로 구현된 방법이나 컴퓨터에서 실행 가능한 명령어들이 기록된 비일시적인 컴퓨터에서 읽을 수 있는 매체로 구현될 수 있다. 컴퓨터에서 읽을 수 있는 명령어들이 프로세서에 의해서 수 행될 때, 컴퓨터에서 읽을 수 있는 명령어들은 본 발명의 적어도 한 가지 측면에 따른 방법을 수행할 수 있다. 이상에서와 같이 본 발명에 따른 가변 길이 명령코드를 이용한 알려지지 않은 악성코드 탐지 장치 및 이를 이용 한 방법은 상기한 바와 같이 설명된 실시예들의 구성과 방법이 한정되게 적용될 수 있는 것이 아니라, 상기 실 시예들은 다양한 변형이 이루어질 수 있도록 각 실시예들의 전부 또는 일부가 선택적으로 조합되어 구성될 수도 있다."}
{"patent_id": "10-2021-0060608", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 일실시예에 따른 가변 길이 명령코드를 이용한 알려지지 않은 악성코드 탐지 방법을 나타낸 동작흐름도이다. 도 2는 본 발명에 따른 악성코드 탐지 과정의 일 예를 나타낸 도면이다. 도 3은 본 발명에 따른 실행형 파일 구조의 일 예를 나타낸 도면이다. 도 4는 본 발명에 따른 명령코드의 일 예를 나타낸 도면이다. 도 5 내지 도 6은 본 발명에 따른 헥사 코드의 일 예를 나타낸 도면이다. 도 7은 본 발명에 따른 N-GRAM 시퀀스 생성 과정의 일 예를 나타낸 도면이다. 도 8은 본 발명에 따른 다차원 RGB 이미지 생성 과정의 일 예를 나타낸 도면이다. 도 9 내지 도 11은 본 발명에 따른 악성코드 분류 과정의 일 예를 나타낸 도면이다. 도 12는 본 발명의 일실시예에 따른 가변 길이 명령코드를 이용한 알려지지 않은 악성코드 탐지 장치를 나타낸 블록도이다. 도 13은 본 발명의 일실시예에 따른 컴퓨터 시스템을 나타낸 도면이다."}
