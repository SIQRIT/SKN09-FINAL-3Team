{"patent_id": "10-2020-0129663", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2022-0046351", "출원번호": "10-2020-0129663", "발명의 명칭": "미리 학습된 이미지 인페인팅 신경망을 파인튜닝하기 위한 장치 및 방법", "출원인": "주식회사 케이티", "발명자": "최형기"}}
{"patent_id": "10-2020-0129663", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "미리 학습된 이미지 인페인팅 신경망을 파인튜닝하는 파인튜닝 장치에 있어서,일부 영역이 마스킹 처리된 하나의 입력 이미지를 수신하고, 해당 입력 이미지의 마스킹 처리된 일부 영역을 복원하여 출력 이미지를 생성하는 상기 미리 학습된 이미지 인페인팅 신경망;상기 출력 이미지에서 랜덤하게 일부 영역을 마스킹 처리하여 상기 미리 학습된 이미지 인페인팅 신경망에 입력하는 과정을 소정 횟수만큼 반복하는 마스킹 처리부;상기 입력 이미지로부터 복원된 상기 출력 이미지를 타겟 이미지로 설정하고, 상기 마스킹 처리부에서 마스킹처리되어 상기 미리 학습된 이미지 인페인팅 신경망으로 입력된 이미지로부터 복원되어 생성된 출력 이미지와상기 타겟 이미지를 비교하여 손실값을 계산하는 손실 계산부; 및상기 손실값을 기초로 상기 미리 학습된 이미지 인페인팅 신경망의 파라미터를 업데이트하는 최적화부를 포함하는 파인튜닝 장치."}
{"patent_id": "10-2020-0129663", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 마스킹 처리부는,0 또는 1의 값으로 구성된 랜덤 바이너리 마스크를 생성하고, 상기 출력 이미지와 상기 랜덤 바이너리 마스크를곱하여, 상기 출력 이미지에서 랜덤하게 일부 영역을 마스킹 처리하는 것을 특징으로 하는 파인튜닝 장치."}
{"patent_id": "10-2020-0129663", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1항에 있어서,상기 손실 계산부는,상기 미리 학습된 이미지 인페인팅 신경망을 미리 학습할 때 사용한 손실 함수를 동일하게 사용하는 것을 특징으로 하는 파인튜닝 장치."}
{"patent_id": "10-2020-0129663", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제1항에 있어서,상기 최적화부는,상기 미리 학습된 이미지 인페인팅 신경망을 미리 학습할 때 사용한 최적화기 및 설정을 동일하게 사용하는 것을 특징으로 하는 파인튜닝 장치."}
{"patent_id": "10-2020-0129663", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제1항에 있어서,학습에 사용된 적이 없고 복원이 불필요한 완전한 상태의 타겟 이미지를 설정하고, 상기 완전한 상태의 타겟 이미지를 이용하여 상기 미리 학습된 이미지 인페인팅 신경망을 반복 파인튜닝하여 생성되는 출력 이미지와, 상기완전한 상태의 타겟 이미지를 비교한 손실값이, 임계값 이하가 될 때의 파인튜닝 반복 횟수를 최적의 파인튜닝반복 횟수로 결정하는 반복 횟수 결정부를 더 포함하는 것을 특징으로 하는 파인튜닝 장치."}
{"patent_id": "10-2020-0129663", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "미리 학습된 이미지 인페인팅 신경망을 파인튜닝하는 방법에 있어서,공개특허 10-2022-0046351-3-일부 영역이 마스킹 처리된 하나의 입력 이미지를 상기 미리 학습된 이미지 인페인팅 신경망에 입력하여 마스킹처리된 일부 영역이 복원된 제1출력 이미지를 생성하는 단계;상기 제1출력 이미지를 타겟 이미지로 설정하는 단계; 및상기 제1출력 이미지에서 랜덤하게 일부 영역을 마스킹 처리하여 상기 미리 학습된 이미지 인페인팅 신경망에입력하여 마스킹 처리된 일부 영역이 복원된 제2출력 이미지를 생성하고, 상기 제2출력 이미지와 상기 타겟 이미지를 비교하여 손실값을 계산하며, 계산된 손실값을 기초로 상기 미리 학습된 이미지 인페인팅 신경망의 파라미터를 업데이트하는 과정을 반복 수행하는 단계를 포함하는 방법."}
{"patent_id": "10-2020-0129663", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제6항에 있어서,상기 반복 수행하는 단계는,0 또는 1의 값으로 구성된 랜덤 바이너리 마스크를 생성하고, 상기 제1출력 이미지와 상기 랜덤 바이너리 마스크를 곱하여, 상기 제1출력 이미지에서 랜덤하게 일부 영역을 마스킹 처리하는 것을 특징으로 하는 방법."}
{"patent_id": "10-2020-0129663", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제6항에 있어서,상기 반복 수행하는 단계는,상기 미리 학습된 이미지 인페인팅 신경망을 미리 학습할 때 사용한 손실 함수를 동일하게 사용하여 상기 손실값을 계산하는 것을 특징으로 하는 방법."}
{"patent_id": "10-2020-0129663", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제6항에 있어서,상기 반복 수행하는 단계는,상기 미리 학습된 이미지 인페인팅 신경망을 미리 학습할 때 사용한 최적화기 및 설정을 동일하게 사용하여 상기 미리 학습된 이미지 인페인팅 신경망의 파라미터를 업데이트하는 것을 특징으로 하는 방법."}
{"patent_id": "10-2020-0129663", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제6항에 있어서,학습에 사용된 적이 없고 복원이 불필요한 완전한 상태의 타겟 이미지를 설정하는 단계; 및상기 완전한 상태의 타겟 이미지를 이용하여 상기 미리 학습된 이미지 인페인팅 신경망을 반복 파인튜닝하여 생성되는 출력 이미지와, 상기 완전한 상태의 타겟 이미지를 비교한 손실값이, 임계값 이하가 될 때의 파인튜닝반복 횟수를 최적의 파인튜닝 반복 횟수로 결정하는 단계를 더 포함하는 것을 특징으로 하는 방법."}
{"patent_id": "10-2020-0129663", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "제6항 내지 제10항 중 어느 한 항에 따른 방법을 컴퓨터 시스템을 통해 실행하는 컴퓨터 프로그램으로서 기록매체에 기록된 컴퓨터 프로그램."}
{"patent_id": "10-2020-0129663", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "일 실시예에 따른, 미리 학습된 이미지 인페인팅 신경망을 파인튜닝하는 파인튜닝 장치는, 일부 영역이 마스킹 처리된 하나의 입력 이미지를 수신하고, 해당 입력 이미지의 마스킹 처리된 일부 영역을 복원하여 출력 이미지를 생성하는 상기 미리 학습된 이미지 인페인팅 신경망; 상기 출력 이미지에서 랜덤하게 일부 영역을 마스킹 처리하 여 상기 미리 학습된 이미지 인페인팅 신경망에 입력하는 과정을 소정 횟수만큼 반복하는 마스킹 처리부; 상기 입력 이미지로부터 복원된 상기 출력 이미지를 타겟 이미지로 설정하고, 상기 마스킹 처리부에서 마스킹 처리되 어 상기 미리 학습된 이미지 인페인팅 신경망으로 입력된 이미지로부터 복원되어 생성된 출력 이미지와 상기 타 겟 이미지를 비교하여 손실값을 계산하는 손실 계산부; 및 상기 손실값을 기초로 상기 미리 학습된 이미지 인페 인팅 신경망의 파라미터를 업데이트하는 최적화부를 포함한다."}
{"patent_id": "10-2020-0129663", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 이미지 인페인팅 신경망 기술에 관한 것으로, 보다 구체적으로, 미리 학습된 이미지 인페인팅 신경망 을 더욱 정교하게 파인튜닝하기 위한 장치 및 방법에 관한 것이다."}
{"patent_id": "10-2020-0129663", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "이미지 인페인팅(Image Inpainting) 기술은, 이미지 내의 훼손되거나 비어 있는 영역을 시각적으로 자연스럽게 채워 복원하는 이미지 후처리 기술을 의미한다. 일반적으로 이미지 내에서 자막, 광고 등 불필요한 영역을 제거하고자 할 때, 제거된 영역이 주변부 영역과 비교하여 자연스럽게 보일 수 있도록 이미지를 합성할 때 많이 사 용되고 있다. 최근에는 딥러닝 기술의 발전과 함께 이미지 인페인팅 기술의 성능도 비약적으로 발전 중이며, 자 막과 같이 작은 영역 뿐만 아니라 이미지 내 존재하는 사람, 자동차, 배경 등 비교적 큰 사이즈의 객체를 제거 하는 데에도 많이 이용되고 있다. 일반적으로 인공지능 신경망을 학습하기 위해서는 학습 데이터가 필요하다.학습 데이터는 데이터와 그 데이터의 정답인 레이블의 쌍으로서, 인공지능 신경망을 학습하기 위해서는 많은 학습 데이터가 필요하다. 이미지 인페인 팅 신경망을 학습하기 위해서도 역시 많은 학습 데이터가 필요하다. 즉, 많은 수의 이미지와 그 이미지의 정답 인 레이블의 쌍이 필요하다. 그런데, 이러한 학습 데이터를 확보하는 것이 어렵고, 적은 수의 학습 데이터만을 확보하여 이미지 인페인팅 신경망을 학습할 경우, 학습된 이미지 인페인팅 신경망의 정확도가 낮은 실정이다. 딥 러닝 기술에서 파인튜닝(fine tunning)이란 미리 학습되어 있는 인공지능 신경망 모델의 파라미터를 미세하 게 조정하는 행위를 의미한다. 파인튜닝을 하기 위해서도, 학습할 때와 마찬가지로, 대량의 학습 데이터가 필요 한데, 학습 데이터를 확보하는 것이 어렵다."}
{"patent_id": "10-2020-0129663", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은, 일반적으로 이미지 내에는 동일하거나 유사한 패턴이 반복적으로 다수 존재한다는 것에 착안하여, 미리 학습된 이미지 인페인팅 신경망을 손쉽게 입수 가능한 마스킹 처리된 하나의 입력 이미지를 이용하여 더욱 정교하게 파인튜닝하기 위한 장치 및 방법을 제공하는데 그 목적이 있다."}
{"patent_id": "10-2020-0129663", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "일 실시예에 따른, 미리 학습된 이미지 인페인팅 신경망을 파인튜닝하는 파인튜닝 장치는, 일부 영역이 마스킹 처리된 하나의 입력 이미지를 수신하고, 해당 입력 이미지의 마스킹 처리된 일부 영역을 복원하여 출력 이미지 를 생성하는 상기 미리 학습된 이미지 인페인팅 신경망; 상기 출력 이미지에서 랜덤하게 일부 영역을 마스킹 처 리하여 상기 미리 학습된 이미지 인페인팅 신경망에 입력하는 과정을 소정 횟수만큼 반복하는 마스킹 처리부; 상기 입력 이미지로부터 복원된 상기 출력 이미지를 타겟 이미지로 설정하고, 상기 마스킹 처리부에서 마스킹 처리되어 상기 미리 학습된 이미지 인페인팅 신경망으로 입력된 이미지로부터 복원되어 생성된 출력 이미지와 상기 타겟 이미지를 비교하여 손실값을 계산하는 손실 계산부; 및 상기 손실값을 기초로 상기 미리 학습된 이미 지 인페인팅 신경망의 파라미터를 업데이트하는 최적화부를 포함한다. 상기 마스킹 처리부는, 0 또는 1의 값으로 구성된 랜덤 바이너리 마스크를 생성하고, 상기 출력 이미지와 상기 랜덤 바이너리 마스크를 곱하여, 상기 출력 이미지에서 랜덤하게 일부 영역을 마스킹 처리할 수 있다. 상기 손실 계산부는, 상기 미리 학습된 이미지 인페인팅 신경망을 미리 학습할 때 사용한 손실 함수를 동일하게 사용할 수 있다. 상기 최적화부는, 상기 미리 학습된 이미지 인페인팅 신경망을 미리 학습할 때 사용한 최적화기 및 설정을 동일 하게 사용할 수 있다. 상기 파인튜닝 장치는, 학습에 사용된 적이 없고 복원이 불필요한 완전한 상태의 타겟 이미지를 설정하고, 상기 완전한 상태의 타겟 이미지를 이용하여 상기 미리 학습된 이미지 인페인팅 신경망을 반복 파인튜닝하여 생성되 는 출력 이미지와, 상기 완전한 상태의 타겟 이미지를 비교한 손실값이, 임계값 이하가 될 때의 파인튜닝 반복 횟수를 최적의 파인튜닝 반복 횟수로 결정하는 반복 횟수 결정부를 더 포함할 수 있다. 일 실시예에 따른 미리 학습된 이미지 인페인팅 신경망을 파인튜닝하는 방법은, 일부 영역이 마스킹 처리된 하 나의 입력 이미지를 상기 미리 학습된 이미지 인페인팅 신경망에 입력하여 마스킹 처리된 일부 영역이 복원된 제1출력 이미지를 생성하는 단계; 상기 제1출력 이미지를 타겟 이미지로 설정하는 단계; 및 상기 제1출력 이미 지에서 랜덤하게 일부 영역을 마스킹 처리하여 상기 미리 학습된 이미지 인페인팅 신경망에 입력하여 마스킹 처 리된 일부 영역이 복원된 제2출력 이미지를 생성하고, 상기 제2출력 이미지와 상기 타겟 이미지를 비교하여 손 실값을 계산하며, 계산된 손실값을 기초로 상기 미리 학습된 이미지 인페인팅 신경망의 파라미터를 업데이트하 는 과정을 반복 수행하는 단계를 포함한다. 상기 반복 수행하는 단계는, 0 또는 1의 값으로 구성된 랜덤 바이너리 마스크를 생성하고, 상기 제1출력 이미지 와 상기 랜덤 바이너리 마스크를 곱하여, 상기 제1출력 이미지에서 랜덤하게 일부 영역을 마스킹 처리할 수 있 다. 상기 반복 수행하는 단계는, 상기 미리 학습된 이미지 인페인팅 신경망을 미리 학습할 때 사용한 손실 함수를 동일하게 사용하여 상기 손실값을 계산할 수 있다. 상기 반복 수행하는 단계는, 상기 미리 학습된 이미지 인페인팅 신경망을 미리 학습할 때 사용한 최적화기 및 설정을 동일하게 사용하여 상기 미리 학습된 이미지 인페인팅 신경망의 파라미터를 업데이트할 수 있다. 상기 방법은, 학습에 사용된 적이 없고 복원이 불필요한 완전한 상태의 타겟 이미지를 설정하는 단계; 및 상기 완전한 상태의 타겟 이미지를 이용하여 상기 미리 학습된 이미지 인페인팅 신경망을 반복 파인튜닝하여 생성되 는 출력 이미지와, 상기 완전한 상태의 타겟 이미지를 비교한 손실값이, 임계값 이하가 될 때의 파인튜닝 반복 횟수를 최적의 파인튜닝 반복 횟수로 결정하는 단계를 더 포함할 수 있다."}
{"patent_id": "10-2020-0129663", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명은, 미리 학습된 이미지 인페인팅 신경망을, 손쉽게 획득이 가능한 마스킹 처리된 하나의 입력 영상만을 이용하여 파인튜닝하여, 미리 학습된 이미지 인페인팅 신경망의 성능을 획기적으로 개선할 수 있다. 종래에는 이미지 인페인팅 신경망의 성능을 개선하기 위해서는, 대용량의 학습 데이터가 필요했지만, 본 발명은, 손쉽게 획득이 가능한 마스킹 처리된 하나의 입력 영상만을 이용하여 파인튜닝함으로써 대용량의 학습 데이터가 불필요하다. 본 발명은, 미리 학습된 이미지 인페인팅 신경망에 대한 최적의 파인튜닝 반복 횟수를 결정하여 이용함으로써, 반복 실험에 의해 파인튜닝 반복 횟수를 찾아야 하는 번거로움을 줄인다."}
{"patent_id": "10-2020-0129663", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "상술한 목적, 특징 및 장점은 첨부된 도면과 관련한 다음의 상세한 설명을 통하여 보다 분명해질 것이며, 그에"}
{"patent_id": "10-2020-0129663", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "따라 본 발명이 속하는 기술분야에서 통상의 지식을 가진 자가 본 발명의 기술적 사상을 용이하게 실시할 수 있 을 것이다. 또한, 본 발명을 설명함에 있어서 본 발명과 관련된 공지 기술에 대한 구체적인 설명이 본 발명의 요지를 불필요하게 흐릴 수 있다고 판단되는 경우에 그 상세한 설명을 생략하기로 한다. 이하, 첨부된 도면을 참조하여 본 발명에 따른 바람직한 일 실시예를 상세히 설명하기로 한다. 딥 러닝 기술에서 파인튜닝(fine tunning)이란 미리 학습되어 있는 인공지능 신경망 모델의 파라미터를 미세하 게 조정하는 행위를 의미한다. 즉, 미리 학습되어 있는 인공지능 신경망 모델에 추가 데이터를 투입하여 파라미 터를 업데이트하는 것이다. 본 발명에서는 학습 데이터를 이용하여 미리 학습된 이미지 인페인팅 신경망을 파인 튜닝하는 것으로서, 종래와 같이, 다수의 데이터와 레이블의 쌍으로 이루어진 학습 데이터를 대량으로 미리 준 비하여, 미리 학습된 이미지 인페인팅 신경망을 파인튜닝하는 것이 아닌, 하나의 입력 영상만을 이용하여, 상기 미리 학습된 이미지 인페인팅 신경망을 파인튜닝하여, 이미지 인페인팅 신경망의 정확도를 높인다. 도 1은 본 발명의 일 실시예에 따른 이미지 인페인팅 신경망의 파인튜닝 장치의 구성을 나타낸 도면이다. 도 1 을 참조하면, 본 실시예에 따른 파인튜닝 장치는, 미리 학습된 이미지 인페인팅 신경망, 마스킹 처리부 , 손실 계산부 및 최적화부를 포함한다. 이들은 프로그램으로 구현되어 메모리에 저장되고 적어 도 하나의 프로세서에 의해 실행될 수 있다. 미리 학습된 이미지 인페인팅 신경망(이하, 이미지 인페인팅 신경망이라 함)은, 데이터와 레이블의 쌍으로 이루어진 대용량의 학습 데이터로 미리 학습된 신경망이다. 바람직하게는, places2, celebA, PSV와 같은 대중에 공개된 대용량의 학습 데이터를 이용하여 각각의 방법들이 제공하는 학습 가이드라인을 따라 미리 충분히 학습 된다. 이미지 인페인팅 신경망는, 일부 영역이 훼손된, 즉 마스킹 처리된 하나의 입력 이미지를 수신한다. 예를 들어, 도 2는 일부 영역이 마스킹 처리된 하나의 입력 이미지로서, 해당 입력 이미지의 일부 영역이 훼손 되어 있다. 검은색으로 마스킹 처리되어 있다. 이미지 인페인팅 신경망은, 상기 일부 영역이 마스킹 처리 된 하나의 입력 이미지에 대해 미리 학습된 이미지 인페인팅 모델을 이용하여 인페인팅을 수행한다. 즉, 상기 마스킹 처리된 일부 영역을 복원하여 완성된 출력 이미지를 생성한다. 도 3은 도 2의 입력 이미지에 대해 인페 인팅이 수행된 출력 이미지를 나타낸다. 도 3에 도시된 바와 같이, 입력 이미지의 마스킹 처리된 일부 영역 이 복원되어 있다. 이미지 인페인팅 신경망은, 최초에 외부로부터 하나의 입력 이미지만을 수신하여 인페인팅을 수행하여 출 력 이미지를 생성하고, 이후에는 마스킹 처리부로부터 수신되는 상기 출력 이미지로부터 파생된 이미지들 에 대해 인페인팅을 수행하여 출력 이미지를 생성하며, 그 과정에서 최적화부에 의해 신경망의 파라미터들 이 정교하게 교정된다. 마스킹 처리부는, 상기 이미지 인페인팅 신경망에서 출력되는 출력 이미지에서 랜덤하게 일부 영역을 마스킹 처리하여 상기 이미지 인페이팅 신경망으로 출력한다. 도 4는 이미지 인페인팅 신경망에서 출 력되는 출력 이미지에 대해 랜덤하게 일부 영역을 마스킹 처리한 예이다. 마스킹 처리부는, 도 4에 도시된 바와 같이, 이미지 인페인팅 신경망에서 복원되어 출력되는 출력 이미지의 일부 영역을 마스킹 처리 하고, 이를 상기 이미지 인페이팅 신경망으로 출력한다. 일 실시예에서, 마스킹 처리부는, 0 혹은 1의 값으로만 구성된 랜덤 바이너리 마스크를 생성하고, 상기 이 미지 인페이팅 신경망에서 복원되어 출력되는 출력 이미지와 상기 랜덤 바이너리 마스크를 곱하기함으로써, 출력 이미지에서 랜덤하게 일부 영역을 마스킹 처리한다. 손실 계산부는, 최초의 입력 이미지로부터 복원된 출력 이미지를 상기 이미지 인페인팅 신경망로부터 수신하여 타겟 영상으로 저장하고, 저장된 타겟 영상과, 이후 상기 이미지 인페인팅 신경망으로부터 출력 되는 다른 출력 이미지를 비교하여 손실값을 계산하여 최적화부에 출력한다. 여기서 손실값은, 타겟 영상 과 출력 이미지 간의 차이값으로 정의할 수 있다. 바람직하게, 손실 계산부는, 상기 이미지 인페인팅 신경 망을 미리 학습할 때 사용한 손실 함수를 변경없이 그대로 사용한다. 최적화부는, 상기 손실 계산부로부터 수신되는 손실값이 최소가 되도록, 상기 이미지 인페인팅 신경 망의 파라미터를 업데이트한다. 최적화부는, Adam, SGD, RMSPROP 등 기존의 최적화기(Optimizer)를 사용할 수 있다. 바람직하게, 최적화부는, 상기 이미지 인페인팅 신경망을 미리 학습할 때 사용한 최 적화기와 설정들을 이용하면 더욱 효과적으로 상기 이미지 인페인팅 신경망의 파라미터를 업데이트할 수 있다. 인공지능 신경망은 일반적으로 입력층(input layer), 은닉층(hidden layer), 및 출력층(output layer)을 포함 하여 구성되고, 신호가 각 층을 통과하면서 가중치가 곱해지거나 더해지는 등의 처리가 이루어진다. 상기 최적 화부에서 업데이트하는 파라미터는 인공지능 신경망에서 신호가 각 층을 통과할 때 적용되는 가중치 등을 의미한다. 이상과 같이, 이미지 인페인팅 신경망은, 마스킹 처리부로부터 수신되는 랜덤하게 일부 영역이 마스 킹 처리된 이미지를 복원하여 출력 이미지를 생성하고, 마스킹 처리부는 그 출력 이미지에 대해 다시 랜덤 하게 일부 영역을 마스킹 처리한 후 이미지 인페인팅 신경망으로 출력한다. 이 과정에서 최적화부는 손실 계산부에서 계산되는 손실값이 최소가 되도록, 이미지 인페인팅 신경망의 파라미터를 업데이트 한다. 이러한 과정을 소정 횟수만큼 반복하게 되면, 이미지 인페인팅 신경망은 파인튜닝 되어 성능이 개선 된다. 즉, 하나의 완전하지 않은 입력 이미지를 이용하여 이미지 인페인팅 신경망의 파라미터를 업데이트 하여 파인튜닝할 수 있어, 대용량의 학습 데이터가 불필요하다. 도 2 내지 도 4의 이미지를 참조하면 일반적으로 이미지 내에는 동일하거나 유사한 패턴이 반복적으로 다수 존 재한다. 따라서 하나의 입력 영상의 일부 영역을 랜덤하게 마스킹하는 경우, 해당 입력 영상 내의 반복되는 패 턴들이 자동으로 마스킹될 확률이 높고, 따라서 위에서 설명한 하나의 입력 영상을 이용한 반복적인 파인튜닝 과정을 통해 이미지 인페인팅 신경망은 이미지 내 반복되는 패턴들을 특히 더 잘 복원할 수 있는 성능을 확보하게 된다. 도 5는 본 발명의 다른 실시예에 따른 이미지 인페인팅 신경망의 파인튜닝 장치의 구성을 나타낸 도면이다. 도 5를 참조한 본 실시예에서 도 1을 참조하여 설명한 실시예와 동일한 참조번호의 구성요소는 도 1을 참조하여 설 명한 기능 및 동작을 모두 포함한다. 도 5를 참조한 본 실시예의 파인튜닝 장치는, 반복 횟수 결정부를 더 포함한다. 훼손되어 불완전한 하나의 입력 영상을 이용하여 파인튜닝을 수행하는 반복 횟수를 결정하기 위해서, 훼손되거 나 비어있는 부분이 없고 학습에 사용된 적이 없는 완전한 타겟 이미지를 준비한다. 타겟 이미지는 손실 계산부 에 저장되고, 이미지 인페인팅 신경망에는 그 타겟 이미지의 일부 영역을 마스킹 처리한 이미지가 최 초의 입력 영상으로서 입력된다. 이 부분이 도 1을 참조한 실시예와 다른 점이다. 도 1을 참조한 실시예에서는, 훼손된 입력 이미지로부터 복원된 출력 이미지가 타겟 이미지로 설정되지만, 도 5를 참조한 본 실시예에서는 훼 손되지 않은 완전한 이미지를 타겟 이미지로 설정한다. 실시예에 따라서는, 마스킹 처리부에서 완전한 이미지인 타겟 이미지의 일부 영역을 마스킹 처리하여 이미 지 인페인팅 신경망으로 출력할 수 있고, 또는 다른 툴을 통해 사용자가 상기 완전한 이미지인 타겟 이미 지의 일부 영역을 마스킹 처리하고 이를 입력 이미지로서 이미지 인페인팅 신경망에 입력할 수 있다. 이미지 인페인팅 신경망은, 아직 파인튜닝 되지 않은 상태이고, 상기 완전한 이미지인 타겟 이미지로부터 마스킹 처리되어 만들어진 최초의 입력 영상을 복원하여 제1출력 이미지를 출력한다. 손실 계산부는, 기 저장된 타겟 이미지와 상기 제1출력 이미지를 비교하여 제1손실값을 계산하고, 최적화부는 제1손실값을 기 초로 이미지 인페인팅 신경망의 파라미터를 업데이트한다. 이로써 첫 번째 파인튜닝 과정이 완료된다. 이후, 마스킹 처리부는, 제1출력 이미지에서 랜덤하게 선택한 일부 영역을 마스킹 처리하여 이미지 인페인 팅 신경망으로 출력하고, 이미지 인페인팅 신경망은 이미지를 복원하여 제2출력 이미지를 생성한다. 손실 계산부는, 기 저장된 타겟 이미지와 상기 제2출력 이미지를 비교하여 제2손실값을 계산하고, 최적화 부는 제2손실값을 기초로 이미지 인페인팅 신경망의 파라미터를 업데이트한다. 이로써 두 번째 파인 튜닝 과정이 완료된다. 이와 같은 파인튜닝 과정이 반복 수행된다. 반복 횟수 결정부는, 파인튜닝 반복 과정에서 출력 이미지와 타겟 이미지 간의 차이값, 즉 손실값이 임계 치 이하가 되는 시점을 확인하고, 그 시점까지 수행된 파인튜닝 반복 횟수를 최적의 파인튜닝 반복 횟수로 결정 한다. 즉, 반복 횟수 결정부는, 복원이 필요 없고 학습에 한번도 사용된 적이 없는 완전한 상태의 타겟 이 미지와, 그 타겟 이미지를 기초로 파인튜닝이 반복 수행되어 출력되는 출력 이미지 간의 손실값이 임계치 이하 가 되는 파인튜닝 반속 횟수를 최적의 파인튜닝 반복 횟수로 결정한다. 이와 같이 결정되는 최적의 파인튜닝 반 복 횟수는 다양한 종류의 미리 학습된 이미지 인페인팅 신경망을 파인튜닝하는데 활용될 수 있다. 도 5를 참조하여 설명한 바와 같이, 복원이 필요 없는 완전한 타겟 이미지를 이용하여 파인튜닝을 수행하여, 타 겟 이미지와 출력 이미지 간의 손실값이 임계치 이하가 되도록 파인튜닝을 반복하는 것이 가장 바람직하다. 그 러나, 복원이 필요 없고 학습에 사용되지 않은 완전한 타겟 이미지를 확보하는 것은 용이하지 않고, 불완전한, 즉 훼손된 이미지를 확보하는 것이 더 용이하고, 이러한 훼손된 이미지를 하나의 입력 영상으로 이용하여 파인 튜닝을 수행하는 것이 일반적이다. 이와 같이 훼손된 이미지를 입력 영상으로 이용하여 이미지 인페인팅 신경망 을 파인튜닝하는데 있어, 개발자들은 파인튜닝 반복 횟수를 실험을 통해 확인해야 하는데, 상기 결정된 최적의 파인튜닝 반복 횟수는 보편적으로 활용될 수 있는 값이기 때문에, 개발자들이 이미지 인페인팅 신경망을 개발하 는데 있어서 파인튜닝 반복 횟수를 실험을 통해 확인하지 않아도 된다. 도 6은 본 발명의 일 실시예에 따른 미리 학습된 이미지 인페인팅 신경망을 파인튜닝하는 방법을 설명하는 흐름 도이다. 도 6을 참조하면, 단계 S601에서, 파인튜닝 장치는, 일부 영역이 훼손된, 즉 마스킹 처리된 하나의 입력 이미지 를 이미지 인페인팅 신경망으로 입력한다. 단계 S602에서, 파인튜닝 장치는, 상기 이미지 인페인팅 신경망을 통해 상기 입력 이미지를 복원하여 출력 이미지를 생성한다. 즉, 이미지 인페인팅 신경망은, 상기 일부 영역이 마스킹 처리된 하나의 입력 이미지 에 대해 미리 학습된 이미지 인페인팅 모델을 이용하여 상기 마스킹 처리된 일부 영역을 복원하여 완성된 출력 이미지를 생성한다. 단계 S603에서, 파인튜닝 장치는, 상기 단계 S602에서 생성된 출력 이미지를 타겟 이미지로 설정한다. 즉, 상기 입력 영상으로부 복원된 출력 이미지를 타겟 이미지로 설정하는 것이다. 단계 S604에서, 파인튜닝 장치는, 상기 단계 S602에서 생성된 출력 이미지에서 랜덤하게 일부 영역을 마스킹 처 리하여 상기 이미지 인페이팅 신경망으로 입력한다. 일 실시예에서, 파인튜닝 장치는, 0 혹은 1의 값으로 만 구성된 랜덤 바이너리 마스크를 생성하고, 상기 단계 S602에서 생성된 출력 이미지와 상기 랜덤 바이너리 마 스크를 곱하기함으로써, 출력 이미지에서 랜덤하게 일부 영역을 마스킹 처리한다. 단계 S605에서, 파인튜닝 장치는, 상기 이미지 인페인팅 신경망을 통해 상기 단계 S604에서 입력된 일부 영역이 마스킹 처리된 출력 이미지의 해당 마스킹 처리된 일부 영역을 복원하여 또 다른 출력 이미지를 생성한 다. 단계 S606에서, 파인튜닝 장치는, 상기 단계 S605에서 생성된 출력 이미지와 상기 단계 S603에서 설정된 타겟 이미지를 비교하여 손실값을 계산한다. 여기서 손실값은, 타겟 이미지와 출력 이미지 간의 차이값으로 정의할 수 있다. 바람직하게, 손실값을 계산하는데 있어서, 상기 이미지 인페인팅 신경망을 미리 학습할 때 사용 한 손실 함수를 변경없이 그대로 사용한다. 단계 S607에서, 파인튜닝 장치는, 상기 단계 S606에서 계산된 손실값을 기초로 상기 이미지 인페인팅 신경망 의 파라미터를 업데이트한다. 파인튜닝 장치는, 상기 손실값이 최소가 되도록, 상기 이미지 인페인팅 신경 망의 파라미터를 업데이트한다. 파인튜닝 장치는, Adam, SGD, RMSPROP 등 기존의 최적화기(Optimizer)를 사용할 수 있다. 바람직하게, 파인튜닝 장치는, 상기 이미지 인페인팅 신경망을 미리 학습할 때 사용한 최 적화기와 설정들을 이용하면 더욱 효과적으로 상기 이미지 인페인팅 신경망의 파라미터를 업데이트할 수 있다. 단계 S608에서, 파인튜닝 장치는, 파인튜닝을 실시한 반복 횟수가 미리 설정된 임계값보다 작은지 확인하고, 반 복 횟수가 임계값보다 작은 경우, 단계 S604부터 다시 반복하여, 미리 설정된 임계값만큼 파인튜닝을 반복한다. 도 7은 본 발명의 일 실시예에 따른 미리 학습된 이미지 인페인팅 신경망을 파인튜닝하는 최적의 반복 횟수를 결정하는 방법을 설명하는 흐름도이다. 도 7을 참조하면, 단계 S701에서, 파인튜닝 장치는, 이미지 인페인팅 신경망의 학습에 사용된 적이 없고 훼손이 없는 완전한 새로운 이미지를 타겟 이미지로 설정한다. 단계 S702에서, 파인튜닝 장치는, 상기 타겟 이미지에서 랜덤하게 일부 영역을 마스킹하여 상기 미리 학습된 이 미지 인페인팅 신경망으로 입력한다. 일 실시예에서, 파인튜닝 장치는, 0 혹은 1의 값으로만 구성된 랜덤 바이너리 마스크를 생성하고, 상기 타겟 이미지와 상기 랜덤 바이너리 마스크를 곱하기함으로써, 타겟 이미지에 서 랜덤하게 일부 영역을 마스킹 처리한다. 단계 S703에서, 파인튜닝 장치는, 상기 마스킹 처리된 타겟 이미지를 상기 이미지 인페인팅 신경망을 통해 복원하여 출력 이미지를 생성한다. 즉, 이미지 인페인팅 신경망은, 상기 일부 영역이 마스킹 처리된 타겟 이미지에 대해 미리 학습된 이미지 인페인팅 모델을 이용하여 상기 마스킹 처리된 일부 영역을 복원하여 완성된 출력 이미지를 생성한다. 단계 S704에서, 파인튜닝 장치는, 상기 단계 S702에서 생성된 출력 이미지와, 상기 타겟 이미지를 비교하여 손 실값을 계산한다. 여기서 손실값은, 타겟 이미지와 출력 이미지 간의 차이값으로 정의할 수 있다. 바람직하게, 손실값을 계산하는데 있어서, 상기 이미지 인페인팅 신경망을 미리 학습할 때 사용한 손실 함수를 변경없 이 그대로 사용한다. 단계 S705에서, 파인튜닝 장치는, 계산된 손실값이 임계값 이하인지 확인한다. 손실값이 임계값 보다 큰 경우, 단계 S706에서, 파인튜닝 장치는, 상기 출력 이미지에서 랜덤하게 일부 영역을 마스킹하여 다시 상기 이미지 인 페인팅 신경망으로 입력하고, 단계 S703부터 반복한다. 상기 단계 S705에서 확인한 결과, 손실값이 임계값 이하인 경우, 단계 S707에서, 파인튜닝 장치는, 그 동안 수 행된 파인튜닝 반복 횟수를 최적의 파인튜닝 반복 횟수로 결정한다. 이와 같이 결정된 최적의 파인튜닝 반복 횟수는, 개발자들이 이미지 인페인팅 신경망을 개발하는데 있어서 파인튜닝 반복 횟수를 실험을 통해 확인하지 않 아도 된다. 따라서, 도 6을 참조한 실시예의 단계 S608에서 기준이 되는 임계 횟수는, 도 7을 참조하여 결정된 최적의 파인튜닝 반복 횟수가 사용될 수 있다. 본 명세서는 많은 특징을 포함하는 반면, 그러한 특징은 본 발명의 범위 또는 특허청구범위를 제한하는 것으로 해석되어서는 안 된다. 또한, 본 명세서에서 개별적인 실시예에서 설명된 특징들은 단일 실시예에서 결합되어 구현될 수 있다. 반대로, 본 명세서에서 단일 실시예에서 설명된 다양한 특징들은 개별적으로 다양한 실시예에 서 구현되거나, 적절히 결합되어 구현될 수 있다. 도면에서 동작들이 특정한 순서로 설명되었으나, 그러한 동작들이 도시된 바와 같은 특정한 순서로 수행되는 것으로, 또는 일련의 연속된 순서, 또는 원하는 결과를 얻기 위해 모든 설명된 동작이 수행되는 것으로 이해되어 서는 안 된다. 특정 환경에서 멀티태스킹 및 병렬 프로세싱이 유리할 수 있다. 아울러, 상술한 실시예에서 다양 한 시스템 구성요소의 구분은 모든 실시예에서 그러한 구분을 요구하지 않는 것으로 이해되어야 한다. 상술한 프로그램 구성요소 및 시스템은 일반적으로 단일 소프트웨어 제품 또는 멀티플 소프트웨어 제품에 패키지로 구 현될 수 있다. 상술한 바와 같은 본 발명의 방법은 프로그램으로 구현되어 컴퓨터로 읽을 수 있는 형태로 기록매체(시디롬, 램, 롬, 플로피 디스크, 하드 디스크, 광자기 디스크 등)에 저장될 수 있다. 이러한 과정은 본 발명이 속하는 기술 분야에서 통상의 지식을 가진 자가 용이하게 실시할 수 있으므로 더 이상 상세히 설명하지 않기로 한다."}
{"patent_id": "10-2020-0129663", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "이상에서 설명한 본 발명은, 본 발명이 속하는 기술분야에서 통상의 지식을 가진 자에게 있어 본 발명의 기술적 사상을 벗어나지 않는 범위 내에서 여러 가지 치환, 변형 및 변경이 가능하므로 전술한 실시예 및 첨부된 도면 에 의해 한정되는 것이 아니다."}
{"patent_id": "10-2020-0129663", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 일 실시예에 따른 이미지 인페인팅 신경망의 파인튜닝 장치의 구성을 나타낸 도면이다. 도 2는 일부 영역이 마스킹 처리된 하나의 입력 이미지의 예를 나타낸 도면이다. 도 3은 도 2의 입력 이미지에 대해 인페인팅이 수행된 출력 이미지를 나타낸 도면이다. 도 4는 도 1의 이미지 인페인팅 신경망에서 출력되는 출력 이미지에 대해 랜덤하게 일부 영역을 마스킹 처리한 예이다. 도 5는 본 발명의 다른 실시예에 따른 이미지 인페인팅 신경망의 파인튜닝 장치의 구성을 나타낸 도면이다. 도 6은 본 발명의 일 실시예에 따른 미리 학습된 이미지 인페인팅 신경망을 파인튜닝하는 방법을 설명하는 흐름 도이다. 도 7은 본 발명의 일 실시예에 따른 미리 학습된 이미지 인페인팅 신경망을 파인튜닝하는 최적의 반복 횟수를 결정하는 방법을 설명하는 흐름도이다."}
