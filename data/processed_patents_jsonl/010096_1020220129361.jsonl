{"patent_id": "10-2022-0129361", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2024-0049894", "출원번호": "10-2022-0129361", "발명의 명칭": "망막 OCT 영상의 층 분할 모델 학습 방법 및 시스템", "출원인": "주식회사 스파이더코어", "발명자": "이상일"}}
{"patent_id": "10-2022-0129361", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "인공지능을 이용한 망막 OCT 영상의 층 분할 모델 학습 시스템에 의해 각 단계가 수행되는 망막 OCT 영상의 층분할 모델 학습 방법에 있어서, 미리 저장된 제1 그룹 망막 이미지에 스타일 전이(style transfer) 기술을 적용하여 제2 그룹 망막 이미지를 생성하는 단계; 및 상기 제1 그룹 망막 이미지와 제2 그룹 망막 이미지에 기초하여 망막 OCT 영상의 층 분할 모델을 구축하는 단계를 포함하는 망막 OCT 영상의 층 분할 모델 학습 방법."}
{"patent_id": "10-2022-0129361", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 제1 그룹 망막 이미지는 복수의 망막 이미지를 포함하고, 상기 복수의 망막 이미지 각각은 콘텐트 이미지(content image)와 스타일 이미지(style image) 쌍을 포함하는것을 특징으로 하는 망막 OCT 영상의 층 분할 모델 학습 방법."}
{"patent_id": "10-2022-0129361", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제2항에 있어서,상기 제2 그룹 망막 이미지를 생성하는 단계는, 상기 복수의 망막 이미지에 포함된 제1 그룹 망막 이미지의 콘텐트 이미지(content image)와 스타일 이미지(style image) 쌍에서 미리 저장된 스타일 전이 모델에 의해 스타일 이미지를 전이시켜 제2 그룹 망막 이미지를생성하고, 상기 제1 그룹 망막 이미지와 제2 그룹 망막 이미지에 대하여 CLAHE (Contrast Limited Adaptive HistogramEqualization) 처리를 수행하는 것을 특징으로 하는 망막 OCT 영상의 층 분할 모델 학습 방법."}
{"patent_id": "10-2022-0129361", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제3항에 있어서,상기 스타일 전이 모델은 콘텐트 손실 함수(content loss function)가 콘텐트 이미지와 상기 제2 그룹 망막 이미지 사이의 요소별 에러(element-wise error)를 최소화하고, 스타일 손실 함수(style loss function)가 스타일 이미지와 제2 그룹 망막 이미지 사이의 통계별 에러(statistic-wise error)를 최소화하는 것을 특징으로 하는 망막 OCT 영상의 층 분할 모델 학습 방법."}
{"patent_id": "10-2022-0129361", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제3항에 있어서,상기 CLAHE 처리는 이미지를 소정의 블록들로 나누어 각 블록들을 미리 설정한 콘트라스트 제한값(ContrastLimit)을 초과하는 픽셀들을 상기 콘트라스트 제한값을 초과하지 않는 픽셀들에 균일하게 재배치하는 것을 특징공개특허 10-2024-0049894-3-으로 하는 망막 OCT 영상의 층 분할 모델 학습 방법."}
{"patent_id": "10-2022-0129361", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제1항에 있어서,상기 망막 OCT 영상의 층 분할 모델을 구축하는 단계는, 상기 제1 그룹 망막 이미지와 제2 그룹 망막 이미지를 훈련 세트, 검증데이터 세트, 테스트 세트로 분할하며, 상기 훈련 세트의 망막 이미지에 대하여 데이터 증강처리(data augmentation)를 적용하여 망막 OCT 영상의 층분할 모델을 생성하는 것을 특징으로 하는 망막 OCT 영상의 층 분할 모델 학습 방법."}
{"patent_id": "10-2022-0129361", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제6항에 있어서,상기 망막 OCT 영상의 층 분할 모델을 생성하는 것은, 상기 훈련 세트로 분할된 망막 이미지 내에서 픽셀 단위로 클래스를 분류하고, 각 클래스에 대하여 필터링을 수행하여 컬럼별로 최대값을 가지는 인덱스를 라벨로 선택함으로써 라벨링을 수행하는 것을 특징으로 하는 망막 OCT 영상의 층 분할 모델 학습 방법."}
{"patent_id": "10-2022-0129361", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "미리 저장된 제1 그룹 망막 이미지에 스타일 전이(style transfer) 기술을 적용하여 제2 그룹 망막 이미지를 생성하는 데이터 생성부; 및상기 제1 그룹 망막 이미지와 제2 그룹 망막 이미지에 기초하여 망막 OCT 영상의 층 분할 모델을 구축하는 분할모델 구축부를 포함하는 망막 OCT 영상의 층 분할 모델 학습 시스템."}
{"patent_id": "10-2022-0129361", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제8항에 있어서,상기 제1 그룹 망막 이미지는 복수의 망막 이미지를 포함하고, 상기 복수의 망막 이미지 각각은 콘텐트 이미지(content image)와 스타일 이미지(style image) 쌍을 포함하는것을 특징으로 하는 망막 OCT 영상의 층 분할 모델 학습 시스템."}
{"patent_id": "10-2022-0129361", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제9항에 있어서,상기 데이터 생성부는, 상기 복수의 망막 이미지에 포함된 제1 망막 이미지의 콘텐트 이미지(content image)와 스타일 이미지(styleimage) 쌍에서 미리 저장된 스타일 전이 모델에 의해 스타일 이미지를 전이시켜 제2 망막 이미지를 생성하는 스타일 전이모듈; 및 상기 제1 그룹 망막 이미지와 제2 그룹 망막 이미지에 대하여 CLAHE (Contrast Limited Adaptive HistogramEqualization) 처리를 수행하는 균일화모듈공개특허 10-2024-0049894-4-을 포함하는 것을 특징으로 하는 망막 OCT 영상의 층 분할 모델 학습 시스템."}
{"patent_id": "10-2022-0129361", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "제8항에 있어서,상기 분할 모델 구축부는, 상기 제1 그룹 망막 이미지와 제2 그룹 망막 이미지를 훈련 세트, 검증데이터 세트, 테스트 세트로 분할하는 분할모듈, 상기 훈련 세트의 망막 이미지에 대하여 데이터 증강처리(data augmentation)를 적용하는 데이터 증강처리모듈, 상기 제1 그룹 망막 이미지와 제2 그룹 망막 이미지 내에서 픽셀 단위로 클래스를 분류하는 분류 모듈;미리 설정된 손실함수를 이용하여 망막 OCT 영상의 층 분할 모델 의 가중치와 바이어스를 찾는 손실함수 연산모듈; 및 각 클래스에 대하여 필터링을 수행하여 컬럼별로 최대값을 가지는 인덱스를 라벨로 선택함으로써 라벨링을 수행하는 라벨링 모듈; 을 포함하는 것을 특징으로 하는 망막 OCT 영상의 층 분할 모델 학습 시스템."}
{"patent_id": "10-2022-0129361", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제11항에 있어서,상기 분할 모델 구축부는, 상기 훈련 세트로 분할된 망막 이미지 내에서 픽셀 단위로 클래스를 분류하는 분류 모듈;각 클래스에 대하여 필터링을 수행하여 컬럼별로 최대값을 가지는 인덱스를 라벨로 선택함으로써 라벨링을 수행하는 라벨링 모듈을 포함하는 것을 특징으로 하는 망막 OCT 영상의 층 분할 모델 학습 시스템."}
{"patent_id": "10-2022-0129361", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "제11항에 있어서,상기 데이터 증강처리모듈은 수평 뒤집기(horizontal flip), 수직 편이(vertical shift), 회전, 밝기처리, 대비처리 또는 믹스업(Mixup) 중 하나 이상을 수행하는 것을 특징으로 하는 망막 OCT 영상의 층 분할 모델 학습시스템."}
{"patent_id": "10-2022-0129361", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명의 일 실시예는 망막 OCT 영상의 층 분할 모델 학습 방법 및 시스템에 관한 것으로, 인공지능을 이용한 망막 OCT 영상의 층 분할 모델 학습 시스템에 의해 각 단계가 수행되는 망막 OCT 영상의 층 분할 모델 학습 방법 은, 미리 저장된 제1 그룹 망막 이미지에 스타일 전이(style transfer) 기술을 적용하여 제2 그룹 망막 이미지를 생성하는 단계 및 상기 제1 그룹 망막 이미지와 제2 그룹 망막 이미지에 기초하여 망막 OCT 영상의 층 분할 모델 을 구축하는 단계를 포함할 수 있다."}
{"patent_id": "10-2022-0129361", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명의 일 실시예는 망막 OCT 영상의 층 분할 모델 학습 방법 및 시스템 에 관한 것으로, 보다 상세하게는 스타일 전이 기술을 이용하여 데이터셋을 생성하고, 생성된 데이터셋에 기초하여 망막 OCT 영상의 층 분할 모델 학습하는 방법 및 시스템에 관한 것이다."}
{"patent_id": "10-2022-0129361", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "안과의 망막분야 중 가장 유병 빈도가 높은 당뇨망막병증, 황반변성, 황반부종, 중심장액맥락망막병증 등의 질 환의 공통점은 혈액-망막장벽의 손상을 동반한다는 점이다. 혈액-망막장벽의 손상은 망막 혹은 맥락막 혈관신생, 이상 망막혈관, 망막색소상피의 부전 등에서 나타난다. 혈액-망막장벽의 손상 여부는 주요한 망막질 환들에 있어서 예후적 의미를 갖기 때문에 진단적 측면에서 중요하고, 손상부위는 다양한 치료에 있어서 해부학적인 타겟이 되기 때문에 치료방침의 결정에 있어서 초점이 된다. 현재, 조영제주사를 이용한 형광안저혈관조영술에서 형광누출이 관찰되면 혈액-망막장벽이 손상되었는지를 파악 할 수는 있다. 그러나 이는 2차원적인 영상으로서 여러 망막층 중 어느 층에서 형광누출(혈액-망막장벽이 손 상)이 발생하였는지는 알 수가 없다. 최근 주요 망막질환의 진단기법으로서. 망막 광학 간섭 단층 촬영(OCT;Optical Coherence Tomography)이 보편적 으로 사용되고 있다. OCT는 CT나 MRI와 같이 조직의 절단면 영상을 보여준다. 다만, 방사선이나 자기장을 이용 하는 CT나 MRI와 달리 OCT는 low coherence의 레이저 광을 이용하여 망막과 맥락막층의 세밀한 절단면 영상을 제공한다. 그러나 이러한 OCT 이미지에서 망막층의 세분화는 임상적 경험에 의해 이루어지고 있으므로 초보자가 분석하기 어려울 수 있으며, 개인마다 분석 결과에 차이가 발생할 수 있다. 따라서, 환자의 OCT 이미지를 학습하여 망막층의 세분화를 자동으로 수행하는 인공지능 모델이 요구된다. 한편, 인공 지능 모델에서는 다양하고 풍부한 데이터 확보가 매우 중요하다. 부족한 데이터로 모델을 학습시키 면 인공지능 모델의 정확도 및 강건성이 떨어지는 문제가 있다. 그럼에도 의료 정보인 환자의 OCT 이미지를 충 분히 확보하는 것은 용이한 일이 아니다."}
{"patent_id": "10-2022-0129361", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은 상기의 문제점을 해결하기 위해 창안된 것으로서, 스타일 전이를 이용해 학습 데이터셋을 충분히 확 보하고, 망막 OCT 영상으로부터 자동으로 망막 층을 분할하는 방법 및 시스템을 제공하고자 한다. 스타일 전이를 이용해 데이터 부족 문제를 해결하고, 다양한 OCT 이미지에 대하여 강건한 특성을 가지는 망막 층 분할 방법 및 장치를 제공하고자 한다. 본 발명이 해결하고자 하는 과제는 이상에서 언급한 과제(들)로 제한되지 않으며, 언급되지 않은 또 다른 과제 (들)은 아래의 기재로부터 당업자에게 명확하게 이해될 수 있을 것이다."}
{"patent_id": "10-2022-0129361", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "이를 위하여, 본 발명의 일 실시예에 따르면, 망막 OCT 영상의 층 분할 모델 학습 방법은 미리 저장된 제1 그룹 망막 이미지에 스타일 전이(style transfer) 기술을 적용하여 제2 그룹 망막 이미지를 생성하는 단계 및 상기 제1 그룹 망막 이미지와 제2 그룹 망막 이미지에 기초하여 망막 OCT 영상의 층 분할 모델을 구축하는 단계를 포 함할 수 있다. 본 발명의 다른 실시예에 따른 망막 OCT 영상의 층 분할 모델 학습 시스템은 미리 저장된 제1 그룹 망막 이미지 에 스타일 전이(style transfer) 기술을 적용하여 제2 그룹 망막 이미지를 생성하는 데이터 생성부, 및 상기 제 1 그룹 망막 이미지와 제2 그룹 망막 이미지에 기초하여 망막 OCT 영상의 층 분할 모델을 구축하는 분할 모델 구축부를 포함한다."}
{"patent_id": "10-2022-0129361", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명에 따르면, 부족한 데이터셋에 기초하여 강건한 망막 OCT 영상의 층 분할 모델을 제공할 수 있다. 망막 OCT 영상에 스타일 전이 기술을 이용하여 학습 데이터 부족 문제를 해결할 수 있다."}
{"patent_id": "10-2022-0129361", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 2, "content": "본 발명의 효과들은 이상에서 언급한 효과들로 제한되지 않으며, 언급되지 않은 또 다른 효과들은 아래의 기재 로부터 통상의 기술자에게 명확하게 이해될 수 있을 것이다."}
{"patent_id": "10-2022-0129361", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하, 첨부된 도면을 참조하여 본 발명에 따른 실시 예를 상세하게 설명한다. 본 발명의 구성 및 그에 따른 작 용 효과는 이하의 상세한 설명을 통해 명확하게 이해될 것이다. 본 발명의 상세한 설명에 앞서, 동일한 구성요 소에 대해서는 다른 도면 상에 표시되더라도 가능한 동일한 부호로 표시하며, 공지된 구성에 대해서는 본 발명 의 요지를 흐릴 수 있다고 판단되는 경우 구체적인 설명은 생략하기로 함에 유의한다. 도 1은 본 발명의 일 실시예에 따른 망막 OCT 영상의 층 분할 모델 학습 시스템의 구성을 개략적으로 나타낸 도 면이다. 도 1에 도시된 바와 같이, 본 발명의 망막 OCT 영상의 층 분할 모델 학습 시스템은 망막 OCT 영상의 층 분 할 모델 학습 서버, 데이터베이스 및 입출력 장치를 포함할 수 있다. 망막 OCT 영상의 층 분할 모델 학습 서버는 스타일 전이를 이용해 학습 데이터셋을 생성하고, 망막 OCT 영 상으로부터 망막 층을 분할하는 모델을 학습시킨다. 망막 OCT 영상의 층 분할 모델 학습 서버는 데이터 생성부와 분할모델 구축부를 포함한다. 데이터 생성부는 미리 저장된 제1 그룹 망막 이미지에 스타일 전이(style transfer) 기술을 적용하여 제2 그룹 망막 이미지를 생성한다. 제1 그룹 망막 이미지는 복수의 망막 이미지를 포함하고, 상기 복수의 망막 이미 지 각각은 콘텐트 이미지(content image)와 스타일 이미지(style image) 쌍을 포함한다. 스타일 전이 기술은 콘텐트 이미지(content image)와 스타일 이미지(style image) 쌍이 주어졌을 때 그 이미지 의 주된 형태는 콘텐트 이미지와 유사하게 유지하면서 스타일만 주어진 스타일 이미지와 유사하게 바꾸는 기술 이다. 스타일 전이 기술에 대하여는 도 2를 참조하여 상세히 설명하기로 한다. 분할모델 구축부는 제1 그룹 망막 이미지와 제2 그룹 망막 이미지에 기초하여 망막 OCT 영상의 층 분할 모 델을 구축한다. OCT 영상의 층 분할 모델을 구축에 대하여는 도 3을 참조하여 상세히 설명하기로 한다. 데이터베이스는 망막 OCT 영상의 층 분할 모델 학습 서버가 스타일 전이(style transfer) 기술을 적 용하여 제2 그룹 망막 이미지를 생성하는데 필요한 정보, 프로그램 및 망막 OCT 영상의 층 분할 모델을 학습하 기 위해 필요한 정보, 프로그램 등을 저장하거나 데이터베이스화한다. 예컨대, 데이터 생성부에 의해 생성 되는 데이터셋을 저장하거나, 데이터 생성부에서 데이터셋을 생성하기 위해 사용되는 스타일 전이 모델을저장할 수 있다. 또한, 분할모델 구축부에 의해 학습되는 망막 OCT 영상의 층 분할 모델 및 학습을 위해 생성되는 중간 데이터를 저장할 수 있다. 이러한 데이터베이스는 스토리지(storage), DB서버 또는 파일서 버를 적어도 하나 포함하여 구성한다. 도 2는 도 1의 데이터 생성부의 구성을 개략적으로 나타낸 블럭도이고, 도 3은 본 발명의 일 실시예에 따른 스 타일 전이를 설명하기 위한 개념도이고, 도 4는 본 발명의 일 실시예에 따른 오토인코더를 이용한 스타일 전이 모듈의 구성의 일 예다. 도 2 및 도 3을 참조하면 스타일 전이모듈은 미리 저장된 스타일 전이 모델에 의해 행해진다. 스타일 전이 모델은 2개의 이미지 데이터를 일대일로 쌍을 이루어 학습된다. 여기서 2개의 이미지 데이터는 콘텐트 이미지 (content image)와 스타일 이미지(style image)이다. 스타일 전이 모델은 입력되는 콘텐트 이미지(content image)의 스타일을 전이시켜 새로운 이미지를 생성한다. 스타일 전이모듈은 미리 저장된 스타일 전이 모델에 의해 복수의 망막 이미지에 포함된 제1 그룹 망막 이 미지의 콘텐트 이미지(content image)와 스타일 이미지(style image) 쌍에 기초하여 제2 그룹 망막 이미지를 생 성한다. 정리하면, 제1 그룹 망막 이미지에 속한 임의의 이미지의 콘텐트 이미지(content image)와 스타일 이미지(style image) 쌍을 스타일 전이 모델에 입력하여 스타일 전이된 이미지를 출력한다. 이와 같이 제1 그룹 망막 이미지 를 스타일 전이 모델에 입력하여 출력한 결과가 제2 그룹 망막 이미지가 된다. 도 4를 참조하면, 스타일 전이모듈은 오토인코더로 구현될 수 있다. 오토인코더는 대표적인 비지도학습을 위한 인공 신경망 구조 중 하나로서 어떤 값을 예측하거나 분류하는 것이 목적인 지도학습과는 다르게 데이터의 숨겨진 구조를 발견하는 것이 목적인 학습 방법이다. 인코더(encoder)에 제1 그룹 망막 이미지의 콘텐트 이미지(content image)와 스타일 이미지(style image)를 입 력한다. 인코더(encoder)는 콘텐트 이미지(content image)를 콘텐트 피처맵(content feature maps)과 스타일 피처맵 (style feature maps)으로 변환하고, 잠재 변수를 생성한다. 잠재 변수는 숨겨진 변수로서 데이터에 직접적으로 나타나지 않지만 현재 데이터 분포를 만드는데 영향을 끼치는 변수로서 데이터의 특징을 나타낸다. 디코더(decoder)는 잠재 변수를 이용하여 스타일 전이된 이미지를 생성해 낸다. 디코더(decoder)는 콘텐트 손실 함수(content loss function)가 콘텐트 이미지와 스타일 전이된 이미지 간의 요소별 에러(element-wise erro r)를 최소화하고, 스타일 손실 함수(style loss function)가 스타일 이미지와 스타일 전이된 이미지 사이의 통 계별 에러(statistic-wise error)를 최소화한 이미지를 출력한다. 이로써 콘텐트 이미지는 유지하면서 스타일만 전이된 망막 OCT 이미지를 생성할 수 있다. 도 5는 본 발명의 일 실시예에 따라 스타일 전이를 설명하기 위한 망막 이미지이다. 도 5의 (a)와 (d)는 콘텐트 이미지의 일 예이고, 도 5의 (b)와 (e)는 스타일 이미지의 일 예이다. 도 5의 (c)는 도 5의 (a) 콘텐트 이미지와 도 5의 (b) 스타일 이미지를 이용하여 출력한 스타일 전이된 이미지이다. 도 5의 (c)는 도 5의 (a)와 동일한 콘텐트를 갖고 도 5의 (b)와 동일한 스타일을 갖는 것을 알 수 있다. 도 5의 (f)는 도 5의 (d) 콘텐트 이미지와 도 5의 (e)는 스타일 이미지를 이용하여 출력한 스타일 전이된 이미 지이다. 도 5의 (f)는 도 5의 (d)와 동일한 콘텐트를 갖고 도 5의 (e) 동일한 스타일을 갖는 것을 알 수 있다. 일 실시예에서, 스타일 전이를 이용한 데이터셋의 생성을 위해, 입력데이터로서 오픈 소스 데이터 셋을 이용할 수 있다. 오픈 소스 데이터셋은 206장의 정상 데이터와 366장의 환자 데이터(MH:102장, AMD:55장, CSR:102장, DR:107장)를 포함할 수 있다. 오픈 소스 데이터셋의 이미지 사이즈는 750×500 px 또는 879×586 px일 수 있다. 오픈 소스 데이터셋의 이미지 사이즈와 스타일 이미지의 사이즈가 서로 상이한 경우, 오픈 소스 데이터셋을 스 타일 이미지의 크기로 리사이즈(resize)하여 사용한다. 예를 들어, 스타일 이미지의 크기는 512×512 px일 수 있다. 이러한 경우, 오픈 소스 데이터 셋을 스타일 이미지의 크기와 동일하게 512×512 px로 리사이즈 하여 스 타일 전이 모델의 입력으로 이용할 수 있다. 균일화모듈은 상기 제1 그룹 망막 이미지와 제2 그룹 망막 이미지에 대하여 CLAHE (Contrast Limited Adaptive Histogram Equalization) 처리를 수행한다. CLAHE 처리는 이미지를 소정의 블록들로 나누어 각 블록들을 미리 설정한 콘트라스트 제한값(Contrast Limit)을 초과하는 픽셀들을 상기 콘트라스트 제한값을 초과하지 않는 픽셀들에 균일하게 재배치한다. 이러한 재배치를 통해서 각 블록들이 상기 콘트라스트 제한값 미만에 위치하게 된다. 도 6은 일 실시예에 따라 CLAHE 처리를 수행한 도면의 일 예이다. 도 6의 (a)는 CLAHE 처리를 행하기 이전의 이미지이고, 도 6의 (b)는 CLAHE 처리를 행한 이후의 이미지이다. 도 6의 (a)와 (b)를 비교하면 CLAHE 처리 이전의 도 6의 (a)의 이미지보다 CLAHE 처리 이후의 도 6의 (b)의 이 미지가 이미지 내의 경계에 대한 대비가 강화된 것을 확인할 수 있다. 이미지 내의 경계 즉 망막의 각 층의 대 비가 강화되는 경우, 후속되는 망막 층 분할 성능을 향상시킬 수 있다. 도 7은 도 1의 분할모델 구축부의 구성을 개략적으로 나타낸 블럭도이고, 도 8 내지 도 13은 분할모델 구축부의 동작을 설명하기 위한 이미지이다. 먼저, 도 7을 참조하면, 분할모델 구축부는 분할모듈, 데이터 증강모듈, 클래스 분할모듈, 손실함수 연산모듈 및 라벨링부를 포함할 수 있다. 분할모델 구축부에 포함된 구성요소는 설명 의 편의를 위해 기능으로 구분되어 있으나, 일부 구성요소를 병합하여 하나의 구성요소로 할 수 있으며, 분할모"}
{"patent_id": "10-2022-0129361", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "델 구축부가 이외 다른 구성요소를 더 포함할 수 있음은 당해 기술분야의 통상의 기술자에게 자명하다. 분할모듈은 제1 그룹 망막 이미지와 제2 그룹 망막 이미지를 훈련 세트, 검증데이터 세트 및 테스트 세트 로 분할한다. 훈련 세트는 모델 훈련에 쓰이는 데이터 세트이고, 검증데이터 세트는 훈련 세트에서 보통 일정 비율로 떼어 사 용하는 모델 튜닝 용도의 세트이며, 테스트 세트는 모델의 실제 정확도를 판별하기 위해 쓰이는 데이터 세트이 다. 일 실시예에서는 훈련 세트, 검증데이터 세트, 테스트 세트를 약 8:1:1의 비율을 가지도록 랜덤하게 분할할 수 있다. 예를 들어, 전체 2586개의 데이터셋 중에 훈련 세트는 2071개, 검증데이터 세트는 242개, 테스트 세트는 273개로 분할할 수 있다. 여기서, 훈련 세트, 검증데이터 세트, 테스트 세트의 비율은 이에 한정하는 것은 아니 다. 훈련 세트가 적으면 성능에 영향을 미치기 때문에 전체 데이터세트의 수에 따라 훈련 세트, 검증데이터 세 트, 테스트 세트의 비율은 변경될 수 있다. 데이터 증강모듈은 훈련 세트의 망막 이미지에 대하여 데이터 증강처리(data augmentation)를 적용할 수 있다. 데이터 증강모듈은 수평 뒤집기(horizontal flip), 수직 편이(vertical shift), 회전, 밝기처리, 대비처 리 등을 포함할 수 있다. 도 8은 일 실시예에 따라 수평 뒤집기(horizontal flip)를 설명하기 위한 도면이다. 도 8을 참조하면 망막 이미지에 미리 설정된 기준 확률 예를 들어 0.5의 확률로 랜덤하게 수평 뒤집기 (horizontal flip)를 적용한다. 도 8의 (a)는 수평 뒤집기를 적용하기 이전 이미지이고, 도 8의 (b)는 도 8의 (a)를 수평 뒤집기를 적용한 이미 지이다. 도 8의 (c)는 수평 뒤집기를 적용하기 전 도 8의 (a) Ground truth map이고, 도 8의 (d)는 수평 뒤집기한 도 8 의 (b)의 Ground truth map이다. 도 8의 (a) 내지 도 8의 (d)와 같이 망막 이미지 뿐만 아니라, Ground truth map에도 동일하게 수평 뒤집기 처 리를 행한다. Ground truth map은 ILM, RNFL, RPE boundary를 기준으로 4개의 영역으로 구분되며, 4개의 class로 one-hot으 로 인코딩된다. 예를 들어, ILM 위쪽 영역은 [1, 0, 0, 0], ILM과 RNFL 사이의 영역은 [0, 1, 0, 0], RNFL과 RPE 사이의 영역은 [0, 0, 1, 0], RPE 아래쪽 영역은 [0, 0, 0, 1] 로 인코딩 된다. 도 9는 일 실시예에 따라 수직 편이(vertical shift)를 설명하기 위한 도면이다. 도 9를 참조하면 망막 이미지와 Ground truth label의 경계(boundary)가 잘리지 않는 범위 내에서 랜덤하게 이 미지와 ground truth map에 수직 편이를 적용할 수 있다. 도 9의 (a)는 수직 편이를 적용하기 이전 이미지이고, 도 9의 (d)는 수직 편이를 적용하기 이전 도 9의 (a)의 ground truth map이다. 도 9의 (b)는 도 9의 (a)를 위쪽 방향으로 시프트(shift)처리한 이미지이고, 도 9의 (e)는 위쪽 방향으로 시프트(shift)처리한 도 9의 (b)의 Ground truth map이다. 위쪽 방향으로 시프트 할 경우, 이미지의 아래쪽 영역은 0으로 padding하고, ground truth map의 아래쪽 영역은 [0, 0, 0, 1]로 padding한다. 도 9의 (c)는 도 9의 (a)의 망막 이미지를 아래쪽 방향으로 시프트(shift) 처리한 이미지이고, 도 9의 (f)는 도 9의 (c)의 Ground truth map을 아래쪽 방향으로 시프트(shift) 처리한 도 9의 (c)의 Ground truth map이다. 아래쪽 방향으로 시프트 할 경우, 이미지의 위쪽 영역은 0으로 padding하고, ground truth map의 위쪽 영역은 [1, 0, 0, 0]로 padding한다. 도 10은 일 실시예에 따라 회전을 설명하기 위한 도면이다. 도 10을 참고하면, 이미지에 미리 설정된 각도(예를 들어, ±10˚ 범위) 내에서 랜덤으로 회전 처리를 수행할 수 있다. 도 10의 (a)는 회전 처리를 적용하기 이전 이미지이고, 도 10의 (d)는 회전 처리를 적용하기 이전 도 10의 (a)의 ground truth map이고 도 10의 (b)는 도 10의 (a)를 시계 방향으로 회전 처리한 이미지이고, 도 10 의 (c)는 도 10의 (a)를 반시계 방향으로 회전 처리한 이미지이다. 이미지의 경우, 회전 처리로 인해 발생하는 빈 공간은 모두 0으로 padding한다. 도 10의 (d)는 도 10의 (a)의 이미지에 대한 ground truth map이고, 도 10의 (e)는 도 10의 (b)의 이미지에 대 한 ground truth map이고, 도 10의 (f)는 도 10의 (c)의 이미지에 대한 ground truth map이다. ground truth map의 경우, 회전에 의해 발생되는 왼쪽과 오른쪽 빈공간 영역은 [0, 0, 0, 0]으로 padding하고, 위쪽 빈공간 영역은 [1, 0, 0, 0]으로, 아래쪽 빈공간 영역은 [0, 0, 0, 1]로 padding한다. 도 11은 일 실시예에 따라 밝기처리를 설명하기 위한 도면이다. 도 11을 참고하면, 이미지에 미리 설정된 범위 (예를 들어 밝기 평균값의 -10%,+10%) 밝기 처리를 랜덤하게 행 할 수 있다. 밝기 처리를 행한 후, 0보다 작은 픽셀은 0으로, 255보다 큰 픽셀은 255로 clipping 해준다. 도 11의 (a)는 밝기 처리를 적용하기 이전 이미지이고, 도 11의 (b)는 도 11의 (a)의 밝기의 평균값에 -10%를 적용한 이미지이고, 도 11의 (c)는 도 11의 (a)를 밝기의 평균값에 +10%를 적용한 이미지이다. 도 12는 일 실시예에 따라 대비처리를 설명하기 위한 도면이다. 도 12를 참고하면, 대비 팩터는 0.9에서 1.1 사이의 랜덤한 값으로 설정하여 미리 설정된 범위(예를 들어 -10% 내지+10% 범위) 내에서 대비처리를 행할 수 있다. [수학식 1] x' = (x - mean) * contrast_factor + mean 수학식 1에서 mean은 모든 이미지의 픽셀(밝기)의 평균을 의미하고, x는 각 픽셀을 의미한다. 수학식 1에서 contrast_factor는 0.9에서 1.1 사이의 랜덤한 값으로 설정하여, ±10% 범위 내에서 랜덤하게 대 비조절을 수행한다. 랜덤으로 대비처리를 적용 후, 0보다 작은 픽셀은 0으로, 255보다 큰 픽셀은 255로 클리핑(clipping)한다. 도 12의 (a)는 대비처리 이전의 이미지이고, 도 12의 (b)는 -10% 대비처리를 적용한 이미지이고, 도 12의 (c)는 +10% 대비처리를 적용한 이미지이다. 도 13은 일 실시예에 따라 믹스업 처리를 설명하기 위한 도면이다. 도 13를 참조하면 이미지의 믹스업(mixup) 처리를 설명한다. [수학식 2] x' = λx1 + (1 - λ)x2 [수학식 3] y' = λy1 + (1 - λ)y2 수학식 2에서 x1은 MixUp을 적용할 첫번째 이미지의 픽셀이고, x2는 두번째 이미지의 픽셀이며, x'은 두 이미지 를 MixUp한 이미지의 픽셀이다. 수학식 3에서 y1은 MixUp을 적용할 첫번째 ground truth map의 픽셀이고, y2는 두번째 ground truth map의 픽셀 이며, y'은 두 map을 MixUp한 map의 픽셀이다. 수학식 2와 수학식 3에서 λ는 베타 분포에서 추출한 랜덤한 값으로, 0부터 1사이의 값을 가지며, 두 데이터의 혼합 비율을 나타낸다. 도 13의 (c)는 λ는 0.3으로 설정하였으며, 도 13의 (a)와 도 13의 (b)를 3:7의 비율로 믹스업 처리한 이미지이 다. 도 14는 본 발명의 일 실시예에 따른 클래스 분할을 설명하기 위한 개념도이다. 다시 도 7 및 도 14를 참조하여, 클래스 분할모듈은 이미지 내에서 픽셀(pixel) 단위로 클래스(class)를 분할하는 모델이다. 분류 모델에 이미지를 입력하면 클래스로 분할된 이미지가 출력된다. 클래스 분할모듈은 미리 저장된 분류 모델을 이용할 수 있다. 일 실시예에서는 분류 모델로 U-Net 모델을 적용하였으나, 이에 한정하는 것은 아니며 FCN, SegNet, PSPNet 등의 알려진 분할 모델을 이용할 수 있다. U- Net 모델 등의 분할 모델은 종래에 알려진 기술로서 상세한 설명은 생략한다. 다시 도 7을 참조하면, 손실함수 연산모듈은 미리 저장된 수학식 4에 기초하여 손실함수를 연산한다. 일 실시예에서, 손실 함수로 CCE(categorical cross-entropy loss)를 사용할 수 있다. CCE는 분류해야 할 클래스가 3개 이상인 경우 즉 멀티클래스 분류에 사용된다. 라벨이 원 핫(One-hot) 형태로 제공될 때 사용된다. [수학식 4]"}
{"patent_id": "10-2022-0129361", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "수학식 4에서 y는 ground truth이며 y_hat은 segmentation 모델의 출력인 predicted probability이다. 이 때, 원 핫(One-hot)으로 인코딩된 라벨을 사용하지 않고, 정수로 인코딩된 라벨을 사용할 경우, 손실 함수로 sparse categorical cross-entropy loss를 사용할 수 있다. 도 15는 일 실시예에 따른 분할 맵 필터링을 설명하기 위한 도면이다. 도 7 및 도 15를 참조하면, 라벨링부는 각 클래스에 대하여 필터링을 수행하여 컬럼별로 최대값을 가지는 인덱스를 라벨로 선택함으로써 라벨링을 수행한다. 라벨링부는 미분 필터를 이용해 픽셀 값이 급격하게 변하는 경계를 찾을 수 있다. 도 16은 본 발명의 일 실시예에 따른 망막 OCT 영상의 층 분할 모델 학습 방법을 설명하기 위한 순서도이다. 도 16의 망막 OCT 영상의 층 분할 모델 학습 방법은 도 1 내지 도 15를 참조하여 설명한 망막 OCT 영상의 층 분 할 모델 학습 시스템에 의해 수행된다. 도 16을 참조하면, 망막 OCT 영상의 층 분할 모델 학습 방법은 미리 저장된 제1 그룹 망막 이미지에 스타일 트 랜스퍼(style transfer) 기술을 적용하여 제2 그룹 망막 이미지를 생성하는 단계(S110)와 제1 그룹 망막 이미지 와 제2 그룹 망막 이미지에 기초하여 망막 OCT 영상의 층 분할 모델을 구축하는 단계(S120)를 포함할 수 있다. 상기 제1 그룹 망막 이미지는 복수의 망막 이미지를 포함하고, 상기 복수의 망막 이미지 각각은 콘텐트 이미지 (content image)와 스타일 이미지(style image) 쌍을 포함한다. 제2 그룹 망막 이미지를 생성하는 단계(S110)는, 데이터 생성부가 상기 복수의 망막 이미지에 포함된 제1 그룹 망막 이미지의 콘텐트 이미지(content image)와 스타일 이미지(style image) 쌍에서 미리 저장된 스타일 전이 모델에 의해 스타일 이미지를 전이시켜 제2 그룹 망막 이미지를 생성한다. 다음, 데이터 생성부가 상 기 제1 그룹 망막 이미지와 제2 그룹 망막 이미지에 대하여 CLAHE (Contrast Limited Adaptive Histogram Equalization) 처리를 수행한다. 일 실시예에서, 스타일 전이 모델은 콘텐트 손실 함수(content loss function)가 콘텐트 이미지와 상기 제2 망 막 이미지 사이의 요소별 에러(element-wise error)를 최소화하고, 스타일 손실 함수(style loss function)가 스타일 이미지와 제2 그룹 망막 이미지 사이의 통계별 에러(statistic-wise error)를 최소화한다. 제1 그룹 망막 이미지와 제2 그룹 망막 이미지에 기초하여 망막 OCT 영상의 층 분할 모델을 구축하는 단계 (S120)는, 분할 모델 구축부가 제1 그룹 망막 이미지와 제2 그룹 망막 이미지를 훈련 세트, 검증데이터 세 트, 테스트 세트로 분할하며, 상기 훈련 세트의 망막 이미지에 대하여 데이터 증강처리(data augmentation)를 적용하여 망막 OCT 영상의 층 분할 모델을 생성할 수 있다. 여기서, 망막 OCT 영상의 층 분할 모델을 생성하는 것은, 상기 훈련 세트로 분할된 망막 이미지 내에서 픽셀 단 위로 클래스를 분류하고, 각 클래스에 대하여 필터링을 수행하여 컬럼별로 최대값을 가지는 인덱스를 라벨로 선 택함으로써 라벨링을 수행할 수 있다. 일 실시예에 따르면, 미리 획득한 망막 이미지를 스타일 전이하여 새로운 망막 이미지를 생성함으로써 강건한 망막 OCT 영상의 층 분할 모델을 구축할 수 있다. 이렇게 제공되는 망막 OCT 영상의 층 분할 모델을 통해 정확하고 신속하게 망막 OCT 영상의 층 분할을 수행할 수 있게 된다. 이 때, 처리 흐름도 도면들의 각 블록과 흐름도 도면들의 조합들은 컴퓨터 프로그램 인스트럭션들에 의해 수행 될 수 있음을 이해할 수 있을 것이다. 이들 컴퓨터 프로그램 인스트럭션들은 범용 컴퓨터, 특수용 컴퓨터 또는 기타 프로그램 가능한 데이터 프로세싱 장비의 프로세서에 탑재될 수 있으므로, 컴퓨터 또는 기타 프로그램 가 능한 데이터 프로세싱 장비의 프로세서를 통해 수행되는 그 인스트럭션들이 흐름도 블록(들)에서 설명된 기능들 을 수행하는 수단을 생성하게 된다. 이들 컴퓨터 프로그램 인스트럭션들은 특정 방식으로 기능을 구현하기 위해 컴퓨터 또는 기타 프로그램 가능한 데이터 프로세싱 장비를 지향할 수 있는 컴퓨터 이용 가능 또는 컴퓨터 판독 가능 메모리에 저장되는 것도 가능하므로, 그 컴퓨터 이용가능 또는 컴퓨터 판독 가능 메모리에 저장된 인스트 럭션들은 흐름도 블록(들)에서 설명된 기능을 수행하는 인스트럭션 수단을 내포하는 제조 품목을 생산하는 것도 가능하다. 컴퓨터 프로그램 인스트럭션들은 컴퓨터 또는 기타 프로그램 가능한 데이터 프로세싱 장비 상에 탑재 되는 것도 가능하므로, 컴퓨터 또는 기타 프로그램 가능한 데이터 프로세싱 장비 상에서 일련의 동작 단계들이 수행되어 컴퓨터로 실행되는 프로세스를 생성해서 컴퓨터 또는 기타 프로그램 가능한 데이터 프로세싱 장비를 수행하는 인스트럭션들은 흐름도 블록(들)에서 설명된 기능들을 실행하기 위한 단계들을 제공하는 것도 가능하 다. 또한, 각 블록은 특정된 논리적 기능(들)을 실행하기 위한 하나 이상의 실행 가능한 인스트럭션들을 포함하는 모듈, 세그먼트 또는 코드의 일부를 나타낼 수 있다. 또, 몇 가지 대체 실행 예들에서는 블록들에서 언급된 기 능들이 순서를 벗어나서 발생하는 것도 가능함을 주목해야 한다. 예컨대, 잇달아 도시되어 있는 두 개의 블록들 은 사실 실질적으로 동시에 수행되는 것도 가능하고 또는 그 블록들이 때때로 해당하는 기능에 따라 역순으로 수행되는 것도 가능하다. 이 때, 본 실시 예에서 사용되는 '~부'라는 용어는 소프트웨어 또는 FPGA또는 ASIC과 같은 하드웨어 구성요소를 의미하며, '~부'는 어떤 역할들을 수행한다. 그렇지만 '~부'는 소프트웨어 또는 하드웨어에 한정되는 의미는 아 니다. '~부'는 어드레싱할 수 있는 저장 매체에 있도록 구성될 수도 있고 하나 또는 그 이상의 프로세서들을 재 생시키도록 구성될 수도 있다. 따라서, 일 예로서 '~부'는 소프트웨어 구성요소들, 객체지향 소프트웨어 구성 요소들, 클래스 구성요소들 및 태스크 구성요소들과 같은 구성요소들과, 프로세스들, 함수들, 속성들, 프로시저 들, 서브루틴들, 프로그램 코드의 세그먼트들, 드라이버들, 펌웨어, 마이크로코드, 회로, 데이터, 데이터베이스, 데이터 구조들, 테이블들, 어레이들, 및 변수들을 포함한다. 구성요소들과 '~부'들 안에서 제공 되는 기능은 더 작은 수의 구성요소들 및 '~부'들로 결합되거나 추가적인 구성요소들과 '~부'들로 더 분리될 수 있다. 뿐만 아니라, 구성요소들 및 '~부'들은 디바이스 또는 보안 멀티미디어카드 내의 하나 또는 그 이상의"}
{"patent_id": "10-2022-0129361", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "CPU들을 재생시키도록 구현될 수도 있다.본 명세서가 속하는 기술분야의 통상의 지식을 가진 자는 본 명세서가 그 기술적 사상이나 필수적인 특징을 변 경하지 않고서 다른 구체적인 형태로 실시될 수 있다는 것을 이해할 수 있을 것이다. 그러므로 이상에서 기술한 실시 예들은 모든 면에서 예시적인 것이며 한정적이 아닌 것으로 이해해야만 한다. 본 명세서의 범위는 상기 상 세한 설명보다는 후술하는 특허청구의 범위에 의하여 나타내어지며, 특허청구의 범위의 의미 및 범위 그리고 그 균등 개념으로부터 도출되는 모든 변경 또는 변형된 형태가 본 명세서의 범위에 포함되는 것으로 해석되어야 한 다. 한편, 본 명세서와 도면에는 본 명세서의 바람직한 실시 예에 대하여 개시하였으며, 비록 특정 용어들이 사용되 었으나, 이는 단지 본 명세서의 기술 내용을 쉽게 설명하고 발명의 이해를 돕기 위한 일반적인 의미에서 사용된 것이지, 본 명세서의 범위를 한정하고자 하는 것은 아니다. 여기에 개시된 실시 예 외에도 본 명세서의 기술적 사상에 바탕을 둔 다른 변형 예들이 실시 가능하다는 것은 본 명세서가 속하는 기술 분야에서 통상의 지식을 가 진 자에게 자명한 것이다."}
{"patent_id": "10-2022-0129361", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 일 실시예에 따른 망막 OCT 영상의 층 분할 모델 학습 시스템의 구성을 개략적으로 나타낸 도 면이다. 도 2는 도 1의 데이터 생성부의 구성을 개략적으로 나타낸 블럭도이다. 도 3은 본 발명의 일 실시예에 따른 스타일 전이를 설명하기 위한 개념도이다. 도 4는 본 발명의 일 실시예에 따른 오토인코더를 이용한 스타일 전이모듈의 구성의 일 예다. 도 5는 본 발명의 일 실시예에 따라 스타일 전이를 설명하기 위한 망막 이미지이다. 도 6은 일 실시예에 따라 CLAHE 처리를 수행한 도면의 일 예이다. 도 7은 도 1의 분할모델 구축부의 구성을 개략적으로 나타낸 블럭도이다. 도 8은 일 실시예에 따라 수평 뒤집기(horizontal flip)를 설명하기 위한 도면이다. 도 9는 일 실시예에 따라 수직 편이(vertical shift)를 설명하기 위한 도면이다. 도 10은 일 실시예에 따라 회전을 설명하기 위한 도면이다. 도 11은 일 실시예에 따라, 밝기처리를 설명하기 위한 도면이다. 도 12는 일 실시예에 따라 대비처리를 설명하기 위한 도면이다. 도 13은 일 실시예에 따라 믹스업 처리를 설명하기 위한 도면이다. 도 14는 본 발명의 일 실시예에 따른 클래스 분할을 설명하기 위한 개념도이다. 도 15는 일 실시예에 따른 분할 맵 필터링을 설명하기 위한 도면이다. 도 16은 본 발명의 일 실시예에 따른 망막 OCT 영상의 층 분할 모델 학습 방법을 설명하기 위한 순서도이다."}
