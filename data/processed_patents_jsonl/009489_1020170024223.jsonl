{"patent_id": "10-2017-0024223", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2017-0128073", "출원번호": "10-2017-0024223", "발명의 명칭": "심층 강화 학습을 이용한 음악 작곡 방법", "출원인": "반병현", "발명자": "반병현"}}
{"patent_id": "10-2017-0024223", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "컴퓨터 장치가 시드 멜로디를 멜로디가 학습된 멜로디 신경망에 입력하여 일정한 멜로디 라인을 추출하는 단계;상기 컴퓨터 장치가 시드 리듬을 리듬이 학습된 리듬 신경망에 입력하여 일정한 리듬을 추출하는 단계; 및상기 컴퓨터 장치가 시간의 흐름에 따른 상기 리듬을 고려하여 상기 멜로디 라인의 조절하는 단계를 포함하되,상기 멜로디 신경망은 샘플 데이터를 입력받아 멜로디 생성을 학습하는 멜로디 학습 신경망 및 상기 멜로디 학습 신경망의 출력이 인공지능이 작성한 시퀀스인지 또는 인간이 작성한 시퀀스인지를 판단하는 평가 신경망을포함하고, 멜로디 학습 과정에서 상기 판단 결과가 정답인지 여부에 따라 상기 학습 신경망의 파라미터를 조절하고,상기 리듬 신경망은 샘플 데이터를 입력받아 리듬 생성을 학습하는 리듬 학습 신경망 및 상기 리듬 학습 신경망의 출력이 인공지능이 작성한 시퀀스인지 또는 인간이 작성한 시퀀스인지를 판단하는 평가 신경망을 포함하고,리듬 학습 과정에서 상기 판단 결과가 정답인지 여부에 따라 상기 리듬 학습 신경망의 파라미터를 조절하는 심층 강화 학습을 이용한 음악 작곡 방법."}
{"patent_id": "10-2017-0024223", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 컴퓨터 장치가 시드 코드를 코드가 학습된 코드 신경망에 입력하여 일정한 코드 진행을 추출하는 단계를더 포함하고, 상기 코드 신경망은 샘플 데이터를 입력받아 코드 생성을 학습하는 코드 학습 신경망 및 상기 코드 학습 신경망의 출력이 인공지능이 작성한 시퀀스인지 또는 인간이 작성한 시퀀스인지를 판단하는 평가 신경망을 포함하고, 코드 학습 과정에서 상기 판단 결과가 정답인지 여부에 따라 상기 리듬 학습 신경망의 파라미터를 조절하고,상기 컴퓨터 장치는 상기 코드 진행에 따라 상기 멜로디 라인을 더 조절하는 심층 강화 학습을 이용한 음악 작곡 방법."}
{"patent_id": "10-2017-0024223", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1항에 있어서,상기 컴퓨터 장치가 사용자로부터 그래픽적 요소인 선(line) 또는 소리를 입력받는 단계; 및상기 컴퓨터 장치가 상기선 또는 소리를 입력받아 사전에 학습된 시드 신경망에 입력하여 상기 시드 멜로디 및상기 시드 리듬을 추출하는 단계를 더 포함하되,상기 컴퓨터 장치는 상기 추출한 시드 멜로디를 상기 멜로디 신경망에 입력하고, 상기 추출한 시드 리듬을 상기리듬 신경망에 입력하는 심층 강화 학습을 이용한 음악 작곡 방법."}
{"patent_id": "10-2017-0024223", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제3항에 있어서,상기 컴퓨터 장치는 상기 멜로디 신경망에서 출력되는 상기 멜로디 라인의 특정 구간이 상기 시드 멜로디와 패턴의 유사도가 기준값 이상 상이하면 상기 시드 멜로디를 다시 상기 멜로디 신경망에 입력하여 멜로디 라인 추출을 다시 시작하는 심층 강화 학습을 이용한 음악 작곡 방법."}
{"patent_id": "10-2017-0024223", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "심층 강화 학습을 이용한 음악 작곡 방법은 컴퓨터 장치가 시드 멜로디를 멜로디가 학습된 멜로디 신경망에 입력 하여 일정한 멜로디 라인을 추출하는 단계, 상기 컴퓨터 장치가 상기 시드 멜로디를 리듬이 학습된 리듬 신경망 에 입력하여 일정한 리듬을 추출하는 단계 및 상기 컴퓨터 장치가 시간의 흐름에 따른 상기 리듬을 고려하여 상 기 멜로디 라인의 조절하는 단계를 포함한다."}
{"patent_id": "10-2017-0024223", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "이하 설명하는 기술은 심층 신경망과 강화학습 전략을 이용하여 음악을 작곡하는 기법에 관한 것이다."}
{"patent_id": "10-2017-0024223", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "최근 인공지능을 이용하여 음악을 자동으로 작곡하려는 시도가 있다. 구글은 마젠타(Magenta) 프로젝트를 통해 음악을 작곡하는 인공지능을 선보였고, 소니는 딥 바흐(Deep Bach)라는 인공 지능을 선보인 바 있다. 한편 전문가가 아닌 일반인이 작곡을 손쉽게 하기 위한 인터페이스도 연구되고 있다. 예컨대, 피아노 건반과 대 응하는 하나 이상의 막대 표시를 제공하여 사용자가 막대 형태의 공간을 채색하면 해당 막대에 해당하는 건반을 그 채색된 박스의 길이에 해당하는 시간만큼 재생하는 방식의 사용자 인터페이스가 공개되었다. 선행기술문헌 특허문헌 (특허문헌 0001) 한국공개특허 제2012-0060085호(2012.06.11)"}
{"patent_id": "10-2017-0024223", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "구글의 마젠타는 순히 코드 진행을 나열하고, 그 화음을 기반으로 비트를 나열하는 것을 기본으로 한다. 멜로디 는 각 코드를 구성하는 4개의 기본음 중 3개 또는 4개를 취하여 단순히 아래에서부터 위로 쌓아 올리는 것을 방 식으로 곡의 기승전결에 맞추어 변주를 가하는 방식이다. 마젠타의 결과물은 단순한 멜로디의 반복으로 음악적 완성도가 부족하다. 예컨대, 마젠타의 멜로디는 사실상 피아노의 왼손반주에 해당하는 음표를 일직선으로 나열 한 것에 지나지 않으므로, 화성과 반주만이 존재하는 반쪽짜리 음악이라 할 수 있다. 한편 소니의 딥 바흐는 바흐의 음악을 딥러닝 방식으로 학습하여 바흐 특유의 분위기가 나는 합창곡을 작곡하는 것을 특징으로 한다. 따라서 딥 바흐는 트레이닝데이터의 제한으로 한정된 분위기의 곡만을 제작할 수 있다. 딥 바흐는 매 순간순간 협화음을 이루는 4성부의 음을 제공할 뿐이므로 화성, 반주, 리듬, 멜로디로 구성되는 음악 적 요소를 충족하기 어렵다. 이하 설명하는 기술은 리듬, 화성 및 멜로디를 모두 고려한 인공 지능 모델을 이용하여 음악을 작곡하는 방법을 제공하고자 한다. 나아가 이하 설명하는 기술은 전문가가 아닌 사용자가 손쉽게 음악을 작곡할 수 있는 인터페 이스를 제공하고자 한다."}
{"patent_id": "10-2017-0024223", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "심층 강화 학습을 이용한 음악 작곡 방법은 컴퓨터 장치가 시드 멜로디를 멜로디가 학습된 멜로디 신경망에 입 력하여 일정한 멜로디 라인을 추출하는 단계, 상기 컴퓨터 장치가 시드 리듬을 리듬이 학습된 리듬 신경망에 입 력하여 일정한 리듬을 추출하는 단계 및 상기 컴퓨터 장치가 시간의 흐름에 따른 상기 리듬을 고려하여 상기 멜 로디 라인의 조절하는 단계를 포함한다."}
{"patent_id": "10-2017-0024223", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "이하 설명하는 기술을 이용하면 사용자가 손쉽게 리듬, 화성 및 멜로디가 조화로운 아름다운 음악을 작곡할 수 있다."}
{"patent_id": "10-2017-0024223", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하 설명하는 기술은 다양한 변경을 가할 수 있고 여러 가지 실시례를 가질 수 있는 바, 특정 실시례들을 도면 에 예시하고 상세하게 설명하고자 한다. 그러나, 이는 이하 설명하는 기술을 특정한 실시 형태에 대해 한정하려 는 것이 아니며, 이하 설명하는 기술의 사상 및 기술 범위에 포함되는 모든 변경, 균등물 내지 대체물을 포함하 는 것으로 이해되어야 한다. 제1, 제2, A, B 등의 용어는 다양한 구성요소들을 설명하는데 사용될 수 있지만, 해당 구성요소들은 상기 용어 들에 의해 한정되지는 않으며, 단지 하나의 구성요소를 다른 구성요소로부터 구별하는 목적으로만 사용된다. 예 를 들어, 이하 설명하는 기술의 권리 범위를 벗어나지 않으면서 제1 구성요소는 제2 구성요소로 명명될 수 있고, 유사하게 제2 구성요소도 제1 구성요소로 명명될 수 있다. 및/또는 이라는 용어는 복수의 관련된 기재된 항목들의 조합 또는 복수의 관련된 기재된 항목들 중의 어느 항목을 포함한다. 본 명세서에서 사용되는 용어에서 단수의 표현은 문맥상 명백하게 다르게 해석되지 않는 한 복수의 표현을 포함 하는 것으로 이해되어야 하고, \"포함한다\" 등의 용어는 설시된 특징, 개수, 단계, 동작, 구성요소, 부분품 또는 이들을 조합한 것이 존재함을 의미하는 것이지, 하나 또는 그 이상의 다른 특징들이나 개수, 단계 동작 구성요 소, 부분품 또는 이들을 조합한 것들의 존재 또는 부가 가능성을 배제하지 않는 것으로 이해되어야 한다. 도면에 대한 상세한 설명을 하기에 앞서, 본 명세서에서의 구성부들에 대한 구분은 각 구성부가 담당하는 주기 능 별로 구분한 것에 불과함을 명확히 하고자 한다. 즉, 이하에서 설명할 2개 이상의 구성부가 하나의 구성부로 합쳐지거나 또는 하나의 구성부가 보다 세분화된 기능별로 2개 이상으로 분화되어 구비될 수도 있다. 그리고 이 하에서 설명할 구성부 각각은 자신이 담당하는 주기능 이외에도 다른 구성부가 담당하는 기능 중 일부 또는 전 부의 기능을 추가적으로 수행할 수도 있으며, 구성부 각각이 담당하는 주기능 중 일부 기능이 다른 구성부에 의 해 전담되어 수행될 수도 있음은 물론이다. 또, 방법 또는 동작 방법을 수행함에 있어서, 상기 방법을 이루는 각 과정들은 문맥상 명백하게 특정 순서를 기 재하지 않은 이상 명기된 순서와 다르게 일어날 수 있다. 즉, 각 과정들은 명기된 순서와 동일하게 일어날 수도 있고 실질적으로 동시에 수행될 수도 있으며 반대의 순서대로 수행될 수도 있다. 이하 설명하는 기술은 강화 학습에 기반하여 음악적 요소를 순차 배열하는 복수의 인공 지능 모델을 이용하여 음악을 작곡한다. 이하 설명에서 컴퓨터 장치가 인공 지능 모델을 사용하여 음악을 작곡한다고 설명한다. 컴퓨 터 장치는 스마트 기기, PC, 네트워크 상의 서버 등을 의미한다. 도 1은 모듈화된 신경망을 이용하여 음악을 작곡하는 과정에 대한 예이다. 사용자는 컴퓨터 장치를 이용하 여 음악을 작곡한다. 사용자는 컴퓨터 장치에 시드 요소를 입력할 수 있다. 시드 요소는 작곡 인공 지능 모델에 입력되어 일정한 음악을 생성하는데 사용된다. 시드 요소는 작곡을 위한 시작 정보에 해당하고, 일정한 리듬, 멜로디, 코드(chord)와 같은 정보를 포함할 수 있다. 나아가 사용자는 도 1에 도시한 바와 같이 스마트 기기와 같은 컴퓨터 장치에 시드 요소를 생성하기 위한 일정한 정보를 입력할 수 있다. 예컨대, 사용자는 터치 패널(또는 다른 인터페이스 장치)을 통해 그래픽 요소인 선을 입력할 수 있다. 도 1에 도시한 바와 같이 사용자는 일정한 변화를 갖는 선을 입력할 수 있다. 사용자가 입력하는 그래픽 객체의 종류는 다양할 수 있다. 사용자는 선, 점, 곡선, 특정 모양 등을 입력할 수도 있다. 나 아가 사용자는 직접 음성이나 음악을 컴퓨터 장치에 입력할 수도 있다. 컴퓨터 장치는 별도의 인공 지능 모델을 사용하여 사용자가 입력한 정보를 기반으로 시드 요소를 추출할 수 있다. 도 2는 음악 작곡을 위한 신경망 모델을 도시한 예이다. 도 2는 음악을 생성하는 인공 지능 모델에 대한 예이다. 컴퓨터 장치는 도 2와 같이 복수의 신경망을 사용하여 음악을 작곡할 수 있다. 예컨대, 코드를 출력하 는 신경망 모델, 멜로디를 출력하는 신경망 모델, 리듬을 출력하는 신경망 모델 등을 이용할 수 있다. 즉 컴퓨 터 장치는 각각 모듈화된 복수의 신경망을 이용하여 음악을 작곡할 수 있다. 코드 신경망은 사전에 샘플 코드를 이용하여 학습된다. 코드 신경망은 시드 코드를 입력받아 일정한 코 드를 출력한다. 시드 코드는 전술한 시드 요소 중 하나이다. 멜로디 신경망은 사전에 샘플 멜로디를 이용하여 학습된다. 멜로디 신경망은 시드 멜로디를 입력받아 일정한 멜로디를 출력한다. 시드 멜로디는 전술한 시드 요소 중 하나이다. 리듬 신경망은 사전에 샘플 리듬을 이용하여 학습된다. 리듬 신경망은 시드 리듬을 입력받아 일정한 리 듬을 출력한다. 시드 리듬을 전술한 시드 요소 중 하나이다. 후처리 신경망은 코드, 멜로디 및 리듬을 입력받아 최종적임 음악을 출력한다. 후처리 신경망은 코드 진행을 고려하여 멜로디를 수정할 수 있다. 예컨대, 후처리 신경망은 코드와 조성이 맞도록 멜로디 라인 중 특정 음표를 제거하거나, 멜로디 라인의 음의 조절할 수 있다. 후처리 신경망은 리듬에 맞도록 멜로디 라인 의 위치 내지 길이를 조절할 수 있다. 코드 신경망, 멜로디 신경망, 리듬 신경망 및 후처리 신경망은 강화 학습 방식을 사용한다. 코 드 신경망, 멜로디 신경망, 리듬 신경망 및 후처리 신경망은 공통된 신경망 모델을 사용할 수 있다. 공통된 신경망 모델(이하 작곡 신경망)에 대해 설명한다. 도 3은 신경망 모듈의 구조를 도시한 예이다. 도 3은 코드 신경망을 예로 도시하였다. 코드 신경망은 코드를 작곡하는 작곡 신경망 및 작곡 신경망의 출력 결과를 평가하는 평가 신경망을 포함한다. 나 아가 멜로디 신경망, 리듬 신경망, 후처리 신경망도 동일한 구성을 갖는다. 트레이닝 데이터는 인간이 작곡한 곡의 코드, 멜로디, 리듬 등의 시퀀스를 사용한다. 나아가 트레이닝 데이터는 인공 지능이 작곡한 곡의 코드, 멜로디, 리듬 등의 시퀀스를 사용할 수도 있다. 작곡 신경망은 학습된 데이터로부터 일련의 시퀀스를 출력하고, 출력한 시퀀스를 평가 신경망에 전달한다. 신경 망의 종류에 따라 시퀀스는 코드 진행, 멜로디 라인, 리듬 또는 완성된 악곡에 해당한다. 평가 신경망이 정답을 출력할 경우 작곡 신경망의 점수를 감점하고, 오답을 출력할 경우 점수를 가산하는 방식의 강화학습을 수행한다. 작곡 신경망은 시퀀스 진행을 학습하는 학습부와, 시퀀스 진행을 출력하는 출력부를 포함할 수 있다. 작곡 신경 망은 오토 인코더(Auto Encoder) 형태를 가질 수 있다. 오토인코더는 신경망 중 자율학습(Unsupervised learning)을 사용하여 학습하는 모델을 의미한다. 오토인코더는 입력 계층(input layer)과 은닉 계층(hidden layer)을 포함하는 인코더(encoder) 및 은닉 계층과 출력 계층(output layer)을 포함하는 디코더(decoder)로 구성된다. 작곡 신경망은 평가 신경망의 피드백을 받아 확률 파라미터를 수정하면서 강화 학습을 진행한다. 예컨대, 작곡 신경망은 평가 신경망의 평가 결과가 정답인 경우 확률 파라미터를 수정하고, 오답일 경우 파라미터를 강화하는 방식으로 강화학습을 진행한다. 오토 인코더로 구성하는 경우 평가 신경망의 출력 결과물에 따라 가중치를 수정 하며 학습하는 방식을 고려할 수 있다. 평가 신경망은 임의로 주어지는 일련의 시퀀스를 입력받아 이것이 인간이 작곡한 시퀀스인지, 아니면 인공지능 이 작곡한 시퀀스인지를 판별한다. 평가 신경망은 판별 결과가 정답일 경우 점수를 가산하며, 판별 결과가 오답 일 경우 점수를 감산한다. 평가 신경망은 판별 결과를 작곡 신경망에 전달한다. 평가 신경망은 동종의 시퀀스들과 결과물의 출처가 인간인지 인공지능인지를 구분짓는 레이블을 학습하는 학습 부 및 학습부의 확률적 파라미터를 이용하여 입력된 데이터의 출처가 인간의 작곡물인지 또는 인공지능의 창작 물인지를 구분하는 판별부를 포함한다. 평가 신경망은 인간이 작곡한 곡의 시퀀스와 상술한 작곡 인공지능이 작곡한 시퀀스를 트레이닝 데이터로 사용 한다. 임의의 순서로 인간이 작곡한 시퀀스와 인공지능이 작곡한 시퀀스를 입력하면서 평가를 수행하고, 평가 결과의 정확도가 높아지도록 내부 확률 파라미터를 조절한다. 평가 신경망이 구축되면, 작곡 신경망은 일정한 시드 요소를 입력받아 일정한 시퀀스를 출력하고, 평가 신경망 은 출력된 시퀀스를 평가한다. 학습이 진행되면서 작곡 신경망은 평가 신경망의 오답을 유도할 수 있도록, 더욱 교묘하게 인간과 같은 수준의 작곡물을 출력하도록 성장하며 평가 신경망은 이를 날카롭게 간파하는 방향으로 성장한다.나아가 도 2에 도시한 바와 같이 컴퓨터 장치는 코드 ,리듬, 멜로디에 대한 별도의 신경망을 이용할 수 있다. 컴퓨터 장치는 하부적인 음악적 구조인 화성, 리듬, 가락 등을 선택적으로 학습하여 하부구조를 출력하는 인공 지능들을 각각 학습시키고, 이들의 결과물을 합쳐 활용할 수 있다. 멜로디 신경망은 화성과 멜로디를 함께 입력받아 학습하도록 구성해야 화성과 어긋나지 않는 통일성 있는 멜로디를 출력할 수도 있다. 나아가 베이스 라인과 멜로디 라인을 위한 별도의 신경망을 이용할 수 있다. 이 경우 베이스 라인을 생성하기 위한 별도의 베이스 라인 신경망을 사용할 수 있다. 베이스 라인 신경망 구축은 멜로디 신경망과 동일하다. 베이스 라인 신경망은 학습 데이터로 기성 악곡의 베이스 라인을 사용한다. 도 4는 음악 작곡을 위한 신경망 모델을 도시한 다른 예이다. 도 4는 음악을 생성하는 인공 지능 모델에 대한 예이다. 도 2와는 다른 모델에 대한 예이다. 도 4는 도 2와 달리 시드 신경망 및 피팅 신경망을 더 포 함한다. 사용자는 악보와 같은 전문적인 정보를 사용하지 않고, 도 1에서 설명한 바와 같이 단순한 방식으로 시드 요소 를 입력할 수 있다. 이를 위해 필요한 것이 시드 신경망이다. 시드 신경망은 사용자로부터 시드 라인을 입력받아 이를 음악적 요소로 변환하고, 피팅 신경망은 시드 신경망이 출력하는 음악적 요소에 따라 멜로디가 출력되도록 조절한다. 사용자는 도 1과 같이 종 또는 횡을 따라 선을 그리거나, 음을 입력하여 시드 라인을 입력한다. 시드 라인은 사 용자가 컴퓨터 장치 등에 직접 입력하는 입력 정보를 의미한다. 예컨대, 시드 라인으로 그래픽 객체인 선을 이 용한다고 가정한다. 사용자는 인터페이스 장치를 통해 일정한 형태의 선을 입력한다. 선은 고저 변화 또는 좌우 변화라는 기하학적 정보는 음의 높이 변화에 매칭될 수 있다. 시드 신경망은 사용자가 입력한 선을 입력받아 음악적 모티프를 출력한다. 음악적 모티프는 전술한 시드 요소이다. 인공지능 모델에 따라 시드 신경망은 시드 코드, 시드 멜로디, 시드 리듬 중 적어도 하나를 출력한다. 시드 신경망도 사전에 학습을 통해 마련된다. 시드 신경망 은 다양한 방식의 기계학습 내지 딥 러닝 기법을 이용하여 마련될 수 있다. 선이라는 그래프 요소를 사용한 다면 CNN(Convolutional Neural Network)과 같은 신경망을 이용할 수도 있다. 피팅 신경망은 시드 신경망이 출력한 시드 요소를 전달받는다. 예컨대, 피팅 신경망은 시드 멜로디 를 전달받고, 멜로디 신경망이 출력하는 멜로디와 비교하여 사용자가 입력한 시드라인 정보와 유사한 패턴 의 멜로디가 출력되도록 제어할 수 있다. 피팅 신경망은 시드 멜로디 또는 시드 멜로디를 반복한 결과물과 멜로디 신경망이 출력하는 특정 구간의 멜로디를 비교하여 패턴의 유사도가 기준값을 벗어나는 경우 멜로디 신경망이 출력한 멜로디를 버리고, 다시 새로운 멜로디 라인을 생성하도록 멜로디 신경망에 제어 명령 을 전달할 수 있다. 이러한 관정을 통해 멜로디 신경망이 학습한 음악의 경향성을 위배하지 않으면서 사용 자가 입력한 시드 정보에 부합하는 결과를 추출할 수 있다. 한편 후처리 신경망이 출력하는 정보는 음악을 재생하는 음악 파일일 수도 있고, 멜로디/리듬/화성 등의 정 보를 포함하는 음악 정보(텍스트, 악보 등)일 수도 있다. 본 실시례 및 본 명세서에 첨부된 도면은 전술한 기술에 포함되는 기술적 사상의 일부를 명확하게 나타내고 있 는 것에 불과하며, 전술한 기술의 명세서 및 도면에 포함된 기술적 사상의 범위 내에서 당업자가 용이하게 유추 할 수 있는 변형 예와 구체적인 실시례는 모두 전술한 기술의 권리범위에 포함되는 것이 자명하다고 할 것이다."}
{"patent_id": "10-2017-0024223", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 모듈화된 신경망을 이용하여 음악을 작곡하는 과정에 대한 예이다. 도 2는 음악 작곡을 위한 신경망 모델을 도시한 예이다. 도 3은 신경망 모듈의 구조를 도시한 예이다. 도 4는 음악 작곡을 위한 신경망 모델을 도시한 다른 예이다."}
