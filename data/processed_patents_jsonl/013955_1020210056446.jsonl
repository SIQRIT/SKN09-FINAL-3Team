{"patent_id": "10-2021-0056446", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2022-0149929", "출원번호": "10-2021-0056446", "발명의 명칭": "주목 매커니즘 기반의 멀티 스케일 신경망을 활용한 흉부 X선 영상 검출 장치 및 방법", "출원인": "연세대학교 산학협력단", "발명자": "장혁재"}}
{"patent_id": "10-2021-0056446", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "주목 메커니즘 기반의 멀티 스케일 조건부 적대적 생성 신경망을 활용한 고해상도 흉부 X선 영상 생성 장치에있어서,잠재변수 및 특정 질환의 특징에 대한 조건변수를 입력받고 각 분기마다 업샘플링(up-sampling)하여 각각 해상도가 다른 상기 특정 질환을 나타내는 복수의 흉부 X선 영상을 생성하는 생성자 및 상기 복수의 흉부 X선 영상의 진위 여부를 구별하는 판별자를 포함하는 멀티 스케일 조건부 적대적 생성 신경망을 구축하는 모델 구축부;및상기 멀티 스케일 조건부 적대적 생성 신경망에 상기 잠재변수 및 특정 질환의 특징에 대한 조건변수를 입력하여 기설정된 값 이상의 해상도를 갖고 상기 특정 질환을 나타내는 흉부 X선 영상을 생성하는 영상 생성부를 포함하는 것인, 흉부 X선 영상 생성 장치."}
{"patent_id": "10-2021-0056446", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제 1 항에 있어서,상기 생성자는 제 1 분기에서 제 1 해상도의 영상 분포를 근사화하여 기본 색상 및 구조를 갖는 흉부 X선 영상을 생성하고, 제 2 분기에서 상기 기본 색상 및 구조를 갖는 흉부 X선 영상의 경사(gradient)를 전달받아 상기제 1 해상도보다 높은 제 2 해상도의 영상 분포를 근사화하여 세부 정보를 표현하는 흉부 X선 영상을 생성하는것인, 흉부 X선 영상 생성 장치."}
{"patent_id": "10-2021-0056446", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제 2 항에 있어서,상기 판별자는 상기 제 1 분기에서 생성된 흉부 X선 영상의 진위 여부를 판별하는 제 1 판별자, 상기 제 2 분기에서 생성된 흉부 X선 영상의 진위 여부를 판별하는 제 2 판별자 및 상기 제 3 분기에서 생성된 흉부 X선 영상의 진위 여부를 판별하는 제 3 판별자를 포함하는 것인, 흉부 X선 영상 생성 장치."}
{"patent_id": "10-2021-0056446", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제 3 항에 있어서,상기 제 1 판별자, 상기 제 2 판별자 및 상기 제 3 판별자의 손실함수는 하기의 수학식으로 표현되는, 흉부 X선영상 생성 장치."}
{"patent_id": "10-2021-0056446", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제 4 항에 있어서,공개특허 10-2022-0149929-3-상기 생성자의 손실함수는 하기의 수학식으로 표현되는, 흉부 X선 영상 생성 장치."}
{"patent_id": "10-2021-0056446", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제 1 항에 있어서,상기 판별자는 상기 복수의 흉부 X선 영상이 상기 조건변수를 만족하는지 여부를 추가로 구별하는 것인, 흉부 X선 영상 생성 장치."}
{"patent_id": "10-2021-0056446", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제 2 항에 있어서,상기 제 1 분기는 업-블록층(up-block layer), 주목층(attention layer) 및 합성곱층(convolution layer)을 포함하는 것인, 흉부 X선 영상 생성 장치."}
{"patent_id": "10-2021-0056446", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제 2 항에 있어서,상기 제 2 분기 및 상기 제 3 분기는 잔차층(residual layer) 및 업-블록층(up-block layer)을 포함하는 것인,흉부 X선 영상 생성 장치."}
{"patent_id": "10-2021-0056446", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제 1 항에 있어서,상기 조건변수는 복수의 흉부 질환을 나타내는 상기 복수의 흉부 X선 영상을 생성하기 위해 복수의 클래스 중어느 하나의 클래스에 대한 원-핫 인코딩(One-Hot Encoding) 값인 것인, 흉부 X선 영상 생성 장치."}
{"patent_id": "10-2021-0056446", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "주목 메커니즘 기반의 멀티 스케일 조건부 적대적 생성 신경망을 활용한 고해상도 흉부 X선 영상 생성 방법에있어서,잠재변수 및 특정 질환의 특징에 대한 조건변수를 입력받고 각 분기마다 업샘플링(up-sampling)하여 각각 해상도가 다른 상기 특정 질환을 나타내는 복수의 흉부 X선 영상을 생성하는 생성자 및 상기 복수의 흉부 X선 영상의 진위 여부를 구별하는 판별자를 포함하는 멀티 스케일 조건부 적대적 생성 신경망을 구축하는 단계; 및상기 멀티 스케일 조건부 적대적 생성 신경망에 상기 잠재변수 및 특정 질환의 특징에 대한 조건변수를 입력하여 기설정된 값 이상의 해상도를 갖고 상기 특정 질환을 나타내는 흉부 X선 영상을 생성하는 단계를 포함하는 것인, 흉부 X선 영상 생성 방법."}
{"patent_id": "10-2021-0056446", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "제 10 항에 있어서,공개특허 10-2022-0149929-4-상기 생성자는 제 1 분기에서 제 1 해상도의 영상 분포를 근사화하여 기본 색상 및 구조를 갖는 흉부 X선 영상을 생성하고, 제 2 분기에서 상기 기본 색상 및 구조를 갖는 흉부 X선 영상의 경사(gradient)를 전달받아 상기제 1 해상도보다 높은 제 2 해상도의 영상 분포를 근사화하여 세부 정보를 표현하는 흉부 X선 영상을 생성하는것인, 흉부 X선 영상 생성 방법."}
{"patent_id": "10-2021-0056446", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제 11 항에 있어서,상기 판별자는 상기 제 1 분기에서 생성된 흉부 X선 영상의 진위 여부를 판별하는 제 1 판별자, 상기 제 2 분기에서 생성된 흉부 X선 영상의 진위 여부를 판별하는 제 2 판별자 및 상기 제 3 분기에서 생성된 흉부 X선 영상의 진위 여부를 판별하는 제 3 판별자를 포함하는 것인, 흉부 X선 영상 생성 방법."}
{"patent_id": "10-2021-0056446", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "제 12 항에 있어서,상기 제 1 판별자, 상기 제 2 판별자 및 상기 제 3 판별자의 손실함수는 하기의 수학식으로 표현되는 것인, 흉부 X선 영상 생성 방법."}
{"patent_id": "10-2021-0056446", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_14", "content": "제 13 항에 있어서,상기 생성자의 손실함수는 하기의 수학식으로 표현되는 것인, 흉부 X선 영상 생성 방법."}
{"patent_id": "10-2021-0056446", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_15", "content": "제 10 항에 있어서,상기 판별자는 상기 복수의 흉부 X선 영상이 상기 조건변수를 만족하는지 여부를 추가로 구별하는 것인, 흉부 X선 영상 생성 방법."}
{"patent_id": "10-2021-0056446", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_16", "content": "제 11 항에 있어서,상기 제 1 분기는 업-블록층(up-block layer), 주목층(attention layer) 및 합성곱층(convolution layer)을 포함하는 것인, X선 영상 생성 방법."}
{"patent_id": "10-2021-0056446", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_17", "content": "공개특허 10-2022-0149929-5-제 11 항에 있어서,상기 제 2 분기 및 상기 제 3 분기는 잔차층(residual layer) 및 업-블록층(up-block layer)을 포함하는 것인,흉부 X선 영상 생성 방법."}
{"patent_id": "10-2021-0056446", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_18", "content": "제 10 항에 있어서,상기 조건변수는 복수의 흉부 질환을 나타내는 상기 복수의 흉부 X선 영상을 생성하기 위해 복수의 클래스 중어느 하나의 클래스에 대한 원-핫 인코딩(One-Hot Encoding) 값인 것인, 흉부 X선 영상 생성 방법."}
{"patent_id": "10-2021-0056446", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "주목 메커니즘 기반의 멀티 스케일 조건부 적대적 생성 신경망을 활용한 고해상도 흉부 X선 영상 생성 장치는 잠 재변수 및 특정 질환의 특징에 대한 조건변수를 입력받고 각 분기마다 업샘플링(up-sampling)하여 각각 해상도가 다른 상기 특정 질환을 나타내는 복수의 흉부 X선 영상을 생성하는 생성자 및 상기 복수의 흉부 X선 영상의 진위 여부를 구별하는 판별자를 포함하는 멀티 스케일 조건부 적대적 생성 신경망을 구축하는 모델 구축부 및 상기 멀 티 스케일 조건부 적대적 생성 신경망에 상기 잠재변수 및 특정 질환의 특징에 대한 조건변수를 입력하여 기설정 된 값 이상의 해상도를 갖고 상기 특정 질환을 나타내는 흉부 X선 영상을 생성하는 영상 생성부를 포함할 수 있 다."}
{"patent_id": "10-2021-0056446", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 주목 매커니즘 기반의 멀티 스케일 신경망을 활용한 흉부 X선 영상 검출 장치 및 방법에 관한 것이다."}
{"patent_id": "10-2021-0056446", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "최근 인공지능 기술의 발전으로 다양한 분야에서 이를 접목해 비약적인 성능 향상을 이루고 있다. 그 중 의료를 도메인으로 한 인공지능 기반의 많은 연구들이 활발히 진행되고 있는데, 이는 전 세계적인 고령화에 따른 인간 의 기대수명 증가로 의료 수요가 확대되어 의료산업의 경제적 가치가 높아졌기 때문이다. 특히, 다양한 의료 융 합연구들 중 심장, 폐를 대상으로 한 연구들이 많이 있다. 흉부 관련 질환은 환경적인 요인으로 인해 일반인들 도 빈번하게 접할 수 있는 흔한 질환이지만 조기발견 후 적절한 조치가 이뤄지지 않으면 치명적일 수 있다. 때 문에 타 기관에서 발생한 여러 질환들과 비교해봤을 때 상대적인 중요도가 커 흉부 기관 대상으로 한 다양한 연 구가 이루어지고 있다. 심·폐질환을 조기에 발견하기 위한 일반적인 검사로는 흉부 X선이 있으며, X선을 흉곽 부위에 투과하여 심장과 폐 관련 질환 유무를 판단한다. 흉부 X선 검사는 전산단층촬영술(Computed Tomography, CT)이나 자기공명영상 (Magnetic Resonance Imaging, MRI) 등 다른 고가검사와 비교하여 상대적으로 저렴하고 단시간에 촬영 가능하며 피폭 선량이 적다는 장점이 있다. 하지만 바쁜 의료현장에서 임상의들이 수많은 환자들의 영상을 정량적으로 정확하게 판독하는 것은 시간소모적 인 작업이며 노동비용 또한 크다. 이를 보완하기 위해 최근에는 인공지능 기술을 활용하여 빠르고 정확하게 영 상판독이 가능한 모듈에 대한 연구결과가 나오고 있다. 한편, 현재의 지도학습기반 인공지능 모델을 잘 학습하는데 있어 균형 있는(balanced) 데이터 셋은 학습 수렴에 있어 매우 중요하다. 그러나 질환 유병률 차이에 의해 수집된 의료 데이터는 대부분 수적으로 불균형하며, 전처 리과정 없이 바로 학습 데이터로 사용할 경우 특정 질환에 과적합(overfitting)되어 원하지 않는 수렴 결과를 얻을 수 있다. 흉부 X선 영상의 경우도 마찬가지로 빈번히 발생하는 질환들(무기폐, 흉수, 침윤 등)은 학습이 잘 진행되는 반면, 그렇지 않은 질환(폐렴, 심장 비대 등)들의 경우 학습 성능이 상대적으로 좋지 못하다. 이러한 데이터 수적 불균형으로 인한 학습 성능 저하 문제를 해결하고자 최근 다양한 데이터 증강(data augmentation) 기술들이 제안되었고, 성능의 향상이 있었다. 영상 데이터의 대표적인 데이터 증강방법은 상하좌 우 반전, 밝기조절 등이 있으나, 이렇게 재구성된 영상 데이터는 표준데이터를 기반으로 생성되기 때문에 적은 데이터에서는 성능 향상이 높지 않을 수 있다. 따라서 훨씬 더 광범위한 데이터 집합을 생성하기 위한 근본적인 해결책으로 표준데이터 수의 증가가 필요하다. 최근, 이러한 문제의 새로운 해결 방안으로 표준데이터 분포의 추정을 학습하는 적대적 생성 신경망(Generative Adversarial Network, GAN)기반의 데이터 증강 기법이 소개되었다. 이 신경망은 다양한 사례에 적용되어 실제와 거의 유사한 거짓 데이터를 만들어 데이터의 수적 불균형 문제를 해결함으로써 분류 성능이 향상됨을 입증하였다. 이와 관련하여, 한국등록특허 제10-2119056호는 생성적 적대 신경망 기반의 의료영상 학습 방법 및 장치를 개시하고 있다. 그러나, 목표 클래스가 다수 개일 경우 각 클래스별로 적대적 생성 신경망을 학습해야 하기 때문에 비효율적이 며 영상 수가 극단적으로 제한적일 경우 학습이 거의 불가능하다는 문제가 있었다."}
{"patent_id": "10-2021-0056446", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은 다수의 질환에 대한 흉부 X선 영상 데이터 셋의 수적 불균형문제를 해결을 목적으로 단 하나의 네트 워크만으로도 질환 별 특징이 잘 반영된 고해상도 영상을 생성할 수 있는 흉부 X선 영상 생성 장치 및 방법을 제공하고자 한다. 다만, 본 실시예가 이루고자 하는 기술적 과제는 상기된 바와 같은 기술적 과제들로 한정되지 않으며, 또 다른 기술적 과제들이 존재할 수 있다."}
{"patent_id": "10-2021-0056446", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "상술한 기술적 과제를 달성하기 위한 기술적 수단으로서, 본 발명의 일 실시예는 잠재변수 및 특정 질환의 특징 에 대한 조건변수를 입력받고 각 분기마다 업샘플링(up-sampling)하여 각각 해상도가 다른 상기 특정 질환을 나 타내는 복수의 흉부 X선 영상을 생성하는 생성자 및 상기 복수의 흉부 X선 영상의 진위 여부를 구별하는 판별자 를 포함하는 멀티 스케일 조건부 적대적 생성 신경망을 구축하는 모델 구축부 및 상기 멀티 스케일 조건부 적대 적 생성 신경망에 상기 잠재변수 및 특정 질환의 특징에 대한 조건변수를 입력하여 기설정된 값 이상의 해상도 를 갖고 상기 특정 질환을 나타내는 흉부 X선 영상을 생성하는 영상 생성부를 포함하는 것인, 흉부 X선 영상 생 성 장치를 제공할 수 있다. 또한, 본 발명의 다른 실시예는 잠재변수 및 특정 질환의 특징에 대한 조건변수를 입력받고 각 분기마다 업샘플 링(up-sampling)하여 각각 해상도가 다른 상기 특정 질환을 나타내는 복수의 흉부 X선 영상을 생성하는 생성자 및 상기 복수의 흉부 X선 영상의 진위 여부를 구별하는 판별자를 포함하는 멀티 스케일 조건부 적대적 생성 신 경망을 생성하는 단계 및 상기 멀티 스케일 조건부 적대적 생성 신경망에 상기 잠재변수 및 특정 질환의 특징에 대한 조건변수를 입력하여 기설정된 값 이상의 해상도를 갖고 상기 특정 질환을 나타내는 흉부 X선 영상을 생성 하는 단계를 포함하는 것인, 흉부 X선 영상 생성 방법을 제공할 수 있다. 상술한 과제 해결 수단은 단지 예시적인 것으로서, 본 발명을 제한하려는 의도로 해석되지 않아야 한다. 상술한 예시적인 실시예 외에도, 도면 및 발명의 상세한 설명에 기재된 추가적인 실시예가 존재할 수 있다."}
{"patent_id": "10-2021-0056446", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "전술한 본 발명의 과제 해결 수단 중 어느 하나에 의하면, 입력으로 조건 변수를 추가하여 생성되는 흉부 X선 영상의 목표 질환을 제어할 수 있어 학습의 비효율성을 제거하였을 뿐만 아니라 극단적으로 불균형한 경우 학습 이 불가능한 문제를 해결할 수 있다. 또한, 주목 메커니즘(attention mechanism)의 적용을 통해 국소적인 부분만이 아니라 영상 전체적으로 형태의 일관성이 보존되어 더 사실과 가까운 영상을 생성할 수 있다."}
{"patent_id": "10-2021-0056446", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "아래에서는 첨부한 도면을 참조하여 본 발명이 속하는 기술 분야에서 통상의 지식을 가진 자가 용이하게 실시할 수 있도록 본 발명의 실시예를 상세히 설명한다. 그러나 본 발명은 여러 가지 상이한 형태로 구현될 수 있으며 여기에서 설명하는 실시예에 한정되지 않는다. 그리고 도면에서 본 발명을 명확하게 설명하기 위해서 설명과 관 계없는 부분은 생략하였으며, 명세서 전체를 통하여 유사한 부분에 대해서는 유사한 도면 부호를 붙였다. 명세서 전체에서, 어떤 부분이 다른 부분과 \"연결\"되어 있다고 할 때, 이는 \"직접적으로 연결\"되어 있는 경우뿐 아니라, 그 중간에 다른 소자를 사이에 두고 \"전기적으로 연결\"되어 있는 경우도 포함한다. 또한 어떤 부분이 어떤 구성요소를 \"포함\"한다고 할 때, 이는 특별히 반대되는 기재가 없는 한 다른 구성요소를 제외하는 것이 아 니라 다른 구성요소를 더 포함할 수 있는 것을 의미하며, 하나 또는 그 이상의 다른 특징이나 숫자, 단계, 동작, 구성요소, 부분품 또는 이들을 조합한 것들의 존재 또는 부가 가능성을 미리 배제하지 않는 것으로 이해 되어야 한다. 본 명세서에 있어서 '부(部)'란, 하드웨어에 의해 실현되는 유닛(unit), 소프트웨어에 의해 실현되는 유닛, 양 방을 이용하여 실현되는 유닛을 포함한다. 또한, 1 개의 유닛이 2 개 이상의 하드웨어를 이용하여 실현되어도 되고, 2 개 이상의 유닛이 1 개의 하드웨어에 의해 실현되어도 된다. 본 명세서에 있어서 단말 또는 디바이스가 수행하는 것으로 기술된 동작이나 기능 중 일부는 해당 단말 또는 디 바이스와 연결된 서버에서 대신 수행될 수도 있다. 이와 마찬가지로, 서버가 수행하는 것으로 기술된 동작이나 기능 중 일부도 해당 서버와 연결된 단말 또는 디바이스에서 수행될 수도 있다. 이하 첨부된 도면을 참고하여 본 발명의 일 실시예를 상세히 설명하기로 한다. 도 1은 본 발명의 일 실시예에 따른 흉부 X선 영상 생성 장치를 도시한 도면이고, 도 2는 본 발명의 일 실시예 에 따른 멀티 스케일 조건부 적대적 생성 신경망의 네트워크 구조를 도시한 도면이다. X선 영상 생성 장치는 멀티 스케일 조건부 적대적 생성 신경망을 통해 흉부 X선 영상 내 늑골, 횡격막, 폐, 심장 등의 세부적인 특징들을 잘 반영하여 고해상도 영상을 생성할 수 있다. 즉, 흉부 X선 영상 내 기관들의 세부적인 특징들을 잘 반영하기 위해서는 고해상도 영상이 필수적으로 요구되는 데, 본원에 따르면 저해상도 영상에서 고해상도 영상까지 멀티 스케일 영상 분포를 학습하여 고해상도 영상을 생성할 수 있다. 본원에 따르면, 멀티 스케일 조건부 적대적 생성 신경망은 질환 조건 제어인자인 조건변수를 추가해 단 하나의 네트워크만으로 다수 질환에 대한 영상을 생성할 수 있다. 한편, 흉부 X선 영상의 경우 환자마다 골격이나 기관의 모습이 다르고(patient-specific) 혈관과 같은 주변기관 과 잡음으로 인해 명암도 레벨의 분포가 불명확하여 지역적 특성만 고려해서는 질환이 무엇인지 판단하기 어렵 다. 또한, 질환 영역이 영상 전체에 걸쳐 있거나 여러 개가 멀리 떨어져 분포할 수 있기 때문에 영상 내 장거리 종속성 문제 해결이 필수적으로 요구된다. 본원에 따르면, 멀티 스케일 조건부 적대적 생성 신경망에 주목 메커니즘을 적용하여 생성되는 흉부 X선 영상 내 장기 종속성 문제를 해결함으로써 흉부 X선 영상의 생성 성능을 향상시킬 수 있다. X선 영상 생성 장치의 일예는 데스크탑, 노트북 등과 같은 퍼스널 컴퓨터(personal computer)뿐만 아니라 유 무선 통신이 가능한 모바일 단말을 포함할 수 있다. 모바일 단말은 휴대성과 이동성이 보장되는 무선 통신 장치 로서, 스마트폰(smartphone), 태블릿 PC, 웨어러블 디바이스뿐만 아니라, 블루투스(BLE, Bluetooth Low Energy), NFC, RFID, 초음파(Ultrasonic), 적외선, 와이파이(WiFi), 라이파이(LiFi) 등의 통신 모듈을 탑재한 각종 디바이스를 포함할 수 있다. 다만, X선 영상 생성 장치는 도 1에 도시된 형태 또는 앞서 예시된 것들 로 한정 해석되는 것은 아니다. 도 1 및 도 2를 참조하면, 흉부 X선 영상 생성 장치는 모델 구축부 및 영상 생성부를 포함할 수 있다. 모델 구축부는 생성자 및 판별자(203, 205, 207)를 포함하는 멀티 스케일 조건부 적대적 생성 신경망 을 구축할 수 있다. 멀티 스케일 조건부 적대적 생성 신경망은 예를 들어 StackGAN++과 LSGAN을 확장하여 저해상도 영상에서 고해상도 영상까지 멀티 스케일 영상 분포를 학습하는 네트워크일 수 있다. 멀티 스케일 조건부 적대적 생성 신경망은 하나의 생성자와 다수개의 판별자(203, 205, 207)로 구성 되어 트리 구조의 네트워크로 이루어질 수 있다. 멀티 스케일 조건부 적대적 생성 신경망의 생성자는 잠재변수 및 특정 질환의 특징에 대한 조건변수 를 입력받고 각 분기마다 업샘플링(up-sampling)하여 각각 해상도가 다른 특정 질환을 나타내는 복수의 흉부 X 선 영상을 생성할 수 있다. 예를 들어, 생성자는 생성자 내 각 분기(branch)별로 저해상도 영상에서 고해상도 영상까지 멀티 스 케일 영상분포를 학습해 점진적으로 고화질 흉부 X선 영상을 생성할 수 있다. 이 때, 조건변수는 잠재변수의 일부를 대신해 생성할 흉부 X선 영상을 질환별로 제어할 수 있도록 한다. 조건변수는 복수의 흉부 질환을 나타내는 복수의 흉부 X선 영상을 생성하기 위해 복수의 클래스 중 어느 하나의 클래스에 대한 원-핫 인코딩(One-Hot Encoding) 값일 수 있다. 예를 들어, 본원에 따르면 대표적인 8개의 흉부 질환에 해당하는 흉부 X선 영상을 생성하기 위해 조건변수에는 8개의 클래스에 대한 원-핫 인코딩 값이 할당될 수 있다. 즉, 표준 정규 분포로 표현된 초기 분포는 조건변수와 함께 생성자의 여러 은닉 층(hidden layer)을 거치 면서 각 분기별마다 해당 스케일의 표준 데이터 분포 내 데이터로 근사화될 수 있다. 또한, 멀티 스케일 조건부 적대적 생성 신경망의 판별자(203, 205, 207)는 복수의 흉부 X선 영상의 진위 여부를 구별할 수 있다. 뿐만 아니라, 판별자(203, 205, 207)는 종래의 적대적 생성 신경망의 판별자와 달리 생 성자가 생성한 복수의 흉부 X선 영상이 조건변수를 만족하는지 여부를 추가로 구별할 수 있다. 즉, 판별자(203, 205, 207)는 생성자의 각 분기별에 대응하는 판별자(203, 205, 207)가 생성자에 의 해 생성된 멀티 스케일 영상이 잘 만들어졌는지 여부를 평가함으로써 생성자가 최적화 될 수 있도록 인도 한다. 생성자는 총 3개의 분기로 나눠져 저해상도에서 고해상도의 흉부 X선 영상을 생성할 수 있다. 즉, 생성자는 제 1 해상도를 갖는 흉부 X선 영상을 생성하는 제 1 분기, 제 1 해상도보다 높은 제 2 해상도를 갖는 흉부 X선 영상을 생성하는 제 2 분기 및 제 2 해상도보다 높은 제 3 해상도를 갖는 흉부 X 선 영상을 생성하는 제 3 분기를 포함할 수 있다. 예를 들어, 생성자는 제 1 분기에서 제 1 해상도의 영상 분포를 근사화하여 기본 색상 및 구조를 갖는 흉 부 X선 영상을 생성하고, 제 2 분기에서 기본 색상 및 구조를 갖는 흉부 X선 영상의 경사(gradient)를 전달받아 제 1 해상도보다 높은 제 2 해상도의 영상 분포를 근사화하여 세부 정보를 표현하는 흉부 X선 영상을 생성할 수 있다. 예를 들어, 제 1 분기는 저해상도 영상(64x64)을 위한 서브-생성자로서 4개의 업-블록층(up-block layer), 주목층(attention layer) 및 3*3 합성곱층(convolution layer)을 포함할 수 있다. 여기서, 업-블록층에는 체커 보드 인공물(checkerboard-artifact) 발생을 완화시키기 위해 업샘플링으로 최근접 이웃(nearest-neighbor) 방 법이 사용될 수 있다. 제 2 분기 및 제 3 분기의 서브-생성자는 결합(joining) 층과 두 번의 잔차층(residual layer) 및 업-블록층(up-block layer)을 포함할 수 있다. 제 2 분기 및 제 3 분기에서는 4단계의 층을 통과한 후 3x3 합성곱을 거쳐 각각 128x128 흉부 X선 영상과 256x256 흉부 X선 영상을 출력할 수 있다. 각 분기별 판별자(203, 205, 207)는 다운샘플링(down-sampling) 층으로 구성되며 조건과 비조건 손실함수 계산 을 위해 마지막 층 전단계의 입력부분을 두 부분으로 나누어 한 곳에만 조건변수를 결합시킬 수 있다.판별자(203, 205, 207)는 제 1 분기에서 생성된 흉부 X선 영상의 진위 여부를 판별하는 제 1 판별자, 제 2 분기에서 생성된 흉부 X선 영상의 진위 여부를 판별하는 제 2 판별자 및 제 3 분기에서 생 성된 흉부 X선 영상의 진위 여부를 판별하는 제 3 판별자를 포함할 수 있다. 즉, 생성자의 총 m개의 분기에 대하여 순차적으로 저해상도 영상 판별자(i=1)와 고해상도 영상 판별자 (i=m)가 있으며, i번째 생성자 분기의 판별자의 손실함수는 수학식 1과 같이 정의될 수 있다. 여기서, a, b 값은 각각 0, 1로 설정된다. 수학식 1"}
{"patent_id": "10-2021-0056446", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "수학식 1에서, si는 생성자로부터 생성된 크기별 샘플을 의미한다. 즉, si = Gi(hi)이고 i는 0, 1, ..., m-1의 범위를 갖는다. 또한 hi = F(hi-1, z)이며, 여기서 hi는 Gi의 은닉 피처(hidden feature)일 수 있다. 생성자의 경우는 각 분기별로 판별자 손실함수들의 합으로 표현되며, 손실함수는 수학식 2와 같이 정의될 수 있다. 여기서, d 값은 1로 설정된다. 수학식 2"}
{"patent_id": "10-2021-0056446", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "즉, 생성자는 저해상도에서 고해상도의 영상들에 대하여 비조건부 영상과 조건부 영상의 분포를 근사화하 는 방향으로 학습된다. 이처럼 멀티 스케일에서 영상 분포를 모델링하게 되면 각 스케일별 경사가 발생되어 전달되기 때문에 초기 층까 지 경사를 잘 전달한다는 장점을 갖고 있다. 결국 이러한 특징은 네트워크 학습을 안정화시키는데 핵심적인 역 할을 해주어 고해상도 영상 생성이 가능하게 된다. 도 3은 본 발명의 일 실시예에 따른 생성자 및 판별자의 손실 그래프를 도시한 도면이다. 도 3의 (a)는 학습단계에서 생성자의 손실 그래프를 나타내며, 도 3의 (b)는 판별자(203, 205, 207)의 손 실 그래프를 나타낸다. 여기서, x축은 반복(iteration), y축은 손실(loss)을 의미한다. 두 신경망은 서로 경쟁하는 관계로 각 신경망 입장에서는 손실 값이 커야 올바르게 학습되고 있음을 의미한다. 도 4는 본 발명의 실험예와 비교예의 성능 비교 결과로서 프레쳇 덴스넷 거리를 나타낸 도면이고, 도 5는 본 발 명의 실험예와 비교예의 성능 비교 결과로서 생성된 흉부 X선 영상을 도시한 도면이다. 본 출원인은 흉부 X선 영상의 데이터 증강 실험을 위하여 NIH Clinical Center에서 제공한 14개 심, 폐질환에 대한 112,120건의 흉부 X선 영상 데이터를 사용하였다. 그 중 8개의 대표 질환(무기폐, 심장 비대, 흉수, 침윤, 종괴, 결절, 폐렴, 기흉)만을 사용하였다. 본 출원인은 성능비교를 위해 8개의 흉부 대표 질환에 대해 2가지 실험을 진행하였다. 첫 번째 실험은 1) 종래의 심층 합성곱 적대적 생성 신경망과 2) 본원의 멀티 스케일 조건부 적대적 생성 신경 망으로 고해상도 영상(256x256)을 질환별로 생성한 후 생성자료의 품질을 평가하기 위해 새롭게 제안한 지표인 프레쳇 덴스넷 거리(Frchet DenseNet distance, FDD)로 네트워크의 성능을 비교한 것이다(도 4). 실험에서 사용한 영상의 개수는 대략 10만장으로 batch size를 16으로 하였을 때 한 에폭당 7,000번의 반복이 이루어진다. 도 3의 그래프를 보면 판별자는 5 에폭 이후 점차 안정화 되었고 생성자는 20 에폭(반복 140,000) 부근에서 함수 변동(fluctuation)이 안정화 되었다. 그 이상 학습을 진행했을 시 두 모델이 균형을 잃어 모두 붕괴(mode collapse)가 발생하여 학습을 중단하였다. 프레쳇 인셉션 거리(Frchet Inception Distance, FID)는 두 정규 분포의 차이를 측정한 것으로 인셉션 점수 (Inception Score, IS)가 실제 자료의 분포를 사용하지 않는 단점을 보완하기 위해서 제안되었다. FID는 수학식 3과 같이 계산되는데 값이 작을수록 좋은 품질을 의미한다. 여기서, 와 는 생성자료와 실제 자료 의 평균과 공분산이다. 하지만, 1,000개의 클래스와 120만개로 구성된 자연 이미지인 ImageNet을 사전 학습한 인셉션 모델을 기반으로 각 정규분포를 구하게 되면 분포를 구할 때 사용되는 이미지가 사전 학습된 모델을 통해 1,000개의 클래스에 속 할 확률 벡터를 출력한다는 점에서 문제가 된다. 그 이유는 인셉션 모델이 자연 이미지를 기반으로 학습되었기 때문에 흉부 X선과 같은 의료 영상을 클래스로 포함하지 않기 때문이다. 즉, 흉부 X선 영상은 자연 이미지가 아 니기 때문에 이렇게 특화된 특징을 해석하기에 적합하지 않다. 따라서 의료 영상의 분포를 구하고 분포간 거리 를 통해 품질을 평가하기 위해서는 의료 도메인에 최적화되어진 모델이 필요하다. 이에, 의료영상을 학습데이터 로 하여 DenseNet을 학습시킨 후 이 모델을 기반으로 두 의료 영상의 정규분포를 구해 거리를 측정하는 프레쳇 덴스넷 거리(Frchet DenseNet Distance, FDD)를 새로운 지표로 제안하여 실험을 수행하였다. 우선, 첫 번째 실험을 진행하기 위해 학습데이터 78,468개, 검증데이터 11,219개로 DenseNet-121을 학습하였다. 그리고 학습된 모델을 기반으로 실제 영상과 cDCGAN 그리고 실제 영상과 제안한 모델에 대한 FDD값을 구하여 모 델의 성능을 정량적으로 평가하였다. 여기서 실제 영상은 DenseNet-121 학습에 사용되지 않은 나머지 부분을 의 미한다. 하지만 의료영상 특성상 데이터 불균형이 심해 각 클래스마다 영상 데이터의 개수가 고르지 못하다. 따 라서 클래스 별 실제영상과 생성된 영상의 개수는 Atelectasis 1,000개, Cardiomegaly 575개, Effusion 1,000 개, Infiltration 1,000개, Mass 729개, Nodule 774개, Pneumonia 242개, Pneu- mothorax 539개로 총 5,859개 의 영상을 동일하게 맞추어 테스트를 수행하였다. 그 결과 도 4에서 보이듯이 실제 영상과 본원의 멀티 스케일 조건부 적대적 생성 신경망을 통해 생성한 영상의 거리를 계산한 FDD값이 실제 영상과 종래의 심층 합성곱 적대적 생성 신경망인 cDCGAN에서 생성한 영상의 거리 를 계산한 FDD값보다 대체로 낮으므로 본원의 멀티 스케일 조건부 적대적 생성 신경망이 더 우수하다는 것을 확 인할 수 있다. 두 번째 실험은 종래의 적대적 생성 신경망인 DCGAN과 본원의 멀티 스케일 조건부 적대적 생성 신경망을 통해 나온 실험결과를 실제 영상과 정성적 비교한 것으로, 본원의 멀티 스케일 조건부 적대적 생성 신경망의 결과에 대해서는 질환별로 질환위치를 찾아 표시하였다. 도 5는 실제 데이터와 종래의 심층 합성곱 적대적 생성 신경망의 결과, 본원의 멀티 스케일 조건부 적대적 생성 신경망의 결과를 나타낸 것이다. 해당 질환에 대한 구체적인 구별방법은 다음과 같다. 무기폐(Atelectasis)는 폐 전체 혹은 일부의 공기 감소를 일으키며, 일반 적으로 폐 용적 감소를 동반하고 호흡 길(기도)이 치우치거나 폐의 백색화가 일어난다. 심장 비대(Cardiomegaly)는 심실벽(근육)이 두꺼워져 심근의 무게가 증가한 상태로 흉곽음영의 내부 길이에 비하여 심장음영의 길이가 절반이상 차지한 경우로 정의한다. 흉 수(Effusion)는 흉막강 내 이상으로 고인 액체로 좌우 흉강의 불균형한 음영증가가 보인다. 침윤(Infiltratio n)은 정상 조직에 염증세포가 모여 있는 모양으로 폐포성 음영증가를 보이며 폐 주변부위에 잘 나타난다. 종괴 (Mass)는 직경 3cm이상의 큰 덩어리 모양으로 증가된 음영. 폐, 흉막, 종격(동), 흉벽 등 흉부 모든 곳에서 기 술 가능하다. 결절(Nodule)은 3cm이하의 경계가 그려지는 둥근 폐 음영이다. 폐렴(Pneumonia)은 폐에 염증이 일 어나는 반응으로 주로 세균의 감염을 통해 일어나고 영상 내 그물모양이나 벌집 모양 같은 음영이 발견된다. 마 지막으로, 기흉(Pneumothorax)은 흉막강 내에 구멍이 생겨 공기가 고이는 상태로 큰 공기주머니가 보인다. 위 질환 설명을 기반으로 종래의 심층 합성곱 적대적 생성 신경망의 결과들은 실제 데이터와 비교해 영상의 해 상도가 확연히 떨어짐을 확인할 수 있다. 즉, 늑골의 모양이나 폐 기관지 모습이 선명하게 보이지 않아 주요 특징들이 제대로 학습되었다고 보기 어렵다. 반면, 본원의 멀티 스케일 조건부 적대적 생성 신경망의 결과는 실제 영상과 구별되지 않을 정도의 영상특징과 해상도를 보였으며, 각 질환별 특징도 실제 영상과 큰 차이가 없을 정 도로 잘 학습하였다. 한 예로 심장 비대의 경우 다른 질환과 비교하였을 때 심장의 모습이 확연히 커진 것을 볼 수 있는데, 이는 '심장 크기 증가'라는 해당 질환의 특징을 잘 학습한 결과이다. 도 6은 본 발명의 일 실시예에 따른 흉부 X선 영상 생성 방법을 나타낸 흐름도이다. 도 6에 도시된 일 실시예에 따른 흉부 X선 영상 생성 방법은 도 1에 도시된 흉부 X선 영상 생성 장치에서 시계열적으로 처리되는 단계들 을 포함한다. 따라서, 이하 생략된 내용이라고 하더라도 도 6에 도시된 일 실시예에 따라 수행되는 흉부 X선 영상 생성 방법에도 적용된다. 도 6을 참조하면, 단계 S600에서 생성자 및 판별자를 포함하는 멀티 스케일 조건부 적대적 생성 신경망을 생성 할 수 있다. 여기서, 생성자는 잠재변수 및 특정 질환의 특징에 대한 조건변수를 입력받고 각 분기마다 업샘플 링(up-sampling)하여 각각 해상도가 다른 특정 질환을 나타내는 복수의 흉부 X선 영상을 생성할 수 있다. 또한, 판별자는 복수의 흉부 X선 영상의 진위 여부를 구별할 수 있다. 단계 S610에서 멀티 스케일 조건부 적대적 생성 신경망을 통해 흉부 X선 영상을 생성할 수 있다. 예를 들어, 멀 티 스케일 조건부 적대적 생성 신경망에 잠재변수 및 특정 질환의 특징에 대한 조건변수를 입력하여 기설정된 값 이상의 해상도를 갖고 특정 질환을 나타내는 흉부 X선 영상을 생성할 수 있다. 도 6을 통해 설명된 흉부 X선 영상 생성 방법은 매체에 저장된 컴퓨터 프로그램의 형태로 구현되거나, 컴퓨터에 의해 실행되는 프로그램 모듈과 같은 컴퓨터에 의해 실행 가능한 명령어를 포함하는 기록 매체의 형태로도 구현 될 수 있다. 컴퓨터 판독 가능 매체는 컴퓨터에 의해 액세스될 수 있는 임의의 가용 매체일 수 있고, 휘발성 및 비휘발성 매체, 분리형 및 비분리형 매체를 모두 포함한다. 또한, 컴퓨터 판독가능 매체는 컴퓨터 저장 매 체를 포함할 수 있다. 컴퓨터 저장 매체는 컴퓨터 판독가능 명령어, 데이터 구조, 프로그램 모듈 또는 기타 데 이터와 같은 정보의 저장을 위한 임의의 방법 또는 기술로 구현된 휘발성 및 비휘발성, 분리형 및 비분리형 매 체를 모두 포함한다."}
{"patent_id": "10-2021-0056446", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "전술한 본 발명의 설명은 예시를 위한 것이며, 본 발명이 속하는 기술분야의 통상의 지식을 가진 자는 본 발명 의 기술적 사상이나 필수적인 특징을 변경하지 않고서 다른 구체적인 형태로 쉽게 변형이 가능하다는 것을 이해 할 수 있을 것이다. 그러므로 이상에서 기술한 실시예들은 모든 면에서 예시적인 것이며 한정적이 아닌 것으로 이해해야만 한다. 예를 들어, 단일형으로 설명되어 있는 각 구성 요소는 분산되어 실시될 수도 있으며, 마찬가 지로 분산된 것으로 설명되어 있는 구성 요소들도 결합된 형태로 실시될 수 있다. 본 발명의 범위는 상기 상세한 설명보다는 후술하는 특허청구범위에 의하여 나타내어지며, 특허청구범위의 의미 및 범위 그리고 그 균등 개념으로부터 도출되는 모든 변경 또는 변형된 형태가 본 발명의 범위에 포함되는 것으 로 해석되어야 한다."}
{"patent_id": "10-2021-0056446", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 일 실시예에 따른 흉부 X선 영상 생성 장치를 도시한 도면이다. 도 2는 본 발명의 일 실시예에 따른 멀티 스케일 조건부 적대적 생성 신경망의 네트워크 구조를 도시한 도면이 다.도 3은 본 발명의 일 실시예에 따른 생성자 및 판별자의 손실 그래프를 도시한 도면이다. 도 4는 본 발명의 실험예와 비교예의 성능 비교 결과로서 프레쳇 덴스넷 거리를 나타낸 도면이다. 도 5는 본 발명의 실험예와 비교예의 성능 비교 결과로서 생성된 흉부 X선 영상을 도시한 도면이다. 도 6은 본 발명의 일 실시예에 따른 흉부 X선 영상 생성 방법을 나타낸 흐름도이다."}
