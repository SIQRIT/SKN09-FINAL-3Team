{"patent_id": "10-2022-0094155", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2024-0016085", "출원번호": "10-2022-0094155", "발명의 명칭": "AI 기반 악성코드 탐지, 분석 및 검증 방법", "출원인": "주식회사 에프원시큐리티", "발명자": "신경아"}}
{"patent_id": "10-2022-0094155", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "AI 기반의 악성코드 탐지, 분석 및 검증 방법은 데이터를 수집하는 S100 단계와, 데이터 정제 및 추출하는 S200 단계와, 피처 엔니어링 및 벡터화하는 S300 단계와, 데이터를 분석하는 S400 단계를 포함하고, S100 단계는 실행파일 및 문서파일을 수집하고,S200 단계는 수집된 데이터 들 중 PE 정보, byte 정보, 동적 분석 데이터, API Sequence, 및 문서파일의 데이터를 추출하고, 이중 기존 빅데이터에서 정상과 악성 판정이 서로 엇갈리는 데이터를 제거하고, 악성이라고 판정한 확율이 높은 데이터에 가중치를 부여하여 데이터를 정제하고, S300 단계는 API Sequence, 동적 분석 데이터 벡터와, 텍스트 데이터 가공, Feature Selection 및 멀티 라벨링을 수행하여 피처 엔지니어링 및 벡터화하고, S400 단계는 단일 모델, 복합 모델, 언어모델 및 강화 학습 모델 중 적어도 하나를 생성하고, 데이터와 시각화분석, 이상치 분석, 고도화 분석을 진행하여 분석 결과와, 오탐을 일으킨 피처의 수치값 변화에 따라 모델값의기여도의 변화량을 확인하는 것; 을 특징으로 하는 AI 기반의 악성코드 탐지, 분석 및 검증 방법."}
{"patent_id": "10-2022-0094155", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 AI 기반의 악성코드 탐지, 분석 및 검증 방법으로서, 데이터를 수집하는 S100 단계와, 데이터 정제 및 추출하는 S200 단계와, 피처 엔니어링 및 벡터화하는 S300 단계와, 데이터를 분석하는 S400 단계를 포함하며, 인 공지능을 통한 자동화 방법으로서 다양한 유형의 악성코드 및 신규 악성코드를 자동으로 분석 및 탐지가 빠른 시 간 이내에 이루어질 수 있다. 또한, 본 발명은 서울특별시 서울산업진흥원 2021년도 인공지능(AI) 기술사업화 지원사업(CY210066) “AI 기반 악성코드 탐지, 분석 및 검증 프레임워크”를 통해 개발되었다."}
{"patent_id": "10-2022-0094155", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 AI 기반 악성코드 탐지, 분석 및 검증 방법에 관한 것이다."}
{"patent_id": "10-2022-0094155", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "악성코드는 기하급수적인 증가 및 다형성에 의한 자동 변형 생성 등으로 기존의 분석가의 수작업에 의한 대응은 한계를 보인다. 특히 2019년 COVID-19 발생 이후로 전 세계적으로 피싱 공격, 악성코드, 개인정보 탈취를 포함 한 사이버 공격이 급격히 상승하는 추세하며 관련된 피해 사례가 속출하고 있다. 관련 어플이나 정보 공유 문서 로 위장하는 등 COVID-19를 미끼로 공격을 감행하거나, 원격 근무나 원격 수업 등 온라인 환경이 많은 이용자에 게 확대되면서 이와 같은 위협에 대한 관리는 더욱 중요해졌다. 이에 많은 나라에서 정부의 적극적인 정책을 앞세워 많은 기업에서 정보보호 시장으로의 투자를 확대하고 있는 추세이다. 그러나 개인과 기업을 포함한 많은 인터넷 사용자들은 이러한 사이버 공격에 대한 위협은 인식하고 있으나 실질적으로 보안 의식과 관련 지식이 약하기 때문에 많은 피해를 입고 있는 실정이다. 그러나, 랜섬웨어, 웜, 바이러스 등과 같은 악성코드는 다양한 감염경로, 빠르고 쉬운 확산이라는 특징 때문에 한정된 인력과 자원으로 모든 피해를 막을 수 없는데다가, 악성코드의 패킹과 암호화는 시그니처 방식의 탐지를 우회하며 제로데이 취약점을 이용한 악성코드는 탐지가 어려워 일일이 관련 분석이나 탐지 및 차단 방법을 확립 하는 것이 불가능하다. 또한 세계적으로 인공지능을 활용하여 다양한 문서 형식의 악성 코드 감염에 대한 연구가 활발히 진행 중이지만 대부분이 탐지에 집중된 방식으로 악성코드에 특화된 학습 데이터를 통한 분석 방법의 제공은 부족한 양상이다. 특히, 관심도가 낮은 파일 형식의 경우에는 다양한 진화를 거듭하는 악성코드를 정확하게 탐지하기에는 한계가 있다. 선행기술문헌 특허문헌(특허문헌 0001) KR 10-2022-0032730 A1(2022.03.15 공개)"}
{"patent_id": "10-2022-0094155", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "그러므로 본 발명은 상기와 같은 종래 기술의 문제점을 해결하기 위하여 안출된 것으로, 본 발명의 목적은 데이 터 마이닝 및 머신러닝의 알고리즘을 공격자 식별에 적용하여 악성코드의 특성에 자동적으로 대응이 가능한 AI 기반 악성코드 탐지, 분석 및 검증 방법을 제공함에 있다. 또한, 본 발명의 다른 목적은 인공지능을 통하여 다양한 유형의 악성코드를 감지할 수 있 는 AI 기반 악성코드 탐지, 분석 및 검증 방법을 제공함에 있다."}
{"patent_id": "10-2022-0094155", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명은 상기와 같은 목적을 달성하기 위하여 하기와 같은 실시예를 포함할 수 있다. 본 발명의 실시예는 AI 기반의 악성코드 탐지, 분석 및 검증 방법에 관한 것으로서, 데이터를 수집하는 S100 단 계와, 데이터 정제 및 추출하는 S200 단계와, 피처 엔니어링 및 벡터화하는 S300 단계와, 데이터를 분석하는 S400 단계를 포함하고, S100 단계는 실행파일 및 문서파일을 수집하고, S200 단계는 수집된 데이터 들 중 PE 정 보, byte 정보, 동적 분석 데이터, API Sequence, 및 문서파일의 데이터를 추출하고, 이중 기존 빅데이터에서 정상과 악성 판정이 서로 엇갈리는 데이터를 제거하고, 악성이라고 판정한 확율이 높은 데이터에 가중치를 부여 하여 데이터를 정제하고, S300 단계는 API Sequence, 동적 분석 데이터 벡터와, 텍스트 데이터 가공, Feature Selection 및 멀티 라벨링을 수행하여 피처 엔지니어링 및 벡터화하고, S400 단계는 단일 모델, 복합 모델, 언 어모델 및 강화 학습 모델 중 적어도 하나를 생성하고, 데이터와 시각화 분석, 이상치 분석, 고도화 분석을 진 행하여 분석 결과와, 오탐을 일으킨 피처의 수치값 변화에 따라 모델값의 기여도의 변화량을 확인하는 것을 특 징으로 하는 AI 기반의 악성코드 탐지, 분석 및 검증 방법을 포함할 수 있다."}
{"patent_id": "10-2022-0094155", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "따라서 본 발명은 악성코드의 특성에 자동적으로 대응이 가능함에 따라 사이버 보안 시스템을 강화 시킬 수 있 어 산업에 대한 공격에 의한 피해를 최소화할 수 있고, 사이버 침해 사고에 대한 징후 예측이 가능할 수 있어 사이버 공격에 대한 정책적 대응 방안을 마련할 수 있는 효과가 있다. 또한, 본 발명은 인공지능을 통한 자동화 방법으로서 다양한 유형의 악성코드 및 신규 악성코드를 자동으로 분 석 및 탐지가 빠른 시간 이내에 이루어질 수 있다."}
{"patent_id": "10-2022-0094155", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "본 발명은 서울특별시 서울산업진흥원 2021년도 인공지능(AI) 기술사업화 지원사업(CY210066) “AI 기반 악성코 드 탐지, 분석 및 검증 프레임워크”를 통해 개발되었다. 본 발명은 다양한 변경을 가할 수 있고 여러 가지 실시예를 가질 수 있지만, 특정 실시예를 도면에 예시하여 상 세하게 설명하고자 한다. 이는 본 발명을 특정한 실시 형태에 대해 한정하려는 것이 아니며, 서로 다른 방향으 로 연장되는 구조물을 연결 및/또는 고정시키기 위한 본 발명의 사상 및 기술 범위에 포함되는 모든 변경, 균등 물 내지 대체물중 어느 하나에 해당되는 것으로 이해되어야 한다. 본 명세서에서 사용한 용어는 단지 특정한 실시예를 설명하기 위해 사용된 것으로, 본 발명을 한정하려는 의도 가 아닌, 단수의 표현은 문맥상 명백하게 다르게 뜻하지 않는 한, 복수의 표현을 포함한다. 또한, 본 발명을 설명함에 있어 관련된 공지 기술에 대한 구체적인 설명이 본 발명의 요지를 불필요하게 흐릴 수 있다고 판단되는 경우 그 상세한 설명을 생략한다. 이하에서는 본 발명에 따른 AI 기반 악성코드 탐지, 분석 및 검증 방법의 바람직한 실시예를 첨부한 도면을 참 조하여 설명한다. 도 1은 본 발명의 개요를 설명하기 위한 도면, 도 2는 본 발명의 순서도이다. 도 1 및 도 2를 참조하면, 본 발명은 데이터를 수집하는 S100 단계와, 데이터 정제 및 추출하는 S200 단계와, 피처 엔니어링 및 벡터화하는 S300 단계와, 데이터를 분석하는 S400 단계를 포함한다. S100 단계는 데이터 수집부가 데이터를 수집하는 단계이다. 여기서 데이터 수집부는 실행파일(예를 들면, *.exe)과, 문서파일(예를 들면, *.pdf, *.hwp, MS offfice, *.xml, *.doc, *.txt)을 수집한다. S200 단계는 데이터 정제 및 추출부에서 수집된 데이터를 정제 및 추출하는 단계이다. 여기서 데이터 정제 및 추출부는 학습 데이터 샘플링을 수행한다. 이는 기존 빅데이터(예를 들면, Virustotal을 통한 백신사의 분석결 과)를 토대로 악성 여부를 판정하고, 정제한 악성 코드를 이용하여 학습 데이터를 샘플링한다. 데이터 정제 및 추출부는 기존 빅데이터를 통해 정상과 악성 판정이 서로 엇갈리는 데이터를 제거하고, 다수 백 신사가 악성이라고 판정한 데이터에 가중치를 부여하여 학습 데이터를 정제한다. 또한, 데이터 정제 및 추출부는 PE 메타 정보, PE 영역으로부터 수집한 정적 분석 데이터를 추출하고, python 라이브러리를 이용하여 PE 헤더 및 바디의 정보를 추출 및 가공하여 피처 정규화를 진행한다. 그리고 데이터 정제 및 추출부는 PE 파일의 byte 정보를 추출하고, 파일 전체 바이트를 이미지화 하고 리사이징 한다. 그리고 데이터 정제 및 추출부는 Cuckoo Sandbox를 이용하여 파일을 실행하고 얻은 동적 분석 데이터 추출하고, Cuckoo Sandbox에서 파일을 실행하고 얻은 API call Sequence 데이터와, SFEM 기반으로 피처와 매크로 데이터 (VBA) 추출 하여 MS Office 데이터를 추출한다. 또한, 데이터 정제 및 추출부는 PDF 데이터, hwp 데이터를 추출할 수있다. 이때, 데이터 정제 및 추출부는 Poppler 등을 이용하여 자바스크립트, 파일 인코딩 및 자바스크립트 삽입 정보 를 추출하여 자바 스크립트 내 특정 단어 빈도수를 추출하고, 키워드 정보, 삽입된 스트립트 내 텍스트 정보와, stream 타입의 오브젝트의 raw data 추출하여 1000바이트까지 사용하도록 가공하여 PDF 문서 파일에 포함된 stream 데이터를 추출한다. 또한, 데이터 정제 및 추출부는 hwp 데이터를 추출한다. 예를 들면, 데이터 정제 및 추출부는 파일 사이즈, 섹 션 수, 스트림 수, eps, ps, ole, bmp 등이 포함된 스트림 파일 수 등의 문서 구조 정보와, xor, exec, createobject 등의 스크립트 코드 내 특정 함수, 특정 문자열, 쉘코드 삽입 정보와, 스트림 데이터(EPS/PS, VBA macro)를 추출 및 디코딩 하여 악성 hwp 파일에서 피처 데이터를 추출한다. S300 단계는 악성코드 탐지부가 피처 엔지니어링 및 벡터화 과정을 진행하는 단계이다. 여기서 악성코드 탐지부 는LabelEncoder, Cosine Similarity 등 API2Vec, Inst2Vec 형태로 가공하고, N-gram 등으로 가공하여 피처 가 중치를 적용하고 벡터 생성하고, BRD 알고리즘을 사용하여 계산 속도를 줄이고 최적의 학습 벡터 생성 API Sequence 가공한다. 또한, 악성코드 탐지부는 추출한 동적 분석 데이터 중 문자열의 피처 엔지니어링 및 벡터화하고, VBA 등 문서에 서 추출한 텍스트 데이터를 학습 할 수 있도록 n-gram, 히스토그램, 엔트로피 등의 벡터 형태로서 가공하고, Feature Selection(Feature Selection을 위한 Wrapper, Embed, Filtering 적용), PCA 주성분 분석을 통한 주요 피처 선정을 진행한다. 또한, 악성코드 탐지부는 동종 악성 코드르 그룹핑하여 피처 선별하고, 이를 종합하여 멀티 분류 피처로 통합하 는 멀티 라베링을 수행할 수 있다. 또한, 악성코드 탐지부는 모델 생성 과정을 진행한다. 모델은 단일 모델과,복합모델, 언어모델, 강화학습 모델 중 적어도 하나 이다. 이중 단일 모델은 Boosting, Random Forest, CNN, RNN, LSTM 등 피처 특성에 맞춘 머신 러닝 알고리즘 모델로 구현될 수 있다. 또한 복합 모델은 Multi Modal, Ensemble 기법에 의한 정적, 동적 피처 통합 모델 구현된다. 언어모델은 시퀀스 데이터의 시계열적 특성을 이용하는 BERT 언어모델에 해당된다. 강화학습 모델은 강화 학습을 이용한 악성코드, 클러스터링으로 멀티 라벨링이 가능한 것을 특징으로 한다. S400 단계는 검증부가 데이터를 분석하는 단계이다. 여기서 검증부는 데이터 분석과, 시각화 분석, 이상치 분석, XAI 및 강화 학습을 분석하여 정확도를 개선한다. 예를 들면, 데이터 분석은 정상 파일과 악성 파일의 데 이터 분포를 통계적 관점에서 분석하고, 악성 파일의 유형별 데이터 분포를 통계적 관점에서 분석할 수 있다. 또한, 데이터 분석은 분포 분석에 의한 신규, 변종 데이터 식별과, 다차원 분석 고도화, 학습데이터셋, 단일 파 일, 복수 파일을 비교하는 데이터를 분석하고, 단일 피처와 복수 피처의 비교 분석한다. 또한, 데이터 분석은 binary class(악성 여부 탐지), multi class(악성 유형 분류)에 따른 피처의 다차원 분석 을 포함한다. 시각화 분석은 Boxplot, 히스토그램, 파이 그래프 등으로 데이터 분석을 시각화한다. 이상치 분석은 개별 파일에서 이상치 구간에 위치한 피처를 식별하여 오탐의 원인이 되는 피처 식별 및 정탐 분 석하고, 피처별 이상치 분포를 class 기준으로 비교하여 class 식별에 우수한 피처 식별한다. 또한, 검증부는 오탐 분석을 위한 XAI 고도화를 진행할 수 있다. 이는 개별 파일에서 어떤 피처에 의해 오탐과 정탐이 발생하였는지와, 피처 중요도를 통한 모델 분석을 통해 이루어진다. 즉, 본 발명은 AI 기반의 악성코드 탐지, 분석 및 검증이 모두 가능하며, 상술한 바와 같이 모든 유형의 파일에 서 악성코드의 탐지 내지 검증이 가능하기에 빠른 시간 내에 자동화 분석 및 탐지가 가능하고, 신규 악성코드 분석 시간 및 건수가 빠른 시간 이내에 이루어 질 수 있다."}
{"patent_id": "10-2022-0094155", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 개요를 설명하기 위한 도면이다. 도 2는 본 발명의 순서도이다."}
