{"patent_id": "10-2021-0134587", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2023-0051792", "출원번호": "10-2021-0134587", "발명의 명칭": "인공지능 기반 영상 개선 방법 및 장치", "출원인": "한국전자기술연구원", "발명자": "정진우"}}
{"patent_id": "10-2021-0134587", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "입력 영상으로부터 제1 개선 방식으로 개선된 제1 개선 영상을 생성하는 제1 영상 개선부;입력 영상으로부터 제2 개선 방식으로 개선된 제2 개선 영상을 생성하는 제2 영상 개선부;입력 영상으로부터 가중치를 생성하기 위한 공통 특징을 추출하는 가중치 코어부;가중치 코어부에서 추출한 공통 특징으로부터 가중치들을 계산하는 가중치 계산부;가중치 계산부에서 계산된 가중치들을 제1 개선 영상과 제2 개선 영상에 각각 적용하는 가중치 연산부;가중치들이 각각 적용된 제1 개선 영상들과 제2 개선 영상들로부터 하나의 개선 영상을 생성하는 정제부;를 포함하는 것을 특징으로 하는 영상 개선 장치."}
{"patent_id": "10-2021-0134587", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "청구항 1에 있어서,제1 영상 개선부는,입력 영상을 화이트 밸런스 처리한 후 네트워크들에 통과시켜 개선된 영상을 생성하고,제2 영상 개선부는,입력 영상을 노이즈 제거 처리한 후 네트워크들에 통과시켜 개선된 영상을 생성하는 것을 특징으로 하는 영상개선 장치."}
{"patent_id": "10-2021-0134587", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "청구항 1에 있어서,가중치 코어부는,입력 영상으로부터 추출한 특징, 제1 영상 개선부가 제1 개선 영상을 생성하는 과정에서 추출하는 입력 영상의특징 및 제2 영상 개선부가 제2 개선 영상을 생성하는 과정에서 추출하는 입력 영상의 특징으로부터 공통 특징을 추출하는 것을 특징으로 하는 영상 개선 장치."}
{"patent_id": "10-2021-0134587", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "청구항 1에 있어서,가중치 계산부는,공통 특징으로부터, 입력 영상에 대한 전역적 컨트라스트 가중치(WL), 지역적 컨트라스트 가중치(WLC), 공통 특징과 동일한 가중치(WI), 노출도를 나타내는 가중치(WE)를 계산하는 것을 특징으로 하는 영상 개선 장치."}
{"patent_id": "10-2021-0134587", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "청구항 4에 있어서,공개특허 10-2023-0051792-3-가중치 계산부는,2n 채널의 가중치(WL)를 n 채널의 [WL1,WL2]로 나누고,2n 채널의 가중치(WLC)를 n 채널의 [WLC1,WLC2]로 나누고,2n 채널의 가중치(WI)를 n 채널의 [WI1,WI2]로 나누고,2n 채널의 가중치(WE)를 n 채널의 [WE1,WE2]로 나누는 것을 특징으로 하는 영상 개선 장치."}
{"patent_id": "10-2021-0134587", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "청구항 5에 있어서,가중치 연산부는,제1 개선 영상에 대해, WL1, WLC1, WI1, WE1와의 요소별 곱셈을 각각 연산하고,제2 개선 영상에 대해, WL2, WLC2, WI2, WE2와의 요소별 곱셈을 각각 연산하는 것을 특징으로 하는 영상 개선장치."}
{"patent_id": "10-2021-0134587", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "청구항 6에 있어서,정제부는,가중치 연산부에서의 연산 결과들을 모두 연결(concatenation)한 후 네트워크에 통과시켜 하나의 개선 영상을생성하는 것을 특징으로 하는 영상 개선 장치."}
{"patent_id": "10-2021-0134587", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "청구항 1에 있어서,영상 개선 장치는,제1 영상 개선부, 제2 영상 개선부, 가중치 코어부에 입력 영상을 입력하는 경우에 정제부에서 출력되는 개선영상과 원본(Ground Truth) 간의 손실이 줄어드는 방향으로 학습되는 것을 특징으로 하는 영상 개선 장치."}
{"patent_id": "10-2021-0134587", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "청구항 1에 있어서,입력 영상은,수중 환경에서 획득된 영상인 것을 특징으로 하는 영상 개선 장치."}
{"patent_id": "10-2021-0134587", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "입력 영상으로부터 제1 개선 방식으로 개선된 제1 개선 영상을 생성하는 단계;입력 영상으로부터 제2 개선 방식으로 개선된 제2 개선 영상을 생성하는 단계;입력 영상으로부터 가중치를 생성하기 위한 공통 특징을 추출하는 단계;공개특허 10-2023-0051792-4-추출한 공통 특징으로부터 가중치들을 계산하는 단계;계산된 가중치들을 제1 개선 영상과 제2 개선 영상에 각각 적용하는 단계;가중치들이 각각 적용된 제1 개선 영상들과 제2 개선 영상들로부터 하나의 개선 영상을 생성하는 단계;를 포함하는 것을 특징으로 하는 영상 개선 방법."}
{"patent_id": "10-2021-0134587", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "영상을 생성하는 영상 생성 장치;영상 생성장치에서 생성된 영상으로부터 개선 영상을 생성하는 영상 개선 장치;영상 개선 장치에서 생성된 개선 영상을 출력하는 영상 출력 장치;를 포함하고,영상 개선 장치는,영상 생성 장치에서 생성된 영상으로부터 제1 개선 방식으로 개선된 제1 개선 영상을 생성하는 제1 영상개선부;영상 생성 장치에서 생성된 영상으로부터 제2 개선 방식으로 개선된 제2 개선 영상을 생성하는 제2 영상개선부;영상 생성 장치에서 생성된 영상으로부터 가중치를 생성하기 위한 공통 특징을 추출하는 가중치 코어부;가중치 코어부에서 추출한 공통 특징으로부터 가중치들을 계산하는 가중치 계산부;가중치 계산부에서 계산된 가중치들을 제1 개선 영상과 제2 개선 영상에 각각 적용하는 가중치 연산부;가중치들이 각각 적용된 제1 개선 영상들과 제2 개선 영상들로부터 하나의 개선 영상을 생성하는 정제부;를 포함하는 것을 특징으로 하는 영상 시스템."}
{"patent_id": "10-2021-0134587", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "영상을 생성하는 단계;생성된 영상으로부터 개선 영상을 생성하는 단계;생성된 개선 영상을 출력하는 단계;를 포함하고,개선 영상 생성 단계는,생성된 영상으로부터 제1 개선 방식으로 개선된 제1 개선 영상을 생성하는 단계;생성된 영상으로부터 제2 개선 방식으로 개선된 제2 개선 영상을 생성하는 단계;생성된 영상으로부터 가중치를 생성하기 위한 공통 특징을 추출하는 단계;추출한 공통 특징으로부터 가중치들을 계산하는 단계;계산된 가중치들을 제1 개선 영상과 제2 개선 영상에 각각 적용하는 단계;가중치들이 각각 적용된 제1 개선 영상들과 제2 개선 영상들로부터 하나의 개선 영상을 생성하는 단계;를 포함하는 것을 특징으로 하는 영상 개선 방법."}
{"patent_id": "10-2021-0134587", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "인공지능 기반 영상 개선 방법 및 장치가 제공된다. 본 발명의 실시예에 따른 영상 개선 장치는, 입력 영상으로 부터 제1 개선 방식으로 개선된 제1 개선 영상을 생성하는 제1 영상 개선부, 입력 영상으로부터 제2 개선 방식으 로 개선된 제2 개선 영상을 생성하는 제2 영상 개선부, 입력 영상으로부터 가중치를 생성하기 위한 공통 특징을 추출하는 가중치 코어부, 가중치 코어부에서 추출한 공통 특징으로부터 가중치들을 계산하는 가중치 계산부, 가 중치 계산부에서 계산된 가중치들을 제1 개선 영상과 제2 개선 영상에 각각 적용하는 가중치 연산부, 가중치들이 각각 적용된 제1 개선 영상들과 제2 개선 영상들로부터 하나의 개선 영상을 생성하는 정제부를 포함한다. 이에 의해, 딥러닝 모델을 활용하여, 종래 수중 촬영 영상 개선 기술에 비해 더욱 정확한 컬러 정확도와 높은 선명도 를 갖는 개선 영상을 생성할 수 있게 된다."}
{"patent_id": "10-2021-0134587", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 인공지능을 활용한 영상처리 기술에 관한 것으로, 더욱 상세하게는 수중 촬영 영상의 화질을 개선하 는 방법 및 장치에 관한 것이다."}
{"patent_id": "10-2021-0134587", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "1) 수중 촬영 영상 도 1은 수중에서 광학 영상 시스템을 보여주는데, 수심에 따라 흡수되는 빛의 파장이 달라짐을 알 수 있다. 이 런 빛의 흡수 뿐만 아니라 수중에서는 탁한 물과 산란과 같은 환경으로 인해 촬영된 영상에 흐려짐 및 어두움, 저대비, 컬러 사라짐과 같은 열화가 발생한다. 따라서 수중 촬영 영상을 개선하기 위한 다양한 연구들이 진행되 어 왔다. 2) 종래 수중 촬영 영상 개선 기술 종래의 수중 촬영 영상 개선 기술은 크게 영상 복원과 영상 개선 기법 두 가지로 나눌 수 있다. 영상 복원 기법 은 수중 환경을 모델링하여 훼손된 영상 모델을 만들고 이를 다시 복원하는 방식이다. 예를 들어 수식 과 같 이 수중 촬영 영상 I(x)은 사물에 반사된 빛을 직접 받거나, 탁수의 매질 또는 물속 작은 입자 등에 의해서 산 란된 빛을 받게 되며, 이를 수식으로 나타내면 다음과 같다. 수식에서 J(x)t(x)는 직접 광원(사물에 반사된 빛)이 B(1-t(x))는 수광조명(산란된 빛)에 해당한다. t(x)는 투과율(transmission map)을 의미하며 객체와의 거 리가 가까울수록 높은 투과율을 갖는다. I(x) = J(x)t(x)+B(1-t(x)) 관찰된 I(x)에서 원신호 J(x)를 복원하므로 영상 복원 기술이라 한다. 이 방법은 모델을 몇 가지 통하여 예측하 는데 예측이 틀릴 경우 복원 성능이 크게 저하되는 단점이 있다. 또한 다양한 바다의 환경을 단일 모델로 예측 하기는 어렵다는 단점이 있다. 영상 개선 방법은 바다 환경 모델을 설정하지 않고 종래의 영상 개선 방법을 통해 수중 촬영 영상을 개선하도록 한다. 이를 위한 방법으로는 Gray World 방법, 히스토그램 평활화 방법(Histogram equlization), 지역적 컨트 라스트 개선 방법(Local Contrast Enhacement) 방법 등이 있다. 그리고 이런 방법들에 기반하여 수중 영상에 최 적화된 방법들이 제안되었다. 3) 종래 기술 한계 영상 복원 기술에 의한 개선 방법은 모델을 몇 가지 통하여 예측하는데 예측이 틀릴 경우 복원 성능이 크게 저 하되는 단점이 있다. 또한 다양한 바다의 환경을 단일 모델로 예측하기는 어렵다는 단점이 있다. 또한 영상 기술 개선 기법들은 선명도나 어두움등은 개선하였으나 컬러의 틀어짐은 완전히 해결하지 못하였다."}
{"patent_id": "10-2021-0134587", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은 상기와 같은 문제점을 해결하기 위하여 안출된 것으로서, 본 발명의 목적은, 딥러닝 모델을 이용하여 수중 영상 촬영의 화질을 개선하는 방법을 제공함에 있다."}
{"patent_id": "10-2021-0134587", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "상기 목적을 달성하기 위한 본 발명의 일 실시예에 따른, 영상 개선 장치는, 입력 영상으로부터 제1 개선 방식 으로 개선된 제1 개선 영상을 생성하는 제1 영상 개선부; 입력 영상으로부터 제2 개선 방식으로 개선된 제2 개 선 영상을 생성하는 제2 영상 개선부; 입력 영상으로부터 가중치를 생성하기 위한 공통 특징을 추출하는 가중치 코어부; 가중치 코어부에서 추출한 공통 특징으로부터 가중치들을 계산하는 가중치 계산부; 가중치 계산부에서계산된 가중치들을 제1 개선 영상과 제2 개선 영상에 각각 적용하는 가중치 연산부; 가중치들이 각각 적용된 제 1 개선 영상들과 제2 개선 영상들로부터 하나의 개선 영상을 생성하는 정제부;를 포함한다. 제1 영상 개선부는, 입력 영상을 화이트 밸런스 처리한 후 네트워크들에 통과시켜 개선된 영상을 생성하고, 제2 영상 개선부는, 입력 영상을 노이즈 제거 처리한 후 네트워크들에 통과시켜 개선된 영상을 생성할 수 있다. 가중치 코어부는, 입력 영상으로부터 추출한 특징, 제1 영상 개선부가 제1 개선 영상을 생성하는 과정에서 추출 하는 입력 영상의 특징 및 제2 영상 개선부가 제2 개선 영상을 생성하는 과정에서 추출하는 입력 영상의 특징으 로부터 공통 특징을 추출할 수 있다. 가중치 계산부는, 공통 특징으로부터, 입력 영상에 대한 전역적 컨트라스트 가중치(WL), 지역적 컨트라스트 가중 치(WLC), 공통 특징과 동일한 가중치(WI), 노출도를 나타내는 가중치(WE)를 계산할 수 있다. 가중치 계산부는, 2n 채널의 가중치(WL)를 n 채널의 [WL1,WL2]로 나누고, 2n 채널의 가중치(WLC)를 n 채널의 [WLC1,WLC2]로 나누고, 2n 채널의 가중치(WI)를 n 채널의 [WI1,WI2]로 나누고, 2n 채널의 가중치(WE)를 n 채널의 [WE1,WE2]로 나눌 수 있다. 가중치 연산부는, 제1 개선 영상에 대해, WL1, WLC1, WI1, WE1와의 요소별 곱셈을 각각 연산하고, 제2 개선 영상에 대해, WL2, WLC2, WI2, WE2와의 요소별 곱셈을 각각 연산할 수 있다. 정제부는, 가중치 연산부에서의 연산 결과들을 모두 연결(concatenation)한 후 네트워크에 통과시켜 하나의 개 선 영상을 생성할 수 있다. 영상 개선 장치는, 제1 영상 개선부, 제2 영상 개선부, 가중치 코어부에 입력 영상을 입력하는 경우에 정제부에 서 출력되는 개선 영상과 원본(Ground Truth) 간의 손실이 줄어드는 방향으로 학습될 수 있다. 입력 영상은, 수중 환경에서 획득된 영상일 수 있다. 한편, 본 발명의 다른 실시예에 따른, 영상 개선 방법은, 입력 영상으로부터 제1 개선 방식으로 개선된 제1 개 선 영상을 생성하는 단계; 입력 영상으로부터 제2 개선 방식으로 개선된 제2 개선 영상을 생성하는 단계; 입력 영상으로부터 가중치를 생성하기 위한 공통 특징을 추출하는 단계; 추출한 공통 특징으로부터 가중치들을 계산 하는 단계; 계산된 가중치들을 제1 개선 영상과 제2 개선 영상에 각각 적용하는 단계; 가중치들이 각각 적용된 제1 개선 영상들과 제2 개선 영상들로부터 하나의 개선 영상을 생성하는 단계;를 포함한다. 한편, 본 발명의 다른 실시예에 따른, 영상 시스템은, 영상을 생성하는 영상 생성 장치; 영상 생성장치에서 생 성된 영상으로부터 개선 영상을 생성하는 영상 개선 장치; 영상 개선 장치에서 생성된 개선 영상을 출력하는 영 상 출력 장치;를 포함하고, 영상 개선 장치는, 영상 생성 장치에서 생성된 영상으로부터 제1 개선 방식으로 개 선된 제1 개선 영상을 생성하는 제1 영상 개선부; 영상 생성 장치에서 생성된 영상으로부터 제2 개선 방식으로 개선된 제2 개선 영상을 생성하는 제2 영상 개선부; 영상 생성 장치에서 생성된 영상으로부터 가중치를 생성하 기 위한 공통 특징을 추출하는 가중치 코어부; 가중치 코어부에서 추출한 공통 특징으로부터 가중치들을 계산하 는 가중치 계산부; 가중치 계산부에서 계산된 가중치들을 제1 개선 영상과 제2 개선 영상에 각각 적용하는 가중 치 연산부; 가중치들이 각각 적용된 제1 개선 영상들과 제2 개선 영상들로부터 하나의 개선 영상을 생성하는 정 제부;를 포함한다. 한편, 본 발명의 다른 실시예에 따른, 영상 개선 방법은, 영상을 생성하는 단계; 생성된 영상으로부터 개선 영 상을 생성하는 단계; 생성된 개선 영상을 출력하는 단계;를 포함하고, 개선 영상 생성 단계는, 생성된 영상으로 부터 제1 개선 방식으로 개선된 제1 개선 영상을 생성하는 단계; 생성된 영상으로부터 제2 개선 방식으로 개선 된 제2 개선 영상을 생성하는 단계; 생성된 영상으로부터 가중치를 생성하기 위한 공통 특징을 추출하는 단계; 추출한 공통 특징으로부터 가중치들을 계산하는 단계; 계산된 가중치들을 제1 개선 영상과 제2 개선 영상에 각 각 적용하는 단계; 가중치들이 각각 적용된 제1 개선 영상들과 제2 개선 영상들로부터 하나의 개선 영상을 생성 하는 단계;를 포함한다."}
{"patent_id": "10-2021-0134587", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "이상 설명한 바와 같이, 본 발명의 실시예들에 따르면, 딥러닝 모델을 활용하여, 종래 수중 촬영 영상 개선 기 술에 비해 더욱 정확한 컬러 정확도와 높은 선명도를 갖는 개선 영상을 생성할 수 있게 된다."}
{"patent_id": "10-2021-0134587", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하에서는 도면을 참조하여 본 발명을 보다 상세하게 설명한다. 본 발명의 실사예에서는 인공지능 기반의 영상 개선 방법 및 장치을 제시한다. 수중 영상은 빛의 특질 및 바다 환경의 특이성으로 인해 촬영 영상의 화질이 매우 열화되어 있는데, 본 발명의 실시예에서는 종래의 영상 복원 이나 영상 개선 기법이 아닌 딥러닝 기법을 사용하여 이를 개선한다. 도 2는 본 발명의 일 실시예에 따른 수중 영상 개선 장치의 구성도이다. 본 발명의 실시예에 따른 수중 영상 개 선 장치는, 도시된 바와 같이, 제1 영상 개선부, 제2 영상 개선부, 가중치 코어부, 가중치 계산 부, 가중치 연산부 및 정제부를 포함하여 구성한다. 제1 영상 개선부는 입력 영상(수중 영상)을 화이트 밸런스 처리한 후 딥러닝 네트워크들에 통과시켜 개선 된 영상을 생성하고, 제2 영상 개선부는 입력 영상을 노이즈 제거 처리한 후 딥러닝 네트워크들에 통과시 켜 개선된 영상을 생성한다. 가중치 코어부는 입력 영상를 딥러닝 네트워크에 통과시켜 추출한 특징, 제1 영상 개선부가 개선된 영상을 생성하는 과정에서 추출하는 입력 영상의 특징 및 제2 영상 개선부가 개선된 영상을 생성하는 과정 에서 추출하는 입력 영상의 특징을 통합하여 딥러닝 네트워크에 통과시켜 공통 특징을 추출한다. 가중치 계산부는 딥러닝 네트워크를 이용하여 가중치 코어부에 의해 추출된 공통 특징으로부터 입력 영상에 대한 전역적 컨트라스트 가중치, 지역적 컨트라스트 가중치, 공통 특징과 동일한 가중치, 노출도를 나타 내는 가중치를 계산한다. 가중치 연산부는 가중치 계산부에서 계산된 가중치들을 제1 영상 개선부에서 개선된 영상과 제2 영상 개선부에서 개선된 영상에 각각 적용한다. 정제부는 가중치들이 각각 적용된 개선 영상들을 모두 연결한 후 딥러닝 네트워크에 통과시켜 하나의 개선 영상을 생성하여 출력한다. 본 발명의 실시예에 따른 수중 영상 개선 장치의 구성들 중 가중치 연산부를 제외한 제1 영상 개선부 , 제2 영상 개선부, 가중치 코어부, 가중치 계산부 및 정제부는 딥러닝 네트워크를 활용하여 구현한다. 본 발명의 실시예에 따른 수중 영상 개선 장치의 딥러닝 네트워크 구성을, 도 3에 도시하였 다. 도 3에 도시된 바와 같이, 제1 영상 개선부와 제2 영상 개선부는 입력 I로부터 딥러닝 네트워크를 통 해 2개의 개선된 영상 I1과 I2를 생성한다. I1과 I2는 화이트 밸런스나 노이즈가 제거된 영상이 생성되어지며 딥 러닝 네트워크의 학습에 의해 산출된다. 개선된 영상 I1과 I2과 가중치 계산부에서 산출된 가중치 WL,WLC,WI,WE를 이용하여 가중치 연산부에서 는 IL1,IL2,ILC1,ILC2,II1,II2,IE1,IE2를 생성한다. 정제부에서는 가중치 연산부의 출력 IL1,IL2,ILC1,ILC2,II1,II2,IE1,IE2를 다시 딥러닝 네트워크에 통과시켜 최종 출력을 생성한다. 이하에서, 각각의 구성에 대해 보다 상세히 설명한다. 가중치 코어부는 영상을 입력으로 받아 가중치 WL,WLC,WI,WE를 생성하기 위한 공통 특징(feature)를 추출한 다. 가중치 코어부는 두 개의 딥러닝 네트워크 NC1과 NC2로 구성되어 있다. 각각의 딥러닝 네트워크는 U- net 구조를 가지며 각각의 레이어는 Conv-BN-PReLU 의 형태를 권장하나 이에 한정되지 않는다. NC1의 출력 IC1은 제1 영상 개선부의 N11의 출력 I11과 제2 영상 개선부의 N21의 출력 I21에 더해져 IC2를 생성하도록 한 다. I11,IC1,I21의 출력의 형태(N x C x H x W)는 같아야 한다. 따라서 딥러닝 네트워크 N11,NC1,N21은 같은 구조의 네트워크를 가지는 것을 권장하나 출력의 형태만 일치한다면 반드시 같을 필요는 없다. N은 배치 크기, C는 채 널 크기, H는 영상 세로 크기, W는 영상 가로 크기를 각각 의미한다. 딥러닝 네트워크 NC2는 IC2를 입력으로 받 아 가중치 공통 특징을 갖는 WC를 생성한다. NC2의 구조는 U-net을 추천하나 어떤 특정한 네트워크에 제한되지 않는다. WC는 가중치 계산부에서 사용되는 4개의 딥러닝 네트워크에 공통 입력이 된다."}
{"patent_id": "10-2021-0134587", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "제1 영상 개선부의 WB는 화이트 밸런스 기법을 의미하며 IWB는 흰색 조정이 된 영상을 의미한다. 화이트 밸 런스 기법은 GRAY WORLD 방법이 추천되나 특정 방법에 한정되지 않는다. IWB는 N11의 입력이 되어 I11을 생성한다. I11은 가중치 코어부의 중간 입력으로 사용된다. I11은 N21의 입력으로 들어가 RGB 영상 I1을 생 성한다. 즉 I1은 RGB 영상으로 개선된 IWB로 볼 수 있다. 제2 영상 개선부의 NR (Noise Reduction)은 노이제 제거 기법을 의미하며 INR은 노이즈가 제거된 영상을 나타한다. 노이즈 제거 기법은 Bilateral 필터 등이 사용될 수 있으나 특정 방법에 한정되지 않는다. INR는 N21 의 입력이 되어 I21을 생성한다. I21은 가중치 코어부의 중간 입력으로 사용된다. I21은 N22의 입력으로 들어 가 RGB 영상 I2을 생성한다. 즉 I2는 RGB 영상으로 개선된 INR로 볼 수 있다. 가중치 계산부에서는 Wc를 입력으로 하여 Laplacian 컨트라스트(L), 지역 컨트라스트(Local Contrast, LC), 동일(Identity, I), 노출(Exposedness, E)의 4가지 가중치를 계산한다. 가중치 계산부의 L 블록은 WC 에 대하여 Laplacian 필터를 적용한 것으로서 WC,L을 생성한다. Laplacian 컨트라스트는 전역적 컨트라스트를 얻 기 위한 것이다. NWL은 WC,L을 입력으로 하여 WL의 출력을 생성한다. WL의 출력의 형태는 N x 6 x H x C 의 형태 를 갖는다. WL은 [WL1,WL2] 로 나누어지며 WL1과 WL2는 각각 N x 3 x H x C 의 크기를 갖는다. [X,Y]는 X와 Y가 연 결 (Concatenation) 되었음을 의미한다. WL1과 WL2는 가중치 연산부에서 각각 I1과 I2와의 연산에 이용된다. WLC,WI,WE도 각각 N x 6 x H x C 의 형태를 갖으며 [WLC1,WLC2], [WI1,WI2], [WE1,WE2]로 나누어진다. 가중치 계산부의 LC 블록은 영상의 지역적 컨트라스트를 산출하기 위한 블록이다. 지역 컨트라스트 WC,LC(x,y)는 수식 와 같이 계산할 수 있다. x와 y는 영상에서 픽셀의 위치를 나타낸다. 는 WC에 저대역 (Lowpass) 필터를 취한 것으로 특정한 필터에 한정하지는 않는다. NWLC은 NC,LC을 입력으로 하여 WLC의 출력을 생 성한다. WLC의 형태는 위에서 서술하였다."}
{"patent_id": "10-2021-0134587", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "가중치 계산부의 I 블록은 Identyty를 의미하며 이 블록은 입력과 출력이 동일하다. 따라서 I 블록의 입력 과 출력은 WC이다. NWI은 WC을 입력으로 하여 WI의 출력을 생성한다. WI의 형태는 위에서 서술한 것과 동일하다. 가중치 계산부의 E 블록은 노출도(Exposedness)를 의미하며 픽셀들이 촬영시 얼마나 잘 노출되어 있는지를 평가한다. 일반적으로 0에서 1사이로 정규화된 픽셀 값이 0.5일 때 노출이 많이 되는 경향이 있고 이는 수식 과 같이 되어 있고 미분 가능하다. NWE은 WC,E을 입력으로 하여 WE의 출력을 생성한다. WE의 형태는 위에서 서 술하였다. 가중치 연산부는 가중치 계산부에서 산출된 [WL1,WL2], [WLC1,WLC2], [WI1,WI2], [WE1,WE2]와 I1 과 I2 와 의 연산을 수행한다. 가중치 연산부에서 는 각 요소 별 곱셈을 의미한다. 즉 4차원 텐서의 동일한 위치의 곱들의 결과로써 에서 A,B,C는 모두 같은 형태를 갖아야 한다. 가중치 연산부는 각각 다음을 계 산한다."}
{"patent_id": "10-2021-0134587", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "최종적으로 정제부에서는 가중치 연산부의 출력을 연결(concatenation)하여 IF=[IL1,IL2,ILC1,ILC2,II1,II2,IE1,IE2]을 입력으로 한다. IF의 형태는 N x 24 x H x W 이다. 정제부의 네트워 크 NF Conv, BN, PReLU 로 구성된 다층의 레이어로 구성된 것을 추천하나 이에 한정하지는 않는다. IF는 네트워 크 NF 를 통과하여 최종 출력인 을 생성하도록 한다. 의 형태는 N x 3 x H x W로 입력 영상 I와 동일하다. 본 발명의 실시예에 따른 수주 영상 개선 장치는 전 영역에서 미분 가능하므로 엔드-투-엔드(end-to-end) 학습 이 가능하다. 즉, 제1 영상 개선부, 제2 영상 개선부 및 가중치 코어부에 입력 영상을 입력하는 경우에 정제부에서 출력되는 개선 영상과 원본(Ground Truth) 간의 손실이 줄어드는 방향으로 학습되다. 학습을 위한 손실 함수는 다음과 같이 정의 할 수 있다."}
{"patent_id": "10-2021-0134587", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 5, "content": "는 생성된 개선 영상이고 O는 원본(Ground Truth) 영상이다. 는 영상 X로부터 특징을 추출하는 데이터 를 의미한다. 본 발명에서는 로 미리 학습된 VGG-19 네트워크의 relu4_4 레이어를 추천하나 이에 한정하지는 않는다. 도 4는 본 발명의 다른 실시예에 따른 수중 영상 개선 방법의 설명에 제공되는 흐름도이다. 수중 영상의 개선을 위해, 먼저 제1 영상 개선부는 수중 영상을 화이트 밸런스 처리한 후 딥러닝 네트워크 들에 통과시켜 개선된 영상을 생성하고(S210), 제2 영상 개선부는 입력 영상을 노이즈 제거 처리한 후 딥 러닝 네트워크들에 통과시켜 개선된 영상을 생성한다(S220). 그러면 가중치 코어부는 수중 영상를 딥러닝 네트워크에 통과시켜 추출한 특징, S210단계에서 개선된 영상 을 생성하는 과정에서 추출하는 수중 영상의 특징 및 S220단계에서 개선된 영상을 생성하는 과정에서 추출하는 수중 영상의 특징을 통합하여 딥러닝 네트워크에 통과시켜 공통 특징을 추출한다(S230). 이후 가중치 계산부는 딥러닝 네트워크를 이용하여 S230단계에서 추출된 공통 특징으로부터 수중 영상에 대한 전역적 컨트라스트 가중치, 지역적 컨트라스트 가중치, 공통 특징과 동일한 가중치, 노출도를 나타내는 가 중치를 계산한다(S240). 그러면 가중치 연산부는 S240단계에서 계산된 가중치들을 S210단계와 S220단계에서 개선된 영상들에 각각 적용한다(S250). 마지막으로 정제부는 S250단계에 가중치들이 각각 적용된 개선 영상들을 모두 연결한 후 딥러닝 네트워크 에 통과시켜 하나의 개선 영상을 생성하여 출력한다(S260).지금까지 수중 영상 개선 장치 및 방법에 대해 바람직한 실시예를 들어 상세히 설명하였다. 위 실시예에서는 개선 대상으로 수중 영상을 언급하였는데, 수중 영상 이외의 다른 영상을 개선함에 있어서도 본 발명의 기술적 사상이 적용될 수 있다. 또한, 도 5에 도시된 바와 같이, 본 발명의 실시예에서 제시한 영상 개선 장치를 영상 생성 장치 및 영상 출력 장치와 연결하여 영상 시스템을 구성하는 경우에도 본 발명의 기술적 사상이 적용될 수 있다. 한편, 본 실시예에 따른 장치와 방법의 기능을 수행하게 하는 컴퓨터 프로그램을 수록한 컴퓨터로 읽을 수 있는 기록매체에도 본 발명의 기술적 사상이 적용될 수 있음은 물론이다. 또한, 본 발명의 다양한 실시예에 따른 기 술적 사상은 컴퓨터로 읽을 수 있는 기록매체에 기록된 컴퓨터로 읽을 수 있는 코드 형태로 구현될 수도 있다. 컴퓨터로 읽을 수 있는 기록매체는 컴퓨터에 의해 읽을 수 있고 데이터를 저장할 수 있는 어떤 데이터 저장 장 치이더라도 가능하다. 예를 들어, 컴퓨터로 읽을 수 있는 기록매체는 ROM, RAM, CD-ROM, 자기 테이프, 플로피 디스크, 광디스크, 하드 디스크 드라이브, 등이 될 수 있음은 물론이다. 또한, 컴퓨터로 읽을 수 있는 기록매체 에 저장된 컴퓨터로 읽을 수 있는 코드 또는 프로그램은 컴퓨터간에 연결된 네트워크를 통해 전송될 수도 있다. 또한, 이상에서는 본 발명의 바람직한 실시예에 대하여 도시하고 설명하였지만, 본 발명은 상술한 특정의 실시"}
{"patent_id": "10-2021-0134587", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 6, "content": "예에 한정되지 아니하며, 청구범위에서 청구하는 본 발명의 요지를 벗어남이 없이 당해 발명이 속하는 기술분야 에서 통상의 지식을 가진자에 의해 다양한 변형실시가 가능한 것은 물론이고, 이러한 변형실시들은 본 발명의 기술적 사상이나 전망으로부터 개별적으로 이해되어져서는 안될 것이다."}
{"patent_id": "10-2021-0134587", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1. 수중에서 광학 영상 시스템 도 2. 본 발명의 실시예에 따른 수중 영상 개선 장치. 도 3. 본 발명의 실시예에 따른 수중 영상 딥러닝 네트워크 도면. 도 4. 본 발명의 실시예에 따른 수중 영상 개선 방법. 도 5. 본 발명이 적용가능한 영상 시스템."}
