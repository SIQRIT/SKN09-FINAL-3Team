{"patent_id": "10-2022-0169769", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2024-0049757", "출원번호": "10-2022-0169769", "발명의 명칭": "위성 이미지의 설명성 향상을 위한 전자 장치", "출원인": "삼성전자주식회사", "발명자": "윤찬현"}}
{"patent_id": "10-2022-0169769", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "적어도 하나의 명령어(instructions)를 저장하는 메모리; 및상기 적어도 하나의 명령어를 실행하도록 구성되는 적어도 하나의 프로세서를 포함하고,상기 적어도 하나의 프로세서는 상기 적어도 하나의 명령어를 실행하여,풀링 레이어를 사이에 두고 순차적으로 연결되는 복수의 컨볼루션 블록을 포함하는 제1 인공지능 모델에 입력데이터를 입력하고, 상기 복수의 컨볼루션 블록 각각으로부터 출력되는 복수의 특징 맵을 획득하고,순차적으로 연결되는 복수의 지역 어텐션 블록을 포함하는 제2 인공지능 모델에 상기 입력 데이터 및 상기 복수의 특징 맵을 입력하고, 상기 복수의 지역 어텐션 블록 각각으로부터 출력되는 복수의 어텐션 맵을 획득하고,상기 복수의 특징 맵 중 마지막 특징 맵에서 상기 복수의 어텐션 맵 중 마지막 어텐션 맵에 대응되는 영역을 증폭하여 증폭 특징 맵을 출력하고,상기 증폭 특징 맵을 분류기에 입력하여 상기 입력 데이터에 대한 분류 결과를 출력하는 전자 장치."}
{"patent_id": "10-2022-0169769", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 입력 데이터는 적어도 하나의 객체를 포함하는 위성 이미지인 전자 장치."}
{"patent_id": "10-2022-0169769", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1항에 있어서,상기 복수의 특징 맵 각각은 상기 복수의 지역 어텐션 블록 각각에 순차적으로 입력되는 전자 장치."}
{"patent_id": "10-2022-0169769", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제1항에 있어서,상기 적어도 하나의 프로세서는 상기 적어도 하나의 명령어를 실행하여,상기 복수의 지역 어텐션 블록 중 가장 먼저 동작하는 지역 어텐션 블록을 통해, 상기 입력 데이터의 그레이 변환 데이터를 풀링 연산하고, 상기 풀링 연산의 결과 및 상기 복수의 특징 맵 중 가장 먼저 출력되는 초기 특징맵의 정규화 결과에 기초하여 상기 초기 특징 맵의 채널 별 가중치 벡터를 획득하는 전자 장치."}
{"patent_id": "10-2022-0169769", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제1항에 있어서,상기 적어도 하나의 프로세서는 상기 적어도 하나의 명령어를 실행하여,상기 복수의 컨볼루션 블록 중 하나의 컨볼루션 블록으로부터 출력된 하나의 특징 맵을 정규화하고,상기 복수의 지역 어텐션 블록 중 상기 하나의 컨볼루션 블록에 대응되는 하나의 지역 어텐션 블록을 통해, 상기 하나의 지역 어텐션 블록 이전에 동작하는 다른 하나의 지역 어텐션 블록의 출력 및 상기 하나의 특징 맵의공개특허 10-2024-0049757-3-정규화 결과에 기초하여 상기 하나의 특징 맵의 채널 별 가중치 벡터를 획득하는 전자 장치."}
{"patent_id": "10-2022-0169769", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제5항에 있어서,상기 적어도 하나의 프로세서는 상기 적어도 하나의 명령어를 실행하여,상기 하나의 지역 어텐션 블록을 통해, 상기 채널 별 가중치 벡터를 가중치로 하여 상기 하나의 특징 맵에 가중치 합 연산을 수행하고, 상기 가중치 합 연산의 결과에 활성화 함수를 적용하여 상기 하나의 지역 어텐션 블록의 출력에 대응되는 하나의 어텐션 맵을 획득하는 전자 장치."}
{"patent_id": "10-2022-0169769", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제1항에 있어서,상기 적어도 하나의 프로세서는 상기 적어도 하나의 명령어를 실행하여,상기 마지막 특징 맵과 상기 마지막 특징 맵에 상기 마지막 어텐션 맵을 곱 연산한 결과를 더하여 상기 증폭 특징 맵을 출력하는 전자 장치."}
{"patent_id": "10-2022-0169769", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제1항에 있어서,상기 적어도 하나의 프로세서는 상기 적어도 하나의 명령어를 실행하여,상기 분류 결과에 기초하여 정의되는 손실 함수에 따라 상기 제1 인공지능 모델 및 상기 제2 인공지능 모델을학습하는 전자 장치."}
{"patent_id": "10-2022-0169769", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "전자 장치에 의해 수행되는 동작 방법으로서,풀링 레이어를 사이에 두고 순차적으로 연결되는 복수의 컨볼루션 블록을 포함하는 제1 인공지능 모델에 입력데이터를 입력하는 단계;상기 복수의 컨볼루션 블록 각각으로부터 출력되는 복수의 특징 맵을 획득하는 단계;순차적으로 연결되는 복수의 지역 어텐션 블록을 포함하는 제2 인공지능 모델에 상기 입력 데이터 및 상기 복수의 특징 맵을 입력하는 단계;상기 복수의 지역 어텐션 블록 각각으로부터 출력되는 복수의 어텐션 맵을 획득하는 단계; 상기 복수의 특징 맵 중 마지막 특징 맵에서 상기 복수의 어텐션 맵 중 마지막 어텐션 맵에 대응되는 영역을 증폭하여 증폭 특징 맵을 출력하는 단계; 및상기 증폭 특징 맵을 분류기에 입력하여 상기 입력 데이터에 대한 분류 결과를 출력하는 단계를 포함하는 동작방법."}
{"patent_id": "10-2022-0169769", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "적어도 하나의 객체를 포함하는 위성 이미지에 대응되는 입력 데이터를 획득하고, 풀링 레이어를 사이에 두고순차적으로 연결되는 복수의 컨볼루션 블록을 포함하는 제1 인공지능 모델 및 순차적으로 연결되는 복수의 지역어텐션 블록을 포함하는 제2 인공지능 모델에 기초하여 상기 입력 데이터에 대한 분류 결과를 출력하는 위성 노공개특허 10-2024-0049757-4-드; 및상기 제1 인공지능 모델 및 상기 제2 인공지능 모델을 재학습시키고, 상기 재학습에 따른 모델 파라미터를 상기위성 노드에 업데이트하는 지상 노드를 포함하고,상기 위성 노드는,상기 제1 인공지능 모델에 입력 데이터를 입력하고, 상기 복수의 컨볼루션 블록 각각으로부터 출력되는 복수의특징 맵을 획득하고,상기 제2 인공지능 모델에 상기 입력 데이터 및 상기 복수의 특징 맵을 입력하고, 상기 복수의 지역 어텐션 블록 각각으로부터 출력되는 복수의 어텐션 맵을 획득하고,상기 복수의 특징 맵 중 마지막 특징 맵에서 상기 복수의 어텐션 맵 중 마지막 어텐션 맵에 대응되는 영역을 증폭하여 증폭 특징 맵을 출력하고,상기 증폭 특징 맵을 분류기에 입력하여 상기 분류 결과를 출력하는 위성 시스템."}
{"patent_id": "10-2022-0169769", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명에 따르면, 적어도 하나의 명령어(instructions)를 저장하는 메모리; 및 상기 적어도 하나의 명령어를 실행하도록 구성되는 적어도 하나의 프로세서를 포함하고, 상기 적어도 하나의 프 로세서는 상기 적어도 하나의 명령어를 실행하여, 풀링 레이어를 사이에 두고 순차적으로 연결되는 복수의 컨볼 (뒷면에 계속)"}
{"patent_id": "10-2022-0169769", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 위성 이미지의 설명성 향상을 위한 전자 장치에 관한 것이다."}
{"patent_id": "10-2022-0169769", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "최근 기술 발전에 따라 대규모 데이터의 확보가 가능해지면서, 위성 영상을 통한 객체 인식 기술이 많은 분야에 서 활용되고 있다. 예시적으로, 실제 위성의 온보드(Onboard)에서 인공지능 모델을 활용하여 수집된 위성 영상 을 전처리하는 기술들이 등장하고 있다. 위성의 온보드 상에서 인공지능 모델 처리를 위해서는, 인공지능 모델의 치명적인 오류를 방지하는 것이 중요하 다. 인공지능 모델의 성능 향상을 위하여, 시각적 설명(visual explanation)을 활용하여 라벨링하는 것이 고려 될 수 있다. 시각적 설명이란 입력 데이터에 대한 예측 결과를 바탕으로 인공지능 모델이 어떤 부분에 근거해 해당 예측을 내놓았는지를 히트 맵(또는, 중요영역 맵(Saliency Map)) 형태로 사람이 이해 가능하도록 표현한 것을 지칭한다. 한편, 기존의 시각적 설명을 생성하는 기술의 경우, 단일 최상위 컨볼루션 레이어(convolution layer)의 특성 맵만 활용한다. 위성 이미지의 경우, 영상 내에서 상대적으로 배경 대비 객체의 크기가 매우 작은 특성을 갖는다. 컨볼루션 레 이어를 포함하는 CNN(Convolutional Neural Network)은 연산 효율성을 위한 풀링(pooling) 레이어를 포함하게 되는데, 위성 영상에 포함된 매우 작은 객체 정보가 풀링 레이어로 인해 소실될 위험성이 있다. 이러한 소실에 따라, 시각적 설명이 객체 보다 배경에 형성되는 문제를 배경 편이(background bias)라 한다. 이러한 배경 편이 는 인공지능 모델의 인식률을 저하시킬 수 있다."}
{"patent_id": "10-2022-0169769", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은 상술한 과제를 해결하기 위한 것으로서, 본 발명의 목적은 위성 이미지의 설명성 향상을 위한 전자 장치를 제공하는 데 있다."}
{"patent_id": "10-2022-0169769", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명의 일 실시예로, 적어도 하나의 명령어(instructions)를 저장하는 메모리 및 상기 적어도 하나의 명령어 를 실행하도록 구성되는 적어도 하나의 프로세서를 포함하고, 상기 적어도 하나의 프로세서는 상기 적어도 하나 의 명령어를 실행하여, 풀링 레이어를 사이에 두고 순차적으로 연결되는 복수의 컨볼루션 블록을 포함하는 제1 인공지능 모델에 입력 데이터를 입력하고, 상기 복수의 컨볼루션 블록 각각으로부터 출력되는 복수의 특징 맵을 획득하고, 순차적으로 연결되는 복수의 지역 어텐션 블록을 포함하는 제2 인공지능 모델에 상기 입력 데이터 및 상기 복수의 특징 맵을 입력하고, 상기 복수의 지역 어텐션 블록 각각으로부터 출력되는 복수의 어텐션 맵을 획득하고, 상기 복수의 특징 맵 중 마지막 특징 맵에서 상기 복수의 어텐션 맵 중 마지막 어텐션 맵에 대응되는 영역을 증폭하여 증폭 특징 맵을 출력하고, 상기 증폭 특징 맵을 분류기에 입력하여 상기 입력 데이터에 대한 분류 결과를 출력하는 전자 장치이다. 예를 들어, 상기 입력 데이터는 적어도 하나의 객체를 포함하는 위성 이미지일 수 있다. 예를 들어, 상기 복수의 특징 맵 각각은 상기 복수의 지역 어텐션 블록 각각에 순차적으로 입력될 수 있다. 예를 들어, 상기 적어도 하나의 프로세서는 상기 적어도 하나의 명령어를 실행하여, 상기 복수의 지역 어텐션 블록 중 가장 먼저 동작하는 지역 어텐션 블록을 통해, 상기 입력 데이터의 그레이 변환 데이터를 풀링 연산하 고, 상기 풀링 연산의 결과 및 상기 복수의 특징 맵 중 가장 먼저 출력되는 초기 특징 맵의 정규화 결과에 기초 하여 상기 초기 특징 맵의 채널 별 가중치 벡터를 획득할 수 있다. 예를 들어, 상기 적어도 하나의 프로세서는 상기 적어도 하나의 명령어를 실행하여, 상기 복수의 컨볼루션 블록 중 하나의 컨볼루션 블록으로부터 출력된 하나의 특징 맵을 정규화하고, 상기 복수의 지역 어텐션 블록 중 상기 하나의 컨볼루션 블록에 대응되는 하나의 지역 어텐션 블록을 통해, 상기 하나의 지역 어텐션 블록 이전에 동작 하는 다른 하나의 지역 어텐션 블록의 출력 및 상기 하나의 특징 맵의 정규화 결과에 기초하여 상기 하나의 특 징 맵의 채널 별 가중치 벡터를 획득할 수 있다. 예를 들어, 상기 적어도 하나의 프로세서는 상기 적어도 하나의 명령어를 실행하여, 상기 하나의 지역 어텐션 블록을 통해, 상기 채널 별 가중치 벡터를 가중치로 하여 상기 하나의 특징 맵에 가중치 합 연산을 수행하고, 상기 가중치 합 연산의 결과에 활성화 함수를 적용하여 상기 하나의 지역 어텐션 블록의 출력에 대응되는 하나 의 어텐션 맵을 획득할 수 있다. 예를 들어, 상기 적어도 하나의 프로세서는 상기 적어도 하나의 명령어를 실행하여, 상기 마지막 특징 맵과 상 기 마지막 특징 맵에 상기 마지막 어텐션 맵을 곱 연산한 결과를 더하여 상기 증폭 특징 맵을 출력할 수 있다. 예를 들어, 상기 적어도 하나의 프로세서는 상기 적어도 하나의 명령어를 실행하여, 상기 분류 결과에 기초하여 정의되는 손실 함수에 따라 상기 제1 인공지능 모델 및 상기 제2 인공지능 모델을 학습할 수 있다. 본 발명의 일 실시예로, 전자 장치에 의해 수행되는 동작 방법으로서, 풀링 레이어를 사이에 두고 순차적으로 연결되는 복수의 컨볼루션 블록을 포함하는 제1 인공지능 모델에 입력 데이터를 입력하는 단계, 상기 복수의 컨 볼루션 블록 각각으로부터 출력되는 복수의 특징 맵을 획득하는 단계, 순차적으로 연결되는 복수의 지역 어텐션 블록을 포함하는 제2 인공지능 모델에 상기 입력 데이터 및 상기 복수의 특징 맵을 입력하는 단계, 상기 복수의 지역 어텐션 블록 각각으로부터 출력되는 복수의 어텐션 맵을 획득하는 단계, 상기 복수의 특징 맵 중 마지막 특징 맵에서 상기 복수의 어텐션 맵 중 마지막 어텐션 맵에 대응되는 영역을 증폭하여 증폭 특징 맵을 출력하는 단계 및 상기 증폭 특징 맵을 분류기에 입력하여 상기 입력 데이터에 대한 분류 결과를 출력하는 단계를 포함한 다. 본 발명의 일 실시예로, 적어도 하나의 객체를 포함하는 위성 이미지에 대응되는 입력 데이터를 획득하고, 풀링 레이어를 사이에 두고 순차적으로 연결되는 복수의 컨볼루션 블록을 포함하는 제1 인공지능 모델 및 순차적으로 연결되는 복수의 지역 어텐션 블록을 포함하는 제2 인공지능 모델에 기초하여 상기 입력 데이터에 대한 분류 결 과를 출력하는 위성 노드 및 상기 제1 인공지능 모델 및 상기 제2 인공지능 모델을 재학습시키고, 상기 재학습 에 따른 모델 파라미터를 상기 위성 노드에 업데이트하는 지상 노드를 포함하고, 상기 위성 노드는, 상기 제1 인공지능 모델에 입력 데이터를 입력하고, 상기 복수의 컨볼루션 블록 각각으로부터 출력되는 복수의 특징 맵을 획득하고, 상기 제2 인공지능 모델에 상기 입력 데이터 및 상기 복수의 특징 맵을 입력하고, 상기 복수의 지역 어텐션 블록 각각으로부터 출력되는 복수의 어텐션 맵을 획득하고, 상기 복수의 특징 맵 중 마지막 특징 맵에서 상기 복수의 어텐션 맵 중 마지막 어텐션 맵에 대응되는 영역을 증폭하여 증폭 특징 맵을 출력하고, 상기 증폭 특징 맵을 분류기에 입력하여 상기 분류 결과를 출력하는 위성 시스템이다."}
{"patent_id": "10-2022-0169769", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명에 의하면, 위성 이미지의 설명성 향상을 위한 전자 장치가 제공될 수 있다."}
{"patent_id": "10-2022-0169769", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하에서, 본 발명의 기술 분야에서 통상의 지식을 가진 자가 본 발명을 용이하게 실시할 수 있을 정도로, 본 발명의 실시 예들이 명확하고 상세하게 기재될 것이다. 도 1은 본 발명의 일 실시예에 따른 전자 장치의 동작 방법을 나타낸 것이다. 도 1을 참조하면, 일 실시예에 따른 전자 장치는 입력 데이터(IN)를 입력받고, 입력 데이터(IN)에 포함된 적어도 하나의 객체를 분류 또는 인식하도록 동작할 수 있다. 일 실시예로, 입력 데이터(IN)는 적어도 하나의 객체를 포함하는 위성 이미지일 수 있다. 위성 이미지는 예를 들어 버드 아이 뷰(bird-eye view) 앵글과 같이 초고도에서 바라본 앵글에서 촬영 및 수집될 수 있다. 따라서, 위성 이미지는 객체와 배경이 상대적으로 높은 연관성을 가진다는 특성과, 객체의 크기가 배경에 비하여 상대적 으로 매우 작다는 특성을 가질 수 있다. 본 발명의 전자 장치는 이러한 위성 이미지의 특성을 고려하여 객 체를 분류 또는 인식할 수 있다. 전자 장치는 상술한 위성 이미지 등을 포함하는 입력 데이터(IN)를 서로 다른 분기점을 갖는 제1 인공지능 모델 및 제2 인공지능 모델에 입력할 수 있다. 일 실시예로, 제1 인공지능 모델은 컨볼루션 신경망 구조를 가질 수 있다. 구체적으로, 제1 인공지능 모 델은 순차적, 연속적으로 연결되는 복수의 컨볼루션 블록(1101, 1103, 1105)을 포함할 수 있다. 더하여, 각 컨볼루션 블록은 활성화 함수(activation function)을 포함할 수 있다. 복수의 컨볼루션 블록(1101, 1103, 1105) 각각은 복수의 컨볼루션 레이어를 포함할 수 있다. 복수의 컨볼루션 블록(1101, 1103, 1105)의 개수를 L (여기서, L은 자연수임)이라고 할 때, 각 컨볼루션 블록의 크기는 일 수 있다. 여기서, i는 L개의 컨볼루션 블록 중 몇 번째 위치한 블록인지를 나타내는 인덱스, Ci는 채널 수, Hi는 높이의 공간 차원, Wi 는 너비의 공간 차원으로 정의될 수 있다. 예를 들어, 복수의 컨볼루션 블록(1101, 1103, 1105)은 입력 데이터 (IN)가 입력되는 입력단으로부터 멀어질수록 컨볼루션 블록의 크기가 줄어드는 피라미드형 구조를 가지도록 구 성될 수 있다. 전자 장치는 복수의 컨볼루션 블록(1101, 1103, 1105) 각각으로부터 출력되는 복수의 특징 맵(FM1, FM2, FML)을 획득할 수 있다. 각 특징 맵은 출력되는 컨볼루션 블록과 동일한 크기를 가질 수 있다. 각 컨볼루션 블 록으로부터 출력되는 특징 맵은 하기 수학식 1로 정의될 수 있다. [수학식 1] 여기서, 는 제1 인공지능 모델의 학습 가능한 파라미터의 집합으로 정의되고, x는 입력 데이터(IN)이 고, 는 특징 맵일 수 있다. 수학식 1에 따라 정의되는 특징 맵 중 i번째 특징 맵(FMi)은 로 정 의될 수 있다. 또한, 이하 본 명세서에 언급되는 수학식들에서 서로 중복되는 수식에 대한 정의는 생략될 수 있 다. 복수의 컨볼루션 블록(1101, 1103, 1105)은 풀링 레이어(pooling layer)(1102, 1104)를 사이에 두고 연결될 수 있다. 각 컨볼루션 블록으로부터 출력된 특징 맵은 다음 컨볼루션 블록에 입력되기 전에 풀링 레이어(1102, 1104)를 통해 자신의 공간 차원 크기에 대한 압축이 수행될 수 있다. 풀링 레이어(1102, 1104)를 통해 전체 제1 인공지능 모델의 연산 효율이 증대될 수 있다. 전자 장치는 입력 데이터(IN)를 제1 인공지능 모델에 입력하여 각 컨볼루션 블록 별로 출력되는 특 징 맵(FM1, FM2, FML)을 획득할 수 있다. 제1 인공지능 모델에 포함된 복수의 컨볼루션 블록(1101, 1103, 1105) 사이의 분기점을 제1 분기점으로 칭할 경우, 전자 장치는 각 제1 분기점을 통해 각 특징 맵 (FM1, FM2, FML)을 제2 인공지능 모델에 입력할 수 있다. 또한, 마지막 컨볼루션 블록으로부터 출력되는 특징 맵(FML)은 제1 인공지능 모델의 출력단과 연결된 분류기(또는, 예측기로 칭해질 수도 있음)에 입력할 수 있다. 상술한 바와 같이, 제1 인공지능 모델은 컨볼루션 신경망 구조를 통해 입력 데이터(IN)의 특징(feature) 를 추출할 수 있으며, 특히 복수의 컨볼루션 블록(1101, 1103, 1105)은 순차적으로 연결되는 구조를 가진다. 따 라서, 전자 장치는 각 컨볼루션 블록의 분기점으로부터 단계적으로 추출되는 각 특징 맵을 추출할 수 있다. 입력 데이터(IN)에서 객체 인식을 위한 특징을 추출한다는 점에서, 제1 인공지능 모델은 인식 모델 (perception model)이라 칭해질 수도 있다. 제2 인공지능 모델은 순차적으로 연결되는 복수의 지역 어텐션(attention) 블록(1201, 1203, 1205)을 포 함할 수 있다. 각 지역 어텐션 블록은 입력 데이터(IN)로부터 어텐션 맵(attention map)(1202, 1204, 1206)을 출력하도록 구성될 수 있다. 어텐션 맵은, 입력 데이터(IN)를 동일한 비율로 참고하는 것이 아니라, 특정 부분 에 가중치를 두어 학습하기 위하여 추출하는 데이터이다. 예를 들어, 위성 이미지의 경우, 위성 이미지에서 객 체에 대응되는 부분을 강조하기 위해 어텐션 맵이 사용될 수 있다. 어텐션 맵의 각 픽셀 값은 특징 맵에서 지역 어텐션 블록이 중요하게 생각하는 정도를 나타낸다. 어텐션 맵이 순차적으로 지역 어텐션 블록으로 전달될 때마다, 다음 지역 어텐션 블록은 전달받은 어텐션 맵에서 집중하는 영역에 더 초점을 두고 동작할 수 있다. 복수의 지역 어텐션 블록(1201, 1203, 1205)은 제1 인공지능 모델과 마찬가지로 컨볼루션 레이어 및/또는 활성화 함수를 포함할 수 있고, 입력단으로부터 멀어질수록 각 블록의 공간 차원의 크기가 줄어드는 피라미드 구조를 가질 수 있다. 일 실시예로, 전자 장치는 제1 인공지능 모델의 제1 분기점으로부터 특징 맵을 각 지역 어텐션 블록 에 입력할 수 있다. 다시 말해서, 복수의 특징 맵(FM1, FM2, FML) 각각은 복수의 지역 어텐션 블록(1201, 1203, 1205) 각각에 순차적으로 입력될 수 있다. 예를 들어, 첫 번째 지역 어텐션 블록은 첫 번째 컨볼루션 블 록으로부터 출력된 특징 맵(FM1)을 입력받을 수 있다. 이를 위하여, 일 실시예에 따른 복수의 지역 어텐 션 블록(1201, 1203, 1205)의 개수는 복수의 컨볼루션 블록(1101, 1103, 1105)의 개수와 동일한 L개일 수 있다. 제2 인공지능 모델에 포함된 복수의 지역 어텐션 블록(1201, 1203, 1205)을 제2 분기점으로 칭할 경우, 전자 장치는 각 제1 분기점을 통해 추출된 각 특징 맵을 각 제2 분기점을 통해 제2 인공지능 모델에 입력할 수 있다. 따라서, 각 지역 어텐션 블록은 이전단에 위치한 지역 어텐션 블록의 출력인 i-1번째 어텐션 맵과 제1 분기점으 로부터 입력된 i번째 특징 맵(FMi)을 입력으로 하여 i번째 어텐션 맵을 출력하도록 구성된다. 전자 장치는 각 지역 어텐션 블록을 통해, 이전단에 위치한 지역 어텐션 블록의 출력인 i-1번째 어텐션 맵을 활용하여 i번째 특징 맵(FMi)에 대하여 시각적 설명이 반영된 i번째 어텐션 맵을 출력할 수 있다. 결국, 제2 인공지능 모델은 입력단에서부터 순차적으로 생성되는 어텐션 맵을 각 지역 어테션 블록으로 전달하면서, 최종적으로 입력 데이터(IN)에서 강조된 영역의 정보가 모두 반영된 어텐션 맵을 출력할 수 있다. 각 지역 어텐션 블록으로부터 획득된 어텐션 맵은 입력 데이터(IN)에서 특정 영역이 강조된 데이터일 수 있다. 특정 영역의 강조는 입력 데이터(IN)가 이미지일 경우 시각적으로 수행되므로 시각적 설명으로 칭해질 수 있고, 이에 따라 어텐션 맵은 시각적 설명 맵으로도 칭해질 수 있다. 전자 장치는 상술한 실시예들에 따라 제1 인공지능 모델을 통해 마지막 컨볼루션 블록으로부 터 출력된 마지막 특징 맵인 L번째 특징 맵(FML)을 획득하고, 제2 인공지능 모델을 통해 마지막 지역 어 텐션 블록으로부터 출력된 마지막 어텐션 맵인 L번째 어텐션 맵을 획득할 수 있다. 전자 장치는 L번째 특징 맵(FML)과 L번째 어텐션 맵에 기초하여 특징 정제(feature refinement)를 수행할 수 있다. 특징 정제란, L번째 특징 맵(FML)에서 L번째 어텐션 맵에 대응되는 영역을 증폭하여 증폭 특징 맵(AFM)을 출력하는 것을 의미할 수 있다. 결국, 증폭 특징 맵(AFM)은 제1 인공지능 모델을 통해 추출된 특징들에 더하여, 제2 인공지능 모델을 통해 추출된 주의 집중이 필 요한 가중치까지 반영될 수 있다. 전자 장치는 증폭 특징 맵(AFM)을 분류기에 입력하여 입력 데이터(IN)에 대한 분류 결과(OUT)를 출 력할 수 있다. 분류 결과(OUT)는 입력 데이터(IN)에 대한 클래스(class) 별 신뢰도(confidence)인 일 수 있다. 예를 들어, 입력 데이터(IN)가 위성 이미지일 경우, 클래스는 위성 이미지에 포함된 각 객체의 종류에 대응될 수 있을 것이다. 전자 장치는 상술한 제1 인공지능 모델 및 제2 인공지능 모델을 손실 함수에 기초하여 학습시 킬 수 있다. 손실 함수는 분류 결과(OUT)에 기초하여 정의될 수 있다. 예를 들어, 학습을 위한 학습 데이터 셋 을 x, 학습 데이터에 대한 라벨 셋을 y, 학습 데이터 셋의 배치(batch)를 로 정의할 경우, 학습 을 위한 손실 함수는 하기 수학식 2로 정의될 수 있다. [수학식 2]"}
{"patent_id": "10-2022-0169769", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "여기서, 는 손실 함수, 1[y=j]는 y가 j일 경우에만 1을 출력하고 나머지는 0을 출력하는 함수, K는 학습 데이터 셋의 총 클래스 개수를 의미한다. 전자 장치는 수학식 2에 따라 정의되는 손실 함수에 기초하여 제1 인공지능 모델 및 제2 인공지능 모델을 학습시킬 수 있다. 전자 장치는 제1 인공지능 모델 및 제2 인공지능 모델에 입 력 데이터(IN)를 입력함으로써, 입력 데이터(IN)에 포함된 적어도 하나의 객체를 분류 또는 인식할 수 있다. 이상 본 발명의 실시예들에 따르면, 전자 장치는 위성 이미지와 같이 객체의 크기가 작은 특성을 갖는 입 력 데이터(IN)에서 객체 또는 중요한 특징을 정확히 감지함으로써 객체 분류 또는 인식의 성능을 향상시킬 수 있다. 특히, 본 발명은 입력 데이터(IN)의 의미론적 정보를 추출하는 제1 인공지능 모델의 각 분기점으로 부터 특징 맵을 추출하고, 특정 영역의 가중치 정보를 추출하는 제2 인공지능 모델의 각 분기점에 입력하 여 어텐션 맵을 추출함으로써, 배경 편이 문제를 해소할 수 있다. 도 2는 본 발명의 일 실시예에 따른 전자 장치의 보다 구체적인 동작 방법을 나타낸 것이다. 도 2를 참조하면, 일 실시예에 따른 전자 장치는 입력 데이터(IN)를 제2 인공지능 모델에 입력 시, 그레이 스케일화(gray scaled) 시킬 수 있다. 그렇다면, 복수의 지역 어텐션 블록(1201, 1203, 1205) 중 입력단에 위치한 지역 어텐션 블록에는 그레이 스케일화된 그레이 변환 데이터(GS_IN)가 입력될 수 있다. 상술한 바와 같이, 제1 인공지능 모델의 각 제1 분기점으로부터 특징 맵이 각 지역 어텐션 블록으로 입력 될 수 있는데, 전자 장치는 특징 맵을 입력 시 업샘플링(up-sampling)(1113, 1115) 또는 정규화 (normalization)(1112, 1114, 1116_를 수행할 수 있다. 일 실시예로, 전자 장치는 복수의 특징 맵(FM1, FM2, FML) 중 가장 먼저 출력되는 초기 특징 맵(FM1)을 복 수의 지역 어텐션 블록(1201, 1203, 1205)들 중 가장 먼저 위치한 지역 어텐션 블록인 제1 지역 어텐션 블록 에 입력 시, 초기 특징 맵(FM1)을 정규화시키고, 정규화된 초기 특징 맵을 입력할 수 있다.일 실시예로, 전자 장치는 초기 특징 맵(FM1)을 제외한 나머지 특징 맵을 제1 지역 어텐션 블록을 제외한 나머지 지역 어텐션 블록(1203, 1205)에 입력 시, 업샘플링(1113, 1115)을 통해 나머지 특징 맵의 공간 차원을 지역 어텐션 블록에서의 연산이 가능하도록 스케일링할 수 있다. 전자 장치는 업샘플링된 나머지 특징 맵을 정규화시키고, 정규화된 나머지 특징 맵을 지역 어텐션 블록에 입력할 수 있다. 도 3은 본 발명의 일 실시예에 따른 지역 어텐션 블록을 도시한 것이다. 도 3을 참조하면, 일 실시예에 따른 지역 어텐션 블록(1201, 1203, 1205)은 L개의 특징 맵 중 i번째 특징 맵 (FMi)을 입력받아 i번째 어텐션 맵을 출력하도록 구성될 수 있다. 이때, 지역 어텐션 블록(1201, 1203, 1205)의 다른 입력은 지역 어텐션 블록(1201, 1203, 1205)이 입력단인지 아닌지에 따라 그레이 변환 데이터(GS_IN) 또는 이전단의 지역 어텐션 블록(1201, 1203, 1205)의 출력일 수 있다. 지역 어텐션 블록(1201, 1203, 1205)은 가중치 벡터 생성기 및 어텐션 맵 생성기를 포함할 수 있다. 가중치 벡터 생성기는 특징 맵의 각 채널 별 가중치 벡터를 생성할 수 있다. 일 실시예로, 가중치 벡터 생성기에 그레이 변환 데이터(GS_IN)가 입력될 경우, 전자 장치는 그레이 변환 데이터(GS_IN)와 초기 특징 맵(FM1)에 기초하여 초기 특징 맵(FM1)의 채널 별 가중치 벡터를 획득할 수 있 다. 일 실시예로, 가중치 벡터 생성기에 이전단의 지역 어텐션 블록(1201, 1203, 1205)의 출력이 입력될 경우, 전자 장치는 이전단의 지역 어텐션 블록(1201, 1203, 1205)의 출력과 초기 특징 맵(FM1)을 제외한 나머지 특징 맵인 i번째 특징 맵(FMi) 중 하나의 특징 맵에 기초하여 특징 맵의 채널 별 가중치 벡터를 획득할 수 있다. 상술한 바와 같이 특징 맵은 Ci 차원의 채널을 가지며, 가중치 벡터는 특징 맵의 채널 별로 생성될 수 있다. 가 중치 벡터는 입력 데이터(IN)에서 강조되어야 할 영역의 정보에 대응될 수 있다. 예를 들어, 위성 이미지가 입 력 데이터(IN)일 경우 가중치 벡터는 위성 이미지에 포함된 적어도 하나의 객체의 영역에 대한 정보를 포함할 수 있다. 제2 인공지능 모델에서 출력단에 가까워질수록, 즉 보다 높은 스테이지에 해당하는 가중치 벡터 생성기일수록 강조되어야 할 영역에 대한 가중치 정보를 정확하게 생성할 수 있다. 어텐션 맵 생성기는 가중치 벡터 생성기로부터 생성된 가중치 벡터에 기초하여 어텐션 맵(1202, 1204, 1206)을 생성할 수 있다. 어텐션 맵 생성기는 i번째 특징 맵(FMi)을 입력받고, i번째 특징 맵(FM i)에 가중치 벡터를 가중치로 하는 가중치 합(weighted sum) 연산을 통해 i번째 어텐션 맵을 생성할 수 있다. 제2 인공지능 모델에서 보다 높은 스테이지에 해당하는 어텐션 맵 생성기일수록 강조되어야 할 영 역의 정보를 정확하게 생성할 수 있다. 어텐션 맵 생성기를 통해 생성된 어텐션 맵은 특징 맵에서 강조되어야 할 영역이 시각적으로 반영된 것일 수 있다. 이하에서는, 지역 어텐션 블록의 실시예들에 대하여 보다 구체적으로 설명한다. 도 4는 본 발명의 일 실시예에 따른 지역 어텐션 블록을 도시한 것이다. 도 4에 따른 지역 어텐션 블록은 제2 인공지능 모델에서 입력단에 위치한 것일 수 있다. 따라서, 가장 먼저 동작하는 지역 어텐션 블록일 수 있다. 가중치 벡터 생성기(1210a)는 그레이 변환 데이터 (GS_IN)와 정규화를 통해 정규화된 초기 특징 맵(FM1)을 입력으로 받아 가중치 벡터를 생성할 수 있다. 먼저, 가중치 벡터 생성기(1210a)는 그레이 변환 데이터(GS_IN)를 초기 특징 맵(FM1)과 연산할 수 있도록 풀링 레이어(1211a)를 통해 풀링 연산함으로써 공간 차원을 초기 특징 맵(FM1)과 일치시킬 수 있다. 가중치 벡터 생 성기(1210a)는 풀링 연산의 결과 및 초기 특징 맵(FM1)의 정규화 결과를 곱 연산(1212a)할 수 있다. 가중치 벡 터 생성기(1210a)는 곱 연산의 결과로써 마스크 입력(MI)을 획득할 수 있다. 다음으로, 가중치 벡터 생성기(1210a)는 마스크 입력(MI)을 어텐션 블록(1213a) 및 풀링 레이어(1214a)에 순차 적으로 통과시켜 신뢰도 점수(CS)를 획득할 수 있다. 어텐션 블록은 적어도 하나의 컨볼루션 레이어와 활성화 함수를 포함할 수 있고, 마스크 입력(MI)으로부터 마스크 입력(MI)의 특징을 출력할 수 있다. 다음으로, 가중치 벡터 생성기(1210a)는 획득한 신뢰도 점수(CS)에 소프트맥스(softmax) 함수(1215a)를 적용함 으로써 최종적으로 채널 별 가중치 벡터를 생성할 수 있다. 상술한 일 실시예에 따른 가중치 벡터 생성기(1210a)의 동작은 하기 수학식 3으로 정의될 수도 있다. [수학식 3]"}
{"patent_id": "10-2022-0169769", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "여기서, W는 마스크 입력(MI), 는 초기 특징 맵(FM1), 는 그레이 변환 데이터(GS_IN)( ) 에 대한 풀링 연산, 는 벡터 또는 행렬의 요소(예를 들어, 픽셀) 별 곱 연산, AttB1는 가장 먼저 위치한 지 역 어텐션 블록인 제1 지역 어텐션 블록에 포함된 어텐션 블록(1213a)의 연산, 는 소프트맥스 함수(1215a) 적용을 통해 생성된 가중치 벡터로써, 초기 특징 맵(FM1)에 대한 가중치 벡터일 수 있다. 가중치 벡터 생성기(1210a)를 통해 생성된 가중치 벡터는 어텐션 맵 생성기로 전달된다. 어텐션 맵 생성기는 채널 별 가중치 벡터를 가중치로 하여 초기 특징 맵(FM1)에 가중치 합 연산을 수행할 수 있다. 예를 들어, 어텐션 맵 생성기는 채널 별로 초기 특징 맵(FM1)과 가중치 벡터를 곱 연산하 고, 곱 연산에 대하여 합 연산을 수행할 수 있다. 어텐션 맵 생성기는 가중치 합 연산의 결과에 활성화 함수를 적용할 수 있다. 이후, 어텐션 맵 생 성기는 활성화 함수의 결과를 정규화함으로써 어텐션 맵을 생성할 수 있다. 상술한 일 실시예에 따른 어텐션 맵 생성기의 동작은 하기 수학식 4로 정의될 수도 있다. [수학식 4]"}
{"patent_id": "10-2022-0169769", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "여기서, M(x)는 가중치 합 연산 및 활성화 함수의 결과, C1은 초기 특징 맵(FM1)의 채널 수, 는 ReLU 활성 화 함수, 는 초기 특징 맵(FM1)에 기초하여 생성된 제1 어텐션 맵으로 정의될 수 있다. 도 5는 본 발명의 다른 일 실시예에 따른 지역 어텐션 블록을 도시한 것이다. 도 5에 따른 지역 어텐션 블록(1203, 1205)은 제2 인공지능 모델에서 제1 지역 어텐션 블록을 제외 한 나머지 지역 어텐션 블록(1203, 1205)일 수 있다. 가중치 벡터 생성기(1210b)는 초기 특징 맵(FM1)을 제외한 나머지 특징 맵의 업샘플링(1113, 1115) 및 정규화 (1102, 1104)의 결과를 입력받고, 해당 지역 어텐션 블록 이전에 동작하는 다른 하나의 지역 어텐션 블록(120 7)의 출력을 입력받을 수 있다. 입력단에 위치한 제1 지역 어텐션 블록과 달리, 가중치 벡터 생성기 (1210b)는 이전단으로부터 출력된 어텐션 맵인 i-1번째 어텐션 맵을 입력으로 하며, 생성하는 마스크 입력(MI) 도 상이하다. 가중치 벡터 생성기(1210b)는 업샘플링(1113, 1115) 및 정규화된 특징 맵과, 이를 i-1번째 어텐션 맵과 곱 연산(1211b)한 결과를 합연산(1212b)하여 마스크 입력(MI)을 생성할 수 있다. 상술한 일 실시예에 따른 가중치 벡터 생성기(1210b)의 동작은 하기 수학식 5로 정의될 수도 있다. [수학식 5]"}
{"patent_id": "10-2022-0169769", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 5, "content": "여기서, 는 i-1번째 어텐션 맵으로 정의될 수 있다. 이후, 가중치 벡터 생성기(1210b)는 도 4와 마찬가지로 마스크 입력(MI)에 어텐션 블록(1213b) 및 풀링 레이어 (1214b)에 순차적으로 통과시켜 신뢰도 점수(CS)를 획득할 수 있다. 다음으로, 가중치 벡터 생성기(1210b)는 획 득한 신뢰도 점수(CS)에 소프트맥스 함수(1215b)를 적용함으로써 최종적으로 채널 별 가중치 벡터를 생성할 수 있다. 이후, 어텐션 맵 생성기는 채널 별 가중치 벡터를 가중치로 하여 i번째 특징 맵(FMi)에 가중치 합 연산을 수행할 수 있다. 예를 들어, 어텐션 맵 생성기는 채널 별로 i번째 특징 맵(FMi)과 가중치 벡터를 곱 연산 하고, 곱 연산에 대하여 합 연산을 수행할 수 있다. 어텐션 맵 생성기는 가중치 합 연산의 결과에 활성화 함수를 적용할 수 있다. 이후, 어텐션 맵 생 성기는 활성화 함수의 결과를 정규화함으로써 i번째 어텐션 맵을 생성할 수 있다. 상술한 실시예들에 따라, 전자 장치는 제2 인공지능 모델에 포함된 복수의 지역 어텐션 블록(1201, 1203, 1205)을 통해 어텐션 맵을 순차적으로 생성하면서 최종적으로는 L번째 지역 어텐션 블록으로부터 마지막 어텐션 맵인 을 획득할 수 있다. 마지막 어텐션 맵은 순차적으로 지역 어텐션 블록을 거치 면서 각 블록에서 강조된 영역의 정보가 모두 반영된 것일 수 있다. 상술한 실시예들에 따르면, 본 발명의 전자 장치는 제1 인공지능 모델의 각 분기점으로부터 출력된 각 특징 맵이 풀링 레이어를 통과하기 전에 제2 인공지능 모델의 각 지역 어텐션 블록에 입력함으로써, 지역 어텐션 블록 각각으로부터 어텐션 맵을 획득할 수 있다. 따라서, 각 지역 어텐션 블록은 풀링 연산 전의 정보 손실이 최소화된 특징 맵을 이용하여 어텐션 맵을 생성할 수 있으므로 배경 편이가 해소될 수 있다. 도 6은 본 발명의 일 실시예에 따른 특징 정제 동작을 나타낸 것이다. 도 6을 참조하면, 전자 장치는 제1 인공지능 모델의 L번째 컨볼루션 블록으로부터 획득한 마지막 특 징 맵인 을 획득하고, L번째 지역 어텐션 블록으로부터 마지막 어텐션 맵인 을 획득 할 수 있다. 전자 장치는 마지막 특징 맵과, 마지막 특징 맵에 마지막 어텐션 맵을 곱 연산 한 결과를 합 연산하여 증폭 특징 맵(AFM)을 출력할 수 있다. 출력된 증폭 특징 맵(AFM)은 어텐션 맵이 강조하는 영역에 해당하는 데이터가 증폭된 것일 수 있다. 곱 연산은 벡터 또는 행렬의 요소 별로 수행될 수 있다. 상술한 일 실시예에 따른 특징 정제 동작은 하기 수학식 6으로 정의될 수도 있다. [수학식 6]"}
{"patent_id": "10-2022-0169769", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 6, "content": "여기서, 는 증폭 특징 맵(AFM)으로 정의될 수 있다. 전자 장치는 증폭 특징 맵(AFM)을 분류기에 전달할 수 있다. 상기 복수의 지역 어텐션 블록(1201, 1203, 1205) 중 상기 하나의 컨볼루션 블록에 대응되는 하나의 지역 어텐 션 블록을 통해, 상기 하나의 지역 어텐션 블록 이전에 동작하는 다른 하나의 지역 어텐션 블록의 출력 및 상기 하나의 특징 맵의 정규화 결과에 기초하여 상기 하나의 특징 맵의 채널 별 가중치 벡터를 획득하는 전자 장치 .도 7은 본 발명의 일 실시예에 따른 전자 장치의 동작 방법의 순서도이다. 도 7을 참조하면, S1010 단계에서, 전자 장치는 풀링 레이어를 사이에 두고 순차적으로 연결되는 복수의 컨볼루션 블록(1101, 1103, 1105)을 포함하는 제1 인공지능 모델에 입력 데이터(IN)를 입력할 수 있다. 예를 들어, 입력 데이터(IN)는 적어도 하나의 객체를 포함하는 위성 이미지일 수 있다. S1020 단계에서, 전자 장치는 복수의 컨볼루션 블록(1101, 1103, 1105) 각각으로부터 출력되는 복수의 특 징 맵(FM1, FM2, FML)을 획득할 수 있다. S1030 단계에서, 전자 장치는 순차적으로 연결되는 복수의 지역 어텐션 블록(1201, 1203, 1205)을 포함하 는 제2 인공지능 모델에 입력 데이터(IN) 및 복수의 특징 맵(FM1, FM2, FML)을 입력할 수 있다. 이때, 전 자 장치는 복수의 특징 맵(FM1, FM2, FML) 각각을 복수의 지역 어텐션 블록(1201, 1203, 1205) 각각에 순 차적으로 입력할 수 있다. 예를 들어 i번째 컨볼루션 블록에서 출력된 i번째 특징 맵(FMi)은 i번째 지역 어텐션 블록에 입력될 수 있다. 또한, 입력 데이터(IN)는 그레이 스케일화된 그레이 변환 데이터(GS_IN)로써 입력될 수 있다. S1040 단계에서, 전자 장치는 복수의 지역 어텐션 블록(1201, 1203, 1205) 각각으로부터 출력되는 복수의 어텐션 맵(1202, 1204, 1206)을 획득할 수 있다. 하나의 지역 어텐션 블록을 기준으로, 이전단의 지역 어텐션 블록에서 획득된 어텐션 맵은 하나의 지역 어텐션 블록의 입력으로 사용될 수 있고, 이에 따라 어텐션 맵은 순 차적으로 지역 어텐션 블록을 거치면서 처리될 수 있다. S1050 단계에서, 전자 장치는 복수의 특징 맵(FM1, FM2, FML) 중 마지막 특징 맵에서 복수의 어텐션 맵 (1202, 1204, 1206) 중 마지막 어텐션 맵에 대응되는 영역을 증폭하여 증폭 특징 맵(AFM)을 출력할 수 있다. S1060 단계에서, 전자 장치는 증폭 특징 맵(AFM)을 분류기에 입력하여 입력 데이터(IN)에 대한 분류 결과(OUT)를 출력할 수 있다. 더하여, 전자 장치는 분류 결과(OUT)에 기초하여 정의되는 손실 함수에 따라 상제1 인공지능 모델 및 제2 인공지능 모델을 학습하는 단계를 더 포함할 수 있다. 여기서, 손실 함수는 수학식 2에 기초하여 정의될 수 있다. 도 8은 본 발명의 일 실시예에 따른 가중치 벡터 동작의 순서도이다. 도 8을 참조하면, 전자 장치는 제1 지역 어텐션 블록을 통해 S1110a 단계 및 S1120a 단계를 수행할 수 있다. S1110a 단계에서, 전자 장치는 입력 데이터(IN)의 그레이 변환 데이터(GS_IN)를 풀링 연산할 수 있다. S1120a 단계에서, 전자 장치는 풀링 연산의 결과 및 복수의 특징 맵(FM1, FM2, FML) 중 가장 먼저 출력되 는 초기 특징 맵(FM1)의 정규화 결과에 기초하여 초기 특징 맵(FM1)의 채널 별 가중치 벡터를 획득할 수 있다. S1120a 단계는 수학식 3을 통해 수행될 수 있다. 또는, 전자 장치는 제1 지역 어텐션 블록을 제외한 나머지 지역 어텐션 블록(1203, 1205) 중 하나를 통해 S1110b 단계 및 S1120b 단계를 수행할 수 있다. S1110b 단계에서, 전자 장치는 복수의 컨볼루션 블록(1101, 1103, 1105) 중 하나의 컨볼루션 블록으로부터 출력된 하나의 특징 맵을 정규화할 수 있다. S1120b 단계에서, 전자 장치는 복수의 지역 어텐션 블록(1201, 1203, 1205) 중 하나의 지역 어텐션 블록 이전에 동작하는 다른 하나의 지역 어텐션 블록의 출력 및 하나의 특징 맵의 정규화 결과에 기초하여 하나의 특 징 맵의 채널 별 가중치 벡터를 획득할 수 있다. 도 9는 본 발명의 일 실시예에 따른 어텐션 맵 생성 동작의 순서도이다. 도 9를 참조하면, 전자 장치는 S1120a 단계 또는 S1120b 단계를 수행한 후, S1130 단계에서 채널 별 가중 치 벡터를 가중치로 하여 하나의 특징 맵에 가중치 합 연산을 수행할 수 있다. 가중치 합 연산은 특징 맵의 채 널 별로 수행될 수 있다. S1140 단계에서, 전자 장치는 가중치 합 연산의 결과에 활성화 함수를 적용하여 하나의 지역 어텐션 블록 의 출력에 대응되는 하나의 어텐션 맵을 획득할 수 있다.도 10은 본 발명의 일 실시예에 따른 전자 장치를 도시한 것이다. 도 10을 참조하면, 일 실시예에 따른 전자 장치는 메모리 및 프로세서를 포함한다. 메모리는 프로세서와 연결될 수 있고, 프로세서의 동작과 관련한 다양한 정보를 저장할 수 있다. 예를 들어, 메모리는 프로세서에 의해 제어되는 프로세스들 중 일부 또는 전부를 수행하거나, 본 개시의 설명, 기능, 절차, 제안, 방법 및/또는 동작 순서도들을 수행하기 위한 적어도 하나의 명령어 (instructions)를 포함하는 소프트웨어 코드를 저장할 수 있다. 프로세서는 메모리를 제어하며, 메모리에 저장된 적어도 하나의 명령어를 실행하여 본 개시의 설명, 기능, 절차, 제안, 방법 및/또는 동작 순서도들을 구현하도록 구성될 수 있다. 또한, 프로세서는 메 모리에 저장된 명령어에 기초하여 본 개시의 다양한 예들에 따른 동작들을 제공할 수 있다. 또한, 프로세 서는 메모리에 저장된 정보를 처리하여 데이터를 생성할 수 있다. 일 실시예로, 프로세서는 풀링 레이어를 사이에 두고 순차적으로 연결되는 복수의 컨볼루션 블록(1101, 1103, 1105)을 포함하는 제1 인공지능 모델에 입력 데이터(IN)를 입력하고, 복수의 컨볼루션 블록(1101, 1103, 1105) 각각으로부터 출력되는 복수의 특징 맵(FM1, FM2, FML)을 획득할 수 있다. 프로세서는 순차적으로 연결되는 복수의 지역 어텐션 블록(1201, 1203, 1205)을 포함하는 제2 인공지능 모 델에 입력 데이터(IN) 및 복수의 특징 맵(FM1, FM2, FML)을 입력하고, 복수의 지역 어텐션 블록(1201, 1203, 1205) 각각으로부터 출력되는 복수의 어텐션 맵(1202, 1204, 1206)을 획득할 수 있다. 프로세서는 복수의 특징 맵(FM1, FM2, FML) 중 마지막 특징 맵에서 복수의 어텐션 맵(1202, 1204, 1206) 중 마지막 어텐션 맵에 대응되는 영역을 증폭하여 증폭 특징 맵(AFM)을 출력하고, 증폭 특징 맵(AFM)을 분류기 에 입력하여 입력 데이터(IN)에 대한 분류 결과(OUT)를 출력할 수 있다. 프로세서는 분류 결과(OUT)에 기초하여 정의되는 손실 함수에 따라 제1 인공지능 모델 및 제2 인공 지능 모델을 학습할 수 있다. 학습된 제1 인공지능 모델 및 제2 인공지능 모델은 메모리 에 저장될 수 있다. 이하에서는, 상술한 실시예들에 따른 전자 장치와 연동되어 동작하는 위성 시스템 및 위성 시스템에 포함 되는 지상 노드에 대하여 설명한다. 상술한 내용과 중복되는 부분에 대한 상세한 설명은 생략될 수 있다. 도 11은 본 발명의 일 실시예에 따른 위성 시스템을 도시한 것이다. 도 11을 참조하면, 일 실시예에 따른 위성 시스템은 위성 노드 및 지상 노드를 포함할 수 있다. 위성 노드 및 지상 노드는 각각 복수 개가 구비될 수도 있다. 위성 노드는 상술한 실시예들에 따른 전자 장치, 전자 장치와 연결되는 카메라 및 송수신기 를 포함할 수 있다. 카메라는 정지 영상 및 동영상을 촬영할 수 있다. 일 실시예에 따르면, 카메라는 하나 이상의 렌즈들, 이미지 센서들, 이미지 시그널 프로세서들, 또는 플래시 등을 포함할 수 있다. 카메라는 버드 아 이 뷰로 보여지는 위성 이미지를 촬영 및 수집할 수 있다. 전자 장치는 수집된 위성 이미지를 입력 데이터 (IN)로 활용할 수 있다. 송수신기는 전자 장치의 제어에 따라 유/무선 신호나 데이터를 전송 및/또는 수신할 수 있다. 예를 들어, 위성 노드는 송수신기를 통해 지상 노드와 신호나 데이터를 주고받을 수 있다. 일 실시예로, 송수신기는 전자 장치를 통해 출력된 복수의 어텐션 맵(1202, 1204, 1206) 및/또는 복 수의 특징 맵(FM1, FM2, FML)을 지상 노드에 전송하거나, 또는 지상 노드로부터 업데이트된 모델 파라 미터를 수신할 수 있다. 전자 장치는 상술한 실시예들에 따라 적어도 하나의 객체를 포함하는 위성 이미지에 대응되는 입력 데이터 (IN)를 카메라로부터 획득하고, 풀링 레이어를 사이에 두고 순차적으로 연결되는 복수의 컨볼루션 블록 (1101, 1103, 1105)을 포함하는 제1 인공지능 모델 및 순차적으로 연결되는 복수의 지역 어텐션 블록 (1201, 1203, 1205)을 포함하는 제2 인공지능 모델에 기초하여 입력 데이터(IN)에 대한 분류 결과(OUT)를 출력할 수 있다. 지상 노드는 위성 노드로부터 입력 데이터(IN)를 수신하고, 제1 인공지능 모델 및 제2 인공지능 모델을 분류기의 분류 결과(OUT)에 따라 재학습시킬 수 있다. 또한, 지상 노드는 재학습에 따른 모델 파라미터를 위성 노드에 업데이트할 수 있다. 지상 노드는 기지국(base station) 또는 단말(terminal)일 수 있다. 기지국은 기지국 외에 '액세스 포인트 (access point, AP)', 'gNB(next generation node B)', '5G 노드(5th generation node)', '무선 포인트 (wireless point)', '송수신 포인트(transmission/reception point, TRP)', 또는 이와 동등한 기술적 의미를 가지는 다른 용어로 지칭될 수 있다. 단말은 단말 외 '사용자 장비(user equipment, UE)', '이동국(mobile station)', '가입자국(subscriber station)', '원격 단말(remote terminal)', '무선 단말(wireless terminal)', 또는 '사용자 장치(user device)' 또는 이와 동등한 기술적 의미를 가지는 다른 용어로 지칭될 수 있다. 이하에서는, 지상 노드의 동작에 대하여 구체적으로 설명한다. 도 12는 본 발명의 일 실시예에 따른 지상 노드의 동작을 나타낸 것이다. 도 12를 참조하면, 일 실시예에 따른 지상 노드는 IES(Inconsistent Explanation Sample) 선택기 및 약한 감독 훈련기를 포함할 수 있다. 먼저, IES 선택기는 위성 노드로부터 생성된 복수의 어텐션 맵(1202, 1204, 1206)을 전달받을 수 있다. IES 선택기는 복수의 어텐션 맵(1202, 1204, 1206) 중 어텐션 맵 쌍을 임의로 선택할 수 있다. 선택 된 어텐션 맵 쌍은 일 수 있다. 상술한 바와 같이, 어텐션 맵은 시각적 설명이 반영된 시각 적 설명 맵으로도 칭해질 수 있으므로, 선택된 어텐션 맵 하나를 편의상 VE(x)로 칭하기로 한다. IES 선택기는 선택한 어텐션 맵 쌍으로부터 공통 영역을 선별할 수 있다. 일 실시예로, IES 선택기는 어텐션 맵 쌍에 포함된 픽셀들 중 픽셀 값이 0이 아닌 픽셀을 공통 영역으로써 선별할 수 있다. 먼저, IES 선택 기는 어텐션 맵 쌍에 포함된 각 어텐션 맵의 픽셀 중 픽셀 값이 0에 가까운 픽셀은 상대적으로 의미가 없 는 영역으로 판단하여 필터링할 수 있다. 필터링된 어텐션 맵 쌍은 로 정의될 수 있다. 이때, 각 픽셀의 인덱스를 (i,j)라 할 때, 어텐션 맵 쌍의 픽셀 값은 로 정의될 수 있다. 다음으로, IES 선택기는 어텐션 맵 쌍에 포함된 두 개의 어텐션 맵에서 픽셀 값이 모두 0이 아닌 영역을 공통 영역으로써 추출할 수 있다. 공통 영역은 하기 수학식 7로 정의될 수 있다. [수학식 7]"}
{"patent_id": "10-2022-0169769", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 7, "content": "여기서, S는 공통 영역으로써 두 개의 어텐션 맵이 모두 0이 아닌 픽셀 값들의 집합을 의미할 수 있다. IES 선택기는 공통 영역에 대하여, 두 개의 어텐션 맵 간 유사도를 하기 수학식 8에 기초하여 계산할 수 있다. [수학식 8]"}
{"patent_id": "10-2022-0169769", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 8, "content": "여기서, SIM()은 두 개의 어텐션 맵 간 유사도 값, s는 두 개의 어텐션 맵 중 픽셀 값이 0이 아닌 픽셀들의 집 합, area(S)는 공통 영역 S 내의 픽셀의 개수로 정의될 수 있다. IES 선택기는 계산한 유사도에 기초하여 어텐션 맵 쌍에 대한 비유사도를 계산할 수 있다. 예를 들어, IES 선택기는 하기 수학식 9에 기초하여 비유사도를 계산할 수 있다.[수학식 9]"}
{"patent_id": "10-2022-0169769", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 9, "content": "여기서, 는 어텐션 맵 쌍에 대한 비유사도 값으로 정의될 수 있다. 결국, IES 선택기는 어텐션 맵 쌍으로부터 공통 영역을 추출하고, 공통 영역의 픽셀 값에 기초하여 어텐션 맵 쌍에 대한 비유사도를 계산할 수 있다. IES 선택기는 계산한 비유사도를 기 설정된 임계값과 비교할 수 있다. 만약, 비유사도가 기 설정된 임계값 을 초과할 경우, 해당 비유사도가 계산된 어텐션 맵 쌍에 비일관성이 발생한 것으로 판단하여 해당 어텐션 맵 쌍을 재학습용 입력 데이터로써 선별할 수 있다. IES 선택기는 L개의 모든 어텐션 맵에 대하여 상술 한 실시예들에 따라 비일관성이 발생한 것으로 판단된 어텐션 맵 쌍을 선별하여 재학습용 입력 데이터를 구성할 수 있다. 개의 재학습용 입력 데이터는 로 정의될 수 있다. 상술한 재학습용 입력 데이터를 구성하는 일련의 실시예들은, 능동 학습(active learning)으로 정의될 수도 있다. 재학습용 입력 데이터는 약한 감독 훈련기로 전달될 수 있다. 약한 감독 훈련기는 재학습용 입력 데이터를 학습 데이터로 하고, 재학습을 위해 정의된 재학습용 손 실함수에 따라 제1 인공지능 모델 및 제2 인공지능 모델을 학습시킬 수 있다. 약한 감독 훈련기(23 0)가 학습시키는 제1 인공지능 모델 및 제2 인공지능 모델은 상술한 실시예들에 따른 위성 노드 및 전자 장치의 제1 인공지능 모델 및 제2 인공지능 모델과 동일한 구조를 갖는다. 재학습을 위한 재학습용 손실 함수는 복수의 어텐션 맵(1202, 1204, 1206)에 대한 라벨링 스코어에 기초하 여 정의될 수 있다. 예시적으로, 도 11은 감독관(supervisor)을 통해 복수의 어텐션 맵(1202, 1204, 1206)에 대한 라벨링이 수행되는 것으로 도시되었으나, 이에 제한되지는 않는다. 예를 들어, 도 11과 같이 감독관에 의 해 라벨링될 경우, 각 어텐션 맵은 '정답' 또는 '오답' 중 하나로 라벨링될 수 있다. 만약 복수의 감독관이 존 재할 경우, 입력 데이터(IN)의 i번째 어텐션 맵에 대하여 과반수의 감독관이 '정답'으로 라벨링한 경우 라벨링 스코어 는 1일 수 있고, '오답'으로 라벨링한 경우 라벨링 스코어 는 0일 수 있다. 또는, 도 11과 달리 라벨링은 별도의 라벨링 알고리즘이나, 또는 라벨링을 위한 다른 인공지능 모델을 통해 수 행될 수도 있을 것이다. 지상 노드는 라벨링 스코어를 다른 지상 노드로부터 수신할 수 있다. 어텐션 맵은 라벨링 스코어에 기초하여 정규화될 수 있다. 예를 들어, 어텐션 맵은 하기 수학식 10에 기초하여 정규화될 수 있다. [수학식 10]"}
{"patent_id": "10-2022-0169769", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 10, "content": "여기서, Q는 '오답'으로 라벨링된 어텐션 맵의 개수로 정의될 수 있다. 정의에서 알 수 있듯이, 수학식 10은 유 클리디안 거리(Euclidean distance)를 기반으로 할 수 있다. 재학습용 손실 함수는 재학습용 입력 데이터와 수학식 10으로 정의되는 정규화 텀에 기초하여 하기 수학식 11로 정의될 수 있다.[수학식 11]"}
{"patent_id": "10-2022-0169769", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 11, "content": "여기서, 는 재학습용 손실 함수, 는 위성 노드 측에서 정의된 손실 함수(예를 들 어, 수학식 2), α는 가중치로 정의될 수 있다. 약한 감독 훈련기는 새로이 정의된 재학습용 손실 함수에 기초하여 제1 인공지능 모델 및 제2 인공지 능 모델을 재학습시킬 수 있다. 따라서, 약한 감독 훈련기는 '정답'으로 라벨링된 어텐션 맵이 가르키는 중요 영역에 더욱 집중하도록 모델 파라미터를 재학습시킬 수 있다. 약한 감독 훈련기는 재학습에 따른 제1 인공지능 모델 및 제2 인공지능 모델의 모델 파라미터 를 획득하고, 위성 노드에 전달할 수 있다. 이에 따라, 위성 노드는 전달받은 모델 파라미터로 제1 인 공지능 모델 및 제2 인공지능 모델을 업데이트할 수 있다. 상술한 실시예들에 따르면, 본 발명의 위성 시스템은 라벨링 작업이 특정 영역이 강조된 어텐션 맵에 대하여 수 행될 수 있으므로, 판독관의 라벨링 비용이 최소화될 수 있다. 또한, 본 발명의 지상 노드는 능동 학습 을 통해 비일관성을 갖는 것으로 판단된 재학습용 입력 데이터를 따로 선별함으로써 부정확한 시각적 설명 을 갖는 데이터는 재학습에서 배제될 수 있다. 또한, 이러한 재학습용 입력 데이터와 새로이 정의된 재학 습용 손실 함수에 기초하여 위성 노드와 동일한 인공지능 모델을 재학습시킴으로써 위성 노드의 인공지능 모델의 성능을 업데이트시킬 수 있다. 도 13은 본 발명의 일 실시예에 따른 지상 노드의 동작 방법의 순서도이다. 도 13을 참조하면, S2010 단계에서, 지상 노드는 복수의 어텐션 맵(1202, 1204, 1206)을 위성 노드로 부터 수신할 수 있다. S2020 단계에서, 지상 노드는 복수의 어텐션 맵(1202, 1204, 1206) 중 어텐션 맵 쌍을 선택할 수 있다. S2030 단계에서, 지상 노드는 어텐션 맵 쌍으로부터 공통 영역을 선별할 수 있다. 예를 들어, 지상 노드 는 어텐션 맵 쌍에 포함된 픽셀들 중 픽셀 값이 0이 아닌 픽셀을 공통 영역으로써 선별할 수 있다. S2040 단계에서, 지상 노드는 공통 영역의 픽셀 값에 기초하여 어텐션 맵 쌍에 대한 비유사도를 계산할 수 있다. S2050 단계에서, 지상 노드는 비유사도가 기 설정된 임계값을 초과하는지 여부를 판단할 수 있다. S2060 단계에서, 지상 노드는 만약 어텐션 맵 쌍의 비유사도가 기 설정된 임계값을 초과할 경우 어텐션 맵 쌍을 재학습용 입력 데이터에 포함시킬 수 있다. S2070 단계에서, 지상 노드는 만약 어텐션 맵 쌍의 비유사도가 기 설정된 임계값 이하일 경우, 현재 선택된 어텐션 맵 쌍 외 다른 어텐션 맵 쌍이 존재하는지 여부를 판단할 수 있다. 만약 다른 어텐션 맵 쌍이 존재할 경 우, 지상 노드는 S2020 단계 내지 S2060 단계를 반복적으로 수행할 수 있다. S2080 단계에서, 지상 노드는 만약 다른 어텐션 맵 쌍이 존재하지 않을 경우, 어텐션 맵에 대한 라벨링 스 코어를 수신할 수 있다. S2090 단계에서, 지상 노드는 라벨링 스코어에 기초하여 새로이 정의된 재학습용 손실 함수에 기초하 여 재학습용 입력 데이터를 입력으로 하여 제1 인공지능 모델 및 제2 인공지능 모델을 재학습시킬 수 있다. S2100 단계에서, 지상 노드는 재학습에 따라 획득한 모델 파라미터를 위성 노드에 업데이트할 수 있다. 상술한 내용은 본 발명을 실시하기 위한 구체적인 실시 예들이다. 본 발명은 상술한 실시 예들 이외에도, 단순 하게 설계 변경되거나 용이하게 변경할 수 있는 실시 예들도 포함될 것이다. 또한, 본 발명은 실시 예들을 이용하여 용이하게 변형하여 실시할 수 있는 기술들도 포함될 것이다. 따라서, 본 발명의 범위는 상술한 실시 예들 에 국한되어 정해져서는 안되며, 후술하는 특허청구범위뿐만 아니라 이 발명의 특허청구범위와 균등한 것들에 의해 정해져야 할 것이다."}
{"patent_id": "10-2022-0169769", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 일 실시예에 따른 전자 장치의 동작 방법을 나타낸 것이다. 도 2는 본 발명의 일 실시예에 따른 전자 장치의 보다 구체적인 동작 방법을 나타낸 것이다. 도 3은 본 발명의 일 실시예에 따른 지역 어텐션 블록을 도시한 것이다. 도 4는 본 발명의 일 실시예에 따른 지역 어텐션 블록을 도시한 것이다. 도 5는 본 발명의 다른 일 실시예에 따른 지역 어텐션 블록을 도시한 것이다. 도 6은 본 발명의 일 실시예에 따른 특징 정제 동작을 나타낸 것이다. 도 7은 본 발명의 일 실시예에 따른 전자 장치의 동작 방법의 순서도이다. 도 8은 본 발명의 일 실시예에 따른 가중치 벡터 동작의 순서도이다. 도 9는 본 발명의 일 실시예에 따른 어텐션 맵 생성 동작의 순서도이다. 도 10은 본 발명의 일 실시예에 따른 전자 장치를 도시한 것이다. 도 11은 본 발명의 일 실시예에 따른 위성 시스템을 도시한 것이다. 도 12는 본 발명의 일 실시예에 따른 지상 노드의 동작을 나타낸 것이다. 도 13은 본 발명의 일 실시예에 따른 지상 노드의 동작 방법의 순서도이다."}
