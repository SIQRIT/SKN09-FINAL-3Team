{"patent_id": "10-2021-0145167", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2023-0060686", "출원번호": "10-2021-0145167", "발명의 명칭": "인공지능을 기반으로 한 폐암 환자의 생존 예측 시스템", "출원인": "전남대학교산학협력단", "발명자": "김민수"}}
{"patent_id": "10-2021-0145167", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "인공신경망을 이용한 비소세포폐암 환자들의 생존 예측 시스템에 있어서,임상데이터와 PET 이미지 데이터를 수신하는 데이터 수신부;임상데이터를 인공신경망에 입력되기 위한 데이터로 변환하는 임상데이터 변환부;PET 이미지 데이터에서 폐암의 특징을 학습된 제 1 인공신경망을 이용하여 추출하고, 추출된 폐암의 특징과 상기 임상데이터 변환부에서 변환된 데이터를 학습된 제 2 인공신경망에 입력하여 환자의 위험률을 출력하는 위험률 추정부를 포함하여, 출력된 위험률에 따른 비소세포폐암 환자의 기대수명과 생존 기간에 따른 생존율을 포함하는 예후 분석을 제공하는 것을 특징으로 하는 생존 예측 시스템."}
{"patent_id": "10-2021-0145167", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제 1 항에 있어서,상기 임상데이터 변환부는,임상데이터를 이산형 변수와 연속형 변수로 구분하여,이산형 변수는 바이너리 변수로 변환하고, 연속형 변수는 표준화하여 평균은 0, 분산은 1이 되도록 변환하는 것을 특징으로 하는 생존 예측 시스템."}
{"patent_id": "10-2021-0145167", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제 1 항에 있어서,상기 위험률 추정부는,제 1 인공신경망을 CNN(Convolution Neural Network)으로 하는 것을 특징으로 하는 생존 예측 시스템."}
{"patent_id": "10-2021-0145167", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제 1 항에 있어서,제 2 인공신경망을 MLP(Multi-Layer Perception)으로 하는 것을 특징으로 하는 생존 예측 시스템."}
{"patent_id": "10-2021-0145167", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제 1 항에 있어서,상기 위험률 추정부는,PET 이미지 데이터의 크기를 일정하게 변환시키는 패딩 모듈; 및상기 패딩 모듈에서 변환된 PET 이미지 데이터가 0 내지 255 값을 갖도록 변환시키는 표준화 모듈을 포함하는것을 특징으로 하는 생존 예측 시스템. 공개특허 10-2023-0060686-3-청구항 6 제 5 항에 있어서, 상기 위험률 추정부는,상기 표준화 모듈에서 변환된 PET 이미지 데이터를 관상면과 수직인 값 중 최댓값을 갖는 픽셀로 관상면에 투영하여 2D 이미지 데이터로 변환하는 MIP 변환 모듈을 더 포함하는 것을 특징으로 하는 생존 예측 시스템."}
{"patent_id": "10-2021-0145167", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제 6 항에 있어서,상기 위험률 추정부는,상기 MIP 변환 모듈이 PET 이미지 데이터를 관상면으로 투영할 때 PET 이미지 데이터를 회전시키는 회전 모듈을더 포함하는 것을 특징으로 하는 생존 예측 시스템."}
{"patent_id": "10-2021-0145167", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제 1 항에 있어서,2D 이미지로 변환시키는 MIP 변환이 적용된 폐암 환자의 PET 이미지 데이터를 입력값으로 하고 폐암의 특징을출력값으로 하여 제 1 인공신경망을 학습시키는 제 1 학습부를 더 포함하는 것을 특징으로 하는 생존 예측 시스템."}
{"patent_id": "10-2021-0145167", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제 1 항에 있어서, 상기 임상데이터 변환부에서 변환된 데이터와 상기 위험률 추정부에서 추출된 폐암 특징을 입력값으로 하고 위험률을 출력값으로 하여 제 2 인공신경망을 학습시키는 제 2 학습부를 더 포함하는 것을 특징으로 하는 생존 예측 시스템."}
{"patent_id": "10-2021-0145167", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은, 인공신경망을 이용한 비소세포폐암 환자들의 생존 예측 시스템에 있어서, 임상데이터와 PET 이미지 데이터를 수신하는 데이터 수신부; 임상데이터를 인공신경망에 입력되기 위한 데이터로 변환하는 임상데이터 변 환부; PET 이미지 데이터에서 폐암의 특징을 학습된 제 1 인공신경망을 이용하여 추출하고, 추출된 폐암의 특징 과 상기 임상데이터 변환부에서 변환된 데이터를 학습된 제 2 인공신경망에 입력하여 환자의 위험률을 출력하는 위험률 추정부를 포함하여, 출력된 위험률에 따른 비소세포폐암 환자의 기대수명과 생존 기간에 따른 생존율을 포함하는 예후 분석을 제공하는 것을 일 특징으로 한다."}
{"patent_id": "10-2021-0145167", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 폐암 환자의 생존 예측 시스템에 관한 것으로서, 특히 폐암 환자의 임상데이터와 PET 이미지 데이터 로 학습된 인공신경망을 통해 환자의 위험률을 도출하는 폐암 환자의 생존 예측 시스템에 관한 것이다."}
{"patent_id": "10-2021-0145167", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "폐암은 전 세계적으로 남녀 모두에게 가장 많이 진단되는 암으로 전체 암 진단의 11.6%를 차지한다. 사망률 또 한 18.4%로 가장 높으며 전체 폐암 중 비소세포폐암(NSCLC)이 85%를 차지하고 있다. 그리고 폐암은 다른 암과 달리 초기에 증상이 발현되지 않고, 마른기침과 가슴 통증 등 몇 가지 증상이 발현된 후에는 이미 후기로 변화 되므로 치료가 쉽지 않다. 그리고 1기에서 4기로의 병기 변화는 1년이 걸리지 않을 정도로 전이 속도 또한 빠르 다. 도 1은 폐암 환자의 위험률을 분석하는 종래의 생존 예측 시스템을 나타낸다. 도 1을 참조하면, 종래의 생존 예측 시스템은 폐암의 진단 및 예후를 분석하기 위하여 전문가 그룹인 흉부외과 의사, 흉부 방사선과 전문의, 호흡기내과 전문의들이 모여서 폐암을 진단하고, AJCC(American Joint Committee on Cancer)의 기준에 따라 각 각의 병기를 통해 환자에게 맞는 치료를 진행한다. 하지만 이 과정은 많은 시간이 소모되며, 환자의 개인 특성 및 병기 데이터만을 이용한 다양한 연구들은 종양의 위치, 모양, 개수 등의 세부적인 정보들이 누락되어 생존분석의 정확도를 향상시키기에 어려움이 많다. 또한 기존의 연구들은 CPH(Cox Proportion Hazard) 모형을 활용 한 선형적인 분석만을 수행하고 변수들 사이의 관계를 반영하기 어려운 한계도 있다. 인공지능을 사용한 모형은 모형의 확장성과 자료에 대한 적합한 구조 변환이 있다. 현재 인공지능 기술의 발전 으로 선형 구조를 벗어나 더 복잡한 구조를 반영할 수 있도록 생존 분석을 위한 인공지능 모형들이 개발되었다. 또한, 대표적인 모형 중 CNN(Convolution Neural Network)은 특히 이미지 분석 분야에서의 특징 추출에서 큰 성 과를 보이므로 종양을 찾아내서 해당 특성을 반영할 수 있다. PET(Positron Emission Tomography) 이미지는 방사성 동위원소로 표지된 추적자를 이용하여 질병 상태를 반정량 적으로 시각화하고 측정할 수 있는 기능적 영상 기술이다. 폐암의 진단에서 가장 중요하게 사용되는 영상학적 자료인 PET 이미지는 환자의 전신에 대한 종양 정보를 담고 있다. 그러나 예후를 예측하기 위해 PET 영상에서 암의 특징을 추출하는 것은 전문가의 전문적인 지식이 필요하고 시간이 많이 소요된다. 이러한 한계를 극복하기 위해 CNN의 이용이 연구되고 있지만, 각 환자의 전신 PET에서 수백 개의 이미지를 이용하여 예후를 예측하기 위 해서는 상당한 양의 컴퓨팅 리소스와 시간이 필요하다. 따라서 PET 이미지를 분석에서 요구되는 컴퓨팅 리소스와 시간을 줄이고, 인공신경망을 이용하여 PET 이미지 데이터에서 생존 기간과 관련된 특징을 추출한 뒤 환자들의 병기 및 개별 특성 정보와의 결합을 통한 멀티모델 구조로 기존보다 더 정확한 예후를 예측할 수 있는 생존 예측 시스템이 요구된다. 선행기술문헌 특허문헌"}
{"patent_id": "10-2021-0145167", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은 임상데이터와 PET 이미지 데이터로 인공신경망을 이용하여 폐암 환자의 위험률을 추정하는 생존 예측 시스템을 제공하는 것을 일 목적으로 한다. 또한, 본 발명은 3D PET 이미지를 2D PET 이미지로 변환하여 PET 이미지 데이터 분석에 걸리는 시간을 단축시킬 수 있는 생존 예측 시스템을 제공하는 것을 다른 목적으로 한다."}
{"patent_id": "10-2021-0145167", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "상기 목적을 달성하기 위하여 본 발명은, 인공신경망을 이용한 비소세포폐암 환자들의 생존 예측 시스템에 있어 서, 임상데이터와 PET 이미지 데이터를 수신하는 데이터 수신부; 임상데이터를 인공신경망에 입력되기 위한 데 이터로 변환하는 임상데이터 변환부; PET 이미지 데이터에서 폐암의 특징을 학습된 제 1 인공신경망을 이용하여 추출하고, 추출된 폐암의 특징과 상기 임상데이터 변환부에서 변환된 데이터를 학습된 제 2 인공신경망에 입력 하여 환자의 위험률을 출력하는 위험률 추정부를 포함하여, 출력된 위험률에 따른 비소세포폐암 환자의 기대수 명과 생존 기간에 따른 생존율을 포함하는 예후 분석을 제공하는 것을 일 특징으로 한다. 바람직하게는, 상기 임상데이터 변환부는, 임상데이터를 이산형 변수와 연속형 변수로 구분하여, 이산형 변수는 바이너리 변수로 변환하고, 연속형 변수는 표준화하여 평균은 0, 분산은 1이 되도록 변환할 수 있다. 바람직하게는, 상기 위험률 추정부는, 제 1 인공신경망을 CNN(Convolution Neural Network)으로 할 수 있다. 바람직하게는, 제 2 인공신경망을 MLP(Multi-Layer Perception)으로 할 수 있다. 바람직하게는, 상기 위험률 추정부는, PET 이미지 데이터의 크기를 일정하게 변환시키는 패딩 모듈; 및 상기 패 딩 모듈에서 변환된 PET 이미지 데이터가 0 내지 255 값을 갖도록 변환시키는 표준화 모듈을 포함할 수 있다. 바람직하게는, 상기 위험률 추정부는, 상기 표준화 모듈에서 변환된 PET 이미지 데이터를 관상면과 수직인 값 중 최댓값을 갖는 픽셀로 관상면에 투영하여 2D 이미지 데이터로 변환하는 MIP 변환 모듈을 더 포함할 수 있다. 바람직하게는, 상기 위험률 추정부는, 상기 MIP 변환 모듈이 PET 이미지 데이터를 관상면으로 투영할 때 PET 이 미지 데이터를 회전시키는 회전 모듈을 더 포함할 수 있다. 바람직하게는, 2D 이미지로 변환시키는 MIP 변환이 적용된 폐암 환자의 PET 이미지 데이터를 입력값으로 하고 폐암의 특징을 출력값으로 하여 제 1 인공신경망을 학습시키는 제 1 학습부를 더 포함할 수 있다. 바람직하게는, 상기 임상데이터 변환부에서 변환된 데이터와 상기 위험률 추정부에서 추출된 폐암 특징을 입력 값으로 하고 위험률을 출력값으로 하여 제 2 인공신경망을 학습시키는 제 2 학습부를 더 포함할 수 있다."}
{"patent_id": "10-2021-0145167", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명에 따르면, 위험률 추정부에서 임상데이터와 PET 이미지 데이터를 인공신경망에 입력하여 폐암 환자의 위험률을 추정하므로 정확한 예후를 측정할 수 있다는 이점이 있다. 또한 본 발명은, 위험률 추정부에서 3D PET 이미지를 2D PET 이미지로 변환하므로 생존 예측 시스템의 연산량을 감소시켜 위험률 도출에 소요되는 시간을 단축할 수 있는 이점이 있다."}
{"patent_id": "10-2021-0145167", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하, 첨부된 도면들에 기재된 내용들을 참조하여 본 발명을 상세히 설명한다. 다만, 본 발명이 예시적 실시 예 들에 의해 제한되거나 한정되는 것은 아니다. 각 도면에 제시된 동일 참조부호는 실질적으로 동일한 기능을 수 행하는 부재를 나타낸다. 본 발명의 목적 및 효과는 하기의 설명에 의해서 자연스럽게 이해되거나 보다 분명해 질 수 있으며, 하기의 기 재만으로 본 발명의 목적 및 효과가 제한되는 것은 아니다. 또한, 본 발명을 설명함에 있어서 본 발명과 관련된 공지 기술에 대한 구체적인 설명이, 본 발명의 요지를 불필요하게 흐릴 수 있다고 판단되는 경우에는 그 상세한 설명을 생략하기로 한다. 도 2는 본 발명의 실시예에 따른 생존 예측 시스템의 구성도를 나타낸다. 도 2를 참조하면, 생존 예측 시스 템은 사용자 단말기 및 서버를 포함할 수 있다. 도 3은 본 발명의 실시예에 따른 생존 예측 시스템의 세부 구성도를 나타낸다. 도 3을 참조하면, 생존 예측 시 스템의 사용자 단말기는 데이터 수신부, 임상데이터 변환부, 및 위험률 추정부를 포함할 수 있다. 생존 예측 시스템의 서버는 제 1 학습부, 제 2 학습부, 및 정보저장부를 포함할 수 있다. 생존 예측 시스템은 인공신경망을 이용하여 비소세포폐암 환자들의 생존을 예측할 수 있다. 생존 예측 시스 템은 환자의 특성이 반영된 임상데이터 및 PET 이미지 데이터를 모두 고려하여 폐암 환자의 위험률을 자동으 로 추정할 수 있다. 생존 예측 시스템은 폐암 환자의 위험률을 추정하여 환자의 기대수명과 생존 기간에 따 른 생존율를 포함하는 예후 분석을 제공할 수 있다. 생존 예측 시스템은 개별 환자들에 대한 위험률을 추정 한 뒤 환자들의 상대적 위험률 순서에 따른 생존 분포를 통해 개별 예후를 상세하게 비교 분석할 수 있는 자료 를 제공할 수 있다. 생존 예측 시스템은 개별 환자들에 대한 생존 분포를 추정하기 때문에 생존 기간에 대한 정보뿐만 아니라, 각 시간에 대한 생존 확률의 계산을 용이하게 할 수 있다. 생존 예측 시스템은 잔여 수명 및 생존 그룹을 구 분할 수 있으므로 다양한 방식으로 환자들의 예후를 제공할 수 있다. 생존 예측 시스템은 PET 이미지 데이터에서 폐암의 특징을 추출하기 위해 다양한 폐암 환자들의 PET 이미지 데이터로 구성된 학습용 데이터로 인공신경망을 학습시킬 수 있다. 생존 예측 시스템은 폐암 환자의 위험률 을 추정하기 위해 폐암 환자의 임상데이터와 PET 이미지 데이터에서 추출한 폐암의 특징으로 구성된 학습용 데 이터로 인공신경망을 학습시킬 수 있다. 도 4는 본 발명의 실시예에 따른 생존 예측 시스템의 위험률 도출 프로세스를 나타낸다. 도 4를 참조하면, 생존 예측 시스템은 3가지 프로세스를 통하여 폐암 환자의 위험률 분석을 수행할 수 있다. 생존 예측 시스템 의 첫 번째 프로세스는 임상데이터에 대한 프로세스가 될 수 있다. 생존 예측 시스템은 의료 분야 전문가 집단에 의해 분류된 병기 데이터 및 종양에 대한 정보와 성별, 연령, 흡연 여부와 같은 환자 개인 정보들을 종 합한 임상 데이터를 변환하여 인공신경망의 입력 변수로 할 수 있다. 생존 예측 시스템의 첫 번째 프로세스 는 아래에서 설명할 임상데이터 변환부에서 수행될 수 있다. 생존 예측 시스템의 두 번째 프로세스는 환자의 전신에 대한 PET 이미지 데이터를 제 1 인공신경망에서 분석 할 수 있는 상태로 변환하는 프로세스가 될 수 있다. 생존 예측 시스템은 최종적으로 3D PET 이미지를 2D 이 미지로 변환할 수 있다. 또한, 생존 예측 시스템은 여러 각도의 PET 이미지를 분석에 활용할 수 있다. 생존 예측 시스템의 세 번째 프로세스는 변환된 임상데이터와 추출된 폐암 특징을 제 2 인공신경망에 연결하 여 해당 환자에 대한 위험률(Hazard ratio)를 추정하는 프로세스가 될 수 있다. 사용자 단말기는 네트워크를 통해 데이터를 송수신할 수 있는 단말기로서, 스마트폰, 노트북, PC 등을 포함 할 수 있다. 이때, 사용자 단말기는 서버와 무선 또는 유선 네트워크로 연결될 수 있다. 서버는 제 1 인공신경망 또는 제 2 인공신경망의 학습을 위해 대량의 연산이 가능하도록 구성될 수 있다. 서버는 사용자 단말기와 유선 또는 무선 네트워크로 연결될 수 있다. 데이터 수신부는 임상데이터와 PET 이미지 데이터를 수신할 수 있다. 데이터 수신부는 임상데이터를 수신하여 임상데이터 변환부로 전송할 수 있다. 데이터 수신부는 PET 이미지 데이터를 수신하여 위험 률 추정부로 전송할 수 있다. 임상데이터 변환부는 임상데이터를 인공신경망에 입력되기 위한 데이터로 변환할 수 있다. 환자의 임상데 이터는 환자 코드(아이디), 성별, 나이, 흡연 여부, T/N/M 병기, 최종병기, 생존일수, 중도절단 등을 포함할 수 있다. 암에서 병기란 암의 진행이 얼마나 됐느냐를 알 수 있는 척도이다. 일반적으로 병기가 높을수록 암이 더 진행된 것이며 예후(미리 예측되는 결과)가 좋지 않다. 암을 병기로 나누는 이유는 재발 위험이나 완치 확률이 병기에 따라 달라지기 때문이다. T/N/M 병기란 AJCC의 기준에 따라 종양의 병기를 결정하는 한 방법으로 질병의 진행 정도를 나타낸다. T/N/M 병기 체계에서는 원발 종양의 해부학적 범위, 국소 림프절 전이 여부, 원격 전이 여부 에 따라 종양의 병기를 구분한다. T는 원발암이 생긴 장기에서 종양의 크기와 침윤 정도를 나타낸다. N은 원발 암이 생긴 장기에서 국소 림프절에 대한 침범 여부를 나타낸다. M은 국소 림프절 침범을 넘어 혈관이나 림프관 을 통해 타 장기에 전이된 여부를 나타낸다. 도 5는 본 발명의 실시예에 따른 임상데이터 변환부의 데이터 변환 프로세스를 나타낸다. 도 5를 참조하면, 임상데이터 변환부는 임상데이터를 이산형 변수와 연속형 변수로 구분하여, 이산형 변수는 바이 너리 변수로 변환하고, 연속형 변수는 표준화하여 평균은 0, 분산은 1이 되도록 변환할 수 있다. 임상데이터 변환부는 환자의 임상데이터를 T/N/M 병기, 성별, 흡연 여부 등의 이산형 변수와 연령, 흡연량 등의 연속형 변수로 구분할 수 있다. 임상데이터 변환부는 이산형 변수를 원핫 인코딩(One-hot encoding) 방법으로 k개의 항목을 가지고 있는 이산형 변수를 3개의 바이너리 변수(Binary variable)로 변환할 수 있다. 임상데이터 변환부는 연속형 변수가 해당 변수의 단위 및 기준값에 따라 의미가 달라질 수 있는 문제를 해 결하기 위해 표준화를 사용할 수 있다. 임상데이터 변환부는 연속형 변수의 표준화를 통해 모든 연속형 변 수가 평균은 0, 분산은 1의 값으로 일정한 범위를 가질 수 있도록 할 수 있다. 위험률 추정부는 PET 이미지 데이터에서 폐암의 특징을 학습된 제 1 인공신경망을 이용하여 추출하고, 추 출된 폐암의 특징과 상기 임상데이터 변환부에서 변환된 데이터를 학습된 제 2 인공신경망에 입력하여 환자의 위험률을 출력할 수 있다. PET 이미지 데이터는 약 220장에서 427장으로 구성되며, 각각은 128*128 크기의 1개의 채널을 갖는 흑백 이미지 이다. 전신 PET 이미지 데이터의 처음 시작은 머리끝으로 0번부터 시작하며, 가장 아래 번호는 환자마다 다르다. 도 6은 본 발명의 실시예에 따른 위험률 추정부에서 추정된 위험률을 활용하여 기대수명과 생존 기간 등 상세한 예후 분석을 수행하는 프로세스를 나타낸다. 도 6을 참조하면, 위험률 추정부는 환자의 임상데이터 와 PET 이미지 데이터를 모두 고려하여 출력된 위험률을 사용하여 생존함수를 생성할 수 있다. 위험률 추정부 가 생성한 생존함수에서 환자의 기대수명과 생존 기간 등의 예후에 대한 정보를 추정할 수 있으므로 환자 에게 맞는 처리 및 치료를 수행할 수 있는 자료를 제공할 수 있다는 이점이 있다. 위험률 추정부는 2개의 인공신경망을 이용할 수 있다. 위험률 추정부는 PET 이미지 데이터에서 폐암 의 특징을 추출하는 역할을 하는 제 1 인공신경망을 이용할 수 있다. 위험률 추정부는 임상데이터 변환부 에서 변환된 데이터와 PET 이미지 데이터에서 추출된 폐암의 특징을 분석하여 위험률을 추출하는 역할을 하는 제 2 인공신경망을 이용할 수 있다. 위험률 추정부는 위험률 추출에 사용되는 입력값으로 변환된 임상데이터와 PET 이미지 데이터에서 추출된 폐암의 특징을 사용할 수 있다. 즉, 위험률 추정부는 기존에는 인공신경망의 입력값으로 PET 이미지 데이 터만 사용하는 것과 달리 임상데이터도 포함하므로 정확한 위험률을 추출할 수 있다. 또한, 위험률 추정부(30 0)는 PET 이미지 데이터를 2D로 변환하여 폐암의 특징을 추출하므로 인공신경망의 연산 속도를 증가시킬 수 있 다. 위험률 추정부는 제 1 인공신경망을 CNN(Convolution Neural Network)으로 할 수 있다. 제 1 인공신경망 은 Convolution, Pooling, Fully-connecte Layer로 구성될 수 있다. 제 1 인공신경망은 비정형 데이터인 PET 이미지 데이터에서 주요 폐암 특징을 추출하기 위해서, 모든 이미지에 동일한 CNN 모형을 활용하여 상위 특징(High-Level feature)을 추출하는 임베딩(Embedding) 과정을 수행할 수 있다. 제 1 인공신경망은 각각의 회전 각도에 따라 순차적인 특성을 가진 폐암의 특징을 추출할 수 있으므로 순 서를 기억할 수 있는 인공신경망 모델일 수 있다. 본 발명에 따른 실시예로 제 1 인공신경망은 자연어 처리 (NLP)에서 주로 사용되는 모형인 Transformer 중 인코더(Encoder)가 될 수 있다. 위험률 추정부는 제 2 인공신경망을 MLP(Multi-Layer Perception)으로 할 수 있다. 본 발명의 실시예로, 제 2 인공신경망은 생존 분석을 위한 인공신경망 모형으로 콕스 비례 위험 모형에 사용되는 콕스 로스(Cox loss) 모델이 될 수 있다. 도 7은 본 발명의 실시예에 따른 위험률 추정부의 구성도를 나타낸다. 도 7을 참조하면, 위험률 추정부 는 패딩 모듈, 표준화 모듈, MIP 변환 모듈, 및 회전 모듈을 포함할 수 있다. 도 8은 본 발명의 실시예에 따른 위험률 추정부의 PET 이미지 데이터 변환 프로세스를 나타낸다. 도 8을 참조하면, 위험률 추정부는 PET 이미지 데이터를 제 1 인공신경망에 입력되기 위한 데이터로 변환하기 위 해 3단계의 전처리 과정을 거칠 수 있다. 첫 번째로, 위험률 추정부는 PET 이미지 데이터를 동일한 길이로 패딩하고 표준화할 수 있다. 두 번째로, 위험률 추정부는 PET 이미지 데이터를 관상면으로 투영할 수 있다. 세 번째로, 위험률 추정부는 이미지를 회전시키며 관상면으로 투영할 수 있다. 위와 같은 단계는 패 딩 모듈, 표준화 모듈, MIP 변환 모듈, 및 회전 모듈이 수행할 수 있고 아래에서 자세히 살펴본다. 도 9는 본 발명의 실시예에 따른 패딩 모듈의 기능을 설명하기 위한 도면을 나타낸다. 도 9를 참조하면, 패딩 모듈은 PET 이미지 데이터의 크기를 일정하게 변환시킬 수 있다. 패딩 모듈은 환자에 대한 전신 PET 이미지 데이터는 환자의 키(height)에 따라 서로 다른 값을 가질 수 있으므로 크기를 일정하게 변환시킬 수 있다. 패딩 모듈은 PET 이미지 데이터를 패딩(padding) 방법을 통해 모두 동일한 크기로 변환할 수 있다. 표준화 모듈은 패딩 모듈에서 변환된 PET 이미지 데이터가 0 내지 255 값을 갖도록 변환시킬 수 있다. 표준화 모듈은 PET 이미지 데이터를 실제로 많이 사용되는 0 내지 255 값을 갖는 정수형 자료로 변 환하기 위해 최소-최대 변환(Min-max scaling) 방법을 사용할 수 있다. MIP 변환 모듈은 표준화 모듈에서 변환된 PET 이미지 데이터를 관상면과 수직인 값 중 최댓값을 갖는 픽셀로 관상면에 투영하여 2D 이미지 데이터로 변환할 수 있다. MIP 변환 모듈은 전신의 PET 이미지 데이 터를 관상면에 정면으로 투영하므로 깊이 및 겹치는 부분에 대한 정보의 손실을 발생시킬 수 있다. 이를 해결하 기 위해, MIP 변환 모듈은 PET 이미지 데이터를 관상면에 투영시 회전 모듈을 이용하여 PET 이미지 데이터를 회전시킬 수 있다. MIP 변환 모듈은 종양의 경우 기존의 다른 조직에 비해 큰 값을 가지므로 더 축약시키더라도 큰 의미를 갖도록 변환할 수 있다는 장점이 있다. 도 10은 본 발명이 실시예에 따른 회전 모듈의 기능을 설명하기 위한 도면을 나타낸다. 도 10을 참조하면, 회전 모듈은 MIP 변환 모듈이 PET 이미지 데이터를 관상면으로 투영할 때 PET 이미지 데이터를 회전 시킬 수 있다. 회전 모듈은 관상면 정면에 대한 투영은 깊이 및 겹치는 부분에 대한 정보의 손실이 있을 수 있으므로 PET 이미지 데이터를 회전시켜 종양의 여러 시야(Multi-view)를 반영할 수 있다. 회전 모듈은 관상면의 회전으로 2D PET 이미지 데이터로 변환시키는 과정에서 데이터의 손실이 발생하고, 관상면과 수직인 픽셀 중 종양 정보가 겹치게 되는 경우 정확한 정보를 반영하기 어렵다는 문제를 해결할 수 있다. 제 1 학습부는 2D 이미지로 변환시키는 MIP 변환이 적용된 폐암 환자의 PET 이미지 데이터를 입력값으로 하고 폐암의 특징을 출력값으로 하여 제 1 인공신경망을 학습시킬 수 있다. 제 1 학습부는 서버에서 학습될 수 있다. 제 1 학습부는 정보저장부에 저장된 폐암 환자의 PET 이미지 데이터를 학습에 사용 할 수 있다. 제 2 학습부는 임상데이터 변환부에서 변환된 데이터와 상기 위험률 추정부에서 추출된 폐암 특징을 입력값으로 하고 환자의 위험률을 출력값으로 하여 제 2 인공신경망을 학습시킬 수 있다. 제 2 학습부는 서버에서 학습될 수 있다. 제 2 학습부는 정보저장부에 저장된 폐암 환자의 임상데이터와 추출된 폐암 특징을 학습에 사용할 수 있다. 정보저장부는 제 1 학습부를 학습시키기 위한 다수 폐암 환자의 PET 이미지 데이터를 저장할 수 있다. 정보저장부에 저장된 PET 이미지 데이터는 패딩, 스케일링, MIP 변환 등의 전처리 과정이 모두 완료 된 것일 수 있다. 정보저장부는 제 2 학습부를 학습시키기 위한 다수 폐암 환자의 임상데이터와 PET 이미지 데이터에서 추출한 폐암의 특징을 저장할 수 있다. 생존 예측 시스템은 위험률 평가지표인 C-index, 사망 환자에 대한 생존시간 예측의 정확도 평가지표인 MAE(Mean Absloute Error), 또는 t 시차에 대한 생존의 정확도를 평가하는 분류 정확도(Classification accuracy) 등의 다각적 평가를 통해 성능 및 정확도가 평가될 수 있다. 또한, 생존 예측 시스템은 위와 같은 평가를 통해 최적의 인공지능 모델이 도출될 수 있다. 생존 예측 시스템이 추출한 개별 위험률에 대한 상대적 평가를 통해 환자 개인의 해당 시기에 대한 생존확률 을 비교할 수 있다. 생존 예측 시스템의 위험률에 대한 평가는 C-index 지표를 사용하며 1.0에 가까울수록 위험률의 순서가 정확하다고 평가될 수 있다. 생존 예측 시스템이 분석한 해당 시기에 대한 생존확률을 생존 테이블로 표현할 수 있다. 생존 예측 시스템 은 잔여 수명 분석에 생존확률이 50% 미만으로 내려가는 시점을 기준으로 하는 MRL(Median Residual Life) 방법을 사용할 수 있다. 생존 예측 시스템이 추정한 잔여 수명은 실제 시간과의 차이를 비교하는 MAE 방법을 통해 오차가 최소화될 수 있다. 생존 예측 시스템이 분석한 해당 시간에 대한 생존 여부를 비교하기 위해 t시차에 대한 생존확률을 비교할 수 있다. 생존 예측 시스템이 분석한 해당 시점 생존확률의 정확도를 비교하기 위하여 분류 정확도를 사용할 수 있다. 분류 정확도는 1.0에 가까울수록 성능이 좋다고 평가될 수 있다. 도 11은 본 발명의 실시예에 따른 생존 예측 시스템의 성능 및 안정성을 평가한 데이터를 나타낸다. 도 11을 참조하면, 생존 예측 시스템은 성능 및 안정성을 평가하기 위하여 5 폴드 교차 검증(5-fold crossvalidation)을 사용하여 5개의 데이터 세트로 나누고, 예후 정확도의 평균적인 오차율 및 표준오차를 측정하였 다. 본 실시예에서는 생존 예측 시스템에 폐암 진단을 받고 사망 혹은 중도절단 된 화순전남대병원 2,687명 의 환자의 데이터를 입력하였다. 모든 지표에서 임상데이터를 활용한 기존 방법(CPH model) 보다 좋은 성능을 보였다. 최종적인 결과는 5개의 폴드에서 평균 420일의 오차를 보이며, C-index의 경우 0.752로 높은 성능을 보 였다. 또한, 5년 분류 정확도의 평균은 0.921로 5년 생존율에 대한 분류 정확도 또한 높은 성능을 보였다. 이상에서 대표적인 실시예를 통하여 본 발명을 상세하게 설명하였으나, 본 발명이 속하는 기술 분야에서 통상의 지식을 가진 자는 상술한 실시예에 대하여 본 발명의 범주에서 벗어나지 않는 한도 내에서 다양한 변형이 가능 함을 이해할 것이다. 그러므로 본 발명의 권리 범위는 설명한 실시예에 국한되어 정해져서는 안 되며, 후술하는 특허청구범위뿐만 아니라 특허청구범위와 균등 개념으로부터 도출되는 모든 변경 또는 변형된 형태에 의하여 정 해져야 한다."}
{"patent_id": "10-2021-0145167", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 폐암 환자의 위험률을 분석하는 종래의 생존 예측 시스템을 나타낸다. 도 2는 본 발명의 실시예에 따른 생존 예측 시스템의 구성도를 나타낸다. 도 3은 본 발명의 실시예에 따른 생존 예측 시스템의 세부 구성도를 나타낸다. 도 4는 본 발명의 실시예에 따른 생존 예측 시스템의 위험률 도출 프로세스를 나타낸다. 도 5는 본 발명의 실시예에 따른 임상데이터 변환부의 데이터 변환 프로세스를 나타낸다. 도 6은 본 발명의 실시예에 따른 위험률 추정부에서 추정된 위험률을 활용하여 기대수명과 생존 기간 등 상세한 예후 분석을 수행하는 프로세스를 타나낸다. 도 7은 본 발명의 실시예에 따른 위험률 추정부의 구성도를 나타낸다. 도 8은 본 발명의 실시예에 따른 위험률 추정부의 PET 이미지 데이터 변환 프로세스를 나타낸다. 도 9는 본 발명의 실시예에 따른 패딩 모듈의 기능을 설명하기 위한 도면을 나타낸다. 도 10은 본 발명의 실시예에 따른 회전 모듈의 기능을 설명하기 위한 도면을 나타낸다. 도 11은 본 발명의 실시예에 따른 생존 예측 시스템의 성능 및 안정성을 평가한 데이터를 나타낸다."}
