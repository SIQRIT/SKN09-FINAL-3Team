{"patent_id": "10-2022-0013513", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2023-0116500", "출원번호": "10-2022-0013513", "발명의 명칭": "인공신경망 기반 부정교합 분류 방법 및 부정교합 분류 애플리케이션", "출원인": "가천대학교 산학협력단", "발명자": "김행근"}}
{"patent_id": "10-2022-0013513", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "연산장치에 의해 수행되는 인공신경망 기반 부정교합 분류 방법에 있어서,(a) 상악과 하악의 치아가 스캔된 3D 모델 데이터를 전처리하여 정해진 시점의 2D 이미지 데이터를 얻기 위해상기 3D 모델 데이터를 정렬하는 리-오리엔테이션(Re-orientation) 단계;(b) 정렬된 상기 3D 모델 데이터에서 부정교합 분류를 위한 라벨을 설정하는 단계로, 원-핫 인코딩(one-hotencoding)으로 앵글 클래스(Angle’s classification)에 기반한 제1 라벨을 설정하고, 상기 제1 라벨에 상악과하악의 상대적 위치에 기반한 순서가 부여된 제2 라벨과, 교합된 상악과 하악의 치아 거리에 기반한 제3 라벨을설정하는 라벨링 단계; 및(c) 상기 제1 라벨에는 다중 분류에서 사용되는 제1 손실함수가 설정되고, 상기 제2 라벨과 상기 제3 라벨은 회귀(regression)의 제2 손실함수가 설정되어, 이종(異種)의 손실함수들에 가중치를 부여하여 다항식으로 조합한최종 손실함수를 갖고, 상기 최종 손실함수 기반으로 인공신경망 모델에 대해 정렬된 상기 3D 모델 데이터로부터 추출된 2D 교합 이미지의 앵글 클래스 분류를 학습하는 학습 단계;를 포함하여 학습을 수행하며,상기의 학습으로 추론 단계에서 상기 3D 모델 데이터의 입력시 앵글 클래스가 분류되고, 분류된 클래스의 정확도 관련 정량적 데이터가 산출 가능한 것을 특징으로 하는 인공신경망 기반 부정교합 분류 방법."}
{"patent_id": "10-2022-0013513", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제 1 항에 있어서,상기 (a)단계의 수행 이후,정렬된 상기 3D 모델 데이터로부터 정해진 시점의 2D 이미지들을 추출하여 2D 이미지의 조합으로 학습을 위한상기 2D 교합 이미지를 생성하는 단계를 더 포함하는 것을 특징으로 하는 인공신경망 기반 부정교합 분류 방법."}
{"patent_id": "10-2022-0013513", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제 1 항에 있어서,상기 (a)단계는,정렬된 상기 3D 모델 데이터로부터, 특정 각도(N개)에서 바라본 단면의 2D 이미지를 그레이 스케일로 변환하여상기 2D 교합 이미지를 생성하는 것을 특징으로 하는 인공신경망 기반 부정교합 분류 방법."}
{"patent_id": "10-2022-0013513", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제 1 항에 있어서,상기 (b)단계는,상기 제2 라벨이 상기 제1 라벨의 분류에서 상악과 하악의 상대적 위치를 연속변수로 지정한 데이터 값으로 표현하여 회귀(regression)라벨로 생성하는 것을 특징으로 하는 인공신경망 기반 부정교합 분류 방법."}
{"patent_id": "10-2022-0013513", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "공개특허 10-2023-0116500-3-제 1 항에 있어서, 상기 (b)단계는,상기 제3 라벨이 상기 3D 모델 데이터로부터, 상악 대구지와 하악 대구치의 특정 포인트의 거리를 픽셀 기반으로 수치화한 데이터인 것을 특징으로 하는 인공신경망 기반 부정교합 분류 방법."}
{"patent_id": "10-2022-0013513", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제 5 항에 있어서,상기 제3 라벨은,상기 3D 모델 데이터에서, 상악 제1 대구치의 근협측 교두와 하악 제1 대구치의 협측 홈을 거리 산출의 기준점인 특정 포인트로 하는 것을 특징으로 하는 인공신경망 기반 부정교합 분류 방법."}
{"patent_id": "10-2022-0013513", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제 1 항에 있어서,상기 (c)단계는,합성곱 신경망(CNN) 모델을 특징 추출(Feature extraction)을 위한 백본 네트워크로 하고, 상기 제1 라벨에 대응하는 제1 출력과, 상기 제2 라벨에 대응하는 제2 출력과, 상기 제3 라벨에 대응하는 제3출력의 다중 출력을 갖도록 하고, 상기 제1 내지 3 출력이 직렬 또는 병렬로 조합된 다중 출력의 인공신경망이구성되며, 상기 인공신경망의 상기 최종 손실함수를 최소화하기 위한 모델 파라메터 업데이트를 수행하는 것을 특징으로하는 인공신경망 기반 부정교합 분류 방법."}
{"patent_id": "10-2022-0013513", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제 7 항에 있어서,상기 (c)단계는,상기 인공신경망이,상기 제2 출력 또는 상기 제3 출력과 상기 제1 출력이 직렬로 연결된 것을 특징으로 하는 인공신경망 기반 부정교합 분류 방법."}
{"patent_id": "10-2022-0013513", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제 7 항에 있어서,상기 (c)단계는,상기 인공신경망이,상기 제1 출력과 상기 제2 출력이 직렬로 연결된 경우, 상기 제3 출력은 상기 제1 출력 및 상기 제2 출력과 병렬로 연결된 것을 특징으로 하는 인공신경망 기반 부정교합 분류 방법."}
{"patent_id": "10-2022-0013513", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제 7 항에 있어서,공개특허 10-2023-0116500-4-상기 (c)단계는,상기 인공신경망이,상기 제1 출력과 상기 제3 출력이 직렬로 연결된 경우, 상기 제2 출력은 상기 제1 출력 및 상기 제3 출력과 병렬로 연결된 것을 것을 특징으로 하는 인공신경망 기반 부정교합 분류 방법."}
{"patent_id": "10-2022-0013513", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "연산장치에 의해 수행되는 인공신경망 기반 부정교합 분류 애플리케이션에 있어서,(a) 상악과 하악의 치아가 스캔된 3D 모델 데이터를 전처리하여 정해진 시점의 2D 이미지 데이터를 얻기 위해상기 3D 모델 데이터를 정렬하는 리-오리엔테이션(Re-orientation) 기능;(b) 정렬된 상기 3D 모델 데이터에서 부정교합 분류를 위한 라벨을 설정하는 단계로, 원-핫 인코딩(one-hotencoding)으로 앵글 클래스(Angle’s classification)에 기반한 제1 라벨을 설정하고, 상기 제1 라벨에 상악과하악의 상대적 위치에 기반한 순서가 부여된 제2 라벨과, 교합된 상악과 하악의 치아 거리에 기반한 제3 라벨을설정하는 라벨링 기능; 및(c) 상기 제1 라벨에는 다중 분류에서 사용되는 제1 손실함수가 설정되고, 상기 제2 라벨과 상기 제3 라벨은 회귀(regression)의 제2 손실함수가 설정되어, 이종(異種)의 손실함수들에 가중치를 부여하여 다항식으로 조합한최종 손실함수를 갖고, 상기 최종 손실함수 기반으로 인공신경망 모델에 대해 정렬된 상기 3D 모델 데이터로부터 추출된 2D 교합 이미지의 앵글 클래스 분류를 학습하는 학습 기능;를 실행시키기 위하여 매체에 저장되어, 상기의 학습으로 추론 단계에서 상기 3D 모델 데이터의 입력시 앵글 클래스가 분류되고, 분류된 클래스의 정확도 관련 정량적 데이터가 산출 가능한 것을 특징으로 하는 인공신경망 기반 부정교합 분류 애플리케이션."}
{"patent_id": "10-2022-0013513", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은, 연산장치에 의해 수행되는 인공신경망 기반 부정교합 분류 방법에 있어서, 상악과 하악의 치아가 스 캔된 3D 모델 데이터(STL 포맷)를 전처리하여 정해진 시점의 2D 이미지 데이터를 얻기 위해 상기 3D 모델 데이터 를 정렬하는 리-오리엔테이션(Re-orientation) 단계; 정렬된 상기 3D 모델 데이터에서 부정교합 분류를 위한 라 (뒷면에 계속)"}
{"patent_id": "10-2022-0013513", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 인공신경망 기반 부정교합 분류 방법 및 부정교합 분류 애플리케이션에 관한 것으로서, 높은 재현성 과 정확도를 갖고, 정량적으로 부정교합 정도를 분류할 수 있는 방법 및 부정교합 분류 애플리케이션에 관한 것 이다."}
{"patent_id": "10-2022-0013513", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "부정교합(malocclusion)은 아래위 턱의 치아가 가지런하지 못하거나 정상적으로 맞물리지 않은 상태로, 기능적 으로 문제가 되는 교합관계를 말한다. 부정교합의 판별은 개개인의 형태학적 구강 구조의 편차를 정형화하여 전 반적인 교정 체제의 기준을 제시하기에 중요하다. 하지만, 부정교합의 판별을 위해 치아를 전반적으로 확인하는 데 많은 시간이 소요되며, 그 판별법 역시 전문의 개개인마다 편차가 존재한다. 에드워드 하틀리 앵글(Edward Hartley Angle)은 정상 교합을 만들어주는 과정에서 교정학을 연구하여 치과교정 학의 창시자로 인지되고 있으며, 부정교합의 분류를 정의하였고, 앵글의 부정교합 분류(Angle’s classification)는 아직도 널리 이용되고 있다. 현재까지 이용되고 있는 앵글 클래스는 상악 첫 번째 어금니(제 1 대구치)를 기준으로 위/아래 치아의 맞물림을 나누는 분류법으로, 다음의 세가지 클래스를 제시한다. 앵글 클래스 1(1급 부정교합)은 위/아래 어금니의 맞물림은 정상적이나 앞쪽 치아의 회전, 돌출, 변위 등으로 가지런하지 못한 상태를 말한다. 앵글 클래스 2(2급 부정교합)는 위/아래 어금니의 맞물림에서 위에 어금니들이 아래 어금니보다 앞쪽으로 돌출된 상태를 말하며, 대표적으로 돌출입이 본 분류에 해당한다. 앵글 클래스 3(3급 부정교합)은 위/아래 어금니의 맞물림에서 아래 어금니가 위의 어금니보다 뒤쪽으로 맞물리는 상태를 말하며, 대표적으로 주걱턱이 본 분류에 해당한다. 종래의 경우, 기존의 인공신경망 모델을 이용하여 앵글 클래스의 부정교합 분류를 학습시, 원-핫 인코딩(one- hot encoding)으로 형성된 라벨 데이터를 사용하며, 범주형 분류 학습으로 진행된다. 기존의 앵글 클래스의 3가 지 클래스에 대하여 원-핫 인코딩을 이용하여 학습하게 되는 인공신경망 모델의 경우, 학습에 필요한 데이터의양이 모든 의료 데이터를 이용하는 인공신경망 학습의 경우와 마찬가지로 매우 많아야 한다는 문제점이 있다. 이를 극복하기 위해서는 전이 학습(Transfer Learning) 또는 데이터 증강(data augmentation) 등의 다양한 기 법이 고려될 수 있다. 그러나, 전이 학습 및 데이터 증강 등의 학습 데이터의 부족을 극복하기 위해 제안된 종 래의 기법들이 적용되어도, 일반적인 대학병원 등에서 수집 가능한 수준의 데이터 집합으로는 만족할 수 있는 성능을 보이도록 인공신경망을 학습시키기에 여전히 부족한 실정이다. 또한, 종래의 경우 부정교합의 판정에 사용 가능한 데이터가 주로 환자의 구강을 본 뜬 3D 스캔 데이터(STL 파 일포맷)여서 기존의 전이 학습이 가능한 2D 이미지 기반 인공신경망 기술을 특징 추출(Feature Extraction)로 적용하기에 어려운 문제점이 있다. 이에, 3D 데이터에 직접적으로 적용 가능한 3D 합성곱(convolution)을 기반 으로 하는 신경망 모델이 있으나, 이 경우 기존의 충분한 데이터로 학습된 모델이 거의 없어서 전이 학습의 적 용이 쉽지 않다. 부정교합을 판단하는 관련 특허문헌으로, 한국등록특허 제10-2070255호는 복수의 치아의 분류 코드 유사도에 기 초하여 부정교합을 결정하는 시스템 및 방법을 개시한다. 상기 선행특허는 치아의 위치와 회전 정도를 나타내는 치아의 분류 코드와 치아의 위치 코드를 이용하여 부정교합을 특정 및 분류하는 방법을 개시하고 있다. 그러나, 상기 선행특허는 부정교합의 특정 및 분류에 인공지능을 접목한 실시예는 개시하지 않고 있다. 인공지능을 이용한 부정교합 분류는 학습 데이터 부족의 문제점을 극복하고 진단에 요구되는 최소한의 분류 성 능의 정확도가 보장될 수 있기 위한 새로운 학습 방법과 그 방법에 적합한 인공신경망 모델이 제시되어야 한다. 이에 본 출원인은, 인공지능 학습의 전처리 단계와 전처리 데이터의 라벨링 및 이에 적합한 인공신경망 모델 및 학습 방법을 고안하여 적은 데이터 집합으로도 높은 정확도의 학습이 가능한 본 발명을 고안하게 되었다. 선행기술문헌 특허문헌 (특허문헌 0001) 한국등록특허 제10-2070255호"}
{"patent_id": "10-2022-0013513", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은 인공신경망 기반 부정교합을 분류하는 방법 및 애플리케이션에 관한 것으로, 적은 데이터 집합으로도 높은 정확도의 학습 및 분류의 정확도를 정량적으로 평가할 수 있는 기계학습 방법 및 이에 적합한 인공신경망 모델을 제공하고자 한다."}
{"patent_id": "10-2022-0013513", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "상기 목적을 달성하기 위하여 본 발명은, 연산장치에 의해 수행되는 인공신경망 기반 부정교합 분류 방법에 있 어서, 상악과 하악의 치아가 스캔된 3D 모델 데이터(STL 포맷)를 전처리하여 정해진 시점의 2D 이미지 데이터를 얻기 위해 상기 3D 모델 데이터를 정렬하는 리-오리엔테이션(Re-orientation) 단계; 정렬된 상기 3D 모델 데이 터에서 부정교합 분류를 위한 라벨을 설정하는 단계로, 원-핫 인코딩(one-hot encoding)으로 앵글 클래스(Angle ’s classification)에 기반한 제1 라벨을 설정하고, 상기 제1 라벨에 상악과 하악의 상대적 위치에 기반한 순 서가 부여된 제2 라벨과, 교합된 상악과 하악의 치아 거리에 기반한 제3 라벨을 설정하는 라벨링 단계; 및 상기 제1 라벨에는 다중 분류에서 사용되는 제1 손실함수가 설정되고, 상기 제2 라벨과 상기 제3 라벨은 회귀 (regression)의 제2 손실함수가 설정되어, 이종(異種)의 손실함수들에 가중치를 부여하여 다항식으로 조합한 최 종 손실함수를 갖고, 상기 최종 손실함수 기반으로 인공신경망 모델에 대해 정렬된 상기 3D 모델 데이터로부터 추출된 2D 교합 이미지의 앵글 클래스 분류를 학습하는 학습 단계;를 포함하여 학습을 수행하며, 상기의 학습으 로 추론 단계에서 상기 3D 모델 데이터의 입력시 앵글 클래스가 분류되고, 분류된 클래스의 정확도 관련 정량적 데이터가 산출 가능한 것을 일 특징으로 한다. 바람직하게, 리-오리엔테이션 단계는 정렬된 상기 3D 모델 데이터로부터 정해진 시점의 2D 이미지들을 추출하여 2D 이미지의 조합으로 학습을 위한 상기 2D 교합 이미지를 생성할 수 있다. 바람직하게, 리-오리엔테이션 단계는 정렬된 상기 3D 모델 데이터로부터, 특정 각도(N개)에서 바라본 단면의 2D 이미지를 그레이 스케일로 변환하여 상기 2D 교합 이미지를 생성할 수 있다. 바람직하게, 라벨링 단계는 상기 제2 라벨이 상기 제1 라벨의 분류에서 상악과 하악의 상대적 위치를 연속변수 (0, 1, -1)로 지정한 데이터 값으로 표현하여 회귀(regression)라벨로 생성할 수 있다. 바람직하게, 라벨링 단계는 상기 제3 라벨이 상기 3D 모델 데이터로부터, 상악 대구지와 하악 대구치의 특정 포 인트의 거리를 픽셀 기반으로 수치화한 데이터일 수 있다. 바람직하게, 상기 제3 라벨은, 상기 3D 모델 데이터에서, 상악 제1 대구치의 근협측 교두와 하악 제1 대구치의 협측 홈을 거리 산출의 기준점인 특정 포인트로 할 수 있다. 바람직하게, 학습 단계는 합성곱 신경망(CNN) 모델을 특징 추출(Feature extraction)을 위한 백본 네트워크로 하고, 상기 제1 라벨에 대응하는 제1 출력과, 상기 제2 라벨에 대응하는 제2 출력과, 상기 제3 라벨에 대응하는 제3 출력의 다중 출력을 갖도록 하고, 상기 제1 내지 3 출력이 직렬 또는 병렬로 조합된 다중 출력의 인공신경 망이 구성되며, 상기 인공신경망의 상기 최종 손실함수를 최소화하기 위한 모델 파라메터 업데이트를 수행할 수 있다. 바람직하게, 학습 단계는 상기 인공신경망이 상기 제2 출력 또는 상기 제3 출력과 상기 제1 출력이 직렬로 연결 될 수 있다. 바람직하게, 학습 단계는 상기 인공신경망이 상기 제1 출력과 상기 제2 출력이 직렬로 연결된 경우, 상기 제3 출력은 상기 제1 출력 및 상기 제2 출력과 병렬로 연결될 수 있다. 바람직하게, 학습 단계는 상기 인공신경망이 상기 제1 출력과 상기 제3 출력이 직렬로 연결된 경우, 상기 제2 출력은 상기 제1 출력 및 상기 제3 출력과 병렬로 연결될 수 있다. 또한, 본 발명은 연산장치에 의해 수행되는 인공신경망 기반 부정교합 분류 애플리케이션에 있어서, 상악과 하 악의 치아가 스캔된 3D 모델 데이터를 전처리하여 정해진 시점의 2D 이미지 데이터를 얻기 위해 상기 3D 모델 데이터를 정렬하는 리-오리엔테이션(Re-orientation) 기능; 정렬된 상기 3D 모델 데이터에서 부정교합 분류를 위한 라벨을 설정하는 단계로, 원-핫 인코딩(one-hot encoding)으로 앵글 클래스(Angle’s classification)에 기반한 제1 라벨을 설정하고, 상기 제1 라벨에 상악과 하악의 상대적 위치에 기반한 순서가 부여된 제2 라벨과, 교합된 상악과 하악의 치아 거리에 기반한 제3 라벨을 설정하는 라벨링 기능; 및 상기 제1 라벨에는 다중 분류 에서 사용되는 제1 손실함수가 설정되고, 상기 제2 라벨과 상기 제3 라벨은 회귀(regression)의 제2 손실함수가 설정되어, 이종(異種)의 손실함수들에 가중치를 부여하여 다항식으로 조합한 최종 손실함수를 갖고, 상기 최종 손실함수 기반으로 인공신경망 모델에 대해 정렬된 상기 3D 모델 데이터로부터 추출된 2D 교합 이미지의 앵글 클래스 분류를 학습하는 학습 기능;를 실행시키기 위하여 매체에 저장되어, 상기의 학습으로 추론 단계에서 상 기 3D 모델 데이터의 입력시 앵글 클래스가 분류되고, 분류된 클래스의 정확도 관련 정량적 데이터가 산출 가능 한 것을 다른 특징으로 한다."}
{"patent_id": "10-2022-0013513", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명에 따르면, 교정 치료에서 쉽게 구할 수 있는 스캔된 3D 모델 데이터를 사용하면서 전이학습 및 데이터 증강(Data Augmentation) 등이 가능하며, 제한된 적은 량의 데이터 집합으로도, 높은 재현성과 정확도를 보이는 부정교합 분류 인공신경망을 구현 가능하고, 이의 학습이 빠른 시간에 가능하다는 이점이 있다."}
{"patent_id": "10-2022-0013513", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하, 첨부된 도면들에 기재된 내용들을 참조하여 본 발명을 상세히 설명한다. 다만, 본 발명이 예시적 실시 예 들에 의해 제한되거나 한정되는 것은 아니다. 각 도면에 제시된 동일 참조부호는 실질적으로 동일한 기능을 수 행하는 부재를 나타낸다. 본 발명의 목적 및 효과는 하기의 설명에 의해서 자연스럽게 이해되거나 보다 분명해질 수 있으며, 하기의 기재 만으로 본 발명의 목적 및 효과가 제한되는 것은 아니다. 또한, 본 발명을 설명함에 있어서 본 발명과 관련된 공지 기술에 대한 구체적인 설명이, 본 발명의 요지를 불필요하게 흐릴 수 있다고 판단되는 경우에는 그 상세한 설명을 생략하기로 한다. 도 1은 본 발명의 실시예에 따른 인공신경망 기반 부정교합 분류 방법의 학습 단계를 나타낸다. 도 2는 도 1의 학습 단계를 개략화한 모식도이다. 도 1 및 도 2를 참조하면, 인공신경망 기반 부정교합 분류 방법은 리-오리엔테이션을 수행하는 (a)단계(S10), 라벨링을 설정하는 (b)단계(S30) 및 인공지능 학습을 수행하는 (c)단계(S50)를 포함할 수 있다. (a)단계(S10)는 전처리 과정의 단계로서 상악과 하악의 치아가 스캔된 3D 모델 데이터를 전처리하여 정해진 시 점의 2D 이미지 데이터를 얻기 위해 상기 3D 모델 데이터를 정렬할 수 있다. 본 실시예로, 부정교합 환자로부터 3D 스캔 등을 통해 얻어진 3D 스캔 데이터는 STL 포맷 데이터가 될 수 있다. (a)단계(S10)는 상악과 하악의 치 아를 3D 스캔으로 획득한 3D 모델 데이터를 정렬한 후, 기 설정된 특정 시점의 2D 이미지 조합을 추출할 수 있 다. 본 실시예로, 리-오리엔테이션 단계(S10)는 정해진 시점의 2D 이미지 데이터를 얻기 위해 스캔된 3D 모델 데이 터를 특정 방향으로 정렬하는 단계이다. 리-오리엔테이션 과정은 좌측 교합 2D 이미지와 우측 교합 2D 이미지를 항상 정해진 시점으로 얻을 수 있도록 3D 모델 데이터에 3개의 점을 지정하여 방향을 조정한다. 일 예시로, 3개 의 점은 좌우측 대구치와 앞니에 지정될 수 있으며, 3개의 점을 지정한 후, 아핀 변환 등을 이용하여 3D 모델 데이터를 정렬시킬 수 있다. 리-오리엔테이션 단계(S10)는 3D 모델의 스캔 데이터에서 양측 대구치와 앞니를 기준으로 동일한 위치로 상악 과 하악을 교합시킨 후, 지정된 방향으로 정렬시켜 항상 정해진 시점으로 2D 이미지를 얻을 수 있게 한다. 리-오리엔테이션 단계(S10)의 수행 이후 정렬된 3D 모델 데이터로부터 정해진 시점의 2D 이미지들을 추출하여 2D 이미지의 조합으로 학습을 위한 2D 교합 이미지를 생성하는 단계가 수행될 수 있다. 이 과정에서, 후술하게 될 라벨링 단계(S30)가 함께 수행될 수 있다. 기존의 전이 학습이 가능한 CNN기반의 인공신경망을 사용하기 위해서는 3D 모델의 스캔 데이터로부터 전문의가 부정교합의 정확한 판정을 내릴 수 있는 시점의 치아의 교합 2D 이미지들이 요구된다. 본 실시예에 따른 리-오 리엔테이션 단계(S10) 및 이후의 2D 교합 이미지를 생성하는 단계의 수행으로, 상악과 하악이 맞물린 3D 모델의 스캔 데이터에서 대구치로부터 앞니에 이르는 치아의 측단면이 표현된 시점의 2D 이미지가 추출된다. 2D 이미지 를 추출하는 특정 시점은 치아의 교합면을 시상면(sagittal plane)을 기준으로 양측면에서 바라본 단면도가 될 수 있다. 이에 따라, 2D 교합 이미지를 생성하는 단계에서 최소한 좌측 단면과 우측 단면인 2장의 2D 이미지 데 이터를 생성한다. 다른 실시예로, 2D 교합 이미지를 생성하는 단계는 정렬된 3D 모델 데이터로부터, 특정 각도(N개)에서 바라본 단면의 2D 이미지를 그레이 스케일로 변환하여 2D 교합 이미지를 생성할 수 있다. 여기서 특정 각도는 3개 내지 4개의 각도가 될 수 있으며, 2D 이미지는 해당 각도에서 바라본 3장 내지 4장의 2D 교합 이미지가 될 수 있다. 본 실시예로, 3D 모델 데이터를 20°, 50°, 70°에서 바라본 각 단면을 그레이 스케일의 2D 이미지로 추출하여 학습 대상인 교합 이미지 조합으로 할 수 있다. 또한, 이는 좌우에 대해 수행하여 (20, 50, 70)의 시점의 그레 이 스케일 이미지를 RGB정보 대신 채널 데이터로 갖는 2D 이미지 데이터와 (-20, -50, -70)의 시점의 그레이 스 케일 이미지 각각을 채널 데이터로 갖는 다채널의 2D 이미지 데이터를 추출할 수 있다. 전이학습이 가능한 CNN 기반 인공신경망의 경우, 최대 4개의 채널이 지원되므로 적용하고자 하는 CNN기반 인공신경망에 맞춰 사용할 시점의 각도가 정해질 수 있다. (b)단계(S30)는 라벨링 단계로서 교합 이미지에서 부정교합 분류를 위한 라벨을 설정하는 단계로, 원-핫 인코딩 (one-hot encoding)으로 앵글 클래스(Angle’s classification)에 기반한 제1 라벨(S31)을 설정하고, 제1 라벨 에 상악과 하악의 상대적 위치를 고려하여 순서를 부여한 숫자 값을 가지는 제2 라벨(S33)과, 교합된 상악과 하 악의 치아 거리에 기반한 제3 라벨(S35)을 설정할 수 있다. (b)단계(S30)는 제2 라벨(S33)은 전문가의 개입 혹은 영상처리 기술 등의 개입이 필요한 제3 라벨(S35)과 달리 제1 라벨(S31)의 분류에서 상악과 하악의 상대적 위치를 3가지로 분류한 데이터 값만으로 설정할 수 있다. (b) 단계(S30)는 제3 라벨(S35)이 교합 이미지에서 상악 대구지와 하악 대구치의 특정 포인트의 거리를 픽셀 기반으 로 수치화한 데이터로 설정할 수 있다. 본 실시예로, 제3 라벨(S35)은 교합 이미지에서, 상악 제1 대구치의 근 협측 교두와 하악 제1 대구치의 협측 홈을 거리 산출의 기준점인 특정 포인트로 할 수 있다. (b)단계(S30)는 학습 대상이 되는 교합 3D 스캔 데이터에 다중 라벨을 부여하는 단계이다. 본 실시예로, (b)단 계(S30)는 3가지의 라벨을 제안한다. 제1 라벨(S31)은 앵글 클래스 값이 될 수 있다. 제1 라벨(S31)은 상악 제1 대구치의 근심협측 교두가 하악 제1 대구치의 근심협측에 접촉하는 경우 클래스 1으로 분류할 수 있다. 제1 라 벨(S31)은 상악 제1 대구치보다 하악 제1 대구치가 뒤쪽으로 위치하여 골격적으로 상악이 상대적으로 하악보다 전방에 위치한 경우 클래스 2로 분류할 수 있다. 제1 라벨(S31)은 상악 제1 대구치보다 하악 제1 대구치가 앞쪽 에 위치하고 있으며, 골격적으로 하악이 상대적으로 상악보다 전방에 위치하는 경우 클래스 3으로 분류할 수 있 다. 각각의 클래스 1 내지 3은 원-핫 인코딩으로 값이 부여되어 라벨 데이터를 형성할 수 있다. 제2 라벨(S33)은 앵글 클래스 라벨에 상악과 하악의 상대적 위치를 고려하여 순서를 가지는 숫자 값이 부여된 라벨로 이해될 수 있다. 본 실시예로, 제2 라벨(S33)은 Pseudo distance label이라 부른다. 제2 라벨(S33)은 일종의 가상의 거리 관계로 데이터를 부여하는 라벨이며 상악과 하악의 상대적 위치에 따른 순서를 가지는 숫자 값으로 표현하여 라벨 데이터를 생성할 수 있다. 제 1라벨에서는 클래스를 분류할 뿐 원-핫 인코딩을 사용하여 클래스 간의 어떠한 순서 정보가 없는 것과 달리 제2 라벨(S33)은 상악과 하악의 상대적 위치에 따른 순서에 대 한 정보가 라벨에 포함된다. 구체적으로, 제2 라벨(S33)은 상악과 하악의 상대적 위치를 -1, 0, +1의 순서를 가 지는 데이터 값으로 표현할 수 있다. 제1 라벨(S31)에서 클래스 1로 분류된 경우, 제2 라벨(S33)은 0으로 설정 될 수 있다. 제1 라벨(S31)에서 클래스 2로 분류된 경우, 제2 라벨(S33)은 +1로 설정될 수 있다. 제1 라벨(S3 1)에서 클래스 3으로 분류된 경우, 제2 라벨(S33)은-1로 설정될 수 있다. 이 경우, 상악이 하악보다 앞에 위치 할 양수의 값을 뒤로 위치할 경우 음수의 값을 가지도록 하여 regression 문제에 대한 학습 기법을 사용할 수 있게 한다. 제2 라벨(S33)은 앵글 클래스로부터 직접 산출된 일종의 Pseudo 거리이며, 데이터가 적은 교합 이미지의 학습 성능을 향상시키기 위한 다중 라벨 중 하나이며, 제1 라벨(S31)과 제2 라벨(S33)은 각각 다중 출력으로 사용되 거나 직렬로 연결하여 학습된다. 제2 라벨(S33)은 후술하게 될 제3 라벨(S35)의 작업이 용이하지 않은 경우, 앵 글 클래스의 상악과 하악의 상대적 위치 정보로 실측 거리를 대체하여 사용이 가능하며 상악과 하악의 상대적 위치 정보를 사전 정보로 제공함으로서 적은 데이터에서 빠른 학습 및 보다 높은 성능을 가능케 한다. 제2 라 벨(S33)은 제3 라벨(S35)의 대체제로서 기능할 수도 있으며, 동시에도 사용 가능하다. 제1 라벨(S31)에 제2 라 벨(S33)과 제3 라벨(S35)을 함께 사용할 경우, 각각의 라벨을 부정교합 클래스의 원-핫 인코딩의 제1 라벨(S3 1)과 사용한 경우보다 보다 높은 정확도의 분류가 가능하다. 참고로 이같은 경향은 학습 데이터의 크기가 작을 수록 두드러진다. 제3 라벨(S35)은 상악과 하악의 특정 치아의 실측된 거리에 관한 라벨 데이터를 의미한다. 본 실시예로, 제3 라 벨(S35)은 Measured distance label이 될 수 있다. 제3 라벨(S35)은 제1 대구치의 근협측 교두와 하악 제1 대 구치의 협측 홈의 거리(the mesiobuccal cusp of the maxillary first molar and the buccal groove of the mandibular first molar) 데이터일 수 있다. 도 2를 참조하면, 제3 라벨(S35)의 거리 측정을 위한 특정 포인트의 타겟 박스를 D로 표현하였다. 제3 라벨 (S35)은 전문의가 3D 모델 데이터 또는 2D의 교합 이미지 상에서 제1 대구치의 근협측 교두와 하악 제1 대구치 의 협측 홈을 직접 포인트로 설정할 수도 있으나, 기존의 다른 영상처리 기술들로 제1 대구치의 학습된 정보로 각 포인트가 자동으로 설정될 수도 있다. 제1 대구치의 양측 포인트가 설정되면 제3 라벨은 이미지 상에서의 픽셀 값을 기반으로 거리를 실측할 수 있다. (b)단계(S30)는 이상의 라벨링 단계를 수행하여 3D 모델 데이터에 해당 라벨 셋을 부여한다.(c)단계(S50)는 학습 단계로서, 제1 라벨(S31)에는 다중 분류에서 사용되는 제1 손실함수가 설정되고, 제2 라벨 (S33)과 제3 라벨(S35)은 회귀(regression)의 제2 손실함수가 설정되어, 이종(異種)의 손실함수들에 가중치를 부여하여 다항식으로 조합한 최종 손실함수를 갖고, 상기 최종 손실함수 기반으로 인공신경망 모델에 대해 정렬 된 3D 모델 데이터로부터 추출된 2D 교합 이미지의 앵글 클래스 분류를 학습할 수 있다. (c)단계(S50)의 학습으로, 추후 사용자가 사용하게 되는 추론 단계에서는 기존의 STL 포맷인 3D 모델 데이터의 입력시 앵글 클래스가 자동으로 분류될 수 있으며, 분류된 클래스의 정확도 관련 정량적 데이터도 산출되어 정 확도 관련 지표가 함께 표현될 수 있다. 제1 손실함수로 분류 문제에 주로 사용되는 크로스-엔트로피(cross-entropy)를 사용할 수 있다. 본 실시예로, 제1 라벨(S31)에 대한 손실함수는 하기의 [수학식 1]로 표현될 수 있다. [수학식 1]"}
{"patent_id": "10-2022-0013513", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "여기서, β는 해당 손실함수의 가중치이고, N은 데이터 개수이며, C는 클래스 개수이고, Lij는 샘플 i가 클래스 j인지를 나타내는 라벨(0 또는 1)이고, Pij는 샘플 i가 클래스 j에 해당할 확률 값(0~1)을 의미한다. 제2 손실함수는 회귀(regression)에서 사용되는 MSE(mean square error)가 될 수 있다. 제2 손실함수는 제2 라 벨(S33) 및 제3 라벨(S35)의 손실함수로 설정될 수 있다. 본 실시예로, 제2 라벨(S33)에 대한 제2 손실함수는 하기의 [수학식 2]로 표현될 수 있다. [수학식 2]"}
{"patent_id": "10-2022-0013513", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "여기서, β는 손실함수의 가중치 값이고, N은 데이터 샘플 개수이며, yi는 Pseudo distance i번째 샘플의 예측 값이고, ti는 Pseudo distance i번째 샘플의 라벨값을 의미한다. 본 실시예로, 제3 라벨(S35)에 대한 제2 손실함수는 하기의 [수학식 3]로 표현될 수 있다. [수학식 3]"}
{"patent_id": "10-2022-0013513", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "여기서, γ는 손실함수의 가중치 값이고, N은 데이터 샘플 개수이며, Zi는 Measured distance i번째 샘플의 예 측값이고, li는 Measured distance i번째 샘플의 라벨값을 의미한다. 본 실시예에 따른 인공신경망의 손실함수는 제1 손실함수 및 제2 손실함수를 항으로 가지는 다항식으로 표현될 수 있다. 본 실시예에 따른 인공신경망의 손실함수는 하기의 [수학식 4]로 표현될 수 있다. [수학식 4]"}
{"patent_id": "10-2022-0013513", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 5, "content": "전체 손실함수 L은 전술한 수학식 1 내지 3의 손실함수가 조합된 다항식으로 표현될 수 있다. 본 실시예로, 가 중치 α, β, γ는 α, β > γ 의 관계가 성립될 수 있다. 바람직하게 α, β 는 1로 γ는 1보다 작게 설정될수 있다. 그 이유로, 제3 라벨(S35)은 실측 데이터로서 데이터 수치의 스케일이 제1 라벨(S31) 및 제2 라벨 (S33)보다 크게 형성되므로, 스케일을 맞추기 위해 가중치가 1 이하의 값으로 설정될 수 있다. (c)단계(S50)는 전이 학습을 사용한 백본 네트워크 학습 단계(S51)와 다중 출력 네트워크 학습 단계(S53)를 포 함할 수 있다. 백본 네트워크 학습 단계(S51)는 기존의 충분한 학습데이터로 사전 훈련된 합성곱 신경망(CNN)기반의 모델을 사 용한다. CNN 기반 모델은 하나 또는 여러 개의 콘볼루션 계층들로 구성된 심층 신경망(DNN)의 한 종류이다. CNN 은 2차원 데이터의 학습에 적합한 구조를 가지고 있으며, 전이 학습이 가능한 여러 버전이 제공되고 있어서 영 상 내 객체 분류, 객체 탐지 등 다양한 응용 분야에 폭넓게 활용되고 있다. 본 실시예에 따른 인공신경망 기반 부정교합 분류 학습 모델은 전술한 전처리 과정으로, 학습 대상 이미지가 2D로 전환되었으므로, 기존의 CNN 모 델 및 특징 벡터를 전용하여 사용하기에 유리하다. 다만, 본 실시예에 따른 부정교합 분류 학습 모델은 다중 라벨이 설정되기 때문에 다중 출력 구조를 형성함이 바람직하다. 이에 백본 네트워크 모델의 수행 이후, 드롭아웃 레이어가 병렬로 분할되고, 손실함수의 조합에 따 라 다중 출력의 네트워크를 구성하여 학습한다. 다중 출력 네트워크 학습 단계(S53)는 제1 라벨(S31)에 대응하는 제1 출력과, 제2 라벨(S33)에 대응하는 제2 출 력과, 제3 라벨(S35)에 대응하는 제3 출력의 다중 학습 결과를 갖도록, 이종의 손실함수가 직렬 또는 병렬로 조 합된 다중 출력의 인경신경망이 구성된다. 본 실시예로, 학습 단계(S50)에서 수행되는 CNN기반의 다중 출력 인공신경망의 학습은 제2 라벨(S33) 또는 제3 라벨(S35)의 출력단과 제1 라벨(S31)의 출력단이 직렬로 연결될 수 있다. 학습 단계(S50)는 학습되는 인공신경 망이 제1 라벨(S31)의 출력단과 제2 라벨(S33)의 출력단이 직렬로 연결된 경우, 제3 라벨(S35) 의 출력단은 제1 라벨(S31) 및 제2 라벨(S33)의 출력단과 병렬로 연결되어 구성될 수 있다. 학습 단계(S50)는 학습되는 인공신경망이 제1 라벨(S31)의 출력단과 제3 라벨(S35)의 출력단이 직렬로 연결된 경우, 제2 라벨(S33)은 제1 라벨(S31) 및 제3 라벨(S35)의 출력단과 병렬로 연결되어 구성될 수 있다."}
{"patent_id": "10-2022-0013513", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 6, "content": "본 실시예로, 다중 출력 네트워크의 상기 출력단 직/병렬 조합은 다음과 같이 요약될 수 있다. 다중 라벨의 효 과를 극대화하는 네트워크 구조로서, 제3 라벨(S35)은 measured distance이며, 대응하는 회귀 출력이 병렬로 놓 이는 것보다 직렬로 제1 라벨(S31) 출력과 연결되는 것이 효과적이다. 제2 라벨(S33) 또한 일종의 distance로 다룰 수 있는 Pseudo distance 값으로 제3 라벨(S35)과 마찬가지로 대응하는 회귀 출력이 병렬로 처리하는 것보 다 제1 라벨(S31) 출력과 직렬 연결하는 것이 효과적이다. 이러한 회귀 구조의 한 실시예로, 도 2에서는 제1 라 벨(S31)인 앵글 클래스 분류와 제2 라벨(S33)인 Pseudo distance의 출력이 직렬로 연결되었다. 또한, 제3 라벨 (S35)은 별도의 레이어의 출력으로 제1 라벨(S31) 및 제2 라벨(S33)과 병렬 관계를 갖고 최종 손실함수에서 제3 라벨(S35)의 손실함수 값을 통해 제1 라벨(S31) 출력에 영향을 미친다. 도 2에서는 다중 출력 네트워크의 상기 출력단 직/병렬 조합의 바람직한 실시예를 도시하였으나, 다른 실시예로 다음과 같이 다른 종류의 네트워크 구조 타입이 형성될 수 있다. 도 3은 제1 출력과 제3 출력이 조합된 인공신경망의 다른 실시예를 나타낸다. 도 3의 실시예는, 전술한 백본 네 트워크(S51)의 수행 이후, 제1 출력과 제3 출력이 병렬로 연결된 네트워크를 개시한다. 본 실시예는 제1 출력과 다른 다중 라벨이 병렬로 연결된 것으로 제2 출력이 병렬로 연결된 네트워크 구조를 포함할 수 있다. 도 4는 제1 출력과 제2 출력이 조합된 인공신경망의 다른 실시예를 나타낸다. 도 4의 실시예는 전술한 백본 네 트워크(S51)의 수행 이후, 제1 출력과 제2 출력이 직렬로 연결된 인공신경망을 개시한다. 여기서, 네트워크의 직렬 구조는 제2 출력의 수행 이후 제1 출력의 학습이 이루어지도록 한다. 본 실시예는 제1 출력과 다른 다중 출력이 직렬로 연결된 것으로, 제3 출력이 제1 출력과 직렬로 연결된 네트워크 구조를 포함할 수 있다. 도 5는 제1 출력과 제3 출력이 직렬로 연결되고, 제2 출력이 병렬로 연결된 인공신경망의 다른 실시예를 나타낸 다. 도 5의 실시예는 전술한 백본 네트워크(S51)의 수행 이후, 제3 출력과 제2 출력이 병렬로 분기되고, 제3 출 력의 학습 결과가 제1 출력과 직렬로 연결된 네트워크 구조를 개시한다. 이상에서 대표적인 실시예를 통하여 본 발명을 상세하게 설명하였으나, 본 발명이 속하는 기술 분야에서 통상의 지식을 가진 자는 상술한 실시예에 대하여 본 발명의 범주에서 벗어나지 않는 한도 내에서 다양한 변형이 가능 함을 이해할 것이다. 그러므로 본 발명의 권리 범위는 설명한 실시예에 국한되어 정해져서는 안 되며, 후술하는 특허청구범위뿐만 아니라 특허청구범위와 균등 개념으로부터 도출되는 모든 변경 또는 변형된 형태에 의하여 정해져야 한다."}
{"patent_id": "10-2022-0013513", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 실시예에 따른 인공신경망 기반 부정교합 분류 방법의 학습 단계를 나타낸다. 도 2는 도 1의 학습 단계를 개략화한 모식도이다. 도 3은 제1 출력과 제3 출력이 조합된 네트워크의 다른 실시예를 나타낸다도 4는 제1 출력과 제2 출력이 조합된 인공신경망의 다른 실시예를 나타낸다. 도 5는 제1 출력과 제3 출력이 직렬로 연결되고, 제2 출력이 병렬로 연결된 인공신경망의 다른 실시예를 나타낸 다."}
