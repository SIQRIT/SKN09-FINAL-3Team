{"patent_id": "10-2021-0007578", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2022-0105035", "출원번호": "10-2021-0007578", "발명의 명칭": "인공 신경망 선량 예측 모델 기반 선량 평가 방법 및 장치", "출원인": "한국원자력연구원", "발명자": "최유미"}}
{"patent_id": "10-2021-0007578", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "선량 평가 장치의 동작 방법으로써, 입력되는 피폭 시나리오마다 상기 피폭 시나리오를 모사하기 위한 하나 이상의 변수들을 선별하고, 선별된 상기변수들 중에서 랜덤하게 값이 설정되는 하나 이상의 랜덤 입력 변수와 출력 변수를 선정하는 단계, 랜덤하게 생성되는 상기 랜덤 입력 변수의 값마다 상기 피폭 시나리오의 모사 과정에서 도출되는 출력 변수 값을 수집하고, 입력되는 랜덤 입력 변수 값과 상기 출력 변수 값을 매칭하여 학습 데이터를 생성하는 단계, 그리고 상기 학습 데이터에 기초하여 상기 랜덤 입력 변수 값을 입력하면, 매칭된 출력 변수 값이 도출되도록 선량 예측 모델을 학습시키는 단계를 포함하는 동작 방법."}
{"patent_id": "10-2021-0007578", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에서, 상기 학습 데이터를 생성하는 단계는,몬테칼로((Monte Carlo N-Paricle transport code) 전산모사를 통해 상기 피폭 시나리오에서 입력되는 하나 이상의 입력 변수와 도출되는 하나의 출력 변수를 매칭하여 학습 데이터로 생성하는 동작 방법."}
{"patent_id": "10-2021-0007578", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제2항에서,상기 랜덤 입력 변수와 출력 변수를 선정하는 단계는,상기 피폭 시나리오에 기초하여 모델링하기 위해 선별된 변수들 중에서 상기 랜덤 입력 변수와 출력 변수로 선정 가능한 변수들이 기재된 가이드 데이터에 기초하여 상기 가이드 데이터에 기재된 변수들의 조합으로 하나 이상의 상기 랜덤 입력 변수와 상기 하나 이상의 출력 변수를 선정하는 동작 방법."}
{"patent_id": "10-2021-0007578", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제2항에서,상기 학습 데이터를 생성하는 단계는, 상기 학습 데이터를 수집하기 위한 상기 몬테칼로 전산모사 계산 시간을 단축하기 위해 입력 변수 중 선원의 위치에 기초하여 상기 선원의 입체각을 형성하는 동작 방법."}
{"patent_id": "10-2021-0007578", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제1항에서,상기 랜덤 입력 변수, 상기 출력 변수를 포함하는 상기 변수는,공개특허 10-2022-0105035-3- 숫자, 문자, 텍스트, 2차원 이미지, 3차원 구조 그리고 영상 정보 중 하나 이상의 형태를 포함하는 동작 방법."}
{"patent_id": "10-2021-0007578", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제1항에서,상기 선량 예측 모델을 학습시키는 단계는,외부 피폭, 내부 피폭 또는 차폐 구조에 대한 피폭 시나리오 별, 상기 랜덤 입력 변수의 종류, 상기 랜덤 입력변수의 세부 값, 상기 출력 변수의 종류 그리고 상기 출력 변수의 세부 값을 포함하는 조건에 기초하여 상기 조건마다 각각의 선량 예측 모델들을 학습시키는 동작 방법."}
{"patent_id": "10-2021-0007578", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제1항에서,피폭 시나리오를 선택하고, 입력 변수의 데이터를 입력받는 단계, 그리고상기 피폭 시나리오에 따라 선별되는 변수들 중에서 상기 입력 변수의 데이터를 설정하여 학습된 선량 예측 모델에 입력하고, 상기 학습된 선량 예측 모델로부터 출력 변수의 값을 획득하여 선량 평가 결과를 산출하는 단계를 더 포함하는 동작 방법."}
{"patent_id": "10-2021-0007578", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "통신 장치,명령어들을 포함하는 메모리, 그리고상기 명령어들을 실행하여 입력된 하나 이상의 변수에 기초하여 선량을 평가하는 프로세서를 포함하고, 상기 프로세서는입력되는 피폭 시나리오마다 상기 피폭 시나리오를 모사하기 위한 하나 이상의 변수 중에서 랜덤하게 값이 설정되는 하나 이상의 랜덤 입력 변수와 출력 변수를 선정하여, 랜덤 입력 변수 값에 따른 상기 피폭 시나리오의 모사 과정에서 도출되는 출력 변수 값을 수집하면, 상기 랜덤 입력 변수 값이 입력하여, 상기 출력 변수 값이 도출되도록 선량 예측 모델을 학습시키고, 상기 선량 예측 모델이 학습이 완료된 후, 피폭 시나리오와 입력 변수의 데이터를 입력받으면, 상기 피폭 시나리오에 기초하여 학습된 선량 예측 모델에 상기 입력 변수의 데이터를 입력하고, 상기 학습된 선량 예측 모델로부터 획득한 출력 변수의 값을 출력하는, 선량 평가 장치."}
{"patent_id": "10-2021-0007578", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제8항에서, 상기 프로세서는,랜덤하게 생성되는 상기 랜덤 입력 변수의 값마다 몬테칼로((Monte Carlo N-Paricle transport code) 전산모사에 입력하여 선정된 출력 변수에 해당하는 출력 변수 값을 수집하고, 랜덤 입력 변수 값과 상기 출력 변수 값을매칭하여 학습 데이터를 생성하는, 선량 평가 장치."}
{"patent_id": "10-2021-0007578", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제8항에서, 공개특허 10-2022-0105035-4-상기 프로세서는, 상기 몬테칼로 전산모사의 입력 변수 값과 출력 변수 값을 상기 선량 예측 모델에 적용하여 상기 입력 변수 값에 기초하여 상기 출력 변수 값을 도출하는 상기 몬테칼로 전산모사 기법을 상기 선량 예측 모델이 학습하도록하는 선량 평가 장치."}
{"patent_id": "10-2021-0007578", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "제8항에서, 상기 프로세서는, 외부 피폭으로 인한 인체 선량 평가 시나리오, 내부 피폭으로 인한 인체 평가 시나리오, 그리고 차폐 구조에 기초한 선량 평가 시나리오에 기초하여, 시나리오들마다 랜덤 입력 변수와 출력 변수들을 선정하는 조건에 기초하여 상기 조건마다 대응하는 선량 예측모델들을 학습시키는 선량 평가 장치."}
{"patent_id": "10-2021-0007578", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제8항에서, 상기 프로세서는, 상기 랜덤 입력 변수로 선원 정보, 피폭대상 정보를 지정하고, 상기 출력 변수로 인체 선량, 선량계 선량, 비상선량계 선량 그리고 선량 환산계수를 설정하여 상기 랜덤 입력 변수 값들의 조합에 기초하여 상기 출력 변수가도출되도록 제1 선량 예측 모델을 학습시키는 선량 평가 장치."}
{"patent_id": "10-2021-0007578", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "제12항에서, 상기 프로세서는, 상기 랜덤 입력 변수로 인체 동선 또는 차폐체 정보를 추가하여 상기 출력 변수가 도출되도록 제2 선량 예측 모델을 학습시키는 선량 평가 장치."}
{"patent_id": "10-2021-0007578", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_14", "content": "제8항에서, 상기 프로세서는, 상기 랜덤 입력 변수로 하나 이상의 계측값, 인체 정보를 지정하고, 상기 출력 변수로 선원항을 설정하여 상기랜덤 입력 변수 값들의 조합에 기초하여 상기 출력 변수가 도출되도록 제3선량 예측 모델을 학습시키는 선량 평가 장치."}
{"patent_id": "10-2021-0007578", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_15", "content": "제8항에서, 상기 랜덤 입력 변수로 선원 정보, 인체팬텀 정보를 지정하고, 상기 출력 변수로 인체 선량을 설정하여 상기 랜덤 입력 변수 값들의 조합에 기초하여 상기 출력 변수가 도출되도록 제4 선량 예측 모델을 학습시키는 선량 평가 장치.공개특허 10-2022-0105035-5-청구항 16 제8항에서, 상기 랜덤 입력 변수로 선원 정보, 차폐체 정보를 지정하고, 상기 출력 변수로 차폐체 피폭 정보와 차폐 후 방사선 정보를 설정하여 상기 랜덤 입력 변수 값들의 조합에 기초하여 상기 출력 변수가 도출되도록 제5 선량 예측 모델을 학습시키는 선량 평가 장치."}
{"patent_id": "10-2021-0007578", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명에 따른 선량 평가 장치의 동작 방법으로써, 입력되는 피폭 시나리오마다 피폭 시나리오를 모사하기 위한 하나 이상의 변수들을 선별하고, 선별된 변수들 중에서 랜덤하게 값이 설정되는 하나 이상의 랜덤 입력 변수와 출력 변수를 선정하는 단계, 랜덤하게 생성되는 랜덤 입력 변수의 값마다 피폭 시나리오의 모사 과정에서 도출되 는 출력 변수 값을 수집하고, 입력되는 랜덤 입력 변수 값과 출력 변수 값을 매칭하여 학습 데이터를 생성하는 단계, 그리고 학습 데이터에 기초하여 랜덤 입력 변수 값을 입력하면, 매칭된 출력 변수 값이 도출되도록 선량 예측 모델을 학습시키는 단계를 포함한다."}
{"patent_id": "10-2021-0007578", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "선량 평가 기술에 관한 것이다."}
{"patent_id": "10-2021-0007578", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "방사선 수송 전산 모사를 통한 선량 평가는 1970년대 이후로 몬테칼로 기법이 사용되고 있다. 몬테칼로 기법은 다수의 입자를 생성하여, 입자의 이동 경로 및 물질과의 상호작용을 모사하는 기법으로, 정확도를 높이기 위해 수백만 번의 입자 생성을 통해 실제와 가장 유사한 모사 결과를 산출한다. 다만, 인체와 같은 복합 구조의 경우 에는 모사 구조의 복잡성과 물리 모델 선정 과정에 따라 컴퓨터의 성능에 따라 전산 모사 결과 산출까지 수 시 간에서 수 일이 소요되기 때문에 방사선 사고 발생시 실제 선원 위치를 반영한 구체적 피폭 상황을 신속하게 모 사하는데 한계가 있다. 이에 따라 종래의 방사선 피폭 사고 응급 상황 시 전산 모사 선량 평가 방법은 정렬장(parallel beam) 피폭을 가정하고 선원의 에너지, 피폭 방향 등 제한된 변수에 따라 미리 계산된 값(Lookup table)에 기초하여 수행되기 때문에 실제 피폭 상황과의 차이가 발생한다. 그러므로 대규모 방사선 피폭 사고 모사의 경우에는 피폭자가 대량으로 발생되기 때문에 빠른 의료적 처치를 위 해서 정확하면서도 신속한 전산모사 스크리닝 기법이 요구된다. 관련 선행문헌으로 한국등록특허 2,059,103호는 \" 인공신경망을 이용한 섬광체 기반 실시간 선량 측정 장치 및 방법 \"을 개시한다. 선행기술문헌 특허문헌 (특허문헌 0001) 한국등록특허 2,059,103"}
{"patent_id": "10-2021-0007578", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명의 한 실시예는 기존의 몬테칼로 전산모사 기법을 학습하여 선량 예측 모델을 구축하고, 학습이 완료된 선량 예측 모델을 통해 초고속 선량환산이 가능한 선량 평가 방법 및 장치를 제공하기 위한 것이다. 상기 과제 이외에도 구체적으로 언급되지 않은 다른 과제를 달성하는 데 본 발명에 따른 실시예가 사용될 수 있 다."}
{"patent_id": "10-2021-0007578", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명의 한 실시예에 따른 선량 평가 장치의 동작 방법으로써, 입력되는 피폭 시나리오마다 피폭 시나리오를 모사하기 위한 하나 이상의 변수들을 선별하고, 선별된 변수들 중에서 랜덤하게 값이 설정되는 하나 이상의 랜 덤 입력 변수와 출력 변수를 선정하는 단계, 랜덤하게 생성되는 랜덤 입력 변수의 값마다 피폭 시나리오의 모사 과정에서 도출되는 출력 변수 값을 수집하고, 입력되는 랜덤 입력 변수 값과 출력 변수 값을 매칭하여 학습 데 이터를 생성하는 단계, 그리고 학습 데이터에 기초하여 랜덤 입력 변수 값을 입력하면, 매칭된 출력 변수 값이 도출되도록 선량 예측 모델을 학습시키는 단계를 포함한다. 본 발명의 한 실시예에 따른 선량 평가 장치는 통신 장치, 명령어들을 포함하는 메모리, 그리고 상기 명령어들 을 실행하여 입력된 하나 이상의 변수에 기초하여 선량을 평가하는 프로세서를 포함하고, 프로세서는 입력되는 피폭 시나리오마다 피폭 시나리오를 모사하기 위한 하나 이상의 변수 중에서 랜덤하게 값이 설정되는 하나 이상 의 랜덤 입력 변수와 출력 변수를 선정하여, 랜덤 입력 변수 값에 따른 피폭 시나리오의 모사 과정에서 도출되 는 출력 변수 값을 수집하면, 랜덤 입력 변수 값을 입력하여, 출력 변수 값이 도출되도록 선량 예측 모델을 학 습시키고, 선량 예측 모델이 학습이 완료된 후, 선량 예측 모델이 학습이 완료된 후, 피폭 시나리오와 입력 변 수의 데이터를 입력받으면, 피폭 시나리오에 기초하여 학습된 선량 예측 모델에 입력 변수의 데이터를 입력하고, 학습된 선량 예측 모델로부터 획득한 출력 변수의 값을 출력한다."}
{"patent_id": "10-2021-0007578", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명의 한 실시예에 따르면, 실제 피폭 상황과 유사한 모사 결과를 산출하는 몬테칼로 기법을 그대로 선량 예측 모델에 적용하여 실제 피폭 상황과 유사한 정확도의 피폭 선량을 초고속으로 산출할 수 있다. 본 발명의 한 실시예에 따르면, 학습된 선량 예측 모델을 통해 선량 평가를 수행함으로써, 빠른 의료적 처치를 위해 신속하게 선별된 피폭자와 높은 정확도의 피폭 선량을 제공할 수 있다. 본 발명의 한 실시예에 따르면, 통제된 환경과 같이, 입력변수가 제한된 구조에서 일부 조작 변인만 변경하여 단순 반복 전산모사를 수행하는 경우, 소요되는 계산 시간을 크게 단축시킴으로써 관련 응용분야 연구의 효율성 을 높일 수 있다."}
{"patent_id": "10-2021-0007578", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "첨부한 도면을 참고로 하여 본 발명의 실시예에 대해 본 발명이 속하는 기술 분야에서 통상의 지식을 가진 자가 용이하게 실시할 수 있도록 상세히 설명한다. 본 발명은 여러 가지 상이한 형태로 구현될 수 있으며 여기에서 설명하는 실시예에 한정되지 않는다. 도면에서 본 발명을 명확하게 설명하기 위해서 설명과 관계없는 부분은 생략하였으며, 명세서 전체를 통하여 동일 또는 유사한 구성요소에 대해서는 동일한 도면부호가 사용되었다. 또한 널리 알려져 있는 공지기술의 경우 그 구체적인 설명은 생략한다. 명세서 전체에서, 어떤 부분이 어떤 구성요소를 \"포함\"한다고 할 때, 이는 특별히 반대되는 기재가 없는 한 다 른 구성요소를 제외하는 것이 아니라 다른 구성요소를 더 포함할 수 있는 것을 의미한다. 본 명세서에서 \"전송 또는 제공\"은 직접적인 전송 또는 제공하는 것뿐만 아니라 다른 장치를 통해 또는 우회 경 로를 이용하여 간접적으로 전송 또는 제공도 포함할 수 있다. 본 명세서에서 단수로 기재된 표현은 \"하나\" 또는 \"단일\" 등의 명시적인 표현을 사용하지 않은 이상, 단수 또는 복수로 해석될 수 있다. 본 명세서에서 입력 변수와 출력 변수는 숫자로 표시되는 값, 2D 이미지, 3D 구조, 그래프, 그리고 영상 정보의 형태를 포함할 수 있다. 도 1은 본 발명의 한 실시예에 따른 선량 평가 장치를 나타낸 구성도이고, 도 2는 본 발명의 한 실시예에 따른 모델 학습 과정을 설명하기 위한 예시도이다. 도 1에 도시한 바와 같이, 선량 평가 장치는 변수 설정기, 학습 데이터 생성기, 선량 예측 모델 을 학습시키는 학습기 그리고 학습된 모델을 이용하여 선량을 평가하는 선량 평가기를 포함할 수 있 다. 변수 설정기, 학습 데이터 생성기, 학습기 그리고 선량 평가기는 적어도 하나의 프로세서 에 의해 동작할 수 있다. 선량 평가 장치를 구성하는 일부 장치는 분리되어 구현될 수 있으며, 설명의 편 의를 위해 통합 구현된 것으로 설명한다. 예를 들면, 선량 평가기는 학습 완료된 선량 예측 모델과 연동하 는 것으로, 선량 예측 모델을 학습시키는 학습 데이터 생성기 그리고 학습기와 반드시 함께 구현될 필요는 없다. 변수 설정기는 입력되는 피폭 시나리오마다 해당 시나리오를 모사하기에 최적화된 하나 이상의 변수를 선 별한다. 여기서, 변수 설정기는 각 선량 평가 적용 분야별 통용되는 피폭 시나리오가 존재하는 경우, 해당 시나리 오 기반으로 변수들을 선별하며, 변수들의 값을 최적화할 수 있다. 또는 임의의 환경과 조건을 가지는 피폭 시나리오가 생성되어 입력되는 경우 해당 피폭 시나리오에 기초하여 모 델링을 수행할 때 필요한 요소들을 변수로 선별할 수 있다. 이러한 최적화된 변수들은 적용 분야별, 피폭 시나리오 별로 따라 달라질 수 있다. 그리고 변수 설정기는 피폭 시나리오에 따른 하나 이상의 변수들 중에서 랜덤하게 값이 설정되는 랜덤 입 력 변수를 지정하여 학습 데이터 생성기로 전송한다. 한편, 변수 설정기는 구체적 전산모사를 위한 피폭 시나리오, 입력변수의 데이터, 출력변수의 종류를 입력 받는 경우에는 해당 피폭 시나리오 및, 피폭 시나리오에 따른 최적화된 입력 및 출력 변수 세트 선별하여 선량 평가기로 전송한다. 이때 선별된 변수 세트 중 입력 변수 세트에 대해서는 입력변수의 데이터를 설정한다. 학습 데이터 생성기는 피폭 시나리오에 따른 랜덤 입력 변수에 기초하여 해당 피폭 시나리오를 모델링하여 시뮬레이션을 통해 획득한 하나 이상의 결과 변수를 수집한다. 학습 데이터 생성기는 랜덤 입력 변수의 값에 기초하여 해당 피폭 시나리오를 반복적으로 시뮬레이션을 수 행한다. 그리고 학습 데이터 생성기는 랜덤 입력 변수의 값마다 시뮬레이션을 통해 도출되는 결과 변수의 값을 매칭하여 학습 데이터로 생성할 수 있다. 학습 데이터 생성기는 랜덤 입력 변수의 개수, 종류에 기초하여 생성한 학습 데이터를 연동하는 데이터베 이스에 저장하여 관리할 수 있다. 또한, 학습 데이터 생성기는 신속한 학습 데이터의 확보를 위해 선원의 입체각을 선정하여 계산 영역을 한 정할 수 있다. 여기서, 피폭 시나리오를 모델링하여 시뮬레이션을 수행하는 과정은 몬테칼로 전산모사 기법(Monte Carlo N- Paricle transport code, MCNP)을 이용할 수 있다. 상세하게는 도 2에 도시한 바와 같이, 학습 데이터 생성기는 몬테칼로 전산모사(MCNP simulation, 200)에 기초하여 하나 이상의 입력 변수(A)를 통해 하나 이상의 출력변수(B)를 획득할 수 있다. 이때, 학습 데이터 생성기는 몬테칼로 전산모사를 수행하는 프로그램을 포함하거나 몬테칼로 전산모사를 수행하는 외부 장치 또는 몬테칼로 전산모사의 입력 변수와 출력 변수들을 저장하는 데이터베이스에 접속하여 입력 변수와 대응하는 출력 변수를 수집할 수 있다. 따라서, 학습 데이터 생성기는 몬테칼로 전산모사에 입력된 입력 변수(A)에 의해 도출되는 출력 변수(B)를 서로 매칭하여 학습데이터로 생성하며 이를 학습기에 전달한다. 그러면, 학습기는 입력 변수(A)가 입력되면 출력 변수(B)가 도출되도록 선량 예측 모델을 반복 학습시킬 수 있다. 학습기는 생성된 학습 데이터를 선량 예측 모델에 입력하기 위해 전처리 과정을 수행할 수 있다. 이때, 학습기는 입력 변수에 대한 정규화 또는 출력 변수에 대한 역수 처리 등과 같이, 선량 예측 모델의 학습에 적합하도록 학습데이터들을 전처리할 수 있다. 학습기는 전처리된 학습 데이터의 랜덤 입력 변수에 대한 랜덤 값들을 선량 예측 모델에 입력하고, 해당 랜덤 값마다 매칭된 출력 변수가 도출되도록 반복적으로 학습시킨다. 다시 말해 학습기는 몬테칼로 전산모사 자체를 선량 예측 모델로 학습시키기 위해 전산모사에 사용된 입력 변수와 출력 변수를 동일하게 선량 예측 모델에 적용한다. 여기서, 선량 예측 모델은 시나리오 별, 입력 변수와 출력 변수의 개수 및 종류별로 적용되는 태스크의 특성에 따라 적합한 모델로서 구현될 수 있다. 예를 들어, 합성곱 신경망(Convolutional Neural Network, CNN), 순환 신경망(Recurrent Neural Network, RNN), 딥러닝(Deep Neural Network, DNN), 장단기 기억 구조(Long Short-Term Memory, LSTM), 어텐션 (Attention) 메커니즘 기반의 Transformer 등으로 구현될 수 있으며, 어느 하나로 한정되는 것은 아니다. 선량 평가기는 입력된 피폭 시나리오에 따라 학습된 선량 예측 모델을 이용하여 입력 변수값을 입력하여 해당 입력 변수에 따른 출력 변수 값을 제공한다. 상세하게는 선량 평가기는 피폭 시나리오, 입력 변수의 데이터와 출력 변수의 종류를 입력받으면, 해당 피 폭 시나리오에 대응하여 입력 변수에 대응되는 해당 출력 변수를 가지는 학습된 선량 예측 모델을 선택한다. 그리고 선량 평가기는 선택한 선량 예측 모델을 통해 입력 변수의 데이터에 따른 선량 평가 결과를 산출할 수 있다. 다시 말해, 특정 시나리오에서 랜덤 입력 변수의 값을 변경하여 선량 예측 모델을 학습한 후, 추후에 사용자로 부터 랜덤 입력 변수에 대응하는 입력 변수 데이터를 입력받아 학습된 선량 예측 모델에 입력하여 대응하는 출 력 변수를 획득할 수 있다. 여기서 사용자가 입력한 구체적 피폭 시나리오, 입력변수 데이터 및 출력변수 종류 는 특정 선량 예측 모델에서 사용된 랜덤 입력변수 및 출력변수에 대응된다. 이하에서는 도 3 및 도 4를 이용하여 선량 평가 장치의 선량 예측 모델 학습 과정에 대해서 상세하게 설명한다. 도 3은 본 발명의 한 실시예에 따른 선량 평가 장치의 학습 방법을 나타낸 순서도이다. 도 3에 도시한 바와 같이, 선량 평가 장치는 피폭 시나리오마다 시나리오를 모사하기에 최적화된 하나 이 상의 변수를 선별하고, 랜덤하게 값이 설정되는 랜덤 입력 변수와 출력 변수를 지정한다(S110). 예를 들어, 선량 평가 장치는 외부 피폭에 의한 인체선량평가를 위한 전산모사의 경우, 피폭을 일으킬 수 있는 선원들로 인한 인체 팬텀의 선량을 평가하도록 시나리오가 정해질 수 있다. 이러한 종류의 시나리오를 모 델링하기에 최적화된 변수들은 선원의 종류, 개수, 분포, 인체팬텀의 체중, 키, 성별 등이 될 수 있다. 그리고 선량 평가 장치는 랜덤 입력 변수를 지정하고, 해당 랜덤 입력 변수 이외의 변수들의 값은 일정하 게 유지하면서, 랜덤 입력 변수의 값만 달리 설정할 수 있다. 여기서, 선량 평가 장치는 해당 피폭 시나 리오에 기초하여 도출하고자 하는 출력 변수와 밀접한 관계가 있는 하나 이상의 변수를 랜덤 입력 변수로 지정 할 수 있다. 또는 선량 평가 장치는 피폭 시나리오마다 랜덤 입력 변수로 지정 가능한 변수들이 기재된 가 이드 데이터에 기초하여 하나 이상의 변수를 랜덤 입력 변수를 지정할 수 있다. 이때, 선량 평가 장치는 가이드 데이터에 기재된 모든 변수들의 조합으로 랜덤 입력 변수의 종류 및 세부 값, 출력 변수의 종류, 세부 값들을 설정할 수 있다. 여기서, 랜덤 입력 변수 및 출력 변수는 각각 하나 이상의변수들이 설정 가능하다. 다음으로 선량 평가 장치는 랜덤 입력 변수와 출력 변수에 기초하여 몬테칼로 시뮬레이션을 통해 학습 데 이터들을 생성한다(S120). 선량 평가 장치는 피폭 시나리오에 기초하여 랜덤 입력 변수의 값을 랜덤하게 생성하여 몬테칼로 전산모사 에 입력할 입력 파일을 생성할 수 있다. 이때, 랜덤 입력 변수가 복수 개 일 경우, 해당 랜덤 입력 변수마다 랜 덤하게 생성된 값에 기초하여 입력 파일을 생성할 수 있다. 그리고 선량 평가 장치는 몬테칼로 전산모사를 통해 입력 파일을 연속 실행하고, 실행 단계마다 지정된 출 력 변수를 포함하는 출력 파일이 획득되도록 조건을 설정할 수 있다. 이에 선량 평가 장치는 입력 파일과 출력 파일에 기초하여 입력 변수와 출력 변수를 매칭하여 학습 데이터를 생성한다. 다음으로 선량 평가 장치는 학습 데이터를 전처리하고, 전처리된 학습 데이터의 랜덤 입력 변수 값을 입력 하면, 매칭된 출력 변수가 도출되도록 선량 예측 모델을 학습시킨다(S130). 선량 평가 장치는 스케일(scale)차이 보정을 위한 데이터 전처리 과정을 수행할 수 있다. 예를 들어, 입력 변수를 정규화하거나 출력 변수의 역수, 좌표변환 처리 등을 포함한다. 그리고 선량 평가 장치는 선량 예측 모델의 학습을 통해 하이퍼 파라미터의 최적화를 위해 손실함수가 최 소가 되도록 반복 학습시킨다. 여기서, 하이퍼 파라미터는 뉴런 개수, layer 수, 활성화 함수 및 배치 크기 등 을 포함한다. 또한, 선량 평가 장치는 선량 예측 모델이 일부 학습 데이터에 과적합(overfitting)되지 않도록 학습 데이 터의 순서를 랜덤하게 섞거나 입력 변수의 범위를 조절하거나 학습 데이터를 정규화하거나 노이즈 추가 또는 학 습 데이터 내의 변수 값의 비율을 조절하는 등을 수행할 수 있다. 선량 평가 장치는 해당 선량 예측 모델의 학습 완료 여부를 판단하고(S140), 학습 완료 전이면 S130 단계 로 회귀하여 학습을 반복한다. 이때 선량 평가 장치는 학습데이터에 대한 손실 함수가 임계치 이하가 되면 학습이 완료되었다고 판단할 수 있다. 다음으로 선량 평가 장치는 학습이 완료되면, 학습 완료된 선량 예측 모델을 출력한다(S150). 도 4는 본 발명의 한 실시예에 따른 학습 데이터를 수집하는 과정에서 선원의 입체각을 선정하는 과정을 설명하 기 위한 예시도이다. 도 4에 도시한 바와 같이, 선량 평가 장치는 학습 데이터를 수집하기 위한 전산모사 계산 시간을 단축하기 위해 팬텀에 대한 선원 입체각을 선정할 수 있다. 상세하게는 선량 평가 장치는 입력 변수 중 선원의 위치에 기초하여 선원의 입체각을 형성한다. 도 4의 (a)는 직사각형의 모양으로 구현된 팬텀 영역에 대해서만 계산을 수행하도록 선원과 팬텀 을 연결하는 벡터들을 통해 각도를 산출하는 과정을 나타내고, (b)는 선정된 입체각을 나타낸 예시도이다. 상세하게는 선량 평가 장치는 선원의 지점에서 팬텀의 중점(402-1)을 연결하는 기준 벡터를 생 성하고, 선원의 지점에서 각 팬텀의 모서리를 연결하는 벡터들을 생성한다. 그리고 선량 평가 장치 는 기준 벡터에서 각 모서리를 연결한 벡터들과의 각도(a, b, c)를 산출하고, 산출된 각도 중에서 가장 큰 각도(c)를 선택한다. 그러면, 선량 평가 장치는 기준 벡터에서 각 방향마다 선택한 각도(c)를 가지도록 입체각을 선정하게 된다. 이를 통해 선량 평가 장치는 선원에 의한 해당 팬텀을 포함하는 영역에 대해서만 선량을 예측하 도록 범위를 한정함으로써, 계산 시간을 단축하여 빠르게 학습데이터를 수집할 수 있다. 도 4에서는 하나의 선원과 하나의 팬텀에 대해서만 도시하였지만, 피폭 시나리오에 기초하여 선원과 팬텀의 개 수는 랜덤하게 설정될 수 있다. 이에 따라 다수 개의 선원과 다수개의 팬텀에 대해서 각각 선원을 기준으로 팬텀을 모두 포함하는 영역을 산출 하여 선원의 입체각을 선정할 수 있다. 이외에도 팬텀의 위치가 겹쳐지는 경우, 선원은 겹쳐지는 팬텀들을 하나의 팬텀으로 추정하고, 선원의 입체각을 선정할 수 있다. 도 5는 본 발명의 한 실시예에 따른 선량 예측 모델의 종류를 나타낸 예시도이다. 도 5에 도시한 바와 같이, 선량 예측 모델은 크게 외부 피폭 시나리오에 대한 선량 예측 모델, 내부 피폭 시나 리오에 대한 선량 예측 모델 그리고 차폐체에 대한 선량 예측 모델을 포함한다. 이러한 선량 예측 모델의 종류 는 예시로 반드시 이에 한정하는 것은 아니다. 선량 예측 모델은 시나리오 별, 입력 변수와 출력 변수의 종류에 기초하여 각각 독립적인 인공지능 모델로 구현 될 수 있다. 예를 들어, 외부 피폭 시나리오에 기초하여 선량 예측 모델 중에서 예측 모델 #1(제1 선량 예측 모델)에 입력 변수로 선원정보, 피폭대상 정보가 입력되면, 출력 변수로 인체 선량, 선량계 선량, 비상선량계 선량, 선량 환 산 계수가 도출될 수 있다. 여기서, 선원정보는 방출입자(p, e, n 등), 선원 분포, 에너지 분포, 방사능량(activity)에 대한 각각의 세부 값들을 가지며, 피폭대상정보로는 인체팬텀(체중, 키, 성별, 나이, 자세, 위치, 누적 피폭시간), 선량계(종류 (EPD, TLD, OSLD 등) 및 착용 위치, 누적 피폭시간), 비상 선량계 (종류(휴대전화유리, 신용카드 등) 및 착용 위치, 누적 피폭시간), 그리고 기타피폭물질(기하구조, 분자구조, 밀도, 위치, 누적 피폭시간)에 대한 세부 값 들을 가질 수 있다. 그리고 출력 변수의 인체 선량은 장기흡수선량, 전신흡수선량, 유효선량에 대한 세부 값들, 선량계 선량은 선량 률, 흡수선량, 선량당량(Hp 에 대한 세부 값들, 비상선량계 선량은 선량률, 흡수선량에 대한 세부 값들, 선 량환산계수는 표지물질선량-인체선량 환산계수에 대한 세부 값들 가질 수 있다. 이때, 학습된 예측 모델 #1(제1 선량 예측 모델)에 적용하기 위해서 세부 값들을 모두 입력해야 하는 것은 아니 며, 하나 이상의 세부 값을 입력받을 수 있다. 이러한 입력 조건 또는 출력 조건은 예측 모델#1(제1 선량 예측 모델)의 학습 데이터의 구성과 학습 과정에 기 초하여 설정 가능하며, 각 상이한 입력 조건에 따라 세분화된 예측 모델을 구축할 수도 있다. 예를 들어, 예측 모델 #n으로 랜덤 입력 변수로 선원정보로 방출 입자와 선원 분포가 설정되고, 피폭 대상 정보 로 인체 팬텀으로 체중, 키와 선량계로 종류, 누적 피폭 시간이 설정되어 학습은 완료한 경우, 이후에 랜덤 입 력 변수로 설정되었던 입력 변수를 입력받아 학습된 예측 모델 #n에 입력하고, 그에 따른 출력 변수를 획득할 수 있다. 이외에도 예측 모델 #2(제2-1 선량 예측 모델)는 예측 모델 #1의 입력 변수에 인체 동선(시간에 따른 인체 위치 함수)이 추가되며, 예측 모델 #3(제2-2 선량 예측 모델)은 예측 모델 #1의 입력 변수에 차폐체 정보(기하구조, 분자구조, 밀도, 위치 등)가 추가되고, 그리고 예측 모델 #4(제2-3 선량 예측 모델)는 예측 모델 #1의 입력 변 수에 인체 동선(시간에 따른 인체 위치함수)과 차폐체 정보(기하구조, 분자구조, 밀도, 위치 등)가 추가되어 학 습될 수 있다. 또한, 내부 피폭 시나리오에 기초하여 선량 예측 모델 중에서 예측 모델 #1(제3 선량 예측 모델)에 입력 변수 로는 계측값(전신계수기, 갑상선계수기, 소변시료 감마분광 측정값 등), 인체정보(체중, 키, 성별, 나이, 섭취 시점 등)가 입력되면, 출력 변수로 선원항(섭취 방사능량(activity))가 도출될 수 있다. 내부 피폭의 예측 모델 #2(제4 선량 예측 모델)에 입력 변수로 선원정보(섭취 방사능량(activity), 선원형태(입 자크기, 기체, 액체, 고체), 방출입자(p, e, n 등), 에너지 분포), 인체팬텀정보(체중, 키, 성별, 나이, 누적 피폭시간, 대사율)가 입력되면, 출력 변수로 인체선량(장기흡수선량, 예탁유효선량)이 도출될 수 있다. 한편, 차폐 구조에 기초하여 예측 모델 #1(제5 선량 예측 모델)인 경우, 입력 변수로 선원정보 (방출입자(p, e, n 등), 선원 분포, 에너지 분포, 방사능량(activity)), 차폐체(기타피폭물질 - 기하구조, 분자구조, 밀도, 위치, 누적 피폭시간)이 입력되면 출력 변수고 차폐체 피폭정보(차폐체 내 에너지흡수 분포, 에너지 스펙트럼), 차폐 후 방사선정보(위치에 따른 에너지 분포 및 스펙트럼)가 도출될 수 있다. 이와 같이, 선량 예측 모델은 각 입력 변수의 종류, 세부 값, 출력 변수의 종류 그리고 세부 값에 기초하여 세 분화될 수 있으며, 각각 조건에 기초하여 생성된 학습 데이터로 반복 학습을 수행한 후, 학습된 선량 예측 모델을 통해 입력 변수의 종류 및 세부 값을 입력하여 대응하는 출력 변수의 종류 및 세부값을 도출할 수 있다. 도 6은 본 발명의 한 실시예에 따른 선량 평가 장치의 선량 평가하는 방법을 나타낸 순서도이다. 도 6에 도시한 바와 같이, 선량 평가 장치는 적용하고자 하는 피폭 시나리오를 선택하고 입력 변수의 데이 터를 입력받는다(S210). 여기서, 선량 평가 장치는 특정 분야에 대한 통용되는 시나리오가 정해져 있다면, 피폭 시나리오를 입력받 지 않을 수 있으므로 반드시 피폭 시나리오를 입력받는 것은 아니다. 이에 선량 평가 장치는 입력 변수의 데이터를 입력받으면, 저장된 시나리오에 기초하여 입력 변수가 랜덤 입력 변수로 지정되어 있는 시나리오를 검색하여 선택할 수 있다. 다음으로 선량 평가 장치는 피폭 시나리오에 따라 선별되는 변수들 중에서 입력된 입력 변수의 데이터를 설정한다(S220). 선량 평가 장치는 해당 피폭 시나리오에 기초하여 적용되는 변수들에 대해서 기본 값이 설정되고, 해당 입 력 변수에 대해서는 입력받은 데이터를 설정한다. 그리고 선량 평가 장치는 피폭 시나리오에 따라 학습된 선량 예측 모델에 입력 변수의 데이터를 입력하고, 설정된 출력 변수의 값을 획득하여 선량평가 결과 산출한다(S230). 여기서, 출력 변수에 대한 종류나 세부 사항에 대해서 별도로 설정하지 않아도, 학습된 선량 예측 모델에 기초 하여 학습과정에서 설정된 출력 변수의 값이 출력된다. 선량 평가 장치는 출력된 출력 변수의 값을 연동되는 디스플레이에 표시하거나 파일 형태로 출력 가능하다. 그리고 예를 들어 선량 평가 장치로부터 산출된 결과는 이후 선량 환산 인자 계산 등에 사용될 수 있다. 도 7은 본 발명의 한 실시예에 따른 선량 예측 모델에 대한 가상 데이터의 손실 함수를 나타낸 그래프이다. 도 7은 학습이 완료된 선량 예측 모델에 대한 학습 데이터의 손실 함수(train loss)와 가상 데이터의 손실 함수 (val loss)를 나타낸 그래프이다. 여기서, 학습 데이터와 가상 데이터는 입력 변수로 선원 위치 좌표(x, y, z)의 값을 설정하고 그에 따른 출력 변수로 선량값이 매칭된 데이터들이다. 그리고 학습 데이터는 학습에 사용된 데이터이고, 가상 데이터는 학습으 로 사용되지 않은 입력 변수와 출력 변수가 매칭된 데이터를 나타내며, 몬테칼로 전사모사를 통해 획득한 데이 터이다. 도 7에서 도시한 바와 같이, 학습 데이터에 대한 손실 함수는 학습이 반복될수록 0에 수렴하는 것을 알 수 있다. 그리고 가상 데이터에 대한 손실 함수는 초기에는 학습 데이터에 대한 손실 함수와 일부 차이가 있지만, 일정한 반복 횟수에 따라 학습 데이터에 대한 손실 함수와 근소한 차이를 나타낸다. 이외에도, 동일한 입력변수에 기초하여 몬테칼로 전산모사를 통해 획득한 선량 값과 선량 예측 모델을 통해 획 득한 선량값을 비교하면, 평균적으로 오차율이 약 0.365%로 최대 오차율 5.56%, 최소 오차율0.001%를 가진다. 이를 통해 선량 예측 모델이 실제 몬테칼로 전산모사의 기법을 그대로 학습하여 별도로 모델링 과정을 거치지 않고도 유사한 정확도의 출력 변수 값을 획득할 수 있음을 알 수 있다. 도 8은 본 발명의 한 실시예에 따른 컴퓨팅 장치의 하드웨어 구성도이다. 도 8을 참고하면, 변수 설정기, 학습 데이터 생성기, 학습기 그리고 선량 평가기는 적어도 하나의 프로세서에 의해 동작하는 컴퓨팅 장치에서, 본 발명의 동작을 실행하도록 기술된 명령들 (instructions)이 포함된 프로그램을 실행한다. 컴퓨팅 장치의 하드웨어는 적어도 하나의 프로세서, 메모리, 스토리지, 통신 인터페이스 를 포함할 수 있고, 버스를 통해 연결될 수 있다. 이외에도 입력 장치 및 출력 장치 등의 하드웨어가 포함 될 수 있다. 컴퓨팅 장치는 프로그램을 구동할 수 있는 운영 체제를 비롯한 각종 소프트웨어가 탑재될 수 있다.프로세서는 컴퓨팅 장치의 동작을 제어하는 장치로서, 프로그램에 포함된 명령들을 처리하는 다양한 형태의 프로세서일 수 있고, 예를 들면, CPU(Central Processing Unit), MPU(Micro Processor Unit), MCU(Micro Controller Unit), GPU(Graphic Processing Unit) 등 일 수 있다. 메모리는 본 발명의 동작을 실행하도록 기술된 명령들이 프로세서에 의해 처리되도록 해당 프로그램을 로드한다. 메모리는 예를 들면, ROM(read only memory), RAM(random access memory) 등 일 수 있다. 스토리지는 본 발명의 동작을 실행하는데 요구되는 각종 데이터, 프로그램 등을 저장한다. 통신 인터페이스는 유/무선 통신 모듈일 수 있다. 본 발명에 따르면, 실제 피폭 상황과 유사한 모사 결과를 산출하는 몬테칼로 기법을 그대로 선량 예측 모델에 적용하여 실제 피폭 상황과 유사한 정확도의 피폭 선량을 초고속으로 산출할 수 있다. 본 발명에 따르면, 학습된 선량 예측 모델을 통해 선량 평가를 수행함으로써, 빠른 의료적 처치를 위해 신속하 게 선별된 피폭자와 높은 정확도의 피폭 선량을 제공할 수 있다. 이상에서 본 발명의 바람직한 실시예에 대하여 상세하게 설명하였지만 본 발명의 권리범위는 이에 한정되는 것 은 아니고 다음의 청구범위에서 정의하고 있는 본 발명의 기본 개념을 이용한 당업자의 여러 변형 및 개량 형태 또한 본 발명의 권리범위에 속하는 것이다."}
{"patent_id": "10-2021-0007578", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 한 실시예에 따른 선량 평가 장치를 나타낸 구성도이다. 도 2는 본 발명의 한 실시예에 따른 모델 학습 과정을 설명하기 위한 예시도이다. 도 3은 본 발명의 한 실시예에 따른 선량 평가 장치의 학습 방법을 나타낸 순서도이다. 도 4는 본 발명의 한 실시예에 따른 학습 데이터를 수집하는 과정에서 선원의 입체각을 선정하는 과정을 설명하 기 위한 예시도이다. 도 5는 본 발명의 한 실시예에 따른 선량 예측 모델의 종류를 나타낸 예시도이다. 도 6은 본 발명의 한 실시예에 따른 선량 평가 장치의 선량 평가하는 방법을 나타낸 순서도이다. 도 7은 본 발명의 한 실시예에 따른 선량 예측 모델에 대한 가상 데이터의 손실 함수를 그래프이다. 도 8은 본 발명의 한 실시예에 따른 컴퓨팅 장치의 하드웨어 구성도이다."}
