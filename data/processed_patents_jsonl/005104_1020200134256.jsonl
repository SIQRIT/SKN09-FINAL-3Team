{"patent_id": "10-2020-0134256", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2022-0050504", "출원번호": "10-2020-0134256", "발명의 명칭": "안면 이미지 변환 장치 및 안면 이미지 변환 방법", "출원인": "주식회사 케이티", "발명자": "송병훈"}}
{"patent_id": "10-2020-0134256", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "1장의 소스 이미지를 워핑(Warping) 및 스케일 변환하여 여러 각도와 거리를 갖는 다수의 안면 이미지 학습데이터를 생성하는 제 1 단계; 상기 안면 이미지 학습데이터를 생성적 대립 신경망(GAN)에 기반하여 심층 학습함으로써 안면 이미지 변환모듈을 생성하는 제 2 단계; 및 상기 안면 이미지 변환모듈에 변환하고자 하는 입력 이미지를 입력하여 학습된 이미지와 유사한 출력 이미지를생성하는 제 3 단계를 포함하는 것을 특징으로 하는 GAN 기반의 안면 이미지 변환방법."}
{"patent_id": "10-2020-0134256", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제 1 항에 있어서, 상기 제 1 단계는, 상기 1장의 소스 이미지에 기반하여 상,하,좌,우로 일정한 각도 회전된 다수의 워핑 이미지를 생성하는 워핑 단계와; 상기 워핑 이미지의 안면 이미지의 스케일을 조정하는 스케일 변환단계;를 포함하는 것을 특징으로 하는 GAN 기반의 안면 이미지 변환방법."}
{"patent_id": "10-2020-0134256", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제 2 항에 있어서, 상기 워핑 이미지는 상기 소스 이미지를 상,하 20도 범위내 그리고, 좌,우 30도 범위내로 회전시킨 것을 특징으로 하는 GAN 기반의 안면 이미지 변환방법."}
{"patent_id": "10-2020-0134256", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제 3 항에 있어서, 상기 워핑 단계는, 상기 소스 이미지로부터 여러개의 히트맵을 생성하고, 상기 히트맵을 FC 레이어를 거쳐서 Affine 변환식의 계수들을 얻고, 상기 Affine 변환식에 기반하여 순차적으로 이미지를 딥러닝시키는 것에 의해 Affine 변환식 네트워크를 얻고, 이 Affine 변환식 네트워크를 통해 상기 워핑 이미지를 생성하는 것을 특징으로 하는 GAN 기반의 안면 이미지 변환방법."}
{"patent_id": "10-2020-0134256", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제 2 항에 있어서, 상기 스케일이 0.25배로부터 1.5배까지 조정되는 것을 특징으로 하는 GAN 기반의 안면 이미지 변환방법."}
{"patent_id": "10-2020-0134256", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제 1 항에 있어서, 상기 제 2 단계는, 워핑 및 스케일이 변환된 상기 안면 이미지 학습데이터를 랜드마크 학습데이터로 변환하는 단계와; 상기 안면 이미지 학습데이터를 스타일 인코딩한 데이터의 산술연산 곱을 산출하는 단계와; 상기 랜드마크 학습데이터를 GAN 모듈의 생성기의 초기 입력으로 하고, 상기 산술연산 곱을 상기 생성기의 네트워크 레이어별로 입력하여 GAN 모듈의 식별기로 하여금 판별하게 함으로써 생성모델과 판별모델이 경쟁하면서심층학습하는 것에 의해 상기 안면 이미지 변환모듈을 생성하는 단계를 포함하는 것을 특징으로 하는 GAN 기반의 안면 이미지 변환방법.공개특허 10-2022-0050504-3-청구항 7 제 6 항에 있어서, 상기 산출연산 곱을 산출하는 단계는,상기 스타일 인코딩을 통해 나온 특징의 시그모이드(Sigmoid) 함수와 상기 안면 이미지 학습데이터가 네트워크의 레이어를 거쳐 나온 특징을 행렬 산술연산 곱(Element-wise multiplication)을 하는 것을 특징으로 하는 GAN기반의 안면 이미지 변환방법."}
{"patent_id": "10-2020-0134256", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제 1 항에 있어서, 상기 제 3 단계는, 변환하고자 하는 입력 이미지의 변형 랜드마크를 생성하는 단계와; 상기 안면 이미지 변환모듈이 상기 변형 랜드마크에 기반하여 상기 학습된 이미지와 유사한 출력 이미지를 생성하는 단계를 포함하는 것을 특징으로 하는 GAN 기반의 안면 이미지 변환방법."}
{"patent_id": "10-2020-0134256", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제 8 항에 있어서, 상기 변형 랜드마크는 상기 학습된 이미지의 랜드마크의 위치평균과 분산을 구하고, 이 위치평균과 분산에 기반하여 상기 입력 이미지의 랜드마크의 위치의 평균과 분산을 조정한 것을 특징으로 하는 GAN 기반의 안면 이미지변환방법."}
{"patent_id": "10-2020-0134256", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "안면 이미지 변환 동작을 훈련하기 위한 장치로서, 하나 이상의 프로세서; 및 상기 하나 이상의 프로세서에 결합되어 입력 이미지를 학습된 이미지와 유사한 출력 이미지로 변환하기 위해 상기 하나 이상의 프로세서에 의해 실행 가능한 하나 이상의 프로그램 모듈들을 포함하는 메모리를 포함하고; 상기 프로그램 모듈은, 소스 이미지를 상,하,좌,우로 일정한 각도 회전시키고 이미지의 스케일을 조정하여 1장의 소스 이미지로부터 각도와 거리를 달리하는 다수의 안면 이미지 학습데이터를 생성하는 이미지 전처리 모듈과; 상기 다수의 안면 이미지 학습데이터를 생성모델과 판별모델이 경쟁하면서 심층 학습하는 생성적 대립 신경망(GAN) 기반의 GAN 모듈을 포함하는 것을 특징으로 하는 안면 이미지 변환 동작을 훈련하는 장치."}
{"patent_id": "10-2020-0134256", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "제 10 항에 있어서, 상기 이미지 전처리 모듈은, 상기 1장의 소스 이미지에 기반하여 상,하,좌,우로 일정한 각도 회전된 다수의 워핑 이미지를 생성하는 워핑부와; 상기 워핑 이미지의 안면 이미지의 스케일을 조정하는 스케일 변환부;를 포함하는 것을 특징으로 하는 안면 이미지 변환 동작을 훈련하는 장치."}
{"patent_id": "10-2020-0134256", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제 11 항에 있어서, 상기 워핑부는, 상기 소스 이미지로부터 여러개의 히트맵을 생성하고, 상기 히트맵을 FC 레이어를 거쳐서 Affine 변환식의 계수들을 얻고, 상기 Affine 변환식에 기반하여 순차적으로 이미지를 딥러닝시키는 것에 의해 생성되는 Affine 변환식 네트워크인 것을 특징으로 하는 안면 이미지 변환 동작을 훈련하는 장치."}
{"patent_id": "10-2020-0134256", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "제 11 항에 있어서, 공개특허 10-2022-0050504-4-상기 GAN 모듈은 생성기와 식별기를 포함하고, 워핑 및 스케일이 변환된 상기 안면 이미지 학습데이터로부터 생성되는 랜드마크 학습데이터를 상기 생성기의초기 입력으로 하고, 상기 안면 이미지 학습데이터를 스타일 인코딩한 데이터의 산술연산 곱을 상기 생성기의네트워크 레이어별로 입력하여 상기 식별기로 하여금 판별하게 함으로써 생성모델과 판별모델이 경쟁하면서 심층학습하는 생성적 대립 신경망인 것을 특징으로 하는 안면 이미지 변환 동작을 훈련하는 장치."}
{"patent_id": "10-2020-0134256", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_14", "content": "제 13 항에 있어서, 상기 산술연산 곱은, 상기 스타일 인코딩을 통해 나온 특징의 시그모이드(Sigmoid) 함수와 상기 안면 이미지 학습데이터가 네트워크의 레이어를 거쳐 나온 특징을 행렬 산술연산 곱(Element-wise multiplication)을 하는 것을 특징으로 하는 안면 이미지 변환 동작을 훈련하는 장치."}
{"patent_id": "10-2020-0134256", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_15", "content": "입력 이미지를 학습된 이미지와 유사한 출력 이미지로 변환하는 안면 이미지 변환장치로서, 하나 이상의 인스트럭션들을 저장하는 메모리; 및상기 메모리에 저장된 상기 하나 이상의 인스트럭션들을 실행하는 프로세서를 포함하고,상기 프로세서는, 1장의 소스 이미지를 워핑(Warping) 및 스케일 변환하여 여러 각도와 거리를 갖는 다수의 안면 이미지 학습데이터를 생성하는 제 1 단계와, 상기 안면 이미지 학습데이터를 생성적 대립 신경망(GAN)에 기반하여 심층 학습함으로써 안면 이미지 변환모듈을 생성하는 제 2 단계 및 상기 안면 이미지 변환모듈에 변환하고자 하는 입력 이미지를 입력하여 학습된 상기 소스 이미지와 유사한 출력이미지를 생성하는 제 3 단계를 포함하는 프로세스를 실행하는 것을 특징으로 하는 안면 이미지 변환장치."}
{"patent_id": "10-2020-0134256", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_16", "content": "제 15 항에 있어서, 상기 제 1 단계는, 상기 1장의 소스 이미지에 기반하여 상,하,좌,우로 일정한 각도 회전된 다수의 워핑 이미지를 생성하는 워핑 단계와; 상기 워핑 이미지의 안면 이미지의 스케일을 조정하는 스케일 변환단계;를 포함하는 것을 특징으로 하는 안면이미지 변환장치."}
{"patent_id": "10-2020-0134256", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_17", "content": "제 16 항에 있어서, 상기 워핑 단계는, 상기 소스 이미지로부터 여러개의 히트맵을 생성하고, 상기 히트맵을 FC 레이어를 거쳐서 Affine 변환식의 계수들을 얻고, 상기 Affine 변환식에 기반하여 순차적으로 이미지를 딥러닝시키는 것에 의해 Affine 변환식 네트워크를 얻고, 이 Affine 변환식 네트워크를 통해 상기 워핑 이미지를 생성하는 것을 특징으로 하는 안면 이미지변환장치."}
{"patent_id": "10-2020-0134256", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_18", "content": "제 15 항에 있어서, 상기 제 2 단계는, 워핑 및 스케일이 변환된 상기 안면 이미지 학습데이터를 랜드마크 학습데이터로 변환하는 단계와; 상기 안면 이미지 학습데이터를 스타일 인코딩한 데이터의 산술연산 곱을 산출하는 단계와; 상기 랜드마크 학습데이터를 GAN 모듈의 생성기의 초기 입력으로 하고, 상기 산술연산 곱을 상기 생성기의 네트워크 레이어별로 입력하여 GAN 모듈의 식별기로 하여금 판별하게 함으로써 생성모델과 판별모델이 경쟁하면서공개특허 10-2022-0050504-5-심층학습하는 것에 의해 상기 안면 이미지 변환모듈을 생성하는 단계를 포함하는 것을 특징으로 하는 안면 이미지 변환장치."}
{"patent_id": "10-2020-0134256", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_19", "content": "제 18 항에 있어서, 상기 산출연산 곱을 산출하는 단계는,상기 스타일 인코딩을 통해 나온 특징의 시그모이드(Sigmoid) 함수와 상기 안면 이미지 학습데이터가 네트워크의 레이어를 거쳐 나온 특징을 행렬 산술연산 곱(Element-wise multiplication)을 하는 것을 특징으로 하는 안면 이미지 변환장치."}
{"patent_id": "10-2020-0134256", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_20", "content": "제 15 항에 있어서, 상기 제 3 단계는, 변환하고자 하는 입력 이미지의 변형 랜드마크를 생성하는 단계와; 상기 안면 이미지 변환모듈이 상기 변형 랜드마크에 기반하여 상기 학습된 이미지와 유사한 출력 이미지를 생성하는 단계를 포함하는 것을 특징으로 하는 안면 이미지 변환장치."}
{"patent_id": "10-2020-0134256", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_21", "content": "제 20 항에 있어서, 상기 변형 랜드마크는 상기 학습된 이미지의 랜드마크의 위치평균과 분산을 구하고, 이 위치평균과 분산에 기반하여 상기 입력 이미지의 랜드마크의 위치의 평균과 분산을 조정한 것을 특징으로 하는 안면 이미지 변환장치."}
{"patent_id": "10-2020-0134256", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 GAN 기반의 안면 이미지 변환방법에 관한 것으로서, 1장의 소스 이미지를 워핑(Warping)하거나 스케일 변환하여 여러 각도와 거리를 갖는 다수의 안면 이미지 학습데이터를 생성하고, 워핑되거나 스케일이 조정된 상 기 안면 이미지 학습데이터를 생성적 대립 신경망(GAN)에 기반하여 심층 학습함으로써 안면 이미지 변환모듈을 생성하며, 상기 안면 이미지 변환모듈에 변환하고자 하는 입력 이미지를 입력하여 학습된 이미지와 유사한 출력 이미지를 생성하는 것을 특징으로 한다."}
{"patent_id": "10-2020-0134256", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 디지털 이미지 처리 기술에 관한 것으로, 보다 구체적으로는 생성적 대립 신경망(GAN : Generative Adversarial Networks)을 이용하여 안면 이미지를 원하는 이미지와 유사하게 변환하는 장치 및 방법에 관한 것 이다."}
{"patent_id": "10-2020-0134256", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "모바일 관련 기술의 발전으로 인해, 카메라, 인터넷, 디스플레이 등과 같은 다양한 기능이 구현된 모바일 기기 가 개발되어 사람들의 필수품으로 사용되고 있다. 이러한 모바일 기기는 일상 생활을 누리기 위해 다양하게 활 용된다. 가장 대표적으로, 모바일 기기는 사진 관련 기능을 수행하기 위해 활용된다. 예를 들어, 모바일 기기는 간편하 게 사진을 촬영하고, 자신의 SNS(Social network system) 계정에 사진을 업로드하는데 사용될 수 있다. 최근 SNS가 사람들의 일상 생활에 깊숙이 자리함에 따라, 모바일 기기에서 사진 관련 기능을 사용하는 시간이 점점 증가하는 추세이다. SNS에 업로드하는 사진 중에서 인물 이미지는 상당한 비중을 차지하고 있다. 그러나, 종래의 모바일 기기 상의 인물 이미지 편집 기술은 인물 이미지 전체를 필터 처리하는 수준이다. 일부 인물 이미지 편집 기술은 인물 이 미지에 포함된 얼굴의 변형이 가능하지만, 조작법이 어려워 사용자 편의성 측면에서 한계가 있었다. 예를 들어, 특허문헌 1(한국 공개특허공보 제 2020-0080577 호)은 사용자가 간편하게 얼굴의 표정 유형, 인상 유형, 포즈와 회전방향 등의 변형을 수행할 수 있는 인터페이스를 위한 이미지 편집 애플리케이션을 제공한다. 최근에는 딥러닝 기술을 활용한 각종 이미지 변환 및 합성 방법들이 등장하고 있다. 예를 들어, 특허문헌 2(일본 공개특허공보 제 2019-148980 호)는 비카메라시선(카메라에 시선이 맞지 않는) 입 력 화상에 기반하여 심층 학습(deep learning) 기반의 생성모델인 생성적 대립 신경망(GAN : Generative Adversarial Networks)을 이용하여 카메라 시선의 출력 이미지로 변환하는 기술을 제안한다. 이를 위해서, 특허문헌 2는 사전에 학습을 위해 등록된 많은 수의 샘플 안면 이미지를 필요로 한다. 또한, 이렇 게 많은 수의 샘플 안면 이미지를 생성하기 위해 제어된 설정하에서 여러 위치에 배치된 알려진 속성을 가진 많은 수의 카메라를 사용해야 한다. 이러한 시스템은 비싸고 섬세할 뿐만 아니라 다루기 어렵고 일반 사용자가 사 용할 수 없다. 물론, 얼굴의 식별 정확도와 변환의 정확성은 다양하고, 많은 등록된 샘플 안면 이미지를 통해 이점을 얻을 수 있지만 이러한 이미지를 제공하면 사용자의 부담이 크게 증가한다. 선행기술문헌 특허문헌 (특허문헌 0001) KR 2020-0080577 A (특허문헌 0002) JP 2019-148980 A"}
{"patent_id": "10-2020-0134256", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "이와 같이, 종래에는 생성적 대립 신경망(GAN : Generative Adversarial Networks)을 적용하여 이용자의 얼굴 을 학습시킨 얼굴로 변환함에 있어서, 원하는 안면 이미지를 만들어내기 위해서 각도와 거리를 달리하는 여러 장의 이미지 학습 데이터를 수집해야만 했다. 즉, 위나 아래 또는 측면에 대한 다양한 이미지 학습 데이터가 수 집되지 않으면, 대응하지 않는 각도와 거리의 입력 영상이 들어왔을 때 깨짐이 심한 출력 이미지를 생성할 수 밖에 없다. 따라서, 본 발명이 달성하고자 하는 기술적 과제는, 1장의 이미지 학습 데이터에 기반하여 다양한 각도와 스케 일을 갖는 다수의 이미지 학습데이터를 생성하는 방법을 제공하는 것이다. 본 발명의 다른 기술적 과제는 1장의 이미지 학습 데이터에 기반하여 다양한 각도와 거리에서도 깨짐이 없는 변 환된 이미지를 생성할 수 있는 인공지능 딥러닝 모델을 제공하는 것이다. 또한, 본 발명의 또 다른 기술적 과제는 생성적 대립 신경망(GAN)을 이용하여 사용자의 얼굴을 학습시킨 얼굴로 변환하는 방법을 제공하는 것이다."}
{"patent_id": "10-2020-0134256", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "상술한 기술적 과제를 달성하기 위한 본 발명의 제 1 양태에 따른 GAN 기반의 안면 이미지 변환방법은, 1장의 소스 이미지를 워핑(Warping) 및 스케일 변환하여 여러 각도와 거리를 갖는 다수의 안면 이미지 학습데이터를 생성하는 제 1 단계; 상기 제 1 단계에서 워핑되거나 스케일이 조정된 상기 안면 이미지 학습데이터를 생성적 대립 신경망(GAN)에 기반하여 심층 학습함으로써 안면 이미지 변환모듈을 생성하는 제 2 단계; 및 상기 안면 이 미지 변환모듈에 변환하고자 하는 입력 이미지를 입력하여 학습된 이미지와 유사한 출력 이미지를 생성하는 제 3 단계를 포함한다. 본 발명의 다른 제 2 양태에 따른 입력 이미지를 학습된 이미지와 유사한 출력 이미지로 변환하는 안면 이미지 변환장치는, 하나 이상의 인스트럭션들을 저장하는 메모리; 및 상기 메모리에 저장된 상기 하나 이상의 인스트 럭션들을 실행하는 프로세서를 포함하고, 상기 프로세서는, 1장의 소스 이미지를 워핑(Warping) 및 스케일 변환 하여 여러 각도와 거리를 갖는 다수의 안면 이미지 학습데이터를 생성하는 제 1 단계와, 상기 안면 이미지 학습 데이터를 생성적 대립 신경망(GAN)에 기반하여 심층 학습함으로써 안면 이미지 변환모듈을 생성하는 제 2 단계 및 상기 안면 이미지 변환모듈에 변환하고자 하는 입력 이미지를 입력하여 학습된 상기 소스 이미지와 유사한 출력 이미지를 생성하는 제 3 단계를 포함하는 프로세스를 실행하는 것을 특징으로 한다. 상기 제 1 단계는, 상기 1장의 소스 이미지에 기반하여 상,하,좌,우로 일정한 각도 회전된 다수의 워핑 이미지 를 생성하는 워핑 단계와; 상기 워핑 이미지의 안면 이미지의 스케일을 조정하는 스케일 변환단계;를 포함한다. 상기 워핑 이미지는 상기 소스 이미지를 상,하 20도 범위내 그리고, 좌,우 30도 범위내로 회전시킨 것이고, 상 기 스케일은 0.25배로부터 1.5배까지 조정되는 것을 특징으로 한다. 상기 워핑 단계는, 상기 소스 이미지로부터 여러개의 히트맵을 생성하고, 상기 히트맵을 FC 레이어를 거쳐서 Affine 변환식의 계수들을 얻고, 상기 Affine 변환식에 기반하여 순차적으로 이미지를 딥러닝시키는 것에 의해 Affine 변환식 네트워크를 얻고, 이 Affine 변환식 네트워크를 통해 상기 워핑 이미지를 생성하는 것을 특징으로 한다. 상기 제 2 단계는, 워핑되고, 스케일이 변환된 상기 안면 이미지 학습데이터를 랜드마크 학습데이터로 변환하는 단계와; 상기 안면 이미지 학습데이터를 스타일 인코딩한 데이터의 산술연산 곱을 산출하는 단계와; 상기 랜드 마크 학습데이터를 GAN 모듈의 생성기의 초기 입력으로 하고, 상기 산술연산 곱을 상기 생성기의 네트워크 레이 어별로 입력하여 GAN 모듈의 식별기로 하여금 판별하게 함으로써 생성모델과 판별모델이 경쟁하면서 심층학습하 는 것에 의해 상기 안면 이미지 변환모듈을 생성하는 단계를 포함한다. 상기 산출연산 곱을 산출하는 단계는, 상기 스타일 인코딩을 통해 나온 특징의 시그모이드(Sigmoid) 함수와 상 기 안면 이미지 학습데이터가 네트워크의 레이어를 거쳐 나온 특징을 행렬 산술연산 곱(Element-wise multiplication)을 하는 것을 특징으로 한다. 상기 제 3 단계는, 변환하고자 하는 입력 이미지의 변형 랜드마크를 생성하는 단계와; 상기 안면 이미지 변환모 듈이 상기 변형 랜드마크에 기반하여 상기 학습된 이미지와 유사한 출력 이미지를 생성하는 단계를 포함한다. 상기 변형 랜드마크는 상기 학습된 이미지의 랜드마크의 위치평균과 분산을 구하고, 이 위치평균과 분산에 기반 하여 상기 입력 이미지의 랜드마크의 위치의 평균과 분산을 조정한 것을 특징으로 한다. 본 발명의 또 다른 제 3 양태에 따른 안면 이미지 변환 동작을 훈련하기 위한 장치는, 하나 이상의 프로세서; 및 상기 하나 이상의 프로세서에 결합되어 입력 이미지를 학습된 이미지와 유사한 출력 이미지로 변환하기 위해 상기 하나 이상의 프로세서에 의해 실행 가능한 하나 이상의 프로그램 모듈들을 포함하는 메모리를 포함하고; 상기 프로그램 모듈은, 소스 이미지를 상,하,좌,우로 일정한 각도 회전시키고, 이미지의 스케일을 조정하여 1장 의 소스 이미지로부터 각도와 거리를 달리하는 다수의 안면 이미지 학습데이터를 생성하는 이미지 전처리 모듈 과; 상기 다수의 안면 이미지 학습데이터를 생성모델과 판별모델이 경쟁하면서 심층 학습하는 생성적 대립 신경 망(GAN) 기반의 GAN 모듈을 포함한다. 상기 이미지 전처리 모듈은, 상기 1장의 소스 이미지에 기반하여 상,하,좌,우로 일정한 각도 회전된 다수의 워 핑 이미지를 생성하는 워핑부와; 상기 워핑 이미지의 안면 이미지의 스케일을 조정하는 스케일 변환부;를 포함 한다. 상기 워핑부는, 상기 소스 이미지로부터 여러개의 히트맵을 생성하고, 상기 히트맵을 FC 레이어를 거쳐서 Affine 변환식의 계수들을 얻고, 상기 Affine 변환식에 기반하여 순차적으로 이미지를 딥러닝시키는 것에 의해 생성되는 Affine 변환식 네트워크이다. 상기 GAN 모듈은 생성기와 식별기를 포함하고, 워핑 및 스케일이 변환된 상기 안면 이미지 학습데이터로부터 생 성되는 랜드마크 학습데이터를 상기 생성기의 초기 입력으로 하고, 상기 안면 이미지 학습데이터를 스타일 인코 딩한 데이터의 산술연산 곱을 상기 생성기의 네트워크 레이어별로 입력하여 상기 식별기로 하여금 판별하게 함 으로써 생성모델과 판별모델이 경쟁하면서 심층학습하는 생성적 대립 신경망이다. 상기 산술연산 곱은, 상기 스타일 인코딩을 통해 나온 특징의 시그모이드(Sigmoid) 함수와 상기 안면 이미지 학 습데이터가 네트워크의 레이어를 거쳐 나온 특징을 행렬 산술연산 곱(Element-wise multiplication)을 하는 것 을 특징으로 한다."}
{"patent_id": "10-2020-0134256", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명에 따르면, 1장의 소스 이미지로부터 각도와 거리를 달리하는 여러장의 이미지 학습데이터를 생성하고, 이 이미지 학습데이터를 딥러닝하여 생성적 대립 신경망 기반의 안면 이미지 변환모델을 생성할 수 있다. 이로 인해, 각도와 거리를 달리하는 여러장의 이미지 학습데이터를 수집할 필요가 없기 때문에 값싸면서 섬세하고, 사용자의 부담을 경감할 수 있는 인공지능 기반의 이미지 변환기술을 제공할 수 있다. 또한, 각도와 거리를 달 리하는 입력 이미지로부터 학습된 이미지와 유사한 출력 이미지를 깨짐이나 일그러짐 없이 생성할 수 있기 때문 에 안면 이미지에 대한 변환의 정확성을 높일 수 있다. 따라서, 본 발명의 안면 이미지 변환장치를 이용하여 캐릭터 변환을 통해 영상 통화에 사용하거나 3D나 VR게임 에 적용하게 되면 영상 통화의 흥미나 게임의 몰입도를 높이는 것이 가능하다."}
{"patent_id": "10-2020-0134256", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하, 본 발명의 실시예를 첨부된 도면들을 참조하여 더욱 상세하게 설명한다. 본 발명의 실시예는 여러 가지 형태로 변형할 수 있으며, 본 발명의 범위가 아래의 실시예들로 한정되는 것으로 해석되어서는 안된다. 본 실시 예는 당업계에서 평균적인 지식을 가진자에게 본 발명을 더욱 완전하게 설명하기 위해 제공되는 것이다. 또한, 본 발명의 도면과 명세서에서 특정한 용어들이 사용되었으나, 이는 단지 본 발명을 설명하기 위한 목적에서 사 용된 것이지 의미 한정이나 특허청구범위에 기재된 본 발명의 범위를 제한하기 위하여 사용된 것은 아니다. 그 러므로 본 기술 분야의 통상의 지식을 가진 자라면 이로부터 다양한 변형 및 균등한 타 실시예가 가능하다는 점 을 이해할 것이다. 따라서 본 발명의 진정한 기술적 보호범위는 첨부된 특허청구범위의 기술적 사상에 의해 정 해져야 할 것이다. 이하 첨부된 도면을 참조하여 본 발명의 바람직한 실시예를 상세하게 설명하도록 한다. 첨부된 도면은 축척에 의하여 도시되지 않았으며, 각 도면의 동일한 참조 번호는 동일한 구성 요소를 지칭한다. 도 1은 본 발명의 바람직한 일 실시예에 따른 안면 이미지 변환 장치의 구성 블록도이다. 본 발명의 안면 이미지 변환장치는 휴대 전화, 태블릿 컴퓨터, 개인용 디지털 비서, 휴대용 음악/비디오 플레이어, 웨어러블 장치 또는 카메라 시스템을 포함하는 기타 전자 장치와 같은 다기능 장치의 일부일 수 있다. 또한, 안면 이미지 변환장치는 독립적인 시스템으로서 모바일 장치, 태블릿 장치, 데스크톱 장치 및 서버 등과 같은 네트워크 저장장치와 같은 네트워크를 통해 다른 전자 장치에 연결될 수 있다. 또한, 안면 이미 지 변환장치는 무선 또는 유선 연결을 통해 다른 전자장치에 연결될 수 있다. 안면 이미지 변환장치는 프로세서를 포함할 수 있다. 프로세서 는 모바일 장치에서 발견되는 것 과 같은 시스템 온 칩일 수 있고 하나 이상의 중앙 처리 장치(CPU), 전용 그래픽 처리 장치(GPU) 또는 둘 다를 포함 할 수 있다. 또한, 프로세서는 동일하거나 상이한 유형의 다중 프로세서를 포함 할 수 있다. 안면 이미지 변환장치는 메모리를 포함 할 수 있다. 메모리는 프로세서와 함께 디바이스 기능을 수행하기 위해 사용될 수 있는 하나 이상의 상이한 유형의 메모리를 포함 할 수 있다. 예를 들어, 메모 리는 임의의 유형의 비 일시적 스토리지를 포함 할 수 있다. 메모리는 실행 중에 이미지 전처리 모듈 및 GAN 모듈을 포함하는 다양한 프로그래밍 모듈을 저장할 수 있다. 이미지 전처리 모듈 및 GAN 모듈은 다른 전자 장치의 메모리를 포함하여 메모리 이외의 메모리에 저장될 수도 있다. 이미지 전처리 모듈 및 GAN 모듈은 일부 실시예에서 별도의 실행 가능한 프로그래밍 모듈을 포함할 수 있지 만, 프로그래밍 모듈의 기능은 단일 프로그래밍 모듈로 결합 될 수 있다. 상기 이미지 전처리 모듈은 도 2와 같이, 워핑부, 스케일 변환부, 랜드마크부 및 변형 랜 드마크부를 포함하고, 상기 GAN 모듈은 생성적 대립 신경망(GAN : Generative Adversarial Networks)으로서 생성기와 식별기를 포함한다. 상기 이미지 전처리 모듈은 1장의 소스 이미지를 상,하,좌,우로 회전시켜 워핑(Warping)하거나 스케일을 조정하여 여러 각도의 원근감을 갖는 다수의 안면 이미 지 학습데이터를 생성한다. 상기 GAN 모듈은 상기 안면 이미지 학습데이터를 심층학습(딥러닝)하여 학습 완료된 GAN 모듈인 안면 이미지 변환모듈(170')을 완성한다. 또한, 안면 이미지 변환장치는 하나 이상의 카메라를 포함할 수 있다. 카메라는 이미지 센서, 렌즈 스택 및 이미지를 캡처하는데 사용될 수 있는 다른 구성 요소를 포함할 수 있다. 예를 들어, 카메라 는 특정 얼굴의 이미지를 캡처하도록 구성될 수 있다. 하나 이상의 실시예에서, 안면 이미지 변환장치는 I/O(입/출력) 디바이스를 포함할 수 있다. 이 I/O 디바이스는 음성 제어 입력을 위한 마이크, 오디오 데이터를 위한 스피커와 같은 임의의 종류의 I/O 장치 일 수 있다. 예를 들어, 시각 데이터 입력을 위한 카메라, 시각 데이터 출력을 위한 디스플레이(예를 들어, LCD, LED, 유기 LED(OLED) 등과 같은 임의의 종류의 디스플레이)일 수 있다 본 발명에 따른 안면 이미지 변환장치가 전술한 다수의 구성 요소를 포함하는 것으로 도시되었지만, 하나 이상의 실시예에서, 다양한 구성 요소는 분산 시스템의 일부로서 다수의 장치에 걸쳐 분산된다. 또한, 추가 구 성 요소를 사용할 수 있으며 구성 요소 중 일부 기능을 결합할 수 있다. 도 2는 본 발명의 바람직한 일 실시예에 따른 GAN 기반의 안면 이미지 변환 동작을 설명하기 위한 기능 흐름도 이다. 안면 이미지 변환 동작은 크게 GAN 모듈을 훈련시키기 위한 학습데이터를 생성하는 이미지 전처리 과정과, GAN 모듈의 딥러닝을 통해 안면 이미지 변환모듈(170')을 생성하는 GAN 학습과정 및 안면 이미지 변환모듈(170')을 통해 입력 이미지를 학습된 소스 이미지와 비슷한 출력 이미지로 변환하는 과정으 로 이루어진다. 먼저, 상기 이미지 전처리 과정은 이미지 전처리 모듈에 의해 프로그래밍되는 동작으로서 소스 이미지를 워핑(Warping)하거나 스케일 변환하여 여러 각도와 거리를 갖는 다수의 이미지 학습데이터를 생성하는 과정이다. 먼저, 이미지 전처리 모듈의 워핑부(Warping unit)는 1장의 소스 이미지에 기반하여 도 4와 같 이 좌,우 30도 범위내 및 상,하 20도 범위내로 회전된 여러가지 각도의 워핑 이미지를 생성하는 딥러닝 기반의 안면 회전 생성모델이다. 도 3은 안면 회전 생성모델을 학습시키는 과정에 대한 흐름도이다. 도 3을 참조하면, 우선 소스 이미지를 24fps씩 쪼갠다. T+1초의 이미지(162a)는 컨볼루션 네트워크(162b)를 통과시켜 20개의 히트맵(Heatmap)(162c) 을 얻는다. 이 20개의 히트맵(162c)은 FC 레이어(Fully-Connected Layer)(162d)를 거쳐 Affine 변환식의 계수 들(162e)을 얻는다. 그리고, 이 Affine 변환식과 T초의 이미지의 픽셀들(Pxi, Pyi, i=1~N, N개의 픽셀 개수)을 각각 곱해 T+1초일 때의 변환 예측 값(162f)을 얻을 수 있다. 도 3의 162g는 T초의 이미지 프레임을 나타내고, 162h는 상기 T초의 이미지 프레임(162g)과 Affine 변환식의 곱을 통해 얻어진 예측 이미지 프레임이다. 이렇게 순차적으로 이미지를 학습시키는 것에 의해 학습된 Affine 변환식 네트워크인 안면 회전 생성모델을 얻을 수 있 다. 상기 학습된 안면 회전 생성모델은 1장의 소스 이미지로부터 도 4와 같이 좌로 30도, 우로 30도 범위내에 서 회전된 다수의 안면 이미지 학습데이터를 생성한다. 이와 동일한 원리로 상기 학습된 안면 회전 생성모델은 위로 20도, 아래로 20도 범위내에서 회전된 다수의 안면 이미지도 생성할 수 있다. 상기 안면 이미지 학습데이터의 회전 각도가 좌,우 30도 범위와 상,하 20도 범위를 초과하게 되면, 이미지가 심 하게 일그러질 수 있다. 이렇게 워핑부에 의해 여러 각도로 회전된 안면 이미지 학습데이터는 스케일 변환부에 의해 스케일 (scale)이 조정된다. 즉, 스케일 변환부는 여러 각도로 회전된 안면 이미지 학습데이터를 도 5와 같이 0.25배로부터 1.5배까지 그 스케일을 조정할 수 있다. 이때, 스케일 변환부는 도 5와 같이 이미지의 사이 즈는 고정시키고, 안면 크기만을 조정하여 안면 이미지에 원근감을 부여한다. 이렇게 워핑부와 스케일 변환부에 의해 회전 각도와 안면 스케일이 조정된 안면 이미지 학습데이터 (Io)는 랜드마크부에 의해 랜드마크 학습데이터(IL)로 변환된다. 여기서, 랜드마크(landmark)는 안면 검출 영역 내에서 객체의 각 특징(feature)을 대표하는 특징점(feature point)을 나타내는 것으로서, 예를 들어, 사 람의 얼굴을 대표하는 특징인 눈, 코, 입, 및 눈썹 등에 대응하는 특징점(point)일 수 있다. 랜드마크는 객체의 각 특징에 대해 적어도 하나가 설정될 수 있고, 하나의 특징에 복수개 설정될 수도 있다. 이렇게, 얼굴 검출 영 역 내의 객체에 대해 설정된 특징의 개수 및 각 특징에 대한 랜드마크의 개수는 필요에 따라 지정될 수 있다. 다음으로, 상기 GAN 학습과정은 이미지 전처리 모듈에 의해 워핑되거나 스케일이 조정된 상기 안면 이미지 학습데이터(IL, IO)를 GAN 모듈을 통해 심층 학습함으로써 안면 이미지 변환모듈(170')을 생성하는 과정이다. 상기 GAN 모듈은 생성기(Generator)와 식별기(Discriminator)로 이루어지는 생성적 대립 신경 망(Generative Adversarial Networks)이다. 도 6은 본 발명에 따른 생성적 대립 신경망(GAN)의 학습 구조를 나타내는 도면이다. 도 6을 참조하면, GAN 모듈은 상기 랜드마크 학습데이터(IL)를 생성기의 초기 입력으로 하고, 회전 각도와 안면 스케일이 조정된 상기 안면 이미지 학습데이터(Io)를 스타일 인코딩한 데이터의 행렬 산술연산 곱 (Element-wise multiplication)을 생성기의 심층 신경망의 네트워크 레이어별로 입력하여 생성 이미지를 생성하고, 이를 식별기로 하여금 판별하게 함으로써 생성모델과 판별모델이 경쟁하면서 심층학습하여 학습 완료된 GAN 모듈인 안면 이미지 변환모듈(170')을 완성한다. 보다 상세하게, 심층 신경망 네트워크의 레이어별로 스타일 인코딩을 통해 나온 특징(F)의 시그모이드(Sigmoid) 함수[M(F)]와 상기 안면 이미지 학습데이터(Io)를 심층 신경망 네트워크의 레이어를 거쳐 나온 특징(F')을 행렬 산술연산 곱(Element-wise multiplication)을 하여 상기 랜드마크 학습데이터(IL)와 함께 생성기의 심층 신경망 네트워크의 레이어를 거치게 함으로써 식별기에 의해 판별할 이미지 데이터를 생성한다. 이때, 스타일 인코딩을 하지 않은 안면 이미지 학습데이터(Io)와 랜드마크 학습데이터(IL)를 합쳐서 심층 학습하 는 경우 이미지 데이터가 심하게 일그러질 수 있다. 따라서, 본 발명의 GAN 모듈의 생성기는 스타일 인코딩을 통해 안면 이미지에서 특징이 뚜렷한 부분만을 취함으로써 이미지 데이터의 일그러짐을 보상할 수 있 다. 마지막으로, 상기 이미지 변환과정은 상기 학습 완료된 GAN 모듈인 안면 이미지 변환모듈(170')에 변환하고자 하는 입력 이미지를 입력하여 학습된 상기 소스 이미지와 유사한 출력 이미지로 변환하는 과정 이다. 이때, 안면 이미지 변환모듈(170')에 입력 이미지의 랜드마크를 그대로 입력하게 되면, 학습한 이미 지와 다르기 때문에 원하는 출력 이미지를 생성할 수 없다. 따라서, 입력 이미지를 이미지 전처리 모 듈의 변형 랜드마크부를 통해 변형된 랜드마크로 생성하고, 이 변형된 랜드마크를 안면 이 미지 변환모듈(170')에 입력한다. 도 7은 본 발명에 따른 변형 랜드마크를 이용한 이미지 변환 과정에 대한 흐름도이다. 도 7을 참조하면, 상기 변형 랜드마크는 학습된 안면 이미지의 랜드마크(눈, 눈썹, 코, 입, 턱선)의 위치평균과 분산을 구하고, 이 위치평균과 분산에 기반하여 상기 입력 이미지의 랜드마크의 위치의 평균과 분산을 조정한 것이다. 이렇게 입력 이미지에 대한 변형 랜드마크를 안면 이미지 변환모듈(170')에 입력하는 것에 의해 원하 는 소스 이미지와 유사한 출력 이미지를 생성할 수 있다. 본 발명의 일 실시예에 따른 안면 이미지 변환장치의 동작방법은 다양한 컴퓨터 수단을 통하여 수행될 수 있는 프로그램 명령 형태로 구현되어 컴퓨터 판독 가능 매체에 기록될 수 있다. 상기 컴퓨터 판독 가능 매체는 프로그램 명령, 데이터 파일, 데이터 구조 등을 단독으로 또는 조합하여 포함할 수 있다. 상기 매체에 기록되는 프로그램 명령은 본 발명을 위하여 특별히 설계되고 구성된 것들이거나 컴퓨터 소프트웨 어 당업자에게 공지되어 사용 가능한 것일 수도 있다. 컴퓨터 판독 가능 기록매체의 예에는 하드 디스크, 플로 피 디스크 및 자기 테이프와 같은 자기 매체(magnetic media), CD-ROM, DVD와 같은 광기록 매체(optical media), 플롭티컬 디스크(floptical disk)와 같은 자기-광 매체(magneto-optical media), 및 롬(ROM), 램 (RAM), 플래시 메모리 등과 같은 프로그램 명령을 저장하고 수행하도록 특별히 구성된 하드웨어 장치가 포함된 다. 프로그램 명령의 예에는 컴파일러에 의해 만들어지는 것과 같은 기계어 코드뿐만 아니라 인터프리터 등을 사용해서 컴퓨터에 의해서 실행될 수 있는 고급 언어 코드를 포함한다. 또한, 개시된 실시예들에 따른 안면 이미지 변환장치 또는 안면 이미지 변환 동작은 컴퓨터 프로그램 제품 (computer program product)에 포함되어 제공될 수 있다. 컴퓨터 프로그램 제품은 상품으로서 판매자 및 구매자 간에 거래될 수 있다. 컴퓨터 프로그램 제품은 S/W 프로그램, S/W 프로그램이 저장된 컴퓨터로 읽을 수 있는 저장 매체를 포함할 수 있다. 예를 들어, 컴퓨터 프로그램 제품은 전자 장치의 제조사 또는 전자 마켓(예, 구글 플레이 스토어, 앱 스 토어)을 통해 전자적으로 배포되는 S/W 프로그램 형태의 상품(예, 다운로더블 앱)을 포함할 수 있다. 전자적 배 포를 위하여, S/W 프로그램의 적어도 일부는 저장 매체에 저장되거나, 임시적으로 생성될 수 있다. 이 경우, 저 장 매체는 제조사의 서버, 전자 마켓의 서버, 또는 SW 프로그램을 임시적으로 저장하는 중계 서버의 저장매체가 될 수 있다. 컴퓨터 프로그램 제품은, 서버 및 클라이언트 장치로 구성되는 시스템에서, 서버의 저장매체 또는 클라이언트 장치의 저장매체를 포함할 수 있다. 또는, 서버 또는 클라이언트 장치와 통신 연결되는 제3의 장치(예, 스마트 폰)가 존재하는 경우, 컴퓨터 프로그램 제품은 제3의 장치의 저장매체를 포함할 수 있다. 또는, 컴퓨터 프로그 램 제품은 서버로부터 클라이언트 장치 또는 제3의 장치로 전송되거나, 제3의 장치로부터 클라이언트 장치로 전 송되는 S/W 프로그램 자체를 포함할 수 있다. 이 경우, 서버, 클라이언트 장치 및 제3의 장치 중 하나가 컴퓨터 프로그램 제품을 실행하여 개시된 실시예들에 따른 방법을 수행할 수 있다. 또는, 서버, 클라이언트 장치 및 제 3의 장치 중 둘 이상이 컴퓨터 프로그램 제품을 실행하여 개시된 실시예들에 따른 방법을 분산하여 실시할 수 있다. 예를 들면, 서버(예로, 클라우드 서버 또는 인공 지능 서버 등)가 서버에 저장된 컴퓨터 프로그램 제품을 실행 하여, 서버와 통신 연결된 클라이언트 장치가 개시된 실시예들에 따른 방법을 수행하도록 제어할 수 있다. 이상에서 본 발명은 비록 한정된 실시예와 도면에 의해 설명되었으나, 본 발명은 이것에 의해 한정되지 않으며"}
{"patent_id": "10-2020-0134256", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "본 발명이 속하는 기술분야에서 통상의 지식을 가진 자에 의해 본 발명의 기술사상과 아래에 기재될 특허청구범 위의 균등범위 내에서 다양한 수정 및 변형이 가능함은 물론이다."}
{"patent_id": "10-2020-0134256", "section": "도면", "subsection": "도면설명", "item": 1, "content": "본 명세서에 첨부되는 다음의 도면들은 본 발명의 바람직한 실시예를 예시하는 것이며, 후술되는 발명의 상세한 설명과 함께 본 발명의 기술사상을 더욱 이해시키는 역할을 하는 것이므로, 본 발명은 그러한 도면에 기재된 사 항에만 한정되어 해석되어서는 아니된다. 도 1은 본 발명의 바람직한 일 실시예에 따른 안면 이미지 변환 장치의 구성 블록도이다. 도 2는 본 발명의 바람직한 일 실시예에 따른 GAN 기반의 안면 이미지 변환 동작을 설명하기 위한 기능 블록도 이다. 도 3은 안면 회전 생성모델을 학습시키는 과정에 대한 흐름도이다. 도 4는 안면 회전 생성모델에 의해 좌,우 30도 범위로 회전된 안면 이미지들을 나타내는 도면이다. 도 5는 스케일 변환부에 의해 0.25배로부터 1.5배까지 스케일이 조정된 안면 이미지들을 나타내는 도면이다. 도 6은 본 발명에 따른 생성적 대립 신경망(GAN)의 학습 구조를 나타내는 도면이다. 도 7은 본 발명에 따른 변형 랜드마크(Regressed Landmark)를 이용한 이미지 변환 과정에 대한 흐름도이다."}
