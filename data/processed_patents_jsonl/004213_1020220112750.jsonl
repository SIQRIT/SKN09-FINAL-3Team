{"patent_id": "10-2022-0112750", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2024-0033899", "출원번호": "10-2022-0112750", "발명의 명칭": "비지도 학습 기반 결품 인식 장치 및 결품 인식 방법", "출원인": "롯데정보통신 주식회사", "발명자": "고재영"}}
{"patent_id": "10-2022-0112750", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "상품 진열 영역을 촬영하여 상품 이미지를 획득하는 이미지 획득부;상기 획득된 상품 이미지를 입력 받아 지도 학습 기반 객체 인식을 수행하여 상품 또는 비상품 여부를인식하고, 상기 비상품으로 인식된 객체에 대해 비지도 학습 기반 객체 인식을 수행하여 결품 여부를 판정하는객체 인식부;를 포함하는, 비지도 학습 기반 결품 인식 장치."}
{"patent_id": "10-2022-0112750", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "청구항 1에 있어서, 상기 객체 인식부는,상기 획득된 상품 이미지를 입력 받아서 지도 학습 기반 객체 인식을 수행하는 1차 객체 인식모델과,상기 1차 객체 인식모델의 객체 인식 결과, 상품이 아니거나 결품으로 인식된 비상품 객체에 대해 비지도 학습기반 객체 인식을 수행하는 2차 객체 인식모델을 포함하는, 비지도 학습 기반 결품 인식 장치."}
{"patent_id": "10-2022-0112750", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "청구항 2에 있어서, 상기 2차 객체 인식모델은,결품 여부 판정을 위해 입력된 쿼리 데이터를, 학습을 통해 n차원의 잠재 공간으로 매핑시키는 인코더와,상기 인코더를 통해 입력된 쿼리 데이터를 매핑시킨 잠재 공간을 기반으로 가상 상품 이미지를 생성하는 이미지생성기와,상기 쿼리 데이터와 상기 가상 상품 이미지의 이미지 차이값인 이상 가중치를 기반으로 결품 여부를 판정하는결품 판정기를 포함하는, 비지도 학습 기반 결품 인식 장치."}
{"patent_id": "10-2022-0112750", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "청구항 3에 있어서, 상기 인코더는,CNN(Convolutional Neural Network)과 ViT(Vision Transformer)을 포함하여 구성되는, 비지도 학습 기반 결품인식 장치."}
{"patent_id": "10-2022-0112750", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "청구항 4에 있어서, 사전에 학습된 CNN에 미세 조정(fine-tunning)하여 ViT와 함께 상기 인코더의 학습을 진행하는, 비지도 학습 기반 결품 인식 장치."}
{"patent_id": "10-2022-0112750", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "청구항 5에 있어서, 상기 인코더 학습은 VGG loss와 adversarial loss를 결합한 perceptual loss를 Encoder loss로 사용하는, 비지도 학습 기반 결품 인식 장치."}
{"patent_id": "10-2022-0112750", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "공개특허 10-2024-0033899-3-청구항 3에 있어서, 상기 결품 판정기는,상기 이상 가중치와 기설정된 기준값을 비교하여, 상기 이상 가중치가 기준값 이하이면 상기 쿼리 데이터를 상품 이미지로 판정하고, 상기 상기 이상 가중치가 기준값 초과이면 상기 쿼리 데이터를 결품 이미지로 판정하는,비지도 학습 기반 결품 인식 장치."}
{"patent_id": "10-2022-0112750", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "이미지 획득부가 상품 진열 영역을 촬영하여 상품 이미지를 획득하는 이미지 획득단계;1차 객체 인식모델이 상기 획득된 상품 이미지를 입력 받아서 지도 학습 기반 객체 인식을 수행하여 상품, 또는상품이 아니거나 결품으로 인식된 비상품을 인식하는 1차 객체 인식단계;상기 1차 객체 인식단계의 객체 인식 결과, 상기 비상품으로 인식된 객체에 대해, 2차 객체 인식모델이 비지도학습 기반 객체 인식을 수행하는 2차 객체 인식단계;를 포함하는, 비지도 학습 기반 결품 인식 방법."}
{"patent_id": "10-2022-0112750", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "청구항 8에 있어서, 상기 2차 객체 인식단계는,결품 여부 판정을 위해 입력된 쿼리 데이터를, 학습을 통해 n차원의 잠재 공간으로 매핑시키는 인코딩 단계와,상기 인코딩 단계를 통해 입력된 쿼리 데이터를 매핑시킨 잠재 공간을 기반으로 가상 상품 이미지를 생성하는이미지 생성단계와,상기 쿼리 데이터와 상기 가상 상품 이미지의 이미지 차이값인 이상 가중치를 기반으로 결품 여부를 판정하는결품 판정단계를 포함하는, 비지도 학습 기반 결품 인식 방법."}
{"patent_id": "10-2022-0112750", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "청구항 9에 있어서, 상기 인코딩 단계를 수행하는 인코더는, CNN(Convolutional Neural Network)과 ViT(Vision Transformer)을 포함하여 구성되는, 비지도 학습 기반 결품 인식 방법."}
{"patent_id": "10-2022-0112750", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "청구항 10에 있어서,사전에 학습된 CNN에 미세 조정(fine-tunning)하여 ViT와 함께 상기 인코더의 학습을 진행하는, 비지도 학습 기반 결품 인식 방법."}
{"patent_id": "10-2022-0112750", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "청구항 11에 있어서,상기 인코더 학습은 VGG loss와 adversarial loss를 결합한 perceptual loss를 Encoder loss로 사용하는, 비지도 학습 기반 결품 인식 방법."}
{"patent_id": "10-2022-0112750", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "청구항 9에 있어서, 상기 결품 판정단계는,상기 이상 가중치와 기설정된 기준값을 비교하여, 상기 이상 가중치가 기준값 이하이면 상기 쿼리 데이터를 상품 이미지로 판정하고, 상기 상기 이상 가중치가 기준값 초과이면 상기 쿼리 데이터를 결품 이미지로 판정하는,비지도 학습 기반 결품 인식 방법."}
{"patent_id": "10-2022-0112750", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_14", "content": "공개특허 10-2024-0033899-4-컴퓨팅 장치에 의해 실행되며,상품 진열 영역을 촬영하여 획득된 상품 이미지를 입력 받아서 지도 학습 기반 객체 인식을 수행하는 1차 객체인식단계;상기 1차 객체 인식단계의 객체 인식 결과, 상품이 아니거나 결품으로 인식된 비상품 객체에 대해, 2차 객체 인식모델이 비지도 학습 기반 객체 인식을 수행하는 2차 객체 인식단계;를 실행시키기 위한 프로그램을 기록한 컴퓨터 해독 가능한 기록 매체."}
{"patent_id": "10-2022-0112750", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_15", "content": "청구항 14에 있어서, 상기 2차 객체 인식단계는,결품 여부 판정을 위해 입력된 쿼리 데이터를, 학습을 통해 n차원의 잠재 공간으로 매핑시키는 인코딩 단계와,상기 인코딩 단계를 통해 입력된 쿼리 데이터를 매핑시킨 잠재 공간을 기반으로 가상 상품 이미지를 생성하는이미지 생성단계와,상기 쿼리 데이터와 상기 가상 상품 이미지의 이미지 차이값인 이상 가중치를 기반으로 결품 여부를 판정하는결품 판정단계를 실행시키기 위한 프로그램을 기록한 컴퓨터 해독 가능한 기록 매체."}
{"patent_id": "10-2022-0112750", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "지도 학습 기반 객체 인식 방법과 비지도 학습 기반으로 이루어지는 이상 탐지 방법을 적용한 다중 처리 방식으 로 결품 인식을 진행하여 오알람 발생 빈도수를 줄일 수 있는 비지도 학습 기반 결품 인식 장치 및 결품 인식 방 법이 개시된다. 개시된 비지도 학습 기반 결품 인식 장치는, 상품 진열 영역을 촬영하여 상품 이미지를 획득하는 이미지 획득부; 상기 획득된 상품 이미지를 입력 받아서 지도 학습 기반 객체 인식을 수행한 결과, 비(非)상품으로 인식된 객체 에 대해 비지도 학습 기반 객체 인식을 수행하여 결품 여부를 판정하는 객체 인식부; 를 포함한다."}
{"patent_id": "10-2022-0112750", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 지도 학습 기반 객체 인식 방법과 비지도 학습 기반으로 이루어지는 이상 탐지 방법을 적용한 다중 처리(multi processing) 방식으로 결품 인식을 진행하여, 오알람(false alarm) 발생 빈도수를 줄일 수 있는 비 지도 학습 기반 결품 인식 장치 및 결품 인식 방법에 관한 것이다."}
{"patent_id": "10-2022-0112750", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "기존 대형 마트에서 물품 진열 및 결품 체크를 하는 방법으로 객체 인식(object detection)을 많이 이용하고 있 다. 그러나, 객체 인식을 이용한 결품 인식은 단일 처리(single processing)로 많이 진행하게 되는데, 이를 위 해서는 많은 학습 데이터가 필요하며, 이러한 학습 데이터에 대한 정답 라벨을 만드는 작업인 주석(Annotation) 과정이 필수적으로 요구되어 시간과 비용이 많이 든다는 단점이 존재한다. 기존에 이미 적용된 마트 이외의 매장에서 결품 인식 모델을 새롭게 적용할 수 있다. 이 경우, 새로운 상품 데 이터, 선반 환경, 조명색, 매대 가림막 등과 같은 다른 환경적인 변화가 주어짐에 따라, 기존 결품 인식 모델의 정확도가 떨어지게 되고, 이에 따라 오알람 발생 확률이 높아지게 되는 문제점이 존재한다. 선행기술문헌 특허문헌 (특허문헌 0001) 한국공개특허 제2020-0045862호(영상 분석 기반 상품 관리 시스템 및 방법)"}
{"patent_id": "10-2022-0112750", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은 지도 학습 기반 객체 인식 방법과 비지도 학습 기반으로 이루어지는 이상 탐지 방법을 적용한 다중 처리(multi processing) 방식으로 결품 인식을 진행하여, 오알람(false alarm) 발생 빈도수를 줄일 수 있는 비 지도 학습 기반 결품 인식 장치 및 결품 인식 방법을 제공하는 것을 목적으로 한다."}
{"patent_id": "10-2022-0112750", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명의 실시예에 따른 비지도 학습 기반 결품 인식 장치는, 상품 진열 영역을 촬영하여 상품 이미지를 획득 하는 이미지 획득부; 와, 상기 획득된 상품 이미지를 입력 받아서 지도 학습 기반 객체 인식을 수행한 결과, 비 (非)상품으로 인식된 객체에 대해 비지도 학습 기반 객체 인식을 수행하여 결품 여부를 판정하는 객체 인식부; 를 포함한다. 본 발명의 실시예에 따른 비지도 학습 기반 결품 인식 장치에 있어서, 상기 객체 인식부는, 상기 획득된 상품 이미지를 입력 받아서 지도 학습 기반 객체 인식을 수행하는 1차 객체 인식모델과, 상기 1차 객체 인식모델의 객체 인식 결과 상품이 아니거나 결품으로 인식된 비상품 객체에 대해 비지도 학습 기반 객체 인식을 수행하는 2차 객체 인식모델을 포함한다. 본 발명의 실시예에 따른 비지도 학습 기반 결품 인식 장치에 있어서, 상기 2차 객체 인식모델은, 결품 여부 판 정을 위해 입력된 쿼리 데이터를 학습을 통해 n차원의 잠재 공간으로 매핑시키는 인코더와, 상기 인코더를 통해 입력된 쿼리 데이터를 매핑시킨 잠재 공간을 기반으로 가상 상품 이미지를 생성하는 이미지 생성기와, 상기 쿼 리 데이터와 상기 가상 상품 이미지의 이미지 차이값인 이상 가중치를 기반으로 결품 여부를 판정하는 결품 판 정기를 포함할 수 있다. 본 발명의 실시예에 따른 비지도 학습 기반 결품 인식 장치에 있어서, 상기 인코더는, CNN(Convolutional Neural Network)과 ViT(Vision Transformer)을 포함하여 구성될 수 있다. 본 발명의 실시예에 따른 비지도 학습 기반 결품 인식 장치에 있어서, 사전에 학습된 CNN에 미세 조정(fine- tunning)하여 ViT와 함께 상기 인코더의 학습을 진행하는 것이 바람직하다. 본 발명의 실시예에 따른 비지도 학습 기반 결품 인식 장치에 있어서, 상기 인코더 학습은 VGG loss와 adversarial loss를 결합한 perceptual loss를 Encoder loss로 사용하는 것이 바람직하다. 본 발명의 실시예에 따른 비지도 학습 기반 결품 인식 장치에 있어서, 상기 결품 판정기는, 상기 이상 가중치와 기설정된 기준값을 비교하여, 상기 이상 가중치가 기준값 이하이면 상기 쿼리 데이터를 상품 이미지로 판정하고, 상기 이상 가중치가 기준값 초과이면 상기 쿼리 데이터를 결품 이미지로 판정할 수 있다. 본 발명의 실시예에 따른 비지도 학습 기반 결품 인식 방법은, 이미지 획득부가 상품 진열 영역을 촬영하여 상 품 이미지를 획득하는 이미지 획득단계; 와, 1차 객체 인식모델이 상기 획득된 상품 이미지를 입력 받아서 지도 학습 기반 객체 인식을 수행하는 1차 객체 인식단계; 와, 상기 1차 객체 인식단계의 객체 인식 결과, 상품이 아 니거나 결품으로 인식된 비상품 객체에 대해, 2차 객체 인식모델이 비지도 학습 기반 객체 인식을 수행하는 2차 객체 인식단계; 를 포함한다. 본 발명의 실시예에 따른 비지도 학습 기반 결품 인식 방법에 있어서, 상기 2차 객체 인식단계는, 결품 여부 판 정을 위해 입력된 쿼리 데이터를 학습을 통해 n차원의 잠재 공간으로 매핑시키는 인코딩 단계와, 상기 인코딩 단계를 통해 입력된 쿼리 데이터를 매핑시킨 잠재 공간을 기반으로 가상 상품 이미지를 생성하는 이미지 생성단 계와, 상기 쿼리 데이터와 상기 가상 상품 이미지의 이미지 차이값인 이상 가중치를 기반으로 결품 여부를 판정 하는 결품 판정단계를 포함할 수 있다. 본 발명의 실시예에 따른 비지도 학습 기반 결품 인식 방법에 있어서, 상기 인코딩 단계를 수행하는 인코더는, CNN(Convolutional Neural Network)과 ViT(Vision Transformer)을 포함하여 구성될 수 있다. 본 발명의 실시예에 따른 비지도 학습 기반 결품 인식 방법에 있어서, 사전에 학습된 CNN에 미세 조정(fine- tunning)하여 ViT와 함께 상기 인코더의 학습을 진행하는 것이 바람직하다. 본 발명의 실시예에 따른 비지도 학습 기반 결품 인식 방법에 있어서, 상기 인코더 학습은 VGG loss와 adversarial loss를 결합한 perceptual loss를 Encoder loss로 사용하는 것이 바람직하다. 본 발명의 실시예에 따른 비지도 학습 기반 결품 인식 방법에 있어서, 상기 결품 판정단계는, 상기 이상 가중치 와 기설정된 기준값을 비교하여, 상기 이상 가중치가 기준값 이하이면 상기 쿼리 데이터를 상품 이미지로 판정 하고, 상기 이상 가중치가 기준값 초과이면 상기 쿼리 데이터를 결품 이미지로 판정할 수 있다. 본 발명의 실시예에 따른 비지도 학습 기반 결품 인식 방법은, 상품 진열 영역을 촬영하여 획득된 상품 이미지 를 입력 받아서 지도 학습 기반 객체 인식을 수행하는 1차 객체 인식단계; 와, 상기 1차 객체 인식단계의 객체 인식 결과, 상품이 아니거나 결품으로 인식된 비상품 객체에 대해, 2차 객체 인식모델이 비지도 학습 기반 객체 인식을 수행하는 2차 객체 인식단계; 를 실행시키기 위한 프로그램을 기록한 컴퓨터 해독 가능한 기록 매체에의해 수행될 수 있다. 또한, 상기 2차 객체 인식단계를 위해, 결품 여부 판정을 위해 입력된 쿼리 데이터를, 학습을 통해 n차원의 잠 재 공간으로 매핑시키는 인코딩 단계와, 상기 인코딩 단계를 통해 입력된 쿼리 데이터를 매핑시킨 잠재 공간을 기반으로 가상 상품 이미지를 생성하는 이미지 생성단계와, 상기 쿼리 데이터와 상기 가상 상품 이미지의 이미 지 차이값인 이상 가중치를 기반으로 결품 여부를 판정하는 결품 판정단계를 실행시키기 위한 프로그램을 기록 한 컴퓨터 해독 가능한 기록 매체에 의해 수행될 수 있다. 기타 본 발명의 다양한 측면에 따른 구현예들의 구체적인 사항은 이하의 상세한 설명에 포함되어 있다."}
{"patent_id": "10-2022-0112750", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명의 실시 형태에 따르면, 지도 학습 기반 객체 인식 방법과 비지도 학습 기반으로 이루어지는 이상 탐지 방법을 적용한 다중 처리(multi processing) 방식으로 결품 인식을 진행하여 오알람(false alarm) 발생 빈도수 를 줄일 수 있다."}
{"patent_id": "10-2022-0112750", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "본 발명은 다양한 변환을 가할 수 있고 여러 가지 실시예를 가질 수 있는 바, 특정 실시예를 예시하고 상세한 설명에 상세하게 설명하고자 한다. 그러나, 이는 본 발명을 특정한 실시 형태에 대해 한정하려는 것이 아니며, 본 발명의 사상 및 기술 범위에 포함되는 모든 변환, 균등물 내지 대체물을 포함하는 것으로 이해되어야 한다. 본 발명에서 사용한 용어는 단지 특정한 실시예를 설명하기 위해 사용된 것으로, 본 발명을 한정하려는 의도가 아니다. 단수의 표현은 문맥상 명백하게 다르게 뜻하지 않는 한, 복수의 표현을 포함한다. 본 발명에서, '포함 하다' 또는 '가지다' 등의 용어는 명세서상에 기재된 특징, 숫자, 단계, 동작, 구성요소, 부품 또는 이들을 조 합한 것이 존재함을 지정하려는 것이지, 하나 또는 그 이상의 다른 특징들이나 숫자, 단계, 동작, 구성요소, 부 품 또는 이들을 조합한 것들의 존재 또는 부가 가능성을 미리 배제하지 않는 것으로 이해되어야 한다. 이하, 도 면을 참조하여 본 발명의 실시예에 따른 비지도 학습 기반 결품 인식 장치 및 결품 인식 방법을 설명한다. 본 발명은 오알람(false alarm)의 빈도수를 줄이기 위해 단일 처리(single processing)가 아닌 지도 학습 기반 객체 인식 방법과 비지도 학습 기반으로 이루어지는 객체 인식 방법을 적용한 다중 처리(multi processing) 방 식으로 결품 인식을 진행하여 오 알람(false alarm)을 효과적으로 줄인다. 본 발명에서 다중 처리는 1차적으로 객체 인식 모델을 통한 상품 및 결품 인식을 진행하고, “상품이라고 인식 못한 결과”에 대해 2차적으로 비지도 학습 기반 객체 인식 방법으로 결품 인식을 진행하는 프로세스를 의미한 다. 여기서, “상품이라고 인식 못한 결과”는 원래 상품이 있음에도 상품으로 인식하지 못하는 경우와, 원래 상품 자체가 존재하지 않는 결품인 경우를 포함할 수 있으며, 이를 “비(非)상품으로 인식”이라 한다. 도 1은 본 발명의 일 실시예에 따른 비지도 학습 기반 결품 인식 장치가 개념적으로 도시된 블록도이다. 도 1을 참조하면, 본 발명의 일 실시예에 따른 비지도 학습 기반 결품 인식 장치는, 이미지 획득부와 객체 인식부를 포함한다. 이미지 획득부는 상품 진열 영역을 촬영하여 상품 이미지를 획득한다. 이미지 획득부는 하나 이상의 카메라를 포함할 수 있다. 이미지 획득부에 포함되는 카메라로는 상품 진열 영역 내의 상품의 상품명, 상 품 코드 및 형태를 인식할 수 있는 어떠한 종류의 카메라도 사용될 수 있다. 카메라는 매장 내에서 상품 진열 영역을 촬영할 수 있는 위치에 배치될 수 있다. 하나의 상품 이미지 내에는 복수개의 상품 객체가 포함될 수 있 다. 객체 인식부는 지도 학습 기반 객체 인식 방법과 비지도 학습 기반으로 이루어지는 객체 인식 방법을 적용 한 다중 처리(multi processing) 방식으로 결품 인식을 진행한다. 객체 인식부는 이미지 획득부에 의 해 획득된 상품 이미지를 입력 받아서 1차로 지도 학습 기반 객체 인식을 수행하고, 1차 객체 인식 결과, 비(非)상품으로 인식된 객체에 대해 2차로 비지도 학습 기반 객체 인식을 수행하여 결품 여부를 판정한다. 객체 인식부는 1차 객체 인식 모델과 2차 객체 인식 모델을 포함한다. 1차 객체 인식 모델은 이미지 획득부에 의해 획득된 상품 이미지를 입력 받아서 1차로 지도 학습 기 반 객체 인식을 수행한다. 지도 학습(Supervised Learning)은 학습 데이터와 그에 대응되는 정답 라벨을 이용하 여 인공지능 모델을 학습시키는 것으로, 이러한 인공지능 모델로는, 예를 들어, YOLO(You Only Look Once), CNN(Convolutional Neural Network)이 될 수 있다. CNN은 데이터로부터 자동으로 특징(features)을 학습하는 대표적인 모델로서 인간의 시각(vision) 정보 처리 방식을 모사한 것으로, 특히 이미지 인식과 분류에서 탁월하 다. 물론, 지도 학습 기반 객체 인식 모델로서 CNN을 한정하는 것은 아니며, K-최근접 이웃(k-Nearest Neighbors), 선형 회귀(Linear Regression), 로지스틱 회귀(Logistic Regression), 서포트 벡터 머신(SVM, Support Vector Machine), 결정 트리(Decision Tree)와 랜덤 포레스트(Random Forest), 신경망(Neural Network) 등 다른 종류의 모델을 사용할 수 있다. 1차 객체 인식 모델은 입력된 상품 이미지에 포함된 복수개의 상품 객체에 대해 객체 인식을 수행하여 개 별 객체의 상품 또는 비(非)상품을 판단한다. 1차 객체 인식 모델은 학습 데이터로 학습된 이미지와 입력 된 상품 이미지의 유사도를 비교하여 산출하고, 산출된 유사도가 기설정된 기준치 이상이면 상품으로 판단하고, 기준치 미만이면 비(非)상품으로 판단한다. 비(非)상품이란, 실제로는 상품이지만 상품으로 인식하지 못하는 경 우와, 원래 상품 자체가 존재하지 않는 결품인 경우를 포함한다. 한편, 1차 객체 인식 모델은 학습 데이터와 다른 새로운 데이터, 조명 밝기, 선반색 변경 등 새로운 환경 적 요소가 추가되면 인식 대상 객체를 아예 다른 물체나 결품으로 인식하게 되어, 결품이 아니어도 결품이 발생 했다는 오알람이 발생하는 문제가 존재한다. 이러한 문제를 해결하게 위해 본 발명의 객체 인식부는 1차 객체 인식 모델의 인식 결과를 추가로 검증하는 2차 객체 인식 모델을 구비한다. 2차 객체 인식 모델은 1차 객체 인식 모델에 의해 비(非)상품으로 판단된 객체에 대해 비지도 학습 기반 객체 인식을 수행하여 결품 여부를 판정한다. 비지도 학습(Unsupervised Learning)이란, 지도 학습과는 다 르게 정답 라벨이 없이 학습 데이터만 이용해서 인공 지능 모델을 학습시키는 것을 말한다. 본 발명에서는 1차 객체 인식 모델 학습시 사용한 상품 이미지(객체 이미지)를 2차 객체 인식 모델의 학습 데이터로 사 용하여 2차 객체 인식 모델를 학습시킨다. 이러한 2차 객체 인식 모델에 대해 도 2를 참조하여 상세히 설명한다. 도 2는 2차 객체 인식 모델이 개념 적으로 도시된 블록도이다. 도 2를 참조하면, 2차 객체 인식 모델은, 인코더, 이미지 생성기, 잠재 공간, 결품 판정기 를 포함한다. 인코더는 결품 여부 판정을 위해 입력된 쿼리(query) 데이터를, 학습을 통해 n차원의 잠재 공간(223, latent space)으로 매핑(mapping)시킨다. 매핑 시킨 잠재 공간을 기반으로 미리 학습된 이미지 생성기 를 통해 입력 데이터와 동일하게 이미지 복원이 되도록 인코더 학습을 진행한다. 쿼리(query) 데이터는 1 차 객체 인식 모델에서 비(非)상품으로 판단된 객체 이미지이다. 이러한 인코더는 CNN(Convolutional Neural Network)과 ViT(Vision Transformer)을 포함하여 구성된다. 도 3은 2차 객체 인식 모델의 인코더 아키텍처의 일부를 이루는 CNN 아키텍처가 도시된 도면이고, 도 4는 2차 객체 인식 모델의 인코더 아키텍처의 일부를 이루는 ViT 아키텍처가 도시된 도면이다. CNN 기반 네트워크는 위치가 조금만 변경되더라도 아예 다른 이미지로 인식을 하는 특성이 있다. 이런 특성때문 에 새로운 환경, 새로운 데이터에 대해서는 기존 인식률에 비해 정확도가 낮아질 수 있다. 따라서, 본 발명에서 는 CNN과 ViT를 합성한 인코더를 사용한다. 국소적인 부분만 보는 CNN과 달리 ViT는 지역 전체를 고려하여 학습 이 이루어진다. CNN는 filter를 통해 Convolution 연산을 진행하다 보니 국소적인 부분을 보게 된다. 이런 특징 때문에 bias가 적은 객체에 대해서는 잘 인식을 하지만 bias가 높은 객체에 대해서는 그 정확도가 감소하게 된다. 이를 극복하 기 위해 CNN에 이미지 전체에서 어느 부분을 주의깊게 봐야하는지 나타내는 기술은 attention 기법을 사용해서 이를 극복할 수 있다. ViT는 CNN과 반대로 이미지 전체를 봐서 카메라 위치가 달라지는 등 bias가 있더라도 잘 동작을 하게 된다. 또한, 인코더는 Image space에서 vector space로 매핑을 하는데, 이런 여러 조건들을 고려해 봤을 때 image space에서 vector space로 매핑하는 경우 ViT를 사용하는 것이 적합하다. 하지만 ViT는 많은 데 이터를 필요로 하기 때문에 본 발명에서는 사전에 학습된 CNN에 미세 조정(fine-tunning)하여 ViT와 함께 인코 더(Encoder) 학습을 진행한다. 인코더가 입력 이미지로부터 특징(Feature)을 잘 추출하게 하기 위해선 풍부한 데이터로 학습하는 것이 필수적 이다. 하지만, 대게 많은 연구 분야에서는 대규모 데이터셋을 구축하기가 어렵기 때문에 차선책으로 전이학습 (Transfer learning)을 진행한다. 여기서, 전이 학습이란 대규모 데이터셋에 선 학습(Pre-training)된 Encoder 를 목표 데이터셋에 추가 학습하여 CNN 학습 파라미터를 미세 조정하는 것을 의미한다. 즉, 본 발명에서 언급한 CNN 미세조정은 ImageNet과 같은 대규모 데이터셋에 선 학습된 CNN 모델을 결품 인식 데이터셋에 전이 학습하여 CNN 파라미터를 미세 조정하는 것을 의미한다. 도 5는 2차 객체 인식 모델의 인코더의 학습 과정이 도시된 도면이고, 도 6은 2차 객체 인식 모델의 인코더의 학습 상세 아키텍처가 도시된 도면이다. 도 5 및 도 6을 참조하면, 인코더는 CNN 기반 인코더(221a)와 Vit 기반 인코더(221b)가 결합되어 형성된다. 여기서, 지각적 유사성(Perceptual similarity)을 기반으로 하는 지각 손실(Perceptual loss(=Reconstruction loss))과 Discriminator의 중간 레이어에서 추출되는 Latent Feature를 비교하는 Feature loss를 기반으로 CNN 기반 Encoder의 학습 파라미터를 미세 조정하여 전이 학습을 진행하게 된다. 다시 도 6을 참조하면, 먼저, CNN 기반 인코더(221a)를 통해 입력 이미지로부터 특징(Feature)을 추출한다. 이 때, 여러 Layer로부터 추출된 특징들을 합쳐서 Multi-scale Feature를 추출한다. 추출된 특징은 Vit 기반 인코 더(221b) (Transformer Encoder)의 입력으로 사용되고 Vit 기반 인코더(221b)를 통해 잠재 공간에서 최종 적으로 Latent Vector를 추출하게 된다. 이렇게 추출된 Latent Vector는 이미지 생성기(222, Generator)를 통 해 이미지로 복원된다. 인코더는, 일반적으로 reconstruction loss로 사용하는 MSE loss 대신, Perceptual loss를 사용한다. 즉, VGG loss와 adversarial loss를 결합한 perceptual loss를 Encoder loss로 사용하여, perceptual similarity를 더 집중하여 좀 더 디테일한 부분을 잘 잡아줄 수 있도록 한다. 또한, 진짜/가짜를 구분하는 구분자 (Discriminator)의 중간 레이어에서 얻어진 feature space 영역을 loss로 취해 pixel level 뿐만 아니라 feature space level도 loss로 취한다. 잠재 공간(223, Latent Space)은 특정 차원에서 원하는 정보들이 모여있는 공간을 의미하며, 잠재 공간에 는 학습시킨 이미지들이 잠재 벡터(latent vector)의 분포 형태로 존재한다. 이미지 생성기는 인코더를 통해 입력된 데이터를 매핑(mapping)시킨 잠재 공간을 기반으로 가상 상품 이미지를 생성한다. 여기서, 가상 상품 이미지는 2차 객체 인식 모델이 학습한 상품 이미지로, 인코 더를 통해 입력된 쿼리 데이터와 이미지 차이값(또는 유사도)을 도출하기 위한 이미지이다. 만약, 입력 이미지(쿼리(query) 데이터)가 결품 이미지인 경우, 랜덤하게 가상 상품 이미지가 생성될 수 있으며, 입력된 이미지가 특정 상품 이미지일 경우, 해당 상품과 동일한 상품 이미지가 생성될 수 있다. 예를 들어, 입력 이미지가 어두운 빈 공간을 촬영한 완전한 블랙인 경우, 이미지 생성기는 상품 중에서 주 로 블랙 색상을 갖는 “카누(인스턴트 커피)”의 상품 이미지를 이미지 차이값 도출을 위한 가상 상품 이미지로생성할 수 있다. 또한, 예를 들어, 입력 이미지가 1차 객체 인식 모델에 의해 기준치 미만의 유사도를 갖는 것으로 도출되 어 비(非)상품으로 인식된 특정 상품 이미지인 경우, 이미지 생성기는 해당 특정 상품 이미지를 이미지 차 이값 도출을 위한 가상 상품 이미지로 생성할 수 있다. 결품 판정기는 이상 가중치(Anomaly weight)를 기반으로 결품 이미지로 판정한다. 결품 판정기는 쿼 리 데이터와 이미지 생성기에서 생성된 가상 상품 이미지의 이미지 차이값(이를 이상 가중치(Anomaly weight)라 함)을 도출하고, 도출된 이미지 차이값(이상 가중치)과 기설정된 기준값을 비교하여, 이미지 차이값 이 기준값 이하이면 쿼리 데이터를 상품 이미지로 판정하고, 이미지 차이값이 기준값 초과이면 쿼리 데이터를 결품 이미지로 판정한다. 이미지 차이값이란, 이미지 생성기에 의해 생성된 이미지와 입력 이미지에 대해 2차원 행렬 뺄셈을 수행한 결과값을 의미한다. 즉, output과 input의 x, y 좌표별 픽셀 값의 차이를 의미한다. 또는, 결품 판정기는 쿼리 데이터와 이미지 생성기에서 생성된 가상 상품 이미지의 유사도값을 도출 하고, 도출된 유사도값과 기설정된 기준값을 비교하여, 유사도값이 기준값 이상이면 쿼리 데이터를 상품 이미지 로 판정하고, 유사도값이 기준값 미만이면 쿼리 데이터를 결품 이미지로 판정한다. 이와 같은 방식으로 결품 이미지가 판정되면, 사용자에게 결품발생 알람 메시지를 전송한다. 다음, 도 7 내지 도 9를 참조하여 본 발명의 일 실시예에 따른 비지도학습 기반 결품 인식 방법을 설명한다. 도 7은 본 발명의 일 실시예에 따른 비지도학습 기반 결품 인식 방법이 도시된 순서도이고, 도 8은 1차 객체 인식 모델의 객체 인식 과정이 예시된 도면이며, 도 9는 2차 객체 인식 모델의 객체 인식 과정이 예시된 도면이다. 도 7 내지 도 9를 참조하면, 본 발명의 일 실시예에 따른 비지도학습 기반 결품 인식 방법은, 이미지 획득단계 (S100), 1차 객체 인식단계(S110: S111 ~ S112), 2차 객체 인식단계(S120: S121 ~ S128)를 포함한다. 먼저, 상품 진열 영역을 촬영할 수 있는 위치에 배치된 카메라가 상품 진열 영역을 촬영하여 상품 이미지를 획 득한다. (S100) 하나의 상품 이미지 내에는 복수개의 상품 객체가 포함될 수 있다. 다음, 1차 객체 인식 모델이 S100 단계에서 획득된 상품 이미지를 입력 받아서 1차로 지도 학습 기반 객체 인식을 수행한다. (S111) 1차 객체 인식 모델은 입력된 상품 이미지에 포함된 복수개의 상품 객체에 대해 객체 인식을 수행하여 개별 객체의 상품 또는 비(非)상품 여부를 판단한다. (S112) 1차 객체 인식 모델은 학습 데이터로 학습된 이미지와 입력된 상품 이미지의 유사도를 비교하여 산출하고, 산출된 유사도가 기설정된 기준치 이상이면 상품으로 판단하고, 기준치 미만이면 비(非)상품으로 판단한다. 기 준치는 사용자 설정 또는 통계적인 방법에 의해 설정될 수 있다. 도 8의 예시에서 상품 객체 이미지 P1은 유사도가 기준치 이상 이여서 상품으로 판단된 경우이고, 상품 객체 이 미지 P2와 P3은 유사도가 기준치 미만 이여서 비(非)상품으로 판단된 경우이다. 다음, 2차 객체 인식 모델이 S112 단계에서 비(非)상품으로 인식된 객체(P2, P3, P4)에 대해 비지도 학습 기반 객체 인식을 수행하여 결품 여부를 판정한다. 상품 객체 이미지 P4는 도 8에는 생략되어 있으나, 비(非)상 품으로 판단된 객체로 간주하여 설명한다. 먼저, 2차 객체 인식 모델은 비(非)상품으로 인식된 객체의 이미지(이하, ‘비상품 객체 이미지’라 함)에 대해 이미지 전 처리 작업을 수행한다. (S121) 즉, 비상품 객체 이미지에 포함된 배경이나 기타 노이즈를 제거 하여 비상품 객체만 남도록 이미지 전 처리한다. 다음, 인코더가 전처리된 비상품 객체 이미지를 쿼리 데이터로 하여 학습을 통해 n차원의 잠재 공간 으로 매핑시킨다. (S122) 잠재 공간은 특정 차원에서 원하는 정보들이 모여있는 공간을 의미하며, 잠재 공 간에는 학습시킨 이미지들이 잠재 벡터(latent vector)의 분포 형태로 존재한다. 다음, 이미지 생성기가 인코더를 통해 입력된 쿼리 데이터를 매핑시킨 잠재 공간을 기반으로 가 상 상품 이미지(P2’, P3’, P4’)를 생성한다. (S123) 가상 상품 이미지는 2차 객체 인식 모델이 학습한 상품 이미지로, 인코더를 통해 입력된 쿼리 데이터와 이미지 차이값(또는 유사도)을 도출하기 위해 생성된 상품 이미지이다. 다음, 결품 판정기가 쿼리 데이터와 이미지 생성기에서 생성된 가상 상품 이미지의 이미지 차이값(이 상 가중치(Anomaly weight))을 도출(S124)하고, 도출된 이미지 차이값과 기설정된 기준값을 비교(S125)하여, 이미지 차이값이 기준값 이하이면 쿼리 데이터를 상품 이미지로 판정(S126)하고, 이미지 차이값이 기준값 초과이 면 쿼리 데이터를 결품 이미지로 판정(S127)한다. 도 9의 예시에서, 쿼리 데이터는 입력 이미지 이고, 가상 상품 이미지는 생성 이미지 이며, 이상 가중치(W) 는 와 의 이미지 차이값이다. 비(非)상품으로 인식된 객체(P2, P3, P4) 중에서 객체 P3와 객체 P4는 이상 가중치(W)가 기준값 이하이여서 상품 이미지로 판정되고, 객체 P2는 이상 가중치(W)가 기준값 초과이여서 결품 이미지로 판정된다. 도 10에는 입력 이미지 (즉, 도 10의 (a))와 출력 이미지 (도 10의 (b))의 이미지 차이값으로 이상 가중치 (W)를 도출(즉, 도 10의 (c))하는 과정이 예시되어 있다. 또는, 결품 판정기는 쿼리 데이터와 이미지 생성기에서 생성된 가상 상품 이미지의 유사도값을 도출 하고, 도출된 유사도값과 기설정된 기준값을 비교하여, 유사도값이 기준값 이상이면 쿼리 데이터를 상품 이미지 로 판정하고, 유사도값이 기준값 미만이면 쿼리 데이터를 결품 이미지로 판정한다. 이와 같은 방식으로 비상품 객체 이미지가 결품인 것으로 판정되면, 이를 저장하고 사용자에게 결품발생 알람 메시지를 전송한다. (S128) 상기와 같은 본 발명의 일 실시예에 따른 비지도 학습 기반 결품 인식 장치 및 결품 인식 방법에 의하면, 지도 학습 기반 객체 인식 방법과 비지도 학습 기반으로 이루어지는 이상 탐지 방법을 적용한 다중 처리(multi processing) 방식으로 결품 인식을 진행하여 오알람(false alarm) 발생 빈도수를 줄일 수 있다. 도 11은 본 발명의 실시예에 따른, 컴퓨팅 장치를 나타내는 도면이다. 도 11의 컴퓨팅 장치(TN100)는 본 명세 서에서 기술된 비지도 학습 기반 결품 인식 장치, 특히, 객체 인식부의 하드웨어적인 구성일 수 있다. 도 11의 실시예에서, 컴퓨팅 장치(TN100)는 적어도 하나의 프로세서(TN110), 송수신 장치(TN120), 및 메모리 (TN130)를 포함할 수 있다. 또한, 컴퓨팅 장치(TN100)는 저장 장치(TN140), 입력 인터페이스 장치(TN150), 출 력 인터페이스 장치(TN160) 등을 더 포함할 수 있다. 컴퓨팅 장치(TN100)에 포함된 구성 요소들은 버스 (bus)(TN170)에 의해 연결되어 서로 통신을 수행할 수 있다. 프로세서(TN110)는 메모리(TN130) 및 저장 장치(TN140) 중에서 적어도 하나에 저장된 프로그램 명령(program command)을 실행할 수 있다. 프로세서(TN110)는 중앙 처리 장치(CPU: central processing unit), 그래픽 처리 장치(GPU: graphics processing unit), 또는 본 발명의 실시예에 따른 방법들이 수행되는 전용의 프로세서를 의 미할 수 있다. 프로세서(TN110)는 본 발명의 실시예와 관련하여 기술된 절차, 기능, 및 방법 등을 구현하도록 구성될 수 있다. 프로세서(TN110)는 컴퓨팅 장치(TN100)의 각 구성 요소를 제어할 수 있다. 메모리(TN130) 및 저장 장치(TN140) 각각은 프로세서(TN110)의 동작과 관련된 다양한 정보를 저장할 수 있다. 메모리(TN130) 및 저장 장치(TN140) 각각은 휘발성 저장 매체 및 비휘발성 저장 매체 중에서 적어도 하나로 구 성될 수 있다. 예를 들어, 메모리(TN130)는 읽기 전용 메모리(ROM: read only memory) 및 랜덤 액세스 메모리 (RAM: random access memory) 중에서 적어도 하나로 구성될 수 있다. 송수신 장치(TN120)는 유선 신호 또는 무선 신호를 송신 또는 수신할 수 있다. 송수신 장치(TN120)는 네트워크 에 연결되어 통신을 수행할 수 있다. 한편, 본 발명은 컴퓨터프로그램으로 구현될 수도 있다. 본 발명은 하드웨어와 결합되어, 컴퓨터가 판독 가능한 기록매체에 저장된 컴퓨터 프로그램으로 구현될 수 있다. 본 발명의 실시예에 따른 방법들은 다양한 컴퓨터수단을 통하여 판독 가능한 프로그램 형태로 구현되어 컴퓨터 로 판독 가능한 기록매체에 기록될 수 있다. 여기서, 기록매체는 프로그램 명령, 데이터 파일, 데이터구조 등을 단독으로 또는 조합하여 포함할 수 있다. 기록매체에 기록되는 프로그램 명령은 본 발명을 위하여 특별히 설계되고 구성된 것들이거나 컴퓨터 소프트웨어 당업자에게 공지되어 사용 가능한 것일 수도 있다. 예컨대 기록매체는 하드 디스크, 플로피 디스크 및 자기 테이프와 같은 자기 매체(magnetic media), CDROM, DVD 와 같은 광 기록 매체(optical media), 플롭티컬 디스크(floptical disk)와 같은 자기-광 매체(magneto- optical media), 및 롬(ROM), 램(RAM), 플래시 메모리 등과 같은 프로그램 명령을 저장하고 수행하도록 특별히구성된 하드웨어 장치를 포함한다. 프로그램 명령의 예에는 컴파일러에 의해 만들어지는 것과 같은 기계어뿐만 아니라 인터프리터 등을 사용해서 컴퓨터에 의해서 실행될 수 있는 고급 언어를 포함할 수 있다. 이러한 하드웨어 장치는 본 발명의 동작을 수행하기 위해 하나 이상의 소프트웨어 모듈로서 작동하도록 구성될 수 있으며, 그 역도 마찬가지이다. 이상, 본 발명의 일 실시예에 대하여 설명하였으나, 해당 기술 분야에서 통상의 지식을 가진 자라면 특허청구범 위에 기재된 본 발명의 사상으로부터 벗어나지 않는 범위 내에서, 구성 요소의 부가, 변경, 삭제 또는 추가 등 에 의해 본 발명을 다양하게 수정 및 변경시킬 수 있을 것이며, 이 또한 본 발명의 권리범위 내에 포함된다고 할 것이다."}
{"patent_id": "10-2022-0112750", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 일 실시예에 따른 비지도학습 기반 결품 인식 장치가 개념적으로 도시된 블록도이다. 도 2는 2차 객체 인식 모델이 개념적으로 도시된 블록도이다. 도 3은 2차 객체 인식 모델의 인코더 아키텍처의 일부를 이루는 CNN 아키텍처가 도시된 도면이다. 도 4는 2차 객체 인식 모델의 인코더 아키텍처의 일부를 이루는 ViT 아키텍처가 도시된 도면이다. 도 5는 2차 객체 인식 모델의 인코더의 학습 과정이 도시된 도면이다. 도 6은 2차 객체 인식 모델의 인코더의 학습 상세 아키텍처가 도시된 도면이다. 도 7은 본 발명의 일 실시예에 따른 비지도학습 기반 결품 인식 방법이 도시된 순서도이다. 도 8은 1차 객체 인식 모델의 객체 인식 과정이 예시된 도면이다. 도 9는 2차 객체 인식 모델의 객체 인식 과정이 예시된 도면이다. 도 10은 이상 가중치(W) 도출 과정을 설명하기 위한 도면이다. 도 11은 본 발명의 실시예에 따른, 컴퓨팅 장치가 도시된 도면이다."}
