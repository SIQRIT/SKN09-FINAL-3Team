{"patent_id": "10-2022-0145573", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2024-0063677", "출원번호": "10-2022-0145573", "발명의 명칭": "연합 학습을 이용한 인공지능 기반 침입 탐지 방법", "출원인": "한전케이디엔주식회사", "발명자": "김종만"}}
{"patent_id": "10-2022-0145573", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "서버와 복수의 클라이언트로 구성되는 침입 탐지 시스템에 의해 수행되는 침입 탐지 방법에 있어서,상기 서버가 학습 데이터를 이용하여 침입 탐지 모델을 생성하고, 상기 침입 탐지 모델을 각 클라이언트에 배포하는 단계;상기 각 클라이언트가 실시간 패킷을 이용하여 상기 침입 탐지 모델을 자기지도 학습(self-supervisedlearning)시켜 상기 침입 탐지 모델에 대한 학습 파라미터를 생성하고, 상기 학습 파라미터를 상기 서버에 송신하는 단계; 및상기 서버가 상기 학습 파라미터에 기초하여 상기 침입 탐지 모델의 글로벌 파라미터를 갱신하고, 상기 갱신된글로벌 파라미터를 상기 각 클라이언트에 배포하는 단계를 포함하는연합 학습을 이용한 인공지능 기반 침입 탐지 방법."}
{"patent_id": "10-2022-0145573", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 침입 탐지 모델은 입력된 패킷의 정상 여부를 분류하는연합 학습을 이용한 인공지능 기반 침입 탐지 방법."}
{"patent_id": "10-2022-0145573", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1항에 있어서,상기 침입 탐지 모델을 배포하는 단계는상기 학습 데이터를 이용하여 상기 침입 탐지 모델을 지도 학습시켜 상기 침입 탐지 모델에 대한 글로벌 파라미터를 생성하는 단계와,상기 글로벌 파라미터가 적용된 상기 침입 탐지 모델을 상기 각 클라이언트에 배포하는 단계를 포함하는연합 학습을 이용한 인공지능 기반 침입 탐지 방법."}
{"patent_id": "10-2022-0145573", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제1항에 있어서,상기 침입 탐지 모델을 자기지도 학습시키는 단계는상기 실시간 패킷을 상기 침입 탐지 모델에 입력하여 상기 실시간 패킷별 예측 신뢰도를 획득하는 단계와,상기 예측 신뢰도가 기준값 이상인 실시간 패킷을 의사 레이블링(pseudo-labeling)하는 단계와,상기 의사 레이블링된 실시간 패킷을 이용하여 상기 침입 탐지 모델을 지도 학습시키는 단계를 포함하는연합 학습을 이용한 인공지능 기반 침입 탐지 방법."}
{"patent_id": "10-2022-0145573", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "공개특허 10-2024-0063677-3-제1항에 있어서,상기 글로벌 파라미터를 갱신하는 단계는상기 각 클라이언트로부터 수신된 상기 학습 파라미터의 중간값, 평균값, 절사평균값 중 어느 하나를 상기 글로벌 파라미터로 갱신하는 단계를 포함하는연합 학습을 이용한 인공지능 기반 침입 탐지 방법."}
{"patent_id": "10-2022-0145573", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제1항에 있어서,상기 각 클라이언트가 상기 실시간 패킷을 상기 침입 탐지 모델에 입력하여 상기 실시간 패킷의 예측 신뢰도를획득하고, 상기 예측 신뢰도가 기준범위 이내인 실시간 패킷을 상기 서버로 송신하는 단계와,상기 서버가 상기 실시간 패킷을 관리자 단말로 송신하고, 상기 실시간 패킷에 대한 실 판정 결과(GroundTruth; GT)를 상기 관리자 단말로부터 수신하고, 상기 실 판정 결과에 따라 상기 실시간 패킷을 레이블링하는단계와,상기 서버가 상기 레이블링된 실시간 패킷을 상기 학습 데이터에 추가하고, 상기 학습 데이터를 이용하여 상기침입 탐지 모델을 재차 지도 학습시키는 단계를 더 포함하는연합 학습을 이용한 인공지능 기반 침입 탐지 방법."}
{"patent_id": "10-2022-0145573", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 침입 탐지를 위한 인공지능 모델을 연합 학습하고, 이를 통해 각 클라이언트가 서로 다른 네트워크 상 에서 실시간 패킷의 위협 여부를 판단하는 방법에 관한 것이다. 본 발명의 일 실시예에 따른 연합 학습을 이용한 인공지능 기반 침입 탐지 방법은, 서버와 복수의 클라이언트로 구성되는 침입 탐지 시스템에 의해 수행되는 침입 (뒷면에 계속)"}
{"patent_id": "10-2022-0145573", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 침입 탐지를 위한 인공지능 모델을 연합 학습하고, 이를 통해 각 클라이언트가 서로 다른 네트워크 상에서 실시간 패킷의 위협 여부를 판단하는 방법에 관한 것이다."}
{"patent_id": "10-2022-0145573", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "침입 탐지 시스템(Intrusion Detection System; IDS)은 전통적인 방화벽(firewall)이 탐지할 수 없는 다양한 종류의 악의적인 네트워크 트래픽을 탐지하는 시스템으로, 데이터 처리 공격(data driven attack), 권한 확대 (privilege escalation), 침입자의 로그인, 침입자에 의한 주요 파일 접근, 악성 소프트웨어(바이러스, 트로이 목마, 웜) 등과 같은 공격을 탐지한다. 기존 침입 탐지 시스템(IDS)은 시스템 설계자가 미리 작성 및 배포한 탐지 패턴, 예컨대 스노트(Snort), YARA 등에 기반하여 위협을 탐지하는데, 이 방식에 의하면 새로운 위협이 발생할 때마다 탐지 패턴을 증가시켜야 하 고, 이로 인해 탐지 패턴의 관리가 어려워지는 문제가 있다. 또한, 침입 탐지 시스템(IDS)의 제조사가 다른 경 우, 새로운 탐지 패턴을 배포하기 위해서는 각 제조사별 침입 탐지 시스템(IDS)에 탐지 패턴을 일일이 배포해야 하는 번거로움이 있다."}
{"patent_id": "10-2022-0145573", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은 연합 학습을 통해 침입 탐지 모델을 학습시키고 이를 이용하여 각 클라이언트가 서로 다른 네트워크 상에서 실시간 패킷의 위협 여부를 판단하는 것을 목적으로 한다. 본 발명의 목적들은 이상에서 언급한 목적으로 제한되지 않으며, 언급되지 않은 본 발명의 다른 목적 및 장점들 은 하기의 설명에 의해서 이해될 수 있고, 본 발명의 실시예에 의해 보다 분명하게 이해될 것이다. 또한, 본 발 명의 목적 및 장점들은 특허 청구 범위에 나타낸 수단 및 그 조합에 의해 실현될 수 있음을 쉽게 알 수 있을 것이다."}
{"patent_id": "10-2022-0145573", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "전술한 목적을 달성하기 위한 본 발명의 일 실시예에 따른 연합 학습을 이용한 인공지능 기반 침입 탐지 방법은, 서버와 복수의 클라이언트로 구성되는 침입 탐지 시스템에 의해 수행되는 침입 탐지 방법에 있어서, 상 기 서버가 학습 데이터를 이용하여 침입 탐지 모델을 생성하고, 상기 침입 탐지 모델을 각 클라이언트에 배포하 는 단계, 상기 각 클라이언트가 실시간 패킷을 이용하여 상기 침입 탐지 모델을 자기지도 학습(self-supervised learning)시켜 상기 침입 탐지 모델에 대한 학습 파라미터를 생성하고, 상기 학습 파라미터를 상기 서버에 송신 하는 단계 및 상기 서버가 상기 학습 파라미터에 기초하여 상기 침입 탐지 모델의 글로벌 파라미터를 갱신하고, 상기 갱신된 글로벌 파라미터를 상기 각 클라이언트에 배포하는 단계를 포함하는 것을 특징으로 한다. 일 실시예에서, 상기 침입 탐지 모델은 입력된 패킷의 정상 여부를 분류하는 것을 특징으로 한다. 일 실시예에서, 상기 침입 탐지 모델을 배포하는 단계는, 상기 학습 데이터를 이용하여 상기 침입 탐지 모델을 지도 학습시켜 상기 침입 탐지 모델에 대한 글로벌 파라미터를 생성하는 단계와, 상기 글로벌 파라미터가 적용 된 상기 침입 탐지 모델을 상기 각 클라이언트에 배포하는 단계를 포함하는 것을 특징으로 한다. 일 실시예에서, 상기 침입 탐지 모델을 자기지도 학습시키는 단계는, 상기 실시간 패킷을 상기 침입 탐지 모델 에 입력하여 상기 실시간 패킷별 예측 신뢰도를 획득하는 단계와, 상기 예측 신뢰도가 기준값 이상인 실시간 패 킷을 의사 레이블링(pseudo-labeling)하는 단계와, 상기 의사 레이블링된 실시간 패킷을 이용하여 상기 침입 탐 지 모델을 지도 학습시키는 단계를 포함하는 것을 특징으로 한다. 일 실시예에서, 상기 글로벌 파라미터를 갱신하는 단계는, 상기 각 클라이언트로부터 수신된 상기 학습 파라미 터의 중간값, 평균값, 절사평균값 중 어느 하나를 상기 글로벌 파라미터로 갱신하는 단계를 포함하는 것을 특징 으로 한다. 일 실시예에서, 상기 각 클라이언트가 상기 실시간 패킷을 상기 침입 탐지 모델에 입력하여 상기 실시간 패킷의 예측 신뢰도를 획득하고, 상기 예측 신뢰도가 기준범위 이내인 실시간 패킷을 상기 서버로 송신하는 단계와, 상 기 서버가 상기 실시간 패킷을 관리자 단말로 송신하고, 상기 실시간 패킷에 대한 실 판정 결과(Ground Truth; GT)를 상기 관리자 단말로부터 수신하고, 상기 실 판정 결과에 따라 상기 실시간 패킷을 레이블링하는 단계와, 상기 서버가 상기 레이블링된 실시간 패킷을 상기 학습 데이터에 추가하고, 상기 학습 데이터를 이용하여 상기 침입 탐지 모델을 재차 지도 학습시키는 단계를 더 포함하는 것을 특징으로 한다."}
{"patent_id": "10-2022-0145573", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명은 연합 학습을 통해 침입 탐지 모델을 학습시킴으로써, 서버가 각 클라이언트가 설치된 회사 네트워크 망의 데이터를 수집하지 않아 데이터 보안에 유리하고, 모델 학습을 위한 리소스를 분산할 수 있어 학습 효율성 이 높다는 장점이 있다. 또한, 본 발명은 서버가 침입 탐지 모델을 갱신 및 배포함으로써 서버에서 각 회사 네트워크 망에서 동작하는 침입 탐지 모델을 일괄적으로 관리할 수 있어 시스템 운용 효율성이 높다는 장점이 있다. 또한, 본 발명은 특정 네트워크 망에서 발생한 새로운 위협을 침입 탐지 모델의 학습에 반영한 뒤 이를 각 클라 이언트에 배포함으로써, 특정 회사에서 발생한 사이버 공격에 대한 방어책을 모든 회사에 적용할 수 있다는 효 과가 있다. 상술한 효과와 더불어 본 발명의 구체적인 효과는 이하"}
{"patent_id": "10-2022-0145573", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "전술한 목적, 특징 및 장점은 첨부된 도면을 참조하여 상세하게 후술되며, 이에 따라 본 발명이 속하는 기술분 야에서 통상의 지식을 가진 자가 본 발명의 기술적 사상을 용이하게 실시할 수 있을 것이다. 본 발명을 설명함 에 있어서 본 발명과 관련된 공지 기술에 대한 구체적인 설명이 본 발명의 요지를 불필요하게 흐릴 수 있다고 판단되는 경우에는 상세한 설명을 생략한다. 이하, 첨부된 도면을 참조하여 본 발명에 따른 바람직한 실시예를 상세히 설명하기로 한다. 도면에서 동일한 참조부호는 동일 또는 유사한 구성요소를 가리키는 것으로 사용된다. 본 명세서에서 제1, 제2 등이 다양한 구성요소들을 서술하기 위해서 사용되나, 이들 구성요소들은 이들 용어에 의해 제한되지 않음은 물론이다. 이들 용어들은 단지 하나의 구성요소를 다른 구성요소와 구별하기 위하여 사용 하는 것으로, 특별히 반대되는 기재가 없는 한, 제1 구성요소는 제2 구성요소일 수도 있음은 물론이다. 또한, 본 명세서에서 \"상부 (또는 하부)\" 또는 구성요소의 \"상 (또는 하)\"에 임의의 구성이 배치된다는 것은, 임의의 구성이 상기 구성요소의 상면 (또는 하면)에 접하여 배치되는 것뿐만 아니라, 상기 구성요소와 상기 구 성요소 상에 (또는 하에) 배치된 임의의 구성 사이에 다른 구성이 개재될 수 있음을 의미할 수 있다. 또한, 본 명세서에서 어떤 구성요소가 다른 구성요소에 \"연결\", \"결합\" 또는 \"접속\"된다고 기재된 경우, 상기 구성요소들은 서로 직접적으로 연결되거나 또는 접속될 수 있지만, 각 구성요소 사이에 다른 구성요소가 \"개 재\"되거나, 각 구성요소가 다른 구성요소를 통해 \"연결\", \"결합\" 또는 \"접속\"될 수도 있는 것으로 이해되어야 할 것이다. 또한, 본 명세서에서 사용되는 단수의 표현은 문맥상 명백하게 다르게 뜻하지 않는 한, 복수의 표현을 포함한다. 본 출원에서, \"구성된다\" 또는 \"포함한다\" 등의 용어는 명세서 상에 기재된 여러 구성 요소들, 또는 여러 단계들을 반드시 모두 포함하는 것으로 해석되지 않아야 하며, 그 중 일부 구성 요소들 또는 일부 단계들 은 포함되지 않을 수도 있고, 또는 추가적인 구성 요소 또는 단계들을 더 포함할 수 있는 것으로 해석되어야 한 다. 또한, 본 명세서에서, \"A 및/또는 B\" 라고 할 때, 이는 특별한 반대되는 기재가 없는 한, A, B 또는 A 및 B를 의미하며, \"C 내지 D\" 라고 할 때, 이는 특별한 반대되는 기재가 없는 한, C 이상이고 D 이하인 것을 의미한다 본 발명은 침입 탐지를 위한 인공지능 모델을 연합 학습하고, 이를 통해 각 클라이언트가 서로 다른 네트워크 상에서 실시간 패킷의 위협 여부를 판단하는 방법에 관한 것이다. 이하, 도 1 내지 도 6을 참조하여 본 발명의 일 실시예에 따른 연합 학습을 이용한 인공지능 기반 침입 탐지 방법(이하, 침입 탐지 방법)을 구체적으로 설명 하도록 한다. 도 1은 본 발명의 일 실시예에 따른 침입 탐지 시스템을 도시한 도면이고, 도 2는 본 발명의 일 실시예에 따른 침입 탐지 방법을 도시한 순서도이다. 도 3은 클라이언트가 침입 탐지 모델을 자기지도 학습시키는 과정을 도시한 순서도이고, 도 4는 침입 탐지 모델 을 이용한 클라이언트의 동작을 도시한 순서도이다. 도 5는 서버가 침입 탐지 모델을 재학습시키는 과정을 도시한 순서도이다. 도 6은 침입 탐지 시스템의 일 구현예와 이를 통한 침입 탐지 방법을 설명하기 위한 도면이다. 도 1을 참조하면, 본 발명의 일 실시예에 따른 침입 탐지 시스템은 서버, 복수의 클라이언트 및 관 리자 단말을 포함할 수 있다. 서버와 각 클라이언트는 인공지능을 통해 패킷의 정상/위협 여부를 분류하는 침입 탐지 모델을 공유하 며, 서버는 복수의 클라이언트를 이용하여 침입 탐지 모델을 연합 학습(federated learning)시킬 수 있 다. 한편, 관리자 단말은 서버를 관리하는 관리자의 단말로서, 서버와 데이터 통신을 수행할 수 있는 임의의 단말, 예컨대, 스마트폰, 노트북, 태블릿, PC 등을 포함할 수 있다. 도 2를 참조하면, 본 발명의 일 실시예에 따른 침입 탐지 방법은 서버가 침입 탐지 모델을 생성하는 단계 (S10), 서버가 클라이언트에 침입 탐지 모델을 배포하는 단계(S20), 클라이언트가 침입 탐지 모델 을 자기지도 학습(self-supervised learning)시키는 단계(S30), 클라이언트가 서버에 학습 파라미터를 송신하는 단계(S40), 서버가 침입 탐지 모델의 글로벌 파라미터를 갱신하는 단계(S50), 서버가 갱신된 글로벌 파라미터를 클라이언트에 배포하는 단계(S60)를 포함할 수 있다. 다만, 도 2에 도시된 침입 탐지 방법은 일 실시예에 따른 것이고, 발명을 이루는 각 단계들이 도 2에 도시된 실 시예에 한정되는 것은 아니며, 필요에 따라 일부 단계들이 부가, 변경 또는 삭제될 수 있다. 한편, 도 2에서는 서버와 하나의 클라이언트 사이에서 이루어지는 동작 과정만을 도시하였으나, 도 2에 도시된 각 단계는 서버와 복수 클라이언트 각각 사이에서 이루어지는 것으로 이해되어야 한다. 서버와 각 클라이언트는 후술하는 동작을 수행하기 위하여, ASICs(application specific integrated circuits), DSPs(digital signal processors), DSPDs(digital signal processing devices), PLDs(programmable logic devices), FPGAs(field programmable gate arrays), 제어기(controller), 마이크로 컨트롤러(micro-controllers), 프로세서(processor), 마이크로프로세서(microprocessor) 중 적어도 하나의 물 리적인 요소를 포함할 수 있다. 이하, 도 2에 도시된 단계들을 구체적으로 설명하도록 한다. 서버는 미리 구축된 학습 데이터를 이용하여 침입 탐지 모델을 생성할 수 있다(S10). 본 발명에서 침입 탐 지 모델은 인공지능 및/또는 기계학습을 이용하여 모델에 입력되는 패킷의 정상 여부를 분류할 수 있다. 이를 위해 침입 탐지 모델은 분류 태스크(classification task)를 수행하는 다양한 인공지능 알고리즘을 포함할 수 있고, 예컨대 분류 신경망(Neural Network; NN), 회귀(regression) 신경망, 결정 트리(decision tree), 서포트 벡터 머신(Support Vector Machine; SVM), K-최소 근접(K-Nearest Neighbor; KNN) 알고리즘 등을 포함할 수 있 다. 학습 데이터는 학습용 패킷과, 학습용 패킷의 정상 여부에 따라 결정되는 클래스(class)로 이루어질 수 있고, 클래스는 관리자의 실 판정 결과(Ground Truth; GT)에 따라 학습용 패킷별로 레이블링(labeling)된 값일 수 있 다. 이러한 학습 데이터는 침입 탐지 모델의 지도 학습(supervised learning)을 위해 미리 구축되어 서버 내 데이터베이스에 저장될 수 있다. 서버는 학습용 패킷을 침입 탐지 모델의 입력 데이터로 설정하고, 학습용 패킷에 대응하는 클래스를 침입 탐지 모델의 출력 데이터로 설정함으로써 침입 탐지 모델을 지도 학습시킬 수 있으며, 이를 통해 침입 탐지 모 델에 대한 글로벌 파라미터를 생성할 수 있다. 구체적으로, 지도 학습에 의해 침입 탐지 모델은 패킷과 클래스 간의 상관관계를 학습할 수 있고, 학습이 반복 됨에 따라 침입 탐지 모델의 파라미터(weight, bias), 자세하게는 침입 탐지 모델을 구성하는 각 신경망 레이어 의 파라미터는 갱신 설정될 수 있다. 서버는 조기 종료(early stopping) 등의 방법에 따라 학습을 종료함으로써 초기 침입 탐지 모델을 생성할 수 있고, 학습 종료 시 결정된 파라미터가 글로벌 파라미터로 결정될 수 있다. 서버는 앞서 생성된 침입 탐지 모델을 침입 탐지 시스템을 구성하는 모든 클라이언트에 배포 (broadcasting)할 수 있다(S20). 구체적으로, 서버는 글로벌 파라미터가 적용된 침입 탐지 모델을 각 클라 이언트에 배포할 수 있고, 각 클라이언트는 내부 데이터베이스에 초기 침입 탐지 모델을 저장할 수 있 다. 클라이언트는 침입 탐지 모델을 이용하여 네트워크 상에서 수집되는 실시간 패킷의 정상 여부를 판단할 수 있다. 클라이언트는 실시간 패킷을 침입 탐지 모델에 입력할 수 있고, 침입 탐지 모델은 입력된 실시간 패 킷의 정상 여부에 따른 클래스를 출력할 수 있다. 구체적으로, 침입 탐지 모델은 패킷과 클래스 간의 상관관계를 학습한 상태이므로, 실시간 패킷을 입력받고 해 당 패킷이 정상인지에 따라 결정되는 클래스를 출력할 수 있다. 클라이언트는 침입 탐지 모델에서 출력된 클래스에 따라 실시간 패킷이 정상 패킷인지 위협 패킷인지 판정할 수 있다. 한편, 각 클라이언트는 침입 탐지 모델을 추가 지도 학습시킬 수 있다. 구체적으로, 각 클라이언트 내 데이터베이스에는 클라이언트의 관리자가 미리 레이블링한 추가 학습 데이터가 미리 저장될 수 있다. 클라 이언트는 추가 학습 데이터를 더 이용하여 초기 침입 탐지 모델을 지도 학습시킬 수 있다. 클라이언트 에서 수행되는 지도 학습에 따라 침입 탐지 모델의 글로벌 파라미터는 갱신될 수 있고, 이하 클라이언트의 학습 동작에 따라 갱신된 글로벌 파라미터를 학습 파라미터로 지칭하도록 한다. 또한, 클라이언트는 실시간 패킷을 이용하여 침입 탐지 모델을 자기지도 학습시켜 침입 탐지 모델에 대한 학습 파라미터를 생성할 수 있다(S30). 실시간 패킷은 네트워크 상에서 실시간으로 수집되는 패킷으로 관리자에 의해 레이블링이 되어있지 않은 패킷일 수 있다. 클라이언트는 이러한 실시간 패킷을 이용하여 침입 탐지 모델을 자기지도 학습할 수 있고, 구체적 으로 의사 레이블링(pseudo-labeling)을 통한 자기지도 학습을 수행할 수 있다. 도 4를 참조하면, 클라이언트는 실시간 패킷을 침입 탐지 모델에 입력하여 실시간 패킷별 예측 신뢰도를 획 득할 수 있다(S31). 앞서 설명한 바와 같이 침입 탐지 모델은 분류 신경망일 수 있고, 분류 신경망은 입력 데이 터의 클래스와 해당 클래스에 속할 확률, 즉 예측 신뢰도를 출력할 수 있다. 클라이언트는 실시간 패킷별 예측 신뢰도를 기준값과 비교할 수 있고(S32), 예측 신뢰도가 기준값 이상인 실시간 패킷을 의사 레이블링할 수 있다(S33). 예컨대, 정상 패킷에 대응하는 클래스가 '0'이고, 위협 패킷에 대응하는 클래스가 '1'일 때, 클라이언트는 예측 신뢰도가 90% 이상인 실시간 패킷을, 해당 패킷에 대해 출력된 클래스로 레이블링할 수 있다. 구체적으로, 실시간 패킷에 대한 침입 탐지 모델의 출력이 클래스인 '0'과 예측 신뢰도인 0.95인 경우, 클라이언트는 레 이블링되지 않았던 해당 실시간 패킷의 클래스를 '0'으로 레이블링할 수 있다. 이어서, 클라이언트는 의사 레이블링된 실시간 패킷을 이용하여 침입 탐지 모델을 지도 학습시킬 수 있다 (S34). 앞서 설명한 바와 같이 지도 학습에는 레이블링된 패킷이 필요한데, 레이블링되지 않았던 실시간 패킷은 클라이언트의 의사 레이블링에 의해 레이블링된 바 지도 학습에 이용될 수 있다. 클라이언트에서 수행되는 자기지도 학습에 따라 침입 탐지 모델의 글로벌 파라미터는 학습 파라미터로 갱신 될 수 있고, 각 클라이언트는 서버에 학습 파라미터를 송신할 수 있다(S40). 서버는 각 클라이언트로부터 수신된 학습 파라미터에 기초하여 침입 탐지 모델의 글로벌 파라미터를 갱 신할 수 있다(S50). 구체적으로, 서버는 각 클라이언트로부터 수신된 학습 파라미터의 중간값(median), 평균값, 절사평균값(trimmed mean) 중 어느 하나를 글로벌 파라미터로 갱신할 수 있다. 일 예에서, 제1 내지 제n 클라이언트로부터 수신된 학습 파라미터가 w1, w2, …, wn인 경우, 서버는 학 습 파라미터들의 평균값, 즉 (w1+w2+…+wn)/n을 글로벌 파라미터로 갱신할 수 있다. 이 외에도 서버는 학습 파라미터들의 중간값이나, 절사평균값을 글로벌 파라미터로 갱신할 수도 있다. 이어서, 서버는 갱신된 글로벌 파라미터를 각 클라이언트에 배포할 수 있고(S60), 각 클라이언트는 데이터베이스에 기 저장된 침입 탐지 모델에 갱신된 글로벌 파라미터를 적용할 수 있다. 이후, 클라이언트 는 다시 도 3에 도시된 단계들(S31 내지 S34)을 수행하여 글로벌 파라미터를 학습 파라미터로 다시 갱신할 수 있고, 단계(S40) 내지 단계(S60)의 동작이 반복 수행될 수 있다. 앞서 설명한 바와 같이, 본 발명은 연합 학습을 통해 침입 탐지 모델을 학습시킴으로써, 서버가 각 클라이 언트가 설치된 회사 네트워크 망의 데이터를 수집하지 않아 데이터 보안에 유리하고, 모델 학습을 위한 리 소스를 분산할 수 있어 학습 효율성이 높다는 장점이 있다. 또한, 본 발명은 서버가 침입 탐지 모델을 갱신 및 배포함으로써 서버에서 각 회사 네트워크 망에서 동 작하는 침입 탐지 모델을 일괄적으로 관리할 수 있어 시스템 운용 효율성이 높다는 장점이 있다. 한편, 침입 탐지 모델의 학습에 이용되지 않았던 새로운 위협이 네트워크 상에 등장한 경우 이를 반영하여 침입 탐지 모델을 학습시킬 필요가 있다. 이를 위해, 클라이언트는 새로운 위협에 관한 실시간 패킷을 서버 로 송신할 수 있고, 서버는 이를 이용하여 침입 탐지 모델을 재학습시킬 수 있다. 구체적으로, 각 클라이언트는 실시간 패킷을 침입 탐지 모델에 입력하여 실시간 패킷의 예측 신뢰도를 획득 하고, 예측 신뢰도가 기준범위 이내인 실시간 패킷을 서버로 송신할 수 있다. 여기서 기준범위는 실시간 패 킷의 정상 또는 위협 여부를 판단하는 문턱값(예컨대, 0.8)보다 낮게 설정될 수 있다.도 4를 참조하여 클라이언트의 동작을 구체적으로 설명하면, 먼저 클라이언트는 실시간 패킷을 침입 탐 지 모델에 입력하여 실시간 패킷별 예측 신뢰도(PE)를 획득할 수 있다(S100). 클라이언트는 실시간 패킷별 예측 신뢰도(PE)를 제1 기준값, 예컨대 0.9와 비교할 수 있고(S200), 예측 신 뢰도(PE)가 제1 기준값 이상인 실시간 패킷을 앞서 설명한 방법에 따라 의사 레이블링할 수 있다(S33). 이어서, 클라이언트는 예측 신뢰도(PE)가 제1 기준값 미만인 실시간 패킷의 예측 신뢰도(PE)를 제2 기준값, 예컨대 0.8과 비교할 수 있고(S300), 예측 신뢰도(PE)가 제2 기준값 이상인 실시간 패킷을 정상 또는 위협 패킷 에 대응하는 클래스로 분류할 수 있다(S400). 즉, 제2 기준값은 실시간 패킷의 정상 또는 위협 여부를 판단하는 문턱값(threshold value)일 수 있다. 이어서, 클라이언트는 예측 신뢰도(PE)가 제2 기준값 미만인 실시간 패킷의 예측 신뢰도(PE)가 기준범위 이 내인지, 구체적으로는 제3 기준값(예컨대 0.6) 이상인지 여부를 판단할 수 있다(S500). 즉 도 4에 도시된 예에 서 기준범위는 '제3 기준값 이상 제2 기준값 미만'으로 설정된 것일 수 있다. 클라이언트는 예측 신뢰도(PE)가 제3 기준값보다 낮은 실시간 패킷에 대해서는 분류 동작을 수행하지 않을 수 있다(S600). 반면에, 클라이언트는 예측 신뢰도(PE)가 제3 기준값 이상인 실시간 패킷을 판단이 모호한 (60% 내지 80%의 예측 신뢰도(PE)를 갖는) 새로운 위협으로 간주하여 서버로 송신할 수 있다(S700). 도 5를 참조하면, 서버는 단계(S700)을 통해 클라이언트로부터 수신된 실시간 패킷을 관리자 단말 로 송신할 수 있고(S800), 해당 실시간 패킷에 대한 실 판정 결과(Ground Truth; GT)를 관리자 단말로부터 수신할 수 있다(S900). 여기서 실 판정 결과는 관리자가 서버에서 송신된 실시간 패킷이 정상 패킷인지 위 협 패킷인지를 실제로 판단하고, 이에 기초하여 관리자 단말을 통해 해당 실시간 패킷에 대해 라벨링한 클 래스를 의미할 수 있다. 서버는 관리자 단말에서 수신된 실 판정 결과에 따라 실시간 패킷을 레이블링할 수 있고(S1000), 새롭 게 레이블링된 실시간 패킷을 이용하여 침입 탐지 모델을 재학습시킬 수 있다(S1100). 구체적으로, 서버는 레이블링된 실시간 패킷을 데이터베이스에 저장된 학습 데이터에 추가하고, 학습 데이 터를 이용하여 침입 탐지 모델을 재차 지도 학습시킬 수 있다. 이에 따라, 글로벌 파라미터는 추가 갱신될 수 있고, 서버는 각 클라이언트에게 갱신된 글로벌 파라미터를 재차 배포할 수 있다(S1200). 전술한 바와 같이, 본 발명은 특정 네트워크 망에서 발생한 새로운 위협을 침입 탐지 모델의 학습에 반영한 뒤 이를 각 클라이언트에 배포함으로써, 특정 회사에서 발생한 사이버 공격에 대한 방어책을 모든 회사에 적용할 수 있다는 효과가 있다. 이하, 도 6을 참조하여 본 발명의 구현예와 동작을 개괄적으로 설명하도록 한다. 도 6을 참조하면, 서버는 데이터베이스에 미리 저장된 학습 데이터(위협 데이터 및 정상 데이터)를 이용하 여 침입 탐지 모델을 생성할 수 있고, 생성된 침입 탐지 모델을 각 클라이언트(클라이언트 A 내지 N, 20)에게 배포할 수 있다. 각각의 클라이언트(클라이언트 A 내지 N, 20)는 각 회사(A사 내지 N사)의 네트워크 망에 연결될 수 있고, 서버 로부터 수신된 침입 탐지 모델을 이용하여 방화벽이 탐지할 수 없는 다양한 종류의 악의적인 네트워크 트래 픽을 탐지할 수 있다. 이 때, 각 클라이언트(클라이언트 A 내지 N, 20)는 예측 신뢰도가 높은 실시간 패킷에 대해 의사 레이블링을 수 행한 후 이를 내부 데이터베이스에 저장하고, 의사 레이블링된 실시간 패킷을 이용하여 침입 탐지 모델을 지도 학습시킬 수 있다. 또한, 각 클라이언트(클라이언트 A 내지 N, 20)는 예측 신뢰도가 비교적 낮은, 즉 정상 여부 판단이 모호한 실시간 패킷을 데이터베이스에 저장할 수 있고, 이를 서버에 송신할 수 있다. 서버는 각 클라이언트(클라이언트 A 내지 N, 20)로부터 수신된 실시간 패킷을 관리자 단말에 송신할 수 있고, 관리자 단말로부터 실 판정 결과를 수신할 수 있다. 서버는 실 판정 결과에 따라 실시간 패킷을 레이블링할 수 있고, 레이블링된 실시간 패킷 데이터베이스 내 학습 데이터에 추가할 수 있다. 이어서, 서버는 데이터베이스 내 학습 데이터를 이용하여 침입 탐지 모델을 재차 지도 학습시킬 수 있고, 침입 탐지 모델 및 글로벌 파라미터를 갱신하여 다시 각 클라이언트(클라이언트 A 내지 N, 20)에 배포할 수 있 다. 이상과 같이 본 발명에 대해서 예시한 도면을 참조로 하여 설명하였으나, 본 명세서에 개시된 실시 예와 도면에 의해 본 발명이 한정되는 것은 아니며, 본 발명의 기술사상의 범위 내에서 통상의 기술자에 의해 다양한 변형이 이루어질 수 있음은 자명하다. 아울러 앞서 본 발명의 실시 예를 설명하면서 본 발명의 구성에 따른 작용 효과 를 명시적으로 기재하여 설명하지 않았을 지라도, 해당 구성에 의해 예측 가능한 효과 또한 인정되어야 함은 당 연하다."}
{"patent_id": "10-2022-0145573", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 일 실시예에 따른 침입 탐지 시스템을 도시한 도면. 도 2는 본 발명의 일 실시예에 따른 침입 탐지 방법을 도시한 순서도. 도 3은 클라이언트가 침입 탐지 모델을 자기지도 학습시키는 과정을 도시한 순서도. 도 4는 침입 탐지 모델을 이용한 클라이언트의 동작을 도시한 순서도. 도 5는 서버가 침입 탐지 모델을 재학습시키는 과정을 도시한 순서도. 도 6은 침입 탐지 시스템의 일 구현예와 이를 통한 침입 탐지 방법을 설명하기 위한 도면."}
