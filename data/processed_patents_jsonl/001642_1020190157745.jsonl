{"patent_id": "10-2019-0157745", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2021-0067783", "출원번호": "10-2019-0157745", "발명의 명칭": "전자 장치, 그 제어 방법 및 시스템", "출원인": "삼성전자주식회사", "발명자": "나상권"}}
{"patent_id": "10-2019-0157745", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "전자 장치에 있어서, 적어도 하나의 인스트럭션(instruction)을 포함하는 메모리; 및상기 메모리와 연결되어 상기 전자 장치를 제어하며, 영상을 업스케일링하도록 학습된 인공 지능 모델을 이용하여 입력 영상을 업스케일링하여 출력 영상을 획득하는 프로세서;를 포함하며,상기 프로세서는, 상기 입력 영상에 수행된 전처리(pre-processing) 관련 정보에 기초하여 상기 인공 지능 모델의 파라미터 정보를 획득하고, 상기 획득된 파라미터 정보에 대응되는 상기 인공 지능 모델을 이용하여 상기 입력 영상을 업스케일링하는, 전자 장치."}
{"patent_id": "10-2019-0157745", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서, 상기 메모리는, 상이한 전처리 각각에 대응되는 전처리 관련 정보에 맵핑된 파라미터 정보를 저장하며, 상기 프로세서는, 상기 저장된 파라미터 정보 중 상기 입력 영상과 함께 수신된 전처리 관련 정보에 대응되는 파라미터 정보를 식별하고, 상기 식별된 파라미터 정보에 대응되는 상기 인공 지능 모델을 이용하여 상기 입력 영상을 업스케일링하는, 전자 장치."}
{"patent_id": "10-2019-0157745", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제2항에 있어서, 상기 메모리에 저장된 파라미터 정보는, 상기 상이한 전처리 각각에 적용되는 필터 관련 정보를 포함하며, 상기 프로세서는, 상기 저장된 파라미터 정보 중 상기 입력 영상과 함께 수신된 필터 관련 정보에 대응되는 파라미터 정보를 식별하고, 상기 식별된 파라미터 정보에 대응되는 상기 인공 지능 모델을 이용하여 상기 입력 영상을 업스케일링하는, 전자 장치."}
{"patent_id": "10-2019-0157745", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제3항에 있어서, 상기 상이한 전처리 각각에 적용되는 필터 관련 정보는, 상기 상이한 전처리 각각에 적용되는 필터의 타입 또는 강도 중 적어도 하나에 대한 정보를 포함하는, 전자 장치."}
{"patent_id": "10-2019-0157745", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제4항에 있어서, 공개특허 10-2021-0067783-3-상기 상이한 전처리 각각에 적용되는 필터 관련 정보는, 상기 필터가 적용되기 전 영상 및 상기 필터가 적용된 후 영상 간 차이에 대한 정보를 더 포함하는, 전자 장치."}
{"patent_id": "10-2019-0157745", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제1항에 있어서, 상기 프로세서는, 상기 입력 영상을 디코딩하고 상기 디코딩된 영상을 상기 인공 지능 모델을 이용하여 업스케일링하는, 전자 장치,"}
{"patent_id": "10-2019-0157745", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제1항에 있어서, 상기 인공 지능 모델은, 복수의 신경망 레이어를 포함하며, 상기 프로세서는, 상기 획득된 파라미터 정보에 기초하여 상기 복수의 신경망 레이어 각각에 대응되는 파라미터를 설정하는, 전자장치,"}
{"patent_id": "10-2019-0157745", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "송신 장치 및 수신 장치를 포함하는 시스템에 있어서, 영상을 다운스케일링(downscaling)하도록 학습된 제1 인공 지능 모델을 이용하여 입력 영상을다운스케일링하고, 상기 다운스케일링된 영상을 전처리하여 전송하는 송신 장치; 및영상을 업스케일링(upscaling)하도록 학습된 제2 인공 지능 모델을 이용하여 상기 송신 장치로부터 수신된 영상을 업스케일링하여 출력 영상을 획득하는 수신 장치;를 포함하며,상기 송신 장치는, 상기 제1 인공 지능 모델로부터 획득된 영상의 특성 정보에 기초하여 상기 다운스케일링된 영상을 전처리하고상기 전처리 관련 정보를 상기 수신 장치로 전송하며, 상기 수신 장치는, 상기 송신 장치로부터 수신된 상기 전처리 관련 정보에 기초하여 상기 제2 인공 지능 모델의 파라미터 정보를획득하고, 상기 획득된 파라미터 정보에 대응되는 상기 제2 인공 지능 모델을 이용하여 상기 송신 장치로부터 수신된 영상을 업스케일링하는, 시스템."}
{"patent_id": "10-2019-0157745", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제8항에 있어서,상기 송신 장치는, 통신 인터페이스를 더 포함하며, 상기 통신 인터페이스가 연결된 네트워크의 상태 정보를 획득하고, 상기 네트워크의 상태 정보 및 상기 제1 인공 지능 모델로부터 획득된 영상의 특성 정보에 기초하여 상기 다운스케일링된 영상을 전처리하는, 시스템."}
{"patent_id": "10-2019-0157745", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제8항에 있어서, 상기 전처리 관련 정보는, 공개특허 10-2021-0067783-4-상기 다운스케일링된 영상의 전처리에 적용된 필터의 타입 또는 강도 중 적어도 하나에 대한 정보를 포함하는,시스템."}
{"patent_id": "10-2019-0157745", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "제10항에 있어서, 상기 전처리 관련 정보는, 상기 필터가 적용되기 전 영상 및 상기 필터가 적용된 후 영상 간 차이에 대한 정보를 더 포함하는, 시스템."}
{"patent_id": "10-2019-0157745", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제8항에 있어서, 상기 송신 장치는, 상기 전처리된 영상을 인코딩하여 상기 수신 장치로 전송하며,상기 수신 장치는, 상기 송신 장치로부터 수신된 영상을 디코딩하고 상기 제2 인공 지능 모델을 이용하여 상기 디코딩된 영상을 업스케일링하여 상기 출력 영상을 획득하는, 시스템."}
{"patent_id": "10-2019-0157745", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "제8항에 있어서, 상기 송신 장치는,상기 제1 인공 지능 모델로부터 획득된 영상의 특성 정보를 이용하여 상기 영상의 전처리 관련 정보를 획득하도록 학습된 제3 인공 지능 모델을 더 포함하며, 상기 프로세서는, 상기 제3 인공 지능 모델을 이용하여 상기 다운스케일링된 영상의 상기 전처리 관련 정보를 획득하는, 시스템."}
{"patent_id": "10-2019-0157745", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_14", "content": "전자 장치의 제어 방법에 있어서,입력 영상에 수행된 전처리(pre-processing) 관련 정보에 기초하여 영상을 업스케일링하도록 학습된 인공 지능모델의 파라미터 정보를 획득하는 단계; 및상기 획득된 파라미터 정보에 대응되는 상기 인공 지능 모델을 이용하여 상기 입력 영상을 업스케일링하여 출력영상을 획득하는 단계;를 포함하는 제어 방법."}
{"patent_id": "10-2019-0157745", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_15", "content": "제14항에 있어서,상기 파라미터 정보를 획득하는 단계는,상이한 전처리 각각에 대응되는 전처리 관련 정보에 맵핑된 파라미터 정보를 저장하는 메모리에서 상기 입력 영상과 함께 수신된 전처리 관련 정보에 대응되는 파라미터 정보를 식별하는 단계;를 포함하고,상기 출력 영상을 획득하는 단계는,상기 식별된 파라미터 정보에 대응되는 상기 인공 지능 모델을 이용하여 상기 입력 영상을 업스케일링하는단계;를 포함하는, 제어 방법."}
{"patent_id": "10-2019-0157745", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_16", "content": "제15항에 있어서,공개특허 10-2021-0067783-5-상기 메모리에 저장된 파라미터 정보는, 상기 상이한 전처리 각각에 적용되는 필터 관련 정보를 포함하며, 상기 파라미터 정보를 획득하는 단계는,상기 저장된 파라미터 정보 중 상기 입력 영상과 함께 수신된 필터 관련 정보에 대응되는 파라미터 정보를 식별하는 단계;를 포함하고,상기 출력 영상을 획득하는 단계는,상기 식별된 파라미터 정보에 대응되는 상기 인공 지능 모델을 이용하여 상기 입력 영상을 업스케일링하는단계;를 포함하는, 제어 방법."}
{"patent_id": "10-2019-0157745", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_17", "content": "제16항에 있어서,상기 상이한 전처리 각각에 적용되는 필터 관련 정보는,상기 상이한 전처리 각각에 적용되는 필터의 타입 또는 강도 중 적어도 하나에 대한 정보를 포함하는, 제어 방법."}
{"patent_id": "10-2019-0157745", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_18", "content": "제17항에 있어서,상기 상이한 전처리 각각에 적용되는 필터 관련 정보는,상기 필터가 적용되기 전 영상 및 상기 필터가 적용된 후 영상 간 차이에 대한 정보를 더 포함하는, 제어 방법."}
{"patent_id": "10-2019-0157745", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_19", "content": "제14항에 있어서,상기 출력 영상을 획득하는 단계는,상기 입력 영상을 디코딩하고 상기 디코딩된 영상을 상기 인공 지능 모델을 이용하여 업스케일링하는 단계;를포함하는, 제어 방법."}
{"patent_id": "10-2019-0157745", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_20", "content": "제14항에 있어서,상기 인공 지능 모델은,복수의 신경망 레이어를 포함하며,상기 획득된 파라미터 정보에 기초하여 상기 복수의 신경망 레이어 각각에 대응되는 파라미터를 설정하는 단계;를 포함하는, 제어 방법."}
{"patent_id": "10-2019-0157745", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "전자 장치가 개시된다. 전자 장치는 적어도 하나의 인스트럭션(instruction)을 포함하는 메모리 및 메모리와 연 결되어 전자 장치를 제어하며, 영상을 업스케일링하도록 학습된 인공 지능 모델을 이용하여 입력 영상을 업스케 일링하여 출력 영상을 획득하는 프로세서를 포함하며, 프로세서는, 입력 영상에 수행된 전처리(pre-processing) 관련 정보에 기초하여 인공 지능 모델의 파라미터 정보를 획득하고, 획득된 파라미터 정보에 대응되는 인공 지능 모델을 이용하여 입력 영상을 업스케일링한다."}
{"patent_id": "10-2019-0157745", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 전자 장치, 그 제어 방법 및 시스템에 관한 것으로, 더욱 상세하게는, 업스케일링을 수행하는 전자 장치, 그 제어 방법 및 시스템에 관한 것이다."}
{"patent_id": "10-2019-0157745", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "전자 기술의 발달에 힘입어 다양한 유형의 전자기기가 개발 및 보급되고 있다. 특히, 최근 가장 많이 사용되고 있는 모바일 장치, TV와 같은 디스플레이 장치는 최근 수년 간 급속도로 발전하고 있다.특히, 사용자에게 제공되는 컨텐츠가 초 고해상화됨에 따라 전자 장치의 연산량, 데이터량이 급수적으로 증가하 고 있는 실정이다. 이에 따라 다운스케일링, 전처리, 부호화 등을 통해 전자 장치에 전송하는 데이터량을 감소 시키고 있다. 이 경우에 전자 장치의 연산량과 데이터량이 감소되는 효과는 있으나, 원본 영상에 포함된 디테일이 손실된 상 태에서 사용자에게 제공되는 문제가 있었다. 특히 라이브 스트리밍 상황에서는 원본 영상에 대한 전처리 과정에 서 손실된 디테일이 복원되지 않은 상태에서 복원 영상이 사용자에게 제공되는 문제가 있었다."}
{"patent_id": "10-2019-0157745", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은 상술한 필요성에 따른 것으로, 본 발명의 목적은, 압축 부호화 성능을 향상시키기 위해 AI 인코딩 및 디코딩을 연동시키고, 영상의 특성 정보를 고려하여 전처리를 수행하는 전자 장치, 시스템 및 그 제어 방법을 제공함에 있다."}
{"patent_id": "10-2019-0157745", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "이상과 같은 목적을 달성하기 위한 본 개시의 일 실시 예에 따른 전자 장치에 있어서, 적어도 하나의 인스트럭 션(instruction)을 포함하는 메모리 및 상기 메모리와 연결되어 상기 전자 장치를 제어하며, 영상을 업스케일링 하도록 학습된 인공 지능 모델을 이용하여 입력 영상을 업스케일링하여 출력 영상을 획득하는 프로세서를 포함 하며, 상기 프로세서는, 상기 입력 영상에 수행된 전처리(pre-processing) 관련 정보에 기초하여 상기 인공 지 능 모델의 파라미터 정보를 획득하고, 상기 획득된 파라미터 정보에 대응되는 상기 인공 지능 모델을 이용하여 상기 입력 영상을 업스케일링한다. 또한, 상기 메모리는, 상이한 전처리 각각에 대응되는 전처리 관련 정보에 맵핑된 파라미터 정보를 저장하며, 상기 프로세서는, 상기 저장된 파라미터 정보 중 상기 입력 영상과 함께 수신된 전처리 관련 정보에 대응되는 파라미터 정보를 식별하고, 상기 식별된 파라미터 정보에 대응되는 상기 인공 지능 모델을 이용하여 상기 입력 영상을 업스케일링할 수 있다. 여기서, 상기 메모리에 저장된 파라미터 정보는, 상기 상이한 전처리 각각에 적용되는 필터 관련 정보를 포함하 며, 상기 프로세서는, 상기 저장된 파라미터 정보 중 상기 입력 영상과 함께 수신된 필터 관련 정보에 대응되는 파라미터 정보를 식별하고, 상기 식별된 파라미터 정보에 대응되는 상기 인공 지능 모델을 이용하여 상기 입력 영상을 업스케일링할 수 있다. 여기서, 상기 상이한 전처리 각각에 적용되는 필터 관련 정보는, 상기 상이한 전처리 각각에 적용되는 필터의 타입 또는 강도 중 적어도 하나에 대한 정보를 포함할 수 있다. 여기서, 상기 상이한 전처리 각각에 적용되는 필터 관련 정보는, 상기 필터가 적용되기 전 영상 및 상기 필터가 적용된 후 영상 간 차이에 대한 정보를 더 포함할 수 있다. 또한, 상기 프로세서는, 상기 입력 영상을 디코딩하고 상기 디코딩된 영상을 상기 인공 지능 모델을 이용하여 업스케일링할 수 있다. 또한, 상기 인공 지능 모델은, 복수의 신경망 레이어를 포함하며, 상기 프로세서는, 상기 획득된 파라미터 정보 에 기초하여 상기 복수의 신경망 레이어 각각에 대응되는 파라미터를 설정할 수 있다. 한편, 본 개시의 일 실시 예에 따른 송신 장치 및 수신 장치를 포함하는 시스템에 있어서, 영상을 다운스케일링 (downscaling)하도록 학습된 제1 인공 지능 모델을 이용하여 입력 영상을 다운스케일링하고, 상기 다운스케일링 된 영상을 전처리하여 전송하는 송신 장치 및 영상을 업스케일링(upscaling)하도록 학습된 제2 인공 지능 모델 을 이용하여 상기 송신 장치로부터 수신된 영상을 업스케일링하여 출력 영상을 획득하는 수신 장치를 포함하며, 상기 송신 장치는, 상기 제1 인공 지능 모델로부터 획득된 영상의 특성 정보에 기초하여 상기 다운스케일링된 영상을 전처리하고 상기 전처리 관련 정보를 상기 수신 장치로 전송하며, 상기 수신 장치는, 상기 송신 장치로 부터 수신된 상기 전처리 관련 정보에 기초하여 상기 제2 인공 지능 모델의 파라미터 정보를 획득하고, 상기 획 득된 파라미터 정보에 대응되는 상기 제2 인공 지능 모델을 이용하여 상기 송신 장치로부터 수신된 영상을 업스 케일링할 수 있다. 또한, 상기 송신 장치는, 통신 인터페이스를 더 포함하며, 상기 통신 인터페이스가 연결된 네트워크의 상태 정 보를 획득하고, 상기 네트워크의 상태 정보 및 상기 제1 인공 지능 모델로부터 획득된 영상의 특성 정보에 기초 하여 상기 다운스케일링된 영상을 전처리할 수 있다. 또한, 상기 전처리 관련 정보는, 상기 다운스케일링된 영상의 전처리에 적용된 필터의 타입 또는 강도 중 적어 도 하나에 대한 정보를 포함할 수 있다. 여기서, 상기 전처리 관련 정보는, 상기 필터가 적용되기 전 영상 및 상기 필터가 적용된 후 영상 간 차이에 대 한 정보를 더 포함할 수 있다. 또한, 상기 송신 장치는, 상기 전처리된 영상을 인코딩하여 상기 수신 장치로 전송하며, 상기 수신 장치는, 상 기 송신 장치로부터 수신된 영상을 디코딩하고 상기 제2 인공 지능 모델을 이용하여 상기 디코딩된 영상을 업스 케일링하여 상기 출력 영상을 획득할 수 있다. 또한, 상기 송신 장치는, 상기 제1 인공 지능 모델로부터 획득된 영상의 특성 정보를 이용하여 상기 영상의 전 처리 관련 정보를 획득하도록 학습된 제3 인공 지능 모델을 더 포함하며, 상기 프로세서는, 상기 제3 인공 지능 모델을 이용하여 상기 다운스케일링된 영상의 상기 전처리 관련 정보를 획득할 수 있다. 한편, 본 개시의 일 실시 예에 따른 전자 장치의 제어 방법에 있어서, 입력 영상에 수행된 전처리(pre- processing) 관련 정보에 기초하여 영상을 업스케일링하도록 학습된 인공 지능 모델의 파라미터 정보를 획득하 는 단계 및 상기 획득된 파라미터 정보에 대응되는 상기 인공 지능 모델을 이용하여 상기 입력 영상을 업스케일 링하여 출력 영상을 획득하는 단계를 포함한다. 또한, 상기 파라미터 정보를 획득하는 단계는, 상이한 전처리 각각에 대응되는 전처리 관련 정보에 맵핑된 파라 미터 정보를 저장하는 메모리에서 상기 입력 영상과 함께 수신된 전처리 관련 정보에 대응되는 파라미터 정보를 식별하는 단계를 포함하고, 상기 출력 영상을 획득하는 단계는, 상기 식별된 파라미터 정보에 대응되는 상기 인 공 지능 모델을 이용하여 상기 입력 영상을 업스케일링하는 단계를 포함할 수 있다. 여기서, 상기 메모리에 저장된 파라미터 정보는, 상기 상이한 전처리 각각에 적용되는 필터 관련 정보를 포함하 며, 상기 파라미터 정보를 획득하는 단계는, 상기 저장된 파라미터 정보 중 상기 입력 영상과 함께 수신된 필터 관련 정보에 대응되는 파라미터 정보를 식별하는 단계를 포함하고, 상기 출력 영상을 획득하는 단계는, 상기 식 별된 파라미터 정보에 대응되는 상기 인공 지능 모델을 이용하여 상기 입력 영상을 업스케일링하는 단계를 포함 할 수 있다. 여기서, 상기 상이한 전처리 각각에 적용되는 필터 관련 정보는, 상기 상이한 전처리 각각에 적용되는 필터의 타입 또는 강도 중 적어도 하나에 대한 정보를 포함할 수 있다. 여기서, 상기 상이한 전처리 각각에 적용되는 필터 관련 정보는, 상기 필터가 적용되기 전 영상 및 상기 필터가 적용된 후 영상 간 차이에 대한 정보를 더 포함할 수 있다. 또한, 상기 출력 영상을 획득하는 단계는, 상기 입력 영상을 디코딩하고 상기 디코딩된 영상을 상기 인공 지능 모델을 이용하여 업스케일링하는 단계를 포함할 수 있다. 또한, 상기 인공 지능 모델은, 복수의 신경망 레이어를 포함하며, 상기 획득된 파라미터 정보에 기초하여 상기 복수의 신경망 레이어 각각에 대응되는 파라미터를 설정하는 단계를 포함할 수 있다."}
{"patent_id": "10-2019-0157745", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "상술한 바와 같이 본 개시의 다양한 실시 예에 따르면, 업스케일링된 영상은 전처리 과정에서 손실된 디테일을 포함할 수 있다. 또한, 데이터 전송량 및 연산량을 절감시키면서도 원본 영상에 포함된 디테일의 복원이 가능할 수 있다. 또한, 실시간 스트리밍 환경에서도 전처리 필터를 적응적으로 이용하여 네트워크 망 상태에 적절한 전처리를 수 행할 수 있다. 또한, 부호화 성능을 향상시키면서도 전처리에 따라 손실되는 디테일을 용이하게 복원시킬 수 있다."}
{"patent_id": "10-2019-0157745", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하에서는 첨부 도면을 참조하여 본 개시를 상세히 설명한다. 본 개시의 실시 예에서 사용되는 용어는 본 개시에서의 기능을 고려하면서 가능한 현재 널리 사용되는 일반적인 용어들을 선택하였으나, 이는 당 분야에 종사하는 기술자의 의도 또는 판례, 새로운 기술의 출현 등에 따라 달 라질 수 있다. 또한, 특정한 경우는 출원인이 임의로 선정한 용어도 있으며, 이 경우 해당되는 개시의 설명 부 분에서 상세히 그 의미를 기재할 것이다. 따라서 본 개시에서 사용되는 용어는 단순한 용어의 명칭이 아닌, 그 용어가 가지는 의미와 본 개시의 전반에 걸친 내용을 토대로 정의되어야 한다. 본 개시에서, \"가진다,\" \"가질 수 있다,\" \"포함한다,\" 또는 \"포함할 수 있다\" 등의 표현은 해당 특징(예: 수치, 기능, 동작, 또는 부품 등의 구성요소)의 존재를 가리키며, 추가적인 특징의 존재를 배제하지 않는다. A 또는/및 B 중 적어도 하나라는 표현은 \"A\" 또는 \"B\" 또는 \"A 및 B\" 중 어느 하나를 나타내는 것으로 이해되어 야 한다. 본 개시에서 사용된 \"제1,\" \"제2,\" \"첫째,\" 또는 \"둘째,\"등의 표현들은 다양한 구성요소들을, 순서 및/또는 중 요도에 상관없이 수식할 수 있고, 한 구성요소를 다른 구성요소와 구분하기 위해 사용될 뿐 해당 구성요소들을 한정하지 않는다. 어떤 구성요소(예: 제1 구성요소)가 다른 구성요소(예: 제2 구성요소)에 \"(기능적으로 또는 통신적으로) 연결되 어((operatively or communicatively) coupled with/to)\" 있다거나 \"접속되어(connected to)\" 있다고 언급된 때에는, 어떤 구성요소가 다른 구성요소에 직접적으로 연결되거나, 다른 구성요소(예: 제3 구성요소)를 통하여 연결될 수 있다고 이해되어야 할 것이다. 단수의 표현은 문맥상 명백하게 다르게 뜻하지 않는 한, 복수의 표현을 포함한다. 본 출원에서, \"포함하다\" 또 는 \"구성되다\" 등의 용어는 명세서상에 기재된 특징, 숫자, 단계, 동작, 구성요소, 부품 또는 이들을 조합한 것 이 존재함을 지정하려는 것이지, 하나 또는 그 이상의 다른 특징들이나 숫자, 단계, 동작, 구성요소, 부품 또는 이들을 조합한 것들의 존재 또는 부가 가능성을 미리 배제하지 않는 것으로 이해되어야 한다. 본 개시에서 \"모듈\" 혹은 \"부\"는 적어도 하나의 기능이나 동작을 수행하며, 하드웨어 또는 소프트웨어로 구현되 거나 하드웨어와 소프트웨어의 결합으로 구현될 수 있다. 또한, 복수의 \"모듈\" 혹은 복수의 \"부\"는 특정한 하드 웨어로 구현될 필요가 있는 \"모듈\" 혹은 \"부\"를 제외하고는 적어도 하나의 모듈로 일체화되어 적어도 하나의 프 로세서(미도시)로 구현될 수 있다. 또한, 본 개시에서, '영상(image)' 또는 '픽처'는 정지영상, 복수의 연속된 정지영상(또는 프레임)으로 구성된 동영상, 또는 비디오를 나타낼 수 있다. 또한, 본 개시에서 'DNN(deep neural network)'은 뇌 신경을 모사한 인공신경망 모델의 대표적인 예시로써, 특 정 알고리즘을 사용한 인공신경망 모델로 한정되지 않는다. 또한, 본 개시에서 '파라미터'는 뉴럴 네트워크를 이루는 각 레이어의 연산 과정에서 이용되는 값으로서 예를 들어, 입력 값을 소정 연산식에 적용할 때 이용되는 가중치를 포함할 수 있다. 또한, 파라미터는 매트릭스 형태 로 표현될 수 있다. 파라미터는 훈련의 결과로 설정되는 값으로서, 필요에 따라 별도의 훈련 데이터(training data)를 통해 갱신될 수 있다. 또한, 본 개시에서 '제 1 DNN'은 영상의 AI 다운스케일을 위해 이용되는 DNN을 의미하고, '제 2 DNN'은 영상의 AI 업스케일을 위해 이용되는 DNN을 의미한다. 또한, 본 개시에서 'DNN 설정 정보'는 DNN을 구성하는 요소와 관련된 정보로서 전술한 파라미터를 포함한다. DNN 설정 정보를 이용하여 제 1 DNN 또는 제 2 DNN이 설정될 수 있다. 또한, 본 개시에서 제1 인공 지능 모델은 영상의 업스케일링을 위해 이용되는 인공 지능 모델을 의미하고, 제2 인공 지능 모델은 영상의 다운스케일링을 위해 이용되는 인공 지능 모델의 의미한다. 또한, 본 개시에서 '원본 영상'은 AI 부호화의 대상이 되는 영상 또는 송신 장치가 수신한 영상을 의미하고, ' 제 1 영상' 또는 ‘다운스케일링된 영상’은 AI 부호화 과정에서 원본 영상의 AI 다운스케일 결과 획득된 영상 을 의미한다. 또한, '제 2 영상' 또는 ‘디코딩된 영상’은 AI 복호화 과정에서 제 1 복호화를 통해 획득된 영 상을 의미하고, '제 3 영상' 또는 ‘업스케일링된 영상’은 AI 복호화 과정에서 제 2 영상을 AI 업스케일하여 획득된 영상을 의미한다. 또한, 본 개시에서 'AI 다운스케일' 또는 ‘다운스케일링’은 AI 기반으로 영상의 해상도를 감소시키는 처리를 의미하고, '제 1 부호화'는 주파수 변환 기반의 영상 압축 방법에 의한 부호화 처리를 의미한다. 또한, '제 1 복호화'는 주파수 변환 기반의 영상 복원 방법에 의한 복호화 처리를 의미하고, 'AI 업스케일' 또는 ‘업스케일 링’은 AI 기반으로 영상의 해상도를 증가시키는 처리를 의미한다. 본 개시에서, 사용자라는 용어는 전자 장치를 사용하는 사람 또는 전자 장치를 사용하는 장치(예: 인공지능 전 자 장치)를 지칭할 수 있다. 이하 첨부된 도면들을 참조하여 본 개시의 일 실시 예를 보다 상세하게 설명한다. 도 1은 본 개시의 일 실시 예에 따른 시스템의 구성을 나타내는 블록도이다. 도 1에 도시된 바에 따르면, 본 발명의 일 실시 예에 따른 시스템은 수신 장치 및 송신 장치를 포함한다. 일 실시 예에 따른 시스템은 영상 스트리밍 시스템으로, 실시간 영상을 전송하는 송신 장치 및 해당 영상을 수신하여 디스플레이하는 수신 장치로 구현될 수 있다. 이는 일 실시 예로 이에 한정되지 않음은 물론이다. 본 개시의 일 실시 예에 따른 송신 장치는 서버로 구현되어 복수의 전자 장치로 영상을 전송할 수 있다. 본 개시의 다양한 실시 예에 따른, 송신 장치는, 예를 들면, 스마트폰, 태블릿 PC, 이동 전화기, 영상 전 화기, 전자책 리더기, 데스크탑 PC, 랩탑 PC, 넷북 컴퓨터, 워크스테이션, 서버, PDA, PMP(portable multimedia player), MP3 플레이어, 의료기기, 카메라, 가상 현실(virtual reality(VR)) 구현 장치 또는 웨어 러블 장치 중 적어도 하나를 포함할 수 있다. 웨어러블 장치는 액세서리형(예: 시계, 반지, 팔찌, 발찌,목걸이, 안경, 콘택트 렌즈, 또는 머리 착용형 장치(head-mounted-device(HMD)), 직물 또는 의류 일체형(예: 전 자 의복), 신체 부착형(예: 스킨 패드 또는 문신), 또는 생체 이식형 회로 중 적어도 하나를 포함할 수 있다. 어떤 실시예들에서, 전자 장치는, 예를 들면, 텔레비전, DVD(digital video disk) 플레이어, 오디오, 냉장고, 에어컨, 청소기, 오븐, 전자레인지, 세탁기, 공기 청정기, 셋톱 박스, 홈 오토매이션 컨트롤 패널, 보안 컨트롤 패널, 미디어 박스(예: 삼성 HomeSyncTM, 애플TVTM, 또는 구글 TVTM), 게임 콘솔(예: XboxTM, PlayStationTM), 전자 사전, 전자 키, 캠코더, 또는 전자 액자 중 적어도 하나를 포함할 수 있다. 다른 실시예에서, 전자 장치는, 각종 의료기기(예: 각종 휴대용 의료측정기기(혈당 측정기, 심박 측정기, 혈압 측정기, 또는 체온 측정기 등), MRA(magnetic resonance angiography), MRI(magnetic resonance imaging), CT(computed tomography), 촬영기, 또는 초음파기 등), 네비게이션 장치, 위성 항법 시스템(GNSS(global navigation satellite system)), EDR(event data recorder), FDR(flight data recorder), 자동차 인포테인먼 트 장치, 선박용 전자 장비(예: 선박용 항법 장치, 자이로 콤파스 등), 항공 전자기기(avionics), 보안 기기, 차량용 헤드 유닛(head unit), 산업용 또는 가정용 로봇, 드론(drone), 금융 기관의 ATM, 상점의 POS(point of sales), 또는 사물 인터넷 장치 (예: 전구, 각종 센서, 스프링클러 장치, 화재 경보기, 온도조절기, 가로등, 토 스터, 운동기구, 온수탱크, 히터, 보일러 등) 중 적어도 하나를 포함할 수 있다. 본 개시의 일 실시 예에 따른 수신 장치는 영상을 디스플레이할 수 있다. 수신 장치는 TV로 구현될 수 있으나, 이에 한정되는 것은 아니며 비디오 월(video wall), LFD(large format display), Digital Signage (디지털 간판), DID(Digital Information Display), 프로젝터 디스플레이 등과 같이 디스플레이 기능을 갖춘 장치라면 한정되지 않고 적용 가능하다. 또한, 수신 장치는 LCD(liquid crystal display), OLED(organic light-emitting diode), LCoS(Liquid Crystal on Silicon), DLP(Digital Light Processing), QD(quantum dot) 디스플레이 패널, QLED(quantum dot light-emitting diodes) μLED(Micro light-emitting diodes), Mini LED 등과 같은 다양한 형태의 디스플레이로 구현될 수 있다. 한편, 수신 장치는 터치 센서와 결합된 터치 스크 린, 플렉시블 디스플레이(flexible display), 롤러블 디스플레이(rollable display), 3차원 디스플레이(3D display), 복수의 디스플레이 모듈이 물리적으로 연결된 디스플레이 등으로 구현될 수도 있다. 본 개시의 일 실시 예에 따른 수신 장치는 송신 장치로부터 수신된 영상을 처리하여 디스플레이할 수 있다. 다른 예로, 수신 장치는 디스플레이 기능을 갖추지 않은 다양한 유형의 전자 장치로 구현될 수도 있음은 물론이다. 본 개시의 다양한 실시 예에 따른, 수신 장치는, 예를 들면, 스마트폰, 태블릿 PC, 이동 전화기, 영상 전 화기, 전자책 리더기, 데스크탑 PC, 랩탑 PC, 넷북 컴퓨터, 워크스테이션, 서버, PDA, PMP(portable multimedia player), MP3 플레이어, 의료기기, 카메라, 가상 현실(virtual reality(VR)) 구현 장치 또는 웨어 러블 장치 중 적어도 하나를 포함할 수 있다. 웨어러블 장치는 액세서리형(예: 시계, 반지, 팔찌, 발찌, 목걸이, 안경, 콘택트 렌즈, 또는 머리 착용형 장치(head-mounted-device(HMD)), 직물 또는 의류 일체형(예: 전 자 의복), 신체 부착형(예: 스킨 패드 또는 문신), 또는 생체 이식형 회로 중 적어도 하나를 포함할 수 있다. 어떤 실시예들에서, 전자 장치는, 예를 들면, 텔레비전, DVD(digital video disk) 플레이어, 오디오, 냉장고, 에어컨, 청소기, 오븐, 전자레인지, 세탁기, 공기 청정기, 셋톱 박스, 홈 오토매이션 컨트롤 패널, 보안 컨트롤 패널, 미디어 박스(예: 삼성 HomeSyncTM, 애플TVTM, 또는 구글 TVTM), 게임 콘솔(예: XboxTM, PlayStationTM), 전자 사전, 전자 키, 캠코더, 또는 전자 액자 중 적어도 하나를 포함할 수 있다. 다른 실시예에서, 전자 장치는, 각종 의료기기(예: 각종 휴대용 의료측정기기(혈당 측정기, 심박 측정기, 혈압 측정기, 또는 체온 측정기 등), MRA(magnetic resonance angiography), MRI(magnetic resonance imaging), CT(computed tomography), 촬영기, 또는 초음파기 등), 네비게이션 장치, 위성 항법 시스템(GNSS(global navigation satellite system)), EDR(event data recorder), FDR(flight data recorder), 자동차 인포테인먼 트 장치, 선박용 전자 장비(예: 선박용 항법 장치, 자이로 콤파스 등), 항공 전자기기(avionics), 보안 기기, 차량용 헤드 유닛(head unit), 산업용 또는 가정용 로봇, 드론(drone), 금융 기관의 ATM, 상점의 POS(point of sales), 또는 사물 인터넷 장치 (예: 전구, 각종 센서, 스프링클러 장치, 화재 경보기, 온도조절기, 가로등, 토 스터, 운동기구, 온수탱크, 히터, 보일러 등) 중 적어도 하나를 포함할 수 있다. 예를 들어, 수신 장치는 셋톱 박스로 구현되어 외부 전자 장치로부터 영상을 수신하고, 수신된 영상을 처 리하여 디스플레이 기능을 갖춘 외부 디스플레이 장치로 전송할 수도 있음은 물론이다. 또는 수신 장치는 클라우딩 컴퓨팅 환경이 구축된 시스템 자체일 수도 있다. 이에 한정되는 것은 아니며, 인공 지능 모델을 이용하여 데이터를 처리하는 장치라면 한정되지 않고 적용 가능하다. 도 2는 본 개시의 일 실시 예에 따른 시스템의 동작을 설명하기 위한 도면이다. 도 2를 참조하면, 송신 장치는 영상을 전처리하여 수신 장치로 전송할 수 있다. 일 예로, 송신 장치는 영상의 인코딩하여 수신 장치로 전송할 수 있다. 여기서, 송신 장치는 영 상에 대한 압축 부호화 성능을 향상시키기 위해 영상에 전처리(pre-processing)를 수행하고, 전처리된 영상을 인코딩하여 인코딩된 영상을 획득할 수 있다. 이어서, 송신 장치는 인코딩된 영상을 수신 장치로 전 송할 수 있다. 예를 들어, 압축 부호화 성능을 저하시키는 요소 중 큰 부분을 차지하는 랜덤 노이즈(Random noise)를 제거하기 위해 송신 장치는 영상에 Bilateral Filter를 적용하는 전처리 과정을 수행할 수 있다. 송신 장치는 전처리된 영상 예를 들어, Bilateral Filter의 적용에 따라 Edge 성분은 유지되고 Noise 성분은 제거된 영상을 인코딩하여 수신 장치로 전송할 수 있다. 종래에 송신 장치의 인코딩 과정에서 전처리된 영상(예를 들어, Bilateral Filter가 적용된 영상)에 대한 부호화 효율이 고효율인 장점은 있으나, 전처리 과정에서 제거된 영상의 텍스처(texture), 세밀감, 디테일 등은 수신 장치의 디코딩 과정에서 복원이 불가한 문제가 있었다. 이하에서는, 수신 장치가 획득한 복원 영상이 원본 영상의 텍스처(texture), 세밀감, 디테일 등을 포함하도록 디코딩을 수행하는 다양한 실시 예에 대 해 설명하도록 한다. 도 2를 참조하면, 송신 장치는 인코딩된 영상을 수신 장치로 전송할 수 있다. 영상의 해상도가 급격히 커짐에 따라 인코딩/디코딩을 위한 정보 처리량이 많아지게 되고, 이에 따라 영상의 인 코딩 및 디코딩 효율을 향상시키기 위한 방안이 요구되었다. 본 개시의 일 실시 예에 따른 송신 장치는 영상을 다운스케일링(downscaling)하도록 학습된 제2 인공 지능 모델을 이용하여 고 해상도의 영상(예를 들어, 원본 영상)을 다운스케일링할 수 있다. 여기서, 고 해상도의 영상은 UHD(Ultra High Definition) 영상(예를 들어, 8K(8192*4320) UHD 영상)을 의미할 수 있다. 예를 들어, 송신 장치는 제2 인공 지능 모델을 이용하여 입력 영상의 해상도를 8K 해상도에서 4K 해상도로 다운스 케일링할 수 있다. 송신 장치는 입력 영상의 해상도를 다운스케일링하여 저 해상도의 영상을 획득하며, 저 해상도의 다운스케일링된 영상을 인코딩하므로 고 해상도의 입력 영상을 대상으로 하여 인코딩을 수행하는 경우 에 비해 연산량, 처리량을 크게 감소시킬 수 있다. 한편, 영상을 다운스케일링하도록 학습된 제2 인공 지능 모델은 AI 인코더, AI 다운스케일러(downscaler) 등 으로 불릴 수 있으나, 이하에서는 설명의 편의를 위해 제2 인공 지능 모델로 통칭하도록 한다. 일 실시 예에 따른 송신 장치는 다운스케일링된 영상을 전처리하여 수신 장치로 전송할 수 있다. 여 기서, 송신 장치는 제2 인공 지능 모델로부터 획득된 영상의 특성 정보에 기초하여 다운스케일링된 영 상을 전처리하고, 전처리 관련 정보를 수신 장치로 전송할 수 있다. 일 예로, 송신 장치는 제2 인공 지능 모델로부터 획득된 영상의 특성 정보에 기초하여 전처리 관련 정 보를 획득하고, 획득된 전처리 관련 정보에 기초하여 다운스케일링된 영상을 전처리할 수 있다. 예를 들어, 전처리 관련 정보는 필터(Filter)의 타입 또는 강도 중 적어도 하나에 대한 정보를 포함할 수 있다. 일 실시 예에 따른 송신 장치는 전처리 관련 정보에 포함된 필터의 타입 또는 강도에 대한 정보에 기초하 여 다운스케일링된 영상을 필터링할 수 있다. 이에 대한 구체적인 설명은 도 7 및 도 8을 참조하여 후술하도록 한다. 이어서, 본 개시의 일 실시 예에 따른 송신 장치는 전처리된 영상을 인코딩할 수 있다. 인코딩 과정은 전 처리된 영상을 예측하여 예측 데이터를 생성하는 과정, 전처리된 영상과 예측 데이터 사이의 차이에 해당하는 잔차 데이터를 생성하는 과정, 공간 영역 성분인 잔차 데이터를 주파수 영역 성분으로 변환(transformation)하 는 과정, 주파수 영역 성분으로 변환된 잔차 데이터를 양자화(quantization)하는 과정 및 양자화된 잔차 데이터 를 엔트로피 부호화하는 과정 등을 포함할 수 있다. 이와 같은 인코딩 과정은 MPEG-2, H.264 AVC(Advanced Video Coding), MPEG-4, HEVC(High Efficiency Video Coding), VC-1, VP8, VP9 및 AV1(AOMedia Video 1) 등 주파수 변환을 이용한 영상 압축 방법 중의 하나를 통해 구현될 수 있다. 이어서, 송신 장치는 인코딩된 영상, 전처리 관련 정보를 수신 장치로 전송할 수 있다. 예를 들어, 송신 장치는 인코딩된 영상, 전처리 관련 정보를 포함하는 영상 데이터를 비트스트림 형태로 수신 장치 로 전송할 수 있다. 한편, 영상 데이터는 송신 장치의 인코딩 과정에서 이용된 양자화 파라미터(Quantization parameter, QP) 관련 정보 등을 포함할 수도 있음은 물론이다. 일 실시 예에 따른 영상 데이터는 MPEG-2, H.264 AVC, MPEG-4, HEVC, VC-1, VP8, VP9 및 AV1 등 주파수 변환을 이용하는 영상 압축 방법 중 인코딩 과정에서 이용된 영상 압축 방법의 규칙, 예를 들어, 신택스(syntax)에 따라 생성될 수 있다. 일 실시 예에 따라, 전처리 관련 정보는 메타 (meta) 데이터, 메타 정보 등으로 불릴 수도 있으나, 이하에서는 설명의 편의를 위해 전처리 관련 정보로 통칭 하도록 한다. 본 개시의 일 실시 예에 따른 수신 장치는 다양한 해상도의 영상, 다양한 압축 영상을 수신할 수 있다. 예 를 들어, 수신 장치는 SD(Standard Definition), HD(High Definition), FHD, UHD 영상, UHD 이상의 해상 도 영상 중 적어도 하나의 영상을 수신할 수 있다. 또한, 수신 장치는 MPEG(Moving Picture Experts Group)(예를 들어, MP2, MP4, MP7 등), JPEG(joint photographic coding experts group), AVC(Advanced Video Coding), H.264, H.265, HEVC(High Efficiency Video Codec), VC-1, VP8, VP9 및 AV1(AOMedia Video 1) 등으 로 압축된 형태로 영상을 수신할 수 있다. 특히, 수신 장치는 영상을 업스케일링(upscaling)하도록 학습된 제1 인공 지능 모델을 이용하여 송신 장치로부터 수신된 영상을 업스케일링하여 출력 영상을 획득할 수 있다. 일 예로, 수신 장치는 송신 장치에서 다운스케일링된 영상을 업스케일링하여 고 해상도의 영상을 획득할 수 있다. 한편, 영상을 업스케일링하도록 학습된 제1 인공 지능 모델은 AI 디코더, AI 업스케일러(upscaler)등으로 불 릴 수 있으나, 이하에서는 설명의 편의를 위해 제1 인공 지능 모델로 통칭하도록 한다. 한편, 인공 지능 모델이 학습된다는 것은, 기본 인공 지능 모델(예를 들어 임의의 랜덤한 파라미터를 포함하는 인공 지능 모델)이 학습 알고리즘에 의하여 다수의 훈련 데이터들을 이용하여 학습됨으로써, 원하는 특성(또는, 목적)을 수행하도록 설정된 기 정의된 동작 규칙 또는 인공 지능 모델이 만들어짐을 의미한다. 이러한 학습은 별도의 서버 및/또는 시스템을 통해 이루어질 수 있으나, 이에 한정되는 것은 아니며 전자 장치에서 이루어질 수도 있다. 학습 알고리즘의 예로는, 지도형 학습(supervised learning), 비지도형 학습(unsupervised learning), 준지도형 학습(semi-supervised learning) 또는 강화 학습(reinforcement learning)이 있으나, 전 술한 예에 한정되지 않는다. 여기서, 제1 및 제2 인공 지능 모델(1, 2) 각각은, 예를 들어, CNN (Convolutional Neural Network), RNN (Recurrent Neural Network), RBM (Restricted Boltzmann Machine), DBN (Deep Belief Network), BRDNN(Bidirectional Recurrent Deep Neural Network) 또는 심층 Q-네트워크 (Deep Q-Networks) 등으로 구현될 수 있으나, 이에 한정되지 않는다. 도 2를 참조하면, 본 개시의 일 실시 예에 따른 수신 장치는 인코딩된 영상을 디코딩할 수 있다. 일 실시 예에 따라 수신 장치는 인코딩된 영상을 디코딩하여 전처리된 영상 즉, 인코딩 전 영상을 획득할 수 있다. 여기서, 디코딩은 영상 데이터를 엔트로피 복호화하여 양자화된 잔차 데이터를 생성하는 과정, 양자화된 잔차 데이터를 역양자화하는 과정, 주파수 영역 성분의 잔차 데이터를 공간 영역 성분으로 변환하는 과정, 예측 데이 터를 생성하는 과정 및 예측 데이터와 잔차 데이터를 이용하여 인코딩된 영상을 복원하는 과정 등을 포함할 수 있다. 이와 같은 디코딩 과정은 인코딩 과정에서 사용된 MPEG-2, H.264, MPEG-4, HEVC, VC-1, VP8, VP9 및 AV1 등 주파수 변환을 이용한 영상 압축 방법 중의 하나에 대응되는 영상 복원 방법을 통해 구현될 수 있다. 이어서, 본 개시의 일 실시 예에 따른 수신 장치는 송신 장치로부터 수신된 전처리 관련 정보에 기초 하여 제1 인공 지능 모델의 파라미터 정보를 획득할 수 있다. 여기서, 파라미터 정보는 제1 인공 지능 모델 을 획득, 설정 또는 모델링하기 위한 파라미터의 집합을 의미할 수 있다. 여기서, 파라미터는 가중치 (weight), 계수 등으로 지칭될 수도 있다. 이어서, 일 실시 예에 따른 수신 장치는 파라미터 정보에 대응되는 제1 인공 지능 모델을 이용하여 송 신 장치로부터 수신된 영상을 업스케일링하여 출력 영상을 획득할 수 있다. 출력 영상은 업스케일링된 영 상, 입력 영상에 대응되는 복원 영상 등으로 지칭될 수도 있다. 여기서, 입력 영상은 송신 장치에 최초 입 력된 영상을 의미할 수 있다. 이하에서는 수신 장치가 파라미터 정보에 대응되는 제1 인공 지능 모델을 이용하여 송신 장치로부 터 수신된 영상을 업스케일링하는 다양한 실시 예에 대해 설명하도록 한다. 도 3은 본 개시의 일 실시 예에 따른 수신 장치의 구성을 나타내는 블록도이다. 도 3을 참조하면, 본 개시의 일 실시 예에 따른 수신 장치는 메모리 및 프로세서를 포함한다. 메모리는 본 개시의 다양한 실시 예를 위해 필요한 데이터를 저장할 수 있다. 메모리는 데이터 저장 용도에 따라 수신 장치에 임베디드된 메모리 형태로 구현되거나, 수신 장치에 탈부착이 가능한 메모 리 형태로 구현될 수도 있다. 예를 들어, 수신 장치의 구동을 위한 데이터의 경우 수신 장치에 임베 디드된 메모리에 저장되고, 수신 장치의 확장 기능을 위한 데이터의 경우 수신 장치에 탈부착이 가능 한 메모리에 저장될 수 있다. 한편, 수신 장치에 임베디드된 메모리의 경우 휘발성 메모리(예: DRAM(dynamic RAM), SRAM(static RAM), 또는 SDRAM(synchronous dynamic RAM) 등), 비휘발성 메모리(non- volatile Memory)(예: OTPROM(one time programmable ROM), PROM(programmable ROM), EPROM(erasable and programmable ROM), EEPROM(electrically erasable and programmable ROM), mask ROM, flash ROM, 플래시 메 모리(예: NAND flash 또는 NOR flash 등), 하드 드라이브, 또는 솔리드 스테이트 드라이브(solid state drive(SSD)) 중 적어도 하나로 구현될 수 있다. 또한, 수신 장치에 탈부착이 가능한 메모리의 경우 메모리 카드(예를 들어, CF(compact flash), SD(secure digital), Micro-SD(micro secure digital), Mini-SD(mini secure digital), xD(extreme digital), MMC(multi-media card) 등), USB 포트에 연결가능한 외부 메모리(예를 들어, USB 메모리) 등과 같은 형태로 구현될 수 있다. 일 예에 따라 메모리는 수신 장치를 제어하기 위한 적어도 하나의 인스트럭션(instruction) 또는 인 스트럭션들을 포함하는 컴퓨터 프로그램을 저장할 수 있다. 다른 예에 따라, 메모리는 복수의 레이어를 포함하는 인공 지능 모델에 관한 정보를 저장할 수 있다. 여기 서, 인공 지능 모델에 관한 정보를 저장한다는 것은 인공 지능 모델의 동작과 관련된 다양한 정보, 예를 들어 인공 지능 모델에 포함된 복수의 레이어에 대한 정보, 복수의 레이어 각각에서 이용되는 파라미터(예를 들어, 필터 계수, 바이어스 등)에 대한 정보 등을 저장한다는 것을 의미할 수 있다. 예를 들어, 메모리는 본 개 시의 일 실시 예에 따라 영상의 업스케일링 처리를 하도록 학습된 제1 인공 지능 모델에 대한 정보를 저장할 수 있다. 여기서, 업스케일링 처리는 예를 들어, 초해상도(super resolution) 처리를 포함할 수 있다. 다만, 프 로세서가 전용 하드웨어로 구현되는 경우, 인공 지능 모델에 관한 정보는 프로세서 내부 메모리에 저 장될 수도 있다. 또 다른 예에 따라, 메모리는 외부 장치(예를 들어, 소스 장치), 외부 저장 매체(예를 들어, USB), 외부 서버(예를 들어 웹 하드) 등으로부터 수신된 영상을 저장할 수 있다. 여기서, 영상은 디지털 동영상이 될 수 있 으나 이에 한정되는 것은 아니다. 또 다른 예에 따라, 메모리는 화질 처리에 필요한 다양한 정보, 예를 들어 Noise Reduction, Detail Enhancement, Tone Mapping, Contrast Enhancement, Color Enhancement 또는 Frame rate Conversion 중 적어 도 하나를 수행하기 위한 정보, 알고리즘, 화질 파라미터 등을 저장할 수 있다. 또한, 메모리는 영상 처리 에 의해 생성된 최종 출력 영상을 저장할 수도 있다. 본 개시의 일 실시 예에 따르면, 메모리는 본 개시에 따른 다양한 동작들에서 생성되는 데이터를 저장하는 단일 메모리로 구현될 수 있다. 다만, 본 개시의 다른 실시 예에 따르면, 메모리는 상이한 타입의 데이터 를 각각 저장하거나, 상이한 단계에서 생성되는 데이터를 각각 저장하는 복수의 메모리를 포함하도록 구현될 수 도 있다. 상술한 실시 예에서는 다양한 데이터가 프로세서의 외부 메모리에 저장되는 것으로 설명하였으나, 상 술한 데이터 중 적어도 일부는 수신 장치 또는 프로세서 중 적어도 하나의 구현 예에 따라 프로세서 내부 메모리에 저장될 수도 있다. 프로세서는 메모리와 전기적으로 연결되어 수신 장치의 전반적인 동작을 제어한다. 프로세서 는 하나 또는 복수의 프로세서로 구성될 수 있다. 구체적으로, 프로세서는 메모리에 저장된 적 어도 하나의 인스트럭션(instruction)을 실행함으로써, 본 개시의 다양한 실시 예에 따른 수신 장치의 동 작을 수행할 수 있다. 일 실시 예에 따라 프로세서는 디지털 영상 신호를 처리하는 디지털 시그널 프로세서(digital signal processor(DSP), 마이크로 프로세서(microprocessor), GPU(Graphics Processing Unit), AI(ArtificialIntelligence) 프로세서, NPU (Neural Processing Unit), TCON(Time controller)으로 구현될 수 있다. 다만, 이에 한정되는 것은 아니며, 중앙처리장치(central processing unit(CPU)), MCU(Micro Controller Unit), MPU(micro processing unit), 컨트롤러(controller), 어플리케이션 프로세서(application processor(AP)), 또 는 커뮤니케이션 프로세서(communication processor(CP)), ARM 프로세서 중 하나 또는 그 이상을 포함하거나, 해당 용어로 정의될 수 있다. 또한, 프로세서는 프로세싱 알고리즘이 내장된 SoC(System on Chip), LSI(large scale integration)로 구현될 수도 있고, ASIC(application specific integrated circuit), FPGA(Field Programmable gate array) 형태로 구현될 수도 있다. 또한, 본 개시의 일 실시 예에 따른 인공 지능 모델을 실행하기 위한 프로세서는 CPU, AP, DSP(Digital Signal Processor) 등과 같은 범용 프로세서, GPU, VPU(Vision Processing Unit)와 같은 그래픽 전용 프로세서 또는 NPU와 같은 인공 지능 전용 프로세서과 소프트웨어의 조합을 통해 구현될 수 있다. 프로세서는, 메모 리에 저장된 기 정의된 동작 규칙 또는 인공 지능 모델에 따라, 입력 데이터를 처리하도록 제어할 수 있다. 또는, 프로세서가 전용 프로세서(또는 인공 지능 전용 프로세서)인 경우, 특정 인공 지능 모델의 처 리에 특화된 하드웨어 구조로 설계될 수 있다. 예를 들어, 특정 인공 지능 모델의 처리에 특화된 하드웨어는 ASIC, FPGA 등의 하드웨어 칩으로 설계될 수 있다. 프로세서가 전용 프로세서로 구현되는 경우, 본 개시의 실시 예를 구현하기 위한 메모리를 포함하도록 구현되거나, 외부 메모리를 이용하기 위한 메모리 처리 기능을 포함하도록 구현될 수 있다. 프로세서는 입력 데이터를 처리하여 출력 데이터를 획득한다. 여기서, 입력 데이터는 텍스트, 이미지 또는 사용자 음성 중 적어도 하나를 포함할 수 있다. 예를 들어, 입력 데이터는, 외부 장치와 통신 가능한 통신부, 키보드 또는 터치 패드 등과 같은 사용자 입력부, 카메라, 마이크 등을 통해 입력될 수 있다. 출력 데이터는 인 공 지능 모델의 종류에 따라 다양한 형태가 될 수 있다. 예를 들어 출력 데이터는, 해상도가 향상된 이미지, 이 미지 내에 포함된 오브젝트 관련 정보, 음성에 대응되는 텍스트 등이 될 수 있다. 일 예에 따라, 프로세서는 입력 영상을 영상 처리하여 출력 영상을 획득한다. 여기서, 영상은 정지 영상, 복수의 연속된 정지영상(또는 프레임), 또는 비디오를 포함할 수 있다. 영상 처리는 영상 개선(image enhancement), 영상 복원(image restoration), 영상 변환(image transformation), 영상 분석(image analysis), 영상 인식(image understanding) 또는 영상 압축(image compression) 중 적어도 하나를 포함하는 디지털 영상 처리가 될 수 있다. 일 예에 따라 입력 영상이 압축 영상인 경우 프로세서는 압축 영상을 디코딩한 후 영 상 처리할 수 있다. 일 실시 예에 따라, 프로세서는 인공 지능 모델을 이용하여 입력 영상을 영상 처리할 수 있다. 예를 들어, 프로세서는 인공 지능 모델을 이용하기 위하여, 메모리, 예를 들어 DRAM과 같은 외부 메모리에 저장된 인공 지능 모델 관련 정보를 로딩하여 이용할 수 있다. 도 4는 본 개시의 일 실시 예에 따른 수신 장치의 동작을 설명하기 위한 도면이다. 도 4를 참조하면, 본 개시의 일 실시 예에 따른 프로세서는 송신 장치로부터 수신된 입력 영상을 디 코딩할 수 있다(S410). 여기서, 입력 영상은 도 4에서 인코딩된 영상으로 도시되어 있으나 설명의 편의를 위해 입력 영상으로 통칭하도록 한다. 일 실시 예에 따른 프로세서는 입력 영상에 수행된 전처리 관련 정보에 기초하여 제1 인공 지능 모델의 파라미터 정보를 획득할 수 있다(S420). 이어서, 프로세서는 획득된 파라미터 정보에 대응되는 제1 인공 지능 모델을 이용하여 입력 영상을 업스케일링할 수 있다(S430). 본 개시의 일 실시 예에 따른 메모리는 상이한 전처리 각각에 대응되는 전처리 관련 정보에 맵핑된 파라미 터 정보를 저장할 수 있다. 일 실시 예에 따른 프로세서는 저장된 파라미터 정보 중 입력 영상과 함께 수 신된 전처리 관련 정보에 대응되는 파라미터 정보를 식별할 수 있다(S420). 이에 대한 구체적인 설명은 도 5를 참조하여 하도록 한다. 도 5는 본 개시의 일 실시 예에 따른 인공 지능 모델을 설명하기 위한 도면이다. 도 5를 참조하면, 메모리는 상이한 전처리 각각에 대응되는 전처리 관련 정보에 맵핑된 파라미터 정 보를 저장할 수 있다. 여기서, 파라미터 정보는 송신 장치가 수신한 원본 영상(예를 들어, 다운스케일링 전 원본 영상)과 제1 학습 네트워크 모델을 이용하여 획득한 업스케일링된 영상의 차이가 최소가 되도록 기 학습된 정보일 수 있다. 일 실시 예에 따라, 전처리 관련 정보는 송신 장치가 전처리 과정에서 다운스케일링된 영상에 적용한 필터 관련 정보를 포함할 수 있다. 여기서, 필터 관련 정보는 필터의 타입 또는 강도 중 적어도 하나를 포함할 수 있다. 종래에는 수신 장치가 업스케일링을 수행함에 있어서, 송신 장치의 전처리 과정에서 다운스케일링된 영상에 적용된 필터에 대한 정보 등을 고려하지 않았다. 따라서, 수신 장치가 획득한 업스케일링된 영상은 전처리 과정에서 손실된 원본 영상의 텍스처(texture), 세밀감, 디테일 등에 대한 복원율이 저조한 문제가 있었 다. 본 개시의 일 실시 예에 따른 수신 장치는 송신 장치의 전처리 과정에서 다운스케일링된 영상에 적용 된 필터 관련 정보 등을 포함하는 전처리 관련 정보에 기초하여 제1 인공 지능 모델을 설정하고, 설정된 제1 인공 지능 모델을 이용하여 입력 영상을 업스케일링할 수 있다. 구체적으로, 프로세서는 메모리에 저장된 복수의 파라미터 정보 중 수신된 전처리 관련 정보에 매칭되는 파라미터 정보를 식별할 수 있다. 여기서, 복수의 파라미터 정보 각각은 상이한 전처리에 대응될 수 있다. 일 예로, 파라미터 정보는 송신 장치가 다운스케일링된 영상에 전처리 필터를 적용함에 따라 손 실된 텍스처(texture), 세밀감, 디테일 등이 업스케일링된 영상에서 복원되도록 학습된 것일 수 있다. 다른 예 로, 파라미터 정보는 송신 장치가 다운스케일링된 영상에 전처리 필터를 적용함에 따라 손실된 텍스처 (texture), 세밀감, 디테일 등이 제1 인공 지능 모델을 이용하여 획득한 업스케일링된 영상에서 복원되어 원 본 영상과 업스케일링된 영상의 차이가 최소가 되도록 학습된 것일 수 있다. 본 개시의 일 실시 예에 따른 메모리는 상이한 전처리 각각에 대응되는 전처리 관련 정보에 맵핑된 파라미터 정보를 룩업 테이블(Lookup table, LUT)로 저장할 수도 있음은 물론이다. 이 경우, 프로세서 룩 업 테이블을 통해 수신된 전처리 관련 정보에 대응되는 파라미터 정보를 식별할 수 있다. 다만, 이는 일 실시 예에 불과하며, 이에 한정되지 않음은 물론이다. 일 예로, 메모리는 룩업 테이블 이외의 다른 형 태의 파라미터 정보를 저장할 수도 있다. 한편, 파라미터 정보는 인공 지능 모델에 포함된 복수의 신경망 레이어 각각에서 이용되는 파라미터(예를 들어, 필터 계수, 바이어스 등)에 대한 정보를 포함할 수 있다. 도 5를 참조하면, 프로세서는 전처리 관련 정보와 매칭되는 제1 파라미터 정보를 식별할 수 있다 . 여기서, 식별된 제1 파라미터 정보는 제1 인공 지능 모델에 포함된 복수의 신경망 레이어 각각에 대 응되는 파라미터(예를 들어, 필터 계수, 바이어스)등을 포함할 수 있다. 일 실시 예에 따라 제1 인공 지능 모델은 CNN(Convolutional Neural Network) 모델로 구현될 수 있고, 파라 미터 정보는 CNN 모델에 포함된 신경망 레이어의 개수, 컨벌루션 필터의 크기(예를 들어, width x height x channel(N x M x C)) 및 바이어스(bias) 등을 포함할 수 있다. 이어서, 프로세서는 식별된 파라미터 정보에 포함된 복수의 파라미터 각각을 대응되는 신경망 레이어 에 대입하여 제1 인공 지능 모델을 설정(또는, 모델링)할 수 있다. 예를 들어, 도 5에서는 y개의 신경망 레 이어(또는, 컨벌루션 필터)를 포함하는 제1 인공 지능 모델이 획득되었으며, 신경망 레이어의 개 수는 식별된 파라미터 정보에 따라 다를 수 있다. 그리고, 프로세서는 제1 인공 지능 모델을 이용하여 입력 영상(예를 들어, 디코딩된 영상)을 업스케일링할 수 있다. 이어서, 프로세서는 업스케일링된 영 상을 출력할 수 있다. 도 5를 참조하면, 본 개시의 일 실시 예에 따른 프로세서는 제1 인공 지능 모 델을 이용하여 N x M 크기의 입력 영상을 업스케일링하여 2N x 2M 크기의 출력 영상(또는, 업스케일링 된 영상)을 획득할 수 있다. 한편, N x M 크기 및 2N x 2M 크기는 설명의 편의를 위해 임의로 상정한 것이 며, 수신 장치는 다양한 크기, 해상도의 입력 영상을 업스케일링하여 고 해상도의 출력 영상을 획득할 수 있음은 물론이다. 한편, 출력 영상은 송신 장치의 전처리 과정에서 손실된 텍스처, 디테일 등을 포함하며, 원본 영상과 의 차이가 최소화되도록 복원된 영상일 수 있다. 한편, 출력 영상은 업스케일링된 영상, 복원 영상, 복원 된 출력 영상 등으로 지칭될 수 있음은 물론이다. 본 개시의 일 실시 예에 따른 제1 인공 지능 모델은 도 5에 도시된 바와 같이 복수의 신경망 레이어를 포함 하고 복수의 신경망 레이어들 각각은 복수의 파라미터를 포함할 수 있다. 이 경우, 제1 인공 지능 모델은 이 전 레이어의 연산 결과와 복수의 파라미터들 간의 연산을 통해 신경망 연산을 수행할 수 있다. 일 예에 따라, 임의의 레이어에서 컨벌루션 필터 적용 후 활성화 함수, 예를 들어 ReLU(Rectified Linear Unit) 연산을 통해 출력되는 연산 데이터가 출력될 수 있다. 이 경우, 레이어에서 출력되는 연산 데이터는 다채널 데 이터로서, 예를 들어, 64 개의 피쳐 맵(또는 액티베이션 맵) 데이터가 출력되어 다음 레이어로 제공될 수 있다. 다만, 일 예에 따라 피쳐 맵 데이터가 메모리(내부 버퍼, 또는 외부 메모리)에 저장된 후 다음 레이어로 제공될 수 있으나, 도 5에서는 해당 구성은 생략하였다. 여기서, 파라미터는 필터의 가중치(또는 계수)와 동일한 의미 일 수 있다. 이 경우, 제1 인공 지능 모델은 Identity Function, Logistic Sigmoid Function, Hyperbolic Tangent(tanh) Function, ReLU Function, Leaky ReLU Function 등 다양한 유형의 활성화 함수(Activation function)를 이용하여 연산을 수행할 수 있다 한편, 프로세서는 DLSR(deep learning super resolution) 기술을 이용하여 화질 처리가 수행된 영상을 업 스케일링 처리할 수 있다. 여기서, DLSR(deep learning super resolution) 기술은 고해상도의 원본 영상 및 저 해상도 영상을 포함하는 학습 DB에 기초하여 학습된 CNN 모델을 이용하여 입력 영상의 해상도를 증대시키는 기 술이다. 일 예에 따라 DLSR 기술은 GAN(Generative Adversarial Networks)을 포함하여 DLSR 화질 처리를 거치 면서 영상 내 texture 부분 생성 효과를 더 극대화시킬 수 있다. 일반적으로 GAN(Generative Adversarial Networks)은 생성자(Generator)에서는 없는 데이터를 만들어내고, 구분자(Discriminator)는 진짜 데이터와 가짜 데이터를 구분해내는 학습으로 둘을 경쟁적으로 함께 학습시켜 진짜와 비슷한 데이터를 만들어내도록 동작한다. 영상 화질 개선에 이러한 GAN을 적용하게 되면, 원본 영상에는 없었으나 기존과 비슷한 영상 특징에 해당하는 texture를 자연스럽게 생성할 수 있어, texture 영역에서의 디테일 향상을 기대할 수 있다. 이에 따라 고화질의 출력 영상을 획득할 수 있게 된다. 도 6은 본 개시의 일 실시 예에 따른 수신 장치의 상세 블록도이다. 도 6을 참조하면, 수신 장치(100’)는 메모리, 프로세서, 디스플레이, 입력부, 출력부 및 사용자 인터페이스를 포함한다. 디스플레이는 자발광 소자를 포함하는 디스플레이 또는, 비자발광 소자 및 백라이트를 포함하는 디스플레 이로 구현될 수 있다. 예를 들어, LCD(Liquid Crystal Display), OLED(Organic Light Emitting Diodes) 디스플 레이, LED(Light Emitting Diodes), 마이크로 LED(micro LED), Mini LED, PDP(Plasma Display Panel), QD(Quantum dot) 디스플레이, QLED(Quantum dot light-emitting diodes) 등과 같은 다양한 형태의 디스플레이 로 구현될 수 있다. 디스플레이 내에는 a-si TFT, LTPS(low temperature poly silicon) TFT, OTFT(organic TFT) 등과 같은 형태로 구현될 수 있는 구동 회로, 백라이트 유닛 등도 함께 포함될 수 있다. 한 편, 디스플레이는 터치 센서와 결합된 터치 스크린, 플렉시블 디스플레이(flexible display), 롤러블 디스 플레이(rollable display), 3차원 디스플레이(3D display), 복수의 디스플레이 모듈이 물리적으로 연결된 디스 플레이 등으로 구현될 수 있다. 프로세서는 상술한 다양한 실시 예에 따라 획득된 출력 영상을 출력하도록 디스플레이를 제어할 수 있다. 여기서, 출력 영상은, 4K 또는 8K 이상의 고해상도 영상일 수 있다. 입력부는 다양한 타입의 컨텐츠를 입력받는다. 예를 들어 입력부는 AP 기반의 Wi-Fi(와이파이, Wireless LAN 네트워크), 블루투스(Bluetooth), 지그비(Zigbee), 유/무선 LAN(Local Area Network), WAN(Wide Area Network), 이더넷(Ethernet), IEEE 1394, HDMI(High-Definition Multimedia Interface), USB(Universal Serial Bus), MHL(Mobile High-Definition Link), AES/EBU(Audio Engineering Society/ European Broadcasting Union), 옵티컬(Optical), 코액셜(Coaxial) 등과 같은 통신 방식을 통해 외부 장치(예를 들어, 소스 장치), 외부 저장 매체(예를 들어, USB 메모리), 외부 서버(예를 들어 웹 하드) 등으로부터 스트리밍 또는 다운로드 방식으로 영상 신호를 입력받을 수 있다. 여기서, 영상 신호는 SD(Standard Definition), HD(High Definition), Full HD 또는 Ultra HD 영상 중 어느 하나의 디지털 영상 신호가 될 수 있으나 이에 한정되는 것 은 아니다. 출력부는 음향 신호를 출력한다. 예를 들어, 출력부는 프로세서에서 처리된 디지털 음향 신호를 아날로그 음향 신호로 변환하고 증폭하여 출력할 수 있다. 예를 들어, 출력부는 적어도 하나의 채널을 출 력할 수 있는, 적어도 하나의 스피커 유닛, D/A 컨버터, 오디오 앰프(audio amplifier) 등을 포함할 수 있다. 일 예에 따라 출력부는 다양한 멀티 채널 음향 신호를 출력하도록 구현될 수 있다. 이 경우, 프로세서 는 입력 영상의 인핸스 처리에 대응되도록 입력된 음향 신호를 인핸스 처리하여 출력하도록 출력부를 제어할 수 있다. 예를 들어, 프로세서는 입력된 2채널 음향 신호를 가상의 멀티 채널(예를 들어, 5.1 채널) 음향 신호로 변환하거나, 수신 장치(100’)가 놓인 위치를 인식해 공간에 최적화된 입체 음향 신호로 처 리하거나, 입력 영상의 타입(예를 들어 컨텐츠 장르)에 따라 최적화된 음향 신호를 제공할 수 있다. 사용자 인터페이스는 버튼, 터치 패드, 마우스 및 키보드와 같은 장치로 구현되거나, 상술한 디스플레이 기능 및 조작 입력 기능도 함께 수행 가능한 터치 스크린, 리모콘 송수신부 등으로 구현될 수 있다. 리모콘 송 수신부는 적외선 통신, 블루투스 통신 또는 와이파이 통신 중 적어도 하나의 통신 방식을 통해 외부 원격 제어 장치로부터 리모콘 신호를 수신하거나, 리모콘 신호를 송신할 수 있다. 전자 장치 (100’)는 구현 예에 따라 튜너 및 복조부를 추가적으로 포함할 수 있다. 튜너(미도시)는 안테나를 통해 수신되는 RF(Radio Frequency) 방송 신호 중 사용자에 의해 선택된 채널 또는 기 저장된 모든 채널을 튜닝 하여 RF 방송 신호를 수신할 수 있다. 복조부(미도시)는 튜너에서 변환된 디지털 IF 신호(DIF)를 수신하여 복조 하고, 채널 복호화 등을 수행할 수도 있다. 일 실시 예에 따라 튜너를 통해 수신된 입력 영상은 복조부(미도 시)를 통해 처리된 후, 본 개시의 일 실시 예에 따른 영상 처리를 위해 프로세서로 제공될 수 있다. 도 7은 본 개시의 일 실시 예에 따른 송신 장치의 구성을 나타내는 블록도이다. 본 개시의 일 실시 예에 따른 송신 장치는 메모리, 프로세서 및 통신 인터페이스를 포함할 수 있다. 메모리는 본 개시의 다양한 실시 예를 위해 필요한 데이터를 저장할 수 있다. 메모리는 데이터 저장 용도에 따라 송신 장치에 임베디드된 메모리 형태로 구현되거나, 송신 장치에 탈부착이 가능한 메모 리 형태로 구현될 수도 있다. 예를 들어, 송신 장치의 구동을 위한 데이터의 경우 송신 장치에 임베 디드된 메모리에 저장되고, 송신 장치의 확장 기능을 위한 데이터의 경우 송신 장치에 탈부착이 가능 한 메모리에 저장될 수 있다. 한편, 송신 장치에 임베디드된 메모리의 경우 휘발성 메모리(예: DRAM(dynamic RAM), SRAM(static RAM), 또는 SDRAM(synchronous dynamic RAM) 등), 비휘발성 메모리(non- volatile Memory)(예: OTPROM(one time programmable ROM), PROM(programmable ROM), EPROM(erasable and programmable ROM), EEPROM(electrically erasable and programmable ROM), mask ROM, flash ROM, 플래시 메 모리(예: NAND flash 또는 NOR flash 등), 하드 드라이브, 또는 솔리드 스테이트 드라이브(solid state drive(SSD)) 중 적어도 하나로 구현될 수 있다. 또한, 송신 장치에 탈부착이 가능한 메모리의 경우 메모리 카드(예를 들어, CF(compact flash), SD(secure digital), Micro-SD(micro secure digital), Mini-SD(mini secure digital), xD(extreme digital), MMC(multi-media card) 등), USB 포트에 연결가능한 외부 메모리(예를 들어, USB 메모리) 등과 같은 형태로 구현될 수 있다. 일 예에 따라 메모리는 송신 장치를 제어하기 위한 적어도 하나의 인스트럭션(instruction) 또는 인 스트럭션들을 포함하는 컴퓨터 프로그램을 저장할 수 있다. 다른 예에 따라, 메모리는 복수의 레이어를 포함하는 인공 지능 모델에 관한 정보를 저장할 수 있다. 여기 서, 인공 지능 모델에 관한 정보를 저장한다는 것은 인공 지능 모델의 동작과 관련된 다양한 정보, 예를 들어 인공 지능 모델에 포함된 복수의 레이어에 대한 정보, 복수의 레이어 각각에서 이용되는 파라미터(예를 들어, 필터 계수, 바이어스 등)에 대한 정보 등을 저장한다는 것을 의미할 수 있다. 예를 들어, 메모리는 본 개 시의 일 실시 예에 따라 영상의 다운스케일링 처리를 하도록 학습된 제2 인공 지능 모델에 대한 정보를 저장 할 수 있다. 다만, 프로세서가 전용 하드웨어로 구현되는 경우, 인공 지능 모델에 관한 정보는 프로세서 내부 메모리에 저장될 수도 있다. 또 다른 예에 따라, 메모리는 외부 장치(예를 들어, 소스 장치), 외부 저장 매체(예를 들어, USB), 외부 서버(예를 들어 웹 하드) 등으로부터 수신된 영상을 저장할 수 있다. 여기서, 영상은 디지털 동영상이 될 수 있 으나 이에 한정되는 것은 아니다. 또 다른 예에 따라, 메모리는 화질 처리에 필요한 다양한 정보, 예를 들어 Noise Reduction, Detail Enhancement, Tone Mapping, Contrast Enhancement, Color Enhancement 또는 Frame rate Conversion 중 적어 도 하나를 수행하기 위한 정보, 알고리즘, 화질 파라미터 등을 저장할 수 있다. 또한, 메모리는 영상 처리 에 의해 생성된 최종 출력 영상을 저장할 수도 있다. 본 개시의 일 실시 예에 따르면, 메모리는 본 개시에 따른 다양한 동작들에서 생성되는 데이터를 저장하는 단일 메모리로 구현될 수 있다. 다만, 본 개시의 다른 실시 예에 따르면, 메모리는 상이한 타입의 데이터 를 각각 저장하거나, 상이한 단계에서 생성되는 데이터를 각각 저장하는 복수의 메모리를 포함하도록 구현될 수 도 있다. 상술한 실시 예에서는 다양한 데이터가 프로세서의 외부 메모리에 저장되는 것으로 설명하였으나, 상 술한 데이터 중 적어도 일부는 송신 장치 또는 프로세서 중 적어도 하나의 구현 예에 따라 프로세서 내부 메모리에 저장될 수도 있다. 프로세서는 메모리와 전기적으로 연결되어 송신 장치의 전반적인 동작을 제어한다. 프로세서 는 하나 또는 복수의 프로세서로 구성될 수 있다. 구체적으로, 프로세서는 메모리에 저장된 적 어도 하나의 인스트럭션(instruction)을 실행함으로써, 본 개시의 다양한 실시 예에 따른 송신 장치의 동 작을 수행할 수 있다. 일 실시 예에 따라 프로세서는 디지털 영상 신호를 처리하는 디지털 시그널 프로세서(digital signal processor(DSP), 마이크로 프로세서(microprocessor), GPU(Graphics Processing Unit), AI(Artificial Intelligence) 프로세서, NPU (Neural Processing Unit), TCON(Time controller)으로 구현될 수 있다. 다만, 이에 한정되는 것은 아니며, 중앙처리장치(central processing unit(CPU)), MCU(Micro Controller Unit), MPU(micro processing unit), 컨트롤러(controller), 어플리케이션 프로세서(application processor(AP)), 또 는 커뮤니케이션 프로세서(communication processor(CP)), ARM 프로세서 중 하나 또는 그 이상을 포함하거나, 해당 용어로 정의될 수 있다. 또한, 프로세서는 프로세싱 알고리즘이 내장된 SoC(System on Chip), LSI(large scale integration)로 구현될 수도 있고, ASIC(application specific integrated circuit), FPGA(Field Programmable gate array) 형태로 구현될 수도 있다. 또한, 본 개시의 일 실시 예에 따른 인공 지능 모델을 실행하기 위한 프로세서는 CPU, AP, DSP(Digital Signal Processor) 등과 같은 범용 프로세서, GPU, VPU(Vision Processing Unit)와 같은 그래픽 전용 프로세서 또는 NPU와 같은 인공 지능 전용 프로세서과 소프트웨어의 조합을 통해 구현될 수 있다. 프로세서는, 메모 리에 저장된 기 정의된 동작 규칙 또는 인공 지능 모델에 따라, 입력 데이터를 처리하도록 제어할 수 있다. 또는, 프로세서가 전용 프로세서(또는 인공 지능 전용 프로세서)인 경우, 특정 인공 지능 모델의 처 리에 특화된 하드웨어 구조로 설계될 수 있다. 예를 들어, 특정 인공 지능 모델의 처리에 특화된 하드웨어는 ASIC, FPGA 등의 하드웨어 칩으로 설계될 수 있다. 프로세서가 전용 프로세서로 구현되는 경우, 본 개시의 실시 예를 구현하기 위한 메모리를 포함하도록 구현되거나, 외부 메모리를 이용하기 위한 메모리 처리 기능을 포함하도록 구현될 수 있다. 프로세서는 입력 데이터를 처리하여 출력 데이터를 획득한다. 여기서, 입력 데이터는 텍스트, 이미지 또는 사용자 음성 중 적어도 하나를 포함할 수 있다. 예를 들어, 입력 데이터는, 외부 장치와 통신 가능한 통신부, 키보드 또는 터치 패드 등과 같은 사용자 입력부, 카메라, 마이크 등을 통해 입력될 수 있다. 출력 데이터는 인 공 지능 모델의 종류에 따라 다양한 형태가 될 수 있다. 예를 들어 출력 데이터는, 해상도가 향상된 이미지, 이 미지 내에 포함된 오브젝트 관련 정보, 음성에 대응되는 텍스트 등이 될 수 있다. 일 예에 따라, 프로세서는 입력 영상을 영상 처리하여 출력 영상을 획득한다. 여기서, 영상은 정지 영상, 복수의 연속된 정지영상(또는 프레임), 또는 비디오를 포함할 수 있다. 영상 처리는 영상 개선(image enhancement), 영상 복원(image restoration), 영상 변환(image transformation), 영상 분석(image analysis), 영상 인식(image understanding) 또는 영상 압축(image compression) 중 적어도 하나를 포함하는 디지털 영상 처리가 될 수 있다. 일 예에 따라 입력 영상이 압축 영상인 경우 프로세서는 압축 영상을 디코딩한 후 영 상 처리할 수 있다. 일 실시 예에 따라, 프로세서는 인공 지능 모델을 이용하여 입력 영상을 영상 처리할 수 있다. 예를 들어, 프로세서는 인공 지능 모델을 이용하기 위하여, 메모리, 예를 들어 DRAM과 같은 외부 메모리에 저장된 인공 지능 모델 관련 정보를 로딩하여 이용할 수 있다. 특히, 본 개시의 일 실시 예에 따른 프로세서는 제2 인공 지능 모델로부터 획득된 영상의 특성 정보에 기초하여 다운스케일링된 영상을 전처리할 수 있다. 이에 대한 구체적인 설명은 도 8을 참조하여 하도록 한다. 도 8은 본 개시의 일 실시 예에 따른 송신 장치의 동작을 설명하기 위한 도면이다. 도 8을 참조하면, 프로세서는 영상을 다운스케일링하도록 학습된 제2 인공 지능 모델을 이용하여 입력 영상을 다운스케일링할 수 있다. 일 실시 예에 따라 프로세서는 2N x 2M 크기의 입력 영상을 다운스케일링하여 N x M 크기의 출력 영상(또 는, 다운스케일링된 영상)을 획득할 수 있다. 한편, N x M 크기 및 2N x 2M 크기는 설명의 편의를 위해 임의로 상정한 것이며, 송신 장치는 다양한 크기, 해상도의 입력 영상을 다운스케일링하여 저 해상도의 출력 영상 을 획득할 수 있음은 물론이다. 한편, 본 개시의 일 실시 예에 따른 프로세서는 제2 인공 지능 모델로부터 획득된 영상의 특성 정보에 기초하여 다운스케일링된 영상의 전처리 과정에 적용하기 위한 필터 관련 정보를 획득할 수 있다. 여기서, 필터관련 정보는 다운스케일링된 영상에 적용하기 위한 필터의 타입 또는 강도 중 적어도 하나를 포함할 수 있다. 영상의 특성 정보는 제2 인공 지능 모델의 컨벌루션 처리 결과에 따라 획득된 특징 맵(feature map)을 의미 할 수 있다. 일 예로, 프로세서는 제2 인공 지능 모델에 입력 영상을 적용하여 적어도 하나 이상의 특 성 정보를 획득할 수 있다. 예를 들어, 프로세서는 제2 인공 지능 모델에 포함된 복수의 신경망 레이어 (또는, 컨벌루션 레이어)에 의해 복수의 특성 정보를 획득하고, 복수의 특성 정보 각각은 입력 영상의 특성(예 를 들어, 수직 방향 특성, 수평 방향 특성 또는 에지 특성)등을 나타낼 수 있다. 영상의 특성 정보는 특징 맵 등으로 불릴 수 있으나 이하에서는 설명의 편의를 위해 특성 정보로 통칭하도록 한다. 이어서, 프로세서는 영상의 특성 정보에 대응되는 영상의 전처리 관련 정보를 획득하도록 학습된 제3 인공 지능 모델을 이용하여 입력 영상 또는 다운스케일링된 영상에 수행될 전처리 필터 관련 정보를 획득할 수 있 다. 예를 들어, 프로세서는 제2 인공 지능 모델에 포함된 복수의 신경망 레이어 중 어느 하나의 신경망 레 이어에서 출력된 특성 정보(또는, 특징 맵)를 제3 인공 지능 모델에 적용할 수 있다. 이어서, 프로세서(22 0)는 영상의 특성 정보에 대응되는 전처리 관련 정보를 출력하도록 학습된 제3 인공 지능 모델을 이용하여 입력 영상의 특성 정보에 대응되는 전처리 관련 정보를 획득할 수 있다. 여기서, 전처리 관련 정보는 다운스케 일링된 영상에 적용하기 위한 필터 관련 정보를 포함할 수 있고, 필터 관련 정보는 필터의 타입 또는 강도 중 적어도 하나를 포함할 수 있다. 일 예에 따라, 제3 인공 지능 모델은 제2 인공 지능 모델과 적어도 하나의 레이어를 공유하도록 구현될 수 있다. 구체적으로 제3 인공 지능 모델은 제2 인공 지능 모델에 포함된 복수의 레이어 중 특정 레이어 에서 출력되는 특징 맵 데이터를 입력받는 적어도 하나의 레이어를 포함할 수 있다. 이에 따라 제3 인공 지능 모델은 제2 인공 지능 모델에 포함된 적어도 일부 레이어 및 추가된 적어도 하나의 레이어를 포함하는 형 태로 구현될 수 있다. 추가된 레이어는 피쳐 맵 데이터(예를 들어, 2차원 데이터)를 전 처리 관련 정보(예를 들 어, 1차원 데이터)로 변환하여 출력하도록 학습될 수 있다. 일 구현 예에 따라 제3 인공 지능 모델은, 제2 인공 지능 모델과 공유하는 적어도 하나의 레이어의 파라 미터는 고정시키고, 제2 인공 지능 모델과 공유하지 않는 나머지 레이어의 파라미터를 학습시키는 형태로 구 현될 수 있다. 즉, 제3 인공 지능 모델의 학습에는 전이 학습이 이용될 수 있다. 여기서, 전이 학습이란, 특 정 응용에 대해 잘 학습된 모델을 다른 응용에서 재사용해서 학습하는 방법이다. 예를 들어 입력 영상 내의 동 물을 Classification 하는 용도로 잘 학습된 모델이 있다고 가정하면, 동물의 종류가 더 추가된 모델을 생성할 때, 처음부터 다시 학습할 필요 없이 기존의 학습된 모델을 재사용하고 Classifier 부분만 추가로 학습하여 새 로운 모델을 만들 수 있다. 전이 학습 방식은 적은 양의 데이터로 빠르게 학습을 할 수 있는 장점이 있으며, 성 능 면에서도 우수한 것으로 알려져 있다. 이미 잘 훈련된 모델이 있고, 해당 모델과 유사한 문제를 해결하고자 할 때 이와 같은 방법을 사용하는 것이 효율적이다. 이와 같이 제3 인공 지능 모델은 다운스케일링을 위해 잘 학습된 제2 인공 지능 모델의 적어도 일부 레이어를 이용하고, 나머지 추가된 레이어만 추가로 학습시키 는 형태로 구현될 수 있다. 예를 들어, 프로세서는 제3 인공 지능 모델을 이용하여 획득한 전처리 관련 정보에 기초하여 전처리 필 터로 Bilateral Filter를 식별할 수 있다. 이어서, 프로세서는 전처리 관련 정보에 기초하여 Bilateral Filter의 강도 즉, Filter weight값을 식별할 수 있다. 예를 들어, Filter weight값은 하기의 수학식 1을 이용 하여 식별할 수 있다. [수학식 1]"}
{"patent_id": "10-2019-0157745", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "여기서, (i, j) 픽셀 좌표를 의미하고, I(i, j)는 (i, j) 픽셀의 intensity, I(k, l)는 Kernel size 내의 (k, l) 픽셀의 intensity를 의미한다. σd와 σr는 smoothing 파라미터를 의미한다. 한편, Bilateral Filter는 다양한 필터의 타입 중 일 예시에 불과하며 이에 한정되지 않음은 물론이다. 다른 예 로, 프로세서는 전처리 관련 정보에 기초하여 Gaussian Filter 또는 Median Filter를 전처리 필터로 식별 할 수도 있음은 물론이다. 또한, 프로세서는 동일한 필터가 식별된 경우에도 전처리 관련 정보에 기초하여상이한 강도로 전처리를 수행할 수도 있음은 물론이다(S1810). 본 개시의 일 실시 예에 따른 프로세서는 전처리 관련 정보를 수신 장치로 전송할 수 있다. 예를 들 어, 다운스케일링된 영상에 적용된 전처리 필터 관련 정보를 수신 장치로 전송할 수 있다. 일 실시 예에 따른 전처리 관련 정보는 전처리 필터가 적용되기 전 영상과 전처리 필터가 적용된 후 영상 간 차 이에 대한 정보를 더 포함할 수도 있음은 물론이다. 본 개시의 일 실시 예에 따라 송신 장치는 영상에 적용된 전처리 필터 관련 정보, 필터의 적용 전 영상과 적용 후 영상 차이에 대한 정보 등을 포함하는 전처리 관련 정보를 수신 장치로 전송할 수 있다. 여기서, 필터의 적용 전 영상과 적용 후 영상 차이에 대한 정보는 Min/Max value, Variance 등을 포함할 수 있다. 수신 장치는 영상을 업스케일링하기 위한 제1 인공 지능 모델(예를 들어, AI 디코더)에 포함된 복수의 신경망 레이어를 수신된 전처리 관련 정보에 기초하여 설정하므로, 제1 인공 지능 모델로부터 획득된 업스케 일링된 영상은 전처리 필터의 적용에 따라 손실된 원본 영상의 디테딜, 세밀감 등을 포함할 수 있다. 이어서, 본 개시의 일 실시 예에 따른 프로세서는 전처리된 영상을 인코딩할 수 있다(S1820). 이어서, 프 로세서는 인코딩된 영상 및 전처리 관련 정보를 수신 장치로 전송할 수 있다. 도 7로 돌아와서, 본 개시의 일 실시 예에 따른 프로세서는 통신 인터페이스를 포함할 수 있다. 통신 인터페이스는 다양한 타입의 컨텐츠를 입력받는다. 또한, 통신 인터페이스는 프로세서의 제어에 따라 인코딩된 영상 및 전처리 관련 정보를 포함하는 영상 데이터를 비트스트림 형태로 수신 장치 로 전송할 수 있다. 예를 들어, 통신 인터페이스는 AP 기반의 Wi-Fi(와이파이, Wireless LAN 네트워크), 블루투스 (Bluetooth), 지그비(Zigbee), 유/무선 LAN(Local Area Network), WAN(Wide Area Network), 이더넷 (Ethernet), IEEE 1394, HDMI(High-Definition Multimedia Interface), USB(Universal Serial Bus), MHL(Mobile High-Definition Link), AES/EBU(Audio Engineering Society/ European Broadcasting Union), 옵 티컬(Optical), 코액셜(Coaxial) 등과 같은 통신 방식을 통해 외부 장치(예를 들어, 소스 장치), 외부 저장 매 체(예를 들어, USB 메모리), 외부 서버(예를 들어 웹 하드) 등으로부터 스트리밍 또는 다운로드 방식으로 영상 신호를 입력받을 수 있다. 여기서, 영상 신호는 SD(Standard Definition), HD(High Definition), Full HD 또는 Ultra HD 영상 중 어느 하나의 디지털 영상 신호가 될 수 있으나 이에 한정되는 것은 아니다. 본 개시의 일 실시 예에 따른 프로세서는 통신 인터페이스가 연결된 네트워크의 상태 정보를 획득할 수 있다. 이어서, 프로세서는 네트워크의 상태 정보 및 제2 인공 지능 모델로부터 획득된 영상의 특성 정보에 기초하여 다운스케일링된 영상을 전처리할 수 있다. 일 실시 예에 따라 네트워크의 상태 정보는 망의 대역폭(bandwidth), error rate, 신호의 세기, 지연율 (latency) 등을 포함할 수 있다. 일 실시 예에 따라 프로세서는 네트워크의 상태 정보 및 영상의 특성 정보를 이용하여 전처리 관련 정보를 획득하도록 학습된 제3 인공 지능 모델을 이용하여 입력 영상 또는 다운스케일링된 영상에 적용하기 위한 전 처리 관련 필터 정보를 포함하는 전처리 관련 정보를 획득할 수 있다. 본 개시의 일 실시 예에 따른 프로세서는 네트워크의 상태 정보에 따라 인코딩 성능, 압축률을 적절히 조 정하기 위해 영상의 특성 정보 외에도 네트워크의 상태 정보를 고려하여 필터의 타입 또는 강도 중 적어도 하나 를 식별할 수 있다. 이하에서는 제1 인공 지능 모델에 대응되는 제2 DNN 및 제2 인공 지능 모델에 대응되는 제1 DNN에 대한 다양한 실시 예에 대해 설명하도록 한다. 도 9는 본 개시의 일 실시 예에 따른 AI(artificial intelligence) 부호화 과정 및 AI 복호화 과정을 설명하기 위한 도면이다. 전술한 바와 같이 영상의 해상도가 급격히 커짐에 따라 부호화/복호화를 위한 정보 처리량이 많아지게 되고, 이 에 따라 영상의 부호화 및 복호화 효율을 향상시키기 위한 방안이 필요하다. 도 9에 도시된 바와 같이, 본 개시의 일 실시 예에 따르면, 해상도가 큰 원본 영상을 AI 다운스케일 하여 제 1 영상을 획득한다. 그리고, 상대적으로 작은 해상도의 제 1 영상을 대상으로 하여 제 1 부호화 및 제 1 복호화를 수행하므로, 원본 영상을 대상으로 하여 제 1 부호화 및 제 1 복호 화를 수행하는 경우에 비해 처리되는 비트레이트를 크게 감소시킬 수 있다. 여기서, AI 다운스케일은 상술한 다운스케일링에 대응되며, 제1 부호화는 상술한 인코딩에 대응될 수 있다. 또한, 제1 복호화 는 상술한 디코딩에 대응될 수 있다. 도 9를 참조하여 상세히 설명하면, 일 실시 예는 AI 부호화 과정에서, 원본 영상을 AI 다운스케일하 여 제 1 영상을 획득하고, 제 1 영상을 제 1 부호화한다. AI 복호화 과정에서는, AI 부호화 결 과 획득된 AI 데이터와 영상 데이터를 포함하는 AI 부호화 데이터를 수신하고, 제 1 복호화를 통해 제 2 영상을 획득하고, 제 2 영상을 AI 업스케일하여 제 3 영상을 획득한다. 여기서, AI 부호화 과정은 송신 장치에서 수행되며, AI 복호화 과정은 수신 장치에서 수행될 수 있다. AI 부호화 과정을 좀 더 상세히 살펴보면, 원본 영상을 입력받으면, 소정 해상도 또는 소정 화질의 제 1 영상을 획득하기 위해 원본 영상을 AI 다운스케일한다. 이때, AI 다운스케일은 AI 기반으 로 수행되는데, AI 다운스케일을 위한 AI는 제 2 영상의 AI 업스케일을 위한 AI와 연계되어 훈 련되어야(joint trained) 한다. 왜냐하면, AI 다운스케일을 위한 AI와 AI 업스케일을 위한 AI가 분 리되어 훈련되는 경우, AI 부호화 대상인 원본 영상과 AI 복호화를 통해 복원된 제 3 영상 사이의 차 이가 커지게 되기 때문이다. 여기서, AI 다운스케일을 위한 AI는 상술한 제2 인공 지능 모델에 대응되며, AI 업스케일을 위한 AI는 상술한 제1 인공 지능 모델에 대응될 수 있다. 또한, 도 9에 도시되어 있지는 않으나 AI 다운스케일 을 위한 AI, AI 업스케일을 위한 AI 및 전처리 관련 정보를 획득하기 위한 AI(즉, 제3 인공 지능 모 델) 모두가 연계되어 훈련될 수 있음은 물론이다. 본 개시의 실시예에서는, AI 부호화 과정과 AI 복호화 과정에서 이러한 연계 관계를 유지하기 위해, AI 데이터 를 이용할 수 있다. 따라서, AI 부호화 과정을 통해 획득된 AI 데이터는 업스케일 타겟을 나타내는 정보를 포함 하여야 하고, AI 복호화 과정에서는 AI 데이터에 기초하여 확인되는 업스케일 타겟에 따라 제 2 영상을 AI 업스케일하여야 한다. AI 다운스케일을 위한 AI 및 AI 업스케일을 위한 AI는 DNN(deep neural network)으로 구현될 수 있 다. 도 9를 참조하여 후술하는 바와 같이, 제 1 DNN과 제 2 DNN은 소정 타겟 하에 손실 정보의 공유를 통해 연 계 훈련되므로, AI 부호화 장치는 제 1 DNN과 2 DNN이 연계 훈련할 때 이용된 타겟 정보를 AI 복호화 장치로 제 공하고, AI 복호화 장치는 제공받은 타겟 정보에 기초하여 제 2 영상을 타겟하는 해상도로 AI 업스케일 할 수 있다. 도 9에 도시된 제 1 부호화 및 제 1 복호화에 대해 상세히 설명하면, 원본 영상으로부터 AI 다 운스케일된 제 1 영상은 제 1 부호화를 통해 정보량이 감축될 수 있다. 제 1 부호화는, 제 1 영상을 예측하여 예측 데이터를 생성하는 과정, 제 1 영상과 예측 데이터 사이의 차이에 해당하는 잔차 데이터를 생성하는 과정, 공간 영역 성분인 잔차 데이터를 주파수 영역 성분으로 변환(transformation)하 는 과정, 주파수 영역 성분으로 변환된 잔차 데이터를 양자화(quantization)하는 과정 및 양자화된 잔차 데이터 를 엔트로피 부호화하는 과정 등을 포함할 수 있다. 이와 같은 제 1 부호화 과정은 MPEG-2, H.264 AVC(Advanced Video Coding), MPEG-4, HEVC(High Efficiency Video Coding), VC-1, VP8, VP9 및 AV1(AOMedia Video 1) 등 주파수 변환을 이용한 영상 압축 방법 중의 하나를 통해 구현될 수 있다. 제 1 영상에 대응하는 제 2 영상은 영상 데이터의 제 1 복호화를 통해 복원될 수 있다. 제 1 복 호화는, 영상 데이터를 엔트로피 복호화하여 양자화된 잔차 데이터를 생성하는 과정, 양자화된 잔차 데이 터를 역양자화하는 과정, 주파수 영역 성분의 잔차 데이터를 공간 영역 성분으로 변환하는 과정, 예측 데이터를 생성하는 과정 및 예측 데이터와 잔차 데이터를 이용하여 제 2 영상을 복원하는 과정 등을 포함할 수 있다. 이와 같은 제 1 복호화 과정은 제 1 부호화 과정에서 사용된 MPEG-2, H.264, MPEG-4, HEVC, VC-1, VP8, VP9 및 AV1 등 주파수 변환을 이용한 영상 압축 방법 중의 하나에 대응되는 영상 복원 방법을 통해 구현될 수 있다. AI 부호화 과정을 통해 획득된 AI 부호화 데이터는, 제 1 영상의 제 1 부호화 결과 획득된 영상 데이 터 및 원본 영상의 AI 다운스케일과 관련된 AI 데이터를 포함할 수 있다. 영상 데이터는 제 1 복호화 과정에서 이용될 수 있으며, AI 데이터는 AI 업스케일 과정에서 이용될 수 있다.영상 데이터는 비트스트림 형태로 전송될 수 있다. 영상 데이터는 제 1 영상 내 픽셀 값들에 기초하여 획 득되는 데이터, 예를 들어, 제 1 영상과 제 1 영상의 예측 데이터 사이의 차이인 잔차 데이터를 포함 할 수 있다. 또한, 영상 데이터는 제 1 영상의 제 1 부호화 과정에서 이용된 정보들을 포함한다. 예 를 들어, 영상 데이터는 제 1 영상을 제 1 부호화하는데 이용된 예측 모드(mode) 정보, 움직임 정보, 및 제 1 부호화에서 이용된 양자화 파라미터 관련 정보 등을 포함할 수 있다. 영상 데이터는 MPEG-2, H.264 AVC, MPEG-4, HEVC, VC-1, VP8, VP9 및 AV1 등 주파수 변환을 이용하는 영상 압축 방법 중 제 1 부호화 과정에서 이용된 영상 압축 방법의 규칙, 예를 들어, 신택스(syntax)에 따라 생성될 수 있다. AI 데이터는 제 2 DNN에 기반한 AI 업스케일에 이용된다. 전술한 바와 같이, 제 1 DNN과 제 2 DNN은 연계 훈련되기 때문에, AI 데이터는 제 2 DNN을 통한 제 2 영상의 정확한 AI 업스케일이 수행될 수 있게 하는 정보를 포함한다. AI 복호화 과정에서는 AI 데이터에 기반하여 제 2 영상을 타겟하는 해상도 및/또는 화질로 AI 업스케일할 수 있다. AI 데이터는 비트스트림의 형태로 영상 데이터와 함께 전송될 수 있다. 또는, 구현예에 따라, AI 데이터는 프레 임이나 패킷 형태로 영상 데이터와 구분되어 전송될 수도 있다. AI 부호화 결과 획득된 영상 데이터와 AI 데이 터는 동일한 네트워크 또는 서로 상이한 네트워크를 통해 전송될 수 있다. 도 10은 일 실시예에 따른 AI 복호화 장치의 구성을 도시하는 블록도이다. 도 10을 참조하면, 일 실시예에 따른 AI 복호화 장치는 수신부 및 AI 복호화부를 포함할 수 있다. 수신부는 통신부, 파싱부 및 출력부를 포함할 수 있다. AI 복호화부는 제 1 복호화부 및 AI 업스케일부를 포함할 수 있다. 여기서, AI 복호화 장치는 수신 장치 를 의미할 수 있다. 또한, 제1 복호화부는 디코딩에 대응되고, AI 업스케일부는 제1 인공 지 능 모델에 대응될 수 있다. 수신부는 AI 부호화 결과 획득된 AI 부호화 데이터를 수신 및 파싱하고, 영상 데이터와 AI 데이터를 구분 하여 AI 복호화부로 출력한다. 구체적으로, 통신부는 네트워크를 통해 AI 부호화 결과 획득된 AI 부호화 데이터를 수신한다. AI 부호화 결과 획득된 AI 부호화 데이터는 영상 데이터와 AI 데이터를 포함한다. 영상 데이터와 AI 데이터는 동종 네트워 크 또는 이종 네트워크를 통해 수신될 수 있다. 파싱부는 통신부를 통해 수신된 AI 부호화 데이터를 전달받아 파싱(parsing)하여 영상 데이터와 AI 데이터로 구분한다. 예를 들어, 통신부로부터 획득된 데이터의 헤더를 읽어, 해당 데이터가 영상 데이터 인지 또는 AI 데이터인지를 구분할 수 있다. 일 예에서, 파싱부는 통신부를 통해 수신된 데이터의 헤더를 통해 영상 데이터와 AI 데이터를 구분하여 출력부로 전달하고, 출력부는 각각의 구분된 데 이터를 제 1 복호화부 및 AI 업스케일부로 전달한다. 이 때, AI 부호화 데이터에 포함된 영상 데이 터가 소정의 코덱(예를 들어, MPEG-2, H.264, MPEG-4, HEVC, VC-1, VP8, VP9 또는 AV1)을 통해 획득된 영상 데 이터인 것으로 확인할 수도 있다. 이 경우, 영상 데이터가 상기 확인된 코덱으로 처리될 수 있도록, 출력부 를 통해 해당 정보를 제 1 복호화부로 전달할 수 있다. 일 실시예에서, 파싱부가 파싱하는 AI 부호화 데이터는, 하드 디스크, 플로피 디스크 및 자기 테이프와 같은 자기 매체, CD-ROM 및 DVD와 같은 광기록 매체, 플롭티컬 디스크(floptical disk)와 같은 자기-광 매체 (magneto-optical medium) 등을 포함하는 데이터 저장 매체로부터 획득된 것일 수도 있다. 제 1 복호화부는 영상 데이터에 기초하여 제 1 영상에 대응하는 제 2 영상을 복원한다. 제 1 복호화부에 의해 획득된 제 2 영상은 AI 업스케일부로 제공된다. 구현예에 따라서는, 영상 데 이터에 포함된 예측 모드 정보, 움직임 정보, 양자화 파라미터 정보 등의 제 1 복호화 관련 정보가 AI 업스케일 부로 더 제공될 수 있다. AI 데이터를 수신한 AI 업스케일부는 AI 데이터에 기초하여 제 2 영상을 AI 업스케일한다. 구현예에 따라서는, 영상 데이터에 포함된 예측 모드 정보, 양자화 파라미터 정보 등의 제 1 복호화 관련 정보를 더 이용 하여 AI 업스케일 할 수 있다. 한편, AI 복호화부는 전처리 관련 정보에 기초하여 AI 업스케일부에 포함된 복수의 신경망 레이어 를 설정할 수 있다. 이에 대한 구체적인 설명은 상술하였다. 일 실시예에 따른 수신부 및 AI 복호화부는 개별적인 장치로 설명되었으나, 하나의 프로세서를 통 해 구현될 수 있다. 이 경우, 수신부 및 AI 복호화부는 전용 프로세서로 구현될 수도 있고, AP 또 는 CPU, GPU와 같은 범용 프로세서와 S/W의 조합을 통해 구현될 수도 있다. 또한, 전용 프로세서의 경우, 본 개 시의 실시예를 구현하기 위한 메모리를 포함하여 구현되거나, 외부 메모리를 이용하기 위한 메모리 처리부를 포 함하여 구현될 수 있다. 또한, 수신부 및 AI 복호화부는 복수의 프로세서로 구성될 수도 있다. 이 경우, 전용 프로세서들의 조합으로 구현될 수도 있고, AP 또는 CPU, GPU와 같은 다수의 범용 프로세서들과 S/W의 조합을 통해 구현될 수 도 있다. 마찬가지로 AI 업스케일부와 제 1 복호화부도 각각 서로 다른 프로세서로 구현될 수 있다. AI 업스케일부로 제공되는 AI 데이터는, 제 2 영상을 AI 업스케일할 수 있게 하는 정보들을 포함한 다. 이때, 업스케일 타겟은 제 1 DNN의 다운스케일에 대응하여야 한다. 따라서, AI 데이터는 제 1 DNN의 다운스 케일 타겟을 확인할 수 있는 정보가 포함되어야 한다. AI 데이터에 포함된 정보를 구체적으로 예시하면, 원본 영상의 해상도와 제 1 영상의 해상도의 차이 정보, 제 1 영상 관련 정보가 있다. 차이 정보는, 원본 영상 대비 제 1 영상의 해상도 변환 정도에 대한 정보(예를 들어, 해상도 변환률 정보)로 표현될 수 있다. 그리고, 복원된 제 2 영상의 해상도를 통해 제 1 영상의 해상도를 알게 되 고 이를 통해 해상도 변환 정도를 확인할 수 있기 때문에, 차이 정보는 원본 영상의 해상도 정보만으로 표 현될 수도 있다. 여기서 해상도 정보는 가로/세로의 화면 사이즈로 표현될 수도 있고, 비율(16:9, 4:3 등)과 한 축의 사이즈로 표현될 수도 있다. 또한, 기 설정된 해상도 정보가 있는 경우는 인덱스 또는 플래그의 형태로 표 현될 수도 있다. 그리고, 제 1 영상 관련 정보는, 제 1 영상의 제 1 부호화 결과 획득된 영상 데이터의 비트레이트 및 제 1 영상의 제 1 부호화시 이용된 코덱 타입 중 적어도 하나에 대한 정보를 포함할 수 있다. AI 업스케일부는 AI 데이터에 포함된 차이 정보 및 제 1 영상 관련 정보 중 적어도 하나에 기초하여 제 2 영상의 업스케일 타겟을 결정할 수 있다. 업스케일 타겟은 예를 들어, 제 2 영상을 어느 정도의 해상도로 업스케일하여야 하는지를 나타낼 수 있다. AI 업스케일부는 업스케일 타겟이 결정되면, 업스케 일 타겟에 대응하는 제 3 영상을 획득하기 위해 제 2 DNN을 통해 제 2 영상을 AI 업스케일한다. AI 업스케일부가 업스케일 타겟에 맞춰 제 2 영상을 AI 업스케일하는 방법을 설명하기에 앞서, 제 2 DNN을 통한 AI 업스케일 과정에 대해 도 11 및 도 12를 참조하여 설명한다. 도 11은 제 2 영상의 AI 업스케일을 위한 제 2 DNN을 나타내는 예시적인 도면이고, 도 12는 도 11에 도시된 제 1 컨볼루션 레이어에서의 컨볼루션 연산을 도시하고 있다. 도 11에 도시된 바와 같이, 제 2 영상은 제 1 컨볼루션 레이어로 입력된다. 도 11에 도시된 제 1 컨 볼루션 레이어에 표시된 3X3X4는 3 x 3의 크기의 4개의 필터 커널을 이용하여 1개의 입력 영상에 대해 컨 볼루션 처리를 하는 것을 예시한다. 컨볼루션 처리 결과 4개의 필터 커널에 의해 4개의 특징 맵이 생성된다. 각 특징 맵은 제 2 영상의 고유한 특성들을 나타낸다. 예를 들어, 각 특징 맵은 제 2 영상의 수직 방향 특성, 수평 방향 특성 또는 에지 특성 등을 나타낼 수 있다. 도 12를 참조하여, 제 1 컨볼루션 레이어에서의 컨볼루션 연산에 대해 상세히 설명한다. 제 1 컨볼루션 레이어에서 이용되는 3 X 3의 크기를 갖는 필터 커널의 파라미터들과 그에 대응하는 제 2 영상 내 픽셀 값들 사이의 곱 연산 및 덧셈 연산을 통해 하나의 특징 맵이 생성될 수 있다. 제 1 컨볼루션 레이어에서는 4개의 필터 커널이 이용되므로, 4개의 필터 커널을 이용한 컨볼루션 연산 과정 을 통해 4개의 특징 맵이 생성될 수 있다. 도 12에서 제 2 영상에 표시된 I1 내지 I49는 제 2 영상의 픽셀들을 나타내고, 필터 커널에 표 시된 F1 내지 F9는 필터 커널의 파라미터들을 나타낸다. 또한, 특징 맵에 표시된 M1 내지 M9는 특 징 맵의 샘플들을 나타낸다. 도 12는 제 2 영상이 49개의 픽셀을 포함하는 것으로 예시하고 있으나, 이는 하나의 예시일 뿐이며, 제 2 영상이 4K의 해상도를 갖는 경우, 예를 들어, 3840 X 2160개의 픽셀을 포함할 수 있다. 컨볼루션 연산 과정에서, 제 2 영상의 I1, I2, I3, I8, I9, I10, I15, I16, I17의 픽셀 값들 각각과 필터 커널의 F1, F2, F3, F4, F5, F6, F7, F8 및 F9 각각의 곱 연산이 수행되고, 곱 연산의 결과 값들을 조합 (예를 들어, 덧셈 연산)한 값이 특징 맵의 M1의 값으로 할당될 수 있다. 컨볼루션 연산의 스트라이드 (stride)가 2라면, 제 2 영상의 I3, I4, I5, I10, I11, I12, I17, I18, I19의 픽셀 값들 각각과 필터 커 널의 F1, F2, F3, F4, F5, F6, F7, F8 및 F9 각각의 곱 연산이 수행되고, 곱 연산의 결과 값들을 조합한 값이 특징 맵의 M2의 값으로 할당될 수 있다. 필터 커널이 제 2 영상의 마지막 픽셀에 도달할 때까지 스트라이드에 따라 이동하는 동안 제 2 영상 내 픽셀 값들과 필터 커널의 파라미터들 사이의 컨볼루션 연산이 수행됨으로써, 소정 크기를 갖는 특징 맵이 획득될 수 있다. 본 개시에 따르면, 제 1 DNN과 제 2 DNN의 연계 훈련을 통해 제 2 DNN의 파라미터들, 예를 들어, 제 2 DNN의 컨 볼루션 레이어들에서 이용되는 필터 커널의 파라미터들(예를 들어, 필터 커널의 F1, F2, F3, F4, F5, F6, F7, F8 및 F9)의 값이 최적화될 수 있다. 전술한 바와 같이, AI 업스케일부는 AI 데이터에 기초하여, 제 1 DNN의 다운스케일 타겟에 대응하는 업스케일 타겟을 결정하고, 결정된 업스케일 타겟에 대응하는 파라미터들 을 제 2 DNN의 컨볼루션 레이어들에서 이용되는 필터 커널의 파라미터들로 결정할 수 있다. 제 1 DNN 및 제 2 DNN에 포함된 컨볼루션 레이어들은 도 12와 관련하여 설명한 컨볼루션 연산 과정에 따른 처리 를 할 수 있으나, 도 12에서 설명한 컨볼루션 연산 과정은 하나의 예시일 뿐이며, 이에 한정되는 것은 아니다. 다시 도 11을 참조하면, 제 1 컨볼루션 레이어에서 출력된 특징 맵들은 제 1 활성화 레이어로 입력 된다. 제 1 활성화 레이어는 각각의 특징 맵에 대해 비선형(Non-linear) 특성을 부여할 수 있다. 제 1 활 성화 레이어는 시그모이드 함수(sigmoid function), Tanh 함수, ReLU(Rectified Linear Unit) 함수 등을 포함할 수 있으나, 이에 한정되는 것은 아니다. 제 1 활성화 레이어에서 비선형 특성을 부여하는 것은, 제 1 컨볼루션 레이어의 출력인, 특징 맵의 일부 샘플 값을 변경하여 출력하는 것을 의미한다. 이때, 변경은 비선형 특성을 적용하여 수행된다. 제 1 활성화 레이어는 제 1 컨볼루션 레이어로부터 출력되는 특징 맵들의 샘플 값들을 제 2 컨볼루 션 레이어로 전달할지 여부를 결정한다. 예를 들어, 특징 맵들의 샘플 값들 중 어떤 샘플 값들은 제 1 활 성화 레이어에 의해 활성화되어 제 2 컨볼루션 레이어로 전달되고, 어떤 샘플 값들은 제 1 활성화 레이어에 의해 비활성화되어 제 2 컨볼루션 레이어로 전달되지 않는다. 특징 맵들이 나타내는 제 2 영상의 고유 특성이 제 1 활성화 레이어에 의해 강조된다. 제 1 활성화 레이어에서 출력된 특징 맵들은 제 2 컨볼루션 레이어로 입력된다. 도 11에 도 시된 특징 맵들 중 어느 하나는 도 12와 관련하여 설명한 특징 맵이 제 1 활성화 레이어에서 처리된 결과이다. 제 2 컨볼루션 레이어에 표시된 3X3X4는 3 x 3의 크기의 4개의 필터 커널을 이용하여 입력된 특징 맵들 에 대해 컨볼루션 처리하는 것을 예시한다. 제 2 컨볼루션 레이어의 출력은 제 2 활성화 레이어 로 입력된다. 제 2 활성화 레이어는 입력 데이터에 대해 비선형 특성을 부여할 수 있다. 제 2 활성화 레이어에서 출력된 특징 맵들은 제 3 컨볼루션 레이어로 입력된다. 도 3에 도시 된 제 3 컨볼루션 레이어에 표시된 3X3X1는 3 x 3의 크기의 1개의 필터 커널을 이용하여 1개의 출력 영상 을 만들기 위해 컨볼루션 처리를 하는 것을 예시한다. 제 3 컨볼루션 레이어는 최종 영상을 출력하기 위 한 레이어로서 1개의 필터 커널을 이용하여 1개의 출력을 생성한다. 본 개시의 예시에 따르면, 제 3 컨볼루션 레이어는 컨벌루션 연산 결과를 통해 제 3 영상을 출력할 수 있다. 제 2 DNN의 제 1 컨볼루션 레이어, 제 2 컨볼루션 레이어 및 제 3 컨볼루션 레이어의 필터 커널의 개수, 필터 커널의 파라미터 등을 나타내는 DNN 설정 정보는 후술하는 바와 같이 복수 개일 수 있 는데, 복수의 DNN 설정 정보는 제 1 DNN의 복수의 DNN 설정 정보와 연계되어야 한다. 제 2 DNN의 복수의 DNN 설 정 정보와 제 1 DNN의 복수의 DNN 설정 정보 사이의 연계는, 제 1 DNN 및 제 2 DNN의 연계 학습을 통해 구현될 수 있다. 도 11은 제 2 DNN이 세 개의 컨볼루션 레이어(1110, 1130, 1150)와 두 개의 활성화 레이어(1120, 1140) 를 포함하고 있는 것으로 도시하고 있으나, 이는 하나의 예시일 뿐이며, 구현예에 따라서, 컨볼루션 레이어 및 활성화 레이어의 개수는 다양하게 변경될 수 있다. 또한, 구현예에 따라서, 제 2 DNN은 RNN(recurrent neural network)을 통해 구현될 수도 있다. 이 경우는 본 개시의 예시에 따른 제 2 DNN의 CNN 구조를RNN 구조로 변경하는 것을 의미한다. 일 실시예에서, AI 업스케일부는 전술한 컨볼루션 연산 및 활성화 레이어의 연산을 위한 적어도 하나의 ALU(Arithmetic logic unit)를 포함할 수 있다. ALU는 프로세서로 구현될 수 있다. 컨볼루션 연산을 위해, ALU 는 제 2 영상 또는 이전 레이어에서 출력된 특징 맵의 샘플 값들과 필터 커널의 샘플 값들 사이의 곱 연산 을 수행하는 곱셈기 및 곱셈의 결과 값들을 더하는 가산기를 포함할 수 있다. 또한, 활성화 레이어의 연산을 위 해, ALU는 미리 결정된 시그모이드 함수, Tanh 함수 또는 ReLU 함수 등에서 이용되는 가중치를 입력된 샘플 값 에 곱하는 곱셈기, 및 곱한 결과와 소정 값을 비교하여 입력된 샘플 값을 다음 레이어로 전달할지를 판단하는 비교기를 포함할 수 있다. 이하에서, AI 업스케일부가 업스케일 타겟에 맞춰 제 2 영상을 AI 업스케일하는 방법을 설명한다. 일 실시예에서, AI 업스케일부는 제 2 DNN에 세팅 가능한 복수의 DNN 설정 정보를 저장할 수 있다. 여기서, DNN 설정 정보는 제 2 DNN에 포함되는 컨볼루션 레이어의 수, 컨볼루션 레이어별 필터 커널의 개수 및 각 필터 커널의 파라미터 중 적어도 하나에 대한 정보를 포함할 수 있다. 복수의 DNN 설정 정보는 다양한 업스 케일 타겟에 각각 대응될 수 있으며, 특정 업스케일 타겟에 대응되는 DNN 설정 정보에 기반하여 제 2 DNN이 동 작할 수 있다. DNN 설정 정보에 따라 제 2 DNN이 서로 다른 구조를 가질 수 있다. 예를 들어, 어느 DNN 설정 정 보에 따라 제 2 DNN이 3개의 컨볼루션 레이어를 포함할 수 있고, 다른 DNN 설정 정보에 따라 제 2 DNN이 4개의 컨볼루션 레이어를 포함할 수 있다. 일 실시예에서, DNN 설정 정보는 제 2 DNN에서 사용되는 필터 커널의 파라미터만을 포함할 수도 있다. 이 경우, 제 2 DNN의 구조는 변경되지 않는 대신, DNN 설정 정보에 따라 내부의 필터 커널의 파라미터만이 달라질 수 있 다. AI 업스케일부는 복수의 DNN 설정 정보 중 제 2 영상의 AI 업스케일을 위한 DNN 설정 정보를 획득할 수 있다. 여기서 사용되는 복수의 DNN 설정 정보 각각은 미리 결정된 해상도 및/또는 미리 결정된 화질의 제 3 영상을 획득하기 위한 정보로, 제 1 DNN과 연계하여 훈련된 것이다. 예를 들어, 복수의 DNN 설정 정보 중 어느 하나의 DNN 설정 정보는 제 2 영상의 해상도보다 2배 큰 해상도 의 제 3 영상, 예를 들어, 2K (2048*1080)의 제 2 영상보다 2배 큰 4K(4096*2160)의 제 3 영상(94 5)을 획득하기 위한 정보들을 포함할 수 있고, 다른 하나의 DNN 설정 정보는 제 2 영상의 해상도보다 4배 큰 해상도의 제 3 영상, 예를 들어, 2K (2048*1080)의 제 2 영상보다 4배 큰 8K(8192*4320)의 제 3 영상을 획득하기 위한 정보들을 포함할 수 있다. 복수의 DNN 설정 정보 각각은 AI 부호화 장치의 제 1 DNN의 DNN 설정 정보와 연계되어 만들어진 것이며, AI 업스케일부는 제 1 DNN의 DNN 설정 정보의 축소 비율에 대응되는 확대 비율에 따라 복수의 DNN 설정 정보 중 하나의 DNN 설정 정보를 획득한다. 이를 위해, AI 업스케일부는 제 1 DNN의 정보를 확인하여야 한다. 제 1 DNN의 정보를 AI 업스케일부가 확인하기 위해, 일 실시예에 따른 AI 복호화 장치는 AI 부호화 장치로부터 제 1 DNN의 정보를 포함하는 AI 데이터를 수신한다. 다시 말하면, AI 업스케일부는 AI 부호화 장치로부터 수신되는 정보들을 이용하여, 제 1 영상(91 5)을 획득하기 위해 이용된 제 1 DNN의 DNN 설정 정보가 타겟하는 정보를 확인하고, 그와 연계 훈련된 제 2 DNN 의 DNN 설정 정보를 획득할 수 있는 것이다. 복수의 DNN 설정 정보 중 제 2 영상의 AI 업스케일을 위한 DNN 설정 정보가 획득되면, 획득된 DNN 설정 정 보에 따라 동작하는 제 2 DNN에 기초하여 입력 데이터가 처리될 수 있다. 예를 들어, 어느 하나의 DNN 설정 정보가 획득되면, 도 3에 도시된 제 2 DNN의 제 1 컨볼루션 레이어 , 제 2 컨볼루션 레이어 및 제 3 컨볼루션 레이어 각각에 대해서, 각 레이어에 포함되는 필 터 커널의 개수와 필터 커널의 파라미터들을, 상기 획득된 DNN 설정 정보에 포함된 값으로 설정한다. 구체적으로, 도 12에 도시된 제 2 DNN의 어느 하나의 컨볼루션 레이어에서 이용되는 3 X 3의 필터 커널의 파라 미터들이 {1, 1, 1, 1, 1, 1, 1, 1, 1}로 세팅되도록 하고, 이후 DNN 설정 정보의 변경이 있는 경우, 이를 변경 된 DNN 설정 정보에 포함된 파라미터들인 {2, 2, 2, 2, 2, 2, 2, 2, 2}로 교체할 수 있는 것이다. AI 업스케일부는 AI 데이터에 포함된 정보에 기초하여 복수의 DNN 설정 정보 중 제 2 영상을 업스케 일하기 위한 DNN 설정 정보를 획득할 수 있는데, DNN 설정 정보를 획득하는데 이용되는 AI 데이터에 대해 구체적으로 설명한다. 일 실시예에서, AI 업스케일부는 AI 데이터에 포함된 차이 정보에 기초하여, 복수의 DNN 설정 정보 중 제 2 영상을 업스케일하기 위한 DNN 설정 정보를 획득할 수 있다. 예를 들어, 차이 정보에 기초하여 원본 영 상의 해상도(예를 들어, 4K(4096*2160))가 제 1 영상의 해상도(예를 들어, 2K (2048*1080))보다 2배 큰 것으로 확인된 경우, AI 업스케일부는 제 2 영상의 해상도를 2배 증가시킬 수 있는 DNN 설정 정 보를 획득할 수 있다. 다른 실시예에서, AI 업스케일부는 AI 데이터에 포함된 제 1 영상 관련 정보에 기초하여, 복수의 DNN 설정 정보 중 제 2 영상을 AI 업스케일하기 위한 DNN 설정 정보를 획득할 수 있다. AI 업스케일부 는 영상 관련 정보들과 DNN 설정 정보들 사이의 매핑 관계를 미리 결정하고, 제 1 영상 관련 정보에 매핑된 DNN 설정 정보를 획득할 수 있다. 도 13은 여러 영상 관련 정보들과 여러 DNN 설정 정보들 사이의 매핑 관계를 나타내는 예시적인 도면이다. 도 13에 따른 실시예를 통해, 본 개시의 일 실시예의 AI 부호화/AI 복호화 과정은 해상도의 변화만을 고려하는 것이 아님을 알 수 있다. 도 5에 도시된 바와 같이, SD, HD, Full HD와 같은 해상도, 10Mbps, 15Mbps, 20Mbps 와 같은 비트레이트, 그리고 AV1, H.264, HEVC와 같은 코덱 정보를 개별적으로 또는 모두 고려하여 DNN 설정 정 보의 선택이 이루어질 수 있다. 이러한 고려를 위해서는 AI 훈련 과정에서 각각의 요소들을 고려한 훈련이 부호 화, 복호화 과정에 연계되어 이루어져야 한다(도 17 참조). 따라서, 훈련 내용에 따라서 도 13에 도시된 바와 같이, 코덱 타입, 영상의 해상도 등을 포함하는 영상 관련 정 보에 기반하여 복수의 DNN 설정 정보가 구비된 경우, AI 복호화 과정에서 전달받는 제 1 영상 관련 정보에 기반하여 제 2 영상의 AI 업스케일을 위한 DNN 설정 정보를 획득할 수 있다. 즉, AI 업스케일부는 도 13에 도시된 표의 좌측에 도시된 영상 관련 정보와 표 우측의 DNN 설정 정보를 매칭하고 있음으로써, 영상 관련 정보에 따른 DNN 설정 정보를 사용할 수 있는 것이다. 한편, 도 13에 도시되어 있지는 않으나, AI 업스케일부는 영상 관련 정보 외에 전처리 관련 정보에 따른 DNN 설정 정보를 더 포함 할 수도 있음은 물론이다. 도 13에 예시된 바와 같이, 제 1 영상 관련 정보로부터 제 1 영상의 해상도가 SD이고, 제 1 영상 의 제 1 부호화 결과 획득된 영상 데이터의 비트레이트가 10Mbps이고, 제 1 영상이 AV1 코덱으로 제 1 부호화된 것으로 확인되면, AI 업스케일부는 복수의 DNN 설정 정보 중 A DNN 설정 정보를 사용할 수 있 다. 또한, 제 1 영상 관련 정보로부터 제 1 영상의 해상도가 HD이고, 제 1 부호화 결과 획득된 영상 데이 터의 비트레이트가 15Mbps이고, 제 1 영상이 H.264 코덱으로 제 1 부호화된 것으로 확인되면, AI 업스케일 부는 복수의 DNN 설정 정보 중 B DNN 설정 정보를 사용할 수 있다. 또한, 제 1 영상 관련 정보로부터 제 1 영상의 해상도가 Full HD이고, 제 1 영상의 제 1 부호화 결과 획득된 영상 데이터의 비트레이트가 20Mbps이고, 제 1 영상이 HEVC 코덱으로 제 1 부호화된 것으로 확인되면, AI 업스케일부는 복수의 DNN 설정 정보 중 C DNN 설정 정보를 사용하고, 제 1 영상의 해 상도가 Full HD이고, 제 1 영상의 제 1 부호화 결과 획득된 영상 데이터의 비트레이트가 15Mbps이고, 제 1 영상이 HEVC 코덱으로 제 1 부호화된 것으로 확인되면, AI 업스케일부는 복수의 DNN 설정 정보 중 D DNN 설정 정보를 사용할 수 있다. 제 1 영상의 제 1 부호화 결과 획득된 영상 데이터의 비트레이트가 20Mbps인지 또는 15Mbps인지에 따라 C DNN 설정 정보와 D DNN 설정 정보 중에서 어느 하나가 선택된다. 동일 해 상도의 제 1 영상을 동일 코덱으로 제 1 부호화하였을 때, 영상 데이터의 비트레이트가 서로 상이하다는 것은, 복원되는 영상의 화질이 서로 상이하다는 것을 의미한다. 따라서, 제 1 DNN과 제 2 DNN은 소정 화질에 기 반하여 연계 훈련될 수 있으며, 이에 따라 AI 업스케일부는 제 2 영상의 화질을 나타내는, 영상 데 이터의 비트레이트에 따라 DNN 설정 정보를 획득할 수 있다. 또 다른 실시예에서, AI 업스케일부는 제 1 복호화부로부터 제공되는 정보(예측 모드 정보, 움직임 정보, 양자화 파라미터 정보 등)와 AI 데이터에 포함된 제 1 영상 관련 정보를 모두 고려하여 복수의 DNN 설정 정보 중 제 2 영상을 AI 업스케일하기 위한 DNN 설정 정보를 획득할 수도 있다. 예를 들어, AI 업스 케일부는 제 1 복호화부로부터 제 1 영상의 제 1 부호화 과정에서 이용된 양자화 파라미터 정 보를 전달받고, AI 데이터로부터 제 1 영상의 부호화 결과 획득된 영상 데이터의 비트레이트를 확인하고, 양자화 파라미터 및 비트레이트에 대응하는 DNN 설정 정보를 획득할 수도 있다. 동일한 비트레이트라도 영상의복잡도에 따라 복원 영상의 화질 정도에 차이가 있을 수 있으며, 비트레이트는 제 1 부호화되는 제 1 영상 전체를 대표하는 값으로서 제 1 영상 내에서도 각 프레임의 화질이 서로 다를 수 있다. 따라서, 제 1 복호 화부로부터 각 프레임 별로 획득할 수 있는 예측 모드 정보, 움직임 정보 및/또는 양자화 파라미터를 함 께 고려하면, AI 데이터만 이용하는 것에 비해 제 2 영상에 보다 적합한 DNN 설정 정보를 획득할 수 있다. 또한, 구현예에 따라, AI 데이터는 상호 약속된 DNN 설정 정보의 식별자를 포함할 수 있다. DNN 설정 정보의 식 별자는, 제 1 DNN의 다운스케일 타겟에 대응하는 업스케일 타겟으로, 제 2 영상을 AI 업스케일할 수 있도 록, 제 1 DNN과 제 2 DNN 간 연계 훈련된 DNN 설정 정보의 쌍을 구분하기 위한 정보이다. AI 업스케일부 는 AI 데이터에 포함된 DNN 설정 정보의 식별자를 획득한 후, DNN 설정 정보의 식별자에 대응하는 DNN 설정 정 보를 사용하여 제 2 영상을 AI 업스케일할 수 있다. 예를 들어, 제 1 DNN에 설정 가능한 복수의 DNN 설정 정보 각각을 가리키는 식별자와 제 2 DNN에 설정 가능한 복수의 DNN 설정 정보 각각을 가리키는 식별자가 미리 지정되어 있을 수 있다. 이 경우, 제 1 DNN 및 제 2 DNN 각각에 설정 가능한 DNN 설정 정보의 쌍에 대해 동일한 식별자가 지정될 수 있다. AI 데이터는 원본 영상의 AI 다운스케일을 위해 제 1 DNN에 설정된 DNN 설정 정 보의 식별자를 포함할 수 있다. AI 데이터를 수신한 AI 업스케일부는 복수의 DNN 설정 정보 중 AI 데이터 에 포함된 식별자가 가리키는 DNN 설정 정보를 이용하여 제 2 영상을 AI 업스케일할 수 있다. 또한, 구현예에 따라, AI 데이터는 DNN 설정 정보를 포함할 수도 있다. AI 업스케일부는 AI 데이터에 포 함된 DNN 설정 정보를 획득한 후, 해당 DNN 설정 정보를 사용하여 제 2 영상을 AI 업스케일할 수도 있다. 구현예에 따라, DNN 설정 정보를 구성하는 정보들(예를 들어, 컨볼루션 레이어의 수, 컨볼루션 레이어별 필터 커널의 개수, 각 필터 커널의 파라미터 등)들이 룩업 테이블 형태로 저장되어 있는 경우, AI 업스케일부 는 AI 데이터에 포함된 정보에 기초하여 룩업 테이블 값들 중에서 선택된 일부를 조합하여 DNN 설정 정보를 획 득하고, 획득된 DNN 설정 정보를 사용하여 제 2 영상을 AI 업스케일할 수도 있다. 구현예에 따라, AI 업스케일부는 업스케일 타겟에 대응되는 DNN의 구조가 결정되면, 결정된 DNN의 구조에 대응하는 DNN 설정 정보, 예를 들어, 필터 커널의 파라미터들을 획득할 수도 있다. AI 업스케일부는 제 1 DNN과 관련된 정보를 포함하는 AI 데이터를 통해 제 2 DNN의 DNN 설정 정보를 획득 하고, 획득된 DNN 설정 정보로 세팅된 제 2 DNN을 통해 제 2 영상을 AI 업스케일하는 데, 이는, 제 2 영상 의 특징을 직접 분석하여 업스케일하는 것과 비교하여 메모리 사용량과 연산량이 감소될 수 있다. 일 실시예에서, 제 2 영상이 복수의 프레임으로 구성된 경우, AI 업스케일부는 소정 개수의 프레임 별로 DNN 설정 정보를 독립적으로 획득할 수 있고, 또는, 전체 프레임에 대해 공통된 DNN 설정 정보를 획득할 수도 있다. 도 14는 복수의 프레임으로 구성된 제 2 영상을 도시하는 도면이다. 도 14에 도시된 바와 같이, 제 2 영상은 t0 내지 tn에 대응하는 프레임들로 이루어질 수 있다. 일 예시에서, AI 업스케일부는 AI 데이터를 통해 제 2 DNN의 DNN 설정 정보를 획득하고, 획득한 DNN 설정 정보에 기초하여 t0 내지 tn에 대응하는 프레임들을 AI 업스케일할 수 있다. 즉, t0 내지 tn에 대응하는 프레임 들이 공통된 DNN 설정 정보에 기초하여 AI 업스케일될 수 있다. 다른 예시에서, AI 업스케일부는 t0 내지 tn에 대응하는 프레임들 중 일부의 프레임들, 예를 들어, t0 내 지 ta에 대응하는 프레임들을 AI 데이터로부터 획득한 'A' DNN 설정 정보로 AI 업스케일하고, ta+1 내지 tb에 대응하는 프레임들을 AI 데이터로부터 획득한 'B' DNN 설정 정보로 AI 업스케일할 수 있다. 또한, AI 업스케일 부는 tb+1 내지 tn에 대응하는 프레임들을 AI 데이터로부터 획득한 'C' DNN 설정 정보로 AI 업스케일할 수 있다. 다시 말하면, AI 업스케일부는 복수의 프레임들 중 소정 개수의 프레임을 포함하는 그룹마다 DNN 설정 정보를 독립적으로 획득하고, 그룹 각각에 포함된 프레임들을 독립적으로 획득한 DNN 설정 정보로 AI 업스케일할 수 있다. 또 다른 예시에서, AI 업스케일부는 제 2 영상을 구성하는 프레임별로 DNN 설정 정보를 독립적으로 획득할 수도 있다. 즉, 제 2 영상이 3개의 프레임으로 구성되어 있는 경우, AI 업스케일부는 첫 번 째 프레임과 관련하여 획득한 DNN 설정 정보로 첫 번째 프레임을 AI 업스케일하고, 두 번째 프레임과 관련하여 획득한 DNN 설정 정보로 두 번째 프레임을 AI 업스케일하고, 세 번째 프레임과 관련하여 획득한 DNN 설정 정보 로 세 번째 프레임을 AI 업스케일할 수 있다. 전술한, 제 1 복호화부로부터 제공되는 정보(예측 모드 정 보, 움직임 정보, 양자화 파라미터 정보 등)와 AI 데이터에 포함된 제 1 영상 관련 정보에 기초하여 DNN설정 정보가 획득되는 방식에 따라, 제 2 영상을 구성하는 프레임별로 DNN 설정 정보가 독립적으로 획득될 수 있다. 왜냐하면, 모드 정보, 양자화 파라미터 정보 등은 제 2 영상을 구성하는 프레임마다 독립적으로 결정될 수 있기 때문이다. 또 다른 예시에서, AI 데이터는 AI 데이터에 기초하여 획득되는 DNN 설정 정보가 어느 프레임까지 유효한 것인 지를 나타내는 정보를 포함할 수 있다. 예를 들어, AI 데이터 내에 DNN 설정 정보가 ta 프레임까지 유효하다는 정보가 포함되어 있는 경우, AI 업스케일부는 AI 데이터에 기초하여 획득한 DNN 설정 정보로 t0 내지 ta 프레임들을 AI 업스케일한다. 그리고, 다른 AI 데이터 내에 DNN의 설정 정보가 tn 프레임까지 유효하다는 정보 가 포함되어 있는 경우, AI 업스케일부는 상기 다른 AI 데이터에 기초하여 획득한 DNN 설정 정보로 ta+1 내지 tn 프레임들을 AI 업스케일할 수 있다. 이하에서는, 도 15를 참조하여, 원본 영상의 AI 부호화를 위한 AI 부호화 장치에 대해 설명한다. 도 15는 일 실시예에 따른 AI 부호화 장치의 구성을 도시하는 블록도이다. 도 15를 참조하면, AI 부호화 장치는 AI 부호화부 및 전송부를 포함할 수 있다. AI 부호화부 는 AI 다운스케일부 및 제 1 부호화부를 포함할 수 있다. 전송부는 데이터 처리부 및 통신부를 포함할 수 있다. 여기서, AI 부호화 장치는 송신 장치를 의미할 수 있다. 도 15는 AI 부호화부 및 전송부를 개별적인 장치로 도시하고 있으나, AI 부호화부 및 전송부 는 하나의 프로세서를 통해 구현될 수 있다. 이 경우, 전용 프로세서로 구현될 수도 있고, AP 또는 CPU, GPU와 같은 범용 프로세서와 S/W의 조합을 통해 구현될 수도 있다. 또한, 전용 프로세서의 경우, 본 개시의 실 시예를 구현하기 위한 메모리를 포함하여 구현되거나, 외부 메모리를 이용하기 위한 메모리 처리부를 포함하여 구현될 수 있다. 또한, AI 부호화부 및 전송부는 복수의 프로세서로 구성될 수도 있다. 이 경우, 전용 프로세서들의 조합으로 구현될 수도 있고, AP 또는 CPU, GPU와 같은 다수의 범용 프로세서들과 S/W의 조합을 통해 구현될 수 도 있다. AI 다운스케일부와 제 1 부호화부도 각각 서로 다른 프로세서로 구현될 수 있다. AI 부호화부는 원본 영상의 AI 다운스케일 및 제 1 영상의 제 1 부호화를 수행하고, AI 데이터 및 영상 데이터를 전송부로 전달한다. 전송부는 AI 데이터 및 영상 데이터를 AI 복호화 장치 로 전송한다. 영상 데이터는 제 1 영상의 제 1 부호화 결과 획득된 데이터를 포함한다. 영상 데이터는 제 1 영상 내 픽셀 값들에 기초하여 획득되는 데이터, 예를 들어, 제 1 영상과 제 1 영상의 예측 데이터 사이의 차이인 잔차 데이터를 포함할 수 있다. 또한, 영상 데이터는 제 1 영상의 제 1 부호화 과정에서 이용된 정 보들을 포함한다. 예를 들어, 영상 데이터는 제 1 영상을 제 1 부호화하는데 이용된 예측 모드 정보, 움직 임 정보 및 제 1 영상을 제 1 부호화하는데 이용된 양자화 파라미터 관련 정보 등을 포함할 수 있다. AI 데이터는, AI 업스케일부가 제 1 DNN의 다운스케일 타겟에 대응하는 업스케일 타겟으로 제 2 영상 을 AI 업스케일할 수 있게 하는 정보들을 포함한다. 일 예에서, AI 데이터는 원본 영상과 제 1 영상 사이의 차이 정보를 포함할 수 있다. 또한, AI 데이터는 제 1 영상 관련 정보를 포함할 수도 있다. 제 1 영상 관련 정보는, 제 1 영상의 해상도, 제 1 영상의 제 1 부호화 결과 획득된 영상 데이 터의 비트레이트 및 제 1 영상의 제 1 부호화시 이용된 코덱 타입 중 적어도 하나에 대한 정보를 포함할 수 있다. 일 실시예에서, AI 데이터는, 제 1 DNN의 다운스케일 타겟에 대응하는 업스케일 타겟으로 제 2 영상이 AI 업스케일될 수 있도록, 상호 약속된 DNN 설정 정보의 식별자를 포함할 수 있다. 또한, 일 실시예에서, AI 데이터는 제 2 DNN에 세팅 가능한 DNN 설정 정보를 포함할 수도 있다. AI 다운스케일부는 제 1 DNN을 통해 원본 영상으로부터 AI 다운스케일된 제 1 영상을 획득할 수 있다. AI 다운스케일부는 미리 결정된 기준에 기초하여 원본 영상의 다운스케일 타겟을 결정할 수 있다. 여기서, AI 다운스케일부는 영상을 다운스케일링하도록 학습된 제2 인공 지능 모델을 의미할 수 있다. 다운스케일 타겟에 부합하는 제 1 영상의 획득을 위해, AI 다운스케일부는 제 1 DNN에 세팅 가능한 복수의 DNN 설정 정보를 저장할 수 있다. AI 다운스케일부는 복수의 DNN 설정 정보 중 다운스케일 타겟에대응하는 DNN 설정 정보를 획득하고, 획득된 DNN 설정 정보로 세팅된 제 1 DNN을 통해 원본 영상을 AI 다 운스케일한다. 상기 복수의 DNN 설정 정보 각각은 미리 결정된 해상도 및/또는 미리 결정된 화질의 제 1 영상을 획득하기 위해 훈련된 것일 수 있다. 예를 들어, 복수의 DNN 설정 정보 중 어느 하나의 DNN 설정 정보는 원본 영상 의 해상도보다 1/2배만큼 작은 해상도의 제 1 영상, 예를 들어, 4K(4096*2160)의 원본 영상보다 1/2 배 작은 2K (2048*1080)의 제 1 영상을 획득하기 위한 정보들을 포함할 수 있고, 다른 하나의 DNN 설정 정 보는 원본 영상의 해상도보다 1/4배만큼 작은 해상도의 제 1 영상, 예를 들어, 8K(8192*4320)의 원본 영상보다 1/4배 작은 2K (2048*1080)의 제 1 영상을 획득하기 위한 정보들을 포함할 수 있다. 구현예에 따라, DNN 설정 정보를 구성하는 정보들(예를 들어, 컨볼루션 레이어의 수, 컨볼루션 레이어별 필터 커널의 개수, 각 필터 커널의 파라미터 등)들이 룩업 테이블 형태로 저장되어 있는 경우, AI 다운스케일부 는 다운스케일 타겟에 따라 룩업 테이블 값들 중에서 선택된 일부를 조합하여 DNN 설정 정보를 획득하고, 획득된 DNN 설정 정보를 사용하여 원본 영상을 AI 다운스케일할 수도 있다. 구현예에 따라, AI 다운스케일부는 다운스케일 타겟에 대응되는 DNN의 구조를 결정하고, 결정된 DNN의 구 조에 대응하는 DNN 설정 정보, 예를 들어, 필터 커널의 파라미터들을 획득할 수도 있다. 원본 영상의 AI 다운스케일을 위한 복수의 DNN 설정 정보는, 제 1 DNN과 제 2 DNN이 연계 훈련됨으로써, 최적화된 값을 가질 수 있다. 여기서, 각 DNN 설정 정보는 제 1 DNN에 포함되는 컨볼루션 레이어의 수, 컨볼루 션 레이어별 필터 커널의 개수 및 각 필터 커널의 파라미터 중 적어도 하나를 포함한다. AI 다운스케일부는 원본 영상의 AI 다운스케일을 위해 결정된 DNN 설정 정보로 제 1 DNN을 세팅하여, 소정 해상도 및/또는 소정 화질의 제 1 영상을 제 1 DNN을 통해 획득할 수 있다. 복수의 DNN 설 정 정보 중 원본 영상의 AI 다운스케일을 위한 DNN 설정 정보가 획득되면, 제 1 DNN 내 각 레이어는 DNN 설정 정보에 포함된 정보들에 기초하여 입력된 데이터를 처리할 수 있다. 이하에서는, AI 다운스케일부가 다운스케일 타겟을 결정하는 방법에 대해 설명한다. 상기 다운스케일 타 겟은 예를 들어, 원본 영상으로부터 얼마나 해상도가 감소한 제 1 영상을 획득해야 하는지를 나타낼 수 있다. 일 실시예에서, AI 다운스케일부는 압축률(예를 들어, 원본 영상과 제 1 영상 사이의 해상도 차이, 타겟 비트레이트), 압축 품질(예를 들어, 비트레이트 타입), 압축 히스토리 정보 및 원본 영상의 타 입 중 적어도 하나에 기초하여 다운스케일 타겟을 결정할 수 있다. 일 예에서, AI 다운스케일부는 미리 설정되거나, 사용자로부터 입력받은 압축률 또는 압축 품질 등에 기 반하여 다운스케일 타겟을 결정할 수 있다. 다른 예로, AI 다운스케일부는 AI 부호화 장치에 저장된 압축 히스토리 정보를 이용하여 다운스케 일 타겟을 결정할 수도 있다. 예를 들어, AI 부호화 장치가 이용할 수 있는 압축 히스토리 정보에 따르면, 사용자가 선호하는 부호화 품질 또는 압축률 등이 결정될 수 있으며, 압축 히스토리 정보에 기초하여 결정된 부호화 품질 등에 따라 다운스케일 타겟이 결정될 수 있다. 예를 들면, 압축 히스토리 정보에 따라 가장 많이 이용된 적이 있는 부호화 품질에 따라 제 1 영상의 해상도, 화질 등이 결정될 수 있다. 또 다른 예로, AI 다운스케일부는 압축 히스토리 정보에 따라 소정의 임계 값보다 많이 이용된 적이 있는 부호화 품질(예를 들면, 소정의 임계값보다 많이 이용된 적이 있는 부호화 품질의 평균 품질)에 기초하여 다운 스케일 타겟을 결정할 수도 있다. 또 다른 예로, AI 다운스케일부는 원본 영상의 해상도, 타입(예를 들어, 파일의 형식)등에 기초하여 다운스케일 타겟을 결정할 수도 있다. 일 실시예에서, 원본 영상이 복수의 프레임으로 구성된 경우, AI 다운스케일부는 소정 개수의 프레 임 별로 다운스케일 타겟을 독립적으로 결정할 수 있고, 또는, 전체 프레임에 대해 공통된 다운스케일 타겟을 결정할 수도 있다. 일 예시에서, AI 다운스케일부는 원본 영상을 구성하는 프레임들을 소정 개수의 그룹으로 구분하고, 각 그룹별로 다운스케일 타겟을 독립적으로 결정할 수 있다. 각 그룹에 대해 서로 동일하거나 서로 상이한 다운 스케일 타겟이 결정될 수 있다. 그룹들에 포함된 프레임들의 개수는 그룹별로 동일하거나 상이할 수 있다.다른 예시에서, AI 다운스케일부는 원본 영상을 구성하는 프레임별로 다운스케일 타겟을 독립적으로 결정할 수 있다. 각각의 프레임에 대해 서로 동일하거나 서로 상이한 다운스케일 타겟이 결정될 수 있다. 이하에서는, AI 다운스케일의 기반이 되는 제 1 DNN의 예시적인 구조에 대해 설명한다. 도 16은 원본 영상의 AI 다운스케일을 위한 제 1 DNN을 나타내는 예시적인 도면이다. 도 16에 도시된 바와 같이, 원본 영상은 제 1 컨볼루션 레이어로 입력된다. 제 1 컨볼루션 레이어 는 5 x 5의 크기의 32개의 필터 커널을 이용하여 원본 영상에 대해 컨볼루션 처리를 한다. 컨볼루션 처리 결과 생성된 32개의 특징 맵은 제 1 활성화 레이어로 입력된다. 제 1 활성화 레이어는 32개의 특징 맵에 대해 비선형(Non-linear) 특성을 부여할 수 있다. 제 1 활성화 레이어는 제 1 컨볼루션 레이어로부터 출력되는 특징 맵들의 샘플 값들을 제 2 컨볼루 션 레이어로 전달할지 여부를 결정한다. 예를 들어, 특징 맵들의 샘플 값들 중 어떤 샘플 값들은 제 1 활 성화 레이어에 의해 활성화되어 제 2 컨볼루션 레이어로 전달되고, 어떤 샘플 값들은 제 1 활성화 레이어에 의해 비활성화되어 제 2 컨볼루션 레이어로 전달되지 않는다. 제 1 컨볼루션 레이어 로부터 출력되는 특징 맵들이 나타내는 정보가 제 1 활성화 레이어에 의해 강조된다. 제 1 활성화 레이어의 출력이 제 2 컨볼루션 레이어로 입력된다. 제 2 컨볼루션 레이어 는 5 x 5의 크기의 32개의 필터 커널을 이용하여 입력 데이터에 대해 컨볼루션 처리를 한다. 컨볼루션 처 리 결과 출력된 32개의 특징 맵은 제 2 활성화 레이어로 입력되고, 제 2 활성화 레이어는 32개의 특징 맵에 대해 비선형 특성을 부여할 수 있다. 제 2 활성화 레이어의 출력은 제 3 컨볼루션 레이어로 입력된다. 제 3 컨볼루션 레이어 는 5 x 5의 크기의 1개의 필터 커널을 이용하여 입력된 데이터에 대해 컨볼루션 처리를 한다. 컨볼루션 처리 결과 제 3 컨볼루션 레이어로부터 1개의 영상이 출력될 수 있다. 제 3 컨볼루션 레이어는 최 종 영상을 출력하기 위한 레이어로서 1개의 필터 커널을 이용하여 1개의 출력을 획득한다. 본 개시의 예시에 따 르면, 제 3 컨볼루션 레이어는 컨벌루션 연산 결과를 통해 제 1 영상을 출력할 수 있다. 제 1 DNN의 제 1 컨볼루션 레이어, 제 2 컨볼루션 레이어 및 제 3 컨볼루션 레이어의 필터 커널의 개수, 필터 커널의 파라미터 등을 나타내는 DNN 설정 정보는 복수 개일 수 있는데, 복수의 DNN 설 정 정보는 제 2 DNN의 복수의 DNN 설정 정보와 연계되어야 한다. 제 1 DNN의 복수의 DNN 설정 정보와 제 2 DNN 의 복수의 DNN 설정 정보 사이의 연계는, 제 1 DNN 및 제 2 DNN의 연계 학습을 통해 구현될 수 있다. 도 16은 제 1 DNN이 세 개의 컨볼루션 레이어(1610, 730, 750)와 두 개의 활성화 레이어(1620, 1640)를 포함하고 있는 것으로 도시하고 있으나, 이는 하나의 예시일 뿐이며, 구현예에 따라서, 컨볼루션 레이어 및 활 성화 레이어의 개수는 다양하게 변경될 수 있다. 또한, 구현예에 따라서, 제 1 DNN은 RNN(recurrent neural network)을 통해 구현될 수도 있다. 이 경우는 본 개시의 예시에 따른 제 1 DNN의 CNN 구조를 RNN 구조로 변경하는 것을 의미한다. 일 실시예에서, AI 다운스케일부는 컨볼루션 연산 및 활성화 레이어의 연산을 위한 적어도 하나의 ALU를 포함할 수 있다. ALU는 프로세서로 구현될 수 있다. 컨볼루션 연산을 위해, ALU는 원본 영상 또는 이전 레 이어에서 출력된 특징 맵의 샘플 값들과 필터 커널의 샘플 값들 사이의 곱 연산을 수행하는 곱셈기 및 곱셈의 결과 값들을 더하는 가산기를 포함할 수 있다. 또한, 활성화 레이어의 연산을 위해, ALU는 미리 결정된 시그모 이드 함수, Tanh 함수 또는 ReLU 함수 등에서 이용되는 가중치를 입력된 샘플 값에 곱하는 곱셈기, 및 곱한 결 과와 소정 값을 비교하여 입력된 샘플 값을 다음 레이어로 전달할지를 판단하는 비교기를 포함할 수 있다. 다시 도 15를 참조하면, AI 다운스케일부로부터 제 1 영상을 전달받은 제 1 부호화부는 제 1 영상을 제 1 부호화하여 제 1 영상이 가지는 정보량을 감축시킬 수 있다. 제 1 부호화부에 의 한 제 1 부호화 결과 제 1 영상에 대응하는 영상 데이터가 획득될 수 있다. 데이터 처리부는 AI 데이터 및 영상 데이터 중 적어도 하나가 소정의 형태로 전송될 수 있게 처리한다. 예를 들어, AI 데이터 및 영상 데이터를 비트스트림 형태로 전송하여야 하는 경우, 데이터 처리부는 AI 데이터가 비트스트림 형태로 표현되도록 AI 데이터를 처리하고, 통신부를 통해 하나의 비트스트림 형태의 AI 데이터 및 영상 데이터를 전송한다. 다른 예로, 데이터 처리부는 AI 데이터가 비트스트림 형태로 표현 되도록 AI 데이터를 처리하고, 통신부를 통해 AI 데이터에 해당하는 비트스트림 및 영상 데이터에 해당하 는 비트스트림 각각을 통신부를 통해 전송한다. 또 다른 예로, 데이터 처리부는 AI 데이터가 프레임 또는 패킷으로 표현되도록 AI 데이터를 처리하고, 비트스트림 형태의 영상 데이터와, 프레임 또는 패킷 형태 의 AI 데이터를 통신부를 통해 전송한다. 여기서, 통신부는 송신 장치에 마련된 통신 인터페 이스를 의미할 수 있다. 전송부는 네트워크를 통해 AI 부호화 결과 획득된 AI 부호화 데이터를 전송한다. AI 부호화 결과 획득된 AI 부호화 데이터는 영상 데이터와 AI 데이터를 포함한다. 영상 데이터와 AI 데이터는 동종 네트워크 또는 이종 네트워크를 통해 전송될 수 있다. 일 실시예에서, 데이터 처리부의 처리 결과 획득된 AI 부호화 데이터는 하드 디스크, 플로피 디스크 및 자기 테이프와 같은 자기 매체, CD-ROM 및 DVD와 같은 광기록 매체, 플롭티컬 디스크(floptical disk)와 같은 자기-광 매체(magneto-optical medium) 등을 포함하는 데이터 저장 매체에 저장될 수도 있다. 한편, 도 15 및 도 16에 도시되어 있지 않으나, 본 개시의 일 실시 예에 따른 AI 부호화 장치는 제1 영상 에 전처리를 수행하기 위해 전처리 관련 정보를 획득할 수 있다. 구체적으로, AI 부호화 장치는 필 터 결정부(미도시)를 더 포함하고, 필터 결정부는 인공 지능 모델로 구현될 수 있다. 여기서, 필터 결정부에 포 함된 인공 지능 모델은 상술한 제3 인공 지능 모델을 의미할 수 있다. 필터 결정부는 제1 DNN으로부터 특성 맵을 획득하고, 특성 맵에 대응되는 전처리 관련 정보를 식별할 수 있다. 다른 예로, 필터 결정부는 제1 DNN으로부터 획득한 특성 맵 및 통신부가 연결된 네트워크 상 태 정보에 기초하여 제1 영상에 적용하기 위한 전처리 필터 관련 정보를 식별할 수 있다. 여기서, 전처리 필터 관련 정보는 필터의 타입 또는 강도 중 적어도 하나를 포함할 수 있다. 이하에서는, 도 17를 참조하여, 제 1 DNN과 제 2 DNN을 연계 훈련시키는 방법에 대해 설명한다. 도 17은 제 1 DNN 및 제 2 DNN을 훈련시키는 방법을 설명하기 위한 도면이다. 일 실시예에서 AI 부호화 과정을 통해 AI 부호화된 원본 영상이 AI 복호화 과정을 통해 제 3 영상으 로 복원되는데, AI 복호화 결과 획득된 제 3 영상과 원본 영상과의 유사성을 유지하기 위해서는 AI 부호화 과정 및 AI 복호화 과정에 연관성이 필요하다. 즉, AI 부호화 과정에서 손실된 정보를 AI 복호화 과정에 서 복원할 수 있어야 하는데, 이를 위해 제 1 DNN과 제 2 DNN의 연계 훈련이 요구된다. 정확한 AI 복호화를 위해서는 궁극적으로 도 17에 도시된 제 3 훈련 영상과 원본 훈련 영상 사이의 비교 결과에 대응하는 퀄리티 손실 정보를 감소시킬 필요가 있다. 따라서, 퀄리티 손실 정보는 제 1 DNN 및 제 2 DNN의 훈련 모두에 이용된다. 먼저, 도 17에 도시된 훈련 과정에 대해 설명한다. 도 17에서, 원본 훈련 영상(original training image)은 AI 다운스케일의 대상이 되는 영상이고, 제 1 훈련 영상(first training image)은 원본 훈련 영상로부터 AI 다운스케일된 영상이다. 또한, 제 3 훈련 영상(third training image)은 제 1 훈련 영상으로부터 AI 업스케일된 영상이다. 원본 훈련 영상은 정지 영상 또는 복수의 프레임으로 이루어진 동영상을 포함한다. 일 실시예에서, 원본 훈련 영상은 정지 영상 또는 복수의 프레임으로 이루어진 동영상으로부터 추출된 휘도 영상을 포함할 수 도 있다. 또한, 일 실시예에서, 원본 훈련 영상은 정지 영상 또는 복수의 프레임으로 이루어진 동영상에 서 추출된 패치 영상을 포함할 수도 있다. 원본 훈련 영상이 복수의 프레임으로 이루어진 경우, 제 1 훈 련 영상, 제 2 훈련 영상 및 제 3 훈련 영상 역시 복수의 프레임으로 구성된다. 원본 훈련 영상 의 복수의 프레임이 순차적으로 제 1 DNN에 입력되면, 제 1 DNN 및 제 2 DNN을 통해 제 1 훈련 영상, 제 2 훈련 영상 및 제 3 훈련 영상의 복수의 프레임이 순차적으로 획득될 수 있다. 제 1 DNN 및 제 2 DNN의 연계 훈련을 위해, 원본 훈련 영상이 제 1 DNN으로 입력된다. 제 1 DNN으로 입력된 원본 훈련 영상은 AI 다운스케일되어 제 1 훈련 영상으로 출 력되고, 제 1 훈련 영상이 제 2 DNN에 입력된다. 제 1 훈련 영상에 대한 AI 업스케일 결과 제 3 훈련 영상이 출력된다. 도 17을 참조하면, 제 2 DNN으로 제 1 훈련 영상이 입력되고 있는데, 구현예에 따라, 제 1 훈련 영 상의 제 1 부호화 및 제 1 복호화 과정을 거쳐 획득된 제 2 훈련 영상(second training image)이 제 2 DNN으로 입력될 수도 있다. 제 2 훈련 영상을 제 2 DNN으로 입력시키기 위해 MPEG-2, H.264, MPEG-4,HEVC, VC-1, VP8, VP9 및 AV1 중 어느 하나의 코덱이 이용될 수 있다. 구체적으로, 제 1 훈련 영상의 제 1 부호화 및 제 1 훈련 영상에 대응하는 영상 데이터의 제 1 복호화에, MPEG-2, H.264, MPEG-4, HEVC, VC-1, VP8, VP9 및 AV1 중 어느 하나의 코덱이 이용될 수 있다. 도 17을 참조하면, 제 1 DNN을 통해 제 1 훈련 영상이 출력되는 것과 별개로, 원본 훈련 영상 으로부터 레거시 다운스케일된 축소 훈련 영상이 획득된다. 여기서, 레거시 다운스케일은 바이리니 어(bilinear) 스케일, 바이큐빅(bicubic) 스케일, 란조스(lanczos) 스케일 및 스테어 스탭(stair step) 스케일 중 적어도 하나를 포함할 수 있다. 원본 영상의 구조적 특징을 기준으로 제 1 영상의 구조적 특징이 크게 벗어나는 것을 방지하기 위해, 원본 훈련 영상의 구조적 특징을 보존하는 축소 훈련 영상을 획득하는 것이다. 훈련의 진행 전 제 1 DNN 및 제 2 DNN은 미리 결정된 DNN 설정 정보로 세팅될 수 있다. 훈련이 진 행됨에 따라 구조적 손실 정보, 복잡성 손실 정보 및 퀄리티 손실 정보가 결정될 수 있다. 구조적 손실 정보는 축소 훈련 영상과 제 1 훈련 영상의 비교 결과에 기초하여 결정될 수 있 다. 일 예에서, 구조적 손실 정보는 축소 훈련 영상의 구조적 정보와 제 1 훈련 영상의 구조 적 정보 사이의 차이에 해당할 수 있다. 구조적 정보는, 영상의 휘도, 대비, 히스토그램 등 영상으로부터 추출 가능한 다양한 특징을 포함할 수 있다. 구조적 손실 정보는 원본 훈련 영상의 구조적 정보가 제 1 훈련 영상에서 어느 정도로 유지되고 있는지를 나타낸다. 구조적 손실 정보가 작을수록 제 1 훈련 영상의 구조적 정보가 원본 훈련 영상의 구조적 정보와 유사해진다. 복잡성 손실 정보는 제 1 훈련 영상의 공간적 복잡도에 기반하여 결정될 수 있다. 일 예에서, 공간 적 복잡도로서, 제 1 훈련 영상의 총 분산(total variance)값이 이용될 수 있다. 복잡성 손실 정보(172 0)는 제 1 훈련 영상을 제 1 부호화하여 획득한 영상 데이터의 비트레이트와 관련된다. 복잡성 손실 정보 가 작을수록 영상 데이터의 비트레이트가 작은 것으로 정의된다. 퀄리티 손실 정보는 원본 훈련 영상과 제 3 훈련 영상의 비교 결과에 기초하여 결정될 수 있 다. 퀄리티 손실 정보는 원본 훈련 영상과 제 3 훈련 영상의 차이에 대한 L1-norm 값, L2- norm 값, SSIM(Structural Similarity) 값, PSNR-HVS(Peak Signal-To-Noise Ratio-Human Vision System) 값, MS-SSIM(Multiscale SSIM) 값, VIF(Variance Inflation Factor) 값 및 VMAF(Video Multimethod Assessment Fusion) 값 중 적어도 하나를 포함할 수 있다. 퀄리티 손실 정보는 제 3 훈련 영상이 원본 훈련 영 상과 어느 정도로 유사한지를 나타낸다. 퀄리티 손실 정보가 작을수록 제 3 훈련 영상이 원 본 훈련 영상에 더 유사해진다. 도 17을 참조하면, 구조적 손실 정보, 복잡성 손실 정보 및 퀄리티 손실 정보가 제 1 DNN의 훈련에 이용되고, 퀄리티 손실 정보는 제 2 DNN의 훈련에 이용된다. 즉, 퀄리티 손실 정보는 제 1 DNN 및 제 2 DNN의 훈련에 모두 이용된다. 제 1 DNN은 구조적 손실 정보, 복잡성 손실 정보 및 퀄리티 손실 정보에 기초하여 결 정된 최종 손실 정보가 감소 또는 최소화되도록 파라미터를 갱신할 수 있다. 또한, 제 2 DNN은 퀄리티 손 실 정보가 감소 또는 최소화되도록 파라미터를 갱신할 수 있다. 제 1 DNN 및 제 2 DNN의 훈련을 위한 최종 손실 정보는 아래의 수학식2와 같이 결정될 수 있다. [수학식 2] LossDS = a*구조적 손실 정보 + b*복잡성 손실 정보 + c*퀄리티 손실 정보 LossUS = d*퀄리티 손실 정보 상기 수학식 2에서, LossDS는 제 1 DNN의 훈련을 위해 감소 또는 최소화되어야 할 최종 손실 정보를 나타 내고, LossUS는 제 2 DNN의 훈련을 위해 감소 또는 최소화되어야 할 최종 손실 정보를 나타낸다. 또한, a, b, c, d는 미리 결정된 소정의 가중치에 해당할 수 있다. 즉, 제 1 DNN은 수학식 2의 LossDS가 감소되는 방향으로 파라미터들을 갱신하고, 제 2 DNN은 LossUS가 감소되는 방향으로 파라미터들을 갱신하게 된다. 훈련 과정에서 도출된 LossDS에 따라 제 1 DNN(160 0)의 파라미터들이 갱신되면, 갱신된 파라미터에 기초하여 획득되는 제 1 훈련 영상이 이전 훈련 과정에 서의 제 1 훈련 영상과 달라지게 되고, 그에 따라 제 3 훈련 영상 역시 이전 훈련 과정에서의 제 3훈련 영상과 달라지게 된다. 제 3 훈련 영상이 이전 훈련 과정에서의 제 3 훈련 영상과 달라 지게 되면, 퀄리티 손실 정보 역시 새롭게 결정되며, 그에 따라 제 2 DNN은 파라미터들을 갱신한다. 퀄리티 손실 정보가 새롭게 결정되면, LossDS 역시 새롭게 결정되므로, 제 1 DNN은 새롭 게 결정된 LossDS에 따라 파라미터들을 갱신한다. 즉, 제 1 DNN의 파라미터 갱신은, 제 2 DNN의 파 라미터 갱신을 야기하고, 제 2 DNN의 파라미터 갱신은 제 1 DNN의 파라미터 갱신을 야기하는 것이다. 다시 말하면, 제 1 DNN 및 제 2 DNN은 퀄리티 손실 정보의 공유를 통해 연계 훈련되므로, 제 1 DNN의 파라미터들과 제 2 DNN의 파라미터들이 서로 연관성을 가지고 최적화될 수 있는 것이다. 수학식 2를 참조하면, LossUS가 퀄리티 손실 정보에 따라 결정되는 것을 알 수 있으나, 이는 하나의 예시 이며, LossUS는 구조적 손실 정보 및 복잡성 손실 정보 중 적어도 하나와, 퀄리티 손실 정보(173 0)에 기초하여 결정될 수도 있다. 앞서, AI 복호화 장치의 AI 업스케일부 및 AI 부호화 장치의 AI 다운스케일부는 복수의 DNN 설정 정보를 저장하는 것으로 설명하였는데, AI 업스케일부 및 AI 다운스케일부에 저장되는 복 수의 DNN 설정 정보 각각을 훈련시키는 방법에 대해 설명한다. 수학식 2와 관련하여 설명한 바와 같이, 제 1 DNN의 경우, 제 1 훈련 영상의 구조적 정보와 원본 훈련 영상의 구조적 정보 사이의 유사 정도(구조적 손실 정보), 제 1 훈련 영상의 제 1 부호 화 결과 획득되는 영상 데이터의 비트레이트(복잡성 손실 정보) 및 제 3 훈련 영상과 원본 훈련 영 상 사이의 차이(퀄리티 손실 정보)를 고려하여 파라미터를 갱신하게 된다. 자세히 설명하면, 원본 훈련 영상의 구조적 정보와 유사하면서, 제 1 부호화를 하였을 때 획득되는 영상 데이터의 비트레이트가 작은 제 1 훈련 영상이 획득 가능하도록 하는 동시에, 제 1 훈련 영상을 AI 업스케일하는 제 2 DNN이 원본 훈련 영상에 유사한 제 3 훈련 영상을 획득할 수 있도록, 제 1 DNN의 파라미터가 갱신될 수 있다. 수학식 2의 a, b, c의 가중치가 조절됨으로써, 제 1 DNN의 파라미터들이 최적화되는 방향이 상이해지게 된다. 예를 들어, b의 가중치를 높게 결정하는 경우, 제 3 훈련 영상의 퀄리티보다 비트레이트가 낮아지 는 것에 더 중요도를 두고 제 1 DNN의 파라미터가 갱신될 수 있다. 또한, c의 가중치를 높게 결정하는 경 우, 비트레이트가 높아지는 것이나, 원본 훈련 영상의 구조적 정보가 유지되는 것보다 제 3 훈련 영상 의 퀄리티가 증가하도록 하는 것에 더 중요도를 두고 제 1 DNN의 파라미터가 갱신될 수 있다. 또한, 제 1 훈련 영상을 제 1 부호화하는데 이용되는 코덱의 타입에 따라 제 1 DNN의 파라미터들이 최적화되는 방향이 상이해질 수 있다. 왜냐하면, 코덱의 종류에 따라, 제 2 DNN으로 입력될 제 2 훈련 영 상이 달라질 수 있기 때문이다. 즉, 가중치 a, 가중치 b, 가중치 c 및 제 1 훈련 영상의 제 1 부호화를 위한 코덱의 종류에 기반하여 제 1 DNN의 파라미터들과 제 2 DNN의 파라미터들이 연계하여 갱신될 수 있는 것이다. 따라서, 가중치 a, 가중치 b, 가중치 c 각각을 소정의 값으로 결정하고, 코덱의 종류를 소정의 종류로 결정한 후, 제 1 DNN과 제 2 DNN을 훈련시키면, 서로 연계되어 최적화된 제 1 DNN의 파라미터들과 제 2 DNN의 파라미터들이 결정될 수 있다. 그리고, 가중치 a, 가중치 b, 가중치 c 및 코덱의 종류를 변경한 후, 제 1 DNN과 제 2 DNN을 훈련 시키면, 서로 연계되어 최적화된 제 1 DNN의 파라미터들과 제 2 DNN의 파라미터들이 결정될 수 있 다. 다시 말하면, 가중치 a, 가중치 b, 가중치 c 및 코덱의 종류 각각의 값을 변경하면서 제 1 DNN과 제 2 DNN을 훈련시키면 서로 연계되어 훈련된 복수의 DNN 설정 정보가 제 1 DNN 및 제 2 DNN에 서 결정될 수 있는 것이다. 앞서, 도 5와 관련하여 설명한 바와 같이, 제 1 DNN 및 제 2 DNN의 복수의 DNN 설정 정보들은 제 1 영상 관련 정보들에 매핑되어 있을 수 있다. 이러한 매핑 관계의 설정을 위해, 제 1 DNN에서 출력되는 제 1 훈련 영상을 특정 비트레이트에 따라 특정 코덱으로 제 1 부호화하고, 제 1 부호화 결과 획득된 비 트스트림을 제 1 복호화하여 획득한 제 2 훈련 영상을 제 2 DNN으로 입력할 수 있다. 즉, 특정 해상도의 제 1 훈련 영상이 특정 코덱에 의해 특정 비트레이트로 제 1 부호화되도록 환경을 설정한 후, 제 1 DNN 및 제 2 DNN을 훈련시킴으로써, 제 1 훈련 영상의 해상도, 제 1 훈련 영상의 제 1 부호화에 이용된 코덱의 종류 및 제 1 훈련 영상의 제 1 부호화 결과 획득된 비트스트림의 비트레이트에 매핑된 DNN 설정 정보 쌍이 결정될 수 있는 것이다. 제 1 훈련 영상의 해상도, 제 1 훈련 영상 의 제 1 부호화에 이용된 코덱의 종류 및 제 1 훈련 영상의 제 1 부호화에 따라 획득되는 비트스트림의 비트레이트를 다양하게 변경시킴으로써, 제 1 DNN 및 제 2 DNN의 복수의 DNN 설정 정보들과 제 1 영상 관련 정보들 사이의 매핑 관계가 결정될 수 있다. 도 18은 훈련 장치에 의한 제 1 DNN 및 제 2 DNN의 훈련 과정을 설명하기 위한 도면이다. 도 17과 관련하여 설명한 제 1 DNN 및 제 2 DNN의 훈련은 훈련 장치에 의해 수행될 수 있다. 훈련 장치는 제 1 DNN 및 제 2 DNN을 포함한다. 훈련 장치는 예를 들어, AI 부 호화 장치 또는 별도의 서버일 수 있다. 훈련 결과 획득된 제 2 DNN의 DNN 설정 정보들은 AI 복호화 장치에 저장된다. 도 17을 참조하면, 훈련 장치는 제 1 DNN 및 제 2 DNN의 DNN 설정 정보를 초기 세팅한다 (S1840, S1845). 이에 의해, 제 1 DNN 및 제 2 DNN은 미리 결정된 DNN 설정 정보에 따라 동작할 수 있다. DNN 설정 정보는 제 1 DNN 및 2 DNN에 포함되는 컨볼루션 레이어의 수, 컨볼루션 레이어별 필터 커널의 개수, 컨볼루션 레이어별 필터 커널의 크기 및 각 필터 커널의 파라미터 중 적어도 하나에 대한 정 보를 포함할 수 있다. 훈련 장치는 원본 훈련 영상을 제 1 DNN으로 입력한다(S1850). 원본 훈련 영상은 정 지 영상 또는 동영상을 구성하는 적어도 하나의 프레임을 포함할 수 있다. 제 1 DNN은 초기 세팅된 DNN 설정 정보에 따라 원본 훈련 영상을 처리하고, 원본 훈련 영상 으로부터 AI 다운스케일된 제 1 훈련 영상을 출력한다(S1855). 도 10은 제 1 DNN으로부터 출력된 제 1 훈련 영상이 제 2 DNN으로 바로 입력되는 것으로 도시되어 있으나, 제 1 DNN으로부터 출력된 제 1 훈련 영상이 훈련 장치에 의해 제 2 DNN으로 입력될 수 있다. 또한, 훈련 장치 는 제 1 훈련 영상을 소정의 코덱으로 제 1 부호화 및 제 1 복호화한 후, 제 2 훈련 영상을 제 2 DNN으로 입력할 수 있다. 제 2 DNN은 제 1 훈련 영상 또는 제 2 훈련 영상을 초기 세팅된 DNN 설정 정보에 따라 처리하고, 제 1 훈련 영상 또는 제 2 훈련 영상으로부터 AI 업스케일된 제 3 훈련 영상을 출력한다(S1860). 훈련 장치는 제 1 훈련 영상에 기초하여 복잡성 손실 정보를 산출한다(S1865). 훈련 장치는 축소 훈련 영상과 제 1 훈련 영상을 비교하여 구조적 손실 정보를 산출한 다(S1870). 훈련 장치는 원본 훈련 영상과 제 3 훈련 영상을 비교하여 퀄리티 손실 정보를 산출한 다(S1875). 제 1 DNN은 최종 손실 정보에 기초한 역전사(back propagation) 과정을 통해 초기 세팅된 DNN 설정 정보 를 갱신한다(S1880). 훈련 장치는 복잡성 손실 정보, 구조적 손실 정보 및 퀄리티 손실 정보 에 기초하여 제 1 DNN의 훈련을 위한 최종 손실 정보를 산출할 수 있다. 제 2 DNN은 퀄리티 손실 정보 또는 최종 손실 정보에 기초한 역전사 과정을 통해 초기 세팅된 DNN 설정 정보를 갱신한다(S1885). 훈련 장치는 퀄리티 손실 정보에 기초하여 제 2 DNN의 훈련을 위한 최종 손실 정보를 산출할 수 있다. 이후, 훈련 장치, 제 1 DNN 및 제 2 DNN은 최종 손실 정보들이 최소화될 때까지 S1850 내지 S1885 과정을 반복하면서 DNN 설정 정보를 갱신한다. 이 때, 각 반복 과정 동안 제 1 DNN 및 제 2 DNN은 이전 과정에서 갱신된 DNN 설정 정보에 따라 동작한다. 아래의 표 1은 본 개시의 일 실시예에 따라 원본 영상을 AI 부호화 및 AI 복호화한 경우와, HEVC로 원본 영상을 부호화 및 복호화한 경우의 효과를 나타낸다. [표 1]"}
{"patent_id": "10-2019-0157745", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "표 1에서 알 수 있듯이, 본 개시의 일 실시예에 따라 8K 해상도의 300개의 프레임들로 이루어진 컨텐츠들을 AI 부호화 및 AI 복호화한 경우의 주관적 화질이 HEVC로 부호화 및 복호화한 경우의 주관적 화질보다 높음에도, 비 트레이트가 50% 이상 감소한 것을 알 수 있다. 도 19는 원본 영상의 AI 다운스케일을 위한 장치 및 제 2 영상의 AI 업스케일을 위한 장치를 도시하는 예시적인 도면이다. 여기서, AI 다운스케일을 위한 장치와 AI 업스케일을 위한 장치 각각은 송신 장치와 수신 장치를 의미할 수 있다. 장치는 원본 영상을 수신하고, AI 다운스케일부 및 변환 기반 부호화부를 이용하여 영상 데이터 및 AI 데이터를 장치로 제공한다. 일 실시예에서, 영상 데이터는 도 9의 영상 데이터에 대응하고, AI 데이터는 도 9의 AI 데이터에 대응한다. 또한, 일 실시예에서, 변환 기반 부호화부는 도 15의 제 1 부호화부에 대응하고, AI 다운스케일부는 도 15의 AI 다운스케일부에 대응한다. 장치는 AI 데이터 및 영상 데이터를 수신하고, 변환 기반 복호화부 및 AI 업스케일부 를 이용하여 제 3 영상을 획득한다. 일 실시예에서, 변환 기반 복호화부는 도 10의 제 1 복호화부 에 대응하고, AI 업스케일부는 도 10의 AI 업스케일부에 대응한다. 일 실시예에서, 장치는 CPU, 메모리 및 인스트럭션들을 포함하는 컴퓨터 프로그램을 포함한다. 컴퓨터 프로 그램은 메모리에 저장된다. 일 실시예에서, CPU에 의한 컴퓨터 프로그램의 실행에 따라, 장치는 도 19와 관 련하여 설명할 기능을 수행한다. 일 실시예에서, 전용 하드웨어 칩 및/또는 CPU에 의해 도 19와 관련하여 설명 할 기능이 수행된다. 일 실시예에서, 장치는 CPU, 메모리 및 인스트럭션들을 포함하는 컴퓨터 프로그램을 포함한다. 컴퓨터 프로 그램은 메모리에 저장된다. 일 실시예에서, CPU에 의한 컴퓨터 프로그램의 실행에 따라, 장치는 도 19와 관 련하여 설명할 기능을 수행한다. 일 실시예에서, 전용 하드웨어 칩 및/또는 CPU에 의해 도 19와 관련하여 설명 할 기능이 수행된다. 도 19에서, 구성 제어부는 하나 이상의 입력 값을 수신한다. 일 실시예에서, 하나 이상의 입력 값 은 AI 다운스케일부 및 AI 업스케일부를 위한 타겟 해상도 차이, 영상 데이터의 비트레이 트, 영상 데이터의 비트레이트 타입(예를 들어, variable bitrate 타입, constant bitrate 타입 또는 average bitrate 타입 등) 및 변환 기반 부호화부를 위한 코덱 타입 중 적어도 하나를 포함할 수 있다. 하나 이상의 입력 값은 장치에 미리 저장되거나, 사용자로부터 입력받은 값을 포함할 수 있다. 구성 제어부는 수신된 입력 값에 기초하여 AI 다운스케일부 및 변환 기반 부호화부의 동 작을 제어한다. 일 실시예에서, 구성 제어부는 수신된 입력 값에 따라 AI 다운스케일부를 위한 DNN 설정 정보를 획득하고, 획득한 DNN 설정 정보로 AI 다운스케일부를 세팅한다. 일 실시예에서, 구성 제어부는 수신된 입력 값을 AI 다운스케일부로 전달하고, AI 다운스케일부는 수신된 입 력 값에 기초하여 원본 영상을 AI 다운스케일하기 위한 DNN 설정 정보를 획득할 수 있다. 일 실시예에 서, 구성 제어부는 입력 값과 함께 추가 정보, 예를 들어, AI 다운스케일이 적용되는 컬러 포맷(휘도 성분, 색차 성분, 레드 성분, 그린 성분 또는 블루 성분 등) 정보, HDR(high dynamic range)의 톤 매핑(tone mapping) 정보 등을 AI 다운스케일부로 제공하고, AI 다운스케일부는 입력 값 및 추가 정보를 고려하여 DNN 설정 정보를 획득할 수도 있다. 일 실시예에서, 구성 제어부는 수신된 입력 값의 적어 도 일부를 변환 기반 부호화부로 전달하여 변환 기반 부호화부가 특정 값의 비트레이트, 특정 타입 의 비트레이트 및 특정 코덱으로 제 1 영상을 제 1 부호화하게 한다.AI 다운스케일부는 원본 영상을 수신하고, 제 1 영상을 획득하기 위해 도 9, 도 15, 도 16, 도 17 및 도 18 중 적어도 하나와 관련하여 설명한 동작을 수행한다. 일 실시예에서, AI 데이터는 장치로 제공된다. AI 데이터는 원본 영상과 제 1 영상 사이 의 해상도 차이 정보 및 제 1 영상 관련 정보 중 적어도 하나를 포함할 수 있다. 해상도 차이 정보는 입력 값의 타겟 해상도 차이에 기반하여 결정될 수 있고, 제 1 영상 관련 정보는 타겟 비트레이트, 비트레 이트 타입 및 코덱 타입 중 적어도 하나에 기반하여 결정될 수 있다. 일 실시예에서, AI 데이터는 AI 업스 케일 과정에 이용되는 파라미터들을 포함할 수도 있다. AI 데이터는 AI 다운스케일부로부터 장치로 제공될 수도 있다. 제 1 영상은 변환 기반 부호화부에 의해 처리되어 영상 데이터가 획득되고, 영상 데이터는 장치로 전달된다. 변환 기반 부호화부는 MPEG-2, H.264 AVC, MPEG-4, HEVC, VC-1, VP8, VP9 또는 AV1에 따라 제 1 영상을 처리할 수 있다. 구성 제어부는 AI 데이터에 기초하여 AI 업스케일부의 동작을 제어한다. 일 실시예에서, 구성 제어부는 수신된 AI 데이터에 따라 AI 업스케일부를 위한 DNN 설정 정보를 획득하고, 획득한 DNN 설정 정보로 AI 업스케일부를 세팅한다. 일 실시예에서, 구성 제어부는 수신된 AI 데이터 을 AI 업스케일부로 전달하고, AI 업스케일부는 AI 데이터에 기초하여 제 2 영상을 AI 업 스케일하기 위한 DNN 설정 정보를 획득할 수 있다. 일 실시예에서, 구성 제어부는 AI 데이터와 함께 추가 정보, 예를 들어, AI 업스케일이 적용되는 컬러 포맷(휘도 성분, 색차 성분, 레드 성분, 그린 성분 또는 블루 성분 등) 정보, HDR(high dynamic range)의 톤 매핑 정보 등을 AI 업스케일부로 제공하고, AI 업스 케일부는 AI 데이터 및 추가 정보를 고려하여 DNN 설정 정보를 획득할 수도 있다. 일 실시예에서, AI 업스케일부는 구성 제어부로부터 AI 데이터를 수신하고, 변환 기반 복호화부로부터 예측 모드 정보, 움직임 정보 및 양자화 파라미터 정보 중 적어도 하나를 수신하고, 예측 모드 정보, 움직임 정보 및 양자화 파라미터 정보 중 적어도 하나와 AI 데이터에 기초하여 DNN 설정 정보를 획득할 수도 있다. 변환 기반 복호화부는 영상 데이터를 처리하여 제 2 영상을 복원한다. 변환 기반 복호화부 는 MPEG-2, H.264 AVC, MPEG-4, HEVC, VC-1, VP8, VP9 또는 AV1에 따라 영상 데이터를 처리할 수 있 다. AI 업스케일부는 세팅된 DNN 설정 정보를 기초로 변환 기반 복호화부로부터 제공되는 제 2 영상 을 AI 업스케일하여 제 3 영상을 획득한다. AI 다운스케일부는 제 1 DNN을 포함하고, AI 업스케일부는 제 2 DNN을 포함할 수 있는데, 일 실시 예에서, 제 1 DNN 및 제 2 DNN을 위한 DNN 설정 정보들은 도 17 및 도 18과 관련하여 설명한 훈련 방법에 따라 훈련된다. 한편, 상술한 본 개시의 실시예들은 컴퓨터에서 실행될 수 있는 프로그램 또는 인스트럭션으로 작성가능하고, 작성된 프로그램 또는 인스트럭션은 매체에 저장될 수 있다. 매체는 컴퓨터로 실행 가능한 프로그램 또는 인스트럭션을 계속 저장하거나, 실행 또는 다운로드를 위해 임시 저장하는 것일 수도 있다. 또한, 매체는 단일 또는 수개 하드웨어가 결합된 형태의 다양한 기록수단 또는 저장 수단일 수 있는데, 어떤 컴퓨터 시스템에 직접 접속되는 매체에 한정되지 않고, 네트워크 상에 분산 존재하는 것일 수도 있다. 매체의 예시로는, 하드 디스크, 플로피 디스크 및 자기 테이프와 같은 자기 매체, CD-ROM 및 DVD와 같은 광기록 매체, 플롭티컬 디스크(floptical disk)와 같은 자기-광 매체(magneto-optical medium), 및 ROM, RAM, 플래시 메모리 등을 포함하여 프로그램 명령어가 저장되도록 구성된 것이 있을 수 있다. 또한, 다른 매체의 예시로, 애플리케이션을 유통하는 앱 스토어나 기타 다양한 소프트웨어를 공급 내지 유통하는 사이트, 서버 등에서 관리하는 기록매체 내지 저장매체도 들 수 있다. 한편, 상술한 DNN과 관련된 모델은, 소프트웨어 모듈로 구현될 수 있다. 소프트웨어 모듈(예를 들어, 명령어 (instruction)를 포함하는 프로그램 모듈)로 구현되는 경우, DNN 모델은 컴퓨터로 읽을 수 있는 판독 가능한 기 록매체에 저장될 수 있다. 또한, DNN 모델은 하드웨어 칩 형태로 집적되어 전술한 AI 복호화 장치 또는 AI 부호화 장치의 일부 가 될 수도 있다. 예를 들어, DNN 모델은 인공 지능을 위한 전용 하드웨어 칩 형태로 제작될 수도 있고, 또는 기존의 범용 프로세서(예를 들어, CPU 또는 애플리케이션 프로세서) 또는 그래픽 전용 프로세서(예를 들어,GPU)의 일부로 제작될 수도 있다. 또한, DNN 모델은 다운로드 가능한 소프트웨어 형태로 제공될 수도 있다. 컴퓨터 프로그램 제품은 제조사 또는 전자 마켓을 통해 전자적으로 배포되는 소프트웨어 프로그램 형태의 상품(예를 들어, 다운로드 가능한 애플리케 이션)을 포함할 수 있다. 전자적 배포를 위하여, 소프트웨어 프로그램의 적어도 일부는 저장 매체에 저장되거나, 임시적으로 생성될 수 있다. 이 경우, 저장 매체는 제조사 또는 전자 마켓의 서버, 또는 중계 서버 의 저장매체가 될 수 있다. 도 20은 본 개시의 일 실시 예에 따른 수신 장치의 제어 방법을 설명하기 위한 흐름도이다. 도 20에 도시된 수신 장치의 제어 방법에 따르면, 입력 영상에 수행된 전처리(pre-processing) 관련 정보에 기 초하여 영상을 업스케일링하도록 학습된 인공 지능 모델의 파라미터 정보를 획득한다(S2010). 이어서, 획득된 파라미터 정보에 대응되는 인공 지능 모델을 이용하여 입력 영상을 업스케일링하여 출력 영상을 획득한다(S2020). 본 개시의 일 실시 예에 따라 파라미터 정보를 획득하는 S2010 단계는, 상이한 전처리 각각에 대응되는 전처리 관련 정보에 맵핑된 파라미터 정보를 저장하는 메모리에서 입력 영상과 함께 수신된 전처리 관련 정보에 대응되 는 파라미터 정보를 식별하는 단계를 포함하고, 출력 영상을 획득하는 S2020 단계는, 식별된 파라미터 정보에 대응되는 인공 지능 모델을 이용하여 입력 영상을 업스케일링하는 단계를 포함할 수 있다. 여기서, 메모리에 저장된 파라미터 정보는, 상이한 전처리 각각에 적용되는 필터 관련 정보를 포함하며, 파라미 터 정보를 획득하는 S2010 단계는, 저장된 파라미터 정보 중 입력 영상과 함께 수신된 필터 관련 정보에 대응되 는 파라미터 정보를 식별하는 단계를 포함하고, 출력 영상을 획득하는 S2020 단계는, 식별된 파라미터 정보에 대응되는 인공 지능 모델을 이용하여 입력 영상을 업스케일링하는 단계를 포함할 수 있다. 여기서, 상이한 전처리 각각에 적용되는 필터 관련 정보는, 상이한 전처리 각각에 적용되는 필터의 타입 또는 강도 중 적어도 하나에 대한 정보를 포함할 수 있다. 여기서, 상이한 전처리 각각에 적용되는 필터 관련 정보는, 필터가 적용되기 전 영상 및 필터가 적용된 후 영상 간 차이에 대한 정보를 더 포함할 수 있다. 또한, 출력 영상을 획득하는 S2020 단계는, 입력 영상을 디코딩하고 디코딩된 영상을 인공 지능 모델을 이용하 여 업스케일링하는 단계를 포함할 수 있다. 본 개시의 일 실시 예에 따른 인공 지능 모델은, 복수의 신경망 레이어를 포함하며, 획득된 파라미터 정보에 기 초하여 복수의 신경망 레이어 각각에 대응되는 파라미터를 설정하는 단계를 포함할 수 있다. 다만, 본 개시의 다양한 실시 예들은 송신 장치 및 수신 장치 뿐 아니라, 셋탑 박스와 같은 영상 수신 장치, 영 상 처리 장치 등 영상 처리가 가능한 모든 전자 장치에 적용될 수 있음은 물론이다. 한편, 이상에서 설명된 다양한 실시 예들은 소프트웨어(software), 하드웨어(hardware) 또는 이들의 조합을 이 용하여 컴퓨터(computer) 또는 이와 유사한 장치로 읽을 수 있는 기록 매체 내에서 구현될 수 있다. 일부 경우 에 있어 본 명세서에서 설명되는 실시 예들이 프로세서 자체로 구현될 수 있다. 소프트웨어적인 구현에 의 하면, 본 명세서에서 설명되는 절차 및 기능과 같은 실시 예들은 별도의 소프트웨어 모듈들로 구현될 수 있다. 소프트웨어 모듈들 각각은 본 명세서에서 설명되는 하나 이상의 기능 및 동작을 수행할 수 있다. 한편, 상술한 본 개시의 다양한 실시 예들에 따른 음향 출력 장치의 프로세싱 동작을 수행하기 위한 컴퓨 터 명령어(computer instructions)는 비일시적 컴퓨터 판독 가능 매체(non-transitory computer-readable medium) 에 저장될 수 있다. 이러한 비일시적 컴퓨터 판독 가능 매체에 저장된 컴퓨터 명령어는 특정 기기의 프 로세서에 의해 실행되었을 때 상술한 다양한 실시 예에 따른 음향 출력 장치에서의 처리 동작을 특정 기기 가 수행하도록 한다. 비일시적 컴퓨터 판독 가능 매체란 레지스터, 캐쉬, 메모리 등과 같이 짧은 순간 동안 데이터를 저장하는 매체 가 아니라 반영구적으로 데이터를 저장하며, 기기에 의해 판독(reading)이 가능한 매체를 의미한다. 비일시적 컴퓨터 판독 가능 매체의 구체적인 예로는, CD, DVD, 하드 디스크, 블루레이 디스크, USB, 메모리카드, ROM 등 이 있을 수 있다. 이상에서는 본 개시의 바람직한 실시 예에 대하여 도시하고 설명하였지만, 본 개시는 상술한 특정의 실시 예에"}
{"patent_id": "10-2019-0157745", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "한정되지 아니하며, 청구범위에서 청구하는 본 개시의 요지를 벗어남이 없이 당해 개시에 속하는 기술분야에서 통상의 지식을 가진자에 의해 다양한 변형실시가 가능한 것은 물론이고, 이러한 변형실시들은 본 개시의 기술적사상이나 전망으로부터 개별적으로 이해되어져서는 안될 것이다."}
{"patent_id": "10-2019-0157745", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 개시의 일 실시 예에 따른 시스템의 구성을 나타내는 블록도이다. 도 2는 본 개시의 일 실시 예에 따른 시스템의 동작을 설명하기 위한 도면이다. 도 3은 본 개시의 일 실시 예에 따른 수신 장치의 구성을 나타내는 블록도이다. 도 4는 본 개시의 일 실시 예에 따른 수신 장치의 동작을 설명하기 위한 도면이다. 도 5는 본 개시의 일 실시 예에 따른 인공 지능 모델을 설명하기 위한 도면이다. 도 6은 본 개시의 일 실시 예에 따른 수신 장치의 상세 블록도이다. 도 7은 본 개시의 일 실시 예에 따른 송신 장치의 구성을 나타내는 블록도이다. 도 8은 본 개시의 일 실시 예에 따른 송신 장치의 동작을 설명하기 위한 도면이다. 도 9는 본 개시의 일 실시 예에 따른 AI 부호화 과정 및 AI 복호화 과정을 설명하기 위한 도면이다. 도 10은 본 개시의 일 실시 예에 따른 AI 복호화 장치의 구성을 나타내는 블록도이다. 도 11은 제 2 영상의 AI 업스케일을 위한 제 2 DNN을 나타내는 예시적인 도면이다. 도 12는 컨볼루션 레이어에 의한 컨볼루션 연산을 설명하기 위한 도면이다. 도 13은 여러 영상 관련 정보들과 여러 DNN 설정 정보들 사이의 매핑 관계를 나타내는 예시적인 도면이다. 도 14는 복수의 프레임으로 구성된 제 2 영상을 도시하는 도면이다. 도 15는 일 실시예에 따른 AI 부호화 장치의 구성을 나타내는 블록도이다. 도 16은 원본 영상의 AI 다운스케일을 위한 제 1 DNN을 나타내는 예시적인 도면이다. 도 17은 제 1 DNN 및 제 2 DNN을 훈련시키는 방법을 설명하기 위한 도면이다. 도 18은 훈련 장치에 의한 제 1 DNN 및 제 2 DNN의 훈련 과정을 설명하기 위한 도면이다. 도 19는 원본 영상의 AI 다운스케일을 위한 장치 및 제 2 영상의 AI 업스케일을 위한 장치를 도시하는 예시적인 도면이다. 도 20은 본 개시의 일 실시 예에 따른 수신 장치의 제어 방법을 설명하기 위한 흐름도이다."}
