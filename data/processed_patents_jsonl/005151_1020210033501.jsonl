{"patent_id": "10-2021-0033501", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2022-0128842", "출원번호": "10-2021-0033501", "발명의 명칭": "이미지 인페인팅 신경망의 고속 적응을 위한 장치 및 방법", "출원인": "주식회사 케이티", "발명자": "최재원"}}
{"patent_id": "10-2021-0033501", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "이미지 인페인팅 신경망의 고속 적응을 위한 장치에 있어서,일부 영역이 마스킹 처리된 하나의 입력 이미지를 수신하고, 해당 입력 이미지의 마스킹 처리된 일부 영역을 복원하여 출력 이미지를 생성하는 이미지 인페인팅 신경망;상기 이미지 인페인팅 신경망에서 생성되는 출력 이미지에서 랜덤하게 일부 영역을 마스킹 처리하여 상기 이미지 인페인팅 신경망에 입력하는 과정을 소정 횟수만큼 반복하는 마스킹 처리부;상기 이미지 인페인팅 신경망을 통해 상기 하나의 입력 이미지로부터 복원된 출력 이미지를 임시 타겟 이미지로설정하고, 상기 마스킹 처리부에서 마스킹 처리되어 상기 이미지 인페인팅 신경망으로 입력된 이미지로부터 복원되어 생성된 출력 이미지와 상기 임시 타겟 이미지를 비교하여 손실값을 계산하는 손실 계산부; 및상기 손실값을 기초로 상기 이미지 인페인팅 신경망의 파라미터를 업데이트하는 최적화부를 포함하고,상기 손실 계산부는, 상기 소정 횟수 반복 완료 후 상기 이미지 인페인팅 신경망에서 출력되는 출력 이미지와,상기 하나의 입력 이미지의 원본 이미지를 비교하여 손실값을 계산하고,상기 최적화부는, 상기 원본 이미지를 비교한 손실값을 기초로 상기 이미지 인페인팅 신경망의 파라미터를 추가로 업데이트하는 장치."}
{"patent_id": "10-2021-0033501", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 마스킹 처리부는,0 또는 1의 값으로 구성된 랜덤 바이너리 마스크를 생성하고, 상기 출력 이미지와 상기 랜덤 바이너리 마스크를곱하여, 상기 출력 이미지에서 랜덤하게 일부 영역을 마스킹 처리하는 것을 특징으로 하는 장치."}
{"patent_id": "10-2021-0033501", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1항에 있어서,상기 이미지 인페인팅 신경망, 상기 마스킹 처리부, 상기 손실 계산부 및 상기 최적화부는, 상기 일부 영역이 마스킹 처리된 하나의 입력 이미지 및 그의 원본 이미지를 이용한 처리와 동일한 처리를, 일부 영역이 마스킹 처리된 서로 다른 복수의 입력 이미지 및 그들의 원본 이미지를 이용하여 반복하는 것을 특징으로 하는 장치."}
{"patent_id": "10-2021-0033501", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제1항에 있어서,테스트 타임에서, 일부 영역이 마스킹 처리된 또 다른 하나의 입력 이미지만을 이용하여 상기 이미지 인페인팅신경망을 파인튜닝하는 것을 특징으로 하는 장치."}
{"patent_id": "10-2021-0033501", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제4항에 있어서,상기 파인튜닝은,상기 이미지 인페인팅 신경망이, 일부 영역이 마스킹 처리된 또 다른 하나의 입력 이미지를 수신하고, 해당 입력 이미지의 마스킹 처리된 일부 영역을 복원하여 출력 이미지를 생성하고,상기 마스킹 처리부가, 상기 이미지 인페인팅 신경망에서 출력되는 출력 이미지에서 랜덤하게 일부 영역을 마스공개특허 10-2022-0128842-3-킹 처리하여 상기 이미지 인페인팅 신경망에 입력하는 과정을 소정 횟수만큼 반복하며,상기 손실 계산부가, 상기 또 다른 하나의 입력 이미지로부터 복원된 출력 이미지를 타겟 이미지로 설정하고,그 타겟 이미지와 상기 마스킹 처리부에서 마스킹 처리되어 상기 이미지 인페인팅 신경망으로 입력된 이미지로부터 복원되어 생성된 출력 이미지를 비교하여 손실값을 계산하며,상기 최적화부가, 상기 손실 계산부에서 계산된 손실값을 기초로 상기 이미지 인페인팅 신경망의 파라미터를 업데이트하는 것을 특징으로 하는 장치."}
{"patent_id": "10-2021-0033501", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "이미지 인페인팅 신경망의 고속 적응을 위한 방법에 있어서,일부 영역이 마스킹 처리된 하나의 입력 이미지를 이미지 인페인팅 신경망에 입력하여 마스킹 처리된 일부 영역이 복원된 제1출력 이미지를 생성하는 단계;상기 제1출력 이미지를 임시 타겟 이미지로 설정하는 단계;상기 제1출력 이미지에서 랜덤하게 일부 영역을 마스킹 처리하여 상기 이미지 인페인팅 신경망에 입력하여 해당마스킹 처리된 일부 영역이 복원된 제2출력 이미지를 생성하고, 상기 제2출력 이미지와 상기 임시 타겟 이미지를 비교하여 손실값을 계산하며, 계산된 손실값을 기초로 상기 이미지 인페인팅 신경망의 파라미터를 업데이트하는 과정을 소정 횟수 반복 수행하는 단계; 및상기 소정 횟수 반복 완료 후 상기 이미지 인페인팅 신경망에서 출력되는 출력 이미지와, 상기 하나의 입력 이미지의 원본 이미지를 비교하여 손실값을 계산하고, 그 손실값을 기초로 상기 이미지 인페인팅 신경망의 파라미터를 추가로 업데이트하는 단계를 포함하는 방법."}
{"patent_id": "10-2021-0033501", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제6항에 있어서,상기 반복 수행하는 단계는,0 또는 1의 값으로 구성된 랜덤 바이너리 마스크를 생성하고, 상기 제1출력 이미지와 상기 랜덤 바이너리 마스크를 곱하여, 상기 제1출력 이미지에서 랜덤하게 일부 영역을 마스킹 처리하는 것을 특징으로 하는 방법."}
{"patent_id": "10-2021-0033501", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제6항에 있어서,상기 제1출력 이미지를 생성하는 단계. 상기 임시 타겟 이미지로 설정하는 단계, 상기 반복 수행하는 단계 및상기 추가로 업데이트하는 단계를, 일부 영역이 마스킹 처리된 서로 다른 복수의 입력 이미지 및 그들의 원본이미지를 이용하여 반복하는 단계를 더 포함하는 것을 특징으로 하는 방법."}
{"patent_id": "10-2021-0033501", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제6항에 있어서,테스트 타임에서, 일부 영역이 마스킹 처리된 또 다른 하나의 입력 이미지만을 이용하여 상기 이미지 인페인팅신경망을 파인튜닝하는 단계를 더 포함하는 것을 특징으로 하는 방법."}
{"patent_id": "10-2021-0033501", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제9항에 있어서,상기 파인튜닝하는 단계는,일부 영역이 마스킹 처리된 또 다른 하나의 입력 이미지를 이미지 인페인팅 신경망에 입력하여 마스킹 처리된일부 영역이 복원된 제3출력 이미지를 생성하는 단계;상기 제3출력 이미지를 제1 타겟 이미지로 설정하는 단계; 및상기 제3출력 이미지에서 랜덤하게 일부 영역을 마스킹 처리하여 상기 이미지 인페인팅 신경망에 입력하여 해당공개특허 10-2022-0128842-4-마스킹 처리된 일부 영역이 복원된 제4출력 이미지를 생성하고, 상기 제4출력 이미지와 상기 제1 타겟 이미지를비교하여 손실값을 계산하며, 계산된 손실값을 기초로 상기 이미지 인페인팅 신경망의 파라미터를 업데이트하는과정을 소정 횟수 반복 수행하는 단계를 포함하는 방법."}
{"patent_id": "10-2021-0033501", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "제6항 내지 제10항 중 어느 한 항에 따른 방법을 컴퓨터 시스템을 통해 실행하는 컴퓨터 프로그램으로서 기록매체에 기록된 컴퓨터 프로그램."}
{"patent_id": "10-2021-0033501", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "일 실시예에 따른, 이미지 인페인팅 신경망의 고속 적응을 위한 방법은, 일부 영역이 마스킹 처리된 하나의 입 력 이미지를 이미지 인페인팅 신경망에 입력하여 마스킹 처리된 일부 영역이 복원된 제1출력 이미지를 생성하는 단계; 상기 제1출력 이미지를 임시 타겟 이미지로 설정하는 단계; 상기 제1출력 이미지에서 랜덤하게 일부 영역 (뒷면에 계속)"}
{"patent_id": "10-2021-0033501", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 이미지 인페인팅 신경망 기술에 관한 것으로, 보다 구체적으로, 이미지 인페인팅 신경망의 고속 적응 을 위한 장치 및 방법에 관한 것이다."}
{"patent_id": "10-2021-0033501", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "이미지 인페인팅(Image Inpainting) 기술은 이미지 내의 훼손되거나 비어 있는 영역을 시각적으로 자연스럽게 채워 복원하는 이미지 후처리 기술을 의미한다. 일반적으로 이미지 내에서 자막, 광고 등 불필요한 영역을 제거 하고자 할 때, 제거된 영역이 주변부 영역과 비교하여 자연스럽게 보일 수 있도록 이미지를 합성할 때 많이 사 용되고 있다. 최근에는 딥러닝 기술의 발전과 함께 이미지 인페인팅 기술의 성능도 비약적으로 발전 중이며, 자 막과 같이 작은 영역 뿐만 아니라 이미지 내 존재하는 사람, 자동차, 배경 등 비교적 큰 사이즈의 객체를 제거 하는 데에도 많이 이용되고 있다. 일반적으로 인공지능 신경망을 학습하기 위해서는 많은 학습 데이터가 필요하다. 학습 데이터는 데이터와 그 데 이터의 정답인 레이블의 쌍으로서, 인공지능 신경망을 학습하기 위해서는 많은 학습 데이터가 필요하다. 이미지 인페인팅 신경망을 학습하기 위해서도 역시 많은 학습 데이터가 필요하다. 즉, 많은 수의 이미지와 그 이미지의 정답인 레이블의 쌍이 필요하다. 이러한 학습 데이터를 확보하는 것이 쉽지 않고, 다량의 학습 데이터를 확보한 다고 해도 신경망을 학습하는데 시간이 많이 소요된다. 한편, 인공지능 신경망을 학습한 후 테스트 타임에서 인공지능 신경망의 파라미터를 미세하게 조정하는 파인튜 닝(fine tunning)을 실시한다. 즉, 미리 학습된 신경망을 추가로 학습시켜 신경망의 파라미터를 업데이트한다. 이미지 인페인팅 신경망에 대해서도 파인튜닝을 통해 파라미터를 업데이트할 수 있다. 파인튜닝을 하기 위해서 도, 학습할 때와 마찬가지로, 다량의 학습 데이터가 필요한데, 학습 데이터를 확보하는 것이 어렵다. 또한 미리 학습된 이미지 인페인팅 신경망을 파인튜닝하는데 있어서 수백회 혹은 수천회 이상의 파인튜닝 과정을 거쳐야 한다. 따라서 시간이 오래 소요되는 문제점이 있다."}
{"patent_id": "10-2021-0033501", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은, 이미지 인페인팅 신경망을 소량의 학습 데이터만으로 학습시켜 이미지 인페인팅 신경망의 파라미터 를 목적하는 파라미터에 빠르게 적응하도록 하여, 테스트 타임에서의 파인튜닝 횟수를 줄이면서도 빠르게 신경 망의 파라미터를 업데이트되도록 하는, 이미지 인페인팅 신경망의 고속 적응을 위한 장치 및 방법을 제공하는데 그 목적이 있다."}
{"patent_id": "10-2021-0033501", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "일 실시예에 따른, 이미지 인페인팅 신경망의 고속 적응을 위한 장치는, 일부 영역이 마스킹 처리된 하나의 입 력 이미지를 수신하고, 해당 입력 이미지의 마스킹 처리된 일부 영역을 복원하여 출력 이미지를 생성하는 이미 지 인페인팅 신경망; 상기 이미지 인페인팅 신경망에서 생성되는 출력 이미지에서 랜덤하게 일부 영역을 마스킹 처리하여 상기 이미지 인페인팅 신경망에 입력하는 과정을 소정 횟수만큼 반복하는 마스킹 처리부; 상기 이미지 인페인팅 신경망을 통해 상기 하나의 입력 이미지로부터 복원된 출력 이미지를 임시 타겟 이미지로 설정하고, 상기 마스킹 처리부에서 마스킹 처리되어 상기 이미지 인페인팅 신경망으로 입력된 이미지로부터 복원되어 생성 된 출력 이미지와 상기 임시 타겟 이미지를 비교하여 손실값을 계산하는 손실 계산부; 및 상기 손실값을 기초로상기 이미지 인페인팅 신경망의 파라미터를 업데이트하는 최적화부를 포함하고, 상기 손실 계산부는, 상기 소정 횟수 반복 완료 후 상기 이미지 인페인팅 신경망에서 출력되는 출력 이미지와, 상기 하나의 입력 이미지의 원본 이미지를 비교하여 손실값을 계산하고, 상기 최적화부는, 상기 실제 이미지를 비교한 손실값을 기초로 상기 이 미지 인페인팅 신경망의 파라미터를 추가로 업데이트한다. 상기 마스킹 처리부는, 0 또는 1의 값으로 구성된 랜덤 바이너리 마스크를 생성하고, 상기 출력 이미지와 상기 랜덤 바이너리 마스크를 곱하여, 상기 출력 이미지에서 랜덤하게 일부 영역을 마스킹 처리할 수 있다. 상기 이미지 인페인팅 신경망, 상기 마스킹 처리부, 상기 손실 계산부 및 상기 최적화부는, 상기 일부 영역이 마스킹 처리된 하나의 입력 이미지 및 그의 원본 이미지를 이용한 처리와 동일한 처리를, 일부 영역이 마스킹 처리된 서로 다른 복수의 입력 이미지 및 그들의 원본 이미지를 이용하여 반복할 수 있다. 테스트 타임에서, 상기 장치는, 일부 영역이 마스킹 처리된 또 다른 하나의 입력 이미지만을 이용하여 상기 이 미지 인페인팅 신경망을 파인튜닝할 수 있다. 상기 파인튜닝은, 상기 이미지 인페인팅 신경망이, 일부 영역이 마스킹 처리된 또 다른 하나의 입력 이미지를 수신하고, 해당 입력 이미지의 마스킹 처리된 일부 영역을 복원하여 출력 이미지를 생성하고, 상기 마스킹 처리 부가, 상기 이미지 인페인팅 신경망에서 출력되는 출력 이미지에서 랜덤하게 일부 영역을 마스킹 처리하여 상기 이미지 인페인팅 신경망에 입력하는 과정을 소정 횟수만큼 반복하며, 상기 손실 계산부가, 상기 또 다른 하나의 입력 이미지로부터 복원된 출력 이미지를 타겟 이미지로 설정하고, 그 타겟 이미지와 상기 마스킹 처리부에서 마스킹 처리되어 상기 이미지 인페인팅 신경망으로 입력된 이미지로부터 복원되어 생성된 출력 이미지를 비교하 여 손실값을 계산하며, 상기 최적화부가, 상기 손실 계산부에서 계산된 손실값을 기초로 상기 이미지 인페인팅 신경망의 파라미터를 업데이트하는 것일 수 있다. 일 실시예에 따른, 이미지 인페인팅 신경망의 고속 적응을 위한 방법은, 일부 영역이 마스킹 처리된 하나의 입 력 이미지를 이미지 인페인팅 신경망에 입력하여 마스킹 처리된 일부 영역이 복원된 제1출력 이미지를 생성하는 단계; 상기 제1출력 이미지를 임시 타겟 이미지로 설정하는 단계; 상기 제1출력 이미지에서 랜덤하게 일부 영역 을 마스킹 처리하여 상기 이미지 인페인팅 신경망에 입력하여 해당 마스킹 처리된 일부 영역이 복원된 제2출력 이미지를 생성하고, 상기 제2출력 이미지와 상기 임시 타겟 이미지를 비교하여 손실값을 계산하며, 계산된 손실 값을 기초로 상기 이미지 인페인팅 신경망의 파라미터를 업데이트하는 과정을 소정 횟수 반복 수행하는 단계; 및 상기 소정 횟수 반복 완료 후 상기 이미지 인페인팅 신경망에서 출력되는 출력 이미지와, 상기 하나의 입력 이미지의 원본 이미지를 비교하여 손실값을 계산하고, 그 손실값을 기초로 상기 이미지 인페인팅 신경망의 파라 미터를 추가로 업데이트하는 단계를 포함한다. 상기 반복 수행하는 단계는, 0 또는 1의 값으로 구성된 랜덤 바이너리 마스크를 생성하고, 상기 제1출력 이미지 와 상기 랜덤 바이너리 마스크를 곱하여, 상기 제1출력 이미지에서 랜덤하게 일부 영역을 마스킹 처리하는 것일 수 있다. 상기 방법은, 상기 제1출력 이미지를 생성하는 단계. 상기 임시 타겟 이미지로 설정하는 단계, 상기 반복 수행 하는 단계 및 상기 추가로 업데이트하는 단계를, 일부 영역이 마스킹 처리된 서로 다른 복수의 입력 이미지 및 그들의 원본 이미지를 이용하여 반복하는 단계를 더 포함할 수 있다. 상기 방법은, 테스트 타임에서, 일부 영역이 마스킹 처리된 또 다른 하나의 입력 이미지만을 이용하여 상기 이 미지 인페인팅 신경망을 파인튜닝하는 단계를 더 포함할 수 있다. 상기 파인튜닝하는 단계는, 일부 영역이 마스킹 처리된 또 다른 하나의 입력 이미지를 이미지 인페인팅 신경망 에 입력하여 마스킹 처리된 일부 영역이 복원된 제3출력 이미지를 생성하는 단계; 상기 제3출력 이미지를 제1 타겟 이미지로 설정하는 단계; 및 상기 제3출력 이미지에서 랜덤하게 일부 영역을 마스킹 처리하여 상기 이미지 인페인팅 신경망에 입력하여 해당 마스킹 처리된 일부 영역이 복원된 제4출력 이미지를 생성하고, 상기 제4출력 이미지와 상기 제1 타겟 이미지를 비교하여 손실값을 계산하며, 계산된 손실값을 기초로 상기 이미지 인페인팅 신경망의 파라미터를 업데이트하는 과정을 소정 횟수 반복 수행하는 단계를 포함할 수 있다."}
{"patent_id": "10-2021-0033501", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명은, 훈련 타임에서, 다량의 학습 데이터를 이용하지 않고도, 이미지 인페인팅 신경망의 파라미터를 목적 하는 파라미터에 최대한 가깝게 빠르게 적응시킬 수 있고, 따라서 테스트 타임에서 적은 횟수로 이미지 인페인 팅 신경망의 파인튜닝이 가능하도록 한다.본 발명은, 이미지 인페인팅 신경망을 테스트 타임에서 파인튜닝하는데 있어서, 손쉽게 획득이 가능한 마스킹 처리된 하나의 입력 영상만을 이용하여 파인튜닝함으로써, 파인튜닝을 위한 대용량의 학습 데이터가 불필요하다."}
{"patent_id": "10-2021-0033501", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "상술한 목적, 특징 및 장점은 첨부된 도면과 관련한 다음의 상세한 설명을 통하여 보다 분명해질 것이며, 그에"}
{"patent_id": "10-2021-0033501", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "따라 본 발명이 속하는 기술분야에서 통상의 지식을 가진 자가 본 발명의 기술적 사상을 용이하게 실시할 수 있 을 것이다. 또한, 본 발명을 설명함에 있어서 본 발명과 관련된 공지 기술에 대한 구체적인 설명이 본 발명의 요지를 불필요하게 흐릴 수 있다고 판단되는 경우에 그 상세한 설명을 생략하기로 한다. 이하, 첨부된 도면을 참조하여 본 발명에 따른 바람직한 일 실시예를 상세히 설명하기로 한다. 도 1은 본 발명의 일 실시예에 따른 이미지 인페인팅 신경망의 고속 적응을 위한 장치(이하, 고속 적응 장치라 함)의 구성을 나타낸 도면이다. 도 1을 참조하면, 본 실시예에 따른 고속 적응 장치는, 이미지 인페인팅 신경망 , 마스킹 처리부, 손실 계산부 및 최적화부를 포함한다. 이들은 프로그램으로 구현되어 메 모리에 저장되고 적어도 하나의 프로세서에 의해 실행될 수 있다. 본 실시예에 따른 고속 적응 장치는, 이미지 인페인팅 신경망의 파라미터를 파라미터 스페이스 상에서 다 량의 학습 데이터를 잘 처리할 수 있는 곳이 아니라 테스트 타임에 파인튜닝이 잘 될 수 있는 곳으로 이동시키 는 것을 목적으로 한다. 본 실시예에 따른 고속 적응 장치는 메타 러닝(meta learning) 알고리즘을 변형하여 이 미지 인페인팅에 적용한다. 메타 러닝 기법으로서 본 실시예에서는 Finn의 MAML(Model-Agnostic Meta-Learning for Fast Adaptation of Deep Networks, 2017)을 기반으로 하지만, 여기에 제한되는 것은 아니며 다양한 메타 러닝 기법(예, F0-MAML, MAML++, FO-MAML+L2F, Mega-SGD 등이 적용될 수 있다. 이미지 인페인팅 신경망의 초기 파라미터는, 데이터와 레이블의 쌍으로 이루어진 학습 데이터로 미리 학습 된 신경망 파라미터를 사용할 수 있다. 바람직하게는, places2, celebA, PSV와 같은 대중에 공개된 학습 데이터 를 이용하여 각각의 방법들이 제공하는 학습 가이드라인을 따라 미리 학습될 수 있다. 이미지 인페인팅 신경망는, 일부 영역이 훼손된, 즉 마스킹 처리된 하나의 입력 이미지를 수신한다. 이미 지 인페인팅 신경망은, 상기 일부 영역이 마스킹 처리된 하나의 입력 이미지에 대해 이미지 인페인팅 모델 을 이용하여 인페인팅을 수행한다. 즉, 상기 마스킹 처리된 일부 영역을 복원하여 출력 이미지를 생성한다. 이미지 인페인팅 신경망은, 최초에 외부로부터 일부 영역이 마스킹 처리된 하나의 입력 이미지만을 수신하 여 인페인팅을 수행하여 출력 이미지를 생성하고, 이후에는 마스킹 처리부로부터 수신되는 상기 출력 이미 지로부터 파생된 이미지들에 대해 인페인팅을 수행하여 출력 이미지를 생성하며, 그 과정에서 최적화부에 의해 신경망의 파라미터들이 정교하게 교정된다. 마스킹 처리부는, 상기 이미지 인페인팅 신경망에서 출력되는 출력 이미지에서 랜덤하게 일부 영역을 마스킹 처리하여 상기 이미지 인페이팅 신경망으로 출력한다. 일 실시예에서, 마스킹 처리부는, 0 혹 은 1의 값으로만 구성된 랜덤 바이너리 마스크를 생성하고, 상기 이미지 인페이팅 신경망에서 복원되어 출 력되는 출력 이미지와 상기 랜덤 바이너리 마스크를 곱하기함으로써, 출력 이미지에서 랜덤하게 일부 영역을 마 스킹 처리한다. 손실 계산부는, 최초의 입력 이미지로부터 복원된 출력 이미지를 상기 이미지 인페인팅 신경망로부터 수신하여 임시 타겟 이미지로 저장하고, 저장된 임시 타겟 이미지와, 이후 상기 이미지 인페인팅 신경망으 로부터 출력되는 다른 출력 이미지를 비교하여 손실값을 계산하여 최적화부에 출력한다. 여기서 손실값은, 임시 타겟 이미지와 출력 이미지 간의 차이값으로 정의할 수 있다. 바람직하게, 손실 계산부는, 상기 이미 지 인페인팅 신경망을 미리 학습할 때 사용한 손실 함수를 변경없이 그대로 사용하거나, 범용으로 사용되 는 손실 함수를 사용해도 무방하다. 최적화부는, 상기 손실 계산부로부터 수신되는 손실값이 최소가 되도록, 상기 이미지 인페인팅 신경 망의 파라미터를 업데이트한다. 최적화부는, Adam, SGD, RMSPROP 등 기존의 최적화기(Optimizer)를 사용할 수 있다. 바람직하게, 최적화부는, 상기 이미지 인페인팅 신경망을 미리 학습할 때 사용한 최 적화기와 설정들을 이용하면 더욱 효과적으로 상기 이미지 인페인팅 신경망의 파라미터를 업데이트할 수 있다. 인공지능 신경망은 일반적으로 입력층(input layer), 은닉층(hidden layer), 및 출력층(output layer)을 포함 하여 구성되고, 신호가 각 층을 통과하면서 가중치가 곱해지거나 더해지는 등의 처리가 이루어진다. 상기 최적 화부에서 업데이트하는 파라미터는 인공지능 신경망에서 신호가 각 층을 통과할 때 적용되는 가중치 등을 의미한다. 이상과 같이, 이미지 인페인팅 신경망은, 마스킹 처리부로부터 수신되는 랜덤하게 일부 영역이 마스 킹 처리된 이미지를 복원하여 출력 이미지를 생성하고, 마스킹 처리부는 그 출력 이미지에 대해 다시 랜덤 하게 일부 영역을 마스킹 처리한 후 이미지 인페인팅 신경망으로 출력한다. 이 과정에서 최적화부는 손실 계산부에서 계산되는 손실값이 최소가 되도록, 이미지 인페인팅 신경망의 파라미터를 업데이트 한다. 이러한 과정을 소정 횟수만큼 반복하게 되면, 이미지 인페인팅 신경망의 파라미터는 업데이트된다. 즉, 마스킹 처리된 하나의 입력 이미지와 인페인팅 결과를 이용하여 이미지 인페인팅 신경망의 파라미터를 업데이트한다. 이와 같이, 일부 영역이 마스킹 처리된 하나의 입력 이미지를 이용하여 이미지 인페인팅 신경망의 파라미 터를 소정 횟수 업데이트한 후, 손실 계산부는, 마지막 회차에서 이미지 인페인팅 신경망으로부터 출 력되는 출력 이미지와, 상기 일부 영역이 마스킹 처리된 하나의 입력 이미지의 원본 이미지, 즉 마스킹 처리되 지 않은 실제 이미지를 비교하여 손실값을 계산하여 최적화부에 출력한다. 그리고, 최적화부는, 상기 손실 계산부로부터 수신되는 손실값이 최소가 되도록, 상기 이미지 인페인팅 신경망의 파라미터를 업 데이트한다. 그리고, 본 실시예에 따른 고속 적응 장치는, 또 다른 하나의 훼손된, 즉 일부 영역이 마스킹 처리된 입력 이미 지와, 해당 입력 이미지의 원본 이미지를 이용하여, 앞서 설명한 과정을 반복 수행한다. 따라서, 이미지 인페인 팅 신경망의 파라미터는 다시 업데이트된다. 이러한 과정을 소정 횟수만큼 반복한다. 예를 들어, 마스킹 처리된 10개의 입력 이미지와, 해당 10개의 입력 이미지의 원본 이미지를 이용하여, 이미지 인페인팅 신경망 의 파라미터를 업데이트한다. 이와 같은 메터 학습 기법을 이용하여 학습된 이미지 인페인팅 신경망 의 파라미터는, 테스트 타임에서 다량의 학습 데이터를 이용하지 않고, 일부 영역이 마스킹 처리된 입력 이미지 만을 이용하여, 입력 이미지에 특화된 목적 파라미터를 적은 횟수의 파인튜닝으로 빠르게 찾을 수 있도록 한다. 본 발명에서의 이미지 인페인팅 신경망의 테스트 타임에서의 파인튜닝은, 앞서 설명한, 일부 영역이 마스 킹 처리된 하나의 입력 이미지를 이용하여 이미지 인페인팅 신경망의 파라미터를 업데이트하는 과정이다. 즉, 일부 영역이 마스킹 처리된 하나의 입력 이미지로부터 복원된 최초의 출력 이미지를 임시 타겟 이미지로 설 정한 후, 그 최초의 출력 이미지에서 랜덤하게 일부 영역을 마스킹 처리하여 다시 이미지 인페인팅 신경망(12 0)을 통해 출력 이미지를 생성하여 임시 타겟 이미지와 비교하고, 다시 출력 이미지에서 랜덤하게 일부 영역을 마스킹 처리하여 다시 이미지 인페인팅 신경망에 입력하여 복원하는 과정을 소정 횟수만큼 반복하면서 손 실값이 최소가 되도록 이미지 인페인팅 신경망의 파라미터를 조정하는 것이다. 파인튜닝 과정에서는 상기 일부 영역이 마스킹 처리된 입력 이미지의 원본 이미지, 즉 실제 이미지를 이용하지 않고, 상기 일부 영역이 마 스킹 처리된 입력 이미지만을 이용하여 이미지 인페인팅 신경망의 파라미터가 미세하게 조정된다. 본 실시예에 따른 고속 적응 장치로 이미지 인페인팅 신경망의 파라미터를 업데이트하지 않고, 다량의 학 습 데이터로 이미지 인페인팅 신경망을 충분히 학습시킨 후, 학습된 이미지 인페인팅 신경망을 테스 트 타임에서 일부 영역이 마스킹 처리된 하나의 입력 이미지로 파인튜닝을 할 경우, 수백회 혹은 수천회 이상의 파인튜닝 과정이 필요하지만, 본 실시예에 따른 고속 적응 장치로 이미지 인페인팅 신경망의 파라미터를 업데이트한 후, 테스트 타임에서 일부 영역이 마스킹 처리된 하나의 입력 이미지로 파인튜닝을 할 경우, 5회 이내의 파인튜닝 과정만 수행해도 큰 폭의 성능 향상을 얻을 수 있다. 따라서, 다량의 학습 데이터가 필요 없으면 서 빠르게 파인튜닝을 할 수 있게 된다. 일반적으로 이미지 내에는 동일하거나 유사한 패턴이 반복적으로 다수 존재한다. 따라서 하나의 입력 영상의 일 부 영역을 랜덤하게 마스킹하는 경우, 해당 입력 영상 내의 반복되는 패턴들이 자동으로 마스킹될 확률이 높고, 따라서 위에서 설명한 하나의 입력 영상을 이용한 고속 적응 및 파인튜닝 과정을 통해 이미지 인페인팅 신경망 은 이미지 내 반복되는 패턴들을 특히 더 잘 복원할 수 있는 성능을 확보하게 된다. 도 2는 이미지 인페인팅 신경망의 통상적인 학습 및 파인튜닝과, 본 발명의 일 실시예에 따른 이미지 인페인팅 신경망의 고속 적응 및 파인튜닝을, 신경망의 파라미터 관점에서 비교한 도면이다. 도 2에서 파라미터 스페이스 상에서 목적하는 파라미터의 위치는 θ'이다. 이미지 인페인팅 신경망을 다량의 학습 데이터를 이용하여 통상적인 학습을 하게 되면, 이미지 인페인팅 신경망의 파라미터의 위치는 Q이다. 그리고 이와 같이 학습된 이미지 인페인팅 신경망을 수백 또는 수천회 파인튜닝하여 Q 위치의 파라미터를 목적하는 파라미터의 위치 θ'로 조정할 수 있다. 그러나, 이와 같이 하기 위해서는, 다량의 학습 데이터가 필요하고 학습에 오랜 시간이 소요되며, 파인튜닝 역시 수백회에서 수천회 반복해야 한다. 반면, 본 발명에 따라 이미지 인페인팅 신경망을 고속 적응이 가능하도록 학습을 하게 되면, 이미지 인페 인팅 신경망의 파라미터는 Q 위치가 아니라 θ* 위치로 조정된다. 즉, 이미지 인페인팅 신경망 의 파라미터는 목적하는 파라미터의 위치 θ'에 더 빨리 도달할 수 있게 된다. 따라서, 고속 적응이 가능하도록 학습된 이미지 인페인팅 신경망에 대해 수백회 또는 수천회의 파인튜닝을 수행할 필요 없이, 상대적으로 더 적은 횟수의 파인튜닝만으로 이미지 인페인팅 신경망의 파라미터를 목적하는 파라미터의 위 치 θ'로 조정할 수 있다. 도 3은 본 발명의 일 실시예에 따른 이미지 인페인팅 신경망의 고속 적응을 위한 학습 방법을 설명하는 흐름도 이다. 도 3을 참조하면, 단계 S301에서, 고속 적응 장치는, 일부 영역이 훼손된, 즉 마스킹 처리된 하나의 입력 이미 지를 이미지 인페인팅 신경망으로 입력한다. 단계 S302에서, 고속 적응 장치는, 상기 이미지 인페인팅 신경망을 통해 상기 입력 이미지를 복원하여 출 력 이미지를 생성한다. 즉, 이미지 인페인팅 신경망은, 상기 일부 영역이 마스킹 처리된 하나의 입력 이미 지에 대해 이미지 인페인팅 모델을 이용하여 상기 마스킹 처리된 일부 영역을 복원하여 출력 이미지를 생성한다. 이때, 이미지 인페인팅 모델은, 기존의 학습 데이터로 학습이 완료된 상태인 것이 바람직하다. 단계 S303에서, 고속 적응 장치는, 상기 단계 S302에서 생성된 출력 이미지를 임시 타겟 이미지로 설정한다. 즉, 상기 입력 이미지로부터 복원된 출력 이미지를 임시 타겟 이미지로 설정하는 것이다. 단계 S304에서, 고속 적응 장치는, 상기 단계 S302에서 생성된 출력 이미지에서 랜덤하게 일부 영역을 마스킹 처리하여 상기 이미지 인페이팅 신경망으로 입력한다. 일 실시예에서, 고속 적응 장치는, 0 혹은 1의 값으 로만 구성된 랜덤 바이너리 마스크를 생성하고, 상기 단계 S302에서 생성된 출력 이미지와 상기 랜덤 바이너리 마스크를 곱하기함으로써, 출력 이미지에서 랜덤하게 일부 영역을 마스킹 처리한다. 단계 S305에서, 고속 적응 장치는, 상기 이미지 인페인팅 신경망을 통해 상기 단계 S304에서 입력된 일부 영역이 마스킹 처리된 출력 이미지의 해당 마스킹 처리된 일부 영역을 복원하여 또 다른 출력 이미지를 생성한 다. 단계 S306에서, 고속 적응 장치는, 상기 단계 S305에서 생성된 출력 이미지와 상기 단계 S303에서 설정된 임시 타겟 이미지를 비교하여 손실값을 계산한다. 여기서 손실값은, 임시 타겟 이미지와 출력 이미지 간의 차이값으 로 정의할 수 있다. 바람직하게, 손실값을 계산하는데 있어서, 상기 이미지 인페인팅 신경망을 미리 학습 할 때 사용한 손실 함수를 변경없이 그대로 사용하거나 범용 손실 함수를 사용할 수 있다. 단계 S307에서, 고속 적응 장치는, 상기 단계 S306에서 계산된 손실값을 기초로 상기 이미지 인페인팅 신경망 의 파라미터를 업데이트한다. 고속 적응 장치는, 상기 손실값이 최소가 되도록, 상기 이미지 인페인팅 신 경망의 파라미터를 업데이트한다. 고속 적응 장치는, Adam, SGD, RMSPROP 등 기존의 최적화기(Optimize r)를 사용할 수 있다. 바람직하게, 고속 적응 장치는, 상기 이미지 인페인팅 신경망을 미리 학습할 때 사 용한 최적화기와 설정들을 이용하면 더욱 효과적으로 상기 이미지 인페인팅 신경망의 파라미터를 업데이트할 수 있다. 단계 S308에서, 고속 적응 장치는, 단계 S304 내지 단계 S307 과정이 소정 횟수 반복되었는지 확인한다. 소정 횟수 반복되지 않은 경우, 고속 적응 장치는, 단계 S304 내지 단계 S307 과정을 소정 반복 횟수까지 반복 수행 한다. 따라서, 소정 반복 횟수만큼 이미지 인페인팅 신경망의 파라미터가 업데이트된다. 이와 같이 단계 S304 내지 단계 S307 과정을 소정 반복 횟수까지 반복 수행한 후, 고속 적응 장치는, 단계 S309 에서, 이미지 인페인팅 신경망에서 마지막에 출력된 출력 이미지와, 단계 S301에 입력된 입력 이미지의 원 본 이미지, 즉 훼손되지 않은 실제 이미지를 비교하여 손실값을 계산한다. 단계 S310에서, 고속 적응 장치는, 상기 단계 S309에서 계산된 손실값을 기초로 상기 이미지 인페인팅 신경망 의 파라미터를 업데이트한다. 고속 적응 장치는, 상기 손실값이 최소가 되도록, 상기 이미지 인페인팅 신 경망의 파라미터를 업데이트한다. 단계 S311에서, 고속 적응 장치는, 상기 단계 S301에서 상기 단계 S310까지의 과정이 소정 반복 횟수만큼 반복 되었는지 확인한다. 소정 횟수 반복되지 않은 경우, 고속 적응 장치는, 입력 이미지를 변경하며 소정 반복 횟수 만큼 상기 단계 S301에서 상기 단계 S310까지를 반복 수행한다. 예컨대, 10회 반복인 경우, 10개의 서로 다른 입력 이미지 각각을 이용하여 단계 S301부터 단계 S310을 수행한다. 도 3을 참조하여 설명한 바와 같은 과정이 완료되면, 도 2를 참조하여 설명한 바와 같이, 이미지 인페인팅 신경 망의 파라미터는, 목적하는 파라미터의 위치 θ'에 빠르게 적응이 가능한 θ* 위치로 조정된다. 따라서, 이후의 테스트 타임에서 이미지 인페인팅 신경망의 파인튜닝을 적은 횟수만큼만 수행하면 된다. 도 4는 본 발명의 일 실시예에 따라 학습된 이미지 인페인팅 신경망을 파인튜닝하는 방법을 설명하는 흐름도이 다. 도 4를 참조하면, 단계 S401에서, 고속 적응 장치는, 일부 영역이 훼손된, 즉 마스킹 처리된 하나의 입력 이미 지를 학습이 완료된 이미지 인페인팅 신경망으로 입력한다. 여기서의 입력 이미지는 도 3을 참조하여 설명 한 방법에서 입력되는 입력 이미지와는 다른 이미지이다. 단계 S402에서, 고속 적응 장치는, 상기 이미지 인페인팅 신경망을 통해 상기 입력 이미지를 복원하여 출 력 이미지를 생성한다. 즉, 이미지 인페인팅 신경망은, 상기 일부 영역이 마스킹 처리된 하나의 입력 이미 지에 대해 미리 학습된 이미지 인페인팅 모델을 이용하여 상기 마스킹 처리된 일부 영역을 복원하여 출력 이미 지를 생성한다. 단계 S403에서, 고속 적응 장치는, 상기 단계 S402에서 생성된 출력 이미지를 타겟 이미지로 설정한다. 즉, 상 기 입력 영상으로부터 복원된 출력 이미지를 타겟 이미지로 설정하는 것이다. 단계 S404에서, 고속 적응 장치는, 상기 단계 S402에서 생성된 출력 이미지에서 랜덤하게 일부 영역을 마스킹 처리하여 상기 이미지 인페이팅 신경망으로 입력한다. 일 실시예에서, 고속 적응 장치는, 0 혹은 1의 값으 로만 구성된 랜덤 바이너리 마스크를 생성하고, 상기 단계 S402에서 생성된 출력 이미지와 상기 랜덤 바이너리 마스크를 곱하기함으로써, 출력 이미지에서 랜덤하게 일부 영역을 마스킹 처리한다. 단계 S405에서, 고속 적응 장치는, 상기 이미지 인페인팅 신경망을 통해 상기 단계 S404에서 입력된 일부 영역이 마스킹 처리된 출력 이미지의 해당 마스킹 처리된 일부 영역을 복원하여 또 다른 출력 이미지를 생성한 다. 단계 S406에서, 고속 적응 장치는, 상기 단계 S405에서 생성된 출력 이미지와 상기 단계 S403에서 설정된 타겟 이미지를 비교하여 손실값을 계산한다. 여기서 손실값은, 타겟 이미지와 출력 이미지 간의 차이값으로 정의할 수 있다. 바람직하게, 손실값을 계산하는데 있어서, 상기 이미지 인페인팅 신경망을 미리 학습할 때 사용 한 손실 함수를 변경없이 그대로 사용한다. 단계 S407에서, 고속 적응 장치는, 상기 단계 S406에서 계산된 손실값을 기초로 상기 이미지 인페인팅 신경망 의 파라미터를 업데이트한다. 고속 적응 장치는, 상기 손실값이 최소가 되도록, 상기 이미지 인페인팅 신 경망의 파라미터를 업데이트한다. 고속 적응 장치는, Adam, SGD, RMSPROP 등 기존의 최적화기(Optimize r)를 사용할 수 있다. 바람직하게, 고속 적응 장치는, 상기 이미지 인페인팅 신경망을 미리 학습할 때 사 용한 최적화기와 설정들을 이용하면 더욱 효과적으로 상기 이미지 인페인팅 신경망의 파라미터를 업데이트 할 수 있다.단계 S408에서, 고속 적응 장치는, 파인튜닝을 실시한 반복 횟수가 미리 설정된 임계값보다 작은지 확인하고, 반복 횟수가 임계값보다 작은 경우, 단계 S404부터 다시 반복하여, 미리 설정된 임계값만큼 파인튜닝을 반복한 다. 본 명세서는 많은 특징을 포함하는 반면, 그러한 특징은 본 발명의 범위 또는 특허청구범위를 제한하는 것으로 해석되어서는 안 된다. 또한, 본 명세서에서 개별적인 실시예에서 설명된 특징들은 단일 실시예에서 결합되어 구현될 수 있다. 반대로, 본 명세서에서 단일 실시예에서 설명된 다양한 특징들은 개별적으로 다양한 실시예에 서 구현되거나, 적절히 결합되어 구현될 수 있다. 도면에서 동작들이 특정한 순서로 설명되었으나, 그러한 동작들이 도시된 바와 같은 특정한 순서로 수행되는 것으로, 또는 일련의 연속된 순서, 또는 원하는 결과를 얻기 위해 모든 설명된 동작이 수행되는 것으로 이해되어 서는 안 된다. 특정 환경에서 멀티태스킹 및 병렬 프로세싱이 유리할 수 있다. 아울러, 상술한 실시예에서 다양 한 시스템 구성요소의 구분은 모든 실시예에서 그러한 구분을 요구하지 않는 것으로 이해되어야 한다. 상술한 프로그램 구성요소 및 시스템은 일반적으로 단일 소프트웨어 제품 또는 멀티플 소프트웨어 제품에 패키지로 구 현될 수 있다. 상술한 바와 같은 본 발명의 방법은 프로그램으로 구현되어 컴퓨터로 읽을 수 있는 형태로 기록매체(시디롬, 램, 롬, 플로피 디스크, 하드 디스크, 광자기 디스크 등)에 저장될 수 있다. 이러한 과정은 본 발명이 속하는 기술 분야에서 통상의 지식을 가진 자가 용이하게 실시할 수 있으므로 더 이상 상세히 설명하지 않기로 한다."}
{"patent_id": "10-2021-0033501", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "이상에서 설명한 본 발명은, 본 발명이 속하는 기술분야에서 통상의 지식을 가진 자에게 있어 본 발명의 기술적 사상을 벗어나지 않는 범위 내에서 여러 가지 치환, 변형 및 변경이 가능하므로 전술한 실시예 및 첨부된 도면 에 의해 한정되는 것이 아니다."}
{"patent_id": "10-2021-0033501", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 일 실시예에 따른 이미지 인페인팅 신경망의 고속 적응을 위한 고속 적응 장치의 구성을 나타 낸 도면이다. 도 2는 이미지 인페인팅 신경망의 통상적인 학습 및 파인튜닝과, 본 발명의 일 실시예에 따른 이미지 인페인팅 신경망의 고속 적응 및 파인튜닝을, 신경망의 파라미터 관점에서 비교한 도면이다. 도 3은 본 발명의 일 실시예에 따른 이미지 인페인팅 신경망의 고속 적응을 위한 학습 방법을 설명하는 흐름도 이다. 도 4는 본 발명의 일 실시예에 따른 학습된 이미지 인페인팅 신경망을 파인튜닝하는 방법을 설명하는 흐름도이 다."}
