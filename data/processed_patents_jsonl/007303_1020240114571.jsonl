{"patent_id": "10-2024-0114571", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2025-0033009", "출원번호": "10-2024-0114571", "발명의 명칭": "레이저 스펙클 대조도 이미징 기반의 다차원 ＣＮＮ을 이용한 혈관 정보 측정 방법", "출원인": "국립부경대학교 산학협력단", "발명자": "안예찬"}}
{"patent_id": "10-2024-0114571", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "장치의 프로세서에 의해 수행되는 혈관 정보 측정을 위한 레이저 스펙클 대조도 이미지 처리 방법에 있어서,레이저 스펙클 대조도 이미지에 대하여 합성곱 신경망을 이용하여 혈관 정보 출력 모델을 학습하는 단계; 학습된 상기 혈관 정보 출력 모델을 적용하여, 입력되는 대상 레이저 스펙클 대조도 이미지의 혈관이 포함된 이미지에 대한 상기 신경망의 수행 결과를 출력하는 단계; 및 상기 신경망의 수행 결과로부터 혈류 속도, 피부로부터 혈관까지의 깊이, 또는 혈관의 직경 중 하나 이상을 포함하는 혈관 정보를 산출하는 단계를 포함하는 이미지 처리 방법."}
{"patent_id": "10-2024-0114571", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 레이저 스펙클 대조도 이미지는, 카메라 노출 시간을 고정하고 촬영한 2차원 레이저 스펙클 대조도 이미지를 소정의 프레임 간격마다 획득하여 정렬한 복수의 이미지를 포함하는 데이터셋을 포함하는 이미지 처리 방법."}
{"patent_id": "10-2024-0114571", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제2항에 있어서,상기 데이터셋은, 카메라 촬영 시의 하나 이상의 노출 시간별 데이터셋을 포함하여 4차원으로 구성된 데이터셋을 포함하는 이미지 처리 방법."}
{"patent_id": "10-2024-0114571", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제1항에 있어서,상기 혈관 정보를 기초로 인체 조직이나 장기에 대한 생존 여부, 또는 인체의 조직 이식이나 조직 절제의 성공여부를 판단하기 위한 이미지 처리 방법."}
{"patent_id": "10-2024-0114571", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제1항에 있어서,상기 학습하는 단계는,합성곱 신경망의 특징 추출부, 클래스 분류부, 확률분포 계산부를 이용하여 상기 혈류 속도, 피부로부터 혈관까지의 깊이, 또는 혈관의 직경 중 어느 하나가 미리 정해지고, 나머지 중 하나 이상에 대한 혈관 정보를 추정하기 위한 상기 혈관 정보 출력 모델을 학습하는 단계를 포함하는 이미지 처리 방법."}
{"patent_id": "10-2024-0114571", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제1항에 있어서,상기 학습하는 단계는,합성곱 신경망의 특징 추출부, 클래스 분류부, 확률분포 계산부를 이용하여 상기 혈류 속도, 피부로부터 혈관까지의 깊이, 또는 혈관의 직경 중 어느 두개가 미리 정해지고, 나머지 한 개에 대한 혈관 정보를 추정하기 위한상기 혈관 정보 출력 모델을 학습하는 단계를 포함하는 이미지 처리 방법."}
{"patent_id": "10-2024-0114571", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "공개특허 10-2025-0033009-3-제1항에 있어서,상기 학습하는 단계는,합성곱 신경망의 특징 추출부, 클래스 분류부, 확률분포 계산부를 이용하여 상기 혈류 속도, 피부로부터 혈관까지의 깊이, 또는 혈관의 직경 중 어느 것도 미리 주어지지 않으며, 상기 혈류 속도, 피부로부터 혈관까지의 깊이, 혈관의 직경 중 하나 이상에 대한 혈관 정보를 추정하기 위한 상기 혈관 정보 출력 모델을 학습하는 단계를포함하는 이미지 처리 방법."}
{"patent_id": "10-2024-0114571", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제1항에 있어서,상기 학습하는 단계에서,활성화 함수(activation function)를 사용하여 입력되는 상기 레이저 스펙클 대조도 이미지가 상기 혈관정보의각 클래스에 속할 확률을 계산하고, 이 예측값과, 학습을 위하여 주어진 실제값 사이의 오차를 비용 함수(costfunction)를 사용하여 계산한 후, 이를 최소화하는 방향으로 신경망의 파라미터들을 업데이트하는 이미지 처리방법."}
{"patent_id": "10-2024-0114571", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제1항에 있어서,상기 학습하는 단계에서,상기 레이저 스펙클 대조도 이미지마다 실제값을 제공하기 위하여, 대상체의 광학성질을 파악하고 이를 적용한모사체를 준비하여, 알고 있는 혈관정보에 대하여 카메라를 이용하여 모사체의 레이저 스펙클 이미지를 촬영하고, 이를 이용하여 학습을 위한 레이저 스펙클 대조도 이미지를 준비시키는 이미지 처리 방법."}
{"patent_id": "10-2024-0114571", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제1항에 있어서,상기 학습하는 단계에서, 입력데이터, 3개의 3D 합성곱층, 2개의 3D 풀링층, 플랫튼층, 밀집 계층 또는 완전 연결 계층 및 확률분포 계산부를 포함하는 신경망을 이용하는 이미지 처리 방법."}
{"patent_id": "10-2024-0114571", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "장치에서 프로세서에 의해 수행되는 혈관 정보 측정을 위한 레이저 스펙클 대조도 이미지의 처리를 위한, 컴퓨터가 판독 가능한 코드를 기록한 기록 매체에 있어서, 레이저 스펙클 대조도 이미지에 대하여 합성곱 신경망을 이용하여 혈관 정보 출력 모델을 학습하는 기능; 학습된 상기 혈관 정보 출력 모델을 적용하여, 입력되는 대상 레이저 스펙클 대조도 이미지의 혈관이 포함된 이미지에 대한 상기 신경망의 수행 결과를 출력하는 기능; 및 상기 신경망의 수행 결과로부터 혈류 속도, 피부로부터 혈관까지의 깊이, 또는 혈관의 직경 중 하나 이상을 포함하는 혈관 정보를 산출하는 기능을 수행하기 위한 기록 매체."}
{"patent_id": "10-2024-0114571", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제11항에 있어서,상기 레이저 스펙클 대조도 이미지는, 카메라 노출 시간을 고정하고 촬영한 2차원 레이저 스펙클 대조도 이미지를 소정의 프레임 간격마다 획득하여 정렬한 복수의 이미지를 포함하는 데이터셋을 포함하는 기록 매체."}
{"patent_id": "10-2024-0114571", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "제12항에 있어서,공개특허 10-2025-0033009-4-상기 데이터셋은, 카메라 촬영 시의 하나 이상의 노출 시간별 데이터셋을 포함하여 4차원으로 구성된 데이터셋을 포함하는 기록 매체."}
{"patent_id": "10-2024-0114571", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_14", "content": "제11항에 있어서,상기 혈관 정보를 기초로 인체 조직이나 장기에 대한 생존 여부, 또는 인체의 조직 이식이나 조직 절제의 성공여부를 판단하기 위한 기록 매체."}
{"patent_id": "10-2024-0114571", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_15", "content": "제11항에 있어서,상기 학습하는 기능은,합성곱 신경망의 특징 추출부, 클래스 분류부, 확률분포 계산부를 이용하여 상기 혈류 속도, 피부로부터 혈관까지의 깊이, 또는 혈관의 직경 중 어느 하나가 미리 정해지고, 나머지 중 하나 이상에 대한 혈관 정보를 추정하기 위한 상기 혈관 정보 출력 모델을 학습하는 기능을 포함하는 기록 매체."}
{"patent_id": "10-2024-0114571", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_16", "content": "제11항에 있어서,상기 학습하는 기능은,합성곱 신경망의 특징 추출부, 클래스 분류부, 확률분포 계산부를 이용하여 상기 혈류 속도, 피부로부터 혈관까지의 깊이, 또는 혈관의 직경 중 어느 두개가 미리 정해지고, 나머지 한 개에 대한 혈관 정보를 추정하기 위한상기 혈관 정보 출력 모델을 학습하는 기능을 포함하는 기록 매체."}
{"patent_id": "10-2024-0114571", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_17", "content": "제11에 있어서,상기 학습하는 기능은,합성곱 신경망의 특징 추출부, 클래스 분류부, 확률분포 계산부를 이용하여 상기 혈류 속도, 피부로부터 혈관까지의 깊이, 또는 혈관의 직경 중 어느 것도 미리 주어지지 않으며, 상기 혈류 속도, 피부로부터 혈관까지의 깊이, 혈관의 직경 중 하나 이상에 대한 혈관 정보를 추정하기 위한 상기 혈관 정보 출력 모델을 학습하는 기능을포함하는 기록 매체."}
{"patent_id": "10-2024-0114571", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_18", "content": "제11항에 있어서,상기 학습하는 기능에서,활성화 함수(activation function)를 사용하여 입력되는 상기 레이저 스펙클 대조도 이미지가 상기 혈관정보의각 클래스에 속할 확률을 계산하고, 이 예측값과, 학습을 위하여 주어진 실제값 사이의 오차를 비용 함수(costfunction)를 사용하여 계산한 후, 이를 최소화하는 방향으로 신경망의 파라미터들을 업데이트하는 기록 매체."}
{"patent_id": "10-2024-0114571", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_19", "content": "제11항에 있어서,상기 학습하는 기능에서,상기 레이저 스펙클 대조도 이미지마다 실제값을 제공하기 위하여, 대상체의 광학성질을 파악하고 이를 적용한모사체를 준비하여, 알고 있는 혈관정보에 대하여 카메라를 이용하여 모사체의 레이저 스펙클 이미지를 촬영하고, 이를 이용하여 학습을 위한 레이저 스펙클 대조도 이미지를 준비시키는 기록 매체."}
{"patent_id": "10-2024-0114571", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_20", "content": "공개특허 10-2025-0033009-5-제11항에 있어서,상기 학습하는 기능에서, 입력데이터, 3개의 3D 합성곱층, 2개의 3D 풀링층, 플랫튼층, 밀집 계층 또는 완전 연결 계층 및 확률분포 계산부를 포함하는 신경망을 이용하는 기록 매체."}
{"patent_id": "10-2024-0114571", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 레이저 스펙클 대조도 이미징 기반의 다차원 CNN을 이용한 혈관 정보 측정 방법에 관한 것으로서, 본 발명의 장치의 프로세서에 의해 수행되는 혈관 정보 측정을 위한 레이저 스펙클 대조도 이미지의 처리 방법은, 레이저 스펙클 대조도 이미지에 대하여 합성곱 신경망을 이용하여 혈관 정보 출력 모델을 학습하는 단계, 학습된 상기 혈관 정보 출력 모델을 적용하여, 입력되는 대상 레이저 스펙클 대조도 이미지의 혈관이 포함된 이미지에 대한 상기 신경망의 수행 결과를 출력하는 단계, 및 상기 신경망의 수행 결과로부터 혈류 속도, 피부로부터 혈관 까지의 깊이, 또는 혈관의 직경 중 하나 이상을 포함하는 혈관 정보를 산출하는 단계를 포함할 수 있다."}
{"patent_id": "10-2024-0114571", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 레이저 스펙클 대조도 이미징(laser speckle contrast imaging) 기반의 이미지들을 다차원 CNN (Multidimension-Convolutional Neural Network, 다차원 합성곱 신경망) 학습 모델에 적용하여 혈관 깊이, 혈 관 크기(직경), 혈류 속도(또는 관류 속도) 등의 혈관 정보를 측정하는 방법에 관한 것이다."}
{"patent_id": "10-2024-0114571", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "레이저 스펙클 대조도 이미징은, 레이저 빔과 같이 간섭성이 강한 빛을 매끄럽지 못한 표면에 조사하여 간섭성 에 따라 표면에 형성되는 좁쌀 무늬와 같은 스펙클 패턴을 카메라로 촬영한 이미지를 획득하는 방법이다. 이와 같은 레이저 스펙클 대조도 이미징은 신체에 해를 가하지 않는 단일 파장의 근적외선 영역대 레이저와 카메라만 을 이용하여 혈액을 실시간으로 관찰할 수 있다는 점에서 많은 연구가 이루어지고 있다. 하지만 종래의 방법은 혈관의 관류 속도를 정성적으로 추정할 뿐 정확한 측정이 어렵고 대상체 외 물체의 움직임에 매우 취약하다는 한계점이 있다. 또한, 다중-노출 레이저 스펙클 이미지 기법을 통해 혈류 속도에 근접한 값을 얻어낼 수 있는 방법도 시도되고 있다. 그러나 이러한 방법도 과도한 연산작업을 처리할 수 있는 병렬 연산 장치가 추가적으로 필요하고 기존 이 미징 기법보다 이미지 산출 시간이 상대적으로 더 소요된다는 단점이 있다. 다차원 CNN 모델은 기존 인공지능 모델 중 하나인 2D CNN 모델을 3차원 또는 4차원으로 확장시킨 모델이며 기존 모델과 같이 이미지를 분석하는 목적으로 가장 널리 사용된다. 다차원 CNN 모델의 특징은 다차원 이미지 분석을 통해 기존 2차원 이미지에서 추출할 수 없었던 새로운 차원의 정보를 추출할 수 있도록 하고 있다. 레이저 스펙클 대조도 이미징과 관련한 선행 문헌으로서 특허출원 제 10-2015-0100515호(2015년07월15일), 제 10-2019-0027903호(2019년03월12일) 등이 참조될 수 있다."}
{"patent_id": "10-2024-0114571", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "따라서, 본 발명은 상술한 문제점을 해결하기 위하여 안출된 것으로, 본 발명의 목적은, 레이저 스펙클 대조도 이미징 기반의 이미지들을 다차원 CNN 학습 모델에 적용하여 혈관 깊이, 혈관 크기(직경), 혈류 속도(또는 관류 속도) 등의 혈관 정보를 측정하는 방법을 제공하는 데 있다."}
{"patent_id": "10-2024-0114571", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "먼저, 본 발명의 특징을 요약하면, 상기의 목적을 달성하기 위한 본 발명의 일면에 따른 장치의 프로세서에 의 해 수행되는 혈관 정보 측정을 위한 레이저 스펙클 대조도 이미지 처리 방법은, 레이저 스펙클 대조도 이미지에 대하여 합성곱 신경망을 이용하여 혈관 정보 출력 모델을 학습하는 단계; 학습된 상기 혈관 정보 출력 모델을 적용하여, 입력되는 대상 레이저 스펙클 대조도 이미지의 혈관이 포함된 이미지에 대한 상기 신경망의 수행 결 과를 출력하는 단계; 및 상기 신경망의 수행 결과로부터 혈류 속도, 피부로부터 혈관까지의 깊이, 또는 혈관의 직경 중 하나 이상을 포함하는 혈관 정보를 산출하는 단계를 포함할 수 있다. 상기 레이저 스펙클 대조도 이미지는, 카메라 노출 시간을 고정하고 촬영한 2차원 레이저 스펙클 대조도 이미지 를 소정의 프레임 간격마다 획득하여 정렬한 복수의 이미지를 포함하는 데이터셋을 포함할 수 있다. 상기 데이터셋은, 카메라 촬영 시의 하나 이상의 노출 시간별 데이터셋을 포함하여 4차원으로 구성된 데이터셋 을 포함할 수 있다. 상기 이미지 처리 방법은, 상기 혈관 정보를 기초로 인체 조직이나 장기에 대한 생존 여부, 또는 인체의 조직 이식이나 조직 절제의 성공 여부를 판단하기 위한 이미지 처리 방법을 제공한다.상기 학습하는 단계는, 합성곱 신경망의 특징 추출부, 클래스 분류부, 확률분포 계산부를 이용하여 상기 혈류 속도, 피부로부터 혈관까지의 깊이, 또는 혈관의 직경 중 어느 하나가 미리 정해지고, 나머지 중 하나 이상에 대한 혈관 정보를 추정하기 위한 상기 혈관 정보 출력 모델을 학습하는 단계를 포함할 수 있다. 상기 학습하는 단계는, 합성곱 신경망의 특징 추출부, 클래스 분류부, 확률분포 계산부를 이용하여 상기 혈류 속도, 피부로부터 혈관까지의 깊이, 또는 혈관의 직경 중 어느 두개가 미리 정해지고, 나머지 한 개에 대한 혈 관 정보를 추정하기 위한 상기 혈관 정보 출력 모델을 학습하는 단계를 포함할 수 있다. 상기 학습하는 단계는, 합성곱 신경망의 특징 추출부, 클래스 분류부, 확률분포 계산부를 이용하여 상기 혈류 속도, 피부로부터 혈관까지의 깊이, 또는 혈관의 직경 중 어느 것도 미리 주어지지 않으며, 상기 혈류 속도, 피 부로부터 혈관까지의 깊이, 혈관의 직경 중 하나 이상에 대한 혈관 정보를 추정하기 위한 상기 혈관 정보 출력 모델을 학습하는 단계를 포함할 수 있다. 상기 학습하는 단계에서, 활성화 함수(activation function)를 사용하여 입력되는 상기 레이저 스펙클 대조도 이미지가 상기 혈관정보의 각 클래스에 속할 확률을 계산하고, 이 예측값과, 학습을 위하여 주어진 실제값 사이 의 오차를 비용 함수(cost function)를 사용하여 계산한 후, 이를 최소화하는 방향으로 신경망의 파라미터들을 업데이트할 수 있다. 상기 학습하는 단계에서, 상기 레이저 스펙클 대조도 이미지마다 실제값을 제공하기 위하여, 대상체의 광학성질 을 파악하고 이를 적용한 모사체를 준비하여, 알고 있는 혈관정보에 대하여 카메라를 이용하여 모사체의 레이저 스펙클 이미지를 촬영하고, 이를 이용하여 학습을 위한 레이저 스펙클 대조도 이미지를 준비할 수 있다. 상기 학습하는 단계에서, 입력데이터, 3개의 3D 합성곱층, 2개의 3D 풀링층, 플랫튼층, 밀집 계층 또는 완전 연 결 계층 및 확률분포 계산부를 포함하는 신경망을 이용할 수 있다. 그리고, 본 발명의 다른 일면에 따른, 장치에서 프로세서에 의해 수행되는 혈관 정보 측정을 위한 레이저 스펙 클 대조도 이미지의 처리를 위한, 컴퓨터가 판독 가능한 코드를 기록한 기록 매체는, 레이저 스펙클 대조도 이 미지에 대하여 합성곱 신경망을 이용하여 혈관 정보 출력 모델을 학습하는 기능; 학습된 상기 혈관 정보 출력 모델을 적용하여, 입력되는 대상 레이저 스펙클 대조도 이미지의 혈관이 포함된 이미지에 대한 상기 신경망의 수행 결과를 출력하는 기능; 및 상기 신경망의 수행 결과로부터 혈류 속도, 피부로부터 혈관까지의 깊이, 또는 혈관의 직경 중 하나 이상을 포함하는 혈관 정보를 산출하는 기능을 수행할 수 있다."}
{"patent_id": "10-2024-0114571", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명에 따른 레이저 스펙클 대조도 이미징 기반의 다차원 CNN을 이용한 혈관 정보 측정 방법에 따르면, 레이 저 스펙클 대조도 이미징을 통해 획득된 이미지를 통해 다차원 CNN 모델을 학습시킨 후, 상기 학습된 모델을 통 해 대상 레이저 스펙클 이미지에서의 혈관 깊이, 혈관 크기(직경), 혈류 속도(또는 관류 속도) 등의 혈관 정보 를 측정할 수 있도록 하였다. 다차원 CNN를 통해 기존 레이저 스펙클 대조도 이미지를 통해서는 측정할 수 없었 던 관류 속도 등을 스펙클 대조도 이미지를 분석하여 관류 속도와 연관된 특징들을 추출하고 측정할 수 있게 한 것이다. 이와 같은 방법은 일반적인 레이저 스펙클 대조도 이미징 시스템에서 이미지를 획득하고 컴퓨터를 통하 여 상기 학습된 모델을 통해 분석이 이루어지므로 추가적인 장비의 도입 없이도 시스템 구성이 용이하도록 하였 다."}
{"patent_id": "10-2024-0114571", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하에서는 첨부된 도면들을 참조하여 본 발명에 대해서 자세히 설명한다. 이때, 각각의 도면에서 동일한 구성 요소는 가능한 동일한 부호로 나타낸다. 또한, 이미 공지된 기능 및/또는 구성에 대한 상세한 설명은 생략한다. 이하에 개시된 내용은, 다양한 실시 예에 따른 동작을 이해하는데 필요한 부분을 중점적으로 설명하며, 그 설명 의 요지를 흐릴 수 있는 요소들에 대한 설명은 생략한다. 또한 도면의 일부 구성요소는 과장되거나 생략되거나 또는 개략적으로 도시될 수 있다. 각 구성요소의 크기는 실제 크기를 전적으로 반영하는 것이 아니며, 따라서 각각의 도면에 그려진 구성요소들의 상대적인 크기나 간격에 의해 여기에 기재되는 내용들이 제한되는 것은 아 니다. 본 발명의 실시예들을 설명함에 있어서, 본 발명과 관련된 공지기술에 대한 구체적인 설명이 본 발명의 요지를 불필요하게 흐릴 수 있다고 판단되는 경우에는 그 상세한 설명을 생략하기로 한다. 그리고, 후술되는 용어들은 본 발명에서의 기능을 고려하여 정의된 용어들로서 이는 사용자, 운용자의 의도 또는 관례 등에 따라 달라질 수 있다. 그러므로 그 정의는 본 명세서 전반에 걸친 내용을 토대로 내려져야 할 것이다. 상세한 설명에서 사용되 는 용어는 단지 본 발명의 실시 예들을 기술하기 위한 것이며, 결코 제한적이어서는 안 된다. 명확하게 달리 사 용되지 않는 한, 단수 형태의 표현은 복수 형태의 의미를 포함한다. 본 설명에서, \"포함\" 또는 \"구비\"와 같은 표현은 어떤 특성들, 숫자들, 단계들, 동작들, 요소들, 이들의 일부 또는 조합을 가리키기 위한 것이며, 기술된 것 이외에 하나 또는 그 이상의 다른 특성, 숫자, 단계, 동작, 요소, 이들의 일부 또는 조합의 존재 또는 가능 성을 배제하도록 해석되어서는 안 된다. 또한, 제1, 제2 등의 용어는 다양한 구성요소들을 설명하는데 사용될 수 있지만, 상기 구성요소들은 상기 용어 들에 의해 한정되는 것은 아니며, 상기 용어들은 하나의 구성요소를 다른 구성요소로부터 구별하는 목적으로만 사용된다. 도 1은 본 발명의 일 실시예에 따른 이미지 처리 시스템을 설명하기 위한 도면이다. 도 1을 참조하면, 본 발명의 일 실시예에 따른 이미지 처리 시스템은, 레이저 광원, 광디퓨저(optical diffuser), 카메라, 및 이미지 처리 장치를 포함할 수 있다. 상기 이미지 처리 시스템은, 레이저 광원을 이용하여 레이저, 예를들어, 근적외선 파장 대역의 레이저 (예, 파장 785nm)를 발생시키고, 이를 광디퓨저를 이용해 분산된 레이저 광을 대상체에 조사한다. 이에 따라, 레이저 광이 대상체에 조사된 후 산란된 광은 카메라에서 촬영되며, 이와 같이 획득된 레이저 스펙 클 이미지들이 카메라와 연결된 이미지 처리 장치로 전송된다. 대상체는 혈관 정보를 획득하기 위한 대상으로서, 실제로는 인체 조직이나 장기 등일 수 있으며, 나아가 조직 이식 부위나 조직 절제 부위 등일 수 있다. 학습에는 실제의 인체 조직이나 장기 등을 대상체로서 이용할 수도 있고, 대상체 대신에 인체 조직 과 조직 내를 관통하는 혈관을 광학적으로 모사한 모사체를 이용하여 데이터셋을 학습시킬 수도 있다. 상기 모 사체는 조직 모사체에 파묻혀 있는 유체가 흐르는 튜브 형태의 유체관일 수 있다. 카메라는 대상체로부터의 상기 산란된 근적외선 레이저 광을 인식할 수 있는 이미지 센서를 구비한다. 카 메라는 노출 시간이 제어될 수 있는 장비이며, 카메라가 획득하는 이미지는 학습용 데이터셋을 구성하며, 하기하는 바와 같이 1msec와 같은 단일 노출 시간의 학습용 이미지가 획득될 수도 있고, 바람직하게는 1, 2, 3,,,,과 같은 다중 노출 시간에 대응된 이미지가 획득되어 학습에 이용될 수 있다. 카메라는 하기하는 바와 같이 혈관 깊이 등에 따라 그 초점거리가 조절되어 대상체에 대한 이미지 획득이 가능하며, 스펙클 정보를 손실 없이 샘플링하기 위해 f수(f number)를 조절할 수 있다. 도 2는 도 1의 이미지 처리 장치의 구체적인 블록도이다. 도 2를 참조하면, 이미지 처리 장치는 전처리부 및 학습부를 포함할 수 있다. 전처리부는 이미지 획득부, 이미지 처리부 및 이미지 전송부를 포함하며, 학습부는, 이미지 편집부, 신 경망 및 검증부를 포함할 수 있다. 카메라에서 획득된 레이저 스펙클 이미지를 레이저 스펙클 대조도 이미지로 변환하여 다차원 CNN 모델, 즉, 혈관 정보 출력 모델을 학습시키기 위한 이미지 처리 장치를 구성하는 전처리부와 학습부의 구 성 요소들 각각의 장치는, 반도체 프로세서와 같은 하드웨어, 응용 프로그램과 같은 소프트웨어, 또는 이들의 결합으로 구현될 수 있다. 또한, 이미지 처리 장치는 본 발명의 이미지 처리 과정의 수행을 위하여 필요한 데이터나 설정 정보 등을 저장하기 위한 메모리를 포함할 수 있다(도 11 참조). 여기서 전처리부와 학습부 의 구성 요소들, 즉, 이미지 획득부, 이미지 처리부 이미지 전송부, 이미지 편집부, 신경망 , 검증부 각각의 기능에 대하여 설명하지만, 이들 구성 요소들은 2 이상이 결합되어 하나의 블록으로 구현되는 것도 가능하다. 이하, 이미지 처리 장치의 프로세서에서 수행되는 전처리부와 학습부의 구성 요소들의 각 기능 을 자세히 설명한다. 예를 들어, 이미지 처리 장치는, 스마트폰, 노트북 PC, 데스크탑 PC 등 사용자 단말의 디스플레이 화면에, 본 발명의 다차원 CNN 모델인 혈관 정보 출력 모델을 통해 대상체에 대한 진단 과정과 그 결과로서 추정된 혈관이 포함된 이미지를 표시할 수 있도록 구현될 수 있으며, 이미지 처리 장치는, 이와 같은 과정의 수행 을 위하여 하드웨어, 소프트웨어, 또는 이들의 결합으로 이루어질 수 있다. 먼저, 이미지 획득부는, 카메라로부터 레이저 스펙클 이미지(들)을 수신하여 이미지 처리부로 전송한 다. 레이저 스펙클 이미지(들)은 소정의 포맷 또는 파일 형식으로 수신될 수 있다. 이미지 처리부는, 이미지 획득부로부터 수신된 각각의 레이저 스펙클 이미지를 레이저 스펙클 대조도 이 미지로 변환한다. 이미지 전송부는, 이미지 처리부에서 생성하는 레이저 스펙클 대조도 이미지를 실시간으로 디스플레이 장 치의 화면에 송출하거나 소정의 포맷 또는 파일 형식으로 메모리에 저장할 수 있다. 각각의 상기 레이저 스펙클 대조도 이미지는 예를 들어 2048x2048의 해상도를 가질 수 있으며(도 5 참조), 디스플레이 장치의 화면에서 30 fps의 속도로 재생될 수 있다. 이미지 전송부가 저장한 레이저 스펙클 대조도 이미지는 수동으로 또는 자동으로 이미지 편집부로 전달 되어 이미지 편집부에서 처리될 수 있다. 이미지 편집부는, 각각의 레이저 스펙클 대조도 이미지를 신경망의 혈관 정보 출력 모델(CNN 모델)의 학습에 적합한 크기로 편집한다. 예를 들어, 2048x2048의 이미지에서 학습 대상이 될 혈관(또는 모사체의 유체 흐름이 있는 유체관)이 포함된 관심 영역(ROI)을 선정하여 소정의 이미지의 크기(예, 25x25)로 편집하되, 촬영 시에 소정의 프레임 간격으로 획득된 레이저 스펙클 이미지의 레이저 스펙클 대조도 이미지에 대하여 소정의 개 수(예, 15개)를 묶어 정렬하여, 하나의 학습용 데이터셋을 구성하도록 한다. 이와 같은 예에서 미리 선정된 관 심 영역(ROI)에 대한 3차원(3D) 25x25x15 이미지들이 하나의 학습용 데이터셋을 구성하며, 이는 하기하는 바와 같이 카메라 촬영 시의 하나 이상의 노출 시간별로 구분지어 4차원(2차원 공간, 촬영시간, 노출시간)의 학습 용 데이터셋이 구성되어 혈관 정보 출력 모델(4D-CNN 모델)이 학습되도록 준비될 수 있다. 이미지 편집부는, 혈류 속도, 피부로부터 혈관까지의 깊이, 또는 혈관의 직경 등의 혈관 정보의 실제값 (ground trouth)에 대응된, 해당 정보별로 구분지어 관심 영역(ROI)에 대한, 하나 이상의 노출 시간별 3차원 25x25x15 이미지들의 학습용 데이터셋을 구성하여, 혈관 정보 출력 모델(4D-CNN 모델)이 학습되도록 준비할 수 있다. 신경망은, 상기 3D 또는 4D 레이저 스펙클 대조도 이미지에 대하여 합성곱 신경망을 이용하여 혈관 정보 출 력 모델(CNN 모델)을 학습한다. 신경망은, 크게 특징 추출부, 클래스 분류부, 확률분포 계산부로 나눌 수 있다. 상기 특징 추출부는 입력데이터, 다수의 합성곱층(convolutional layer)과 풀링층(pooling layer) 및 하 나의 플래튼층(flatten layer)으로 구성되고, 상기 클래스 분류부는 밀집 계층(dense layer) 또는 완전 연결 계 층(fully connected layer) 이라 불리는 다수의 층을 포함하며, 상기의 확률분포 계산부는 softmax 같은 활성화 함수(activation function)를 사용하여 상기 입력데이터가 각 클래스에 속할 확률을 계산하고 이를 예측값으로 삼는다. 이 예측값과, 학습을 위하여 주어진 실제값 사이의 오차를 크로스 엔트로피 함수(cross entropy function) 같은 비용 함수(cost function)를 사용하여 계산하고 이를 최소화하는 방향으로 신경망의 파라미 터들을 업데이트 함으로써 학습이 이루어 진다. 3D 레이저 스펙클 대조도 이미지 같은 경우에는 도 8과 같은 신 경망을 이용할 수 있다. 검증부는, 신경망에서 학습된 인공 지능 혈관 정보 출력 모델(CNN 모델)의 성능을 학습에서 사용되지 않은 데이터셋을 사용하여 평가하며, 실시예에 따른 본 발명에서는, 혈류 속도, 피부로부터 혈관까지의 깊이, 또는 혈관의 직경을 포함하는 혈관 정보 중 하나 이상을 산출하여 검증할 수 있다. 하기하는 바와 같이(도 9a 내지 도 10d 참조), 상기 혈관 정보 출력 모델을 평가하기 위한 컨퓨전 매트릭스(confusion matrix)에서의 예측 라벨과 트루 라벨이 일치하는 대각선 상의 레이저 스펙클 대조도 이미지들의 상기 신경망의 수행 결과를 기 초로 상기 혈관 정보 예측 성능을 평가한다. 이와 같이 검증부를 통해 검증된 혈관 정보 출력 모델(CNN 모델)은, 입력되는 진단 대상 레이저 스펙클 대 조도 이미지에 대하여 이미지 처리 장치에서 자동으로, 혈류 속도, 피부로부터 혈관까지의 깊이, 또는 혈 관의 직경 등 혈관 정보를 산출한다. 의사 등 전문가는 상기 혈관 정보를 기초로 인체 조직이나 장기에 대한 생 존 여부, 또는 인체의 조직 이식이나 조직 절제의 성공 여부를 판단할 수 있게 된다. 이와 같이 본 발명에 따른 이미지 처리 장치는, 레이저 스펙클 대조도 이미징을 통해 획득된 이미지를 통 해 혈관 정보 출력 모델(CNN 모델)을 학습시킨 후, 상기 학습된 모델을 통해 대상 레이저 스펙클 이미지에서의 혈관 깊이, 혈관 크기(직경), 혈류 속도(또는 관류 속도) 등의 혈관 정보를 용이하게 측정할 수 있도록 하였다. 다차원 CNN를 통해 기존 레이저 스펙클 대조도 이미지를 통해서는 정량적으로 측정할 수 없었던 관류 속도 등을 스펙클 대조도 이미지를 분석하여 관류 속도와 연관된 특징들을 추출하고 측정할 수 있게 한 것이다. 이와 같은 방법은 일반적인 레이저 스펙클 대조도 이미징 시스템에서 이미지를 획득하고 컴퓨터를 통하여 상기 학습된 모 델을 통해 분석이 이루어지므로 추가적인 장비의 도입 없이도 시스템 구성이 용이하도록 한 것이다. 이하 도 3의 이미지 처리 장치의 동작 흐름도와 도 4 내지 도 11의 참조 도면을 바탕으로 좀 더 자세히 설 명한다. 도 3은 본 발명의 레이저 스펙클 대조도 이미지의 처리를 수행하는 이미지 처리 장치의 동작 설명을 위한 흐름도이다. 도 3을 참조하면, 먼저, 이미지 처리 장치에서의 이미지 처리 대상으로서의 대상체를 결정한다(S1). 학 습에는 실제의 인체 조직이나 장기 등을 대상체로서 이용할 수도 있고, 대상체 대신에 인체 조직과 조직 내를 관통하는 혈관을 광학적으로 모사한 모사체를 이용하여 데이터셋을 학습시킬 수도 있다(S2). 상기 모사체 는 조직 모사체에 파묻혀 있는 유체가 흐르는 튜브 형태의 유체관일 수 있다. 대상체는 본 발명의 혈관 정보를 획득하기 위한 대상으로서의 인체의 체내/체외 조직 또는 장기 등일 수 있 다. 대상체는 광원의 파장이 잘 투과하여 혈관까지 도달할 수 있는 조직 또는 장기일 수 있다. 예시적인 임상 상황으로서, 대상체의 혈관 정보가 인체 조직이나 장기에 대한 생존 여부, 또는 인체의 조직 이식이나 조직 수술 성공 여부를 알려주도록, 혈관문합술, 피부이식, 수술중 부갑상선 보존 등을 염두에 둘 수 있다. 대 상체의 혈관 정보가 육안으로 보이지 않거나 보이더라도 다른 조직과 경계선이 모호하여 제대로 분간할 수"}
{"patent_id": "10-2024-0114571", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "없는 경우 본 발명의 효과가 극대화되도록 할 수 있다. 본 발명을 통해 대상체의 혈관 정보를 획득할 경우 조직의 이식(문합)이 성공적으로 이루어졌는지를 평가하거나, 조직 절제 등의 상황에서 보존해야 할 혈관을 잃 지 않도록 사전에 방지할 수 있게 된다. 대상체가 생체 조직인 경우, 투과 깊이를 고려해 근적외선(예를 들어 785nm 대역) 영역의 파장대를 갖는 광 원이 사용된다. 대상체가 조사받는 레이저 광에 따라 반응하는 물리적인 성질로서 광학 성질을 가지며, 본 발명에서 대상체의 광학성질은 소정의 투과계수(absorption coefficient, μa)와 감쇠된 산란 계수 (reduced scattering coefficient, μs')를 갖도록 특정될 수 있다.대상체를 대신할 모사체는, 대상체의 광학성질과 동일하거나 유사한 조직을 포함하며, 혈관 정보를 포함 할 수 있도록 피부와 유사한 재질 내부에 유체관과 유체관 내의 유체가 흐르도록 구성될 수 있다. 상기 유체관 내에 흐르는 유체는 혈액과 광학적 및 유변학적으로 유사한 성질을 가지며 본 발명과 같이 785nm 대역의 근적외 선을 유사하게 산란시킬 수 있는 유체로 특정될 수 있다. 상기 모사체의 구성은 대상체의 광학 성질에 따라 달라진다. 상기 신경망에서 인공 지능 혈관 정보 출력 모델의 학습에서, 상기 활성화 함수(activation function)를 사 용하여, 입력되는 상기 레이저 스펙클 대조도 이미지가 상기 혈관정보의 각 클래스에 속할 확률을 계산하고, 이 예측값과, 학습을 위하여 주어진 실제값 사이의 오차를 비용 함수(cost function)를 사용하여 계산한 후, 이를 최소화하는 방향으로 신경망의 파라미터들을 업데이트하게 된다. 이를 위하여, 상기 레이저 스펙클 대조도 이미 지마다 상기 실제값을 제공하기 위하여, 대상체의 광학성질을 파악하고 이를 적용한 모사체를 준비하여, 알고 있는 혈관정보에 대하여 카메라를 이용하여 모사체의 레이저 스펙클 이미지를 촬영하고, 이를 이용하여 학습을 위한 레이저 스펙클 대조도 이미지를 준비할 수 있다. 본 발명의 실시예에서는 대상체를 피하 지방조직으로, 모사체는 돼지의 지방조직 내부에 외직경 5mm, 내직경 4mm의 PVC(Polyvinyl chloride) 유체관을 배치하고 유체관 내부에는 인지질을 물과 5%v/v로 섞은 유체를 주사기 펌프를 이용하여 유속을 조절하여 유체 흐름이 이루어지도록 구성하였다. 이때, 흐르는 유체는 레이저 광을 산 란시킬 수 있는 인지질을 물과 섞어 사용하였다. 본 실시예에서는 유체의 관류 속도를 주사기 펌프를 이용하여 조절하였다. 조절한 속도는 0.22mm/sec에서 1.76mm/sec까지의 속도를 0.22mm/sec 단위로 나누어 총 8개의 속도 를 구분하여 실시하였다(도 4 참조). 이와 같이 대상체 또는 모사체가 준비되면, 레이저 광원을 이용하여 레이저, 예를들어, 근적외선 파장 대 역의 레이저(예, 파장 785nm)를 발생시키고, 이를 광디퓨저를 이용해 분산된 레이저 광을 대상체에 조사 한다. 이에 따라, 레이저 광이 대상체에 조사된 후 산란된 광은 카메라에서 촬영되며, 이와 같이 획득된 레이저 스펙클 이미지들이 카메라와 연결된 이미지 처리 장치로 전송된다(S3). 각각의 레이저 스펙클 이미지는 예를 들어 2048x2048의 해상도를 가질 수 있으며(도 5 참조), 30 fps의 속도로 획득되고 전송될 수 있 다. 카메라는 대상체로부터의 상기 산란된 근적외선 레이저 광을 인식할 수 있는 이미지 센서를 구비한다. 카 메라는 프레임 속도 및 노출 시간이 제어될 수 있는 장비이며, 카메라가 획득하는 이미지는 학습용 데이 터셋을 구성하며, 하기하는 바와 같이 1msec와 같은 단일 노출 시간의 학습용 이미지가 획득될 수도 있고, 바람 직하게는 1, 2, 3,,,,과 같은 다중 노출 시간에 대응된 이미지가 획득되어 학습에 이용될 수 있다. 카메라는 혈관 깊이 등에 따라 그 초점거리가 조절되어 대상체에 대한 이미지 획득이 가능하며, 스펙클 정보를 손실 없이 샘플링하기 위해 f수(f number)를 조절할 수 있다. 실시예에서, 대상체로서의 모사체를 이용한 실험은 다음과 같다. 즉, 광원은 충분한 광량(예, 150mA의 레 이저 다이오드 출력)으로 레이저를 발생시키며, 레이저를 넓은 영역에 조사할 수 있도록 광디퓨저가 이용된 다. 카메라가 획득하는 레이저 스펙클 이미지는 Nyquist 조건을 만족한다. 카메라의 이미지 센서의 픽셀 은 아래 식과 같은 최소 스펙클 크기(dmin)의 1/2 이하일 수 있다."}
{"patent_id": "10-2024-0114571", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "여기서, M은 카메라의 배율, λ는 광원의 레이저의 파장, f/#는 카메라의 f number이다. 본 발명의 실 시예에서 카메라의 배율은 약 10.4, 파장은 785 nm, f number는 2.8이었으며, 측정한 dmin은 약 30μm이며, 사용된 카메라 이미지 센서의 픽셀 사이즈는 5μm*5μm로서 Nyquist 조건을 만족한다. 신경망의 혈관 정보 출력 모델(다차원 CNN 모델)을 통해, 혈류(또는 모사체의 유체) 속도, 피부로부터 혈관 까지의 깊이(또는 모사체 표면에서 유체관까지의 깊이), 또는 혈관의 직경(유체관 직경) 등 혈관 정보를 얻는 것을 목표로 할 수 있다. 예를 들어, 혈류(또는 모사체의 유체) 속도는 0.22mm/s에서 1.76mm/s까지 0.22의 간격 을 두고 총 8개의 속도를 조절하였다. 대상체 내부 혈류(또는 유체)의 속도에 따라 이미지가 더 어둡게(스펙 클 대조도 K 값이 낮게) 나오는 것을 이용하고자 하였다(도 4 참조). 또한, 피부로부터 혈관까지의 깊이(또는 모사체 표면에서 유체관까지의 깊이)는 2mm, 3mm, 4mm, 5mm,,,등으로 나누어 진행하였다(도 4 참조). 나아가, 혈관의 직경(유체관 직경)에 대하여도 적절한 크기로 나누어 진행할 수 있다. 이미지 획득부는, 카메라로부터 레이저 스펙클 이미지(들)을 수신하여 이미지 처리부로 전송하고, 이 미지 처리부는, 이미지 획득부로부터 수신된 각각의 레이저 스펙클 이미지를 레이저 스펙클 대조도 이미 지로 변환한다(S4). 레이저 광과 같이 간섭성이 강한 빛을 매끄럽지 못한 표면에 조사하게 되면, 간섭성에 따라 표면에 좁쌀 무늬를 형성하며, 이를 스펙클 패턴이라고 한다. 물체의 표면의 상태에 변화가 있으면 스펙클 패턴이 변화하고, 이를 분석하면 물체의 변형 전/후의 변형 정보를 알 수 있다. 레이저 스펙클 대조도 (K)는 아래의 식과 같이 표현된 다. 여기서, K 은 레이저 스펙클 대조도 값, σ는 이미지의 화소값들(N*N) 행렬의 화소값 표준편차, I는 이미지 의 화소값들(N*N) 행렬의 값의 화소값 평균이다."}
{"patent_id": "10-2024-0114571", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "이미지 처리부는, 레이저 스펙클 이미지의 스펙클 패턴을 분석하여 레이저 스펙클 대조도 (K)를 알 수 있는 화소값들을 갖는 레이저 스펙클 대조도 이미지를 생성할 수 있다. 이미지 처리부는, 잘 알려진 시간 기반의 연산, 공간 기반의 연산법 등을 이용하여 레이저 스펙클 대조도 영상을 획득할 수 있다. 한편, 이미지 전송부가 저장한 레이저 스펙클 대조도 이미지는 이미지 편집부에서 학습에 적합한 크기로 편집되고 정렬되며, 신경망은, 이미지 편집부에서 편집되어 정렬된 레이저 스펙클 대조도 이미지의 데 이터셋(예, 25x25x15)에 대하여 합성곱 신경망을 이용하여 혈관 정보 출력 모델(CNN 모델)을 학습한다(S4). 이미지 편집부는 위에서도 기술한 바와 같이 카메라 촬영 시의 하나 이상의 노출 시간별 3D 레이저 스펙 클 대조도 이미지의 데이터셋(예, 25x25x15)을 생성하되, 혈류 속도별(소정의 속도 간격), 피부로부터 혈관까지 의 깊이별(소정의 깊이 간격), 또는 혈관의 직경별(소정의 직경 간격) 등의 실제값 (ground trouth)에 대응된, 해당 정보별로 구분지어, 하나 이상의 노출 시간별로 획득된 2차원 레이저 스펙클 대조도 이미지 내의 다양한 관심영역(ROI) (예 25x25)의 시작 시간이 다른 연속적인 프레임(예, 15개)으로 학습용 데이터셋을 구성한다. 또한, 이미지 편집부는 상기 편집되고 정렬된 데이터셋을 신경망으로 전송하기 전에 보다 정확한 특징 분석이 이루질 수 있도록 전처리한 후, 신경망으로 전송할 수도 있다. 예를 들어, 이미지 편집부는 상 기 편집되고 정렬된 데이터셋에 대하여 시공간에서 푸리에 도메인(Fourier Domain) 분석, 웨이블렛 변환 (Wavelet transform)과 분석 등을 이용한 필터링 등의 기법으로 실험적인 노이즈를 적절히 제거할 수 있다. 도 5는 본 발명의 레이저 스펙클 대조도 이미지의 관심 영역에 대한 학습 데이터셋의 준비를 설명하기 위한 도 면이다. 도 5를 참조하면, 어떤 노출 시간에서의 다양한 혈류 속도에 대한 레이저 스펙클 대조도 이미지(예, 2048x2048) 540 프레임(약 18초)에 대하여(S51), 하나의 관심 영역(ROI)(예, 25x25)에서 15 프레임 마다의 3차원 이미지들 (예, 25x25x15)을 예시하였고(S52), 같은 방법으로 다른 관심 영역(ROI)에 대하여도 다양한 혈류 속도에 대한 3 차원 이미지들(예, 25x25x15)이 준비될 수 있다(S53). 또한, 같은 방법으로 다른 촬영 시작 시간에 대하여도(예, 프레임 번호 1~15, 2~16, 3~17쪋 등) 다양한 혈류 속도에 대한 3차원 이미지들(예, 25x25x15)이 준비될 수 있다(S53). 또한, 이와 유사한 방법으로, 피부로부터 혈관까지의 깊이별(소정의 깊이 간격), 또는 혈관의 직경별(소정의 직 경 간격) 등의 혈관 정보에 대하여도, 3차원 이미지들(예, 25x25x15)의 데이터셋이 준비될 수 있다. 도 6은 본 발명의 학습 데이터셋에서의 혈류 속도와 시간 평균 레이저 스펙클 대조도의 상관 관계를 다른 혈관 깊이별로 나타내는 예시적인 그래프이다. 도 6에서 혈관 깊이 2, 3, 4, 5mm 각각에 대한 혈류 속도별 시간 평균 대조도의 관계를 나타내었으며, 오차 막대는 시간 변화에 대한 대조도의 표준 편차를 나타낸다. 도 6과 같이, 혈류 속도의 증가에 따라 상기 시간 평균 대조도가 감소하는 일반적인 경향을 보이지만 상기 표준 편차가 상당히 커서, 어떤 특정 시간에 시간 평균되지 않은 순간 대조도가 주어질 때 도 6만으로는 혈류 속도와 혈관 깊이를 동시에 특정하기 모호한 면이 있다. 이는 순간 레이저 스펙클 대조도의 시간에 따른 변화(도 7a 내 지 도 7d)를 보면 확연히 알 수 있다. 따라서, 상기 시간 평균 대조도 차트 보다는 시간 평균되지 않은 순간 대조도의 시간에 따른 변화 양상을 관찰 하면 혈관 정보를 보다 정확히 예측할 수 있다. 이는 그 변화 양상이 혈관 정보(속도, 깊이, 직경)를 암시하고 있기 때문이다.도 7a 내지 도 7d는 본 발명의 학습 데이터셋에서의 시간 평균되지 않은 순간 레이저 스펙클 대조도의 시간에 따른 변화에 대한 예시적인 그래프이다. 도 7a 내지 도 7d 각각은 혈관 깊이 2, 3, 4, 5mm 각각에 대한 시간(프 레임) 변화에 따른 혈류 속도별(위 0.22 mm/s, 아래 1.76mm/s) 상기 순간 대조도의 변화를 나타내었다. 도 7a 내지 도 7d와 같이, 혈관 깊이가 커짐에 따라 대조도의 변화는 크게 나타나며 이와 같은 대조도의 변화의 특징은 신경망을 통해 혈관 정보 출력 모델(CNN 모델)로 학습되어, 혈관 정보, 즉, 혈류 속도, 피부로부터 혈관까지의 깊이, 또는 혈관의 직경 등에 대한 특징적인 정보를 파악할 수 있도록 할 수 있다. 한편, 신경망은, 상기 레이저 스펙클 대조도 이미지에 대하여 합성곱 신경망을 이용하여 혈관 정보 출력 모 델(CNN 모델)을 학습한다(S4). 도 8은 본 발명의 학습부의 신경망에서의 입력데이터, 다수의 합성곱층(convolutional layer)과 풀링 층(pooling layer), 플래튼층(flatten layer), 밀집 계층(dense layer) 또는 완전 연결 계층(fully connected layer), 활성화 함수(activation function)의 구성을 설명하기 위한 도면이다. 도 8을 참조하면, 신경망은, 본 실시예에서 다층 퍼셉트론에 따른 3개의 3D 합성곱층(21, 23, 25), 2개의 3D 풀링층(22, 24), 플래튼층, 및 밀집 계층을 포함할 수 있다. 상기 3D 합성곱층과 상기 3D 풀링층은 번갈아 적용된다. 상기 3D 풀링층(22/24)을 거치면 데이터의 크기가 각각 절반으로 줄어들게 되며, 상기 3D 합 성곱층(21, 23, 25)과 상기 3D 풀링층(22, 24)에 입력되는 데이터의 크기가 변함에 따라 각 층에 해당하는 적절 한 크기의 필터 사이즈와 풀(pool) 사이즈가 정해져 있다. 예를 들어, 3D 합성곱층(21, 23, 25)은 각각 필터 사이즈 7x7x5, 필터수 10, 동일 패딩(same padding)을 적용 하고, 활성화 함수로서 잘 알려진 'RELU' 함수를 적용하였다. 또한, 3D 풀링층(22, 24)은 풀(pool) 사이즈 2x2x2, 스트라이드 사이즈(stride size) 2를 적용하였다. 이에 따라, 입력 데이터(S21)의 사이즈가 25x25x15인 경우에, 제1 3D 합성곱층과 제1 풀링층의 연산으 로 사이즈가 12x12x7로 특징맵이 축소(S22)되고, 제2 3D 합성곱층과 제2 3D 풀링층의 연산으로 사이즈 가 6x6x3로 특징맵이 축소(S24)되고, 이후 제3 3D 합성곱층을 적용한 후 평탄화(flatten)(S26)하여 혈관 정 보의 예측을 위한 특징맵을 추정하고, 다수의 밀집 계층에서 각 클래스로 분류된 뒤, 활성화 함수(예, softmax)의 연산을 적용하여 혈관 정보의 예측을 위한 확률적인 값들을 출력할 수 있다(S26). 이와 같은 신경망을 통해 혈관 정보 출력 모델이 학습되어, 혈관 정보 출력 모델에서 추정된 이미지(특징맵)를 통해, 혈관 정보, 즉, 혈류 속도, 피부로부터 혈관까지의 깊이, 또는 혈관의 직경 등에 대한 특징적인 정보를 파악할 수 있도록 할 수 있다. 이와 같은 혈관 정보 출력 모델은, 입력되는 레이저 스펙클 대조도 이미지(S21)에 대하여, 혈류 속도, 피부로부 터 혈관까지의 깊이, 또는 혈관의 직경 등의 혈관 정보를 추정하기 위한 파라미터를 업데이트하도록 학습하게 된다. 즉, 신경망의 반복 학습을 통하여, 혈관 정보 출력 모델이 더 정확하게 혈관 정보의 예측을 위한 이 미지(특징맵)을 추정하고, 혈관 정보에 대한 확률적인 값들을 출력할 수 있도록, 혈관 정보 출력 모델에서의 혈 관 정보를 추정하기 위한 파라미터 또는 하이퍼 파라미터가 업데이트될 수 있다. 상기 파라미터들은 신경망(1 1)에 사용되는 풀링 크기, 커널 크기, 필터 수, 에포크 수, 배치 크기 등 다양한 정보를 포함할 수 있다. 예를 들어, 상기와 같은 다층 퍼셉트론에 따른 다수의 합성곱층들(21, 23, 25)과 다수의 풀링층(22, 24)을 이용 하여, 이와 같은 혈관 정보 출력 모델의 학습이 이루어짐으로써, 혈류 속도별로 정렬된 복수의 상기 레이저 스 펙클 대조도 이미지(S21)에서의 미리 선정된 각 관심 영역(ROI)에 대하여 학습하여, 혈관 정보 출력 모델의 피 부로부터 혈관까지의 깊이, 혈관의 직경 등의 혈관 정보를 추정하기 위한 파라미터가 업데이트될 수 있다. 또한, 상기와 같은 다층 퍼셉트론에 따른 다수의 합성곱층들(21, 23, 25)과 다수의 풀링층(22, 24)을 이용하여, 이와 같은 혈관 정보 출력 모델의 학습이 이루어짐으로써, 피부로부터 혈관까지의 깊이별로 정렬된 복수의 상기 레이저 스펙클 대조도 이미지(S21)에서의 미리 선정된 각 관심 영역(ROI)에 대하여 학습하여, 혈관 정보 출력 모델에서의 혈류 속도, 혈관의 직경 등의 혈관 정보를 추정하기 위한 파라미터가 업데이트될 수 있다. 나아가, 상기와 같은 다층 퍼셉트론에 따른 다수의 합성곱층들(21, 23, 25)과 다수의 풀링층(22, 24)을 이용하 여, 이와 같은 혈관 정보 출력 모델의 학습이 이루어짐으로써, 혈관의 직경별로 정렬된 복수의 상기 레이저 스 펙클 대조도 이미지(S21)에서의 미리 선정된 각 관심 영역(ROI)에 대하여 학습하여, 혈관 정보 출력 모델의 혈 류 속도, 피부로부터 혈관까지의 깊이 등의 혈관 정보를 추정하기 위한 파라미터가 업데이트될 수 있다. 다른 한편, 검증부는, 신경망에서 학습된 인공 지능 혈관 정보 출력 모델의 성능을 학습에서 사용되지 않은 데이터셋을 사용하여 평가하며, 실시예에 따른 본 발명에서는, 혈류 속도, 피부로부터 혈관까지의 깊이, 또는 혈관의 직경을 포함하는 혈관 정보 중 하나 이상을 산출하여 검증할 수 있다. 특히, 하기하는 바와 같이 (도 9a 내지 도 10d 참조), 상기 혈관 정보 출력 모델을 평가하기 위한 컨퓨전 매트릭스(confusion matrix)에서 의 예측 라벨과 트루 라벨이 일치하는 대각선 상의 레이저 스펙클 대조도 이미지들의 상기 신경망의 수행 결과를 기초로 상기 혈관 정보 예측 성능을 평가한다. 이와 같은 상기 신경망을 통한 상기 혈관 정보 출력 모델의 학습은, 다음과 같이 크게 3가지, 세부적으로는 7가지 경우로 나누어 고려되어 수행될 수 있다. 예를 들어, 첫째, 상기 혈류 속도, 피부로부터 혈관까지의 깊이, 또는 혈관의 직경 중 어느 하나가 미리 정해지 고, 나머지 중 하나 이상에 대한 혈관 정보를 추정하기 위한 상기 혈관 정보 출력 모델의 학습이 수행될 수 있 다. 이러한 학습 과정에서는 혈류 속도가 미리 정해진 경우, 피부로부터 혈관까지의 깊이, 또는 혈관의 직경 중 하나 이상에 대한 혈관 정보를 추정하기 위한 학습이 이루어지는 것과 같이, 나머지 혈관 정보에 대하여도 마찬 가지로 어느 하나를 미리 알거나 주어진 값을 사용하면 되므로, 총 3가지 케이스의 학습 방법이 있을 수 있다. 또한, 둘째, 상기 혈류 속도, 피부로부터 혈관까지의 깊이, 또는 혈관의 직경 중 어느 두개가 미리 정해지고, 나머지 한 개에 대한 혈관 정보를 추정하기 위한 상기 혈관 정보 출력 모델의 학습이 수행될 수도 있다. 이러한 학습 과정에서는 혈류 속도와 피부로부터 혈관까지의 깊이가 미리 정해진 경우, 혈관의 직경에 대한 혈관 정보 를 추정하기 위한 학습이 이루어지는 것과 같이, 나머지 혈관 정보에 대하여도 마찬가지로 어느 두개를 미리 알 거나 주어진 값을 사용하면 되므로, 총 3가지 케이스의 학습 방법이 있을 수 있다. 또한, 셋째, 상기 혈류 속도, 피부로부터 혈관까지의 깊이, 또는 혈관의 직경 중 어느 것도 미리 주어지지 않으 며, 상기 혈류 속도, 피부로부터 혈관까지의 깊이, 혈관의 직경 중 하나 이상에 대한 혈관 정보를 추정하기 위 한 상기 혈관 정보 출력 모델의 학습이 수행될 수도 있는 것이다. 이는 상기 혈류 속도, 피부로부터 혈관까지의 깊이, 또는 혈관의 직경 중 어느 것도 알려지지 않은 경우에, 상기 혈류 속도, 피부로부터 혈관까지의 깊이, 혈 관의 직경 중 하나 이상에 대한 혈관 정보를 추정하도록 학습이 이루어지는 케이스이다. 도 9a는 혈관 깊이를 모를 때 본 발명의 혈류 속도의 예측에 대한 예시적인 도면이다. 여기서, 예를 들어, 예측 라벨과 트루 라벨에서의 혈류 속도가, 0은 0.22mm/s, 7은 1.76mm/s에 대응된다. 도 9a에서는 전체 대조도 이미 지들의 개수에 대한 대각선 상의 대조도 이미지들의 비율, 즉, 정확도가 0.8인 경우를 예시하였다. 도 9b는 혈류 속도를 모를 때 본 발명의 혈관 깊이의 예측에 대한 예시적인 도면이다. 여기서, 예를 들어, 예측 라벨과 트루 라벨에서의 혈관 깊이가, 0은 2mm, 트루 라벨 3은 5mm에 대응된다. 도 9b에서는 전체 대조도 이미 지들의 개수에 대한 대각선 상의 대조도 이미지들의 비율, 즉, 정확도가 0.98인 경우를 예시하였다. 도 9a 및 도 9b와 같이, 상기 신경망의 학습이 이루어지면서, 상기 혈관 정보 출력 모델을 평가하기 위한 컨퓨전 매트릭스(confusion matrix)에서, 가로축의 예측 라벨(predicted label)(예, 8개)과 세로축의 트루 라 벨(true label)(예, 8개)이 일치하는 대각선(910/920) 상에 대응된 레이저 스펙클 대조도 이미지들이 개수가 많 아질 수 있으며, 이러한 대각선 상에 대응된 레이저 스펙클 대조도 이미지들의 상기 신경망의 수행 결과는 상기 혈관 정보를 정확히 추정하도록 상기 신경망의 파라미터를 업데이트하기 위한 기초가 될 수 있다. 도 10a 내지 도 10d는 혈관 깊이를 알고 있을 때 본 발명의 각 혈관 깊이별 혈류 속도의 예측에 대한 예시적인 도면이다. 여기서, 예를 들어, 예측 라벨과 트루 라벨에서의 혈류 속도가, 0은 0.22mm/s, 7은 1.76mm/s에 대응 된다. 도 10a는 혈관 깊이가 2mm로 미리 알고 있는 경우, 도 10a는 혈관 깊이가 3mm로 미리 알고 있는 경우, 도 10c는 혈관 깊이가 4mm로 미리 알고 있는 경우, 도 10d는 혈관 깊이가 5mm로 미리 알고 있는 경우를 나타낸다. 특히, 도 9a의 혈관 깊이를 모를 때 보다, 정확도가 0.95 이상으로 증가하는 것을 확인할 수 있었다. 다른 한편, 검증부는, 신경망에서 학습된 인공 지능 혈관 정보 출력 모델의 성능을 평가하며, 실시예에 따른 본 발명에서는, 혈류 속도, 피부로부터 혈관까지의 깊이, 또는 혈관의 직경을 포함하는 하나 이상의 혈관 정보를 산출하여 검증할 수 있다. 이상적인 경우 100%의 정확도를 가지나 대상체 혹은 임상 환경의 특성에 따라 적절한 값의 정확도를 갖는 경우 검증에 성공한 것으로 볼 수 있다. 검증을 완료한 경우 실제 임상 상황에 적용 이 가능하다. 만약 정확도가 충분하지 못한 경우 피드백 단계(S6)를 거쳐 해당 오차 정보를 반영하도록 혈관 정 보 출력 모델의 학습이 추가적으로 이루어질 수 있다. 이와 같이 검증을 통해 검증된 혈관 정보 출력 모델은, 입력되는 진단 대상 레이저 스펙클 대조도 이미지에 대 하여 이미지 처리 장치에서 자동으로, 혈류 속도, 피부로부터 혈관까지의 깊이, 또는 혈관의 직경 등 혈관 정보를 산출한다. 의사 등 전문가는 상기 혈관 정보를 기초로 인체 조직이나 장기에 대한 생존 여부, 또는 인체 의 조직 이식이나 조직 절제의 성공 여부를 판단할 수 있게 된다. 상술한 바와 같이, 본 발명에 따른 이미지 처리 장치에서의 레이저 스펙클 대조도 이미징 기반의 다차원 CNN을 이용한 혈관 정보 측정 방법에 따르면, 레이저 스펙클 대조도 이미징을 통해 획득된 이미지를 통해 다차 원 CNN 모델을 학습시킨 후, 상기 학습된 모델을 통해 대상 레이저 스펙클 이미지에서의 혈관 깊이, 혈관 크기 (직경), 혈류 속도(또는 관류 속도) 등의 혈관 정보를 측정할 수 있다. 다차원 CNN를 통해 기존 레이저 스펙클 대조도 이미지를 통해서는 정량적으로 측정할 수 없었던 관류 속도 등을 스펙클 대조도 이미지를 분석하여 관류 속도와 연관된 특징들을 추출하고 측정할 수 있게 한 것이다. 이와 같은 방법은 일반적인 레이저 스펙클 대조도 이미징 시스템에서 이미지를 획득하고 컴퓨터를 통하여 상기 학습된 모델을 통해 분석이 이루어지므로 추가적인 장비의 도입 없이도 시스템 구성이 용이하도록 한 것이다. 도 11은 본 발명의 일 실시예에 따른 이미지 처리 장치의 구현 방법의 일례를 설명하기 위한 도면이다. 도 11을 참조하면, 본 발명의 일 실시예에 따른 이미지 처리 장치는, 하드웨어, 소프트웨어, 또는 이들의 결합으로 이루어질 수 있다. 예를 들어, 본 발명의 이미지 처리 장치는 위와 같은 기능/단계/과정들을 수 행하기 위한 적어도 하나의 프로세서를 갖는 도 11과 같은 컴퓨팅 시스템 또는 인터넷 상의 서버 형태로 구현될 수 있다. 컴퓨팅 시스템은 버스를 통해 연결되는 적어도 하나의 프로세서, 메모리, 사용자 인터 페이스 입력 장치, 사용자 인터페이스 출력 장치, 스토리지, 및 네트워크 인터페이스 를 포함할 수 있다. 프로세서는 중앙 처리 장치(CPU) 또는 메모리 및/또는 스토리지에 저장 된 명령어들에 대한 처리를 실행하는 반도체 장치일 수 있다. 메모리 및 스토리지는 다양한 종류의 휘발성 또는 불휘발성 저장 매체를 포함할 수 있다. 예를 들어, 메모리는 ROM(Read Only Memory) 및 RAM(Random Access Memory)을 포함할 수 있다. 또한, 네트워크 인터페이스는 스마트폰, 노트북 PC, 데스크탑 PC 등 사용자 단말에서의 유선 인터넷 통신이나 WiFi, WiBro 등 무선 인터넷 통신, WCDMA, LTE 등 이동통신을 지원하는 모뎀 등의 통신 모듈이나, 근거리 무선 통신 방식(예, 블루투스, 지그비, 와이파이 등)의 통신을 지원하는 모뎀 등의 통신모듈을 포함할 수 있다. 따라서, 본 명세서에 개시된 실시예들과 관련하여 설명된 방법 또는 알고리즘의 단계는 프로세서에 의해 실행되는 하드웨어, 소프트웨어 모듈, 또는 그 2 개의 결합으로 직접 구현될 수 있다. 소프트웨어 모듈은 RAM 메모리, 플래시 메모리, ROM 메모리, EPROM 메모리, EEPROM 메모리, 레지스터, 하드 디스크, 착탈형 디스크, CD-ROM과 같이 컴퓨터 등 장치로 판독 가능한 저장/기록 매체 (A non-transitory computer-readable storage medium storing computer executable instructions) (즉, 메모리 및/또는 스토리지)에 상주할 수 도 있다. 예시적인 저장 매체는 프로세서에 커플링되며, 그 프로세서는 저장 매체로부터 정보(코드)를 판독할 수 있고 저장 매체에 정보(코드)를 기입할 수 있다. 다른 방법으로, 저장 매체는 프로세서 와 일체형일 수도 있다. 프로세서 및 저장 매체는 주문형 집적회로(ASIC) 내에 상주할 수도 있다. ASIC는 사용자 단말기 내에 상주할 수도 있다. 다른 방법으로, 프로세서 및 저장 매체는 사용자 단말기 내에 개별 컴포 넌트로서 상주할 수도 있다. 이상과 같이 본 발명에서는 구체적인 구성 요소 등과 같은 특정 사항들과 한정된 실시예 및 도면에 의해 설명되 었으나 이는 본 발명의 보다 전반적인 이해를 돕기 위해서 제공된 것일 뿐, 본 발명은 상기의 실시예에 한정되 는 것은 아니며, 본 발명이 속하는 분야에서 통상적인 지식을 가진 자라면 본 발명의 본질적인 특성에서 벗어나 지 않는 범위에서 다양한 수정 및 변형이 가능할 것이다. 따라서, 본 발명의 사상은 설명된 실시예에 국한되어 정해져서는 아니 되며, 후술하는 특허청구범위뿐 아니라 이 특허청구범위와 균등하거나 등가적 변형이 있는 모 든 기술 사상은 본 발명의 권리범위에 포함되는 것으로 해석되어야 할 것이다."}
{"patent_id": "10-2024-0114571", "section": "도면", "subsection": "도면설명", "item": 1, "content": "본 발명에 관한 이해를 돕기 위해 상세한 설명의 일부로 포함되는 첨부도면은, 본 발명에 대한 실시예를 제공하 고 상세한 설명과 함께 본 발명의 기술적 사상을 설명한다. 도 1은 본 발명의 일 실시예에 따른 이미지 처리 시스템을 설명하기 위한 도면이다. 도 2는 도 1의 이미지 처리 장치의 구체적인 블록도이다. 도 3은 본 발명의 레이저 스펙클 대조도 이미지의 처리를 수행하는 이미지 처리 장치의 동작 설명을 위한 흐름 도이다. 도 4는 노출 시간을 고정하고 다른 혈류 속도, 다른 혈관 깊이, 다른 측정 시간에서 획득한 순간 레이저 스펙클 대조도 이미지 데이터셋의 예를 설명하기 위한 도면이다. 여기서, 속도는 아래로 갈수록 깊이는 우측으로 갈수 록 증가한다.도 5는 본 발명의 레이저 스펙클 대조도 이미지의 관심 영역에 대한 학습 데이터셋의 준비를 설명하기 위한 도 면이다. 도 6은 본 발명의 학습 데이터셋에서의 혈류 속도와 이미지의 레이저 스펙클 대조도의 상관 관계를 다른 혈관 깊이별로 나타내는 예시적인 그래프이다. 도 7a 내지 도 7d는 본 발명의 학습 데이터셋에서의 레이저 스펙클 대조도의 시간에 따른 변화에 대한 예시적인 그래프이다. 도 8은 본 발명의 학습부의 다층 합성곱층과 풀링층 및 완전 연결 계층의 구성을 설명하기 위한 도면이다. 도 9a는 혈관 깊이를 모를 때 본 발명의 혈류 속도의 예측에 대한 예시적인 도면이다. 도 9b는 혈류 속도를 모를 때 본 발명의 혈관 깊이의 예측에 대한 예시적인 도면이다. 도 10a 내지 도 10d는 혈관 깊이를 알고 있을 때 본 발명의 각 혈관 깊이별 혈류 속도의 예측에 대한 예시적인 도면이다. 도 11은 본 발명의 일 실시예에 따른 이미지 처리 장치의 구현 방법의 일례를 설명하기 위한 도면이다."}
