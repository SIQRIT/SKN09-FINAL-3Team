{"patent_id": "10-2019-0112244", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2021-0030730", "출원번호": "10-2019-0112244", "발명의 명칭": "의료 영상을 해석하는 인공지능 모델을 이용한 폐암 발병 가능성 예측 방법 및 의료 영상 분", "출원인": "계명대학교 산학협력단", "발명자": "김해원"}}
{"patent_id": "10-2019-0112244", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "영상분석장치가 샘플에 대한 흉부 FDG(fluorodeoxyglucose) PET/CT 영상을 입력받는 단계; 및상기 영상분석장치가 상기 FDG PET/CT 영상을 분류 신경망에 입력하여 상기 샘플에 대한 폐암 발병 가능성을 예측하는 단계를 포함하되,상기 분류 신경망은 폐암 환자에 대한 흉부 FDG PET/CT 영상에서 폐암 영역을 제외한 훈련 영상 및 정상인에 대한 흉부 FDG PET/CT 영상을 이용하여 학습되는 의료 영상을 해석하는 인공지능 모델을 이용한 폐암 발병 가능성예측 방법."}
{"patent_id": "10-2019-0112244", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 분류 신경망은 F-18 FDG로 표지된 PET/CT 영상을 이용하여 학습되는 의료 영상을 해석하는 인공지능 모델을 이용한 폐암 발병 가능성 예측 방법."}
{"patent_id": "10-2019-0112244", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1항에 있어서,상기 분류 신경망은 CNN(Convolution neural network)이고, 상기 샘플을 저위험군 또는 고위험군으로 분류하는의료 영상을 해석하는 인공지능 모델을 이용한 폐암 발병 가능성 예측 방법."}
{"patent_id": "10-2019-0112244", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제1항에 있어서,상기 영상분석장치가 상기 분류 신경망에서 출력되는 특징 정보를 디코더 신경망에 입력하여 상기 폐암 발병 가능성에 대한 정보가 포함되는 영상을 생성하는 단계를 더 포함하는 의료 영상을 해석하는 인공지능 모델을 이용한 폐암 발병 가능성 예측 방법."}
{"patent_id": "10-2019-0112244", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제1항에 있어서,상기 영상분석장치가 상기 FDG PET/CT 영상을 검출 신경망에 입력하여, 상기 FDG PET/CT 영상에서 폐 영역을 검출하는 단계를 더 포함하고, 상기 영상분석장치가 상기 검출된 폐 영역을 상기 분류 신경망에 입력하는 의료 영상을 해석하는 인공지능 모델을 이용한 폐암 발병 가능성 예측 방법."}
{"patent_id": "10-2019-0112244", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제1항에 있어서,상기 영상분석장치가 별도의 신경망을 이용하여 상기 폐암 환자에 대한 FDG PET/CT 영상에서 훈련 영상을 생성하는 단계를 더 포함하되,상기 훈련 영상을 생성하는 단계는 상기 영상분석장치가 폐암 환자의 FDG PET/CT 영상을 입력받는 단계; 및 상기 영상분석장치가 상기 FDG PET/CT 영상을 상기 별도의 신경망에 입력하여 폐암 영역을 제외한 영역을 추출하는 단계를 포함하는 의료 영상을 해석하는 인공지능 모델을 이용한 폐암 발병 가능성 예측 방법."}
{"patent_id": "10-2019-0112244", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "공개특허 10-2021-0030730-3-컴퓨터에서 제1항 내지 제6항 중 어느 하나의 항에 기재된 의료 영상을 해석하는 인공지능 모델을 이용한 폐암발병 가능성 예측 방법을 실행하기 위한 프로그램을 기록한 컴퓨터로 읽을 수 있는 기록 매체."}
{"patent_id": "10-2019-0112244", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "검사 대상자의 흉부 FDG(fluorodeoxyglucose) PET/CT 영상을 입력받는 입력장치;흉부 FDG PET/CT 영상을 이용하여 폐암 발병 가능성에 대한 정보를 생성하는 분류 신경망을 저장하는 저장장치;및상기 입력받은 FDG PET/CT 영상을 상기 분류 신경망에 입력하여 상기 대상자에 대한 폐암 발병 가능성을 예측하는 연산장치를 포함하되,상기 분류 신경망은 폐암 환자에 대한 FDG PET/CT 영상에서 폐암 영역을 제외한 훈련 영상 및 정상인에 대한 흉부 FDG PET/CT 영상을 이용하여 학습되는 의료 영상 분석 장치."}
{"patent_id": "10-2019-0112244", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제8항에 있어서,상기 신경망은 F-18 FDG로 표지된 PET/CT 영상을 이용하여 학습되는 의료 영상 분석 장치."}
{"patent_id": "10-2019-0112244", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제8항에 있어서,상기 분류 신경망은 CNN(Convolution neural network)이고, 상기 연산장치는 상기 대상자를 저위험군 또는 고위험군으로 분류하는 의료 영상 분석 장치."}
{"patent_id": "10-2019-0112244", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "제8항에 있어서,상기 저장장치는 흉부 FDG PET/CT 영상에서 폐 영역을 검출하는 검출 신경망을 더 저장하고,상기 연산장치는 상기 검출 신경망에 흉부 FDG PET/CT 영상을 입력하여 상기 FDG PET/CT 영상에서 폐 영역을 검출하고, 상기 검출된 폐 영역을 상기 분류 신경망에 입력하는 의료 영상 분석 장치."}
{"patent_id": "10-2019-0112244", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제8항에 있어서,상기 저장장치는 상기 분류 신경망에서 출력되는 특징 정보를 입력받아 폐암 발병 가능성에 대한 정보가 포함된영상을 생성하는 디코더 신경망을 더 저장하고,상기 연산장치는 상기 분류 신경망에서 출력되는 분류 정보와 특징 정보를 상기 디코더 신경망에 입력하여 상기분류 정보가 포함된 영상을 생성하는 의료 영상 분석 장치."}
{"patent_id": "10-2019-0112244", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "인공지능 모델을 이용한 폐암 발병 가능성 예측 방법은 영상분석장치가 샘플에 대한 흉부 FDG(fluorodeoxyglucose) PET/CT 영상을 입력받는 단계 및 상기 영상분석장치가 상기 FDG PET/CT 영상을 신경망 에 입력하여 상기 샘플에 대한 폐암 발병 가능성을 예측하는 단계를 포함한다. 상기 신경망은 폐암 환자에 대한 흉부 FDG PET/CT 영상에서 폐암 영역을 제외한 훈련 영상을 이용하여 학습된다."}
{"patent_id": "10-2019-0112244", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "이하 설명하는 기술은 의료 영상을 이용하여 폐암 발병 가능성을 예측하는 기법에 관한 것이다."}
{"patent_id": "10-2019-0112244", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "폐암은 초기 자각 증상이 거의 없어 대부분 말기에 발견되는 경우가 많다. 전체 폐암 환자의 50~70%를 차지하는 수술이 불가능한 진행성 폐암의 5년 상대 생존율은 6.1%(2011~2015년 기준) 수준이다. 진행성 폐암 환자 10명 중 9명 이상(94%)이 5년 이내에 사망한다. 폐암 조기 발견을 위하여 의료계는 저선량 CT를 매년 시행할 것을 권고하고 있다. 저선량 CT는 흉부 X-선에 비 해 조기 폐암이 발견 가능성이 높다. 선행기술문헌 특허문헌 (특허문헌 0001) 한국등록특허 제10-1768812호"}
{"patent_id": "10-2019-0112244", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "저선량 CT의 폐암 진단율은 0.3~2.3%로 매우 낮다. 저선량 CT는 20% 가량의 위양성 결과를 보인다. 위양성 진단 은 불필요한 침습적 진단을 동반하는 문제가 있다. 또한 반복적인 저선량 CT는 방사선 피폭에 따른 암발생 위험 이 있다. 이하 설명하는 기술은 AI(artificial intelligence, 인공지능) 모델을 이용하여 진단 영상을 기준으로 자동으로 폐암 발병 가능성을 예측하는 기법을 제공하고자 한다."}
{"patent_id": "10-2019-0112244", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "의료 영상을 해석하는 인공지능 모델을 이용한 폐암 발병 가능성 예측 방법은 영상분석장치가 샘플에 대한 흉부 FDG(fluorodeoxyglucose) PET/CT 영상을 입력받는 단계 및 상기 영상분석장치가 상기 FDG PET/CT 영상을 분류 신경망에 입력하여 상기 샘플에 대한 폐암 발병 가능성을 예측하는 단계를 포함한다. 의료 영상 분석 장치는 검사 대상자의 흉부 FDG(fluorodeoxyglucose) PET/CT 영상을 입력받는 입력장치, 흉부 FDG PET/CT 영상을 이용하여 폐암 발병 가능성에 대한 정보를 생성하는 분류 신경망을 저장하는 저장장치 및 상 기 입력받은 FDG PET/CT 영상을 상기 분류 신경망에 입력하여 상기 대상자에 대한 폐암 발병 가능성을 예측하는 연산장치를 포함한다. 상기 분류 신경망은 폐암 환자에 대한 FDG PET/CT 영상에서 폐암 영역을 제외한 훈련 영상 및 정상인에 대한 흉 부 FDG PET/CT 영상을 이용하여 학습된다."}
{"patent_id": "10-2019-0112244", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "이하 설명하는 기술은 AI 모델을 이용하여 비침습적으로 폐암 발병 가능성을 예측한다. 따라서, 이하 설명하는 기술은 종래 영상 진단 방법으로 판정이 어려운 폐암발생 고위험 환자를 선별하여, 집중적 관리를 가능케 하고, 폐암 진단율을 높일 수 있다. 이를 통해, 이하 설명하는 기술은 폐암 환자의 생존율 향상을 제고한다."}
{"patent_id": "10-2019-0112244", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하 설명하는 기술은 다양한 변경을 가할 수 있고 여러 가지 실시례를 가질 수 있는 바, 특정 실시례들을 도면 에 예시하고 상세하게 설명하고자 한다. 그러나, 이는 이하 설명하는 기술을 특정한 실시 형태에 대해 한정하려 는 것이 아니며, 이하 설명하는 기술의 사상 및 기술 범위에 포함되는 모든 변경, 균등물 내지 대체물을 포함하 는 것으로 이해되어야 한다.제1, 제2, A, B 등의 용어는 다양한 구성요소들을 설명하는데 사용될 수 있지만, 해당 구성요소들은 상기 용어 들에 의해 한정되지는 않으며, 단지 하나의 구성요소를 다른 구성요소로부터 구별하는 목적으로만 사용된다. 예 를 들어, 이하 설명하는 기술의 권리 범위를 벗어나지 않으면서 제1 구성요소는 제2 구성요소로 명명될 수 있고, 유사하게 제2 구성요소도 제1 구성요소로 명명될 수 있다. 및/또는 이라는 용어는 복수의 관련된 기재된 항목들의 조합 또는 복수의 관련된 기재된 항목들 중의 어느 항목을 포함한다. 본 명세서에서 사용되는 용어에서 단수의 표현은 문맥상 명백하게 다르게 해석되지 않는 한 복수의 표현을 포함 하는 것으로 이해되어야 하고, \"포함한다\" 등의 용어는 설시된 특징, 개수, 단계, 동작, 구성요소, 부분품 또는 이들을 조합한 것이 존재함을 의미하는 것이지, 하나 또는 그 이상의 다른 특징들이나 개수, 단계 동작 구성요 소, 부분품 또는 이들을 조합한 것들의 존재 또는 부가 가능성을 배제하지 않는 것으로 이해되어야 한다. 도면에 대한 상세한 설명을 하기에 앞서, 본 명세서에서의 구성부들에 대한 구분은 각 구성부가 담당하는 주기 능 별로 구분한 것에 불과함을 명확히 하고자 한다. 즉, 이하에서 설명할 2개 이상의 구성부가 하나의 구성부로 합쳐지거나 또는 하나의 구성부가 보다 세분화된 기능별로 2개 이상으로 분화되어 구비될 수도 있다. 그리고 이 하에서 설명할 구성부 각각은 자신이 담당하는 주기능 이외에도 다른 구성부가 담당하는 기능 중 일부 또는 전 부의 기능을 추가적으로 수행할 수도 있으며, 구성부 각각이 담당하는 주기능 중 일부 기능이 다른 구성부에 의 해 전담되어 수행될 수도 있음은 물론이다. 또, 방법 또는 동작 방법을 수행함에 있어서, 상기 방법을 이루는 각 과정들은 문맥상 명백하게 특정 순서를 기 재하지 않은 이상 명기된 순서와 다르게 일어날 수 있다. 즉, 각 과정들은 명기된 순서와 동일하게 일어날 수도 있고 실질적으로 동시에 수행될 수도 있으며 반대의 순서대로 수행될 수도 있다. 이하 설명에서 사용하는 정보 내지 용어에 대하여 먼저 설명한다. 의료 영상은 사용자(환자)에 대한 의학적 정보를 포함하는 영상을 의미한다. 의료 영상은 다양한 기법으로 촬영 된 다양한 영상을 포함하는 의미이다. 예컨대, 의료 영상은 X-ray 영상, CT 영상, MRI 영상, PET 영상, PET-CT 영상 등을 의미한다. 이하 설명의 편의를 위해 개별 영상은 CT, PET, PET-CT 등으로 표현한다. CT는 X 선을 이용한 단층촬영 기법이다. PET는 양전자방출단층촬영 기법이다. PET는 체내의 특정 성분에 양전자 를 내는 물질을 정맥 주사한 후 대상자를 촬영한다. PET는 인체에 투입하는 방사성 동위원소 화합물의 종류에 따라 포도당 대사, 아미노산 대사, DNA 합성, 수용체 영상(소마토스타틴 등), 종양에 특이적인 항체, 유전자 영 상 등 다양한 분자 영상을 획득할 수 있다. PET-CT는 양전자방출 단층촬영검사(PET)와 전산화 단층촬영검사(CT)가 결합된 촬영 기법이다. PET-CT는 질환의 형태적 영상(CT)과 기능적 영상(PET)을 동시에 포함한다. 따라서 종래 PET 검사보다 병소 부위를 정확하게 진단 할 수 있다. F-18 FDG(fludeoxyglucose) PET/CT는 F-18 FDG를 이용한 PET/CT이다. F-18 FDG는 포도당처럼 세포 내로 이동되 고 세포의 대사 활성도(metabolic activity)에 따라 섭취률이 달라진다. 당분해가 활발히 일어나는 활성화된 염 증세포 내에서 F-18 FDG 섭취가 현저하게 증가한다. 따라서, F-18 FDG PET/CT는 염증이 발생한 영역을 모니터링 하는데 유용하다. 연구자(의료진)가 대상자에게 F-18 FDG를 일정량 투여하고, 일정 시간이 경과한 후 PET 스캐 너를 이용하여 F-18 FDG PET/CT를 얻을 수 있다. 이하 F-18 FDG PET/CT 영상은 F-18 FDG PET/CT 또는 FDG PET/CT라고 명명한다. 이하 설명하는 기술은 폐암 발병 가능성을 예측하는 기법이다. 이하 설명하는 기술은 의료 영상을 분석하여 폐 암 발병 가능성을 예측한다. 이하 설명하는 기술은 폐 영역의 염증 특징을 나타내는 다양한 의료 영상이 사용될 수 있다. 이하 F-18 FDG PET/CT 영상을 이용하여 폐암 발병 가능성을 예측한다고 전제한다. 이하 설명하는 기술은 기계학습(machine learning)모델을 사용하여 의료 영상을 분석한다. 기계학습모델은 널리 알려진 바와 같이 다양한 모델이 있다. 이하 설명하는 기술은 인공신경망(artificial neural network)을 사용하 여 영상을 분석한다고 가정한다. 인공신경망은 딥러닝 네트워크를 사용할 수 있다. 딥러닝 네트워크는 DNN(Deep Neural Network), CNN(Convolutional Neural Network), RNN(Recurrent Neural Network), RBM(Restricted Boltzmann Machine) 등의 모델일 수 있다. 널리 알려진 딥러닝 모델에 대해서는 자세한 설명을 생략한다. 이하 인공신경망을 이용하여 영상을 분석하는 장치를 영상분석장치라고 명명하다. 영상분석장치는 사전에 학습 된 인공신경망을 이용하여 영상을 분석한다. 영상분석장치는 일정한 데이터 처리 내지 신호 처리를 수행할 수있다. 예컨대, 영상분석장치는 PC, 스마트기기, 서버 등과 같은 장치로 구현될 수 있다. 영상분석장치는 의료 영상을 분석한다. 분석 대상인 영상을 이하 소스 영상이라고 명명한다. 영상분석장치는 인 공신경망에 소스 영상을 입력하여 분석 결과를 도출한다. 사용자 내지 대상자는 검사 대상이 되는 사람을 의미한다. 소스 영상은 사용자에 대한 의료 영상이다. 폐암은 의학적으로 다양한 원인(흡연, 유전, 바이러스, 환경 요인 등)에 의하여 발병한다고 알려졌다. 폐암 위 험 인자들이 폐실질에 만성적으로 염증성 반응을 일으키고, 유전자 변형을 통해 폐암으로 진행된다고 인식되고 있다. 즉, 염증(inflamation)은 폐암에 대한 병인학적 기능(etiologic role)이 있다고 인식되고 있다. 종래 연 구는 주로 폐암 연관 염증을 식별하기 위한 생물학적 마커(C-reactive protein, interleukin 등) 개발에 초점이 있다. 이하 설명하는 기술은 사용자의 흉부 FDG PET/CT 영상을 이용하여 폐암 발병 가능성을 예측한다. 기본적으로 이 하 설명하는 기술은 폐암 환자가 아닌 사용자(정상인)를 대상으로 폐암 발병 가능성을 예측한다. 정상인도 흉부 FDG PET/CT 영상에 일정한 염증 병변이 있을 수 있다. 나아가 정상인도 흉부 FDG PET/CT 영상에 판독자의 시각 에는 명확하지 않은 염증 관련 특징이 있을 수 있다. 이하 설명하는 기술은 폐암과 관련된 염증 특징을 이용하 여 폐암 발병 가능성을 예측한다. 도 1은 의료 영상을 이용한 폐암 발병 예측 시스템에 대한 예이다. 폐암 발병 예측 시스템은 의료 영 상 스캔 장치 및 영상분석장치(150, 180)를 포함한다. 의료 영상 스캔 장치는 의료 기관에 설치된 영상 장비이다. 의료 영상 스캔 장치는 사용자를 대상으 로 CT, PET, PET/CT 등의 영상을 생성한다. 도 1은 하나의 의료 영상 스캔 장치를 도시하였다. 폐암 발병 예측 시스템은 복수의 의료 영상을 사용할 수 있다. 따라서, 도 1과 달리 서로 다른 종류(복수)의 의료 영 상 스캔 장치가 사용될 수 있다. 설명의 편의를 위하여, 의료 영상 스캔 장치는 FDG PET/CT 영상을 생성한 다고 가정한다. 도 1은 영상분석장치로 분석 서버 및 분석 PC를 예로 도시하였다. 영상분석장치는 다양한 형태로 구 현될 수 있다. 예컨대, 영상분석장치는 휴대 가능한 모바일 기기로 구현될 수도 있다. 폐암 발병 예측 시스템은 분석 서버 또는 분석 PC 중 어느 하나를 포함할 수 있다. 나아가 폐 암 발병 예측 시스템은 분석 서버 및 분석 PC를 모두 포함할 수 있다. 분석 서버는 의료 영상 스캔 장치부터 FDG PET/CT 영상을 전달받는다. 분석 서버는 유선 또는 무선 네트워크를 통해 소스 영상을 수신할 수 있다. 분석 서버는 의료 영상을 분석하고, 분석한 결과를 사 용자에게 전달한다. 사용자는 사용자 단말을 통해 분석 서버의 분석 결과 또는 영상을 확인할 수 있다. 사용자 단말은 PC, 스마트 기기, 디스플레이 장치 등과 같은 장치를 의미한다. 분석 PC는 의료 영상 스캔 장치가 생성한 FDG PET/CT 영상을 입력받는다. 분석 PC는 유선 또는 무선 네트워크를 통해 FDG PET/CT 영상을 수신할 수 있다. 또는 분석 PC는 FDG PET/CT 영상을 저장한 매체 (USB, SD 카드, CD 등)로부터 FDG PET/CT 영상 입력받을 수 있다. 분석 PC는 의료 영상을 분석하고, 분석 한 결과를 사용자에게 전달한다. 사용자는 분석 PC를 통해 분석 결과를 확인할 수 있다. 분석 서버 또는 분석 PC는 딥러닝 모델을 사용하여 의료 영상을 분석할 수 있다. 분석 서버 또 는 분석 PC는 의료 영상을 분석하여 사용자의 폐암 발병 가능성에 대한 정보를 생성할 수 있다. 도 2는 폐암 발병 예측을 위한 신경망 모델의 예이다. 도 2는 폐암 발병 가능성을 예측하는 영상분석장치 에서 사용할 수 있는 신경망 모델에 대한 예이다. 도 2는 하나의 신경망(제1 신경망, 210)을 사용하는 예 이다. 제1 신경망은 FDG PET/CT 영상을 입력받아 해당 영상에 대한 폐암 발병 가능성을 예측하는 정보를 출력한다. 제1 신경망은 폐암 발병 가능성에 대하여 고위험(High) 또는 저위험(Low)과 같은 정보를 출력할 수 있다. 이하 소스 영상을 이용하여 폐암 발병 가능성을 판단하는 신경망을 분류 신경망이라고 명명한다. 분류 신경망은 샘플(사용자)의 폐암 발병 가능성을 분류할 수 있다.도 2에서 제1 신경망은 입력 영상 전체가 아닌, 폐 영역만을 입력받을 수 있다. 이 경우, 입력 영상에 대 한 전처리가 필요할 수 있다. 예컨대, 컴퓨터 장치가 시드 기반 영역확장기법(seed-based region growing)을 이 용하여 입력 영상을 전처리할 수 있다. 제1 신경망은 CNN과 같은 모델일 수 있다. 제1 신경망은 의료 영상을 입력받고, 의료 영상의 분석 결 과인 폐암 발병 가능성 정보를 출력한다. 제1 신경망은 사전에 학습되어야 한다. 제1 신경망은 특정 한 유형(FDG PET 또는 FDG PET/CT 중 어느 하나)의 훈련 영상과 훈련 영상의 출처(인간)의 폐암 발병 여부에 대 한 정보를 이용하여 훈련될 수 있다. 신경망 훈련 과정은 후술한다. 전술한 바와 같이 신경망 모델은 다양한 모델이 사용될 수 있다. 대표적으로 CNN이 사용될 수 있다. CNN은 다양 한 형태의 계층 구조로 구성될 수 있다. 통상적으로 CNN은 컨볼루셔널(합성곱) 계층 (convolution layer)와 풀 링 계층 (pooling layer)이 여러 층으로 이루어진 네트워크이다. 예컨대, CNN은 5개의 컨볼루션 계층 + Relu 계 층, 2개의 최대 풀링 계층, 2개의 전연결 계층(Fully connected layer) 구조를 가질 수 있다. 컨볼루셔널 계층은 입력 이미지에 대한 컨볼루셔널 연산을 통해 특징맵(feature map)을 출력한다. 이때 컨볼루 셔널 연산을 수행하는 필터(filter)를 커널(kernel) 이라고도 부른다. 필터의 크기를 필터 크기 또는 커널 크기 라고 한다. 커널을 구성하는 연산 파라미터(parameter)를 커널 파라미터(kernel parameter), 필터 파라미터 (filter parameter), 또는 가중치(weight)라고 한다. 컨볼루션 연산은 일정한 크기의 윈도우에서 수행된다. 윈도우는 영상의 좌측 상단에서 우측 하단까지 한 칸씩 이동할 수 있고, 한 번에 이동하는 이동 크기를 조절할 수 있다. 이동 크기를 스트라이드(stride)라고 한다. 컨 볼루셔널 계층은 입력이미지에서 윈도우를 이동하면서 입력이미지의 모든 영역에 대하여 컨볼루션 연산을 수행 한다. 컨볼루셔널 계층은 영상의 가장 자리에 패딩(padding)을 하여 컨볼루션 연산 후 입력 영상의 차원을 유지 할 수 있다. 비선형 연산 계층(nonlinear operation layer)은 뉴런(노드)에서 출력값을 결정하는 계층이다. 비선형 연산 계 층은 전달 함수(transfer function)를 사용한다. 전달 함수는 Relu, sigmoid 함수 등이 있다. 도 1은 컨볼루셔 널 계층과 Relu를 사용한 예를 도시한다. 풀링 계층(pooling layer)은 컨볼루셔널 계층에서의 연산 결과로 얻은 특징맵을 서브 샘플링(sub sampling)한다. 풀링 연산은 최대 풀링(max pooling)과 평균 풀링(average pooling) 등이 있다. 최대 풀링은 윈도우 내에서 가장 큰 샘플 값을 선택한다. 평균 풀링은 윈도우에 포함된 값의 평균 값으로 샘플링한다. 전연결 계층은 최종적으로 입력 영상을 분류한다. 도 2에서 전연결 계층은 폐암 발병 가능성에 대한 정보를 출 력한다. 도 3은 폐암 발병 예측을 위한 신경망 모델의 다른 예이다. 도 3은 두 개의 신경망(제1 신경망, 제2 신경 망)을 사용하는 예이다. 제1 신경망 및 제2 신경망은 서로 다른 종류의 딥러닝 모델일 수도 있다. 제1 신경망은 의료 영상에서 원하는 객체가 존재하는 관심 영역(ROI)을 검출한다. 제1 신경망은 소스 영상에서 특정한 영역 내지 객체를 검출(segmentation)하는 모델에 해당한다. 이와 같이 소스 영상에서 객체를 검출하는 유형의 신경망을 검출 신경망이라고 명명한다. 검출 신경망은 소스 영상에서 객체를 식별하고, 해당 객체를 분할(구분)한다. 검출 신경망은 다양한 유형의 모 델로 구현될 수 있다. 예컨대, 검출 신경망은 CNN과 같은 유형의 모델일 수 있다. 검출 신경망은 인코더-디코더 구조, FCN(Fully Convolutional Network) 등과 같은 구조를 가질 수 있다. 제1 신경망은 객체 검출을 위한 것으로 의료 영상의 특징 정보를 기준으로 특정한 영역을 검출하고 구분한 다. 제1 신경망은 FDG PET/CT 영상에서 폐 영역을 관심 영역(ROI)로 구분할 수 있다. 제1 신경망도 관심 영역 검출을 위하여 사전에 학습되어야 한다. 제2 신경망은 입력되는 의료 영상을 이용하여 폐암 발병 가능성 정보를 출력한다. 제2 신경망은 분류 신경망에 해당한다. 이때, 제2 신경망은 입력 영상으로 제1 신경망이 출력한 영상을 이용할 수 있다. 즉, 제2 신경망은 폐 영역을 기준으로 폐암 발병 가능성에 대한 정보를 출력할 수 있다. 제2 신경망은 CNN과 같은 모델일 수 있다. 제2 신경망은 제1 신경망에서 검출한 관심 영역을 입 력받을 수 있다. 또는 제2 신경망은 의료 영상 전체를 입력받되, 관심 영역의 특징 정보만을 이용하여 영상을 분석할 수 있다. 제2 신경망은 관심 영역의 특징 정보를 기준으로 폐암 발병 가능성 정보를 출력한다. 제2 신경망은 사전에 학습되어야 한다. 제2 신경망은 관심 영역 훈련 영상과 해당 영상에 매칭되는 폐암 발병 가능성 정보를 이용하여 훈련될 수 있다. 도 3의 하부에는 입력되는 의료 영상에 대한 예와 출력되는 폐암 발병 가능성 정보의 예를 도시하였다. 의료 영 상은 FDG PET/CT 영상을 예로 도시하였다. 제1 신경망은 FDG PET/CT 영상상에서 폐 영역(ROI)을 검출한다. 제2 신경망은 제1 신경망 모델이 출력하는 영상 내지 정보를 입력받아 폐암 발병 가능성 정보를 출력한다. 폐암 발병 가능성 정보는 고위험 또는 저위험일 수 있다. 도 4는 신경망을 학습하는 과정에 대한 예이다. 도 4는 분류 신경망을 학습하는 과정에 대한 예이다. 분류 신경망은 폐암 환자의 FDG PET/CT 영상과 정상인의 FDG PET/CT 영상을 이용하여 학습될 수 있다. 훈련 영상은 전처리를 거칠 수 있다. 예컨대, FDG PET/CT 영상을 이용한다면, 512 * 512 픽셀의 PET dicom 영상 과 CT dicom 영상을 256 * 256 pixel 크기로 자를(crop) 수 있다. 자른 영상에 대한 판별결과를 2차원 원-핫 벡터(one-hot vector)로 정의할 수 있다. 예컨대, 정상인의 흉부 FDG PET/CT 영상은 저위험군으로 분류하여 [0,1]로 정의하고, 폐암 환자의 흉부 FDG PET/CT 영상은 고위험군으로 분류하여 [1,0]로 정의할 수 있다. 이와 같이 픽셀 정보나 텍스트를 하나의 유의미한 벡터로 변환하여 정의하는 과정을 원-핫 인코딩이라고 한다. 제1 신경망은 폐암 환자의 영상에서 관심 영역을 검출하는 신경망이다. 제1 신경망은 폐암군(폐암 환 자들) FDG PET/CT에서 폐 영역을 검출한다. 나아가 제1 신경망은 폐 영역에서 폐암 영역(폐암 병증이 발생 한 영역)을 제외한 나머지 영역을 검출한다. 제1 신경망은 폐암 영역 제거한 폐 영역 검출을 위하여 사전 에 학습되어야 한다. 타깃 신경망은 전술한 분류 신경망이다. 타깃 신경망은 입력 영상을 기준으로 폐암 발병 가능성 정보 를 출력한다. 타깃 신경망은 제1 신경망이 출력하는 영상을 입력받으면, 해당 영상(영상의 특징)에 대해서는 고위험군이라는 정보를 출력하게 학습된다. 나아가 타깃 신경망은 별도의 객체 검출 기법(예컨대, 시드 기반 영역확장기법)을 이용하여 전처리된 영상을 이용할 수도 있다. 제2 신경망은 정상인의 영상에서 관심 영역을 검출하는 신경망이다. 제2 신경망은 도 3에서 설명한 제1 신경망에 대응된다. 제2 신경망은 정상군(정상인들) FDG PET/CT에서 폐 영역을 검출한다. 제2 신 경망은 폐 영역 검출을 위하여 사전에 학습되어야 한다. 타깃 신경망은 제2 신경망이 출력하는 영상을 입력받으면, 해당 영상(영상의 특징)에 대해서는 저위 험군이라는 정보를 출력하게 학습된다. 나아가 타깃 신경망은 별도의 객체 검출 기법(예컨대, 시드 기반 영역확장기법)을 이용하여 전처리된 영상을 이용할 수도 있다. 딥러닝 네트워크 학습 과정에 대한 상세한 설명을 생략한다. 타깃 신경망은 학습 과정을 통해 신경망 계층 의 가중치가 최적화된다. 물론 타깃 신경망은 폐암 발병 가능성을 예측하는 애플리케이션으로 사용되면서, 결과값을 피드백받아 계속 업데이트될 수도 있다. 딥러닝 네트워크에서 파라미터 (parameter)는 손실함수를 감 소시키는 방향으로 학습을 수행한다. 손실함수는 학습 과정을 통해 신경망의 가중치를 최적화할 수 있다. 예컨 대, 가중치 최적화는 경사 하강법(gradient descent method)을 이용할 수 있다. 도 5는 폐암 발병 정보를 갖는 영상을 생성하는 신경망 모델의 예이다. 신경망 모델은 폐암 발병 가 능성에 대한 정보를 포함하는 영상을 생성한다. 신경망 모델은 입력 영상에서 특징 정보를 추출하고, 추출 한 특징 정보를 기반으로 일정한 영상을 생성하는 모델에 해당한다. 이와 같은 신경망은 대표적으로 오토인코더, 컨볼루셔널 인코더-디코더 등이 있다. 도 5는 컨볼루셔널 인코더-디코더 구조에 대한 예이다. 신경망 모델은 인코더 및 디코더를 포함한다. 인코더는 소스 영상(FDG PET/CT 영상)을 입력받아 특징 정보 내지 특징 맵을 출력한다. 디코더는 입 력받은 특징 정보 내지 특징 맵을 기준으로 특정 영상을 출력한다. 디코더가 출력하는 영상을 출력 영상이 라고 명명한다. 인코더는 소스 영상의 특징 맵을 생성하고, 특징 맵의 크기를 감소시키면서 일부 유효한 특징값만을 추출 한다. 디코더는 인코더가 출력하는 유효한 특징값을 기준으로 특징 맵의 크기를 증가시킨다. 디코더는 최종적으로 소스 영상과 동일한 크기의 출력 영상을 출력한다. 인코더는 복수의 인코더 단을 포함한다. 도 7은 3개의 인코더 단(encoder 1, encoder 2 및 encoder 3)을 예로 도시하였다. 인코더 단은 복수의 컨볼루셔널 블록과 하나의 풀링 계층으로 구성될 수 있다. 하나의 컨볼루셔널 블록은 컨볼 루셔널 계층, 비선형화 계층 및 표준화 계층을 포함한다. 비선형화 계층은 relu layer를 사용할 수 있다. 표준 화 계층은 배치 표준화 계층을 사용할 수 있다. 각 계층의 동작은 전술한 바와 같다. 풀링 계층은 최대 풀링(max pooling)을 수행할 수 있다. 풀링 계층은 최댓값을 갖는 픽셀 위치를 저장해두고, 대응되는 디코더 단의 업 샘플링 계층에 전달한다(도 5에서 점선 화살표로 표시함). 인코더는 소스 영상에서 폐암 발병 가능성 판단에 사용될 특징 정보를 추출한다. 한편 의료 영상에 특정 영역을 표시하기 위하여 인코더는 특징 정보 위치 파악이 가능한 모델을 사용할 수도 있다. 디코더는 복수의 디코더 단을 포함한다. 도 7은 3개의 디코더 단(decoder 1, decoder 2 및 decoder 3)을 예로 도시하였다. 전술한 바와 같이 디코더는 인코더에 대칭되는 구조(거울상)를 갖는다. 따라서 디 코더 단은 하나의 업샘플링 계층 및 복수(컨볼루셔널 블록의 개수와 동일한)의 역컨볼루셔널 블록으로 구성될 수 있다. 디코더 단은 인코더 단의 동작을 역으로 수행한다. 업샘플링 계층은 대응되는 인코더 단의 최대 풀링 계층으로부터 전달 받은 최댓값 픽셀 위치에 입력 특징 맵의 값을 출력하고, 최댓값 픽셀 위치 외에는 '0' 의 값을 출력한다. 디코더 단은 대응되는 인코더 단의 컨볼루셔널 블록 및 컨볼루셔널 계층과 필터 개수, 필터 크기 등이 동일하다. 디코더는 입력된 의료 영상과 유사한 영상을 출력할 수 있다. 출력 영상은 특징 정보가 반영된 값을 포함 한다. 출력 영상은 FDG PET/CT 영상에 폐암 발병 가능성(고위험 또는 저위험)을 특정한 색상으로 표현할 수 있 다. 또는 출력 영상은 폐암 발병 가능성 정보를 출력 영상에 표시 텍스트 형태로 표현할 수 있다. 출력 영상이 나타내는 정보는 디코더의 구성 내지 파라미터 설정에 따라 달라질 수 있다. 도 6은 의료 영상을 이용한 폐암 발병 예측 장치의 구성에 대한 예이다. 폐암 발병 가능성 결정 장치(60 0)는 전술한 영상처리장치에 해당한다. 폐암 발병 가능성 결정 장치는 도 1의 분석 서버 내지 분석 PC에 해당하기도 한다. 폐암 발병 가능성 결정 장치는 전술한 신경망 모델을 이용하여 소스 영상으로부터 폐암 발병 가능성 정보 를 추출할 수 있다. 폐암 발병 가능성 결정 장치는 물리적으로 다양한 형태로 구현될 수 있다. 예컨대, 폐 암 발병 가능성 결정 장치는 PC와 같은 컴퓨터 장치, 네트워크의 서버, 영상 처리 전용 칩셋 등의 형태를 가질 수 있다. 컴퓨터 장치는 스마트 기기 등과 같은 모바일 기기를 포함할 수 있다. 폐암 발병 가능성 결정 장치는 저장 장치, 메모리, 연산장치, 인터페이스 장치 및 통 신 장치를 포함한다. 저장 장치는 영상 처리 내지 분석을 위한 신경망 모델을 저장한다. 예컨대, 저장 장치는 전술한 분류 신경망 및/또는 검출 신경망을 저장할 수 있다. 나아가 저장 장치는 영상 처리에 필요한 프로그램 내지 소 스 코드 등을 저장할 수 있다. 예컨대, 저장 장치는 입력 영상에서 관심 영역을 검출하는 프로그램을 저장 할 수 있다. 저장 장치는 입력된 소스 영상 및 생성된 출력 영상을 저장할 수 있다. 메모리는 폐암 발병 가능성 결정 장치가 수신한 소스 영상 및 출력 영상 생성과정에서 생성되는 데이 터 및 정보 등을 저장할 수 있다. 인터페이스 장치는 외부로부터 일정한 명령 및 데이터를 입력받는 장치이다. 인터페이스 장치는 물리 적으로 연결된 입력 장치 또는 외부 저장 장치로부터 소스 영상을 입력받을 수 있다. 인터페이스 장치는 영상 분석을 위한 각종 신경망 모델을 입력받을 수 있다. 인터페이스 장치는 신경망 모델 생성을 위한 학 습데이터, 정보 및 파라미터값을 입력받을 수도 있다. 통신 장치는 유선 또는 무선 네트워크를 통해 일정한 정보를 수신하고 전송하는 구성을 의미한다. 통신 장 치는 외부 객체로부터 소스 영상을 수신할 수 있다. 통신 장치는 각종 신경망 모델 및 모델 학습을 위한 데이터도 수신할 수 있다. 통신 장치는 결정한 폐암 발병 가능성 정보 또는 출력 영상을 외부 객체로송신할 수 있다. 통신 장치 내지 인터페이스 장치는 외부로부터 일정한 데이터 내지 명령을 전달받는 장치이다. 통신 장치 내지 인터페이스 장치를 입력장치라고 명명할 수 있다. 연산 장치는 저장장치에 저장된 신경망 모델 내지 프로그램을 이용하여 소스 영상으로부터 폐암 발병 가능성 정보 또는 출력 영상을 생성한다. 연산 장치는 소스 영상에 대한 일정한 전처리(크롭, 관심 영역 검출 등)를 할 수 있다. 연산 장치는 검출 신경망을 이용하여 소스 영상에서 관심 영역을 검출할 수도 있 다. 연산 장치는 주어진 학습 데이터를 이용하여 영상 처리 과정에 사용되는 신경망 모델을 학습할 수도 있다. 연산 장치는 전술한 과정을 통해 구축된 신경망 모델을 이용하여 소스 영상으로부터 폐암 발병 가능 성 정보를 생성할 수 있다. 연산 장치는 데이터를 처리하고, 일정한 연산을 처리하는 프로세서, AP, 프로 그램이 임베디드된 칩과 같은 장치일 수 있다. 또한, 상술한 바와 같은 영상 처리 방법 내지 폐암 발병 가능성 예측 방법은 컴퓨터에서 실행될 수 있는 실행가 능한 알고리즘을 포함하는 프로그램(또는 어플리케이션)으로 구현될 수 있다. 상기 프로그램은 비일시적 판독 가능 매체(non-transitory computer readable medium)에 저장되어 제공될 수 있다. 비일시적 판독 가능 매체란 레지스터, 캐쉬, 메모리 등과 같이 짧은 순간 동안 데이터를 저장하는 매체가 아니 라 반영구적으로 데이터를 저장하며, 기기에 의해 판독(reading)이 가능한 매체를 의미한다. 구체적으로는, 상 술한 다양한 어플리케이션 또는 프로그램들은 CD, DVD, 하드 디스크, 블루레이 디스크, USB, 메모리카드, ROM 등과 같은 비일시적 판독 가능 매체에 저장되어 제공될 수 있다. 본 실시례 및 본 명세서에 첨부된 도면은 전술한 기술에 포함되는 기술적 사상의 일부를 명확하게 나타내고 있 는 것에 불과하며, 전술한 기술의 명세서 및 도면에 포함된 기술적 사상의 범위 내에서 당업자가 용이하게 유추 할 수 있는 변형 예와 구체적인 실시례는 모두 전술한 기술의 권리범위에 포함되는 것이 자명하다고 할 것이다."}
{"patent_id": "10-2019-0112244", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 의료 영상을 이용한 폐암 발병 예측 시스템에 대한 예이다. 도 2는 폐암 발병 예측을 위한 신경망 모델의 예이다. 도 3은 폐암 발병 예측을 위한 신경망 모델의 다른 예이다. 도 4는 신경망을 학습하는 과정에 대한 예이다. 도 5는 폐암 발병 정보를 갖는 영상을 생성하는 신경망 모델의 예이다. 도 6은 의료 영상을 이용한 폐암 발병 예측 장치의 구성에 대한 예이다."}
