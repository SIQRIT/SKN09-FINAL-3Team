{"patent_id": "10-2021-0149588", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2023-0064225", "출원번호": "10-2021-0149588", "발명의 명칭": "클래스 불균형 해소를 위한 데이터 증강 방법 및 장치", "출원인": "에스케이텔레콤 주식회사", "발명자": "정원진"}}
{"patent_id": "10-2021-0149588", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "데이터를 증강하기 위한 컴퓨터 구현 방법에 있어서,객체를 포함하는 패치, 및 이미지를 획득하는 단계;복수의 마스크 중에서 하나의 마스크를 선택하는 단계;상기 선택된 마스크를 상기 패치에 적용함으로써, 분할된 객체를 획득하는 단계; 및상기 분할된 객체를 상기 이미지에 합성하는 단계를 포함하는 방법."}
{"patent_id": "10-2021-0149588", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 복수의 마스크 중 적어도 두 개의 마스크는,서로 다른 모양의 엣지 정보를 가지는 것인 방법."}
{"patent_id": "10-2021-0149588", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1항에 있어서,상기 하나의 마스크는,상기 복수의 마스크 중에서 랜덤하게 선택된 것인 방법."}
{"patent_id": "10-2021-0149588", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제1항에 있어서,상기 분할된 객체를 상기 이미지에 합성하는 단계는, 상기 이미지 내 각 픽셀의 값이 소정의 범위 내에 속하는 복수의 픽셀들을 포함하는 영역을 탐지하는 단계; 및상기 탐지된 영역에 상기 분할된 객체를 합성하는 단계를 포함하는 방법."}
{"patent_id": "10-2021-0149588", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제4항에 있어서,상기 탐지된 영역에 상기 분할된 객체를 합성하는 단계는, 상기 분할된 객체의 컨텐트(content) 및 상기 탐지된 영역의 스타일(style)에 기초하여, 스타일 변환(styletransfer)된 객체를 생성하는 단계 및상기 탐지된 영역에 상기 스타일 변환된 객체를 합성하는 단계를 포함하는 방법."}
{"patent_id": "10-2021-0149588", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제1항에 있어서,상기 이미지는 인식 모델에 의해 타겟 객체가 포함된 것으로 오인식(misrecognize)된 것이며,공개특허 10-2023-0064225-3-상기 합성된 이미지는 상기 인식 모델의 훈련 데이터 셋(training data set)을 구성하는 것인 방법."}
{"patent_id": "10-2021-0149588", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "객체를 포함하는 패치, 이미지, 복수의 마스크를 저장하는 메모리;상기 복수의 마스크 중에서 하나의 마스크를 선택하는 마스크 선택부;상기 선택된 마스크를 상기 패치에 적용함으로써, 분할된 객체를 획득하는 객체 획득부; 및상기 분할된 객체를 상기 이미지에 합성하는 객체 합성부를 포함하는 증강 장치."}
{"patent_id": "10-2021-0149588", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제1항 내지 제6항 중 어느 한 항의 방법을 실행하기 위한 컴퓨터 프로그램을 기록한 컴퓨터로 판독 가능한 기록매체."}
{"patent_id": "10-2021-0149588", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "클래스 불균형 해소를 위한 데이터 증강 방법 및 장치를 개시한다. 본 발명의 일 측면에 의하면, 데이터를 증강하기 위한 방법에 있어서, 객체를 포함하는 패치, 및 이미지를 획득 하는 단계; 복수의 마스크 중에서 하나의 마스크를 선택하는 단계; 상기 선택된 마스크를 상기 패치에 적용함으 로써, 분할된 객체를 획득하는 단계; 및 상기 분할된 객체를 상기 이미지에 합성하는 단계를 포함하는 방법을 제 공한다."}
{"patent_id": "10-2021-0149588", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명의 실시예들은 딥러닝을 위한 훈련 데이터의 클래스 불균형을 해소하기 위한 데이터 증강 방법 및 장치 에 관한 것이다."}
{"patent_id": "10-2021-0149588", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "이 부분에 기술된 내용은 단순히 본 발명에 대한 배경 정보를 제공할 뿐 종래기술을 구성하는 것은 아니다. 최근 들어, 이미지 내 객체를 탐색(detection), 인식(recognition), 또는 분류(classification)하는 이미지 인 식(image recognition) 기술에 대한 연구가 활발히 진행되고 있다. 특히, 인공지능(artificial intelligence, AI) 모델을 이용한 이미지 인식 기술이 각광 받고 있다. 일반적으로, 이미지 인식 기술에 이용되는 인식 모델은 기계 학습을 통해 이미지를 인식할 수 있다. 여기서, 기 계 학습이란 경험을 통해 자동으로 개선되는 컴퓨터 알고리즘을 의미한다. 인식 모델은 훈련 데이터 간 규칙이 나 특징을 학습함으로써, 이미지를 인식할 수 있다. 다시 말하면, 인식 모델의 기계 학습은 인식 모델을 학습시키기 위한 데이터로서, 훈련 데이터를 요구한다. 예 를 들면, 인식 모델이 강아지 이미지와 고양이 이미지를 분류하기 위해선, 강아지 이미지 셋과 고양이 이미지 셋이 필요하다. 인식 모델의 인식 성능을 위해서는, 훈련 데이터의 종류, 품질 및 양이 모두 적절하게 구성되어야 한다. 반대로, 훈련 데이터의 종류, 품질 및 양이 적절하게 구성되지 않으면, 훈련이 완료된 인식 모델의 성능이 나빠 질 수 있다. 예를 들면, 강아지 이미지들의 수가 고양이 이미지들의 수보다 10배만큼 많은 경우, 인식 모델은 강아지 이미지 에 편향(bias)되어 학습될 수 있다. 즉, 인식 모델이 강아지 이미지를 잘 분류하지만, 고양이 이미지를 잘 분류 하지 못할 수 있다. 다른 예로써, 의료 이미지(medical image)를 훈련 데이터로서 훈련하는 인식 모델이 있다. 폐렴에 관한 이미지 들의 수가 많고 폐 섬유증에 관한 이미지들의 수가 적을 때, 인식 모델은 폐렴에 관한 이미지에 편향되어 학습 될 수 있다. 이처럼, 훈련 데이터 간 불균형을 클래스 불균형(class imbalance) 또는 데이터 불균형이라고 한다. 기계 학습 방법들 중 하나인 신경망 학습 방법에서는, 클래스 불균형 문제를 해결하기 위해, 훈련 데이터의 훈 련 결과에 대한 피드백인 그래디언트(gradient)에 훈련 데이터의 비율에 따른 가중치를 적용하였다. 이를 역성 향 스코어(inverse propensity score, IPS) 기반 가중치 적용 방법이라 한다. 하지만, 훈련 데이터의 양이 고정 되어 있으므로, 역성향 스코어 기반 가중치 적용 방법도 클래스 불균형 문제를 해결하는 데 한계가 있다. 클래스 불균형 문제를 해결하기 위해, 훈련 데이터를 증강하는 데이터 증강 방법이 대두되고 있다. 데이터 증강 방법은 훈련 데이터의 양을 조절하는 방법이다. 일 예로써, 데이터 증강 방법은 인식하고자 하는 객체를 포함하는 객체 이미지를 객체가 없는 배경 이미지에 합 성함으로써, 객체를 포함하는 합성 이미지로 생성할 수 있다. 도 1은 종래의 데이터 증강 방법을 예시적으로 나타낸 도면이다. 도 1을 참조하면, 객체 이미지 저장부, 배경 이미지, 객체 이미지, 객체, 패치(patch, 114) 및 합성 이미지가 도시되어 있다. 배경 이미지는 탐지, 분류 또는 인식하고자 하는 객체가 없는 이미지이다. 즉, 배경 이미지는 타겟 객체가 아닌 다른 객체를 포함할 수는 있다. 객체 이미지는 탐지, 분류 또는 인식하고자 하는 객체를 포함하는 이미지이다. 객체 이미지 저장부 는 복수의 객체 이미지들을 저장한다. 종래의 데이터를 증강하는 장치(이하, 증강 장치라 함)는 객체 이미지 내에서 객체가 위치에 기초하 여 패치를 식별한다. 여기서, 패치는 객체 외에 객체의 주변 배경을 더 포함한다. 증강 장치는 배경 이미지에 패치를 합성한다. 여기서, 사각형 형태를 가지는 패치로부터 곡선의 바운더리(boundary)를 가지는 객체를 분할(segment)하는 데 연산량이 많이 필요하므로, 증강 장치는 패치 를 그대로 배경 이미지에 합성한다. 증강 장치는 객체 이미지 내 패치의 위치와 상관없이 배경 이미지 내 임의의 위치에 패치 를 합성할 수 있다. 합성 이미지는 객체를 포함하는 패치가 배경 이미지에 합성된 이미지다. 도 1에 도시된 과정들을 통해, 증강 장치는 객체를 포함하되, 기존의 객체 이미지와는 다른 합성 이 미지를 생성할 수 있다. 하지만, 객체뿐만 아니라 객체 주변을 모두 포함하는 패치를 배경 이미지에 그대로 합성하는 경 우, 패치와 배경 이미지 간 경계가 부자연스러운 현상인 스트롱 엣지(strong edge) 문제가 발생할 수 있다. 합성 이미지에서 객체를 인식하도록 훈련되는 인식 모델은 패치와 배경 이미지 간 경계선으로 인해, 객체를 인식하는 성능이 저하될 수 있다. 스트롱 엣지 문제를 해결하기 위해, 딥러닝(deep-learning) 기술을 이용하여 객체 이미지로부터 객체(11 2)를 분리하는 방법이 연구되고 있다. 하지만, 딥러닝 기술을 이용하는 방법에 의하면, 데이터 증강된 합성 이 미지의 수는 객체 이미지 내 객체의 수에 의존한다. 즉, 객체의 수가 적을수록 합성 이미 지의 수도 적다. 또한, 패치의 스타일과 배경 이미지의 스타일 간 차이로 인해 색감의 부조화(dis-harmonization) 문 제가 발생할 수 있다. 즉, 패치의 색감과 배경 이미지의 색감의 차이로 인해, 인식 모델이 객체(11 2)의 특징을 적절하게 추출하기 어려울 수 있다. 따라서, 증강 데이터의 품질을 향상시키고, 증강 데이터의 수를 증가시키기 위한 연구가 필요하다."}
{"patent_id": "10-2021-0149588", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명의 실시예들은, 객체가 포함된 패치로부터 객체를 분할하고, 분할된 객체를 스타일 변환하며, 배경 이미 지의 픽셀 값에 기초하여 합성 영역을 탐지하고, 탐지된 합성 영역에 변환된 객체를 합성함으로써, 배경 이미지 에 객체를 자연스럽게 합성하여 데이터를 증강하기 위한 방법 및 장치를 제공하는 데 주된 목적이 있다. 본 발명의 다른 실시예들은, 복수의 마스크 중 랜덤하게 선택된 마스크를 이용하여 패치로부터 객체를 분할함으 로써, 적은 연산량 및 다양한 모양으로 객체를 분할하여 데이터를 증강하기 위한 방법 및 장치를 제공하는 데 일 목적이 있다. 본 발명의 다른 실시예들은, 인식 모델에 의해 오인식된 이미지에 객체를 합성하여 인식 모델의 훈련 데이터로 구성함으로써, 인식 모델의 성능을 개선하기 위한 데이터 증강 방법 및 장치를 제공하는 데 일 목적이 있다."}
{"patent_id": "10-2021-0149588", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명의 일 측면에 의하면, 데이터를 증강하기 위한 방법에 있어서, 객체를 포함하는 패치, 및 이미지를 획득 하는 단계; 복수의 마스크 중에서 하나의 마스크를 선택하는 단계; 상기 선택된 마스크를 상기 패치에 적용함으 로써, 분할된 객체를 획득하는 단계; 및 상기 분할된 객체를 상기 이미지에 합성하는 단계를 포함하는 방법을 제공한다. 본 실시예의 다른 측면에 의하면, 객체를 포함하는 패치, 이미지, 복수의 마스크를 저장하는 메모리; 상기 복수 의 마스크 중에서 하나의 마스크를 선택하는 마스크 선택부; 상기 선택된 마스크를 상기 패치에 적용함으로써, 분할된 객체를 획득하는 객체 획득부; 및 상기 분할된 객체를 상기 이미지에 합성하는 객체 합성부를 포함하는 증강 장치를 제공한다."}
{"patent_id": "10-2021-0149588", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "이상에서 설명한 바와 같이 본 발명의 일 실시예에 의하면, 객체가 포함된 패치로부터 객체를 분할하고, 분할된 객체를 스타일 변환하며, 배경 이미지의 픽셀 값에 기초하여 합성 영역을 탐지하고, 탐지된 합성 영역에 변환된 객체를 합성함으로써, 배경 이미지에 객체를 자연스럽게 합성할 수 있다. 본 발명의 다른 실시예에 의하면, 복수의 마스크 중 랜덤하게 선택된 마스크를 이용하여 패치로부터 객체를 분 할함으로써, 적은 연산량 및 다양한 모양으로 객체를 분할할 수 있다. 본 발명의 다른 실시예에 의하면, 인식 모델에 의해 오인식된 이미지에 객체를 합성하여 인식 모델의 훈련 데이 터로 구성함으로써, 인식 모델의 성능을 개선할 수 있다."}
{"patent_id": "10-2021-0149588", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하, 본 발명의 일부 실시예들을 예시적인 도면을 통해 상세하게 설명한다. 각 도면의 구성요소들에 참조부호 를 부가함에 있어서, 동일한 구성요소들에 대해서는 비록 다른 도면 상에 표시되더라도 가능한 한 동일한 부호 를 가지도록 하고 있음에 유의해야 한다. 또한, 본 발명을 설명함에 있어, 관련된 공지 구성 또는 기능에 대한 구체적인 설명이 본 발명의 요지를 흐릴 수 있다고 판단되는 경우에는 그 상세한 설명은 생략한다. 또한, 본 발명의 구성 요소를 설명하는 데 있어서, 제 1, 제 2, A, B, (a), (b) 등의 용어를 사용할 수 있다. 이러한 용어는 그 구성 요소를 다른 구성 요소와 구별하기 위한 것일 뿐, 그 용어에 의해 해당 구성 요소의 본 질이나 차례 또는 순서 등이 한정되지 않는다. 명세서 전체에서, 어떤 부분이 어떤 구성요소를 '포함', '구비' 한다고 할 때, 이는 특별히 반대되는 기재가 없는 한 다른 구성요소를 제외하는 것이 아니라 다른 구성요소를 더 포함할 수 있는 것을 의미한다. 또한, 명세서에 기재된 '~부', '모듈' 등의 용어는 적어도 하나의 기능이나 동작을 처리하는 단위를 의미하며, 이는 하드웨어나 소프트웨어 또는 하드웨어 및 소프트웨어의 결합으로 구현 될 수 있다. 본 명세서에서, 탐지, 분류 또는 인식은 모두 인식 모델(recognition model)에 의해 수행될 수 있는 것으로 설 명한다. 탐지 기능 및 분류 기능은 인식 기능에 포함될 수 있다.도 2는 본 발명의 일 실시예에 따른 데이터 증강 방법을 나타낸 도면이다. 도 2를 참조하면, 본 발명의 일 실시예에 따른 증강 장치는 합성 영역의 탐지 및 객체의 조정을 통해 합성된 이미지의 품질을 향상시킬 수 있을 뿐만 아니라, 복수의 합성된 이미지들을 생성할 수 있다. 이미지는 인식 모델이 인식하고자 하는 객체가 합성될 배경 이미지다. 인식 모델이 이미지 내 복수의 객체를 인식할 수 있으므로, 이미지는 객체를 이미 포함하고 있을 수 있다. 이미지는 객체 외에 다른 객체를 더 포함할 수 있다. 패치는 인식 모델이 인식하고자 하는 객체를 포함하는 이미지다. 여기서, 패치는 객체의 주변 부분도 포함한다. 패치 저장부는 패치를 미리 저장하는 구성요소다. 증강 장치는 복수의 패치들을 미리 수집하여 패치 저장부에 저장할 수 있다. 증강 장치는 이미지, 및 객체가 포함된 패치를 획득한다. 증강 장치는 이미지 내 영역으로서, 객체를 합성할 영역인 합성 영역을 탐지(detect)한다. 본 발명의 일 실시예에 의하면, 증강 장치는 합성 영역 내 픽셀 값들에 기초하여, 합성 영역을 탐지한다. 증강 장치는 이미지 내 임의의 위치에 객체를 합성하지 않고, 이미지 내 픽셀 값들을 고려하여 적절한 위치에 객체를 합성할 수 있다. 예를 들면, 이미지에 피부가 촬영된 영역과 피부가 아닌 영역이 포함된 경우, 객체에 대응되는 병변(lesion)을 피부 위에 합성하도록, 증강 장치는 픽셀 값들 을 이용할 수 있다. 한편, 증강 장치는 패치로부터 객체를 분할한다. 본 발명의 일 실시예에 의하면, 증강 장치는 패치로부터 객체를 분할하기 위한 복수의 마스크(mask) 를 이용할 수 있다. 구체적으로, 증강 장치는 패치 내 객체를 분할하기 위해, 서로 다른 모양의 엣지 정보를 가지는 복수의 마스크를 준비한다. 여기서, 마스크는 패치로부터 분할하고자 하는 객체의 모 양을 나타내는 엣지 정보를 가지며, 엣지 정보에 따라 0 또는 1의 픽셀값을 가지는 바이너리(binary) 마스크일 수 있다. 증강 장치는 복수의 마스크 중 하나를 선택하고, 선택된 마스크를 패치에 적용함으로써, 객체 를 획득한다. 이때, 패치의 한 픽셀이 1 값을 가지는 마스크 픽셀과 연산되면 그대로 출력되고, 0 값 을 가지는 마스크 픽셀과 연산되면 0이 출력된다. 증강 장치는 미리 준비된 복수의 마스크를 이용하여 객체 의 모양을 다양하게 분할할 수 있다. 다시 말하면, 증강 장치는 객체를 포함하는 패치로부터 서 로 다른 모양을 가진 복수의 객체들을 분할할 수 있다. 이로 인해, 증강 장치는 증강 데이터의 수를 증가시킬 수 있다. 본 발명의 다른 실시예에 의하면, 증강 장치는 객체 내 픽셀값과 객체 외부 픽셀값 간 차이에 기초하 여 객체를 분할할 수 있다. 본 발명의 다른 실시예에 의하면, SIFT(Scale-Invariant Feature Transform) 및 HoG(Histogram of Gradient) 기법을 이용하여 객체를 분할할 수도 있다. 증강 장치는 패치로부터 분할한 객체를 조정한다. 본 발명의 일 실시예에 의하면, 증강 장치는 객체에 스타일 변환(style transfer)을 수행할 수 있다. 구체 적으로, 증강 장치는 객체의 컨텐트(content)와 합성 영역의 스타일(style)에 기초하여, 객체에 스타일 변환을 적용한다. 여기서, 객체의 컨텐트는 객체의 모양과 연관되며, 합성 영역의 스타 일은 합성 영역의 색감과 연관된다. 스타일 변환을 통해, 객체의 색감, 톤 등이 합성 영역과 조 화될 수 있다. 본 발명의 다른 실시예에 의하면, 증강 장치는 객체를 워핑(warping)할 수 있다. 이미지의 워핑은 이미지 에 나타난 모양이 왜곡되도록 픽셀의 위치를 조정하는 기하학적 처리를 의미한다. 이미지 워핑의 종류로써, 이 미지의 가로 길이 및 세로 길이의 조정, 이미지의 뒤틀림, 아핀 변환 또는 회전 등이 있다. 증강 장치는 객체 의 워핑을 통해, 객체의 모양을 다양하게 조정할 수 있다. 증강 장치는 스타일 변환 또는 워핑 중 적어도 하나를 객체에 적용함으로써, 조정된 객체를 획득한다. 증강 장치는 합성 영역에 조정된 객체를 합성함으로써, 합성된 이미지를 생성한다. 도 3은 본 발명의 일 실시예에 따른 합성 영역 탐지를 설명하기 위해 예시적으로 나타낸 도면이다. 도 3을 참조하면, 배경 이미지 내에 팔이 표현되어 있다. 신체 이미지로부터 병변을 인식하도록 훈련 되는 인식 모델의 훈련 데이터 셋으로 활용하기 위해, 증강 장치는 병변을 팔이 표현되어 있는 영역 내에 합성해야 한다. 병변이 팔이 표현된 영역 밖에 합성된 이미지가 인식 모델의 훈련 데이터로 이용되는 경우, 훈련이 완료된 인식 모델의 성능이 저하될 수 있다. 본 발명의 일 실시예에 따른 증강 장치는 배경 이미지의 픽셀 값들에 기초하여, 팔의 이 표현된 영역 내에 병변을 합성할 적절한 위치를 탐지할 수 있다. 구체적으로, 증강 장치는 배경 이미지 내 소정의 영역을 설정하고, 설정된 영역 내 픽셀 값들이 미리 설정 된 범위 내에 속하는지 여부를 판단하고, 각 픽셀의 값이 미리 설정된 범위 내에 속하는 경우 합성 영역으로 결 정할 수 있다. 도 3에서 증강 장치는 소정의 영역을 임의로 설정할 수 있다. 증강 장치는 배경 이미지 내 임의의 영역을 설정하고, 임의의 영역 내 픽셀 값들을 이용한다. 한편, 증강 장치는 소정의 영역을 특정 지점으로부터 스크리 닝(screening) 방식으로 설정할 수도 있다. 예를 들면, 증강 장치는 좌측 상단의 영역부터 픽셀 단위로 영역을 옮겨가면서 픽셀 값들을 비교한다. 이 외에도, 소정의 영역은 다양한 방식으로 설정될 수 있다. 제1 영역은 팔이 표현된 영역과 팔이 표현되지 않은 영역으로 나뉜다. 제1 영역 내 팔 이 표현된 영역의 픽셀 값들이 미리 설정된 범위에 속하더라도, 팔이 표현되지 않은 영역의 픽셀 값 들은 미리 설정된 범위에 속하지 못할 수 있다. 증강 장치는 제1 영역은 합성 영역으로서 적절하지 않은 것으로 판단한다. 제2 영역은 모두 팔이 표현된 영역이다. 즉, 제2 영역은 온전히 팔의 피부 영역이다. 제2 영역 내 모든 픽셀 값들은 팔의 피부를 표현하므로, 미리 설정된 범위에 속할 수 있다. 증강 장치는 제2 영역을 합성 영역으로서 적절한 영역으로 판단한다. 본 발명의 다른 실시예에 따른 증강 장치는 배경 이미지 내 소정의 영역을 설정하고, 설정된 영역 내 적어 도 두 개의 픽셀 값들 간 차이가 미리 설정된 범위보다 작은 경우, 설정된 영역을 합성 영역으로 결정할 수 있 다. 도 3에서 설명된 방법을 통해, 증강 장치는 배경 이미지 내 적절한 합성 영역을 탐지할 수 있다. 도 4a, 4b 및 4c는 본 발명의 일 실시예에 따른 객체의 분할을 설명하기 위해 예시적으로 나타낸 도면이다. 도 4a를 참조하면, 마스크 셋, 제1 마스크, 제2 마스크, 제3 마스크, 제3 조정된 마스크 (404a), 패치, 객체, 분할된 객체가 도시되어 있다. 본 발명의 일 실시예에 따른 증강 장치는 복수의 마스크(400, 402, 404)로 구성된 마스크 셋 중에서 하나를 선택하고, 선택된 마스크를 패치에 적용함으로써, 분할된 객체를 획득할 수 있다. 패치 내 객체 의 엣지를 따라 분할하는 경우, 증강 데이터의 수가 한정적일 수 있다. 따라서, 본 발명의 일 실시예에 따 른 증강 장치는 객체에 다양한 변형을 적용하여 패치로부터 다양한 모양의 객체를 분할하고, 다양한 증강 데이터를 생성할 수 있다. 구체적으로, 증강 장치는 복수의 마스크(400, 402, 404)를 포함하는 마스크 셋을 준비한다. 마스크 셋 은 사용자에 의해 생성되거나, 실제 촬영된 실물 객체에 기초하여 생성될 수 있는 등 다양한 방법으로 생성될 수 있다. 증강 장치는 마스크 셋에 포함된 복수의 마스크(400, 402, 404) 중 하나의 마스크를 선택할 수 있다. 본 발 명의 일 실시예에 의하면, 증강 장치는 복수의 마스크(400, 402, 404) 중 랜덤하게 하나의 마스크를 선택할 수 있다. 도 4a에서 증강 장치는 제3 마스크를 선택한다. 제3 마스크와 패치의 사이즈가 일치하지 않는 경우, 증강 장치는 제3 마스크의 크기를 패치 의 사이즈에 기초하여 조절한다. 증강 장치는 패치의 사이즈와 동일한 크기로 조정된 제3 조정된 마 스크(404a)를 획득한다. 증강 장치는 제3 조정된 마스크(404a)를 패치에 적용한다. 제3 조정된 마스크(404a) 내 분할하려는 모양의 엣지와 객체의 엣지가 다르므로, 패치로부터 제3 조정된 마스크(404a)에 따라 분할된 객체가 추출된다. 증강 장치는 분할된 객체를 배경 이미지에 그대로 합성할 수도 있고, 분할된 객체를 스타일 변환하거 나 워핑한 후 배경 이미지에 합성할 수 있다. 증강 장치는 서로 다른 모양의 엣지 정보를 가지는 복수의 마스크(400, 402, 404)로부터 랜덤하게 선택된 마스 크를 패치에 적용함으로써, 다양한 모양의 객체를 얻을 수 있으며, 다양한 모양의 객체를 이용하여 다양한 증강 데이터를 생성할 수 있다. 도 4b를 참조하면, 본 발명의 일 실시예에 따른 증강 장치는 SIFT(Scale-Invariant Feature Transform) 및 HoG(Histogram of Gradients) 방법을 이용하여 객체를 분할할 수 있다. SIFT 방법 및 HoG 방법 모두 객체의 모양, 패턴, 색상 또는 이들의 조합으로부터 객체의 특징점들을 추출하는 방법이다. SIFT 방법 및 HoG 방법은 이미지 처리 기술 분야에서 통상의 지식을 가진 자에게 자명하므로, 자세한 설명은 생략한다. 증강 장치는 객체가 포함된 패치로부터 SIFT 기반 특징점 정보 또는 HoG 기반 특징점 정보 중 적어도 하나를 추출하고, 추출된 정보를 기반으로 분할된 객체를 획득할 수 있다. 도 4c를 참조하면, 패치, 패치 픽셀(460a), 객체, 및 객체 픽셀(462a)이 도시되어 있다. 본 발명의 일 실시예에 따른 증강 장치는 패치의 픽셀 값과 객체의 픽셀 값을 비교하여 패치으 로부터 객체를 분할할 수 있다. 구체적으로, 증강 장치는 객체 내 임의의 위치에 있는 객체 픽셀(462a)을 선택한다. 객체 픽셀(462a)은 객 체의 중앙에 위치하는 픽셀일 수 있다. 증강 장치는 패치에 포함된 복수의 패치 픽셀들의 값들을 객체 픽셀(462a)의 값과 비교한다. 예를 들면, 객체 픽셀(462a)의 값과 패치 픽셀(460a)의 값 간 차이가 미리 설정된 값보다 큰 경우, 증강 장치는 패치 픽셀 (460a)을 무시한다. 반대로, 객체 픽셀(462a)의 값과 패치 픽셀(460a)의 값 간 차이가 미리 설정된 값보다 작은 경우, 증강 장치는 패치 픽셀(460a)을 객체를 구성하는 픽셀로 판단한다. 이와 같은 과정을 패치에 포함된 픽셀들에 수행함으로써, 증강 장치는 패치으로부터 객체를 분 할할 수 있다. 도 5는 본 발명의 일 실시예에 따른 스타일 변환을 설명하기 위해 예시한 도면이다. 도 5를 참조하면, 객체, 합성 영역 및 스타일 변환된 객체가 도시되어 있다. 본 발명의 일 실시예에 따른 증강 장치는 객체의 컨텐트 및 합성 영역의 스타일에 기초하여, 스타일 변환된 객체를 생성할 수 있다. 스타일 변환된 객체는 객체의 엣지와 합성 영역의 색감을 가진다. 증강 장치는 딥러닝 기반 스타일 변환 모델을 이용하여 스타일 변환된 객체를 생성할 수 있다. 스타일 변 환 모델은 두 개의 이미지를 입력 받아 하나의 이미지의 스타일을 나머지 이미지의 컨텐트에 적용한다. 스타일 변환 모델은 신경망 구조를 가지며, 신경망 구조는 이미지로부터 특징을 추출하는 인코더와 추출된 특징으로부 터 이미지를 복원하는 디코더로 구성된다. 스타일 변환 모델은 다양한 학습 방법에 의해 학습될 수 있다. 증강 장치는 객체와 합성 영역을 스타일 변환 모델에 입력하여 스타일 변환된 객체를 얻을 수 있다. 증강 장치는 합성될 합성 영역의 스타일에 기초하여 스타일 변환된 객체를 합성 영역에 합성함으로써, 위화감이 적은 합성 이미지를 생성할 수 있다. 한편, 본 발명의 일 실시예에 따른 증가 장치는 도 3에서 설명된 방법과 같이 픽셀 값에 기초하여 합성 영역 을 획득하고, 픽셀 값에 기초하여 획득된 합성 영역의 스타일을 객체의 컨텐트에 적용함으로써, 합성 영역과 객체를 조화롭게 합성할 수 있다. 도 3을 참조하면, 제1 영역과 같이 스타일이 다 른 영역이 공존하는 영역이 아니라, 제2 영역과 같이 하나의 스타일로 구성된 영역의 스타일을 이용하므로, 합성 영역과 객체의 합성이 더 자연스러워진다. 한편, 인식 모델이 입력 이미지로부터 타겟 객체를 인식하도록 인식 모델을 훈련시키기 위해, 타겟 객체가 포함 된 이미지들이 필요하다. 하지만, 일반적으로 타겟 객체가 포함된 이미지보다 타겟 객체가 포함되지 않은 이미 지의 수가 많다. 타겟 객체가 포함된 이미지를 훈련 데이터로 훈련하는 인식 모델의 경우, 훈련 데이터의 수가적어 인식 모델의 훈련이 완료되더라도 인식 모델의 인식 성능이 제한적일 수 있다. 따라서, 훈련 데이터 수를 증가시키기 위해, 본 발명의 일 실시예에 따른 증강 장치는 데이터 증강을 통해 타겟 객체가 포함된 이미지들을 생성할 수 있다. 인식 모델의 훈련 데이터인, 타겟 객체가 포함된 이미지들의 수가 많을수록, 훈련된 인식 모델의 성능이 개선될 수 있다. 나아가, 증강 장치는 객체가 포함되지 않은 이미지에 객체를 합성하여 합성 이미지를 생성할 수 있다. 특히, 이 미지가 객체를 포함하지 않음에도 불구하고, 인식 모델이 객체를 포함하는 것으로 인식한 이미지에 객체를 합성 하여 합성 이미지를 생성하고, 합성 이미지를 인식 모델의 훈련 데이터로 이용함으로써, 인식 모델의 성능을 더 욱 개선할 수 있다. 도 6은 본 발명의 일 실시예에 따른 인식 모델의 훈련 데이터 셋을 설명하기 위해 예시적으로 나타낸 도면이다. 도 6을 참조하면, 포지티브 데이터는 타겟 객체를 포함하는 이미지를 나타내고, 네거티브 데이터는 타겟 객체를 포함하지 않는 이미지를 나타낸다. 포지티브 패치는 타겟 객체를 포함하되 포지티브 데이터 보다 작은 이미지이며, 포지티브 데이터로부터 획득된다. 증강 장치는 네거티브 데이터를 인식 모델에 입력하여, 인식 모델로 하여금 네거티브 데이터 내에 객체가 포함되었는지 여부를 판단하도록 한다. 즉, 인식 모델은 네거티브 데이터가 객체 를 포함하는지 여부를 판단한다. 나아가, 증강 장치는 포지티브 데이터를 인식 모델에 입력하여, 인 식 모델로 하여금 포지티브 데이터 내에 객체가 포함되었는지 여부를 판단하도록 할 수 있다. 이때, 네거티브 데이터가 객체를 포함하지 않음에도 불구하고, 인식 모델이 네거티브 데이터에 객체가 포함된 것으로 잘못 인식(misrecognize)할 수 있다. 또한, 포지티브 데이터는 객체를 포함하지만, 인식 모델이 포지티브 데이터에 포함된 객체의 수보다 더 많은 객체들이 포함된 것으로 잘못 인식할 수 있다. 오인식된 데이터는 객체를 포함하지 않지만 인식 모델에 의해 객체를 포함하는 것으로 판단 되거나, 포함하는 객체의 수보다 많은 객체들을 포함하는 것으로 판단된 데이터이다. 오인식된 데이터는 위양성 데이터(false positive data)로 지칭될 수 있다. 증강 장치는 오인식된 데이터에 포지티브 패치를 합성함으로써 증강 데이터를 생성한다. 증강 장치는 증강 데이터를 포지티브 데이터와 함께 훈련 데이터 셋으로 구성한다. 증강 장치는 훈련 데이터 셋을 이용하여 인식 모델을 훈련할 수 있다. 이 경우, 인식 모델은 객체가 있는 것으로 잘못 판단한 영역을 객체가 없는 영역으로 판단하도록 훈련된다. 또한, 인식 모델은 객체가 합성된 영역에 객체가 존재하는 것으로 판단하도록 훈련된다. 위 과정과 같이, 오인식된 데이터에 포지티브 패치가 합성된 증강 데이터를 훈련 데이터 셋 으로 이용함으로써, 인식 모델의 성능이 개선될 수 있다. 나아가, 객체를 포함하는 데이터의 수가 증 가하고, 이미지 내 객체의 수가 증가하므로, 인식 모델의 성능이 개선될 수 있다. 도 7은 본 발명의 일 실시예에 따른 데이터 증강 방법을 설명하기 위해 나타낸 순서도다. 증강 장치는 객체를 포함하는 패치, 및 이미지를 획득한다(S700). 본 발명의 일 실시예에 의하면, 이미지는 인식 모델에 의해 타겟 객체가 포함된 것으로 오인식된 것이며, 합성 된 이미지는 인식 모델의 훈련 데이터 셋을 구성하는 것일 수 있다. 증강 장치는 복수의 마스크 중에서 하나의 마스크를 선택한다(S702). 여기서, 각 마스크는 내부에 기하학적 모양을 포함하며, 기하학적 모양의 내부의 픽셀 값은 1이고, 외부의 픽셀 값은 0이다. 복수의 마스크 중 적어도 두 개의 마스크는 서로 다른 모양의 엣지 정보를 가진다. 본 발명의 일 실시예에 의하면, 증강 장치는 복수의 마스크 중에서 랜덤하게 하나의 마스크를 선택할 수 있다. 증강 장치는 선택된 마스크를 패치에 적용한다(S704). 증강 장치는 분할된 객체를 획득한다(S706). 증강 장치는 분할된 객체를 이미지에 합성한다(S708). 본 발명의 일 실시예에 의하면, 증강 장치는 이미지 내 각 픽셀의 값이 소정의 범위 내에 속하는 복수의 픽셀들 을 포함하는 영역을 탐지하고, 탐지된 영역에 분할된 객체를 합성할 수 있다.본 발명의 일 실시예에 의하면, 분할된 객체의 컨텐트 및 탐지된 영역의 스타일에 기초하여, 스타일 변환된 객 체를 생성할 수 있다. 도 8은 본 발명의 일 실시예에 따른 전자장치의 구성도다. 도 8을 참조하면, 전자장치는 메모리, 프로세서, 스토리지, 입출력 인터페이스 및 통 신 인터페이스 중 일부 또는 전부를 포함할 수 있다. 전자장치는 데이터 증강 장치를 나타낸다. 메모리는 프로세서로 하여금 본 발명의 일 실시예에 따른 데이터 증강 방법을 수행하도록 하는 프로 그램을 저장할 수 있다. 예를 들면, 프로그램은 프로세서에 의해서 실행 가능한(executable) 복수의 명령 어들을 포함할 수 있고, 복수의 명령어들이 프로세서에 의해서 실행됨으로써 데이터 증강 방법이 수행될 수 있다. 또한, 메모리는 객체를 포함하는 패치, 이미지 및 복수의 마스크를 저장할 수 있다. 메모리는 단일 메모리 또는 복수의 메모리들일 수 있다. 이 경우, 패치, 이미지 및 복수의 마스크는 단일 메모리에 저장되거나 복수의 메모리들에 나뉘어 저장될 수 있다. 메모리가 복수의 메모리들로 구성된 경우, 복수의 메모리들은 물리적으로 분리될 수 있다. 메모리는 휘발성 메모리 및 비휘발성 메모리 중 적어도 하나를 포함할 수 있다. 휘발성 메모리는 SRAM(Static Random Access Memory) 또는 DRAM(Dynamic Random Access Memory) 등을 포함하고, 비휘발성 메모 리는 플래시 메모리(flash memory) 등을 포함한다. 프로세서는 적어도 하나의 명령어들을 실행할 수 있는 적어도 하나의 코어를 포함할 수 있다. 프로세서 는 메모리에 저장된 명령어들을 실행할 수 있다. 프로세서는 단일 프로세서 또는 복수의 프로세서들일 수 있다. 본 발명의 일 실시예에 따른 증강 장치는 마스크 선택부, 객체 획득부 및 객체 합성부를 포함할 수 있다. 이때, 마스크 선택부, 객체 획득부 및 객체 합 성부의 각 기능은 단일 프로세서 또는 복수의 프로세서들로 구현될 수 있다. 스토리지는 전자장치에 공급되는 전력이 차단되더라도 저장된 데이터를 유지한다. 예를 들면, 스토리 지는 EEPROM(Electrically Erasable Programmable Read-Only Memory), 플래시 메모리(flash memory), PRAM(Phase Change Random Access Memory), RRAM(Resistance Random Access Memory), NFGM(Nano Floating Gate Memory) 등과 같은 비휘발성 메모리를 포함할 수도 있고, 자기 테이프, 광학 디스크, 자기 디스크와 같은 저장 매체를 포함할 수도 있다. 일부 실시예들에서, 스토리지는 전자장치로부터 탈착 가능할 수도 있 다. 본 발명의 일 실시예에 의하면, 스토리지는 데이터를 증강하는 프로그램을 저장할 수 있다. 스토리지(83 0)에 저장된 프로그램은 프로세서에 의해서 실행되기 이전에 메모리로 로딩될 수 있다. 스토리지 는 프로그램 언어로 작성된 파일을 저장할 수 있고, 파일로부터 컴파일러 등에 의해서 생성된 프로그램은 메모리로 로딩될 수 있다. 스토리지는 프로세서에 의해서 처리될 데이터 및 프로세서에 의해서 처리된 데이터를 저장할 수 있다. 입출력 인터페이스는 키보드, 마우스 등과 같은 입력 장치를 포함할 수 있고, 디스플레이 장치, 프린터 등 과 같은 출력 장치를 포함할 수 있다. 사용자는 입출력 인터페이스를 통해 프로세서에 의한 프로그램의 실행을 트리거할 수도 있다. 통신 인터페이스는 외부 네트워크에 대한 액세스를 제공한다. 예를 들면, 전자장치는 통신 인터페이 스를 통해 다른 장치들과 통신할 수 있다. 한편, 전자장치는 데스크탑 컴퓨터, 서버, AI 가속기 등과 같은 고정형(stationary) 컴퓨팅 장치뿐만 아니 라, 랩탑 컴퓨터, 스마트 폰 등과 같은 휴대용(mobile) 컴퓨팅 장치일 수도 있다. 도 7에서는 과정 S700 내지 과정 S708을 순차적으로 실행하는 것으로 기재하고 있으나, 이는 본 발명의 일 실시 예의 기술 사상을 예시적으로 설명한 것에 불과한 것이다. 다시 말해, 본 발명의 일 실시예가 속하는 기술 분야 에서 통상의 지식을 가진 자라면 본 발명의 일 실시예의 본질적인 특성에서 벗어나지 않는 범위에서 도 7에 기 재된 순서를 변경하여 실행하거나 과정 S700 내지 과정 S708 중 하나 이상의 과정을 병렬적으로 실행하는 것으 로 다양하게 수정 및 변형하여 적용 가능할 것이므로, 도 7은 시계열적인 순서로 한정되는 것은 아니다.한편, 도 7에 도시된 과정들은 컴퓨터로 읽을 수 있는 기록매체에 컴퓨터가 읽을 수 있는 코드로서 구현하는 것 이 가능하다. 컴퓨터가 읽을 수 있는 기록매체는 컴퓨터 시스템에 의하여 읽혀질 수 있는 데이터가 저장되는 모 든 종류의 기록장치를 포함한다. 즉, 이러한 컴퓨터가 읽을 수 있는 기록매체는 ROM, RAM, CD-ROM, 자기 테이 프, 플로피디스크, 광 데이터 저장장치 등의 비일시적인(non-transitory) 매체를 포함한다. 또한 컴퓨터가 읽을 수 있는 기록매체는 네트워크로 연결된 컴퓨터 시스템에 분산되어 분산방식으로 컴퓨터가 읽을 수 있는 코드가 저장되고 실행될 수 있다. 또한, 본 발명의 구성 요소들은 메모리, 프로세서, 논리 회로, 룩-업 테이블(look-up table) 등과 같은 집적 회 로 구조를 사용할 수 있다. 이러한 집적 회로 구조는 하나 이상의 마이크로 프로세서 또는 다른 제어 장치의 제 어를 통해 본 명세서에 기술 된 각각의 기능을 실행한다. 또한, 본 발명의 구성 요소들은 특정 논리 기능을 수 행하기 위한 하나 이상의 실행 가능한 명령을 포함하고 하나 이상의 마이크로 프로세서 또는 다른 제어 장치에 의해 실행되는 프로그램 또는 코드의 일부에 의해 구체적으로 구현될 수 있다. 또한, 본 발명의 구성 요소들은 각각의 기능을 수행하는 중앙 처리 장치(CPU), 마이크로 프로세서 등을 포함하거나 이에 의해 구현될 수 있다. 또한, 본 발명의 구성 요소들은 하나 이상의 프로세서에 의해 실행되는 명령어들을 하나 이상의 메모리에 저장 할 수 있다. 이상의 설명은 본 실시예의 기술 사상을 예시적으로 설명한 것에 불과한 것으로서, 본 실시예가 속하는 기술 분 야에서 통상의 지식을 가진 자라면 본 실시예의 본질적인 특성에서 벗어나지 않는 범위에서 다양한 수정 및 변 형이 가능할 것이다. 따라서, 본 실시예들은 본 실시예의 기술 사상을 한정하기 위한 것이 아니라 설명하기 위 한 것이고, 이러한 실시예에 의하여 본 실시예의 기술 사상의 범위가 한정되는 것은 아니다. 본 실시예의 보호 범위는 아래의 청구범위에 의하여 해석되어야 하며, 그와 동등한 범위 내에 있는 모든 기술 사상은 본 실시예의 권리범위에 포함되는 것으로 해석되어야 할 것이다."}
{"patent_id": "10-2021-0149588", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 종래의 데이터 증강 방법을 예시적으로 나타낸 도면이다. 도 2는 본 발명의 일 실시예에 따른 데이터 증강 방법을 나타낸 도면이다. 도 3은 본 발명의 일 실시예에 따른 합성 영역 탐지를 설명하기 위해 예시적으로 나타낸 도면이다. 도 4a, 도 4b 및 도 4c는 본 발명의 일 실시예에 따른 객체의 분할을 설명하기 위해 예시적으로 나타낸 도면이 다. 도 5는 본 발명의 일 실시예에 따른 스타일 변환을 설명하기 위해 예시한 도면이다. 도 6은 본 발명의 일 실시예에 따른 인식 모델의 훈련 데이터 셋을 설명하기 위해 예시적으로 나타낸 도면이다. 도 7은 본 발명의 일 실시예에 따른 데이터 증강 방법을 설명하기 위해 나타낸 순서도다. 도 8은 본 발명의 일 실시예에 따른 전자장치의 구성도다."}
