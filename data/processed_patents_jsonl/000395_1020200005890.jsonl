{"patent_id": "10-2020-0005890", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2021-0092464", "출원번호": "10-2020-0005890", "발명의 명칭": "인공지능을 사용한 네트워크 트래픽 분석 장치 및 방법", "출원인": "주식회사 윈스", "발명자": "최병환"}}
{"patent_id": "10-2020-0005890", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "보안 장치로부터 전달되는 정보를 기반으로 제1 이벤트에 대응되는 패킷 정보를 확인하는 단계;상기 패킷 정보와 제1 유사도 판단 기준을 기반으로 악성 행위 관련 우선 순위 정보를 기반으로 학습된 인공지능(artificial intelligence, AI) 엔진을 사용하여 상기 제1 이벤트가 악성 행위에 대응하는지 확인하는 단계;상기 제1 이벤트가 악성 행위에 대응하는 경우 상기 패킷 정보를 기반으로 상기 제1 이벤트에 대응하는 특징 정보를 추출하여 침입 방지 시스템에 적용할 제1 규칙을 배포하는 단계;상기 제1 규칙에 대응하는 추가 패킷 정보를 확인하는 단계;상기 제1 유사도 판단 기준과 상이한 제2 유사도 판단 기준을 기반으로 상기 추가 패킷 정보에 대응하는 메타정보 및 상기 제1 규칙에 대응하는 메타 정보의 유사도를 분석하는 단계;상기 메타 정보의 유사도 분석을 기반으로 상기 추가 패킷 정보에 대응하는 제2 이벤트의 공격 유형을 확인하여악성 행위로의 확정 여부를 판단하는 단계; 및상기 제2 이벤트가 악성 행위로 확정되는 경우 상기 제2 이벤트에 대응하는 특징 정보를 추출하여 상기 침입 방지 시스템에 적용할 제2 규칙을 배포하는 단계를 포함하는, 트래픽 분석 방법."}
{"patent_id": "10-2020-0005890", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 패킷 정보를 확인하는 단계는 상기 보안 장치로부터 전달되는 정보가 코드를 포함하는 파일일 경우 샌드박스(sandbox)상에서 상기 코드에 대응하는 패킷 정보를 확인하는 것을 특징으로 하는, 트래픽 분석 방법."}
{"patent_id": "10-2020-0005890", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1항에 있어서,상기 패킷 정보는 패킷의 플로우(flow), 헤더(header) 및 데이터(data)에 대한 정보를 적어도 하나 이상 포함하는 것을 특징으로 하는, 트래픽 분석 방법."}
{"patent_id": "10-2020-0005890", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제1항에 있어서,상기 악성 행위 관련 우선 순위 정보는 악성 행위로 판단된 동작이 수행될 때 패킷 정보에 포함되는 정보의 유형을 기반으로 도출된 각 정보의 유형에 대응하는 우선 순위 정보를 포함하는 것을 특징으로 하는, 트래픽 분석방법."}
{"patent_id": "10-2020-0005890", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제1항에 있어서,상기 악성 행위에 대응하는지 확인하는 단계는,상기 패킷 정보와 제1 유사도 판단 기준을 기반으로 상기 제1 이벤트가 악성 행위 분류에 대응하는지 판단하는단계; 및상기 제1 이벤트가 상기 악성 행위 분류에 대응하는 경우, 상기 패킷 정보 및 공격 유형별 정보를 기반으로 상기 제1 이벤트에 대응하는 공격 유형을 확인하는 단계를 포함하는 것을 특징으로 하는, 트래픽 분석 방법."}
{"patent_id": "10-2020-0005890", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "공개특허 10-2021-0092464-3-제5항에 있어서,상기 제1 이벤트가 악성 행위 분류에 대응하는지 판단하는 단계는 머신 러닝(machine learning)을 기반으로 코사인 유사도 알고리즘(cosine similarity algorithm)을 사용하여 판단하는 것을 특징으로 하는, 트래픽 분석 방법."}
{"patent_id": "10-2020-0005890", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제5항에 있어서,상기 제1 이벤트가 악성 행위 분류에 대응하고, 상기 제1 이벤트에 대응하는 공격 유형이 확인되지 않는 경우,상기 제1 이벤트와 관련된 정보를 기반으로 상기 AI 엔진을 학습시키는 단계를 더 포함하는 것을 특징으로하는, 트래픽 분석 방법."}
{"patent_id": "10-2020-0005890", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제5항에 있어서,상기 악성 행위에 대응하는지 확인하는 단계는,상기 공격 유형에 대응하는 메타 정보와 상기 제1 이벤트의 유사도를 분석하는 단계; 및상기 유사도 분석을 기반으로 상기 공격 유형의 버전 정보를 확인하는 단계를 더 포함하는 것을 특징으로 하는,트래픽 분석 방법."}
{"patent_id": "10-2020-0005890", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제1항에 있어서,상기 메타 정보의 유사도 분석을 기반으로 상기 제2 이벤트의 공격 유형이 확인되지 않는 경우, 상기 제2 이벤트와 관련된 정보를 기반으로 상기 AI 엔진을 학습시키는 단계를 더 포함하는 것을 특징으로 하는, 트래픽 분석방법."}
{"patent_id": "10-2020-0005890", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제1항에 있어서,상기 제2 이벤트의 악성 행위로의 확정 여부를 판단하는 단계는 머신 러닝을 기반으로 코사인 유사도 알고리즘을 사용하여 판단하는 것을 특징으로 하는, 트래픽 분석 방법."}
{"patent_id": "10-2020-0005890", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "제1항에 있어서,상기 제1 규칙을 배포하는 단계 및 제2 규칙을 배포하는 단계는,특징 정보가 고유 패턴(unique pattern)에 대응되는 경우, 상기 고유 패턴에 대해 유효성 여부를 검증하는단계; 및상기 고유 패턴의 유효성이 검증되는 경우, 상기 고유 패턴을 기반으로 침입 방지 시스템에 적용할 규칙을 설정하는 단계를 포함하는 것을 특징으로 하는, 트래픽 분석 방법."}
{"patent_id": "10-2020-0005890", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "보안 장치로부터 전달되는 정보를 제1 이벤트로 수집하는 이벤트 수집 엔진;상기 이벤트 수집 엔진에서 수집된 제1 이벤트에 대응되는 패킷 정보를 분석하고 및 배포되는 제1 규칙에 대응하는 추가 패킷 정보를 확인하는 위협 분석 엔진;상기 패킷 정보와 제1 유사도 판단 기준을 기반으로 악성 행위 관련 우선 순위 정보를 기반으로 학습된 인공지능 엔진을 사용하여 상기 제1 이벤트가 악성 행위에 대응하는지 확인하고 및 상기 제1 유사도 판단 기준과 상이한 제2 유사도 판단 기준을 기반으로 상기 추가 패킷 정보에 대응하는 메타 정보 및 상기 제1 규칙에 대응하는메타 정보의 유사도를 분석하여 상기 추가 패킷 정보에 대응하는 제2 이벤트의 공격 유형을 확인하고 악성 행위공개특허 10-2021-0092464-4-로의 확정 여부를 판단하는 AI 엔진; 및상기 제1 이벤트가 악성 행위에 대응하는 경우 상기 패킷 정보를 기반으로 상기 제1 이벤트에 대응하는 특징 정보를 추출하여 침입 방지 시스템에 적용할 상기 제1 규칙을 배포하고 및 상기 제2 이벤트가 악성 행위로 확정되는 경우 상기 제2 이벤트에 대응하는 특징 정보를 추출하여 상기 침입 방지 시스템에 적용할 제2 규칙을 배포하는 규칙 처리 엔진을 포함하는, 트래픽 분석 장치."}
{"patent_id": "10-2020-0005890", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "제1항 내지 제11항 중 어느 한 항에 따른 방법을 수행하는 제어부를 포함하는, 트래픽 분석 장치."}
{"patent_id": "10-2020-0005890", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 악성코드에서 추출된 트래픽 정보를 분석하여 생성한 패턴을 바탕으로 보안장비에서 변종 공격을 식별 할 수 있고, 공격 유형의 유사도 분석을 통해 신규 또는 변종에 대한 분석을 가능하게 하는 AI 기반의 트래픽 분 석 장치 및 방법에 관한 것이다. 이를 위한 본 발명의 AI 기반의 트래픽 분석 방법은 보안 장치로부터 전달되는 (뒷면에 계속)"}
{"patent_id": "10-2020-0005890", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 인공지능(Artificial Intelligence, AI) 기반의 네트워크 트래픽 분석 장치 및 방법에 관한 것이고, 보다 상세하게 AI를 사용하여 악성코드와 관련된 트래픽에서 악성코드 고유의 패턴 정보를 적응 추출하고, 실제 망에 패턴 정보와 관련된 룰(rule)을 적용하여 악성코드와 관련된 공격을 식별하고, 룰을 적응적으로 업데이트 할 수 있는 장치 및 방법에 관한 것이다."}
{"patent_id": "10-2020-0005890", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "최근, P2P(Peer-to-Peer) 응용서비스, 이메일 등을 통해 비정상 트래픽을 발생시키는 웜, 바이러스, 백도어, 랜 섬웨어 등이 인터넷에 다량으로 유포되고 있으며, 이들의 공격기법 또한 고도화되고 다양화되어 가는 추세이다. 이들 공격기법은 정보통신망의 안전성 및 신뢰성을 위협하고 있어서, 공격에 대한 발생 징후를 사전에 탐지하여 대응할 수 있는 방안의 필요성이 대두되고 있다. 보다 구체적으로 네트워크 공격과 관련된 침입 행위는 오용 침입 및 비정상적인 침입 등이 있을 수 있으며, 이 외에도 다양한 침입 유형이 있다. 이에 많은 침입탐지 기법들이 소개되고 이들을 탑재한 침입탐지 시스템(IDS: Intrusion Detection System)들이 상용화되고 있으며, 침입에 대한 패턴 정보를 기반으로 침입에 대한 탐지를 하고 있으나, 침입의 패턴이 다양하고 짧은 시간에 변화하게 되는바, 오탐율이 증가하게 된다. 한편, 고속 네트워크 환경에서 변형된 공격의 유형을 빠르게 검출 및 검증하기에는 보안 운영 인력적인 부분과 시간적 노력이 과다하게 소모되기 때문에 악성코드가 생성하는 악성 트래픽으로부터 공격 유형을 분류하고, 패 킷 분석을 통해 보다 빠르게 알려지지 않는 공격에 대처할 필요성이 있다. 또한, 기존의 패턴 생성이 분석가의 기술에 의존성이 높고, 분석가 수준에 따른 정탐 편차가 커서, 패킷 수집부 터 분석까지의 수행시간이 오래 걸리고 패턴 검증까지의 패턴 추출 생성 시간이 장기화되는 문제가 존재한다. 그리고, 최근 악성 코드가 오픈 소스(open source)화 됨에 따라 공격의 변종이 많아지고, 공격 패턴의 수명주기 시간(lifecycle time)이 짧아지고 있어, 이를 수동으로 분석하기 위해서는 많은 분석 노력과 시간이 발생하게 된다."}
{"patent_id": "10-2020-0005890", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 명세서의 실시 예는 AI를 활용하여 악성코드에서 추출된 트래픽 정보를 분석하는 장치 및 방법을 제공하는 것을 목적으로 한다. 또한 분석된 트래픽 정보를 기반으로 생성한 패턴을 네트워크 보안장비에 적용하고, 보안 장비에서 실제 송수신 되는 패킷을 분석하여 패턴 정보를 업데이트 함으로써 변종 공격을 식별할 수 있고, 공격 유형의 유사도 분석을 통해 신규 또는 변종에 대한 분석을 가능하게 하는 AI 기반의 트래픽 분석 장치 및 방법을 제공하는데 그 목적 이 있다."}
{"patent_id": "10-2020-0005890", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "상기와 같은 과제를 해결하기 위한 AI 기반의 트래픽 분석 방법은 보안 장치로부터 전달되는 정보를 기반으로 제1 이벤트에 대응되는 패킷 정보를 확인하는 단계; 패킷 정보와 제1 유사도 판단 기준을 기반으로 악성 행위 관련 우선 순위 정보를 기반으로 학습된 인공지능(artificial intelligence, AI) 엔진을 사용하여 제1 이벤트가 악성 행위에 대응하는지 확인하는 단계; 제1 이벤트가 악성 행위에 대응하는 경우 패킷 정보를 기반으로 제1 이 벤트에 대응하는 특징 정보를 추출하여 침입 방지 시스템에 적용할 제1 규칙을 배포하는 단계; 제1 규칙에 대응 하는 추가 패킷 정보를 확인하는 단계; 제1 유사도 판단 기준과 상이한 제2 유사도 판단 기준을 기반으로 추가 패킷 정보에 대응하는 메타 정보 및 제1 규칙에 대응하는 메타 정보의 유사도를 분석하는 단계; 메타 정보의 유 사도 분석을 기반으로 추가 패킷 정보에 대응하는 제2 이벤트의 공격 유형을 확인하여 악성 행위로의 확정 여부 를 판단하는 단계; 및 제2 이벤트가 악성 행위로 확정되는 경우 제2 이벤트에 대응하는 특징 정보를 추출하여 침입 방지 시스템에 적용할 제2 규칙을 배포하는 단계를 포함하는 것을 특징으로 한다. 또한, 패킷 정보를 확인하는 단계는 보안 장치로부터 전달되는 정보가 코드를 포함하는 파일일 경우 샌드박스 (sandbox) 상에서 코드에 대응하는 패킷 정보를 확인할 수 있다. 또한, 패킷 정보는 패킷의 플로우(flow), 헤더(header) 및 데이터(data)에 대한 정보를 적어도 하나 이상 포함 할 수 있다. 또한, 행위 관련 우선 순위 정보는 악성 행위로 판단된 동작이 수행될 때 패킷 정보에 포함되는 정보의 유형을 기반으로 도출된 각 정보의 유형에 대응하는 우선 순위 정보를 포함할 수 있다. 또한, 악성 행위에 대응하는지 확인하는 단계는 패킷 정보와 제1 유사도 판단 기준을 기반으로 제1 이벤트가 악 성 행위 분류에 대응하는지 판단하는 단계; 및 제1 이벤트가 악성 행위 분류에 대응하는 경우, 패킷 정보 및 공 격 유형별 정보를 기반으로 제1 이벤트에 대응하는 공격 유형을 확인하는 단계를 포함할 수 있다. 또한, 제1 이벤트가 악성 행위 분류에 대응하는지 판단하는 단계는 머신 러닝(machine learning)을 기반으로 코 사인 유사도 알고리즘(cosine similarity algorithm)을 사용하여 판단할 수 있다. 또한, 본 발명의 일 실시예에 따른 AI 기반의 트래픽 분석 방법은 제1 이벤트가 악성 행위 분류에 대응하고, 제 1 이벤트에 대응하는 공격 유형이 확인되지 않는 경우, 제1 이벤트와 관련된 정보를 기반으로 AI 엔진을 학습시 키는 단계를 더 포함할 수 있다. 또한, 악성 행위에 대응하는지 확인하는 단계는 공격 유형에 대응하는 메타 정보와 제1 이벤트의 유사도를 분석 하는 단계; 및 유사도 분석을 기반으로 공격 유형의 버전 정보를 확인하는 단계를 더 포함할 수 있다. 또한, 메타 정보의 유사도 분석을 기반으로 제2 이벤트의 공격 유형이 확인되지 않는 경우, 제2 이벤트와 관련 된 정보를 기반으로 AI 엔진을 학습시키는 단계를 더 포함할 수 있다. 또한, 제2 이벤트의 악성 행위로의 확정 여부를 판단하는 단계는 머신 러닝을 기반으로 코사인 유사도 알고리즘 을 사용하여 판단할 수 있다. 또한, 제1 규칙을 배포하는 단계 및 제2 규칙을 배포하는 단계는 특징 정보가 고유 패턴(unique pattern)에 대 응되는 경우, 고유 패턴에 대해 유효성 여부를 검증하는 단계; 및 고유 패턴의 유효성이 검증되는 경우, 고유 패턴을 기반으로 침입 방지 시스템에 적용할 규칙을 설정하는 단계를 포함할 수 있다. 상기와 같은 과제를 해결하기 위한 본 발명의 AI 기반의 트래픽 분석 장치는 보안 장치로부터 전달되는 정보를 제1 이벤트로 수집하는 이벤트 수집 엔진; 이벤트 수집 엔진에서 수집된 제1 이벤트에 대응되는 패킷 정보를 분 석하고 및 배포되는 제1 규칙에 대응하는 추가 패킷 정보를 확인하는 위협 분석 엔진; 패킷 정보와 제1 유사도 판단 기준을 기반으로 악성 행위 관련 우선 순위 정보를 기반으로 학습된 인공지능 엔진을 사용하여 제1 이벤트 가 악성 행위에 대응하는지 확인하고 및 제1 유사도 판단 기준과 상이한 제2 유사도 판단 기준을 기반으로 추가 패킷 정보에 대응하는 메타 정보 및 제1 규칙에 대응하는 메타 정보의 유사도를 분석하여 추가 패킷 정보에 대 응하는 제2 이벤트의 공격 유형을 확인하고 악성 행위로의 확정 여부를 판단하는 AI 엔진; 및 제1 이벤트가 악 성 행위에 대응하는 경우 패킷 정보를 기반으로 제1 이벤트에 대응하는 특징 정보를 추출하여 침입 방지 시스템 에 적용할 제1 규칙을 배포하고 및 제2 이벤트가 악성 행위로 확정되는 경우 제2 이벤트에 대응하는 특징 정보 를 추출하여 침입 방지 시스템에 적용할 제 2 규칙을 배포하는 규칙 처리 엔진을 포함할 수 있다. 상기와 같은 과제를 해결하기 위한 본 발명의 일 실시예에 따른 AI 기반의 트래픽 분석 장치는 상술한 방법을 수행하는 제어부를 포함할 수 있다."}
{"patent_id": "10-2020-0005890", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명의 일 실시예에 따른 AI 기반의 트래픽 분석 장치 및 방법은 공격 유형의 유사도 분석 및 학습을 통한 공격 유형의 분류 과정, 공격 유형의 패턴 추출 과정을 자동화함으로써 보다 빠른 공격 변화에 대응할 수 있다. 또한, 본 발명의 일 실시예에 따른 AI 기반의 트래픽 분석 장치 및 방법은 지속적인 네트워크 흐름을 파악하여 분석가의 분석 지원 및 보안 운영의 빠른 지원효과를 가질 수 있다."}
{"patent_id": "10-2020-0005890", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하, 본 발명의 실시 예를 첨부된 도면을 참조하여 상세하게 설명한다. 실시 예를 설명함에 있어서 본 발명이 속하는 기술 분야에 익히 알려져 있고 본 발명과 직접적으로 관련이 없는 기술 내용에 대해서는 설명을 생략한다. 이는 불필요한 설명을 생략함으로써 본 발명의 요지를 흐리지 않고 더 욱 명확히 전달하기 위함이다. 마찬가지 이유로 첨부 도면에 있어서 일부 구성요소는 과장되거나 생략되거나 개략적으로 도시되었다. 또한, 각 구성요소의 크기는 실제 크기를 전적으로 반영하는 것이 아니다. 각 도면에서 동일한 또는 대응하는 구성요소에 는 동일한 참조 번호를 부여하였다. 본 발명의 이점 및 특징, 그리고 그것들을 달성하는 방법은 첨부되는 도면과 함께 상세하게 후술되어 있는 실시 예들을 참조하면 명확해질 것이다. 그러나 본 발명은 이하에서 개시되는 실시 예들에 한정되는 것이 아니라 서 로 다른 다양한 형태로 구현될 수 있으며, 단지 본 실시 예들은 본 발명의 개시가 완전하도록 하고, 본 발명이"}
{"patent_id": "10-2020-0005890", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "속하는 기술분야에서 통상의 지식을 가진 자에게 발명의 범주를 완전하게 알려주기 위해 제공되는 것이며, 본 발명은 청구항의 범주에 의해 정의될 뿐이다. 명세서 전체에 걸쳐 동일 참조 부호는 동일 구성 요소를 지칭한다. 이 때, 처리 흐름도 도면들의 각 블록과 흐름도 도면들의 조합들은 컴퓨터 프로그램 인스트럭션들에 의해 수행 될 수 있음을 이해할 수 있을 것이다. 이들 컴퓨터 프로그램 인스트럭션들은 범용 컴퓨터, 특수용 컴퓨터 또는 기타 프로그램 가능한 데이터 프로세싱 장비의 프로세서에 탑재될 수 있으므로, 컴퓨터 또는 기타 프로그램 가 능한 데이터 프로세싱 장비의 프로세서를 통해 수행되는 그 인스트럭션들이 흐름도 블록(들)에서 설명된 기능들 을 수행하는 수단을 생성하게 된다. 이들 컴퓨터 프로그램 인스트럭션들은 특정 방식으로 기능을 구현하기 위해 컴퓨터 또는 기타 프로그램 가능한 데이터 프로세싱 장비를 지향할 수 있는 컴퓨터 이용 가능 또는 컴퓨터 판독 가능 메모리에 저장되는 것도 가능하므로, 그 컴퓨터 이용가능 또는 컴퓨터 판독 가능 메모리에 저장된 인스트 럭션들은 흐름도 블록(들)에서 설명된 기능을 수행하는 인스트럭션 수단을 내포하는 제조 품목을 생산하는 것도 가능하다. 컴퓨터 프로그램 인스트럭션들은 컴퓨터 또는 기타 프로그램 가능한 데이터 프로세싱 장비 상에 탑재 되는 것도 가능하므로, 컴퓨터 또는 기타 프로그램 가능한 데이터 프로세싱 장비 상에서 일련의 동작 단계들이 수행되어 컴퓨터로 실행되는 프로세스를 생성해서 컴퓨터 또는 기타 프로그램 가능한 데이터 프로세싱 장비를 수행하는 인스트럭션들은 흐름도 블록(들)에서 설명된 기능들을 실행하기 위한 단계들을 제공하는 것도 가능하 다.또한, 각 블록은 특정된 논리적 기능(들)을 실행하기 위한 하나 이상의 실행 가능한 인스트럭션들을 포함하는 모듈, 세그먼트 또는 코드의 일부를 나타낼 수 있다. 또, 몇 가지 대체 실행 예들에서는 블록들에서 언급된 기 능들이 순서를 벗어나서 발생하는 것도 가능함을 주목해야 한다. 예컨대, 잇달아 도시되어 있는 두 개의 블록들 은 사실 실질적으로 동시에 수행되는 것도 가능하고 또는 그 블록들이 때때로 해당하는 기능에 따라 역순으로 수행되는 것도 가능하다. 이 때, 본 실시 예에서 사용되는 '~부'라는 용어는 소프트웨어 또는 FPGA또는 ASIC과 같은 하드웨어 구성요소를 의미하며, '~부'는 어떤 역할들을 수행한다. 그렇지만 '~부'는 소프트웨어 또는 하드웨어에 한정되는 의미는 아 니다. '~부'는 어드레싱할 수 있는 저장 매체에 있도록 구성될 수도 있고 하나 또는 그 이상의 프로세서들을 재 생시키도록 구성될 수도 있다. 따라서, 일 예로서 '~부'는 소프트웨어 구성요소들, 객체지향 소프트웨어 구성 요소들, 클래스 구성요소들 및 태스크 구성요소들과 같은 구성요소들과, 프로세스들, 함수들, 속성들, 프로시저 들, 서브루틴들, 프로그램 코드의 세그먼트들, 드라이버들, 펌웨어, 마이크로코드, 회로, 데이터, 데이터베이스, 데이터 구조들, 테이블들, 어레이들, 및 변수들을 포함한다. 구성요소들과 '~부'들 안에서 제공 되는 기능은 더 작은 수의 구성요소들 및 '~부'들로 결합되거나 추가적인 구성요소들과 '~부'들로 더 분리될 수 있다. 뿐만 아니라, 구성요소들 및 '~부'들은 디바이스 또는 보안 멀티미디어카드 내의 하나 또는 그 이상의 CPU들을 재생시키도록 구현될 수도 있다. 본 발명을 첨부된 도면을 참조하여 상세히 설명하면 다음과 같다. 여기서, 반복되는 설명, 본 발명의 요지를 불 필요하게 흐릴 수 있는 공지 기능, 및 구성에 대한 상세한 설명은 생략한다. 본 발명의 실시형태는 당 업계에서 평균적인 지식을 가진 자에게 본 발명을 보다 완전하게 설명하기 위해서 제공되는 것이다. 따라서, 도면에서의 요소들의 형상 및 크기 등은 보다 명확한 설명을 위해 과장될 수 있다. 도 1은 본 발명의 일 실시예에 따른 AI 기반의 트래픽 분석 장치에 대한 개념도이다. 일 실시예에서, 트래 픽 분석 장치는 복수의 클라이언트(1a, 1b), 서버 및 보안 장치를 포함하는 네트워크 침입탐지 시 스템에 적용될 수 있다. 트래픽 분석 장치는 보안 장치의 내부에 장착되거나 소프트웨어의 형태로 설 치될 수 있고, 별도의 장치 형태로 보안 장치에 직접 연결될 수도 있다. 본 발명의 일 실시예에 따른 트래 픽 분석 장치의 이해를 돕기 위해, 네트워크 침입탐지 시스템의 개념을 먼저 설명한다. 또한, 도 1 에서 클라이언트의 개수는 2개인 것으로 도시 되었으나, 이는 예시일 뿐이고 실제 환경에 따라 다양한 수의 클라이언 트들이 포함될 수 있다. 일반적으로 네트워크 침입 탐지 시스템은 의심스러운 파일이 발생할 시 샌드박스(Sandbox)에서 해당 파일을 정 적 또는 동적 분석하며, 트래픽 분석을 위해 패킷을 추출하고, 추출한 패킷에 대한 유효성 판단을 수행함으로써 악성 트래픽의 침입을 탐지한다. 그리고 정규화된 패턴을 생성하여 생성된 패턴을 보안 장비에 등록하고 일정기 간동안 수집되는 이벤트 추이 및 검증을 통해 거짓 양성 패턴(False Positive Pattern) 검증을 수행한다. 이와 같은 침입 탐지 방법은 생성된 패턴에 대한 검증, 육안 확인, 패킷 분석 등의 수행시간이 장기화되어 실제 패턴 을 적용한 후에 공격에 대한 탐지 및 차단 효율성이 떨어지므로, 변형된 공격이 발생할 시 유해 이벤트 인지의 필요성이 있다. 보안 장치는 특정 이벤트에 대응하여 복수의 클라이언트(1a, 1b)와 서버 사이에 송수신되는 패킷들을 확 인하고, 이를 분석함으로써 비정상(또는 악성) 트래픽(또는 패킷)을 탐지하는 기능을 한다. 보안 장치는 데 이터베이스에 저장된 공격 패턴 정보를 이용하여, 복수의 클라이언트(1a, 1b)와 관련하여 비정상 패킷을 확 인하고, 이에 따라 이벤트들에 대해 위협 여부를 확인하고, 공격 유형별 유사도 분류를 수행을 통해 공격 패턴 정보를 업데이트 할 수 있다. 실시 예에서 공격과 관련되어 발생하는 패킷을 비정상 패킷으로 칭한다. 예를 들어, 복수의 클라이언트(1a, 1b) 중 제1 클라이언트(1a)와의 통신에서 비정상 패킷이 발생하는 상황을 가 정한다. 보안 장치는 서버와 복수의 클라이언트(1a, 1b)사이에서 교환된 패킷들을 분석하고, 공격 패턴 에 대응하는 패킷이 있는지 판단할 수 있다. 클라이언트들로부터 수신한 패킷에 대한 판단 결과 공격 패턴에 대 응하지 않는 경우, 보안 장치는 수신한 패킷들을 서버로 전달한다. 판단 결과, 수신된 패킷이 공격 패턴 에 대응하는 정보가 포함되는 경우, 보안 장치는 공격 패턴에 대응하는 패킷을 차단할 수 있다. 한편 실시 예에서 보안 장치는 공격 패턴에 대응하는 패턴을 차단하고, 차단한 패킷을 제외한 나머지 패킷 (예를 들어, 정상 패킷)들만 서버로 전달할 수 있다. 실시 예에서 제1 클라이언트(1a)로부터 수신된 패킷에 공격 패턴에 대응하는 패킷이 존재하는 경우, 보안장치 는 제1 클라이언트(1a)로부터 수신된 비정상 패킷을 차단할 수 있다. 또한 실시 예에서 보안장치는 비 정상 패킷 이외의 패킷은 서버로 전달할 수 있다. 한편 일 실시 예에서 비정상 패킷을 전송한 제1 클라이언트(1a)를 이상 클라이언트로 분류하여 제1 클라이언트(1a)가 전송하는 패킷 전체를 차단할 수도 있다. 한편 실 시 예에서 이상 클라이언트로 분류된 제1 클라이언트(1a)가 전송하는 패킷은 트래픽 분석 장치를 통해 이 상 패턴과 관련된 정보를 업데이트 하는데 사용 될 수 있다. 실시 예에서 하나의 클라이언트에서 사용되는 악성 코드는 상이한 버전 혹은 변종된 악성 코드를 사용하여 업데이트 될 수 있는바, 트래픽 분석 장치에서 패 턴 정보 추출하고, 해당 악성 코드 각 버전에 대응하는 패턴 정보를 추출하고, 이를 집중적으로 관리할 수 있다. 트래픽 분석을 기반으로 하는 위협 탐지 장치 및 방법은 트래픽 분석을 통해 정규화된 패턴을 생성하여 비정상 패킷들을 탐지하므로 탐지율이 높은 장점이 있다. 공격 패턴은 생성된 후 데이터베이스에 저장되고 보안 장 치는 일정기간동안 수집되는 이벤트에 대해 검증을 수행함으로써 생성된 패턴의 유효성을 판단한다. 그러나 이에 따라 생성된 패턴에 대한 검증, 육안 확인, 패킷 분석 등의 수행시간이 장기화되어 실제 패턴 적용 후에 공격에 대한 탐지 및 차단 효율성이 떨어질 수 있는바, 이에 대한 적응적 관리를 위해 AI 엔진을 사용할 필요성 이 있다. 본 발명의 일 실시예에 따른 트래픽 분석 장치는 상술한 문제점을 해소하기 위한 것으로, 공격 유형의 유 사도 분석 및 AI 엔진 기반의 학습을 통해 공격 패턴 추출 과정을 자동화함으로써 보다 빠른 공격 변화에 대응 할 수 있다. 본 발명의 일 실시예에 따른 트래픽 분석 장치의 동작은 도 2를 참조로 상세히 설명된다. 도 2는 본 발명의 일 실시예에 따른 트래픽 분석 장치에 대한 블록도이다. 본 발명의 일 실시예에 따른 트 래픽 분석 장치는 이벤트 수집 엔진, 위협 분석 엔진, AI 엔진 및 규칙 처리 엔진을 포함할 수 있으며, 각 엔진은 하위 모듈을 포함한다. 이벤트 수집 엔진은 보안 장치로부터 전달되는 정보를 이벤트로서 수집한다. 일 예로, 이벤트 수집 엔 진은 파일, 트래픽 및 보안 장비에서 발생하는 각종 이벤트를 수집할 수 있다. 위협 분석 엔진은 이 벤트 수집 엔진에서 수집된 이벤트에 대응되는 패킷 정보를 분석한다. 위협 분석 엔진은 샌드박스 기 반의 분석 모듈과 네트워크 트래픽을 분석하는 패킷 분석기를 포함하여, 수집된 이벤트의 형식에 따 라 구분하여 처리할 수 있다. 특히 패킷 분석기는 주로 네트워크 계층에서 접근할 수 있는 가공되지 않은 raw 패킷에 대해 분석할 수 있다. AI 엔진은 위협 분석 엔진으로부터 분석된 패킷 정보를 기반으로 이벤트가 악성 행위에 대응하는지 확인한다. 구체적으로, AI 엔진은 위협 분석 엔진을 통해서 나온 패킷 정보와 이를 프로파일링한 프 로파일 데이터(Profile Data) 및 악성 행위의 우선 순위 지표(Triage Volume Indicator)에 대한 정보와 코사인 유사도 알고리즘 및 딥 러닝 등의 인공지능 기술을 활용하여, 이벤트가 악성 행위인지 정상 행위인지 분류하고 (classification), 공격 유형별 유사도 비교를 통해(similarity group) 해당 이벤트가 악성 행위에 대응하는지 에 대한 최종적인 의사결정을 도출(decision maker)할 수 있다. 또한, AI 엔진은 AI 제어부를 포함할 수 있는데, 이벤트의 공격 유형의 유사도 분석이 잘못된 분석 결과라고 판단될 때에 해당 분석 결과를 AI 제어 부로 전달하여 인공지능 기술을 통해 학습함으로써 공격 유형의 유사도 분석에 대한 정보를 고도화 할 수 있다. 규칙 처리 엔진은 AI 엔진에서 이벤트가 악성 행위에 대응하는 것으로 확인되는 경우, 패킷 정보를 기반으로 이벤트에 대응하는 특징 정보를 추출한다. 그리고, 규칙 처리 엔진은 특징 정보를 추출한 후에 침입 방지 시스템에 적용할 규칙을 생성하여 보안 장치에 배포할 수 있다. 또한, 규칙 처리 엔진은 AI 엔진에 의해 검출된 위협을 기반으로 각 보안 장치에서 사용할 수 있는 패턴의 추출 및 배포를 수행하 기 위해 제네릭 패턴(Generic Pattern) 처리 모듈(도시하지 않음)을 포함할 수 있다. 도 2에는 데이터베이스가 도시되어 있지 않지만, 규칙 처리 엔진으로부터 생성된 규칙은 데이터베이스 에 저장될 수 있으며, 후술할 2차 유사도 분석에 저장된 규칙이 활용될 수 있다. 도 3은 본 발명의 일 실시예에 따른 AI 기반의 트래픽 분석 장치에 대한 흐름도이다. 이하 도 2의 블록도 를 기초로 하여 본 발명의 트래픽 분석 장치에 따른 AI 기반의 트래픽 분석 방법은 다음과 같다. 먼저, 이벤트 수집 엔진은 보안 장치로부터 전달되는 정보를 이벤트로서 수집한다(S301). 보안 장치 로부터 전달되는 정보에는 네트워크를 통해 복수의 클라이언트(1a, 1b)가 보안 장치로 송신한 패킷들과 보안 장치에서 생성되는 데이터를 포함할 수 있다. 일 실시예에 따르면, 이벤트 수집 엔진은 보안 장 치 내 GSP(Global Security Policy)(예를 들어, Security Information and Event Management, SIEM)를 통 해 전달되는 악성으로 의심되는 파일 및 트래픽 파일 등을 수집할 수 있다. 또한, 다른 실시예에 따르면, 이벤트 수집 엔진은 네트워크를 통해 복수의 클라이언트(1a, 1b)가 송신한 패킷들을 보안 장치로부터 전달 받아 수집할 수 있다. 이때 수집되는 이벤트는 파일 또는 네트워크 캡처 파일(예를 들어, pcap 파일) 형식일 수 있으며, 위의 형식에 제한되지 않는다. 위협 분석 엔진은 이벤트 수집 엔진에서 수집된 이벤트에 대응되는 패킷을 분석하여 패킷 정보를 추 출한다. 위협 분석 엔진은 악성 행위를 분석하는 샌드박스 기반의 분석 모듈과 네트워크 트래픽을 분 석하는 패킷 분석기를 포함할 수 있다. 위협 분석 엔진은 수집된 이벤트의 형식에 따라 구분하여 처 리하는데(S302), 이에 대하여 도 4를 추가로 참조하여 설명하도록 한다. 도 4는 본 발명의 일 실시예에 따른 위협 분석 엔진의 구성을 나타낸 블록도이다. 본 발명의 위협 분석 엔진은 수집된 이벤트가 코드를 포함하는 파일(예를 들어, 악성으로 의심되는 파일)인 경우, 샌드박스 기 반의 분석 모듈을 통해 샌드박스 상에서 파일을 분석하여 코드에 대응하는 패킷 정보를 확인할 수 있다. 구체적으로, 위협 분석 엔진은 샌드박스 기반의 분석 모듈을 통해 이벤트에 대응되는 패킷에서 네트 워크 캡처 파일을 추출하고(S303), 추출된 네트워크 캡처 파일에 대해 패킷 분석기를 통해 트래픽을 분석 하여(S304) 패킷 정보를 추출할 수 있다(S305). 또한, 수집된 이벤트가 네트워크 캡처 파일(예를 들어, pcap 파 일)인 경우, 샌드박스 기반의 분석 모듈을 거치지 않고 바로 패킷 분석기를 통해 트래픽을 분석하여 패킷 정보를 확인할 수 있다(S304). 일반적으로, 패킷은 소스(Source) 주소, 목적지(destination) 주소 등을 포 함하는 헤더(header)와 실제 데이터(예를 들어, 문자열)을 포함하는 페이로드(payload)로 구성된다. 본 발명의 패킷 정보는 헤더 정보가 동일한 단방향의 트래픽 흐름인 플로우(flow)와 헤더 및 데이터 등에 대한 정보를 적 어도 하나 이상 포함할 수 있다. 인공지능(AI) 엔진은 위협 분석 엔진으로부터 확인된 패킷 정보를 기반으로 이벤트가 악성 행위에 대 응하는지 확인할 수 있다. 구체적으로, 악성 행위 관련 우선 순위 정보를 기반으로 학습된 인공지능을 통해 이 벤트의 악성 행위 대응 여부를 확인할 수 있다. 예를 들어, 악성 행위로 판단된 동작이 수행될 때에 자주 사용 되는 패킷 정보의 유형을 지표로 하여, 각 패킷 정보의 유형에 대응하는 우선 순위 정보를 도출하고, 이러한 우 선 순위 정보를 기반으로 인공지능을 학습시켜 이벤트에 대응되는 패킷 정보를 분석할 수 있다. 여기서, 인공지 능은 머신 러닝 기법과 딥 러닝 기술 등을 이용하여 학습될 수 있으며, 이에 한정되지 않는다. 머신 러닝은 기 계 학습이라고도 불리며, 컴퓨터가 데이터를 통해 학습하고, 사람처럼 어떤 대상 혹은 상황을 이해할 수 있게 하는 기술이다. 특히, 컴퓨터가 스스로 훈련하면서 패턴을 찾아내 분류하는 기술적 방식으로 컴퓨터가 데이터를 분석할 수 있게 하는 알고리즘이 머신 러닝의 핵심이며, 사람의 사고방식을 컴퓨터에게 가르치는 머신 러닝의 한 분야로 딥 러닝이 있다. 도 5는 본 발명의 일 실시예에 따른 AI 엔진의 유사도 분석 단계를 도시한 흐름도이다. 도 3과 5를 참조로 설명하면, AI 엔진은 이벤트가 악성 행위에 대응하는지 확인하는 데에 있어서 송수신되는 패킷의 대상 서 버를 기반으로 인공지능 기술을 이용하여, 이벤트가 악성 행위인지 정상 행위인지 분류하고, 공격 유형별 유사 도 비교를 통해 해당 이벤트가 악성 행위에 대응하는지에 대한 최종적인 의사결정을 도출할 수 있다. 즉, AI 엔 진은 패킷 정보를 기반으로 이벤트가 악성 행위 분류에 대응하는지 판단하고(S306), 이벤트가 악성 행위로 분류되는 경우(S306에서 예), 이벤트에 대응하는 공격 유형을 확인할 수 있다. 이 때 이벤트가 악성 행위 분류 에 대응하지 않는 경우에는(S306에서 아니오), 정상 행위로 분류하여(S307) 해당 이벤트의 공격 유형 확인 단계 를 보류할 수 있다. 이벤트가 악성 행위 분류에 대응하는 경우(S306에서 예), AI 엔진은 패킷 정보와 공격 유형별 정보를 기반 으로 이벤트에 대응하는 공격 유형을 확인하기 위하여, 공격 유형에 대응하는 메타 정보와 이벤트의 유사도를 분석할 수 있다(S309). 이때의 공격 유형별 정보는 도 5에서도 볼 수 있듯이, 악성 행위의 공격 유형에 따라 랜 섬웨어(Ransomware), 지능형 지속 위협(Advanced Persistent Threat, APT), 사물인터넷(Internet of Things, IoT) 및/또는 사물베터리(Battery of Things)를 통한 위협 및 바이러스(virus) 등을 포함하며, 이에 제한되지 않는다. 공격 유형에 대응하는 메타 정보는 IP 주소, 포트 번호, 문자열, 문자열의 길이, 서비스 템플릿, 도메 인, URI, 스크립트, 방식 및 데이터 등을 포함할 수 있으며, 나아가 공격 유형의 버전별 특징에 대응하는 정보 일 수 있다. 예를 들어, 갠드크랩(Gandcrab) 랜섬웨어는 버전(v1 내지 v5)에 따라 암호화 확장자 또는 암호 알 고리즘 등이 상이하므로 이와 같은 버전별 특징에 따라 메타 정보를 생성하여 이벤트의 공격 유형을 판단할 수 있다. 또한, 이벤트가 악성 행위 분류에 대응하는지 판단하는 과정은 인공지능 기술을 사용하여 판단되며, 특히 머신 러닝을 기반으로 코사인 유사도 알고리즘(cosine similarity algorithm)을 사용하여 판단될 수 있다. 한편, 이벤트가 악성 행위 분류에 대응하나, 이벤트에 대응하는 공격 유형이 확인되지 않는 경우, 이러한 이벤 트와 관련된 정보를 기반으로 AI 엔진을 학습시키는 것이 요구된다. 구체적으로, 악성 행위로 분류된 이벤 트에 대응되는 공격 유형이 확인되지 않는 경우(S310에서 예), 이벤트의 공격 유형의 유사도 분석이 잘못된 분 석 결과라고 판단할 수 있다. 이 경우 해당 분석 결과에 대한 정보를 거짓 양성(false positive) 정보로서 추출 하여(S311) AI 제어부로 전달하고, AI 제어부에서는 머신 러닝과 같은 인공지능 기술을 통해(예를 들 어, 코사인 유사도 알고리즘을 활용하여) 거짓 양성 정보를 학습할 수 있다. 예를 들어, 공격 트래픽으로 잘못 탐지되거나 오인 탐지된 트래픽들은 대응되는 공격 유형이 확인되지 않음으로써 잘못된 유사도 분석 결과임을 나타낼 수 있다. 이러한 트래픽들을 AI 제어부로 전달하여 머신 러닝 알고리즘을 기반으로 샘플링 (sampling)하고, 샘플링된 트래픽들을 공격 혹은 정상 트래픽으로 라벨링(labeling)하여 피드백 절차에 활용할 수 있다. 본 발명의 트래픽 분석 장치는 거짓 양성 정보에 대한 학습을 통해 공격 유형의 유사도 분석에 대한 정보를 고도화 할 수 있다. 규칙 처리 엔진은 AI 엔진에 의해 이벤트가 악성 행위로 분류되고 대응하는 공격 유형이 확인되어, 해당 이벤트가 악성 행위에 대응하는 것으로 확인된 경우(S310에서 아니오), 위협 분석 엔진으로부터 전달 받은 패킷 정보를 기반으로 악성 행위에 대응하는 것으로 확인된 이벤트에 대응하는 특징 정보를 추출할 수 있 다(S312). 또한, 규칙 처리 엔진은 추출된 특징 정보를 기반으로 침입 방지 시스템(예를 들어, IPS(Intrusion Prevention System))에 적용할 규칙을 보안 장치에 배포할 수 있다(S313). 이때 규칙은 공 격 유형에 대해 보안 장치가 판독 가능한 표현 방식(예를 들어, 스노트(Snort), 야라(Yara) 등)으로 정의될 수 있다. 또한, 규칙은 정규표현식 문법을 이용하거나 이용하지 않는 정책 또는 시그니처로 구성될 수 있다. 즉, 본 발명은 스노트, 야라는 물론, 다양한 문법, 라이브러리로 정의된 규칙들에 적용될 수 있다. 단계 S313에 서 생성된 규칙은 데이터베이스에 저장되어(S314), 침입 방지 시스템에 적용될 수 있다(S315). 일 실시예에 있어서, 규칙은 의심 패턴 정보로서 스노트 룰(rule)로 생성되어 여러 조건(옵션)의 조합으로 표현 될 수 있다. 스노트는 IP 주소, 포트 번호, 프로토콜 및 타 옵션으로 스노트 옵션을 구성하여 패턴 매칭을 수행 함으로써 네트워크 침입을 탐지하는 오픈소스 라이브러리이다. 스노트 정책은 두 개의 부분(이하, 정책 헤더 및 정책 옵션)으로 구분되는데, 정책 헤더는 액션(Action), 프로토콜, 소스 IP 주소, 소스 포트 번호, 목적지 IP 주소, 목적지 포트 번호의 순서로 구성된다. 정책 옵션은 페이로드 부분을 검사하기 위한 옵션들과 탐지 규칙의 이름 또는 식별자 등을 정의할 수 있는 옵션들을 포함한다. 이에 따라 생성된 의심 패턴 룰은 네트워크 트래픽 의 악성 행위 및 이상 징후를 판단하기 위해 침입 방지 시스템에 적용될 수 있다. 도 6은 본 발명의 일 실시예에 따른 규칙 처리 엔진이 특징 정보를 기반으로 규칙을 생성하는 단계에 대한 흐름도이다. 먼저, 규칙 처리 엔진은 패킷 정보를 기반으로 이벤트에 대응하는 특징 정보를 추출(S601)한 이후, 추출된 특징 정보에 대해 샘플링하여 어휘 분석(lexical analyzer)을 수행한다(S602). 이는 컴파일러의 첫 번째 단계로 서 소스 코드를 정규 문법에 따라 의미 있는 조각을 어휘항목(lexeme)으로서 검출하고 토큰(token)으로 분류하 는 것을 말한다. 일 예로, 소스 코드에 대해 형태소 분석을 하여 의미 있는 조각들을 어휘항목으로 검출하고 토 큰을 생성할 수 있다(S603). 규칙 처리 엔진은 생성된 토큰의 어휘항목을 정규 문법에 따라 패턴으로 표현 한다(S604). 다음으로, 생성된 토큰의 어휘항목들에 대해 민-해쉬 알고리즘(Min-Hash Algorithm)을 이용하여 클 러스터링(clustring)을 수행한다(S605). 구체적으로, 어휘항목과 근접한 데이터에 대하여 민-해쉬 알고리즘을 통해 근접한 어휘항목과의 형태소 유사도를 추정하여 이를 클러스터링할 수 있다. 또한, 규칙 처리 엔진은 어휘 분석 단계(S602)를 반복하여 형태소 별로 매칭 여부를 판단할 수 있다. 클러스터링을 완료한 후, 규칙 처 리 엔진은 형태소 매칭 결과 중 가장 큰 문자열을 패턴으로 생성할 수 있다(S606). 이때 생성된 패턴은 제 네릭 패턴(generic pattern)으로서, 정규표현식으로 표현될 수 있다. 생성된 제네릭 패턴은 침입 탐지 시스템에 적용되어 악성 행위의 탐지 및 차단에 사용될 수 있다. 도 7은 본 발명의 일 실시예에 따른 규칙 처리 엔진에서 제네릭 패턴을 생성하는 단계를 도시한 흐름도이 다. 앞서 설명하였던 바와 같이 규칙 처리 엔진은 제네릭 패턴 처리 모듈을 포함할 수 있으며, 이를 통해 제네릭 패턴을 생성할 수 있다. 간단한 정보(simple data), 예를 들어, 의심되는 C&C(Command&Control) 서버, 악성 행위의 의심되는 배포지 및 감염이 의심되는 단말의 정보 등과 같은 비교적 간단한 정보에 대하여는 IP와 도메인을 기준으로 제네릭 패턴을 생성할 수 있다. 그러나, 그 외의 복잡한 정보(complex data)에 대해서는 도 6에서 설명한 바와 같은 규칙 생성 단계를 거친 후에 패턴 추출이 가능하다. 제네릭 패턴 처리 모듈은 복잡한 정보에 대하여 샘플링 형태소 분석을 통해 제네릭 패턴을 추출할 수 있다. 다 시 말해, 샘플링 된 복잡한 정보(예를 들어, 추출된 특징 정보)에 대해 형태소 분석을 하여 의미 있는 조각을 어휘항목으로서 검출할 수 있다. 그리고, 검출된 어휘항목들에 대해 민-해쉬 알고리즘을 이용하여 근접한 어휘 항목과의 형태소 유사도를 추정하여 클러스터링하고, 형태소가 매칭될 경우 다음으로 근접 형태소를 검사하며, 일련의 단계를 다음 어휘에 대하여 반복할 수 있다. 클러스터링이 완료된 후 근접 형태소 중 가장 큰 문자열 매 칭 결과를 패턴으로 생성할 수 있으며, 이렇게 생성된 패턴을 제네릭 패턴이라 한다. 한편, 본 발명의 다른 실시예에 있어서, 규칙 처리 엔진에서 침입 방지 시스템에 적용할 규칙을 배포한 뒤, 트래픽 분석 장치는 배포된 규칙을 이용하여 이벤트의 유사도 분석을 다시 수행할 수 있다. 이와 관련 하여 도 8은 본 발명의 다른 실시예에 따른 AI 기반의 트래픽 분석 장치에 대한 흐름도이며, 이하 도 8을 참조하여 설명한다. 본 발명의 일 실시예에 따르면, 이벤트 수집 엔진은 배포된 규칙에 대응하는 이벤트를 추가적으로 수집하 고(S801), 위협 분석 엔진은 추가 수집된 이벤트에 대응되는 패킷을 분석하여 추가 패킷 정보를 확인하고 이를 추출할 수 있다(S802). 또한, AI 엔진은 추가 패킷 정보에 대응하는 메타 정보 및 배포된 규칙에 대 응하는 메타 정보의 유사도를 분석하여(S806), 추가 패킷 정보에 대응하는 이벤트의 공격 유형을 확인할 수 있 다(S807). 추가 패킷 정보에 대응하는 메타 정보는 5-Tuple, 도메인, URI, 방식 및 데이터 등 다양한 메타 정보 를 포함할 수 있다. 5-Tuple은 소스 IP 주소, 소스 포트 번호, 목적지 IP 주소, 목적지 포트 번호 및 프로토콜 을 포함하는 데이터 포맷 규격을 말한다. 구체적으로, 본 발명의 일 실시예에 따른 트래픽 분석 장치는 침입 방지 시스템에 적용할 규칙을 배포하기 위해 1차적으로 특정 패킷에 대해서만 수집하여 패킷 정보를 추출하고, 1차 유사도 분석을 수행하여 악성 행위 로 분류된 이벤트에 대응하는 규칙을 생성할 수 있다. 그리고 실제 네트워크에서의 악성 행위 및 이상 징후를 판단하기 위해, 네트워크에서 수집되는 패킷에 대해 2차 유사도 분석을 수행하여 침입 방지 시스템에 적용할 규 칙을 생성할 수 있다. 또한, 2차 유사도 분석에서는 1차적으로 수행하였던 유사도 분석과 유사한 프로세스로 추 가 패킷 정보를 기반으로 이벤트가 악성 행위 분류에 대응하는지 판단할 수 있으며(S803), 이벤트가 악성 행위 로 분류되는 경우(S805), 추가 패킷 정보에 대응하는 메타 정보 및 배포된 규칙에 대응하는 메타 정보의 유사도 를 분석하여(S806), 추가 패킷 정보에 대응하는 이벤트의 공격 유형을 확인할 수 있다(S807). 이벤트가 악성 행 위 분류에 대응하나, 추가 패킷 정보에 대응하는 이벤트의 공격 유형이 확인되지 않는 경우(S808에서 예), 해당 분석 결과에 대한 정보를 거짓 양성 정보로서 추출하여(S809) AI 제어부에 전달한 뒤 인공지능 기술을 통 해 거짓 양성 정보를 피드백 절차에 사용할 수 있다. 예를 들어, 본 발명의 트래픽 분석 장치는 이벤트 수집 엔진에서 GSP를 통해 악성으로 의심되는 파일 및 악성 트래픽 파일 등을 수집하여(S301) 위협 분석 엔진에서 패킷 정보를 추출하고(S305), AI 엔진(13 0)에서 1차 유사도 분석을 수행할 수 있다(S309). 그리고 규칙 처리 엔진은 1차 유사도 분석을 통해 악성 행위로 확인된 이벤트에서 특징 정보를 추출하여(S312) 탐지 규칙을 생성할 수 있다(S313). 생성된 탐지 규칙은 이후 이벤트의 수집 및 유사도 분석에 사용될 수 있다. 구체적으로, 이벤트 수집 엔진은 복수의 클라이언 트(1a, 1b)가 보안 장치로 송신한 패킷들을 전달받을 수 있고(S801), 이때 패킷들은 상기 탐지 규칙을 이용 하여 보안 장치에서 필터링된 패킷일 수 있으며, 악성으로 의심되는 이벤트에 대응될 수 있다. 2차적으로 수집된 이벤트에 대해 위협 분석 엔진에서는 패킷 정보를 추출하고(S802), AI 엔진에서는 추가 패킷 정보에 대응하는 메타 정보와 상기 생성되었던 탐지 규칙에 대응하는 메타 정보의 유사도 분석을 통해 추가적으 로 수집된 이벤트의 2차 유사도 분석을 수행할 수 있다(S803 내지 S809). 그리고 2차 유사도 분석을 통해 악성 행위로 확정된 이벤트에 대응하는 특징 정보를 추출하여(S810) 침입 방지 시스템에 배포할 규칙을 생성 및 배포 할 수 있으며(S811 내지 S814), 생성된 탐지 규칙을 데이터 베이스에 저장하여(S815) 보안 장치 내 침 입 탐지에 적용할 수 있다(S816). 이때 1차 유사도 분석에서 이벤트가 악성 행위 분류에 대응하는지 확인하는 단계에서 고려되는 유사도 판단 기 준과 2차 유사도 분석에서 메타 정보의 유사도를 분석하는 단계에서 고려되는 유사도 판단 기준은 서로 상이할 수 있다. 본 발명의 트래픽 분석 방법은 위와 같이 1차와 2차로 분리된 유사도 분석을 수행함으로써 악성 행위 로 의심되는 이벤트를 악성 행위로 확정하여 공격에 대한 탐지 효율성과 차단 정확성을 높이는 효과가 있다. 또 한, 악성 행위로 의심되는 이벤트에서 추출된 패킷 정보를 기반으로 침입 방지 시스템에 적용할 규칙을 생성하 여 이를 실망에서 추출된 정보와 비교하므로, 변종 공격을 보다 빠르게 식별할 수 있다. 한편, 규칙 처리 엔진이 악성 행위에 대응하는 것으로 확인된 이벤트에서 추출된 특징 정보를 기반으로 보 안 장치에 배포할 규칙을 생성할 때, 생성된 규칙이 특징 정보에 고유한 고유 패턴(unique pattern)일 수있다. 이 경우 고유 패턴에 대해 유효성 여부를 검증하여 침입 방지 시스템에 적용할 수 있는지 여부를 판단할 수 있다. 구체적으로 본 발명의 일 실시예에 따른 트래픽 분석 장치는 고유 패턴 검증 엔진(도시하지 않음)를 더 포함할 수 있다. 고유 패턴 검증 엔진은 고유 패턴에 대해 침입 방지 시스템에 적용될 수 있는 공격 패턴으로 활용될 수 있는지 여부를 검증하기 위해 유효 패턴 가능성 여부를 판단할 수 있다. 예를 들어, 고유 패턴이 그에 고유한 특징 정보에 대응되는 이벤트에 대해서만 또는 그 이벤트와 유사하다고 판단될 수 있는 이 벤트에 대해서만 악성 행위에 대응하는지 여부를 확인할 수 있는 경우, 해당 고유 패턴은 범용성이 있다고 보기 어려우므로, 유효 패턴 가능성이 낮다고 판단될 수 있고, 탐지 규칙으로서 침입 탐지 시스템에 적용되지 않을 수 있다. 다시 말해, 추출된 특징 정보가 고유 패턴에 대응되는 경우(S815에서 예), 고유 패턴 검증 엔진은 고 유 패턴에 대해 유효성 여부를 검증하고(S816), 패턴의 유효성이 검증되는 경우(S817에서 예), 검증된 고유 패 턴을 기반으로 침입 방지 시스템에 적용할 규칙을 설정할 수 있다(S818). 이렇게 필터링된 고유 패턴은 데이터 베이스에 저장되어(S819) 침입 방지 시스템에서 탐지 규칙으로 적용될 수 있다(S820). 도 9는 본 발명의 일 실시예에 따른 AI 기반의 트래픽 분석 방법을 도식화한 흐름도이다. 먼저, GSP가 악성으로 의심되는 파일 및 트래픽 파일 등을 트래픽 분석 장치로 전달하여 이벤트 수집 엔진에서 이벤트로 수 집한다. 이후 위협 분석 엔진에서 수집한 이벤트에 대해 동적 분석을 수행하게 된다. 위협 분석 엔진(12 0)은 악성 행위를 분석하는 샌드박스 기반의 분석 모듈과 네트워크 트래픽을 분석하는 패킷 분석기를 포함할 수 있는데, 이때 샌드박스 기반의 분석 모듈은 지능형 지속 위협(APT)를 막기 위한 샌드박스 APTX 일 수 있다. 위협 분석 엔진에서는 동적 분석을 통해 패킷 정보를 추출할 수 있고, 이때의 패킷 정보는 패 킷의 플로우, 헤더 및 데이터 등에 대한 정보를 포함할 수 있다. 한편, 이벤트에 대응하는 패킷 정보를 추출하 는 구체적인 과정은 앞서 설명한 도 3 및 4를 참조하도록 한다. AI 엔진은 패킷 정보와 이를 프로파일링한 프로 파일 데이터 및 악성 행위의 우선 순위 지표에 대한 정보를 이용하여 깊은 분석(deep analysis)을 할 수 있다. 구체적으로, 인공지능 기술을 활용하여, 이벤트가 악성 행위인지 정상 행위인지 분류하고(classification), 공 격 유형별 유사도 비교를 통해(similarity group) 해당 이벤트가 악성 행위에 대응하는지에 대한 최종적인 의사 결정을 도출(decision maker)할 수 있다. 다음으로 규칙 처리 엔진은 악성 행위로 분류된 이벤트에 대해 이벤트에 대응하는 특징 정보를 추출하여 탐지 규칙을 생성할 수 있다. 이때에 생성된 탐지 규칙은 일반적으로 정규표현식으로 표현된 제네릭 패턴일 수 있으며, 제네릭 패턴은 침입 탐지 시스템(IPS)에 적용되기 위한 자동 화된 패턴 정보를 의미할 수 있다. 탐지 규칙이 생성된 후에는 실망에서의 위협을 탐지하기 위해 정책 검증을 수행할 수 있다. 정책 검증은 본 발명의 도 8에서 설명한 바와 같이, 생성된 탐지 규칙으로 추가 수집된 이벤트 에 대해 추가 패킷 정보에 대응하는 메타 정보 및 생성된 탐지 규칙에 대응하는 메타 정보의 유사도를 분석하여 (2차 유사도 분석) 악성 행위를 확정하기 위한 탐지 규칙을 생성하는 것을 의미할 수 있다. 이렇게 검증 단계까 지 거친 탐지 규칙을 침입 탐지 시스템에 적용할 수 있으며, 예를 들어, SIEM과 같은 종합 관제 솔루션에 적용 하여 실제 위협을 탐지 및 차단하는 데에 상기 탐지 규칙을 적용할 수 있다. 본 발명의 실시예에 따른 트래픽 분석 장치 및 방법은 공격 유형의 유사도 분석 및 학습을 통한 공격 유형 의 분류 과정, 탐지 규칙 및 고유 패턴 추출 과정을 자동화함으로써 변종 공격에 보다 빨리 대응할 수 있다. 또 한, 1차 유사도 분석을 통해 탐지 규칙을 생성한 뒤에 생성된 규칙으로 이벤트를 재 수집하여 2차 유사도 분석 을 수행하여 의심되는 악성 행위를 확정할 수 있는 바, 이와 같이 자동화된 분석 시스템으로 인해 네트워크 흐 름을 지속적으로 파악하여 빠른 분석 지원 효과를 가질 수 있다. 본 발명에 따른 상기 예시적인 방법들은 프로세서에 의해 실행되는 프로그램 명령들, 소프트웨어 모듈, 마이크 로코드, 컴퓨터(정보 처리 기능을 갖는 장치를 모두 포함함)로 읽을 수 있는 기록 매체에 기록된 컴퓨터 프로그 램 제품, 애플리케이션, 논리 회로들, 주문형 반도체, 또는 펌웨어 등 다양한 방식으로 구현될 수 있다. 상기 컴퓨터로 읽을 수 있는 기록 매체의 예로는 ROM, RAM, CD, DVD, 자기 테이프, 하드 디스크, 플로피 디스크, 하 드 디스크, 광데이터 저장 장치 등이 있으며, 이에 제한되는 것은 아니다. 또한, 컴퓨터가 읽을 수 있는 기록 매체는 네트워크로 연결된 컴퓨터 시스템에 분산되어, 분산방식으로 컴퓨터가 읽을 수 있는 코드가 저장되고 실 행될 수 있다."}
{"patent_id": "10-2020-0005890", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "이상의 설명은 본 발명을 예시적으로 설명한 것에 불과하며, 본 발명이 속하는 기술분야에서 통상의 지식을 가 진 자에 의해 본 발명의 기술적 사상에서 벗어나지 않는 범위에서 다양한 변형이 가능할 것이다. 한편, 본 명세서와 도면에는 본 발명의 바람직한 실시 예에 대하여 개시하였으며, 비록 특정 용어들이 사용되었 으나, 이는 단지 본 발명의 기술 내용을 쉽게 설명하고 발명의 이해를 돕기 위한 일반적인 의미에서 사용된 것 이지, 본 발명의 범위를 한정하고자 하는 것은 아니다. 여기에 개시된 실시 예 외에도 본 발명의 기술적 사상에 바탕을 둔 다른 변형 예들이 실시 가능하다는 것은 본 발명이 속하는 기술 분야에서 통상의 지식을 가진 자에게자명한 것이다."}
{"patent_id": "10-2020-0005890", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 일 실시예에 따른 AI 기반의 트래픽 분석 장치에 대한 개념도이다. 도 2는 본 발명의 일 실시예에 따른 AI 기반의 트래픽 분석 장치에 대한 블록도이다. 도 3은 본 발명의 일 실시예에 따른 AI 기반의 트래픽 분석 장치에 대한 흐름도이다. 도 4는 본 발명의 일 실시예에 따른 위협 분석 엔진의 구성을 나타낸 블록도이다. 도 5는 본 발명의 일 실시예에 따른 AI 엔진의 유사도 분석 단계를 도시한 흐름도이다. 도 6은 본 발명의 일 실시예에 따른 규칙 처리 엔진이 특징 정보를 기반으로 규칙을 생성하는 단계에 대한 흐름 도이다. 도 7은 본 발명의 일 실시예에 따른 규칙 처리 엔진에서 제네릭 패턴을 생성하는 단계를 도시한 흐름도이다. 도 8은 본 발명의 다른 실시예에 따른 AI 기반의 트래픽 분석 장치에 대한 흐름도이다. 도 9는 본 발명의 일 실시예에 따른 AI 기반의 트래픽 분석 방법을 도식화한 흐름도이다."}
