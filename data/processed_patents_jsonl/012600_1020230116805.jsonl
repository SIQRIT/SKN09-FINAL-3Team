{"patent_id": "10-2023-0116805", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2025-0034629", "출원번호": "10-2023-0116805", "발명의 명칭": "결정 그래프를 활용하는 비전-언어 모델을 사용한 이미지 분류 방법 및 장치", "출원인": "주식회사 마크애니", "발명자": "권용혜"}}
{"patent_id": "10-2023-0116805", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "비전-언어 모델 기반의 이미지 분류 방법에 있어서,적어도 하나의 이미지를 포함하는 데이터 목록을 입력하는 단계;이미지의 분류를 지정하고 적어도 하나의 클래스로 분류되는 단어를 포함하는 프롬프트를 입력하는 단계;적어도 하나의 클래스 간의 분류 순서를 정의하는 그래프를 읽어들이는 단계;상기 그래프의 노드를 선택하는 단계;상기 노드에 해당하는 클래스 정보를 읽어들이는 단계;상기 프롬프트와 클래스 정보에 기반하여 이미지를 분류하는 단계;상기 노드가 말단 노드인 경우 분류 결과를 반환하는 단계;를 포함하는, 방법."}
{"patent_id": "10-2023-0116805", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제 1 항에 있어서,상기 그래프는,루트(root) 노드를 기점으로 하고, 적어도 하나의 말단(leaf) 노드가 존재하고, 순환 구조를 가지지 않는 것을특징으로 하는, 방법."}
{"patent_id": "10-2023-0116805", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제 1 항에 있어서,상기 프롬프트에 포함된 적어도 하나의 클래스로 분류되는 단어를 추출하는 단계;를 더 포함하고,상기 단어를 추출하는 단계는,자연어처리(natural language process; NLP) 방법에 의하여 실행되는, 방법."}
{"patent_id": "10-2023-0116805", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제 1 항에 있어서,상기 프롬프트에 포함된 적어도 하나의 클래스로 분류되는 단어를 추출하는 단계; 및상기 추출된 단어를 인코딩(encoding)하여 텍스트 특징값을 추출하는 단계;를 더 포함하고,상기 이미지를 분류하는 단계는, 상기 텍스트 특징값에 기반하여 동작하는 것을 특징으로 하는, 방법."}
{"patent_id": "10-2023-0116805", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제 1 항에 있어서,상기 클래스 정보를 읽어들이는 단계는,적어도 하나의 분류 대상을 포함하는 클래스 텍스트의 목록을 읽어들이는 단계;공개특허 10-2025-0034629-3-상기 목록에 포함된 텍스트를 인코딩하여 텍스트 특징값을 추출하는 단계; 및상기 특징값을 상기 클래스 정보로서 읽어들이는 단계;를 포함하는, 방법."}
{"patent_id": "10-2023-0116805", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제 1 항에 있어서,상기 클래스 정보를 읽어들이는 단계는,적어도 하나의 분류 대상에 대한 텍스트 특징값을 상기 클래스 정보로서 읽어들이는 단계;를 포함하는, 방법."}
{"patent_id": "10-2023-0116805", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제 1 항에 있어서,상기 이미지를 분류하는 단계는,상기 프롬프트에 포함된 단어 가운데, 상기 클래스 정보에 대응하는 단어를 선택하는 단계;처음 실행되는 경우 상기 데이터 목록을, 반복 실행되는 경우 앞서 실행된 이미지를 분류하는 단계의 결과를 분류 대상 이미지 목록으로 읽어들이는 단계;상기 분류 대상 이미지 목록에 포함된 적어도 하나의 이미지 가운데, 상기 선택된 단어에 대응하는 적어도 하나의 이미지를 선택하는 단계; 및상기 선택된 이미지의 목록을 결과로서 출력하는 단계;를 포함하는, 방법."}
{"patent_id": "10-2023-0116805", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제 1 항에 있어서,노드 별 이미지 분류 결과를 병합하는 단계;를 더 포함하고,상기 이미지를 분류하는 단계는,상기 프롬프트에 포함된 단어 가운데, 상기 클래스 정보에 대응하는 단어를 선택하는 단계;상기 데이터 목록을 분류 대상 이미지 목록으로 읽어들이는 단계;상기 분류 대상 이미지 목록에 포함된 적어도 하나의 이미지 가운데, 상기 선택된 단어에 대응하는 적어도 하나의 이미지를 선택하는 단계; 및상기 선택된 이미지의 목록을 노드 별 분류 결과로서 출력하는 단계;를 포함하는, 방법."}
{"patent_id": "10-2023-0116805", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제 8 항에 있어서,상기 병합하는 단계는,노드 별 분류 결과 간의 행렬곱에 의하여 실행되는, 방법."}
{"patent_id": "10-2023-0116805", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제 1 항에 있어서,공개특허 10-2025-0034629-4-상기 이미지를 분류하는 단계는,사전에 대규모 학습된 비전-언어 모델(vision-language model)에 기반하여 동작하는 것을 특징으로 하는, 방법."}
{"patent_id": "10-2023-0116805", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "제 1 항에 있어서,상기 데이터 목록에 포함된 이미지를 인코딩하여 이미지 특징값을 추출하는 단계;를 더 포함하고,상기 이미지를 분류하는 단계는, 상기 이미지 특징값에 기반하여 동작하는 것을 특징으로 하는, 방법."}
{"patent_id": "10-2023-0116805", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제 1 항에 있어서,상기 노드에 해당하는 클래스 정보를 읽어들이는 단계마다 반복 실행되고 상기 프롬프트에 포함된 상기 클래스정보에 대응하는 단어를 추출하는 단계;를 더 포함하는, 방법."}
{"patent_id": "10-2023-0116805", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "비전-언어 모델 기반의 이미지 분류 장치에 있어서,연산 기능을 가진 프로세서;상기 프로세서에 연결된 메모리;적어도 하나의 이미지를 포함하는 데이터 목록을 입력받는 데이터 입력부;이미지의 분류를 지정하고 적어도 하나의 클래스로 분류되는 단어를 포함하는 프롬프트를 입력받는 문장입력부;적어도 하나의 클래스 간의 분류 순서를 정의하는 그래프를 읽어들이고, 상기 그래프의 노드를 선택하고, 상기노드에 해당하는 클래스 정보를 읽어들이고, 상기 노드가 말단 노드인 경우 분류 결과를 반환하는 결정 그래프탐색부; 및상기 프롬프트와 클래스 정보에 기반하여 이미지를 분류하는 이미지 분류부;를 포함하는 포함하는, 장치."}
{"patent_id": "10-2023-0116805", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_14", "content": "제 13 항에 있어서,상기 그래프는,루트(root) 노드를 기점으로 하고, 적어도 하나의 말단(leaf) 노드가 존재하고, 순환 구조를 가지지 않는 것을특징으로 하는, 장치."}
{"patent_id": "10-2023-0116805", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_15", "content": "제 13 항에 있어서,상기 결정 그래프 탐색부는,텍스트 인코더를 포함하고,적어도 하나의 분류 대상을 포함하는 클래스 텍스트의 목록을 읽어들이고, 상기 목록에 포함된 텍스트를 인코딩공개특허 10-2025-0034629-5-하여 텍스트 특징값을 추출하고, 그리고 상기 특징값을 상기 클래스 정보로서 읽어들이도록 구성되는, 장치."}
{"patent_id": "10-2023-0116805", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_16", "content": "제 13 항에 있어서,상기 결정 그래프 탐색부는,적어도 하나의 분류 대상에 대한 텍스트 특징값을 상기 클래스 정보로서 읽어들이도록 구성되는, 장치."}
{"patent_id": "10-2023-0116805", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_17", "content": "제 13 항에 있어서,상기 프롬프트에 포함된 적어도 하나의 클래스로 분류되는 단어를 추출하는 자연어 처리부;를 더 포함하고,상기 이미지 분류부는,상기 자연어 처리부로부터, 상기 클래스 정보에 대응하는 단어를 입력받고, 처음 실행되는 경우 상기 데이터 입력부로부터 상기 데이터 목록을, 반복 실행되는 경우 앞서 실행된 이미지를 분류하는 단계의 결과를 분류 대상이미지 목록으로 읽어들이고, 상기 분류 대상 이미지 목록에 포함된 적어도 하나의 이미지 가운데, 상기 선택된단어에 대응하는 적어도 하나의 이미지를 선택하고, 그리고 상기 선택된 이미지의 목록을 결과로서 출력하여 상기 메모리에 저장하도록 구성되는, 장치."}
{"patent_id": "10-2023-0116805", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_18", "content": "제 13 항에 있어서,상기 프롬프트에 포함된 적어도 하나의 클래스로 분류되는 단어를 추출하는 자연어 처리부;및노드 별 이미지 분류 결과를 병합하는 병합부;를 더 포함하고,상기 이미지 분류부는,상기 자연어 처리부로부터, 상기 클래스 정보에 대응하는 단어를 입력받고, 상기 데이터 입력부로부터 상기 데이터 목록을 분류 대상 이미지 목록으로 읽어들이고, 상기 분류 대상 이미지 목록에 포함된 적어도 하나의 이미지 가운데, 상기 선택된 단어에 대응하는 적어도 하나의 이미지를 선택하고, 그리고 상기 선택된 이미지의 목록을 노드 별 분류 결과로서 출력하여 상기 메모리에 저장하도록 구성되는, 장치."}
{"patent_id": "10-2023-0116805", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_19", "content": "제 13 항에 있어서,상기 이미지 분류부는,사전에 대규모 학습된 비전-언어 모델(vision-language model)에 기반하여 동작하는 것을 특징으로 하는, 장치."}
{"patent_id": "10-2023-0116805", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_20", "content": "제 13 항에 있어서,상기 데이터 목록에 포함된 이미지를 인코딩하여 이미지 특징값을 추출하는 이미지 인코더;를 더 포함하고,상기 이미지 분류부는, 상기 인코더로부터 제공되는 상기 이미지 특징값에 기반하여 동작하는 것을 특징으로 하는, 장치.공개특허 10-2025-0034629-6-"}
{"patent_id": "10-2023-0116805", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 인공지능의 활용에 대한 것으로써, 구체적으로는 비전-언어 모델(vision-language model)의 효율적 사 용에 관련된 것이다. 본 발명의 일 실시예에 따른 비전-언어 모델 기반의 이미지 분류 방법은, 적어도 하나의 이 미지를 포함하는 데이터 목록을 입력하는 단계, 이미지의 분류를 지정하는 프롬프트를 입력하는 단계, 상기 프롬 프트로부터 적어도 하나의 클래스로 분류되는 단어를 추출하는 단계, 적어도 하나의 클래스 간의 분류 순서를 정 의하는 그래프를 읽어들이는 단계, 상기 그래프의 노드를 선택하는 단계, 상기 노드에 해당하는 클래스 정보를 읽어들이는 단계, 상기 프롬프트와 클래스 정보에 기반하여 이미지를 분류하는 단계, 상기 노드가 말단 노드인 경우 분류 결과를 반환하는 단계를 포함할 수 있다."}
{"patent_id": "10-2023-0116805", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 인공지능의 활용에 대한 것으로써, 구체적으로는 비전-언어 모델(vision-language model)의 효율적 사용에 관련된 것이다."}
{"patent_id": "10-2023-0116805", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "인공지능(artificial intelligence)을 이용한 자연어 처리(natural language processing) 기술의 성능은 지속 적으로 향상되어, 최근에는 이른바 (대규모) 언어 모델 ((large) language model; (L)LM)으로 불리는 인공지능 기반의 기술이 널리 상용화되고 있다. 여기에서 언어 모델이란 인공지능으로 하여금 인간이 사용하는 언어를 대 규모로 학습하도록 함으로써 소위 생성형(generative) 인공지능으로서의 기능을 부여하는 것을 의미한다. 상기 생성형 인공지능은 특히, 입력으로 주어진 문장을 학습된 언어 데이터에 기반하여 새로운 문장으로 변형하여 도 출하는 데에 강한 성능을 보여 왔으며, 특히 인공지능에 대하여 질문을 입력하고 그에 대한 자연어 해답을 구하 는 형태의 상호작용을 허용함으로써, 전문가 시스템(professional system)으로서의 인공지능의 도래를 내다보게 하고 있다. 상기 언어 모델은 비단 언어를 입력으로 하여 언어를 출력으로 하는 데에만 활용되는 것이 아니라, 자연어를 입 력으로 하여 화상(image)을 결과로 얻는 인공지능의 개발에도 사용되고 있다. 이러한 인공지능을 화상문답 (visual question-answering; VQA)형 인공지능으로 칭한다. 유사한 과제를 종래에 인공지능을 이용하여 해결하 고자 하는 경우 레이블링을 통한 사전 학습에 의존하였으나, 언어 모델의 도입을 통해 이러한 사전 학습 과정을 대부분 생략하고, 구성된 언어 모델을 이용하여 즉각적인 동작 결과를 도출하는 이른바 \"제로-샷(zero-shot)\" 방식이 널리 사용되고 있다. 특히 최근에는, 대규모의 자연어 데이터를 기반으로 생성된 언어 모델과 대규모의 화상 데이터를 기반으로 생성된 비전(vision) 모델을 상호 결합시켜 사전에 학습시킴으로써 다양한 물체에 대한 인식을 제로-샷 방식으로 실행하기 용이하게 구성된, 이른바 비전-언어 모델(vision-language model)이 사용되 고 있다. 이러한 비전-언어 모델 인공지능의 통상적인 용례는 다음과 같다. 첫째로, 인공지능시스템이 접근 가능한 대규 모 화상 데이터로 이루어진 풀(pool)을 공급한다. 다음으로, 상기 풀로부터 소정의 특징을 가지는 화상(들)을 선택하여 도출하도록 상기 인공지능에 질의, 즉 프롬프트(prompt)를 입력한다. 다음으로, 상기 인공지능이 자체 적 처리에 의하여 상기 풀로부터 소정의 화상을 선택하여 출력하고, 입력자는 상기 출력을 확인한다. 예를 들어, \"사과\"를 프롬프트로 입력하는 경우, 상기 인공지능은 출력으로서 사과가 포함되어 있는 적어도 하나의 화상을 상기 풀에 저장된 화상 데이터 가운데 선택함으로써, 마치 \"사과\"의 형상을 인식하여 화상을 선택한 것 과 유사한 형태의 출력을 도출할 것으로 기대된다."}
{"patent_id": "10-2023-0116805", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "비전-언어 모델의 제공 등 인공지능 기술의 비약적 진보에도 불구하고, 언어를 입력으로 소정의 화상을 탐색하 도록 하는 인공지능의 성능 향상은 상대적으로 더디게 이루어져 왔다. 특히 비전-언어 모델 기반의 인공지능을 이용한 이미지 분류 작업에 있어서는, 복합적인 클래스(class)로 이미지를 분류하는 작업은 통상적 난제로 간주 되어 왔다. 상기 클래스란, 본 명세서에 있어서는, 상호 충분히 배타적인 복수의 선택지로 구성된 택일식의 정답 세트를 의 미하는 것으로 해석될 수 있다. 예를 들어서, \"가위바위보\" 게임을 수행하는 사람의 화상을 식별하기 위한 프롬 프트를 구성하는 경우, 어떤 사람이 \"가위\", \"바위\", 또는 \"보\" 중 어느 하나의 배타적 선택지 안에서 프롬프트 가 구성될 수 있다. 이 경우, 상기 프롬프트에는 \"가위바위보\"에 대한 단일 클래스가 존재한다고 간주할 수 있 다. 그러나, 통상적으로 인간이 제공하는 프롬프트는 상술하는 바와 같이 단일 클래스로 제공되지 아니한다. 가령, \"가위바위보를 수행하는 검은 옷을 입은 사람\"과 같이 복합적인 클래스가 포함되면, 비전-언어 모델을 이러한 프롬프트에 맞추어 동작시키기 위한 별개의 고안이 필요해지게 된다.나아가, 비전-언어 모델은 입력으로 주어지는 화상 데이터와 프롬프트에 포함된 클래스가 일치하지 아니하는 경 우에도 위양성(false-positive) 결과를 출력할 수 있다는 한계가 존재하며, 이 또한 복합 클래스 문제의 일부로 볼 수 있다."}
{"patent_id": "10-2023-0116805", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "상술한 기술적 과제를 해결하기 위한 본 발명의 일 실시예에 따른 비전-언어 모델 기반의 이미지 분류 방법은, 적어도 하나의 이미지를 포함하는 데이터 목록을 입력하는 단계, 이미지의 분류를 지정하고 적어도 하나의 클래 스로 분류되는 단어를 포함하는 프롬프트를 입력하는 단계, 상기 프롬프트로부터 적어도 하나의 클래스로 분류 되는 단어를 추출하는 단계, 적어도 하나의 클래스 간의 분류 순서를 정의하는 그래프를 읽어들이는 단계, 상기 그래프의 노드를 선택하는 단계, 상기 노드에 해당하는 클래스 정보를 읽어들이는 단계, 상기 프롬프트와 클래 스 정보에 기반하여 이미지를 분류하는 단계, 상기 노드가 말단 노드인 경우 분류 결과를 반환하는 단계를 포함 할 수 있다. 상기 그래프는, 루트(root) 노드를 기점으로 하고, 적어도 하나의 말단(leaf) 노드가 존재하고, 순환 구조를 가 지지 않는 것을 특징으로 할 수 있다. 상기 방법은, 상기 프롬프트에 포함된 적어도 하나의 클래스로 분류되는 단어를 추출하는 단계를 더 포함하고, 상기 단어를 추출하는 단계는, 자연어처리(natural language process, NLP) 방법에 의하여 실행될 수 있다. 상기 방법은, 상기 프롬프트에 포함된 적어도 하나의 클래스로 분류되는 단어를 추출하는 단계, 및 상기 추출된 단어를 인코딩(encoding)하여 텍스트 특징값을 추출하는 단계를 더 포함하고, 상기 이미지를 분류하는 단계는, 상기 텍스트 특징값에 기반하여 동작하는 것을 특징으로 할 수 있다. 상기 클래스 정보를 읽어들이는 단계는, 적어도 하나의 분류 대상을 포함하는 클래스 텍스트의 목록을 읽어들이 는 단계, 상기 목록에 포함된 텍스트를 인코딩하여 텍스트 특징값을 추출하는 단계, 및 상기 특징값을 상기 클 래스 정보로서 읽어들이는 단계를 포함할 수 있다. 상기 클래스 정보를 읽어들이는 단계는, 적어도 하나의 분류 대상에 대한 텍스트 특징값을 상기 클래스 정보로 서 읽어들이는 단계를 포함할 수 있다. 상기 이미지를 분류하는 단계는, 상기 프롬프트에 포함된 단어 가운데, 상기 클래스 정보에 대응하는 단어를 선 택하는 단계, 처음 실행되는 경우 상기 데이터 목록을, 반복 실행되는 경우 앞서 실행된 이미지를 분류하는 단 계의 결과를 분류 대상 이미지 목록으로 읽어들이는 단계, 상기 분류 대상 이미지 목록에 포함된 적어도 하나의 이미지 가운데, 상기 선택된 단어에 대응하는 적어도 하나의 이미지를 선택하는 단계, 및 상기 선택된 이미지의 목록을 결과로서 출력하는 단계를 포함할 수 있다. 상기 방법은, 노드 별 이미지 분류 결과를 병합하는 단계를 더 포함하고, 상기 이미지를 분류하는 단계는, 상기 프롬프트에 포함된 단어 가운데, 상기 클래스 정보에 대응하는 단어를 선택하는 단계, 상기 데이터 목록을 분류 대상 이미지 목록으로 읽어들이는 단계, 상기 분류 대상 이미지 목록에 포함된 적어도 하나의 이미지 가운데, 상기 선택된 단어에 대응하는 적어도 하나의 이미지를 선택하는 단계, 및 상기 선택된 이미지의 목록을 노드 별 분류 결과로서 출력하는 단계를 포함할 수 있다. 상기 병합하는 단계는, 노드 별 분류 결과 간의 행렬곱에 의하여 실행될 수 있다. 상기 이미지를 분류하는 단계는, 사전에 대규모 학습된 비전-언어 모델(vision-language model)에 기반하여 동 작하는 것을 특징으로 할 수 있다. 상기 방법은, 상기 데이터 목록에 포함된 이미지를 인코딩하여 이미지 특징값을 추출하는 단계를 더 포함하고, 상기 이미지를 분류하는 단계는, 상기 이미지 특징값에 기반하여 동작하는 것을 특징으로 할 수 있다. 상기 방법은, 상기 노드에 해당하는 클래스 정보를 읽어들이는 단계마다 반복 실행되고 상기 프롬프트에 포함된 상기 프롬프트로부터 상기 클래스 정보에 대응하는 단어를 추출하는 단계를 더 포함할 수 있다.상술한 기술적 과제를 해결하기 위한 본 발명의 일 실시예에 따른 비전-언어 모델 기반의 이미지 분류 장치는, 연산 기능을 가 진 프로세서, 상기 프로세서에 연결된 메모리, 적어도 하나의 이미지를 포함하는 데이터 목록을 입력받는 데이 터 입력부, 이미지의 분류를 지정하고 적어도 하나의 클래스로 분류되는 단어를 포함하는 프롬프트를 입력받는 문장 입력부, 적어도 하나의 클래스 간의 분류 순서를 정의하는 그래프를 읽어들이고, 상기 그래프의 노드를 선 택하고, 상기 노드에 해당하는 클래스 정보를 읽어들이고, 상기 노드가 말단 노드인 경우 분류 결과를 반환하는결정 그래프 탐색부, 및 상기 프롬프트와 클래스 정보에 기반하여 이미지를 분류하는 이미지 분류부를 포함하는 포함할 수 있다. 상기 그래프는, 루트(root) 노드를 기점으로 하고, 적어도 하나의 말단(leaf) 노드가 존재하고, 순환 구조를 가 지지 않는 것을 특징으로 할 수 있다. 상기 결정 그래프 탐색부는, 텍스트 인코더를 포함하고, 적어도 하나의 분류 대상을 포함하는 클래스 텍스트의 목록을 읽어들이고, 상기 목록에 포함된 텍스트를 인코딩하여 텍스트 특징값을 추출하고, 그리고 상기 특징값을 상기 클래스 정보로서 읽어들이도록 구성될 수 있다. 상기 결정 그래프 탐색부는, 적어도 하나의 분류 대상에 대한 텍스트 특징값을 상기 클래스 정보로서 읽어들이 도록 구성될 수 있다. 상기 장치는, 상기 프롬프트에 포함된 적어도 하나의 클래스로 분류되는 단어를 추출하는 자연어 처리부를 더 포함하고, 상기 이미지 분류부는, 상기 자연어 처리부로부터, 상기 클래스 정보에 대응하는 단어를 입력받고, 처음 실행되는 경우 상기 데이터 입력부로부터 상기 데이터 목록을, 반복 실행되는 경우 앞서 실행된 이미지를 분류하는 단계의 결과를 분류 대상 이미지 목록으로 읽어들이고, 상기 분류 대상 이미지 목록에 포함된 적어도 하나의 이미지 가운데, 상기 선택된 단어에 대응하는 적어도 하나의 이미지를 선택하고, 그리고 상기 선택된 이 미지의 목록을 결과로서 출력하여 상기 메모리에 저장하도록 구성될 수 있다. 상기 장치는, 상기 프롬프트에 포함된 적어도 하나의 클래스로 분류되는 단어를 추출하는 자연어 처리부를 더 포함하고, 상기 이미지 분류부는, 상기 자연어 처리부, 및 노드 별 이미지 분류 결과를 병합하는 병합부를 더 포함하고, 상기 이미지 분류부는, 상기 자연어 처리부로부터, 상기 클래스 정보에 대응하는 단어를 입력받고, 상기 데이터 입력부로부터 상기 데이터 목록을 분류 대상 이미지 목록으로 읽어들이고, 상기 분류 대상 이미지 목록에 포함된 적어도 하나의 이미지 가운데, 상기 선택된 단어에 대응하는 적어도 하나의 이미지를 선택하고, 그리고 상기 선택된 이미지의 목록을 노드 별 분류 결과로서 출력하여 상기 메모리에 저장하도록 구성될 수 있 다. 상기 이미지 분류부는, 사전에 대규모 학습된 비전-언어 모델(vision-language model)에 기반하여 동작하는 것 을 특징으로 할 수 있다. 상기 장치는, 상기 데이터 목록에 포함된 이미지를 인코딩하여 이미지 특징값을 추출하는 이미지 인코더를 더 포함하고, 상기 이미지 분류부는, 상기 인코더로부터 제공되는 상기 이미지 특징값에 기반하여 동작하는 것을 특징으로 할 수 있다."}
{"patent_id": "10-2023-0116805", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명에 따르면, 종래의 비전-언어 모델 기반 인공지능에 중대한 수정을 가하거나 학습 방법을 고도화하지 않 고서도, 복합적 클래스에 대한 분류 문제를 해결할 수 있는 이로운 효과가 있다."}
{"patent_id": "10-2023-0116805", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "본 발명은 다양한 변경을 가할 수 있고 여러 가지 실시예를 가질 수 있는 바, 특정 실시예들을 도면에 예시하고 상세하게 설명하고자 한다. 그러나, 이는 본 발명을 특정한 실시 형태에 대해 한정하려는 것이 아니며, 본 발명 의 사상 및 기술 범위에 포함되는 모든 변경, 균등물 내지 대체물을 포함하는 것으로 이해되어야 한다. 제 1, 제 2 등의 용어는 다양한 구성요소들을 설명하는데 사용될 수 있지만, 상기 구성요소들은 상기 용어들에 의해 한정되어서는 안 된다. 상기 용어들은 하나의 구성요소를 다른 구성요소로부터 구별하는 목적으로만 사용 된다. 예를 들어, 본 발명의 권리 범위를 벗어나지 않으면서 제 1 구성요소는 제 2 구성요소로 명명될 수 있고, 유사하게 제 2 구성요소도 제 1 구성요소로 명명될 수 있다. \"및/또는\"이라는 용어는 복수의 관련된 기재된 항 목들의 조합 또는 복수의 관련된 기재된 항목들 중의 어느 항목을 포함하며, 또한, 달리 지시되지 않는 한 비배 타적이다. 본 출원에 항목을 열거하는 경우 그것은 본 출원 발명의 사상과 가능한 실시 방법들을 용이하게 설명 하기 위한 예시적 서술에 그치며, 따라서, 본 발명의 실시예 범위를 한정하는 의도를 가지지 아니한다. 본 명세서에서 \"A 또는 B(A or B)\"는 \"오직 A\", \"오직 B\" 또는 \"A와 B 모두\"를 의미할 수 있다. 달리 표현하면, 본 명세서에서 \"A 또는 B(A or B)\"는 \"A 및/또는 B(A and/or B)\"으로 해석될 수 있다. 예를 들어, 본 명세서에 서 \"A, B 또는 C(A, B or C)\"는 \"오직 A\", \"오직 B\", \"오직 C\", 또는 \"A, B 및 C의 임의의 모든 조합(any combination of A, B and C)\"를 의미할 수 있다. 본 명세서에서 사용되는 슬래쉬(/)나 쉼표(comma)는 \"및/또는(and/or)\"을 의미할 수 있다. 예를 들어, \"A/B\"는 \"A 및/또는 B\"를 의미할 수 있다. 이에 따라 \"A/B\"는 \"오직 A\", \"오직 B\", 또는 \"A와 B 모두\"를 의미할 수 있다. 예를 들어, \"A, B, C\"는 \"A, B 또는 C\"를 의미할 수 있다. 본 명세서에서 \"적어도 하나의 A 및 B(at least one of A and B)\"는, \"오직 A\", \"오직 B\" 또는 \"A와 B 모두\"를 의미할 수 있다. 또한, 본 명세서에서 \"적어도 하나의 A 또는 B(at least one of A or B)\"나 \"적어도 하나의 A 및/또는 B(at least one of A and/or B)\"라는 표현은 \"적어도 하나의 A 및 B(at least one of A and B)\"와 동 일하게 해석될 수 있다. 또한, 본 명세서에서 \"적어도 하나의 A, B 및 C(at least one of A, B and C)\"는, \"오직 A\", \"오직 B\", \"오직 C\", 또는 \"A, B 및 C의 임의의 모든 조합(any combination of A, B and C)\"를 의미할 수 있다. 또한, \"적어도 하나의 A, B 또는 C(at least one of A, B or C)\"나 \"적어도 하나의 A, B 및/또는 C(at least one of A, B and/or C)\"는 \"적어도 하나의 A, B 및 C(at least one of A, B and C)\"를 의미할 수 있다. 어떤 구성요소가 다른 구성요소에 \"연결되어\" 있다거나 \"접속되어\" 있다고 언급된 때에는, 그 다른 구성요소에 직접적으로 연결되어 있거나 또는 접속되어 있을 수도 있지만, 중간에 다른 구성요소가 존재할 수도 있다고 이 해되어야 할 것이다. 반면에, 어떤 구성요소가 다른 구성요소에 \"직접 연결되어\" 있다거나 \"직접 접속되어\" 있 다고 언급된 때에는, 중간에 다른 구성요소가 존재하지 않는 것으로 이해되어야 할 것이다. 본 출원에서 사용한 용어는 단지 특정한 실시예를 설명하기 위해 사용된 것으로, 본 발명을 한정하려는 의도가 아니다. 단수의 표현은 문맥상 명백하게 다르게 뜻하지 않는 한, 복수의 표현을 포함한다. 본 출원에서, \"포함 하다\" 또는 \"가지다\" 등의 용어는 명세서상에 기재된 특징, 숫자, 단계, 동작, 구성요소, 부품 또는 이들을 조 합한 것이 존재함을 지정하려는 것이지, 하나 또는 그 이상의 다른 특징들이나 숫자, 단계, 동작, 구성요소, 부 품 또는 이들을 조합한 것들의 존재 또는 부가 가능성을 미리 배제하지 않는 것으로 이해되어야 한다. 다르게 정의되지 않는 한, 기술적이거나 과학적인 용어를 포함해서 여기서 사용되는 모든 용어들은 본 발명이 속하는 기술 분야에서 통상의 지식을 가진 자에 의해 일반적으로 이해되는 것과 동일한 의미를 이용하고 있다. 일반적으로 사용되는 사전에 정의되어 있는 것과 같은 용어들은 관련 기술의 문맥상 가지는 의미와 일치하는 의 미를 가진 것으로 해석되어야 하며, 본 출원에서 명백하게 정의하지 않는 한, 이상적이거나 과도하게 형식적인 의미로 해석되지 않는다. 본 출원에서 발명을 설명함에 있어, 실시예들은 설명된 기능 또는 기능들을 수행하는 단위 블록들의 측면에서 설명되거나 예시될 수 있다. 상기 블록들이란 본 출원에서 하나 또는 복수의 장치, 유닛, 모듈, 부 등으로 표현 될 수 있다. 상기 블록들은 하나 또는 복수의 논리 게이트, 집적 회로, 프로세서, 컨트롤러, 메모리, 전자 부품 또는 이에 한정되지 않는 정보처리 하드웨어의 구현 방법에 의하여 하드웨어적으로 실시될 수도 있다. 또는, 상 기 블록들은 응용 소프트웨어, 운영 체제 소프트웨어, 펌웨어, 또는 이에 한정되지 않는 정보처리 소프트웨어의 구현 방법에 의하여 소프트웨어적으로 실시될 수도 있다. 하나의 블록은 동일한 기능을 수행하는 복수의 블록들 로 분리되어 실시될 수도 있으며, 반대로 복수의 블록들의 기능을 동시에 수행하기 위한 하나의 블록이 실시될 수도 있다. 상기 블록들은 또한 임의의 기준에 의하여 물리적으로 분리되거나 결합되어 실시될 수 있다. 상기블록들은 통신 네트워크, 인터넷, 클라우드 서비스, 또는 이에 한정되지 않는 통신 방법에 의해 물리적 위치가 특정되지 않고 서로 이격되어 있는 환경에서 동작하도록 실시될 수도 있다. 상기의 모든 실시 방법은 동일한 기 술적 사상을 구현하기 위하여 정보통신 기술 분야에 익숙한 통상의 기술자가 취할 수 있는 다양한 실시예의 영 역이므로, 여하의 상세한 구현 방법은 모두 본 출원상 발명의 기술적 사상 영역에 포함되는 것으로 해석되어야 한다. 이하, 첨부한 도면들을 참조하여, 본 발명의 바람직한 실시예를 보다 상세하게 설명하고자 한다. 본 발명을 설 명함에 있어 전체적인 이해를 용이하게 하기 위하여 도면상의 동일한 구성요소에 대해서는 동일한 참조부호를 사용하고 동일한 구성요소에 대해서 중복된 설명은 생략한다. 또한 복수의 실시예들은 서로 배타적이 아니며, 일부 실시예들이 새로운 실시예들을 형성하기 위해 하나 이상의 다른 실시예들과 조합될 수 있음을 전제로 한다. 도 1은 LLM에 의한 VQA 인공지능의 동작에 대한 개념도이다. 도 1을 참조하면, 대형 언어 모델(large language model; LLM)이 적용된 화상문답(visual question-answer; VQA) 기능의 인공지능이 제공되어 있다. 상기 인공지능은, 그 유형이 분류되지 않은 대량의 화상 데이터에 연결된 뒤, 상기 화상 데이터로부터 추 출하고자 하는 특정한 화상의 유형 또는 내용을 설명하는 프롬프트를 입력으로 받도록 구성될 수 있다. 상 기 인공지능은, 상기 프롬프트가 설명하는 바를 상기 LLM을 이용하여 처리하고, 그 결과물로서 상기 화상 데이터로부터 상기 프롬프트가 설명하는 바와 일치하는 적어도 하나의 출력 화상을 도출하도록 구성될 수 있다. 상술한 바와 같은 구성은 대량의 화상 데이터로부터 사람이 원하는 특정 요소가 있는 화상을 추출하는 데 편리 하게 활용될 수 있다. 예를 들어, 상기 화상 데이터가 대량의 CCTV 촬영 데이터이고, 상기 프롬프트 는 상기 CCTV에 촬영된 특정한 행동을 묘사하는 것이고, LLM VQA 인공지능이 상기 CCTV 촬영 데이터 를 분석하도록 설치되어 있다면, 상기 인공지능을 통하여 상기 CCTV 촬영 영상 가운데에서 특정 행동 이 발생한 영상을 추출할 수 있게 되는 것이다. 그러나 상술하였듯이 상기 프롬프트의 내용에 따라서 상기 인공지능이 도출하는 결과물의 품질은 달 라질 수 있다. 특히, 본 발명에서는 상기 프롬프트에 복합적인 클래스가 포함되어 있는 경우의 한계를 극복하고 자 한다. 도 2는 VQA 인공지능에 있어서 단일 클래스 판별과 복합 클래스 판별의 차이를 나타낸 개념도이다. 단일 클래스 판별의 경우, 도 2의 (a)를 참조하면, VQA 인공지능에는 화상 데이터 세트와 프롬프트가 주어질 수 있다. 상기 프롬프트에는 \"가위바위보\" 게임에서 어느 하나의 수를 지정하여 이미지를 찾고자 하는 자 연어 요구가 포함될 수 있으며, 따라서 \"가위/바위/보\"로 구성되는 단일 클래스에 대한 프롬프트로 간주될 수 있다. 상기와 같이 단일 클래스 프롬프트인 경우, 상기 VQA 인공지능은 상기 화상 데이터 세트에 속한 각각의 이미지에 대하여 프롬프트와 합치하는 정도에 대한 확률적 판단(예를 들어, 231)을 수행하도록 구 성되고, 통상적으로는 그 중 가장 프롬프트에 일치할 확률이 높은 경우(예를 들어, 232)에 해당하는 이미지 (들)(예를 들어, 211)를 정답으로 간주하여, 해당하는 이미지(들)을 출력하도록 구성될 수 있다. 도 2(a) 의 예시에는, 상기 프롬프트가 \"가위바위보에서 가위를 내는 사람\"으로 지정되었으므로, 상기 클래스(22 2)에 상응하여 타당한 출력이 도출되는 바람직한 예를 소개하고 있는 것으로 이해될 수 있다. 반면, 복수 클래스 판별의 경우 문제가 있을 수 있다. 도 2의 (b)를 참조하면, VQA 인공지능에는 유사하게 화상 데이터 세트와 프롬프트가 주어질 수 있으나, 이 경우 상기 프롬프트에는 \"가위바위보\" 게 임에서 어느 하나의 수를 내는 \"특정 옷 색깔\"의 사람을 나타내는 이미지를 찾고자 하는 자연어 요구가 포함될 수 있으며, 따라서 \"가위/바위/보\"로 구성되는 제1 클래스와 함께 \"검은옷/흰옷\"으로 구성되는 제2 클래스 를 더 구비하는 프롬프트로 간주될 수 있다. 상술하였듯이, 상기 VQA 인공지능은 상기 화상 데이터 세트에 속한 각각의 이미지에 대하여 프롬프트와 합치하는 정도에 대한 확률적 판단(예를 들어, 233)을 수 행하는 과정에서, 주어진 클래스 각각에 대하여 통합적인 확률 판단을 내리도록 구성될 수 있다. 그러나, 확률 의 총합은 일정하게 정해질 수밖에 없기 때문에, 도 2의 (b)에서 예시되는 것과 같이, 복수의 클래스 중 제2 클 래스에 대응하는 확률이 높게 측정되는 경우, 제1 클래스에 대해서는 상호 간의 확률적 차이가 간섭을 받아 희박하게 도출되거나, 및/또는 잘못된 확률 값의 분포를 도출하여, 실제의 정답(가령, 예시된 도면 에 따르면, 주어진 영상에 있어서 제1 클래스에 대한 정답은 \"바위\"가 아닌 \"가위\"이어야 한 다)되는 경우가 발생하게 된다. 결론적으로, 통상적으로 가장 프롬프트에 일치할 확률이 높은 경우(예를 들어, 234 및 235)가 잘못 계산되어, 바람직한 이미지(예를 들어, 275)를 정답으로 간주하지 못하고, 부적절한 이미지이미지를 출력하게 되는 한계 상황이 발생할 수 있다. 또한, 클래스와 화상이 일치하지 않는 경우의 문제도 상정할 수 있다. 도 2의 (c)를 참조하면, VQA 인공지능 에는 유사하게 화상 데이터 세트와 프롬프트가 주어질 수 있으나, 이 경우 상기 프롬프트 에 포함된 클래스에 전혀 대응하지 않는 화상 데이터를 포함하는 화상 데이터 세트가 제공되었다고 가정한 다. 이 경우, 상술하였듯이, 상기 VQA 인공지능은 상기 화상 데이터 세트에 속한 각각의 이미지에 대 하여 프롬프트와 합치하는 정도에 대한 확률적 판단(예를 들어, 235)을 수행하는 과정에서, 실제로는 어느 클래 스로도 분류될 수 없는 화상(예를 들어, 동물이 나타난 화상)에 대하여 부적절한 확률적 판단(예를 들어, 236)을 내리도록 동작할 수 있다. 그리고 결과적으로, 부적절한 이미지 이미지를 출력하게 되는 한계 상황 이 발생할 수 있다. 이러한 동작은 클래스 기반 VQA 인공지능이 확률적으로 동작하는 데에 따라 발생하는 본질 적 한계라고 이해될 수 있을 것이다. 따라서 상술하는 바와 같은 한계들을 개선하기 위하여, 본 발명에서는 결정 그래프에 의하여 동작하는 VQA 인공 지능의 연쇄적 구조를 제안한다. 도 3은 본 발명의 일 실시예에 의한 결정 그래프의 예시도이다. 도 3의 (a)를 참조하면, 일례를 들어, 임의의 프롬프트로서 \"가위바위보에서 가위를 내는 검은 옷의 사람\"이라는 문장이 주어졌다고 가정한다. 상기 프 롬프트는 상술한 바와 같이 비전-언어 모델에 의하여 그 총체로서 복합적으로 판단될 수도 있으나, 본 발명의 바람직한 일 실시예에 따르면, 개별 클래스 단위로 반복하여 판단함으로써 높은 정확도의 결과를 용이하게 얻을 수 있다. 상기 개별 클래스 단위의 판단을 위하여, 결정 그래프(decision graph)를 활용할 수 있다. 예를 들어, 도 3의 (a)에 나타난 예시에서는 최대 깊이 3을 가지는 결정 그래프가 나타나 있다. 상기 결정 그래프를 탐색하는 경우, 루트 노드는 첫 번째 클래스 판단을 수행하는 경우로 해석될 수 있다. 예를 들어, 상기 프롬프트를 분할하여, 제1 클래스의 판단에서는 \"사람/동물\" 중 어느 하나로 의 분류만을 실행하도록 한다. 이 중 \"사람\"으로 분류된 경우에는 그래프의 노드(node)가 확장되고, \"동물\"로 분류된 경우에는 노드의 말단(leaf)에 도달한 것으로 간주되는 예가 나타나 있다. \"사람\"으로 분류된 경우에는 상기 그래프로부터 다음 노드가 탐색되어, 제2 클래스의 판단이 실행될 수 있 다. 상기 제2 클래스의 판단에서는 \"가위/바위/보\"로의 분류만을 실행하도록 한다. 이 때, \"동물\"에 해당 하는 경우는 앞서 제1 클래스의 판단을 수행하는 노드에서 판단이 계속되지 아니하게 되므로, 무관계한 이 미지를 조기에 배제하는 효과가 있다. 상기 제2 클래스의 판단에서 어떠한 판단에 도달하였든, 상기 그래프에 의하면 다음 노드는 제3 클래 스의 판단으로 연결되고, \"검은옷/흰옷\"의 분류만을 실행하도록 한다. 상기 그래프는 해당 판단을 통해 말 단에 도달하는 예시에 해당한다. 이 때, 이미지에 포함되어 있는 사람이 \"가위/바위/보\" 중 어느 수를 내었는지 에 대한 판단이 병합되어 이루어지지 아니하므로, 옷의 색상과 관련하여서만 독립적인 판단이 이루어져, 비전- 언어 모델에 있어 복합 클래스가 동시에 입력됨에 따른 확률 간섭을 차단하는 효과가 있다. 상기와 같이 결정 그래프를 활용하여 순차적으로 판단을 실행하는 것이 본 발명의 바람직한 실시예에 해당할 수 있다. 실시예에 따라서는 도 3의 (b)와 같이, 루트 노드로부터 말단 노드까지 일관적으로 발산하는 구조를 가지 는 결정 트리(decision tree)가 사용될 수 있다. 그러나 다른 실시예에 따라서는 도 3의 (a)와 같이, 그리고 도 3의 (c)와 같이, 노드 간의 관계가 발산하지 아니하고 수렴하거나, 또는 노드의 깊이를 무시하고 다음 노드가 선택될 수 있는, 방향성 있는 그래프의 형태로 구성되어도 무방하다. 단, 본 발명의 바람직한 실시방법에 따르 면, 상기 그래프는 루트 노드를 기점으로 하고, 적어도 하나의 말단 노드가 존재하고, 순환 구조를 가지지 않는 단방향성 그래프인 것이 바람직할 수 있다. 본 발명에 의하면, 서로 다른 클래스에 대한 순차적 판단을 실시하 게 되므로, 동일한 클래스에 대하여 복수 회 판단을 수행할 필요가 없으며, 또한 말단 노드에 도달하지 아니한 다면 판단이 완료되는 시점을 특정할 수 없게 된다. 바람직하지 않은 그래프의 예시로는 도 3의 (d)가 제공되어 있다. 도 3에 나타난 다양한 트리 및/또는 그래프의 형상들은 본 발명의 동작 원리를 나타내기 위한 개념적 예시에 해 당하는 것으로서, 본 발명의 사상은 트리 및/또는 그래프에 한정되지 아니하고, 순차적 절차를 실행하기 위하여 사용되는 개념 또는 방법이 사용된다 하여도 이는 본 발명에서 예시로 나타낸 결정 그래프에 의한 판단과 등가 물일 것이므로, 본 발명이 나타내고자 하는 발명의 범위 내에 모두 포함되는 것임은 쉽게 알 수 있다. 본 발명의 원리를 설명하기 위하여, 비전-언어 모델의 기초적 구성과 관련하여 설명한다. 도 4는 비전-언어 모 델의 일반적 개념을 나타내는 개념도이다. 비전-언어 모델에는 텍스트 데이터 집합과 이미지 데이터 집합이 입력으로 주어질 수 있다. 상기 텍스트 데이터 집합에 포함된 텍스트 데이터는 텍스트 인코더 를 거쳐 텍스트 특징값(feature)으로 변환될 수 있다. 유사하게, 상기 이미지 데이터 집합에 포 함된 이미지 데이터는 이미지 인코더를 거쳐 이미지 특징값으로 변환될 수 있다. 상기 적어도 하나의 이미지 특징값에 대하여 상기 적어도 하나의 텍스트 특징값을 매칭시키는 연산을 통하여, 각각의 경 우에 대한 확률분포가 도출되고, 상기 분포에 기반하여 특정 단어로 설명되는 이미지의 분류가 가능하게 되는 것으로 예시할 수 있다. 도 5는 본 발명의 적용대상에 대응하는 비전-언어 모델의 동작방법에 대한 예시도이다. 도 5를 참조하면, 이미 지를 분류하는 데 사용하고자 하는 프롬프트가 주어진다. 상기 프롬프트은 자연어 처리(natural language process; NLP) 알고리즘에 입력되어, 바람직하게는 텍스트 특징값으로 처리될 수 있다. 본 발명 의 바람직한 일 실시예에 있어서, 상기 NLP 알고리즘은 텍스트 인코더를 포함하는 임베딩 과정을 의미할 수 있다. 상기 텍스트 특징값은, 바람직하게는, 특정한 분류 대상 클래스에 대응하는 것일 수 있다. 상기 분류 대상 클래스에 해당하는 텍스트 또한 텍스트 인코더에 의하여 특징값으로 변환될 수 있다. 본 발명의 다른 일 실시예에 있어서, 상기 NLP 알고리즘은 생략되고, 사람에 의하여 상기 특징값이나 그에 상응하는 특정 클래스에 대응하는 단어가 직접 상기 프롬프트로서 입력되어도 무방하다. 도 5의 예시에서는, 복수의 이미지로 구성된 이미지 데이터 집합으로부터 예시적으로 4개의 이미지(531 내 지 534)를 추출하여 예시하고 있다. 상기 프롬프트의 내용을 통하여, 상기 프롬프트에 대응하는 두 개의 이미지(531, 533)가 존재함을 이해할 수 있다. 상기 각각의 이미지(531 내지 534)는 이미지 인코더를 통하여 이미지 특징값으로 변환된 후, 상기 분류 대상 클래스에 대한 특징값과 매칭 연산될 수 있다. 개념적으로 단순화하여 예시하면, 상기 분류 대상 클래스에 예시된 \"가위\", \"바위\", 및 \"보\"의 특징 값이 각각 Ta, Tb, Tc로 나타났을 때, 상기 각각의 텍스트 특징값에 대응하여 상기 각각의 이미지 특징값 을 매칭한 결과는 상기 각각의 텍스트에 대응할 확률에 대한 행렬로 도출되는 것으로 개념화할 수 있 다. 이 때, 상기 프롬프트에 포함된 상기 클래스에 대응하는 단어가 \"가위\"였으므로, 이 중 \"가위\"일 확률이 높은 이미지의 특징값을 선택하도록 동작함으로써, 결과적으로 해당 이미지를 선택하고, 바람직한 출력 이미지(581, 583)을 포함하는 출력 이미지 집합을 생성하는 것이 가능하게 되는 것으로 이해될 수 있다. 도 6은 본 발명의 일 실시예에 따른 비전-언어 모델의 개량된 적용 방법에 대한 개념도이다. 도 6을 설명함에 있어서, 도 5와 중복되는 구성에 대한 설명은 도 5를 준용하여 생략한다. 프롬프트가 주어지면, 상기 프롬프트는 상술한 바와 같이 텍스트 임베딩 인코더를 포함할 수 있는 NLP 알고리즘에 의해 처리될 수 있다. 이 때, 상기 프롬프트로부터는 복수의 서로 다른 분류 클래스 에 대응하는 단어들(621, 622, 623)이 추출될 수 있다. 본 발명의 바람직한 일 실시예에 있어서, 상기 NLP 알고 리즘은 텍스트 인코더를 포함하는 임베딩 과정을 의미할 수 있다. 본 발명의 일 실시예에 있어서, 상기 프롬프트를 대신하여 상기 단어들(621, 622, 623)이 각각 제1 프롬프 트, 제2 프롬프트, 제3 프롬프트와 같이 직접 입력되어도 무방하다. 예를 들어, \"사람\", \"가위\", \"검은 옷\"이 각각의 프롬프트로서 입력될 수 있다. 또한, 응용된 일 실시예에 있어서, 도 6에 도시된 바와는 상이하게, 상기 제1 프롬프트, 제2 프롬프트, 제3 프롬프트가 상기 NLP 알고리즘에 입력되어 상술한 바와 같이 텍스트 인 코더에 의한 임베딩 과정에 입력되어도 무방하다. 또한, 본 발명의 더욱 응용된 일 실시예에 있어서는, 상기 NLP 알고리즘은 생략되고, 상기 텍스트 인코더에 의하여 인코딩된 특징값이 프롬프트를 대체하여 입력되어 도 무방하다. 상기 각각의 분류 클래스에 대응하는 분류 대상 클래스(615, 616, 617)은 상술한 바와 같이 텍스트 인코더(62 5)에 의하여 처리되어 입력될 수 있다. 이 때, 상기 분류 대상 클래스의 선택 과정은, 상기 단어들(621, 622, 623)에 기반하여 결정 그래프에 의하여 실행될 수 있다. 복수의 이미지로 구성된 이미지 데이터 집합 또한 예시되나, 그 중 하나는 상기 프롬프트와 보다 연관성이 낮은 이미지, 예를 들어 동물의 화상으로 예 시되어 있다. 본 발명의 일 실시예에 의한 순차적 비교에 의하면, 이미지 데이터 집합이 이미지 인코더를 통해 변 환된 이미지 특징값상기 각각의 클래스(615, 616, 617)로부터 추출된 텍스트 특징값 집합(651, 652, 653) 의 상호 비교는 순차적으로 이루어질 수 있다. 도 6의 실시 예시를 참조하면, 제1 클래스에 대한 첫 번째 비교 결과에 의해서는 \"사람\"이 포함된 이미지가 선택될 수 있다. 제2 클래스에 대한 두 번째 비교 결과는 \"가위\"를 내는 것으로 인식된 이미지가 선택될 수 있다. 이 때, 상술한 바와 같이 비전-언어 모델 의 한계로 인하여 궁극적으로는 무관계한 이미지 또한 선택될 수 있다. 제3 클래스에 대한 두번째 비교 결과는 \"검은 옷\"으로 인식된 이미지가 선택될 수 있다. 상기 3개의 순차적으로 실행된 결과 (671, 672, 673)는 각각의 클래스에 대응하여 이미지의 분류를 완료한 행렬의 형태로 도출될 수 있다. 본 발명 의 일 실시예에 따르면, 상기 각각의 결과는 행렬곱과 같이 행렬의 교집합을 구하는 연산에 의하여 처리될 수 있다. 즉, \"사람\"이자 \"가위\"이자 \"검은 옷\"인 교집합의 이미지를 선택하도록 구성될 수 있다. 이 경우 오선택 된 이미지나 부분적으로만 대응하는 이미지가 제거되고, 합당한 결과 이미지만을 포함하는 출력 이미지 집합을 용이하게 획득할 수 있다. 도 6에 나타난 예시에서는 각각의 판단이 순차적으로 그러나 독립적으로 수행된 뒤 각각의 교집합에 의하여 최 종 출력이 도출되는 것으로 묘사되어 있다. 그러나 이는 본 발명의 동작방법을 예시하기 위한 일 실시예에 불과 한 것으로, 본 발명의 적용 방법은 이에 한정되지 아니한다. 예를 들어, 상기 이미지 분류 과정은 첫 번째 결과 에서 지정된 분류로 분류된 이미지에 한정하여 두 번째 비교를 실행하여 두 번째 결과를 얻는 것과 같이 그 비교대상을 점진적으로 한정하는 방법으로 구현될 수도 있다. 그 밖에 비전-언어 모델의 클래스 별 순 차적 적용을 통하여 복수의 단일 클래스 이미지 분류를 통해 복합 클래스 이미지 분류를 용이하게 달성할 수 있 는 어떠한 방법이 사용되어도 무방하다. 도 7은 본 발명의 일 실시예에 따른 순차적 비전-언어 모델의 적용 방법에 대한 순서도이다. 본 발명의 일 실시 예에 따른 비전-언어 모델 기반의 이미지 분류 방법은, 적어도 하나의 이미지를 포함하는 데이터 목록에 기반하 여 동작하는 것일 수 있다. 상기 데이터 목록으로부터 분류하고자 하는 이미지의 분류를 지정하는 프롬프트가 입력(S710)될 수 있다. 다음으로, 상기 프롬프트로부터 적어도 하나의 클래스로 분류되는 단어를 추출(S720)할 수 있다. 다음으로, 최종 결과 행렬을 초기화하는 과정이 진행될 수 있는데, 이러한 과정은 결과 행렬을 행렬곱에 의하여 도출하는 경우 필요한 절차일 수 있다. 다음으로, 적어도 하나의 클래스 간의 분류 순서를 정 의하는 결정 그래프에 대한 정보를 읽어들이고(S740), 상기 결정 그래프에 근거하여 그래프의 루트 노드로부터 의 탐색을 통해 분류 대상이 되는 클래스를 변경하면서 이미지의 순차적 분류를 실행할 수 있다. 최초에는 그래 프의 루트에 해당하는 노드를, 그 이후에는 앞선 비교의 결과로 선택된 노드를 선택하고(S750), 상기 노드에 해 당하는 클래스 정보를 읽어들일 수 있다(S760). 다음으로, 앞서 도 6에서 예시한 바와 같이, 상기 프롬프트와 클래스 정보에 기반하여 이미지를 단일 클래스에 대하여 제로-샷 방식으로 분류(S770)하는 과정이 실행될 수 있 다. 상기 분류의 결과에 의하여 분류의 대상이 되는 이미지 목록이 한정(S780)될 수 있는데, 이러한 과정은 한 차례의 분류에 의하여 선택된 이미지에 대하여서만 다음 순서의 분류를 진행하는 경우 필요한 절차일 수 있다. 만약 상기 결정 그래프의 마지막 노드, 즉 말단에 도달하여 더 이상의 분류가 불필요한 경우(S785), 최종적으로 이미지 목록이 출력(S790)되고, 그렇지 않은 경우 그래프의 탐색이 이루어지며 노드의 선택(S750) 단계부터가 반복되는 것으로 이해될 수 있다. 본 발명의 일 실시예에 따르면, 상기 프롬프트의 입력(S710) 시에는, 자연어 프롬프트가 아니라 클래스 별 분류 가 바람직하도록 이미 분리되어 있는 단어의 집합이 입력되거나, 또는 상기 단어를 텍스트 인코딩한 적어도 하 나의 특징값으로 구성된 입력 값이 상기 프롬프트를 대신하여 입력되어도 무방하다. 본 발명의 일 실시예에 따르면, 상기 노드에 해당하는 클래스 정보를 읽어들이는 과정(S760)은, 적어도 하나의 분류 대상을 포함하는 클래스 텍스트의 목록을 읽어들이고, 상기 목록에 포함된 텍스트를 인코딩하여 텍스트 특 징값을 추출하고, 상기 특징값을 상기 클래스 정보로서 읽어들이는 방법으로 구현될 수 있다. 또는, 상기 인코 딩이 미리 수행되어 저장된 특징값을 상기 클래스 정보로서 읽어들이는 방법으로 구현되어도 무방하다. 본 발명의 일 실시예에 따르면, 상기 프롬프트를 클래스 단위로 분리하는 과정(S720)은 노드로부터 클래스 정보 를 읽어들인 뒤 매번 실행되는 것으로 구현되어도 무방하다. 즉, 단계 S760과 S770 사이에 실행되도록 구성될 수 있다. 이 경우 상기 노드로부터 읽어들인 클래스 정보에 기반하여 상기 프롬프트로부터 대응하는 단어만이 분리되는 형태로 구현될 수 있다. 본 발명의 일 실시예에 따르면, 상기 이미지를 제로-샷 방식으로 분류하는 과정(S770)은, 상기 프롬프트로부터 추출된 단어 가운데, 상기 클래스 정보에 대응하는 단어를 선택하여, 처음 실행되는 경우 상기 데이터 목록을, 반복 실행되는 경우 앞서 실행된 이미지를 분류하는 단계의 결과를 분류 대상 이미지 목록으로 읽어들여 실행될 수 있다. 또는, 다른 실시예에 따르면, 처음과 반복 실행의 경우에 무관하게 상기 데이터 목록을 분류 대상 이 미지 목록으로 읽어들여 실행되어도 무방하다. 이러한 경우, 각 노드별로 실행된 결과에 대해서는 차후에 행렬 곱 등을 이용한 병합이 필요할 수 있다. 본 발명의 일 실시예에 따르면, 상기 이미지를 제로-샷 방식으로 분류하는 과정(S770)은 사전에 대규모 학습된 비전-언어 모델(vision-language model)에 기반하여 동작하도록 구성될 수 있으며, 예를 들어, CLIP 모델과 같은 것이 사용될 수 있으나, 본 발명의 실시 및 구현 방법은 해당 모델에 한정되지는 아니한다. 본 발명의 일 실시예에 따르면, 상기 이미지를 제로-샷 방식으로 분류하는 과정(S770)은, 사전에 상기 데이터 목록에 포함된 이미지를 인코딩하여 추출된 이미지 특징값에 기반하여 동작하도록 구성될 수 있다. 도 8은 본 발명의 일 실시예에 따른 결정 그래프에 의한 순차적 분류 실행의 예시도이다. 도 8은 방범용 지능형 CCTV에 사용될 수 있는 결정 그래프의 일 사례를 나타낸 것이다. 도 8을 참조하면, 프롬프트가 입력되면 인코딩 등 자연어 처리 과정에 의하여 분류에 사용되는 클래스 별 단어들이 추출될 수 있다. 상기 클 래스 별 단어들은 루트 노드를 기점으로 하는 결정 그래프의 각각의 노드(810 내지 880)에서 단일 클래스 제로-샷 이미지 분류를 실행하는 데 사용될 수 있다. 예를 들어, 노드 810에서의 분류를 통하면, 사람에 해당하 는 이미지의 목록을 획득할 수 있다. 마찬가지로, 노드 820에서는 행동의 유형을, 노드 830에서는 유기의 경우 에 한정하여 유기 물체의 유형을, 노드 840에서는 대상자의 성별을, 노드 850에서는 대상자의 추정 연령을, 노 드 860에서는 대상자의 외양을 각각 단일 클래스 제로-샷 이미지 분류를 통해 식별하도록 구성된다. 상술한 바 와 같이, 단계적으로 선택 대상이 되는 이미지의 수를 줄여나가거나, 또는 각각의 단계별로 분류한 결과의 교집 합을 행렬곱 등을 통해 획득하는 방법으로, \"쓰레기를 유기하는 검은색 옷의 30대 남성 사람\"이라는 복합적 클 래스를 가진 프롬프트에 대하여 용이하게 분류 결과를 획득할 수 있음을 알 수 있다. 또한, 동일한 결정 그래프 가 그래프에서 도출될 수 있는 다른 프롬프트를 이용한 분류에도 곧바로 사용될 수 있는 이점이 있다. 예를 들 어, 상기 결정 그래프를 이용한 시스템은 상기 예시된 프롬프트 외에도, \"빨간 옷의 쓰러진 40대 여성\"이 나 \"유해조수 가운데 멧돼지\"를 식별하는 데에도 단계적 분류법을 통해 용이하게 이를 수 있음을 이해할 수 있 을 것이다. 도 9는 본 발명의 일 실시예에 따른 비전-언어 모델 기반의 이미지 분류 장치를 나타내는 블록도이다. 상술한 방법을 장치로서 구현하는 경우, 본 발명의 일 실시예에 따른 이미지 분류 장치는, 연산 기능을 가진 프로 세서, 상기 프로세서에 연결된 메모리, 입/출력 인터페이스, 상기 프롬프트와 클래스 정보에 기 반하여 이미지를 분류하는 이미지 분류부, 상기 프롬프트로부터 적어도 하나의 클래스로 분류되는 단어를 추출하는 자연어 처리부, 및 적어도 하나의 클래스 간의 분류 순서를 정의하는 그래프를 읽어들이고, 상기 그래프의 노드를 선택하고, 상기 노드에 해당하는 클래스 정보를 읽어들이고, 상기 노드가 말단 노드인 경우 분 류 결과를 반환하도록 지시하는 결정 그래프 탐색부를 포함하여 구성될 수 있다. 상술하는 각각의 기능부 가운데, 앞서 도 3 내지 도 8을 참조하여 설명한 본 발명에 의한 방법을 동일하게 구현하는 기능부에 대한 상세 한 동작의 설명은 앞서 서술한 실시예로 대체한다. 본 발명의 실시예에 따라서, 상기 입/출력 인터페이스는 적어도 하나의 이미지를 포함하는 데이터 목록을 입력받는 데이터 입력부, 이미지의 분류를 지정하는 프롬프트를 입력받는 문장 입력부, 및 선택된 이 미지의 결과를 출력하는 출력부로 구성될 수 있다. 또한, 실시예에 따라서, 상기 이미지 분류부는 비 전-언어 모델를 내포하도록 구성될 수 있다. 상기 입/출력 인터페이스에 있어 입력 기능은 인간-컴퓨터 인터페이스 및 컴퓨터-컴퓨터 인터페이스 중 적 어도 하나를 포함하여 구성될 수 있다. 상기 인간-컴퓨터 인터페이스란, 예를 들어 키보드, 버튼, 마우스, 트랙 볼, 터치패드, 디지타이저 펜, 카메라, 음성 입력용 마이크, 및 그 밖의 인간 입력을 상기 장치에 제공하는 인 터페이스 기능을 의미할 수 있다. 상기 컴퓨터-컴퓨터 인터페이스란, 예를 들어 유선 또는 무선 통신에 의한 방 법으로 상기 장치에 입력을 제공하는 통신 기능을 의미하거나, 또는 하나의 장치를 구성하는 기능부들 간에 입 력 신호를 제공하기 위하여 구성된 회로와 같은 것을 의미할 수 있다. 상기 입/출력 인터페이스에 있어 출력 기능은 일반적인 출력용 인간-컴퓨터 인터페이스 장치 또는 방법을 사용하는 기능부일 수 있다. 예를 들어, 상기 입/출력 인터페이스의 출력부는 액정이나 OLED와 같은 화상 디스플레이 장치를 통해 문자, 그래픽, 색상 중 적어도 하나를 이용하여 결과 데이터를 표출하는 기능부이 거나, 분리된 또는 이격된 임의의 장치, 예를 들어 터미널, 단말기, 무전기, 또는 휴대전화를 포함하는 유형의 장치에 대하여 유선 또는 무선 통신을 통하여 결과 데이터를 전송하는 통신 기능부의 형태로도 구현될 수 있다. 그 밖에도 상기 장치가 출력하는 정보를 외부에 표출할 수 있는 형태로서 통상의 기술자에게 알려진 어떠한 장 치나 수단으로 구현되어도 무방하다. 상기 이미지 분류 장치에 포함될 수 있는 각 기능부는 버스(bus), 회로, 또는 루틴(routine)과 서브루틴 (subroutine)의 관계와 같이 다양한 형태로 상호 연결되어 상기 장치 내에서 정보를 교환하도록 구성 될 수 있다. 또한, 상기 각 기능부는, 상기 상호 연결을 통하여, 상기 각 기능부 가운데 계산의 수행을 주 로 요하는 기능부의 동작을 실행 또는 지원하기 위한 목적에서, 연산 기능을 가지는 독립적인 프로세서 및/또는메모리를 포함하도록 구성될 수 있다. 상기 프로세서를 포함하여 본 명세서에 기재된 \"프로세서\"는, 프로세서, 콘트롤러, ALU(arithmetic logic unit), 디지털 신호 프로세서(digital signal processor), 마이크로컴퓨터, FPA(field programmable array), PLU(programmable logic unit), 마이크로프로세서, 또는 명령(instruction)을 실행하고 응답할 수 있는 다른 어떠한 장치와 같이, 하나 이상의 범용 컴퓨터 또는 특수 목적 컴퓨터를 의미할 수 있다."}
{"patent_id": "10-2023-0116805", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "이해의 편의를 위하여 상기 프로세서가 단수로 표현되는 경우라 할지라도, 해당 기술분야에서 통상의 지식 을 가진 자는, 상기 프로세서가 복수 개의 처리요소(processing element) 및/또는 복수 유형의 처리 요소 를 포함할 수 있음을 알 수 있다. 예를 들어, 본 발명의 일 실시예에 따른 장치는 상기 프로세서로서 복수 개의 프로세서 또는 하나의 프로세서 및 하나의 콘트롤러를 포함할 수 있다. 또한, 상기 프로세서는 병렬 프로세서(parallel processor)나 멀티-코어 프로세서(multi-core processor)와 같이, 다양한 처리 구성 (processing configuration)에 의하여 구현될 수 있다. 상기 프로세서는, 운영 체제(OS) 및 상기 운영 체제 상에서 수행되는 하나 이상의 소프트웨어(software)를 수행하도록 구성될 수 있다. 또한, 상기 프로세서는 상기 소프트웨어의 실행에 응답하여, 데이터를 접근, 저장, 조작, 처리 및 생성할 수도 있다. 상기 소프트웨어는, 컴퓨터 프로그램(computer program), 코드(code), 명령(instruction), 또는 이들 중 하나 이상의 조합을 포함하 수 있으며, 원하는 대로 동작하도록 처리 장치를 구성하거나 독립적으로 또는 결합적으로(collectively) 처리 장치를 명령할 수 있다. 상기 소프트웨어는, 상기 프로세서에 의하여 해석되거나 상기 프로세서에 명령 또는 데이터를 제공하기 위하여, 어떤 유형의 기계, 구성요소(component), 물리적 장치, 가상 장치(virtual equipment), 컴퓨터 저장 매체 또는 장치, 또는 전송되는 신호 파(signal wave)에 영구적으로, 또는 일시적으로 구체화(embody)될 수 있다. 상기 소프트웨어는 네트워크로 연결된 컴퓨터 시스템 상에 분산되어서, 분산된 방법으로 저장되거나 실행될 수도 있다. 상기 소프트웨어는 또한, 다양한 컴퓨터 수단을 통하여 수행될 수 있는 프로그램 명령 형태로 구현되어 상기 메 모리에 기록되거나 저장될 수 있다. 상기 메모리는 컴퓨터 판독 가능 기록 매체일 수 있으며, 상기 컴퓨터 판독 가능 기록 매체에는 프로그램 명령, 데이터 파일, 데이터 구조 등이 단독으로 또는 조합되어 기록될 수도 있다. 상기 메모리에 저장되는 프로그램 명령은 본 발명의 실시예를 위하여 특별히 설계되고 구성된 명령 체계에 기반하거나, 또는 컴퓨터 소프트웨어 당업자에게 공지되어 사용 가능한 명령 체계, 예를 들어 어셈블리 어(Assembly), C, C++, Java, Python 언어 등으로 예시되는 명령 체계를 따를 수도 있다. 상기 명령 체계 및 그에 의한 프로그램 명령은 컴파일러에 의해 만들어지는 것과 같은 기계어 코드뿐만 아니라 인터프리터 등을 사 용하여 본 발명의 일 실시예에 따른 장치 및/또는 상기 프로세서에 의해서 실행될 수 있는 고급 언어 코드를 포 함하는 것으로 이해되어야 한다. 본 명세서에 기재된 상기 메모리를 포함하여 본 발명의 일 실시예에 따른 장치를 구성하는 컴퓨터 판독 가 능 기록 매체는, 프로세서 캐시(Cache), 램(RAM), 플래시 메모리와 같이 상기 프로세서가 동작하는 동안만 유지되는 일시적 또는 휘발성 기록 매체를 포함할 수 있고, 또는 하드 디스크, 플로피 디스크, 및 자기 테이프 와 같은 자기체(magnetic media), CD-ROM, DVD와 같은 광기록 매체(optical media), 플롭티컬 디스크 (floptical disk)와 같은 자기-광 매체(magneto-optical media), 또는 정적 상태 메모리(solid state memory) 와 같이 상대적으로 비휘발성적이거나 장기 기록이 가능한 기록 매체를 포함할 수 있고, 또는 하드웨어 상에 배 치된 롬(ROM)과 같은 읽기 전용의 기록 매체를 포함할 수 있으며, 나아가 회로배선에 의한 하드-와이어드(hard- wired) 구조에 의하여 일련의 프로그램 명령과 등가의 동작을 수행하도록 구성된 하드웨어 그 자체 또한, 본 발 명의 실시예를 구현하는 상기 동작을 수행하기 위한 각 단계가 상기 하드웨어 부품의 연결과 배치에 의하여 기 록되어 있다고 볼 수 있으므로, 그 연결 및 배치방법이 곧 상기 메모리와 등가인 것으로 볼 수 있음은 통 상의 기술자에게 자명하다. 상기 프로세서 및 상기 메모리에 대하여 상술한 실시예는 상호 배타적이지 않으며, 필요에 따라 선택 되거나 결합되어 실시될 수 있다. 예를 들어, 하나의 하드웨어 장치는 본 발명 실시예의 동작을 수행하기 위해 하나 이상의 상기 소프트웨어로 구성된 모듈로서 작동하도록 구성될 수 있으며, 그 역도 마찬가지이다. 또 다른 예를 들어, 본 명세서에 있어서, 어떠한 기능부에 할당된 동작의 전부 또는 일부는 본 발명의 일 실시예에 따른 장치에(바람직하게는, 상기 메모리의 범주에 속하는 어느 하나의 기록 매체에) 저장된 하나 이상의 상기 소프트웨어에 의하여 구현되어, 상기 프로세서에 의하여 실행되도록 구성될 수 있으며, 이러한 경우, 상기 와 같은 기능부는 상기 프로세서에 \"포함되는\" 기능부로서 칭해질 수 있다.이상 본 발명에 대하여 도면 및 실시예를 참조하여 설명하였으나, 이미 상술한 바와 같이 본 발명의 보호범위가 상기 제시된 도면 또는 실시예에 의해 한정되는 것을 의미하지는 않으며, 해당 기술 분야의 숙련된 당업자는 본 발명 특허의 청구범위에 기재된 본 발명의 사상 및 영역으로부터 벗어나지 않는 범위 내에서 본 발명을 다양하 게 수정 및 변경시킬 수 있음을 이해할 수 있을 것이다."}
{"patent_id": "10-2023-0116805", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 LLM에 의한 VQA 인공지능의 동작에 대한 개념도, 도 2는 VQA 인공지능에 있어서 단일 클래스 판별과 복합 클래스 판별의 차이를 나타낸 개념도, 도 3은 본 발명의 일 실시예에 의한 결정 그래프의 예시도, 도 4는 비전-언어 모델의 일반적 개념을 나타내는 개념도, 도 5는 본 발명의 적용대상에 대응하는 비전-언어 모델의 동작방법에 대한 예시도, 도 6은 본 발명의 일 실시예에 따른 비전-언어 모델의 개량된 적용 방법에 대한 개념도, 도 7은 본 발명의 일 실시예에 따른 순차적 비전-언어 모델의 적용 방법에 대한 순서도, 도 8은 본 발명의 일 실시예에 따른 결정 그래프에 의한 순차적 분류 실행의 예시도, 그리고 도 9는 본 발명의 일 실시예에 따른 비전-언어 모델 기반의 이미지 분류 장치를 나타내는 블록도이다."}
