{"patent_id": "10-2022-0084087", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2024-0007334", "출원번호": "10-2022-0084087", "발명의 명칭": "인공지능을 이용한 뇌관류 및 혈액뇌장벽투과도 맵 예측 방법 및 장치", "출원인": "학교법인 건국대학교", "발명자": "문원진"}}
{"patent_id": "10-2022-0084087", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "인공지능을 이용한 뇌관류 및 혈액뇌장벽투과도 맵 예측 방법에 있어서, 물리적 모델을 기반으로 한 순환 생성적 적대 신경망(CycleGAN)을 이용하여 비대응 데이터를 기반으로 DCE-MRI(Dynamic Contrast-Enhanced Magnetic Resonance Imaging) 영상으로부터 약동학적(Pharmacokinetic, PK) 파라미터를 추정하도록 학습하는 단계를 포함하는, 맵 예측 방법."}
{"patent_id": "10-2022-0084087", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 순환 생성적 적대 신경망은, 하나의 생성자 및 하나의 구별자를 포함하는 것을 특징으로 하는, 맵 예측 방법."}
{"patent_id": "10-2022-0084087", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1항에 있어서,상기 DCE-MRI 영상은 각 조직에서 시간에 따른 조영제 농도 변화를 측정하며, 측정된 상기 조영제 농도 변화로부터 혈관의 투과도 또는 조직 관류와 연관된 상기 약동학적(PK) 파라미터를 추정하는 것을 특징으로 하는, 맵 예측 방법."}
{"patent_id": "10-2022-0084087", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제1항에 있어서,상기 학습하는 단계는, 상기 순환 생성적 적대 신경망의 생성자를 이용하여 상기 DCE-MRI 영상으로부터 약동학적(PK) 파라미터를 추정하는 단계; 상기 생성자를 이용하여 추정된 상기 약동학적(PK) 파라미터를 특정 동역학(Tracer Kinetic, TK) 모델을 이용하여 다시 DCE-MRI 영상으로 되돌리는 단계; 및 상기 동역학(TK) 모델을 이용하여 되돌린 DCE-MRI 영상과 처음의 상기 생성자의 입력으로 들어간 상기 DCE-MRI영상을 비교하여 제1 순환 일관성(cycle-consistency) 손실을 계산하는 단계를 포함하는, 맵 예측 방법."}
{"patent_id": "10-2022-0084087", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제1항에 있어서,상기 학습하는 단계는, 상기 순환 생성적 적대 신경망의 특정 동역학(TK) 모델을 이용하여 약동학적(PK) 파라미터로부터 DCE-MRI 영상을 생성하는 단계; 상기 동역학(TK) 모델을 이용하여 생성한 상기 DCE-MRI 영상을 생성자의 입력으로 사용하여 약동학적(PK) 파라미터를 추정하는 단계; 및 처음의 상기 약동학적(PK) 파라미터와 상기 생성자가 추정한 약동학적(PK) 파라미터를 비교하여 제2 순환 일관공개특허 10-2024-0007334-3-성 손실을 계산하는 단계를 포함하는, 맵 예측 방법."}
{"patent_id": "10-2022-0084087", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제1항에 있어서,상기 학습하는 단계는, 상기 순환 생성적 적대 신경망에서 각각 계산된 제1 순환 일관성 손실 및 제2 순환 일관성 손실을 통해 대응 데이터가 없이도 생성자가 동역학(TK) 모델의 역이 되어 상기 DCE-MRI 영상으로부터 상기 약동학적(PK) 파라미터를 추정하도록 학습하는 단계를 포함하는, 맵 예측 방법."}
{"patent_id": "10-2022-0084087", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제4항에 있어서,상기 학습하는 단계는, 구별자를 통해 실제 상기 약동학적(PK) 파라미터와 상기 생성자가 추정한 약동학적(PK) 파라미터를 구분하는 단계를 더 포함하는, 맵 예측 방법."}
{"patent_id": "10-2022-0084087", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "인공지능을 이용한 뇌관류 및 혈액뇌장벽투과도 맵 예측 장치에 있어서, 물리적 모델을 기반으로 한 순환 생성적 적대 신경망(CycleGAN)을 이용하여 비대응 데이터를 기반으로 DCE-MRI(Dynamic Contrast-Enhanced Magnetic Resonance Imaging) 영상으로부터 약동학적(Pharmacokinetic, PK) 파라미터를 추정하도록 학습하는 학습부를 포함하는, 맵 예측 장치."}
{"patent_id": "10-2022-0084087", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제1항에 있어서,상기 학습부는, 상기 순환 생성적 적대 신경망의 생성자를 이용하여 상기 DCE-MRI 영상으로부터 약동학적(PK) 파라미터를 추정하는 제1 약동학적(PK) 파라미터 추정부; 상기 생성자를 이용하여 추정된 상기 약동학적(PK) 파라미터를 특정 동역학(Tracer Kinetic, TK) 모델을 이용하여 다시 DCE-MRI 영상으로 되돌리는 제1 DCE-MRI 영상 재생성부; 상기 동역학(TK) 모델을 이용하여 되돌린 DCE-MRI 영상과 처음의 상기 생성자의 입력으로 들어간 상기 DCE-MRI영상을 비교하여 제1 순환 일관성(cycle-consistency) 손실을 계산하는 제1 순환 일관성 손실 산정부; 상기 순환 생성적 적대 신경망의 특정 동역학(TK) 모델을 이용하여 약동학적(PK) 파라미터로부터 DCE-MRI 영상을 생성하는 제2 DCE-MRI 영상 재생성부; 상기 동역학(TK) 모델을 이용하여 생성한 상기 DCE-MRI 영상을 생성자의 입력으로 사용하여 약동학적(PK) 파라미터를 추정하는 제2 약동학적(PK) 파라미터 추정부; 및 처음의 상기 약동학적(PK) 파라미터와 상기 생성자가 추정한 약동학적(PK) 파라미터를 비교하여 제2 순환 일관성 손실을 계산하는 제2 순환 일관성 손실 산정부를 포함하는, 맵 예측 장치."}
{"patent_id": "10-2022-0084087", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "공개특허 10-2024-0007334-4-인공지능을 이용한 뇌관류 및 혈액뇌장벽투과도 맵 예측 방법에 있어서, 물리적 모델을 기반으로 한 순환 생성적 적대 신경망(CycleGAN)의 생성자를 이용하여 DCE-MRI(DynamicContrast-Enhanced Magnetic Resonance Imaging) 영상으로부터 약동학적(Pharmacokinetic, PK) 파라미터를 추정하는 단계; 상기 생성자를 이용하여 추정된 상기 약동학적(PK) 파라미터를 특정 동역학(Tracer Kinetic, TK) 모델을 이용하여 다시 DCE-MRI 영상으로 되돌리는 단계; 및 상기 동역학(TK) 모델을 이용하여 되돌린 DCE-MRI 영상과 처음의 상기 생성자의 입력으로 들어간 상기 DCE-MRI영상을 비교하여 제1 순환 일관성(cycle-consistency) 손실을 계산하는 단계를 포함하는, 맵 예측 방법."}
{"patent_id": "10-2022-0084087", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "인공지능을 이용한 뇌관류 및 혈액뇌장벽투과도 맵 예측 방법 및 장치가 제시된다. 일 실시예에 따른 인공지능 을 이용한 뇌관류 및 혈액뇌장벽투과도 맵 예측 방법은, 물리적 모델을 기반으로 한 순환 생성적 적대 신경망 (CycleGAN)을 이용하여 비대응 데이터를 기반으로 DCE-MRI(Dynamic Contrast-Enhanced Magnetic Resonance Imaging) 영상으로부터 약동학적(Pharmacokinetic, PK) 파라미터를 추정하도록 학습하는 단계를 포함하여 이루어 질 수 있다."}
{"patent_id": "10-2022-0084087", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "아래의 실시예들은 인공지능을 이용한 뇌관류 및 혈액뇌장벽투과도 맵 예측 방법 및 장치에 관한 것이다."}
{"patent_id": "10-2022-0084087", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "역동적 조영 증강 자기 공명 영상(Dynamic Contrast-Enhanced Magnetic Resonance Imaging, DCE-MRI)은 다양한 질병의 진단, 예후추정과 치료효과평가에 유용한 영상 기술이다. DCE-MRI에서는 가돌리늄 조영제를 투여하고 적어도 몇 분 이상 반복적으로 T1강조영상을 획득함으로써, 조직의 T1변화를 시간적으로 측정한다. 이때 조직의 T1 신호변화를 통해, 시간에 따른 조영제의 농도변화를 측정하게 된다. 이렇게 측정한 시간에 따른 조영제 농도 곡선에 대하여 약동학적분석을 적용하면, 조직내로 조영제가 분포한 정도를 계산해낼 수 있으며, 이를 통해 조 직내 미세혈관의 투과도나 조직 관류 등의 약동학적(PharmacoKinetic, PK) 파라미터를 추정할 수 있다. 조영제 농도와 PK 파라미터간의 약동학적 관계는 트레이서 동역학(Tracer Kinetic, TK) 모델이라는 수학적 관계 로 표현된다. 대표적인 TK 모델에는 Tofts 모델, eTofts 모델 및 Patlak 모델 등이 있으며, 가장 많이 이용되 는 모델은 eTofts 모델과 Patlak 모델이다. PK 파라미터는 각 복셀의 조영제 농도 변화를 TK 모델에 피팅하여 추정할 수 있다. TK 모델 피팅에 일반적으로 사용되는 방법은 비선형적 최소 제곱(Nonlinear Least Squares, NLLS) 방법이다. 하지만 NLLS 방법은 많은 반복이 필요해서 계산 복잡도가 크고, 동맥 주입 함수(Arterial Input Function, AIF)와 같은 생리학적 지표 정보가 반드시 필요하다. AIF가 정확하게 측정되지 않으면 NLLS 방 법의 정확도는 매우 감소할 수 있다. 계산 복잡도와 시간 단축을 줄이기 위한 선형 최소 제곱(Linear Least Squares, LLS) 방법이 제안되었지만, 잡음 수준이 높으면 정확하지 않은 결과를 보여준다. 최근 DCE-MRI로부터의 PK 파라미터 추정을 위한 딥러닝 방법들이 개발되었다. 딥러닝 방법들은 감소한 실행시 간과 NLLS 혹은 LLS 방법에 견줄만한 추정 결과를 보여주었다. 하지만 대부분의 방법은 입력 DCE-MRI 영상과 이에 대응하는 라벨 PK 파라미터가 있어야 하는 지도 학습 기반의 방법들이다. 라벨 PK 파라미터는 NLLS 방법 이나 LLS 방법으로 얻어야 하며, 이러한 과정은 많은 시간이 필요할 뿐 아니라, 라벨 데이터의 잡음 수준이 높 으면 지도학습방법의 성능이 감소된다는 단점이 있다. 선행기술문헌 비특허문헌 (비특허문헌 0001) S.-L. Chao, T. Metens, and M. Lemort, \"Tumourmetrics: a comprehensive clinical solution for the standardization of dce-mri analysis in research and routine use,\" Quantitative imaging in medicine and surgery, vol. 7, no. 5, p. 496, 2017. (비특허문헌 0002) B. Sim, G. Oh, J. Kim, C. Jung, and J. C. Ye, \"Optimal transport driven cyclegan for unsupervised learning in inverse problems,\" SIAM Journal on Imaging Sciences, vol. 13, no. 4, pp. 2281-2306, 2020. (비특허문헌 0003) B. Sim, G. Oh, J. Kim, C. Jung, and J. C. Ye, \"Optimal transport driven cyclegan for unsupervised learning in inverse problems,\" SIAM Journal on Imaging Sciences, vol. 13, no. 4, pp.2281-2306, 2020. (비특허문헌 0004) X. Mao, Q. Li, H. Xie, R. Y. Lau, Z. Wang, and S. Paul Smolley, \"Least squares generative adversarial networks,\" in Proceedings of the IEEE international conference on computer vision, 2017, pp. 2794-2802."}
{"patent_id": "10-2022-0084087", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "실시예들은 인공지능을 이용한 뇌관류 및 혈액뇌장벽투과도 맵 예측 방법 및 장치에 관하여 기술하며, 보다 구 체적으로 일반적인 역문제에 적용 가능한 비지도 학습 방법을 기반으로 하여 혈액뇌장벽투과도 맵 예측 기술을 제공한다. 실시예들은 물리적 모델을 적용한 순환 생성적 적대 신경망(cycle-consistency Generative Adversarial Network, cycleGAN) 구조를 이용하여 목표 혈액뇌장벽 맵이 없는 경우에도 학습이 가능한 인공지능을 이용한 뇌 관류 및 혈액뇌장벽투과도 맵 예측 방법 및 장치를 제공하는데 있다."}
{"patent_id": "10-2022-0084087", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "일 실시예에 따른 인공지능을 이용한 뇌관류 및 혈액뇌장벽투과도 맵 예측 방법은, 물리적 모델을 기반으로 한 순환 생성적 적대 신경망(CycleGAN)을 이용하여 비대응 데이터를 기반으로 DCE-MRI(Dynamic Contrast-Enhanced Magnetic Resonance Imaging) 영상으로부터 약동학적(Pharmacokinetic, PK) 파라미터를 추정하도록 학습하는 단계를 포함하여 이루어질 수 있다. 상기 순환 생성적 적대 신경망은, 하나의 생성자 및 하나의 구별자를 포함할 수 있다. 상기 DCE-MRI 영상은 각 조직에서 시간에 따른 조영제 농도 변화를 측정하며, 측정된 상기 조영제 농도 변화로 부터 혈관의 투과도 또는 조직 관류와 연관된 상기 약동학적(PK) 파라미터를 추정할 수 있다. 상기 학습하는 단계는, 상기 순환 생성적 적대 신경망의 생성자를 이용하여 상기 DCE-MRI 영상으로부터 약동학 적(PK) 파라미터를 추정하는 단계; 상기 생성자를 이용하여 추정된 상기 약동학적(PK) 파라미터를 특정 동역학 (Tracer Kinetic, TK) 모델을 이용하여 다시 DCE-MRI 영상으로 되돌리는 단계; 및 상기 동역학(TK) 모델을 이용 하여 되돌린 DCE-MRI 영상과 처음의 상기 생성자의 입력으로 들어간 상기 DCE-MRI 영상을 비교하여 제1 순환 일 관성(cycle-consistency) 손실을 계산하는 단계를 포함할 수 있다. 상기 학습하는 단계는, 상기 순환 생성적 적대 신경망의 특정 동역학(TK) 모델을 이용하여 약동학적(PK) 파라미 터로부터 DCE-MRI 영상을 생성하는 단계; 상기 동역학(TK) 모델을 이용하여 생성한 상기 DCE-MRI 영상을 생성자 의 입력으로 사용하여 약동학적(PK) 파라미터를 추정하는 단계; 및 처음의 상기 약동학적(PK) 파라미터와 상기 생성자가 추정한 약동학적(PK) 파라미터를 비교하여 제2 순환 일관성 손실을 계산하는 단계를 포함할 수 있다. 상기 학습하는 단계는, 상기 순환 생성적 적대 신경망에서 각각 계산된 제1 순환 일관성 손실 및 제2 순환 일관 성 손실을 통해 대응 데이터가 없이도 생성자가 동역학(TK) 모델의 역이 되어 상기 DCE-MRI 영상으로부터 상기 약동학적(PK) 파라미터를 추정하도록 학습하는 단계를 포함할 수 있다. 상기 학습하는 단계는, 구별자를 통해 실제 상기 약동학적(PK) 파라미터와 상기 생성자가 추정한 약동학적(PK) 파라미터를 구분하는 단계를 더 포함할 수 있다. 다른 실시예에 따른 인공지능을 이용한 뇌관류 및 혈액뇌장벽투과도 맵 예측 장치는, 물리적 모델을 기반으로 한 순환 생성적 적대 신경망(CycleGAN)을 이용하여 비대응 데이터를 기반으로 DCE-MRI(Dynamic Contrast- Enhanced Magnetic Resonance Imaging) 영상으로부터 약동학적(Pharmacokinetic, PK) 파라미터를 추정하도록 학습하는 학습부를 포함할 수 있다. 상기 학습부는, 상기 순환 생성적 적대 신경망의 생성자를 이용하여 상기 DCE-MRI 영상으로부터 약동학적(PK) 파라미터를 추정하는 제1 약동학적(PK) 파라미터 추정부; 상기 생성자를 이용하여 추정된 상기 약동학적(PK) 파 라미터를 특정 동역학(Tracer Kinetic, TK) 모델을 이용하여 다시 DCE-MRI 영상으로 되돌리는 제1 DCE-MRI 영상 재생성부; 상기 동역학(TK) 모델을 이용하여 되돌린 DCE-MRI 영상과 처음의 상기 생성자의 입력으로 들어간 상기 DCE-MRI 영상을 비교하여 제1 순환 일관성(cycle-consistency) 손실을 계산하는 제1 순환 일관성 손실 산 정부; 상기 순환 생성적 적대 신경망의 특정 동역학(TK) 모델을 이용하여 약동학적(PK) 파라미터로부터 DCE-MRI 영상을 생성하는 제2 DCE-MRI 영상 재생성부; 상기 동역학(TK) 모델을 이용하여 생성한 상기 DCE-MRI 영상을 생 성자의 입력으로 사용하여 약동학적(PK) 파라미터를 추정하는 제2 약동학적(PK) 파라미터 추정부; 및 처음의 상 기 약동학적(PK) 파라미터와 상기 생성자가 추정한 약동학적(PK) 파라미터를 비교하여 제2 순환 일관성 손실을 계산하는 제2 순환 일관성 손실 산정부를 포함할 수 있다. 또 다른 실시예에 따른 인공지능을 이용한 뇌관류 및 혈액뇌장벽투과도 맵 예측 방법은, 물리적 모델을 기반으 로 한 순환 생성적 적대 신경망(CycleGAN)의 생성자를 이용하여 DCE-MRI(Dynamic Contrast-Enhanced Magnetic Resonance Imaging) 영상으로부터 약동학적(Pharmacokinetic, PK) 파라미터를 추정하는 단계; 상기 생성자를 이용하여 추정된 상기 약동학적(PK) 파라미터를 특정 동역학(Tracer Kinetic, TK) 모델을 이용하여 다시 DCE- MRI 영상으로 되돌리는 단계; 및 상기 동역학(TK) 모델을 이용하여 되돌린 DCE-MRI 영상과 처음의 상기 생성자 의 입력으로 들어간 상기 DCE-MRI 영상을 비교하여 제1 순환 일관성(cycle-consistency) 손실을 계산하는 단계 를 포함할 수 있다."}
{"patent_id": "10-2022-0084087", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "실시예들에 따르면 물리적 모델을 적용한 순환 생성적 적대 신경망(cycle-consistency Generative Adversarial Network, cycleGAN) 구조를 이용하여 목표 혈액뇌장벽 맵이 없는 경우에도 학습이 가능한 인공지능을 이용한 뇌 관류 및 혈액뇌장벽투과도 맵 예측 방법 및 장치를 제공할 수 있다. 실시예들에 따르면 순환 생성적 적대 신경망은 하나의 생성 네트워크와 하나의 판별 네트워크만을 필요로 하여 기존의 순환 생성적 적대 신경망보다 더 빠르고 안정적인 학습이 가능함으로써, 빠르고 정확하게 혈액뇌장벽투 과도 맵을 제공하는 인공지능을 이용한 뇌관류 및 혈액뇌장벽투과도 맵 예측 방법 및 장치를 제공할 수 있다."}
{"patent_id": "10-2022-0084087", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하, 첨부된 도면을 참조하여 실시예들을 설명한다. 그러나, 기술되는 실시예들은 여러 가지 다른 형태로 변 형될 수 있으며, 본 발명의 범위가 이하 설명되는 실시예들에 의하여 한정되는 것은 아니다. 또한, 여러 실시"}
{"patent_id": "10-2022-0084087", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "예들은 당해 기술분야에서 평균적인 지식을 가진 자에게 본 발명을 더욱 완전하게 설명하기 위해서 제공되는 것 이다. 도면에서 요소들의 형상 및 크기 등은 보다 명확한 설명을 위해 과장될 수 있다. 아래의 실시예들은 일반적인 역문제에 적용 가능한 비지도 학습 방법을 기반으로 하여 혈액뇌장벽투과도 맵 예 측을 위한 새로운 방법을 제시한다. 혈액뇌장벽투과도 맵은 동적 조영 증강 자기 공명 영상(Dynamic Contrast Enhanced-Magnetic Resonance Imaging, DCE-MRI)에서 시간에 따른 조영제 농도 변화를 측정하여 예측할 수 있다. 하지만 기존의 예측 방법은 많은 반복과 큰 계산 복잡도, 낮은 정확도라는 단점을 보유하고 있다. 실시예들은 목표 혈액뇌장벽 맵이 없는 경우에도 학습이 가능한 인공지능 기반 방법이다. 실시예들에 따르면 기존의 방법들 혹은 다른 인공지능 기반 의 방법들보다 빠르고 정확하게 혈액뇌장벽투과도 맵을 제공한다. 실시예들은 물리적 모델을 기반으로 한 순환 생성적 적대 신경망 구조를 이용하여 지도 학습 방법과 달리 비대 응 데이터를 이용하여 학습할 수 있다. 구체적으로, 일 실시예에 따른 순환 생성적 적대 신경망은 하나의 생성 네트워크와 하나의 판별 네트워크만을 필요로 하여 기존의 순환 생성적 적대 신경망보다 더 빠르고 안정적인 학 습이 가능하다. 실시예들은 인공지능을 기반으로 하여 기존 반복적 방법보다 더 적은 계산 복잡도로 빠르게 혈액뇌장벽투과도 맵을 예측한다. 또한, 대응 쌍의 데이터를 이용하지 않고도 기존의 인공지능 기반 방법들보다 정확한 예측 결 과를 제공한다. 이와 같이 실시예들에 따르면 빠르고 정확한 혈액뇌장벽투과도 맵 예측이 가능하며, 이를 통해 임상에서 뇌질환 진단에 도움이 되는 정보를 제공할 수 있다. 기존의 방법과 감독 방법의 문제를 해결하기 위해, 여기서는 DCE-MRI에서 PK 파라미터를 직접 추정하기 위한 쌍 이 없는 딥러닝 방법을 제안한다. 실시예들에 따른 방법은 최적의 전송 주도 cycleGAN(OT-CycleGAN)에서 영감 을 얻었으며, 이는 일치하는 입력 및 레이블 쌍이 부족할 때 적용될 수 있다. PK 파라미터에서 DCE-MR 이미지 에 이르는 TK 모델이 알려져 있기 때문에 OT-CycleGAN에는 단일 생성자와 구별자만 있다. 실험에서, 제안된 방 법이 쌍이 없는 데이터셋으로 학습되더라도 지도 학습과 비교하여 경쟁력 있는 성능을 보인다는 것을 보여준다. 아래에서는 먼저 관련 연구에 대해 설명한다. 동역학 모델(TK 모델) 도 1은 일 실시예에 따른 DCEMRI에서 사용되는 두 가지 추적자 운동 모델을 나타내는 도면이다. 보다 구체적으 로, 도 1의 (a)는 확장된 Tofts 모델을 나타내고, (b)는 Patlak 모델을 나타낸다. 동역학(Tracer Kinetic, TK) 모델은 CA 농도와 PK 파라미터 사이의 관계를 나타낸다. 본 실시예에서는 DCE-MRI 에서 광범위하게 사용되는 eTofts 모델과 Patlak 모델 두 가지 TK 모델을 찾아볼 것이다. 1) 확장 Tofts 모델: 확장 Tofts(eTofts) 모델은, 도 1의 (a)에 도시된 바와 같이, 고도의 관류 조직 상태를 가 정하는 TK 모델이다. 즉, eTofts 모델은 무한 혈장의 흐름 조건을 가정한다. eTofts 모델에서 조직 Ct(t)의 CA 농도는 다음과 같이 표시된다. [수학식 1]"}
{"patent_id": "10-2022-0084087", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "여기서, Cp(t)는 혈장 내 CA 농도, vp는 분획 혈장량, ve는 분획 간질(또는 혈관 외 세포 공간)량, Ktrans는 혈장 에서 간질로의 양 전달 상수이다. 따라서 eTofts 모델에서 Ktrans, vp, ve의 세 가지 PK 파라미터를 추정해야 한 다. 2) Patlak 모델: 도 1의 (b)에 도시된 바와 같이, 간질에서 혈장으로 역류하는 것이 무시할 수 있는 경우, eTofts 모델은 다음과 같이 2-파라미터 모델로 단순화시킬 수 있다. [수학식 2]"}
{"patent_id": "10-2022-0084087", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "따라서 이 2-파라미터 모델은 Patlak 모델이라고 불리며, eTofts 모델의 특별한 경우이다. Patlak 모형에서는 Ktrans와 vp가 추정된다. 3) DCE-MRI에 대한 CA 농도: 시계열 DCEMRI 신호 S(t)가 손상된 gradient 에코에 의해 획득된 경우, (비특허문 헌 1)에 의해 CA 농도 Ct(t)로 변환될 수 있다. [수학식 3]"}
{"patent_id": "10-2022-0084087", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 5, "content": "여기서, S0은 사전 대비 영상 강도이고, 는 플립 각도이며, 이다. 여기서, TR은 반복시간, T1은 T1 이완시간, r1은 조영제의 이완시간이다. 반대로, 만약 eTofts 또는 Patlak 모 델에서 나온 Ct(t)로부터 S(t)를 얻기를 원한다면, [수학식 3]은 다음과 같이 변환할 수 있다. [수학식 4]"}
{"patent_id": "10-2022-0084087", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 6, "content": "약동학적 파라미터 추정을 위한 딥러닝 방법 NLLS 또는 LLS 방법은 높은 계산 복잡성을 요구하기 때문에 PK 파라미터 추정을 위한 딥러닝 방법이 연구되었다. 기존에 동적 민감성 증강 MRI(DSC-MRI)에서 AIF를 변환하기 위한 조건부 적대적 생성망이 제안되 었다. T1-가중 DCE-MRI는 T2-가중 DSC-MRI에 비해 낮은 신호 강도를 나타내기 때문에 DSC-MRI의 AIF는 DCE- MRI의 AIF보다 신뢰성이 높다. 추정된 PK 파라미터의 신뢰성이 향상되었음을 확인했다. 그러나 딥러닝으로 PK 파리미터를 직접 추정하는 방법은 아니다. 또한, 기존에 PK 파라미터를 직접 추정하기 위한 컨볼루션 신경망(Convolutional Neural Network, CNN)이 제안 되었다. 이러한 작업에서, 그들은 로컬 및 글로벌 경로와 forward 물리적 손실을 가진 CNN을 사용했으며, 제안 된 방법이 NLLS 또는 LLS 방법에 비해 신뢰할 수 있는 결과와 줄어든 런타임을 보여준다는 것을 입증했다. 그 러나 둘 다 입력 DCE-MR 영상 쌍과 일치하는 레이블 PK 파라미터 맵이 필요한 지도 학습을 기반으로 한다. 지 도 방법을 학습하기 위한 이러한 PK 파라미터 맵은 NLLS 또는 LLS 방법을 통해 획득해야 한다. 따라서 레이블 데이터를 수집하려면 긴 추정 시간이 필요하거나 데이터의 품질이 저하된 것으로 나타난다. 이 문제를 해결하 기 위해, 실시예들은 물리적 주도 CycleGAN을 사용하여 PK 파리미터를 직접 추정하기 위한 쌍이 없는 딥러닝 방 법을 제안한다. 최적 전송 주도 CycleGAN 최근 연구(비특허문헌 2, 3)에서 CycleGAN의 아키텍처가 최적의 전송 문제의 이중 공식과 관련이 있다는 것이 밝혀졌다. 여기에서는 상기 연구 이론에 대한 간략한 검토를 제공한다. 다음 측정 모델을 고려한다. [수학식 5]"}
{"patent_id": "10-2022-0084087", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 7, "content": "여기서, x X와 y Y는 각각 알 수 없는 이미지와 노이즈를 가지는 측정을 의미하며, 는 알려진 결정론적 이미지 연산자이다. 지도 학습의 목표는 이미지 x와 측정 y 쌍 사이 의 관계를 배우는 것이다. 그러나 쌍이 없는 학습에서는 일치하는 이미지-측정 쌍이 없다. 따라서 쌍이 없는 학습의 목표는 쌍이 없는 이미지 및 측정 집합의 각 개별 샘플이 아닌 확률 분포를 일치시키는 것이다. 이것은 두 공간 사이의 확률 분포를 전달하는 전송 맵을 찾는 것으로 이루어질 수 있다. 특히, 대상 영상 공간 X와 측정 공간 Y에 각각 확률 측정 및 가 장착되어 있다고 가정한다. 에 서 로의 질량 전송은 forward 연산자 에 의해 수행되고, 에서 로의 질량 전송은 에 의해 파라미터화된 생성자 에 의해 수행된다. 따라서 최적의 전송 문제에 대해 다음과 같은 전송 비용이 제안된다(비특허문헌 2). [수학식 6]"}
{"patent_id": "10-2022-0084087", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 8, "content": "이는 각 공간에서 학습 샘플과 전송된 샘플 사이의 거리의 합을 나타낸다. [수학식 6]을 사용하여 샘플별 비용 을 최소화하는 대신, 최적의 전송 목표는 평균 전송 비용을 최소화하는 것이다. 보다 구체적으로, 최적 전송 문제는 최소 평균 전송 비용을 주도하는 공동 분포 를 찾기 위해 공식화된다. [수학식 7]"}
{"patent_id": "10-2022-0084087", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 9, "content": "여기서, 는 X와 Y의 주변 분포가 각각 와 인 공동 측정 집합이다. [수학식 6]의 전송 비용을 사용하여, 칸토로비치 이중 공식은 (비특허문헌 2)로 주어진다. [수학식 8]"}
{"patent_id": "10-2022-0084087", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 10, "content": "[수학식 9] 여기서, 이다. 여기서, 는 적절한 하이퍼파라미터이고, 은 cycle consistency 손실이고, 은 WGAN(Wasserstein GAN) 손실이다. 보다 구체적으로, 과 은 다음과 같이 주어진다.[수학식 10]"}
{"patent_id": "10-2022-0084087", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 11, "content": "[수학식 11]"}
{"patent_id": "10-2022-0084087", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 12, "content": "forward 연산자 가 알려져 있기 때문에 단일 구별자 만 존재하므로 forward 연산자와 경쟁할 필요가 없 다. 이것은 CycleGAN 아키텍처를 단순하게 만든다. 도 2a는 일 실시예에 따른 인공지능을 이용한 뇌관류 및 혈액뇌장벽투과도 맵 예측 방법을 나타내는 흐름도이다. 또한, 도 2b는 일 실시예에 따른 DCE-MRI 영상으로부터 약동학적(PK) 파라미터를 추정하도록 학습 하는 방법을 나타내는 흐름도이다. 도 2a를 참조하면, 일 실시예에 따른 인공지능을 이용한 뇌관류 및 혈액뇌장벽투과도 맵 예측 방법은, 물리적 모델을 기반으로 한 순환 생성적 적대 신경망(CycleGAN)을 이용하여 비대응 데이터를 기반으로 DCE-MRI(Dynamic Contrast-Enhanced Magnetic Resonance Imaging) 영상으로부터 약동학적(Pharmacokinetic, PK) 파라미터를 추 정하도록 학습하는 단계(S110)를 포함하여 이루어질 수 있다. 도 2b를 참조하면, 학습하는 단계(S110)는, 순환 생성적 적대 신경망의 생성자를 이용하여 DCE-MRI 영상으로부 터 약동학적(PK) 파라미터를 추정하는 단계(S111), 생성자를 이용하여 추정된 약동학적(PK) 파라미터를 특정 동 역학(Tracer Kinetic, TK) 모델을 이용하여 다시 DCE-MRI 영상으로 되돌리는 단계(S112), 및 동역학(TK) 모델 을 이용하여 되돌린 DCE-MRI 영상과 처음의 생성자의 입력으로 들어간 DCE-MRI 영상을 비교하여 제1 순환 일관 성(cycle-consistency) 손실을 계산하는 단계(S113)를 포함할 수 있다. 또한, 학습하는 단계(S110)는, 순환 생성적 적대 신경망의 특정 동역학(TK) 모델을 이용하여 약동학적(PK) 파라 미터로부터 DCE-MRI 영상을 생성하는 단계(S114), 동역학(TK) 모델을 이용하여 생성한 DCE-MRI 영상을 생성자의 입력으로 사용하여 약동학적(PK) 파라미터를 추정하는 단계(S115), 및 처음의 약동학적(PK) 파라미터와 생성자 가 추정한 약동학적(PK) 파라미터를 비교하여 제2 순환 일관성 손실을 계산하는 단계(S116)를 포함할 수 있다. 또한, 학습하는 단계(S110)는, 순환 생성적 적대 신경망에서 각각 계산된 제1 순환 일관성 손실 및 제2 순환 일 관성 손실을 통해 대응 데이터가 없이도 생성자가 동역학(TK) 모델의 역이 되어 DCE-MRI 영상으로부터 약동학적 (PK) 파라미터를 추정하도록 학습하는 단계(S117)를 포함할 수 있다. 또한, 학습하는 단계(S110)는, 구별자를 통해 실제 약동학적(PK) 파라미터와 생성자가 추정한 약동학적(PK) 파 라미터를 구분하는 단계(S118)를 더 포함할 수 있다. 한편, 다른 실시예에 따른 인공지능을 이용한 뇌관류 및 혈액뇌장벽투과도 맵 예측 방법은, 물리적 모델을 기반 으로 한 순환 생성적 적대 신경망(CycleGAN)의 생성자를 이용하여 DCE-MRI(Dynamic Contrast-Enhanced Magnetic Resonance Imaging) 영상으로부터 약동학적(Pharmacokinetic, PK) 파라미터를 추정하는 단계, 생성자 를 이용하여 추정된 약동학적(PK) 파라미터를 특정 동역학(Tracer Kinetic, TK) 모델을 이용하여 다시 DCE-MRI 영상으로 되돌리는 단계, 및 동역학(TK) 모델을 이용하여 되돌린 DCE-MRI 영상과 처음의 생성자의 입력으로 들 어간 DCE-MRI 영상을 비교하여 제1 순환 일관성(cycle-consistency) 손실을 계산하는 단계를 포함할 수 있다.또한, 순환 생성적 적대 신경망의 특정 동역학(TK) 모델을 이용하여 약동학적(PK) 파라미터로부터 DCE-MRI 영상 을 생성하는 단계, 동역학(TK) 모델을 이용하여 생성한 DCE-MRI 영상을 생성자의 입력으로 사용하여 약동학적 (PK) 파라미터를 추정하는 단계, 및 처음의 약동학적(PK) 파라미터와 생성자가 추정한 약동학적(PK) 파라미터를 비교하여 제2 순환 일관성 손실을 계산하는 단계를 포함할 수 있다. 또한, 순환 생성적 적대 신경망에서 각각 계산된 제1 순환 일관성 손실 및 제2 순환 일관성 손실을 통해 대응 데이터가 없이도 생성자가 동역학(TK) 모델의 역이 되어 DCE-MRI 영상으로부터 약동학적(PK) 파라미터를 추정하 도록 학습할 수 있다. 또한, 구별자를 통해 실제 약동학적(PK) 파라미터와 생성자가 추정한 약동학적(PK) 파라미터를 구분하는 단계를 더 포함할 수 있다. DCE-MRI에서 획득할 수 있는 약동학적(PK) 파라미터는 혈관 투과성 또는 조직 관류에 대한 정보를 제공한다. 약동학적 파라미터는 동역학(TK) 모델을 적합시켜 추정할 수 있지만, 이러한 기존 방법은 노이즈가 많은 동맥 입력 기능으로 인해 계산 복잡도가 낮고 정확도가 낮아야 한다. 이 문제를 해결하기 위해 일부 딥러닝 방법이 제안되었지만, 대부분의 기존 방법은 지도 학습을 기반으로 하며 입력 DCE-MRI와 레이블 PK 파라미터 맵의 일치 하는 쌍이 필요하다. 레이블 데이터를 획득하는 데 오랜 시간이 걸리고 레이블 데이터에 높은 노이즈 수준이 포함될 수 있기 때문에 지도 학습 방법을 실제로 적용하기는 어렵다. 이러한 문제를 해결하기 위해, 물리적 주도 CycleGAN을 사용하여 약물 동태학적 파라미터 추정을 위한 새로운 쌍이 없는 딥러닝 방법을 제안한다. 제안된 CycleGAN은 물리적 모델을 기반으로 하기 때문에 생성자와 구별자 의 한 쌍만 포함한다. 또한, 실험 결과로부터, 제안된 방법이 물리적 모델을 반영하여 다른 방법보다 더 신뢰 할 수 있는 약동학적 파라미터를 제공한다는 것을 검증한다. 일 실시예에 따른 인공지능을 이용한 뇌관류 및 혈액뇌장벽투과도 맵 예측 방법은 일 실시예에 따른 인공지능을 이용한 뇌관류 및 혈액뇌장벽투과도 맵 예측 장치를 예를 들어 설명할 수 있다. 도 3은 일 실시예에 따른 인공지능을 이용한 뇌관류 및 혈액뇌장벽투과도 맵 예측 장치를 나타내는 블록도이다. 도 3을 참조하면, 일 실시예에 따른 인공지능을 이용한 뇌관류 및 혈액뇌장벽투과도 맵 예측 장치는 학습부 를 포함할 수 있다. 여기서, 학습부는 제1 약동학적(PK) 파라미터 추정부, 제1 DCE-MRI 영상 재생성부, 제1 순환 일관성 손실 산정부, 제2 DCE-MRI 영상 재생성부, 제2 약동학적(PK) 파라미 터 추정부, 제2 순환 일관성 손실 산정부를 포함할 수 있다. 학습부는 물리적 모델을 기반으로 한 순환 생성적 적대 신경망(CycleGAN)을 이용하여 비대응 데이터를 기 반으로 DCE-MRI(Dynamic Contrast-Enhanced Magnetic Resonance Imaging) 영상으로부터 약동학적 (Pharmacokinetic, PK) 파라미터를 추정하도록 학습할 수 있다. DCE-MRI 영상은 각 조직에서 시간에 따른 조영 제 농도 변화를 측정하며, 측정된 조영제 농도 변화로부터 혈관의 투과도 또는 조직 관류와 연관된 약동학적 (PK) 파라미터를 추정할 수 있다. 여기서, 순환 생성적 적대 신경망은 하나의 생성자 및 하나의 구별자를 포함할 수 있다. 제1 약동학적(PK) 파라미터 추정부는 순환 생성적 적대 신경망의 생성자를 이용하여 DCE-MRI 영상으로부터 약동학적(PK) 파라미터를 추정할 수 있다. 제1 DCE-MRI 영상 재생성부는 생성자를 이용하여 추정된 약동학적(PK) 파라미터를 특정 동역학(Tracer Kinetic, TK) 모델을 이용하여 다시 DCE-MRI 영상으로 되돌릴 수 있다. 제1 순환 일관성 손실 산정부는 동역학(TK) 모델을 이용하여 되돌린 DCE-MRI 영상과 처음의 생성자의 입력 으로 들어간 DCE-MRI 영상을 비교하여 제1 순환 일관성(cycle-consistency) 손실을 계산할 수 있다. 또한, 제2 DCE-MRI 영상 재생성부는 순환 생성적 적대 신경망의 특정 동역학(TK) 모델을 이용하여 약동학 적(PK) 파라미터로부터 DCE-MRI 영상을 생성할 수 있다. 제2 약동학적(PK) 파라미터 추정부는 동역학(TK) 모델을 이용하여 생성한 DCE-MRI 영상을 생성자의 입력으 로 사용하여 약동학적(PK) 파라미터를 추정할 수 있다. 제2 순환 일관성 손실 산정부는 처음의 약동학적(PK) 파라미터와 생성자가 추정한 약동학적(PK) 파라미터 를 비교하여 제2 순환 일관성 손실을 계산할 수 있다. 학습부는 순환 생성적 적대 신경망에서 각각 계산된 제1 순환 일관성 손실 및 제2 순환 일관성 손실을 통 해 대응 데이터가 없이도 생성자가 동역학(TK) 모델의 역이 되어 DCE-MRI 영상으로부터 약동학적(PK) 파라미터 를 추정하도록 학습할 수 있다. 또한, 학습부는 구별자를 통해 실제 약동학적(PK) 파라미터와 생성자가 추정한 약동학적(PK) 파라미터를 구분할 수 있다. 생성자의 학습 단계에서는 구별자를 속일 수 있도록 학습하는 반면, 생성자의 학습 단계에서 는 진짜와 가짜를 구별할 수 있도록 학습한다. 이러한 경쟁적 학습을 통해 생성자는 더 사실적인 약동학적(PK) 파라미터를 추정할 수 있다. 기존에는 비선형 최소 제곱법을 이용하여 혈액뇌장벽투과도 맵을 예측하였지만 높은 계산 복잡도로 인하여 긴 시간이 요구된다. 실시예들에 따르면, 훨씬 빠른 속도로 혈액뇌장벽 투과도 맵 예측이 가능하다. 즉, 실시예 들은 비선형 최소 제곱법과 같은 반복적 방법이 아닌 인공지능을 적용하여 낮은 계산 복잡도에서 빠른 시간 내 에 혈액뇌장벽투과도 맵을 복원할 수 있다. 또한, 기존에는 지도 학습 기반의 인공지능 방법으로 학습을 위해 목표 혈액뇌장벽투과도 맵을 필요로 하는 반 면, 실시예들에 따르면 비대응 데이터를 이용하여 학습이 가능하다. 즉, 실시예들은 동적 조영 증강 자기 공명 영상에 대응하는 혈액뇌장벽투과도 맵이 없는 경우에도 학습이 가능한 비지도 학습 기반의 방법이다. 아래에서는 PK 파라미터 추정에 최적의 전송 기반 CycleGAN을 적용한다. 여기에서는 시계열 DCE-MRI 신호 와 PK 파라미터 맵 가 각각 측정 및 관찰되지 않은 이미지에 해당한다. 특히, PK 파라미터 맵에서 DCE-MRI로의 forward 모델은 다음과 같이 공식화될 수 있다. [수학식 12]"}
{"patent_id": "10-2022-0084087", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 13, "content": "여기서, fTK는 TK 모델(eTofts 또는 Patlak)과 [수학식 4]에 의해 구성된 함수이다. 를 식별함으로써 [수학식 10]에서의 cycle consistency 손실과 [수학식 11]에서의 WGAN 손실을 다음과 같이 나타낼 수 있다. [수학식 13]"}
{"patent_id": "10-2022-0084087", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 14, "content": "[수학식 14]"}
{"patent_id": "10-2022-0084087", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 15, "content": "이러한 OT-CycleGAN의 직접 적용은 PK 파라미터 추정에 사용될 수 있지만, 더 나은 성능을 위해 일부 손실 함수 를 수정하거나 추가한다. 첫째, WGAN을 사용하는 대신 보다 안정적인 교육을 위해 LSGAN(최소 제곱 GAN)(비특 허문헌 4)을 사용한다. WGAN과 LSGAN 사이의 연결은 이전 연구에서 설명되었다(비특허문헌 3). 다음으로 PK 파 라미터 맵의 노이즈를 줄이기 위해 총 변동(TV) 손실 및 L1 정규화를 추가한다.[수학식 15]"}
{"patent_id": "10-2022-0084087", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 16, "content": "[수학식 16]"}
{"patent_id": "10-2022-0084087", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 17, "content": "여기서, 는 gradient 연산자이다. 따라서 최종 손실 함수는 다음과 같이 공식화할 수 있다. [수학식 17]"}
{"patent_id": "10-2022-0084087", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 18, "content": "여기서, 는 적합한 하이퍼파라미터이다. [수학식 17]에 추가 손실이 있지만 [수학식 15]와 [수학식 16]의 추가 손실은 주변 분포에 대한 평균 값이기 때문에 최적 전송 해석에 영향을 미치지 않는다. 보다 구체 적으로, [수학식 17]의 최종 손실 함수는 [수학식 7]의 최적 전송 문제의 이중 공식으로 다음과 같은 전송 비용 과 함께 얻을 수 있다. [수학식 18]"}
{"patent_id": "10-2022-0084087", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 19, "content": "아래에서는 실험 방법의 예시를 설명한다. 실험 데이터셋 실시예들에 따른 실험에서, 건국대학교병원에서 획득한 두 개의 데이터셋을 사용한다. 두 데이터셋 모두에 대 해 이완률(relaxation rate)이 r1 = 3.47 mM-1s-1인 가도부트롤 조영제를 사용하였다. 네 번째 동적 스캔 후 자 동주입기를 이용하여 가도부트롤 표준 용량(0.1 mmol/kg 체중, Bayer Healthcare)을 2 mL/s의 유량으로 주입후 30mL 식염수를 주입하였다. 또한, 역동적 파라미터 계산을 위한 T1 불균일성 보정을 위한 T1 매핑은 6개의 서로 다른 플립 각도(2-12°)를 갖는 사전 대비 T1 가중 gradient 에코 계열을 사용하여 생성되었다. 1) 뇌종양의 DCE-MRI: 첫 번째 데이터셋('종양 데이터')는 뇌종양 환자로부터 획득되었다. DCE 이미지 촬영의 경우, 축 3D DCE 시퀀스는 다음 파라미터를 사용하여 65개 개별 스캔의 동적 계열로 획득되었다. 여기서, TR = 2.80ms, TE = 0.90ms, 숙임각= 10°, 평균 = 1, FOV = 222 Х 240 mm2, 슬라이스 두께 = 4mm, 획득 행렬 = 160 x 148, 복셀 크기 = 0.75 x 0.75 x 4.00mm3, 획득 시간 7분, 시간 해상도 = 6.5s 이다. 2) 치매진단을 위한 정상인과 인지장애군의 DCE-MRI: 두 번째 데이터셋('MCI 데이터')는 정상 및 경도인지 장애 (mild cognitive impairment, MCI) 피험자로부터 획득되었다. 60개의 개별 스캔으로 구성된 동적 계열의 3D DCE 관상면 시퀀스를 획득하는 데 사용된 파라미터는 다음과 같다. 여기서, TR = 3.72ms, TE = 1.04ms, 플립 각도 = 10°, 평균 = 1, 시야 = 225 x 240mm2, 슬라이스 두께 = 3mm, 획득 행렬 = 180 x 192, 복셀 크기 = 1.25 x 1.25 x 3.00mm3, 획득 시간 = 10분, 시간 해상도 = 10s 이다. 환자의 수용 상태와 수학적 모델링을 모 두 고려하여 획득 시간 10분을 사용했다. DCE 이미지 촬영을 위한 관상면은 전교련과 후교련 선에 수직이었다. 해마와 측두엽은 관상면의 슬라이스를 사용하여 가장 잘 평가되기 때문에 스캔은 관상면에서 얻었다.3) DCE-MRI 분석: DCE 영상 데이터의 후 처리 및 관심 영역 선택은 구조 이미지 촬영에 사용되는 T1 체적영상도 포함하여 NordicICE 소프트웨어(버전 4.1.3)에 의해 수행되었다. 이 분석은 임상최종진단에 맹검으로 연구원(3 년 경력)이 신경방사선 전문의(신경영상 20년 경력)의 지도 아래 수행했다. 동맥 입력 함수(Arterial Input Function, AIF)는 NordicICE 소프트웨어에서 반자동 방법을 사용하여 얻었다. 움직임 보정 및 노이즈 변조 후 AIF 검색 박스를 이용한 자동 검출을 적용했다. AIF 검색 박스는 첫 번째 데이터셋의 축 슬라이스 상의 내부 경동맥 영역과 두 번째 데이터셋의 관상 공간 상의 상 시상정맥동 영역에 각각 배치되었다. 최종 AIF 곡선은 검색 박스 내에서 1~5개의 서로 다른 곡선(최대 5픽셀)의 평균을 계산하여 결정되었다. 각 환자에 대해 예상 입력 함수 속성(낮은 첫 번째 모멘트, 높은 피크 향상, 곡선 아래의 넓은 영역 만족)을 보여주는 첫 번째(두 번 째) 데이터셋에 대해 3-5개(1-5개) 픽셀 시간 곡선을 선택했다. AIF를 얻은 후, 측정된 AIF는 Cb(t)이고 Hct가 혈액 헤마토크리트인 Cp(t) = Cb(t)/(1-Hct) 방정식에 의해 AIF를 혈장 농도로 변환하였다. 이전 연구와 같이 Hct = 0.45를 사용하였다. eTofts 투과성 모델은 조직 내 표준 DCE 관류 파라미터를 추정하기 위해 두 데이터셋에 모두 사용되었다. eTofts 모델에서 도출된 Ktrans, vp, ve의 맵은 AIF를 획득한 후 계산되었다. 반면, 두 번째 데이터셋에 Patlak 모델을 사용했는데, 이는 낮은 누출 조건에 가장 적합한 것으로 간주되기 때문이다. 두 파라미터인 Ktrans와 vp 는 Patlak 모델에 대해 계산되었다. NordicICE 소프트웨어에서 LLS 방법은 PK 파라미터를 추정하기 위해 사용 된다. 네트워크 아키텍처 위와 같은 기존의 방법 혹은 지도 학습 방법의 문제를 해결하기 위해, 본 실시예에서는 비대응 학습을 기반으로 한 PK 파라미터 추정 딥러닝 방법을 제안하였다. 실시예들은 대응 데이터 쌍이 없을 때 적용 가능한 최적 운송 유도 cycleGAN(optimal transport driven cycleGAN, OT-CycleGAN)을 기반으로 한 방법이다. 도 4는 일 실시예에 따른 PK 파라미터 추정을 위한 CycleGAN 아키텍처를 나타내는 도면이다. 도 4를 참조하면, CycleGAN의 윗부분은 생성자(generator, )를 이용해 DCE-MRI 영상으로부터 PK 파라미 터를 추정하는 것에서 시작한다. 생성자를 이용해 추정된 PK 파라미터는 특정 TK 모델(eTofts 모델, Patlak 모델 등)을 이용해 다시 DCE-MRI 영상으로 되돌아간다. 이렇게 되돌아온 DCE-MRI 영상과 처음 생 성자의 입력으로 들어간 DCE-MRI 영상을 비교하여 순환 일관성(cycle-consistency) 손실을 계산한다. CycleGAN의 아랫부분에서는 TK 모델을 이용해 PK 파라미터로부터 DCE-MRI 영상을 만들어낸다. 여기서, 사 용하는 PK 파라미터는 CycleGAN의 윗부분에서 사용한 DCE-MRI 영상과 대응하지 않는 데이터이다. 이후, TK 모 델을 이용해 만들어진 DCE-MRI를 생성자의 입력으로 사용해 PK 파라미터를 추정한 뒤, 처음 PK 파라 미터와 생성자가 추정한 PK 파라미터를 비교하여 순환 일관성 손실을 계산한다. CycleGAN의 윗부분과 아랫부분에서 각각 계산된 순환 일관성 손실을 통해 대응 데이터가 없이도 생성자가 TK 모 델의 역이 되어 DCE-MRI 영상으로부터 PK 파라미터를 추정하도록 학습이 가능하다. 마지막으로, 구별자(discriminator, )는 실제 PK 파라미터와 생성자가 추정한 PK 파라미터를 구분 하는 역할을 한다. 생성자의 학습 단계에서는 구별자를 속일 수 있도록 학습하는 반면, 생성자(41 0)의 학습 단계에서는 진짜와 가짜를 구별할 수 있도록 학습한다. 이러한 경쟁적 학습을 통해 생성자는 더 사실적인 PK 파라미터를 추정할 수 있다. PK 파라미터에서 DCE-MRI에 이르는 물리적 모델은 [수학식 1], [수학식 2] 및 [수학식 4]의 방정식에 의해 결정 적이기 때문에, 실시예들에 따른 CycleGAN은 생성자 1개와 구별자 1개만 있는 반면, vanilla CycleGAN은 생성자와 구별자 2개가 있다. PK 파라미터 맵에서 DCE-MRI 신호를 생성하려면 사전 대비 이미지 강 도 S0, T1 맵, 혈장 Cp 내의 CA 농도 및 반복 시간, 플립 각도, 시간 프레임 간 시간 간격, 조영제의 이완성과 같은 스캔 파라미터가 필요하다. 반면, 생성자는 시계열 DCE-MRI만 입력으로 요구하므로 T1 또는 Cp와 같 은 추가 정보를 추론 시간에 측정할 필요가 없다. 도 5는 일 실시예에 따른 CycleGAN에 이용한 생성자 아키텍처를 나타내는 도면이다. 도 5를 참조하면, DCE-MRI 영상은 시간 순서대로 채널 방향으로 합쳐져 생성자의 입력이 된다. 생성자의 첫 번째 층은 DCE-MRI 영상으로부터 특징을 뽑아낸다. 이후, 로컬 경로와 글로벌 경로로 나누 어져 각각 좁은 범위와 넓은 범위에서 특징을 뽑아낸다. 이렇게 각각 추출된 특징을 합쳐 몇 개의 층(530, 540)을 거친 뒤 마지막 층에서 추정한 PK 파라미터가 나오게 된다. 보다 구체적으로, DCE-MRI의 시간 프레임은 채널 차원을 따라 연결되며, 입력 Cin의 채널 수는 시간 프레임 수이다. 첫째, 컨볼루션 계층은 입력에서 특징을 추출한다. 그런 다음, 생성자는 이전 연구의 생성자와 같이 두 개의 경로로 분할된다. 로컬 경로에서 로컬 영역의 세부 사항은 3 x 3 컨볼루션 계층에 의해 추 출된다. 반면, 글로벌 경로는 서로 다른 확장을 가진 세 개의 확장된 컨볼루션 계층으로 구성되므로 글로 벌 정보는 글로벌 경로에 의해 캡처될 수 있다. 로컬 및 글로벌 경로(520, 521)를 통과한 후 두 특징이 연결된다. 최종적으로, PK 파라미터 맵은 세 개의 1 x 1 컨볼루션 계층(530, 540, 550)에 의해 추정된다. 출 력 Cout의 채널 수는 추정할 파라미터의 수이다. 따라서 Cout은 eTofts 모델의 경우 3이고, Patlak 모 델의 경우 2이다. 구별자의 경우 PatchGAN 구별자를 사용한다. 구별자는 4 x 4 컨볼루션, 인스턴스 정규화 및 누출 ReLU 활성화 로 구성된다. 구별자의 초기 필터 수는 32로 설정된다. 구현 세부 정보 학습을 위해 DCE-MR 이미지 또는 PK 파라미터 맵에서 작은 패치를 잘라냈다. 패치의 크기는 64 x 64로 설정되 었으며 모든 학습 단계에서 패치가 임의의 위치에서 잘렸다. 데이터 확대를 위해 무작위 플립이 사용되었다. 또한 파라미터의 범위를 일치시키기 위해 PK 파라미터는 적절한 요인에 의해 조정되었다. 이전 연구를 기준으 로 eTofts 모델에서는 Ktrans, vp, ve를 5, 10, 5/3로 스케일링하였고, Patlak 모델에서는 Ktrans와 vp를 각각 50, 5로 스케일링하였다. 반면, 전체 DCE-MR 이미지는 추론 중에 네트워크에 공급되었다. 방정식 [수학식 17]에서 = 10, = 0.001, = 0.001을 선택했다. = 0.5, = 0.999의 Adam optimizer와 8의 배치 크기를 사용하여 네트워크를 학습시켰다. 초기 학습 속도를 10-4로 설정하고 코사인 학습 속도 감소를 사용하였다. 실시예들에 따른 cycleGAN은 500 epoch를 위해 학습되었으며, PyTorch에 의해 Python 으로 구현되었다. 비교 방법 제안된 방법을 검증하기 위해 두 가지 유형의 지도 학습 방법을 사용한다. 먼저, 다음과 같이 간단한 L1 손실 로 지도된 방법을 학습했다. [수학식 19]"}
{"patent_id": "10-2022-0084087", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 20, "content": "여기서, 는 네트워크의 출력과 실측 정보 사이의 L1 손실이며, 는 적절한 파라미터이다. 공정한 비교를 위해 = 0.001 및 = 0.001의 지도 학습에 TV 손실 및 L1 정규화를 사용한다. 지도 학습의 L1 손실이 CycleGAN의 cycle consistency 손실과 유사하기 때문에 = 10을 선택한다. 또한, CycleGAN의 생성자와 동일한 네트워크 아키텍처 및 기타 하이퍼파라미터를 사용한다. 또한, PK 파라미터 추정에 대한 기존 방법과 마찬가지로 물리적 모델을 지도 학습 방법에 적용했다. 물리적 모 델을 지도 방법에 적용함으로써, 물리적 모델에 대한 지도 방법에서의 충실도인 DCE 이미지의 시계열을 네트워 크와 물리적 모델([수학식 1], [수학식 2] 및 [수학식 4])의 출력과 함께 재구성한다. 그런 다음 추가 손실인가 계산되므로 물리적 모델을 사용한 지도 학습은 다음과 같은 손실로 학습된다. [수학식 20]"}
{"patent_id": "10-2022-0084087", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 21, "content": "여기서, 는 입력 DCE 이미지와 재구성된 DCE 이미지 사이의 L1 손실이다. = 10으로 선택하고 물리적 모델 없이 지도 학습과 동일한 설정을 사용한다. 도 6은 일 실시예에 따른 지도 방법의 전체적인 흐름 을 나타내는 도면이다. 도 6을 참조하면, 지도 학습(Supervised) 및 물리적 모델을 적용한 지도 학습 방 법(Supervised(physics))을 나타낸다. 정량적 평가 LLS 방법의 PK 파라미터 맵이 방법 학습에 사용되지만 AIF 또는 기타 측정된 파라미터의 정확도가 낮을 경우 LLS 방법의 파라미터를 신뢰할 수 없는 경우가 있다. 따라서 LLS 방법과 딥러닝 방법을 직접 비교하는 정량적 평가는 LLS 방법의 정확도 저하를 반영하지 않기 때문에 적절한 방법이 아니다. 딥러닝 방식이 LLS 방식보다 물리적 모델을 더 잘 반영하고 개선된 결과를 보여도 정량적 결과는 좋지 않을 수 있다. 따라서 LLS 방법의 물 리적 모델과 PK 파라미터를 기반으로 시뮬레이션된 DCE 시계열 이미지를 생성했다. 시뮬레이션된 데이터는 물 리적 모델을 기반으로 생성되므로 시뮬레이션된 데이터가 입력되는 딥러닝 방법은 물리적 모델을 잘 반영하기 때문에 LLS 방법과 유사한 결과를 보여야 한다. 따라서 시뮬레이션된 데이터를 사용하여 딥러닝 방법을 정량적 으로 평가했다. 정량적 메트릭의 경우 피크 신호 대 잡음비(PSNR)와 구조적 유사성 지수 측정(SSIM)을 사용했 다. 도 7은 일 실시예에 따른 다양한 PK 파라미터 추정 방법들의 추정 결과를 나타내는 도면이다. 실시예들에 따른 PK 파라미터 추정 방법의 성능을 비교하기 위해, 도 7에 도시된 바와 같이, LLS 방법, 지도 학 습(Supervised), 물리적 모델을 적용한 지도 학습 방법(Supervised(physics))과 개발한 방법의 결과를 비교한다. 확대된 결과에서 보이는 것처럼, 제안한 방법은 종양 부위의 microenvironmental heterogeneity를 가장 잘 반영하고 있다. 반면, 지도 학습 기반의 방법은 종양의 특성을 반영한 결과를 보여주지 못하고 있다. 특히 지도 학습 방법을 통해 추정된 vp는 다른 방법과 달리 매우 낮은 값을 보여주고 있다. 물리적 모델을 적용 한 지도 학습 방법은 일반적인 지도 학습 방법보다는 더 나은 결과를 보여주지만, 제안한 방법보다는 종양의 특 징을 잘 나타내지 못한다. 혈액뇌장벽투과도 맵은 동적 조영 증강 자기 공명 영상(DCE-MRI)에서 시간에 따른 조영제 농도 변화를 측정하여 예측할 수 있다. 하지만 기존의 예측 방법은 많은 반복과 큰 계산 복잡도, 낮은 정확도라는 단점을 보유하고 있다. 본 실시예에서 제시한 기술은 물리적 모델을 적용한 순환 생성적 적대 신경망(cycleGAN) 구조를 이용하 여 목표 혈액뇌장벽 맵이 없는 경우에도 학습이 가능한 인공지능을 이용한 방법이다. 실시예들에 따르면 기존 의 방법들 혹은 다른 인공지능 기반의 방법들보다 빠르고 정확하게 혈액뇌장벽투과도 맵을 제공한다. 혈액뇌장벽투과도 맵은 인지장애, 알츠하이머 병과 같은 다양한 뇌 질환과 연관되어 있기 때문에 혈액뇌장벽투 과도 맵은 빠르고 정확하게 복원하여 환자의 진단 및 예후 관리에 많은 정보와 도움을 제공할 수 있다. 혈액뇌장벽투과도 맵은 뇌질환 진단에 중용한 정보를 제공함에 따라 이를 정확하게 예측하는 것이 최근 중요한 연구 주제로 떠오르고 있다. 하지만 기존의 복원 방법들은 큰 계산 복잡도, 목표 혈액뇌장벽투과도 맵 획득으 로 인한 시간 소요, 낮은 정확도 등의 한계점이 존재한다. 실시예들에 따르면 비대응 데이터를 이용하여 학습 이 가능하며 물리적 모델을 적용하여 더 정확한 투과도 맵 예측이 가능하다. 이상에서 설명된 장치는 하드웨어 구성요소, 소프트웨어 구성요소, 및/또는 하드웨어 구성요소 및 소프트웨어 구성요소의 조합으로 구현될 수 있다. 예를 들어, 실시예들에서 설명된 장치 및 구성요소는, 예를 들어, 프로 세서, 컨트롤러, ALU(arithmetic logic unit), 디지털 신호 프로세서(digital signal processor), 마이크로컴 퓨터, FPA(field programmable array), PLU(programmable logic unit), 마이크로프로세서, 또는 명령 (instruction)을 실행하고 응답할 수 있는 다른 어떠한 장치와 같이, 하나 이상의 범용 컴퓨터 또는 특수 목적 컴퓨터를 이용하여 구현될 수 있다. 처리 장치는 운영 체제(OS) 및 상기 운영 체제 상에서 수행되는 하나 이상 의 소프트웨어 애플리케이션을 수행할 수 있다. 또한, 처리 장치는 소프트웨어의 실행에 응답하여, 데이터를 접근, 저장, 조작, 처리 및 생성할 수도 있다. 이해의 편의를 위하여, 처리 장치는 하나가 사용되는 것으로 설"}
{"patent_id": "10-2022-0084087", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 22, "content": "명된 경우도 있지만, 해당 기술분야에서 통상의 지식을 가진 자는, 처리 장치가 복수 개의 처리 요소 (processing element) 및/또는 복수 유형의 처리 요소를 포함할 수 있음을 알 수 있다. 예를 들어, 처리 장치 는 복수 개의 프로세서 또는 하나의 프로세서 및 하나의 컨트롤러를 포함할 수 있다. 또한, 병렬 프로세서 (parallel processor)와 같은, 다른 처리 구성(processing configuration)도 가능하다. 소프트웨어는 컴퓨터 프로그램(computer program), 코드(code), 명령(instruction), 또는 이들 중 하나 이상의 조합을 포함할 수 있으며, 원하는 대로 동작하도록 처리 장치를 구성하거나 독립적으로 또는 결합적으로 (collectively) 처리 장치를 명령할 수 있다. 소프트웨어 및/또는 데이터는, 처리 장치에 의하여 해석되거나 처리 장치에 명령 또는 데이터를 제공하기 위하여, 어떤 유형의 기계, 구성요소(component), 물리적 장치, 가상 장치(virtual equipment), 컴퓨터 저장 매체 또는 장치에 구체화(embody)될 수 있다. 소프트웨어는 네트워크로 연결된 컴퓨터 시스템 상에 분산되어서, 분산된 방법으로 저장되거나 실행될 수도 있다. 소프트웨어 및 데이터 는 하나 이상의 컴퓨터 판독 가능 기록 매체에 저장될 수 있다. 실시예에 따른 방법은 다양한 컴퓨터 수단을 통하여 수행될 수 있는 프로그램 명령 형태로 구현되어 컴퓨터 판 독 가능 매체에 기록될 수 있다. 상기 컴퓨터 판독 가능 매체는 프로그램 명령, 데이터 파일, 데이터 구조 등 을 단독으로 또는 조합하여 포함할 수 있다. 상기 매체에 기록되는 프로그램 명령은 실시예를 위하여 특별히 설계되고 구성된 것들이거나 컴퓨터 소프트웨어 당업자에게 공지되어 사용 가능한 것일 수도 있다. 컴퓨터 판 독 가능 기록 매체의 예에는 하드 디스크, 플로피 디스크 및 자기 테이프와 같은 자기 매체(magnetic media), CD-ROM, DVD와 같은 광기록 매체(optical media), 플롭티컬 디스크(floptical disk)와 같은 자기-광 매체 (magneto-optical media), 및 롬(ROM), 램(RAM), 플래시 메모리 등과 같은 프로그램 명령을 저장하고 수행하도 록 특별히 구성된 하드웨어 장치가 포함된다. 프로그램 명령의 예에는 컴파일러에 의해 만들어지는 것과 같은 기계어 코드뿐만 아니라 인터프리터 등을 사용해서 컴퓨터에 의해서 실행될 수 있는 고급 언어 코드를 포함한다."}
{"patent_id": "10-2022-0084087", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 23, "content": "이상과 같이 실시예들이 비록 한정된 실시예와 도면에 의해 설명되었으나, 해당 기술분야에서 통상의 지식을 가 진 자라면 상기의 기재로부터 다양한 수정 및 변형이 가능하다. 예를 들어, 설명된 기술들이 설명된 방법과 다 른 순서로 수행되거나, 및/또는 설명된 시스템, 구조, 장치, 회로 등의 구성요소들이 설명된 방법과 다른 형태 로 결합 또는 조합되거나, 다른 구성요소 또는 균등물에 의하여 대치되거나 치환되더라도 적절한 결과가 달성될 수 있다. 그러므로, 다른 구현들, 다른 실시예들 및 특허청구범위와 균등한 것들도 후술하는 특허청구범위의 범위에 속한 다. 도면 도면1 도면2a 도면2b 도면3 도면4 도면5 도면6 도면7"}
{"patent_id": "10-2022-0084087", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 일 실시예에 따른 DCEMRI에서 사용되는 두 가지 추적자 운동 모델을 나타내는 도면이다. 도 2a는 일 실시예에 따른 인공지능을 이용한 뇌관류 및 혈액뇌장벽투과도 맵 예측 방법을 나타내는 흐름도이다. 도 2b는 일 실시예에 따른 DCE-MRI 영상으로부터 약동학적(PK) 파라미터를 추정하도록 학습하는 방법을 나타내 는 흐름도이다. 도 3은 일 실시예에 따른 인공지능을 이용한 뇌관류 및 혈액뇌장벽투과도 맵 예측 장치를 나타내는 블록도이다. 도 4는 일 실시예에 따른 PK 파라미터 추정을 위한 CycleGAN 아키텍처를 나타내는 도면이다. 도 5는 일 실시예에 따른 CycleGAN에 이용한 생성자 아키텍처를 나타내는 도면이다. 도 6은 일 실시예에 따른 지도 방법의 전체적인 흐름을 나타내는 도면이다. 도 7은 일 실시예에 따른 다양한 PK 파라미터 추정 방법들의 추정 결과를 나타내는 도면이다."}
