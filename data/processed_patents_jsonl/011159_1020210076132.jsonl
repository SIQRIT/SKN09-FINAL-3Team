{"patent_id": "10-2021-0076132", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2022-0167061", "출원번호": "10-2021-0076132", "발명의 명칭": "딥러닝 기반 병변 분류 방법 및 장치", "출원인": "중앙대학교 산학협력단", "발명자": "홍병우"}}
{"patent_id": "10-2021-0076132", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "모발이 제거된 이미지를 생성하도록 학습된 GAN(Generative Adversarial Network) framework를 이용하는 병변분류 방법에 있어서,상기 GAN framework의 생성기가 검진 대상 환자의 피부 질환 및 모발을 포함하는 입력 이미지로부터 상기 입력이미지에서 모발이 제거된 가상 이미지인 분류 대상 이미지를 생성하는 단계;상기 GAN framework의 판별기가 모발이 포함되지 않은 사전 수집된 복수의 병변 이미지로부터 상기 병변의 공통특징을 학습하고, 상기 분류 대상 이미지에 모발이 포함되어 있는지 여부를 판단하는 단계; 및분류기가 상기 분류 대상 이미지에 모발이 포함되어 있지 않다고 판단되면, 이미지 분류 모델을 통해 상기 분류대상 이미지에 포함된 피부 질환을 분류하는 단계를 포함하는병변 분류 방법."}
{"patent_id": "10-2021-0076132", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 분류 대상 이미지를 생성하는 단계는상기 입력 이미지에서 모발이 포함될 확률인 사전 확률(prior probability), 상기 분류 대상 이미지에서 모발이포함되지 않을 확률인 사후 확률(posterior probability) 및 상기 입력 이미지와 상기 분류 대상 이미지가 비유사할 확률인 우도 확률(likelihood probability)에 기초하여 상기 분류 대상 이미지를 생성하는 단계를 포함하는병변 분류 방법."}
{"patent_id": "10-2021-0076132", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제2항에 있어서,상기 분류 대상 이미지를 생성하는 단계는상기 사전 확률 및 상기 우도 확률의 곱에 비례하는 사후 확률을 최대화하여 상기 분류 대상 이미지를 생성하는단계를 포함하는병변 분류 방법."}
{"patent_id": "10-2021-0076132", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제3항에 있어서,상기 분류 대상 이미지를 생성하는 단계는상기 우도 확률에 비례하는 우도 확률 밀도에 음의 로그값을 취한 재구성 손실 함수(reconstruction lossfunction)를 최소화하여 상기 사후 확률을 최대화하는 것인병변 분류 방법.공개특허 10-2022-0167061-3-청구항 5 제1항에 있어서,상기 분류 대상 이미지에 모발이 포함되어 있다고 판단되면, 상기 생성하는 단계, 상기 판단하는 단계 및 상기분류하는 단계를 다시 수행하여 새로운 분류 대상 이미지에 포함된 피부 질환을 분류하는 단계를 포함하는병변 분류 방법."}
{"patent_id": "10-2021-0076132", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제1항에 있어서,상기 분류 대상 이미지는상기 입력 이미지에서 상기 모발을 제외한 나머지 구성이 보존되도록 생성되는병변 분류 방법."}
{"patent_id": "10-2021-0076132", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "모발이 제거된 이미지를 생성하도록 학습된 GAN(Generative Adversarial Network) framework를 이용하는 병변분류 장치에 있어서,검진 대상 환자의 피부 질환 및 모발을 포함하는 입력 이미지로부터 상기 입력 이미지에서 모발이 제거된 가상이미지인 분류 대상 이미지를 생성하는 생성기;모발이 포함되지 않은 사전 수집된 복수의 병변 이미지로부터 상기 병변의 공통 특징을 학습하고, 상기 분류 대상 이미지에 모발이 포함되어 있는지 여부를 판단하는 판별기; 및상기 분류 대상 이미지에 모발이 포함되어 있지 않다고 판단되면, 이미지 분류 모델을 통해 상기 분류 대상 이미지에 포함된 피부 질환을 분류하는 분류기를 포함하는병변 분류 장치."}
{"patent_id": "10-2021-0076132", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제7항에 있어서,상기 생성기는상기 입력 이미지에서 모발이 포함될 확률인 사전 확률(prior probability), 상기 분류 대상 이미지에서 모발이포함되지 않을 확률인 사후 확률(posterior probability) 및 상기 입력 이미지와 상기 분류 대상 이미지가 비유사할 확률인 우도 확률(likelihood probability)에 기초하여 상기 분류 대상 이미지를 생성하는 병변 분류 장치."}
{"patent_id": "10-2021-0076132", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제8항에 있어서,상기 생성기는상기 사전 확률 및 상기 우도 확률의 곱에 비례하는 사후 확률을 최대화하여 상기 분류 대상 이미지를 생성하는 병변 분류 장치.공개특허 10-2022-0167061-4-청구항 10 제9항에 있어서,상기 생성기는상기 우도 확률에 비례하는 우도 확률 밀도에 음의 로그값을 취한 재구성 손실 함수(reconstruction lossfunction)를 최소화하여 상기 사후 확률을 최대화하는병변 분류 장치."}
{"patent_id": "10-2021-0076132", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "제7항에 있어서,상기 분류 대상 이미지에 모발이 포함되어 있다고 판단되면, 상기 생성기, 상기 판별기 및 상기 분류기를 이용하여 새로운 분류 대상 이미지에 포함된 피부 질환을 분류하도록 제어하는 제어기를 더 포함하는 병변 분류 장치."}
{"patent_id": "10-2021-0076132", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제7항에 있어서,상기 분류 대상 이미지는상기 입력 이미지에서 상기 모발을 제외한 나머지 구성이 보존되도록 생성되는병변 분류 장치."}
{"patent_id": "10-2021-0076132", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 명세서는 병변 분류 방법 및 장치에 관한 것으로 보다 상세하게는 딥러닝을 이용하여 병변을 분류하는 방법 및 장치에 관한 것이다. 본 명세서의 일 실시예에 따른 병변 분류 방법은 GAN framework의 생성기가 검진 대상 환자의 피부 질환 및 모발을 포함하는 입력 이미지로부터 상기 입력 이미지에서 모발이 제거된 가상 이미지인 분 류 대상 이미지를 생성하는 단계, GAN framework의 판별기가 모발이 포함되지 않은 사전 수집된 복수의 병변 이 미지로부터 상기 병변의 공통 특징을 학습하고, 상기 분류 대상 이미지에 모발이 포함되어 있는지 여부를 판단하 는 단계 및 분류기가 상기 분류 대상 이미지에 모발이 포함되어 있지 않다고 판단되면, 이미지 분류 모델을 통해 상기 분류 대상 이미지에 포함된 피부 질환을 분류하는 단계를 포함한다."}
{"patent_id": "10-2021-0076132", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 명세서는 병변 분류 방법 및 장치에 관한 것으로 보다 상세하게는 딥러닝을 이용하여 병변을 분류하는 방법 및 장치에 관한 것이다."}
{"patent_id": "10-2021-0076132", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "최근에는 인공지능 기술의 발달과 더불어 피부 질환을 가진 환자의 병변 부위 사진만을 보고도 환자가 어떠한 질환을 가지고 있는지 컴퓨터를 통해 판단할 수 있다. 예를 들어, 치명적인 피부암으로 알려진 흑색 종에 대하 여 사진만 가지고도 음성 종양인지 또는 양성 종양인지를 분류할 수 있다. 컴퓨터가 환자의 피부 질환을 분류하기 위해서는 방대한 양의 데이터를 이용하거나, 특정 규칙에 따른 이미지 분류 기술이 사용된다. 그러나, 이러한 이미지 분류 기술을 사용하는 경우 피부에 포함된 모발(털)로 인하여 피 부 질환이 가려지면 병변 분류의 정확도가 매우 떨어지게 된다. 또한, 피부에 포함된 모발은 수가 많아 구조가 복잡하고 다양하게 변형되어 공통적인 특징을 추출하기 어려우므 로 사전에 환자의 피부의 병변 주변에 제모 과정을 수행한 뒤의 병변 이미지를 이용하여 피부 질환을 분류한다. 이러한 제모 과정은 번거로우며 환자의 피부에 대한 미관을 해치게 되므로 실제 제모 과정 없이 인공지능 기술 을 이용하여 병변 이미지에서 모발을 제거하는 기술의 필요성이 요구된다."}
{"patent_id": "10-2021-0076132", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 2, "content": "발명의 내용"}
{"patent_id": "10-2021-0076132", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 명세서의 목적은 GAN framework를 통해 입력 이미지를 재구성하고, 입력 이미지에서 모발만 제거된 분류 대 상 이미지를 생성하는 병변 분류 방법 및 장치는 제공하는 것이다. 또한, 본 명세서의 목적은 모발이 제거된 분류 대상 이미지를 이용함으로써 피부 질환을 보다 정확하게 분류하 는 병변 분류 방법 및 장치는 제공하는 것이다. 본 명세서의 목적들은 이상에서 언급한 목적으로 제한되지 않으며, 언급되지 않은 본 명세서의 다른 목적 및 장 점들은 하기의 설명에 의해서 이해될 수 있고, 본 명세서의 실시예에 의해 보다 분명하게 이해될 것이다. 또한, 본 명세서의 목적 및 장점들은 특허 청구 범위에 나타낸 수단 및 그 조합에 의해 실현될 수 있음을 쉽게 알 수 있을 것이다."}
{"patent_id": "10-2021-0076132", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 명세서의 일 실시예에 따른 병변 분류 방법은 GAN framework의 생성기가 검진 대상 환자의 피부 질환 및 모 발을 포함하는 입력 이미지로부터 상기 입력 이미지에서 모발이 제거된 가상 이미지인 분류 대상 이미지를 생성 하는 단계, GAN framework의 판별기가 모발이 포함되지 않은 사전 수집된 복수의 병변 이미지로부터 상기 병변 의 공통 특징을 학습하고, 상기 분류 대상 이미지에 모발이 포함되어 있는지 여부를 판단하는 단계 및 분류기가 상기 분류 대상 이미지에 모발이 포함되어 있지 않다고 판단되면, 이미지 분류 모델을 통해 상기 분류 대상 이 미지에 포함된 피부 질환을 분류하는 단계를 포함한다. 본 명세서의 일 실시예에서 분류 대상 이미지를 생성하는 단계는 입력 이미지에서 모발이 포함될 확률인 사전 확률(prior probability), 분류 대상 이미지에서 모발이 포함되지 않을 확률인 사후 확률(posterior probability) 및 입력 이미지와 상기 분류 대상 이미지가 비유사할 확률인 우도 확률(likelihood probabilit y)에 기초하여 상기 분류 대상 이미지를 생성하는 단계를 포함한다. 본 명세서의 일 실시예에서 분류 대상 이미지를 생성하는 단계는 사전 확률 및 상기 우도 확률의 곱에 비례하는 사후 확률을 최대화하여 상기 분류 대상 이미지를 생성하는 단계를 포함한다. 본 명세서의 일 실시예에서 분류 대상 이미지를 생성하는 단계는 우도 확률에 비례하는 우도 확률 밀도에 음의 로그 값을 취한 재구성 손실 함수(reconstruction loss function)를 최소화하여 상기 사후 확률을 최대화하는 단계를 포함한다. 본 명세서의 일 실시예에 따른 병변 분류 방법은 분류 대상 이미지에 모발이 포함되어 있다고 판단되면, 상기 생성하는 단계, 상기 판단하는 단계 및 상기 분류하는 단계를 다시 수행하여 새로운 분류 대상 이미지에 포함된 피부 질환을 분류하는 단계를 더 포함한다. 본 명세서의 일 실시예에서 분류 대상 이미지는 입력 이미지에서 상기 모발을 제외한 나머지 구성이 보존되도록 생성된다. 본 명세서의 일 실시예에 따른 병변 분류 장치는 검진 대상 환자의 피부 질환 및 모발을 포함하는 입력 이미지 로부터 상기 입력 이미지에서 모발이 제거된 가상 이미지인 분류 대상 이미지를 생성하는 생성기, 모발이 포함 되지 않은 사전 수집된 복수의 병변 이미지로부터 상기 병변의 공통 특징을 학습하고, 상기 분류 대상 이미지에 모발이 포함되어 있는지 여부를 판단하는 판별기 및 분류 대상 이미지에 모발이 포함되어 있지 않다고 판단되면, 이미지 분류 모델을 통해 상기 분류 대상 이미지에 포함된 피부 질환을 분류하는 분류기를 포함한다. 본 명세서의 일 실시예에서 생성기는 입력 이미지에서 모발이 포함될 확률인 사전 확률(prior probability), 상 기 분류 대상 이미지에서 모발이 포함되지 않을 확률인 사후 확률(posterior probability) 및 상기 입력 이미지 와 상기 분류 대상 이미지가 비유사할 확률인 우도 확률(likelihood probability)에 기초하여 상기 분류 대상 이미지를 생성한다. 본 명세서의 일 실시예에서 생성기는 사전 확률 및 상기 우도 확률의 곱에 비례하는 사후 확률을 최대화하여 상 기 분류 대상 이미지를 생성한다. 본 명세서의 일 실시예에서 생성기는 우도 확률에 비례하는 우도 확률 밀도에 음의 로그 값을 취한 재구성 손실 함수(reconstruction loss function)를 최소화하여 상기 사후 확률을 최대화한다. 본 명세서의 일 실시예에서 분류 대상 이미지에 모발이 포함되어 있다고 판단되면, 상기 생성기, 상기 판별기 및 상기 분류기를 이용하여 새로운 분류 대상 이미지에 포함된 피부 질환을 분류하도록 제어하는 제어기를 더 포함한다. 본 명세서의 일 실시예에서 분류 대상 이미지는 입력 이미지에서 상기 모발을 제외한 나머지 구성이 보존되도록 생성된다."}
{"patent_id": "10-2021-0076132", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 명세서의 일 실시예에 따른 병변 분류 장치 및 방법은 GAN framework를 통해 입력 이미지를 재구성하고, 입 력 이미지에서 모발만 제거된 분류 대상 이미지를 생성할 수 있다. 또한, 본 명세서의 일 실시예에 따른 병변 분류 장치 및 방법은 모발이 제거된 분류 대상 이미지를 이용함으로 써 피부 질환을 보다 정확하게 분류할 수 있다."}
{"patent_id": "10-2021-0076132", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "본 발명은 다양한 변경을 가할 수 있고 여러 가지 실시예를 가질 수 있는 바, 특정 실시예들을 도면에 예시하고 상세한 설명에 상세하게 설명하고자 한다. 그러나, 이는 본 발명을 특정한 실시 형태에 대해 한정하려는 것이 아니며, 본 발명의 사상 및 기술 범위에 포함되는 모든 변경, 균등물 내지 대체물을 포함하는 것으로 이해되어 야 한다. 각 도면을 설명하면서 유사한 참조부호를 유사한 구성요소에 대해 사용하였다. 제1, 제2, A, B 등의 용어는 다양한 구성요소들을 설명하는데 사용될 수 있지만, 상기 구성요소들은 상기 용어 들에 의해 한정되어서는 안 된다. 상기 용어들은 하나의 구성요소를 다른 구성요소로부터 구별하는 목적으로만 사용된다. 예를 들어, 본 발명의 권리 범위를 벗어나지 않으면서 제1 구성요소는 제2 구성요소로 명명될 수 있 고, 유사하게 제2 구성요소도 제1 구성요소로 명명될 수 있다. 및/또는 이라는 용어는 복수의 관련된 기재된 항 목들의 조합 또는 복수의 관련된 기재된 항목들 중의 어느 항목을 포함한다. 어떤 구성요소가 다른 구성요소에 \"연결되어\" 있다거나 \"접속되어\" 있다고 언급된 때에는, 그 다른 구성요소에 직접적으로 연결되어 있거나 또는 접속되어 있을 수도 있지만, 중간에 다른 구성요소가 존재할 수도 있다고 이 해되어야 할 것이다. 반면에, 어떤 구성요소가 다른 구성요소에 \"직접 연결되어\" 있다거나 \"직접 접속되어\" 있 다고 언급된 때에는, 중간에 다른 구성요소가 존재하지 않는 것으로 이해되어야 할 것이다. 본 출원에서 사용한 용어는 단지 특정한 실시예를 설명하기 위해 사용된 것으로, 본 발명을 한정하려는 의도가 아니다. 단수의 표현은 문맥상 명백하게 다르게 뜻하지 않는 한, 복수의 표현을 포함한다. 본 출원에서, \"포함 하다\" 또는 \"가지다\" 등의 용어는 명세서상에 기재된 특징, 숫자, 단계, 동작, 구성요소, 부품 또는 이들을 조 합한 것이 존재함을 지정하려는 것이지, 하나 또는 그 이상의 다른 특징들이나 숫자, 단계, 동작, 구성요소, 부 품 또는 이들을 조합한 것들의 존재 또는 부가 가능성을 미리 배제하지 않는 것으로 이해되어야 한다. 다르게 정의되지 않는 한, 기술적이거나 과학적인 용어를 포함해서 여기서 사용되는 모든 용어들은 본 발명이 속하는 기술 분야에서 통상의 지식을 가진 자에 의해 일반적으로 이해되는 것과 동일한 의미를 가지고 있다. 일 반적으로 사용되는 사전에 정의되어 있는 것과 같은 용어들은 관련 기술의 문맥 상 가지는 의미와 일치하는 의미를 가지는 것으로 해석되어야 하며, 본 출원에서 명백하게 정의하지 않는 한, 이상적이거나 과도하게 형식적 인 의미로 해석되지 않는다. 이하, 첨부된 도면을 참조하여 본 발명의 바람직한 실시예를 상세하게 설명한다. 도 1은 본 명세서의 일 실시예에 따른 병변 분류 장치의 구성도이다. 도면을 참조하면, 병변 분류 장치는 GAN(Generative Adversarial Network) framework를 이용하여 피부 질 환 이미지가 어떠한 피부 질환인지를 분류하는 장치로써, 생성기, 판별기, 분류기 및 제어기 를 포함한다. 생성기는 검진 대상 환자의 실제 이미지인 피부 질환 및 모발을 포함하는 입력 이미지로부터 입력 이미지 에서 모발이 제거된 가상 이미지인 분류 대상 이미지를 생성한다. 판별기는 모발이 포함되지 않은 사전 수집된 복수의 병변 이미지로부터 병변의 공통 특징을 학습하고, 생 성된 분류 대상 이미지에 모발이 포함되어 있는지 여부를 판단한다. 분류 대상 이미지에 모발이 포함되어 있지 않다고 판단되면, 분류기는 이미지 분류 모델을 통해 분류 대상 이미지에 포함된 피부 질환을 분류한다. 예를 들어, 분류기는 피부 질환이 흑색종인 경우 흑색종이 양성 종양(benign)인지 또는 악성 종양(malignant)인지를 분류할 수 있다. 이때 사용되는 이미지 분류 모델은 딥러닝 에 기반한 분류 모델일 수 있다. 제어기는 생성기, 판별기 및 분류기의 동작을 제어하며 병변 분류 장치를 컨트롤한다. 생성기, 판별기 및 분류기 각각은 제어기의 동작 명령에 의해 동작이 수행될 수 있다. 도 2는 본 명세서의 일 실시예에 따른 병변 분류 장치에서 병변을 분류하는 과정을 나타낸 흐름도이다. 도면을 참조하면, 입력 이미지(x)가 생성기에 입력되면, 생성기는 입력 이미지(x)로부터 분류 대상 이미지(γ)를 생성한다. 즉, 입력 이미지(x)에는 피부 질환뿐만 아니라 모발이 함께 포함되어 있으므로 생성기 는 피부 질환만을 추출하기 위해 입력 이미지에서 모발을 제거하는 재구성 과정을 거쳐 가상 이미지인 분 류 대상 이미지(γ)를 생성한다. 생성기는 인코더(RE) 및 디코더(RD)를 포함하며, 입력 이미지(x)는 인코더(RE)를 통해 재구성되고, 디코더 (RD)를 통해 재구성된 입력 이미지로부터 분류 대상 이미지(γ)가 생성된다. 구체적으로, 생성기는 베이즈 정리(Bayes rule)를 이용한 확률을 통해 입력 이미지(x)를 재구성하고, 분류 대상 이미지를 생성한다. 즉, 생성기는 입력 이미지(x)에서 모발이 포함될 확률인 사전 확률(prior probability), 분류 대상 이미지(γ)에서 모발이 포함되지 않을 확률인 사후 확률(posterior probability) 및 입력 이미지와 분류 대상 이미지가 비유사할 확률인 우도 확률(likelihood probability)에 기초하여 분류 대상 이미지(γ)를 생성한다. 보다 상세하게, 생성기는 사전 확률 및 우도 확률의 곱에 비례하는 사후 확률을 최대화하여 분류 대상 이 미지(γ)를 생성하며, 이러한 사전 확률, 우도 확률 및 사후 확률의 관계는 하기의 수학식 1로 표현될 수 있다. <수학식 1>"}
{"patent_id": "10-2021-0076132", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "여기서 는 사전 확률, 는 우도 확률, 는 사후 확률을 의미한다. 또한, 이러한 확률 중 우도 확률에 비례하며, 확률 변수의 분포를 나타내는 우도 확률 밀도는 하기의 수학식 2로 표현될 수 있다.<수학식 2>"}
{"patent_id": "10-2021-0076132", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "한편, 분류 대상 이미지(γ)에 포함된 피부 질환이 변형되어 입력 이미지(x)의 피부 질환과 전혀 다른 형태를 갖게 되면 입력 이미지(x)에 대한 병변을 분류하는 것이 아니므로 분류 대상 이미지를 생성하는 의미가 없어진 다. 따라서, 생성기는 입력 이미지(x)에서 모발만을 제거하는 것을 목적으로 하며, 분류 대상 이미지(γ)는 입 력 이미지(x)에서 모발을 제외한 나머지 구성이 보존되도록 생성될 수 있다. 또한, 입력 이미지(x)가 재구성되며 분류 대상 이미지(γ)가 생성되는 과정에서 손실이 발생하며, 이러한 손실 을 최소화하는 경우 입력 이미지(x)에서 모발을 제외한 나머지 구성 (예컨대, 피부 질환과 주변 피부)이 보존될 수 있다. 상술한 손실을 최소화하기 위해, 생성기는 재구성 손실 함수(reconstruction loss function)를 사용할 수 있다. 재구성 손실 함수를 최소화하는 경우 손실이 최소화 되므로 사후 확률이 최대화 되고 입력 이미지에서 모 발을 제외한 나머지 구성이 보존될 수 있다. 재구성 손실 함수는 우도 확률에 비례하는 우도 확률 밀도에 음의 로그 값을 곱하여 도출될 함수로 하기의 수학 식 3으로 표현될 수 있다. <수학식 3>"}
{"patent_id": "10-2021-0076132", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "여기서 는 재구성 손실 함수, 는 모발의 분포를 의미한다. = 인 경우 재구성 손실 함수 가 최소화 되므로 사후 확률이 최대화 될 수 있다. 판별기는 딥러닝 알고리즘을 이용하여 생성된 분류 대상 이미지에 모발이 포함되어 있는지 여부를 판단한 다. 여기서 딥러닝 알고리즘은 GAN(Generative Adversarial Network) framework일 수 있다. 판별기는 특정 이미지에 모발이 포함되어 있는지 여부를 판단하기 위해 모발이 포함되지 않은 복수의 병변 이미지(y1)를 수집하고, 수집된 복수의 병변 이미지(y1)로부터 병변의 공통 특징을 학습한다. 이후, 분류기는 분류 대상 이미지에 대하여 학습한 병변의 공통 특징을 적용함으로써 모발이 포함되어 있 는지 여부를 판단한다. 만약 분류 대상 이미지에 모발이 포함되어 있다고 판단되면, 제어기는 생성기 , 판별기 및 분류기를 제어하여 새로운 분류 대상 이미지에 포함된 피부 질환을 분류한다. 즉, 분류 대상 이미지에 여전히 모발이 포함되어 있다고 판단되는 경우 생성기가 충분히 학습이 되지 않은 것으로, 모발이 제거되지 않은 불완전한 분류 대상 이미지를 생성한 것이다. 따라서, 제어기는 해당 분류 대상 이미지를 대상으로 병변을 분류하지 않도록 분류기를 제어하고, 새로운 분류 대상 이미지를 생성하도 록 생성기를 제어한다. 이후, 제어기의 제어 명령에 따라 판별기가 새로운 분류 대상 이미지를 판별한 결과, 새로운 분류 대 상 이미지에 모발이 포함되어 있지 않다고 판단된 경우, 제어기는 분류기를 제어하여 새로운 분류 대 상 이미지에 포함된 피부 질환을 분류한다. 이와 반대로, 새로운 분류 대상 이미지에 모발이 포함되어 있다고 판단된 경우, 제어기는 생성기를 제어하여 또다시 새로운 분류 대상 이미지를 생성한다. 이와 같이 GAN framework에 따라 생성기 및 판별기는 서로 적대적 관계를 이루며 동시에 학습되고, 점차 많은 영역에서 모발이 제거된 분류 대상 이미지가 생성된다. 결과적으로, 병변 분류 장치는 입력 이 미지에서 모발이 완전히 제거된 분류 대상 이미지를 획득할 수 있다. 분류기는 이미지 분류 모델을 통해 분류 대상 이미지에 포함된 피부 질환을 분류한다. 이미지 분류 모델은 MNIST, VGG16, CNN 등을 이용한 모델일 수 있으나, 이에 한정되지 않고 인공지능을 이용하여 이미지를 분류하는 모델을 모두 포함할 수 있다. 이때, 분류기는 사전 수집된 복수의 병변 이미지(y2)를 이용하여 병변의 종 류에 대해 학습함으로써 병변 분류 성능을 향상시킬 수 있다. 한편, 상술한 바와 같이 분류 대상 이미지가 반복되며 생성되는 과정에서 손실이 발생한다. 이는 적대적 손실 (Adversarial loss)로써, 적대적 손실은 하기의 수학식 4와 같이 표현될 수 있다. <수학식 4>"}
{"patent_id": "10-2021-0076132", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 5, "content": "여기서, 는 적대적 손실, 는 모발이 없는 데이터 분포, 는 모 발이 있는 데이터 분포, D는 판별기, 및 는 D의 학습 가능한 모델 매개 변수를 나타내고, 및 는 정규 화 정도를 결정하는 양의 정수값을 의미한다. 적대적 손실은 모발이 없는 데이터의 분포를 따르도록 분류 대상 이미지( )를 유도하며, 재구성 손실은 입력 이 미지(x)의 모발을 제외한 나머지 구성을 보존을 유도한다. 따라서, 병변 분류 장치는 재구성 손실과 적대 적 손실을 동시에 학습함으로써 입력 이미지의 속성을 보존하면서도 모발만 제거된 분류 대상 이미지를 획득할 수 있다. 또한, 본 명세서의 병변 분류 장치는 모발이 제거된 분류 대상 이미지를 이용함으로써 피부 질환을 보다 정확하게 분류할 수 있다. 도 3은 본 명세서의 병변 분류 장치와 다른 장치를 사용하여 모발을 제거한 결과에 대한 도면이다. 도면을 참조하면, 상단에는 피부 질환 및 모발을 포함하는 복수의 입력 이미지가 도시 되며, 중단과 하단 에는 복수의 입력 이미지로부터 CycleGAN framework를 이용하여 생성된 가상 이미지 및 복수의 입력 이미지로부터 본 명세서의 병변 분류 장치를 이용하여 생성된 분류 대상 이미지가 각각 도시 된 다. CycleGAN framework를 이용한 장치로부터 생성된 가상 이미지는, 도시된 바와 같이 복수의 입력 이미지 와 비교할 때 복수의 입력 이미지에서 모든 모발이 제거되었다. 그러나, 살펴보면 복수의 입력 이미지에 포함된 피부 질환과 가상 이미지에 포함된 양성 피부 질환의 색, 크기 등이 상이하다. 따라서, CycleGAN framework를 이용한 장치로부터 생성된 가상 이미지는 재구성 손실이 큰 것을 알 수 있다. 반면, 병변 분류 장치를 이용한 분류 대상 이미지는 복수의 입력 이미지와 비교할 때, 복수의 입력 이미지에서 모발만 제거되고 나머지 구성인 피부 질환의 크기나 색 및 주변 피부의 색이 동일함을 확 인할 수 있다. 따라서, 본 명세서의 병변 분류 장치를 이용하면, 입력 이미지의 병변 특성이 그대로 보존되면서 모발이 제거된 분류 대상 이미지가 생성되므로 피부 질환을 보다 정확하게 분류할 수 있다. 도 4는 병변 분류 장치 및 다른 장치를 이용해 제거된 모발을 입력으로 한 다수의 분류 모델의 평균 분류 정확 도를 나타낸 표이다. 도면을 참조하면, 다수의 분류 모델이 사용되었으나 그 중 'Res-18, Res-152, RexX-101, EC-B3, EC-B4' 5개의 모델이 상위 값을 가진다. 여기서, Res는 ResNet, ResX는 ResNeXt, EC는 EfficientNet을 각각 나타낸다. 모발이 제거되지 않은 이미지를 입력 이미지로 사용하는 경우 각각의 분류 모델은 '0.7533, 0.68, 0.6933, 07067, 06111' 의 평균 분류 정확도를 나타냈고, 다른 장치의 CycleGAN을 사용하여 모발이 제거된 이미지를 입 력 이미지로 하였을 때 각각의 분류 모델은 '0.7667, 0.6667, 0.6934, 0.6533, 0.7267'의 평균 분류 정확도를 나타냈다. 즉, 특정 분류 모델에서는 모발이 제거되지 않은 이미지를 입력 이미지로 사용하였을 때보다 오히려 정확도가 떨어졌다. 한편, 병변 분류 장치를 이용한 모발이 제거된 이미지를 입력 이미지로 사용하였을 때 각각의 분류 모델은 '0.8067, 0.7667, 0.7600, 0.7600, 0.7267'의 평균 분류 정확도를 나타냄으로써 모든 분류 모델에서 정확도가 향상되었음을 보였다. 도 5는 본 명세서의 일 실시예에 따른 병변 분류 방법의 순서도이다. 도면을 참조하면, 본 명세서의 병변 분류 방법은 모발이 제거된 이미지를 생성하도록 학습된 GAN(Generative Adversarial Network) framework를 이용하는 방법으로, GAN framework의 생성기는 검진 대상 환자의 피부 질환 및 모발을 포함하는 입력 이미지로부터 입력 이미지에서 모발이 제거된 가상 이미지인 분류 대상 이미지를 생성 한다(S110). 또한, GAN framework의 판별기는 모발이 포함되지 않은 사전 수집된 복수의 병변 이미지로부터 상기 병변의 공 통 특징을 학습하고, 분류 대상 이미지에 모발이 포함되어 있는지 여부를 판단한다(S130). 마지막으로 분류기가 상기 분류 대상 이미지에 모발이 포함되어 있지 않다고 판단되면, 이미지 분류 모델을 통 해 상기 분류 대상 이미지에 포함된 피부 질환을 분류한다(S150). 만약 분류 대상 이미지에 모발이 포함되어 있다고 판단되면, 제어기는 새로운 분류 대상 이미지에 대하여 생성 하는 단계, 판단하는 단계 및 분류하는 단계를 다시 수행한다. 이와 같이, 본 명세서의 병변 분류 방법은 GAN framework를 통해 입력 이미지를 재구성하고, 입력 이미지에서 모발만 제거된 분류 대상 이미지를 생성할 수 있다. 또한, 본 명세서의 병변 분류 방법은 모발이 제거된 분류 대상 이미지를 이용함으로써 피부 질환을 보다 정확하 게 분류할 수 있다. 이상과 같이 본 발명에 대해서 예시한 도면을 참조로 하여 설명하였으나, 본 명세서에 개시된 실시 예와 도면에 의해 본 발명이 한정되는 것은 아니며, 본 발명의 기술사상의 범위 내에서 통상의 기술자에 의해 다양한 변형이 이루어질 수 있음은 자명하다. 아울러 앞서 본 발명의 실시 예를 설명하면서 본 발명의 구성에 따른 작용 효과 를 명시적으로 기재하여 설명하지 않았을지라도, 해당 구성에 의해 예측 가능한 효과 또한 인정되어야 함은 당 연하다.도면 도면1 도면2 도면3 도면4 도면5"}
{"patent_id": "10-2021-0076132", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 명세서의 일 실시예에 따른 병변 분류 장치의 구성도이다. 도 2는 본 명세서의 일 실시예에 따른 병변 분류 장치에서 병변을 분류하는 과정을 나타낸 흐름도이다. 도 3은 본 명세서의 병변 분류 장치와 다른 장치를 사용하여 모발을 제거한 결과를 비교한 도면이다. 도 4는 병변 분류 장치 및 다른 장치를 이용해 제거된 모발을 입력으로 한 다수의 분류 모델의 평균 분류 정확 도를 나타낸 표이다. 도 5는 본 명세서의 일 실시예에 따른 병변 분류 방법의 순서도이다."}
