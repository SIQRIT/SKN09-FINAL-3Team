{"patent_id": "10-2019-0107483", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2021-0026543", "출원번호": "10-2019-0107483", "발명의 명칭": "복수의 인공신경망 모델 기반 단백질 결합 화합물의 활성 예측 시스템", "출원인": "주식회사 에일론", "발명자": "조경민"}}
{"patent_id": "10-2019-0107483", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "복수의 인공신경망 모델 기반 단백질 결합 화합물의 활성 예측 시스템에 있어서,단백질에 대한 화합물의 활성 데이터, 및, 단백질과 화합물의 3차원 형상 또는 3차원 구조 데이터를 저장하는데이터관리 모듈;자신만의 개별 신경망 모듈을 구비하고, 단백질 또는 화합물의 3차원 형상 데이터 또는 3차원 구조 데이터로부터 디스크립터를 추출하고, 추출한 디스크립터와 활성 데이터로 상기 개별 신경망 모델을 학습시키고, 학습된개별 신경망 모델에 적용하여 출력되는 2차 학습용 결과 데이터를 저장하는 개별 신경망 모듈;자신만의 통합 신경망 모듈을 구비하고, 각각의 개별 신경망 모듈에서 생성된 2차 학습용 결과 데이터를 통합하여 2차 학습데이터를 생성하고, 생성된 2차 학습데이터로 상기 통합 신경망 모델을 학습시키는 통합 신경망 모듈; 및,질의 단백질과 질의 화합물에 대하여 상기 개별 신경망 모델 및 상기 통합 신경망 모델을 이용하여 활성을 예측하는 활성예측 모듈을 포함하고,상기 개별 신경망 모델은 적어도 2개 이상으로 구성되어 하나의 개별 신경망 모듈 그룹을 형성하는 것을 특징으로 하는 복수의 인공신경망 모델 기반 단백질 결합 화합물의 활성 예측 시스템."}
{"patent_id": "10-2019-0107483", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 개별 신경망 모듈은 추출한 디스크립터와 활성 데이터로 1차 학습데이터를 생성하고, 1차 학습 데이터 중일부로 상기 개별 신경망 모델을 학습시키고, 학습된 개별 신경망 모델에 1차 학습데이터 중 다른 일부를 적용하여 2차 학습용 결과 데이터를 생성하는 것을 특징으로 하는 복수의 인공신경망 모델 기반 단백질 결합 화합물의 활성 예측 시스템."}
{"patent_id": "10-2019-0107483", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1항에 있어서,상기 1차 학습데이터는 단백질과 화합물의 식별정보, 단백질과 화합물에 대한 디스크립터와, 해당 단백질에 대한 해당 화합물의 활성 데이터로부터 결정되는 라벨 값을 포함하고,상기 개별 신경망 모듈은 1차 학습데이터의 각 데이터에 대하여 해당 데이터의 디스크립터를 상기 개별 신경망모델에 적용하여 예측결과 데이터를 획득하고, 예측결과 데이터에 해당 1차 학습데이터의 해당 데이터의 라벨을부여하여 2차 학습용 결과 데이터를 생성하고, 상기 2차 학습용 결과 데이터에 단백질과 화합물에 대한 식별정보를 포함시키는 것을 특징으로 하는 복수의 인공신경망 모델 기반 단백질 결합 화합물의 활성 예측 시스템."}
{"patent_id": "10-2019-0107483", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제1항에 있어서,상기 개별 신경망 모델의 출력 데이터는 라벨 값의 확률 값으로 출력되고,상기 통합 신경망 모듈은 2차 학습용 결과 데이터를, 단백질과 화합물의 쌍을 기준으로 결합하여 통합시키되,단백질과 화합물의 쌍이 일치하면 모든 개별 신경망 모듈의 2차 학습용 결과 데이터를 하나의 데이터로 결합하공개특허 10-2021-0026543-3-여 2차 학습데이터를 생성하는 것을 특징으로 하는 복수의 인공신경망 모델 기반 단백질 결합 화합물의 활성 예측 시스템."}
{"patent_id": "10-2019-0107483", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제1항에 있어서,상기 개별 신경망 모듈 그룹은 3차원 형상 데이터로부터 디스크립터를 생성하는 적어도 하나의 개별신경망 모듈과, 3차원 구조 데이터로부터 디스크립터를 생성하는 적어도 하나의 개별신경망 모듈을 포함하는 것을 특징으로하는 복수의 인공신경망 모델 기반 단백질 결합 화합물의 활성 예측 시스템."}
{"patent_id": "10-2019-0107483", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제1항에 있어서,상기 개별 신경망 모듈은 푸리에 변환을 이용하여 3차원 형상 데이터에서 1차원 데이터를 추출하여 디스크립터로 생성하거나, 호몰로지를 이용하여 3차원 구조 데이터에서 2차원 이미지를 추출하여 디스크립터로생성하거나, 3차원 형상 데이터를 2차원 이미지로 투영하여 디스크립터를 생성하는 것을 특징으로 하는 복수의인공신경망 모델 기반 단백질 결합 화합물의 활성 예측 시스템."}
{"patent_id": "10-2019-0107483", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제1항에 있어서,상기 3차원 형상 데이터는 닫힌 표면 데이터로서 닫힌 메쉬 표면(closed mesh surface)에 대한 3차원 데이터이고, 상기 3차원 구조 데이터는 단백질 또는 화합물의 화학적 구조에서의 원자 위치에 대한 3차원 데이터로서 3차원 포인트로 구성되는 데이터인 것을 특징으로 하는 복수의 인공신경망 모델 기반 단백질 결합 화합물의 활성예측 시스템."}
{"patent_id": "10-2019-0107483", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 타겟 단백질에 대한 화합물의 활성 여부를 예측하는 복수 개의 인공 신경망(Neural Network) 모델을 결합하여 학습시키고 예측하는, 복수의 인공신경망 모델 기반 단백질 결합 화합물의 활성 예측 시스템에 관한 것으로서, 단백질에 대한 화합물의 활성 데이터, 및, 단백질과 화합물의 3차원 형상 또는 3차원 구조 데이터를 저 (뒷면에 계속)"}
{"patent_id": "10-2019-0107483", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 신약개발에 있어서 초기단계인 유효물질 발굴 단계를 빠른 시간 내에 효율적으로 처리하기 위하여, 인공지능을 이용해 단백질과 화합물의 결합 정보를 학습하여, 주어진 단백질과 화합물이 결합하여 활성을 나타 낼 수 있는지를 판단하고 예측하는, 복수의 인공신경망 모델 기반 단백질 결합 화합물의 활성 예측 시스템에 관 한 것이다. 또한, 본 발명은 타겟 단백질에 대한 화합물의 활성 여부를 예측하는 복수 개의 인공 신경망(Neural Network) 모델을 결합하기 위하여, 개별 인공신경망 모델을 통해 단백질과 화합물의 반응 정도에 대해 확률분포 데이터를 출력하게 하고, 이를 학습 데이터로 활용하는 별도의 통합 인공신경망을 구성하는, 복수의 인공신경망 모델 기 반 단백질 결합 화합물의 활성 예측 시스템에 관한 것이다."}
{"patent_id": "10-2019-0107483", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "컴퓨터를 활용한 신약개발은 신약 발굴(Drug Discovery) 단계에서 많이 쓰이는데, 화합물의 유효(Hit) 물질 발 굴을 위해서는 크게 두 가지의 방식이 사용되어 지고 있다. 첫번째 방식은 화합물 기반 약물 설계로서, 어떤 화 합물이 특정 구조 단백질에 결합을 한다는 사실에 기초해, 유사한 화학적 특징을 가진 화합물을 찾거나 만드는 방법이다. 두번째 방식은, 단백질 구조 기반 약물 설계로서, 단백질 3차원 구조 정보에 대한 사전 지식을 이용 하여 이러한 구조의 형태와 크기가 비슷한 화합물 중 활성을 보이는 화합물을 찾아낸다. 단백질 구조 기반 약물 설계 방식도 크게 세가지로 나뉠 수 있다. 첫번째는 바인딩 사이트(binding site) 또는 바인딩 포켓(binding pocket) 형태의 정보에 가장 형태가 유사한 화합물을 도킹 프로그램을 활용하여 빠르게 찾 아내는 방식이다[특허문헌 1]. 두번째로는, 바인딩 포켓(binding pocket)의 사이즈 및 크기에 맞게 화합물의 원 소 혹은 분자 조각(molecular fragments)을 합치는 방식이다. 세번째로는, 바인딩 캐비티(binding cavity)에 활성을 보이는 화합물들 중 알려진 형태(conformation)를 최적화 시키는 방식이다. 이 중에서도, 컴퓨터 기술 의 발달로 가상 스크리닝(virtual screening) 형태의 방법이 활발히 응용되어 지고 있다[특허문헌 2]. 가상 스크리닝(virtual screening)의 기술적인 측면에서, 기존의 기계적인 수백~수천만의 화합물 라이브러리에 서 타겟 단백질에 활성을 보이는 화합물을 찾는 방법에서, 현재는 인공신경망(딥러닝)을 활용한 방법들의 움직 임이 활발하다. 2015년 아톰와이즈사는 세계 최초로 분자의 결합 친화성 및 신약 타겟(단백질)의 결합 구조를 예측하는 아톰넷(AtomNet) 기술을 선보이게 되었다. 그러나 난이도가 높은 예측 문제를 단일 모델로만 인공 신경망을 구성하여 해결할 때 데이터에 따라 편향성이 나타나게 되어 정확도가 떨어지는 경우가 많다, 이를 해결하기 위해 다양한 인공 신경망을 결합하여 예측하면, 정확도를 보다 높일 수 있을 것이다. 그런데 다양한 인공 신경망의 모델을 결합하는 방법은 복수개의 개별 인공신경망 모델을 인공신경망 통합모델이 제어할 수 있는 환경을 구축한 후 학습을 수행한다. 그런데 이러한 신경망의 통합 모델을 실제 적용할 때 다음 과 같은 문제가 발생하게 된다.. 먼저, 각 단일 인공신경망 구축 자체가 복잡한 경우, 각 종류별로 각 인공신경망을 구축하게 되는데, 이때 서로 다른 개별 인공 신경망을 통일적으로 관리하기 위해서 개발 비용이나 유지 보수 비용이 급격하게 증가된다. 또한, 각 개별 인공신경망을 통합하여 동시에 학습을 할 경우 인공지능 서버에 부하가 걸리거나 주 메모리 공간 의 부족으로 학습 자체가 불가능 할 수 있다. 또한, 각 개별 인공신경망이 완성된 후 실제 통합 인공신경망을 훈련(training) 할 때, 각 단일 인공신경망에 인입되는 학습 데이터셋이 모두 동일한 순서대로 무작위로 셔플링(shuffling)되어 있어야 한다. 이것은 데이터 를 무작위로 셔플링 하지 않으면 인공신경망이 마지막으로 학습한 데이터에 맞춰 편향된 예측을 할 수 있기 때 문이다. 또한, 통합 인공신경망을 구현하는 개발자가 각 개별 인공신경망의 입력 데이터(학습 데이터 셋)의 구성과 데이 터형식(data format)을 파악하고 있어야 하며, 데이터 자체에 대한 제어권도 획득해야 한다. 따라서 위와 같은 어려움을 극복하고 투입되는 막대한 시간을 줄이고 전체 과정을 단순화하는 기술이 필요하다. 선행기술문헌 특허문헌 (특허문헌 0001) 한국 공개특허공보 제10-2018-0058648호(2018.06.01.공개) (특허문헌 0002) 한국 공개특허공보 제10-2019-0000167호(2019.01.02.공개) 비특허문헌 (비특허문헌 0001) http://dude.docking.org/ (비특허문헌 0002) Connolly, M. L., \"Analytical molecular surface calculation.\", J. Appl. Cryst. 1983, 16, 548-558"}
{"patent_id": "10-2019-0107483", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명의 목적은 상술한 바와 같은 문제점을 해결하기 위한 것으로, 타겟 단백질에 대한 화합물의 활성 여부를 예측하는 복수 개의 인공 신경망(Neural Network) 모델을 결합하기 위하여, 개별 인공신경망 모델을 통해 단백 질과 화합물의 반응 정도에 대해 확률분포 데이터를 출력하게 하고, 이를 학습 데이터로 활용하는 별도의 통합인공신경망을 구성하는, 복수의 인공신경망 모델 기반 단백질 결합 화합물의 활성 예측 시스템을 제공하는 것이다."}
{"patent_id": "10-2019-0107483", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "상기 목적을 달성하기 위해 본 발명은 복수의 인공신경망 모델 기반 단백질 결합 화합물의 활성 예측 시스템에 관한 것으로서, 단백질에 대한 화합물의 활성 데이터, 및, 단백질과 화합물의 3차원 형상 또는 3차원 구조 데이 터를 저장하는 데이터관리 모듈; 자신만의 개별 신경망 모듈을 구비하고, 단백질 또는 화합물의 3차원 형상 데 이터 또는 3차원 구조 데이터로부터 디스크립터를 추출하고, 추출한 디스크립터와 활성 데이터로 상기 개별 신 경망 모델을 학습시키고, 학습된 개별 신경망 모델에 적용하여 출력되는 2차 학습용 결과 데이터를 저장하는 개 별 신경망 모듈; 자신만의 통합 신경망 모듈을 구비하고, 각각의 개별 신경망 모듈에서 생성된 2차 학습용 결과 데이터를 통합하여 2차 학습데이터를 생성하고, 생성된 2차 학습데이터로 상기 통합 신경망 모델을 학습시키는 통합 신경망 모듈; 및, 질의 단백질과 질의 화합물에 대하여 상기 개별 신경망 모델 및 상기 통합 신경망 모델 을 이용하여 활성을 예측하는 활성예측 모듈을 포함하고, 상기 개별 신경망 모델은 적어도 2개 이상으로 구성되 어 하나의 개별 신경망 모듈 그룹을 형성하는 것을 특징으로 한다. 또한, 본 발명은 복수의 인공신경망 모델 기반 단백질 결합 화합물의 활성 예측 시스템에 있어서, 상기 개별 신 경망 모듈은 추출한 디스크립터와 활성 데이터로 1차 학습데이터를 생성하고, 1차 학습 데이터 중 일부로 상기 개별 신경망 모델을 학습시키고, 학습된 개별 신경망 모델에 1차 학습데이터 중 다른 일부를 적용하여 2차 학습 용 결과 데이터를 생성하는 것을 특징으로 한다. 또한, 본 발명은 복수의 인공신경망 모델 기반 단백질 결합 화합물의 활성 예측 시스템에 있어서, 상기 1차 학 습데이터는 단백질과 화합물의 식별정보, 단백질과 화합물에 대한 디스크립터와, 해당 단백질에 대한 해당 화합 물의 활성 데이터로부터 결정되는 라벨 값을 포함하고, 상기 개별 신경망 모듈은 1차 학습데이터의 각 데이터에 대하여 해당 데이터의 디스크립터를 상기 개별 신경망 모델에 적용하여 예측결과 데이터를 획득하고, 예측결과 데이터에 해당 1차 학습데이터의 해당 데이터의 라벨을 부여하여 2차 학습용 결과 데이터를 생성하고, 상기 2차 학습용 결과 데이터에 단백질과 화합물에 대한 식별정보를 포함시키는 것을 특징으로 한다. 또한, 본 발명은 복수의 인공신경망 모델 기반 단백질 결합 화합물의 활성 예측 시스템에 있어서, 상기 개별 신 경망 모델의 출력 데이터는 라벨 값의 확률 값으로 출력되고, 상기 통합 신경망 모듈은 2차 학습용 결과 데이터 를, 단백질과 화합물의 쌍을 기준으로 결합하여 통합시키되, 단백질과 화합물의 쌍이 일치하면 모든 개별 신경 망 모듈의 2차 학습용 결과 데이터를 하나의 데이터로 결합하여 2차 학습데이터를 생성하는 것을 특징으로 한다. 또한, 본 발명은 복수의 인공신경망 모델 기반 단백질 결합 화합물의 활성 예측 시스템에 있어서, 상기 개별 신 경망 모듈 그룹은 3차원 형상 데이터로부터 디스크립터를 생성하는 적어도 하나의 개별신경망 모듈과, 3차원 구 조 데이터로부터 디스크립터를 생성하는 적어도 하나의 개별신경망 모듈을 포함하는 것을 특징으로 한다. 또한, 본 발명은 복수의 인공신경망 모델 기반 단백질 결합 화합물의 활성 예측 시스템에 있어서, 상기 개별 신 경망 모듈은 푸리에 변환을 이용하여 3차원 형상 데이터에서 1차원 데이터를 추출하여 디스크립터로 생성하거나, 호몰로지를 이용하여 3차원 구조 데이터에서 2차원 이미지를 추출하여 디스크립터로 생성하거나, 3 차원 형상 데이터를 2차원 이미지로 투영하여 디스크립터를 생성하는 것을 특징으로 한다. 또한, 본 발명은 복수의 인공신경망 모델 기반 단백질 결합 화합물의 활성 예측 시스템에 있어서, 상기 3차원 형상 데이터는 닫힌 표면 데이터로서 닫힌 메쉬 표면(closed mesh surface)에 대한 3차원 데이터이고, 상기 3차 원 구조 데이터는 단백질 또는 화합물의 화학적 구조에서의 원자 위치에 대한 3차원 데이터로서 3차원 포인트로 구성되는 데이터인 것을 특징으로 한다."}
{"patent_id": "10-2019-0107483", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "상술한 바와 같이, 본 발명에 따른 복수의 인공신경망 모델 기반 단백질 결합 화합물의 활성 예측 시스템에 의 하면, 복수의 인공 신경망 모델을 이용하여 단백질과 화합물의 결합 정보를 학습하고 예측함으로써, 난이도가 높은 예측 문제에 대해서도 데이터에 따른 편향성을 줄이고 그 만큼 정확도를 높일 수 있는 효과가 얻어진다. 즉, 각 개별 인공신경망이 예측하지 못하는 영역을 향상된 변별력으로 구분할 수 있다.또한, 본 발명에 의하면, 각 인공신경망 모델을 독립적으로 학습시킴으로써, 전체 시스템의 가용 자원을 적절히 분배할 수 있고, 개발 및 유지 보수 비용을 대폭 줄일 수 있는 효과가 얻어진다. 본 발명에 따른 시스템에 의하면, 인공지능을 이용해 단백질과 화합물의 결합 정보를 학습하여 그 활성을 예측 함으로써, 단백질과 결합된 화합물의 구조 정보로부터 활성 화합물 후보를 대량으로 짧은 시간 내에 추출할 수 있는 효과가 얻어진다. 이를 통해, 실험적으로 테스트할 화합물을 빠르게 선정하여 유효물질 발굴에 걸리는 시 간과 비용을 대폭 단축시킬 수 있다."}
{"patent_id": "10-2019-0107483", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하, 본 발명의 실시를 위한 구체적인 내용을 도면에 따라서 설명한다. 또한, 본 발명을 설명하는데 있어서 동일 부분은 동일 부호를 붙이고, 그 반복 설명은 생략한다. 먼저, 본 발명을 실시하기 위한 전체 시스템의 구성의 예들에 대하여 도 1을 참조하여 설명한다. 도 1(a)와 1(b)에서 보는 바와 같이, 본 발명에 따른 복수의 인공신경망 모델 기반 단백질 결합 화합물의 활성 예측 시스템은 네트워크 상의 서버 시스템 또는 컴퓨터 단말 상의 프로그램 시스템으로 실시될 수 있다. 도 1(a)와 같이, 본 발명의 실시를 위한 전체 시스템의 일례는 분석 단말과 활성 예측 시스템으로 구성 되고 서로 네트워크로 연결된다. 또, 필요한 데이터를 저장하기 위한 데이터베이스를 더 구비할 수 있 다. 분석 단말은 신약개발 연구원 등 사용자가 이용하는 PC, 노트북, 넷북, PDA, 모바일 등의 통상의 컴퓨팅 단 말기이다. 사용자는 사용자 단말을 통해 타겟 단백질 및 화합물의 3차원 구조 등 데이터를 활성 예측 시스 템으로 전달하거나, 그 활성 예측 결과 값을 활성 예측 시스템으로부터 수신한다. 활성 예측 시스템은 통상의 서버로서 네트워크에 연결되어 인공신경망을 이용한 타겟 단백질에 대한 화 합물 활성 예측을 지원하는 서비스를 제공한다. 한편, 활성 예측 시스템은 상기 각 서비스를 인터넷 상의 웹페이지로 제공하는 웹서버 또는 웹어플리케이션 서버 등으로 구현될 수 있다. 또한, 활성 예측 시스템은 클라우드 시스템으로 구현되어, 클라우드 기반으로 학습이나 분석 기능을 수행하고 활성 예측 서비스를 제공할 수 있다. 데이터베이스는 활성 예측 시스템에서 필요한 데이터를 저장하는 통상의 저장매체로서, 타겟 단백질 또 는 화합물의 3차원 구조에 대한 데이터, 타겟 단백질과 화합물 간의 결합 등 활성 데이터를 저장한다. 한편, 데이터베이스는 이미 구축된 천연물이나 화학 합성물 라이브러리의 데이터를 가져와서 구축될 수 있 다. 구체적으로, 데이터베이스는 개별신경망 모델, 통합신경망 모델, 2차 학습용 결과 데이터를 저장하 는 2차 학습용 데이터 스토리지 등으로 구성될 수 있다. 그러나 상기 데이터베이스의 구성은 바람직한 일실시예일 뿐이며, 구체적인 시스템을 개발하는데 있어서, 접근 및 검색의 용이성 및 효율성 등을 감안하여 데 이터베이스 구축이론에 의하여 다른 구조로 구성될 수 있다. 한편, 활성 예측 시스템은 서버와 클라이언트로 구성된 서버-클라이언트 시스템으로 구성될 수 있다. 즉, 활성 예측 시스템의 디스크립터 생성, 주요 학습이나 분석 기능은 서버에 구축되고, 사용자 인터페이스 또 는 분석을 위한 간단한 전처리 작업 등은 분석 단말에 클라이언트 모듈로 구축될 수 있다. 서버와 클라이언 트 간의 작업 분담은 통상의 서버-클라이언트 구축 이론에 따라 다양한 형태로 구현될 수 있다. 또한, 활성 예측 시스템에서 학습 기능이나 예측 기능을 엔진 모듈로 구축되고, 분석 단말에 설치된 클 라이언트 서비스 모듈이 엔진 모듈을 이용하여, 사전에 수집된 데이터로 인공지능 모델을 학습시키고, 학습된 모델을 통해 타겟 단백질에 대한 화합물의 활성을 예측 서비스를 제공할 수 있다. 이 경우, 분석 단말은 또 다른 서버로서 역할을 수행할 수 있다. 또한, 도 1(b)와 같이, 본 발명의 실시를 위한 전체 시스템의 다른 예는 컴퓨터 단말에 설치되는 프로그램 형태의 활성 예측 시스템으로 구성된다. 즉, 활성 예측 시스템의 각 기능들은 컴퓨터 프로그램으로 구 현되어 컴퓨터 단말에 설치되어, 컴퓨터 단말 상의 프로그램 시스템으로 실시될 수 있다. 컴퓨터 단말 에 설치된 프로그램은 하나의 프로그램 시스템과 같이 동작할 수 있다. 한편, 활성 예측 시스템에 서 필요한 데이터들은 컴퓨터 단말의 하드디스크 등 저장공간에 저장되어 이용된다. 한편, 다른 실시예로서, 복수의 인공신경망 모델 기반 단백질 결합 화합물의 활성 예측 시스템은 프로그램으로 구성되어 범용 컴퓨터에서 동작하는 것 외에 ASIC(주문형 반도체) 등 하나의 전자회로로 구성되어 실시될 수 있 다. 또는 화합물 활성을 예측하는 것만을 전용으로 처리하는 전용 컴퓨터 단말로 개발될 수도 있다. 이를 활성 예측 시스템라 부르기로 한다. 그 외 가능한 다른 형태도 실시될 수 있다. 다음으로, 본 발명의 일실시예에 따른 복수의 인공신경망 모델 기반 단백질 결합 화합물의 활성 예측 시스템의 구성을 도 2를 참조하여 설명한다. 도 2에서 보는 바와 같이, 본 발명에 따른 복수의 인공신경망 모델 기반 단백질 결합 화합물의 활성 예측 시스 템은 단백질에 대한 화합물의 활성 데이터 또는 단백질/화합물의 3차원 데이터를 관리하는 데이터관리 모듈 , 3차원 데이터로부터 디스크립터를 생성하고 디스크립터와 활성 데이터로 1차 학습데이터를 생성하여 개별 신경망 모델을 학습시키고 2차 학습데이터를 생성하는 개별 신경망 모듈, 다수의 개별 신경망 모델(3 3)로 구성된 개별 신경망 모델 그룹, 2차 학습데이터로 2차 신경망 모델을 학습시키는 통합 신경망 모 듈, 및, 검사대상 단백질(또는 질의 단백질)과 검사대상 화합물(또는 질의 화합물)에 대하여 개별 신경망 모델 및 통합 신경망 모델을 이용하여 활성을 예측하는 활성예측 모듈로 구성된다. 먼저, 데이터관리 모듈은 단백질에 대한 화합물의 활성 데이터를 수집하거나, 단백질과 화합물의 3차원 형 상 또는 3차원 구조 데이터를 형성하여 관리한다. 활성 데이터는 특정 타겟 단백질에 대하여 특정 화합물이 활성 화합물(active)인지, 또는 비활성 화합물 (inactive)인지를 나타내는 데이터이다. 즉, 단백질과 화합물의 결합의 활성 여부가 이미 알려진 데이터이다. 단백질 또는 화합물에 대한 3차원 형상 데이터 또는 3차원 구조 데이터는 단백질 또는 화합물의 3차원 형상이나 구조를 나타내는 3차원 데이터이다. 이때, 단백질 또는 화합물은 앞서 수집된 활성 데이터에 속하는 타겟 단백 질 또는 화합물들이다.다음으로, 개별 신경망 모듈은 자신만의 신경망 모델(또는 개별 신경망 모듈)을 구비하고, 단백질 또는 화합물의 3차원 형상 데이터 또는 3차원 구조 데이터로부터 디스크립터를 추출하고, 추출한 디스크립터와 활성 데이터로 1차 학습데이터를 생성하고, 1차 학습 데이터 중 일부로 개별 신경망 모델을 학습시키고, 학습된 개별 신경망 모델에 1차 학습데이터 중 다른 일부를 적용하여 2차 학습용 결과데이터를 생성한다. 또한, 개별 신경망 모듈은 다수 개로 구성되어 하나의 그룹, 즉, 개별 신경망 모듈 그룹으로 구성된다. 특히, 개별신경망 모듈은 디스크립터를 추출하는 방식에 따라 다수 개가 구비될 수 있다. 즉, 디스크립터를 추출하는 방식은 각 개별신경망 모듈에 따라 고유하다. 한편, 바람직하게는, 개별 신경망 모듈 그룹은 3차원 형상 데이터로부터 디스크립터를 생성하는 적어도 하 나의 개별신경망 모듈과, 3차원 구조 데이터로부터 디스크립터를 생성하는 적어도 하나의 개별신경망 모듈 로 구성한다. 즉, 단백질 및 화합물의 3차원 형상과 3차원 구조를 모두 반영함으로써, 활성 예측을 보다 정 확하게 분류할 수 있다. 바람직하게는, 디스크립터는 1차원 데이터 또는 2차원 이미지 데이터로 구성된다. 즉, 개별신경망 모듈은 3 차원 형상 데이터 또는 3차원 구조 데이터로부터 1차원 데이터 또는 2차원 이미지 데이터를 추출하여, 이를 디 스크립터로 활용한다. 또한, 개별신경망 모듈은 단백질과 화합물의 디스크립터와, 단백질에 대한 화합물의 활성 데이터로 1차 학 습데이터를 생성한다. 즉, 단백질과 화합물의 쌍에 대한 디스크립터와, 해당 단백질에 대한 해당 화합물의 활성 데이터를 해당 디스크립터에 라벨링함으로써 1차 학습데이터를 생성한다. 즉, 활성 데이터가 라벨(label)로 사 용된다. 1차 학습데이터는 2개의 그룹으로 구분되어, 하나의 그룹은 자신의 개별신경망 모델을 학습시키기 위해 사 용되고, 다른 하나의 그룹은 2차 학습용 결과 데이터를 생성하기 위해 사용된다. 즉, 개별신경망 모듈은 1차 학습데이터 중 일부(또는 첫번째 그룹)로 자신의 개별 신경망 모델을 학습 시킨다. 이때, 첫 번째 그룹은 그 내에서 학습용 데이터와 검증용 데이터(또는 테스트용 데이터) 등으로 분할될 수 있다. 또한, 개별신경망 모듈은 학습된 개별 신경망 모델에 두 번째 그룹을 적용하여, 2차 학습용 결과 데이 터를 생성한다. 즉, 두 번째 그룹의 1차 학습데이터의 각 데이터에 대하여 해당 데이터의 디스크립터를 개별 신 경망 모델에 적용하여 예측결과 데이터를 획득하고, 예측결과 데이터에 해당 데이터(1차 학습데이터)의 라 벨(해당 디스크립터의 라벨)을 부여하여 2차 학습용 결과 데이터를 생성한다. 또한, 해당 데이터(1차 학습 데이터)의 단백질과 화합물에 대한 정보(또는 식별정보)를 2차 학습용 결과 데이터 에 함께 포함시킨다. 즉, 2차 학습용 결과 데이터는 단백질과 화합물에 대한 정보(아이디 등 식별정보), 예측결과 데이터, 라벨로 구 성된다. 다음으로, 개별 신경망 모델은 개별신경망 모듈에서 구비된 신경망 모델로서, DNN(Deep Neural Network) 또는 딥러닝 모델, 순환형 신경망(RNN), 합성곱 신경망(CNN) 등이 적용될 수 있다. 디스크립터가 2차 원 이미지인 경우, 바람직하게는, 합성곱 신경망(CNN)을 사용한다. 개별 신경망 모델의 입력 데이터는 단백질의 디스크립터와 화합물의 디스크립터이고, 출력 데이터는 라벨 값(범주 값)의 확률 값이다. 즉, 출력 데이터는 각 라벨 값의 확률 값으로 출력된다. 각 개별신경망 모델의 예측 결과값의 개수, 즉, 출력하는 라벨(Label)에 대한 확률의 개수는 범주 값(Label)의 개수와 동일하다. 바람 직하게는, 출력 데이터의 라벨 값(또는 범주값)은 활성(active)과 비활성(inactive)이다. 개별신경망 모델은 데이터의 수치를 예측하는 회귀(regression) 형태와 데이터의 특정 범주를 예측하는 분 류(Classification) 형태로 구분된다. 바람직하게는, 개별신경망 모델의 출력은 분류(Classification) 형 태로 구성된다. 특히, 개별신경망 모델은 각 데이터(또는 분류를 나타내는 라벨 값)에 대한 예측 가능성을 표현할 수 있는 소프트맥스(softmax) 값으로 계산하여 출력한다. 소프트맥스 값을 구하기 위한 소프트맥스(softmax) 함수는 다 음과 같다.[수학식 1]"}
{"patent_id": "10-2019-0107483", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "여기서, xi는 최종 출력 값이고, k+1은 범주 개수를 나타낸다. e는 오일러 상수 또는 자연상수이다. 즉, 소프트맥스(softmax) 함수의 결과값은 예측하고자 하는 범주(또는 라벨값)의 개수와 동일한 크기의 1차원 벡터로, 각 값을 모두 더하면 1.0이 되는 일종의 확률분포이다."}
{"patent_id": "10-2019-0107483", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "다음으로, 통합 신경망 모듈는 자신만의 신경망 모델(또는 통합 신경망 모듈)을 구비하고, 각각의 개별 신경망 모듈에서 생성된 2차 학습용 결과 데이터를 통합하여 2차 학습데이터를 생성하고, 생성된 2차 학습 데이터로 통합 신경망 모델을 학습시킨다. 즉, 통합 신경망 모듈은 각 개별 신경망 모듈이 생성한 2차 학습용 결과 데이터를, 단백질과 화합물의 쌍을 기준으로 결합하여 통합시킨다. 즉, 단백질과 화합물의 쌍이 동일하면, 서로 다른 개별 신경망 모듈의 2차 학습용 결과 데이터를 하나의 데이터로 결합하여 통합한다. 특히, 단백질과 화합물의 하나의 쌍에 대하여, 모든 개별 신경망 모듈의 2차 학습용 결과 데이터를 결합하여 2차 학습데이터를 생성한다. 앞서 설명한 바와 같이, 개별 신경망 모델의 결과 데이터는 소프트맥스(softmax) 함수의 결과 값으로 출력 된다. 따라서 통합 신경망 모듈는 각 개별신경망 모델이 출력하는 소프트맥스(softmax) 함수의 결과값 을 수집하고, 그 소프트맥스 결과값을 결합하여 2차 학습데이터를 형성한다. 또한, 2차 학습데이터는 단백질과 화합물의 각 식별정보도 함께 포함하여 구성된다. 따라서 2차 학습데이터는 단백질과 화합물의 각 식별정보와, 해당 단백질과 화합물에 대한 모든 개별신경망 모델의 예측 결과값, 해 당 단백질과 화합물의 활성 데이터(또는 라벨 값)로 구성된다. 또한, 통합 신경망 모듈는 통합하여 생성된 2차 학습데이터를 이용하여 통합 신경망 모델을 학습시킨다. 이때, 2차 학습데이터는 그 내에서 학습용 데이터와 검증용 데이터(또는 테스트용 데이터) 등으로 분할될 수 있다. 다음으로, 통합신경망 모델은 통합 신경망 모듈에서 구비된 신경망 모델로서, DNN(Deep Neural Network) 또는 딥러닝 모델, 순환형 신경망(RNN), 합성곱 신경망(CNN) 등이 적용될 수 있다. 디스크립터 또는 입력 데이터는 1차원 데이터를 사용한다. 바람직하게는, 통합신경망 모델은 FNN(Fully-connected Neural Network)을 이용하여 구성한다. 통합신경망 모델에 입력되는 각 데이터를 구성하는 원소의 개수(feature 수)는 다음과 같이 구할 수 있다. 입력데이터 특징(feature) 수 = (각 개별신경망의 수) × (라벨의 수) 다음으로, 활성예측 모듈는 검사대상 단백질(또는 질의 단백질)과 검사대상 화합물(또는 질의 화합물)에 대 하여 개별 신경망 모델 및 통합 신경망 모델을 이용하여 활성을 예측한다. 즉, 활성예측 모듈는 질의 단백질과 질의 화합물에 대한 3차원 데이터를 데이터관리 모듈에 요청하고, 이를 개별 신경망 모듈로 전달하거나 전달하게 한다. 또한, 활성예측 모듈는 질의 단백질과 질의 화합물의 3차원 데이터를, 학습된 개별 신경망 모델에 적용 하여 1차적으로 활성 결과를 예측하도록, 개별 신경망 모델에 요청한다. 이때, 개별 신경망 모델은 3차 원 데이터로부터 디스크립터를 생성하고, 생성된 디스크립터를 개별 신경망 모델에 적용하여 1차 예측결과 를 산출한다. 이때, 활성예측 모듈는 모든 개별 신경망 모듈에, 질의 단백질과 질의 화합물에 대한 예측을 요청하고, 모든 예측결과를 통합 신경망 모듈에 전달하거나 전달하게 한다. 또한, 활성예측 모듈은 질의 단백질과 질의 화합물의 1차 예측결과에 대하여 통합 신경망 모델을 적용 하여, 2차 예측을 요청한다. 이때, 통합 신경망 모듈는 모든 개별 신경망 모델의 1차 예측결과를 모두 획득하면, 다수의 1차 예측결과를 통합하고, 통합된 데이터를 통합 신경망 모델에 적용하여, 최종적인 2차예측을 출력한다. 한편, 개별신경망 모듈들과, 통합신경망 모듈은 서로 독립적인 시스템으로 구축될 수 있다. 이때, 바람 직하게는, 2차 학습용 데이터 스토리지 등 데이터베이스를 통해 데이터를 주고 받을 수 있다. 다음으로, 본 발명의 일실시예에 따른 데이터관리 모듈의 구성에 대하여 도 3을 참조하여 보다 구체적으로 설명한다. 도 3에서 보는 바와 같이, 데이터관리 모듈은 활성데이터를 수집하는 활성데이터 수집부, 및, 3차원 형성 데이터 또는 3차원 구조 데이터를 생성하는 3D데이터 형성부로 구성된다. 먼저, 활성데이터 수집부은 각 타겟 단백질에 대한 각 화합물의 활성 데이터를 수집한다. 활성 데이터는 특정 타겟 단백질(또는 표적 단백질) Pi에 대하여 특정 화합물 Cj이 활성 화합물(active)인지, 또 는 비활성 화합물(inactive)인지를 나타내는 데이터이다. 즉, 활성 데이터는 { ( Pi, Cj, Aij ) }로 구성된다. 이때, Aij 는 활성화 또는 비활성화 값(이진 값)을 갖는다. 한편, 활성 데이터는 타겟 단백질에 대한 화합물의 활성 정도를 나타내는 활성값으로 표시될 수 있다. 이 경우, 사전에 정해진 기준값(또는 임계값)을 기준으로 활성 또는 비활성으로 구분될 수 있다. 활성화(active)는 타겟 단백질 Pi에 대하여 특정 화합물 Cj가 결합하였다는 것을 의미하고, 비활성화(inactive) 는 그러하지 않다는 것을 나타낸다. 바람직하게는, 활성데이터 수집부은 사전에 구축된 활성데이터의 데이터셋으로부터 활성데이터를 수집할 수 있다. 일례로서, DUD-E(A Database of Useful Decoys: Enhanced)[비특허문헌 1]에서 제공하는 데이터셋을 사용한다. DUD-E 데이터셋은 총 102개의 타겟 단백질에 대한 총 22,146개의 활성(active) 화합물(타겟 단백질당 평균 217 개의 활성 화합물)과, 비활성(inactive) 화합물 대신 각 활성(active)에 대해 5~60여개씩 만들어진 디코이 (decoy) 화합물을 제공한다. 이 중 4개의 타겟 단백질은 부적합성 등의 이유로 제거하였고, 남은 98개 단백질에 대한 데이터가 본 발명의 실험에 사용되었다. DUD-E 데이터셋의 용도는 벤치마크 데이터셋이다. 디코이 화합물은 이론상 비활성 화합물일 가능성이 높은 구조의 화합물로서, 현실적으로 비활성 화합물에 대한 데이터를 수집하기 곤란한 점을 반영한다. 즉, 활성 화합물에 대비되어 구별되게 하기 위한 목적으로 표준 데이 터 설계자들이 구성한 화합물 데이터이다. 디코이 화합물은 실질적으로는 비활성 화합물에 준하는 용도로 사용 된다. 다음으로, 3D데이터 형성부는 단백질 또는 화합물에 대한 3차원 형상 데이터 또는 3차원 구조 데이터를 형 성한다. 이때, 단백질 또는 화합물은 앞서 수집된 활성 데이터에 속하는 타겟 단백질 또는 화합물들이다. 먼저, 3차원 형상 데이터를 형성하는 방법을 설명한다. 3차원 형상 데이터는 닫힌 표면 데이터로서, 바람직하게 는, 닫힌 메쉬 표면(closed mesh surface)에 대한 3차원 데이터이다. 바람직하게는, 3D데이터 형성부는 코놀리 표면[비특허문헌 2]을 이용하여, 타겟 단백질 또는 화합물의 3차 원 형상을 형성한다. 구체적으로, 단백질 또는 화합물에 대한 코놀리 표면을 구하고, 코놀리 표면으로부터 3차 원 형상 데이터를 생성한다. 즉, 도 4에서 보는 바와 같이, 코놀리 표면 생성 방법을 통해 단백질과 화합물의 3 차원 데이터로부터 각각이 가지는 3차원 형상을 추출한다. 바람직하게는, 코놀리 표면 생성방법을 통해 추출되 는 것이 표면의 3차원 위치정보이고, 그 위치 정보를 그물망(mesh) 구조의 삼각형을 이루는 꼭지점들의 3차원 좌표로 나타낸다. 즉, 그물망 구조에 의한 꼭지점들의 집합이 3차원 형상을 나타낸다. 코놀리 표면은 분자를 구성하는 각 원자의 반데르 발스(van der Waals) 반지름을 바탕으로 용매가 접근 가능한 범위를 나타내는 표면을 말한다. 즉, 코놀리 표면은 단백질 또는 화합물이 차지하는 공간에 대한 형상을 나타낸 다. 바람직하게는, 3D데이터 형성부는 단백질의 경우에는 단백질의 기질 결합부위의 표면만을 추출하고, 추출된 표면에 대한 3차원 형상을 추출한다. 즉, 단백질의 전체 형상이 필요한 것이 아니라 화합물에 상보적인 기질 결 합부위의 형상만이 필요한 것이므로, 단백질의 기질 결합부위의 표면만을 따로 추출하여도 된다. 즉, 단백질과 화합물(ligand)가 결합된 상태에서, 화합물의 표면 원소 좌표를 기준으로, 일정 범위(사전에 정해 진 거리) 이내에 들어오는 단백질의 바인딩 사이트(binding-site) 또는 결합 부위 정보를 추출한다. 또한, 추출 된 바인딩 사이트에서 폐곡면을 유지하면서, 3차원 형상 데이터를 생성한다. 바람직하게는, 3D데이터 형성부는 추출된 표면을 삼각 그물망 구조(triangular mesh)로 변환하고, 면과 꼭 지점의 정보를 통합하고 변환하여 3차원 형상을 생성한다. 다음으로, 3차원 구조 데이터를 형성하는 방법을 설명한다. 3차원 구조 데이터는 단백질 또는 화합물의 화학적 구조에서의 원자 위치에 대한 3차원 데이터로서, 3차원 점 또는 포인트로 구성되는 데이터이다. 바람직하게는, 3D데이터 형성부는 단백질 또는 화합물의 몰(mol) 파일로부터, 화학적 결합 구조의 3차원 구조 데이터를 형성한다. 3차원 구조 데이터의 각 포인트는 3차원 상의 원자 위치를 나타낸다. 또한, 바람작하 게는, 단백질과 화합물이 결합된 상태에서의 원자 위치를 3차원 점 데이터로 추출한다. 이때, 몰(mol) 파일은 사전에 제공되는(만들어진) 데이터를 이용하거나, 가상 결합을 통해 생성된 데이터를 이 용한다. 즉, 화합물 또는 단백질이 실제 실험을 통한 결정구조(crystal structure)를 가지고 있는 경우, 화합물 또는 단백질의 각 원소의 위치정보가 몰(mol) 파일 형태로 제공된다. 이 경우, 제공된 몰(mol) 파일을 사용한다. 또한, 화학 결합 시뮬레이션 도구(예를 들어, 오토도킹 autodocing 프로그램) 등을 이용하여, 화합물과 단백질 을 가상으로 결합하고, 결합된 가상 3차원 화학적 구조로부터 3차원 점 데이터를 형성한다. 특히, 가상 결합을 한 후, 스코링 함수(scoring function)를 통한 최적의 포지셔닝(최적의 결합 상태)을 얻은 후, 이때의 위치정보 를 몰(Mol) 파일로 저장한다. 특히, 3D데이터 형성부는 단백질과 화합물의 3차원 결합 구조에서, 각각 단백질과 화합물의 3차원 구조 데 이터(또는 3차원 점 데이터)를 추출한다. 바람직하게는, 단백질 또는 화합물의 각 원자 별로 별도의 3차원 구조 데이터를 추출한다. 또한, 더욱 바람직하게는, 주요 원자에 대해서만, 각 원자 별로 3차원 구조 데이터를 추출 하고, 주요 원자 및 나머지 모든 원자에 대하여 3차원 점 데이터를 추출할 수도 있다. 일례로서, 단백질은 C(탄소), N(질소), O(산소), S(황)의 4가지 원자로 구성된다. 따라서 단백질의 각 원자별로 4개의 3차원 구조 데이터를 추출한다. 화합물은 C(탄소), N(질소), O(산소)의 주요 원자와, 그외 다양한 원자를 포함할 수 있다. 따라서 화합물은 C(탄소), N(질소), O(산소)의 주요 원자에 대해서, 각 원자별로 3개의 3차원 점 데이터를 추출하고, 주요 원자 및 그외 모든 원자의 3차원 구조 데이터를 추출한다. 따라서 따라서 전체적으 로, 모두 8개의 3차원 구조 데이터를 추출한다. 또한, 바람직하게는, 3D데이터 형성부는 단백질의 3차원 구조 데이터를 추출할 때, 화합물과 결합하는 단 백질의 부위 근처의 원자 위치만을 추출하여 3차원 구조 데이터를 추출한다. 즉, 화합물과의 결합 부위에서 소 정의 거리 내에 위치한 원자들의 위치만을 추출하여 3차원 구조 데이터를 형성한다. 다음으로, 본 발명의 일실시예에 따른 개별신경망 모듈의 세부 구성을 도 3을 참조하여 보다 구체적으로 설 명한다. 도 3에서 보는 바와 같이, 개별신경망 모듈은 3차원 데이터에서 디스크립터를 추출하는 디스크립터 추출부 , 개별신경망 모델을 학습시키는 개별모델 학습부, 및, 2차 학습용 결과데이터를 생성하는 결과 데이터 생성부로 구성된다. 먼저, 디스크립터 추출부은 단백질 또는 화합물의 3차원 데이터에서 1차원 데이터 또는 2차원 이미지 데이 터를 생성한다. 각 개별신경망 모듈에 따라 디스크립터를 산출하는 방식이 다르다. 구체적으로, 푸리에 변환을 이용한 방식, 호몰로지를 이용한 방식, 기하학적 이미지 변환을 이용한 방식 등 3가 지 방식으로 구분된다. 푸리에 변환 방식은 3차원 형상 데이터로부터 1차원 데이터의 디스크립터를 추출한다. 또한, 호몰로지 방식은 3차원 구조 데이터로부터 2차원 이미지의 디스크립터를 생성한다. 또한, 기하학적 이미 지 변환 방식은 3차원 형상 데이터로부터 2차원 이미지의 디스크립터를 추출한다. 먼저, 푸리에 변환 방식에 대하여 설명한다. 다음으로, 푸리에 변환(fourier transform, FT)은 함수 또는 신호를 그 함수를 구성하고 있는 주파수 성분들의 합으로 표현하는 방법이다. 변환된 함수는 주파수의 복소함수가 되고, 그의 절대값은 원래 함수를 구성하는 주 파수 성분의 양을 나타낸다. 먼저, 디스크립터 추출부은 단백질 또는 화합물에 대해 추출된 3차원 형상 데이터를 구성하는 각 좌표를, 구면 조화 함수(spherical harmonics)를 통해 구면 좌표계로 변환한다. 즉, 3차원 형상 데이터의 좌표 (x,y,z)를 구면 좌표계의 좌표 (θ,φ,r)로 변환된다. 다음으로, 디스크립터 추출부은 구면 좌표계의 좌표 데이터 (θ,φ,r)에 대해, 푸리에 변환을 이용하면, 다음 식과 같이 기저함수와 그의 계수들의 합으로 표현할 수 있다. [수학식 2]"}
{"patent_id": "10-2019-0107483", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "여기서, Yl,k 는 기저함수를 나타내고, cl,k 는 기저함수 Yl,k 에 대한 푸리에 계수를 나타낸다. l은 디그리 (degree)를 나타내고, k는 차수(order)를 나타낸다. L은 디그리(degree)의 크기를 나타낸다. L이 클수록 오차를 적게 근사할 수 있다. 즉, 모든 구면 좌표 (θ,φ,r)에 대해, r = f(θ,φ)로 나타나는데, 이때, 푸리에 변환을 적용하면, r = f(θ, φ)는 기저함수 Yl,k(θ,φ) 의 가중치(푸리에 계수에 의한 가중치) 합으로 표현될 수 있다. 바람직하게는, 도 5에서 보는 바와 같이, 앞서 푸리에 변환을 통해 구한 푸리에 계수 cl,k 들을 1차원 벡터 (c0,0, c1,-1, cl,0, cl,1, c2,-2, c2,-1, c2,0, c2,1, c2,2, c3,-3, ..., cL,L)로 만들어, 만들어진 1차원 벡터를 디스크립터로 생성한다. 즉, 위와 같은 변환을 통해 단백질과 화합물의 3차원 구조는 푸리에 계수에 의한 1차원 벡터로 변환되었다. 더욱 바람직하게는, 푸리에 계수를 먼저 디그리(l)가 작은 수부터, 다음으로 차수(k)가 작은 수부터 순서대로로 나열한다. 다음으로, 호몰로지를 이용한 디스크립터 추출 방식에 대하여 설명한다. 호몰로지를 이용한 방식은 단백질 또는 화합물의 3차원 구조 데이터에 대해 호몰로지(homology)를 이용하여 디 스크립터(descriptor)를 산출한다. 3차원 구조 데이터는 단백질 또는 화합물의 원자 또는 분자 구조에 대한 3차원 데이터이다. 즉, 3차원 구조 데 이터는 유한개의 3차원 상의 점 데이터(또는 포인트 데이터)들의 집합이다. 각 포인트는 원자의 위치를 나타낸 다. 즉, 3차원 구조 데이터에 호몰로지(homology)를 적용하여, 2차원의 퍼시스턴스 다이어그램(persistence diagram)를 추출하고, 퍼시스턴스 다이어그램을 2차원 이미지로 변환하여 디스크립터로 사용한다. 구체적으로, 먼저, 3차원 구조 데이터에 호몰로지를 적용하여 퍼시스턴스 정보를 추출한다. 즉, 실수인 변수 r 값을 준 다음, 이 값을 순차적으로 0부터 증가시켜가며 점 집합의 연결 상태를 변화시킨다. 두 점의 연결상태는 다음과 같이 판단한다. 각 점을 원점으로 하는 반지름이 r인 3차원 구를 그린다. 각 r에 대 해 다음을 판단한다. 만약 두 구가 교차하는 부분이 있을 경우 두 점은 연결된 것으로 간주한다. 아닐 경우에는 연결되지 않은 것으 로 간주한다. 두 점이 연결되었을 경우 두 점을 잇는 변을 생성한다. 만약 세 변이 서로 연결되어 삼각형을 이룰 경우, 이를 변으로 하는 삼각형을 만든다. 만약 네 삼각형이 서로 연결되어 사면체를 이룰 경우, 이를 면으로 하는 속이 꽉 찬 사면체를 만든다. 위 과정을 통해 각 r에 대해, 주어진 점 데이터로부터, 0차원 복합체(simplex)(점), 1차원 복합체(변), 2차원 복합체(삼각형), 3차원 복합체(사면체)로 구성된 복합체(simplicial complex)를 얻는다. 즉, 주어진 r에서의 복합체 M에 대한 호몰로지 Hr(M)를 계산한다. 다음으로, 각 차원 복합체에 대한 호몰로지 그룹을 생성한다. 즉, 0차원 호몰로지 그룹, 1차원 호몰로지 그룹, 및 2차원 호몰로지 그룹을 생성한다.그리고 각 차원의 호몰로지 그룹에 대해 생성자의 개수를 구한다. 호몰로지 그룹은 유한 개의 생성자에 의해 만 들어지는 그룹이다. 호몰로지 그룹의 생성자 또는 생성자들은 해당 차원의 복합체의 구성 형태에 따라 새로 생 성되거나 소멸된다. 호몰로지 그룹은 해당 차원에서 싸이클(cycle)을 형성하여 경계가 없는 복합체들로 구성된다. 즉, 0차원에서는 각 점이 싸이클을 형성하여, 0차원 호몰로지 그룹은 각 점들로 구성된다. 1차원 호몰로지 그룹은 링(ring)을 형 성하는 1차원 복합체(변)들로 구성된다. 또한, 2차원 호몰로지 그룹은 내부 공간이 있는 폐곡면 형태로 연결되 는 2차원 복합체(삼각형)들로 구성된다. 생성자는 해당 차원에서의 각 싸이클에 해당되며, 생성자의 개수는 해 당 차원에서의 싸이클 개수를 나타낸다. 한편, 2차원(상위차원)의 복합체(삼각형)를 구성하는 1차원(하위 차원) 복합체(변)들은 링을 형성한다. 그러나, 호몰로지 그룹은 상위 차원의 복합체를 구성하는 하위 차원의 복합체 집합에 의해 쿼오션트 그룹(quotient)으로 형성되므로, 해당 하위 차원의 복합체들은 하나의 복합체로 합동(congruence)된다. 따라서 2차원 복합체(삼각형)를 형성하는 1차원 복합체(변)들이 링을 형성하더라도 1차원 호몰로지 그룹에서 제외된다. 한편, 특정 r에서 새로운 생성자에 대한 생성 시기(rS)를 기록하고, 이 생성자가 사라질 때 그 생성자에 대한 소멸 시기(rE)를 기록한다. 이 기록들을 모두 모아 다이어그램으로 나타낸 것이 퍼시스턴스 다이어그램(persistence diagram)이다. 퍼시스 턴스 다이어그램(persistence diagram)을 나타내는데 필요한 데이터(persistence information)는 다음과 같이 나타난다. 퍼시스턴스 정보 = { (d, (rS, rE)) } 여기서, d는 해당 생성자의 차원이다. rS 과 rE 는 각각 해당 생성자의 생성시기와 소멸 시기이다. 즉, r을 순차 적으로 증가시키는데, r = rS 일때 해당 생성자가 생성되고, r = rE 일때 해당 생성자가 소멸된다. 일례로서, 퍼시스턴스 정보는 다음과 같이 구해질 수 있다. 퍼시스턴스 정보 = {(0,(0 ,0.8)),…,(1,(0.4,0.9))} 즉, 하나의 퍼시스턴스 정보 (0, (0, 0.8))는 해당 생성자가 0차원이고, r = 0일 때 생성되었다가, r = 0.8 일 때 소멸되었다는 것을 나타낸다."}
{"patent_id": "10-2019-0107483", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 5, "content": "다음으로, 퍼시스턴스 정보를 퍼시스턴스 다이어그램(persistence diagram)으로 나타낸다. 퍼시스턴스 다이어그램의 x 축과 y 축은 각각 생성 시기와, 소멸 시기를 나타낸다. 그리고 각 퍼시스턴스 정보 를 퍼시스턴스 다이어그램에 점(포인트)으로 표시한다. 이때, 점(포인트)의 위치는 (x,y)는 (rS,rE)에 해당하고, 포인트의 값은 차원으로 표시한다. 바람직하게는, 포인트의 값인 차원을 색상으로 표시한다. 일례로서, 빨간색은 0차원 생성자, 초록색은 1차원 생 성자, 파란색은 2차원 생성자를 나타낸다. 퍼시스턴스 다이이어그램의 일례가 도 6에 도시되고 있다. 다음으로, 퍼시스턴스 다이어그램(persistence diagram)으로부터 2차원의 호몰로지 이미지를 생성하여, 이를 디 스크립터로 사용한다. 바람직하게는, 퍼시스턴스 다이어그램에 가우시안 매핑(Gaussian mapping)을 적용하여, 점의 밀도에 따라 값을 차등적으로 부여한다. 호몰로지 이미지의 일례가 도 7에 도시되고 있다. 다음으로, 기하학적 이미지 변환을 이용한 디스크립터 추출 방식에 대하여 설명한다. 기하학적 이미지 변환 방식은 단백질 또는 화합물의 3차원 형상 데이터에서 2차원 기하학적 이미지를 생성하고, 2차원 기하학적 이미지를 디스크립터(descriptor)로 추출한다. 도 8에서 보는 바와 같이, 디스크립터 추출부은 3차원 형상 데이터를 구면에 매핑시키는 구형 매개변수화 (Spherical Parameterization) 단계(S31), 오탈릭 매핑을 통해 구면 상의 형상 데이터를 보정하는 오탈릭 매개 변수화(Authalic Parameterization) 단계(S32), 보정된 구면 상의 형상 데이터를 팔면체의 표면 상에 매핑하는 팔면체 매개변수화(Octahedron Parameterization) 단계(S33), 팔면체 상의 형상 데이터를 2차원 사각형에 매핑 하는 사각형 매개화변수화(Square Parameterization) 단계(S34), 및, 2차원 기하학적 디스크립터를 생성하는 단 계(S35)를 수행하여, 2차원 기하학적 이미지를 디스크립터로 산출한다. 도 9는 구형 메쉬(spherical mesh)에 매핑(mapping)된 꼭지점(vertex) 정보를 활용하여 최종적인 2D 기하학 이 미지를 산출하는 형태를 나타낸 그림이다. 먼저, 구형 매개변수화(Spherical Parameterization)를 이용하여, 3차원 형상 데이터를 구면(spherical surface) 상에 매핑시킨다(S31). 이때, 3차원 형상 데이터는 3D데이터 형성부에서 형성한 단백질 또는 화합물의 형상 또는 표면에 대한 3차 원 데이터이다. 특히, 3차원 형상 데이터는 삼각 그물망 구조(triangular mesh)로 표현된 표면 데이터로서, 각 삼각형의 꼭지점(vertex) 데이터들이다. 즉, 3차원 형상 데이터는 꼭지점의 3차원 좌표들로 구성된다. 따라서 3차원 형상 데이터의 각 꼭지점을 구면 상에 매핑시킨다. 도 9의 예를 참조하면, (a) 3차원 형상 데이터에서, (b) 구면 상의 데이터로 매핑하는 것과 같다. 다음으로, 오탈릭 매개변수화(Authalic Parameterization)를 통해 구면 상의 형상 데이터를 보정한다(S32). 즉, 3차원 형상 데이터에서의 각 메쉬(mesh)의 면적이, 이에 대응하는 구면(spherical surface) 상의 메쉬의 면적에 보전되도록, 구면 상의 데이터를 보정한다. 즉, 면적왜곡비율이 최소화되도록 보정한다. 즉, 구면 상에 매핑된 3차원 형상 데이터의 오리지날 메쉬(original mesh)의 꼭지점(vertex) 정보를 면적 왜곡 비율(areal distortion ratio)를 최소화하여 구형 메쉬(spherical mesh)에 보정하여 매핑(mapping)한다. 다음으로, 구면 상의 보정된 형상 데이터를 정팔면체의 표면 상에 매핑한다(S33). 즉, 팔면체 매개변수화 (Octahedron Parameterization)를 통해, 구면 상의 형상 데이터(또는 메쉬)를 8면체의 도메인으로 변환한다. 바람직하게는, 8면체는 정팔면체이다. 도 9의 예를 참조하면, (b) 구면 상의 데이터에서, (c) 8면체 상의 데이터로 매핑하는 것과 같다. 다음으로, 팔면체 상의 형상 데이터를 2차원의 사각형에 매핑한다(S34). 즉, 변환된 8면체를 편평(flatten)하여 2차원 사각형에 매핑한다. 바람직하게는, 2차원 사각형은 N×N의 정사각 형으로 형성한다. 일례로서, N은 128로 설정한다. 한편, 8면체의 각 표면의 8개의 삼각형을 조합하여 2차원 기하학적 이미지로 형성한다. 바람직하게는, 8면체의 각 표면의 8개의 삼각형을 직각 이등변 삼각형으로 변환하고, 이들 직각 이등변 삼각형을 서로 조합하여 사각형 또는 정사각형을 형성한다. 특히, 2D 이미지 또는 사각형 이미지는 에지(edge)와 코너(corner) 부분의 이미지 끊김 현상을 방지하기 위해, 8면체의 도메인에 해당하는 각각의 삼각형을 상하를 회전시킨 복사본을 이어 붙여, 각각의 정사각형 형태를 이 루게 한다. 도 9의 예를 참조하면, (c) 8면체 상의 데이터에서, (d) 정사각형 상의 데이터로 매핑하는 것을 도시하고 있다. 다음으로, 매핑된 2차원 사각형에 대해 2차원 기하학적 이미지의 디스크립터를 생성한다(S35). 앞서 단계들에서, 3차원 형상 데이터, 구면 상의 매핑 데이터, 보정된 구면 상의 매핑 데이터, 8면체 상의 매핑 데이터, 2차원 사각형 상의 매핑 데이터로 서로 일대일 매핑 관계를 갖는다. 따라서 3차원 형상 데이터와 2차원 사각형은 서로 매핑되고, 특히, 3차원 형상 데이터의 각 꼭지점은 2차원 사각형의 각 꼭지점에 매핑된다. 2차원 이미지 또는 사각형의 각 픽셀의 픽셀 값을 픽셀 위치에 매핑되는 3차원 형상 데이터의 위치에서의 3차원 형상의 특징값(또는 기하학적 특성값)으로 설정한다. 즉, 2차원 이미지(또는 2차원 사각형)의 픽셀 위치 (x',y')는 3차원 형상 데이터의 한 점 (x,y,z)에 매핑된다. 꼭지점이 아닌 픽셀의 경우는, 보간법 등에 의해 대 응되는 위치를 찾을 수 있다. 바람직하게는, 3차원 형상 데이터의 기하학적 특성값은 3차원 x축의 x좌표값, y축의 y좌표값, z축의 z좌표값, 주곡률값(최대 곡률값, 최소 곡률값) 등 어느 하나 이상을 사용한다. 바람직하게는, 5개의 기하학적 특성값을모두 사용한다. 한편, 각 기하학적 특성값은 픽셀의 수치 범위(0~255)로 정규화(normalization) 될 수 있다. 따라서 각 기하학적 특성값을 픽셀값으로 갖는 2차원 기하학적 이미지를 각 기하학적 특성값 별로 생성한다. 바 람직하게는, 모두 K개(예를 들어, 5개)의 2차원 기하학적 이미지가 생성된다. 다음으로, 개별모델 학습부는 추출한 단백질과 화합물의 디스크립터와, 단백질에 대한 화합물의 활성 데이 터로 1차 학습데이터를 생성하고, 1차 학습데이터 중 일부로 자신의 개별 신경망 모델을 학습시킨다. 특히, 개별모델 학습부는 단백질의 디스크립터와, 화합물의 디스크립터가 별도로 구성되는 경우, 단백질과 화합물의 쌍에 대하여 해당 단백질의 디스크립터와 화합물의 디스크립터를 결합하여 전체 디스크립터를 형성한 다. 예를 들어, 푸리에 방식의 경우, 전체 디스크립터는 타겟 단백질과 그에 대응하는 화합물에 대한 각기 n개의 원 소를 가진 두 벡터가 하나로 합쳐져 최종적으로 2n개의 원소를 가진 1차원 벡터이다. 또한, 호몰리지 방식의 경우, 전체 디스크립터는 타겟 단백질의 호몰로지 이미지와, 그에 대응하는 화합물에 대 한 호몰로지 이미지를 결합한 이미지이다. 또한, 기하학적 변환 방식의 경우, 전체 디스크립터는 픽셀 값을 3차원 형상 데이터의 기하학적 특성값(정규화 된 특성값)으로 갖는 K개의 2차원 기하학적 이미지이며, 단백질과 화합물의 각각을 결합한 이미지이다. K개는 기하학적 특성값의 개수(종류의 개수)이다. 이하에서, 설명의 편의를 위하여, 전체 디스크립터를 디스크립터와 혼용한다. 또한, 개별모델 학습부는 단백질과 화합물의 쌍에 대한 디스크립터(또는 전체 디스크립터)와, 해당 단백질 에 대한 해당 화합물의 활성 데이터를 해당 디스크립터에 라벨링함으로써 1차 학습데이터를 생성한다. 즉, 활성 데이터가 라벨(label)로 사용된다. 또한, 개별모델 학습부는 1차 학습데이터를 2개의 그룹으로 분할한다. 하나의 그룹(또는 첫 번째 그룹)은 자신의 개별신경망 모델을 학습시키기 위해 사용되고, 다른 하나의 그룹(또는 두 번째 그룹)은 2차 학습용 결과 데이터를 생성하기 위해 사용된다. 또한, 개별모델 학습부는 1차 학습데이터 중 일부(또는 첫번째 그룹)로 자신의 개별 신경망 모델을 학 습시킨다. 이때, 첫 번째 그룹은 그 내에서 학습용 데이터와 검증용 데이터(또는 테스트용 데이터) 등으로 분할 될 수 있다."}
{"patent_id": "10-2019-0107483", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 6, "content": "다음으로, 결과데이터 생성부는 학습된 개별 신경망 모델에 두 번째 그룹을 적용하여, 2차 학습용 결 과 데이터를 생성한다. 즉, 두 번째 그룹의 1차 학습데이터 중 디스크립터를 개별 신경망 모델에 적용하여 예측결과 데이터를 획득하고, 예측결과 데이터에 해당하는 1차 학습데이터의 라벨(해당 디스크립터의 라벨)을 부여하여 2차 학습용 결과 데이터를 생성한다. 즉, 2차 학습용 결과 데이터는 단백질과 화합물에 대한 정보(아이디 등 식별정보), 예측결과 데이터, 라벨로 구 성된다. 즉, 각 예측결과 데이터를 식별하기 위하여, 각 데이터에 대해 데이터 식별번호 역할을 하는 단백질 ID 와 화합물 ID가 있어야 한다 특히, 개별신경망 모델은 각 데이터(또는 분류를 나타내는 라벨 값)에 대한 예측 가능성을 표현할 수 있는 소프트맥스(softmax) 값으로 계산하여 출력한다. 따라서 예측결과 데이터는 활성 또는 비활성의 확률 값(또는 소프트맥스 값)으로 구성된다. 다음으로, 본 발명의 일실시예에 따른 통합 신경망 모듈의 세부 구성에 대하여 도 3을 참조하여 보다 구체 적으로 설명한다. 도 3에서 보는 바와 같이, 통합 신경망 모듈은 각 개별 신경망 모듈에서 생성한 2차 학습용 결과 데이 터를 통합하여 2차 학습데이터를 생성하는 데이터 통합부, 및, 2차 학습데이터로 통합 신경망 모델을 학습시키는 통합모델 학습부로 구성된다. 먼저, 데이터 통합부는 생성한 2차 학습용 결과 데이터를, 단백질과 화합물의 쌍을 기준으로 결합하여 통 합시킨다. 즉, 단백질과 화합물의 쌍이 동일하면, 서로 다른 개별 신경망 모듈의 2차 학습용 결과 데이터를 하 나의 데이터로 결합하여 통합한다. 특히, 단백질과 화합물의 하나의 쌍에 대하여, 모든 개별 신경망 모듈의 2차 학습용 결과 데이터를 결합하여 2차 학습데이터를 생성한다. 단백질과 화합물의 쌍(또는 그 식별정보)에 의하여 결합되므로 각 개별신경망 모듈이 출력하는 데이터의 순서는 반드시 일치할 필요는 없다. 바람직하게는, 데이터 통합부는 각 개별신경망 모델이 출력하는 소프트맥스(softmax) 함수의 결과값을 수집하고, 그 소프트맥스 결과값을 결합하여 2차 학습데이터를 형성한다. 즉, 각 개별신경망 모델에서 출력 한 소프트맥스(softmax) 값이 수집되면 데이터 식별번호(단백질ID와 화합물ID 등)을 기준으로 통합된다. 또한, 2차 학습데이터는 단백질과 화합물의 각 식별정보도 함께 포함하여 구성된다. 따라서 2차 학습데이터는 단백질과 화합물의 각 식별정보와, 해당 단백질과 화합물에 대한 모든 개별신경망 모 델의 예측 결과값, 해당 단백질과 화합물의 활성 데이터(또는 라벨 값)로 구성된다. 특히, 예측 결과값은 소프트맥스(softmax) 함수의 결과값이다. 2차 학습데이터의 예시가 도 10의 표에 도시되고 있다. 도 10은 라벨의 범주가 2가지이고, 각 개별신경망 모델 이 3개의 경우를 예시하였다. 라벨의 범주의 개수와 개별신경망 모델의 개수는 가변적으로 적용할 수 있다. 다음으로, 통합모델 학습부는 통합하여 생성된 2차 학습데이터를 이용하여 통합 신경망 모델을 학습시 킨다. 이때, 2차 학습데이터는 그 내에서 학습용 데이터와 검증용 데이터(또는 테스트용 데이터) 등으로 분할될 수 있다."}
{"patent_id": "10-2019-0107483", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 7, "content": "다음으로, 본 발명의 효과를 도 11 내지 도 13을 참조하여 설명한다. 앞서 설명한 바와 같이, 통합 신경망 모듈에서 개별 신경망 모듈에서 출력한 소프트맥스(softmax) 값을 독립적으로 수집하고, 수집한 데이터를 통합하면 된다. 따라서 각 개별신경망 모듈의 개발 일정이 상이하여 도, 개별신경망 모듈이 데이터를 생산하는 대로 통합신경망 모델을 학습하면 된다. 또한, 개별 데이터 를 확보한 이후에는 개별신경망 모델 또는 개별신경망 모듈과 분리하여 통합신경망 모델을 훈련할 수 있다. 본 발명에 따른 활성 예측 시스템은 다음과 같은 효과가 얻어진다. 즉, 전체 개발기간 및 개별 인공신경망 학습시간을 단축시킬 수 있다. 또한, 인공지능 서버 시스템의 사용 효율성을 제고할 수 있다. 즉, 개별 인공신경망을 동시에 학습시키지 않고, 시스템이 가용한 시간에 학습시킬 수 있다. 또한, 개별 인공신경망을 동시에 메모리에 적재할 필요가 없으므로 시스템 가용성이 향상된다. 또한, 도 11 내지 도 13에서 보는 바와 같이, 비활성(Inactive)에 대한 변별력을 향상시킬 수 있음을 확인하였 다(여기서는 개별 인공지능모델을 2개 적용한 실례를 보여줌). 본 발명은 복수개의 개별 인공신경망을 학습한 결과를 출력 받은 후 해당 출력파일을 통합하여 별도의 통합 인 공신경망(앙상블, Ensemble)을 구성하여 데이터 예측 가능성을 향상시키는 방법을 구현하였다. 본 발명은 단백 질과 화합물의 3차원 구조를 표현하는 디스크립터(descriptor) 기법에 국한하지 않고 분류(Classification) 유 형의 인공신경망을 통합하는 분야에 모두 적용이 가능하다. 이상, 본 발명자에 의해서 이루어진 발명을 실시 예에 따라 구체적으로 설명하였지만, 본 발명은 실시 예에 한 정되는 것은 아니고, 그 요지를 이탈하지 않는 범위에서 여러 가지로 변경 가능한 것은 물론이다."}
{"patent_id": "10-2019-0107483", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본"}
