{"patent_id": "10-2008-0135027", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2009-0071502", "출원번호": "10-2008-0135027", "출원인": "넷시큐어테크놀러지 주식회사", "발명자": "천성훈"}}
{"patent_id": "10-2008-0135027", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "지능형 소프트웨어 로봇을 이용하여 위협을 탐지함에 있어서,외부 또는 주변환경으로부터 데이터를 수집, 가공 및 축약 등의 전처리하는 수집시스템(collection system);위 수집시스템에서 전달되는 데이터를 대상으로 비정상탐지, 오용탐지 및 추론탐지에 의하여 데이터를 탐지하는탐지시스템(detection system);상기 수집시스템 및 탐지시스템에서 받은 데이터 및 정보로부터 선호도 및 규칙을 생성하고, 모니터링하기 위한위협수준 및 정책조정의 기본 값을 생성하는 적응시스템(adaptation system);상기 수집시스템, 탐지시스템 및 적응시스템으로부터 데이터 및 규칙 등을 받아서 위협여부를 감시하고 경보,보고 또는 감사의 행동지침을 생성하는 모니터링시스템(monitoring system); 및위 모니터링시스템으로부터 생성된 행동지침에 따라 경보, 보고 또는 감사(audit)를 수행하는 대응시스템(response system);으로 구성된 것을 특징으로 하는 지능형 소프트웨어 로봇의 행동특성을 이용한 위협탐지 시스템."}
{"patent_id": "10-2008-0135027", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제 1항에 있어서,상기 수집시스템은 외부환경 또는 주변환경의 네트워크에서 발생하는 패킷(packet), 트래픽(traffic), 이벤트(event) 또는 로그(log) 등의 데이터를 수집하고, 정규화(문자열 재정열, 축약 등) 및 재조합하는 기능을 수행하는 에이전트(agent)부;위 에이전트부에서 가공된 데이터를 이용하여 상태벡터(status vector)와 긴급값(urgent value)을 생성하고 관리하는 벡터화(vectorization)부; 및위 에이전트부 및 벡터화부에서 가공된 데이터 중에서 우선처리 되어야 하는 관심대상을 정하고, 정해진 대상에적합하지않는 행동을 차단(제외)시키는 값을 벡터화하는 우선벡터(priority vector) 기능을 하는 포커스셀렉터(focus selector);로 이루어진 것을 특징으로 하는 지능형 소프트웨어 로봇의 행동특성을 이용한 위협탐지 시스템."}
{"patent_id": "10-2008-0135027", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제 2항에 있어서,상기 탐지시스템은 오용엔진(misuse engine), 비정상엔진(anomaly engine) 및 추론엔진(deduction engine)으로구성되며, 상기 벡터화부에서 생성된 상태벡터와 상기 패킷(packet), 트래픽(traffic), 이벤트(event) 또는 로그(log) 등을 선택적으로 입력을 받아 위협을 탐지하는 것을 특징으로 하는 지능형 소프트웨어 로봇의 행동특성을 이용한 위협탐지 시스템."}
{"patent_id": "10-2008-0135027", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제 1항에 있어서,상기 적응시스템은 선호도학습부(preference learner)와 규칙생성부(rule maker)로 구성되며, 이 선호도학습부는 모니터링 대상에 대한 선택 또는 주의정보 등을 조절하여 모니터링 대상에 대한 위협탐지 선호도를 학습할수 있도록 하며, 규칙생성부는 관리자가 직접 설정한 규칙을 보관하고 적용하는 것을 특징으로 하는 지능형 소프트웨어 로봇의 행동특성을 이용한 위협탐지 시스템."}
{"patent_id": "10-2008-0135027", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "지능형 소프트웨어 로봇을 이용하여 위협을 탐지함에 있어서,- 3 -공개특허 10-2009-0071502외부환경 또는 주변환경의 네트워크에서 발생하는 패킷(packet), 트래픽(traffic), 이벤트(event) 또는 로그(log) 등의 데이터를 수집하고, 정규화(문자열 재정열, 축약 등) 및 재조합하는 기능을 수행하는 에이전트(agent)부,위 에이전트부에서 가공된 데이터를 이용하여 상태벡터(status vector)와 긴급값(urgent value)을 생성하고 관리하는 벡터화(vectorization)부, 및위 에이전트부 및 벡터화부에서 가공된 데이터 중에서 우선처리 되어야 하는 관심대상을 정하고, 정해진 대상에적합하지 않는 행동을 차단(제외)시키는 값을 벡터화하는 우선벡터(priority vector) 기능을 하는 포커스셀렉터(focus selector),로이루어져 외부 또는 주변환경으로부터 데이터를 수집, 가공 및 축약 등의 전처리하는 수집시스템(collectionsystem);오용엔진(misuse engine), 비정상엔진(anomaly engine) 및 추론엔진(deduction engine)으로 구성되며, 위 벡터화부에서 생성된 상태벡터와 위 패킷(packet), 트래픽(traffic), 이벤트(event) 또는 로그(log) 등을 선택적으로 입력을 받아 위 수집시스템에서 전달되는 데이터를 대상으로 비정상탐지, 오용탐지 및 추론탐지에 의하여 데이터의 위협을 탐지하는 탐지시스템(detection system);모니터링 대상에 대한 선택 또는 주의정보 등을 조절하여 모니터링 대상에 대한 위협탐지 선호도를 학습할 수있도록 하는 선호도학습부(preference learner),와관리자가 직접 설정한 규칙을 보관하고 적용하는 규칙생성부(rule maker)로 구성되며,상기 수집시스템 및 탐지시스템에서 받은 데이터 및 정보로부터 선호도 및 규칙을 생성하고 모니터링하기 위한위협수준 및 정책조정의 기본 값을 생성하는 적응시스템(adaptation system);상기 수집시스템, 탐지시스템 및 적응시스템으로부터 데이터 및 규칙 등을 받아서 감시하고, 경보, 보고 또는감사의 행동지침을 생성하는 모니터링시스템(monitoring system); 및위 모니터링시스템으로부터 생성된 행동지침에 따라 경보, 보고 또는 감사(audit)를 수행하는 대응시스템(response system);으로 구성된 것을 특징으로 하는 지능형 소프트웨어 로봇의 행동특성을 이용한 위협탐지 시스템"}
{"patent_id": "10-2008-0135027", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "지능형 소프트웨어 로봇을 이용하여 위협을 탐지함에 있어서,네트워크에서 발생하는 패킷(packet), 트래픽(traffic), 이벤트(event) 또는 로그(log) 등의 데이터를 수집, 가공 및 축약 등의 전처리하는 데이터 수집단계;위 수집단계에서 전처리된 데이터를 대상으로 비정상탐지, 오용탐지 및 추론탐지에 의하여 데이터를 탐지하는탐지단계;위 수집단계에서 전처리 받은 데이터 및 위 탐지단계에서 발생한 정보로부터 선호도 및 규칙을 생성하고, 그리고 모니터링하기 위한 위협수준 및 정책조정의 기본 값을 생성하는 적응단계;위 수집단계, 탐지단계 및 적응단계로부터 데이터 및 규칙 등을 받아서 경보, 보고 또는 감사의 행동지침을 생성하는 모니터링단계; 및위 모니터링단계에서 생성된 행동지침에 따라 경보, 보고 또는 감사(audit)를 수행하는 대응단계;로 이루어진 것을 특징으로 하는 지능형 소프트웨어 로봇의 행동특성을 이용한 위협탐지 방법."}
{"patent_id": "10-2008-0135027", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제 6항에 있어서,상기 수집단계가 네트워크에서 발생하는 패킷(packet), 트래픽(traffic), 이벤트(event) 또는 로그(log) 등의데이터를 수집하는 제1-1단계;위 수집된 데이터의 문자열을 정규화/필터링 및 재조합하여 재정열하는 제1-2단계;- 4 -공개특허 10-2009-0071502위 정규화/필터링 및 재조합된 문자열을 축약하는 제1-3단계; 및위 축약하는 단계에서 축약된 스칼라 데이터를 가공하여 상태벡터(status vector)와 긴급값(urgent value)을 생성하고 관리하여 중요도 데이터를 생성하고, 또한 우선순위에 따라 정렬된 데이터를 생성하고 이 데이터를 상기탐지단계로 전달하는 제1-4단계;로 이루어진 것을 특징으로 하는 지능형 소프트웨어 로봇의 행동특성을 이용한 위협탐지 방법."}
{"patent_id": "10-2008-0135027", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제 7항에 있어서,상기 탐지단계가 상기 제1-3단계에서 축약된 데이터 및 상기 제1-4단계에서 생성된 중요도 데이터 중에서 우선처리 되어야 하는 관심대상을 정하고, 정해진 대상에 적합하지않는 행동을 차단(제외)시키는 값을 우선벡터(priority vector)화 하여 선별된 데이터를 상기 모니터링단계 및 적응단계로 전달하는 제2-1단계;위 제2-1단계에서 생성된 우선순위에 따라 정렬된 데이터에서 비정상 및 오용탐지를 위하여 프로파일(profile)과 패턴(pattern)을 비교하여 비정상 및 오용 데이터에 대한 정보를 생성하는 제2-21단계;위 2-21단계에서 생성된 정보를 상태벡터에 적용하여 일반적 위협정보인 위협상태벡터(threat status vector)를생성하는 제2-31단계;위 제2-1단계에서 생성된 우선순위에 따라 정렬된 데이터를 이용하여 추론벡터(deduction vector)를 생성하여추론탐지를 준비하는 제2-22단계;위 제2-22단계에서 생성된 추론벡터를 이용하여 선호도(preference)가 포함된 추론벡터를 생성하는 제2-32단계;및위 제2-31단계 및 제2-32단계에서 생성된 정보를 이용하여 위협정보를 파악하여 상기 모니터링단계로 전달하는제2-4단계;로 이루어진 것을 특징으로 하는 지능형 소프트웨어 로봇의 행동특성을 이용한 위협탐지 방법."}
{"patent_id": "10-2008-0135027", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제 8항에 있어서,상기 적응단계가 상기 제2-1단계에서 선별된 데이터를 이용하여 선호도를 계산하는 제3-1단계위 계산된 선호도 정보를 정책에 따라 선택하거나 또는 주의정보를 분배하여 상기 탐지단계로 전달하는 제3-2단계; 및상기 제2-1단계에서 선별된 데이터를 관리자의 설정규칙과 비교하여 해당규칙에 일치하는 데이터를 상기 모니터링단계로 전달하는 제3-3단계;로 이루어진 것을 특징으로 하는 지능형 소프트웨어 로봇의 행동특성을 이용한 위협탐지 방법."}
{"patent_id": "10-2008-0135027", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제5항의 시스템을 이용하여 지능형 소프트웨어 로봇을 이용하여 위협을 탐지함에 있어서,상기 수집시스템의 에이전트부에서 네트워크에서 발생하는 패킷(packet), 트래픽(traffic), 이벤트(event) 또는로그(log) 등의 데이터를 수집하는 제1단계;위 수집된 데이터를 상기 에이전트부에서 문자열을 정규화/필터링 및 재조합하여 재정열하는 제2단계;위 정규화/필터링 및 재조합된 문자열을 축약하는 제3단계;위 제3단계에서 축약된 스칼라 데이터를 상기 벡터화부에서 가공하여 상태벡터(status vector)와 긴급값(urgentvalue)을 생성하고 관리하여 중요도 데이터를 생성하고 또한 우선순위에 따라 정렬된 데이터를 생성하고 이 데이터를 상기 탐지시스템으로 전달하는 제4단계;상기 포커스셀렉터에서 위 제3단계에서 축약된 데이터 및 위 제4단계에서 생성된 중요도 데이터 중에서 우선처리 되어야 하는 관심대상을 정하고, 정해진 대상에 적합하지않는 행동을 차단(제외)시키는 값을 우선벡터- 5 -공개특허 10-2009-0071502(priority vector)화 하여 선별된 데이터를 상기 모니터링시스템 및 적응시스템으로 전달하는 제5단계;위 제5단계에서 생성된 우선순위에 따라 정렬된 데이터를 상기 탐지시스템에서 비정상 및 오용탐지를 위하여 프로파일(profile)과 패턴(pattern)을 비교하여 비정상 및 오용 데이터에 대한 정보를 생성하는 제6-1단계;위 제6-1단계에서 생성된 정보를 를 상태벡터에 적용하여 일반적 위협정보인 위협상태벡터(threat statusvector)를 생성하는 제7-1단계;위 제5단계에서 생성된 우선순위에 따라 정렬된 데이터를 이용하여 상기 탐지시스템에서 추론벡터(deductionvector)를 생성하여 추론탐지를 준비하는 제6-2단계;위 제6-2단계에서 생성된 추론벡터를 이용하여 선호도(preference)가 포함된 추론벡터를 생성하는 제7-2단계;위 제7-1단계 및 제7-2단계에서 생성된 정보를 이용하여 위협정보를 파악하여 상기 모니터링시스템으로 전달하는 제8단계;상기 수집시스템에서 전달되어오는 선별된 데이터(제5단계)를 상기 선호도학습부에서 선호도를 계산하는 제9단계위 계산된 선호도 정보를 정책에 따라 선택하거나 또는 주의정보를 분배하여 상기 탐지시스템 및 모니터링시스템으로 전달하는 제10단계;상기 수집시스템에서 전달되어오는 선별된 데이터(제5단계)를 상기 규칙생성부에서 관리자의 설정규칙과 비교하여 해당규칙에 일치하는 데이터를 상기 모니터링시스템으로 전달하는 제11단계; 및위 제5단계, 제8단계 및 제11단계에서 정보를 전달받은 상기 모니터링시스템에서 그 정보를 바탕으로 위협여부에 대한 행동지침을 상기 대응시스템에 전달하는 제12단계; 및위 제12단계에서의 행동지침을 전달받은 상기 대응시스템에서 경보, 보고 또는 감사(audit)를 수행하는 제13단계;로 이루어진 것을 특징으로 하는 지능형 소프트웨어 로봇의 행동특성을 이용한 위협탐지 방법."}
{"patent_id": "10-2008-0135027", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "제 1항, 제 5항 및 제 6항 중 어느 한 항에 있어서,상기 추론 값은 OS(Operating System), CPU, 메모리, 인터페이스, 트래픽(traffic), 취약점, IDS 로그(log),방화벽 로그, 라우터 로그, 시스템 로그, 테스트인터페이스 또는 테스트 트래픽의 정보와 같은 데이터 값을 추론벡터로서 구할 수 있으며, 이 추론 값을 모니터링시스템에서 보내서 위협여부를 판단하게 하는 것을 특징으로하는 지능형 소프트웨어 로봇의 행동특성을 이용한 위협탐지 방법."}
{"patent_id": "10-2008-0135027", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제 1항, 제 5항 및 제 6항 중 어느 한 항에 있어서,상기 위협수준 및 정책조정의 기본 값은 규칙차단 및 선택행렬을 생성한 후, 수학식 10에서 추론 벡터를 이용하여 일반적인 위협정보를 구하고, 이 일반적인 위협정보를 이용하여 수학식 11에서 수학식 10에서 생성한 값을곱하여 실질적 위협정보를 획득하여 모니터링을 위한 위협수준 및 정책조정의 기본 값을 생성하는 것을 특징으로 하는 지능형 소프트웨어 로봇의 행동특성을 이용한 위협탐지 방법."}
{"patent_id": "10-2008-0135027", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "제 1항, 제 5항 및 제 6항 중 어느 한 항에 있어서,상기 선호도 및 규칙은 추론에 대한 선호도로서, 가중치를 두어 위협으로 판단할 것인 지 여부를 판단할 수 있는 기준값으로서, 고정된 값이 아니라 학습 또는 경험에 의하여 강화 또는 약화되는 값이며, 수학식 7은 추론에대한 선호도를 구하는 식으로서 강화 또는 약화될 수 있으며, 강화 또는 약화되는 강도의 변화량은 수학식 8에서 구할 수 있고, 차단하여야 할 위협정보인지 아니면 차단되지 않아도 될 위협정보인지는 수학식 9에 의하여생성되어 규칙을 설정하는 것을 특징으로 하는 지능형 소프트웨어 로봇의 행동특성을 이용한 위협탐지 방법.- 6 -공개특허 10-2009-0071502명 세 서발명의 상세한 설명 기 술 분 야본 발명은 정보시스템을 마비시키거나 또는 파괴하는 등의 사고를 일으킬 수 있는 위협을 탐지하는 방법 및 이 <1>방법을 실현하기 위한 시스템에 관한 것으로서, 감정을 가지고서 의사소통과 상호작용이 가능하고 스스로 학습할 수 있는 지능형 소프트웨어 로봇의 행동특성을 이용하여 변화하는 주변환경에 적응하고 변형되는 각종 위협에 대응할 수 있는 탐지방법 및 이를 위한 시스템에 관한 것이다. 배 경 기 술본 발명에서 정보시스템이라 함은 정보에 대해 저장, 계산, 분배 및 통신 등을 통칭하는 것이며, 위협(threat) <2>은 정보시스템의 취약한 부분을 공격하여 시스템 내부에 침입하거나, 침입하여 시스템을 마비 또는 파괴하는 등의 침해사고를 유발하게 하는 모든 행위를 말한다.또한 일반적으로 지능형 소프트웨어 로봇(Intelligent Software Robot)은 프로그램의 일종으로서 그 특징은 1) <3>사용자와 의사소통하여 상호작용을 할 수 있으며, 2) 같은 조건에서도 다양한 행동을 할 수 있는 감정이있으며, 3) 설계 시 미처 고려하지 못한 환경에서도 잘 적응할 수 있는 스스로 학습능력이 있어서 설계 시 설정하여 놓은 조건에 대응하면서도 조건의 변화에 스스로 대처할 수 있는 인공지능 프로그램을 총칭하는 것이다.한편 정보시스템은 각종 통신망에 의하여 전 세계적으로 연결이 되어 있으므로 누구든지 이 정보시스템에 접촉 <4>할 수 있는 접근의 자유성과 더불어 이 자유성을 저해하거나 정보를 오용될 가능성 또한 높다. 즉 공개된 정보는 누구라도 접근하여 이를 사용할 수 있는 것이지만 이러한 공개된 정보를 권한 없는 자가 수정하거나 기밀을요구하는 정보를 무단으로 열람하여서는 아니 되며 정당한 권한이 있는 자가 요청하는 서비스는 권한에 맞게 제공되어야 한다.그리하여 현재의 정보시스템은 이러한 정보의 접근 자유성과 이 자유성의 차단이라는 양면의 칼과도 같은 개념 <5>을 동시에 유지하여야 하는 어려움과 고가의 비용이 소요되고 있다.정보시스템의 운영자(관리자)들은 일명 보안시스템을 운영하여 정보 접근의 자유성을 차단하고 있으나, 이러한 <6>차단을 고의적으로 깨뜨려서 정보의 무결성, 기밀성 및 가용성을 해하거나 또는 고의적으로 접근의 자유성을 차단하여 일반 사용자들로 하여금 정보에 접근할 수 없도록 하고 있으며 이러한 고의적인 행위에 대한 결과는 상상을 초월할 정도가 되는 경제적 손실과 정신적인 손실까지 유발하는 심각한 상황에 이르고 있다.위의 고의적인 행위는 사이버 위협, 사이버테러, 사이버침해, 사이버침입 또는 사이버공격 등으로 다양하게 불 <7>리고 있으며 보통 침입 또는 위협이라고 하고, 이러한 행위를 유발하는 것으로서는 해킹, 컴퓨터 바이러스, 스팸메일 등이 그 일 예이다.일반적으로 위와 같은 고의적인 행위를 사전에 차단하는 것을 보안시스템이라고 하고 있으며, 이러한 고의적인 <8>행위인 침입 또는 위협을 탐지하기 위한 종래의 보안 시스템으로서 위협탐지시스템(위협탐지엔진)을 도 1에 도시하였는 바, 정보시스템에 접근하는 접근데이터를 수집하는 수집시스템(collection system), 이 수집된 접근데이터를 탐지하는 탐지시스템(detection system), 위 수집시스템에서 전달되는 접근데이터의 상태정보와 탐지시스템을 통하여 전달되는 탐지정보로서 접근데이터를 감시하는 모니터링시스템(monitoring system) 및 이 모니터링시스템에서 전달되는 대응정보(접근데이터의 허(許) 또는 불허(不許), 위협정도 판단 등)를 운영자가 처리할수 있도록 사용자 시스템에 전달하는 대응시스템(response system)으로 구성되어 있다.이러한 종래 시스템은 이미 진행된 위협(침입)을 판단하여 동일 또는 유사한 위협에 대하여 대응(방어)하도록 <9>하는 사후적인 대응이 이루어지고 있으며, 이 사후적인 대응이 운영자(관리자)에 의하여 분석되고 적용되어야하는 시간적인 지체가 발생하여 즉각적인 대응을 할 수 없는 문제점이 있으며, 주변환경과는 무관하게 동일한대응정보(접근데이터에 대한 허/불허 규칙(rule) 등)를 적용하게 되므로 특정장치 또는 특정 소프트웨어의 유무와 상관없이 동일한 규칙이 적용되어 이미 없는 시스템에 대한 방어를 계속함으로써 자원이 낭비되는 문제점이있으며, 새로이 도입된 시스템에 대해서는 전혀 방어를 하지 않게 되어 침입을 방관하게 되는 문제점이 있다. 발명의 내용- 7 -공개특허 10-2009-0071502 해결 하고자하는 과제본 발명은 상기와 같은 즉각적이지 않는 종래 시스템의 사후대응 및 주변환경 미적용과 같은 문제점을 해결하기 <10>위하여 주변환경에 적응하고 이와 상호작용하는 방법 및 시스템을 제공하여 자동화된 탐지정책의 갱신 및 수립이 가능하도록 하는 것을 과제로 한다. 과제 해결수단상기한 과제를 해결하기 위하여 본 발명의 지능형 소프트웨어 로봇은 <11>외부 또는 주변환경으로부터 데이터를 수집, 가공 및 축약 등의 전처리를 수행하는 수집시스템(collection <12>system);위 수집시스템에서 전달되는 데이터를 대상으로 비정상탐지, 오용탐지 및 추론탐지에 의하여 전처리 데이터를 <13>탐지하는 탐지시스템(detection system);상기 수집시스템 및 탐지시스템에서 받은 데이터 및 정보로부터 선호도 및 규칙을 생성하고 모니터링하기 위한 <14>위협수준 및 정책조정의 기본 값을 생성하는 적응시스템(adaptation system);상기 수집시스템, 탐지시스템 및 적응시스템으로부터 데이터 및 규칙 등을 받아서 행동하는 모니터링시스템 <15>(monitoring system); 및위 모니터링시스템으로부터 받은 행동지침에 따라 경보, 보고 또는 감사(audit)를 수행하는 대응시스템 <16>(response system);으로 구성된다. <17>상기에서 적응시스템이 생성한 데이터는 상기 수집시스템으로 피드백(feed back)되며, 그리고 상기 모니터링시 <18>스템과 대응시스템도 상호작용을 한다. 즉 적응시스템에서는 수집시스템으로부터 데이터 및 정보 등을 받아 규칙 등을 생성하여 이러한 규칙 등을 다시 수집시스템으로 피드백하여 적용할 수 있도록 하고, 대응시스템에서이루어진 행동을 모니터링시스템에서 다시 모니터링 할 수 있도록 하여 상호보완할 수 있도록 한다.상기에서 수집시스템은 외부환경 또는 주변환경의 네트워크에서 발생하는 패킷(packet), 트래픽(traffic), 이벤 <19>트(event) 또는 로그(log) 등의 데이터를 수집하고, 정규화(문자열 재정열, 축약 등) 및 재조합하는 기능을 수행하는 에이전트(agent)부;위 에이전트부에서 가공된 데이터를 이용하여 상태벡터(status vector)와 긴급값(urgent value)을 생성하고 관 <20>리하는 벡터화(vectorization)부; 및위 에이전트부 및 벡터화부에서 가공된 데이터 중에서 우선처리 되어야 하는 관심대상을 정하고, 정해진 대상에 <21>적합하지않는 행동을 차단(제외)시키는 값을 벡터화하는 우선벡터(priority vector) 기능의 포커스셀렉터(focusselector);로 이루어져 있다.상기 탐지시스템은 오용엔진(misuse engine), 비정상엔진(anomaly engine) 및 추론엔진(deduction engine)으로 <22>구성되며, 상기 벡터화부에서 생성된 상태벡터와 상기 패킷(packet), 트래픽(traffic), 이벤트(event) 또는 로그(log) 등을 선택적으로 입력을 받아 위협을 탐지한다.상기 적응시스템은 선호도학습부(preference learner)와 규칙생성부(rule maker)로 구성되며, 이 선호도학습부 <23>는 모니터링 대상에 대한 선택 또는 주의정보 등을 조절하여 모니터링 대상에 대한 위협탐지 선호도를 학습할수 있도록 하며, 규칙생성부는 관리자가 직접 설정한 규칙을 보관하고 적용한다.상기 모니터링시스템과 대응시스템은 종래의 시스템을 이용한다. <24>한편 상기와 같은 시스템을 이용하여 위협탐지를 하는 방법은 상기 수집시스템의 에이전트부에서 네트워크에서 <25>발생하는 패킷(packet), 트래픽(traffic), 이벤트(event) 또는 로그(log) 등의 데이터를 수집하는 제1단계;위 수집된 데이터를 상기 수집시스템의 에이전트부에서 문자열을 정규화/필터링 및 재조합하여 재정열하는 제2 <26>단계;위 정규화/필터링 및 재조합된 문자열을 축약하는 제3단계; <27>- 8 -공개특허 10-2009-0071502위 제3단계에서 축약된 스칼라 데이터를 상기 벡터화부에서 가공하여 상태벡터(status vector)와 긴급값(urgent <28>value)을 생성하고 관리하여 중요도 데이터를 생성하고 또한 우선순위에 따라 정렬된 데이터를 생성하고 이 데이터를 상기 탐지시스템으로 전달하는 제4단계;상기 포커스셀렉터에서 상기 제3단계에서 축약된 데이터 및 상기 제4단계에서 생성된 중요도 데이터 중에 우선 <29>처리 되어야 하는 관심대상을 정하고, 정해진 대상에 적합하지않는 행동을 차단(제외)시키는 값을 우선벡터(priority vector)화 하여 선별된 데이터를 상기 모니터링시스템 및 적응시스템으로 전달하는 제5단계;위 제5단계에서 생성된 우선순위에 따라 정렬된 데이터를 상기 탐지시스템에서 비정상 및 오용탐지를 위하여 프 <30>로파일(profile)과 패턴(pattern)을 비교하는 제6-1단계;위 제6-1단계에서 생성된 정보로서 일반적 위협정보인 위협상태벡터(threat status vector)를 생성하는 제7-1단 <31>계;상기 제5단계에서 생성된 우선순위에 따라 정렬된 데이터를 이용하여 상기 탐지시스템에서 추론벡터(deduction <32>vector)를 생성하여 추론탐지를 준비하는 제6-2단계;위 제6-2단계에서 생성된 추론벡터를 이용하여 선호도(preference)가 포함된 추론벡터를 생성하는 제7-2단계; <33>상기 제7-1단계 및 제7-2단계에서 생성된 정보로서 위협정보를 파악하여 상기 모니터링시스템으로 전달하는 제8 <34>단계;상기 수집시스템에서 전달되어오는 선별된 데이터(제5단계)를 상기 선호도학습부에서 선호도를 계산하는 제9단 <35>계위 계산된 선호도 정보를 정책에 따라 선택하거나 또는 주의정보를 분배하여 상기 탐지시스템으로 전달하는 제 <36>10단계;상기 수집시스템에서 전달되어오는 선별된 데이터(제5단계)를 상기 규칙생성부에서 관리자의 설정규칙과 비교하 <37>여 해당규칙에 일치하는 데이터(마스크(mask)된 데이터)를 상기 모니터링시스템으로 전달하는 제11단계; 및상기 제5단계, 제8단계 및 제11단계에서 정보를 전달받은 상기 모니터링시스템에서 그 정보를 바탕으로 위협여 <38>부에 대한 행동지침을 상기 대응시스템에 전달하는 제12단계; 및위 제12단계에서의 행동지침을 전달받은 상기 대응시스템에서 경보, 보고 또는 감사(audit)를 수행하는 제13단 <39>계;로 이루어진다. <40>상기 제10단계에서 탐지시스템으로의 정보전달은 상기 수집시스템으로 피드백하여 전달하게 되므로 위 단계들이 <41>반드시 일련의 순서과정인 것은 아니며 피드백되면서 학습되어지고 위협탐지가 규칙(정책)이 변형되어 간다. 효 과상기와 같은 본 발명은 지능형 소프트웨어 로봇이 주변환경 및 외부환경과의 적응을 통한 행동특성을 적용함으 <42>로써 감시대상인 주변환경 또는 외부환경(네트워크, 호스트 등)과의 합리적인 적응을 통하여 종래의 시스템에는없는 자동화된 탐지정책의 갱신 및 수립이 가능하며, 종래의 단순한 침입탐지 유무로만 제공하는 정보와 관리자가 수동으로 트래픽 증가 등의 다른 정보를 조합하여 판단하는 형태와는 다르게 본 발명은 관리자의 개입이 최소화되고 감시대상에 대한 실제 위협을 단계적인 정보로 제공할 수 있은 장점이 있으며, 외부환경인 보안장비(IDS, IPS, Web F/W 등)에 적용하게 되면 능동적인 보안시스템으로 진화할 수 있는 효과가 있고, 시스템에 내재되어 변화모습을 추적하기 어려운 취약성 및 가치평가를 자동화할 수 있으며, 주변환경에 적응하고 이와 상호작용함으로써 종래 시스템의 사후대응 및 주변환경 미적용과 같은 문제점을 해결하는 효과가 있다. 발명의 실시를 위한 구체적인 내용이하, 첨부된 도면에 의하여 발명의 실시를 위한 구체적인 내용을 상세히 설명한다. <43>도 2는 본 발명 시스템의 개략적인 구성으로 도시한 블록도, 도 3은 본 발명 시스템의 구성을 상세하게 도시한 <44>블록도, 도 4는 본 발명 방법의 전체적인 흐름을 도시한 흐름도, 도 5는 본 발명 수집시스템에 일어나는 과정을도시한 흐름도, 도 6은 본 발명 탐지시스템에서 일어나는 과정을 도시한 흐름도, 도 7은 본 발명 적응시스템에- 9 -공개특허 10-2009-0071502서 일어나는 과정을 도시한 흐름도, 도 8은 본 발명의 최종단계에서 일어나는 과정을 도시한 흐름도이다.본 발명의 시스템은 도 2 및 도 3에 도시한 바와 같이 <45>외부환경 또는 주변환경의 네트워크에서 발생하는 패킷(packet), 트래픽(traffic), 이벤트(event) 또는 로그 <46>(log) 등의 데이터를 수집하고, 정규화(문자열 재정열, 축약 등) 및 재조합하는 기능을 수행하는 에이전트(agent)부,위 에이전트부에서 가공된 데이터를 이용하여 상태벡터(status vector)와 긴급값(urgent value)을 생성하고 관 <47>리하는 벡터화(vectorization)부, 및위 에이전트부 및 벡터화부에서 가공된 데이터 중에서 우선처리 되어야 하는 관심대상을 정하고, 정해진 대상에 <48>적합하지않는 행동을 차단(제외)시키는 값을 벡터화하는 우선벡터(priority vector) 기능의 포커스셀렉터(focusselector),로이루어져 외부 또는 주변환경으로부터 데이터를 수집, 가공 및 축약 등의 전처리하는 수집시스템(collection <49>system);오용엔진(misuse engine), 비정상엔진(anomaly engine) 및 추론엔진(deduction engine)으로 구성되며, 상기 벡 <50>터화부에서 생성된 상태벡터와 상기 패킷(packet), 트래픽(traffic), 이벤트(event) 또는 로그(log) 등을 선택적으로 입력을 받아 위 수집시스템에서 전달되는 데이터를 대상으로 비정상탐지, 오용탐지 및 추론탐지에 의하여 데이터의 위협을 탐지하는 탐지시스템(detection system);모니터링 대상에 대한 선택 또는 주의정보 등을 조절하여 모니터링 대상에 대한 위협탐지 선호도를 학습할 수 <51>있도록 하는 선호도학습부(preference learner),와관리자가 직접 설정한 규칙을 보관하고 적용하는 규칙생성부(rule maker)로 구성되며, <52>상기 수집시스템 및 탐지시스템에서 받은 데이터 및 정보로부터 선호도 및 규칙을 생성하고 모니터링하기 위한 <53>위협수준 및 정책조정의 기본 값을 생성하는 적응시스템(adaptation system);상기 수집시스템, 탐지시스템 및 적응시스템으로부터 데이터 및 규칙 등을 받아서 행동하는 모니터링시스템 <54>(monitoring system); 및위 모니터링시스템으로부터 받은 행동지침에 따라 경보, 보고 또는 감사(audit)를 수행하는 대응시스템 <55>(response system);으로 구성된다. <56>상기와 같이 구성된 시스템을 이용하는 본 발명의 위협탐지방법은 도4 내지 도 8에 도시된 바와 같이 <57>상기 수집시스템의 에이전트부에서 네트워크에서 발생하는 패킷(packet), 트래픽(traffic), 이벤트(event) 또는 <58>로그(log) 등의 데이터를 수집하는 제1단계;위 수집된 데이터를 상기 에이전트부에서 문자열을 정규화/필터링 및 재조합하여 재정열하는 제2단계; <59>위 정규화/필터링 및 재조합된 문자열을 축약하는 제3단계; <60>위 제3단계에서 축약된 스칼라 데이터를 상기 벡터화부에서 가공하여 상태벡터(status vector)와 긴급값(urgent <61>value)을 생성하고 관리하여 중요도 데이터를 생성하고 또한 우선순위에 따라 정렬된 데이터를 생성하고 이 데이터를 상기 탐지시스템으로 전달하는 제4단계;상기 포커스셀렉터에서 상기 제3단계에서 축약된 데이터 및 상기 제4단계에서 생성된 중요도 데이터 중에서 우 <62>선처리 되어야 하는 관심대상을 정하고, 정해진 대상에 적합하지않는 행동을 차단(제외)시키는 값을 우선벡터(priority vector)화 하여 선별된 데이터를 상기 모니터링시스템 및 적응시스템으로 전달하는 제5단계;위 제5단계에서 생성된 우선순위에 따라 정렬된 데이터를 상기 탐지시스템에서 비정상 및 오용탐지를 위하여 프 <63>로파일(profile)과 패턴(pattern)을 비교하는 제6-1단계;위 제6-1단계에서 생성된 정보로서 일반적 위협정보인 위협상태벡터(threat status vector)를 생성하는 제7-1단 <64>계;상기 제5단계에서 생성된 우선순위에 따라 정렬된 데이터를 이용하여 상기 탐지시스템에서 추론벡터(deduction <65>- 10 -공개특허 10-2009-0071502vector)를 생성하여 추론탐지를 준비하는 제6-2단계;위 제6-2단계에서 생성된 추론벡터를 이용하여 선호도(preference)가 포함된 추론벡터를 생성하는 제7-2단계; <66>상기 제7-1단계 및 제7-2단계에서 생성된 정보로서 위협정보를 파악하여 상기 모니터링시스템으로 전달하는 제8 <67>단계;상기 수집시스템에서 전달되어오는 선별된 데이터(제5단계)를 상기 선호도학습부에서 선호도를 계산하는 제9단 <68>계위 계산된 선호도 정보를 정책에 따라 선택하거나 또는 주의정보를 분배하여 상기 탐지시스템 및 모니터링시스 <69>템으로 전달하는 제10단계;상기 수집시스템에서 전달되어오는 선별된 데이터(제5단계)를 상기 규칙생성부에서 관리자의 설정규칙과 비교하 <70>여 해당규칙에 일치하는 데이터(마스크(mask)된 데이터)를 상기 모니터링시스템으로 전달하는 제11단계; 및상기 제5단계, 제8단계 및 제11단계에서 정보를 전달받은 상기 모니터링시스템에서 그 정보를 바탕으로 위협여 <71>부에 대한 행동지침을 상기 대응시스템에 전달하는 제12단계; 및위 제12단계에서의 행동지침을 전달받은 상기 대응시스템에서 경보, 보고 또는 감사(audit)를 수행하는 제13단 <72>계;로 이루어진다. <73>상기와 같은 단계들은 이하에서 설명하는 수학식들에 의하여 구체화되며 그리하여 본 발명이 당업자에 의하여 <74>쉽게 이해되어 실시될 수 있다.상기 제4단계에서 상태벡터(Status Vector)는 아래 수학식 1에 의하여 구해진다. <75>수학식 1<76>상기 제5단계에서 우선벡터(priority vector)는 아래 수학식 2에 의하여 구해진다. <77>수학식 2<78>또한 상기 제5단계에서 정해진 대상에 적합하지않는 행동을 차단(제외)시키는 관심도 차단행렬은 아래 수학식 3 <79>에 의하여 구해질 수 있다.수학식 3<80>상기 제7-1단계에서 위협이 가해지고 있는 탐지된 관찰 및 모니터링 대상은 아래의 수학식 4에서 구한다. <81>- 11 -공개특허 10-2009-0071502수학식 4<82>상기 제6-2단계에서 추론벡터(deduction vector)는 아래 수학식 5에서 구할 수 있다. <83>수학식 5<84>위 수학식 5에서 시간 t에서 각 \"d\" 값은 수학식 6에서 구하게 된다. <85>수학식 6<86>상기 수학식 6에서 연결강도의 값은 아래 수학식 7에서 구할 수 있다. <87>수학식 7<88>위 수학식 7에서 연결강도의 변화량은 아래 수학식 8에서 구한다. <89>수학식 8<90>상기 제11단계에서 관리자의 설정규칙은 아래 수학식 9에서 구하여 적용한다. <91>- 12 -공개특허 10-2009-0071502수학식 9<92>상기 제12단계에서 위협여부에 대한 판단은 먼저 일반적인 위협정보(ATtemp)를 아래의 수학식 10에서 구한 후, 수 <93>학식11을 이용하여 본 발명의 지능형 소프트웨어 로봇의 행동특성을 이용한 실질적 위협정보(AT)를 구하게 된다.위와 같이 위협정보를 구하게 됨으로써 주변환경에 적응하고 이와 상호작용하여 변화하는 위협정보를 구할 수 <94>있게 된다.수학식 10<95>수학식 11<96>이하에서는 상기와 같이 이루어진 본 발명의 일 실시예를 첨부한 도면을 참고로 설명한다. <97>도 9는 본 발명 일 실시예의 메인화면의 구성을 나타내는 화면이고, 도 10a는 본 발명 수집시스템의 에이전트부 <98>를 나타내는 도면이며, 도 10b는 본 발명 수집시스템의 에이전트부의 규칙을 설정하는 화면이고, 도 11은 본 발명 수집시스템의 벡터화부의 화면이며, 도 12는 본 발명 수집시스템의 포커스셀렉터의 구성을 나타내는 화면이고, 도 13은 본 발명 탐지시스템의 탐지 정책의 결과를 상태를 나타내는 화면이며, 도 14는 본 발명 탐지시스템의 오용탐지의 정책과 패턴을 설정하는 화면이고, 도 15는 본 발명 탐지시스템의 비정상탐지의 정책을 설정하는화면이며, 도 16은 본 발명 탐지시스템의 추론탐지의 정책을 설정하는 화면이고, 도 17은 본 발명 적응시스템의선호도학습부의 학습리스트 및 가중치를 나타내는 화면이며, 도 18은 본 발명 적응시스템의 규칙생성부의 정책을 생성 및 수정할 수 있는 화면이고, 도 19는 본 발명 모니터링시스템에서 각 수집대상의 상태벡터, 시간에 따른 위협수준, 이벤트 통계 등을 보여주는 화면이며, 도 20은 본 발명 탐지시스템에서 탐지된 결과를 보여주는화면이고, 도 21은 본 발명 대응시스템에 의한 대응행동을 보여주는 화면이며, 도 22는 본 발명 모니터링시스템의 보여지는 벡터를 설정하는 화면이고, 도 23은 본 발명 대응시스템의 대응이력을 조회한 화면이고, 도 24는본 발명 대응시스템의 대응보고서를 나타낸 화면이다.좀더 상세하게 설명하면, 도 9는 수집시스템의 상태(데이터를 수집, 가공 및 축약하는 상황), 탐지시스템의 상 <99>태(오용, 비정상, 추론 탐지 엔진에서 탐지된 이벤트) 및 적응시스템의 상태(선호도 및 위협수준/정책조정 적용여부)의 세 시스템의 현재 상태를 실시간(시간 간격 설정 가능)적으로 보여 주는 화면이고,도 10a는 외부환경 또는 주변 환경의 네트워크에서 발생하는 패킷(packet), 트래픽(traffic), 이벤트(event) 또 <100>는 로그(log) 등의 데이터(Low Data)를 수집 상태와 그 데이터를 정규화(문자열 재정열, 축약 등: ParsingData) 및 재조합(Summary Data)하는 상태를 보여 주는 화면이며,- 13 -공개특허 10-2009-0071502도 10b는 수집 대상 데이터(Low Data)의 정의 및 그 데이터를 정규화(문자열 재정열, 축약 등: Parsing Data) <101>및 재조합(Summary Data)하는 규칙을 설정하는 화면이고,도 11은 에이전트부에서 가공된 데이터를 이용하여 상태벡터를 생성하고 대상 벡터를 탐지 및 적응에 참여시킬 <102>지 여부를 설정하는 화면이며,도 12는 포커스셀렉터화면으로서 에이전트부와 벡터화부에서 가공된 데이터(외부환경 또는 주변 환경의 네트워 <103>크에서 발생하는 패킷(packet), 트래픽(traffic), 이벤트(event) 또는 로그(log) 등의 데이터(Low Data)를 포함한 OS Info, CPU Info, Memory Info 등 각종 보안이벤트 및 관리자의 보안이벤트 처리행위) 중에서 우선처리되어야 하는 관심대상을 정하고, 정해진 대상에 적합하지않는 행동을 차단(제외)시키는 값을 벡터화하는 우선벡터를 만들도록 그 적용순위/여부를 설정하고 해당된 기록을 검색하는 기능을 제공하는 화면이며,도 16은 대상 벡터에 대한 관심도 차단 행렬을 위한 차단 설정과 추론벡터를 구하는데 필요한 추론 변화 Gain <104>값을 설정하는 화면이고,도 17은 대상 벡터의 선호도 값을 조회하고 대상 벡터에 대한 선호도 값을 변경 설정하여 선호도 학습의 결과를 <105>조정할 수 있는 화면이며,도 18은 선호도 학습 이외에 관리자 또는 가이드라인 등에 의해 관리되는 항목들의 규칙을 관리하고 생성/수정 <106>된 규칙을 조회하는 화면이고,도 19는 에이전트부에서 가공된 데이터 중, 긴급 값이 설정되어 모니터링 시스템으로 전송된 데이터의 상태를 <107>보여주고, 각 수집대상의 상태벡터, 시간에 따른 위협수준, 이벤트 통계 등을 제공하는 화면이며,도 20은 탐지시스템(오용, 비정상, 추론)에서 탐지된 결과를 보여주고, 각 수집대상의 상태벡터, 시간에 따른 <108>위협수준 및 구체적인 탐지 내역 등을 제공하는 화면이고,도 21은 모니터링시스템으로부터 받은 행동지침에 따라 경보, 보고 또는 감사를 수행한 본 발명 대응시스템에 <109>의한 관리자의 대응행동을 보여주는 화면이며,도 22은 일반적인 위협정보로부터 적응된 위협정보를 보기 위해 설정해야 하는 값들 중에 규칙 차단/선택 행렬 <110>을 대상 벡터 별로 설정하는 화면이다.상기 일 실시예에서 선호도는 추론에 대한 선호도로서, 가중치를 두어 위협으로 판단할 것인 지 여부를 판단할 <111>수 있는 기준값으로서, 고정된 값이 아니라 학습 또는 경험에 의하여 강화 또는 약화되는 값이며, 수학식 7은추론에 대한 선호도를 구하는 식으로서 강화 또는 약화될 수 있으며, 강화 또는 약화되는 강도의 변화량은 수학식 8에서 구할 수 있고, 차단하여야 할 위협정보인지 아니면 차단되지 않아도 될 위협정보인지는 수학식 9에 의하여 생성되어 규칙을 설정할 수 있으며,탐지단계에서 얻어진 데이터를 프로파일과 패턴을 비교하여 오용(misuse) 및 비정상(anomaly) 데이터에 대한 정 <112>보를 생성하고, 이렇게 생성된 정보를 상태벡터(수학식 1)를 이용하여 위협상태벡터를 생성하고,추론의 대상은 각종 데이터 값으로서, OS(Operating System), CPU, 메모리, 인터페이스, 트래픽(traffic), 취 <113>약점, IDS 로그(log), 방화벽 로그, 라우터 로그, 시스템 로그, 테스트인터페이스 또는 테스트 트래픽의 정보와같은 값을 상기 수학식 6, 7 및 8을 이용하여 수학식 5의 추론 값(벡터 값)을 구할 수 있고,위 추론에 의하여 구하여지는 추론 값은 도 16의 gain 값이며, 이 gain 값은 학습에 의하여 변화되면서 정해질 <114>수도 있으며, 관리자가 임의로 먼저 정하여 주거나 또는 사후에 변경할 수 있게 되며, 이 gain 값의 정도에 의하여 모니터링시스템에서는 위협여부를 판단하게 되고,모니터링하기 위한 위협수준 및 정책조정의 기본 값은 수학식 9에서 규칙차단 및 선택행렬을 생성한 후, 수학식 <115>10에서 추론 벡터를 이용하여 일반적인 위협정보를 구하고, 이 일반적인 위협정보를 이용하여 수학식 11에서 수학식 10에서 생성한 값을 곱하여 실질적 위협정보를 획득하여 모니터링을 위한 위협수준 및 정책조정의 기본값을 생성하며,모니터링시스템에서는 수집된 데이터에 위협여부가 존재하는 지를 감시하여 경보(alarm), 보고(report) 또는 감 <116>사(audit) 행동을 수행할 지 여부의 행동지침을 결정하고,대응시스템에서는 위에서 결정된 행동지침에 의하여 경보(alarm), 보고(report) 또는 감사(audit) 행동을 수행 <117>하여 위협되는 데이터 탐지할 수 있다.- 14 -공개특허 10-2009-0071502한편 이하에서는 주요 수학식의 역할과 입력값 및 리턴값을 제시하고 이에대한 pseudo-code를 나타내었다. <118><수학식1> <119>(1) 역할: 에이전트부에서 가공된 데이터를 이용하여 상태벡터를 만든다. <120>(2) 입력값: 에이전트부에서 가공된 데이터(이벤트 스트링) <121>(3) 리턴값: 가공된 데이터로부터 얻게 될 상태벡터 <122>(4) pseudo-code <123>#define num_of_target1024// 벡터화될 정보수집 종류의 총 수 <124>#define num_of_element256*256// 수집정보 중 관심대상의 총 개수(예: 모니터링 대상의 서버 총 대수) <125>StringstrEvent[num_of_target][num_of_element]; // 에이전트부에서 가공된 데이터 <126>floatS[num_of_target][num_of_element]; // 상태벡터(Status Vector) <127>intiTarget; // 벡터화될 정보수집 종류의 수 , 벡터설정에서 결정 <128>intiElement; // 수집정보 중 관심대상의 총 개수: 벡터설정에서 결정 <129>int Vectorization(String,int); <130>int Vectorization(String** Event, float** S) <131>{ <132>int i, j; <133>for(i=0; i<iTarget; i++) <134>{ <135>for(j=0; j<iElement; j++) <136>{ // 에이전트부에서 가공된 데이터가 \"Sensing\" 되었다면 <137>// 단계가 여러 단계일 수 있으나 여기서는 두 단계로만 정의 <138>// 0≤S≤1, S는 실수 <139>if(strEvent[i][j] == \"Sensing\") <140>{ <141>S[i][j] = 1.0;// 상태벡터의 해당 요소에 1 값을 저장 <142>} <143>else <144>{ <145>S[i][j] = 0;// 그렇지 않다면 0 값을 저장 <146>} <147>} <148>} <149><150>return EXIT_SUCCESS; <151>} <152><수학식 6> <153>- 15 -공개특허 10-2009-0071502(1) 역할: 벡터화부에서 생성된 상태벡터와 외부환경 또는 주변 환경의 네트워크에서 발생하는 패킷(packet), <154>트래픽(traffic), 이벤트(event) 또는 로그(log) 등의 데이터(Low Data)를 포함한 OS Info, CPU Info, MemoryInfo 등 각종 보안이벤트 및 관리자의 보안이벤트 처리행위 등으로부터 위협을 추론한다.(2) 입력값: - 추론 변화 Gain 값 <155>- 시간 t까지의 추론 벡터의 평균 값 <156>- 시간 t까지의 추론 벡터의 요소 합 <157>- 상태 벡터 <158>- Sj와 Dj와의 연결 강도 벡터 <159>(3) 리턴값: - 시간 t+1에서 추론 벡터 값 <160>- 시간 t+1에서 추론 벡터의 평균 값 <161>- 시간 t+1에서 추론 벡터의 요소 합 <162>(4) pseudo-code <163>#define num_of_target1024// 벡터화될 정보수집 종류의 총 수 <164>#define num_of_element256*256// 수집정보 중 관심대상의 총 개수(예: 모니터링 대상의 서버 총 대수) <165>#define time_step 1.0// 추론벡터를 구하는 시간 단위 (기본값: 1초) <166>StringstrEvent[num_of_target][num_of_element]; // 에이전트부에서 가공된 데이터 <167>floatS[num_of_target][num_of_element]; // 상태벡터(Status Vector) <168>floatd[num_of_target][num_of_element]; // 시간 t에서 추론벡터 <169>floatSum_d[num_of_target][num_of_element]; // 시간 t까지 추론벡터의 요소의 합 <170>floatmd[num_of_target][num_of_element]; // 시간 t까지 추론벡터의 평균값 <171>floatlambda[num_of_target][num_of_element];// 추론 변화 Gain <172>floatW[num_of_target][num_of_element]; // 상태벡터 Sj와 추론벡터 Dj와의 연결 강도 <173>intiTarget; // 벡터화될 정보수집 종류의 수 , 벡터설정에서 결정 <174>intiElement; // 수집정보 중 관심대상의 총 개수: 벡터설정에서 결정 <175>float nTime; // 추론을 시행하는 시간 <176>float DotVector(float**,float**); // 두 벡터의 내적을 구하는 함수 <177>int Deduction_Vector(float**, float**, float**, float** float**, float**); <178>int Deduction_Vector(float **d, float **lambda, float **md, float Sum_d, float **S, float **W) <179>{ <180>int i, j; <181><182>for(i=0; i<iTarget; i++) <183>{ <184>for(j=0; j<iElement; j++) <185>{ <186>// [수학식 6]의 구현 <187>- 16 -공개특허 10-2009-0071502d[i][j] += lambda[i][j]*(md[i][j] - d[i][j]) + DotVector(&S, &W); <188>// 추론벡터의 평균값 구하기 <189>Sum_d[i][j] += d[i][j]; <190>md[i][j] = Sum_d[i][j] / nTime; <191>} <192>} <193>// t → t+1 로 이동 <194>nTime += time_step; <195>return EXIT_SUCCESS; <196>} <197><수학식 10> <198>(1) 역할: 위협탐지 벡터와 시간 t에서 추론벡터를 통해 일반적인 위협정보를 얻는다. <199>(2) 입력값: - 위협탐지 벡터 <200>- 시간 t에서 추론 벡터 <201>(3) 리턴값: - 일반적인 위협정보 벡터 <202>(4) pseudo-code <203>#define num_of_target1024 // 벡터화될 정보수집 종류의 총 수 <204>#define num_of_element256*256 // 수집정보 중 관심대상의 총 개수(예: 모니터링 대상의 서버 총 대 <205>수)float r[num_of_target][num_of_element]; // 위협탐지 벡터, 오용탐지/비정상탐지로부터 얻은 값 <206>float d[num_of_target][num_of_element];// 시간 t에서 추론벡터 <207>float Atemp[num_of_target][num_of_element];// 일반적인 위협정보 <208>intiTarget; // 벡터화될 정보수집 종류의 수 , 벡터설정에서 결정 <209>intiElement; // 수집정보 중 관심대상의 총 개수: 벡터설정에서 결정 <210>int General_Threat_Info(float**, float**, float**); <211>int General_Threat_Info(float **Atemp, float **r, float **d) <212>{ <213>int i, j; <214>for(i=0; i<iTarget; i++) <215>{ <216>for(j=0; j<iElement; j++) <217>{ <218>// [수학식 10]의 구현 <219>Atemp[i][j] = r[i][j]*d[i][j]; <220>} <221>} <222>- 17 -공개특허 10-2009-0071502return EXIT_SUCCESS; <223>} <224><수학식 11> <225>(1) 역할: 일반적인 위협정보로부터 관심도와 규칙을 반영하여 주변 환경에 적응하고 이와 상호작용한 위협정보 <226>벡터를 얻는다.(2) 입력값: - 일반적인 위협정보 벡터 <227>- 관심도 차단 행렬(벡터) <228>- 규칙 차단/선택 행렬(벡터) <229>(3) 리턴값: - 위협정보 벡터 <230>(4) pseudo-code <231>#define num_of_target1024 // 벡터화될 정보수집 종류의 총 수 <232>#define num_of_element256*256 // 수집정보 중 관심대상의 총 개수(예: 모니터링 대상의 서버 총 대 <233>수)float Atemp[num_of_target][num_of_element];// 일반적인 위협정보 <234>float A[num_of_target][num_of_element];// 주변환경에 적응하고 이와 상호작용한 위협정보 <235>float Mf[num_of_target][num_of_element]; // 관심도 차단 행렬 <236>float Mr[num_of_target][num_of_element]; // 규칙 차단/선택 행렬 <237>intiTarget; // 벡터화될 정보수집 종류의 수 , 벡터설정에서 결정 <238>intiElement; // 수집정보 중 관심대상의 총 개수: 벡터설정에서 결정 <239>floatDotVector(float**,float**); // 두 벡터의 내적을 구하는 함수 <240>int Threat_Info(float**,float**,float**,float**); <241>int Threat_Info(float **A, float **Atemp, float **Mf, float **Mr) <242>{ <243>for(i=0; i<iTarget; i++) <244>{ <245>for(j=0; j<iElement; j++) <246>{ <247>// [수학식 11]의 구현 <248>A[i][j] = Atemp[i][j]*Mf[i][j]*Mr[i][j]; <249>} <250>} <251><252>return EXIT_SUCCESS; <253>} <254>도면의 간단한 설명도 1은 종래의 위협탐지시스템의 구성을 도시한 블록도. <255>- 18 -공개특허 10-2009-0071502도 2는 본 발명 시스템의 개략적인 구성으로 도시한 블록도. <256>도 3은 본 발명 시스템의 구성을 상세하게 도시한 블록도. <257>도 4는 본 발명 방법의 전체적인 흐름을 도시한 흐름도. <258>도 5는 본 발명 수집시스템에 일어나는 과정을 도시한 흐름도. <259>도 6은 본 발명 탐지시스템에서 일어나는 과정을 도시한 흐름도. <260>도 7은 본 발명 적응시스템에서 일어나는 과정을 도시한 흐름도. <261>도 8은 본 발명의 최종단계에서 일어나는 과정을 도시한 흐름도. <262>도 9는 본 발명 일 실시예의 메인화면의 구성을 나타내는 화면. <263>도 10a는 본 발명 수집시스템의 에이전트부를 나타내는 도면. <264>도 10b는 본 발명 수집시스템의 에이전트부의 규칙을 설정하는 화면. <265>도 11은 본 발명 수집시스템의 벡터화부의 화면. <266>도 12는 본 발명 수집시스템의 포커스셀렉터의 구성을 나타내는 화면. <267>도 13은 본 발명 탐지시스템의 탐지 정책의 결과를 상태를 나타내는 화면. <268>도 14는 본 발명 탐지시스템의 오용탐지의 정책과 패턴을 설정하는 화면. <269>도 15는 본 발명 탐지시스템의 비정상탐지의 정책을 설정하는 화면. <270>도 16은 본 발명 탐지시스템의 추론탐지의 정책을 설정하는 화면. <271>도 17은 본 발명 적응시스템의 선호도학습부의 학습리스트 및 가중치를 나타내는 화면. <272>도 18은 본 발명 적응시스템의 규칙생성부의 정책을 생성 및 수정할 수 있는 화면. <273>도 19는 본 발명 모니터링시스템에서 각 수집대상의 상태벡터, 시간에 따른 위협수준, 이벤트 통계 등을 보여주 <274>는 화면.도 20은 본 발명 탐지시스템에서 탐지된 결과를 보여주는 화면. <275>도 21은 본 발명 대응시스템에 의한 대응행동을 보여주는 화면. <276>도 22는 본 발명 모니터링시스템의 보여지는 벡터를 설정하는 화면. <277>도 23은 본 발명 대응시스템의 대응이력을 조회한 화면. <278>도 24는 본 발명 대응시스템의 대응보고서를 나타낸 화면. <279>- 19 -공개특허 10-2009-0071502도면 도면1- 20 -공개특허 10-2009-0071502 도면2- 21 -공개특허 10-2009-0071502 도면3- 22 -공개특허 10-2009-0071502 도면4- 23 -공개특허 10-2009-0071502 도면5- 24 -공개특허 10-2009-0071502 도면6- 25 -공개특허 10-2009-0071502 도면7- 26 -공개특허 10-2009-0071502 도면8- 27 -공개특허 10-2009-0071502 도면9- 28 -공개특허 10-2009-0071502 도면10a 도면10b- 29 -공개특허 10-2009-0071502 도면11 도면12- 30 -공개특허 10-2009-0071502 도면13- 31 -공개특허 10-2009-0071502 도면14 도면15- 32 -공개특허 10-2009-0071502 도면16 도면17- 33 -공개특허 10-2009-0071502 도면18- 34 -공개특허 10-2009-0071502 도면19- 35 -공개특허 10-2009-0071502 도면20- 36 -공개특허 10-2009-0071502 도면21 도면22- 37 -공개특허 10-2009-0071502 도면23- 38 -공개특허 10-2009-0071502 도면24- 39 -공개특허 10-2009-0071502"}
{"patent_id": "10-2008-0135027", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 정보시스템을 마비시키거나 또는 파괴하는 등의 사고를 일으킬 수 있는 위협에 대하여 감정을 가지고 서 의사소통과 상호작용이 가능하고 스스로 학습할 수 있는 지능형 소프트웨어 로봇의 행동특성을 이용하여 변화 하는 주변환경에 적응하고 알려지지 않았거나 변형되는 각종 위협에 대응할 수 있는 탐지방법 및 이를 위한 시스 템에 관한 것으로서 네트워크에서 발생하는 패킷(packet), 트래픽(traffic), 이벤트(event) 또는 로그(log) 등 의 데이터를 수집, 가공 및 축약 등의 전처리하는 데이터 수집단계; 위 수집단계에서 전처리된 데이터를 대상으 로 비정상탐지, 오용탐지 및 추론탐지에 의하여 데이터를 탐지하는 탐지단계; 상기 수집단계에서 전처리 받은 데 이터 및 상기 탐지단계에서 발생한 정보로부터 선호도 및 규칙을 생성하고 모니터링하기 위한 위협수준 및 정책 조정의 기본 값을 생성하는 적응단계; 위 수집, 탐지 및 적응단계로부터 데이터 및 규칙 등을 받아서 행동하는 모니터링단계; 및 위 모니터링단계에서 받은 행동지침에 따라 경보, 보고 또는 감사(audit)를 수행하는 대응단계;로 이루어진 것을 특징으로 한다."}
{"patent_id": "10-2008-0135027", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 정보시스템을 마비시키거나 또는 파괴하는 등의 사고를 일으킬 수 있는 위협을 탐지하는 방법 및 이 <1> 방법을 실현하기 위한 시스템에 관한 것으로서, 감정을 가지고서 의사소통과 상호작용이 가능하고 스스로 학습 할 수 있는 지능형 소프트웨어 로봇의 행동특성을 이용하여 변화하는 주변환경에 적응하고 변형되는 각종 위협 에 대응할 수 있는 탐지방법 및 이를 위한 시스템에 관한 것이다."}
{"patent_id": "10-2008-0135027", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "본 발명에서 정보시스템이라 함은 정보에 대해 저장, 계산, 분배 및 통신 등을 통칭하는 것이며, 위협(threat) <2> 은 정보시스템의 취약한 부분을 공격하여 시스템 내부에 침입하거나, 침입하여 시스템을 마비 또는 파괴하는 등 의 침해사고를 유발하게 하는 모든 행위를 말한다. 또한 일반적으로 지능형 소프트웨어 로봇(Intelligent Software Robot)은 프로그램의 일종으로서 그 특징은 1) <3> 사용자와 의사소통하여 상호작용을 할 수 있으며, 2) 같은 조건에서도 다양한 행동을 할 수 있는 감정이 있으며, 3) 설계 시 미처 고려하지 못한 환경에서도 잘 적응할 수 있는 스스로 학습능력이 있어서 설계 시 설정 하여 놓은 조건에 대응하면서도 조건의 변화에 스스로 대처할 수 있는 인공지능 프로그램을 총칭하는 것이다. 한편 정보시스템은 각종 통신망에 의하여 전 세계적으로 연결이 되어 있으므로 누구든지 이 정보시스템에 접촉 <4> 할 수 있는 접근의 자유성과 더불어 이 자유성을 저해하거나 정보를 오용될 가능성 또한 높다. 즉 공개된 정보 는 누구라도 접근하여 이를 사용할 수 있는 것이지만 이러한 공개된 정보를 권한 없는 자가 수정하거나 기밀을 요구하는 정보를 무단으로 열람하여서는 아니 되며 정당한 권한이 있는 자가 요청하는 서비스는 권한에 맞게 제 공되어야 한다. 그리하여 현재의 정보시스템은 이러한 정보의 접근 자유성과 이 자유성의 차단이라는 양면의 칼과도 같은 개념 <5> 을 동시에 유지하여야 하는 어려움과 고가의 비용이 소요되고 있다. 정보시스템의 운영자(관리자)들은 일명 보안시스템을 운영하여 정보 접근의 자유성을 차단하고 있으나, 이러한 <6> 차단을 고의적으로 깨뜨려서 정보의 무결성, 기밀성 및 가용성을 해하거나 또는 고의적으로 접근의 자유성을 차 단하여 일반 사용자들로 하여금 정보에 접근할 수 없도록 하고 있으며 이러한 고의적인 행위에 대한 결과는 상 상을 초월할 정도가 되는 경제적 손실과 정신적인 손실까지 유발하는 심각한 상황에 이르고 있다. 위의 고의적인 행위는 사이버 위협, 사이버테러, 사이버침해, 사이버침입 또는 사이버공격 등으로 다양하게 불 <7> 리고 있으며 보통 침입 또는 위협이라고 하고, 이러한 행위를 유발하는 것으로서는 해킹, 컴퓨터 바이러스, 스 팸메일 등이 그 일 예이다. 일반적으로 위와 같은 고의적인 행위를 사전에 차단하는 것을 보안시스템이라고 하고 있으며, 이러한 고의적인 <8> 행위인 침입 또는 위협을 탐지하기 위한 종래의 보안 시스템으로서 위협탐지시스템(위협탐지엔진)을 도 1에 도 시하였는 바, 정보시스템에 접근하는 접근데이터를 수집하는 수집시스템(collection system), 이 수집된 접근데 이터를 탐지하는 탐지시스템(detection system), 위 수집시스템에서 전달되는 접근데이터의 상태정보와 탐지시 스템을 통하여 전달되는 탐지정보로서 접근데이터를 감시하는 모니터링시스템(monitoring system) 및 이 모니터 링시스템에서 전달되는 대응정보(접근데이터의 허(許) 또는 불허(不許), 위협정도 판단 등)를 운영자가 처리할 수 있도록 사용자 시스템에 전달하는 대응시스템(response system)으로 구성되어 있다. 이러한 종래 시스템은 이미 진행된 위협(침입)을 판단하여 동일 또는 유사한 위협에 대하여 대응(방어)하도록 <9> 하는 사후적인 대응이 이루어지고 있으며, 이 사후적인 대응이 운영자(관리자)에 의하여 분석되고 적용되어야 하는 시간적인 지체가 발생하여 즉각적인 대응을 할 수 없는 문제점이 있으며, 주변환경과는 무관하게 동일한 대응정보(접근데이터에 대한 허/불허 규칙(rule) 등)를 적용하게 되므로 특정장치 또는 특정 소프트웨어의 유무 와 상관없이 동일한 규칙이 적용되어 이미 없는 시스템에 대한 방어를 계속함으로써 자원이 낭비되는 문제점이 있으며, 새로이 도입된 시스템에 대해서는 전혀 방어를 하지 않게 되어 침입을 방관하게 되는 문제점이 있다."}
{"patent_id": "10-2008-0135027", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 2, "content": "발명의 내용 - 7 -공개특허 10-2009-0071502 해결 하고자하는 과제 본 발명은 상기와 같은 즉각적이지 않는 종래 시스템의 사후대응 및 주변환경 미적용과 같은 문제점을 해결하기 <10> 위하여 주변환경에 적응하고 이와 상호작용하는 방법 및 시스템을 제공하여 자동화된 탐지정책의 갱신 및 수립 이 가능하도록 하는 것을 과제로 한다. 과제 해결수단 상기한 과제를 해결하기 위하여 본 발명의 지능형 소프트웨어 로봇은 <11> 외부 또는 주변환경으로부터 데이터를 수집, 가공 및 축약 등의 전처리를 수행하는 수집시스템(collection <12> system); 위 수집시스템에서 전달되는 데이터를 대상으로 비정상탐지, 오용탐지 및 추론탐지에 의하여 전처리 데이터를 <13> 탐지하는 탐지시스템(detection system); 상기 수집시스템 및 탐지시스템에서 받은 데이터 및 정보로부터 선호도 및 규칙을 생성하고 모니터링하기 위한 <14> 위협수준 및 정책조정의 기본 값을 생성하는 적응시스템(adaptation system); 상기 수집시스템, 탐지시스템 및 적응시스템으로부터 데이터 및 규칙 등을 받아서 행동하는 모니터링시스템 <15> (monitoring system); 및 위 모니터링시스템으로부터 받은 행동지침에 따라 경보, 보고 또는 감사(audit)를 수행하는 대응시스템 <16> (response system); 으로 구성된다. <17> 상기에서 적응시스템이 생성한 데이터는 상기 수집시스템으로 피드백(feed back)되며, 그리고 상기 모니터링시 <18> 스템과 대응시스템도 상호작용을 한다. 즉 적응시스템에서는 수집시스템으로부터 데이터 및 정보 등을 받아 규 칙 등을 생성하여 이러한 규칙 등을 다시 수집시스템으로 피드백하여 적용할 수 있도록 하고, 대응시스템에서 이루어진 행동을 모니터링시스템에서 다시 모니터링 할 수 있도록 하여 상호보완할 수 있도록 한다. 상기에서 수집시스템은 외부환경 또는 주변환경의 네트워크에서 발생하는 패킷(packet), 트래픽(traffic), 이벤 <19> 트(event) 또는 로그(log) 등의 데이터를 수집하고, 정규화(문자열 재정열, 축약 등) 및 재조합하는 기능을 수 행하는 에이전트(agent)부; 위 에이전트부에서 가공된 데이터를 이용하여 상태벡터(status vector)와 긴급값(urgent value)을 생성하고 관 <20> 리하는 벡터화(vectorization)부; 및 위 에이전트부 및 벡터화부에서 가공된 데이터 중에서 우선처리 되어야 하는 관심대상을 정하고, 정해진 대상에 <21> 적합하지않는 행동을 차단(제외)시키는 값을 벡터화하는 우선벡터(priority vector) 기능의 포커스셀렉터(focus selector);로 이루어져 있다. 상기 탐지시스템은 오용엔진(misuse engine), 비정상엔진(anomaly engine) 및 추론엔진(deduction engine)으로 <22> 구성되며, 상기 벡터화부에서 생성된 상태벡터와 상기 패킷(packet), 트래픽(traffic), 이벤트(event) 또는 로 그(log) 등을 선택적으로 입력을 받아 위협을 탐지한다. 상기 적응시스템은 선호도학습부(preference learner)와 규칙생성부(rule maker)로 구성되며, 이 선호도학습부 <23> 는 모니터링 대상에 대한 선택 또는 주의정보 등을 조절하여 모니터링 대상에 대한 위협탐지 선호도를 학습할 수 있도록 하며, 규칙생성부는 관리자가 직접 설정한 규칙을 보관하고 적용한다. 상기 모니터링시스템과 대응시스템은 종래의 시스템을 이용한다. <24> 한편 상기와 같은 시스템을 이용하여 위협탐지를 하는 방법은 상기 수집시스템의 에이전트부에서 네트워크에서 <25> 발생하는 패킷(packet), 트래픽(traffic), 이벤트(event) 또는 로그(log) 등의 데이터를 수집하는 제1단계; 위 수집된 데이터를 상기 수집시스템의 에이전트부에서 문자열을 정규화/필터링 및 재조합하여 재정열하는 제2 <26> 단계; 위 정규화/필터링 및 재조합된 문자열을 축약하는 제3단계; <27> - 8 -공개특허 10-2009-0071502위 제3단계에서 축약된 스칼라 데이터를 상기 벡터화부에서 가공하여 상태벡터(status vector)와 긴급값(urgent <28> value)을 생성하고 관리하여 중요도 데이터를 생성하고 또한 우선순위에 따라 정렬된 데이터를 생성하고 이 데 이터를 상기 탐지시스템으로 전달하는 제4단계; 상기 포커스셀렉터에서 상기 제3단계에서 축약된 데이터 및 상기 제4단계에서 생성된 중요도 데이터 중에 우선 <29> 처리 되어야 하는 관심대상을 정하고, 정해진 대상에 적합하지않는 행동을 차단(제외)시키는 값을 우선벡터 (priority vector)화 하여 선별된 데이터를 상기 모니터링시스템 및 적응시스템으로 전달하는 제5단계; 위 제5단계에서 생성된 우선순위에 따라 정렬된 데이터를 상기 탐지시스템에서 비정상 및 오용탐지를 위하여 프 <30> 로파일(profile)과 패턴(pattern)을 비교하는 제6-1단계; 위 제6-1단계에서 생성된 정보로서 일반적 위협정보인 위협상태벡터(threat status vector)를 생성하는 제7-1단 <31> 계; 상기 제5단계에서 생성된 우선순위에 따라 정렬된 데이터를 이용하여 상기 탐지시스템에서 추론벡터(deduction <32> vector)를 생성하여 추론탐지를 준비하는 제6-2단계; 위 제6-2단계에서 생성된 추론벡터를 이용하여 선호도(preference)가 포함된 추론벡터를 생성하는 제7-2단계; <33> 상기 제7-1단계 및 제7-2단계에서 생성된 정보로서 위협정보를 파악하여 상기 모니터링시스템으로 전달하는 제8 <34> 단계; 상기 수집시스템에서 전달되어오는 선별된 데이터(제5단계)를 상기 선호도학습부에서 선호도를 계산하는 제9단 <35> 계 위 계산된 선호도 정보를 정책에 따라 선택하거나 또는 주의정보를 분배하여 상기 탐지시스템으로 전달하는 제 <36> 10단계; 상기 수집시스템에서 전달되어오는 선별된 데이터(제5단계)를 상기 규칙생성부에서 관리자의 설정규칙과 비교하 <37> 여 해당규칙에 일치하는 데이터(마스크(mask)된 데이터)를 상기 모니터링시스템으로 전달하는 제11단계; 및 상기 제5단계, 제8단계 및 제11단계에서 정보를 전달받은 상기 모니터링시스템에서 그 정보를 바탕으로 위협여 <38> 부에 대한 행동지침을 상기 대응시스템에 전달하는 제12단계; 및 위 제12단계에서의 행동지침을 전달받은 상기 대응시스템에서 경보, 보고 또는 감사(audit)를 수행하는 제13단 <39> 계; 로 이루어진다. <40> 상기 제10단계에서 탐지시스템으로의 정보전달은 상기 수집시스템으로 피드백하여 전달하게 되므로 위 단계들이 <41> 반드시 일련의 순서과정인 것은 아니며 피드백되면서 학습되어지고 위협탐지가 규칙(정책)이 변형되어 간다. 효 과 상기와 같은 본 발명은 지능형 소프트웨어 로봇이 주변환경 및 외부환경과의 적응을 통한 행동특성을 적용함으 <42> 로써 감시대상인 주변환경 또는 외부환경(네트워크, 호스트 등)과의 합리적인 적응을 통하여 종래의 시스템에는 없는 자동화된 탐지정책의 갱신 및 수립이 가능하며, 종래의 단순한 침입탐지 유무로만 제공하는 정보와 관리자 가 수동으로 트래픽 증가 등의 다른 정보를 조합하여 판단하는 형태와는 다르게 본 발명은 관리자의 개입이 최 소화되고 감시대상에 대한 실제 위협을 단계적인 정보로 제공할 수 있은 장점이 있으며, 외부환경인 보안장비 (IDS, IPS, Web F/W 등)에 적용하게 되면 능동적인 보안시스템으로 진화할 수 있는 효과가 있고, 시스템에 내재 되어 변화모습을 추적하기 어려운 취약성 및 가치평가를 자동화할 수 있으며, 주변환경에 적응하고 이와 상호작 용함으로써 종래 시스템의 사후대응 및 주변환경 미적용과 같은 문제점을 해결하는 효과가 있다. 발명의 실시를 위한 구체적인 내용 이하, 첨부된 도면에 의하여 발명의 실시를 위한 구체적인 내용을 상세히 설명한다. <43> 도 2는 본 발명 시스템의 개략적인 구성으로 도시한 블록도, 도 3은 본 발명 시스템의 구성을 상세하게 도시한 <44> 블록도, 도 4는 본 발명 방법의 전체적인 흐름을 도시한 흐름도, 도 5는 본 발명 수집시스템에 일어나는 과정을 도시한 흐름도, 도 6은 본 발명 탐지시스템에서 일어나는 과정을 도시한 흐름도, 도 7은 본 발명 적응시스템에 - 9 -공개특허 10-2009-0071502서 일어나는 과정을 도시한 흐름도, 도 8은 본 발명의 최종단계에서 일어나는 과정을 도시한 흐름도이다. 본 발명의 시스템은 도 2 및 도 3에 도시한 바와 같이 <45> 외부환경 또는 주변환경의 네트워크에서 발생하는 패킷(packet), 트래픽(traffic), 이벤트(event) 또는 로그 <46> (log) 등의 데이터를 수집하고, 정규화(문자열 재정열, 축약 등) 및 재조합하는 기능을 수행하는 에이전트 (agent)부, 위 에이전트부에서 가공된 데이터를 이용하여 상태벡터(status vector)와 긴급값(urgent value)을 생성하고 관 <47> 리하는 벡터화(vectorization)부, 및 위 에이전트부 및 벡터화부에서 가공된 데이터 중에서 우선처리 되어야 하는 관심대상을 정하고, 정해진 대상에 <48> 적합하지않는 행동을 차단(제외)시키는 값을 벡터화하는 우선벡터(priority vector) 기능의 포커스셀렉터(focus selector),로 이루어져 외부 또는 주변환경으로부터 데이터를 수집, 가공 및 축약 등의 전처리하는 수집시스템(collection <49> system); 오용엔진(misuse engine), 비정상엔진(anomaly engine) 및 추론엔진(deduction engine)으로 구성되며, 상기 벡 <50> 터화부에서 생성된 상태벡터와 상기 패킷(packet), 트래픽(traffic), 이벤트(event) 또는 로그(log) 등을 선택 적으로 입력을 받아 위 수집시스템에서 전달되는 데이터를 대상으로 비정상탐지, 오용탐지 및 추론탐지에 의하 여 데이터의 위협을 탐지하는 탐지시스템(detection system); 모니터링 대상에 대한 선택 또는 주의정보 등을 조절하여 모니터링 대상에 대한 위협탐지 선호도를 학습할 수 <51> 있도록 하는 선호도학습부(preference learner),와 관리자가 직접 설정한 규칙을 보관하고 적용하는 규칙생성부(rule maker)로 구성되며, <52> 상기 수집시스템 및 탐지시스템에서 받은 데이터 및 정보로부터 선호도 및 규칙을 생성하고 모니터링하기 위한 <53> 위협수준 및 정책조정의 기본 값을 생성하는 적응시스템(adaptation system); 상기 수집시스템, 탐지시스템 및 적응시스템으로부터 데이터 및 규칙 등을 받아서 행동하는 모니터링시스템 <54> (monitoring system); 및 위 모니터링시스템으로부터 받은 행동지침에 따라 경보, 보고 또는 감사(audit)를 수행하는 대응시스템 <55> (response system); 으로 구성된다. <56> 상기와 같이 구성된 시스템을 이용하는 본 발명의 위협탐지방법은 도4 내지 도 8에 도시된 바와 같이 <57> 상기 수집시스템의 에이전트부에서 네트워크에서 발생하는 패킷(packet), 트래픽(traffic), 이벤트(event) 또는 <58> 로그(log) 등의 데이터를 수집하는 제1단계; 위 수집된 데이터를 상기 에이전트부에서 문자열을 정규화/필터링 및 재조합하여 재정열하는 제2단계; <59> 위 정규화/필터링 및 재조합된 문자열을 축약하는 제3단계; <60> 위 제3단계에서 축약된 스칼라 데이터를 상기 벡터화부에서 가공하여 상태벡터(status vector)와 긴급값(urgent <61> value)을 생성하고 관리하여 중요도 데이터를 생성하고 또한 우선순위에 따라 정렬된 데이터를 생성하고 이 데 이터를 상기 탐지시스템으로 전달하는 제4단계; 상기 포커스셀렉터에서 상기 제3단계에서 축약된 데이터 및 상기 제4단계에서 생성된 중요도 데이터 중에서 우 <62> 선처리 되어야 하는 관심대상을 정하고, 정해진 대상에 적합하지않는 행동을 차단(제외)시키는 값을 우선벡터 (priority vector)화 하여 선별된 데이터를 상기 모니터링시스템 및 적응시스템으로 전달하는 제5단계; 위 제5단계에서 생성된 우선순위에 따라 정렬된 데이터를 상기 탐지시스템에서 비정상 및 오용탐지를 위하여 프 <63> 로파일(profile)과 패턴(pattern)을 비교하는 제6-1단계; 위 제6-1단계에서 생성된 정보로서 일반적 위협정보인 위협상태벡터(threat status vector)를 생성하는 제7-1단 <64> 계; 상기 제5단계에서 생성된 우선순위에 따라 정렬된 데이터를 이용하여 상기 탐지시스템에서 추론벡터(deduction <65> - 10 -공개특허 10-2009-0071502vector)를 생성하여 추론탐지를 준비하는 제6-2단계; 위 제6-2단계에서 생성된 추론벡터를 이용하여 선호도(preference)가 포함된 추론벡터를 생성하는 제7-2단계; <66> 상기 제7-1단계 및 제7-2단계에서 생성된 정보로서 위협정보를 파악하여 상기 모니터링시스템으로 전달하는 제8 <67> 단계; 상기 수집시스템에서 전달되어오는 선별된 데이터(제5단계)를 상기 선호도학습부에서 선호도를 계산하는 제9단 <68> 계 위 계산된 선호도 정보를 정책에 따라 선택하거나 또는 주의정보를 분배하여 상기 탐지시스템 및 모니터링시스 <69> 템으로 전달하는 제10단계; 상기 수집시스템에서 전달되어오는 선별된 데이터(제5단계)를 상기 규칙생성부에서 관리자의 설정규칙과 비교하 <70> 여 해당규칙에 일치하는 데이터(마스크(mask)된 데이터)를 상기 모니터링시스템으로 전달하는 제11단계; 및 상기 제5단계, 제8단계 및 제11단계에서 정보를 전달받은 상기 모니터링시스템에서 그 정보를 바탕으로 위협여 <71> 부에 대한 행동지침을 상기 대응시스템에 전달하는 제12단계; 및 위 제12단계에서의 행동지침을 전달받은 상기 대응시스템에서 경보, 보고 또는 감사(audit)를 수행하는 제13단 <72> 계; 로 이루어진다. <73> 상기와 같은 단계들은 이하에서 설명하는 수학식들에 의하여 구체화되며 그리하여 본 발명이 당업자에 의하여 <74> 쉽게 이해되어 실시될 수 있다. 상기 제4단계에서 상태벡터(Status Vector)는 아래 수학식 1에 의하여 구해진다. <75> 수학식 1 <76> 상기 제5단계에서 우선벡터(priority vector)는 아래 수학식 2에 의하여 구해진다. <77> 수학식 2 <78> 또한 상기 제5단계에서 정해진 대상에 적합하지않는 행동을 차단(제외)시키는 관심도 차단행렬은 아래 수학식 3 <79> 에 의하여 구해질 수 있다. 수학식 3 <80> 상기 제7-1단계에서 위협이 가해지고 있는 탐지된 관찰 및 모니터링 대상은 아래의 수학식 4에서 구한다. <81> - 11 -공개특허 10-2009-0071502수학식 4 <82> 상기 제6-2단계에서 추론벡터(deduction vector)는 아래 수학식 5에서 구할 수 있다. <83> 수학식 5 <84> 위 수학식 5에서 시간 t에서 각 \"d\" 값은 수학식 6에서 구하게 된다. <85> 수학식 6 <86> 상기 수학식 6에서 연결강도의 값은 아래 수학식 7에서 구할 수 있다. <87> 수학식 7 <88> 위 수학식 7에서 연결강도의 변화량은 아래 수학식 8에서 구한다. <89> 수학식 8 <90> 상기 제11단계에서 관리자의 설정규칙은 아래 수학식 9에서 구하여 적용한다. <91> - 12 -공개특허 10-2009-0071502수학식 9 <92> 상기 제12단계에서 위협여부에 대한 판단은 먼저 일반적인 위협정보(AT temp)를 아래의 수학식 10에서 구한 후, 수 <93> 학식11을 이용하여 본 발명의 지능형 소프트웨어 로봇의 행동특성을 이용한 실질적 위협정보(AT)를 구하게 된다. 위와 같이 위협정보를 구하게 됨으로써 주변환경에 적응하고 이와 상호작용하여 변화하는 위협정보를 구할 수 <94> 있게 된다. 수학식 10 <95> 수학식 11 <96> 이하에서는 상기와 같이 이루어진 본 발명의 일 실시예를 첨부한 도면을 참고로 설명한다. <97> 도 9는 본 발명 일 실시예의 메인화면의 구성을 나타내는 화면이고, 도 10a는 본 발명 수집시스템의 에이전트부 <98> 를 나타내는 도면이며, 도 10b는 본 발명 수집시스템의 에이전트부의 규칙을 설정하는 화면이고, 도 11은 본 발 명 수집시스템의 벡터화부의 화면이며, 도 12는 본 발명 수집시스템의 포커스셀렉터의 구성을 나타내는 화면이 고, 도 13은 본 발명 탐지시스템의 탐지 정책의 결과를 상태를 나타내는 화면이며, 도 14는 본 발명 탐지시스템 의 오용탐지의 정책과 패턴을 설정하는 화면이고, 도 15는 본 발명 탐지시스템의 비정상탐지의 정책을 설정하는 화면이며, 도 16은 본 발명 탐지시스템의 추론탐지의 정책을 설정하는 화면이고, 도 17은 본 발명 적응시스템의 선호도학습부의 학습리스트 및 가중치를 나타내는 화면이며, 도 18은 본 발명 적응시스템의 규칙생성부의 정책 을 생성 및 수정할 수 있는 화면이고, 도 19는 본 발명 모니터링시스템에서 각 수집대상의 상태벡터, 시간에 따 른 위협수준, 이벤트 통계 등을 보여주는 화면이며, 도 20은 본 발명 탐지시스템에서 탐지된 결과를 보여주는 화면이고, 도 21은 본 발명 대응시스템에 의한 대응행동을 보여주는 화면이며, 도 22는 본 발명 모니터링시스템 의 보여지는 벡터를 설정하는 화면이고, 도 23은 본 발명 대응시스템의 대응이력을 조회한 화면이고, 도 24는 본 발명 대응시스템의 대응보고서를 나타낸 화면이다. 좀더 상세하게 설명하면, 도 9는 수집시스템의 상태(데이터를 수집, 가공 및 축약하는 상황), 탐지시스템의 상 <99> 태(오용, 비정상, 추론 탐지 엔진에서 탐지된 이벤트) 및 적응시스템의 상태(선호도 및 위협수준/정책조정 적용 여부)의 세 시스템의 현재 상태를 실시간(시간 간격 설정 가능)적으로 보여 주는 화면이고, 도 10a는 외부환경 또는 주변 환경의 네트워크에서 발생하는 패킷(packet), 트래픽(traffic), 이벤트(event) 또 <100> 는 로그(log) 등의 데이터(Low Data)를 수집 상태와 그 데이터를 정규화(문자열 재정열, 축약 등: Parsing Data) 및 재조합(Summary Data)하는 상태를 보여 주는 화면이며, - 13 -공개특허 10-2009-0071502도 10b는 수집 대상 데이터(Low Data)의 정의 및 그 데이터를 정규화(문자열 재정열, 축약 등: Parsing Data) <101> 및 재조합(Summary Data)하는 규칙을 설정하는 화면이고, 도 11은 에이전트부에서 가공된 데이터를 이용하여 상태벡터를 생성하고 대상 벡터를 탐지 및 적응에 참여시킬 <102> 지 여부를 설정하는 화면이며, 도 12는 포커스셀렉터화면으로서 에이전트부와 벡터화부에서 가공된 데이터(외부환경 또는 주변 환경의 네트워 <103> 크에서 발생하는 패킷(packet), 트래픽(traffic), 이벤트(event) 또는 로그(log) 등의 데이터(Low Data)를 포 함한 OS Info, CPU Info, Memory Info 등 각종 보안이벤트 및 관리자의 보안이벤트 처리행위) 중에서 우선처리 되어야 하는 관심대상을 정하고, 정해진 대상에 적합하지않는 행동을 차단(제외)시키는 값을 벡터화하는 우선벡 터를 만들도록 그 적용순위/여부를 설정하고 해당된 기록을 검색하는 기능을 제공하는 화면이며, 도 16은 대상 벡터에 대한 관심도 차단 행렬을 위한 차단 설정과 추론벡터를 구하는데 필요한 추론 변화 Gain <104> 값을 설정하는 화면이고, 도 17은 대상 벡터의 선호도 값을 조회하고 대상 벡터에 대한 선호도 값을 변경 설정하여 선호도 학습의 결과를 <105> 조정할 수 있는 화면이며, 도 18은 선호도 학습 이외에 관리자 또는 가이드라인 등에 의해 관리되는 항목들의 규칙을 관리하고 생성/수정 <106> 된 규칙을 조회하는 화면이고, 도 19는 에이전트부에서 가공된 데이터 중, 긴급 값이 설정되어 모니터링 시스템으로 전송된 데이터의 상태를 <107> 보여주고, 각 수집대상의 상태벡터, 시간에 따른 위협수준, 이벤트 통계 등을 제공하는 화면이며, 도 20은 탐지시스템(오용, 비정상, 추론)에서 탐지된 결과를 보여주고, 각 수집대상의 상태벡터, 시간에 따른 <108> 위협수준 및 구체적인 탐지 내역 등을 제공하는 화면이고, 도 21은 모니터링시스템으로부터 받은 행동지침에 따라 경보, 보고 또는 감사를 수행한 본 발명 대응시스템에 <109> 의한 관리자의 대응행동을 보여주는 화면이며, 도 22은 일반적인 위협정보로부터 적응된 위협정보를 보기 위해 설정해야 하는 값들 중에 규칙 차단/선택 행렬 <110> 을 대상 벡터 별로 설정하는 화면이다. 상기 일 실시예에서 선호도는 추론에 대한 선호도로서, 가중치를 두어 위협으로 판단할 것인 지 여부를 판단할 <111> 수 있는 기준값으로서, 고정된 값이 아니라 학습 또는 경험에 의하여 강화 또는 약화되는 값이며, 수학식 7은 추론에 대한 선호도를 구하는 식으로서 강화 또는 약화될 수 있으며, 강화 또는 약화되는 강도의 변화량은 수학 식 8에서 구할 수 있고, 차단하여야 할 위협정보인지 아니면 차단되지 않아도 될 위협정보인지는 수학식 9에 의 하여 생성되어 규칙을 설정할 수 있으며, 탐지단계에서 얻어진 데이터를 프로파일과 패턴을 비교하여 오용(misuse) 및 비정상(anomaly) 데이터에 대한 정 <112> 보를 생성하고, 이렇게 생성된 정보를 상태벡터(수학식 1)를 이용하여 위협상태벡터를 생성하고, 추론의 대상은 각종 데이터 값으로서, OS(Operating System), CPU, 메모리, 인터페이스, 트래픽(traffic), 취 <113> 약점, IDS 로그(log), 방화벽 로그, 라우터 로그, 시스템 로그, 테스트인터페이스 또는 테스트 트래픽의 정보와 같은 값을 상기 수학식 6, 7 및 8을 이용하여 수학식 5의 추론 값(벡터 값)을 구할 수 있고, 위 추론에 의하여 구하여지는 추론 값은 도 16의 gain 값이며, 이 gain 값은 학습에 의하여 변화되면서 정해질 <114> 수도 있으며, 관리자가 임의로 먼저 정하여 주거나 또는 사후에 변경할 수 있게 되며, 이 gain 값의 정도에 의 하여 모니터링시스템에서는 위협여부를 판단하게 되고, 모니터링하기 위한 위협수준 및 정책조정의 기본 값은 수학식 9에서 규칙차단 및 선택행렬을 생성한 후, 수학식 <115> 10에서 추론 벡터를 이용하여 일반적인 위협정보를 구하고, 이 일반적인 위협정보를 이용하여 수학식 11에서 수 학식 10에서 생성한 값을 곱하여 실질적 위협정보를 획득하여 모니터링을 위한 위협수준 및 정책조정의 기본값 을 생성하며, 모니터링시스템에서는 수집된 데이터에 위협여부가 존재하는 지를 감시하여 경보(alarm), 보고(report) 또는 감 <116> 사(audit) 행동을 수행할 지 여부의 행동지침을 결정하고, 대응시스템에서는 위에서 결정된 행동지침에 의하여 경보(alarm), 보고(report) 또는 감사(audit) 행동을 수행 <117> 하여 위협되는 데이터 탐지할 수 있다. - 14 -공개특허 10-2009-0071502한편 이하에서는 주요 수학식의 역할과 입력값 및 리턴값을 제시하고 이에대한 pseudo-code를 나타내었다. <118> <수학식1> <119> 역할: 에이전트부에서 가공된 데이터를 이용하여 상태벡터를 만든다. <120> 입력값: 에이전트부에서 가공된 데이터(이벤트 스트링) <121> 리턴값: 가공된 데이터로부터 얻게 될 상태벡터 <122> pseudo-code <123> #define num_of_target1024// 벡터화될 정보수집 종류의 총 수 <124> #define num_of_element256*256// 수집정보 중 관심대상의 총 개수(예: 모니터링 대상의 서버 총 대수) <125> StringstrEvent[num_of_target][num_of_element]; // 에이전트부에서 가공된 데이터 <126> floatS[num_of_target][num_of_element]; // 상태벡터(Status Vector) <127> intiTarget; // 벡터화될 정보수집 종류의 수 , 벡터설정에서 결정 <128> intiElement; // 수집정보 중 관심대상의 총 개수: 벡터설정에서 결정 <129> int Vectorization(String,int); <130> int Vectorization(String** Event, float** S) <131> { <132> int i, j; <133> for(i=0; i<iTarget; i++) <134> { <135> for(j=0; j<iElement; j++) <136> { // 에이전트부에서 가공된 데이터가 \"Sensing\" 되었다면 <137> // 단계가 여러 단계일 수 있으나 여기서는 두 단계로만 정의 <138> // 0≤S≤1, S는 실수 <139> if(strEvent[i][j] == \"Sensing\") <140> { <141> S[i][j] = 1.0;// 상태벡터의 해당 요소에 1 값을 저장 <142> } <143> else <144> { <145> S[i][j] = 0;// 그렇지 않다면 0 값을 저장 <146> } <147> } <148> } <149> <150> return EXIT_SUCCESS; <151> } <152> <수학식 6> <153> - 15 -공개특허 10-2009-0071502 역할: 벡터화부에서 생성된 상태벡터와 외부환경 또는 주변 환경의 네트워크에서 발생하는 패킷(packet), <154> 트래픽(traffic), 이벤트(event) 또는 로그(log) 등의 데이터(Low Data)를 포함한 OS Info, CPU Info, Memory Info 등 각종 보안이벤트 및 관리자의 보안이벤트 처리행위 등으로부터 위협을 추론한다. 입력값: - 추론 변화 Gain 값 <155> - 시간 t까지의 추론 벡터의 평균 값 <156> - 시간 t까지의 추론 벡터의 요소 합 <157> - 상태 벡터 <158> - Sj와 Dj와의 연결 강도 벡터 <159> 리턴값: - 시간 t+1에서 추론 벡터 값 <160> - 시간 t+1에서 추론 벡터의 평균 값 <161> - 시간 t+1에서 추론 벡터의 요소 합 <162> pseudo-code <163> #define num_of_target1024// 벡터화될 정보수집 종류의 총 수 <164> #define num_of_element256*256// 수집정보 중 관심대상의 총 개수(예: 모니터링 대상의 서버 총 대수) <165> #define time_step 1.0// 추론벡터를 구하는 시간 단위 (기본값: 1초) <166> StringstrEvent[num_of_target][num_of_element]; // 에이전트부에서 가공된 데이터 <167> floatS[num_of_target][num_of_element]; // 상태벡터(Status Vector) <168> floatd[num_of_target][num_of_element]; // 시간 t에서 추론벡터 <169> floatSum_d[num_of_target][num_of_element]; // 시간 t까지 추론벡터의 요소의 합 <170> floatmd[num_of_target][num_of_element]; // 시간 t까지 추론벡터의 평균값 <171> floatlambda[num_of_target][num_of_element];// 추론 변화 Gain <172> floatW[num_of_target][num_of_element]; // 상태벡터 Sj와 추론벡터 Dj와의 연결 강도 <173> intiTarget; // 벡터화될 정보수집 종류의 수 , 벡터설정에서 결정 <174> intiElement; // 수집정보 중 관심대상의 총 개수: 벡터설정에서 결정 <175> float nTime; // 추론을 시행하는 시간 <176> float DotVector(float**,float**); // 두 벡터의 내적을 구하는 함수 <177> int Deduction_Vector(float**, float**, float**, float** float**, float**); <178> int Deduction_Vector(float **d, float **lambda, float **md, float Sum_d, float **S, float **W) <179> { <180> int i, j; <181> <182> for(i=0; i<iTarget; i++) <183> { <184> for(j=0; j<iElement; j++) <185> { <186> // [수학식 6]의 구현 <187> - 16 -공개특허 10-2009-0071502d[i][j] += lambda[i][j]*(md[i][j] - d[i][j]) + DotVector(&S, &W); <188> // 추론벡터의 평균값 구하기 <189> Sum_d[i][j] += d[i][j]; <190> md[i][j] = Sum_d[i][j] / nTime; <191> } <192> } <193> // t → t+1 로 이동 <194> nTime += time_step; <195> return EXIT_SUCCESS; <196> } <197> <수학식 10> <198> 역할: 위협탐지 벡터와 시간 t에서 추론벡터를 통해 일반적인 위협정보를 얻는다. <199> 입력값: - 위협탐지 벡터 <200> - 시간 t에서 추론 벡터 <201> 리턴값: - 일반적인 위협정보 벡터 <202> pseudo-code <203> #define num_of_target1024 // 벡터화될 정보수집 종류의 총 수 <204> #define num_of_element256*256 // 수집정보 중 관심대상의 총 개수(예: 모니터링 대상의 서버 총 대 <205> 수) float r[num_of_target][num_of_element]; // 위협탐지 벡터, 오용탐지/비정상탐지로부터 얻은 값 <206> float d[num_of_target][num_of_element];// 시간 t에서 추론벡터 <207> float Atemp[num_of_target][num_of_element];// 일반적인 위협정보 <208> intiTarget; // 벡터화될 정보수집 종류의 수 , 벡터설정에서 결정 <209> intiElement; // 수집정보 중 관심대상의 총 개수: 벡터설정에서 결정 <210> int General_Threat_Info(float**, float**, float**); <211> int General_Threat_Info(float **Atemp, float **r, float **d) <212> { <213> int i, j; <214> for(i=0; i<iTarget; i++) <215> { <216> for(j=0; j<iElement; j++) <217> { <218> // [수학식 10]의 구현 <219> Atemp[i][j] = r[i][j]*d[i][j]; <220> } <221> } <222> - 17 -공개특허 10-2009-0071502return EXIT_SUCCESS; <223> } <224> <수학식 11> <225> 역할: 일반적인 위협정보로부터 관심도와 규칙을 반영하여 주변 환경에 적응하고 이와 상호작용한 위협정보 <226> 벡터를 얻는다. 입력값: - 일반적인 위협정보 벡터 <227> - 관심도 차단 행렬(벡터) <228> - 규칙 차단/선택 행렬(벡터) <229> 리턴값: - 위협정보 벡터 <230> pseudo-code <231> #define num_of_target1024 // 벡터화될 정보수집 종류의 총 수 <232> #define num_of_element256*256 // 수집정보 중 관심대상의 총 개수(예: 모니터링 대상의 서버 총 대 <233> 수) float Atemp[num_of_target][num_of_element];// 일반적인 위협정보 <234> float A[num_of_target][num_of_element];// 주변환경에 적응하고 이와 상호작용한 위협정보 <235> float Mf[num_of_target][num_of_element]; // 관심도 차단 행렬 <236> float Mr[num_of_target][num_of_element]; // 규칙 차단/선택 행렬 <237> intiTarget; // 벡터화될 정보수집 종류의 수 , 벡터설정에서 결정 <238> intiElement; // 수집정보 중 관심대상의 총 개수: 벡터설정에서 결정 <239> floatDotVector(float**,float**); // 두 벡터의 내적을 구하는 함수 <240> int Threat_Info(float**,float**,float**,float**); <241> int Threat_Info(float **A, float **Atemp, float **Mf, float **Mr) <242> { <243> for(i=0; i<iTarget; i++) <244> { <245> for(j=0; j<iElement; j++) <246> { <247> // [수학식 11]의 구현 <248> A[i][j] = Atemp[i][j]*Mf[i][j]*Mr[i][j]; <249> } <250> } <251> <252> return EXIT_SUCCESS; <253> } <254>"}
