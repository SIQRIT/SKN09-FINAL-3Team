{"patent_id": "10-2022-0179231", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2024-0097299", "출원번호": "10-2022-0179231", "발명의 명칭": "인공지능 기반 단일 객체 움직임 추적 시스템", "출원인": "주식회사 리얼타임테크", "발명자": "이승국"}}
{"patent_id": "10-2022-0179231", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "입력되는 영상 프레임에 이전 영상 프레임에서 결정된 기 설정된 크기의 바운딩 영역을 설정하고, 이전 바운딩영역을 기 설정된 확장 상수를 이용하여 확장시켜 관심 영역을 결정하며, 이 관심 영역을 객체위치 식별모델에서 요구하는 크기로 리사이징 처리하여 입력 이미지를 생성하는 입력 이미지 생성부와,기 수행된 학습결과에 기초하여 리사이징된 입력 이미지에 대응되는 바운딩 박스의 중심점 좌표 및 바운딩 박스의 높이값과 너비값을 포함하는 바운딩 박스 정보를 출력하는 객체위치 식별모델 및,객체위치 식별모델을 통해 제공되는 바운딩 박스정보를 현재 영상 프레임에 반영하여 객체 위치를결정함으로써, 연속되는 영상 프레임에서 목표 객체의 움직임을 추적하는 객체 추적부를 포함하여 구성되는 것을 특징으로 하는 인공지능 기반 단일 객체 움직임 추적 시스템."}
{"patent_id": "10-2022-0179231", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,기 수행된 학습결과에 기초하여 영상 프레임 전체 이미지를 입력받아 해당 영상 프레임내에 존재하는 객체 종류및 객체 위치정보를 출력하는 객체 탐지모델을 추가로 구비하여 구성되고,상기 입력 이미지 생성부는 초기 영상 프레임을 객체 탐지모델로 입력하여 목표 객체 위치를 획득하고, 획득된목표 객체 위치를 기준으로 초기 영상 프레임에 대한 바운딩 박스를 설정하는 것을 특징으로 하는 인공지능 기반 단일 객체 움직임 추적 시스템."}
{"patent_id": "10-2022-0179231", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1항에 있어서,기 수행된 학습결과에 기초하여 영상 프레임 전체 이미지를 입력받아 해당 영상 프레임내에 존재하는 객체 종류및 객체 위치정보를 출력하는 객체 탐지모델을 추가로 구비하여 구성되고,상기 객체위치 식별모델은 리사이징된 입력 이미지에 목표 객체가 존재할 확률값을 추가로 도출하며,상기 객체 움직임 추적부는 객체위치 식별모델을 통해 획득한 객체 존재 확률값이 기준 확률값 미만인 경우에는해당 영상 프레임을 객체 탐지모델에 입력하여 해당 영상 프레임내에 존재하는 목표 객체의 존재 유무와 위치정보를 획득하는 것을 특징으로 하는 인공지능 기반 단일 객체 움직임 추적 시스템."}
{"patent_id": "10-2022-0179231", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제1항에 있어서,상기 객체위치 식별모델이 도출한 바운딩 박스정보와 하기 수학식을 이용하여 산출된 레이블 데이터간의 유사도를 기반으로 객체 위치 모델의 학습을 진행하는 것을 특징으로 하는 인공지능 기반 단일 객체 움직임 추적 시스템.공개특허 10-2024-0097299-3-여기서, h,w 는 기존에 라벨링한 객체의 바운딩 박스 높이와 너비이고, H,W 는 기 기정한 객체 위치 식별 모델의 입력 사이즈이며, 는 기존에 라벨링한 객체의 바운딩 박스를 확장시킨 관심영역을 객체 위미 식별모델의 입력 사이즈에 맞도록 리사이징 했을때의 바운딩 박스의 중심 x,y 좌표와, 높이 및 너비이고, a,b,c,d는학습 데이터 제작용 확장 상수임."}
{"patent_id": "10-2022-0179231", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제1항에 있어서상기 객체 움직임 추적부는 하기 수학식을 이용하여 객체위치 식별모델을 통해 획득된 바운딩 박스 위치정보를영상 프레임 전체 이미지에 대한 위치값으로 변환하는 것을 특징으로 하는 인공지능 기반 단일 객체 움직임 추적 시스템. 여기서, x',y' 는 객체위치 식별모델을 통해 획득된 리사이징 된 현재 시점 관심 영역에서의 바운딩 박스 중심점 좌표이고, w',h' 는 객체위치 식별모델을 통해 획득된 리사이징 된 현재 시점 관심 영역에서의 바운딩 박스의 너비와 높이, x1,y1 은 현재 시점의 영상 프레임 전체 이미지에 대한 바운딩 박스 중심점 좌표, x0, y0 는 이전 시점의 영상 프레임 전체 이미지에 대한 바운딩 박스 중심점 좌표, H,W 는 기 지정한 객체 위치 식별 모델의입력 사이즈, w0, h0 는 이전 시점의 영상 프레임 전체 이미지에 대한 바운딩 박스의 너비와 높이, w1, h1 는 현재 시점의 영상 프레임 전체 이미지에 대한 바운딩 박스의 너비와 높이, α는 객체 위치 추적을 위한 관심 영역설정용 확장 상수임."}
{"patent_id": "10-2022-0179231", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 인공지능을 이용하여 분석 영상에서 단일 객체의 움직임을 추적하는 방법에 관한 것으로, 객체 탐지 모델이 아닌 보다 작은 추론 시간과 필요 자원이 요구되는 객체 위치 식별 모델을 이용하여 객체의 움직임을 추 적하는 기술에 관한 것이다. (뒷면에 계속)"}
{"patent_id": "10-2022-0179231", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 인공지능을 이용하여 분석 영상에서 객체의 움직임을 추적하는 방법에 관한 것으로, 객체 탐지 모델 이 아닌 보다 작은 추론 시간과 필요 자원이 요구되는 객체 위치 식별 모델을 이용하여 객체의 움직임을 추적하 는 기술에 관한 것이다."}
{"patent_id": "10-2022-0179231", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "인공지능 기술의 발전에 따라 인공지능은 자연어 처리, 음성 인식, 데이터 마이닝, 컴퓨터 비전, 지능형 로봇 등 매우 다양한 분야에서 사용되고 있다. 여기서, 객체 탐지 기술은 일반적으로 주어진 영상에 존재하는 객체를 탐지하고자 객체 탐지(Object detectio n)용 AI 모델을 사용하게 되는데, 이러한 객체 탐지 모델에는 객체의 종류에 대한 정보를 도출하는데 필요한 매 개변수 및 연산들이 포함되어 모델의 학습 및 추론에 사용된다. 그러나, 일반적으로 사용되는 객체 탐지 모델들을 이용하여 영상에서 단일 객체를 탐지하고 움직임을 추적하고 자 하는 경우, 불필요한 객체의 종류에 대한 정보까지 도출하게 되므로, 추론 시간 측면이나, 컴퓨터 자원의 활 용 측면에서 효율적이지 않다. 또한, 일반적으로 사용되는 객체 탐지 모델의 경우에는 연속된 프레임에서 매 프레임마다 프레임의 전체 영역을 객체 탐지 모델의 입력으로 제공하게 되는데, 프레임의 크기가 객체 탐지 모델의 입력 이미지의 크기보다 훨씬 크기 때문에 입력 프레임의 크기를 강제로 줄이는 과정을 수행하게 된다. 예컨대, 입력 이미지가 일반적인 크기에 비해 큰 8192 × 8192 크기의 이미지이고, 이미지를 분류하기 위한 대 상 특징의 크기가 40 × 40일 경우에. 이미지 내 대상 크기가 차지하는 비율은 0.003% 이하로 매우 작다. 이때, 기존 인공지능 방법론을 이용하기 위해 입력 이미지를 1024 × 1024로 줄이게 되면 인식 대상의 크기가 5 × 5 픽셀 미만으로 줄어들어 인식이 매우 힘들다. 종래의 가장 큰 문제점은 AI 신경망의 입력 데이터 크기에 맞춰서 입력 이미지의 크기를 강제로 줄이는 것에 의 해 발생한다. 특히 반도체 공정과 같은 미세 공정에서는 결함의 크기가 매우 작기 때문에 불량 판별을 위해서는 고해상도 촬영이 반드시 필요하다. 이때, 종래 AI 기술 이용을 위해서 이미지 크기를 줄이게 되면 각 원본 픽셀 이 가지고 있는 정보를 잃게 되는 문제가 있다. 즉, 단순히 리사이징을 통해 입력 이미지의 크기를 줄이는 방식은 픽셀 정보의 손실을 일으킬 수 있다. 실제 상 황에서는 전체 이미지에 대해 결함이 차지하는 비율이 굉장히 작기 때문에 이러한 정보의 손실이 치명적으로 작 용할 수 있다. 또한 객체 탐지 모델의 결과값을 해석하는 과정에서 프레임의 크기를 조정한 과정을 고려하게 됨으로써 전체 프 레임에서의 객체의 위치 정보가 부정확하게 도출될 수 있다. 선행기술문헌 특허문헌 (특허문헌 0001) 1. 한국등록특허 제10-2186875호 (명칭 : 움직임 추적 시스템 및 방법) (특허문헌 0002) 2. 한국등록특허 제10-2189502호 (명칭 : 객체 추적 장치 및 객체 추적 방법)"}
{"patent_id": "10-2022-0179231", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "이에, 본 발명은 상기한 사정을 감안하여 창출된 것으로, 분석하고자 하는 영상에서 단일 객체의 위치를 기반으 로 객체 움직임을 탐색함으로써, 추론 시간과 컴퓨팅 비용을 절감할 수 있고, 객체의 주변 영역을 관심영역으로 설정하고, 이를 리사이징 처리하여 객체 위치 식별 모델의 입력 이미지로 제공하여 객체 움직임을 분석함으로써, 이미지의 크기가 강제로 리사이징되는 비율을 줄여 객체 위치 식별 모델을 통한 객체 움직임 탐 색 정확성을 향상시킬 수 있도록 해 주는 인공지능 기반 단일 객체 움직임 추적 시스템을 제공함에 그 기술적 목적이 있다."}
{"patent_id": "10-2022-0179231", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "상기 목적을 달성하기 위한 본 발명의 일측면에 따르면, 입력되는 영상 프레임에 이전 영상 프레임에서 결정된 기 설정된 크기의 바운딩 영역을 설정하고, 이전 바운딩 영역을 기 설정된 확장 상수를 이용하여 확장시켜 관심 영역을 결정하며, 이 관심 영역을 객체위치 식별모델에서 요구하는 크기로 리사이징 처리하여 입력 이미지를 생 성하는 입력 이미지 생성부와, 기 수행된 학습결과에 기초하여 리사이징된 입력 이미지에 대응되는 바운딩 박스 의 중심점 좌표 및 바운딩 박스의 높이값과 너비값을 포함하는 바운딩 박스 정보를 출력하는 객체위치 식별모델 및, 객체위치 식별모델을 통해 제공되는 바운딩 박스정보를 현재 영상 프레임에 반영하여 객체 위치를 결정함으 로써, 연속되는 영상 프레임에서 목표 객체의 움직임을 추적하는 객체 추적부를 포함하여 구성되는 것을 특징으 로 하는 인공지능 기반 단일 객체 움직임 추적 시스템이 제공된다. 또한, 기 수행된 학습결과에 기초하여 영상 프레임 전체 이미지를 입력받아 해당 영상 프레임내에 존재하는 객 체 종류 및 객체 위치정보를 출력하는 객체 탐지모델을 추가로 구비하여 구성되고, 상기 입력 이미지 생성부는 초기 영상 프레임을 객체 탐지모델로 입력하여 목표 객체 위치를 획득하고, 획득된 목표 객체 위치를 기준으로 초기 영상 프레임에 대한 바운딩 박스를 설정하는 것을 특징으로 하는 인공지능 기반 단일 객체 움직임 추적 시 스템이 제공된다. 또한, 기 수행된 학습결과에 기초하여 영상 프레임 전체 이미지를 입력받아 해당 영상 프레임내에 존재하는 객 체 종류 및 객체 위치정보를 출력하는 객체 탐지모델을 추가로 구비하여 구성되고, 상기 객체위치 식별모델은 리사이징된 입력 이미지에 목표 객체가 존재할 확률값을 추가로 도출하며, 상기 객체 움직임 추적부는 객체위치 식별모델을 통해 획득한 객체 존재 확률값이 기준 확률값 미만인 경우에는 해당 영상 프레임을 객체 탐지모델에 입력하여 해당 영상 프레임내에 존재하는 목표 객체의 존재 유무와 위치정보를 획득하는 것을 특징으로 하는 인 공지능 기반 단일 객체 움직임 추적 시스템이 제공된다. 또한, 상기 객체위치 식별모델이 도출한 바운딩 박스정보와 하기 수학식을 이용하여 산출된 레이블 데이터간의 유사도를 기반으로 객체 위치 모델의 학습을 진행하는 것을 특징으로 하는 인공지능 기반 단일 객체 움직임 추 적 시스템이 제공된다. 여기서, h,w 는 기존에 라벨링한 객체의 바운딩 박스 높이와 너비이고, H,W 는 기 지정한 객체 위치 식별 모델의 입력 사이즈이며, 는 기존에 라벨링 한 객체의 바운딩 박스를 확장시킨 관심영역을 객체 위미 식별 모델의 입력 사이즈에 맞도록 리사이징 했을때의 바운딩 박스의 중심 x,y 좌표와, 높이 및 너비이고, a,b,c,d는 학습 데이터 제작용 확장 상수임. 또한, 상기 객체 움직임 추적부는 하기 수학식을 이용하여 객체위치 식별모델을 통해 획득된 바운딩 박스 위치 정보를 영상 프레임 전체 이미지에 대한 위치값으로 변환하는 것을 특징으로 하는 인공지능 기반 단일 객체 움 직임 추적 시스템이 제공된다. 여기서, x',y' 는 객체위치 식별모델을 통 해 획득된 리사이징 된 현재 시점 관심 영역에서의 바운딩 박스 중심점 좌표이고, w',h' 는 객체위치 식별모델 을 통해 획득된 리사이징 된 현재 시점 관심 영역에서의 바운딩 박스의 너비와 높이, x1,y1 은 현재 시점의 영 상 프레임 전체 이미지에 대한 바운딩 박스 중심점 좌표, x0, y0 는 이전 시점의 영상 프레임 전체 이미지에 대 한 바운딩 박스 중심점 좌표, H,W 는 기 지정한 객체 위치 식별 모델의 입력 사이즈, w0, h0 는 이전 시점의 영상 프레임 전체 이미지에 대한 바운딩 박스의 너비와 높이, w1, h1 는 현재 시점의 영상 프레임 전체 이미지에 대한 바운딩 박스의 너비와 높이, α는 객체 위치 추적을 위한 관심 영역 설정용 확장 상수임."}
{"patent_id": "10-2022-0179231", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명에 의하면, 연속하는 영상 프레임에 존재하는 단일 객체의 움직임을 객체위치 식별모델을 이용하여 보 다 신속하게 추적할 수 있다. 예컨대, 웨이퍼 클리닝 장비가 구동될 때 내부 용액 토출구의 움직임을 객체위치 식별모델을 이용하여 추적함으 로써, 실시간으로 장비 내의 구동 상황을 용이하게 파악할 수 있다. 또한, 이러한 기술은 광학 현미경을 이용하여 촬영된 확대 영상에서의 관찰 목표 입자의 운동을 실시간으로 추 적하는 분야에도 적용하게 실시할 수 있다."}
{"patent_id": "10-2022-0179231", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "본 발명에 기재된 실시예 및 도면에 도시된 구성은 본 발명의 바람직한 실시예에 불과할 뿐이고, 본 발명의 기 술적 사상을 모두 표현하는 것은 아니므로, 본 발명의 권리범위는 본문에 설명된 실시예 및 도면에 의하여 제한 되는 것으로 해석되어서는 아니 된다. 즉, 실시예는 다양한 변경이 가능하고 여러 가지 형태를 가질 수 있으므 로 본 발명의 권리범위는 기술적 사상을 실현할 수 있는 균등물들을 포함하는 것으로 이해되어야 한다. 또한, 본 발명에서 제시된 목적 또는 효과는 특정 실시예가 이를 전부 포함하여야 한다거나 그러한 효과만을 포함하여 야 한다는 의미는 아니므로, 본 발명의 권리범위는 이에 의하여 제한되는 것으로 이해되어서는 아니 될 것이다. 여기서 사용되는 모든 용어들은 다르게 정의되지 않는 한, 본 발명이 속하는 분야에서 통상의 지식을 가진 자에 의해 일반적으로 이해되는 것과 동일한 의미를 가진다. 일반적으로 사용되는 사전에 정의되어 있는 용어들은 관 련 기술의 문맥상 가지는 의미와 일치하는 것으로 해석되어야 하며, 본 발명에서 명백하게 정의하지 않는 이상 적이거나 과도하게 형식적인 의미를 지니는 것으로 해석될 수 없다. 도1은 본 발명의 제1 실시예에 따른 인공지능 기반 단일 객체 움직임 추적 시스템의 개략적인 구성을 도시한 도 면이다. 도1을 참조하면, 본 발명에 따른 인공지능 기반 단일 객체 움직임 추적 시스템은, 입력 이미지 생성부와, 객체위치 식별모델 및, 객체 움직임 추적부를 포함하고, 객체 탐지모델을 추가로 더 포함할 수 있다. 입력 이미지 생성부는 이전 영상 프레임을 대상으로 한 객체 위치 식별모델 및 객체 탐지모델의 추론값에 기인하여 현 시점 영상 프레임에 대한 목표 객체와 바운딩 박스(bounding box)를 설정한다. 도2 (A)에는 웨이 퍼 클리닝 장비의 내부 용액 토출구를 목표 객체로 하는 영상 프레임에서 너비 w, 높이 h로 설정된 바운딩 박스 (B)가 도시되어 있다. 이때, 목표 객체는 일정 이하의 이동 속도를 갖는 단일 객체로서, 목표 객체의 위치정보는 객체 움직임 추적부 에 의해 제공될 수 있으며, 예컨대 목표 객체의 중심점 좌표로 제공될 수 있다. 여기서, 목표 객체의 중심 점 좌표는 바운딩 박스의 중심점 좌표가 된다. 또한, 입력 이미지 생성부는 확장 상수를 근거로 바운딩 박스를 상,하,좌,우로 확장하여 관심영역(ROI)을 설정하고, 이 관심 영역을 추출한 후, 객체위치 식별모델의 입력 이미지 크기에 적합하게 리사이징 처리하 여 입력 이미지를 생성한다. 이때, 확장 상수는 객체 움직임 추적부에 의해 제공되며, 목표 객체의 이동 방향 및 이동 속도에 비례하여 설정될 수 있다. 도2 (B)에는 확장 상수 a,b,c,d에 의해 설정된 관심영역(R)이 도시되어 있다. 여기서, x,y 는 바운딩 박스(B)의 중심점 좌표이다. 본 발명에서는 도2 (A)와 같은 영상 프레임 전체를 리사이징하여 입력 이미지를 생성하는 것이 아니라, 도2 (B)와 같이 영상 프레임에서 상당히 작은 영역인 관심 영역의 이미지를 리사이징하여 입력 이미지를 생성하기 때문에, 정보의 손실이 상대적으로 적게 발생한다. 객체위치 식별모델은 인공지능 신경망을 이용하여 입력 이미지를 분석하여 학습하고, 기 수행된 학습결과 에 기초하여 리사이징된 입력 이미지에 대응되는 바운딩 박스의 중심점 좌표 및 바운딩 박스의 높이값과 너비값 을 포함하는 바운딩 박스 정보를 출력한다. 이때, 객체위치 식별모델은 입력 이미지가 입력되면, 위치 속성별 제1 내지 제4 출력값을 도출한다. 여기 서, 제1 내지 제4 출력값은 관심영역 기준의 바운딩 박스의 중심점 좌표값(x,y) 및 바운딩 박스의 너비와 높이 값(w,h)이다. 여기서. 객체위치 식별모델은 입력으로 주어진 입력 이미지에 객체가 포함되어 있을 확률 (p)을 제5 출력값으로 추가로 도출할 수 있다. 그리고, 인공지능 신경망을 통해 출력값을 도출하기 위해서는 먼저 학습과정이 필요하다. 여기서, 레이블로서 사용되는 데이터 또한 위치 속성별 출력값과 동일한 종류의 위치 속성별 제1 내지 제5 레이 블값( )으로 표현되며, 바운딩 정보에 해당하는 제1 내지 제4 레이블값( )은 하기 수학식 1을 통 해 산출될 수 있다. 수학식 1"}
{"patent_id": "10-2022-0179231", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "여기서, h,w 는 기존에 라벨링한 객체의 바운딩 박스 높이와 너비이고, H,W 는 기 지정한 객체 위치 식별 모델 의 입력 사이즈이며, 는 기존에 라벨링한 객체의 바운딩 박스를 확장시킨 관심영역을 객체 위미 식별 모델의 입력 사이즈에 맞도록 리사이징 했을때의 바운딩 박스의 중심 x,y 좌표와, 높이 및 너비이고, a,b,c,d는 학습 데이터 제작용 확장 상수이다. 즉, 도2(B)에서 x, y, w, h는 빨간 박스 (기존 객체의 라벨링 박스)에 해당하는 값이고, 는 파란 박스 (관심영역)를 객체 위치 식별 모델의 입력 사이즈에 맞게 리사이징 했을 때 변형된 파란박스 안의 변형된 빨간 박스의 중심 x,y 좌표와 높이 및, 너비에 해당하는 값이다. 또한, 객체위치 식별모델은 각 위치 속성별 출력값과 기 설정된 레이블 데이터간의 유사도를 기반으로, 객 체 위치 식별 모델을 학습할 수 있다. 이때, 객체위치 식별모델 출력값과 기 설정된 레이블 데이터간 유사도는 CIOU loss 함수를 이용하여 산출될 수 있다. 객체위치 식별모델 출력값과 레이블 데이터간 유사도(LCIOU)는 하기 수학식 2를 통해 산출될 수 있다. 수학식 2"}
{"patent_id": "10-2022-0179231", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "또한, 객체위치 식별모델은 레이블 데이터에 객체가 존재하지 않는 상황에서는 LCIOU 값이 의미가 없으므로, 객체위치 식별모델의 학습시 의도되지 않는 LCIOU 값에 의한 역전파가 발생하지 않도록 수학식3과 같 이 객체가 포함 되어 있을 확률(p)을 반영하여 최종적으로 학습 데이터 결정 여부를 판단할 수 있다. 수학식 3"}
{"patent_id": "10-2022-0179231", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "여기서, β와 γ 는 기 설정된 상수값이다. 또한, 본 발명에서는 관심 영역 내 목표 객체의 존재 유무에 대한 보다 정확한 추론을 위해 영상 프레임에 목표 객체가 없는 경우에도 임의로 관심영역을 설정하고, 해당 부분에 대한 입력 이미지를 생성하여 객체위치 식별모 델의 학습 데이터로 제공할 수 있다. 객체 움직임 추적부는 현재 분석할 영상 프레임의 목표객체 위치정보를 획득하고, 이 목표객체 위치정보와 바운딩 박스 크기정보 및 확장 상수정보를 입력 이미지 생성부와 객체위치 식별모델로 제공한다. 이 때, 초기 영상 프레임의 목표객체 위치정보는 사전에 생성한 데이터베이스에서 해당 목표객체의 위치정보를 제 공받거나, 사전에 학습한 프레임 이미지 전체를 입력으로 받는 객체 탐지 모델을 이용하여 획득할 수 있다. 또한, 객체 움직임 추적부는 객체위치 식별모델로부터 제공되는 바운딩 박스정보를 현재 영상 프레 임에 반영하여 객체 위치를 획득하고, 연속되는 영상 프레임에서의 객체 움직임을 추적한다. 이때, 객체 움직임 추적부는 하기 수학식4를 이용하여 관심 영역에 대한 객체 위치 식별 모델 결과값 (x',y')을 프레임 이미지 전체에 대한 바운딩 박스의 중심점 좌표(x1,y1)로 변환하여 해당 전체 영상 프레임에서 의 객체 위치를 판단한다.수학식 4"}
{"patent_id": "10-2022-0179231", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 5, "content": "여기서, x',y' 는 객체위치 식별모델을 통해 획득된 리사이징 된 현재 시점 관심 영역에서의 바운딩 박스 중심 점 좌표이고, w',h' 는 객체위치 식별모델을 통해 획득된 리사이징 된 현재 시점 관심 영역에서의 바운딩 박스 의 너비와 높이, x1,y1 은 현재 시점의 영상 프레임 전체 이미지에 대한 바운딩 박스 중심점 좌표, x0, y0 는 이 전 시점의 영상 프레임 전체 이미지에 대한 바운딩 박스 중심점 좌표, H,W 는 기 지정한 객체 위치 식별 모델의 입력 사이즈, w0, h0 는 이전 시점의 영상 프레임 전체 이미지에 대한 바운딩 박스의 너비와 높이, w1, h1 는 현 재 시점의 영상 프레임 전체 이미지에 대한 바운딩 박스의 너비와 높이, α는 객체 위치 추적을 위한 관심 영역 설정용 확장 상수로서, 확장 비율이다. 즉, 바운딩 박스를 확장 상수 α에 대응되게 동일 비율로 확장하여 관심 영역이 설정되는 것이다. 또한, 객체 움직임 추적부는 객체위치 식별모델로부터 제공되는 결과값 중 객체 존재 확률(p)값이 기 설정된 기준 확률값 미만으로, 해당 관심 영역내에 객체가 존재하지 않는 것으로 판단되면, 해당 영상 프레임을 객체 탐지 모델로 제공하여 해당 영상 프레임에서의 목표 객체의 존재 유무 및 위치정보를 획득할 수 있다. 객체 탐지모델은 인공지능 신경망을 이용하여 수행된 학습결과에 기초하여 영상 프레임 전체 이미지를 입 력받아 해당 영상 프레임내에 존재하는 객체 존재 여부 및 객체 위치정보를 출력한다. 즉, 객체 움직임 추적부는 객체 탐지모델로부터 제공되는 객체정보를 근거로 목표 객체에 대한 위치 정보를 획득할 수 있다. 이어, 상기한 구성으로 된 인공지능 기반 단일 객체 움직임 추적 시스템의 동작을 도3에 도시된 흐름도를 참조 하여 설명한다. 먼저, 객체위치 식별모델과 객체 탐지모델이 인공지능 신경망을 이용하여 미리 학습되어, 객체위치 식별모델은 기 설정된 크기의 입력 이미지에 대응되는 바운딩 박스 정보를 출력하고, 객체 탐지모델 은 영상 프레임 전체 이미지에 존재하는 객체 종류 및 객체 위치정보를 출력한다. 또한, 객체 움직임 추적부에는 관심영역 설정을 위한 확장 상수와, 바운딩 박스 크기정보 및 리사이징 크 기 정보가 미리 제공되고, 객체 움직임 추적부는 확장 상수와 바운딩 박스 크기정보를 입력 이미지 생성부 로 제공한다. 이때, 바운딩 박스 크기는 객체 위치 식별모델 또는 객체 탐지모델을 통해 그 크기가 미리 결정되고, 확장 상수는 상,하, 좌, 우에 대한 각 상수이거나, 일정 비율 정보가 될 수 있다. 상기한 상태에서, 객체 움직임 추적 시스템은 움직임 분석을 위한 목표객체가 포함된 초기 영상 프레임에 대해 해당 초기 영상 프레임에서 목표 객체를 포함하는 바운딩 박스를 도출한다(ST100). 상기 ST100 단계에서 객체 움직임 추적 시스템은 초기 단계에서 데이터베이스에 기 등록된 목표 객체 위치정보 를 제공받거나, 해당 영상 프레임 전체를 입력으로 받는 객체 탐지 모델을 이용하여 해당 목표 객체 위치정보를 획득할 수 있다. 상기 ST100 단계와 같이, 초기 바운딩 박스 및 이전 영상 프레임에서 바운딩 박스가 정상적으로 도출된 상태에 서, 새로운 영상 프레임이 입력되면(ST200), 객체 움직임 추적 시스템은 현재 영상 프레임에 이전 영상 프레임에서 결정된 바운딩 박스를 기 설정된 확장 상수를 이용하여 확장시켜 관심영역을 결정한다(ST300). 즉, 객체 움직임 추적 시스템은 다음 시점(T=t1)의 프레임이 입력되었을 때, 관심영역을 결정하기 위하여 이전 시점인 t0에서 결정한 바운딩 박스를 참고한다. 이때, 사전에 결정한 확장 상수α를 근거로 기존 바운딩 박스와 중심점은 동일하지만 높이와 너비가 α배 증가시킨 새로운 바운딩 박스를 생성하여 이를 관심영역으로 설정할 수 있다. 여기서, 객체가 움직이는 속도에 비례하여 확장 상수 α를 설정하는 것이 바람직하다. 도4에는 t0 시점 에서의 바운딩 박스(B1)과, t1 시점에서의 객체 위치 식별을 위한 관심영역(R) 및, t1 시점에서의 바운딩 박스 (B2)가 표현되어 있다. 이어, 객체 움직임 추적 시스템은 현재 영상 프레임에서 해당 관심영역을 추출하고, 추출된 관심영역을 기 설정 된 크기로 리사이징하여 객체위치 식별모델로 제공할 입력 이미지를 생성한다(ST400). 그리고, 상기 ST400 단계에서 생성된 입력 이미지를 객체위치 식별모델로 입력하여 현재 영상 프레임에서 바운딩 박스 위치를 결정하는 출력값 즉, 바운딩 박스의 중심점 좌표와, 바운딩 박스의 크기를 획득한다 (ST500). 즉, 도4의 t1 시점의 바운딩 박스(B2)에 대한 정보를 획득할 수 있다. 이어, 객체 움직임 추적 시스템은 객체위치 식별모델을 통해 획득된 관심영역 기준의 바운딩 박스 출력값 을 상기 수학식 4에 적용하여 영상 프레임 전체에서의 바운드 박스 위치정보로 변환하고, 이를 이용하여 현재 영상 프레임에서의 목표객체 위치를 결정한다(ST600). 즉, 객체 움직임 추적 시스템은 각 영상 프레임에서의 목표객체 위치에 해당하는 바운딩 박스 위치를 근거로 목 표 객체의 움직임을 추적한다. 이후, 객체 움직임 추적 시스템은 해당 목표 객체에 대한 새로운 영상 프레임이 수신될 때마다 해당 영상 프레 임에 대해 상술한 ST300 내지 ST600 의 과정을 반복적으로 수행한다. 한편, 본 발명에서 객체 움직임 추적 시스템은 이전 영상 프레임에서 바운딩 박스가 정상적으로 도출되지 않은 경우, 현재 영상 프레임을 객체 탐지 모델의 입력으로 제공하여 현재 영상 프레임에 위치하는 목표 객체를 탐색 하고, 탐색된 목표 객체 중심점을 바운딩 박스 중심점으로 설정하여 해당 영상 프레임에 대한 바운딩 박스를 결 정할 수 있다. 또한, 본 발명에서 객체위치 식별모델은 입력 이미지에서 객체 존재 확률값을 추가적으로 제공하는 바, 객 체 움직임 추적 시스템은 상기 ST500 단계에서 객체위치 식별모델을 통해 객체 존재 확률이 기 설정된 기 준 확률값 미만인 경우, 현재 영상 프레임을 객체 탐지 모델의 입력으로 제공하여 현재 영상 프레임에 위치하는 목표 객체를 탐색하고, 탐색된 목표 객체 중심점을 바운딩 박스 중심점으로 설정하여 해당 영상 프레임에 대한 바운딩 박스를 결정할 수 있다. 즉, 도5를 참조하면, 객체 움직임 추적 시스템은 상기 ST500 단계에서 객체 위치 식별모델을 통해 객체 존 재 확률값이 기준 확률값 미만인지를 판단하고(ST510), 기준 확률값 미만인 경우, 현재 영상 프레임(TN 시점)을 객체 탐지 모델의 입력으로 제공하여 객체 존재 유무와 위치정보를 획득한다(ST520). 여기서, 객체 탐지 모델을 통해 출력되는 객체 존재 유무 정보는 객체 존재 확률값으로, 객체 움직임 추적 시스 템은 객체 존재 확률값이 기준 확률값 이상인 경우(ST530), 상기 ST520 단계에서 도출된 위치 정보를 근거로 다 음 시점(TN+1 시점)에 입력되는 영상 프레임을 위한 관심 영역을 설정한다(ST540), 즉, ST540 단계에서 설정한 관심영역을 다음 시점(TN+1 시점)의 영상 프레임에 대한 관심영역으로 설정하여 객체 위치 식별 모델로 제공할 입력 이미지를 생성한다. 한편, 객체 움직임 추적 시스템은 상기 ST 530 단계에서 객체 탐지 모델을 통해 출력되는 객체 존재 확률값이 기준 확률값 미만인 경우에는 다음 시점(TN+1 시점)의 영상 프레임을 다시 객체 탐지 모델의 입력으로 제공하여 객체 존재 유무와 위치정보를 획득하는 ST520 이하의 동작을 반복적으로 수행한다(ST550)."}
{"patent_id": "10-2022-0179231", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 6, "content": "부호의 설명100 : 입력 이미지 생성부, 200 : 객체위치 식별모델, 300 : 객체 움직임 추적부, 400 : 객체 탐지모델, B : 바운딩 박스, R : 관심영역(ROI)."}
{"patent_id": "10-2022-0179231", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도1은 본 발명의 제1 실시예에 따른 인공지능 기반 단일 객체 움직임 추적 시스템의 개략적인 구성을 도시한 도 면. 도2는 도1에 도시된 입력 이미지 생성부에서 입력 이미지를 생성하는 과정을 설명하기 위한 도면. 도3은 도1에 도시된 인공지능 기반 단일 객체 움직임 추적 시스템의 동작을 설명하기 위한 흐름도. 도4는 도3에서 관심영역을 결정하는 과정(ST300)을 예시한 도면. 도5는 도3의 ST500 단계에서 관심영역 내에 객체 존재 확률이 낮은 경우의 인공지능 기반 단일 객체 움직임 추 적 시스템의 동작을 설명하기 위한 흐름도."}
