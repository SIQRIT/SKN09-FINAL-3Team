{"patent_id": "10-2022-0071393", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2023-0171160", "출원번호": "10-2022-0071393", "발명의 명칭": "의료 영상의 품질을 조절하기 위한 방법 및 장치", "출원인": "주식회사 온택트헬스", "발명자": "이지나"}}
{"patent_id": "10-2022-0071393", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "의료 영상의 품질을 조절하기 위한 방법에 있어서,인공지능 모델의 입력으로서 입력 영상을 획득하는 단계;상기 입력 영상에서 특징 맵들을 추출하는 단계;상기 특징 맵들에 대하여, 채널에 따른 스퀴즈 동작(squeeze operation) 및 공간적 자극 동작(excitationoperation)을 수행함으로써 압축 및 재교정된(compressed and re-calibrated) 특징 맵들을 생성하는 단계; 및상기 압축 및 재교정된 특징 맵들에 기반하여, 품질 조절된 출력 영상을 생성하는 단계를 포함하는 방법."}
{"patent_id": "10-2022-0071393", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "청구항 1에 있어서,상기 인공지능 모델에 대하여 적어도 하나의 드랍아웃 패턴을 적용하는 단계를 더 포함하는 방법."}
{"patent_id": "10-2022-0071393", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "청구항 2에 있어서,상기 적어도 하나의 드랍아웃 패턴은, 상기 인공지능 모델의 훈련 중 에포크(epoch) 별로 다르게 적용된 드랍아웃 패턴들과 독립적으로 선택되는 방법."}
{"patent_id": "10-2022-0071393", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "청구항 3에 있어서, 상기 성능은, 상기 훈련 중 생성된 출력 영상에 대한 라디오믹스(radiomics), 최대신호대잡음비(Peak Signal-to-noise, PSNR), 구조적 유사도(Structural Similarity index method, SSIM) 중 적어도 하나에 기반하여 평가되는 방법."}
{"patent_id": "10-2022-0071393", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "청구항 1에 있어서,상기 인공지능 모델은, 상기 출력 영상을 생성하는 생성자(generator) 네트워크 및, 상기 생성자 네트워크에 의해 생성된 모조(fake) 영상 및 실제(real) 영상을 구분하는 판별자(discriminator) 네트워크를 포함하는 방법."}
{"patent_id": "10-2022-0071393", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "청구항 5에 있어서,상기 생성자 네트워크 및 상기 판별자 네트워크는, 판별자 손실(discriminator loss) 및 생성자 손실(generatorloss)을 최소화하도록 훈련되며,상기 판별자 손실은, 와씨스타인 거리(Wasserstein distance)에 기반하여 정의되고,공개특허 10-2023-0171160-3-상기 생성자 손실은, 적대적 손실(adversarial loss) 및 유사도 손실(similarity loss)에 기반하여 정의되는방법."}
{"patent_id": "10-2022-0071393", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "청구항 6항에 있어서,상기 적대적 손실은, 상기 생성자 네트워크에 의해 생성된 모조 영상에서 추출된 패치(patch)들에 기반하여 결정되고,상기 유사도 손실은, 상기 생성자 네트워크에 의해 생성된 모조 영상의 전체에 기반하여 결정되는 방법."}
{"patent_id": "10-2022-0071393", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "청구항 1항에 있어서,상기 입력 영상은, 저선량(low-dose) CT(computer tomography) 영상을 포함하고,상기 출력 영상은, 가상의 표준선량(standard-dose) 또는 고선량(high-dose) CT 영상을 포함하는 방법."}
{"patent_id": "10-2022-0071393", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "의료 영상의 품질을 조절하기 위한 장치에 있어서,상기 장치의 동작을 위한 명령어 집합을 저장하는 저장부; 및상기 저장부와 연결된 적어도 하나의 프로세서를 포함하며,상기 적어도 하나의 프로세서는, 인공지능 모델의 입력으로서 입력 영상을 획득하고,상기 입력 영상에서 특징 맵들을 추출하고,상기 특징 맵들에 대하여, 채널에 따른 스퀴즈 동작(squeeze operation) 및 공간적 자극 동작(excitationoperation)을 수행함으로써 압축 및 재교정된(compressed and re-calibrated) 특징 맵들을 생성하고,상기 압축 및 재교정된 특징 맵들에 기반하여, 품질 조절된 출력 영상을 생성하도록 제어하는 장치."}
{"patent_id": "10-2022-0071393", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "프로세서에 의해 동작되면 제1항 내지 제8항 중의 어느 한 항에 따른 방법을 실행하기 위해 컴퓨터 판독 가능한매체에 저장된 프로그램."}
{"patent_id": "10-2022-0071393", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "의료 영상의 품질을 조절하기 위한 것으로, 조절 방법은, 인공지능 모델의 입력으로서 입력 영상을 획득하는 단 계, 상기 입력 영상에서 특징 맵들을 추출하는 단계, 상기 특징 맵들에 대하여, 채널에 따른 스퀴즈 동작 (squeeze operation) 및 공간적 자극 동작(excitation operation)을 수행함으로써 압축 및 재교정된(compressed and re-calibrated) 특징 맵들을 생성하는 단계, 및 상기 압축 및 재교정된 특징 맵들에 기반하여, 품질 조절된 출력 영상을 생성하는 단계를 포함할 수 있다."}
{"patent_id": "10-2022-0071393", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 의료 영상에 대한 것으로, 특히, 의료 영상의 품질을 조절하기 위한 방법 및 장치에 대한 것이다."}
{"patent_id": "10-2022-0071393", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "질병은 인간의 심신에 장애를 일으켜서 정상적인 기능을 저해하는 상태를 의미하는 것으로, 질병에 따라 인간은 고통을 받고 심지어 생을 유지하지 못할 수 있다. 따라서, 질병을 진단하고, 치료하고 나아가 예방하기 위한 다 양한 사회적 시스템 및 기술들이 인류의 역사와 함께 발전해왔다. 질병의 진단 및 치료에 있어서, 기술의 눈부 신 발전에 따라 다양한 도구들 및 방식들이 개발되어 왔지만, 아직까지, 종국적으로는 의사의 판단에 의존하고있는 현실이다. 한편, 최근 인공지능(artificial intelligence, AI) 기술이 크게 발전하면서 다양한 분야에서 주목되고 있다. 특히, 방대한 양의 누적된 의료 데이터와, 영상 위주의 진단 데이터 등의 환경으로 인해, 의료 분야에 인공지능 알고리즘을 접목하려는 다양한 시도와 연구가 진행 중이다. 구체적으로, 질병을 진단, 예측하는 등 종래의 임상 적 판단에 머물러 있던 작업들을 인공지능 알고리즘을 이용하여 해결하려는 다양한 연구가 이루어지고 있다. 또 한, 진단 등을 위한 중간 과정으로서 의료 데이터를 처리하고 분석하는 작업을 인공지능 알고리즘을 이용하여 해결하려는 다양한 연구가 이루어지고 있다. 선행기술문헌 미국공개특허 US 2021/0312242 미국공개특허 US 2018/0293712"}
{"patent_id": "10-2022-0071393", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은 인공지능(artificial intelligence, AI) 알고리즘을 이용하여 의료 영상의 품질을 효과적으로 조절하 기 위한 방법 및 장치를 제공하기 위한 것이다. 본 발명은 의료 영상에서 잡음을 제거하기 위한 방법 및 장치를 제공하기 위한 것이다. 본 발명은 저선량(low-dose) CT(computer tomography) 영상에 기반하여 표준선량(standard-dose) 또는 고선량 (high-dose) CT 영상을 생성하기 위한 방법 및 장치를 제공하기 위한 것이다. 본 발명에서 이루고자 하는 기술적 과제들은 이상에서 언급한 기술적 과제들로 제한되지 않으며, 언급하지 않은"}
{"patent_id": "10-2022-0071393", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 2, "content": "또 다른 기술적 과제들은 아래의 기재로부터 본 발명이 속하는 기술분야에서 통상의 지식을 가진 자에게 명확하 게 이해될 수 있을 것이다."}
{"patent_id": "10-2022-0071393", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명의 일 실시 예에 따른, 의료 영상의 품질을 조절하기 위한 방법은, 인공지능 모델의 입력으로서 입력 영 상을 획득하는 단계, 상기 입력 영상에서 특징 맵들을 추출하는 단계, 상기 특징 맵들에 대하여, 채널에 따른 스퀴즈 동작(squeeze operation) 및 공간적 자극 동작(excitation operation)을 수행함으로써 압축 및 재교정 된(compressed and re-calibrated) 특징 맵들을 생성하는 단계, 및 상기 압축 및 재교정된 특징 맵들에 기반하 여, 품질 조절된 출력 영상을 생성하는 단계를 포함할 수 있다. 본 발명의 일 실시 예에 따르면, 상기 방법은, 상기 인공지능 모델에 대하여 적어도 하나의 드랍아웃 패턴을 적 용하는 단계를 더 포함할 수 있다. 본 발명의 일 실시 예에 따르면, 상기 적어도 하나의 드랍아웃 패턴은, 상기 인공지능 모델의 훈련 중 에포크 (epoch) 별로 다르게 적용된 드랍아웃 패턴들과 독립적으로 선택될 수 있다. 본 발명의 일 실시 예에 따르면, 상기 성능은, 상기 훈련 중 생성된 출력 영상에 대한 라디오믹스(radiomics), 최대신호대잡음비(Peak Signal-to-noise, PSNR), 구조적 유사도(Structural Similarity index method, SSIM) 중 적어도 하나에 기반하여 평가될 수 있다. 본 발명의 일 실시 예에 따르면, 상기 인공지능 모델은, 상기 출력 영상을 생성하는 생성자(generator) 네트워 크 및, 상기 생성자 네트워크에 의해 생성된 모조(fake) 영상 및 실제(real) 영상을 구분하는 판별자 (discriminator) 네트워크를 포함할 수 있다. 본 발명의 일 실시 예에 따르면, 상기 생성자 네트워크 및 상기 판별자 네트워크는, 판별자 손실(discriminator loss) 및 생성자 손실(generator loss)을 최소화하도록 훈련되며, 상기 판별자 손실은, 와씨스타인 거리 (Wasserstein distance)에 기반하여 정의되고, 상기 생성자 손실은, 적대적 손실(adversarial loss) 및 유사도 손실(similarity loss)에 기반하여 정의될 수 있다. 본 발명의 일 실시 예에 따르면, 상기 적대적 손실은, 상기 생성자 네트워크에 의해 생성된 모조 영상에서 추출 된 패치(patch)들에 기반하여 결정되고, 상기 유사도 손실은, 상기 생성자 네트워크에 의해 생성된 모조 영상의전체에 기반하여 결정될 수 있다. 본 발명의 일 실시 예에 따르면, 상기 입력 영상은, 저선량(low-dose) CT(computer tomography) 영상을 포함하 고, 상기 출력 영상은, 가상의 표준선량(standard-dose) 또는 고선량(high-dose) CT 영상을 포함할 수 있다. 본 발명의 일 실시 예에 따른, 의료 영상의 품질을 조절하기 위한 장치는, 상기 장치의 동작을 위한 명령어 집 합을 저장하는 저장부, 및 상기 저장부와 연결된 적어도 하나의 프로세서를 포함하며, 상기 적어도 하나의 프로 세서는, 인공지능 모델의 입력으로서 입력 영상을 획득하고, 상기 입력 영상에서 특징 맵들을 추출하고, 상기 특징 맵들에 대하여, 채널에 따른 스퀴즈 동작(squeeze operation) 및 공간적 자극 동작(excitation operation)을 수행함으로써 압축 및 재교정된(compressed and re-calibrated) 특징 맵들을 생성하고, 상기 압 축 및 재교정된 특징 맵들에 기반하여, 품질 조절된 출력 영상을 생성하도록 제어할 수 있다. 본 발명의 일 실시 예에 따른, 컴퓨터 판독 가능한 매체에 저장된 프로그램은, 프로세서에 의해 동작되면 전술 한 방법을 실행할 수 있다."}
{"patent_id": "10-2022-0071393", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 2, "content": "본 발명에 대하여 위에서 간략하게 요약된 특징들은 후술하는 본 발명의 상세한 설명의 예시적인 양상일 뿐이며, 본 발명의 범위를 제한하는 것은 아니다."}
{"patent_id": "10-2022-0071393", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명에 따르면, 인공지능 모델의 훈련을 위한 의료 영상이 보다 효과적으로 생성될 수 있다. 본 발명에서 얻을 수 있는 효과는 이상에서 언급한 효과들로 제한되지 않으며, 언급하지 않은 또 다른 효과들은"}
{"patent_id": "10-2022-0071393", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 2, "content": "아래의 기재로부터 본 발명이 속하는 기술분야에서 통상의 지식을 가진 자에게 명확하게 이해될 수 있을 것이다."}
{"patent_id": "10-2022-0071393", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하에서는 첨부한 도면을 참고로 하여 본 발명의 실시 예에 대하여 본 발명이 속하는 기술 분야에서 통상의 지 식을 가진 자가 용이하게 실시할 수 있도록 상세히 설명한다. 그러나, 본 발명은 여러 가지 상이한 형태로 구현 될 수 있으며 여기에서 설명하는 실시 예에 한정되지 않는다. 본 발명의 실시 예를 설명함에 있어서 공지 구성 또는 기능에 대한 구체적인 설명이 본 발명의 요지를 흐릴 수 있다고 판단되는 경우에는 그에 대한 상세한 설명은 생략한다. 그리고, 도면에서 본 발명에 대한 설명과 관계없 는 부분은 생략하였으며, 유사한 부분에 대해서는 유사한 도면 부호를 붙였다. 본 발명은 의료 영상의 품질을 조절하기 위한 것이다. 구체적으로, 본 발명은 GAN(generative adversarial network) 기반 인공지능 모델을 이용하여 주어진 의료 영상의 품질을 조절하는 기술에 관한 것으로, 인공지능 모델의 구조 및 운용에 대한 다양한 실시 예들을 설명한다.도 1은 본 발명의 일 실시 예에 따른 시스템을 도시한다. 도 1을 참고하면, 시스템은 서비스 서버, 데이터 서버, 적어도 하나의 클라이언트 장치를 포함 한다. 서비스 서버는 인공지능 모델 기반의 서비스를 제공한다. 즉, 서비스 서버는 인공지능 모델을 이용하 여 학습 및 예측 동작을 수행한다. 서비스 서버는 네트워크를 통해 데이터 서버 또는 적어도 하나의 클라이언트 장치와 통신을 수행할 수 있다. 예를 들어, 서비스 서버는 데이터 서버로부터 인공 지능 모델을 훈련하기 위한 학습 데이터를 수신하고, 훈련을 수행할 수 있다. 서비스 서버는 적어도 하나 의 클라이언트 장치로부터 학습 및 예측(prediction) 동작에 필요한 데이터를 수신할 수 있다. 또한, 서비 스 서버는 적어도 하나의 클라이언트 장치에게 예측 결과에 대한 정보를 송신할 수 있다. 데이터 서버는 서비스 서버에 저장된 인공지능 모델의 훈련을 위한 학습 데이터를 제공한다. 다양한 실시 예들에 따라, 데이터 서버는 누구나 접근 가능한 공공 데이터를 제공하거나 또는 허가를 필요로 하는 데이터를 제공할 수 있다. 필요에 따라, 학습 데이터는 데이터 서버에 의해 또는 서비스 서버에 의해 전처리할 수 있다. 다른 실시 예에 따라, 데이터 서버는 생략될 수 있다. 이 경우, 서비스 서버는 외 부에서 훈련된 인공지능 모델을 사용하거나 또는 서비스 서버에 오프라인으로 학습 데이터가 제공될 수 있 다. 적어도 하나의 클라이언트 장치는 서비스 서버에 의해 운용되는 인공지능 모델에 관련된 데이터를 서 비스 서버와 송신 및 수신한다. 적어도 하나의 클라이언트 장치는 사용자에 의해 사용되는 장비이며, 사용자에 의해 입력되는 정보를 서비스 서버에게 송신하고, 서비스 서버로부터 수신되는 정보를 저장 하거나 사용자에게 제공(예: 표시)할 수 있다. 경우에 따라, 어느 하나의 클라이언트로부터 송신된 데이터에 기 반하여 예측 동작이 수행되고, 예측의 결과에 관련된 정보가 다른 클라이언트에게 제공될 수 있다. 적어도 하나 의 클라이언트 장치는 데스크탑 컴퓨터, 랩탑 컴퓨터, 스마트폰, 타블렛, 웨어러블 기기 등 다양한 형태의 컴퓨팅 장치일 수 있다. 도 1에 도시되지 아니하였으나, 시스템은 서비스 서버를 관리하기 위한 관리 장치를 더 포함할 수 있다. 관리 장치는 서비스를 관리하는 주체에 의해 사용되는 장치로서, 서비스 서버의 상태를 모니터링하거나, 서비스 서버의 설정을 제어한다. 관리 장치는 네트워크를 통해 서비스 서버에 접속하거나 또는 케이 블 연결을 통해 직접 연결될 수 있다. 관리 장치의 제어에 따라, 서비스 서버는 동작을 위한 파라미터를 설정할 수 있다. 도 1을 참고하여 설명한 바와 같이, 서비스 서버, 데이터 서버, 적어도 하나의 클라이언트 장치 , 관리 장치 등이 네트워크를 통해 연결되고, 상호작용할 수 있다. 여기서, 네트워크는 유선 네트워크 및 무선 네트워크 중 적어도 하나를 포함할 수 있고, 셀룰러 네트워크, 근거리 네트워크, 광역 네트워크 중 어느 하나 또는 둘 이상의 조합으로 이루어질 수 있다. 예를 들어, 네트워크는 LAN(local area network), WLAN(wireless LAN), 블루투스(bluetooth), LTE(long term evolution), LTE-A(LTE-advanced), 5G(5th generation) 중 적어도 하나에 기반하여 구현될 수 있다. 도 2는 본 발명의 일 실시 예에 따른 질병 발생 가능성을 예측하는 장치의 구조를 도시한다. 도 2에 예시된 구 조는 도 1의 서비스 서버, 데이터 서버, 적어도 하나의 클라이언트 장치의 구조로 이해될 수 있 다. 도 2를 참고하면, 장치는, 통신부, 저장부, 제어부를 포함한다. 통신부는 네트워크에 접속하고, 다른 장치와 통신을 수행하기 위한 기능을 수행한다. 통신부는 유선 통신 및 무선 통신 중 적어도 하나를 지원할 수 있다. 통신을 위해, 통신부는 RF(radio frequency) 처리 회로, 디지털 데이터 처리 회로 중 적어도 하나를 포함할 수 있다. 경우에 따라, 통신부는 케이블을 연결 하기 위한 단자를 포함하는 구성요소로 이해될 수 있다. 통신부는 데이터, 신호를 송신 및 수신하기 위한 구성요소이므로, '송수신부(transceiver)'라 지칭될 수 있다. 저장부는 장치의 동작을 위해 필요한 데이터, 프로그램, 마이크로 코드, 명령어 집합, 어플리케이션 등을 저장한다. 저장부는 일시적 또는 비일시적 저장 매체로 구현될 수 있다. 또한, 저장부는 장치에 고정 되어 있거나, 또는 분리 가능한 형태로 구현될 수 있다. 예를 들어, 저장부는 콤팩트 플래시(compactflash, CF) 카드, SD(secure digital) 카드, 메모리 스틱(memory stick), 솔리드 스테이트 드라이브(solid- state drive; SSD) 및 마이크로(micro) SD 카드 등과 같은 낸드 플래시 메모리(NAND flash memory), 하드 디스 크 드라이브(hard disk drive; HDD) 등과 같은 마그네틱 컴퓨터 기억 장치 중 적어도 하나로 구현될 수 있다. 제어부는 장치의 전반적인 동작을 제어한다. 이를 위해, 제어부는 적어도 하나의 프로세서, 적어도 하나의 마이크로 프로세서 등을 포함할 수 있다. 제어부는 저장부에 저장된 프로그램을 실행하고, 통 신부를 통해 네트워크에 접속할 수 있다. 특히, 제어부는 후술하는 다양한 실시 예들에 따른 알고리 즘들을 수행하고, 후술하는 실시 예들에 따라 장치가 동작하도록 제어할 수 있다. 도 1 및 도 2를 참고하여 설명한 구조에 기반하여, 본 발명의 다양한 실시 예들에 따른 인공지능 알고리즘 기반 의 서비스가 제공될 수 있다. 여기서, 인공지능 알고리즘을 구현하기 위해 인공 신경망으로 이루어진 인공지능 모델이 사용될 수 있다. 인공 신경망의 구성 단위인 퍼셉트론(perceptron) 및 인공 신경망의 개념은 다음과 같 다. 퍼셉트론은 생물의 신경 세포를 모델링한 것으로서, 다수의 신호들을 입력으로 삼아 하나의 신호를 출력하는 구 조를 가진다. 도 3은 본 발명에 적용 가능한 인공지능 모델을 구성하는 퍼셉트론의 예를 도시한다. 도 3을 참고 하면, 퍼셉트론은 입력 값들(예: x1, x2, x3, …, xn) 각각 대하여 가중치들(302-1 내지 302-n)(예: w1j, w2j, w3j, …, wnj)을 곱한 후, 가중치 곱해진(weighted) 입력 값들을 변환 함수(transfer function)을 이용하여 합산한다. 합산 과정에서, 바이어스(bias) 값(예: bk)이 더해질 수 있다. 퍼셉트론은 변환 함수의 출력인 네트(net) 입력 값(예: netj)에 대하여 활성 함수(activation function)을 적용함으로써, 출력 값(예: o j)를 생성한다. 경우에 따라, 활성 함수은 임계치(예: θj)에 기반하여 동작할 수 있다. 활성 함수는 다양 하게 정의될 수 있다. 본 발명이 이에 제한되는 것은 아니나, 예를 들어, 활성 함수로서, 스텝 함수(step function), 시그모이드(sigmoid), Relu, Tanh 등이 사용될 수 있다. 도 3와 같은 퍼셉트론들이 나열되고, 레이어를 이룸으로써 인공 신경망이 설계될 수 있다. 도 4는 본 발명에 적 용 가능한 인공지능 모델을 구성하는 인공 신경망의 예를 도시한다. 도 4에서, 원으로 표현된 각 노드는 도 3의 퍼셉트론으로 이해될 수 있다. 도 4를 참고하면, 인공 신경망은 입력 레이어(input layer), 복수의 은닉 레이어(hidden layer)들(404a, 404b), 출력 레이어(output layer)를 포함한다. 예측을 수행하는 경우, 입력 레이어의 각 노드로 입력 데이터가 제공되면, 입력 데이터는 입력 레이어 , 은닉 레이어들(404a, 404b)을 이루는 퍼셉트론들에 의한 가중치 적용, 변환 함수 연산 및 활성 함수 연 산 등을 거쳐 출력 레이어까지 순전파(forward propagation)된다. 반대로, 훈련을 수행하는 경우, 출력 레 이어로부터 입력 레이어를 향한 역전파(backward propagation)를 통해 오차가 계산되고, 계산된 오차 에 따라 각 퍼셉트론에 정의된 가중치 값들이 갱신될 수 있다. GAN(generative adversarial network)은 적대적(adversarial) 학습을 수행하도록 설계된 인공지능 네트워크로 서, 생성자(generator) 및 판별자(discriminator)가 경쟁적으로 학습하며 모두 발전하는 방식으로 훈련이 진행 된다. 즉, 생성자는 판별자의 분류 성공 확률을 낮추고자 노력하고, 판별자는 분류 성공 확률을 높이고자 노력 하면서, 서로를 경쟁적으로 발전시킨다. GAN의 구조는 이하 도 5와 같다. 도 5는 본 발명에 적용 가능한 GAN의 예를 도시한다. 도 5는 샘플(예: 영상)을 분류하는 GAN의 구조를 예시한다. 도 5를 참고하면, GAN은 생성자 및 판별자를 포함한다. 생성자 및 판별자 각각 은 인공 신경망을 포함하며, 생성자는 모조(fake) 샘플을 생성하고, 판별자는 모조 샘플을 진짜 (real) 샘플과 구분한다. 구체적으로, 생성자는 랜덤 입력(random input)에 기반하여 합성 샘플 (synthetic sample)을 생성한다. 예를 들어, 랜덤 입력은 잠재 벡터(latent vector)를 포함할 수 있다. 판별자 는 실제 샘플(real sample)을 이용하여 사전에 훈련된 상태로서, 실제 샘플 및 합성 샘플을 구분할 수 있 도록 더 훈련된다. 이를 위해, 판별자는 실제 샘플 및 합성 샘플을 학습 데이터로서 이용하고, 적어도 하나의 손실(loss) 값, 예를 들어, 판별자 손실 및 생성자 손실을 출력한다. 판별자 손실은 실제 샘플을 합성 샘플로 오분류 (misclassify)한 경우 또는 합성 샘플을 실제 샘플로 오분류한 경우에 대한 정보를 포함하며, 판별자에게패널티로 작용한다. 판별자 손실을 이용하여 역전파가 수행되면, 판별자 내의 인공 신경망의 가중치들이 갱신된다. 생성자는 판별자로부터의 피드백(예: 생성자 손실)에 기반하여 훈련된다. 훈련을 통해, 생 성자는 실제 샘플과 더 유사한 합성 샘플을 생성하도록 발전할 수 있다. 생성자 손실은 판별자가 오 류 없이 분류한 경우에 대한 정보를 포함하며, 생성자에게 패널티로 작용한다. 생성자 손실을 이용하여 역 전파가 수행되면, 생성자 내의 인공 신경망의 가중치들이 갱신된다. 전술한 GAN의 구조는 다양한 실시 예들에 따른 의료 영상 조절을 위한 인공지능 모델에 적용될 수 있다. 이하, 의료 영상의 일 예로서, CT(computer tomography) 영상에 대한 품질 조절의 실시 예들이 설명된다. 그러나, 본 발명의 다양한 실시 예들은 CT 영상은 물론 엑스레이(X-ray), 초음파, MRI(magnetic resonance imaging), PET(positron emission tomography), SPET(single photon emission computed tomography) 등 다양한 형태의 의료 영상들에도 적용될 수 있다. CT는 병 진단을 위한 신뢰할 수 있는 영상 검사들 중 하나이다. CT 영상의 품질은 전압 및 전류와 같은 스캔 요 소에 따라 달라진다. 엑스레이 선량(X-ray dose)는 화질과 직결된다. 고선량(high-dose)는 고화질 영상을 얻게 하지만, DNA 손상과 세포 기형을 일으켜 질병이나 종양을 유발할 수 있다. 반면에 저선량은 환자에게 조사되는 선량을 감소시킬 수 있지만, 잡음이나 인공물(artifacts)에 의한 영상 품질의 저하를 야기할 수 있다. 이때, 재 구성 알고리즘은 저선량 파라미터에 의해 획득된 CT 영상의 품질을 향상킬 수 있다. 최근, 딥러닝은 컴퓨터 비 전(vision) 및 의료 영상 처리 분야에서 유망한 성능을 보여주고 있다. 비지도 학습인 GAN(generative adversarial networks)은 CT 잡음 제거 연구에서 우수한 성능을 보여준다. 예를 들어, WGAN(Wasserstein GAN) 은 와씨스타인 거리(Wasserstein distance)를 기반으로 하는 개선된 GAN 프레임워크로서, 기존 GAN보다 더 높은 훈련 안정성을 보여준다. 그러나 GAN 기반 후처리(post-processing) 알고리즘을 임상에 적용(clinical adoption)하는 것은 여전히 한계를 가진다. 전술한 문제를 해결하기 위해, 본 발명은 불확실성 추정을 포함하는 새로운 CT 영상 잡음 제거 모델을 제안한다. 다양한 실시 예들에 따른 인공지능 모델은 잔차 밀집 블록(residual dense block)과 스킵 연결(skip connection)을 통해 성능을 향상시켰다. 동시에, 다양한 실시 예들에 따른 인공지능 모델은, 단순한 정보 전달 이 아닌 본질적으로 중요한 데이터를 전달하기 위해, 어탠션(attention) 모듈을 사용한다. 또한, 보다 안정적인 잡음 제거 성능을 만들기 위해, 다양한 실시 예들에 따른 인공지능 모델은 베이지안 근사(Bayesian approximation)를 사용하여 모델 불확실성을 측정한다. 저선량 CT(low-does CT, LDCT) 및 대응하는 표준선량 CT(standard-dose CT, SDCT) 간 관계는 이하 [수학식 1] 과 같이 표현될 수 있다. 수학식 1"}
{"patent_id": "10-2022-0071393", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "[수학식 1]에서, y는 표준선량 CT, x는 저선량 CT, T()는 변환 행렬(translation function)을 의미한다. 일반적으로 CT 영상의 잡음 분포는 푸아송(Poission) 양자 잡음과 가우스 전자 잡음의 복잡한 합성에 의해 모델 링될 수 있다. 잡음들 사이의 관계 T를 정확하게 정의할 수 없기 때문에, 기존의 기존 잡음 제거 기술은 CT 잡 음 제거에서 우수한 성능을 달성할 수 없었다. 네트워크는 역(inverse) 문제를 해결하여 영상을 생성하도록 훈 련된다. 역-변환 함수는 이하 [수학식 2]와 같이 표현될 수 있다. 수학식 2"}
{"patent_id": "10-2022-0071393", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "[수학식 2]에서, T-1()는 변환 함수의 역함수, y는 표준선량 CT, 는 역-변환 함수에 의해 생성된 저선량 CT, x는 저선량 CT를 의미한다. 네트워크는 비선형 함수를 통해 고차원 기능을 효율적으로 학습한다. 결과적으로 x에 가까운 잡음 제거 영상이 생성될 수 있다. GAN 기반의 인공지능 모델을 완전-컨볼루션(fully convolutional) 구조로 설계하면, 인공지능 모델 내의 커널 (kernel)들은 임의의 크기의 영상을 이용하여 훈련될 수 있다. 이 경우, 생성자 네트워크 내의 컨볼루션 커널들 을 랜덤하게 샘플링된 로컬 패치(local patch)들을 이용하여 훈련될 수 있다. 그러나, 본 발명의 실시 예들에 따른 인공지능 모델의 컨볼루션 커널들은, 원본 크기의 출력 영상을 생성할 수 있도록, 원본(original) 크기(예: 512×512)의 영상을 이용하여 훈련될 수 있다. 이를 통해, 표준선량 CT 및 모조(fake) 표준선량 CT 간 인지적인 차이가, 로컬하게(locally) 샘플링된 차원이 아닌, 원본 차원에서 측정될 수 있다. 한편, 판별자 네트 워크는, 표준선량 CT 및 모조(fake) 표준선량 CT의 로컬 텍스쳐를 구분할 수 있도록, 랜덤하게 샘플링된 로컬 패치들을 이용하여 훈련될 수 있다. 다양한 실시 예들에 따른 인공지능 모델의 구조에 대한 구체적인 예는 이하 도 6과 같다. 도 6은 본 발명의 일 실시 예에 따른 인공지능 모델의 구조의 일 예를 도시한다. 이하 도 6을 참고한 설명은 인 공지능 모델을 구성하는 블록/모듈/계층의 크기를 구체적인 예시하고 있으나, 이하 예시되는 크기는 구체적인 실시 예에 따라 변형될 수 있다. 생성자 네트워크는 원본 크기(예: 512×512)의 저선량 CT를 입력으로 취하고, 동일 크기의 모조 표준선량 CT를 생산한다. 컨볼루션 계층은 입력되는 저선량 CT 영상들을 리키(leaky) ReLU 활성화를 가지는 3×3 컨 볼루션 커널들을 통해 32개의 특징 맵들로 인코딩한다. 인코딩된 특징 맵들은 DRBD(dense residual block with dropout) 블록으로 제공된다. DRBD 블록은 3개의 연속적인 컨볼루션 계층들(613-1 내지 613-3)을 포함하고, 잔 차 연산(residual operation)에 의해 연결된다. 또한, DRBD 블록은 3개의 컨볼루션 계층들(613-1 내지 613- 3)의 연산 결과를 처리하는 추가 컨볼루션 계층(613-4) 및 sSE(squeeze and spatial excitation) 모듈을 포함한다. 구체적으로, 컨볼루션 계층(613-1)의 출력 및 컨볼루션 계층의 출력은 합산기(617a)에 의해 합산된 후, 컨 볼루션 계층(613-2)에 입력된다. 컨볼루션 계층(613-1)의 출력, 컨볼루션 계층(613-2)의 출력 및 컨볼루션 계층 의 출력은 합산기(617b)에 의해 합산된 후, 컨볼루션 계층(613-3)에 입력된다. 컨볼루션 계층(613-1)의 출 력, 컨볼루션 계층(613-2)의 출력, 컨볼루션 계층(613-3)의 출력 및 컨볼루션 계층의 출력은 합산기(617 c)에 의해 합산된 후, 컨볼루션 계층(613-4)에 입력된다. 컨볼루션 계층들(613-1 내지 613-4) 각각은 리키 (leaky) ReLU 활성화를 가질 수 있다. 예를 들어, 리키 ReLU 활성화 함수는 0.3의 음의 경사도(negative slope) 계수를 가질 수 있다. sSE(squeeze and spatial excitation) 모듈은 특징 맵들을 압축 및 재교정(compressing and re- calibrating)함으로써 특징 맵들의 이용을 강화할 수 있다. 구체적으로, sSE 모듈은 특징 맵에 대한 전체"}
{"patent_id": "10-2022-0071393", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "정보를 요약하는 스퀴즈 동작(squeeze operation) 및 각 특징 맵의 중요성(importance)을 스케일링하는 자극 동 작(excitation operation)을 수행한다. 이때, sSE 모듈은 채널을 따라(along a channel) 스퀴즈 동작을 수행하고, 공간적으로 자극 동작을 수행함으로써, 픽셀-별 공간 정보를 효과적으로 사용하게 한다. 구체적으로, sSE 모듈은 모든 채널을 아우르는 하나의 특징 맵을 추출하고, 추출된 특징 맵을 각 채널에 적용한다. 즉, sSE 모듈는 추출된 특징 맵을 각 채널의 특징 맵에 곱한다. 여기서, sSE 모듈에 입력되는 특징 맵들 은 H×W×C의 3차원 구조를 가지며, 추출된 특징 맵은 H×W×1의 2차원 구조를 가지며, sSE 모듈에서 출력 되는 결과물은 다시 H×W×C의 3차원 구조를 가질 수 있다. 여기서, C는 채널 개수를 의미한다. 또한, sSE 모듈 은 스퀴징된(sequeezed) 정보를 획득하기 위해 시그모이드(sigmoid) 활성화를 가지는 1×1 컨볼루션 계층 에서 입력을 처리하고, 스퀴징된 정보 및 원본 입력을 곱함으로써 3차원적으로, 즉, 공간적으로 재교정된 특징 맵을 획득할 수 있다. 도 6에서, sSE 모듈의 출력 및 컨볼루션 계층(613-4)의 출력이 곱셈기에 의해 곱해지는 것으로 표현 되어 있으나, 전술한 sSE 모듈의 동작은 곱셈기에 의한 곱셈 동작을 포함한다. 따라서, 도 6의 곱셈 기는 sSE 모듈에 포함되는 것으로 이해되거나, 또는 전술한 동작 중 곱셈 동작은 sSE 모듈의 동 작에서 제외되는 것으로 이해될 수 있다. 드랍아웃 계층은 설정된 비율로 드랍아웃 동작을 수행한다. 드랍아웃 계층으로의 입력은 sSE 모듈 의 출력(예: 곱셉기의 출력) 및 컨볼루션 모듈의 출력이 합산기(617d)에 의해 합산된 결과이다.드랍아웃 계층은 특정 뉴런, 즉, 노드들을 일정 확률로 훈련에서 제외함으로써, 인공지능 모델들의 노드들 간 균형있는 훈련을 유도하고, 오버피팅(overfitting)을 방지할 수 있다. 다시 말해, 드랍아웃 계층은 훈 련 시 적어도 하나의 노드를 제외하고, 나머지 노드들을 이용하여 순방향/역방향 전파(forward/backward propagation)를 수행할 수 있다. 드랍아웃에 의해 특정한 적어도 하나의 노드가 훈련에서 제외될 수 있으며, 드 랍아웃 동작에 의해 제외되는 패턴(이하 '드랍아웃 패턴')은 에포크(epoch) 별로 다르게 조절될 수 있다. 여기 서, 노드를 제외함은 노드를 오프(off)함으로 표현될 수 있다. 일 실시 예에 따라, 각 노드에 적용되는 제외 확 률은 고정된 값으로 정의되거나, 훈련 상황에 따라 적응적으로 조절될 수 있다. 예를 들어, 제외 확률은 0.5로 설정될 수 있다. 제외 확률의 결정, 드랍아웃 패턴의 제어 등은 별도의 제어 모듈(예: 도 2의 제어부)에 의해 수행될 수 있다. 마지막 컨볼루션 계층을 제외한 컨볼루션 계층들, 즉, 컨볼루션 계층들(612, 613-1 내지 613-4)은 3×3 컨 볼루션 커널들을 포함한다. 컨볼루션 커널들의 가중치 및 바이어스는 He 정규 초기화(normal initialization)에 의해 초기화될 수 있다. 마지막 컨볼루션 계층에 포함되는 컨볼루션 커널은, 빠른 학습이 가능하도록, 9× 9 크기를 가질 수 있다. 마지막 컨볼루션 계층은 드랍아웃 계층에서 출력된 특징 맵들을 원하는 채널 에 부합하는 형태로 가공한다. 예를 들어, DRBD 블록에서 출력되는 특징 맵들의 형태는 [batch size, 512, 512, 16]이고, 특징 맵들은 마지막 컨볼루션 계층에 의해 최종 출력 형태인 [batch size, 512, 512, 1]의 크기 로 가공될 수 있다. 다시 말해, 최종 출력은 하나의 채널을 가지는 이미지로서, 마지막 컨볼루션 계층은 앞선 특징 맵들을 재정렬 및 압축함으로써 최종 출력물을 생성한다. 특징 맵의 차원을 보존하기 위해, 모든 컨 볼루션 계층들(612, 613-1 내지 613-4, 616)에 제로 패딩이 적용될 수 있다. 판별자 네트워크는 표준선량 CT 및 모조 표준선량 CT로부터의 로컬 패치들을 구분하도록 훈련된다. 예를 들어, 주어진 크기(예: 64×64)의 로컬 패치들이 설정된 횟수(예: 5번)만큼 표준선량 CT에서 랜덤하게 샘플링되 고, 모조 표준선량 CT의 대응하는 위치에서 로컬 패치들이 샘플링될 수 있다. 판별자 네트워크는 4개의 컨 볼루션 블록들(622-1 내지 622-4)을 포함하고, 하나의 컨볼루션 계층을 포함한다. 컨볼루션 블록들(622-1 내지 622-4) 각각에서, 첫번째 계층은 1-스트라이드(stride)를 이용하는 3×3 컨볼루션 커널들을 포함하고, 두 번째 계층은 2-스트라이드들을 이용하는 3×3 컨볼루션 커널들을 포함한다. 여기서, 스트라이드는 몇개의 픽셀 을 스킵하면서 영상을 처리하는지를 의미한다. 2개의 컨볼루션 계층들, 즉, 첫번째 계층 및 두번째 계층은 제로 -패딩(zero-padding)을 포함하지 아니하고, ReLU를 이용하여 활성화된다. 컨볼루션 특징 맵들의 개수는 다음 컨 볼루션 블록을 통과할 때 두배가 된다. 마지막 컨볼루션 계층은 하나의 스트라이드를 가지는 4×4 컨볼루 션 커널을 포함한다. 컨볼루션 계층의 출력은 단일 확률 값을 포함할 수 있다. 도 7은 본 발명의 일 실시 예에 따라 의료 영상의 품질을 조절하는 절차의 예를 도시한다. 도 7은 연산 능력을 가진 장치(예: 도 1의 서비스 서버)의 동작 방법을 예시한다. 도 7을 참고하면, S701 단계에서, 장치는 입력 영상을 획득한다. 입력 영상은 상대적으로 저품질을 가지는 영상 이다. 예를 들어, 입력 영상은 저선량 CT 영상일 수 있다. 입력 영상은 의료 영상 촬영 장비로부터 촬영과 함께 실시간으로 제공되거나 또는 의료 영상을 저장한 데이터베이스로부터 제공될 수 있다. S703 단계에서, 장치는 입력 영상에서 특징 맵들을 추출한다. 특징 맵들을 추출하기 위해, 장치는 인공지능 모 델에 포함된 적어도 하나의 컨볼루션 계층들을 이용할 수 있다. 장치는 복수의 채널들에 대응하는 특징 맵들을 추출할 수 있으며, 각 특징 맵은 2차원 구조를 가질 수 있다. S705 단계에서, 장치는 채널에 따른 스퀴즈 동작 및 공간적인 자극 동작을 수행한다. 즉, 장치는, 추출된 특징 맵들로부터 주요 정보를 추출하고, 추출된 정보를 공간적으로 재조정한다. 즉, 장치는 추출된 특징 맵들의 정보"}
{"patent_id": "10-2022-0071393", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 5, "content": "를 요약하고, 요약된 정보를 스케일링한다. 구체적으로, 장치는 모든 특징 맵들에 대응하는 요약을 위한 필터를 생성하고, 필터를 특징 맵들에 곱할 수 있다. 여기서, 필터는 또 다른 하나의 특징 맵으로 이해될 수 있다. 이 에 따라, 장치는 압축 및 재교정된(compressed and re-calibrated) 특징 맵들을 생성할 수 있다."}
{"patent_id": "10-2022-0071393", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 6, "content": "S707 단계에서, 장치는 조절된 품질을 가지는 출력 영상을 생성한다. 장치는 요약 및 스케일링된 특징 맵들, 다 시 말해, 압축 및 재교정된(compressed and re-calibrated) 특징 맵들에 기반하여 조절된 품질을 가지는 영상을 생성할 수 있다. 조절된 품질은 향상된 또는 개선된 품질을 포함할 수 있다. 여기서, 개선된 품질은 S701 단계 에서 획득된 영상에 비교하여 높은 품질을 가짐을 의미한다. 예를 들어, 개선된 품질을 가지는 영상은 입력 영 상에 비하여 선명하거나, 더 많은 특징 정보를 포함하거나, 또는 더 큰 해상도를 가질 수 있다.도 7을 참고하여 설명한 절차를 통해, 입력 영상의 품질이 개선될 수 있다. 도 7에 도시되지 아니하였으나, 일 실시 예에 따라, 장치는 드랍아웃 패턴을 적용할 수 있다. 여기서, 드랍아웃을 수행하는 경우, 미리 설정된 확 률에 따라 각 에포크(epoch)에서 제거되는 노드들에 대하여, 다른 노드들에 의존하지 아니한 채로, 가중치가 갱 신될 수 있다. 드랍아웃에 의해, 인공지능 모델에 포함된 적어도 하나의 노드가 제외된 상태에서 예측 동작이 수행될 수 있다. 이때, 드랍아웃 패턴은 확률에 기반하여 랜덤하게 다양하게 정의될 수 있다. 드랍아웃 패턴을 적용하는 절차는 이하 도 8과 같다. 도 8은 본 발명의 일 실시 예에 따라 인공지능 모델을 훈련 및 운용하는 절차의 예를 도시한다. 도 8은 연산 능 력을 가진 장치(예: 도 1의 서비스 서버)의 동작 방법을 예시한다. 도 8을 참고하면, S801 단계에서, 장치는 에포크 별로 드랍아웃 패턴을 변경하며 훈련을 수행한다. 즉, 훈련 과 정에서, 장치는 랜덤하게 드랍아웃 패턴들 결정 및 적용함으로써 적어도 하나의 노드를 제외하고, 나머지 노드 들을 이용하여 순방향/역방향 전파를 수행한다. 이때, 장치는 순방향 전파의 결과에 기반하여 생성자 손실 및 판별자 손실을 산출하고, 생성자 손실 및 판별자 손실을 최소화하도록 생성자 네트워크 및 판별자 네트워크의 가중치들을 갱신함으로써, 역방향 전파를 수행할 수 있다. 이 경우, 적어도 하나의 노드를 제외한 나머지 노드 들에 관련된 가중치들만이 갱신될 수 있다. 여기서, 드랍아웃 패턴은 에포크 단위로 변경된다. 드랍아웃을 수행 함에 따라, 미리 설정된 확률에 따라 각 에포크에서 제거되는 노드들에 대하여, 다른 노드들에 의존하지 아니한 채로, 가중치가 갱신될 수 있다. S803 단계에서, 장치는 에포크 별 성능 평가를 수행한다. 장치는 성능 평가를 위해 선택된 학습 데이터를 이용 하여, 에포크 별로 인공지능 모델의 성능을 평가할 수 있다. 성능 평가는 다양한 방식으로 수행될 수 있다. 일 실시 예에 따라, 성능 평가는 라디오믹스(radiomics)에 기반하여 수행될 수 있다. 구체적으로, 장치는 생성자에 의해 생성된 모조 영상 및 레이블에 해당하는 영상 각각에서 패치들을 추출하고, 추출된 패치들 각각에 대한 라 디오믹스 특징들을 생성한다. 예를 들어, 라디오믹스 특징들은 GLCM(gray-level co-occurrence matrix), GLRLM(gray-level run length matrix), GLSZM(gray-level size zone matrix), GLDM(gray-level dependence matrix), NGTDM(neighboring gray tone difference matrix) 또는 이들의 변형된 정보를 포함할 수 있다. 장치 는 생성된 라디오믹스 특징들에 기반하여 비교 지표(예: 일치 상관 계수(concordance correlation coefficient, CCC))를 결정하고, 결정된 비교 지표에 기반하여 성능을 평가할 수 있다. 예를 들어, 비교 지표가 임계치보다 크면, 충분한 성능을 가진 것으로 평가될 수 있다. 즉, 비교 지표가 곧 성능으로 해석될 수 있다. S805 단계에서, 장치는 복수의 드랍아웃 패턴들을 적용하여 인공지능 모델을 운용한다. 즉, 장치는 복수의 에포 크들에서 독립적으로 갱신된 가중치를 가진 노드들을 포함하는 인공지능 모델을 이용하며, 확률에 기반하여 결 정되는 복수의 드랍아웃 패턴들을 적용한 복수의 예측 결과들을 생성한 후, 예측 결과들을 결합함으로써 단일한 하나의 예측 결과를 생성할 수 있다. 일 실시 예에 따라, 장치는 복수의 예측 결과들을 평균화함으로써 예측 결 과들을 결합할 수 있다. 다른 실시 예에 따라, 장치는 복수의 예측 결과들을 가중치 평균화함으로써 예측 결과 들을 결합할 수 있다. 도 8을 참고하여, 드랍아웃 패턴에 관련된 실시 예가 설명되었다. 여기서, 드랍아웃 패턴은 복수의 드랍아웃 결 과들의 조합일 수 있다. 예를 들어, 확률 0.5의 드랍아웃 연산에 의해, 인공지능 모델 내의 전체 노드들 중 일 부가 제외됨으로써 노드들의 부분집합A가 선택될 수 있다. 또한, 드랍아웃 연산을 재수행하면, 전체 노드들 중 다른 일부가 제외됨으로써 노드들의 부분집합B가 선택될 수 있다. 드랍아웃 연산 시마다 선택되는 노드들의 부 분집합이 상이할 수 있으며, 복수의 부분집합들을 그룹핑함으로써 하나의 드랍아웃 패턴이 정의될 수 있다. 이 경우, 하나의 드랍아웃 패턴을 적용함은 서로 다른 노드들의 부분집합을 도출한 복수의 드랍아웃 연산들에 따른 영상들을 평균화함으로 이해될 수 있다. 구체적인 예로, 하나의 드랍아웃 패턴은 20회의 드랍아웃된 노드 부분 집합들을 포함할 수 있다. 전술한 인공지능 모델의 훈련 과정에서, 목표 함수들(objective functions)은 판별자 손실(discriminator loss) 및 생성자 손실(generator loss)을 최소화하는 것으로 정의될 수 있다. 여기서, 판별자 손실 및 생성자 손실은 다음과 같이 정의될 수 있다. 먼저, 판별자 손실은 이하 [수학식 3]과 같이 정의될 수 있다. 수학식 3"}
{"patent_id": "10-2022-0071393", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 7, "content": "[수학식 3]에서, LD는 판별자 손실, E[]는 기대 값(expected value) 연산자, D(x)는 판별자의 출력, G(x)는 생 성자의 출력, 는 입력 영상 및 생성자의 출력 간 직선(straight line) 상에서 랜덤하게 샘플링된 2D 가우시 안 점(gaussian point), 는 의 경사도, 는 판별자에 의해 판별된 에 대한 결과 값을 의미한다. 여기서, 전단의 2개 항(term)들은 와씨스타인 거리를 이용한 판별자 손실들이고, 마지막 항은 경사도 패널티 (gradient penalty)를 의미한다. 이때, 생성자를 위한 적대적(adversarial) 손실은 이하 [수학식 4]와 같이 정의될 수 있다. 수학식 4"}
{"patent_id": "10-2022-0071393", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 8, "content": "[수학식 4]에서, Ladv는 적대적 손실, E[]는 기대 값(expected value) 연산자, D(x)는 판별자의 출력, G(x)는 생성자의 출력을 의미한다. 일 실시 예에 따라, 분석의 유연성을 위한 다중-스케일 구조적 유사성(multi-scale structural similarity, MS-SSIM)이 유사도 손실(similarity loss)로서 사용될 수 있다. MS-SSIM은 이하 [수학식 5]와 같이 정의될 수 있다. 수학식 5"}
{"patent_id": "10-2022-0071393", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 9, "content": "[수학식 5]에서, SSIM(x,y)는 영상 x 및 영상 y에 대한 구조적 유사도, C1 및 C2는 상수, μx는 영상 x에 대한 표준 편차(standard deviation), μy는 영상 y에 대한 표준 편차, σx는 영상 x에 대한 상호 공분산(cross- covariance), σy는 영상 x에 대한 상호 공분산, σxy는 영상 x 및 영상 y에 대한 상호 공분산, xj는 영상 x에 대한 j번째 레벨에서의 로컬 이미지 컨텐츠, yj는 영상 y에 대한 j번째 레벨에서의 로컬 이미지 컨텐츠, M은 스 케일 레벨을 의미한다. 위와 같은 MS-SSIM에 근거하여, 유사도 손실은 이하 [수학식 6]과 같이 정의될 수 있다. 수학식 6"}
{"patent_id": "10-2022-0071393", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 10, "content": "[수학식 6]에서, Lsimilarity은 유사도 손실, MS_SSIM(x,y)는 영상 x 및 영상 y에 대한 MS-SSIM을 의미한다. 일 실시 예에 따른 생성자 손실은 전술한 적대적 손실 및 유사도 손실에 기반하여 정의될 수 있다. 예를 들어, 이하 [수학식 7]과 같이, 생성자 손실은 적대적 손실 및 유사도 손실의 합으로 정의될 수 있다. 수학식 7"}
{"patent_id": "10-2022-0071393", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 11, "content": "[수학식 7]에서, LG는 생성자 손실, Ladv는 적대적 손실, Lsimilarity은 유사도 손실, α는 유사도 손실에 대한 가중 치를 의미한다. [수학식 7]과 같이, 적대적 손실 및 유사도 손실이 동일 가중치 또는 서로 다른 가중치로 결합 될 수 있다. 도 9는 본 발명의 일 실시 예에 따른 인공지능 모델을 훈련하기 위한 손실 값들의 예를 도시한다. 도 9는 유사 도 손실 및 적대적 손실의 관계를 도시한다. 도 9를 참고하면, 저품질 영상가 생성자로 입력되고, 생 성자는 모조 고품질 영상을 생성한다. 그리고, 레이블에 해당하는 실제 고품질 영상이 제공된다. 여기서, 모조 고품질 영상 및 실제 고품질 영상에 기반하여, 유사도 손실(Lsimilarity)이 결 정될 수 있다. 모조 고품질 영상 및 실제 고품질 영상 각각에서 랜덤하게 복수의 패치들(954, 956)이 추출된다. 추출된 복수의 패치들(954, 956)은 판별자에 입력되고, 판별자에 의한 판별 결과로부터 적 대석 손실(Ladv)이 결정될 수 있다. 즉, 적대적 손실(Ladv)은 생성된 모조 고품질 영상에서 추출된 패치들 및 실제 고품질 영상의 패치들에 기반하여 결정되고, 유사도 손실(Lsimilarity)은 모조 고품질 영 상 및 실제 고품질 영상의 전체에 기반하여 결정될 수 있다. 본 발명의 예시적인 방법들은 설명의 명확성을 위해서 동작의 시리즈로 표현되어 있지만, 이는 단계가 수행되는 순서를 제한하기 위한 것은 아니며, 필요한 경우에는 각각의 단계가 동시에 또는 상이한 순서로 수행될 수도 있 다. 본 발명에 따른 방법을 구현하기 위해서, 예시하는 단계에 추가적으로 다른 단계를 포함하거나, 일부의 단 계를 제외하고 나머지 단계를 포함하거나, 또는 일부의 단계를 제외하고 추가적인 다른 단계를 포함할 수도 있 다. 본 발명의 다양한 실시 예는 모든 가능한 조합을 나열한 것이 아니고 본 발명의 대표적인 양상을 설명하기 위한 것이며, 다양한 실시 예에서 설명하는 사항들은 독립적으로 적용되거나 또는 둘 이상의 조합으로 적용될 수도 있다. 또한, 본 발명의 다양한 실시 예는 하드웨어, 펌웨어(firmware), 소프트웨어, 또는 그들의 결합 등에 의해 구현 될 수 있다. 하드웨어에 의한 구현의 경우, 하나 또는 그 이상의 ASICs(Application Specific Integrated Circuits), DSPs(Digital Signal Processors), DSPDs(Digital Signal Processing Devices), PLDs(Programmable Logic Devices), FPGAs(Field Programmable Gate Arrays), 범용 프로세서(general processor), 컨트롤러, 마이크로 컨트롤러, 마이크로 프로세서 등에 의해 구현될 수 있다. 본 발명의 범위는 다양한 실시 예의 방법에 따른 동작이 장치 또는 컴퓨터 상에서 실행되도록 하는 소프트웨어 또는 머신-실행가능한 명령들(예를 들어, 운영체제, 애플리케이션, 펌웨어(firmware), 프로그램 등), 및 이러한 소프트웨어 또는 명령 등이 저장되어 장치 또는 컴퓨터 상에서 실행 가능한 비-일시적 컴퓨터-판독가능 매체 (non-transitory computer-readable medium)를 포함한다. 도면 도면1 도면2 도면3 도면4 도면5 도면6 도면7 도면8 도면9"}
{"patent_id": "10-2022-0071393", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 일 실시 예에 따른 시스템을 도시한다. 도 2는 본 발명의 일 실시 예에 따른 질병 발생 가능성을 예측하는 장치의 구조를 도시한다. 도 3은 본 발명에 적용 가능한 인공지능 모델을 구성하는 퍼셉트론(perceptron)의 예를 도시한다. 도 4는 본 발명에 적용 가능한 인공지능 모델을 구성하는 인공 신경망의 예를 도시한다. 도 5는 본 발명에 적용 가능한 GAN(generative adversarial network)의 예를 도시한다. 도 6은 본 발명의 일 실시 예에 따른 인공지능 모델의 구조의 일 예를 도시한다. 도 7은 본 발명의 일 실시 예에 따라 의료 영상의 품질을 조절하는 절차의 예를 도시한다. 도 8은 본 발명의 일 실시 예에 따라 인공지능 모델을 훈련 및 운용하는 절차의 예를 도시한다. 도 9는 본 발명의 일 실시 예에 따른 인공지능 모델을 훈련하기 위한 손실 값들의 예를 도시한다."}
