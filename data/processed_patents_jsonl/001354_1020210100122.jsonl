{"patent_id": "10-2021-0100122", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2023-0018209", "출원번호": "10-2021-0100122", "발명의 명칭": "GAN을 이용하여 피부암 이미지 데이터를 생성하는 방법 및 그를 이용한 장치", "출원인": "주식회사 씨앤에이아이", "발명자": "이원섭"}}
{"patent_id": "10-2021-0100122", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "피부암 병변 이미지를 생성하는 방법에 있어서,Pix2Pix 모델이 적용된 생성적 적대 네트워크(GAN: Generative Adversarial Network)가 생성 모델 및 판별 모델을 포함하는 상태에서, (a) 컴퓨팅 장치가, 피부암 관련 입력 이미지를 attention 모듈이 포함된 상기 생성 모델에 통과시켜 페이크 병변 이미지를 획득하고, 상기 페이크 병변 이미지 및 리얼 병변 이미지를 상기 판별 모델에 통과시키면서 획득한손실함수의 결과 값을 기초로 상기 생성 모델 및 상기 판별 모델을 학습시키는 단계; 및(b) 상기 컴퓨팅 장치는, 상기 학습된 생성 모델을 이용하여 피부암 관련 복수의 가상 이미지를 생성하는 단계;를 포함하는 방법."}
{"patent_id": "10-2021-0100122", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 (a) 단계에서,상기 입력 이미지는 가로 길이 w, 세로 길이 h를 가지는 이미지로 구성된 채널을 복수 개 포함하며,상기 복수의 채널은 RGB 채널을 포함하는 제1 채널 그룹, 병변 여부를 나타내는 채널을 포함하는 제2 채널그룹, 피부암의 종류를 나타내는 채널을 포함하는 제3 채널 그룹으로 이루어지는 것을 특징으로 하는 방법."}
{"patent_id": "10-2021-0100122", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제2항에 있어서,상기 피부암의 종류가 n개로 구분되고, 상기 제3 채널 그룹에는 n개의 채널이 포함되며, 상기 피부암이 특정 종류의 피부암에 해당하는 상태에서,상기 특정 종류의 피부암에 해당하는 특정 채널에 포함된 픽셀 값들은 모두 1로 설정되고, 상기 특정 채널을 제외한 n-1개의 채널에 포함된 픽셀 값들은 모두 0으로 설정되는 것을 특징으로 하는 방법."}
{"patent_id": "10-2021-0100122", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제1항에 있어서,상기 생성 모델이 인코딩부 및 디코딩부로 구분되고, 상기 인코딩부에 적어도 제1 콘볼루션 레이어, 제2 콘볼루션 레이어를 포함하는 복수의 콘볼루션 레이어가 포함된 상태에서,상기 제1 콘볼루션 레이어 및 상기 제2 콘볼루션 레이어 사이에 상기 attention 모듈이 추가되는 것을 특징으로하는 방법."}
{"patent_id": "10-2021-0100122", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제4항에 있어서,서로 다른 1x1 2D 콘볼루션 연산을 포함하는 제1 함수, 제2 함수 및 제3 함수가 상기 attention 모듈에 포함된상태에서,상기 제1 콘볼루션 레이어의 연산 결과 값인 제1 피쳐 맵을 입력 데이터로 하는 상기 attention 모듈은 i) 상기제1 함수 및 상기 제2 함수의 연산 결과 값에 softmax 함수를 통과시켜 attention map을 생성시키고, ii) 상기attention map과 상기 제3 함수의 연산을 진행하여 상기 제1 피쳐 맵과 사이즈가 동일한 제2 피쳐 맵을 생성시키는 것을 특징으로 하는 방법.공개특허 10-2023-0018209-3-청구항 6 제1항에 있어서,상기 (a) 단계에서,복수의 페이크 병변 이미지 및 복수의 리얼 병변 이미지가 상기 판별 모델의 입력 데이터에 해당하고, 상기 판별 모델의 상기 손실함수에 n개의 이미지가 반복적으로 입력되는 상태에서,상기 복수의 페이크 병변 이미지 중 n/2개의 페이크 병변 이미지와 상기 복수의 리얼 병변 이미지 중 n/2개의리얼 병변 이미지가 동일 회차로 상기 손실함수에 입력되는 것을 특징으로 하는 방법."}
{"patent_id": "10-2021-0100122", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제1항에 있어서,상기 (a) 단계에서,상기 컴퓨팅 장치는 상기 생성 모델의 파라미터를 업데이트할 경우 상기 판별 모델의 파라미터를 고정시키고,상기 판별 모델의 파라미터를 업데이트할 경우 상기 생성 모델의 파라미터를 고정시키는 것을 특징으로 하는 방법."}
{"patent_id": "10-2021-0100122", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "피부암 병변 이미지를 생성하는 장치에 있어서,Pix2Pix 모델이 적용된 생성적 적대 네트워크(GAN: Generative Adversarial Network)가 생성 모델 및 판별 모델을 포함하는 상태에서, 통신부; 및피부암 관련 입력 이미지를 attention 모듈이 포함된 상기 생성 모델에 통과시켜 페이크 병변 이미지를 획득하고, 상기 페이크 병변 이미지 및 리얼 병변 이미지를 상기 판별 모델에 통과시키면서 획득한 손실함수의 결과값을 기초로 상기 생성 모델 및 상기 판별 모델을 학습시키고, 상기 학습된 생성 모델을 이용하여 피부암 관련복수의 가상 이미지를 생성하는 프로세서;를 포함하는 컴퓨팅 장치."}
{"patent_id": "10-2021-0100122", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명에 따르면, 피부암 병변 이미지를 생성하는 방법에 있어서, Pix2Pix 모델이 적용된 생성적 적대 네트워크 (GAN: Generative Adversarial Network)가 생성 모델 및 판별 모델을 포함하는 상태에서, 컴퓨팅 장치가, 피부 암 관련 입력 이미지를 attention 모듈이 포함된 상기 생성 모델에 통과시켜 페이크 병변 이미지를 획득하고, 상 기 페이크 병변 이미지 및 리얼 병변 이미지를 상기 판별 모델에 통과시키면서 획득한 손실함수의 결과 값을 기 초로 상기 생성 모델 및 상기 판별 모델을 학습시키는 단계; 및 상기 컴퓨팅 장치는, 상기 학습된 생성 모델을 이용하여 피부암 관련 복수의 가상 이미지를 생성하는 단계를 포함하는 방법을 제시한다."}
{"patent_id": "10-2021-0100122", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 GAN을 이용하여 피부암 이미지 데이터를 생성하는 방법에 있어서, Pix2Pix 모델이 적용된 생성적 적 대 네트워크(GAN: Generative Adversarial Network)가 생성 모델 및 판별 모델을 포함하는 상태에서, 컴퓨팅 장치가, 피부암 관련 입력 이미지를 attention 모듈이 포함된 상기 생성 모델에 통과시켜 페이크 병변 이미지를 획득하고, 상기 페이크 병변 이미지 및 리얼 병변 이미지를 상기 판별 모델에 통과시키면서 획득한 손실함수의 결과 값을 기초로 상기 생성 모델 및 상기 판별 모델을 학습시키는 단계; 및 상기 컴퓨팅 장치는, 상기 학습된 생성 모델을 이용하여 피부암 관련 복수의 가상 이미지를 생성하는 단계를 포함하는 방법에 관한 것이다."}
{"patent_id": "10-2021-0100122", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "의료용 인공지능 모델의 개발을 위해서는 많은 양의 데이터가 필요하다. 다만, 병원 등으로부터 의료용 데이터 를 수집하기 쉽지 않고 무엇보다도 개인정보 유출이라는 문제 때문에 일반적인 데이터보다도 의료용 데이터를 얻기는 매우 어려운 편이다. 이때, 의료용 데이터를 생성하는 기술이 필요한데, 이용될 수 있는 기술이 GAN(Generative Adversarial Network, 생성적 대립 신경망) 알고리즘이다. GAN은 생성자 및 분별자를 순차적으로 반복 학습시키는 대립적 프 로세스를 통해 실제 이미지와 유사한 가상 이미지를 생성할 수 있다. 특히, Attention 모듈 등을 이용하는 경우 더 다채롭고 디테일이 있는 이미지를 생성할 수 있다. 이에 본 발명자는 의료용 이미지 데이터 중에서도 피부암 이미지 데이터를 GAN을 이용하여 생성하는 방법 및 그 를 이용한 장치를 제안하고자 한다."}
{"patent_id": "10-2021-0100122", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은 상술한 문제점을 모두 해결하는 것을 목적으로 한다. 본 발명은 GAN에 포함된 생성 모델에 Attention 모듈을 적용하여 보다 다양한 피부암 이미지 데이터를 생성하는 것을 다른 목적으로 한다. 또한, 본 발명은 GAN에 포함된 판별 모델의 손실 함수를 컨트롤하여 보다 정밀한 피부암 이미지 데이터를 생성 하는 것을 다른 목적으로 한다. 또한, 본 발명은 pix2pix 아키텍쳐를 이용하여 보다 선명하고 자연스러운 이미지를 생성하는 것을 또 다른 목적 으로 한다."}
{"patent_id": "10-2021-0100122", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "상기한 바와 같은 본 발명의 목적을 달성하고, 후술하는 본 발명의 특징적인 효과를 실현하기 위한, 본 발명의 특징적인 구성은 하기와 같다. 본 발명의 일 태양에 따르면, 피부암 병변 이미지를 생성하는 방법에 있어서, Pix2Pix 모델이 적용된 생성적 적 대 네트워크(GAN: Generative Adversarial Network)가 생성 모델 및 판별 모델을 포함하는 상태에서, 컴퓨팅 장치가, 피부암 관련 입력 이미지를 attention 모듈이 포함된 상기 생성 모델에 통과시켜 페이크 병변 이미지를 획득하고, 상기 페이크 병변 이미지 및 리얼 병변 이미지를 상기 판별 모델에 통과시키면서 획득한 손실함수의 결과 값을 기초로 상기 생성 모델 및 상기 판별 모델을 학습시키는 단계; 및 상기 컴퓨팅 장치는, 상기 학습된 생성 모델을 이용하여 피부암 관련 복수의 가상 이미지를 생성하는 단계를 포함하는 방법이 제공된다. 또한, 본 발명의 다른 태양에 따르면, 피부암 병변 이미지를 생성하는 장치에 있어서, Pix2Pix 모델이 적용된 생성적 적대 네트워크(GAN: Generative Adversarial Network)가 생성 모델 및 판별 모델을 포함하는 상태에서, 통신부; 및 피부암 관련 입력 이미지를 attention 모듈이 포함된 상기 생성 모델에 통과시켜 페이크 병변 이미 지를 획득하고, 상기 페이크 병변 이미지 및 리얼 병변 이미지를 상기 판별 모델에 통과시키면서 획득한 손실함 수의 결과 값을 기초로 상기 생성 모델 및 상기 판별 모델을 학습시키고, 상기 학습된 생성 모델을 이용하여 피 부암 관련 복수의 가상 이미지를 생성하는 프로세서를 포함하는 컴퓨팅 장치가 제공된다."}
{"patent_id": "10-2021-0100122", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명에 의하면, 다음과 같은 효과가 있다. 본 발명은 GAN에 포함된 생성 모델에 Attention 모듈을 적용하여 보다 다양한 피부암 이미지 데이터를 생성하는 효과가 있다. 또한, 본 발명은 GAN에 포함된 판별 모델의 손실 함수를 컨트롤하여 보다 정밀한 피부암 이미지 데이터를 생성 하는 효과가 있다. 또한, 본 발명은 pix2pix 아키텍쳐를 이용하여 보다 선명하고 자연스러운 이미지를 생성하는 효과가 있다."}
{"patent_id": "10-2021-0100122", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "후술하는 본 발명에 대한 상세한 설명은, 본 발명이 실시될 수 있는 특정 실시예를 예시로서 도시하는 첨부 도 면을 참조한다. 이들 실시예는 당업자가 본 발명을 실시할 수 있기에 충분하도록 상세히 설명된다. 본 발명의 다양한 실시예는 서로 다르지만 상호 배타적일 필요는 없음이 이해되어야 한다. 예를 들어, 여기에 기재되어 있 는 특정 형상, 구조 및 특성은 일 실시예에 관련하여 본 발명의 정신 및 범위를 벗어나지 않으면서 다른 실시예 로 구현될 수 있다. 또한, 각각의 개시된 실시예 내의 개별 구성요소의 위치 또는 배치는 본 발명의 정신 및 범 위를 벗어나지 않으면서 변경될 수 있음이 이해되어야 한다. 따라서, 후술하는 상세한 설명은 한정적인 의미로 서 취하려는 것이 아니며, 본 발명의 범위는, 적절하게 설명된다면, 그 청구항들이 주장하는 것과 균등한 모든 범위와 더불어 첨부된 청구항에 의해서만 한정된다. 도면에서 유사한 참조부호는 여러 측면에 걸쳐서 동일하거 나 유사한 기능을 지칭한다."}
{"patent_id": "10-2021-0100122", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "이하, 본 발명이 속하는 기술분야에서 통상의 지식을 가진 자가 본 발명을 용이하게 실시할 수 있도록 하기 위 하여, 본 발명의 바람직한 실시예들에 관하여 첨부된 도면을 참조하여 상세히 설명하기로 한다. 본 발명의 컴퓨팅 장치는 생성적 적대 네트워크(GAN: Generative Adversarial Network)를 이용하여 피부암 관 련 복수의 병변 이미지를 생성할 수 있다. 상기 컴퓨팅 장치는 통신부, 프로세서 및 데이터베이스 등을 포함할 수 있다. 컴퓨팅 장치의 통신부는 다양한 통신 기술로 구현될 수 있다. 즉, 와이파이(WIFI), WCDMA(Wideband CDMA), HSDPA(High Speed Downlink Packet Access), HSUPA(High Speed Uplink Packet Access), HSPA(High Speed Packet Access), 모바일 와이맥스(Mobile WiMAX), 와이브로(WiBro), LTE(Long Term Evolution), 블루투스 (bluetooth), 적외선 통신(IrDA, infrared data association), NFC(Near Field Communication), 지그비 (Zigbee), 무선랜 기술 등이 적용될 수 있다. 또한, 인터넷과 연결되어 서비스를 제공하는 경우 인터넷에서 정 보전송을 위한 표준 프로토콜인 TCP/IP를 따를 수 있다. 이하에서는, 컴퓨팅 장치에서 GAN을 이용하는 프로세스에 대해 서술하도록 하겠다. 간략하게는, 컴퓨팅 장치 가 GAN의 생성 모델 및 판별 모델을 먼저 학습시키고, 학습된 생성 모델을 이용하여 피부암 관련 복수의 가 상 이미지를 생성시킬 수 있을 것이다. 도 1은 본 발명의 일 실시예에 따라 GAN의 개략적인 구성을 나타내는 도면이다. 기존의 GAN들은 condition(조건)을 명시하기 위해서 잠재 벡터 z에 one-hot encoding된 라벨을 이어 붙여서 (concatenate) 입력 값을 구성하였다. 그러나, 본 발명에서는 Pix2Pix 모델이 적용된 GAN을 사용하였고 기존 의 one-hot encoding된 라벨을 그대로 활용할 수가 없다. 도 1에서 볼 수 있듯이, 생성 모델에 입력되는 입력 이미지, 판별 모델에 입력되는 페이크 병변 이미지 및 리얼 병변 이미지 등은 모두 이미지(image) 구조를 가질 수 있다. 도 2는 본 발명의 일 실시예에 따라 생성 모델에 입력되는 입력 이미지의 모습을 나타내는 도면이다. 상기 입력 이미지는 피부암 관련 실제 이미지를 나타내며, 다만 조건이 부가된 상태(여러 채널이 추가)에 해당할 수 있다. 이에 대해서는 아래에서 살펴보도록 하겠다. 입력 이미지는 가로 길이 w, 세로 길이 h를 가지는 이미지로 구성된 채널을 복수 개 포함할 수 있다. 일반 적으로 이미지의 구조는 (w, h, 3) 구조에 해당하여, 가로 길이 w, 세로 길이 h, 3개의 채널(R, G, B)을 나타내 나, 본 발명에서는 3개의 채널 외에 병변 여부를 나타내는 이미지에 해당하는 채널(binary mask segmentiation 채널), 피부암의 종류(class information - ex 편평상피세포암, 기저세포암, 악성흑색종, 정상부위 등)를 나타 내는 이미지에 해당하는 채널을 입력 이미지로 포함시킬 수 있다. 도 2에서 볼 수 있듯이, 상기 복수의 채널은 RGB 채널(11, 12, 13)을 포함하는 제1 채널 그룹, 병변 여부를 나 타내는 채널을 포함하는 제2 채널 그룹, 피부암의 종류를 나타내는 채널(15, 16, 17)을 포함하는 제3 채널 그룹을 포함할 수 있다. 상기 채널들(11 내지 17)은 가로 길이 w, 세로 길이 h로 구성되며, channel-wise로 합 쳐져 입력 이미지를 이룰 수 있다. 참고로, 제3 채널 그룹에 포함된 채널들은 피부암의 종류 개수(#)에 따라 달라지므로 상기 입력 이미지의 구조 는 (w, h, 4 + # of class)가 될 수 있다. 도 2의 경우 피부암의 종류를 3개로 예시적으로 구분하였고, 제3 채 널 그룹에 포함된 채널들(15, 16, 17) 역시 3개이므로, 입력 이미지의 구조가 (w, h, 7)이 될 수 있다.상기 제2 채널 그룹에 해당하는 병변 여부를 나타내는 채널은 피부암 관련 병변을 나타내는 영역의 픽셀 값 들을 '1'로 표시하고, 그 외 영역의 픽셀 값들을 '0'으로 표시하여 구분할 수 있다. 따라서, 하나의 피부암 관 련 이미지에서 상기 채널을 통해 어느 영역이 병변 영역인지를 나타낼 수 있는 것이다. 또한, 피부암의 종류가 n개로 구분되고, 상기 제3 채널 그룹에는 n개의 채널이 포함되며, 피부암이 특정 종류의 피부암에 해당한다고 상정할 수 있다. 예를 들어, 피부암의 종류가 3개(ex 편평상피세포암, 기저세포암, 악성흑 색종)이고, 제3 채널 그룹에 해당하는 채널 역시 3개라고 상정할 수 있다. 이때, 특정 종류의 피부암에 해당하는 특정 채널에 포함된 픽셀 값들은 모두 1로 설정되고, 상기 특정 채널을 제외한 n-1 개의 채널에 포함된 픽셀 값들은 모두 0으로 설정될 수 있다. 즉, 입력 이미지가 편평상피세포암에 해당하는 경우, 이에 해당하는 채널에 포함된 픽셀 값들은 모두 '1'로 표시될 수 있다. 나머지(ex 기저세포암, 악성흑색종)에 해당하는 채널(16, 17)에 포함된 픽셀 값들은 모 두 '0'으로 표시될 수 있는 것이다. 다음으로, GAN에는 생성 모델 및 판별 모델 등이 포함되는데, 이 중에서도 생성 모델 관련 프로세스를 살펴보도록 하겠다. 도 3은 본 발명의 일 실시예에 따라 생성 모델의 개략적인 구성을 나타내는 도면이다. 도 4는 본 발명의 일 실시예에 따라 attention 모듈을 개략적으로 나타낸 도면이다. 도 5는 본 발명의 일 실시예에 따라 attention 모듈이 적용되는 이미지의 모습을 나타낸 도면이다. 컴퓨팅 장치는 피부암 관련 입력 이미지를 attention 모듈이 포함된 생성 모델에 통과시켜 페이크 병 변 이미지를 획득할 수 있다. 즉, 생성 모델을 기준으로 입력 값은 상기 피부암 관련 입력 이미지(1 0)에 해당하고, 출력 값은 페이크 병변 이미지에 해당할 수 있다. 학습 단계에서는 상기 생성 모델의 출력 값이 학습을 위해 비교 대상에 해당하는 이미지(페이크 병변 이미 지, 20)에 해당하고, 후술하겠지만 학습이 완료된 이후의 생성 모델의 출력 값은 실질적으로 필요한 피부 암 병변 가상 이미지에 해당할 것이다. 도 3에서 볼 수 있듯이, 생성 모델은 인코딩부와 디코딩부로 구분되고, 상기 인코딩부에는 적어도 제1 콘 볼루션 레이어(convolution layer), 제2 콘볼루션 레이어를 포함하는 복수의 콘볼루션 레이어(conv1, conv2 쪋) 및 연산 결과인 피쳐맵(a, b, c 쪋)이 포함될 수 있다. 또한, 상기 디코딩부에도 복수의 콘볼루션 레이어 및 특성맵이 포함될 수 있는데, 이때 디코딩부에 포함된 콘볼 루션 레이어는 fractionally-strided convolution(transposed convolution)을 수행하여 상기 인코딩부의 콘볼 루션 레이어의 수행 프로세스와는 구분될 수 있다. 본 발명은 생성 모델에 attention 모듈을 포함시키며, 상기 attention 모듈은 1개의 입력 이미지에 한 개 의 특정 픽셀에 집중할 때, 그 픽셀이 non-linear하게 어디 부분을 봐야 하는지를 확인해주는 모듈에 해당할 수 있다. Attention 모듈을 사용하면 한가지 물체의 한 특정 픽셀의 생성을 진행할 때 생성 중인 픽셀에서 거리가 있는 위치에 있는 픽셀을 참고하므로 보다 다양하고 디테일한 가상 이미지의 생성이 가능한 것이다. 즉, 512 x 512 사이즈의 이미지가 있을 때, (20, 25) 위치에 해당하는 특정 픽셀과 관련 attention 모듈을 통해 (20, 25)를 판단할 때 어느 픽셀에 더 가중치를 두어야 하는지를 확인하는 용도로 상기 attention 모듈이 이용 될 수 있다. 이와 같이, 가중치를 두는 것을 통해 가중치가 높은 부분을 보다 디테일하게 표현할 수 있는 효과 가 있다. 상기 attention 모듈은 복수의 콘볼루션 레이어 중 제1 콘볼루션 레이어 및 제2 콘볼루션 레이어 사이에 추가될 수 있다. 즉, 어느 2개의 convolution 연산 사이에 attention 모듈의 연산이 추가될 수 있는 것이다. 다만, 본 발명에서는 도 3과 같이 인코딩부에 포함된 convolution layer 중 시계열적으로 첫번째에 위치한 convolution layer와 두번째에 위치한 convolution layer 사이에 상기 attention 모듈이 추가되는 것을 고려할 수 있다. 다만, 다른 위치의 convolution layer를 제외하는 것은 아니다. attention 모듈은 서로 다른 1x1 kernel의 2D convolution 연산을 포함하는 제1 함수, 제2 함수 및 제3 함수를 포함할 수 있다. 도 4를 참조하면, 상기 제1 함수는 f(x), 상기 제2 함수는 g(x), 상기 제3 함수는 h(x)와 매칭 될 수 있을 것이다. 참고로, f(x), g(x), h(x) 등은 서로 다른 가중치를 가질 수 있고, f(x)는 일종의 queue,g(x)는 일종의 key, h(x)는 일종의 value에 해당할 수 있을 것이다. 또한, 제1 콘볼루션 레이어의 연산 결과인 제1 피쳐 맵(x)을 attention 모듈의 입력 데이터로 설정할 수 있다. 상기 제1 피쳐 맵(x)에 대해 상기 제1 함수, 제2 함수, 제3 함수 각각에 대해 연산을 수행할 수 있다. 상기 제1 피쳐 맵(x)에 대해 제1 함수의 연산 결과 값과 상기 제1 피쳐 맵(x)에 대해 제2 함수의 연산 결과 값 에 softmax 함수를 통과시켜 attention map을 생성시킬 수 있다. 도 4를 참조하여, 구체적으로 설명하면 제1 피쳐맵(convolution feature maps(x))에 대해 1x1 2D convolution 연산을 포함하는 f(x) 연산을 통해 제1-1 피쳐맵을 획득하고, 제1 피쳐맵에 대해 1x1 2D convolution 연산을 포 함하는 g(x) 연산을 통해 제1-2 피쳐맵을 획득할 수 있다. 또한, 상기 제1-1 피쳐맵에 대해 transpose 연산 수행 후 결과 값을 상기 제1-2 피쳐맵과 연산(ex 크로네커 곱 셈)을 수행하고, softmax 함수를 거쳐 가중치 값들을 0~1 사이로 만들고, 해당 값들을 가지는 attention map을 생성시킬 수 있다. 즉, f(x)와 g(x)를 pixel-wise 곱으로 진행한 뒤 softmax activation을 통해 attention map 을 생성시키는 것이다. 상기 연산의 결과인 attention map은 포함된 가중치가 높을수록 특정 픽셀에 대해 영향력이 커서 흰색(밝음)에 가깝고, 포함된 가중치가 낮을수록 특정 픽셀에 대해 영향력이 작아서 검정색(어두움)에 가까울 수 있다. 도 5 를 살펴보면, 이미지 상에 특정 픽셀이 존재하고 그로부터 떨어진 영역에 흰색 영역이 존재하는 것을 확인할 수 있다. 즉, 특정 픽셀에 영향을 미치는 지역을 흰색 영역으로 표시한 것이다. 또한, 특정 픽셀에의 정보로 거리가 먼 픽셀의 정보에 attention 하여 특정 픽셀의 속성을 확인할 수도 있다. 다음으로, 상기 attention map과 제3 함수의 연산을 진행하여 제2 피쳐 맵(o)을 생성시킬 수 있다. 구체적으로, 제1 피쳐맵에 대해 1x1 2D convolution 연산을 포함하는 h(x) 연산을 통해 제1-3 피쳐맵을 획득할 수 있고, 상 기 제1-3 피쳐맵과 상기 attention map을 연산(ex 크로네커 곱셈)을 수행한 뒤 1x1 2D convolution을 포함하는 v(x)를 통해 제2 피쳐맵(o)을 획득할 수 있다. 즉, h(x)와 attention map을 pixel-wise 곱으로 진행한 뒤, 1x1 conv(v(x))를 통해 제2 피쳐맵(o)을 획득할 수 있는 것이다. 여기서, v(x)는 제4 함수로서 1x1 2D convolution을 통해 제1 피쳐맵(convolution feature maps(x))과 같은 사이즈에 해당하는 제2 피쳐맵(o)을 생성시킬 수 있다. 0~1의 가중치를 가지는 것을 고려할 때 attention map이 key에 해당하고, h(x)는 value에 해당할 수 있을 것이다. 또한, 설정에 따라 입력 데이터인 제1 피쳐맵(x)을 kernel로 콘볼루션 연산을 수행한 뒤, 출력으로 나온 피쳐맵 을 Global Average Plloing과 Max Pooling 연산을 통해 가중치를 산출할 수 있고, 산출된 가중치는 입력값에 반영되어 주목이 필요한 부분은 더 강조되고, 필요없는 부분은 그 영향이 감소되어 나타날 수 있다. 도 3을 고려할 때, attention 모듈의 입력 데이터인 제1 피쳐맵(x)이 제1 콘볼루션 레이어(conv 1)의 결과 값에 해당하고, attention 모듈의 출력 데이터인 제2 피쳐맵(o)은 피쳐맵 b에 해당할 수 있을 것이다. 상기 피쳐맵 b 는 제2 콘볼루션 레이어(conv 2)의 입력 값에 해당할 수 있다. 결국, 제1 콘볼루션 레이어와 제2 콘볼루션 레이 어 사이에 attention 모듈이 추가되는 것이다. 상기 attention 모듈에 포함된 f(x), g(x), h(x) 함수에서 1x1 kernel convolution을 넣어, 1x1 kernel을 학습 시켜 해당 task에 맞도록 kernel을 학습시킬 수 있다. 상기 입력 이미지가 상기 생성 모델을 통과한 후 페이크 병변 이미지가 생성되고, 상기 페이크 병 변 이미지와 리얼 병변 이미지를 판별 모델에 통과시키면서 획득한 손실함수의 결과 값을 기초로 생성 모델 및 판별 모델을 학습시킬 수 있다. 컴퓨팅 장치는 판별 모델에 대해 가짜 이미지(페이크 병변 이미지)와 진짜 이미지(리얼 병변 이미지)를 구 분하고자, 입력받은 이미지가 진짜 이미지인 경우 1, 가짜 이미지인 경우 0의 값을 출력하도록 학습할 수 있다. 이에 반해 생성 모델은 생성한 가짜 이미지를 판별 모델이 입력받는 경우 이를 1로 예측하도록 하는 것을 목표로 학습될 수 있다. 상기 생성 모델 및 판별 모델의 관계를 나타낸 함수가 손실함수이며, 학습 과정에서 손실함수가 이용될 수 있다. 도 6은 본 발명의 일 실시예에 따라 판별 모델의 손실함수를 나타낸 도면이다. 도 6(a)는 기존의 손실함수에 해당하며 해당 손실함수는 생성 모델과 판별 모델을 경쟁 학습시킬 수 있다. 도 6의 D는 판별 모델을 나타내고, G는 생성 모델을 나타낼 수 있다. 도 6(a)의 식을 판별 모델과 생성 모델로 나누어 살펴보면 다음과 같다. 먼저, 판별 모델 D는 아래의 식의 최대값으로 파라미터를 업데이트하는 것을 목표로 할 수 있다. (식 1) 이때, 판별 모델 D 입장에서 최상의 경우(진짜 이미지는 1, 가짜 이미지는 0을 출력하는 경우) D(x)=1, D(G(z))=0이 될 것이고 이는 위의 식의 최대값이 될 수 있다. 다음으로 생성 모델 G는 아래의 식의 최소값으로 파라미터를 업데이트하는 것을 목표로 할 수 있다. (식 2) 이때 생성 모델 G 입장에서 최상의 경우(판별 모델이 생성 모델이 생성한 가짜 이미지를 1로 출력하는 경우) D(G(z))=1이 될 것이고, 이는 위의 식의 최소값이 될 수 있다. 상기 도 6(a)에 해당하는 기존 손실함수를 이용할 때, GAN 알고리즘의 학습 후반부에 다가갈수록 판별 모델 에 주어진 이미지가 모두 진짜라고 판단되는 경우가 많아질 수 있다. 이는 생성 모델의 성능이 학습 을 통해 향상되면서 발생하는 현상이지만, 판별 모델의 학습, 나아가 GAN 알고리즘 전체의 성능에는 도움 이 되지 않을 수 있다. GAN을 학습시킬 때 주어지는 배치는 진짜 이미지 반, 가짜 이미지 반으로 이루어지는데, 기존에는 진짜 이미지 는 진짜 이미지끼리, 가짜 이미지는 가짜 이미지끼리 판별 모델에서 학습되었다. 즉, 1000장의 이미지(500장은 진짜 이미지, 500장은 가짜 이미지)를 이용하여 학습을 진행할 때, 배치 사이즈가 16인 경우 1회차에는 진짜 이미지로부터 16장의 이미지를 획득하여 판별 모델을 통과시키고, 2회차에는 가 짜 이미지로부터 16장의 이미지를 획득하여 판별 모델을 통과시켜 학습 과정을 진행한 것이다. 진짜 이미 지 16장, 가짜 이미지 16장, 진짜 이미지 16장, 가짜 이미지 16장 등이 반복적으로 획득되어 학습되었다. 참고 로, 배치 사이즈는 한 번에 입력되는 이미지의 개수에 해당하며 설정에 따라 변경될 수 있다. 진짜 이미지는 진짜 이미지끼리, 가짜 이미지는 가짜 이미지끼리 학습되는 기존의 방식은 진짜 이미지와 가짜 이미지의 절대적인 거리만을 고려한다는 문제가 있었다. 이에 따라 본 발명에서는 상대적인 손실 함수(Relativistic Discriminator, 도 6(b) 참조)를 이용하여 진짜 이 미지와 가짜 이미지의 상대적인 거리를 구하여 GAN이 최적의 해로 수렴되도록 할 수 있다. 도 6(b)의 식은 상대적인 손실 함수를 나타내며, 모두 활성화 함수이며, 대부분 cross-entropy를 이용할 수 있 다. 상기 손실함수는 진짜 이미지와 가짜 이미지의 상대적인 거리가 발생하여 판별 모델은 보다 정확한 구 분이 가능할 수 있다. 또한, 상기 식에 의한 손실함수를 이용하게 되면 GAN은 학습시 더 이상 데이터들을 절대적인 기준으로 판단하지 않고 진짜 데이터들의 feature들의 분포와 가짜 데이터들의 feature들의 분포를 비교하여 입력받은 데이터가 가 짜 데이터와 비교했을 때 상대적으로 얼마나 가짜같은지 여부를 판단할 수 있다. 이 경우, 모든 배치에 대해 대 부분 진짜와 가짜에 대해 판단하게 되므로 gradient 손실로 인해 모든 데이터를 진짜로 판별하게 되는 문제를 해결할 수 있다. 복수의 페이크 병변 이미지 및 복수의 리얼 병변 이미지가 상기 판별 모델의 입력 데이터에 해당 하고, 상기 판별 모델의 상기 손실함수에 n개의 이미지가 반복적으로 입력되고 이를 통해 학습이 이루어질 수 있다. 복수의 페이크 병변 이미지 중 n/2개의 페이크 병변 이미지와 복수의 리얼 항변 이미지 중 n/2개의 리얼 병변 이미지가 동일 회차에서 손실함수에 입력될 수 있다. 예를 들어, 1000장의 이미지(ex 500장은 리얼 병변 이미지, 500장은 페이크 병변 이미지)로부터 배치 사이즈 16 에 기초하여 16장의 이미지를 획득하여 판별 모델에 입력될 수 있다. 이때, 복수의 페이크 병변 이미지 중 8장의 이미지와 복수의 리얼 병변 이미지 중 8장의 이미지를 상기 판별 모 델의 손실함수에 반복적으로 입력시켜 결과 값을 획득하고, 이를 통해 상기 생성 모델에 포함된 파라 미터(ex 콘볼루션 레이어, 1x1 kernel 등에 포함) 및 판별 모델에 포함된 파라미터 등을 학습시킬 수 있다. 컴퓨팅 장치는 상기 생성 모델의 파라미터를 업데이트할 경우 판별 모델의 파라미터를 고정시킬 수 있다. 반대로, 판별 모델의 파라미터를 업데이트할 경우 생성 모델의 파라미터를 고정시킬 수 있다. 생성 모델 및 판별 모델이 학습이 완료된 후, 컴퓨팅 장치는 상기 학습된 생성 모델을 이용하여 피부암 관련 복수의 가상 이미지를 생성할 수 있다. 페이크 병변 이미지와 가상 이미지는 모두 생성 모델 의 연산 결과에 해당하나, 페이크 병변 이미지는 학습 전 또는 학습 과정 중의 연산 결과이고, 가상 이미지는 학습이 완료된 후의 연산 결과에 해당할 수 있다. 상기 생성되는 가상 이미지는 학습이 완료되기 전 페이크 병변 이미지보다 실제 피부암 병변 이미지와 유사할 수 있을 것이다. 이상 설명된 본 발명에 따른 실시예들은 다양한 컴퓨터 구성요소를 통하여 수행될 수 있는 프로그램 명령어의 형태로 구현되어 컴퓨터 판독 가능한 기록 매체에 기록될 수 있다. 상기 컴퓨터 판독 가능한 기록 매체는 프로 그램 명령어, 데이터 파일, 데이터 구조 등을 단독으로 또는 조합하여 포함할 수 있다. 상기 컴퓨터 판독 가능 한 기록 매체에 기록되는 프로그램 명령어는 본 발명을 위하여 특별히 설계되고 구성된 것들이거나 컴퓨터 소프 트웨어 분야의 당업자에게 공지되어 사용 가능한 것일 수도 있다. 컴퓨터 판독 가능한 기록 매체의 예에는, 하 드 디스크 및 자기 테이프와 같은 자기 매체, CD-ROM, DVD와 같은 광기록 매체 및 ROM, RAM, 플래시 메모리 등 과 같은 프로그램 명령어를 저장하고 수행하도록 특별히 구성된 하드웨어 장치가 포함된다. 프로그램 명령어의 예에는, 컴파일러에 의해 만들어지는 것과 같은 기계어 코드뿐만 아니라 인터프리터 등을 사용해서 컴퓨터에 의 해서 실행될 수 있는 고급 언어 코드도 포함된다. 상기 하드웨어 장치는 본 발명에 따른 처리를 수행하기 위해 하나 이상의 소프트웨어 모듈로서 작동하도록 구성될 수 있으며, 그 역도 마찬가지이다. 이상에서 본 발명이 구체적인 구성요소 등과 같은 특정 사항들과 한정된 실시예 및 도면에 의해 설명되었으나, 이는 본 발명의 보다 전반적인 이해를 돕기 위해서 제공된 것일 뿐, 본 발명이 상기 실시예들에 한정되는 것은"}
{"patent_id": "10-2021-0100122", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "아니며, 본 발명이 속하는 기술분야에서 통상적인 지식을 가진 자라면 이러한 기재로부터 다양한 수정 및 변형 을 꾀할 수 있다. 따라서, 본 발명의 사상은 상기 설명된 실시예에 국한되어 정해져서는 아니 되며, 후술하는 특허청구범위뿐만 아니라 이 특허청구범위와 균등하게 또는 등가적으로 변형된 모든 것들은 본 발명의 사상의 범주에 속한다고 할 것이다."}
{"patent_id": "10-2021-0100122", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 일 실시예에 따라 GAN의 개략적인 구성을 나타내는 도면이다. 도 2는 본 발명의 일 실시예에 따라 생성 모델에 입력되는 입력 이미지의 모습을 나타내는 도면이다. 도 3은 본 발명의 일 실시예에 따라 생성 모델의 개략적인 구성을 나타내는 도면이다. 도 4는 본 발명의 일 실시예에 따라 attention 모듈을 개략적으로 나타낸 도면이다. 도 5는 본 발명의 일 실시예에 따라 attention 모듈이 적용되는 이미지의 모습을 나타낸 도면이다. 도 6은 본 발명의 일 실시예에 따라 판별 모델의 손실함수를 나타낸 도면이다."}
