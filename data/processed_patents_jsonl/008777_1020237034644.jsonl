{"patent_id": "10-2023-7034644", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2024-0007124", "출원번호": "10-2023-7034644", "발명의 명칭": "심층 학습 알고리즘을 훈련하기 위한 희귀 의료 영상을 생성하는 방법", "출원인": "퀀텀 서지컬", "발명자": "지라르도 미카엘"}}
{"patent_id": "10-2023-7034644", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "관심 해부학적 구조(14) 및 상기 관심 해부학적 구조(14) 내의 이상(15)을 나타내는 합성 의료 영상(13)을 생성하는 방법(100)으로서,- 메이저 분할 마스크(21)를 생성하는 단계(101)로, 각각의 메이저 분할 마스크(21)는 이상이 없는 환자의 관심해부학적 구조(14)를 나타내는 메이저 실제 의료 영상(11)과 관련이 있는 것인 단계(101);- 마이너 분할 마스크(22)를 생성하는 단계(102)로, 각각의 마이너 분할 마스크(22)는 이상(15)이 있는 환자의관심 해부학적 구조(14)를 나타내는 마이너 실제 의료 영상(12)과 관련이 있는 것인 단계(102);- 분할 마스크로부터 합성 의료 영상(13)을 생성하도록 신경망(31)을 훈련하는 단계(103);- 메이저 분할 마스크(21) 및 마이너 분할 마스크(22)로부터 인공 분할 마스크(23)를 생성하는 단계(104)로, 상기 인공 분할 마스크(23)의 생성(104)은 메이저 분할 마스크(21)의 관심 해부학적 구조의 분할(24)과 마이너 분할 마스크(22)의 이상의 분할(25)의 결합을 포함하는 것인 단계(104);- 사전 훈련된 신경망(31')을 사용하여 상기 인공 분할 마스크(23)로부터 합성 의료 영상(13)을 생성하는 단계(105)를 포함하는, 방법(100)."}
{"patent_id": "10-2023-7034644", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서, 상기 인공 분할 마스크(23-1~23-7)의 생성(104)은 상기 마이너 분할 마스크(22)의 상기 이상의상기 분할(25)을 변환하는 것을 추가로 포함하는, 방법(100)."}
{"patent_id": "10-2023-7034644", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제2항에 있어서, 상기 이상의 상기 분할(25)의 변환은 상기 이상의 상기 분할(25)의 회전, 확대, 축소, 변형,및/또는 이동에 해당하는, 방법."}
{"patent_id": "10-2023-7034644", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제1항 내지 제3항 중 어느 한 항에 있어서, 상기 인공 분할 마스크(23)의 생성(104)은 상기 관심 해부학적 구조의 상기 분할(24)에 대한 상기 이상의 상기 분할(25)이 특정 기준을 충족하는지 확인하는 것을 추가로포함하는, 방법(100)."}
{"patent_id": "10-2023-7034644", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제1항 내지 제4항 중 어느 한 항에 있어서, 분할 마스크(21, 22)는 복셀의 세트를 포함하되, 각각의 복셀은 상기 분할 마스크(21, 22)와 관련이 있는 상기 실제 의료 영상(11, 12)의 구역에 해당하고, 각각의 복셀은 상기실제 의료 영상(11, 12)에서 상기 구역에 의해 보이는 것을 인코딩한 수치값과 관련이 있고, 상기 인공 분할 마스크(23)를 생성하는 단계(104)는- 메이저 분할 마스크(21) 및 마이너 분할 마스크(22)를 선택하는 것;- 상기 선택된 마이너 분할 마스크(22) 상에서, 상기 이상을 인코딩한 수치값을 갖는 복셀의 세트를 식별하는것;- 상기 선택된 메이저 분할 마스크(21) 상에서, 상기 식별된 복셀의 수치값을 상기 이상을 인코딩한 수치값으로대체하는 것을 포함하는, 방법(100)."}
{"patent_id": "10-2023-7034644", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제1항 내지 제5항 중 어느 한 항에 있어서, 합성 의료 영상(13)을 생성하기 위해 사용되는 상기 신경망(31)은생성기 신경망(31)이고, 상기 생성기 신경망(31)의 훈련은 판별기 신경망(32)을 사용하여 구현되되, 상기 생성공개특허 10-2024-0007124-3-기 신경망(31) 및 상기 판별기 신경망(32)은 한 쌍의 생성적 적대 신경망을 형성하는, 방법(100)."}
{"patent_id": "10-2023-7034644", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제1항 내지 제6항 중 어느 한 항에 있어서, 상기 메이저 분할 마스크(21) 및 상기 마이너 분할 마스크(22)가 생성되는 상기 실제 의료 영상(11, 12)은 단층밀도계측, 양전자 방출 단층촬영, 자기 공명 영상, 또는 초음파에의해 획득되는 의료 영상인, 방법(100)."}
{"patent_id": "10-2023-7034644", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제1항 내지 제7항 중 어느 한 항에 있어서, 상기 관심 해부학적 구조는 간, 폐, 또는 신장과 같은 기관, 또는뼈 또는 혈관과 같은 다른 해부학적 구조물인, 방법(100)."}
{"patent_id": "10-2023-7034644", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제1항 내지 제8항 중 어느 한 항에 있어서, 상기 이상은 종양 또는 절제 구역인, 방법(100)."}
{"patent_id": "10-2023-7034644", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "- 실제 의료 영상(11, 12)에서 환자의 관심 해부학적 구조(14) 내의 이상(15)을 검출하거나 특성화하는 것을 목표로 하는 기계 학습 알고리즘(40)을 훈련하는 방법(200)으로서,- 제1항 내지 제9항 중 어느 한 항에 따른 방법(100)을 사용하여 관심 해부학적 구조 및 상기 관심 해부학적 구조 내의 이상을 나타내는 합성 의료 영상(13)을 생성하는 단계(201);- 그렇게 생성된 상기 합성 의료 영상(13)을 포함하는 훈련 영상의 세트를 사용하여 상기 기계 학습 알고리즘(40)을 훈련하는 단계(202)를 포함하는, 방법(200)."}
{"patent_id": "10-2023-7034644", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "제10항에 있어서, 상기 훈련 영상의 세트는 합성 의료 영상(13) 및 실제 의료 영상(11, 12)을 포함하고, 이상이있는 영상의 수는 이상이 없는 영상의 수의 적어도 10%와 같은, 방법(200)."}
{"patent_id": "10-2023-7034644", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제10항 또는 제11항에 있어서, 상기 기계 학습 알고리즘(40)은 이상 분류 알고리즘인, 방법(200)."}
{"patent_id": "10-2023-7034644", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "제10항 또는 제11항에 있어서, 상기 기계 학습 알고리즘(40)은 이상 분할 알고리즘인, 방법(200)."}
{"patent_id": "10-2023-7034644", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_14", "content": "제10항 내지 제13항 중 어느 한 항에 있어서, 상기 기계 학습 알고리즘(40))은 심층 신경망에 의해 구현되는,방법(200)."}
{"patent_id": "10-2023-7034644", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_15", "content": "하나 이상의 프로세서(들) 및 상기 하나 이상의 프로세서(들)에 의해 판독될 수 있는 하나 이상의 저장 매체를포함하는 장치로, 상기 저장 매체는 메이저 분할 마스크(21) 및 마이너 분할 마스크(22)를 저장하도록의도되고, 각각의 메이저 분할 마스크(21)는 이상이 없는 환자의 관심 해부학적 구조(14)의 메이저 실제 의료영상(11)에서 보이는 상기 관심 해부학적 구조의 분할(24)을 포함하고, 각각의 마이너 분할 마스크(22)는 환자의 관심 해부학적 구조(14) 내에 이상(15)이 있는 상기 관심 해부학적 구조(14)의 마이너 실제 의료 영상(12)에서 보이는 이상의 분할(25)을 포함하는 장치로서, 상기 저장 매체는, 프로그램이 상기 하나 이상의프로세서(들)에 의해 실행될 때, 상기 저장 매체 상에 저장되는 상기 메이저 분할 마스크(21) 및 상기 마이너분할 마스크(22)로부터 인공 분할 마스크(23)의 세트를 생성하도록 상기 하나 이상의 프로세서(들)를 구성하는프로그램 코드 명령의 세트를 포함하되, 각각의 인공 분할 마스크(23)는 메이저 분할 마스크(21)의 관심 해부학적 구조의 분할(24)과 마이너 분할 마스크(22)의 이상의 분할(25)을 결합시킴으로써 생성되는 것을 특징으로 하는 장치.공개특허 10-2024-0007124-4-청구항 16 제15항에 있어서, 인공 분할 마스크(23-1~27-1)를 생성하기 위해, 상기 하나 이상의 프로세서(들)는 또한 상기마이너 분할 마스크(22)의 상기 이상의 상기 분할(25)을 변환하도록 구성되는, 장치."}
{"patent_id": "10-2023-7034644", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_17", "content": "제16항에 있어서, 상기 이상의 상기 분할(25)의 변환은 상기 이상의 상기 분할(25)의 회전, 확대, 축소, 변형,또는 이동에 해당하는, 장치."}
{"patent_id": "10-2023-7034644", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_18", "content": "제15항 내지 제17항 중 어느 한 항에 있어서, 인공 분할 마스크(23)를 생성하기 위해, 상기 하나 이상의 프로세서(들)는 또한 상기 관심 해부학적 구조의 상기 분할(24)에 대한 상기 이상의 상기 분할(25)이 특정 기준을 충족함을 확인하도록 구성되는, 장치."}
{"patent_id": "10-2023-7034644", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_19", "content": "제15항 내지 제18항 중 어느 한 항에 있어서, 분할 마스크(21, 22)는 복셀의 세트를 포함하되, 각각의 복셀은상기 분할 마스크(21, 22)와 관련이 있는 상기 실제 의료 영상(11, 12)의 구역에 해당하고, 각각의 복셀은 상기실제 의료 영상(11, 12)에서 상기 구역에 의해 보이는 것을 인코딩한 수치값과 관련이 있고, 인공 분할 마스크(23)를 생성하기 위해, 상기 하나 이상의 프로세서(들)는- 메이저 분할 마스크(21) 및 마이너 분할 마스크(22)를 선택하고;- 상기 선택된 마이너 분할 마스크(22) 상에서, 상기 이상을 인코딩한 수치값을 갖는 복셀의 세트를 식별하고;- 상기 선택된 메이저 분할 마스크(21) 상에서, 상기 식별된 복셀의 수치값을 상기 이상을 인코딩한 수치값으로대체하도록 구성되는, 장치."}
{"patent_id": "10-2023-7034644", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_20", "content": "제15항 내지 제19항 중 어느 한 항에 있어서, 상기 저장 매체는 또한 분할 마스크로부터 합성 의료 영상(13)을생성하도록 사전 훈련된 신경망(31')을 저장하고, 프로그램이 실행될 때, 상기 하나 이상의 프로세서(들)는 상기 신경망(31')으로 인공 분할 마스크(23)로부터 합성 의료 영상(13)을 생성하도록 구성되는, 장치."}
{"patent_id": "10-2023-7034644", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_21", "content": "제20항에 있어서, 합성 의료 영상(13)을 생성하기 위한 상기 신경망(31)은 판별기 신경망(32)을 사용하여 훈련되도록 생성되는 생성기 신경망(31)이고, 상기 생성기 신경망(31) 및 상기 판별기 신경망(32)은 한 쌍의 생성적적대 신경망을 형성하는, 장치."}
{"patent_id": "10-2023-7034644", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 관심 해부학적 구조 및 상기 관심 해부학적 구조 내의 이상을 나타내는 합성 의료 영상을 생성하는 방 법에 관한 것이다. 방법은 이상이 없는 실제 의료 영상과 관련이 있는 메이저 분할 마스크를 생성하는 단계, 이상이 있는 실제 의료 영상과 관련이 있는 마이너 분할 마스크를 생성하는 단계, 분할 마스크 에 기반하여 합성 의료 영상을 생성하도록 신경망을 훈련하는 단계, 메이저 분할 마스크의 관심 해부학적 구조의 분할과 마이너 분할 마스크의 이상의 분할을 결합시킴으로써 메이저 및 마이너 분할 마스크에 기반하여 인공 분할 마스크를 생성하는 단계, 및 사전 훈련된 신경망을 사용하여 인공 분할 마스크에 기반하여 합성 의료 영상을 생성하는 단계를 포함한다."}
{"patent_id": "10-2023-7034644", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 출원은 인공 신경망을 사용하여 희귀 해부학적 이상을 나타내는 합성 의료 영상을 생성하는 분야에 관한 것 이다. 생성된 합성 영상은 의료 영상에서 보이는 관심 해부학적 구조 내의 이상을 검출하거나 특성화하는 것을 목표로 하는 기계 학습 알고리즘, 예를 들어 이상을 분류하거나 분할하기 위한 심층 신경망을 훈련하기 위해 사 용되도록 의도된다."}
{"patent_id": "10-2023-7034644", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "기계 학습 알고리즘의 훈련, 보다 구체적으로 인공 신경망의 훈련은 양호한 예측 품질을 달성하기 위해 훈련 세 트에서 대량의 데이터를 요구한다. 훈련 세트에서 희귀 클래스의 데이터를 과소 대표하는 것은 실제로 클래스들 간에 관찰되는 예측 편향에 영향을 미친다. 이러한 문제는 예를 들어 의료 영상에서 보이는 관심 해부학적 구조 내의 이상을 검출하거나 특성화하는 것을 목표로 하는 심층 신경망을 훈련하기 위한 의료 분야에서 특히 중요하다. 실제로, 질환의 희소성, 환자의 기밀성, 의료 촬상 작업을 수행하는 데에 요구되는 수고 및 비용 등으로 인해 대량의 의료 영상을 수집하기가 어렵 다. 기존의 몇몇 해결안은 희귀 해부학적 이상을 나타내는 합성 의료 영상을 생성함으로써 훈련 세트에서 희귀 클래 스에 해당하는 데이터의 양을 인위적으로 증가시키는 것을 목표로 한다. 그러나, 선행 기술의 해결안에서, 획득 되는 합성 영상은 일반적으로 이것이 생성되는 실제 영상과 충분히 상이하지 않으며, 분류 또는 분할을 위한 심 층 신경망의 최적의 훈련을 가능하게 하지 않는다. 실제로, 이후 다른 클래스들을 희생하여 특정 클래스를 과잉 학습할 위험이 있다. 과잉 학습은 알고리즘의 예측의 일반화 손실 현상을 가리킨다: 예측은 훈련 세트의 데이터 에 대해서는 양호하지만 신규 데이터에 대해서는 열악하다. 특허 출원 US 2019/0370969 A1에는, 예를 들어, \"생성적 적대 신경망(Generative Adversarial Networks)\"(또는 GAN)에 의해 생성되는 합성 영상으로 종양을 분류하기 위한 알고리즘을 훈련하는 것이 교시되어 있다. 분류 알 고리즘은 실제 영상과 혼합되는 합성 영상을 사용하여 훈련된다. 몇몇 생성적 적대 신경망이 상이한 클래스의 종양들의 영상을 생성하는 데에 요구된다. 분류 알고리즘을 훈련하는 방법은 알고리즘의 학습 성능의 함수로서 영상의 가중치를 조정하는 방법을 포함하고, 이는 상이한 사례의 학습, 특히 훈련 세트에서 과소 대표되는 사례 의 학습을 향상시키는 것을 가능하게 한다. 이러한 방법의 주요 단점은 상이한 클래스의 합성 영상을 생성하기 위해 복수의 생성적 적대 신경망을 훈련해야 한다는 것인데, 이는 기술적으로 어려운 일이다. 이러한 접근법의 다른 한계는 획득되는 합성 영상의 다양성이 생성적 적대 신경망을 훈련하기 위해 사용되는 영상의 다양성에 의 해 제한된다는 데에 있다. 희귀 클래스의 합성 영상은 초기에 생성적 적대 신경망의 훈련 데이터의 세트에 존재 하지 않는 경우 생성하기가 어렵다. 일부 해결안은 서로 상호 의존하는 적어도 2개의 생성적 적대 신경망을 구현한다. 이러한 접근법은, 특히 하나 의 생성기의 최적화가 다른 생성기의 최적화에 따라 좌우되기 때문에, 기술적 복잡성을 상당히 증가시킨다. 따라서, 이상을 검출하거나 특성화하는 것을 목표로 하는 학습 알고리즘을 훈련하기 위해 희귀 해부학적 이상의 다수의 다양한 영상을 생성하기 위한 비교적 간단히 구현되는 해결안에 대한 요구가 여전히 존재한다."}
{"patent_id": "10-2023-7034644", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 출원에 개시된 방법 및 장치의 목적은 선행 기술의 단점들, 특히 상기에 설명된 단점들 중 전부 또는 일부를 극복하는 데에 있다."}
{"patent_id": "10-2023-7034644", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "이를 위해, 제1 양태에 따르면, 관심 해부학적 구조 및 상기 관심 해부학적 구조 내의 이상을 나타내는 합성 의 료 영상을 생성하는 방법이 제안된다. 방법은 - 메이저 분할 마스크를 생성하는 단계로, 각각의 메이저 분할 마스크는 이상이 없는 환자의 관심 해부학적 구 조를 나타내는 메이저 실제 의료 영상과 관련이 있는 것인 단계; - 마이너 분할 마스크를 생성하는 단계로, 각각의 마이너 분할 마스크는 이상이 있는 환자의 관심 해부학적 구 조를 나타내는 마이너 실제 의료 영상과 관련이 있는 것인 단계; - 분할 마스크로부터 합성 의료 영상을 생성하도록 신경망을 훈련하는 단계; - 메이저 분할 마스크 및 마이너 분할 마스크로부터 인공 분할 마스크를 생성하는 단계로, 인공 분할 마스크의 생성은 메이저 분할 마스크의 관심 해부학적 구조의 분할과 마이너 분할 마스크의 이상의 분할의 결합을 포함하 는 것인 단계; - 사전 훈련된 신경망을 사용하여 인공 분할 마스크로부터 합성 의료 영상을 생성하는 단계를 포함한다. 관심 해부학적 구조는 기관(예를 들어, 간, 췌장, 담낭, 폐, 또는 신장) 또는 다른 해부학적 구조물(예를 들어, 뼈 또는 혈관)에 해당할 수 있다. 관심 해부학적 구조 내에 존재하는 이상은 일반적으로 예를 들어 종양, 낭종, 절제 구역, 동맥류 등과 같은 병변에 해당한다. 절제 구역은 공지된 방법(마이크로파, 레이저, 고주파 등)을 사 용하여 절제 치료가 가해진 병변에 해당한다. 이는 괴사 부위를 수반한다. \"실제 의료 영상\"은 의료 촬상 장치를 사용하여, 예를 들어 단층밀도계측(컴퓨터 단층촬영(CT) 스캔), 양전자 방출 단층촬영(PET 스캔), 자기 공명 영상(MRI), 초음파, 또는 엑스레이에 의해, 환자에게서 획득되는 의료 영 상으로 이해된다. \"메이저(majority)\" 및 \"마이너(minority)\"라는 용어는 일반적으로 이상이 있는 관심 해부학적 구조를 나타내는 의료 영상보다 이상이 없는 관심 해부학적 구조를 나타내는 의료 영상의 수가 훨씬 더 많기 때문에 사용된다. 이와 달리, \"합성\" 의료 영상은 신경망에 의해 인위적으로 생성된다. 신경망은 하드웨어 및/또는 소프트웨어 컴 퓨터 시스템이며, 이의 작동은 인간 두뇌의 뉴런을 모사한다. 이는 그 자체가 기계 학습 알고리즘의 일부를 형 성하는 다양한 \"심층 학습\" 기술이다. 기계 학습 알고리즘은 인공 지능 분야의 하나의 범주를 형성한다. 신경망은 실제 의료 영상과 관련이 있는 분할 마스크로부터 합성 영상을 생성하도록 훈련된다. 메이저 분할 마 스크 및 마이너 분할 마스크가 신경망을 훈련하기 위해 사용될 수 있다. 분할 마스크는 영상이며, 이의 각각의 복셀은 실제 의료 영상에서 복셀의 위치에 보이는 요소에 관한 특정 정보를 제공한다. 따라서, 복셀은 실제 의 료 영상에서 복셀의 위치에 보이는 요소와 관련이 있는 특정 수치값을 취할 수 있다(예를 들어, 특정 수치값이 관심 해부학적 구조의 건강한 부분에 대해 획정되고, 상이한 수치값이 이상에 대해 획정된다). \"복셀\"이라는 용 어는 일반적으로 영상의 특정 구역을 획정하기 위해 사용됨을 주목해야 한다(복셀은 영상에서 상기 구역의 위치 를 식별하고, 영상에서 상기 구역에 보이는 것을 나타내는 값을 취한다). 이는 2차원 또는 3차원 영상을 수반할 수 있다. 2차원 영상을 수반하는 경우, \"복셀\"이라는 용어는 \"픽셀\"이라는 용어와 동일한 의미를 갖는다. 다양한 유형의 신경망이 분할 마스크로부터 합성 영상을 생성하기 위해 고려될 수 있다. 예를 들어, 오토인코더 (\"변분 오토인코더\" 또는 VAE)형 신경망을 사용하는 것을 고려할 수 있다. 그러나, 한 쌍의 생성적 적대 신경망 (GAN)의 생성기를 사용하는 것이 바람직하다. 이러한 유형의 신경망은 실제로 매우 사실적인 영상을 생성하는 것을 가능하게 한다. GAN은 2개의 신경망이 제로섬 게임 시나리오로 경쟁하도록 설정되는 생성적 모델이다. 제1 신경망인 생성기는 영상을 생성하고, 이의 상대인 판별기는 생성된 영상이 실제 영상인지 또는 생성기에 의해 생성되는 합성 영상인지 검출하려 시도한다. 일반적으로 선행 기술의 사례와 같이, 랜덤 \"잡음\"이 아닌 분할 마스크로부터 합성 영상을 생성하는 것이 유리 하다. 신경망의 입력으로서의 분할 마스크의 사용은 신경망에 의해 생성되는 합성 영상에 대해 더 많은 제어를 제공하는 것을 가능하게 한다. 본 발명은 메이저 실제 의료 영상과 관련이 있는 메이저 분할 마스크의 세트 및 마이너 실제 의료 영상과 관련 이 있는 마이너 분할 마스크의 세트로부터 인공 분할 마스크를 생성하는 것에 기반한다. 인공 분할 마스크를 생 성하기 위해, 메이저 분할 마스크의 관심 해부학적 구조의 분할이 마이너 분할 마스크의 이상의 분할과 결합된 다. 이상의 분할은 예를 들어 관심 해부학적 구조 내의 다양한 위치에서 다양한 배향으로 메이저 분할 마스크에 통합된다. 관심 이상의 분할을 메이저 분할 마스크에 통합하기 전에 이를 변형하는 것을 또한 고려할 수 있다. 각각의 메이저 분할 마스크는 각각의 마이너 분할 마스크와 결합될 수 있다. 이러한 배열은 매우 다양한 인공 분할 마스크를 생성하는 것을 가능하게 한다. 이후, 이는 이어서 해부학적 이 상을 나타내는 매우 다양한 합성 의료 영상을 생성하는 것을 가능하게 한다. 합성 의료 영상의 이러한 다양성은 훈련 영상의 세트를 생성하는 것을 가능하게 하고, 이는 실제 의료 영상에서 환자의 관심 해부학적 구조 내의 이상을 검출하거나 특성화하는 것을 목표로 하는 기계 학습 알고리즘에 특히 효과적이다. 훈련 영상의 세트는 실제 의료 영상과 합성 의료 영상을 모두 포함할 수 있다. 하나의 이상 및 다 양한 이상을 나타내는 의료 영상의 수는 다양한 인공 분할 마스크에 의해 상당히 증가된다. 바람직하게는, 훈련 영상의 세트는 이상이 없는 영상의 수와 실질적으로 같은 수의 이상이 있는 영상을 포함한다. 따라서, 이는 특 정 클래스의 이상에 대한 과잉 학습 현상을 방지하는 것을 가능하게 한다. 게다가, 제안된 해결안의 기술적 복잡성이 비교적 제한된다. 특히, 인공 분할 마스크의 생성은 학습 알고리즘의 사용을 요구하지 않는다. 따라서, 합성 의료 영상을 생성하기 위해 제안된 방법은 (합성 영상을 생성하기 위해 사용되는 신경망이 GAN이라고 가정할 때) 기껏해야 단일 GAN을 요구한다. 제안된 방법은 단일 관심 해부학적 구조 내에 단일 이상이 있는 상기 관심 해부학적 구조를 나타내는 합성 의료 영상의 생성에 제한되지 않음을 추가로 주목해야 한다. 다시 말하면, 방법은 또한 관심 해부학적 구조 내에 복 수의 이상(잠재적으로 상이한 성질을 갖는 이상)이 있는 상기 관심 해부학적 구조를 나타내는 합성 의료 영상을 생성하는 것을 가능하게 할 수 있다. 따라서, 방법은 잠재적으로 복수의 이상이 각각 나타낸 관심 해부학적 구 조 내에 있는 복수의 상이한 관심 해부학적 구조를 나타내는 합성 의료 영상을 생성하는 것을 가능하게 할 수 있다. 이를 목적으로, 인공 분할 마스크가 상이한 관심 해부학적 구조에 해당하는 메이저 분할 마스크와 상이한유형의 이상에 해당하는 마이너 분할 마스크의 조합으로부터 생성될 수 있다. 특정 실시예에서, 방법은 단독으로 또는 모든 기술적으로 가능한 조합에 따라 채택되는 하기 특징(들) 중 하나 이상을 추가로 포함할 수 있다. 특정 실시예에서, 인공 분할 마스크의 생성은 마이너 분할 마스크의 이상의 분할을 변환하는 것을 추가로 포함 한다. 특정 실시예에서, 이상의 분할의 변환은 이상의 분할의 회전, 확대, 축소, 변형, 및/또는 이동에 해당한다. 특정 실시예에서, 인공 분할 마스크의 생성은 관심 해부학적 구조의 분할에 대한 이상의 분할이 특정 기준을 충 족하는지 확인하는 것을 추가로 포함한다. 이는 예를 들어 소정의 특정 제약이 비사실적인 조합을 필터링하기 위해 충족되는지 확인하는 것을 수반한다. 이러한 제약은 예를 들어 관심 기관 내의 또는 다른 기관 또는 다른 해부학적 구조물에 대한 이상의 위치와 관 련이 있다. 특정 실시예에서, 분할 마스크는 복셀의 세트를 포함하되, 각각의 복셀은 분할 마스크와 관련이 있는 실제 의료 영상의 구역에 해당하고, 각각의 복셀은 실제 의료 영상에서 상기 구역에 의해 보이는 것을 인코딩한 수치값과 관련이 있고, 인공 분할 마스크를 생성하는 단계는 - 메이저 분할 마스크 및 마이너 분할 마스크를 선택하는 것; - 선택된 마이너 분할 마스크 상에서, 이상을 인코딩한 수치값을 갖는 복셀의 세트를 식별하는 것; - 선택된 메이저 분할 마스크 상에서, 식별된 복셀의 수치값을 이상을 인코딩한 수치값으로 대체하는 것을 포함 한다. 특정 실시예에서, 합성 의료 영상을 생성하기 위해 사용되는 신경망은 생성기 신경망이고, 생성기 신경망의 훈 련은 판별기 신경망을 사용하여 구현되되, 생성기 신경망 및 판별기 신경망은 한 쌍의 생성적 적대 신경망을 형 성한다. 일반적으로, 생성적 적대 신경망(GAN)으로 고해상도 영상을 획득하기가 어렵다. 이러한 단점을 극복하기 위해, 본 발명에 따른 방법은 유리하게는 메이저 및 마이너 실제 의료 영상의 크기를 축소하는 선행 단계를 포함할 수 있다. 예를 들어, 의료 영상은 (2차원 영상이 수반되는 경우) 128 x 128 픽셀의 크기로 축소될 수 있고 관심 해 부학적 구조의 중앙에 놓일 수 있다. 특정 실시예에서, 메이저 분할 마스크 및 마이너 분할 마스크가 생성되는 실제 의료 영상은 단층밀도계측, 양전 자 방출 단층촬영, 자기 공명 영상, 또는 초음파에 의해 획득되는 의료 영상이다. 특정 실시예에서, 관심 해부학적 구조는 간, 폐, 또는 신장과 같은 기관, 또는 뼈 또는 혈관과 같은 다른 해부 학적 구조물이다. 특정 실시예에서, 이상은 종양 또는 절제 구역이다. 제2 양태에 따르면, 실제 의료 영상에서 환자의 관심 해부학적 구조 내의 이상을 검출하거나 특성화하는 것을 목표로 하는 기계 학습 알고리즘을 훈련하는 방법이 제안된다. 방법은 전술한 실시예들 중 임의의 하나에 따른 방법을 사용하여 관심 해부학적 구조 및 상기 관심 해부학적 구조 내의 이상을 나타내는 합성 의료 영상을 생성 하는 단계를 포함한다. 방법은 이어서 그렇게 생성된 합성 의료 영상을 포함하는 훈련 영상의 세트를 사용하여 기계 학습 알고리즘을 훈련하는 단계를 포함한다. 특정 실시예에서, 방법은 단독으로 또는 모든 기술적으로 가능한 조합에 따라 채택되는 하기 특징(들) 중 하나 이상을 추가로 포함할 수 있다. 특정 실시예에서, 훈련 영상의 세트는 합성 의료 영상 및 실제 의료 영상을 포함하고, 이상이 있는 영상의 수는 이상이 없는 영상의 수의 적어도 10%와 같다. 특정 실시예에서, 기계 학습 알고리즘은 이상 분류 알고리즘이다. 특정 실시예에서, 기계 학습 알고리즘은 이상 분할 알고리즘이다. 특정 실시예에서, 기계 학습 알고리즘은 심층 신경망에 의해 구현된다. 제3 양태에 따르면, 실제 의료 영상에서 환자의 관심 해부학적 구조 내의 이상을 검출하거나 특성화하는 방법이 제안된다. 방법은 - 전술한 실시예들 중 임의의 하나에 따른 방법을 사용하여 실제 의료 영상에서 환자의 관심 해부학적 구조 내 의 이상을 검출하거나 특성화하는 것을 목표로 하는 기계 학습 알고리즘을 훈련하는 단계; - 환자의 관심 해부학적 구조의 실제 의료 영상을 수신하는 단계; - 훈련된 기계 학습 알고리즘으로 상기 실제 의료 영상을 분석하는 단계; - 훈련된 기계 학습 알고리즘의 출력으로서, 실제 의료 영상에서 보이는 관심 해부학적 구조 내의 이상의 검출 또는 특성화를 가능하게 하는 정보를 획득하는 단계를 포함한다. 제4 양태에 따르면, 하나 이상의 프로세서(들) 및 하나 이상의 프로세서(들)에 의해 판독될 수 있는 하나 이상 의 저장 매체를 포함하는 장치가 제안된다. 저장 매체는 메이저 분할 마스크 및 마이너 분할 마스크를 저장하도 록 의도된다. 각각의 메이저 분할 마스크는 이상이 없는 환자의 관심 해부학적 구조의 메이저 실제 의료 영상에 서 보이는 관심 해부학적 구조의 분할을 포함한다. 각각의 마이너 분할 마스크는 환자의 관심 해부학적 구조 내 에 이상이 있는 상기 관심 해부학적 구조의 마이너 실제 의료 영상에서 보이는 이상의 분할을 포함한다. 저장 매체는, 프로그램이 하나 이상의 프로세서(들)에 의해 실행될 때, 저장 매체 상에 저장되는 메이저 분할 마스크 및 마이너 분할 마스크로부터 인공 분할 마스크의 세트를 생성하도록 하나 이상의 프로세서(들)를 구성하는 프 로그램 코드 명령의 세트를 포함한다. 각각의 인공 분할 마스크는 메이저 분할 마스크의 관심 해부학적 구조의 분할과 마이너 분할 마스크의 이상의 분할을 결합시킴으로써 생성된다. 특정 실시예에서, 장치는 단독으로 또는 모든 기술적으로 가능한 조합에 따라 채택되는 하기 특징(들) 중 하나 이상을 추가로 포함할 수 있다. 특정 실시예에서, 인공 분할 마스크를 생성하기 위해, 하나 이상의 프로세서(들)는 또한 마이너 분할 마스크의 이상의 분할을 변환하도록 구성된다. 특정 실시예에서, 이상의 분할의 변환은 이상의 분할의 회전, 확대, 축소, 변형, 또는 이동에 해당한다. 특정 실시예에서, 인공 분할 마스크를 생성하기 위해, 하나 이상의 프로세서(들)는 또한 관심 해부학적 구조의 분할에 대한 이상의 분할이 특정 기준을 충족함을 확인하도록 구성된다. 특정 실시예에서, 분할 마스크는 복셀의 세트를 포함한다. 각각의 복셀은 분할 마스크와 관련이 있는 실제 의료 영상의 구역에 해당한다. 각각의 복셀은 실제 의료 영상에서 상기 구역에 의해 보이는 것을 인코딩한 수치값과 관련이 있다. 인공 분할 마스크를 생성하기 위해, 하나 이상의 프로세서(들)는 - 메이저 분할 마스크 및 마이너 분할 마스크를 선택하고; - 선택된 마이너 분할 마스크 상에서, 이상을 인코딩한 수치값을 갖는 복셀의 세트를 식별하고; - 선택된 메이저 분할 마스크 상에서, 식별된 복셀의 수치값을 이상을 인코딩한 수치값으로 대체하도록 구성된 다. 특정 실시예에서, 저장 매체는 또한 분할 마스크로부터 합성 의료 영상을 생성하도록 사전 훈련된 신경망을 저 장하고, 프로그램이 실행될 때, 하나 이상의 프로세서(들)는 신경망으로 인공 분할 마스크로부터 합성 의료 영 상을 생성하도록 구성된다. 특정 실시예에서, 합성 의료 영상을 생성하기 위한 신경망은 판별기 신경망을 사용하여 훈련되도록 구성되는 생 성기 신경망이고, 생성기 신경망 및 판별기 신경망에 의해 형성되는 쌍은 한 쌍의 생성적 적대 신경망을 형성한 다."}
{"patent_id": "10-2023-7034644", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "item": 1, "content": "도 1은 관심 해부학적 구조 내의 이상을 나타내는 합성 의료 영상을 생성하는 본 발명에 따른 방법의 주요 단계들을 개략적으로 도시한다. 본 설명의 나머지 부분 전체에 걸쳐, 관심 해부학적 구조는 비제한적 예시의 차원에서 간으로 간주될 것이고, 이상은 종양으로 간주될 것이다. 그러나, 방법은 예를 들어 폐, 신장, 뼈, 혈관 등과 같은 다른 관심 해부학적 구조에 적용될 수 있음을 주목해야 한다. 게다가, 방법은 예를 들어 종양, 낭종, 절제 구역, 동맥류 등과 같은 다른 유형의 이상에 적용될 수 있다. 방법은 메이저 분할 마스크를 생성하는 단계를 포함한다. 각각의 메이저 분할 마스크는 환자의 관심 해부학적 구조를 나타내는 메이저 실제 의료 영상과 관련이 있고, 이 경우 상기 관심 해부학적 구조는 이상을 나타내지 않는다. 본 설명의 나머지 부분 전체에 걸쳐, 실제 의료 영상은 단층밀도계측 촬상 장치에 의해 획득되는 2차원 영상으 로 간주된다. 그러나, 변형예에서, 예를 들어 자기 공명, 양전자 방출 단층촬영, 초음파, 또는 엑스레이와 같은 다른 촬상 모드를 사용하여 획득되는 실제 의료 영상 또는 3차원 실제 의료 영상의 사용이 가능하다. 방법은 또한 마이너 분할 마스크를 생성하는 단계를 포함한다. 각각의 마이너 분할 마스크는 환자의 관심 해부학적 구조를 나타내는 마이너 실제 의료 영상과 관련이 있고, 이 경우 상기 관심 해부학적 구조는 이 상을 나타낸다. 단계들(101, 102)의 순서가 중요하지 않음을 주목해야 한다. 게다가, 방법은 선택적으로 실제 의료 영상의 크기를 축소하는 선행 단계를 포함할 수 있다. 예를 들어, 의료 영상은 (2차원 영상인 경우) 128 x 128 픽셀의 크기로 축소될 수 있고, 분할 마스크를 생성하기 위해 사용되기 전에 관심 해부학적 구조의 중앙에 놓일 수 있 다.방법은 분할 마스크로부터 합성 의료 영상을 생성하기 위한 신경망을 훈련하는 단계를 포함한다. 신경망을 훈련하기 위해, 예를 들어 단계에서 생성된 메이저 분할 마스크 및/또는 단계에서 생성된 마이너 분할 마스크가 사용될 수 있다. 그러나, 다른 분할 마스크가 또한 사용될 수 있다. 본 설명의 나머지 부분 전체에 걸쳐, 분할 마스크로부터 합성 의료 영상을 생성하기 위해 사용되는 신경망은 한 쌍의 생성적 적대 신경망(GAN)의 생성기로 간주된다. 그러나, 예를 들어 오토인코더(VAE)형 신경망과 같은 다른 유형의 신경망을 사용하는 것도 가능함을 주목해야 한다. 분할 마스크로부터 합성 의료 영상을 생성하기 위한 특정 유형의 신경망의 선택은 본 발명의 하나의 변형예에 불과하다. 방법은 메이저 분할 마스크 및 마이너 분할 마스크로부터 인공 분할 마스크를 생성하는 단계를 포함 한다. 인공 분할 마스크의 생성은 메이저 분할 마스크의 관심 해부학적 구조의 분할과 마이너 분할 마스크 의 관심 이상의 분할을 결합시키는 것에 기반한다. 단계들(103, 104)은 서로 독립적이며 이들의 실행 순서는 중요하지 않음을 주목해야 한다. 마지막으로, 방법은 사전 훈련된 신경망을 사용하여 인공 분할 마스크로부터 합성 의료 영상을 생성하는 단계를 포함한다. 단계들(101~105)은 도 4 내지 도 12를 참조하여 이하에 설명될 것이다. 도 2는 실제 의료 영상에서 환자의 관심 해부학적 구조 내의 이상을 검출하거나 특성화하는 것을 목표로 하는 기계 학습 알고리즘을 훈련하는 본 발명에 따른 방법의 주요 단계들을 개략적으로 도시한다. 방법은 특히 관심 해부학적 구조 및 상기 관심 해부학적 구조 내의 이상을 나타내는 합성 의료 영상을 생 성하는 단계를 포함한다. 합성 의료 영상의 생성은 도 1을 참조하여 상기에 설명된 방법을 사용 하여 구현된다. 방법은 이어서 단계에서 생성된 합성 의료 영상을 포함하는 훈련 영상의 세트를 사용하여 기계 학습 알고리즘을 훈련하는 단계를 포함한다. 기계 학습 알고리즘은 예를 들어 심층 신경망에 해당한다. 그러나, 예를 들어 \"랜덤 포레스트\" 알고리즘과 같은 다른 유형의 기계 학습 알고리즘의 사용이 가능하다. 기계 학습 알고리즘은 예를 들어 이상의 성질(종양의 유형)을 식별하는 것을 가능하게 하는 분류 알고리즘에 해 당한다. 다른 예에 따르면, 기계 학습 알고리즘은 의료 영상에서 이상의 윤곽을 획정하는 것을 가능하게 하는 분할 알고리즘에 해당한다. 훈련 영상의 세트는 실제 의료 영상과 합성 의료 영상을 모두 포함할 수 있다. 하나의 이상 및 다양한 이상을 나타내는 의료 영상의 수는 합성 의료 영상을 생성하기 위해 사용되는 다양한 인공 분할 마스크로 인해 상당히 증가된다. 바람직하게는, 이상이 있는 영상의 수는 이상이 없는 영상의 수의 적어도 10%와 같다. 이상적으로는, 훈련 영상의 세트는 이상이 없는 영상의 수와 실질적으로 같은 수의 이상이 있는 영상을 포함한다. 따라서, 이 는 특정 클래스의 이상에 대한 과잉 학습 현상을 방지하는 것을 가능하게 한다. 기계 학습 알고리즘을 훈련하는 단계는 도 13을 참조하여 이하에 설명될 것이다. 도 3은 실제 의료 영상에서 환자의 관심 해부학적 구조 내의 이상을 검출하거나 특성화하는 본 발명에 따른 방 법의 주요 단계들을 개략적으로 도시한다. 방법은 특히 실제 의료 영상에서 환자의 관심 해부학적 구조 내의 이상을 검출하거나 특성화하는 것을 목 표로 하는 기계 학습 알고리즘을 훈련하는 단계를 포함한다. 이러한 훈련 단계는 도 2를 참조하여 상 기에 설명된 방법을 사용하여 구현된다. 방법은 이어서 연속적으로 환자의 관심 해부학적 구조의 실제 의료 영상을 수신하는 단계, 훈련된 기 계 학습 알고리즘으로 상기 실제 의료 영상을 분석하는 단계, 및 훈련된 기계 학습 알고리즘의 출력으로서, 실제 의료 영상에서 보이는 관심 해부학적 구조 내의 이상의 검출 또는 특성화를 가능하게 하는 정 보를 획득하는 단계를 포함한다. 도 4는 메이저 실제 의료 영상으로부터 메이저 분할 마스크를 생성하는 단계를 개략적으로 도시한 다. 관심 해부학적 구조가 메이저 실제 의료 영상에서 보인다. \"메이저\" 영상으로 지칭되는 실제 의료 영상에는, 관심 해부학적 구조 내에 이상이 없다. 메이저 분할 마스크는 관심 해부학적 구조의 분할을 포함한다. 도 5는 마이너 실제 의료 영상으로부터 마이너 분할 마스크를 생성하는 단계를 개략적으로 도시한 다. 관심 해부학적 구조가 마이너 실제 의료 영상에서 보인다. \"마이너\" 영상으로 지칭되는 실제 의료 영상에는, 관심 해부학적 구조 내에 이상이 존재한다. 마이너 분할 마스크는 관심 해부학적 구조의 분할 및 이상의 분할을 포함한다. 의료 촬상시, 분할은 영상으로부터 하나 이상의 특정 해부학적 영역(들)을 추출하는 것을 수반하는 필수 단계이 다. 분할 마스크는, 각각의 복셀(또는 2차원 영상의 경우 픽셀)이 실제 의료 영상에서 복셀의 위치에 보이는 요 소에 관한 특정 정보를 제공하는, 영상이다. 따라서, 복셀은 실제 의료 영상에서 복셀의 위치에 보이는 요소와 관련이 있는 특정 수치값을 취할 수 있다. 예를 들어, 관심 해부학적 구조의 건강한 부분, 관심 해부학적 구조 내의 이상, 기타 해부학적 구조물(예를 들어, 뼈, 혈관), 영상의 배경 등에 대해, 상이한 구체적인 수치가 각각 획정된다. 분할은 수동으로 구현될 수 있다. 이 경우, 의사는 영상이 표시되는 전자 장치(컴퓨터, 태블릿 등)의 그래픽 인 터페이스(마우스, 스타일러스, 터치스크린 등)를 사용하여 의료 영상에서 다양한 해부학적 영역의 윤곽을 획정 한다. 분할은 또한 인공 지능 분할 알고리즘을 사용하여 자동으로 구현될 수 있다. 예를 들어, 의료 영상에서 보이는 뼈는 1800 HU의 폭 및 400 HU의 중심을 갖는 강도 윈도우를 이용한 복셀 강도 임계화 방법을 사용하여 분할된다(HU는 \"하운스필드 단위(Houndsfield Unit)\"의 약어로서, 전파 밀도를 묘사하 는 정량적 척도, 즉 전자파에 대한 재료의 불투명도를 나타내는 측정 단위이다). 도 6은 메이저 분할 마스크 및 마이너 분할 마스크로부터 인공 분할 마스크를 생성하는 단계 를 개략적으로 도시한다. 도 6에 도시된 예에서, 인공 분할 마스크를 생성하는 단계는 - 메이저 분할 마스크를 선택하는 것; - 마이너 분할 마스크를 선택하는 것; - 선택된 마이너 분할 마스크 상에서, 이상을 인코딩한 수치값을 갖는 복셀의 세트를 식별하는 것; - 선택된 메이저 분할 마스크 상에서, 식별된 복셀의 수치값을 이상을 인코딩한 수치값으로 대체하는 것을 포함한다. 메이저 분할 마스크 및 마이너 분할 마스크는 랜덤 선택될 수 있다. 따라서, 인공 분할 마스크의 조합 의 수는 메이저 분할 마스크의 수와 마이너 분할 마스크의 수의 곱에 이를 수 있다. 다양한 의미값(즉, 다양한 유형의 이상: 종양, 낭종, 절제 영역, 인공물 등)을 갖는 복수의 마이너 분할 마스크 가 메이저 분할 마스크와 결합될 수 있고, 그에 따라 잠재적인 조합의 수가 증가될 수 있다. 인공 분할 마스크의 조합에 사용되는 다양한 마이너 마스크의 비율의 조작은 생성되는 합성 영상의 특성을 제어하 는 것을 가능하게 한다. 마찬가지로, 다양한 의미값(즉, 간, 폐, 췌장, 담낭 등)을 갖는 복수의 메이저 마스크 가 마이너 분할 마스크와 결합될 수 있다. 이러한 다양한 메이저 마스크는 인공 분할 마스크의 각각의 픽셀에 대해 다양한 메이저 마스크와 마이너 마스크 사이의 부울 논리 규칙(예를 들어, \"AND\", \"OR\", \"NOT\"과 같은 규칙)으로 인해 마이너 분할 마스크가 어떤 기관 또는 구조물에 나타날 수 있는지 제어 하는 것을 가능하게 한다. 이러한 특징은 예를 들어 종양의 마이너 분할 마스크의 랜덤 분포가 어떤 기관에 나타날 수 있는지(\"AND\"), 및 이러한 마이너 분할 마스크가 어떤 기관 또는 구조물에 나타날 수 없는지 (\"NOT\") 제어하는 것을 가능하게 한다. 최대 관심 메이저 분할 마스크 및 마이너 분할 마스크의 조합은 또한 예를 들어 담낭, 혈관, 문부, 또 는 심지어 간 피박의 분할과 같은 메이저 분할 마스크의 관심 분할과 마이너 분할 마스크의 이상의 분 할 사이에 추정되는 거리의 함수로서 선택될 수 있다. 도 7에 도시된 바와 같이, 인공 분할 마스크를 생성하는 단계는 선택된 마이너 분할 마스크의 이 상의 분할의 변환을 포함할 수 있다. 이러한 배열은 더 많은 수의 상이한 인공 분할 마스크를 생성하는 것 을 가능하게 한다. 이상의 분할의 변환은 예를 들어 (인공 분할 마스크(23-1)에 대해 도시된 것과 같은) 회 전, (인공 분할 마스크(23-2)에 대해 도시된 것과 같은) 이동, (인공 분할 마스크(23-3)에 대해 도시된 것과 같 은) 확대, (인공 분할 마스크(23-4)에 대해 도시된 것과 같은) 축소, (인공 분할 마스크(23-5)에 대해 도시된것과 같은) 변형, 또는 (이상의 분할이 동등하게 이동, 축소, 및 회전된 인공 분할 마스크(23-6)에 대해 도 시된 것과 같은) 다양한 가능한 변환의 조합에 해당한다. 도 8은 메이저 분할 마스크 및 마이너 분할 마스크로부터의 인공 분할 마스크의 생성을 도시 한다. 관심 해부학적 구조의 분할(24-1)이 메이저 분할 마스크에서 확인될 수 있다. 관심 해부학적 구조의 분할(24-2) 및 이상의 분할(25-2)이 모두 마이너 분할 마스크에서 확인될 수 있다. 마이너 분할 마스크(2 2)의 이상의 분할(25-2)(고려된 예에서, 이상의 분할(25-2)이 또한 이동되었음)과 결합된 메이저 분할 마스크 의 관심 해부학적 구조의 분할(24-1)은 생성된 인공 분할 마스크에서 확인될 수 있다. 특정 실시예에서, 인공 분할 마스크의 생성은 관심 해부학적 구조의 분할(24-1)에 대한 이상의 분할 (25-2)이 특정 기준을 충족하는지 확인하는 단계를 추가로 포함할 수 있다. 이러한 추가적인 확인 단계는 소정의 특정 제약이 충족되는 것을 보장한다. 이는 특히 소정의 비사실적인 조합 을 필터링하는 것을 가능하게 할 수 있다. 이러한 제약은 예를 들어 관심 기관 내의 또는 다른 기관 또는 다른 해부학적 구조물에 대한 이상의 위치와 관련이 있다. 따라서, 예시의 차원에서, 기준은 관심 해부학적 구조의 분할의 에지와 이상의 분할의 에지 사이의 거리가 적어도 임계값과 같아야 한다는 점에 해당할 수 있다. 그러나, 이는 목표한 응용에 따라 좌우된다: 기관 내의 종양의 영상을 합성하고자 하는 경우, 이상이 기관 내에 위치되는 것을 보장하게 될 것이다; 그러나, 다양한 기관 내에 종양이 있는 영상을 합성하고자 하는 경우, 종양 의 분할과 다양한 기관의 분할의 중첩이 승인될 것이다. 이러한 인공 분할 마스크의 생성은 예를 들어 컴퓨터와 같은 전자 장치에 의해 구현될 수 있다. 장치 는 예를 들어 하나 이상의 프로세서(들) 및 하나 이상의 프로세서(들)에 의해 판독될 수 있는 하나 이상의 저장 매체를 포함한다. 저장 매체는 메이저 분할 마스크 및 마이너 분할 마스크를 저장하도록 의도된다. 저 장 매체는, 프로그램이 하나 이상의 프로세서(들)에 의해 실행될 때, 도 6 내지 도 8을 참조하여 상기에 설명된 바와 같이, 저장 매체 상에 저장되는 메이저 분할 마스크 및 마이너 분할 마스크로부터 인공 분할 마스 크의 세트를 생성하도록 하나 이상의 프로세서(들)를 구성하는 프로그램 코드 명령의 세트를 추가로 포함한 다. 도 9는 분할 마스크로부터 합성 의료 영상을 생성하도록 신경망을 훈련하는 단계를 개략적으 로 도시한다. 고려된 예에서, 합성 의료 영상을 생성하기 위해 사용되는 신경망은 생성기 신경망이고, 생성기 신 경망의 훈련은 판별기 신경망을 사용하여 구현된다. 생성기 신경망 및 판별기 신경망은 한 쌍 의 생성적 적대 신경망(GAN)을 형성한다. GAN형 신경망은 실제로 매우 사실적인 영상을 생성하는 것을 가능하게 한다. GAN에서, 생성기 신경망 및 판별기 신경망은 제로섬 게임 시나리오로 경쟁하도록 설정된다. 생성기는 영 상을 생성하고, 이의 상대인 판별기는 생성된 영상이 실제 영상인지 또는 생성기에 의해 생성되는 합성 영상인 지 검출하려 시도한다. 먼저, 생성기는 분할 마스크로부터 합성 영상을 생성하도록 훈련된다. 생성기의 입력부에서 분할 마스크는 동등하게 (도 9에 도시된 예에서와 같은) 마이너 분할 마스크 또는 메이저 분할 마스크일 수 있다. 다음으로, 생성기에 의해 생성되는 합성 영상은 판별기에 의해 분석되는데, 이는 입력으로서 영상 및 관련 분할 마스크를 채택함으로써, 영상 및 분할 마스크에 의해 형성되는 쌍이 실제인지 인식하 도록 사전에 훈련되었다. 따라서, 판별기의 출력부에서, \"참(True)\" 또는 \"거짓(False)\" 결정이 내려지고, 그에 따라 영상 및 분할 마스크에 의해 형성되는 쌍은 실제 또는 거짓으로 간주된다. 역전파 루프 를 사용하여, 판별기에 의해 내려진 결정의 정확도의 함수로서, 생성기의 파라미터는 분할 마스크 와 관련하여 생성된 합성 영상이 판별기에 의해 실제로 간주될 때까지 수정된다. 생성기는 영상-영상 변환 신경망이다. 예를 들어, 이는 Isola, P 등에 의해 문헌[\"Image-to-Image translation with conditional adversarial networks\"]에 설명된 바와 같은 컨볼루션형 \"pix2pix\" 신경망이다. 고려된 예에서, 신경망은 64, 128, 256, 512, 512, 512, 512 크기의 4 x 4 컨볼루션 필터를 갖는 \"배치 정규화 리키 렐루(Batch Normalisation Leaky ReLU)\" 컨볼루션 층으로 구성되는 인코더 유형의 제1 부분, 및 512, 512, 512 크기의 4 x 4 컨볼루션 필터를 갖는 \"배치 정규화 드롭아웃 렐루(Batch Normalisation Dropout ReLU)\" 컨볼루션 층, 및 256, 128, 64 크기의 4 x 4 컨볼루션 필터를 갖는 \"배치 정규화 렐루(Batch Normalisation ReLU)\" 컨볼루션 층으로 구성되는 디코더 유형의 제2 부분을 포함한다. 인코더 부분 내의 영상크기 축소는 2의 픽셀 \"보폭(stride)\"에 의해 이루어지고, 디코더 부분 내의 영상의 크기 증가는 2 x 2의 크기 를 갖는 2D 확대층(\"Upsampling2D\", \"최근접 이웃(Nearest Neighbours)\" 방법)에 의해 이루어진다. 출력은 하 이퍼볼릭 탄젠트형 활성화층(Tanh)에 의해 생성된다. 판별기는 신경망이다. 예를 들어, 이는 입력으로서 단일 영상으로 연접되는 2개의 영상을 수용하도록 수정 된, Isola, P 등에 의해 문헌[\"Image-to-Image translation with conditional adversarial networks\"]에 설명 된 바와 같은 \"PatchGAN\"형 컨볼루션 신경망이다. 신경망의 나머지 부분은 64 크기의 4 x 4 컨볼루션 필터를 갖 는 1개의 \"리키 렐루(Leaky ReLU)\" 컨볼루션 층, 및 128, 256, 512, 512 크기의 4 x 4 컨볼루션 필터를 갖는 4 개의 \"배치 정규화 리키 렐루(Batch Normalisation Leaky ReLU)\" 컨볼루션 층으로 구성된다. 영상-영상 변환 생성기 신경망(31; \"pix2pix\")은, 생성기의 출력 예측(합성 의료 영상)이 PatchGAN형 판별기의 제2 입력을 형성하도록, 판별기와 결합된다. 판별기의 제1 입력은 생성기의 입력으로서 제공되는 분할 마스크에 해당한다. 출력은 70 x 70 확률 행렬이다. 판별기의 뉴런의 가중치는 생성기 의 훈련시 수정될 수 없다. 생성기의 가중치는 훈련 중에 업데이트될 수 있다. 비용 산출 함수는 1:100 의 비율로 교차-엔트로피 및 노름 1로 구성된다. 이어서, 판별기 및 생성기는 메이저 쌍(각각의 메이저 쌍은 메이저 의료 영상 및 관련 메이저 분할 마 스크를 포함함) 및 마이너 쌍(각각의 마이너 쌍은 마이너 의료 영상 및 관련 마이너 분할 마스크를 포함함)을 포함하는 훈련 세트에서 교번적으로 훈련된다. 판별기의 출력은, 입력이 \"참\" 쌍(즉, 분할 마스크 및 관련 실제 의료 영상을 포함하는 쌍)일 때 1 값, 및 입력이 \"거짓\" 쌍(즉, 분할 마스크 및 생성기에 의해 분할 마스크로부터 생성되는 합성 의료 영상을 포함하는 쌍)일 때 0 값의 70 x 70 행렬에 대해, 아담형 확률적 경사 알고리즘(적응적 모멘트 추정, beta_1:0.9, beta_02:0. 999, epsilon: 1e-08)을 사용하여 최적화된다. 생성기 의 출력은 1 값의 70 x 70 행렬에 대해 아담형 확률적 경사 알고리즘을 사용하여 최적화되고, 그에 따라 생 성기의 뉴런의 가중치는 업데이트되지만, 판별기가 입력 쌍이 이미 마주친 \"참\" 쌍에 충분히 가깝지 않 음을 검출할 때, 판별기의 뉴런의 가중치는 업데이트되지 않는다. 대안적으로, 판별기의 가중치의 업데 이트는 판별기가 생성기보다 앞서는 것을 가능하게 하고, 판별기가 자체 업데이트하도록 강제한다. 독립 신경망이 적대 신경망들(31, 32)의 훈련을 제어하기 위해 사용될 수 있다. 예를 들어, 생성기에 의해 생성되는 합성 영상과 실제 영상을 비교하기 위해, 사전 훈련된 \"InceptionV3\" 모델이 최종 분류층이 제거된 후에 사용될 수 있다(\"InceptionV3\"는 영상 분석을 보조하기 위한 컨볼루션 신경망이다). 2개의 영상에 의해 모델의 출력으로서 생성되는 활성화 값이 FID(\"프레쳇 인셉션 거리(Frechet Inception Distance)\"의 약어) 점수를 산출하기 위해 사용된다. 이 점수가 낮을수록, 영상이 더 유사하다. 새로운 FID 점수가 사전 기록된 점 수보다 낮아지는 즉시 생성기의 가중치가 저장된다. 훈련은 FID 점수가 훈련 중에 획득되는 최소치에 비해 너무 커질 때 중단된다. 도 10은 실제 의료 영상(11, 12), 관련 분할 마스크(21, 22), 및 (이상이 없는) 메이저 사례 및 (이상이 있는) 마이너 사례에 대해, 신경망에 의해 분할 마스크(21, 22)로부터 생성되는 합성 의료 영상을 도시한다. 신경망의 훈련이 완료되면, 도 11에 도시된 바와 같이, 훈련된 신경망(31')이 인공 분할 마스크로부터 합성 의료 영상을 생성하기 위해 사용될 수 있다. 인공 분할 마스크를 생성하는 단계를 구현하는 장치는 또한 합성 의료 영상을 생성하는 단계(10 5)를 구현할 수 있다. 이 경우, 장치의 저장 매체는 사전 훈련된 생성기 신경망(31')을 저장하고, 프로그램이 실행될 때, 장치의 하나 이상의 프로세서(들)는 신경망(31')으로 인공 분할 마스크로부터 합성 의료 영상 을 생성하도록 구성된다. 도 12는 예시의 차원에서, 3개의 상이한 메이저 실제 의료 영상에 대해, 메이저 실제 의료 영상, 관련 메이저 분할 마스크, 메이저 분할 마스크로부터 생성되는 인공 분할 마스크, 및 신경망(31')에 의해 인 공 분할 마스크로부터 생성되는 합성 의료 영상을 도시한다. 단계에서 생성된 다양한 인공 분할 마스크로 인해, 이상을 나타내는 다양한 합성 의료 영상이 생 성될 수 있다. 이러한 합성 의료 영상의 다양성은 훈련 영상의 세트를 생성하는 것을 가능하게 하고, 이는 실제 의료 영상에서 환자의 관심 해부학적 구조 내의 이상을 검출하거나 특성화하는 것을 목표로 하는 기계 학 습 알고리즘에 특히 효과적이다. 훈련 영상의 세트는 실제 의료 영상과 합성 의료 영상을 모두 포함할 수 있다. 바람직하게는, 훈련 영상의 세트는 이상이 없는 영상의 수와 실질적으로 같은 수의 이상이 있는 영상을 포함한 다. 따라서, 이는 특정 클래스의 이상에 대한 과잉 학습 현상을 방지한다.도 13은 합성 의료 영상으로부터 기계 학습 알고리즘을 훈련하는 단계를 개략적으로 도시한다. 기 계 학습 알고리즘은 의료 영상에서 환자의 관심 해부학적 구조 내의 이상을 검출하거나 특성화하는 것을 목 표로 한다. 고려된 예에서, 기계 학습 알고리즘은 심층 신경망이다. 도 13에 도시된 바와 같이, 훈련 과정 중에, 기계 학습 알고리즘은 입력으로서 의료 영상을 채택한다(이는 도 13에 도시된 예에서 합성 의료 영상이다). 기계 학습 알고리즘의 출력으로서 획득되어야 하는 정보 는 선험적으로 알려져 있다(\"예상 정보\"). 획득 정보와 예상 정보가 비교되고, 비교 결과에 따라 신경망의 파라 미터가 역전파 루프에 의해 업데이트된다. 훈련은 기계 학습 알고리즘이 만족스러운 성공률을 갖는 예 상 정보를 제공할 수 있을 때까지 계속된다. 도 14는 그렇게 훈련된 기계 학습 알고리즘(40')에 의한 실제 의료 영상에서 보이는 관심 해부학적 구조 내의 이상의 검출 또는 특성화를 개략적으로 도시한다. 기계 학습 알고리즘(40')의 출력으로서 공급되 는 정보는 예를 들어 이상이 검출되었다는 표시, 이상의 분류(예를 들어, 종양의 성질), 및/또는 의료 영상(1 2)에서의 이상의 분할에 해당한다. 하나의 대안적인 작동 모드에서, 신경망은 기계 학습 알고리즘이 훈련되는 것과 동시에 훈련된다. 이러 한 작동 모드에서, 신경망은 결코 훈련을 중단하지 않으며, 합성 영상은 신경망에 의해 생성되고, 중간 저장 단계 없이 규칙적인 간격으로 기계 학습 알고리즘에 의해 사용된다. 각각의 합성 영상 배치(batch)가 다양한 훈련 단계에서 신경망에 의해 생성되므로, 주어진 인공 분할 마스크가 상이한 합성 영상을 생성 할 것이다. 이런 방식의 작동은 기계 학습 알고리즘을 위해 신경망에 의해 생성되는 영상의 무한한 가 변성을 가능하게 한다. 이러한 특징은, 알고리즘이 훈련 중에 동일한 합성 영상을 두 번 사용하지 않을 것이므 로, 훈련 데이터에 대한 기계 학습 알고리즘에 의한 과적합을 제한하기 때문에 중요하다."}
{"patent_id": "10-2023-7034644", "section": "도면", "subsection": "도면설명", "item": 1, "content": "본 발명은 도 1 내지 도 14를 참조하여 단지 비제한적 예시의 차원에서 제공되는 후술하는 설명을 숙독함으로써 더 잘 이해될 것이다. 도 1은 해부학적 이상을 나타내는 합성 의료 영상을 생성하는 본 발명에 따른 방법의 주요 단계들의 개략도이다.도 2는 실제 의료 영상에서 환자의 관심 해부학적 구조 내의 이상을 검출하거나 특성화하는 것을 목표로 하는 기계 학습 알고리즘을 훈련하는 본 발명에 따른 방법의 주요 단계들의 개략도이다. 도 3은 실제 의료 영상에서 환자의 관심 해부학적 구조 내의 이상을 검출하거나 특성화하는 본 발명에 따른 방 법의 주요 단계들의 개략도이다. 도 4는 메이저 실제 의료 영상으로부터 메이저 분할 마스크를 생성하는 단계의 개략도이다. 도 5는 마이너 실제 의료 영상으로부터 마이너 분할 마스크를 생성하는 단계의 개략도이다. 도 6은 메이저 분할 마스크 및 마이너 분할 마스크로부터 인공 분할 마스크를 생성하는 단계의 개략도이다. 도 7은 이상의 분할의 변환을 포함하는 인공 분할 마스크를 생성하는 단계의 개략도이다. 도 8은 메이저 분할 마스크 및 마이너 분할 마스크로부터의 인공 분할 마스크의 생성을 도시한다. 도 9는 분할 마스크로부터 합성 의료 영상을 생성하도록 신경망을 훈련하는 단계의 개략도이다. 도 10은 실제 의료 영상, 관련 분할 마스크, 및 (이상이 없는) 메이저 사례 및 (이상이 있는) 마이너 사례에 대 해, 신경망에 의해 분할 마스크로부터 생성되는 합성 의료 영상을 도시한다. 도 11은 사전 훈련된 신경망을 사용하여 인공 분할 마스크로부터 합성 의료 영상을 생성하는 단계의 개략도이다. 도 12는 3개의 상이한 메이저 실제 의료 영상에 대해, 메이저 실제 의료 영상, 관련 메이저 분할 마스크, 메이 저 분할 마스크 및 마이너 분할 마스크로부터 생성되는 인공 분할 마스크, 및 신경망에 의해 인공 분할 마스크 로부터 생성되는 합성 의료 영상을 도시한다. 도 13은 합성 의료 영상으로부터 기계 학습 알고리즘을 훈련하는 단계의 개략도이다. 도 14는 기계 학습 알고리즘에 의한 실제 의료 영상에서 보이는 관심 해부학적 구조 내의 이상의 검출 또는 특 성화의 개략도이다. 이들 도면 전체에 걸쳐, 도면들 간의 동일한 참조번호는 동일 또는 유사한 요소를 가리킨다. 명료함을 위해, 달 리 명시되지 않는 한, 도시된 요소들이 반드시 동일한 축척으로 그려진 것은 아니다."}
