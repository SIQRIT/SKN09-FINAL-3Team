{"patent_id": "10-2020-0101660", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2022-0021171", "출원번호": "10-2020-0101660", "발명의 명칭": "안저 이미지를 이용한 심층 신경망 기반 안구질환 진단 장치 및 방법", "출원인": "순천향대학교 산학협력단", "발명자": "남윤영"}}
{"patent_id": "10-2020-0101660", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "적어도 둘 이상의 안구질환 각각에 대한 다수의 안저 이미지 및 각 안저 이미지별 해당 안구질환에 대한 전문가의 주석을 포함하는 학습 데이터세트를 획득하여 출력하는 안저 이미지 획득부;심층 신경망 인공지능 모델을 포함하여 상기 안저 이미지 획득부로부터 입력되는 학습 데이터세트를 상기 심층신경망(DNN) 인공지능 모델에 적용하여 학습시켜 당뇨병 망막증, 연령 관련 황반변성, 녹내장 및 정상에 대해학습된 심층 신경망 인공지능 모델을 출력하는 심층 학습부;진단할 진단 대상 안저 이미지를 획득하여 출력하는 진단 이미지 획득부; 및상기 심층 신경망 인공지능 모델을 입력받아 구동하고 있으며, 상기 진단 대상 안저 이미지를 상기 심층 신경망인공지능 모델에 적용하여 상기 진단 대상 안저 이미지에 안구질환이 존재하는지의 여부 및 안구질환 존재 시해당 안구질환 진단 결과를 출력하는 안구질환 진단부를 포함하는 것을 특징으로 하는 안저 이미지를 이용한 심층 신경망 기반 안구질환 진단 장치."}
{"patent_id": "10-2020-0101660", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 학습 데이터세트는,당뇨병 망막증을 가지는 다수의 안저 이미지 및 상기 당뇨병 망막증에 대한 주석을 가지는 당뇨병 망막증 학습데이터, 연령 관련 황반변성(AMD)를 가지는 안저 이미지 및 상기 연령 관련 황반변성에 대한 주석을 가지는 연령 관련 황반변성 학습 데이터 및 녹내장을 가지는 안저 이미지, 상기 녹내장에 대한 주석을 가지는 녹내장 학습 데이터 및 정상 안저 이미지를 포함하는 정상 학습 데이터를 포함하는 것을 특징으로 하는 안저 이미지를 이용한 심층 신경망 기반 안구질환 진단 장치."}
{"patent_id": "10-2020-0101660", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제2항에 있어서,상기 학습 데이터세트의 안저 이미지 및 상기 진단 대상 안저 이미지의 크기 및 수를 조절하는 이미지 전처리를수행하여 출력하는 이미지 전처리부를 더 포함하는 것을 특징으로 하는 안저 이미지를 이용한 심층 신경망 기반안구질환 진단 장치."}
{"patent_id": "10-2020-0101660", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제3항에 있어서,상기 이미지 전처리부는,상기 학습 데이터세트의 안저 이미지 및 상기 평가 대상 안저 이미지에서 관심영역을 추출하여 크기를 조절하는관심영역 획득부; 및상기 관심영역 획득부로부터 출력되는 안저 이미지의 적어도 하나 이상의 파라미터를 조절하여 상기 안저 이미지에 대한 이미지 수를 증강하는 이미지 증강부를 포함하는 것을 특징으로 하는 안저 이미지를 이용한 심층 신경망 기반 안구질환 진단장치.공개특허 10-2022-0021171-3-청구항 5 제4항에 있어서,상기 관심영역 획득부는,상기 안저 이미지의 적색 채널 및 청색 채널의 안저 이미지를 추출하는 채널 선택부;상기 적색 채널 및 청색 채널을 포함하는 안저 이미지를 관심영역만을 포함하는 크기로 조절하여 출력하는 크기조절부; 및상기 크기 조절된 안저 이미지 대조 제한 적응 히스토그램 등화를 적용하여 출력하는 대조 제한 적응 히스토그램 등화부를 포함하는 것을 특징으로 하는 안저 이미지를 이용한 심층 신경망 기반 안구질환 진단장치."}
{"patent_id": "10-2020-0101660", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제5항에 있어서,상기 이미지 전처리에 의해 생성된 학습 데이터세트를 학습 세트와 검증 세트로 나눈 후 상기 학습된 상기 심층신경망 인공지능 모델에 대해 상기 검증 세트에 의해 K-fold 교차 검증을 수행하여 검증결과를 출력하는 검증부를 더 포함하는 것을 특징으로 하는 안저 이미지를 이용한 심층 신경망 기반 안구질환 진단장치."}
{"patent_id": "10-2020-0101660", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "안저 이미지 획득부가 적어도 둘 이상의 안구질환 각각에 대한 다수의 안저 이미지 및 각 안저 이미지별 해당안구질환에 대한 전문가의 주석을 포함하는 학습 데이터세트를 획득하여 출력하는 안저 이미지 획득 과정;심층 학습부가 심층 신경망 인공지능 모델을 포함하여 상기 안저 이미지 획득부로부터 입력되는 학습 데이터세트를 상기 심층 신경망(DNN) 인공지능 모델에 적용하여 학습시켜 당뇨병 망막증, 연령 관련 황반변성, 녹내장및 정상에 대해 학습된 심층 신경망 인공지능 모델을 출력하는 심층 학습 과정;진단 이미지 획득부가 진단할 진단 대상 안저 이미지를 획득하여 출력하는 진단 이미지 획득 과정; 및안구질환 진단부가 상기 심층 신경망 인공지능 모델을 입력받아 구동하고 있으며, 상기 진단 대상 안저 이미지를 상기 심층 신경망 인공지능 모델에 적용하여 상기 진단 대상 안저 이미지에 안구질환이 존재하는지의 여부및 안구질환 존재 시 해당 안구질환 진단 결과를 출력하는 안구질환 진단 과정을 포함하는 것을 특징으로 하는안저 이미지를 이용한 심층 신경망 기반 안구질환 진단 방법."}
{"patent_id": "10-2020-0101660", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제7항에 있어서,상기 학습 데이터세트는,당뇨병 망막증을 가지는 다수의 안저 이미지 및 상기 당뇨병 망막증에 대한 주석을 가지는 당뇨병 망막증 학습데이터, 연령 관련 황반변성(AMD)를 가지는 안저 이미지 및 상기 연령 관련 황반변성에 대한 주석을 가지는 연령 관련 황반변성 학습 데이터 및 녹내장을 가지는 안저 이미지, 상기 녹내장에 대한 주석을 가지는 녹내장 학습 데이터 및 정상 안저 이미지를 포함하는 정상 학습 데이터를 포함하는 것을 특징으로 하는 안저 이미지를 이용한 심층 신경망 기반 안구질환 진단 방법."}
{"patent_id": "10-2020-0101660", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제8항에 있어서,이미지 전처리부가 상기 학습 데이터세트의 안저 이미지 및 상기 진단 대상 안저 이미지의 크기 및 수를 조절하공개특허 10-2022-0021171-4-는 이미지 전처리를 수행하여 출력하는 이미지 전처리 과정을 더 포함하는 것을 특징으로 하는 안저 이미지를이용한 심층 신경망 기반 안구질환 진단 방법."}
{"patent_id": "10-2020-0101660", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제9항에 있어서,상기 이미지 전처리 과정은,상기 이미지 전처리부가 관심영역 획득부를 통해 상기 학습 데이터세트의 안저 이미지 및 상기 평가 대상 안저이미지에서 관심영역을 추출하여 크기를 조절하는 관심영역 획득 단계; 및상기 이미지 전처리부가 이미지 증강부를 통해 상기 관심영역 획득부로부터 출력되는 안저 이미지의 적어도 하나 이상의 파라미터를 조절하여 상기 안저 이미지에 대한 이미지 수를 증강하는 이미지 증강 단계를 포함하는것을 특징으로 하는 안저 이미지를 이용한 심층 신경망 기반 안구질환 진단 방법."}
{"patent_id": "10-2020-0101660", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "제10항에 있어서,상기 관심영역 획득 단계는,상기 안저 이미지의 적색 채널 및 청색 채널의 안저 이미지를 추출하는 채널 선택 단계;상기 적색 채널 및 청색 채널을 포함하는 안저 이미지를 관심영역만을 포함하는 크기로 조절하여 출력하는 크기조절 단계; 및상기 크기 조절된 안저 이미지 대조 제한 적응 히스토그램 등화를 적용하여 출력하는 대조 제한 적응 히스토그램 등화 단계를 포함하는 것을 특징으로 하는 안저 이미지를 이용한 심층 신경망 기반 안구질환 진단 방법."}
{"patent_id": "10-2020-0101660", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제11항에 있어서,검증부가 상기 이미지 전처리에 의해 생성된 학습 데이터세트를 학습 세트와 검증 세트로 나눈 후 상기 학습된상기 심층 신경망 인공지능 모델에 대해 상기 검증 세트에 의해 K-fold 교차 검증을 수행하여 검증결과를 출력하는 검증 과정을 더 포함하는 것을 특징으로 하는 안저 이미지를 이용한 심층 신경망 기반 안구질환 진단방법."}
{"patent_id": "10-2020-0101660", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 안저 이미지를 이용한 안구질환 진단 장치 및 방법에 관한 것으로, 더욱 상세하게는 관심영역 축소, 등광 평면 대조 제한 적응 히스토그램 등화 및 데이터 증강 등을 포함하는 이미지 전처리를 수행하여 학습 데이 터세트를 정규화하고, 심층 신경망을 적용하여 정상(Nomal), 녹내장(Glaucoma: GLC), 연령 관련 황반변성(Age related macular degeneration: AMD), 당뇨병 망막증(Diabetic Retinopathy: DR)을 포함하는 안구질환을 진단할 수 있는 안저 이미지를 이용한 심층 신경망 기반 안구질환 진단 장치 및 방법에 관한 것이다."}
{"patent_id": "10-2020-0101660", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 안저 이미지를 이용한 안구질환 진단 장치 및 방법에 관한 것으로, 더욱 상세하게는 관심영역(Region of Interest: ROI) 축소, 등광 평면 대조 제한 적응 히스토그램 등화 및 데이터 증강 등을 포함하는 이미지 전 처리를 수행하여 학습 데이터세트를 정규화하고, 심층 신경망을 적용하여 정상(Nomal), 녹내장(Glaucoma: GLC), 연령 관련 황반 변성(Age related macula degeneration: AMD), 당뇨병 망막증(Diabetic Retinopathy: DR)을 포 함하는 복수의 안구질환을 진단할 수 있는 안저 이미지를 이용한 심층 신경망 기반 안구질환 진단 장치 및 방법 에 관한 것이다."}
{"patent_id": "10-2020-0101660", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "당뇨병 망막증(Diabetic Retinopathy: DR), 녹내장(Glaucoma: GLC), 연령 관련 황반 변성(Age related macula degeneration: AMD)은 전 세계적으로 시력 상실과 실명을 일으키는 주요 원인이다. 당뇨병 망막증은 망막의 혈관 합병증으로, 망막에 손상을 입히고, 이로 인해 즉시 치료하지 않으면 심각한 시력 상실을 초래한다. 2000년부터 2030년까지 전 세계의 당뇨병 인구 증가율은 2.8%에서 4.4%로 추산되며, 이는 당뇨병으로 고통받는 환자가 약 1억7100만명에서 1억9500만명에 해당된다. 당뇨병 환자 중 2%의 실명과 향후 15년 동안 약 10%의 시 력 손실을 겪을 위험이 있다. 또한, 녹내장(GLC)은 시신경 헤드를 손상시키고 시력 손실을 일으키는 안구 내 차압의 영향으로 발생한다. 연령 관련 황반변성(AMD) 또한 60세 이상의 노인들에게 시력 손실과 실명의 원인을 제공하고 있으며, 60세 이상 의 노인들에게 큰 영향을 미치는 것으로 나타나고 있다. 이러한 수많은 환자는 인간의 5가지 기본 감각 중 하나인 시력 때문에 그들의 삶에서 어려움을 겪을 수 있을 것 이다. 전문가나 의사들이 상술한 안구질환들을 진단하는 방법으로는 다양한 기법들이 있으며, 이 기법들은 단면 이미 지 촬영인 광학적 일관성 단층촬영(OCT) 및 안저 이미지 촬영을 통해 촬영된 안저 이미지들을 이용하여 안구질 환을 판단한다. 또한, 안구질환의 빠른 진단 및 정확한 진단을 위해 DR, GLC, AMD 각각의 진단영역에 있어서 다양한 인공지능 모델들을 적용한 이미지 분류에 의한 안구질환 진단 장치들이 연구 및 개발되고 있다. 당뇨망막병증의 주기적인 스크리닝에 의한 조기 검출과 적절한 치료에 따라 당뇨망막병증에 의한 실명 위험을 50% 정도 감소시킬 수 있는 것으로 나타나고 있다. 통상적으로 안과질환을 진단하기 위해 광학적 일관성 단층촬영(Optical coherence tomography: OCT) 및 안저 이 미지 촬영 등을 수행하여 안저 이미지를 획득한다. 안저 이미지는 당뇨망막병증(Diabetic Retinopathy: DR), 녹내장(Glaucoma), 연령 관련 황반변성(Age-related maculas degeneration: AMD) 등의 많은 안과 질환들을 진단하고 검진하는 데 이용되고 있다. 따라서 안저 이미 지의 품질은 임상의가 올바른 검사 및 진단을 수행할 수 있는 능력에 영향을 줄 수 있다. 이와 같이 안저 이미지로부터 복수의 안과질환을 진단할 수 있음에도 불구하고, 종래 인공지능을 적용한 안과질 환 진단 장치는 안저 이미지로부터 특화된 하나의 안구질환만을 검출할 수 있었다. 즉, 종래 인공지능을 이용한 안구질환 진단 장치는 안저 이미지로부터 하나의 안구질환만을 검출하고, 둘 이상 의 안구질환을 검출할 수 없는 문제점이 있었다. 선행기술문헌 특허문헌 (특허문헌 0001) 대한민국 공개특허 제10-2020-0065923호(2020.06.09.공개)"}
{"patent_id": "10-2020-0101660", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "따라서 본 발명의 목적은 관심영역 축소, 등광 평면 대조 제한 적응 히스토그램 등화 및 데이터 증강 등을 포함 하는 이미지 전처리를 수행하여 학습 데이터세트를 정규화하고, 심층 신경망을 적용하여 정상(Nomal), 녹내장 (Glaucoma: GLC), 연령 관련 황반변성(Age related macular degeneration: AMD), 당뇨병 망막증(Diabetic Retinopathy: DR)을 포함하는 복수의 안구질환을 진단할 수 있는 안저 이미지를 이용한 심층 신경망 기반 안구 질환 진단 장치 및 방법을 제공함에 있다."}
{"patent_id": "10-2020-0101660", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "상기와 같은 목적을 달성하기 위한 본 발명에 따른 안저 이미지를 이용한 심층 신경망 기반 안구질환 진단 장치 는: 적어도 둘 이상의 안구질환 각각에 대한 다수의 안저 이미지 및 각 안저 이미지별 해당 안구질환에 대한 전 문가의 주석을 포함하는 학습 데이터세트를 획득하여 출력하는 안저 이미지 획득부; 심층 신경망 인공지능 모델 을 포함하여 상기 안저 이미지 획득부로부터 입력되는 학습 데이터세트를 상기 심층 신경망(DNN) 인공지능 모델에 적용하여 학습시켜 당뇨병 망막증, 연령 관련 황반변성, 녹내장 및 정상에 대해 학습된 심층 신경망 인공지 능 모델을 출력하는 심층 학습부; 진단할 진단 대상 안저 이미지를 획득하여 출력하는 진단 이미지 획득부; 및 상기 심층 신경망 인공지능 모델을 입력받아 구동하고 있으며, 상기 진단 대상 안저 이미지를 상기 심층 신경망 인공지능 모델에 적용하여 상기 진단 대상 안저 이미지에 안구질환이 존재하는지의 여부 및 안구질환 존재 시 해당 안구질환 진단 결과를 출력하는 안구질환 진단부를 포함하는 것을 특징으로 한다. 상기 학습 데이터세트는, 당뇨병 망막증을 가지는 다수의 안저 이미지 및 상기 당뇨병 망막증에 대한 주석을 가 지는 당뇨병 망막증 학습 데이터, 연령 관련 황반변성(AMD)를 가지는 안저 이미지 및 상기 연령 관련 황반변성 에 대한 주석을 가지는 연령 관련 황반변성 학습 데이터 및 녹내장을 가지는 안저 이미지, 상기 녹내장에 대한 주석을 가지는 녹내장 학습 데이터 및 정상 안저 이미지를 포함하는 정상 학습 데이터를 포함하는 것을 특징으 로 한다. 상기 장치는: 상기 학습 데이터세트의 안저 이미지 및 상기 진단 대상 안저 이미지의 크기 및 수를 조절하는 이 미지 전처리를 수행하여 출력하는 이미지 전처리부를 더 포함하는 것을 특징으로 한다. 상기 이미지 전처리부는, 상기 학습 데이터세트의 안저 이미지 및 상기 평가 대상 안저 이미지에서 관심영역을 추출하여 크기를 조절하는 관심영역 획득부; 및 상기 관심영역 획득부로부터 출력되는 안저 이미지의 적어도 하 나 이상의 파라미터를 조절하여 상기 안저 이미지에 대한 이미지 수를 증강하는 이미지 증강부를 포함하는 것을 특징으로 한다. 상기 관심영역 획득부는, 상기 안저 이미지의 적색 채널 및 청색 채널의 안저 이미지를 추출하는 채널 선택부; 상기 적색 채널 및 청색 채널을 포함하는 안저 이미지를 관심영역만을 포함하는 크기로 조절하여 출력하는 크기 조절부; 및 상기 크기 조절된 안저 이미지 대조 제한 적응 히스토그램 등화를 적용하여 출력하는 대조 제한 적 응 히스토그램 등화부를 포함하는 것을 특징으로 한다. 상기 장치는: 상기 이미지 전처리에 의해 생성된 학습 데이터세트를 학습 세트와 검증 세트로 나눈 후 상기 학 습된 상기 심층 신경망 인공지능 모델에 대해 상기 검증 세트에 의해 K-fold 교차 검증을 수행하여 검증결과를 출력하는 검증부를 더 포함하는 것을 특징으로 한다. 상기와 같은 목적을 달성하기 위한 본 발명에 따른 안저 이미지를 이용한 심층 신경망 기반 안구질환 진단 방법 은: 안저 이미지 획득부가 적어도 둘 이상의 안구질환 각각에 대한 다수의 안저 이미지 및 각 안저 이미지별 해 당 안구질환에 대한 전문가의 주석을 포함하는 학습 데이터세트를 획득하여 출력하는 안저 이미지 획득 과정; 심층 학습부가 심층 신경망 인공지능 모델을 포함하여 상기 안저 이미지 획득부로부터 입력되는 학습 데이터세 트를 상기 심층 신경망(DNN) 인공지능 모델에 적용하여 학습시켜 당뇨병 망막증, 연령 관련 황반변성, 녹내장 및 정상에 대해 학습된 심층 신경망 인공지능 모델을 출력하는 심층 학습 과정; 진단 이미지 획득부가 진단할 진단 대상 안저 이미지를 획득하여 출력하는 진단 이미지 획득 과정; 및 안구질환 진단부가 상기 심층 신경망 인공지능 모델을 입력받아 구동하고 있으며, 상기 진단 대상 안저 이미지를 상기 심층 신경망 인공지능 모델에 적용하여 상기 진단 대상 안저 이미지에 안구질환이 존재하는지의 여부 및 안구질환 존재 시 해당 안구질환 진 단 결과를 출력하는 안구질환 진단 과정을 포함하는 것을 특징으로 한다. 상기 학습 데이터세트는, 당뇨병 망막증을 가지는 다수의 안저 이미지 및 상기 당뇨병 망막증에 대한 주석을 가 지는 당뇨병 망막증 학습 데이터, 연령 관련 황반변성(AMD)를 가지는 안저 이미지 및 상기 연령 관련 황반변성 에 대한 주석을 가지는 연령 관련 황반변성 학습 데이터 및 녹내장을 가지는 안저 이미지, 상기 녹내장에 대한 주석을 가지는 녹내장 학습 데이터 및 정상 안저 이미지를 포함하는 정상 학습 데이터를 포함하는 것을 특징으 로 한다. 상기 방법은: 이미지 전처리부가 상기 학습 데이터세트의 안저 이미지 및 상기 진단 대상 안저 이미지의 크기 및 수를 조절하는 이미지 전처리를 수행하여 출력하는 이미지 전처리 과정을 더 포함하는 것을 특징으로 한다. 상기 이미지 전처리 과정은, 상기 이미지 전처리부가 관심영역 획득부를 통해 상기 학습 데이터세트의 안저 이 미지 및 상기 평가 대상 안저 이미지에서 관심영역을 추출하여 크기를 조절하는 관심영역 획득 단계; 및 상기 이미지 전처리부가 이미지 증강부를 통해 상기 관심영역 획득부로부터 출력되는 안저 이미지의 적어도 하나 이 상의 파라미터를 조절하여 상기 안저 이미지에 대한 이미지 수를 증강하는 이미지 증강 단계를 포함하는 것을 특징으로 한다. 상기 관심영역 획득 단계는, 상기 안저 이미지의 적색 채널 및 청색 채널의 안저 이미지를 추출하는 채널 선택 단계; 상기 적색 채널 및 청색 채널을 포함하는 안저 이미지를 관심영역만을 포함하는 크기로 조절하여 출력하는 크기 조절 단계; 및 상기 크기 조절된 안저 이미지 대조 제한 적응 히스토그램 등화를 적용하여 출력하는 대 조 제한 적응 히스토그램 등화 단계를 포함하는 것을 특징으로 한다. 상기 방법은: 검증부가 상기 이미지 전처리에 의해 생성된 학습 데이터세트를 학습 세트와 검증 세트로 나눈 후 상기 학습된 상기 심층 신경망 인공지능 모델에 대해 상기 검증 세트에 의해 K-fold 교차 검증을 수행하여 검증 결과를 출력하는 검증 과정을 더 포함하는 것을 특징으로 한다."}
{"patent_id": "10-2020-0101660", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명은 심층 신경망(Deep Neural Networks: DNN)을 적용하여 안저 이미지로부터 정상, 녹내장, 연결 관련 황 반변성, 당뇨병 망막증을 포함하는 안구질환을 학습시키므로, 안저 이미지로부터 둘 이상의 안구질환을 분류하 여 진단할 수 있는 효과가 있다. 또한, 본 발명은 대조 제한 적응 히스토그램 등화(CLAHE) 데이터 전처리를 적용하여 선형 누적분포함수(CDF)로 부터 가장 낮은 평균 절대 오차율을 극복할 수 있는 효과가 있다. 또한, 본 발명은 K-fold 교차 검증을 수행하므로 더 많은 수의 특징을 가진 모델에서 검증을 수행하므로 보다 향상된 검증결과를 제공하는 효과가 있다. 또한, 본 발명은 데이터 증강을 통해 가짜 이미지가 아닌 진짜 이미지의 수를 증가시켜 안구질환의 진단 정확도 를 향상시킬 수 있는 효과가 있다."}
{"patent_id": "10-2020-0101660", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하 첨부된 도면을 참조하여 본 발명에 따른 안저 이미지를 이용한 심층 신경망 기반 안구질환 진단장치의 구 성 및 동작을 상세히 설명하고, 상기 장치에서의 안저 이미지를 이용한 안구질환 진단 방법을 설명한다. 도 1은 본 발명에 따른 안저 이미지를 이용한 심층 신경망 기반 안구질환 진단 장치 및 방법의 구성을 나타낸 도면이고, 도 2는 본 발명에 따른 이미지 전처리를 수행한 안저 이미지를 나타낸 도면이며, 도 3은 본 발명에 따른 이미지 증강 이미지 전처리를 수행한 안저 이미지를 나타낸 도면이다. 이하 도 1 내지 도 3을 참조하여 설 명한다. 본 발명에 따른 안저 이미지를 이용한 심층 신경망 기반 안구질환 진단장치는 안저 이미지 획득부, 진단 이미지 획득부, 심층 학습부 및 안구질환 진단부를 포함하고, 실시예에 따라 이미지 전처리부 및 교차 검증부를 더 포함할 수 있을 것이다. 안저 이미지 획득부는 적어도 둘 이상의 안구질환 각각에 대한 다수의 안저 이미지 및 각 안저 이미지별 해당 안구질환에 대한 전문가의 주석을 포함하는 학습 데이터세트를 획득하여 출력한다. 본 발명에서는 다수의 정상 안저 이미지, 다수의 녹내장 안저 이미지, 다수의 연령 관련 황반변성 안저 이미지, 다수의 당뇨병 망막증 안저 이미지와 각 안저 이미지들에는 해당 안구질환에 대응하는 주석을 포함한다. 예를 들어, 본 발명에서는 총 2,335개의 안저 이미지가 획득되어 학습에 사용될 수 있으며, 상기 2,335개 중 정 상 안저 이미지는 1195, 녹내장 안저 이미지는 168, 연경 관련 황반변성 안저 이미지는 65, 당뇨병 망막증 안저 이미지는 907개를 포함할 수 있을 것이다. 각 안저 이미지는 전문가에 의해 기록된 주석정보를 포함할 것이다. 상기 안저 이미지는 ORIGA(-light)1, IDRID2, Messidor3, ARIA4, STARE5 등의 데이터베이스로부터 수집될 수 있을 것이다. 각 데이터베이스는 적어도 하나 이상의 특정 안구질환에 대한 안저 이미지들을 저장하여 관리한다. 진단 이미지 획득부는 안저 카메라 및 OCT 카메라로부터 진단할 대상의 안저 이미지인 진단 대상 안저 이 미지를 획득할 수도 있고, 저장수단으로부터 진단 대상 안저 이미지를 로드하여 획득할 수도 있으며, 통신수단 을 통해 진단 대상 안저 이미지를 수신받아 획득할 수도 있을 것이다. 이미지 전처리부는 상기 안저 이미지 획득부로부터 입력되는 학습 데이터세트의 안저 이미지를 이미 지 전처리하여 심층 학습부로 출력하거나, 상기 진단 이미지 획득부로부터 입력되는 진단 대상 안저 이미지를 이미지 전처리하여 안구질환 진단부로 출력한다. 상기 이미지 전처리부는 관심영역 획득부 및 이미지 증강부를 포함하고, 상기 관심영역 획득부 는 채널 선택부, 크기 조절부 및 대조 제한 적응 히스토그램 등화부를 포함한다. 관심영역 획득부는 안저 이미지로부터 관심영역만을 추출하여 출력한다. 구체적으로 채널 선택부는 하기 수학식 1에서 나타낸 바와 같이 25, 13의 임계값에 기반한 적색 채널 및 녹색 채널을 추출하여 전체 안저 이미지를 표준화하여 출력한다. 상기 녹색 채널은 보완적인 계층이다. 수학식 1"}
{"patent_id": "10-2020-0101660", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "여기서 imax는 이미지 폭이고, jmax는 이미지의 높이이다. 크기 조절부는 상기 추출된 채널의 안저 이미지를 384*384의 크기로 조절한다. 대조제한 적응 히스토그램 등화부는 상기 크기 조절부에서 크기 조절된 안저 이미지를 휘도 평면에서 히스토그램 등화를 수행한다. 상기 대조제한 적응 히스토그램 등화부는 휘도 평면에서 히스토그램 등화를 수행함으로써 선형 누적분포함수(CDF)로부터 가장 낮은 평균 절대 오차율을 극복할 수 있도록 한다. 관심영역 획득부는 도 2의 왼쪽의 원본 안저 이미지를 도 2의 가운데와 같이 관심영역만(ROI)을 추출하고, 도 2의 오른쪽과 같이 대조 제한 적응 히스토그램 등화(ISOL-CLAHE)를 수행하여 ROI만 추출된 안저 이미지의 품 질을 개선한다. 이미지 증강부는 상기 관심영역 획득부로부터 출력되는 안저 이미지의 적어도 하나 이상의 파라미터 를 조절하여 상기 안저 이미지에 대한 이미지 수를 증강하여 출력한다. 상기 이미지 증강은 가짜 이미지의 생성 없이, 안저 이미지의 크기(파라미터)를 20% 이내에서 확대하거나, 일정 각도(파라미터)로 회전하거나, 밝기(파라미터)를 25% 이내에서 변경하여 안저 이미지의 수를 증강한다. 예를 들면, 도 3과 같이 왼쪽이 원본 안저 이미지이고, 가운데 왼쪽이 원본 안저 이미지를 +25%의 밝기 조절과 80도 반 시계 방향으로 회전을 시킨 안저 이미지이며, 가운데 오른쪽이 원본 안저 이미지를 +25%의 밝기 조절, 20%의 줌아웃(축소), 수평 플립, 40도 반 시계 방향 회전 등을 수행한 이미지이며, 맨 오른쪽은 +25%의 밝기 조 절, 20%의 줌인(확대), 수평 플립을 수행한 증강 이미지이다. 이미지 증강은 AMD의 매우 작은 데이터세트 크기와 NR 및 DR의 매우 큰 데이터세트로 인해 생성될 수 있는 성능 차이를 방지한다. 그러나 상기 안저 이미지의 증강 시 모든 기능, 즉 시신경 디스크, 황반 및 혈관을 포함하여야 하므로 파라미터 에 이동은 적용되지 않는다. 심층 학습부는 입력되는 안저 이미지의 형상을 384*384*384*383의 최적 형상으로 구성하고, 4급 연결 소프 트맥스 예측 확률을 적용한 심층 신경망(DNN) 인공지능 모델이 구성되며, 상기 이미지 전처리된 학습 데이터세 트의 안저이미지를 상기 심층 신경망 인공지능 모델에 적용하여 학습시키고, 학습된 심층 신경망 인공지능 모델을 교차 검증부 및 안구진환 진단부로 출력한다. 본 발명의 심층 학습부는 신경망 최적화기가 적용되고, 신경망 최적화기는 가중치를 형성하고 학습을 수행 하는 데 중요한 역할을 하며, 손실함수는 최적화기가 올바른 방향으로 이동하도록 안내한다. 본 발명에서는 Adadelta라고 하는 적응적 구배 확장 최적화기가 적용되며 학습 강건성과 학습 속도 변화를 방지한다. 상기 Adadelta의 학습 속도는 0.001 이내이고, 범주형 Cross-entropy 손실함수를 사용한다. 상기 이미지 전처리부에서 출력되는 데이터세트는 80%만 학습에 적용하고, 10%는 테스트용으로, 10%는 검 증용으로 사용한다. 교차 검증부는 상기 심층 학습부에서 학습된 심층 신경망 인공지능 모델에 상기 10%의 검증용 데이터 세트를 입력받아 K-fold 교차검증, 특히 10배 교차 검증을 수행한다. 검증에 실패하면 심층 학습부는 재학 습을 수행하도록 구성되는 것이 바람직할 것이다. 안구질환 진단부는 상기 교차 검증부를 통해 검증에 성공한 학습된 심층 신경망 인공지능모델에 이미 지 전처리된 진단 대상 안저 이미지를 적용하여 안구질환을 분류하고, 분류된 안구질환을 출력한다. 도 4는 본 발명에 따른 안저 이미지를 이용한 심층 신경망 기반 안구질환 진단 방법을 나타낸 흐름도이다. 도 4를 참조하면, 안저 이미지 획득부는 상술한 다수의 데이터베이스들로부터 본 발명에 따라 필요한 안저 이미지 및 각 안저 이미지에 대한 전문가의 주석을 포함하는 안저 이미지 학습 데이터세트를 획득하여 이미지 전처리부로 출력한다(S111). 이미지 전처리부는 입력되는 학습 데이터세트의 안저 이미지들을 이미지 전처리하여 이미지 전처리된 학습 데이터세트를 심층 학습부로 제공한다(S113). 심층 학습부는 이미지 전처리부로부터 입력되는 이미지 전처리된 학습 데이터세트의 안저 이미지들을 심층 신경망 인공지능모델에 적용하여 학습을 시켜 안구질환 진단 모델을 생성하여 교차 검증부 및 안구질 환 진단부로 제공한다(S115). 교차 검증부는 생성된 안구질환 진단 모델에 검증용 데이터세트를 적용하여 K-fold 교차 검증을 수행하여 성공 여부를 판단한다(S117). 성공이면 안구질환 진단부는 심층 학습부로부터 입력된 심층 신경망 인공지능 모델인 안구질환 진단 모델을 구동하고, 진단 이미지 획득부로부터 획득되어 이미지 전처리부를 통해 진단 대상 안저 이미 지가 입력되는지를 모니터링하고(S119), 진단 대상 안저 이미지가 입력되면 안구질환 진단 모델에 적용하여 (S123) 진단결과를 출력한다(S125). 도 5는 본 발명에 따른 안저 이미지를 이용한 심층 신경망 기반 안구질환 진단 방법 중 이미지 전처리 방법을 나타낸 흐름도이다. 도 5를 참조하면, 우선 이미지 전처리부의 관심영역 획득부는 채널 선택부를 통해 입력되는 학 습 데이터세트의 각 안저 이미지의 적색 채널 및 청색 채널만을 추출하여 크기 조절부로 출력한다(S211). 크기 조절부는 상기 적색 채널의 안저 이미지의 크기를 384 픽셀로 조절한 후 대조 제한 적응 히스토그램 등화부로 출력한다(S213). 대조 제한 적응 히스토그램 등화부는 크기 조절된 안저 이미지를 휘도 평면에서 히스토그램 등화를 수행하 여 이미지 증강부로 출력한다(S215). 이미지 증강부는 입력되는 각 안저 이미지에 대해 파마리터를 변경하면서 상기 안저 이미지에 대한 증강 이미지를 생성하고, 증강 이미지가 생성된 학습 데이터세트를 심층 학습부로 제공한다(S220). 한편, 본 발명은 전술한 전형적인 바람직한 실시예에만 한정되는 것이 아니라 본 발명의 요지를 벗어나지 않는"}
{"patent_id": "10-2020-0101660", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "범위 내에서 여러 가지로 개량, 변경, 대체 또는 부가하여 실시할 수 있는 것임은 당해 기술분야에서 통상의 지 식을 가진 자라면 용이하게 이해할 수 있을 것이다. 이러한 개량, 변경, 대체 또는 부가에 의한 실시가 이하의 첨부된 특허청구범위의 범주에 속하는 것이라면 그 기술사상 역시 본 발명에 속하는 것으로 보아야 한다."}
{"patent_id": "10-2020-0101660", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명에 따른 안저 이미지를 이용한 심층 신경망 기반 안구질환 진단 장치의 구성을 나타낸 도면이다. 도 2는 본 발명에 따른 이미지 전처리를 수행한 안저 이미지를 나타낸 도면이다. 도 3은 본 발명에 따른 이미지 증강 이미지 전처리를 수행한 안저 이미지를 나타낸 도면이다. 도 4는 본 발명에 따른 안저 이미지를 이용한 심층 신경망 기반 안구질환 진단 방법을 나타낸 흐름도이다. 도 5는 본 발명에 따른 안저 이미지를 이용한 심층 신경망 기반 안구질환 진단 방법 중 이미지 전처리 방법을 나타낸 흐름도이다."}
