{"patent_id": "10-2020-0114607", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2022-0033083", "출원번호": "10-2020-0114607", "발명의 명칭": "XAI 딥러닝 기반 심장질환 진단 및 해석 시스템", "출원인": "주식회사 바디프랜드", "발명자": "권준명"}}
{"patent_id": "10-2020-0114607", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "심장질환 및 심장질환을 결정하는 심전도 데이터를 학습 데이터로 사용하고, 심장질환의 진단명을 판단하는 하나 이상의 특성을 해석하는 하나 이상의 해당 해석모듈을 구비하여, 심장질환의 진단명 및 진단된 심장질환의판단 특성을 도출하도록 구축된, XAI 딥러닝 모델부;심전도 데이터를 입력받아 상기 XAI 딥러닝 모델부로 제공하는 입력부; 및상기 XAI 딥러닝 모델부에 의해, 상기 입력부로부터의 심전도 데이터를 입력으로 하여 심장질환의 진단명 및 진단된 심장질환의 판단 특성을 출력하는 출력부;를 포함하는,XAI 딥러닝 기반 심장질환 진단 및 해석 시스템."}
{"patent_id": "10-2020-0114607", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 심장질환은 심방세동이고, 상기 해석모듈은 상기 심방세동의 판단 특성을 해석하는 것을 특징으로 하는,XAI 딥러닝 기반 심장질환 진단 및 해석 시스템."}
{"patent_id": "10-2020-0114607", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제2항에 있어서,상기 해석모듈은 상기 심전도 데이터로부터 심장박동의 불규칙성을 해석하는 불규칙성 해석모듈, P파의 부재를해석하는 P파 해석모듈, 및 상기 불규칙성 해석모듈과 상기 P파 해석모듈의 출력값을 결합하여 상기 심방세동을판단하는 앙상블 모듈로 구성되는 것을 특징으로 하는,XAI 딥러닝 기반 심장질환 진단 및 해석 시스템."}
{"patent_id": "10-2020-0114607", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제3항에 있어서,상기 불규칙성 해석모듈 또는 상기 P파 해석모듈은, 제1잔여블록 내지 제4 잔여블록과, 제1FC레이어 및 제2FC레이어를 포함하며,상기 제1잔여블록 내지 제4잔여블록에는 2개의 컨벌루션 레이어와 2개의 배치 정규화 레이어가 각각 반복되어구성되고, 상기 제4잔여블록은 플래튼 레이어에 연결되고, 상기 플래튼 레이어는 상기 제1FC레이어에 연결되고,상기 제2FC레이어는 단일 출력 노드에 연결되고, 상기 단일 출력 노드는, 시그모이드 활성화 함수에 의해, 심장박동의 불규칙성의 제1확률 및 P파의 부재의 제2확률을 각각 출력하고,상기 앙상블 모듈은 상기 제1확률 및 상기 제2확률을 결합하여 상기 심방세동의 존재확률을 출력하여서,상기 심방세동의 존재를 예측하고, 예측된 상기 심방세동의 판단 특성을 해석하는 것을 특징으로 하는,XAI 딥러닝 기반 심장질환 진단 및 해석 시스템."}
{"patent_id": "10-2020-0114607", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "공개특허 10-2022-0033083-3-제1항에 있어서,상기 심전도 데이터는 단일유도, 6유도 또는 12유도 심전도 데이터인 것을 특징으로 하는,XAI 딥러닝 기반 심장질환 진단 및 해석 시스템."}
{"patent_id": "10-2020-0114607", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제1항에 있어서,상기 입력부는 상기 심전도 데이터의 노이즈를 제거하고 정규화하는 전처리모듈을 포함하는 것을 특징으로하는,XAI 딥러닝 기반 심장질환 진단 및 해석 시스템."}
{"patent_id": "10-2020-0114607", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제1항에 있어서,상기 XAI 딥러닝 모델부의 검증 데이터는, 상기 학습 데이터와 동일한 진단집단으로부터 일정 비율로 추출된 내부 검증 데이터와, 상기 학습 데이터와 상이한 진단집단으로부터 추출된 외부 검증 데이터로 구성되는 것을 특징으로 하는,XAI 딥러닝 기반 심장질환 진단 및 해석 시스템."}
{"patent_id": "10-2020-0114607", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제1항에 있어서,상기 출력부는 상기 진단된 심장질환의 판단 특성에 상응하는 치료법을 제공하는 것을 특징으로 하는,XAI 딥러닝 기반 심장질환 진단 및 해석 시스템."}
{"patent_id": "10-2020-0114607", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제1항에 있어서,상기 XAI 딥러닝 모델부는 NBDT 모델인 것을 특징으로 하는,XAI 딥러닝 기반 심장질환 진단 및 해석 시스템."}
{"patent_id": "10-2020-0114607", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은, 심장질환 및 심장질환을 결정하는 심전도 데이터를 학습 데이터로 사용하고, 심장질환의 진단명을 판 단하는 하나 이상의 특성을 해석하는 하나 이상의 해당 해석모듈을 구비하여, 심장질환의 진단명 및 진단된 심장 질환의 판단 특성을 도출하도록 구축된, XAI 딥러닝 모델부, 심전도 데이터를 입력받아 XAI 딥러닝 모델부 로 제공하는 입력부, 및 XAI 딥러닝 모델부에 의해, 입력부로부터의 심전도 데이터를 입력 으로 하여 심장질환의 진단명 및 진단된 심장질환의 판단 특성을 출력하는 출력부를 포함하여, 설명가능한 신경망 모델에 의해 심장질환의 진단 및 진단 이유를 제공할 수 있는, XAI 딥러닝 기반 심장질환 진단 및 해석 시스템을 개시한다."}
{"patent_id": "10-2020-0114607", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은, 설명가능한 신경망 모델에 의해 심장질환의 진단 및 진단 이유를 제공하여서 진단의 정확성 및 해석 성을 높여 임상 실습에 적용할 수 있는, XAI 딥러닝 기반 심장질환 진단 및 해석 시스템에 관한 것이다."}
{"patent_id": "10-2020-0114607", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "주지하는 바와 같이, 심전도의 개발 이후, 심전도 관련 지식은 기하급수적으로 확대되었고, 심전도 검사에서 심 장의 전기적 기능에 대한 정보를 얻고 부정맥, 관상동맥질환, 심근질환 등 다양한 심장질환을 진단할 수 있다. 한편, 심전도의 AI 알고리즘에 대한 연구가 활발히 진행되고 있으며, AI 알고리즘에 의해 심부전을 감지하고, 부정맥 리듬 중 심방세동을 예측하거나, 성별을 결정하기도 한다.이와 같이, 인간의 한계를 극복하여, AI 알고리즘에 의해 심전도 파형의 미묘한 변화를 감지할 수 있고, 더 나 아가 심전도 해석을 향상시킬 수도 있다. 심방세동은 질병률과 사망률 상승의 주요 원인이며, 시기적절한 진단과 치료가 중요한데, 심전도와 산소포화도 곡선과 같은 생체신호를 이용한 진단 알고리즘의 성능을 향상시키기 위해 AI 알고리즘 사용하지만, AI 알고리즘 은 인간이 이해할 수 있는 방식으로 예측을 설명하지 않는 블랙박스로서, 투명성과 해석성이 떨어져 신뢰도가 낮은 문제점이 있다. 또한, 종래의 딥러닝 구조에서는 신경망이 하나의 단위로 되어있어서 심장질환의 유무, 심장질환의 종류 또는 심장질환의 정도 등의 판단의 내용만을 확인할 수 있는 한계가 있다. 이에, 투명성과 해석성의 결여로 딥러닝모델을 신뢰할 수 없어서, 심장질환의 진단명과 진단이유를 함께 제시할 수 있는, 정확성과 해석성이 향상된 설명 가능한 인공지능 모델을 구축할 수 있는 기술이 요구된다. 선행기술문헌 특허문헌 (특허문헌 0001) 한국 등록특허공보 제10-2156087호 (딥러닝을 이용한 정상동율동 심전도 상태에서의 발작성 심 방세동 예측방법, 2020.09.15) (특허문헌 0002) 한국 공개특허공보 제10-2021-0066322호 (심방세동 예측시스템 및 예측방법, 2021.06.07)"}
{"patent_id": "10-2020-0114607", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명의 사상이 이루고자 하는 기술적 과제는, 설명가능한 신경망 모델에 의해 심장질환의 진단 및 진단 이유 를 제공하여서 진단의 정확성 및 해석성을 높여 임상 실습에 적용할 수 있는, XAI 딥러닝 기반 심장질환 진단 및 해석 시스템을 제공하는 데 있다."}
{"patent_id": "10-2020-0114607", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "전술한 목적을 달성하고자, 본 발명의 실시예는, 심장질환 및 심장질환을 결정하는 심전도 데이터를 학습 데이 터로 사용하고, 심장질환의 진단명을 판단하는 하나 이상의 특성을 해석하는 하나 이상의 해당 해석모듈을 구비 하여, 심장질환의 진단명 및 진단된 심장질환의 판단 특성을 도출하도록 구축된, XAI 딥러닝 모델부; 심전도 데이터를 입력받아 상기 XAI 딥러닝 모델부로 제공하는 입력부; 및 상기 XAI 딥러닝 모델부에 의해, 상기 입 력부로부터의 심전도 데이터를 입력으로 하여 심장질환의 진단명 및 진단된 심장질환의 판단 특성을 출력하는 출력부;를 포함하는, XAI 딥러닝 기반 심장질환 진단 및 해석 시스템을 제공한다. 여기서, 상기 심장질환은 심방세동이고, 상기 해석모듈은 상기 심방세동의 판단 특성을 해석할 수 있다. 또한, 상기 해석모듈은 상기 심전도 데이터로부터 심장박동의 불규칙성을 해석하는 불규칙성 해석모듈, P파의 부재를 해석하는 P파 해석모듈, 및 상기 불규칙성 해석모듈과 상기 P파 해석모듈의 출력값을 결합하여 상기 심 방세동을 판단하는 앙상블 모듈로 구성될 수 있다. 또한, 상기 불규칙성 해석모듈 또는 상기 P파 해석모듈은, 제1잔여블록 내지 제4 잔여블록과, 제1FC레이어 및 제2FC레이어를 포함하며, 상기 제1잔여블록 내지 제4잔여블록에는 2개의 컨벌루션 레이어와 2개의 배치 정규화 레이어가 각각 반복되어 구성되고, 상기 제4잔여블록은 플래튼 레이어에 연결되고, 상기 플래튼 레이어는 상기제1FC레이어에 연결되고, 상기 제2FC레이어는 단일 출력 노드에 연결되고, 상기 단일 출력 노드는, 시그모이드 활성화 함수에 의해, 심장박동의 불규칙성의 제1확률 및 P파의 부재의 제2확률을 각각 출력하고, 상기 앙상블 모듈은 상기 제1확률 및 상기 제2확률을 결합하여 상기 심방세동의 존재확률을 출력하여서, 상기 심방세동의 존 재를 예측하고, 예측된 상기 심방세동의 판단 특성을 해석할 수 있다. 한편, 상기 심전도 데이터는 단일유도, 6유도 또는 12유도 심전도 데이터일 수 있다. 또한, 상기 입력부는 상기 심전도 데이터의 노이즈를 제거하고 정규화하는 전처리모듈을 포함할 수 있다. 또한, 상기 XAI 딥러닝 모델부의 검증 데이터는, 상기 학습 데이터와 동일한 진단집단으로부터 일정 비율로 추 출된 내부 검증 데이터와, 상기 학습 데이터와 상이한 진단집단으로부터 추출된 외부 검증 데이터로 구성될 수 있다. 또한, 상기 출력부는 상기 진단된 심장질환의 판단 특성에 상응하는 치료법을 제공할 수 있다. 또한, 상기 XAI 딥러닝 모델부는 NBDT 모델일 수 있다."}
{"patent_id": "10-2020-0114607", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명에 의하면, 설명가능한 신경망 모델에 의해 심장질환의 진단 및 진단 이유를 제공하여서 진단의 정확성 및 해석성을 높여 임상 실습에 적용할 수 있도록 하고, 내외부 검증 데이터를 활용하여 모델의 정확도를 높일 수 있고, 진단 이유에 따른 해당 치료법을 제공하도록 할 수 있고, 심전도 데이터를 이용하여 심방세동 이외에 다양한 심장질환을 진단하도록 할 수 있는 효과가 있다."}
{"patent_id": "10-2020-0114607", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하, 첨부된 도면을 참조로 전술한 특징을 갖는 본 발명의 실시예를 더욱 상세히 설명하고자 한다. 본 발명의 실시예에 의한 XAI 딥러닝 기반 심장질환 진단 및 해석 시스템은, 심장질환 및 심장질환을 결정하는 심전도 데이터를 학습 데이터로 사용하고, 심장질환의 진단명을 판단하는 하나 이상의 특성을 해석하는 하나 이 상의 해당 해석모듈을 구비하여, 심장질환의 진단명 및 진단된 심장질환의 판단 특성을 도출하도록 구축된, XAI 딥러닝 모델부, 심전도 데이터를 입력받아 XAI 딥러닝 모델부로 제공하는 입력부, 및 XAI 딥러 닝 모델부에 의해, 입력부로부터의 심전도 데이터를 입력으로 하여 심장질환의 진단명 및 진단된 심 장질환의 판단 특성을 출력하는 출력부를 포함하여, 설명가능한 신경망 모델에 의해 심장질환의 진단 및 진단 이유를 제공하는 것을 요지로 한다.이하, 도 1 내지 도 4를 참조하여, 전술한 구성의 XAI 딥러닝 기반 심장질환 진단 및 해석 시스템을 구체적으로 상술하면 다음과 같다. 우선, XAI 딥러닝 모델부는, 심장질환 및 심장질환을 결정하는 생체신호 중 디지털방식으로 저장된 심전도 (ECG;electrocardiogram) 데이터를 학습 데이터(train data)로 사용하고, 심장질환의 진단명을 판단하는 하나 이상의 특성을 해석하는 하나 이상의 해당 해석모듈을 구비하여, 심장질환의 진단명 및 진단된 심장질환의 판단 특성을 도출하도록 구축되어서, 진단명뿐만 아니라 해당 심장질환 진단의 판단 기준, 판단 이유 또는 판단 근거 를 함께 제시하도록 할 수 있다. 여기서, XAI 딥러닝 모델부는 모델 구축을 위한 학습 데이터 또는 모델의 유효성 검증을 위한 검증 데이터 (validation data)로 단일유도(lead Ⅰ), 6유도(Ⅰ,Ⅱ,Ⅲ,VL,VR,VF) 또는 12유도 심전도 데이터 등의 다양한 형식의 심전도 데이터를 사용할 수 있다. 또한, XAI 딥러닝 모델부의 검증 데이터는, 학습 데이터와 동일한 진단집단으로부터 일정 비율로 추출된 내부 검증 데이터와, 학습 데이터와 상이한 진단집단으로부터 추출된 외부 검증 데이터로 구성되어서, 외부 검 증 데이터를 통해 과적합(overfitting) 문제를 해결하여 모델의 정확도를 검증하도록 할 수 있다. 예컨대, 도 3의 <표 1>을 참고하면, 샘플링 레이트(sampling rate)가 400Hz인 21,837개의 12유도 ECG가 포함된 PTB-XL ECG 데이터 세트와, 샘플링 레이트가 500Hz인 10,605개의 12유도 ECG가 포함된 Chapman ECG 데이터 세 트와, 샘플링 레이트가 300Hz인 8,528개의 단일유도 ECG가 포함된 PhysioNet ECG 데이터 세트와, 샘플링 레이트 가 500Hz인 128,399개의 12유도 ECG가 포함된 Sejong ECG 데이터 세트가 예시되어 있으며, 본 실시예에서의 모 델 구축시에, Sejong ECG 데이터 세트의 모집단으로부터 무작위로 9 : 1의 비율로 분할하여 학습 데이터와 내부 검증 데이터를 선택하고, 외부 검증 데이터로는 PTB-XL ECG 데이터 세트와 Chapman ECG 데이터 세트와 PhysioNet ECG 데이터 세트를 선택할 수 있다. 본 실시예에서, XAI 딥러닝 모델부는 신경망의 정확도에 근접하도록 하면서 높은 수준의 해석가능성 (interpretability)을 유지하도록 신경망(neural network)과 의사결정트리(decision tree)가 결합된 NBDT(Neural-Backed Decision Tree) 모델일 수 있다. 한편, 심장질환은 심방세동(Atrial fibrillation)이고, 해석모듈은 심방세동의 특성을 분류하는 모듈로서, 심방 세동으로 진단하게 된 기준, 이유 또는 근거의 판단 특성을 해석하도록 할 수 있다. 참고로, 심방세동은 심방의 규칙적인 수축이 소실되고 불규칙한 잔떨림이 발생하여 빠른 맥의 형태로 불규칙한 맥박을 일으키는 부정맥 질환으로서, 심전도 검사에서, 동방결절에서 정상적인 전기적 자극이 시작되는 것을 의 미하는, 정상적 P파가 나타나지 않고 불규칙한 선으로만 나타난다. 이에, 해석모듈은 심방세동의 판단 특성인 심장박동의 불규칙성 및 P파의 부재를 식별하기 위해서, 도 2를 참고 하면, 심전도 데이터로부터 심장박동의 불규칙성을 해석하는 불규칙성 해석모듈, P파의 부재를 해석하는 P 파 해석모듈, 및 불규칙성 해석모듈과 P파 해석모듈의 출력값을 결합하여 심방세동의 존재확률 을 판단하는 앙상블 모듈(ensemble module)로 구성될 수 있다. 구체적으로, 불규칙성 해석모듈 또는 P파 해석모듈은, 각각 학습 수행을 보다 쉽도록 하는 제1잔여블 록(residual block) 내지 제4 잔여블록과, 컨벌루션(convolution)과 맥스 풀링(Max Pooling) 프로세스의 결과 를 취하여 심전도 데이터 이미지를 정의된 라벨로 분류하는 제1FC레이어(Fully Connected layer) 및 제2FC레이 어를 포함할 수 있다. 여기서, 도 2에 확대 도시된 바와 같이, 제1잔여블록 내지 제4잔여블록에는 2개의 컨벌루션 레이어 (CONV;convolution layer)와, 학습을 더 빨리 수행하거나 극소적 최적해(local optimum) 문제에 빠지는 가능성 을 줄이기 위한 2개의 배치 정규화 레이어(BN;Batch Normalization layer)가 각각 반복되어 구성될 수 있다. 또한, 제4잔여블록은 단일 벡터로 변환하는 플래튼 레이어(flatten layer)에 연결되고, 플래튼 레이어는 제1FC 레이어에 연결되고, 제2FC레이어는 단일 출력 노드에 연결되고, 단일 출력 노드는, 이전 레이어에 대한 가중 합 의 크기에 따라 활성 여부를 결정하는 시그모이드 활성화 함수(sigmoid activation function)에 의해, 심장박동의 불규칙성의 제1확률 및 P파의 부재의 제2확률을 각각 출력할 수 있다. 마지막으로, 앙상블 모듈은 제1확률 및 제2확률을 결합하여 심방세동의 존재확률을 출력하여서, 심방세동 의 존재를 예측하고, 예측된 심방세동의 판단 특성을 해석할 수 있다. 한편, XAI 딥러닝 모델부는, 앞서 언급한 심방세동에 한정되지 않고, 심근증, 선천성 심장병, 판막 질환, 심부전증, 심낭 질환, 고혈압, 동맥 경화증 또는 관상동맥 질환 등의 다양한 심장질환에 적용하여서, 2D 진단 데이터, 3D 진단 데이터 또는 파형 등의 셍체신호를 제공하는 심전도 데이터의 형상을 추출하고 분석하여 심장 질환을 진단하기 위한 N개의 특성을 오토인코더(auto encoder)에 의해 추출하고, 특성의 조합에 따른 심장질환 의 해당 진단명을 학습하여, 예측 변수인 심전도 데이터에 따른 예측 결과인 진단명을 도출하도록 할 수도 있다. 다음, 입력부는 심장질환의 진단명 및 판단 특성을 예측하고자 하는 심전도 데이터를 입력받아 XAI 딥러닝 모델부로 제공한다. 한편, 입력부는 심전도 데이터의 노이즈를 제거하고 정규화하는 전처리모듈을 포함할 수 있다. 예컨대, 전처리모듈은 10초 동안 디지털로 저장된 12유도 심전도 데이터 중 시작 부분과 끝 부분의 각 1초 씩 제거하여 아티팩트(artifact)를 제거하여 보다 양질의 심전도 데이터를 확보하도록 할 수 있다. 다음, 출력부는, XAI 딥러닝 모델부에 의해, 입력부로부터의 예측 변수인 심전도 데이터를 입력 으로 하여, 예측 결과인 심장질환의 진단명 및 진단된 심장질환의 판단 특성을 출력하여서, 진단명의 가능성, 및 해당 진단명으로 판단하게 된 기준, 이유 또는 근거를 확인하도록 한다. 즉, 출력부는 심방세동이 없다고 진단한 결과와 함께 심장박동이 규칙적이어서인지 P파가 존재하여서인지 제시하거나, 심방세동이 있다고 진단한 결과와 함께 심장박동이 불규칙적이어서인지 P파가 부재하여서인지 제시 하도록 할 수 있다. 또한, 출력부는 진단된 심장질환의 판단 특성, 예컨대 심장박동의 불규칙성 또는 P파의 부재에 상응하는 치료법을 제공할 수도 있다. 도 4는 도 1의 XAI 딥러닝 기반 심장질환 진단 및 해석 시스템에 의한 진단 및 해석 과정의 흐름도를 도시한 것으로서, 이를 참조하여, 간략히 상술하면 다음과 같다. 우선, XAI 딥러닝 모델부 구축 단계(S110)에서는, 심장질환 및 심장질환을 결정하는 생체신호 중 디지털방식으 로 저장된 심전도 데이터를 학습 데이터로 사용하고, 심장질환의 진단명을 판단하는 하나 이상의 특성을 해석하 는 하나 이상의 해당 해석모듈을 구비하여, 심장질환의 진단명 및 진단된 심장질환의 판단 특성을 도출하도록 XAI 딥러닝 모델부를 구축하여서, 진단명뿐만 아니라 해당 심장질환 진단의 판단 기준, 판단 이유 또는 판 단 근거를 함께 제시하도록 할 수 있다. 여기서, 모델 구축을 위한 학습 데이터 또는 모델의 유효성 검증을 위한 검증 데이터로 단일유도(lead Ⅰ), 6유 도(Ⅰ,Ⅱ,Ⅲ,VL,VR,VF) 또는 12유도 심전도 데이터 등의 다양한 형식의 심전도 데이터를 사용할 수 있다. 또한, 검증 데이터는, 학습 데이터와 동일한 진단집단으로부터 일정 비율로 추출된 내부 검증 데이터와, 학습 데이터와 상이한 진단집단으로부터 추출된 외부 검증 데이터로 구성되어서, 외부 검증 데이터를 통해 과적합 문 제를 해결하여 모델의 정확도를 검증하도록 할 수 있다. 한편, 심장질환은 심방세동이고, 해석모듈은 심방세동의 특성을 분류하는 모듈로서, 심방세동으로 진단하게 된 기준, 이유 또는 근거의 판단 특성을 해석하도록 할 수 있다. 참고로, 심방세동은 심방의 규칙적인 수축이 소실되고 불규칙한 잔떨림이 발생하여 빠른 맥의 형태로 불규칙한 맥박을 일으키는 부정맥 질환으로서, 심전도 검사에서, 동방결절에서 정상적인 전기적 자극이 시작되는 것을 의 미하는, 정상적 P파가 나타나지 않고 불규칙한 선으로만 나타난다. 이에, 해석모듈은 심방세동의 판단 특성인 심장박동의 불규칙성 및 P파의 부재를 식별하기 위해서, 도 2를 참고 하면, 심전도 데이터로부터 심장박동의 불규칙성을 해석하는 불규칙성 해석모듈, P파의 부재를 해석하는 P 파 해석모듈, 및 불규칙성 해석모듈과 P파 해석모듈의 출력값을 결합하여 심방세동의 존재확률 을 판단하는 앙상블 모듈로 구성될 수 있다. 구체적으로, 불규칙성 해석모듈 또는 P파 해석모듈은, 각각 학습수행을 보다 쉽도록 하는 제1잔여블 록 내지 제4 잔여블록과, 컨벌루션과 맥스 풀링 프로세스의 결과를 취하여 심전도 데이터 이미지를 정의된 라벨 로 분류하는 제1FC레이어 및 제2FC레이어를 포함할 수 있다. 여기서, 도 2에 확대 도시된 바와 같이, 제1잔여블록 내지 제4잔여블록에는 2개의 컨벌루션 레이어와, 학습을 더 빨리 수행하거나 극소적 최적해 문제에 빠지는 가능성을 줄이기 위한 2개의 배치 정규화 레이어가 각각 반복 되어 구성될 수 있다. 또한, 제4잔여블록은 단일 벡터로 변환하는 플래튼 레이어에 연결되고, 플래튼 레이어는 제1FC레이어에 연결되 고, 제2FC레이어는 단일 출력 노드에 연결되고, 단일 출력 노드는, 이전 레이어에 대한 가중 합의 크기에 따라 활성 여부를 결정하는 시그모이드 활성화 함수에 의해, 심장박동의 불규칙성의 제1확률 및 P파의 부재의 제2확 률을 각각 출력할 수 있다. 마지막으로, 앙상블 모듈은 제1확률 및 제2확률을 결합하여 심방세동의 존재확률을 출력하여서, 심방세동 의 존재를 예측하고, 예측된 심방세동의 판단 특성을 해석할 수 있다. 한편, XAI 딥러닝 모델부는, 앞서 언급한 심방세동에 한정되지 않고, 심근증, 선천성 심장병, 판막 질환, 심부전증, 심낭 질환, 고혈압, 동맥 경화증 또는 관상동맥 질환 등의 다양한 심장질환에 적용하여서, 심전도 데 이터를 분석하여 심장질환을 진단하기 위한 N개의 특성을 추출하고, 특성의 조합에 따른 심장질환의 해당 진단 명을 학습하여, 예측 변수인 심전도 데이터에 따른 예측 결과인 진단명을 도출하도록 할 수도 있다. 이후, 시험 데이터 입력 단계(S120)에서는, 심장질환의 진단명 및 판단 특성을 예측하고자 하는 예측 변수인 심 전도 데이터를 입력받아 XAI 딥러닝 모델부로 제공한다. 한편, 시험 데이터 입력 단계(S120)는 전처리모듈에 의해 심전도 데이터의 노이즈를 제거하고 정규화하는 전처리 단계(S121)를 더 포함할 수 있다. 예컨대, 전처리 단계(S121)에서는, 10초 동안 디지털로 저장된 12유도 심전도 데이터 중 시작 부분과 끝 부분의 각 1초씩 제거하여 아티팩트를 제거하여 보다 양질의 심전도 데이터를 확보하도록 할 수 있다. 이후, 예측 결과 출력 단계(S130)에서는, XAI 딥러닝 모델부에 의해, 입력부로부터의 예측 변수인 심 전도 데이터를 입력으로 하여, 심장박동의 불규칙성과 P파의 부재를 판단하여, 예측 결과인 심장질환의 진단명 및 진단된 심장질환의 판단 특성을 출력하여서, 진단명의 가능성, 및 해당 진단명으로 판단하게 된 기준, 이유 또는 근거를 확인하도록 한다. 즉, 예측 결과 출력 단계(S130)에서는, 심방세동이 없다고 진단한 결과와 함께 심장박동이 규칙적이어서인지 P 파가 존재하여서인지 제시하거나, 심방세동이 있다고 진단한 결과와 함께 심장박동이 불규칙적이어서인지 P파가 부재하여서인지 제시하도록 할 수 있다. 이후, 치료법 제공 단계(S140)에서는, 출력부를 통해, 심방세동 등의 진단된 심장질환의 판단 특성, 예컨 대 심장박동의 불규칙성 또는 P파의 부재에 상응하는 치료법을 제공하도록 할 수 있다. 또한, 앞서 언급한 XAI 딥러닝 기반 심장질환 진단 및 해석 시스템에 의한 진단 및 해석 방법을 수행하는 컴퓨 터판독가능한 기록 매체에 저장된 컴퓨터 소프트웨어를 제공할 수 있다. 따라서, 전술한 바와 같은 XAI 딥러닝 기반 심장질환 진단 및 해석 시스템의 구성에 의해서, 설명가능한 신경망 모델에 의해 심장질환의 진단 및 진단 이유를 제공하여서 진단의 정확성 및 해석성을 높여 임상 실습에 적용할수 있도록 하고, 내외부 검증 데이터를 활용하여 모델의 정확도를 높일 수 있고, 진단 이유에 따른 해당 치료법 을 제공하도록 할 수 있고, 심전도 데이터를 이용하여 심방세동 이외에 다양한 심장질환을 진단하도록 할 수 있 다. 본 명세서에 기재된 실시예와 도면에 도시된 구성은 본 발명의 가장 바람직한 일 실시예에 불과할 뿐이고, 본 발명의 기술적 사상을 모두 대변하는 것은 아니므로, 본 출원 시점에 있어서 이들을 대체할 수 있는 다양한 균 등물과 변형예들이 있을 수 있음을 이해하여야 한다."}
{"patent_id": "10-2020-0114607", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 실시예에 의한 XAI 딥러닝 기반 심장질환 진단 및 해석 시스템의 개략적인 구성도를 도시한 것이다. 도 2는 도 1의 XAI 딥러닝 기반 심장질환 진단 및 해석 시스템의 XAI 딥러닝 모델부를 예시한 것이다. 도 3은 도 2의 XAI 딥러닝 모델부의 구축을 위한 심전도 데이터의 데이터셋 테이블을 예시한 것이다. 도 4는 도 1의 XAI 딥러닝 기반 심장질환 진단 및 해석 시스템에 의한 진단 및 해석 과정의 흐름도를 도시한 것 이다."}
