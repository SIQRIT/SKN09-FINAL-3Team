{"patent_id": "10-2023-0159590", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2024-0073790", "출원번호": "10-2023-0159590", "발명의 명칭": "다중 레이블 이미지에 대한 이미지 분류 모델 학습방법 및 시스템, 그리고 상기 이미지 분류", "출원인": "주식회사 LG 경영개발원", "발명자": "장종성"}}
{"patent_id": "10-2023-0159590", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "메모리와 프로세서를 포함하는 컴퓨팅 시스템이 이미지 분류 모델을 학습하는 방법으로서,복수의 이미지-텍스트 쌍의 샘플 데이터에서 텍스트 데이터 확대(text data augmentation)하는 단계;상기 데이터 확대된 텍스트들과 이미지를 기초로 사전 학습된 비전-언어 모델을 파인 튜닝하여 이미지 분류 모델을 학습하는 단계; 및 상기 학습된 이미지 분류 모델을 제공하는 단계를 포함하는 다중 레이블 이미지에 대한 이미지 분류 모델 학습방법."}
{"patent_id": "10-2023-0159590", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1 항에 있어서,상기 샘플 데이터에서 텍스트 데이터 확대(text data augmentation)하는 단계는,복수의 다중 레이블 이미지와 상기 다중 레이블 이미지에 대한 설명을 포함하는 보고서들로 구성된 로 데이터(raw data)를 획득하는 단계와,상기 로 데이터(raw data)에서 기 설정된 기준에 따른 다중 레이블 이미지를 검출하는 단계와, 상기 검출한 다중 레이블 이미지에 연관된 보고서를 검출하는 단계를 포함하는다중 레이블 이미지에 대한 이미지 분류 모델 학습방법."}
{"patent_id": "10-2023-0159590", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제2 항에 있어서,상기 샘플 데이터에서 텍스트 데이터 확대(text data augmentation)하는 단계는,상기 검출한 보고서에서 상기 다중 레이블을 분류하는 설명에 해당하는 적어도 하나 이상의 단란을 추출하여 재구성된 보고서를 생성하는 단계를 포함하는다중 레이블 이미지에 대한 이미지 분류 모델 학습방법."}
{"patent_id": "10-2023-0159590", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제1 항에 있어서,상기 샘플 데이터에서 텍스트 데이터 확대(text data augmentation)하는 단계는,복수의 다중 레이블 이미지와, 각 이미지에 연관된 복수의 보고서를 획득하는 단계와, 상기 복수의 보고서에 포함된 문장을 각각 분리하여 n개의 문장을 검출하는 단계와, 상기 검출한 n개의 문장을 기초로 복수의 하위 텍스트들을 생성하는 단계를 포함하는 다중 레이블 이미지에 대한 이미지 분류 모델 학습방법."}
{"patent_id": "10-2023-0159590", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제4 항에 있어서,상기 복수의 하위 텍스트들을 생성하는 단계는, 상기 검출한 n개의 문장을 무작위로 샘플링하여 조합하는 방식으로 상기 복수의 하위 텍스트를 생성하는 단계를공개특허 10-2024-0073790-3-포함하는 다중 레이블 이미지에 대한 이미지 분류 모델 학습방법."}
{"patent_id": "10-2023-0159590", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제4 항에 있어서,상기 사전 학습된 비전-언어 모델을 파인 튜닝하여 이미지 분류 모델을 학습하는 단계는,제1 다중 레이블 이미지에 대한 제1 보고서로부터 생성된 복수의 하위 텍스트들을 상기 제1 다중 레이블 이미지와 각각 포지티브 쌍으로 맵핑하고, 다른 다중 레이블 이미지와는 네거티브 쌍으로 맵핑하여 확장된 샘플 데이터를 생성하는 단계를 포함하는 다중 레이블 이미지에 대한 이미지 분류 모델 학습방법."}
{"patent_id": "10-2023-0159590", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제6 항에 있어서,상기 사전 학습된 비전-언어 모델을 파인 튜닝하여 이미지 분류 모델을 학습하는 단계는,상기 확장된 샘플 데이터를 배치 사이즈를 기준으로 분류하는 단계와, 각 배치 별 샘플 데이터의 다중 레이블 이미지들을 이미지 인코더에 입력하여 이미지 임베딩을 출력하는단계와, 상기 각 배치 별 샘플 데이터의 하위 텍스트들을 텍스트 인코더에 입력하여 텍스트 임베딩을 출력하는 단계와, 상기 이미지 임베딩과 상기 텍스트 임베딩을 상기 맵핑한 포지티브 쌍과 네거티브 쌍을 기초로 나열하여 유사성메트릭을 생성하는 단계를 포함하는 다중 레이블 이미지에 대한 이미지 분류 모델 학습방법."}
{"patent_id": "10-2023-0159590", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제7 항에 있어서,상기 사전 학습된 비전-언어 모델을 파인 튜닝하여 이미지 분류 모델을 학습하는 단계는,상기 생성한 유사성 메트릭에서 유사도를 완화된 손실함수(Relaxing loss function)를 통해 계산하여 포지티브쌍 사이의 유사도가 완화되도록 학습하는 단계를 포함하는 다중 레이블 이미지에 대한 이미지 분류 모델 학습방법."}
{"patent_id": "10-2023-0159590", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제8 항에 있어서,상기 완화된 손실함수는, 여기서, v, u는 각각 이미지와 텍스트의 정규화된 임베딩 벡터를 의미하고, (vi, ui)는 포지티브 임베딩 샘플이고, (vi, uk)는 네거티브 임베딩 샘플이며, sim은 임베딩 벡터 간 유사성을 계산하는 함수로 예를 들어 코사인유사도(cosine similarity)일 수 있고, τ는 학습가능한 온도(learnable temperature)를 의미하며, N은 배치사이즈(batch size)공개특허 10-2024-0073790-4-인 것을 특징으로 하는 다중 레이블 이미지에 대한 이미지 분류 모델 학습방법."}
{"patent_id": "10-2023-0159590", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "청구항 1항의 이미지 분류 모델 학습방법에 따라서 학습된 이미지 분류 모델을 이용하여 입력 이미지를 분류하는 방법."}
{"patent_id": "10-2023-0159590", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "제10 항에 있어서,유저 컴퓨팅 디바이스로부터 입력 이미지를 획득하는 단계와, 상기 획득한 입력 이미지와, 프롬프트 엔지니어링을 통해 다중 레이블에 대해 생성된 복수의 문장을 상기 이미지 분류 모델에 입력하는 단계와, 상기 이미지 분류 모델로부터 상기 복수의 문장에 대해 각각의 레이블 적용 여부를 검출하는 단계와, 상기 각각의 레이블 적용 여부 검출에 따른 결과를 제공하는 단계를 포함하는 이미지를 분류하는 방법."}
{"patent_id": "10-2023-0159590", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제11 항에 있어서,상기 다중 레이블 이미지는 의료 이미지이고, 상기 이미지 분류 모델은, 상기 의료 이미지에 대한 복수의 병리의 적용 여부를 판별하는 모델인이미지를 분류하는 방법."}
{"patent_id": "10-2023-0159590", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "다중 레이블 특성을 가진 입력 의료 이미지에 대해 복수의 병리에 대해 개별적으로 분류하는 컴퓨팅 디바이스로서, 상기 입력 의료 이미지에 대해 복수의 병리를 분류를 하는 이미지 분류 모델과, 상기 이미지 분류 모델을 제어하는 데이터를 저장하는 메모리; 및상기 메모리의 이미지 분류 모델 및 데이터를 동작 가능하게 결합된 적어도 하나 이상의 프로세서를 포함하고, 상기 적어도 하나 이상의 프로세서는, 복수의 다중 레이블 이미지와 상기 다중 레이블 이미지에 대한 설명을 포함하는 보고서들로 구성된 로 데이터(raw data)를 획득하고,상기 획득한 로 데이터(raw data)에서 기 설정된 기준에 따른 다중 레이블 이미지를 검출하며,상기 검출한 다중 레이블 이미지에 연관된 보고서를 검출하고,상기 검출한 보고서에 포함된 문장을 각각 분리하여 n개의 문장을 검출하며,상기 검출한 n개의 문장을 기초로 복수의 하위 텍스트들을 생성하여 텍스트 데이터 확대(text dataaugmentation)하고,,상기 데이터 확대된 텍스트들과 이미지를 기초로 사전 학습된 비전-언어 모델을 파인 튜닝하여 이미지 분류 모델을 학습하며,상기 학습된 이미지 분류 모델을 제공하는 다중 레이블 이미지에 대한 이미지 분류 모델 학습 시스템."}
{"patent_id": "10-2023-0159590", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_14", "content": "공개특허 10-2024-0073790-5-제13 항에 있어서,상기 적어도 하나의 프로세서는,상기 검출한 n개의 문장을 무작위로 샘플링하여 조합하는 방식으로 상기 복수의 하위 텍스트를 생성하고,제1 다중 레이블 이미지에 대한 제1 보고서로부터 생성된 복수의 하위 텍스트들을 상기 제1 다중 레이블 이미지와 각각 포지티브 쌍으로 맵핑하고, 다른 다중 레이블 이미지와는 네거티브 쌍으로 맵핑하여 확장된 샘플 데이터를 생성하는 다중 레이블 이미지에 대한 이미지 분류 모델 학습 시스템."}
{"patent_id": "10-2023-0159590", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_15", "content": "제14 항에 있어서,상기 적어도 하나의 프로세서는,상기 생성한 샘플 데이터에서 각 배치 별 샘플 데이터의 다중 레이블 이미지들을 이미지 인코더에 입력하여 이미지 임베딩을 출력하고, 상기 각 배치 별 샘플 데이터의 하위 텍스트들을 텍스트 인코더에 입력하여 텍스트 임베딩을 출력하며,상기 이미지 임베딩과 상기 텍스트 임베딩을 상기 맵핑한 포지티브 쌍과 네거티브 쌍을 기초로 나열하여 유사성메트릭을 생성하고,상기 생성한 유사성 메트릭에서 유사도를 완화된 손실함수(Relaxing loss function)를 통해 계산하여 포지티브쌍 사이의 유사도가 완화되도록 학습하는다중 레이블 이미지에 대한 이미지 분류 모델 학습 시스템."}
{"patent_id": "10-2023-0159590", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명의 실시예에 따른 메모리와 프로세서를 포함하는 컴퓨팅 시스템이 이미지 분류 모델을 학습하는 방법으로 서, 복수의 이미지-텍스트 쌍의 샘플 데이터에서 텍스트 데이터 확대(text data augmentation)하는 단계; 상기 데이터 확대된 텍스트들과 이미지를 기초로 사전 학습된 비전-언어 모델을 파인 튜닝하여 이미지 분류 모델을 학 습하는 단계; 및 상기 학습된 이미지 분류 모델을 제공하는 단계를 포함한다."}
{"patent_id": "10-2023-0159590", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 다중 레이블 이미지에 대한 이미지 분류 모델 학습방법 및 시스템, 그리고 상기 이미지 분류 모델을 통해 이미지를 분류하는 방법에 관한 것이다."}
{"patent_id": "10-2023-0159590", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "심층 신경망(deep neural networks)으로 메디컬 이미지를 병리 분류(pathology classification)하는 기술은 다 양한 영역에서 성공적으로 개발되고 있다. 그러나 기존 심층 신경망을 학습하기 위해서는 메디컬 이미지에 대한 라벨링 작업이 필수적이며라벨러들에게 깊 이 있는 의료지식이 필요하기 때문에, 심층 신경망을 강력하게 학습시키기 위한 대규모의 고품질 트레이닝 데이 터셋을 구축하기에는 어려움이 있다. 그런데 최근 대규모 일반 도메인 데이터에 대하여 사전 훈련된(pre-trained) 심층 신경망이 등장하면서, 일반 도메인 데이터로 사전 훈련된 심층 신경망을 이용하여 위 문제점을 해결하는 방안들이 제안되고 있다. 특히, 선행문헌 1(CLIP, Contrastive Language-Image Pretraining)은, 일반적인 이미지-텍스트 쌍을 자기지도 학습(self-supervised)하기 위하여 대조 사전 훈련방식을 제안하며, 비주얼 트랜스포머(visual transformer)의 사전학습 성능을 급격하게 향상시켰다. 이러한 선행문헌 1을 바탕으로 선행문헌 2(CheXzero: Expert-level detection of pathologies from unannotated chest x-ray images via self-supervised learning)은, 대조 이미지-텍스트 인코더를 사용하여 흉 부 X선 이미지와 이에 대한 병리주석을 대조 이미지-텍스트 쌍으로 파인 튜닝하여(finetuning) 흉부 X선 이미지 의 병리를 분류해주는 모델을 개발하였다. 이러한 선행문헌 2는, 200,000쌍이 넘은 흉부 X선 이미지와 각 X선 이미지에 대한 진단 보고서로 선행문헌 1의 사전 훈련된 비주얼 트랜스포머를 파인튜닝하였으며, 파인튜닝된 모델로 제로샷 병리학 분석을 수행해본 결과공인 방사선 전문의와 비슷한 수준의 진단 정확도를 보였다. 즉, 선행문헌 1은, 기존 트레이닝 데이터 셋인 메 디컬 이미지와 라벨링된 이미지-텍스트 페어 없이도 최소한의 트레이닝 데이터 세트로 병리학 분류를 수행할 수 있음을 보여주었다. 그러나 선행문헌 1의 병리분류모델은 선행문헌 1과 동일한 대조학습 프레임워크로 파인튜닝되어, 메디컬 이미지 에 대한 다중 레이블 특성을 분석하지 못하는 단점이 있다. 자세히, 선행문헌 1의 제로샷 분석 방식과 동일한 대조학습목표로 사전 훈련된 선행문헌 2의 병리학 분류 모델은 하나의 흉부 X선 검사 이미지에 대해 폐혼탁 (Lung Opacity), 부종(Edema), 폐렴(Pneumonia) 및 그 밖에 합병증 중에서 복수의 병리가 있음을 검출하지 못 하는 문제가 있다. 또 다른 병리학 분류 모델에 대한 선행문헌 3(MedCLIP: Contrastive learning from unpaired medical images and text)에서는 이미지에 대한 다중 라벨링 문제를 부분적으로 다루고 있지만 이를 해결하기 위한 방법으로, 메디컬 이미지에 대해 전문가의 라벨링된 트레이닝 데이터 셋을 통한 파인 튜닝을 진행하였으며, 전문가의 라벨 링된 데이터를 충분히 확보하기 어려우므로 파인 튜닝에 어려움을 겪는 문제를 갖고 있다. 한편, 제한된 트레이닝 데이터를 확대(data augmentation)시키는 연구 또한 활발하다. 데이터 확대를 위해, 이미지를 다양하게 랜덤 변형(Ex. cropping, horizontal flipping, affine transform, color jittering and Gaussian blurring)한 후 기존 텍스트와 다시 매칭시키는 방식으로 샘플 데이터를 추가하 는 것이 일반적이다. 이때, 메타 데이터를 추가로 이용하기도 한다. 예를 들어, 선행문헌 5(MedAug)는, 동일한 연구 ID를 포함하는 이미지들의 유사 포지티브 쌍으로 하여 훈련을 진행하는 기술을 개시하고 있으며, 선행문헌 6(MICLe)은 메타데이터를 사용하여 동일한 사람에 대한 이미지를 식별하여 사전 훈련시 가중치를 주는 방식으로 파인 튜닝하는 기술을 개시하고 있다. 이러한 선행문헌 5~6은, 동일한 연구 ID, 동일한 사람에 대한 이미지가 부족한 경우, 이미지를 변형하여 데이터 확대시키고, 증대된 데이터들을 포지티브 쌍이 되도록 훈련하는 방식을 개시하고 있다. 선행문헌 7(MCL: Masked Contrative Learning)은 데이터 확대나, 메타 데이터 상으로 포지티브 쌍으로 판별된 데이터들의 유사성이 높게 되도록 새로운 손실함수를 가지는 훈련 방식을 개시하고 있다. 선행기술문헌 선행문헌 1: Alec Radford, Jong Wook Kim, Chris Hallacy, Aditya Ramesh, Gabriel Goh, Sandhini Agarwal, Girish Sastry, Amanda Askell, Pamela Mishkin, Jack Clark, Gretchen Krueger, Ilya Sutskever. Learning Transferable Visual Models From Natural Language Supervision, on 26 Feb 2021 선행문헌 2: Ekin Tiu, Ellie Talius, Pujan Patel, Curtis P Langlotz, Andrew Y Ng, and Pranav Rajpurkar. Expert-level detection of pathologies from unannotated chest x-ray images via selfsupervised learning. Nature Biomedical Engineering, pages 1?8, 2022. 선행문헌 3: Zifeng Wang, Zhenbang Wu, Dinesh Agarwal, and Jimeng Sun. Medclip: Contrastive learning from unpaired medical images and text. In EMNLP, 2022. 선행문헌 4: Yuhao Zhang, Hang Jiang, Yasuhide Miura, Christopher D Manning, and Curtis P Langlotz. Contrastive learning of medical visual representations from paired images and text. arXiv preprint arXiv:2010.00747, 2020. 선행문헌 5: Yen Nhi Truong Vu, Richard Wang, Niranjan Balachandar, Can Liu, Andrew Y Ng, and Pranav Rajpurkar. Medaug: Contrastive learning leveraging patient metadata improves representations for chest x-ray interpretation. In Machine Learning for Healthcare Conference, pages 755?769. PMLR, 2021. 선행문헌 6: Shekoofeh Azizi, Basil Mustafa, Fiona Ryan, Zachary Beaver, Jan Freyberg, Jonathan Deaton, Aaron Loh, Alan Karthikesalingam, Simon Kornblith, Ting Chen, et al. Big self-supervised models advance medical image classification. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 3478?3488, 2021. 선행문헌 7: Maria de la Iglesia-Vay´a. Padchest: A large chest x-ray image dataset with multi-label annotated reports. Medical image analysis, 66:101797, 2020."}
{"patent_id": "10-2023-0159590", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은 전술한 문제점을 극복하고자 대조 지도로 사전 훈련된 비전-언어 모델(예컨대, CLIP)을 파인튜닝하여 다중 라벨링 특성(multi-label nature)의 이미지에 대해 각각의 레이블 분류(classification)가 정확하게 수행 하는 이미지 분류 모델을 제공하고자 한다. 또한, 본 발명의 이러한 이미지 분류 모델을 이용하여 다중 라벨 특성(multi-label nature)을 가진 카테고리의 이미지들에 대해 다중 라벨 각각에 대한 분류(classification)를 수행할 수 있는 이미지 분류 방법을 제공하고 자 한다. 예를 들어, 본 발명은 상기 이미지 분류 모델은 메디컬 이미지의 복수의 병리에 대한 진단을 수행하는 병리 분 류(pathology classification) 방법을 제공하고자 한다. 특히, 본 발명의 다중 레이블 이미지를 대조 학습하는 방법은, 메디컬 이미지-텍스트 쌍의 다중 레이블 특성을 고려하여 제로샷으로 병리를 분류할 수 있는 새로운 파인 튜닝 기법을 제안하고자 한다. 구체적으로, 본 발명의 다중 레이블 이미지를 대조 학습하는 방법은, 자체 스트림 제로샷 병리학 분류 성능을 향상시키기 위한 문장 샘플링 및 포지티브페어 손실 완화를 기반으로 하는 새로운 파인튜닝 전략을 제안하고자 한다."}
{"patent_id": "10-2023-0159590", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명의 실시예에 따른 메모리와 프로세서를 포함하는 컴퓨팅 시스템이 이미지 분류 모델을 학습하는 방법으 로서, 복수의 이미지-텍스트 쌍의 샘플 데이터에서 텍스트 데이터 확대(text data augmentation)하는 단계; 상 기 데이터 확대된 텍스트들과 이미지를 기초로 사전 학습된 비전-언어 모델을 파인 튜닝하여 이미지 분류 모델 을 학습하는 단계; 및 상기 학습된 이미지 분류 모델을 제공하는 단계를 포함한다. 또한, 본 발명의 실시예에 따른 다중 레이블 특성을 가진 입력 의료 이미지에 대해 복수의 병리에 대해 개별적 으로 분류하는 컴퓨팅 디바이스로서, 상기 입력 의료 이미지에 대해 복수의 병리를 분류를 하는 이미지 분류 모 델과, 상기 이미지 분류 모델을 제어하는 데이터를 저장하는 메모리; 및 상기 메모리의 이미지 분류 모델 및 데 이터를 동작 가능하게 결합된 적어도 하나 이상의 프로세서를 포함하고, 상기 적어도 하나 이상의 프로세서는, 복수의 다중 레이블 이미지와 상기 다중 레이블 이미지에 대한 설명을 포 함하는 보고서들로 구성된 로 데이터(raw data)를 획득하고, 상기 획득한 로 데이터(raw data)에서 기 설정된 기준에 따른 다중 레이블 이미지를 검출하며, 상기 검출한 다중 레이블 이미지에 연관된 보고서를 검출하고, 상 기 검출한 보고서에 포함된 문장을 각각 분리하여 n개의 문장을 검출하며, 상기 검출한 n개의 문장을 기초로 복 수의 하위 텍스트들을 생성하여 텍스트 데이터 확대(text data augmentation)하고,, 상기 데이터 확대된 텍스트 들과 이미지를 기초로 사전 학습된 비전-언어 모델을 파인 튜닝하여 이미지 분류 모델을 학습하며, 상기 학습된 이미지 분류 모델을 제공한다."}
{"patent_id": "10-2023-0159590", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명의 다중 레이블 이미지에 대한 이미지 분류 모델 학습방법은, 일반 도메인 이미지-텍스트 쌍으로 사전 훈련된 이미지 분류 모델을 별도의 라벨링 작업 없는 트레이닝 데이터 세트로 파인 튜닝하여 다운스트림 제로샷 성능을 향상시킨 이미지 분류 모델를 제공할 수 있다. 이러한 본 발명의 이미지 분류 모델 및 이를 이용한 이미지 분류 방법은, 다중 레이블 특성을 가진 이미지에 대 해 각 레이블의 적용여부를 판별하여 중복 분류를 정확하게 수행할 수 있다. 구체적으로, 실시예에 따른 이미지 분류 학습방법으로 사전 훈련된 비전-언어 모델을 파인튜닝하였을 때 평균적 으로 제로샷 병리학 분류를 수행한 결과 AUROC가 5.77% 향상됨을 확인할 수 있었다. 또한, 본 발명의 이미지 분 류 모델은, 위원회 인증을 받은 방사선 전문의와 훨씬 비슷하거나 더 나은 성능을 보여주었다. 구체적으로, 본 발명의 이미지 분류 모델은, CheXpert 데이터세트의 5가지 주요 질병에 대한 제로샷 분류에서 (F1 점수는 0.619 대 0.625, MCC는 0.530 대 0.544)로 상대적으로 높은 정확도의 이미지 레이블 분류를 수행한것을 확인할 수 있다."}
{"patent_id": "10-2023-0159590", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "본 발명은 다양한 변환을 가할 수 있고 여러 가지 실시예를 가질 수 있는 바, 특정 실시예들을 도면에 예시하고"}
{"patent_id": "10-2023-0159590", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "상세한 설명에 상세하게 설명하고자 한다. 본 발명의 효과 및 특징, 그리고 그것들을 달성하는 방법은 도면과 함께 상세하게 후술되어 있는 실시예들을 참조하면 명확해질 것이다. 그러나 본 발명은 이하에서 개시되는 실시 예들에 한정되는 것이 아니라 다양한 형태로 구현될 수 있다. 이하의 실시예에서, 제1, 제2 등의 용어는 한정적 인 의미가 아니라 하나의 구성 요소를 다른 구성 요소와 구별하는 목적으로 사용되었다. 또한, 단수의 표현은 문맥상 명백하게 다르게 뜻하지 않는 한, 복수의 표현을 포함한다. 또한, 포함하다 또는 가지다 등의 용어는 명 세서상에 기재된 특징, 또는 구성요소가 존재함을 의미하는 것이고, 하나 이상의 다른 특징들 또는 구성요소가 부가될 가능성을 미리 배제하는 것은 아니다. 이하, 첨부된 도면을 참조하여 본 발명의 실시예들을 상세히 설명하기로 하며, 도면을 참조하여 설명할 때 동일 하거나 대응하는 구성 요소는 동일한 도면부호를 부여하고 이에 대한 중복되는 설명은 생략하기로 한다. [이미지 분류 모델을 학습하고, 학습된 이미지 분류 모델을 통해 이미지 분류를 수행하는 예시적인 시스템] 도 1은 본 발명의 실시예에 따른 다중 레이블의 이미지 분류를 효과적으로 정확하게 수행하는 이미지 분류 모델 을 학습 및 제어하는 컴퓨팅 시스템의 블록도의 예시를 도시한다. 도 1을 참조하면, 본 발명의 이미지 분류 모델을 학습/동작하는 컴퓨팅 시스템은, 유저 컴퓨팅 디바이스 , 트레이닝 컴퓨팅 시스템 및 서버 컴퓨팅 시스템을 포함하며, 디바이스들은 네트워크를 통해 통신 가능하다. 본 발명의 실시예에 따른 이미지 분류 방법은, 1) 유저 컴퓨팅 디바이스가 로컬에서 직접 이미지분류 모델 을 학습시키고, 학습된 이미지 분류 모델을 통해 이미지 분류를 수행할 수 있으며, 2) 유저 컴퓨팅 디바이스 와 통신하는 서버 컴퓨팅 시스템에 포함되어 웹서비스 형태로 제공될 수 있으며, 3) 유저 컴퓨팅 디 바이스와 서버 컴퓨팅 시스템이 서로 연계하여 이미지 분류 모델을 통해 이미지 분류를 수행할 수 있 다. 사용자 컴퓨팅 디바이스 및/또는 서버 컴퓨팅 시스템은 네트워크를 통해 통신적으로 연결된 트 레이닝 컴퓨팅 시스템과의 인터렉션을 통해 머신 러닝 모델(120 또는/및 140)을 트레이닝할 수 있다. 트레 이닝 컴퓨팅 시스템은 서버 컴퓨팅 시스템과 별개이거나 서버 컴퓨팅 시스템의 일부일 수 있다. 그리고 이때, 이미지 분류 모델은, 1) 유저 컴퓨팅 디바이스가 로컬에서 직접 학습시키거나, 2) 서버 컴퓨 팅 시스템과 유저 컴퓨팅 디바이스가 네트워크를 통해 서로 인터랙션하며 학습할 수 있고, 3) 별도의 트레이닝 컴퓨팅 시스템이 서버 컴퓨팅 시스템이미지 분류 모델을 다양한 트레이닝 기법과 학 습 기법을 사용하여 학습시킬 수 있다 그리고 트레이닝 컴퓨팅 시스템이 학습시킨 이미지 분류 모델을 네 트워크를 통해 유저 컴퓨팅 디바이스 또는/및 서버 컴퓨팅 시스템에 전송하여 제공/업데이트 하 는 방식으로 구현될 수도 있다. 일부 실시예에서, 트레이닝 컴퓨팅 시스템은, 서버 컴퓨팅 시스템의 일부이거나, 유저 컴퓨팅 디바이 스에 일부일 수 있다. 유저 컴퓨팅 디바이스는, 스마트 폰(smart phone), 휴대폰, 디지털방송용 디바이스, PDA(personal digital assistants), PMP(portable multimedia player), 데스크 탑, 웨어러블 디바이스, 임베디드 컴퓨팅 장 치 및/또는 태블릿 PC(tablet PC) 등 기타 모든 유형의 컴퓨팅 장치를 포함할 수 있다. 이러한 유저 컴퓨팅 디바이스는, 적어도 하나 이상의 프로세서 및 메모리를 포함한다. 여기서, 프로세서는, 중앙처리장치(CPU), 그래픽처리장치(GPU), ASICs (application specific integrated circuits), DSPs(digital signal processors), DSPDs(digital signal processing devices), PLDs(programmable logic devices), FPGAs(field programmable gate arrays), 제어기(controllers), 마이크로 컨트롤러(micro-controllers), 마이크로 프로세스(microprocessors) 및/또는 기타 기능 수행을 위한 전기적 유 닛 중 적어도 하나 또는 전기적으로 연결된 복수의 프로세서들로 구성될 수 있다. 그리고 메모리는, RAM, ROM, EEPROM, EPROM, 플래시 메모리 디바이스, 자기 디스크 등 같은 하나 이상의 비일시적/일시적 컴퓨터 판독가능한 저장 매체 및 이들의 조합을 포함할 수 있고, 인터넷(internet) 상에서 메 모리의 저장 기능을 수행하는 서버의 웹 스토리지(web storage)를 포함할 수 있다. 이러한 메모리는, 상기 적어도 하나 이상의 프로세서가 이미지 분류 모델을 학습하거나, 이미지 분류 모델을 통해 이미지 분류 등의 동 작을 수행하기 위하여 필요한 데이터 및 명령어들을 저장할 수 있다. 일 실시예에서, 유저 컴퓨팅 디바이스는, 적어도 하나 이상의 머신 러닝 모델들을 저장할 수 있다. 자세히, 머신 러닝 모델은, 복수의 뉴럴 네트워크(예를 들어, Deep neural network)와 같은 다양한 머신 러닝 모델들 또는 비선형 모델 및/또는 선형 모델을 포함하는 다른 유형의 머신 러닝 모델들일 수 있으며, 이들 의 조합으로 구성할 수 있다. 그리고 뉴럴 네트워크는 피드-포워드 뉴럴 네트워크들(feed-forward neural networks), 순환 뉴럴 네트워크(예 를 들어, 장단기 메모리 순환 뉴럴 네트워크들), 컨벌루션 뉴럴 네트워크 또는/및 다른 형태의 뉴럴 네트워크들 중 적어도 하나 이상을 포함할 수 있다. 일 실시예에서, 유저 컴퓨팅 디바이스는, 네트워크를 통해서 서버 컴퓨팅 시스템으로부터 적어 도 하나 이상의 머신 러닝 모델을 수신하고, 메모리(!12)에 저장한 후, 저장된 머신 러닝 모델을 프 로세서에 의해 실행하여, 이미지 분류 방법 등을 수행할 수 있다. 다른 실시예에서, 서버 컴퓨팅 시스템은, 적어도 하나 이상의 머신 러닝 모델을 포함하여 머신 러닝 모델을 통한 동작을 수행하며, 유저 컴퓨팅 디바이스와 이와 관련된 데이터를 통신하는 방식으로 유 저 컴퓨팅 디바이스와 연동해 이미지 분류 방법을 통한 서비스를 유저에게 제공할 수 있다. 예를 들어, 유 저 컴퓨팅 디바이스는, 웹을 통해 서버 컴퓨팅 시스템이 머신 러닝 모델을 이용하여 유저의 입 력에 대한 출력을 제공하는 방식으로 이미지 분류 방법이 수행될 수 있다. 또한, 머신 러닝 모델들(120 또는/및 140) 중 적어도 일부는 유저 컴퓨팅 디바이스에서 실행되고, 나머지는 서버 컴퓨팅 시스템에서 실행 되는 방식으로도 이미지 분류 모델이 구현될 수 있다. 또한, 유저 컴퓨팅 디바이스는, 유저의 입력을 감지하는 적어도 하나 이상의 입력 컴포넌트를 포함할 수 있다. 예를 들어, 유저 입력 컴포넌트는, 유저의 입력 매체(예를 들어, 손가락 또는 스타일러스)의 터치를 감지 하는 터치 센서(예를 들어, 터치 스크린 또는/및 터치 패드 등), 유저의 모션 입력을 감지하는 이미지 센서, 유 저 음성 입력을 감지하는 마이크로폰, 버튼, 마우스 및/또는 키보드 등을 포함할 수 있다. 또한, 유저 입력 컴 포넌트는, 인터페이스를 통해 외부 컨트롤러(예컨대, 마우스, 키보드 등)에 대한 입력을 수신할 경우에, 인터페이스와 외부 컨트롤러가 포함될 수 있다. 서버 컴퓨팅 시스템은 적어도 하나 이상의 프로세서와 메모리를 포함한다. 여기서, 프로세서 는, 중앙처리장치(CPU), 그래픽처리장치(GPU), ASICs (application specific integrated circuits), DSPs(digital signal processors), DSPDs(digital signal processing devices), PLDs(programmable logic devices), FPGAs(field programmable gate arrays), 제어기(controllers), 마이크로 컨트롤러(micro- controllers), 마이크로 프로세스(microprocessors) 및/또는 기타 기능 수행을 위한 전기적 유닛 중 적어도 하 나 또는 전기적으로 연결된 복수의 프로세서들로 구성될 수 있다. 그리고 메모리는, RAM, ROM, EEPROM, EPROM, 플래시 메모리 디바이스, 자기 디스크 등 같은 하나 이상의 비일시적/일시적 컴퓨터 판독가능한 저장 매체 및 이들의 조합을 포함할 수 있다. 이러한 메모리는, 프로 세서가 이미지 분류 모델을 학습하거나, 이미지 분류 모델을 통해 이미지 분류 등의 동작을 수행하기 위하여 필 요한 데이터 및 명령어들을 저장할 수 있다. 일 실시예에서, 서버 컴퓨팅 시스템은, 적어도 하나 이상의 컴퓨팅 디바이스를 포함하여 구현될 수 있다. 예를 들어, 서버 컴퓨팅 시스템은, 복수의 컴퓨팅 디바이스를 순차적 컴퓨팅 아키텍처, 병렬 컴퓨팅 아키 텍처 또는 이들의 조합에 따라 동작하도록 구현될 수 있다. 또한, 서버 컴퓨팅 시스템은, 네트워크로 연결된 복수의 컴퓨팅 디바이스를 포함할 수 있다. 또한, 서버 컴퓨팅 시스템은 적어도 하나 이상의 머신 러닝 모델을 저장할 수 있다. 예를 들어, 서버 컴퓨팅 시스템은, 머신 러닝 모델로 뉴럴 네트워크 또는/및 기타 멀티 레이어 비선형 모델을 포함할 수 있 다. 예시적 신경 네트워크는 피드 포워드 뉴럴 네트워크, 딥 뉴럴 네트워크, 순환 뉴럴 네트워크 및 컨벌 루션 뉴럴 네트워크를 포함할 수 있다. 트레이닝 컴퓨팅 시스템은 적어도 하나 이상의 프로세서와 메모리를 포함한다. 여기서, 프로세 서는, 중앙처리장치(CPU), 그래픽처리장치(GPU), ASICs (application specific integrated circuits), DSPs(digital signal processors), DSPDs(digital signal processing devices), PLDs(programmable logic devices), FPGAs(field programmable gate arrays), 제어기(controllers), 마이크로 컨트롤러(micro- controllers), 마이크로 프로세스(microprocessors) 및/또는 기타 기능 수행을 위한 전기적 유닛 중 적어도 하 나 또는 전기적으로 연결된 복수의 프로세서들로 구성될 수 있다. 그리고 메모리는, RAM, ROM, EEPROM, EPROM, 플래시 메모리 디바이스, 자기 디스크 등 같은 하나 이상의 비일시적/일시적 컴퓨터 판독가능한 저장 매 체 및 이들의 조합을 포함할 수 있다. 이러한 메모리는, 프로세서가 이미지 분류 모델을 학습을 수행하기 위하여 필요한 데이터 및 명령어들을 저장할 수 있다. 예를 들어, 트레이닝 컴퓨팅 시스템은, 에러의 역방향 전파와 같은 다양한 트레이닝, 파인 튜닝 또는 학습 기법을 사용하여(도 7에 도시된 프레임워크에 따라), 유저 컴퓨팅 디바이스 또는/및 서버 컴퓨팅 시스템 에 저장된 머신 러닝 모델(120 또는/및 140)을 학습(training)하는 모델 트레이너를 포함할 수 있다. 예를 들어, 모델 트레이너는, 정의된 손실 함수에 기초하여 머신 러닝 모델(120 또는/및 140)의 하나 이상 의 파라미터를 업데이트를 역전파 방식으로 수행할 수 있다. 예를 들어 식 1 내지 4에서 기술된 것과 같은 완화 된 손실 함수를 평균 제곱 오차, 우도 손실, 교차 엔트로피 손실, 힌지 손실 및/또는 다양한 기타 손실 함수와 같은 다양한 손실 함수가 사용될 수 있다. 자세히, 모델 트레이너는, 이미지와 텍스트 임베딩 벡터의 쌍으로 구성된 유사성 메트릭에 대해 완화된 손실함 수를 이용해 학습하는 과정을 적어도 일회 이상 반복하여 뉴럴 네트워크의 파라미터를 업데이트하여 이미지 분 류 모델을 학습시킬 수 있다. 일부 구현예에서, 에러의 역방향 전파를 수행하는 것은 시간을 통한 잘린 역 전파(truncated backpropagation through time)를 수행하는 것을 포함할 수 있다. 모델 트레이너는 트레이닝되는 머신 러닝 모델(120 또는/ 및 140)의 일반화 능력을 향상시키기 위해 다수의 일반화 기법들(예를 들어, 가중치 감소, 드롭 아웃, 지식 증 류 등)을 수행할 수 있다. 특히, 모델 트레이너는 일련의 트레이닝 데이터에 기초하여 머신 러닝 모델(120 또는/및 140)을 트레 이닝할 수 있다. 트레이닝 데이터는 예를 들어, 이미지, 오디오 샘플, 텍스트 등과 같은 상이한 양식의 데 이터를 포함할 수 있다. 사용될 수 있는 이미지 유형의 예는 비디오 프레임, LiDAR 포인트 클라우드, X선 이미 지, 컴퓨터 단층 촬영 스캔, 초분광 이미지 및/또는 다양한 기타 형태의 이미지를 포함할 수 있다. 실시예에서, 트레이닝 데이터는, 이미지-텍스트 쌍으로 구성되며, 이미지는 다중 레이블 중 적어도 하나에 해당할 수 있는 다중 레이블 특성을 가진 이미지이고, 텍스트는 이미지에 대한 설명을 포함하는 리포트로 상기 이미지가 다중 레이블에 각각에 해당되는지 여부에 대한 정보를 포함할 수 있다. 이러한, 이미지-텍스트 쌍에서 텍스트는 이미지에 대해 연관된 문장으로 자기지도학습(self-supervised learning)을 위해 특정 기준에 따라 샘플 데이터에서 이미지와 연관되어 검출된 텍스트를 의미할 수 있다. 즉, 라벨러가 이미지에 대해 라벨링 작업으로 생성한 레이블이 아닌, 샘플 데이터에 포함된 텍스트 중 이미지에 대 해 연관된 텍스트를 의미할 수 있다. 예를 들어, 의료 이미지에 대한 진단 보고서가 트레이닝 데이터의 이미지-텍스트 쌍일 수 있으며, 좀더 구체적 으로, 폐 방사선 이미지와, 폐 방사선 이미지에 대해 전문가가 작성한 병리 진단 보고서를 묶은 것을 의미할 수 있다. 이러한 트레이닝 데이터와, 이미지 분류 대상 데이터는, 유저 컴퓨팅 디바이스 또는/및 서버 컴퓨팅 시스템에 의해 제공될 수 있다. 유저 컴퓨팅 디바이스의 특정 데이터에 대해 트레이닝 컴퓨팅 시스템 이 머신 러닝 모델을 학습시킬 경우, 머신 러닝 모델은 개인화된 모델로 특성화될 수 있다. 그리고 모델 트레이너는 원하는 기능을 제공하기 위해 활용되는 컴퓨터 로직을 포함한다. 모델 트레이너 는 범용 프로세서를 제어하는 하드웨어, 펌웨어 및/또는 소프트웨어로 구현될 수 있다. 예를 들어, 일 실 시예에서, 모델 트레이너는 저장 디바이스에 저장된 프로그램 파일을 포함하고, 메모리에 로딩되고 하나 이상의 프로세서에 의해 실행될 수 있다. 네트워크는 3GPP(3rd Generation Partnership Project) 네트워크, LTE(Long Term Evolution) 네트워크, WIMAX(World Interoperability for Microwave Access) 네트워크, 인터넷(Internet), LAN(Local Area Network), Wireless LAN(Wireless Local Area Network), WAN(Wide Area Network), PAN(Personal Area Network), 블루투스(Bluetooth) 네트워크, 위성 방송 네트워크, 아날로그 방송 네트워크 및/또는 DMB(Digital Multimedia Broadcasting) 네트워크 등이 포함되나 이에 한정되지는 않는다. 일반적으로, 네트워크를 통한 통신은 임의의 유형의 유선 및/또는 무선 연결을 사용하여, 다양한 통신 프 로토콜들(예를 들어, TCP/IP, HTTP, SMTP, FTP), 인코딩 또는 포맷들(예를 들어, HTML, XML), 및/또는 보호 스 키마(예를 들어, VPN, 시큐어 HTTP, SSL)를 통해 수행될 수 있다. 도 2는 본 발명의 실시예에 따른 다중 레이블의 이미지 분류를 효과적으로 정확하게 수행하는 이미지 분류 모델 을 학습 및 제어하는 컴퓨팅 디바이스의 블록도의 예시를 도시한다. 도 2를 포함하면, 유저 컴퓨팅 디바이스, 서버 컴퓨팅 시스템 및 트레이닝 컴퓨팅 시스템에 포 함되는 컴퓨팅 디바이스는, 다수의 애플리케이션(예를 들어, 애플리케이션 1 내지 애플리케이션 N)을 포함 한다. 각 애플리케이션은 머신 러닝 라이브러리 및 하나 이상의 머신 러닝 모델을 포함할 수 있다. 예를 들어, 애플리케이션은 이미지 처리(예를 들어, detection, classification, segmentation 등) 애플리케이션, 텍스트 메시징 애플리케이션, 이메일 애플리케이션, 받아쓰기 애플리케이션, 가상 키보드 애플리케이션, 브라우저 애플 리케이션, 쳇-봇(chat-bot) 애플리케이션 등을 포함할 수 있다. 실시예에서, 컴퓨팅 디바이스는, 이미지 분류 모델을 학습시키기 위한 모델 트레이너를 포함할 수 있 고, 상기 학습된 이미지 분류 모델을 저장하고 동작시켜 입력 이미지에 대한 이미지 분류를 수행할 수 있다. 컴퓨팅 디바이스의 각 애플리케이션은 예를 들어, 하나 이상의 센서, 컨텍스트 관리자, 디바이스 상태 컴 포넌트 및/또는 추가 컴포넌트들과 같은 컴퓨팅 디바이스의 다수의 다른 컴포넌트들과 통신할 수 있다. 일 실시예에서, 각 애플리케이션은 API(예를 들어, 퍼블릭 API)를 사용하여 각 디바이스 컴포넌트와 통신할 수 있 다. 일 실시예에서, 각 애플리케이션에 의해 사용되는 API는 해당 애플리케이션에 대해 특정적일 수 있다. 도 3은 본 발명의 실시예에 따른 다중 레이블의 이미지 분류를 효과적으로 정확하게 수행하는 이미지 분류 모델 을 학습 및 제어하는 컴퓨팅 디바이스에 대한 다른 측면에서의 블록도의 예시를 도시한다. 도 3을 참조하면, 컴퓨팅 디바이스는 다수의 애플리케이션(예를 들어, 애플리케이션 1 내지 애플리케이션 N)을 포함한다. 각 애플리케이션은 중앙 인텔리전스 레이어와 통신할 수 있다. 예를 들어, 애플리케이션은 이미 지 처리 애플리에키션, 문자 메시지 애플리케이션, 이메일 애플리케이션, 받아쓰기 애플리케이션, 가상 키보드 애플리케이션, 브라우저 애플리케이션 등을 포함할 수 있다. 일 실시예에서, 각 애플리케이션은 API(예: 모든 애플리케이션에 걸쳐 공통 API)를 사용하여 중앙 인텔리전스 레이어(및 그 안에 저장된 모델)과 통신할 수있다. 중앙 인텔리전스 레이어는 다수의 머신 러닝 모델들을 포함할 수 있다. 예를 들어, 도 3에 도시된 바와 같이, 각각의 머신 러닝 모델 중 적어도 일부가 각 애플리케이션에 대해 제공될 수 있고, 중앙 인텔리전스 레이어에 의해 관리될 수 있다. 다른 구현예에서, 2개 이상의 애플리케이션들은 단일의 머신 러닝 모델을 공유할 수 있다. 예를 들어, 일부 구현예에서, 중앙 인텔리전스 레이어는 모든 애플리케이션에 대해 단일 모델을 제공할 수 있다. 일부 구현예에서, 중앙 인텔리전스 레이어는 컴퓨팅 디바이스의 운영 체제 내에 포함되거나 이와 다르게 구현될 수 있다. 중앙 인텔리전스 레이어는 중앙 디바이스 데이터 레이어와 통신할 수 있다. 중앙 디바이스 데이터 레이어는 컴 퓨팅 디바이스에 대한 중앙 집중식 데이터 저장소일 수 있다. 도 3에 도시된 바와 같이, 중앙 디바이스 데 이터 레이어는 예를 들어, 하나 이상의 센서, 컨텍스트 관리자, 디바이스 상태 컴포넌트 및/또는 추가 컴포넌트 들과 같은 컴퓨팅 디바이스의 다수의 다른 컴포넌트들과 통신할 수 있다. 일부 구현예에서, 중앙 디바이스 데이터 레이어는 API(예를 들어, 사설 API)를 사용하여 각 디바이스 컴포넌트와 통신할 수 있다. 본 명세서에서 설명한 기술은 서버, 데이터베이스, 소프트웨어 애플리케이션들 및 다른 컴퓨터 기반 시스템들 뿐만 아니라 취해진 액션들 및 상기 시스템으로 전송되거나 그로부터 전송된 정보를 참조할 수 있다. 컴퓨터 기 반 시스템들의 내재적 유연성은 광범위한 가능한 구성들, 조합들 및 작업의 분할 및 컴포넌트들 간의 및 그로부 터의 기능성을 허용함을 인식할 것이다. 예를 들어, 본 명세서에서 기술한 프로세스들은 단일의 디바이스 또는 컴포넌트 또는 조합으로 작동하는 다수의 디바이스들 또는 컴포넌트들을 사용하여 구현될 수 있다. 데이터베이 스 및 애플리케이션들은 단일 시스템 또는 다수의 시스템들에 걸쳐 분산된 시스템에서 구현될 수 있다. 분산 컴 포넌트들은 순차적으로 또는 병렬로 동작할 수 있다. [이미지 분류 모델 학습 방법 및 이미지 분류 모델을 통한 이미지 분류 방법] 이하, 이러한 이미지 분류 모델을 학습/동작하는 컴퓨팅 시스템이, 이미지 분류 모델을 학습하고, 학습한 이미지 분류 모델을 통해 이미지 분류를 수행하는 방법을 상세히 설명한다. 여기서, 분류 대상인 이미지는, 복수의 레이블에 대해 각각 적용여부가 개별적으로 결정되는 다중 레이블 특성 (multi-label nature)을 가진 이미지일 수 있다. 예를 들어, X선 이미지, 컴퓨터 단층 촬영 스캔 이미지 등을 포함하는 의료 이미지(예를 들어, 흉부 X선 검사 이미지)는, 복수의 병리(예를 들어, 폐혼탁(Lung Opacity), 부 종(Edema), 폐렴(Pneumonia))에 대해 각각 진단될 수 있으므로 의료 이미지에 대해 진단될 수 있는 복수의 병리 들이 복수의 레이블에 해당할 수 있다. 이하 설명에서는, 다중 레이블 특성을 가진 이미지로 의료 이미지를 대표하여 설명하며, 의료 이미지에 대한 레 이블은 의료 이미지에 대해 진단 가능한 병리들인 것을 기준으로 설명한다. 본 발명에 따른 컴퓨팅 시스템이 이미지 분류 모델을 학습방법은, 사전 훈련된 비전-언어 모델을 의료 이 미지에 대한 샘플 데이터(이미지-텍스트 쌍)를 통해 파인 튜닝하여, 효과적으로 다중 레이블 특성의 의료 이미 지를 정확하게 분류할 수 있는 이미지 분류 모델을 학습시켜, 제로 샷 의료 이미지에 대한 복수의 병리 분류에 서 일관된 개선을 가져왔으며, 인증된 위원회의 방사선 전문의보다 더 나은 정확도로 병리 분류를 수행할 수 있 다. 여기서 사전 훈련된 비전-언어 모델은, CLIP(Contrastive Language-Image Pretraining), BigGAN, Slip(Self- supervision meets language-image pretraining) 또는/및 Uniclip(Unified framework for contrastive language-image pretraining) 등 일반 도메인에서의 이미지-텍스트 쌍들로부터 대조 학습된 모델들일 수 있다. 본 발명의 실시예에서 이미지 분류 모델 학습방법에서 파인 튜닝 기법은, 1) 샘플 데이터의 부족 문제를 해결하 기 위한 데이터 확대(data augmentation)를 할 수 있다. 이를 통해, 의료 이미지에 대한 라벨링 작업(예컨대, 주석 작업)이 불필요하며, 의료 이미지에 대해 병리 분류에 필요한 텍스트들만 추출하고, 추출된 텍스트들을 확 대하여 다수의 샘플 데이터를 확보함으로써, 이미지 분류 모델의 파인 튜닝을 원활하게 수행할 수 있다. 또한, 본 발명의 실시예에서 이미지 분류 모델 학습방법에서 파인 튜닝 기법은, 2) 포지티브 쌍의 이미지-텍스 트 사이의 벡터 유사성을 완화하는 손실 함수(Relaxing loss function)를 적용하여, 다중 레이블 특성을 가진 의료 이미지에 대한 각 레이블 별 분류 정확도를 더욱 향상시킬 수 있다. 이하, 이러한 이미지 분류 모델 학습방법에 대해 도 4 내지 도 7을 참조하여 좀더 상세히 설명한다. 실시예에 따른 이미지 분류 모델 학습방법은, 샘플 데이터를 생성하는 단계(S101)와, 샘플 데이터의 이미지-텍 스트를 각각 인코딩하여 임베딩을 출력하는 단계(S103)와, 출력한 이미지 임베딩과, 텍스트 임베딩을 포지티브/ 네가티브 쌍으로 유사성 메트릭을 생성하는 단계(S105)와, 생성한 유사성 메트릭이 완화된 손실함수를 기초로 포지티브 쌍이 유사성을 갖도록 학습하는 단계(S107)를 포함할 수 있다. 그리고 이미지 분류 모델을 기초로 이 미지 분류하는 방법은, 전술한 바와 같이 학습된 이미지 분류 모델을 기초로 입력 이미지의 다중 레이블에 각각 해당하는지 여부에 대한 분류 작업 수행하는 단계(S109)와, 상기 이미지 분류 작업에 따라 입력 이미지에 대한 다중 레이블 분류 작업 결과를 제공하는 단계(S111)을 포함할 수 있다. 구체적으로, 컴퓨팅 시스템은, 샘플 데이터를 생성할 수 있다. (S101) 자세히, 컴퓨팅 시스템은, 로-데이터(raw-data)에서 기 정해진 기준에 해당하는 의료 이미지를 검출하고, 검출한 의료 이미지에 연관된 진단 보고서를 검출할 수 있다. 여기서, 로-데이터는, 다수의 의료 이미지와 의료 이미지에 대한 진단 보고서를 포함하는 전자의료기록(EMR: Electronic Medical Record)일 수 있다. 예를 들어, 컴퓨팅 시스템은, 의료 이미지에 대해 1) 특정 신체기관을 결정하고, 2) 이미지 종류(예를 들 어, RGB 이미지, 방사선 이미지, 컴퓨터 단층촬영 이미지 등)를 결정하면, 이미지 검출 모델을 통해서 설정된 특정 신체기관에 대한 특정 종류의 이미지를 샘플 데이터의 이미지로 검출할 수 있다. 그리고 컴퓨팅 시스템은, 검출된 샘플 데이터의 의료 이미지에 대한 진단 보고서를 검출할 수 있다. 예를 들어, 컴퓨팅 시스템은, 로-데이터의 작성 형식에 따라서 메타 데이터 또는/및 작성 템플릿 등을 기초로 연관 진단 보고서를 샘플 데이터의 텍스트로 결정할 수 있다. 예를 들어, 컴퓨팅 시스템은, 의료 이미지 의 ID와 매칭되는 ID를 포함하는 문장을 추출하는 방식 또는/및 의료 이미지에 전단부 또는 후단부에 기재된 문 장을 추출하는 방식을 로-데이터 작성 형식에 따라 기준을 설정하면, 설정된 기준에 따라 연관된 진단 보고서를 샘플 데이터로 추출할 수 있다. 이때, 컴퓨팅 시스템은, 의료 이미지에 대한 병리학 분류에 정보를 내포 하고 있는 “발견(Findings)”와, “인상(Impression)”에 대한 단락을 모두 포함하도록 진단 보고서를 검출할 수 있다. 그리고 컴퓨팅 시스템은, 이와 같이 추출한 샘플 데이터의 의료 이미지와 진단 보고서를 매칭하여 샘플 데이터의 이미지-텍스트 쌍으로 저장할 수 있다. 또한, 컴퓨팅 시스템은, 사전 훈련된 비전-언어 모델의 트레이닝 데이터 대비 상대적으로 적은 샘플 데이 터를 부족 문제를 극복하기 위하여, 데이터 확대(data augmentation)을 수행할 수 있다. 여기서, 데이터 확대란, 기존 샘플 데이터를 기초로 추가 샘플 데이터를 생성하여 증대시키는 것을 의미한다. 도 5를 참조하면, 의료 이미지에 대해 연관된 전체 진단 보고서를 텍스트로 하여, 이미지-텍스트 쌍으로 설정할 경우, (a) 다이어그램과 같이 이미지-텍스트 간의 유사성의 일치율이 너무 높아져서 이미지와 연관되지 않으나 공유 가능한 정보가 있는 다른 이미지에 대한 진단 보고서에 대해 네가티브 쌍이 되어 다중 레이블 분류에 적합 하지 않게 된다. 상대적으로 (b)와 같이 이미지에 대한 진단 보고서에 대해 각 레이블 별 정보를 포함하는 하위 보고서를 추가 생성하여 데이터를 증대하면, 의료 이미지와 서로 연관되지 않은 하위 보고서 간에도 유사성이 일치할 수 있도록 학습할 수 있으므로, 다중 레이블 특성의 의료 이미지를 학습하기 적합한 텍스트들을 확대할 수 있다. 상기 컨셉에 따라서, 실시예에 따른 데이터 확대의 구체적인 방법을 설명한다. 실시예에 따른 데이터 확대는, 의료 이미지에 대해서는 수행하지 않을 수 있다. 일반적으로, 이미지 확대 기법 인, 무작위 자르기, 회전, 색상 변환, 시점 변경, 블러링, 랜덤 노이즈 추가 등의 방식은 의료 이미지로부터 병 리를 검출하는데 결정적인 의미를 왜곡할 수 있다. 도 6을 참조하면, 실시예에 따른 데이터 확대는, 텍스트에 대해서만 수행하는 랜덤 텍스트 확대(random text augmentation)일 수 있다. (S101) 구체적으로, 랜덤 텍스트 데이터 확대방법은, 진단 보고서에서 병리 분류에 관련된 단락만 추출하는 작업을 수 행하여, 불필요한 토큰들을 제거할 수 있다. 예를 들어, 데이터 확대방법은, 기 정해진 목차(예를 들어, “발견”, “인상”)에 해당하는 단락을 추출하여 진단 리포트를 재구성할 수 있다. (S201) 진단 보고서에서 발견 단락(FS)과 인상 단락(IS)은 병리 분류에 의미있는 내용으로 구성되며 대부분 문장을 짧고 형싱적으로 구성되므로, 파인 튜닝에 적합한 텍스트 샘플 데이터일 수 있다. 그리고 데이터 확대방법은, 재구성된 진단 리포트에 포함된 각 문장(S1, S2, …, Sn)을 n개의 문장으로 분리할 수 있다. (S203) 이후 데이터 확대방법은, 분리된 n개의 문장(S1, S2, …, Sn)을 기초로 복수의 텍스트를 추가 생성하여 텍스트 데이터를 확대할 수 있다. (S205) 실시예에서, 제1 의료 이미지에 매칭된 진단 보고서에서 분리된 문장(S1, S2, …, Sn)이 n개이고, m개(n>m)의 문장으로 텍스트를 구성하도록 할 경우, 분리된 n개의 문장(S1, S2, …, Sn)에서 랜덤으로 샘플링하여 조합하여 nCm개의 문장을 제1 의료 이미지에 대한 하위 텍스트(AD)로 생성할 수 있다. 여기서, 하위 텍스트(AD)의 문장수 를 m개로 고정할 수 있고, 각 진단 리포트의 분리된 문장수에 따라서 서로 다르게 하위 문장수의 개수를 정할 수 있다. 다른 실시에에서는, 랜덤하게 문장수를 결정하여 하위 텍스트(AD)의 문장수를 진단 보고서의 분리된 문장들에서 랜덤 샘플링하는 방식을 취할수도 있다. 이러한 텍스트 확대방법을 통해, 제1 의료 이미지에 대해 포지티브 쌍이 될 수 있는 하위 텍스트(AD)들을 다수 추가 생성할 수 있으며, 이러한 다수의 포지티브 쌍으로 구성된 하위 텍스트(AD)들은, 각기 특정 병리에 대해 풍부한 의미를 표출하므로, 다중 레이블 특성을 가진 의료 이미지에 대해 풍부한 의미를 학습할 수 있다. 또한, 중복되는 병리(레이블)을 가진 다른 제2 의료 이미지들에 대해 하위 텍스트(AD)들의 네가티브 특성을 줄여서 유 사한 병리를 가진 하위 텍스트(AD)와 제2 의료 이미지 사이의 임베딩을 서로 가깝게 위치하도록 학습할 수 있다. 텍스트 데이터 확대를 수행한 이후, 의료 이미지에 대해 복수의 하위 텍스트(AD)가 추가 생성되어 샘플 데이터 가 확대되어, 추가 생성된 텍스트 데이터에 비례하여 샘플 데이터가 증가할 수 있다. 이후 컴퓨팅 시스템은, 의료 이미지의 진단 보고서에 대해 확대된 텍스트 데이터들에 대한 샘플 데이터들 을 포지티브 쌍으로 맵핑하고, 다른 의료 이미지와는 네거티브 쌍으로 맵핑하여, 포지티브 샘플 데이터와, 네거 티브 샘플 데이터를 충분히 확대시킬 수 있다. 그리고 도 7을 참조하면, 컴퓨팅 시스템은, 샘플 데이터의 의료 이미지 각각을 이미지 인코더를 통해 이 미지 특징을 나타내는 이미지 임베딩 벡터(이하, “임베딩”)들을 출력하도록 제어하고, 하위 텍스트들은 텍스 트 인코더를 통해 텍스트 특징을 나타내는 텍스트 임베딩 벡터(이하, “임베딩”)들을 출력하도록 제어할 수 있 다. (S103a, S103b) 다음으로, 컴퓨팅 시스템은, 샘플 데이터들을 배치(batch) 사이즈에 따라 분류하고, 분류된 배치 별로 샘 플 데이터에 대한 상기 맵핑한 포지티브 쌍 및 네거티브 쌍을 기준으로 이미지 임베딩과 텍스트 임베딩의 포지 티브 쌍/네거티브 쌍으로 매칭하여 유사성 메트릭을 생성할 수 있다. (S105) 여기서 유사성은, 이미지 임베딩과 텍스트 임베딩의 간의 내적(dot product)을 의미할 수 있다. 즉, 유사성 매트릭은, 포지티브 쌍의 행과 열이 일치하도록 포지티브 쌍의 임베딩 샘플과, 네거티브 쌍의 임베 딩 샘플을 나열한 행렬일 수 있다. 이후, 컴퓨팅 시스템은, 포지티브 임베딩 샘플 사이의 공간 상 거리가 가깝워지도록, 네가티브 임베딩 샘 플 사이의 공간 상 거리가 멀어지도록 손실함수에 따라 학습시킬 수 있다. 즉, 이 되도록 손실함수를 정의하여 대조 학습(contrastive learning)할 수 있다. 예를 들어, 컴퓨팅 시스템은, 유사성 메트릭에 제1 손실함수(수식 1)인 InfoNCE Loss를 적용하여 학습시 킬 수 있다. 수학식 1 여기서, v, u는 각각 이미지와 텍스트의 정규화된 임베딩 벡터를 의미하고, (vi, ui)는 포지티브 임베딩 샘플이 고, (vi, uk)는 네거티브 임베딩 샘플이며, sim은 임베딩 벡터 간 유사성을 계산하는 함수로 예를 들어 코사인 유사도(cosine similarity)일 수 있고, τ는 학습가능한 온도(learnable temperature)를 의미하며, N은 배치 사이즈(batch size)이다. 즉, 이미지 i는 1개의 포지티브 텍스트와, N-1개의 네가티브 텍스트들과 쌍을 이루어 유사 메트릭을 구성한다. lv→u는 이미지 i에 대해 텍스트 i가 유사성이 높아지도록 제1 손실함수를 통해 손실도를 학습할 수 있다. 다만, 제1 손실함수을 그대로 적용하여 유사성 메트릭에서 포지티브 쌍의 유사도가 완전히 높아지도록, 네거티 브 쌍의 유사도가 완전히 낮아지도록 학습할 경우, 이미지 i에 대해 긍정적인 텍스트들 사이의 유사성을 높게 학습하기 어려울 수 있다. 이러한 문제를 완화하기 위하여, 컴퓨팅 시스템은, 유사성을 계산하는 함수 sim을 수정한 제2 손실함수에 따라서 유사성 메트릭의 유사도를 계산해 학습하는 방식을 취할 수 있다. 수학식 2"}
{"patent_id": "10-2023-0159590", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "여기서, vi*uj는 이미지 임베딩 벡터들과 텍스트 임베딩 벡터들 사이의 코사인 유사도이고, α는 시그모이드 함 수의 기울기 계수이며, t (0 < t < 1)는 샘플 데이터 사이의 유사성 수준을 “포지티브로 간주하는 유사도의 임 계값을 의미한다. 즉, 유사도가 t보다 크면 빠르게 1에 가까워지도록 계산될 수 있다. 이와 같이 포지티브 쌍의 이미지-텍스트 간의 일치를 완화하도록 계산하는 제2 손실함수(Relaxing loss function)를 통해 포지티브로 맵핑되지 않은 샘플의 텍스트들에 대해서도 이미지에 대해 일치할 여지를 만들 수 있으며, 이를 통해 다중 레이블 특성을 가진 이미지들에 복수에 레이블이 정확하게 분류되는 이미지 분류 모델 을 학습할 수 있다. 이와 같이, 컴퓨팅 시스템은, 사전 훈련된 비전-언어 모델에 대해 하기 두가지 파인 튜닝 기법을 사용하 여 이미지 분류 모델로 학습시킴으로써, 1) 왜곡되지 않고 각 병리에 대해 풍부한 의미를 내포하는 텍스트 데이 터 확대를 통해 샘플 데이터를 충분히 확보할 수 있으며, 2) 샘플 데이터 사이의 포지티브 쌍의 일치가 완화된 손실함수를 유사성 메트릭에 적용하여 학습시켜 다중 레이블 특성을 가진 의료 이미지에 중복적으로 레이블의 적용 여부를 정확히 분류하는 이미지 분류 모델을 학습시킬 수 있다. 또한, 컴퓨팅 시스템은 이와 같이 학습된 이미지 분류 모델을 통해 입력 이미지에 대한 다중 레이블의 분 류를 작업을 수행할 수 있다. (S109) 도 8을 참조하면, 컴퓨팅 시스템은, 프롬프트 엔지니어링을 수행하여 입력 이미지에 대한 각각의 다중 레 이블의 분류를 수행하도록 할 수 있다. 자세히, 컴퓨팅 시스템은, 의료 이미지에 대한 다중 레이블을 정의할 수 있다. 예를 들어, 파인 튜닝을 위한 트레이닝 데이터 세트에서 정의한 병리들을 각각을 레이블로 결정할 수 있다. 실시예에서 컴퓨팅 시스템 은, 의료 이미지에 대한 진단 보고서를 텍스트 데이터 확대하여 생성한 하위 텍스트들을 자연어 분석 모 델에 입력하여 검출 가능한 병리들을 추출하여, 추출된 병리들을 레이블로 결정할 수 있다. 그리고 컴퓨팅 시스템은, 입력 이미지에 대해 레이블 각각을 긍정/부정 템플릿에 입력하여 레이블 분류 여부를 판단하는 문장을 생성할 수 있다. 예를 들어, 폐 경화(Consolidation)에 대한 레이블의 분류 여부를 확인하기 위해 폐 경화 긍정을 포함하는 긍정 문장과, 폐 경화 부정을 포함하는 부정 문장을 생성할 수 있다. 그리고 컴퓨팅 시스템은, 긍정 문장과 부정 문장을 텍스트로 기 학습된 이미지 분류 모델의 텍스트 인코 더에 입력하여, 긍정 문장에 대한 텍스트 임베딩과 부정 문장에 대한 텍스트 임베딩을 출력하고, 입력 이미지를 기 학습된 이미지 분류 모델의 이미지 인코더에 입력하여 이미지 임베딩을 출력할 수 있다. 그리고 컴퓨팅 시스템은, 긍정 문장의 텍스트 임베딩과, 부정 문장의 텍스트 임베딩에 각각에 대해 이미 지 임베딩 노말라이즈드 된 소프트맥스 유사도를 산출(각 벡터 사이의 거리)하여, 해당 병리에 대한 분류 긍정 유사도 및 부정 유사도의 수치를 각각 산출하고, 긍정에 대한 유사도가 더 높을 경우 입력 이미지를 해당 병리 로 분류하고, 부정에 대한 유사도가 더 높을 경우 입력 이미지를 해당 병리로 분류하지 않는다. 이와 같이, 컴퓨팅 시스템은, 다중 레이블 각각에 대해 긍정 문장과 부정 문장을 템플릿에 따라 생성하고, 생성된 긍정 문장과 부정 문장을 포함하는 텍스트와 입력 이미지를 이미지 분류 모델에 입력하여 각 레이블에 대한 분류 여부를 각각 판별할 수 있다. 이러한 프롬프트 엔지니어링을 통해, 컴퓨팅 시스템은, 다중 레이블에 대한 이미지 분류를 중복하여 판별 할 수 있다. 도 9를 참고하면, 컴퓨팅 시스템은, 이와 같이 입력 이미지(I)에 대해 적어도 하나 이상의 레이블(병리) 에 해당 여부를 분류하여 분류된 레이블(AR)을 표시할 수 있으며, 이때, 분류되지 않은 병리(UR)들도 함께 표시 하도록 제공하여, 이미지 분류 모델이 판별한 레이블(FL)을 유저가 확인할 수 있도록 제공할 수 있다. 이를 통 해, 유저는 의료 이미지에 대해 이미지 분류 모델이 판별할 수 있는 병리(FL)를 직관적으로 파악하여 효율적인 의료 이미지에 대한 진단을 수행하는데 보조할 수 있다. 또한, 컴퓨팅 시스템은, 다중 레이블에 대한 적용 여부에 따른 유사도가 높은 텍스트 임베딩을 기초로 진 단 보고서(RP)를 복원하여 제공할 수 있다. 즉, 컴퓨팅 시스템은, 진단 보고서에 대해 텍스트 확대를 통 해 생성된 하위 텍스트들로부터 학습된 이미지 분류 모델을 통해 입력 이미지(I)에 대한 인공지능 진단 보고서 (RP)를 생성하여 제공할 수도 있다. 또한, 컴퓨팅 시스템은, 입력 이미지(I)의 적어도 일부 영역과 분류된 레이블과 연관성을 산출하여, 분류 된 레이블과 유사도가 높은 입력 이미지(I)의 영역을 하이라이트(HL) 표시하여 제공하여, 유저의 진단을 추가적 으로 보조할 수 있다. 이하에서는, 대조 학습을 통해 사전 훈련된 비전-언어 모델 중 3가지 예시 모델에 대해 본 발명의 실시예에 따 른 파인 튜닝을 수행하여 3개의 이미지 분류 모델을 학습시켰으며, 3개의 이미지 분류 모델과 기존 선행된 이미 지 분류 모델(CheXzero와 MedCLIP)에 대해 각각 제로샷 성능 평가를 수행하여 효과를 입증하고자 한다. 여기서, 예시 모델로 파인 튜닝된 제1 이미지 분류 모델은 CLIP (Contrastive Language-Image Pretraining) 기 반 프레임워크를 파인튜닝한 모델이며, 제2 이미지 분류 모델은 Slip(Self-supervision meets language-image pretraining) 기반 프레임워크를 파인튜닝한 모델이며, 제3 이미지 분류 모델은 Uniclip(Unified framework for contrastive language-image pretraining)의 프레임워크를 파인튜닝한 모델일 수 있다. 표 1"}
{"patent_id": "10-2023-0159590", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "표 1은, 실시예에 따른 파인 튜닝을 위해 사용한 데이터 세트와, 제로샷 성능 평가를 위해 사용한 데이터 세트 를 나타낸다. 실시예에서, 본 발명의 파인 튜닝을 위해 사용한 트레이닝 데이터 세트는 MIMIC-CXR이다. 그리고 CheXpert의 검증을 위한 데이터 세트와, PadChest의 데이터 세트와, Open-i chest X-ray dataset 및 VinDr-CXR를 테스트 데이터 세트로 활용하였다. 제1 이미지 분류 모델, 제2 이미지 분류 모델, 제3 이미지 분류 모델 및 제1 선행 이미지 분류 모델과 제2 선행 이미지 분류 모델에 대해 테스트 데이터 세트를 활용하여 제로샷 성능 평가를 수행한 결과는 하기 표 2와 같다."}
{"patent_id": "10-2023-0159590", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 5, "content": "표 2"}
{"patent_id": "10-2023-0159590", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 6, "content": "표 2를 보면, 제1 내지 제3 이미지 분류 모델이 파인 튜닝 적용 여부에 따라 AUROC(Area Under ROC curve)가 평균 5.77% 증가하는 것을 통해, 본 발명의 실시예에 따른 파인 튜닝 기법이 제로샷 병리 분류 성능을 지속적으 로 향상시키는 것을 보여주므로, 파인 튜닝 기법의 우수성을 입증할 수 있다. 표 3"}
{"patent_id": "10-2023-0159590", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 7, "content": "또한, 표 3은 CheXpert의 테스트 세트(평균 ± 표준)에서 제안된 방법의 다양한 병리(질병) 별 분류 정확도에 대한 실험을 나타낸다. 각 프레임워크에 대해 최고 성능은 굵은 글씨로, 두 번째 최고 성능은 밑줄로 표시되었 다. 표 3을 참고하여서도, 파인 튜닝 기법에서 텍스트 데이터 확대와, 완화 손실 함수를 적용하였을 때의 각각 제로샷 성능이 개선된 것을 명확히 파악할 수 있다. 특히 CheXpert 데이터세트의 경우, 본 발명의 이미지 분류 모델 학t습 방법으로 CLIP을 미세 조정하면 F1 점수 에서 0.619 대 0.625, MCC에서 0.530 대 0.544로 5가지 주요 질병을 탐지하는 데 있어 위원회 인증 방사선 전문 의보다 약간 더 나은 성능을 발휘하는 경우가 있었으며, 이는 표로 첨부하진 않았다. 이와 같이, 본 발명은 일반 도메인 이미지-텍스트 쌍으로 사전 훈련된 이미지 분류 모델을 별도의 라벨링 작업 없이 파인 튜닝하여 다운스트림 제로샷 성능을 향상시킨 뉴럴 네트워크를 포함하는 이미지 분류 모델를 제공할 수 있다. 이러한 본 발명의 이미지 분류 모델은, 4가지 흉부 X선 데이터세트와 3가지 사전 훈련된 모델(5.77% 평균 AUROC 증가)을 파인 튜닝한 후 제로샷 병리학 분류를 수행해본 결과, 극적으로 향상된 제로샷 병리학 분류 성능을 지 속적으로 보여줄 수 있었다. 특히, 본 발명의 이미지 분류 모델은, 위원회 인증을 받은 방사선 전문의와 비슷하거나 더 나은 성능을 보여준 실험 결과도 도출할 수 있었다. 이상 설명된 본 발명에 따른 실시예는 다양한 컴퓨터 구성요소를 통하여 실행될 수 있는 프로그램 명령어의 형 태로 구현되어 컴퓨터 판독 가능한 기록 매체에 기록될 수 있다. 상기 컴퓨터 판독 가능한 기록 매체는 프로그 램 명령어, 데이터 파일, 데이터 구조 등을 단독으로 또는 조합하여 포함할 수 있다. 상기 컴퓨터 판독 가능한 기록 매체에 기록되는 프로그램 명령어는 본 발명을 위하여 특별히 설계되고 구성된 것이거나 컴퓨터 소프트웨 어 분야의 당업자에게 공지되어 사용 가능한 것일 수 있다. 컴퓨터 판독 가능한 기록 매체의 예에는, 하드 디 스크, 플로피 디스크 및 자기 테이프와 같은 자기 매체, CD-ROM 및 DVD와 같은 광기록 매체, 플롭티컬 디스크 (floptical disk)와 같은 자기-광 매체(magneto-optical medium), 및 ROM, RAM, 플래시 메모리 등과 같은, 프 로그램 명령어를 저장하고 실행하도록 특별히 구성된 하드웨어 장치가 포함된다. 프로그램 명령어의 예에는, 컴파일러에 의하여 만들어지는 것과 같은 기계어 코드뿐만 아니라 인터프리터 등을 사용하여 컴퓨터에 의해서 실행될 수 있는 고급 언어 코드도 포함된다. 하드웨어 장치는 본 발명에 따른 처리를 수행하기 위하여 하나 이 상의 소프트웨어 모듈로 변경될 수 있으며, 그 역도 마찬가지이다. 본 발명에서 설명하는 특정 실행들은 일 실시 예들로서, 어떠한 방법으로도 본 발명의 범위를 한정하는 것은 아 니다. 명세서의 간결함을 위하여, 종래 전자적인 구성들, 제어 시스템들, 소프트웨어, 상기 시스템들의 다른 기 능적인 측면들의 기재는 생략될 수 있다. 또한, 도면에 도시된 구성 요소들 간의 선들의 연결 또는 연결 부재들 은 기능적인 연결 및/또는 물리적 또는 회로적 연결들을 예시적으로 나타낸 것으로서, 실제 장치에서는 대체 가 능하거나 추가의 다양한 기능적인 연결, 물리적인 연결, 또는 회로 연결들로서 나타내어질 수 있다. 또한, “필 수적인”, “중요하게” 등과 같이 구체적인 언급이 없다면 본 발명의 적용을 위하여 반드시 필요한 구성 요소 가 아닐 수 있다. 도면 도면1 도면2 도면3 도면4 도면5 도면6 도면7 도면8 도면9"}
{"patent_id": "10-2023-0159590", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 실시예에 따른 다중 레이블의 이미지 분류를 효과적으로 정확하게 수행하는 이미지 분류 모델 을 학습 및 제어하는 컴퓨팅 시스템의 블록도의 예시를 도시한다. 도 2는 본 발명의 실시예에 따른 다중 레이블의 이미지 분류를 효과적으로 정확하게 수행하는 이미지 분류 모델 을 학습 및 제어하는 컴퓨팅 디바이스의 블록도의 예시를 도시한다. 도 3은 본 발명의 실시예에 따른 다중 레이블의 이미지 분류를 효과적으로 정확하게 수행하는 이미지 분류 모델 을 학습 및 제어하는 컴퓨팅 디바이스에 대한 다른 측면에서의 블록도의 예시를 도시한다. 도 4는 본 발명의 실시예에 따른 이미지 분류 모델을 학습하는 방법 및 학습된 이미지 분류 모델을 이용하여 이 미지를 분류하는 방법에 대한 흐름도이다. 도 5는 의료 이미지의 임베딩 벡터와 의료 이미지의 진단 리포트의 임베딩 벡터 사이의 관계를 나타내는 개념도 (a)와, 의료 이미지의 임베딩 벡터와 의료 이미지의 진단 리포트로부터 데이터 확대된 하위 텍스트들의 임베딩 벡터 사이의 관계를 나타내는 개념도 (b)를 포함하다. 도 6은 본 발명의 실시예에 따른 텍스트 데이터 확대 방법을 나타내는 예시이다. 도 7은 본 발명의 실시예에 따른 이미지 분류 모델이 학습되는 모습의 일 예시를 나타낸다. 도 8은 본 발명의 실시예에 따른 학습된 이미지 분류 모델을 통해 이미지 분류하는 모습의 일 예시를 나타낸다. 도 9는 본 발명의 실시예에 따른 이미지 분류 모델이 다중 레이블의 이미지에 대해 분류를 수행한 결과를 제공 해주는 예시이다."}
