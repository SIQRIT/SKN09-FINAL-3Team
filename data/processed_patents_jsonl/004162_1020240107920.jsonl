{"patent_id": "10-2024-0107920", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2025-0023971", "출원번호": "10-2024-0107920", "발명의 명칭": "초분광 이미지와 인공지능 모델에 기초한 검사 장치 및 방법", "출원인": "에스케이바이오사이언스", "발명자": "이건형"}}
{"patent_id": "10-2024-0107920", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "컴퓨터 장치에서 실행되는 데이터 처리부와 인공지능 모델에 의한 제품 검사 방법으로서, 초분광 카메라로 검사대상 제품을 촬영하여 획득한 초분광 이미지를 수신하는 단계(S10); 제1 머신러닝 모델을 이용하여 상기 초분광 이미지에서 이상 영역을 탐지하는 1차 검사 단계(S30); 및제2 머신러닝 모델을 이용하여 상기 1차 검사 단계에서 발견된 이상의 종류를 판별하는 2차 검사 단계(S50);를포함하는 것을 특징으로 하는, 초분광 이미지와 인공지능 모델에 기초한 제품 검사 방법."}
{"patent_id": "10-2024-0107920", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제 1 항에 있어서, 상기 단계(S10)에서 수신한 초분광 이미지에 대한 데이터 전처리를 수행하는 단계(S20)를 더 포함하는 것을 특징으로 하는, 초분광 이미지와 인공지능 모델에 기초한 제품 검사 방법."}
{"patent_id": "10-2024-0107920", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제 2 항에 있어서, 상기 전처리 단계(S20)가, 초분광 이미지에 대한 주성분 분석(PCA)를 수행하여 데이터를 압축하는 단계를 포함하는 것을 특징으로 하는, 초분광 이미지와 인공지능 모델에 기초한 제품 검사 방법."}
{"patent_id": "10-2024-0107920", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제 1 항에 있어서, 상기 1차 검사 단계(S30)가, 기설정된 제1 탐지영역 단위의 초분광 스펙트럼을 입력 데이터로서 제1 머신러닝 모델에 입력하는 단계(S310);및제1 머신러닝 모델의 출력을 상기 입력 데이터와 비교하여 각 탐지영역의 이상 여부를 판단하는 단계(S320);를포함하는 것을 특징으로 하는, 초분광 이미지와 인공지능 모델에 기초한 제품 검사 방법."}
{"patent_id": "10-2024-0107920", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제 4 항에 있어서, 상기 2차 검사 단계(S50)가, 상기 1차 검사 단계에서 이상으로 판단된 제1 탐지영역을 커버하는 제2 탐지영역에 대해, 해당 탐지영역을 대표하는 대표 초분광 스펙트럼을 결정하는 단계(S510); 상기 대표 초분광 스펙트럼과 정상 스펙트럼을 사이의 스펙트럼 유사도 값을 생성하는 단계(S520); 및 상기 스펙트럼 유사도 값을 제2 머신러닝 모델에 입력하여 제2 탐지영역의 이상의 종류를 판단하는 단계(S530);를 포함하는 것을 특징으로 하는, 초분광 이미지와 인공지능 모델에 기초한 제품 검사 방법."}
{"patent_id": "10-2024-0107920", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제 1 항에 있어서, 상기 제1 머신러닝 모델이 오토인코더이고 제2 머신러닝 모델이 합성곱 신경망(CNN) 모델인 것을 특징으로하는, 초분광 이미지와 인공지능 모델에 기초한 제품 검사 방법."}
{"patent_id": "10-2024-0107920", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제1항 내지 제6항 중 어느 한 항에 따른 제품 검사 방법을 실행시키기 위한 컴퓨터 프로그램이 기록된 컴퓨터공개특허 10-2025-0023971-3-판독가능 기록매체."}
{"patent_id": "10-2024-0107920", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명에 따르면, 초분광 이미지와 머신러닝 모델을 이용하되 단순히 임의의 탐지영역의 정상/이상 여부만 판단 하는 것이 아니라 1차 검사에서 탐지영역의 정상/이상을 판단하고 이상으로 판단된 영역에 대해 2차 검사를 하여 이상의 종류를 판정함으로써 정상/불량 제품을 보다 정확하고 신속히 판별할 수 있는 기술적 효과를 가진다."}
{"patent_id": "10-2024-0107920", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 제품 생산 공정의 품질관리(QC) 방법에 관한 것으로, 보다 상세하게는, 제품 생산 공정에서 생산된 생산품에 대해 초분광 이미지 및 인공지능 모델에 기초하여 정상/이상 여부를 판단하는 검사 장치 및 방법에 관 한 것이다."}
{"patent_id": "10-2024-0107920", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "일반적으로 제약, 음료수 등의 제품 생산 공정에서 생산된 제품은 생산 직후 품질관리(QC) 공정을 거치는 것이 필수적이다. 예를 들어 제약 공정에서 생산되는 각종 혈액제제 등 약물은 인체의 혈액에 직접 주입하는 약품이 므로 제품 생산 후 품질관리 공정에서 불량 여부를 판단하는 것이 요구된다. 일반적으로 이러한 약물은 바이알 (vial)이라는 작은 유리병에 담겨 생산되는데, 기존 QC 공정에서는 작업자가 수작업으로 각 바이알의 정상 여부 를 판단하였다. 즉 기존에는 작업자가 검사대상 바이알을 대략 1~2초 내외로 눈으로 보고 바이알 내 이물질이 있는지를 판단하고 그에 따라 정상/불량을 판정하였다. 그러나 이러한 종래 방식에서는 많은 바이알을 작업자가 직접 눈으로 보고 판단하기 때문에 정상/불량 판정이 틀릴 수 있고 작업자에 따라 편차도 크며 이를 방지하기 위해 교차 검증을 함에 따라 비용이 추가로 발생한다. 또한 최근 수작업에 의한 바이알 검사의 경우 식약처에서 바이알 검사시간을 개당 1초에서 5초 이상으로 높일 것을 권고하고 있어 향후 검사시간 증가와 이에 따른 추가적인 비용 증가가 우려되고 있다. 또한 카메라를 통한 이상/불량 판정 방법도 존재하지만, 여러 가지 파장이 아니라 단 파장에서 이물질을 확인하 기 때문에 이물이 아닌 것도 이물이라고 판단하거나 이물인 것이 정상으로 판단되는 경우가 빈번히 일어나서 검 사 정확도가 떨어지는 문제가 있었고, 이물로 판단된 것이라도 해당 이물이 구체적으로 무엇인지 특정하기 어려 운 문제가 있었다."}
{"patent_id": "10-2024-0107920", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은 종래 수작업으로 행해지던 제품 검사를 초분광 이미지와 인공지능 기반 검사로 대체하여 제품의 정상 /불량 여부에 대한 신속하고 정확한 판정을 할 수 있는 검사 방법 및 장치를 제공하는 것을 목적으로 한다."}
{"patent_id": "10-2024-0107920", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명의 일 실시예에 따르면, 컴퓨터 장치에서 실행되는 데이터 처리부와 인공지능 모델에 의한 제품 검사 방 법으로서, 초분광 카메라로 검사대상 제품을 촬영하여 획득한 초분광 이미지를 수신하는 단계; 제1 머신러닝 모 델을 이용하여 상기 초분광 이미지에서 이상 영역을 탐지하는 1차 검사 단계; 및 제2 머신러닝 모델을 이용하여 상기 1차 검사 단계에서 발견된 이상의 종류를 판별하는 2차 검사 단계;를 포함하는 초분광 이미지와 인공지능 모델에 기초한 제품 검사 방법을 개시한다. 본 발명의 일 실시예에 따르면 상기 제품 검사 방법을 실행시키기 위한 컴퓨터 프로그램이 기록된 컴퓨터 판독 가능 기록매체를 개시한다."}
{"patent_id": "10-2024-0107920", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명에 따르면, 초분광 이미지와 머신러닝 모델을 이용하되 단순히 임의의 탐지영역의 정상/이상 여부만 판 단하는 것이 아니라 1차 검사에서 탐지영역의 정상/이상을 판단하고 이상으로 판단된 영역에 대해 2차 검사를 하여 이상의 종류를 판정함으로써 정상/불량 제품을 보다 정확하고 신속히 판별할 수 있는 기술적 효과를 가진 다."}
{"patent_id": "10-2024-0107920", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이상의 본 발명의 목적들, 다른 목적들, 특징들 및 이점들은 첨부된 도면과 관련된 이하의 바람직한 실시예들을 통해서 쉽게 이해될 것이다. 그러나 본 발명은 여기서 설명되는 실시예들에 한정되지 않고 다른 형태로 구체화 될 수도 있다. 오히려, 여기서 소개되는 실시예들은 개시된 내용이 철저하고 완전해질 수 있도록 그리고 당업자 에게 본 발명의 사상이 충분히 전달될 수 있도록 하기 위해 제공되는 것이다. 본 명세서에서 제1, 제2 등의 용어가 구성요소들을 기술하기 위해서 사용된 경우, 이들 구성요소들이 이 같은 용어들에 의해서 한정되어서는 안된다. 이들 용어들은 단지 어느 구성요소를 다른 구성요소와 구별시키기 위해 서 사용되었을 뿐이다. 여기에 설명되고 예시되는 실시예들은 그것의 상보적인 실시예들도 포함한다. 본 명세서에서, 단수형은 문구에서 특별히 언급하지 않는 한 복수형도 포함한다. 명세서에서 사용되는 '~를 포 함한다', ‘~로 구성된다', 및 ‘~으로 이루어진다’라는 표현은 언급된 구성요소 외에 하나 이상의 다른 구성 요소의 존재 또는 추가를 배제하지 않는다. 본 명세서에서 용어 '소프트웨어'는 컴퓨터에서 하드웨어를 움직이는 기술을 의미하고, 용어 '하드웨어'는 컴퓨 터를 구성하는 유형의 장치나 기기(CPU, 메모리, 입력장치, 출력장치, 주변장치 등)를 의미하고, 용어 '단계'는 소정의 목을 달성하기 위해 시계열로 연결된 일련의 처리 또는 조작을 의미하고, 용어 '컴퓨터 프로그램', '프 로그램‘, 또는 '알고리즘'은 컴퓨터로 처리하기에 적합한 명령의 집합을 의미하고, 용어 '프로그램 기록 매 체'는 프로그램을 설치하고 실행하거나 유통하기 위해 사용되는 프로그램을 기록한 컴퓨터로 읽을 수 있는 기록 매체를 의미한다. 본 명세서에서 발명의 구성요소를 지칭하기 위해 사용된 ‘~부’, ‘~모듈’, ‘~유닛’, ‘~블록’, ‘~보드’ 등의 용어는 적어도 하나의 기능이나 동작을 처리하는 물리적, 기능적, 또는 논리적 단위를 의미할 수 있고 이 는 하나 이상의 하드웨어나 소프트웨어 또는 펌웨어로 구현되거나 또는 하드웨어, 소프트웨어, 및/또는 펌웨어 의 결합으로 구현될 수 있다. 본 명세서에서 '처리장치', ‘컴퓨터’, ‘컴퓨팅 장치’, '서버 장치', '서버'는 윈도우, 맥, 또는 리눅스와 같은 운영체제, 컴퓨터 프로세서, 메모리, 응용프로그램, 및 기억장치(예를 들면, HDD, SSD)를 구비한 시스템으 로 구현될 수 있다. 컴퓨터는 예를 들면, 데스크톱 컴퓨터나 노트북, 모바일 단말기 등과 같은 장치일 수 있으 나 이들은 예시적인 것이며 이에 한정되는 것은 아니다. 모바일 단말기는 스마트폰, 태블릿 PC, 또는 PDA와 같 은 모바일 무선통신기기 중 하나일 수 있다. 이하 도면을 참조하여 본 발명을 상세히 설명하도록 한다. 아래의 특정 실시예들을 기술하는데 있어서 여러 가 지의 특정적인 내용들은 발명을 더 구체적으로 설명하고 이해를 돕기 위해 작성되었다. 하지만 본 발명을 이해 할 수 있을 정도로 이 분야의 지식을 갖고 있는 독자는 이러한 여러 가지의 특정적인 내용들이 없어도 사용될 수 있다는 것을 인지할 수 있다. 또한 발명을 기술하는 데 있어서 공지 또는 주지관용 기술이면서 발명과 크게 관련 없는 부분들은 본 발명을 설명하는 데 있어 혼돈을 막기 위해 기술하지 않음을 미리 언급해 둔다. 또한 도면을 참조한 이하의 상세한 설명에서는 혈액제제를 담는 바이알 제품을 실시예로서 설명하지만 본 발명 에 따른 검사 장치 및 검사 방법이 이에 한정되지 않으며 다양한 제품에 적용 가능함을 당업자는 이해할것이다. 예를 들어, 본 발명에 따른 검사 장치 및 검사 방법은 혈액제제를 담는 바이알에만 적용되지 않으며 각종 음료 수 등의 액체, 기체나 고체, 또는 젤 등의 제품을 유리나 투명 플라스틱 등과 같은 투명 또는 반투명 재질의 용 기에 담은 제품에 적용될 수 있다. 이 때의 용기는 가시광선이 투과하는 투명 또는 반투명의 용기일 수 있지만 이에 제한되지 않으며 초분광 이미지를 얻기 위해 조사되는 소정 주파수 대역의 전자기파를 투과할 수 있는 용 기이면 무방하다. 또한 본 발명에 따른 검사 장치가 판별하는 '이물질'은 본 발명의 구체적 실시 상황에 따라 다양하게 정의된다. 예를 들어 본 명세서에서 언급하는 '이물질'은 발명의 구체적 실시 형태에 따라 단백질 덩어리일 수도 있고 먼 지나 벌레일 수도 있으며, '생산되는 제품 내에 포함되지 않아야 할 또는 포함되지 않는 것이 바람직한 임의의 물질 또는 입자'로 정의하기로 한다. 도1은 본 발명의 일 실시예에 따른 바이알 검사 방법을 설명하는 흐름도이다. 도1의 흐름도는 컴퓨터 장치에서 실행되는 데이터 처리부와 인공지능 모델에 의해 수행될 수 있다. 일 실시예에서 상기 바이알 검사 방법은 초분 광 카메라로 촬영된 바이알의 초분광 이미지를 수신하는 단계(S10), 수신한 초분광 이미지를 전처리하는 단계 (S20), 제1 머신러닝 모델을 이용하여 초분광 이미지에서 이상 영역을 탐지하는 1차 검사 단계(S30); 및 제2 머 신러닝 모델을 이용하여 상기 1차 검사 단계에서 발견된 이상의 종류를 판별하는 2차 검사 단계(S50);를 포함할 수 있다. 이 때 만일 1차 검사 단계(S30)에서 바이알에 대한 초분광 이미지의 이상 탐지 결과 이상이 없다고 판단하면 정 상 바이알로 판단하여 출고하고, 1차 검사 단계(S30)에서 이상(비정상) 영역이 하나 이상 발견된 경우 이상 영 역의 각각에 대해 상기 2차 검사 단계(S50)를 수행하여 이상의 종류를 판단한다. 만일 이상에 대한 2차 검사 결 과 예컨대 단순한 단백질 조각이나 바이알 표면의 흠집 등으로 판단하면 정상 범주라고 판단하여 정상 출고하고 바이알 내 이물질이라고 판단하면 불량 바이알로 최종 판단한다. 이러한 본 발명에 따른 바이알 검사 방법은 컴퓨터 장치에서 실행되는 데이터 처리부와 인공지능 모델 등에 의 해 수행된다. 예를 들어 컴퓨터 장치는 데이터 전처리(S20)를 수행하는 데이터 전처리부 및 제1 및 제2 머신러 닝 모델에 의한 검사 단계(S30, S50)를 수행하는 인공지능 모델을 포함할 수 있고 이러한 각 구성요소는 컴퓨터 장치에서 실행 가능하게 프로그램되는 소프트웨어로(또는 필요에 따라 펌웨어, 하드웨어 등과 결합하여) 구현될 수 있다. 이제 도1의 바이알 검사 방법의 구체적 단계에 대해 이하 도2 내지 도9를 참조하여 설명하기로 한다. 우선 도1의 단계(S10)에서 컴퓨터 장치는 초분광 카메라에 의해 촬영된 검사대상 바이알의 초분광 이미지를 수 신한다. 초분광 이미지(hyperspectral image)는 촬영 이미지에 대해 공간(spatial) 정보와 분광(spectral) 정 보를 합하여 각 픽셀마다 3차원 정보를 포함하는 이미지이다. 예를 들어, 초분광 이미지는 검사대상의 가시광선 영역뿐만 아니라 자외선(UV), 근적외선(NIR), 및 단파 적외선(SWIR) 등의 주파수 대역의 데이터(예컨대 반사스 펙트럼의 세기에 대한 데이터)를 포함하고 있다. 컴퓨터 장치는 검사대상에 대한 초분광 이미지를 수신한 후 이미지에 대해 전처리를 수행할 수 있다(S20). 전처 리는 데이터의 노이즈를 제거하거나 이후의 검사 단계에서의 컴퓨터 처리 속도를 빠르게 하기 위해 수행된다. 예를 들어, 초분광 이미지는 데이터 량이 크기 때문에 머신러닝 모델에 적용하기 전에 데이터를 압축하는 것이 바람직할 수 있고, 이를 위해 전처리 단계(S20)에서 초분광 이미지에 대한 주성분 분석(PCA)을 수행하여 데이터 를 압축할 수 있다. 초분광 이미지는 기설정한 소정 크기의 탐지영역 단위로 초분광 스펙트럼 정보를 포함하고 있으며, 이후의 1차 검사 단계(S30) 및 2차 검사 단계(S50)는 이러한 기설정한 탐지영역 단위로 해당 영역의 이상 및 정상 여부를 판단한다. 예를 들어 도2는 예시적인 바이알 촬영 이미지를 나타내는 도면으로, 가시광 이미지를 예시적으로 나타내었다. 이 이미지에서 예컨대 (가) 및 (나) 영역은 이물질이나 흠집이 없는 정상 영역이고 (다) 및 (라) 영역은 흠집 또는 이물질 형상이 보이는 이상(비정상) 영역이다. 도3은 도2의 (가) 영역을 확대한 것으로, 예시적으로 5X5 픽셀 크기를 갖는 것으로 가정한다. 이 때 각각의 픽셀, 즉 1X1 픽셀 크기의 영역을 제1 탐지영역으로 설정할 수 있고, 각각의 제1 탐지영역 마다 초분광 스펙트럼을 획득할 수 있다. 즉 도3에서는 전체 25개의 제1 탐지영역을 나타내었고그 중 일부의 제1 탐지영역에는 해당 탐지영역의 초분광 스펙트럼을 오버랩하여 표시하였다. 한편 유리의 흠집, 단백질 응고, 이물질 등 바이알에 나타나는 이상은 하나의 제1 탐지영역 보다 훨씬 큰 영역에 걸쳐 나타나기 때문에, 하나의 이상을 커버하기 위해서는 제1 탐지영역보다 큰 사이즈의 제2 탐지영역이 필요할 수 있다. 예를 들어 도3에서 제2 탐지영역은 5X5 픽셀로 이루어진 영역으로 설정하였고, 이 경우 25개의 제1 탐지영역이 하나의 제2 탐지영역을 구성함을 이해할 것이다. 그러나 상술한 제1 탐지영역 및 제2 탐지영역의 크기는 구체적 실시 형태에 따라 달라질 수 있음은 물론이다. 예컨대 제1 탐지영역을 3X3 픽셀 또는 5X5 픽셀로 정의할 수 있고 제2 탐지영역을 가로X세 로 각각 5개X5개의 제1 탐지영역으로 정의하거나 10개X10개의 제1 탐지영역으로 정의할 수도 있다. 다만 본 명세서에서는 설명의 편의를 위해 제1 탐지영역이 1X1 픽셀 크기이고 제2 탐지영역은 5X5 픽 셀 크기인 것으로 가정한다. 다시 도1을 참조하면, 데이터 전처리 후 제1 머신러닝 모델을 이용한 1차 검사 단계(S30)를 수행할 수 있다. 일 실시예에서 제1 머신러닝 모델은 제1 탐지영역 단위의 초분광 이미지의 데이터를 입력 받아 정상 여부를 판정하 는 모델로서 예를 들어 오토인코더로 구현될 수 있다. 도5는 오토인코더의 구성을 개략적으로 나타낸 도면으로, 오토인코더는 입력되는 데이터의 차원을 축소시켜 압 축한 뒤 원래 크기로 복원하는 머신러닝 모델의 일종이다. 도5를 참조하면, 오토인코더는 일반적으로 인코더와 디코더로 구성된다. 인코더는 입력 데이터의 차원을 축소시켜 입력 데이터를 잠재 벡터(latent variable) 형태 로 압축시켜 출력하는 모델이고 디코더는 잠재 벡터를 입력받아 이를 다시 원본 크기로 업샘플링하여 원본 데이 터를 출력하는 모델이다. 만약 정상 데이터로만 오토인코더를 학습시킨 후 비정상(이상) 데이터를 입력한다면 오토인코더의 출력이 정상 데이터로 완전히 복원되지 않을 것이므로 복원 오차가 커질 수 밖에 없고, 따라서 어떤 데이터의 복원 오류가 소정 임계값을 초과한다면 그 데이터를 비정상으로 판단할 수 있다. 도6은 오토인코더를 이용한 1차 검사 단계(S30)를 설명하는 흐름도이다. 도6을 참조하면, 단계(S310)에서, 제1 탐지영역 단위의 초분광 스펙트럼을 오토인코더에 입력 데이터로서 입력한다. 오토인코더는 입력 데이터에 대한 인코딩 및 디코딩 처리를 한 후 복원 데이터를 출력하며, 단계(S320)에서, 오토인코더의 출력 데이터를 입력 데 이터와 비교하여 제1 탐지영역 단위로 초분광 스펙트럼의 이상 여부를 판단한다. 즉, 입력 스펙트럼과 출력 스 펙트럼의 오차가 기설정된 임계값 이하이면 해당 탐지영역이 정상이고 임계값을 초과하면 해당 탐지영역에 이상 이 있다고 판단할 수 있다. 다시 도1을 참조하면, 제1 머신러닝 모델을 이용한 1차 검사 단계(S30)에서의 검사 결과 이상으로 판별된 제1 탐지영역에 대해, 제2 머신러닝 모델을 이용한 2차 검사 단계(S50)를 수행할 수 있다. 일 실시예에서 2차 검사 단계(S50)는 제2 머신러닝 모델을 이용하여 상기 1차 검사 단계에서 발견된 이상의 종류를 판별하는 단계 이다. 일 실시예에서, 임의의 제1 탐지영역이 이상으로 판정된 경우 이 영역을 커버하는 제2 탐지영역에 대 해 2차 검사가 수행된다. 예를 들어, 1차 검사 단계(S30)에서 하나의 흠집 또는 이물질로 인해 복수개의 서로 인접한 제1 탐지영역들이 이상이라고 판정된 경우 이 흠집 또는 이물질을 커버하는 제2 탐지영역을 선정한다. 예컨대 도2에서 (다) 영역과 (라) 영역은 각각 1차 검사 결과 이상이 있다고 판단된 제1 탐지영역 들을 커버하는 제2 탐지영역일 수 있다. 2차 검사 단계(S50)에서, 이상의 종류를 판별하기 위해 스펙트럼의 유사도 값(Spectral Similarity Value)을 이 용하여 이미지를 분류하는 머신러닝 모델을 사용할 수 있다. 예를 들어 일 실시예에 따른 2차 검사 단계(S50)에 서, 이상의 종류를 판별하기 위해 합성곱 신경망(CNN) 모델을 사용한다. 합성곱 신경망(CNN)은 이미지 인식 패 턴을 찾고 분류하는데 유용한 머신러닝 모델이다. 일반적으로 CNN 모델은 입력층 후단에 컨볼루션층과 풀링층을 1회 이상 반복하고 그 후 완전 연결층(fully-connected layer)과 소프트맥스 함수를 거쳐 이미지를 분류할 수 있다. 도6은 일 실시예에 따른 2차 검사 단계(S50)의 예시적 방법을 설명하는 흐름도이다. 단계(S510)에서, 상기 1차 검사 단계(S30)에서 이상으로 판단된 제1 탐지영역을 커버하는 제2 탐지영역에 대해, 해당 탐지영역을 대표하는 초분광 스펙트럼(이하 간단히 “대표 초분광 스펙트럼”이라고도 함)을 결정한다. 대표 초분광 스펙트럼은 해당 제2 탐지영역의 각각의 제1 탐지영역의 초분광 스펙트럼을 이용하여 결 정된다. 예를 들어 제2 탐지영역 내의 모든 제1 탐지영역의 초분광 스펙트럼에서 하나를 대표 초분광 스펙트럼으로 선택할 수도 있고, 제2 탐지영역 내의 모든 제1 탐지영역의 초분광 스펙트럼을 이용하 여 새로운 초분광 스펙트럼을 생성하여 이를 대표 초분광 스펙트럼으로 정할 수도 있다. 예를 들어, 제2 탐지영 역 내의 모든 제1 탐지영역의 초분광 스펙트럼들을 이용하여 각 파장대역에서의 최빈값 또는 평균값 을 구하고 이로부터 대표 초분광 스펙트럼을 선정할 수 있다. 이와 관련하여 도7과 도8은 제2 탐지영역이 정상인 경우의 초분광 스펙트럼과 이상인 경우의 초분광 스펙 트럼의 예시적 그래프를 나타낸다. 도7(a)와 도7(b)는 각각 정상으로 판정된 서로 다른 제1 탐지영역의 초분광 스펙트럼을 확대하여 나타내었다. 예를 들어 도7(a)는 임의의 제2 탐지영역에 대해, 이 탐지영역 내의 모든 제1 탐지영역의 각각의 초 분광 스펙트럼을 오버랩하여 하나의 그래프에 나타내었고 또한 이렇게 오버랩된 모든 제1 탐지영역의 초분 광 스펙트럼으로부터 선정된(또는 새로 생성된) 대표 초분광 스펙트럼을 나타내었다. 예를 들어 도3과 같이 제1 탐지영역이 1X1 픽셀이고 제2 탐지영역이 5X5 픽셀로서 25개의 제1 탐지영 역을 포함하는 경우, 제2 탐지영역은 25개의 초분광 스펙트럼을 포함하고 있으며, 이 때 도7(a)는 임 의의 제2 탐지영역에 대한 25개 초분광 스펙트럼들을 오버랩하여 표시하였고 이들 중 빨간색 선으로 표시 한 그래프가 대표 초분광 스펙트럼이다. 도8(a)와 도8(b)는 이상 중에서도 바이알 유리병의 흠집의 전형적인 스펙트럼을 나타낸다. 예를 들어 제1 탐지 영역이 1X1 픽셀이고 제2 탐지영역이 5X5 픽셀로서 25개의 제1 탐지영역을 포함하는 경우, 도 8(a)은 임의의 제2 탐지영역에 대한 25개 초분광 스펙트럼을 오버랩하여 이들이 나타내는 영역을 표시 하였고 빨간색 선은 25개의 초분광 스펙트럼을 이용하여 선정한 대표 초분광 스펙트럼을 나타낸다. 그리고 도8(c)와 도8(d)는 이상 중에서도 바이알 내 이물질이 전형적인 스펙트럼을 나타내었다. 이와 같이 도7과 도8에서 알 수 있듯이 정상 영역의 초분광 스펙트럼과 이상 영역의 초분광 스펙트럼의 분포와 편차(분산)가 상이함을 알 수 있고, 이상의 종류(예컨대 흠집, 이물질 등)에 따라서도 제2 탐지영역의 초 분광 스펙트럼들의 분포와 편차 정도가 상이함을 알 수 있다. 한편 도9는 또 다른 예로서 초분광 카메라로 촬영한 알부민 샘플을 나타낸 도면이다. 도9에서 왼쪽 영역은 카메 라로 촬영한 이미지이고, 이 이미지에서 두 개의 이상 영역을 빨간색 원으로 표시하였고 각 이상 영역에 대한 대표 초분광 스펙트럼을 오른쪽에 표시하였다. 두 개의 이상 영역 중 위쪽 영역은 흠집이고 아래쪽 영역은 이물 질로 판명되었고, 이 때 각 이상 영역의 초분광 스펙트럼(11a, 11b)이 정상인 초분광 스펙트럼과 비교할 때 상이할 뿐 아니라 두 이상 영역의 초분광 스펙트럼(11a, 11b) 서로간에도 상이한 분포를 나타남을 알 수 있다. 도6을 참조하면, 단계(S520)에서, 상기 단계(S510)에서 산출된 대표 초분광 스펙트럼과 정상 스펙트럼을 이용하 여 스펙트럼 유사도 값을 생성한다. 제2 검사 단계(S50)에서는 이미지를 분류하는 머신러닝 모델(이하 '제2 머 신러닝 모델'이라고도 함)을 이용하여 이상의 종류를 판단하는데, 이때 제2 머신러닝 모델에 입력할 입력 데이 터로서 본 발명의 일 실시예에서는 이미지 스펙트럼의 유사도 값(Spectral Similarity Value)을 이용한다. 스펙트럼 유사도 값은 제2 탐지영역의 대표 초분광 스펙트럼과 기정의된 정상인 초분광 스펙트럼 사이의 유사도 (예를 들어, 빛의 밝기, 스펙트럼 모양의 유사성 등)를 수치로 척도화하는 공지의 방법으로 산출될 수 있다. 일 실시예에서 제2 검사 단계(S50)는 스펙트럼 유사도 값으로서 히트맵(Heatmap)을 사용한다. 본 발명에 따른 스펙 트럼 유사도 기반 히트맵은 제2 탐지영역의 대표 초분광 스펙트럼과 기설정된 정상 스펙트럼 간의 유사성을 색 깔로 시각화한 것으로, 예를 들어 두 변수간의 상관관계를 시각화하여 나타내는 상관관계 히트맵(correlation heatmap) 등의 공지의 방법을 사용하여 본 발명에 따른 스펙트럼 유사도 기반 히트맵을 생성할 수 있다. 예를 들어, 도10은 알부민 데이터의 스펙트럼 유사도를 기반으로 계산한 값을 히트맵 형태로 나타낸 도면으로, 도10(a)와 도10(b)는 알부민 정상 시료의 히트맵을 나타내고, 도10(c)는 바이알 겉 표면에 흠집이 있는 경우의 히트맵, 그리고 도10(d)는 바이알 내부에 이물질이 포함된 시료의 히트맵을 각각 예시적으로 나타낸다. 다시 도6을 참조하면, 단계(S530)에서, 이와 같이 검사하고자 하는 제2 탐지영역에 대한 스펙트럼 유사도 값(예컨대, 스펙트럼 유사도 기반 히트맵)이 산출되면, 이를 제2 머신러닝 모델에 입력하여 제2 탐지영역 의 이상의 종류를 판단한다. 예를 들어 제2 머신러닝 모델은 합성곱 신경망(CNN) 모델이며, 스펙트럼 유사도 값(예컨대 유사도 기반의 히트 맵)을 입력 데이터로서 CNN에 입력하고 CNN 모델은 출력 데이터로서 이상의 분류에 대한 결과를 출력한다. 이러한 2차 검사(S50) 결과 만일 이상으로 판단된 이유가 단순한 단백질 조각이나 바이알 표면의 흠집 때문이라 면 정상 범주라고 판단하여 정상 출고하고(도1의 S60_Yes) 이상의 이유가 바이알 내 이물질이라고 판단하면 불 량 바이알로 최종 판단한다(도1의 S60_No). 이와 같이 본 발명에 따른 바이알 검사 방법은 이상 영역에 대한 초분광 스펙트럼을 분석함으로써 이상 영역이 흠집인지 이물질인지 판별하고 더 나아가 이물질의 종류도 알 수 있다. 즉 본 발명에 따르면 초분광 이미지와 머신러닝 모델을 이용하되 단순히 임의의 탐지영역의 정상/이상 여부만 판단하는 것이 아니라 1차 검사에서 탐 지영역의 정상/이상을 판단하고 이상으로 판단된 영역에 대해 2차 검사를 하여 이상의 종류를 판정할 수 있으므 로 정상/불량 바이알을 보다 정확하고 신속하게 판별할 수 있는 기술적 효과를 가진다. 한편, 분류 모델의 성능을 평가하는 데 사용되는 중요한 지표 중 하나로 AUROC (Area Under the Receiver Operating Characteristic Curve)가 있는데, 이 모델은 이진 분류를 얼마나 잘 수행하는가를 나타내는 지표 기 준이다. 본 발명에 따른 바이알 검사 방법은 총 31개의 알부민 샘플을 가지고 48,000개의 픽셀 단위의 스펙트럼 데이터를 수집하고 수 차례 테스트를 거친 끝에 도출된 발명으로 AUROC 값이 평균 96% 수준에 이른다. 이는 이 물 판별의 정확도가 매우 높다는 것을 의미한다. 도11은 대안적 실시예에 따른 바이알 검사 방법을 설명하는 도면이다. 대안적 실시예에 따르면 상술한 실시예와 같이 두 단계의 검사(S30, S50)를 거치지 않고 한 번에 이물 유형을 분류하는 모델을 기반으로 정상과 비정상을 분류할 수 있다. 예컨대 SID와 같이 정상 스펙트럼과 이물 스펙트럼 간의 확률분포 거리를 유사성의 척도로 활 용하는 방법 또는, PCA와 같은 전처리 방법 등 각 이물 유형의 스펙트럼을 가장 잘 표현할 수 있는 방법을 적용 한다. 예를 들어 도11의 예시적 방법을 참조하면, 제1 탐지영역이 1X1 픽셀이라고 가정할 때, (a) 단계에서 제1 탐지영역 단위로 초분광 이미지 데이터에 주성분 분석(PCA)에 의한 차원축소를 하여 데이터를 압축한다. 다음으로 (b) 단계에서, 모든 픽셀별 초분광적 특징을 잘 학습할 수 있는 3D-Convolutional Network 기법을 적 용하고, 그 후 (c) 단계에서, 픽셀별 대표 스펙트럼 형상과 주변 픽셀 스펙트럼을 기초로 대상 픽셀과 주변 픽 셀의 관계성 즉, 공간적 특징을 잘 학습할 수 있도록 2D-Convolutional Network을 적용한다. 마지막으로 (d) 단 계에서 분류(Classification)를 수행함으로써, 분류 단계 수행에서 출력된 최종 표상이 기정의된 복수개의 이물 검출 관련 유형 중 어떤 유형인지에 대해 확률적으로 판단할 수 있다. 이상과 같이 본 발명이 속하는 분야에서 통상의 지식을 가진 자라면 이러한 명세서의 기재로부터 다양한 수정 및 변형이 가능함을 이해할 수 있다. 그러므로 본 발명의 범위는 설명된 실시예에 국한되어 정해져서는 아니되 며 후술하는 특허청구범위뿐 아니라 이 특허청구범위와 균등한 것들에 의해 정해져야 한다."}
{"patent_id": "10-2024-0107920", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도1은 본 발명의 일 실시예에 따른 바이알 검사 방법을 설명하는 흐름도, 도2는 예시적인 바이알 촬영 이미지를 나타내는 도면, 도3은 예시적인 탐지영역을 설명하는 도면, 도4는 오토인코더를 설명하는 도면, 도5는 일 실시예에 따른 1차 검사 단계를 설명하는 흐름도, 도6은 일 실시예에 따른 2차 검사 단계를 설명하는 흐름도, 도7은 정상 영역의 예시적인 초분광 스펙트럼을 나타내는 도면, 도8은 이상 영역의 예시적인 초분광 스펙트럼을 나타내는 도면, 도9는 초분광 카메라로 촬영한 알부민 샘플을 나타낸 도면, 도10은 알부민 데이터의 스펙트럼 유사도를 기반으로 계산한 값을 히트맵(Heatmap) 형태로 나타낸 도면, 도11은 대안적 실시예에 따른 바이알 검사 방법을 설명하는 도면이다."}
