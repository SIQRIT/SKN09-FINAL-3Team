{"patent_id": "10-2023-0044394", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2024-0119795", "출원번호": "10-2023-0044394", "발명의 명칭": "기계학습 모델이 내장된 초소형 센서에서 이종 환경 적응을 위한 특징 벡터 보정 방법", "출원인": "(주)제노", "발명자": "박상규"}}
{"patent_id": "10-2023-0044394", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "MCU에 Application ML 모델을 내장하고, 입력 신호인 기계 소음 데이터를 획득하고, 획득된 데이터를 스펙트로그램으로 전처리하고 기계학습 모델을 통하여 특징 벡터를 추출하여 정상 데이터 상태 및 비정상 데이터 상태를분류하는 인공지능 센서에 의한 기계학습 모델이 내장된 초소형 센서에서 이종 환경 적응을 위한 특징 벡터 보정 방법으로서,입력장치를 통해 획득된 상기 기계학습 모델이 내장된 초소형 센서 주변의 환경 소음으로부터 실시간으로 소리데이터를 획득하는 단계;상기 MCU가 상기 입력장치를 통해 획득된 소리 데이터를 스펙트로그램으로 전처리하고, 사전 훈련된 기계 학습모델을 통하여 특징 벡터를 추출하는 단계;상기 Application ML 모델이 Tiny ML 모델을 통해 상기 추출된 특징 벡터를 잠재 공간(Latent space)에 기초하여 정상 데이터 상태 및 비정상 데이터 상태로 분류하는 단계; 도메인 셀렉터에 의해 발생된 인터럽트 신호에 의해 상기 Application ML 모델이 정상 데이터 상태 및 비정상데이터 상태로 분류된 특징 벡터의 평균값이 원점(프로토타입)과의 차이로 바이어스 값을 산출하는 단계; 상기 Application ML 모델이 상기 산출된 바이어스 값을 신규 프로토타입으로 설정하는 단계; 및상기 Application ML 모델이 상기 신규 프로토타입에 기초하여 상기 정상 데이터 상태 및 비정상 데이터 상태로분류하는 신규 잠재 공간을 설정하여 상기 특정 벡터를 보정하는 단계;를 포함하는 기계학습 모델이 내장된 초소형 센서에서 이종 환경 적응을 위한 특징 벡터 보정 방법."}
{"patent_id": "10-2023-0044394", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "청구항 1에 있어서,상기 Application ML 모델에서 상기 특정 벡터가 보정되어 보정된 Application ML 모델이 형성되는 단계를 더포함하는 기계학습 모델이 내장된 초소형 센서에서 이종 환경 적응을 위한 특징 벡터 보정 방법."}
{"patent_id": "10-2023-0044394", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "청구항 1에 있어서,상기 Application ML 모델이 Tiny ML 모델을 통해 상기 추출된 특징 벡터를 잠재 공간에 기초하여 정상 데이터상태 및 비정상 데이터 상태로 분류하는 단계에서,상기 추출된 특징 벡터에 근거하여 Few-shot classification으로 상기 정상 데이터 상태 및 비정상 데이터 상태를 분류하는 기계학습 모델이 내장된 초소형 센서에서 이종 환경 적응을 위한 특징 벡터 보정 방법."}
{"patent_id": "10-2023-0044394", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "에 있어서,상기 Application ML 모델이 신규 프로토타입에 기초하여 정상 데이터 상태 및 비정상 데이터 상태로 분류하는신규 잠재 공간을 설정하여 상기 특징 벡터를 보정하는 단계에서,상기 Application ML 모델은 상기 데이터 저장부에 저장된 상기 신규 프로토타입을 기반으로 상기 추출된 특징벡터를 보정한 후에, 상기 신규 프로토타입과의 거리를 계산하며, 상기 계산된 거리와 사전 설정된 한계값에 기초하여 상기 획득된 데이터의 이상 유무를 판별하는 기계학습 모델이 내장된 초소형 센서에서 이종 환경 적응을위한 특징 벡터 보정 방법."}
{"patent_id": "10-2023-0044394", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "청구항 5에 있어서,상기 사전 설정된 한계값은 상기 획득된 데이터의 분산 정도에 따라서 상이한 기계학습 모델이 내장된 초소형센서에서 이종 환경 적응을 위한 특징 벡터 보정 방법."}
{"patent_id": "10-2023-0044394", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "청구항 1에 있어서,상기 MCU는 Few-shot learning 기반의 Application ML 모델이 내재된 32 비트 기반 MCU인 기계학습 모델이 내장된 초소형 센서에서 이종 환경 적응을 위한 특징 벡터 보정 방법."}
{"patent_id": "10-2023-0044394", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "청구항 1에 있어서,상기 도메인 셀렉터는 스위치의 작동에 의한 초기화 신호에 의해 이종 환경에서 상기 잠재 공간을 보정하는 일련의 과정을 진행시키는 인터럽트 신호를 발생시켜서 Few-shot learning 기반의 Application ML 모델을 통해 상기 획득된 데이터의 특징 벡터에 대한 신규 프로토타입을 데이터 저장부가 저장하게 하는 기계학습 모델이 내장된 초소형 센서에서 이종 환경 적응을 위한 특징 벡터 보정 방법."}
{"patent_id": "10-2023-0044394", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 기계학습 모델이 내장된 MCU(Microcontroller Unit)에 소리 센서와 같은 입력장치와 블루투스, 알람 등을 표시할 수 있는 출력장치로 구성하는 초소형 소음 센서로서, 기계의 소음 데이터만으로 기계 장비의 이상 유무를 판단하는 데에 이용되는 기계학습 모델이 내장된 초소형 센서에서 이종 환경 적응을 위한 특징 벡터 보정 (뒷면에 계속)"}
{"patent_id": "10-2023-0044394", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 기계학습 모델이 내장된 초소형 센서에서 이종 환경 적응을 위한 특징 벡터(Feature vector) 보정 방 법에 관한 것으로, 특히, 기계학습 모델이 내장된 MCU(Microcontroller Unit)에 소리 센서와 같은 입력장치와 블루투스, 알람 등을 표시할 수 있는 출력장치로 구성하는 초소형 소음 센서로서, 기계의 소음 데이터만으로 기 계 장비의 이상 유무를 판단하는 데에 이용되는 기계학습 모델이 내장된 초소형 센서에서 이종 환경 적응을 위 한 특징 벡터 보정 방법에 관한 것이다."}
{"patent_id": "10-2023-0044394", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "기존의 기계학습 기반의 소음 데이터를 이용한 기계 설비의 고장 판별 장치 및 방법은 소음 데이터 획득부, 데 이터 전처리부, 기계학습 모델부, 후처리부, 이상 유무 판별부로 구성되어 있다. 여기서, 소음 정보는 Mel-spectrogram 과 같은 다양한 변환을 통해 특징 벡터를 추출할 수 있도록 전 처리를 한 다. 스펙트로그램으로 변환된 소음 정보는 이미지 처리 기계학습 모델로도 훈련 및 분석이 가능하게 된다. 또한, 소리 정보를 처리하기 위한 기계학습 모델은 CNN, LSTM RNN, Autoencoder 등의 다양한 구조를 가진 다층 인공 신경망이 적용된다. 2019년 Harsh Purohit 외 6인은 기계 설비의 이상 유무를 판단하기 위한 기계학습 모 델의 훈련 데이터와 기본 모델을 발표하였는데, 여기서는 기본적인 구조의 Autoencoder가 사용되었다. 이 외에 도 스펙트로그램으로 변환할 수 있다는 특성을 이용하여 다층 CNN 구조, Residual Network 등의 구조가 활용되 고 있다. 따라서, 이러한 기계 학습 모델은 직접적으로 정상 동작과 이상 동작을 분류하는 분류기(Classifier)로 만들어 지거나, 특징 벡터를 추출한 뒤에 클러스터링과 같은 후처리로 이상 유무를 판단한다. 한편, 기계학습 모델로는 다층 인공 신경망이 활용된다. 인공 신경망을 통한 특징 벡터의 추출은 입력 데이터에 내재된 다양한 특성 벡터 간의 비선형 관계를 처리할 수 있는 장점을 가지고 있다. 인공 신경망의 발전으로 인 해 기계학습을 통한 소리 정보 처리는 높은 수준에 도달했지만, 초소형 장비로의 이식에는 아직 한계를 가지고 있다. 또한, 기존의 기계학습 기반의 소음 데이터를 이용한 기계 설비의 고장 판별 장치 및 방법은 유의미한 특징을 검출하기 위해서는 적어도 수십, 수백층의 레이어를 적층하여야 하는데, 이렇게 하면 모델의 크기가 수MB에서 수십MB크기로 된다. 이 정도의 크기는 MCU에서는 실장할 수 없는 의미없는 모델이 되는 것이다. 모델의 크기를 100KB 이내로 하기 위하여 레이어를 최소로 하여 단순 분류기로 실행시키며, 크기를 더욱 줄이기 위하여 컴파일 시에 양자화 및 최적화 과정을 거친다. 그러나, 이런 단순화 과정에서 모델의 분류 성능을 크게 잃게 되고, 결 과적으로 원하는 분류 성능을 얻기 어렵게 된다는 문제점이 있다. 또한, 특정 데이터 셋으로 훈련된 학습모델은 해당 데이터 셋에서는 좋은 학습 효과를 내지만, 바뀐 환경에서는 기존의 데이터의 분포와 다른 정보가 들어오게 되어 기존의 학습 모델에서는 잘못된 분류 결과가 나올 수 있게 된다. 게다가 단순한 레이어 구조로 인하여, 과적합(overfitting)된 모델은 데이터 셋이 바뀌는 환경 변화에 대 해서 민감하게 동작할 수 있기 때문에, 이러한 모델로서는 다양한 입력 신호의 이상 유무를 올바로 판별할 수 없게 된다는 문제점이 있다. 또한, 기계 설비의 고장 판별 장치에 내장되는 학습 모델을 훈련시키기 위한 데이터 셋은 정상 데이터(Normal Dataset)는 쉽게 구하지만, 비정상 데이터(Abnormal Dataset)는 구하기 어렵다는 문제점이 있어, 정상 데이터만 을 이용한 훈련으로 비정상 데이터를 감지할 수 있어야 한다."}
{"patent_id": "10-2023-0044394", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명의 목적은 상기와 같은 문제를 해결하기 위해 안출된 것으로, 정상 데이터와 비정상 데이터로 직접적으 로 구분하기 보다는, 다양한 소리 정보를 학습하는 과정에서 일반적인 기계 소리의 특징 벡터를 잘 나타낼 수 있는 잠재 공간(Latent space)을 학습한 비교적 단순한 다층 인공 신경망 구조를 활용하여, 다양한 기계 소리를 구분할 수 있는 잠재 특징 벡터를 추출하고 MCU에 최적화된 연산 과정을 통해서 분류할 수 있으며, 다양한 기계 소리를 현장에서 짧은 시간의 재보정 과정을 통해 새로운 데이터도 훈련된 잠재 공간 상에 잘 분포될 수 있도록 하는 기계학습 모델이 내장된 초소형 센서에서 이종 환경 적응을 위한 특징 벡터 보정 방법을 제공하고자 하는 것이다. 본 발명이 해결하고자 하는 과제들은 이상에서 언급된 과제로 제한되지 않으며, 언급되지 않은 또 다른 과제들 은 아래의 기재로부터 통상의 기술자에게 명확하게 이해될 수 있을 것이다."}
{"patent_id": "10-2023-0044394", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명에 따른 기계학습 모델이 내장된 초소형 센서에서 이종 환경 적응을 위한 특징 벡터 보정 방법은 MCU에 Application ML 모델을 내장하고, 입력 신호인 기계 소음 데이터를 획득하고, 획득된 데이터를 스펙트로그램으 로 전처리하고 기계학습 모델을 통하여 특징 벡터를 추출하여 정상 데이터 상태 및 비정상 데이터 상태를 분류 하는 인공지능 센서에 의한 기계학습 모델이 내장된 초소형 센서에서 이종 환경 적응을 위한 특징 벡터 보정 방법으로서, 입력장치를 통해 획득된 상기 기계학습 모델이 내장된 초소형 센서 주변의 환경 소음으로부터 실시간 으로 소리 데이터를 획득하는 단계; 상기 MCU가 상기 입력장치를 통해 획득된 소리 데이터를 스펙트로그램으로 전처리하고, 사전 훈련된 기계 학습 모델을 통하여 특징 벡터를 추출하는 단계; 상기 Application ML 모델이 Tiny ML 모델을 통해 상기 추출된 특징 벡터를 잠재 공간(Latent space)에 기초하여 정상 데이터 상태 및 비정 상 데이터 상태로 분류하는 단계; 도메인 셀렉터에 의해 발생된 인터럽트 신호에 의해 상기 Application ML 모 델이 정상 데이터 상태 및 비정상 데이터 상태로 분류된 특징 벡터의 평균값이 원점(프로토타입)과의 차이로 바 이어스 값을 산출하는 단계; 상기 Application ML 모델이 상기 산출된 바이어스 값을 신규 프로토타입으로 설 정하는 단계; 및 상기 Application ML 모델이 상기 신규 프로토타입에 기초하여 상기 정상 데이터 상태 및 비정 상 데이터 상태로 분류하는 신규 잠재 공간을 설정하여 상기 특정 벡터를 보정하는 단계;를 포함하는 것을 특징 으로 한다."}
{"patent_id": "10-2023-0044394", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "상술한 바와 같이, 본 발명에 따른 기계학습 모델이 내장된 초소형 센서에서 이종 환경 적응을 위한 특징 벡터 보정 방법은 수십KB 크기의 학습모델이 내장된 32비트 MCU에서 기계 소음 데이터를 이용하여 이종환경에서 추가 훈련 과정 없이도 기계장치의 이상 유무를 판단할 수 있는 초소형 인공지능 센서를 구현할 수 있다는 이점이 있 다."}
{"patent_id": "10-2023-0044394", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 2, "content": "본 발명의 효과들은 이상에서 언급된 효과로 제한되지 않으며, 언급되지 않은 또 다른 효과들은 아래의 기재로 부터 통상의 기술자에게 명확하게 이해될 수 있을 것이다."}
{"patent_id": "10-2023-0044394", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하, 도면을 참조한 실시 예들의 상세한 설명을 통하여 본 발명에 따른 기계학습 모델이 내장된 초소형 센서에 서 이종 환경 적응을 위한 특징 벡터 보정 방법을 보다 상세히 기술하기로 한다. 본 발명을 설명함에 있어서 관 련된 공지기술 또는 구성에 대한 구체적인 설명이 본 발명의 요지를 불필요하게 흐릴 수 있다고 판단되는 경우 에는 그 상세한 설명은 생략될 것이다. 그리고, 후술되는 용어들은 본 발명에서의 기능을 고려하여 정의된 용어 들로서 이는 클라이언트나 운용자, 사용자의 의도 또는 관례 등에 따라 달라질 수 있다. 그러므로 정의는 본 명 세서 전반에 걸친 내용을 토대로 내려져야 할 것이다. 도면 전체에 걸쳐 같은 참조번호는 같은 구성 요소를 가리킨다. 도 1은 본 발명에 따른 기계학습 모델이 내장된 초소형 센서의 블록 구성도이며, 도 2는 도 1의 초소형 센서의 응용 프로그램을 구현한 예시도이며, 도 3a 내지 도 3d는 본 발명에 따른 기계학습 모델이 내장된 초소형 센서 에서 이종 환경 적응을 위한 특징 벡터 보정 방법에서의 정상 데이터, 비정상 데이터, 프로토타입을 설명하기 위한 예시도이며, 도 4는 본 발명에 따른 기계학습 모델이 내장된 초소형 센서에서 이종 환경 적응을 위한 특징 벡터 보정 방법의 흐름도이다. 이제, 도 1을 참조하여, 본 발명에 따른 기계학습 모델이 내장된 초소형 센서를 살펴보고자 한다. 도 1에 도시된 바와 같이, 본 발명에 따른 기계학습 모델이 내장된 초소형 센서는 입력장치, MCU, 출 력장치, 스위치, RF 인터페이스 모듈을 포함한다 상기 입력장치는 주변의 환경 소음을 이미지 데이터로 변환하는 역할을 하며, 진동센서, 제1 필터 , 마이크, 제2 필터, 신호변환부를 포함한다. 여기서, 진동센서는 센서 설치 장소에 대한 진동 신호를 감지하여, 진도의 범위가 사전설정된 기준값을 벗 어나면 경보가 울리게 하며, 널리 공지되었기에 자세한 설명은 생략한다. 또한, 제1 필터 및 제2 필터는 칼만필터 또는 저역통과필터(LPF, Low Pass Filter)로 구성되어 주변 의 환경 소음을 억제하며, 널리 공지되었기에 자세한 설명은 생략한다. 또한, 마이크는 주변의 환경 소음을 증폭시키는 역할을 하며, 널리 공지되었기에 자세한 설명은 생략한다. 또한, 신호변환부는 사운드 신호를 스펙트럼 변환하되, Mel-Spectrogram과 같은 주파수, 진폭 변환하여 사 운드를 이미지 데이터로 변환하며, 널리 공지되었기에 자세한 설명은 생략한다. 상기 입력장치를 통해 변환된 이미지 데이터는 32 비트 기반의 MCU에 제공된다. MCU는 입력장치를 통해 입력 신호(환경 소음) 데이터를 획득하고, 획득된 환경 소음 데이터를 스펙트 로그램(Spectrogram)으로 전처리하고, 사전 훈련된 기계 학습 모델을 통하여 특징 벡터를 추출하고, 추출된 특 징 벡터에 근거하여 Few-shot classification으로 정상 데이터 상태 및 비정상 데이터 상태를 분류한다. MCU는 이종 환경에서 소량의 정상 데이터를 추가적으로 획득한 후에 획득된 데이터를 기반으로 비정상 동 작을 판단하는데, 이는 이종 환경에서 비정상 상태를 구분하는 데에, 매우 적은 양의 추가 정상 데이터만을 필 요로 하므로, 기계 학습 모델의 추가 훈련 과정을 필요로 하지 않는다. 여기서, 기계학습 모델은 정상 데이터만 있는 조건에서, 정상 데이터와 정상 데이터에 무작위 노이즈를 추가한 데이터를 생성하고, Triplet loss를 계산 함으로써, 서로 다른 기계의 소리를 구분하는 것이 아니고, 비정상 상황을 판단하도록 훈련한다. MCU는 도메인 셀렉터(Domain selector, 210), Application ML 모델, 데이터 저장부를 포함한다. 여기서, 도메인 셀렉터는 스위치의 작동에 의한 초기화 신호에 의해 이종 환경에서 잠재 공간(Latent space)을 보정하는 일련의 과정을 진행시키는 인터럽트 신호를 발생시켜서 Few-shot learning 기반의 Application ML 모델을 통해 얻게 되는 새로운 환경소음의 특징 벡터에 대한 신규 프로토타입(Prototype) 정보를 데이터 저장부가 저장할 수 있게 한다. 또한, 도메인 셀렉터에 의해 발생된 인터럽트 신호는 Application ML 모델이 새로운 정상 데이터를 획득한 후에 특징 벡터를 추출하며, 새로운 환경(이종 환경)의 특징 벡터의 평균값이 프로토타입에 위치하도록 바이어스(Bias) 값을 산출하여 잠재 공간을 보정하는 방식을 사용한다. 또한, Application ML 모델은 Tiny ML 모델을 통해 특징 벡터를 추출하며, 데이터 저장부에 저장된 신규 프로토타입을 기반으로 특징 벡터를 보정한 후에, 신규 프로토타입과의 거리를 계산한 후에 이상 유무를 판별한다. 또한, 데이터 저장부는 도메인 셀렉터 및 Application ML 모델과 연결되어 도메인 셀렉터(21 0)에 의해 Application ML 모델을 통해 얻게 되는 새로운 환경소음의 특징 벡터에 대한 신규 프로토타입을 저장한다. 출력장치는 블루투스, 외부 경광등과 연결할 수 있는 릴레이 접점 출력이며, 널리 공지되었기에 자세한 설 명은 생략한다. 스위치는 사용자에 의해 작동되며, 도메인 셀렉터가 인터럽트 신호를 발생시키게 한다. RF 인터페이스 모듈은 에지컴퓨터, 휴대용 단말기(스마트폰)와 블루투스, LoRa(Long Range) 망과 무선으로 연결하는 무선 출력장치이며, 널리 공지되었기에 자세한 설명은 생략한다. 이제, 도 2를 참조하여, 초소형 센서의 응용 프로그램을 살펴보고자 한다. 도 2에 도시된 초소형 센서의 응용 프로그램은 MCU에 적합한 소리 정보 처리를 위한 CNN 기반의 다층 신경 망 구조의 다층 신경망 기계학습 모델로 프로그램된다. 여기서, 다층 신경망 기계학습 모델은 다양한 기계 장비의 소리 정보를 활용하여 Multi-class classifier로 훈 련시킨다. 이 훈련 과정 속에서 다층 신경망 기계학습 모델은 소리 정보의 특징 벡터를 추출할 수 있는 인공지 능 특징 추출기(AI Feature extractor)가 된다. 또한, 짧은 시간 동안의 입력 소리 정보를 이용하여 특징 잠재 공간이 새로운 소리 정보도 나타낼 수 있도록 보 정한다. 도 2에 도시된 바와 같이, 초소형 센서의 응용 프로그램에서 짧은 시간의 입력 데이터(예를 들어, 00001110)는 새로운 정상 동작의 기준인 프로토타입이 되고, 이후 발생하는 이상 동작의 소리를 감지하는 기준이 된다. Application ML 모델의 훈련 과정에서 설정된 원점(프로토타입)과 새로 얻어진 프로토타입 간의 거리가 충 분히 확보될 수 있도록 잠재 공간의 바이어스 값을 계산한다. 상기 입력 데이터는 정상 동작의 프로토타입을 중심으로 한계 범위를 계산하는데 이용되며, 이는 미래 발생할 이상 동작을 분류하는데 사용된다. 이종환경에서의 Application ML 모델의 특징 벡터 보정 과정의 시작은 도메인 셀렉터에 의한 인터럽 트 입력에 의해서 실행되되, 스위치의 작동에 의한 초기화 신호에 의해서 시작되며, 초기화 과정에서 한번 실행된다. Application ML 모델의 보정이 끝나면 벡터의 바이어스 값을 실제 실행 과정에서 특징 벡터 보정에서 사용 한다. 이제, 도 3a 내지 도 3d를 참조하여, 본 발명에 따른 기계학습 모델이 내장된 초소형 센서에서 이종 환경 적응 을 위한 특징 벡터 보정 방법에서의 정상 데이터, 비정상 데이터, 프로토타입을 살펴보고자 한다. 본 발명에 따른 기계학습 모델이 내장된 초소형 센서에서 이종 환경 적응을 위한 특징 벡터 보정 방법에서의 정 상 데이터, 비정상 데이터, 프로토타입은 전술한 바와 같이, 도메인 셀렉터에 의한 인터럽트 입력에 의해 서 실행되며, 여기서, A, B, C, D는 정상 데이터이고, A', B', C', D'는 비정상 데이터이며, A, B, C, D는 프 로토타입이다. 도 3a에 도시된 바와 같이, 다양한 기계의 정상 데이터로부터 노이즈를 추가해 다양한 비정상 데이터를 생성하 며, Triplet Loss를 이용하여 다양한 기계의 정상 데이터 상태 및 비정상 데이터 상태로 구분하는 기계 학습 모 델을 학습시킨다. 따라서, 상기 기계학습 모델은 다양한 기계의 정상 데이터의 특징 벡터를 추출할 수 있도록 학습된다. 여기서, 프로토타입에 가깝게 정상 데이터(A, B, C)가 위치하며, 프로토타입으로부터 거리가 이격되 어 분산된 비정상 데이터(A', B', C')가 위치한다. 이후, 도 3b에 도시된 바와 같이, 도메인 셀렉터)에서 시그널이 발생하면, 새롭게 얻어지는 데이터를 사전 에 훈련된 Application ML 모델을 통해서 특징 벡터로 변환한 후에 메모리 저장부에 저장한다. 여기 서, 프로토타입에 형성된 중심원 안에 모인 A, B, C가 프로토타입이며, 중심원의 외부에 분산된 정상 데이터(D) 및 비정상 데이터(A', B', C')가 위치한다. 그 후, 도 3c에 도시된 바와 같이, 새롭게 획득된 이종 환경에 대한 특징 벡터들로부터 프로토타입을 계산하고 기존의 훈련과정에서 저장된 프로토타입들과의 거리를 계산하여 앞으로 새롭게 얻어질 데이터(D)를 보정하기 위 한 바이어스 값을 계산한다. 여기서, 새롭게 얻어질 데이터(D)를 프로토타입에 형성된 중심원 안에 위치시키기 위해 데이터(D)를 보정하기 위한 바이어스 값이 계산된다. 이후, 도 3d에 도시된 바와 같이, 새롭게 인입하는 데이터(N, N')는 특징 벡터로 변환한 후에 프로토타입들과의 거리를 계산해서 정상과 비정상을 판단하게 된다. 이때 새로운 환경에서의 정상 프로토타입들뿐만 아니라, 훈련 시에 사용된 데이터들의 정상 프로토타입들도 사용된다. 여기서, 새롭게 인입하는 데이터(N, N')는 프로토타입 (A, B, C, D)들과의 거리(화살표로 표시)를 계산하되, 예를 들어, 새롭게 인입하는 데이터(N)와 프로토타입(B, D)들과의 거리가 계산되고 그 계산 결과가 프로토타입에 형성된 중심원 안에 속하므로 정상 데이터 상태로 판단 한다. 또한, 새롭게 인입하는 데이터(N')는 프로토타입(C, D)들과의 거리가 계산되고 그 계산 결과가 프로토타 입에 형성된 중심원을 벗어나므로 비정상 데이터 상태로 판단한다. 본 발명에 따른 기계학습 모델이 내장된 초소형 센서에서 이종 환경 적응을 위한 특징 벡터 보정 방법에서 새롭 게 획득된 정상 데이터의 분산 정도에 따라서 한계값이 달라질 수 있다. 이제, 도 4를 참조하여, 본 발명에 따른 기계학습 모델이 내장된 초소형 센서에서 이종 환경 적응을 위한 특징 벡터 보정 방법을 살펴보고자 한다. 도 4에 도시된 바와 같이, 본 발명에 따른 기계학습 모델이 내장된 초소형 센서에서 이종 환경 적응을 위한 특 징 벡터 보정 방법은 단계 S410에서 입력장치를 통해 획득된 기계학습 모델이 내장된 초소형 센서 주변의환경 소음으로부터 실시간으로 소리 데이터를 획득한다. 단계 S420에서 MCU가 입력장치를 통해 획득된 소리 데이터를 스펙트로그램으로 전처리하고, 사전 훈 련된 기계 학습 모델을 통하여 특징 벡터를 추출한다. 단계 S430에서 Application ML 모델이 Tiny ML 모델을 통해 추출된 특징 벡터를 분류한다. 여기서, 추출된 특징 벡터에 근거하여 Few-shot classification으로 정상 데이터 상태 및 비정상 데이터 상태로 분류한다. 단계 S440에서 도메인 셀렉터에 의해 발생된 인터럽트 신호에 의해 Application ML 모델이 정상 데이 터 상태 및 비정상 데이터 상태로 분류된 특징 벡터의 평균값이 프로토타입과의 차이로 바이어스 값을 산출한다. 단계 S450에서 Application ML 모델이 산출된 바이어스 값을 신규 프로토타입으로 설정한다. 여기서, 특징 벡터로 변환된 입력 신호(환경 소음)와 프로토타입들과의 거리가 계산되어 정상 데이터 상태 및 비정상 데이터 상태로 판단되게 된다. 단계 S460에서 Application ML 모델이 신규 프로토타입에 기초하여 정상 데이터 상태 및 비정상 데이터 상 태로 분류하는 신규 잠재 공간을 설정하여 특징 벡터를 보정한다. 단계 S470에서 Application ML 모델에서 특정 벡터가 보정되어 보정된 Application ML 모델이 형성된다. 전술한 바와 같은 본 발명에 따른 기계학습 모델이 내장된 초소형 센서에서 이종 환경 적응을 위한 특징 벡터 보정 방법은 수십KB 크기의 학습모델이 내장된 32비트 MCU에서 기계 소음 데이터를 이용하여 이종환경에서 추가 훈련 과정 없이도 기계장치의 이상 유무를 판단할 수 있는 초소형 인공지능 센서를 구현할 수 있다. 이상과 같이 본 발명은 양호한 실시 예에 근거하여 설명하였지만, 이러한 실시 예는 본 발명을 제한하려는 것이"}
{"patent_id": "10-2023-0044394", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "아니라 예시하려는 것이므로, 본 발명이 속하는 기술분야의 숙련자라면 본 발명의 기술사상을 벗어남이 없이 위 실시 예에 대한 다양한 변화나 변경 또는 조절이 가능할 것이다. 그러므로, 본 발명의 보호 범위는 본 발명의 기술적 사상의 요지에 속하는 변화 예나 변경 예 또는 조절 예를 모두 포함하는 것으로 해석되어야 할 것이다."}
{"patent_id": "10-2023-0044394", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명에 따른 기계학습 모델이 내장된 초소형 센서의 블록 구성도이다. 도 2는 도 1의 초소형 센서의 응용 프로그램을 구현한 예시도이다. 도 3a 내지 도 3d는 본 발명에 따른 기계학습 모델이 내장된 초소형 센서에서 이종 환경 적응을 위한 특징 벡터 보정 방법에서의 정상 데이터, 비정상 데이터, 프로토타입을 설명하기 위한 예시도이다. 도 4는 본 발명에 따른 기계학습 모델이 내장된 초소형 센서에서 이종 환경 적응을 위한 특징 벡터 보정 방법의 흐름도이다."}
