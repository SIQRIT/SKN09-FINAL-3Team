{"patent_id": "10-2021-0123351", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2023-0040126", "출원번호": "10-2021-0123351", "발명의 명칭": "아키텍처 확장을 통한 신경망의 유효 정밀도 향상 방법 및 장치", "출원인": "주식회사 사피온코리아", "발명자": "최용석"}}
{"patent_id": "10-2021-0123351", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "신경망의 아키텍처를 확장하는 컴퓨터 구현 방법에 있어서,상기 신경망에 포함된 뉴런들 중 타겟 생산자 뉴런을 선택하는 과정; 상기 타겟 생산자 뉴런은 주어진 클리핑범위에 따라 클리핑된 액티베이션을 출력함,상기 주어진 클리핑 범위를 복수의 세그먼트들로 분할하는 과정;상기 타겟 생산자 뉴런을 상기 세그먼트들에 대응되는 복수의 생산자 뉴런으로 대체하는 과정; 각 생산자 뉴런이 상기 타겟 생산자 뉴런의 입력을 처리하도록 각 생산자 뉴런의 파라미터들을 설정하는 과정;및상기 타겟 생산자 뉴런에 연결된 소비자 뉴런이 상기 복수의 생산자 뉴런의 출력들을 처리하도록, 상기 소비자뉴런의 파라미터들을 설정하는 과정을 포함하는, 방법."}
{"patent_id": "10-2021-0123351", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 각 생산자 뉴런은,상기 복수의 세그먼트들 중 대응되는 세그먼트의 범위에 따라 클리핑된 액티베이션을 출력하는 것인, 방법."}
{"patent_id": "10-2021-0123351", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1항에 있어서,상기 복수의 생산자 뉴런에 의해 출력되는 복수의 출력 액티베이션은 상기 타겟 생산자 뉴런에 의해 출력되는상기 클리핑된 액티베이션과 동일한 정밀도(precision)를 가지는 것인, 방법."}
{"patent_id": "10-2021-0123351", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제1항에 있어서,상기 복수의 세그먼트들을 상기 주어진 클리핑 범위와 같은 크기를 가지며, 서로 겹치지 않는 세그먼트들로 변환하는 과정을 더 포함하는, 방법."}
{"patent_id": "10-2021-0123351", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제1항에 있어서,상기 복수의 세그먼트들 중 적어도 두 개는 서로 다른 크기를 갖는, 방법."}
{"patent_id": "10-2021-0123351", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제1항에 있어서,각 세그먼트의 범위를 각 생산자 뉴런의 연산 범위를 고려하여 조정하는 과정을 더 포함하는, 방법."}
{"patent_id": "10-2021-0123351", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "공개특허 10-2023-0040126-3-제6항에 있어서,상기 각 생산자 뉴런의 파라미터들을 설정하는 과정은,상기 각 생산자 뉴런에 대응되는 세그먼트의 범위와 상기 조정된 세그먼트의 범위에 기초하여, 상기 각 생산자뉴런의 파라미터들을 설정하는 과정을 포함하고,상기 소비자 뉴런의 파라미터들을 설정하는 과정은,상기 각 생산자 뉴런에 대응되는 세그먼트의 범위와 상기 조정된 세그먼트의 범위에 기초하여, 상기 각 생산자뉴런의 출력에 적용되는 파라미터들을 설정하는 과정을 포함하는, 방법."}
{"patent_id": "10-2021-0123351", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제1항에 있어서,상기 각 생산자 뉴런은 상기 타겟 생산자 뉴런의 파라미터들과 동일한 파라미터들을 이용하여 상기 입력을 처리하고, 상기 소비자 뉴런은 상기 타겟 생산자의 출력에 적용되는 파라미터들과 동일한 파라미터들 및 상기 복수의 세그먼트들에 따른 오프셋을 이용하여, 상기 복수의 생산자 뉴런의 출력들을 처리하는, 방법."}
{"patent_id": "10-2021-0123351", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "명령어들을 저장하는 메모리; 및적어도 하나의 프로세서를 포함하되,상기 적어도 하나의 프로세서는 상기 명령어들을 실행함으로써,신경망에 포함된 뉴런들 중 타겟 생산자 뉴런을 선택하되, 상기 타겟 생산자 뉴런은 주어진 클리핑 범위에 따라클리핑된 액티베이션을 출력하고,상기 클리핑 범위를 복수의 세그먼트들로 분할하고,상기 타겟 생산자 뉴런을 상기 세그먼트들에 대응되는 복수의 생산자 뉴런으로 대체하고,각 생산자 뉴런이 상기 타겟 생산자 뉴런의 입력을 처리하도록 각 생산자 뉴런의 파라미터들을 설정하고,상기 타겟 생산자 뉴런에 연결된 소비자 뉴런이 상기 복수의 생산자 뉴런의 출력들을 처리하도록, 상기 소비자뉴런의 파라미터들을 설정하는, 연산 장치."}
{"patent_id": "10-2021-0123351", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제1항 내지 제8항 중 어느 한 항의 방법을 실행하기 위한 컴퓨터 프로그램을 기록한 컴퓨터로 판독 가능한 기록매체."}
{"patent_id": "10-2021-0123351", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "아키텍처 확장을 통한 신경망의 유효 정밀도 향상 방법 및 장치를 개시한다. 본 발명의 일 측면에 의하면, 신경망의 아키텍처를 확장하는 컴퓨터 구현 방법에 있어서, 상기 신경망에 포함된 뉴런들 중 타겟 생산자 뉴런을 선택하는 과정, 상기 타겟 생산자 뉴런은 주어진 클리핑 범위에 따라 클리핑된 액 티베이션을 출력함, 상기 주어진 클리핑 범위를 복수의 세그먼트들로 분할하는 과정, 상기 타겟 생산자 뉴런을 상기 세그먼트들에 대응되는 복수의 생산자 뉴런으로 대체하는 과정, 각 생산자 뉴런이 상기 타겟 생산자 뉴런의 입력을 처리하도록 각 생산자 뉴런의 파라미터들을 설정하는 과정, 및 상기 타겟 생산자 뉴런에 연결된 소비자 뉴런이 상기 복수의 생산자 뉴런의 출력들을 처리하도록, 상기 소비자 뉴런의 파라미터들을 설정하는 과정을 포 함하는, 방법을 제공한다."}
{"patent_id": "10-2021-0123351", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명의 실시예들은 신경망의 유효 정밀도를 향상시키는 방법 및 장치, 자세하게는 신경망의 아키텍처를 확장 함으로써 신경망의 유효 정밀도를 향상시키는 방법 및 장치에 관한 것이다."}
{"patent_id": "10-2021-0123351", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "이 부분에 기술된 내용은 단순히 본 발명에 대한 배경 정보를 제공할 뿐 종래기술을 구성하는 것은 아니다. 신경망(neural network)은 인간의 뉴런 구조를 모사하여 만든 기계 학습 모델이다. 신경망은 하나 이상의 레이 어로 구성되고, 각 레이어의 출력 데이터는 다음 레이어의 입력으로 이용된다. 최근에는, 다수의 레이어로 구성 된 심층 (Deep neural network)를 활용하는 것에 대한 연구가 집중적으로 진행되고 있으며, 딥 뉴럴 네트워크는 음성 인식, 자연어 처리, 병변 진단 등 다양한 분야에서 인식 성능을 높이는 데 중요한 역할을 하고 있다. 신경망의 구조를 자세히 살펴보면, 신경망은 하나 이상의 레이어로 구성되고, 각 레이어는 인공 뉴런들을 포함 한다. 하나의 레이어의 인공 뉴런들은 다른 레이어의 인공 뉴런들과 가중치(weight)를 통해 연결된다. 인공 뉴 런들은 이전 레이어의 인공 뉴런들의 출력들로부터 가중치를 통해 수신한 데이터를 처리하고, 처리된 데이터를 다른 인공 뉴런들에 전송한다. 인공 뉴런들은 가중치를 통해 수신한 데이터에 바이어스(bias)를 더 적용할 수 있다. 신경망이 주어진 훈련 데이터 셋에 기초하여 훈련됨으로써, 가중치들과 바이어스들이 결정된다. 즉, 훈련 이 완료된 신경망은 유효한 가중치들과 바이어스들을 갖는다. 이후, 훈련이 완료된 신경망은 결정된 가중치들과 바이어스들을 이용하여 주어진 입력에 대한 태스크(task)를 수행한다. 일반적으로, 훈련이 완료된 신경망 내 가중치들과 바이어스들은 고정된 값을 가진다. 또한, 가중치들과 바이어 스들 각각은 고정된 정밀도를 가진다. 예를 들면, 신경망이 32 비트 부동 소수점 수(FP32, 32-bit floating- point numbers) 체계로 훈련된 경우, 가중치들과 바이어스들은 32 비트 부동 소수점 수 체계로 표현된다. 하지만, 가중치들과 바이어스들이 고정된 정밀도를 가지는 경우, 각 인공 뉴런은 고정된 정밀도보다 높은 정밀 도를 요구하는 연산을 수행하기 어렵다. 구체적으로, 인공 뉴런이 클리핑 함수(clipping function)를 이용하여 출력 범위를 제한하는 연산을 수행하는 경우, 인공 뉴런은 주어진 클리핑 범위에 따라 클리핑된 액티베이션을 출력할 수 있다. 클리핑 범위 내 액티베 이션은 그대로 출력되지만, 클리핑 범위 밖 액티베이션은 클리핑 범위의 경계값으로 포화(saturation) 또는 클 리핑되어 출력된다. 이때, 클리핑된 액티베이션은 고정된 정밀도로 표현된다. 고정된 정밀도가 낮은 정밀도인 경우, 클리핑된 액티베이션도 낮은 정밀도로 표현된다. 액티베이션들 중 일부가 높은 정밀도로 연산되어 신경망 의 정확도가 향상될 수 있더라도, 신경망의 훈련이 완료된 뒤에는 액티베이션이 고정된 정밀도를 가지므로 신경 망의 정확도가 상대적으로 저하된다. 따라서, 신경망 내 인공 뉴런의 정밀도가 고정되더라도, 일부 인공 뉴런이 고정된 정밀도보다 높은 정밀도를 연 산할 수 있도록 하는 연구가 필요하다."}
{"patent_id": "10-2021-0123351", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명의 실시예들은, 신경망 내 타겟 뉴런을 복수의 뉴런으로 대체하고, 대체된 뉴런들의 파라미터들을 설정 함으로써, 뉴런의 유효 정밀도를 향상시키기 위한 방법 및 장치를 제공하는 데 주된 목적이 있다. 본 발명의 다른 실시예들은, 대체된 뉴런들이 타겟 뉴런에게 주어진 클리핑 범위로부터 분할된 세그먼트들의 범 위에 따라 클리핑을 수행함으로써, 주어진 클리핑 범위 내에서 높은 정밀도를 가지는 액티베이션을 계산하도록 하여 뉴런의 유효 정밀도를 향상시키기 위한 방법 및 장치를 제공하는 데 일 목적이 있다. 본 발명의 다른 실시예들은, 대체된 뉴런들이 타겟 뉴런에게 주어진 클리핑 범위보다 넓은 범위 내에서 액티베 이션을 클리핑함으로써, 뉴런의 유효 정밀도를 향상시키기 위한 방법 및 장치를 제공하는 데 일 목적이 있다."}
{"patent_id": "10-2021-0123351", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명의 일 측면에 의하면, 신경망의 아키텍처를 확장하는 컴퓨터 구현 방법에 있어서, 상기 신경망에 포함된 뉴런들 중 타겟 생산자 뉴런을 선택하는 과정, 상기 타겟 생산자 뉴런은 주어진 클리핑 범위에 따라 클리핑된 액티베이션을 출력함, 상기 주어진 클리핑 범위를 복수의 세그먼트들로 분할하는 과정, 상기 타겟 생산자 뉴런 을 상기 세그먼트들에 대응되는 복수의 생산자 뉴런으로 대체하는 과정, 각 생산자 뉴런이 상기 타겟 생산자 뉴 런의 입력을 처리하도록 각 생산자 뉴런의 파라미터들을 설정하는 과정, 및 상기 타겟 생산자 뉴런에 연결된 소 비자 뉴런이 상기 복수의 생산자 뉴런의 출력들을 처리하도록, 상기 소비자 뉴런의 파라미터들을 설정하는 과정 을 포함하는, 방법을 제공한다. 본 실시예의 다른 측면에 의하면, 명령어들을 저장하는 메모리 및 적어도 하나의 프로세서를 포함하되, 상기 적 어도 하나의 프로세서는 상기 명령어들을 실행함으로써, 신경망에 포함된 뉴런들 중 타겟 생산자 뉴런을 선택하 되, 상기 타겟 생산자 뉴런은 주어진 클리핑 범위에 따라 클리핑된 액티베이션을 출력하고, 상기 클리핑 범위를 복수의 세그먼트들로 분할하고, 상기 타겟 생산자 뉴런을 상기 세그먼트들에 대응되는 복수의 생산자 뉴런으로 대체하고, 각 생산자 뉴런이 상기 타겟 생산자 뉴런의 입력을 처리하도록 각 생산자 뉴런의 파라미터들을 설정 하고, 상기 타겟 생산자 뉴런에 연결된 소비자 뉴런이 상기 복수의 생산자 뉴런의 출력들을 처리하도록, 상기 소비자 뉴런의 파라미터들을 설정하는, 연산 장치를 제공한다.본 실시예의 다른 측면에 의하면, 명령어가 저장된, 컴퓨터로 읽을 수 있는 기록매체로서, 상기 명령어는 상기 컴퓨터에 의해 실행될 때 상기 컴퓨터로 하여금, 신경망에 포함된 뉴런들 중 타겟 생산자 뉴런을 선택하는 과정, 상기 타겟 생산자 뉴런은 주어진 클리핑 범위에 따라 클리핑된 액티베이션을 출력함, 상기 클리핑 범위를 복수의 세그먼트들로 분할하는 과정, 상기 타겟 생산자 뉴런을 상기 세그먼트들에 대응되는 복수의 생산자 뉴런 으로 대체하는 과정, 각 생산자 뉴런이 상기 타겟 생산자 뉴런의 입력을 처리하도록 각 생산자 뉴런의 파라미터 들을 설정하는 과정, 및 상기 타겟 생산자 뉴런에 연결된 소비자 뉴런이 상기 복수의 생산자 뉴런의 출력들을 처리하도록, 상기 소비자 뉴런의 파라미터들을 설정하는 과정을 실행하도록 하는 것을 특징으로 하는, 컴퓨터로 읽을 수 있는 기록매체를 제공한다."}
{"patent_id": "10-2021-0123351", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "이상에서 설명한 바와 같이 본 발명의 일 실시예에 의하면, 신경망 내 타겟 뉴런을 복수의 뉴런으로 대체하고, 대체된 뉴런들의 파라미터들을 설정함으로써, 뉴런의 유효 정밀도를 향상시킬 수 있다. 본 발명의 다른 실시예에 의하면, 대체된 뉴런들이 타겟 뉴런에게 주어진 클리핑 범위로부터 분할된 세그먼트들 의 범위에 따라 클리핑을 수행함으로써, 주어진 클리핑 범위 내에서 높은 정밀도를 가지는 액티베이션을 계산하 도록 하여 뉴런의 유효 정밀도를 향상시킬 수 있다. 본 발명의 다른 실시예에 의하면, 대체된 뉴런들이 타겟 뉴런에게 주어진 클리핑 범위보다 넓은 범위 내에서 액 티베이션을 클리핑함으로써, 뉴런의 유효 정밀도를 향상시킬 수 있다."}
{"patent_id": "10-2021-0123351", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하, 본 발명의 일부 실시예들을 예시적인 도면을 통해 상세하게 설명한다. 각 도면의 구성요소들에 참조부호 를 부가함에 있어서, 동일한 구성요소들에 대해서는 비록 다른 도면 상에 표시되더라도 가능한 한 동일한 부호 를 가지도록 하고 있음에 유의해야 한다. 또한, 본 발명을 설명함에 있어, 관련된 공지 구성 또는 기능에 대한 구체적인 설명이 본 발명의 요지를 흐릴 수 있다고 판단되는 경우에는 그 상세한 설명은 생략한다. 또한, 본 발명의 구성 요소를 설명하는 데 있어서, 제 1, 제 2, A, B, (a), (b) 등의 용어를 사용할 수 있다. 이러한 용어는 그 구성 요소를 다른 구성 요소와 구별하기 위한 것일 뿐, 그 용어에 의해 해당 구성 요소의 본 질이나 차례 또는 순서 등이 한정되지 않는다. 명세서 전체에서, 어떤 부분이 어떤 구성요소를 '포함', '구비' 한다고 할 때, 이는 특별히 반대되는 기재가 없는 한 다른 구성요소를 제외하는 것이 아니라 다른 구성요소를더 포함할 수 있는 것을 의미한다. 또한, 명세서에 기재된 '~부', '모듈' 등의 용어는 적어도 하나의 기능이나 동작을 처리하는 단위를 의미하며, 이는 하드웨어나 소프트웨어 또는 하드웨어 및 소프트웨어의 결합으로 구현 될 수 있다. 도 1a는 신경망의 연산 구조를 나타낸 도면이다. 도 1a를 참조하면, 레이어, 아핀 변환 블록 및 클리핑 블록이 도시되어 있다. 레이어는 신경망에 포함된 적어도 하나의 레이어를 나타낸다. 신경망이 복수의 레이어를 포함하는 경우, 각 레이어는 다른 레이어의 출력을 입력으로 수신하고, 자신의 출력을 또 다른 레이어로 전송한다. 이하에서는, 레이어의 전후로 다른 레이어들이 존재하는 것으로 설명한다. 레이어는 이전 레이어로부터 입력들(xp,1, xp,2)을 수신한다. 레이어는 입력들(xp,1, xp,2)을 처리하고, 액티베이션들(yp,1, yp,2)을 출력한다. 레이어의 입력들(xp,1, xp,2)은 이전 레이어의 출력이다. 신경망에 포함된 각 레이어는 적어도 하나의 뉴런을 포함한다. 도 1a에서 레이어는 상단에 위치한 제1 뉴 런과 하단에 위치한 제2 뉴런을 포함한다. 제1 뉴런은 제1 가중치들(wp,11, wp,12)과 제1 바이어스(bp,1)를 포함한 다. 제2 뉴런은 제2 가중치들(wp,21, wp,22)과 제2 바이어스(bp,2)를 포함한다. 각 뉴런은 가중치들과 바이어스에 기초하여 입력들을 처리하여 바이어스된 가중합을 계산한다. 예를 들면, 제1 뉴런은 입력들(xp,1, xp,2)과 제1 가중치들(wp,11, wp,12)의 가중합을 계산하고, 가중합에 제1 바이어스(bp,1)를 반영 함으로써, 제1 바이어스된 가중합(hp,1)을 계산한다. 이를 아핀 변환(affine transformation)이라 한다. 각 뉴런은 클리핑 범위가 주어지며, 바이어스된 가중합에 클리핑을 수행할 수 있다. 클리핑 범위는 미리 주어지 는 값이다. 클리핑 범위는 신경망의 훈련이 완료될 때 신경망의 파라미터들과 함께 결정될 수 있다. 클리핑 범 위는 추론 단계에서 액티베이션의 값들에 기초하여 결정될 수도 있다. 이 외에도, 클리핑 범위는 사용자에 의해 설정될 수 있다. 도 1a에서, 제1 뉴런은 α, β를 클리핑 범위의 경계값으로 가진다. 제1 뉴런은 클리핑 범위에 따라 제1 바이어스된 가중합(hp,1)을 클리핑함으로써, 제1 액티베이션(yp,1)을 계산한다. 도 1b는 클리핑 함수를 나타낸 도면이다. 도 1b를 참조하면, 클리핑 함수는 클리핑 범위 [α, β]에 따라 바이어스된 가중합(h)을 클리핑한다. 클리핑 함 수는 클리핑 범위 내 입력을 그대로 출력하고, 클리핑 범위 밖 입력을 클리핑 범위의 경계값으로 출력한다. 즉, 클리핑 함수는 클리핑 범위 내에서 선형 함수로 표현된다. 클리핑 함수의 입력이 클리핑 범위 [α, β] 내 값인 경우, 클리핑 함수의 입력이 그대로 출력된다. 반면, 클리 핑 함수의 입력이 α보다 작은 값을 가지는 경우, 클리핑 함수의 출력은 α다. 클리핑 함수의 입력이 β보다 큰 값을 가지는 경우, 클리핑 함수의 출력은 β이다. 본 발명의 일 실시예에 의하면, 클리핑 블록에서 클리핑 함수와 활성화 함수가 함께 이용될 수 있다. 여기 서, 본 발명의 실시예를 적용하기 위해서, 활성화 함수는 클리핑 함수의 출력에 영향을 주지 않아야 한다. 구체적으로, 바이어스된 가중합은 활성화 함수에 먼저 입력되고, 활성화 함수의 출력은 클리핑 범위에 따라 클 리핑된 후 액티베이션으로 출력될 수 있다. 수학식을 이용하면, 바이어스된 가중합 h에 대해, 활성화 함수는 y=f(h)로 표현될 수 있고, 클리핑 함수의 식은 y=clip(h, α, β)로 표현될 수 있다. 바이어스된 가중합에 활성 화 함수와 클리핑 함수가 모두 적용되는 경우, 클리핑 함수는 활성화 함수의 출력을 입력으로 이용할 수 있다. 이때, 클리핑 함수의 출력은 y=clip(f(h), α, β)로 표현될 수 있다. 본 발명의 일 실시예에 의하면, 바이어스된 가중합에 대한 활성화 함수의 출력을 입력으로 하는 클리핑 함수의 출력은 바이어스된 가중합에 대한 클리핑 함수의 출력과 같다. 예를 들면, 활성화 함수가 ReLu(Rectified Linear unit) 함수이고, 클리핑 범위의 α 가 0 이상의 값을 가질 때, clip(ReLu(h), α, β)=clip(h, α, β)가 성립한다. 즉, 활성화 함수의 통과 여부는 클리핑 함수의 출력에 영향을 주지 않는다. 이와 같이, 바이어 스된 가중합에 대한 활성화 함수의 출력을 입력으로 가지는 클리핑 함수의 출력값은 바이어스된 가중합에 대한 클리핑 함수의 출력과 같을 때, 본 발명의 일 실시예에 따른 아키텍처 확장 방법이 적용될 수 있다. 도 1a 및 도 1b를 참조하면, 클리핑 범위가 주어지고, 각 뉴런은 주어진 클리핑 범위에 따라 클리핑을 수행하고, 고정된 정밀도를 가진 액티베이션을 출력한다. 같은 레이어로부터 출력된 액티베이션들은 단일 정밀도를 가진다. 다시 말하면, 액티베이션들은 주어진 클리핑 범위로 표현되며, 클리핑 범위 내에서도 고정된 정밀도로 표현된다. 뉴런들 중 일부로부터 출력된 액티베이션이 높은 정밀도로 표현될 필요가 있는 경우에도 고정된 정밀도로 표현 되면, 신경망의 성능이 온전히 발휘되지 못할 수 있다. 또한, 액티베이션이 주어진 클리핑 범위보다 넓은 범위 에서 클리핑되어야 할 필요가 있는 경우에도 주어진 클리핑 범위로 클리핑되면, 신경망의 성능이 온전히 발휘되 지 못할 수 있다. 도 2는 본 발명의 일 실시예에 따른 신경망의 아키텍처 확장을 나타내는 도면이다. 도 2를 참조하면, 신경망은 복수의 뉴런들(200, 202, 210, 212, 220, 222)을 포함한다. 구체적으로, 신경망은 세 개의 레이어를 포함하며, 각 레이어는 브랜치(branch)로 연결된다. 제1 레이어는 제1 뉴런들(200, 202)를 포 함하고, 제2 레이어는 제2 뉴런들(210, 212)를 포함하며, 제3 레이어는 소비자 뉴런들(220, 222)를 포함한다. 신경망은 훈련이 완료된 후 고정된 파라미터들을 가지며, 각 뉴런으로부터 출력되는 액티베이션은 고정된 정밀 도를 가진다. 예를 들면, 도 2에서 복수의 뉴런들(200, 202, 210, 212, 220, 222)은 256 단계의 액티베이션을 출력한다. 즉, 각 뉴런으로부터 출력되는 액티베이션은 256 단계의 정밀도를 가진다. 또한, 각 뉴런으로부터 출 력되는 액티베이션은 주어진 클리핑 범위 내의 값을 가진다. 이때, 일부 액티베이션이 주어진 클리핑 범위 내에서 높은 정밀도로 표현되는 경우, 신경망의 성능이 향상될 수 있다. 도 2에서 타겟 뉴런의 출력 액티베이션은 주어진 클리핑 범위 내에서 256 단계의 정밀도를 가지지만, 신경망의 정확도 향상을 위해 512 단계의 정밀도로 출력될 필요가 있다. 이 외에도, 일부 액티베이션이 동일한 해상도(resolution)를 가지되 주어진 클리핑 범위보다 넓은 범위로 표현 되는 경우, 신경망의 성능이 향상될 수 있다. 도 2에서 타겟 뉴런의 출력 액티베이션은 주어진 클리핑 범 위 내 값을 가지지만, 신경망의 정확도 향상을 위해 더 넓은 클리핑 범위에 따라 클리핑될 필요가 있다. 본 발명의 일 실시예에 의하면, 일부 뉴런으로부터 출력되는 액티베이션의 정밀도 향상을 위해 신경망의 아키텍 처는 확장될 수 있다. 높은 정밀도를 요구하거나 넓은 클리핑 범위를 요구하는 뉴런이 복수의 뉴런들로 대체됨 으로써, 신경망의 아키텍처가 확장될 수 있다. 도 2에서 타겟 뉴런은 제1 생산자 뉴런과 제2 생산자 뉴런로 대체된다. 이때, 제1 생산자 뉴런과 제2 생산자 뉴런은 각각 독립적인 클리핑 범위를 가진다. 제1 생산자 뉴런 과 제2 생산자 뉴런은 256 단계의 정밀도를 가지는 액티베이션을 출력한다. 제1 생산자 뉴런의 클리핑 범위와 제2 생산자 뉴런의 클리핑 범위의 합이 타겟 뉴런의 클리핑 범위와 동일한 경우, 아키텍처 확장으로 인해 타겟 뉴런의 출력 액티베이션의 유효 정밀도가 증가한 것과 동일한 효과가 있다. 제1 타겟 뉴런의 출력 액티베이션이 클리핑 범위 내에서 256 단계의 정밀도를 가지는 반면, 대체된 뉴런들(213, 214)의 출력 액티베이션들은 동일한 클리핑 범위 내에서 512 단계의 정밀도를 표현할 수 있다. 즉, 제1 생산자 뉴런과 제2 생산자 뉴런 모두에 연결된 소비자 뉴런들(220, 222)은 타겟 뉴 런의 출력 액티베이션보다 높은 정밀도의 액티베이션을 수신하는 것으로 볼 수 있다. 소비자 뉴런들(220, 222)은 타겟 뉴런으로부터 512 단계의 정밀도를 가지는 액티베이션과 동일한 입력을 입력 받게 된다. 즉, 소비자 뉴런들(220, 222)의 입력 액티베이션의 해상도가 증가한다. 한편, 제1 생산자 뉴런의 클리핑 범위와 제2 생산자 뉴런의 클리핑 범위의 합이 타겟 뉴런의 클 리핑 범위보다 큰 경우, 아키텍처 확장으로 인해 타겟 뉴런의 출력 액티베이션의 유효 정밀도가 증가한 것 과 동일한 효과가 있다. 제1 생산자 뉴런이 타겟 뉴런의 클리핑 범위와 동일한 범위로 액티베이션을 클리핑하고, 제2 생산자 뉴런이 타겟 뉴런의 클리핑 범위를 벗어난 범위로 액티베이션을 클리핑한다. 타겟 뉴런의 출력 액티베이션이 주어진 클리핑 범위 내 값을 가지는 반면, 대체된 뉴런들(213, 214)의 출 력 액티베이션들은 주어진 클리핑 범위보다 넓은 범위의 값을 나타낼 수 있다. 소비자 뉴런들(220, 222)은 타겟 뉴런으로부터 주어진 클리핑 범위보다 넓은 범위의 값을 가지는 액티베이션을 입력 받는 것과 같이 동작한 다. 이처럼, 각 레이어의 출력의 정밀도가 고정되고 클리핑 범위가 정해진 상황에서, 신경망은 각 레이어의 출력의 유효 정밀도(effective precision)를 향상시킬 수 있다.도 3은 본 발명의 일 실시예에 따른 타겟 생산자 뉴런 및 소비자 뉴런을 나타낸 도면이다. 도 3을 참조하면, 타겟 생산자 뉴런(target producer neuron) 및 소비자 뉴런(consumer neuron)이 도시되어 있 다. 타겟 생산자 뉴런과 소비자 뉴런은 서로 다른 레이어에 포함된다. 타겟 생산자 뉴런은 신경망의 정확도 향상을 위해 출력 액티베이션의 유효 정밀도 증가가 필요한 뉴런을 의미한 다. 타겟 생산자 뉴런으로부터, 주어진 클리핑 범위 내 값을 가지며 주어진 정밀도를 가지는 액티베이션이 출력 된다. 소비자 뉴런은 생산자 뉴런으로부터 액티베이션을 수신하고 처리하는 뉴런이다. 타겟 생산자 뉴런과 소비자 뉴런은 각각 파라미터들을 포함할 수 있다. 타겟 생산자 뉴런은 생산자 가중치(wp) 및 생산자 바이어스(bp)를 포함한다. 소비자 뉴런은 소비자 가중치(wc) 및 소비자 바이어스(bc)를 포함한다. 타겟 생산자 뉴런은 입력(xp)에 생산자 가중치(wp)를 곱한 후 생산자 바이어스(bp)를 더함으로써, 바이어스된 가 중합(hp)을 계산할 수 있다. 타겟 생산자 뉴런은 바이어스된 가중합(hp)을 주어진 클리핑 범위에 따라 클리핑함 으로써, 클리핑된 액티베이션(yp)을 출력할 수 있다. 클리핑된 액티베이션(yp)은 소비자 뉴런의 입력(xc)이 된다. 다만, 이하에서 생산자 뉴런의 입력과 소비자 뉴런의 입력이 1개인 것으로 설명하지만, 이는 일 실시예에 불과하며, 생산자 뉴런의 입력과 소비자 뉴런의 입력은 복수일 수 있다. 즉, 생산자 뉴런과 소비자 뉴런은 복수 의 입력에 대해 아핀 변환을 적용할 수 있다. 타겟 생산자 뉴런은 주어진 클리핑 범위에 따라 클리핑된 액티베이션을 출력한다. 타겟 생산자 뉴런의 클리핑 범위는 [αp, βp]로 주어진다. 타겟 생산자 뉴런의 액티베이션은 클리핑 범위 내 값을 가지며, 고정된 정밀도로 표현된다. 타겟 생산자 뉴런의 출력 액티베이션의 유효 정밀도를 향상시키기 위해, 타겟 생산자 뉴런은 복수의 생산자 뉴 런으로 대체된다. 도 4는 본 발명의 일 실시예에 따라 클리핑 범위의 분할을 나타낸 도면이다. 도 5a는 본 발명의 일 실시예에 따 라 신경망의 확장된 아키텍처를 나타낸 도면이다. 도 5b는 복수의 생산자 뉴런에 대응되는 클리핑 범위를 나타 내는 도면이다. 이하에서, 신경망의 아키텍처를 확장하는 데 수행되는 동작들은 전자장치에 의해 수행되는 것으로 설명한다. 전 자장치에 관한 구체적인 구성은 도 10에서 설명된다. 도 4를 참조하면, 클리핑 함수의 주어진 클리핑 범위 및 분할된 세그먼트들이 도시되어 있다. 타겟 생산자 뉴런 의 클리핑 범위는 [αp, βp]로 주어진다. 타겟 생산자 뉴런의 유효 정밀도를 높이기 위해, 전자장치는 타겟 생산자 뉴런의 클리핑 범위를 분할할 개수와 분할 범위를 결정한다. 결정된 분할 개수와 분할 범위에 기초하여, 전자장치는 타겟 생산자 뉴런의 클리핑 범위 를 복수의 세그먼트들로 분할한다. 복수의 세그먼트들은 동일한 크기를 가질 수도 있고, 서로 다른 크기를 가질 수도 있다. 또한, 복수의 세그먼트들 중 적어도 두개는 서로 다른 크기를 가질 수도 있다. 각 세그먼트의 범위 에 따라 클리핑된 액티베이션은 정밀도는 2m 단계의 정밀도를 갖는다. 도 5a를 참조하면, 전자장치는 도 3 내 타겟 생산자 뉴런을 분할된 세그먼트들에 대응되는 복수의 생산자 뉴런 으로 대체한다. 복수의 생산자 뉴런의 수는 복수의 세그먼트들의 수와 같다. 각 생산자 뉴런은 대응되는 세그먼 트의 범위에 따라 클리핑된 액티베이션을 출력한다. 도 5b를 참조하면, 분할된 세그먼트들에 대응되는 클리핑 함수들이 도시되어 있다. 제1 클리핑 함수는 제1 세그먼트를 클리핑 범위로 가지는 함수다. 제2 클리핑 함수는 제2 세그먼트를 클리핑 범위로 가지는 함수 다. 도 5a 및 도 5b를 참조하면, 제1 생산자 뉴런의 제1 클리핑 범위는 [αp,1, βp,1]이다. 제1 생산자 뉴런은 제1 클리핑 범위에 따라 제1 바이어스된 가중합(hp,1)을 클리핑함으로써, 제1 출력 액티베이션(yp,1)을 출력한다. 제2 생산자 뉴런의 제2 클리핑 범위는 [αp,2, βp,2]이다. 제2 생산자 뉴런은 제2 클리핑 범위에 따라 제2 바이어스된 가중합(hp,2)을 클리핑함으로써, 제2 출력 액티베이션(yp,2)을 출력한다. 타겟 생산자 뉴런이 복수의 생산자 뉴런으로 대체됨에 따라, 전자장치는 각 생산자 뉴런이 타겟 생산자 뉴런의 입력을 처리하도록 각 생산자 뉴런의 파라미터들을 설정한다. 구체적으로, 전자장치는 각 생산자 뉴런의 가중치 들과 바이어스를 설정한다. 각 생산자 뉴런은 타겟 생산자 뉴런과 동일한 입력을 입력 받고, 설정된 파라미터들을 이용하여 바이어스된 가 중합들을 계산한다. 각 생산자 뉴런은 대응되는 세그먼트의 범위에 따라 바이어스된 가중합을 클리핑한다. 한편, 타겟 생산자 뉴런이 복수의 생산자 뉴런으로 대체됨에 따라, 전자장치는 타겟 생산자 뉴런에 연결되어 있 던 소비자 뉴런이 복수의 생산자 뉴런의 출력들을 처리하도록 소비자 뉴런의 파라미터들을 설정한다. 구체적으 로, 소비자 뉴런은 각 생산자 뉴런의 출력에 적용되는 각각의 파라미터들을 포함하도록 설정된다. 타겟 생산자 뉴런에 연결되었던 소비자 뉴런은 복수의 생산자 각각에 연결된다. 소비자 뉴런은 각 생산자 뉴런의 출력 액티베이션들을 입력 받고, 출력 액티베이션들에 파라미터들을 적용한다. 구체적으로, 소비자 뉴런은 각 생산자 뉴런의 출력 액티베이션에 각 가중치를 적용함으로써, 가중합을 계산한다. 이후, 소비자 뉴런은 가중합에 바이어스를 반영한다. 도 5a를 참조하면, 각 생산자 뉴런은 타겟 생산자 뉴런의 파라미터들과 동일한 파라미터들을 이용하여 입력을 처리할 수 있다. 각 생산자 뉴런은 타겟 생산자 뉴런의 생산자 가중치(wp)와 생산자 바이어스(bp)를 자신의 가중 치와 바이어스로 가지도록 설정될 수 있다. 소비자 뉴런은 타겟 생산자의 출력에 적용되는 파라미터들과 동일한 파라미터들 및 복수의 세그먼트들에 따른 오프셋을 이용하여 복수의 생산자 뉴런의 출력을 처리할 수 있다. 구체적으로, 소비자 뉴런은 타겟 생산자 뉴런 의 출력에 적용되는 소비자 가중치(wc)와 동일한 가중치를 각 생산자 뉴런의 출력 액티베이션에 적용하여 가중합 을 계산한다. 소비자 뉴런은 복수의 세그먼트들에 따른 오프셋을 계산된 가중합에 반영함으로써, 소비자 뉴런의 출력을 계산한다. 소비자 뉴런의 출력은 수학식 1로 표현될 수 있다. 수학식 1"}
{"patent_id": "10-2021-0123351", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "수학식 1에서 hc는 소비자 뉴런의 출력, N은 생산자 뉴런의 수, wc는 소비자 가중치, yp,i는 각 생산자 뉴런의 출 력 액티베이션, αp는 주어진 클리핑 범위의 최솟값, βp는 주어진 클리핑 범위의 최댓값, bc는 소비자 바이어스, αp,i는 각 생산자 뉴런에 대응되는 세그먼트의 최솟값을 의미한다. 한편, 본 발명의 일 실시예에 의하면, 복수의 생산자 뉴런의 출력 액티베이션들은 타겟 생산자 뉴런의 출력 액 티베이션과 동일한 정밀도를 가진다. 도 3 및 도 5a를 참조하면, 제1 출력 액티베이션(yp,1), 제2 출력 액티베이 션(yp,2) 및 제n 출력 액티베이션(yp,n)은 타겟 생산자 뉴런에 의해 클리핑된 액티베이션(yp)과 동일한 정밀도를 갖는다. 이 경우, 복수의 생산자 뉴런은 타겟 생산자 뉴런에 비해 출력 액티베이션의 정밀도를 향상시킬 수 있 다. 복수의 뉴런의 수가 n 개이고, 복수의 생산자 뉴런의 출력 액티베이션들을 집계하면, 주어진 클리핑 범위는 N×2m 단계로 나뉜다. 주어진 클리핑 범위를 2m 단계로 구분하는 타겟 생산자 뉴런에 비해, 복수의 생산자 뉴런 은 주어진 클리핑 범위를 N×2m 단계로 구분할 수 있다. 이는, 복수의 생산자 뉴런에 연결된 소비자 뉴런이 더 높은 정밀도를 가지는 액티베이션을 입력으로 처리하게 한다. 본 발명의 다른 실시예에 의하면, 전자장치는 타겟 생산자 뉴런에 주어진 클리핑 범위를 복수의 세그먼트들로 분할하고, 복수의 세그먼트들을 주어진 클리핑 범위와 같은 크기를 가지며 서로 겹치지 않는 세그먼트들로 변환 한다. 이는, 복수의 생산자 뉴런이 타겟 생산자 뉴런에 비해 더 넓은 클리핑 범위를 가지도록 한다. 예를 들어, 전자장치는 도 5a에서 제1 생산자 뉴런의 클리핑 범위를 [αp,1, βp,1]에서 [αp, βp]로 변환한다. 또한, 전자장 치는 제2 생산자 뉴런의 클리핑 범위를 [αp,2, βp,2]에서 [βp, βp+(βp-αp)]로 변환한다. 제1 생산자 뉴런은 타겟 생산자 뉴런과 같아진다. 대신, 제2 생산자 뉴런은 주어진 클리핑 범위를 벗어난 범위의 값을 처리할 수있다. 이는, 복수의 생산자 뉴런에 연결된 소비자 뉴런이 더 넓은 범위의 값을 가지는 액티베이션을 입력으로 처리하게 한다. 다시 도 4를 참조하면, 전자장치는 확장된 아키텍처를 가지는 신경망을 양자화할 수 있다. 양자화란 높은 정밀 도(precision)를 가지는 텐서들을 낮은 정밀도의 값으로 변환하는 것이다. 여기서, 텐서는 신경망의 가중치, 바 이어스 또는 액티베이션 중 적어도 하나를 의미한다. 양자화는 높은 정밀도의 텐서들을 낮은 정밀도의 값들로 변환함으로써, 신경망의 계산 복잡도를 감소시킬 수 있다. 이때, 본 발명의 일 실시예에 의하면, 복수의 세그먼트들 중 적어도 두 개는 서로 다른 크기를 갖는다. 이때, 전자장치가 신경망을 양자화하면, 양자화에 따른 비선형 양자화 효과가 발생한다. 구체적으로, 복수의 생산자 뉴런이 포함하는 파라미터들이 양자화되고, 복수의 생산자 뉴런의 출력 액티베이션 들도 양자화된다. 각 생산자 뉴런에 대응되는 세그먼트의 크기들이 서로 다른 경우, 복수의 생산자 뉴런의 출력 액티베이션들은 비선형적으로 양자화된다. 도 6a는 본 발명의 일 실시예에 따라 신경망의 확장된 아키텍처를 나타낸 도면이다. 도 6b는 복수의 생산자 뉴 런에 대응되는 클리핑 범위를 나타내는 도면이다. 신경망의 연산을 수행하는 전자장치는 각 생산자 뉴런의 클리핑 함수를 연산한다. 이때, 하드웨어의 제약으로 인해, 각 생산자 뉴런에 대응되는 세그먼트의 크기와 각 생산자 뉴런에서 계산될 수 있는 세그먼트의 크기가 다를 수 있다. 예를 들면, 하드웨어가 연산할 수 있는 클리핑 범위와 각 생산자 뉴런에 할당된 클리핑 범위가 다를 수 있다. 나아가, 동일한 레이어에 포함된 뉴런들은 서로 다른 클리핑 범위가 할당 됨에도, 하드웨어의 효율을 위해 클리핑 범위가 동일하게 설정될 필요가 있을 수 있다. 따라서, 각 생산자 뉴런에 대응되는 세그먼트의 크기와 범위를 조정할 필요가 있다. 도 5a를 참조하면, 각 생산자 뉴런은 모두 같은 파라미터들을 포함하고, 소비자 뉴런의 가중치들도 모두 동일하 다. 하지만, 복수의 생산자 뉴런은 서로 다른 세그먼트의 범위를 가진다. 반면, 도 6a를 참조하면, 각 생산자 뉴런은 독립적인 파라미터들을 포함하고, 소비자 뉴런의 가중치들도 독립적 인 값을 가진다. 대신, 복수의 생산자 뉴런은 동일한 세그먼트의 범위를 가질 수 있다. 이와 같이, 전자장치는 각 생산자 뉴런의 세그먼트가 서로 일치되도록 복수의 생산자 뉴런의 파라미터들을 설정 하고 소비자 뉴런의 파라미터들을 설정할 수 있다. 이는, 논리적으로 필요한 세그먼트의 범위와 전자장치가 물 리적으로 계산 가능한 세그먼트의 범위가 다른 경우에도, 전자장치가 주어진 연산을 계산 가능한 세그먼트의 범 위 내에서 수행하기 위한 것이다. 전자장치가 계산 불가능한 세그먼트가 존재하더라도, 파라미터들의 설정을 통 해 계산 가능한 세그먼트로 변환할 수 있다. 다만, 도 6a와 달리, 본 발명의 다른 실시예에 의하면, 각 생산자 뉴런은 독립적인 파라미터들을 포함하되, 복 수의 생산자 뉴런은 서로 다른 세그먼트의 범위를 가질 수 있다. 즉, 전자장치는 각 생산자 뉴런의 세그먼트 범 위를 독립적으로 결정하고, 결정된 세그먼트 범위에 따라 각 생산자 뉴런의 파라미터들을 설정할 수 있다. 이때, 전자장치는 각 세그먼트의 범위를 각 생산자 뉴런별로 조정할 수 있다. 또한, 전자장치는 소비자 뉴런의 가중치들도 각 생산자 뉴런별로 독립적으로 설정할 수 있다. 다시 도 6a를 참조하면, 전자장치는 복수의 세그먼트들을 동일한 크기를 갖도록 조정하고, 조정에 따라 신경망 의 파라미터들을 설정할 수 있다. 그렇지 않으면, 클리핑 범위로부터 분할된 복수의 세그먼트들은 각 생산자 뉴 런의 연산 범위를 고려하여 각 생산자 뉴런별로 조정될 수도 있다. 도 6b를 참조하면, 각 생산자 뉴런에 대응되는 클리핑 함수들이 도시되어 있다. 본 발명의 일 실시예에 의하면, 제1 클리핑 함수와 제2 클리핑 함수 모두 동일한 크기의 세그먼트를 클리핑 범위로 가진다. 이처럼, 주어진 클리핑 범위로부터 분할된 복수의 세그먼트들은 동일한 크기를 갖는 세그먼트로 조정될 수 있다. 각 생 산자 뉴런은 동일한 클리핑 범위에 따라 클리핑된 액티베이션을 출력한다. 복수의 생산자 뉴런의 파라미터들과 소비자 뉴런의 파라미터들은 적절하게 설정되어야 할 필요가 있다. 도 6a를 참조하면, 전자장치는 각 생산자 뉴런에 대응되는 세그먼트의 범위와 조정된 세그먼트의 범위에 기초하 여, 각 생산자 뉴런의 파라미터들을 설정할 수 있다. 구체적으로, 전자장치는 수학식 2 및 수학식 3을 이용하여 각 생산자 뉴런의 파라미터들을 설정할 수 있다.수학식 2"}
{"patent_id": "10-2021-0123351", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "수학식 3"}
{"patent_id": "10-2021-0123351", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "수학식 2에서, p는 생산자 뉴런, i는 각 생산자 뉴런의 인덱스, 는 각 생산자 뉴런에 대응되는 세그먼트의 범위의 최솟값, 는 생산자 뉴런에 대응되는 세그먼트의 범위의 최댓값, 는 조정된 세그먼트의 범위의 최 솟값, 는 조정된 세그먼트의 범위의 최댓값, 는 각 생산자 뉴런에 대응되는 세그먼트의 범위와 조정된 세그먼트의 범위 간 비율, 는 각 생산자 뉴런에 대응되는 세그먼트의 중심, 는 조정된 세그먼트의 중심을 나타낸다. 수학식 3에서, 는 각 생산자 뉴런의 가중치, 는 각 생산자 뉴런의 바이어스, 는 타겟 생산자 뉴런 의 가중치, 는 타겟 생산자 뉴런의 바이어스를 나타낸다. 한편, 전자장치는 각 생산자 뉴런에 대응되는 세그먼트의 범위와 조정된 세그먼트의 범위에 기초하여, 소비자 뉴런의 파라미터들을 설정할 수 있다. 구체적으로, 전자장치는 수학식 2 및 수학식 4를 이용하여 각 생산자 뉴 런의 파라미터들을 설정할 수 있다. 수학식 4"}
{"patent_id": "10-2021-0123351", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 5, "content": "수학식 4에서, 는 각 생산자 뉴런에 연결된 소비자 뉴런의 가중치, 는 타겟 생산자 뉴런에 연결된 소 비자 뉴런의 가중치, 는 각 생산자 뉴런에 연결된 소비자 뉴런의 바이어스, 타겟 생산자 뉴런에 연결된 소비자 뉴런의 바이어스, N은 복수의 생산자 뉴런의 수를 나타낸다. 전자장치는 수학식 2, 수학식 3 및 수학식 4를 이용하여 타겟 생산자 뉴런의 파라미터들을 조정함으로써 복수의 생산자 뉴런의 파라미터를 결정한다. 또한, 전자장치는 타겟 생산자 뉴런에 연결된 소비자 뉴런의 파라미터들을 조정함으로써 복수의 생산자 뉴런에 연결된 소비자 뉴런의 파라미터들을 결정한다. 전자장치는 수학식 2, 수학식 3 및 수학식 4를 이용하여 각 생산자 뉴런의 파라미터들과 소비자 뉴런의 파라미 터들을 설정함으로써, 각 생산자 뉴런의 클리핑 범위를 동일하게 만들 수 있다. 본 발명의 다른 실시예에 의하면, 전자장치는 수학식 2, 수학식 3 및 수학식 4를 이용하여 각 생산자 뉴런의 파 라미터들과 소비자 뉴런의 파라미터들을 설정함으로써, 각 생산자 뉴런의 클리핑 범위를 조절할 수 있다. 도 7은 본 발명의 일 실시예에 따라 신경망의 확장된 아키텍처를 나타낸 도면이다. 도 7을 참조하면, 생산자 뉴런은 타겟 생산자 뉴런의 파라미터들(wp, bp)을 유지한 채, 클리핑 함수만 분할된 것으로 도시되어 있다. 소비자 뉴런은 생산자 뉴런의 출력 액티베이션들(yp,1, yp,2, yp,N)에 오프셋들(αp, αp,1, α p,2, αp,N)을 적용하고, 적용 결과(yp)에 가중치(wc)와 바이어스(bc)를 적용함으로써 소비자 뉴런의 출력 액티베 이션(hc)을 출력할 수 있다. 도 7에 도시된 신경망 아키텍처에 의하면, 전자장치가 타겟 생산자 뉴런을 복수의 생산자 뉴런으로 분할하는 것 이 아니라 타겟 생산자 뉴런의 클리핑 기능을 분할한다. 또한, 전자장치는 소비자 뉴런이 복수의 클리핑 함수값 들을 입력 받고, 클리핑 함수값들에 오프셋들을 적용하도록 파라미터들을 설정한다. 타겟 생산자 뉴런의 클리핑 기능이 분할된 뉴런을 생산자 뉴런이라 지칭한다. 생산자 뉴런은 타겟 생산자 뉴런 의 입력(xp)과 동일한 입력을 입력 받고, 타겟 생산자 뉴런의 아핀 변환과 동일한 변환을 수행한다. 생산자 뉴런 은 아핀 변환 결과에 복수의 클리핑 함수를 적용한다. 복수의 클리핑 함수는 서로 다른 클리핑 범위를 가진다. 생산자 뉴런은 복수의 클리핑 결과를 출력 액티베이션들(yp,1, yp,2, yp,N)로 출력한다. 소비자 뉴런은 출력 액티베이션들(yp,1, yp,2, yp,N)를 수신하고, 각 출력 액티베이션에 오프셋들(αp, αp,1, αp,2, αp,N)을 적용한다. 또한, 소비자 뉴런은 글로벌 오프셋(αp)을 함께 적용한다. 소비자 뉴런은 적용 결과(yp)에 가중치(wc)와 바이어스(bc)를 적용함으로써 소비자 뉴런의 출력 액티베이션(hc)을 출력한다. 소비자 뉴런의 오프셋 적용 결과(yp)는 수학식 5와 같이 표현될 수 있다. 수학식 5"}
{"patent_id": "10-2021-0123351", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 6, "content": "수학식 5에서, i는 클리핑 함수의 인덱스, N은 분할된 클리핑 함수의 수를 의미한다. 는 소비자 뉴런의 오프 셋 적용 결과, 는 글로벌 오프셋, 은 각 클리핑 결과, 는 각 출력 액티베이션에 적용되는 오프셋 들을 나타낸다. 도 7에 도시된 신경망 아키텍처는, 하드웨어 레벨에서 생산자 뉴런의 클리핑 범위만 분할될 수 있고, 소비자 뉴 런이 생산자 뉴런의 출력 액티베이션들 각각에 오프셋을 적용할 수 있도록 구현되는 경우, 높은 효율을 가진다. 도 8a는 본 발명의 일 실시예에 따라 확장된 클리핑 범위를 가지도록 확장된 아키텍처를 나타내는 도면이다. 도 8a를 참조하면, 아키텍처가 확장되지 않은 기존 신경망, 아키텍처가 확장된 신경망 및 대체된 뉴 런의 클리핑 함수들이 도시되어 있다. 기존 신경망은 기존 신경망에 포함된 뉴런들로부터 출력되는 액티베이션들을 256 단계의 정밀도를 가 지도록 양자화될 수 있다. 기존 신경망이 양자화된 경우, 동일한 레이어에 포함된 뉴런들은 동일한 클리핑 범위에 따라 클리핑된 액티베이션을 출력하되, 클리핑된 액티베이션을 256 단계의 정밀도로 출력한다. 기존 신 경망에서 일부 레이어에 포함된 뉴런들은 [0, t1]를 클리핑 범위로 가지며, 다른 레이어에 포함된 뉴런들 은 [0, t2]를 클리핑 범위로 가진다. 하지만, 기존 신경망에서 일부 뉴런은 주어진 클리핑 범위보다 넓은 범위를 이용하여 액티베이션을 클리핑 함으로써, 신경망의 정확도를 향상시킬 수 있다. 즉, 기존 신경망의 성능 향상을 위해, 기존 신경망에서 왼쪽 하단의 타겟 생산자 뉴런은 [0, 2t1]를 클리핑 범위로 가지고, 클리핑 범위 내 액티베이션을 512 단 계로 계산할 것이 요구된다. 본 발명의 일 실시예에 의하면, 전자장치는 기존 신경망에 포함된 타겟 뉴런을 복수의 뉴런으로 대체함으 로써, 타겟 뉴런의 유효 정밀도를 향상시킬 수 있다. 확장된 신경망은 기존 신경망으로부터 타겟 생산자 뉴런이 두 개의 생산자 뉴런으로 대체된 신경망이 다. 확장된 신경망에서 왼쪽 하단에 복수의 생산자 뉴런이 도시되어 있다. 복수의 생산자 뉴런은 타겟 생산자 뉴런의 입력과 동일한 입력을 입력 받는다. 복수의 생산자 뉴런 중 제1 생산 자 뉴런은 [0, t1]의 클리핑 범위를 가지며, 제2 생산자 뉴런은 [t1, 2t1]의 클리핑 범위를 가진다. 다만, 복수 의 생산자 뉴런의 클리핑 함수가 하드웨어에 의해 동일한 범위 내에서 연산되는 경우, 복수의 생산자 뉴런에 대 응되는 클리핑 범위는 동일한 크기와 범위를 갖도록 조정될 수 있다. 각 생산자 뉴런의 클리핑 함수는 크기가 t1 인 클리핑 범위를 가진다. 대신, 각 생산자 뉴런은 서로 다른 파라미터들을 가진다. 예를 들어, 제1 생산자 뉴 런의 바이어스(b1b)는 제2 생산자 뉴런의 바이어스(b1b-t1)와 다르다. 소비자 뉴런들은 복수의 생산자 뉴런으로부터 출력 액티베이션들을 입력 받고, 처리한다. 소비자 뉴런의 관점에 서, 복수의 생산자 뉴런으로부터 출력 액티베이션을 입력 받는 것은 타겟 생산자 뉴런으로부터 [0, 2t1] 범위의 클리핑 범위에 따라 512 단계의 정밀도로 클리핑된 액티베이션을 수신하는 것과 같다. 따라서, 전자장치는 기존 신경망에서 클리핑 범위의 증가 또는 양자화 범위의 증가가 필요한 뉴런을 복수 의 뉴런으로 대체함으로써, 실질적으로 뉴런의 클리핑 범위 또는 양자화 범위를 증가시킬 수 있다. 도 8b는 본 발명의 일 실시예에 따라 높은 유효 정밀도를 가지도록 확장된 아키텍처를 나타내는 도면이다. 도 8b를 참조하면, 아키텍처가 확장되지 않은 기존 신경망, 아키텍처가 확장된 신경망 및 대체된 뉴 런의 클리핑 함수들이 도시되어 있다. 기존 신경망은 기존 신경망에 포함된 뉴런들로부터 출력되는 액티베이션들을 256 단계의 정밀도를 가 지도록 양자화될 수 있다. 기존 신경망이 양자화된 경우, 동일한 레이어에 포함된 뉴런들은 동일한 클리핑 범위에 따라 클리핑된 액티베이션을 출력하되, 클리핑된 액티베이션을 256 단계의 정밀도로 출력한다. 하지만, 기존 신경망에서 일부 뉴런은 주어진 정밀도보다 높은 정밀도를 가지는 액티베이션을 출력함으로 써, 신경망의 정확도를 향상시킬 수 있다. 즉, 기존 신경망의 성능 향상을 위해, 기존 신경망에서 왼 쪽 하단의 타겟 생산자 뉴런은 256 단계의 정밀도를 가지는 액티베이션을 출력하지만, 액티베이션을 512 단계의 정밀도로 계산할 것이 요구된다. 본 발명의 일 실시예에 의하면, 전자장치는 기존 신경망에 포함된 타겟 뉴런을 복수의 뉴런으로 대체함으 로써, 타겟 뉴런의 유효 정밀도를 향상시킬 수 있다. 확장된 신경망은 기존 신경망으로부터 타겟 생산자 뉴런이 두 개의 생산자 뉴런으로 대체된 신경망이 다. 확장된 신경망에서 왼쪽 하단에 복수의 생산자 뉴런이 도시되어 있다. 복수의 생산자 뉴런은 타겟 생산자 뉴런의 입력과 동일한 입력을 입력 받는다. 복수의 생산자 뉴런은 액티베이 션을 256 단계의 정밀도로 계산한다. 다만, 타겟 생산자 뉴런은 [0, t1]의 클리핑 범위 내에서 액티베이션을 256 단계의 정밀도로 계산한다. 반면, 복수의 생산자 뉴런 중 제1 생산자 뉴런은 [0, 0.5t1]의 클리핑 범위 내 에서 액티베이션을 256 단계의 정밀도로 계산하고, 제2 생산자 뉴런은 [0.5t1, t1]의 클리핑 범위 내에서 액티베 이션을 256 단계의 정밀도로 계산한다. 소비자 뉴런들은 복수의 생산자 뉴런으로부터 출력 액티베이션들을 입력 받고, 처리한다. 소비자 뉴런의 관점에 서, 복수의 생산자 뉴런으로부터 출력 액티베이션을 입력 받는 것은 타겟 생산자 뉴런으로부터 [0, t1] 범위의 클리핑 범위에 따라 512 단계의 정밀도로 클리핑된 액티베이션을 수신하는 것과 같다. 따라서, 전자장치는 기존 신경망에서 주어진 클리핑 범위 내에서 액티베이션의 정밀도 증가가 필요한 뉴런 을 복수의 뉴런으로 대체함으로써, 실질적으로 뉴런의 클리핑 범위 또는 양자화 범위를 증가시킬 수 있다. 도 9는 본 발명의 일 실시예에 따른 신경망의 아키텍처를 확장하는 방법의 순서도다. 도 9를 참조하면, 전자장치는 신경망에 포함된 뉴런들 중 타겟 생산자 뉴런을 선택한다(S900). 여기서, 신경망은 훈련이 완료된 신경망일 수 있다. 타겟 생산자 뉴런은 이전 레이어의 뉴런들로부터 입력을 입력 받는다. 타겟 생산자 뉴런은 입력을 아핀 변환하 고, 아핀 변환 결과를 주어진 클리핑 범위에 따라 클리핑한다. 타겟 생산자 뉴런은 클리핑된 액티베이션을 출력 한다. 전자장치는 주어진 클리핑 범위를 복수의 세그먼트들로 분할한다(S902). 복수의 세그먼트들 중 적어도 두 개는 서로 다른 크기를 가질 수 있다. 그렇지 않으면, 복수의 세그먼트들은 서 로 다른 경계값을 가지되, 같은 크기를 가질 수 있다. 전자장치는 타겟 생산자 뉴런을 세그먼트들에 대응되는 복수의 생산자 뉴런으로 대체한다(S904). 각 생산자 뉴런은 복수의 세그먼트들 중 대응되는 세그먼트의 범위에 따라 클리핑된 액티베이션을 출력한다. 본 발명의 일 실시예에 의하면, 복수의 생산자 뉴런에 의해 출력되는 복수의 출력 액티베이션은 타겟 생산자 뉴 런에 의해 출력되는 클리핑된 액티베이션과 동일한 정밀도(precision)를 가진다. 이를 통해, 복수의 생산자 뉴 런은 타겟 생산자 뉴런의 클리핑 범위와 동일한 범위 내에서 보다 높은 정밀도를 가지는 액티베이션을 나타낼 수 있다. 본 발명의 일 실시예에 의하면, 전자장치는 복수의 세그먼트들을 주어진 클리핑 범위와 같은 크기를 가지며, 서 로 겹치지 않는 세그먼트들로 변환할 수 있다. 이를 통해, 복수의 생산자 뉴런은 타겟 생산자 뉴런의 클리핑 범 위보다 넓은 범위에서 액티베이션을 나타낼 수 있다. 본 발명의 다른 실시예에 의하면, 전자장치는 각 세그먼트의 범위를 각 생산자 뉴런별로 조정 또는 변환할 수 있다. 구체적으로, 각 생산자 뉴런의 계산 가능한 연산 범위를 고려하여, 전자장치는 각 세그먼트의 범위를 조 정할 수 있다. 이때, 조정된 세그먼트들의 범위의 합은 주어진 클리핑 범위와 달라질 수 있고, 조정된 세그먼트 들의 범위에 대한 경계값은 일치하지 않을 수 있다. 예를 들어, 클리핑 범위를 제1 세그먼트와 제2 세그먼트로 분할하고, 제1 세그먼트의 범위와 제2 세그먼트의 범위를 각각 조정하는 경우, 제1 조정된 세그먼트 범위의 최 댓값과 제2 조정된 세그먼트 범위의 최솟값이 일치하지 않을 수 있다. 각 생산자 뉴런은 각 조정된 세그먼트의 범위에 따라 클리핑된 액티베이션을 출력한다. 이를 위해, 전자장치는 각 생산자 뉴런이 타겟 생산자 뉴런의 입력을 처리하도록 각 생산자 뉴런의 파라미터들 을 설정한다(S906). 전자장치는 타겟 생산자 뉴런에 연결된 소비자 뉴런이 복수의 생산자 뉴런의 출력들을 처리하도록, 소비자 뉴런 의 파라미터들을 설정한다(S908). 본 발명의 일 실시예에 의하면, 각 생산자 뉴런이 타겟 생산자 뉴런의 파라미터들과 동일한 파라미터들을 이용 하여 입력을 처리하도록, 각 생산자 뉴런의 파라미터들이 설정될 수 있다. 또한, 소비자 뉴런이 타겟 생산자의 출력에 적용되는 파라미터들과 동일한 파라미터들 및 복수의 세그먼트들에 따른 오프셋을 이용하여, 복수의 생 산자 뉴런의 출력들을 처리하도록, 소비자 뉴런의 파라미터들이 설정될 수 있다. 이를 통해, 복수의 생산자 뉴 런과 복수의 생산자 뉴런에 연결된 소비자 뉴런은, 타겟 생산자 뉴런과 타겟 생산자 뉴런에 연결된 소비자 뉴런 과 동일한 파라미터들을 가진다. 다만, 복수의 생산자 뉴런은 서로 다른 클리핑 범위를 가진다. 본 발명의 다른 실시예에 의하면, 전자장치는 각 생산자 뉴런의 계산 가능한 세그먼트 범위를 고려하여, 복수의 세그먼트들을 각 생산자 뉴런별로 조정할 수 있다. 전자장치는 각 생산자 뉴런에 대응되는 세그먼트의 범위와 조정된 세그먼트의 범위에 기초하여, 각 생산자 뉴런의 파라미터들을 설정한다. 또한, 전자장치는 각 생산자 뉴 런에 대응되는 세그먼트의 범위와 조정된 세그먼트의 범위에 기초하여, 각 생산자 뉴런의 출력에 적용되는 파라 미터들을 설정한다. 이를 통해, 복수의 생산자 뉴런과 복수의 생산자 뉴런에 연결된 소비자 뉴런은, 타겟 생산 자 뉴런과 타겟 생산자 뉴런에 연결된 소비자 뉴런과 다른 파라미터들을 가진다. 다만, 복수의 생산자 뉴런은 모두 동일한 클리핑 범위를 가진다. 도 10은 본 발명의 일 실시예에 따른 전자장치의 구성도다. 도 10을 참조하면, 전자장치는 시스템 메모리, 프로세서, 스토리지, 입출력 인터페이 스 및 통신 인터페이스 중 일부 또는 전부를 포함할 수 있다.시스템 메모리는 프로세서로 하여금 본 발명의 일 실시예에 따른 범위 결정 방법을 수행하도록 하 는 프로그램을 저장할 수 있다. 예를 들면, 프로그램은 프로세서에 의해서 실행 가능한(executable) 복수 의 명령어들을 포함할 수 있고, 복수의 명령어들이 프로세서에 의해서 실행됨으로써 신경망의 아키텍처가 확장될 수 있다. 시스템 메모리는 휘발성 메모리 및 비휘발성 메모리 중 적어도 하나를 포함할 수 있다. 휘발성 메모리는 SRAM(Static Random Access Memory) 또는 DRAM(Dynamic Random Access Memory) 등을 포함하고, 비휘발성 메모 리는 플래시 메모리(flash memory) 등을 포함한다. 프로세서는 적어도 하나의 명령어들을 실행할 수 있는 적어도 하나의 코어를 포함할 수 있다. 프로세서 는 시스템 메모리에 저장된 명령어들을 실행할 수 있다. 스토리지는 전자장치에 공급되는 전력이 차단되더라도 저장된 데이터를 유지한다. 예를 들면, 스토 리지는 EEPROM(Electrically Erasable Programmable Read-Only Memory), 플래시 메모리(flash memory), PRAM(Phase Change Random Access Memory), RRAM(Resistance Random Access Memory), NFGM(Nano Floating Gate Memory) 등과 같은 비휘발성 메모리를 포함할 수도 있고, 자기 테이프, 광학 디스크, 자기 디스크와 같은 저장 매체를 포함할 수도 있다. 일부 실시예들에서, 스토리지는 전자장치로부터 탈착 가능할 수도 있다. 본 발명의 일 실시예에 의하면, 스토리지는 신경망의 아키텍처를 확장하는 프로그램을 저장할 수 있다. 스토리지에 저장된 프로그램은 프로세서에 의해서 실행되기 이전에 시스템 메모리로 로딩될 수 있다. 스토리지는 프로그램 언어로 작성된 파일을 저장할 수 있고, 파일로부터 컴파일러 등에 의해서 생성된 프로그램은 시스템 메모리로 로딩될 수 있다. 스토리지는 프로세서에 의해서 처리될 데이터 및 프로세서에 의해서 처리된 데이터를 저장할 수 있다. 입출력 인터페이스는 키보드, 마우스 등과 같은 입력 장치를 포함할 수 있고, 디스플레이 장치, 프린터 등과 같은 출력 장치를 포함할 수 있다. 사용자는 입출력 인터페이스를 통해 프로세서에 의한 프로그램의 실행을 트리거할 수도 있다. 또한, 사용자는 입출력 인터페이스를 통해 목표 포화 비율을 설정할 수 있다. 통신 인터페이스는 외부 네트워크에 대한 액세스를 제공한다. 예를 들면, 전자장치는 통신 인터페 이스를 통해 다른 장치들과 통신할 수 있다. 한편, 전자장치는 데스크탑 컴퓨터, 서버, AI 가속기 등과 같은 고정형(stationary) 컴퓨팅 장치뿐만 아 니라, 랩탑 컴퓨터, 스마트 폰 등과 같은 휴대용(mobile) 컴퓨팅 장치일 수도 있다. 전자장치에 포함된 관측기와 제어기는 프로세서에 의해서 실행되는 복수의 명령어들의 집합으로서 프로시 저일 수 있고, 프로세서에 의해서 접근 가능한 메모리에 저장될 수 있다. 도 9에서는 과정 S900 내지 과정 S908을 순차적으로 실행하는 것으로 기재하고 있으나, 이는 본 발명의 일 실시 예의 기술 사상을 예시적으로 설명한 것에 불과한 것이다. 다시 말해, 본 발명의 일 실시예가 속하는 기술 분야 에서 통상의 지식을 가진 자라면 본 발명의 일 실시예의 본질적인 특성에서 벗어나지 않는 범위에서 도 9에 기 재된 순서를 변경하여 실행하거나 과정 S900 내지 과정 S908 중 하나 이상의 과정을 병렬적으로 실행하는 것으 로 다양하게 수정 및 변형하여 적용 가능할 것이므로, 도 9는 시계열적인 순서로 한정되는 것은 아니다. 한편, 도 9에 도시된 과정들은 컴퓨터로 읽을 수 있는 기록매체에 컴퓨터가 읽을 수 있는 코드로서 구현하는 것 이 가능하다. 컴퓨터가 읽을 수 있는 기록매체는 컴퓨터 시스템에 의하여 읽혀질 수 있는 데이터가 저장되는 모 든 종류의 기록장치를 포함한다. 즉, 이러한 컴퓨터가 읽을 수 있는 기록매체는 ROM, RAM, CD-ROM, 자기 테이 프, 플로피디스크, 광 데이터 저장장치 등의 비일시적인(non-transitory) 매체를 포함한다. 또한 컴퓨터가 읽을 수 있는 기록매체는 네트워크로 연결된 컴퓨터 시스템에 분산되어 분산방식으로 컴퓨터가 읽을 수 있는 코드가 저장되고 실행될 수 있다. 이상의 설명은 본 실시예의 기술 사상을 예시적으로 설명한 것에 불과한 것으로서, 본 실시예가 속하는 기술 분 야에서 통상의 지식을 가진 자라면 본 실시예의 본질적인 특성에서 벗어나지 않는 범위에서 다양한 수정 및 변 형이 가능할 것이다. 따라서, 본 실시예들은 본 실시예의 기술 사상을 한정하기 위한 것이 아니라 설명하기 위한 것이고, 이러한 실시예에 의하여 본 실시예의 기술 사상의 범위가 한정되는 것은 아니다. 본 실시예의 보호 범위는 아래의 청구범위에 의하여 해석되어야 하며, 그와 동등한 범위 내에 있는 모든 기술 사상은 본 실시예의 권리범위에 포함되는 것으로 해석되어야 할 것이다. 본 출원은 2021년도 정부(과학기술정보통신부)의 재원으로 정보통신기획평가원의 지원을 받아 수행된 연구임 (2020-0-01305, 2,000 TFLOPS급 서버 인공지능 딥러닝 프로세서 및 모듈 개발)."}
{"patent_id": "10-2021-0123351", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1a는 신경망의 연산 구조를 나타낸 도면이다. 도 1b는 클리핑 함수를 나타낸 도면이다. 도 2는 본 발명의 일 실시예에 따른 신경망의 아키텍처 확장을 나타내는 도면이다. 도 3은 본 발명의 일 실시예에 따른 타겟 생산자 뉴런 및 소비자 뉴런을 나타낸 도면이다. 도 4는 본 발명의 일 실시예에 따라 클리핑 범위의 분할을 나타낸 도면이다. 도 5a는 본 발명의 일 실시예에 따라 신경망의 확장된 아키텍처를 나타낸 도면이다. 도 5b는 복수의 생산자 뉴런에 대응되는 클리핑 범위를 나타내는 도면이다. 도 6a는 본 발명의 일 실시예에 따라 신경망의 확장된 아키텍처를 나타낸 도면이다. 도 6b는 복수의 생산자 뉴런에 대응되는 클리핑 범위를 나타내는 도면이다. 도 7은 본 발명의 일 실시예에 따라 신경망의 확장된 아키텍처를 나타낸 도면이다. 도 8a는 본 발명의 일 실시예에 따라 확장된 클리핑 범위를 가지도록 확장된 아키텍처를 나타내는 도면이다. 도 8b는 본 발명의 일 실시예에 따라 높은 유효 정밀도를 가지도록 확장된 아키텍처를 나타내는 도면이다. 도 9는 본 발명의 일 실시예에 따른 신경망의 아키텍처를 확장하는 방법의 순서도다. 도 10은 본 발명의 일 실시예에 따른 전자장치의 구성도다."}
