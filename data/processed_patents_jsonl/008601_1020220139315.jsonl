{"patent_id": "10-2022-0139315", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2024-0058517", "출원번호": "10-2022-0139315", "발명의 명칭": "플래시 이미지를 이용한 논-플래시 이미지의 품질 향상 장치 및 방법", "출원인": "광주과학기술원", "발명자": "문보창"}}
{"patent_id": "10-2022-0139315", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "플래시 이미지와 논-플래시 이미지의 이미지 쌍을 입력받아 학습되고 국부적인 플래시 이미지 패치와 논-플래시이미지 패치로부터 컨볼루셔널 커널(kc)과 합성 가중치(wci)를 출력하는 인공 신경망 모듈;상기 플래시 이미지 패치와 상기 컨볼루셔널 커널을 컨볼루션하여 일관된 플래시 이미지 패치를 생성하는 컨볼루션부; 및상기 합성 가중치(wci)를 이용하여 상기 논-플래시 이미지 패치와 상기 일관된 플래시 이미지 패치를 결합하여노이즈 제거된 이미지를 생성하는 결합 모듈을 포함하는,플래시 이미지를 이용한 논-플래시 이미지의 품질 향상 장치."}
{"patent_id": "10-2022-0139315", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 플래시 이미지 패치와 논-플래시 이미지 패치는 정렬된 이미지 쌍인,플래시 이미지를 이용한 논-플래시 이미지의 품질 향상 장치."}
{"patent_id": "10-2022-0139315", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1항에 있어서,상기 결합 모듈은 수학식 4의 추정 함수를 사용하여 참값 이미지의 픽셀 c의 색상값을 추정하는,플래시 이미지를 이용한 논-플래시 이미지의 품질 향상 장치.수학식 4여기서, Ic햇은 참값 이미지의 픽셀c 추정 색상값이고, ΩC는 픽셀c를 중심으로 한 영역 윈도우로서 픽셀c의 인접픽셀들의 집합이며, wci는 상기 합성 가중치이고, kc는 상기 컨볼루셔널 커널이고, kc*IF는 상기 컨볼루셔널부의 픽셀c에서 컨볼루셔널 커널(kc)과 플래시 이미지 패치 사이의 컨볼루션 결과로서 일관된 플래시 이미지 패치이고, (kc*IF)c는 (kc*IF)의 픽셀c 색상값이고, (kc*IF)i는 (kc*IF)의 픽셀i의 색상값이다."}
{"patent_id": "10-2022-0139315", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제1항에 있어서,픽셀당 컨볼루셔널 커널(kc)은 정규화되는,플래시 이미지를 이용한 논-플래시 이미지의 품질 향상 장치."}
{"patent_id": "10-2022-0139315", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제1항에 있어서,상기 인공 신경망 모듈은 플래시 이미지와 논-플래시 이미지의 이미지 쌍을 입력받아 학습 가능한 파라미터공개특허 10-2024-0058517-3-(θ)로 손실이 최소화되도록 훈련되는,플래시 이미지를 이용한 논-플래시 이미지의 품질 향상 장치."}
{"patent_id": "10-2022-0139315", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제5항에 있어서,상기 인공 신경망 모듈의 최적의 학습 파라미터(θ햇)는 수학식 5로 정의되는,플래시 이미지를 이용한 논-플래시 이미지의 품질 향상 장치.수학식 5여기서, n은 참값 이미지 I의 전체 픽셀의 수이고, Ic햇은 참값 이미지의 픽셀c 추정 색상값이고, Ic는 참값 이미지의 픽셀c 색상값이다."}
{"patent_id": "10-2022-0139315", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "플래시 이미지와 논-플래시 이미지의 이미지 쌍을 입력받아 학습된 인공 신경망 모듈에 국부적인 플래시 이미지패치와 논-플래시 이미지 패치를 적용하여 컨볼루셔널 커널(kc)과 합성 가중치(wci)를 출력하는 단계;컨볼루션부가 상기 플래시 이미지 패치와 상기 컨볼루셔널 커널을 컨볼루션하여 일관된 플래시 이미지 패치를생성하는 단계; 및결합 모듈이 상기 합성 가중치(wci)를 이용하여 상기 논-플래시 이미지 패치와 상기 일관된 플래시 이미지 패치를 추정 함수로 결합하여 노이즈 제거된 이미지를 생성하는 단계를 포함하는,플래시 이미지를 이용한 논-플래시 이미지의 품질 향상 방법."}
{"patent_id": "10-2022-0139315", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제7항에 있어서,상기 플래시 이미지 패치와 논-플래시 이미지 패치는 정렬된 이미지 쌍인,플래시 이미지를 이용한 논-플래시 이미지의 품질 향상 방법."}
{"patent_id": "10-2022-0139315", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제7항에 있어서,상기 추정 함수는 수학식 4로 정의되는,플래시 이미지를 이용한 논-플래시 이미지의 품질 향상 방법.수학식 4여기서, Ic햇은 참값 이미지의 픽셀c 추정 색상값이고, ΩC는 픽셀c를 중심으로 한 영역 윈도우로서 픽셀c의 인접픽셀들의 집합이며, wci는 상기 합성 가중치이고, kc는 상기 컨볼루셔널 커널이고, kc*IF는 상기 컨볼루셔널부의 픽셀c에서 컨볼루셔널 커널(kc)과 플래시 이미지 패치 사이의 컨볼루션 결과로서 일관된 플래시 이미지 패치공개특허 10-2024-0058517-4-이고, (kc*IF)c는 (kc*IF)의 픽셀c 색상값이고, (kc*IF)i는 (kc*IF)의 픽셀i의 색상값이다."}
{"patent_id": "10-2022-0139315", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제7항에 있어서,픽셀당 컨볼루셔널 커널(kc)은 정규화되는,플래시 이미지를 이용한 논-플래시 이미지의 품질 향상 방법."}
{"patent_id": "10-2022-0139315", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "제7항에 있어서,상기 인공 신경망 모듈은 플래시 이미지와 논-플래시 이미지의 이미지 쌍을 입력받아 학습 가능한 파라미터(θ)로 손실이 최소화되도록 훈련되는,플래시 이미지를 이용한 논-플래시 이미지의 품질 향상 방법."}
{"patent_id": "10-2022-0139315", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제11항에 있어서,상기 인공 신경망 모듈의 최적의 학습 파라미터(θ햇)는 수학식 5로 정의되는,플래시 이미지를 이용한 논-플래시 이미지의 품질 향상 방법.수학식 5여기서, n은 참값 이미지 I의 전체 픽셀의 수이고, Ic햇은 참값 이미지의 픽셀c 추정 색상값이고, Ic는 참값 이미지의 픽셀c 색상값이다."}
{"patent_id": "10-2022-0139315", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 플래시 이미지를 이용하여 논-플래시 이미지에 포함된 노이즈를 제거하여 논-플래시 이미지의 품질을 향상하는 장치 및 방법에 관한 것이다. 본 발명의 일 실시예에 따른 플래시 이미지를 이용한 논-플래시 이미지의 품질 향상 장치는, 플래시 이미지와 논 -플래시 이미지의 이미지 쌍을 입력받아 학습되고 국부적인 플래시 이미지 패치와 논-플래시 이미지 패치로부터 컨볼루셔널 커널(kc)과 합성 가중치(wci)를 출력하는 인공 신경망 모듈, 플래시 이미지 패치와 컨볼루셔널 커널을 컨볼루션하여 일관된 플래시 이미지 패치를 생성하는 컨볼루션부 및 합성 가중치(wci)를 이용하여 논-플래시 이미 지 패치와 일관된 플래시 이미지 패치를 결합하여 노이즈 제거된 이미지를 생성하는 결합 모듈을 포함한다."}
{"patent_id": "10-2022-0139315", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 이미지 품질 향상 장치 및 방법에 관한 것으로서, 보다 상세하게는 플래시 이미지를 이용하여 논-플 래시 이미지에 포함된 노이즈를 제거하여 논-플래시 이미지의 품질을 향상하는 장치 및 방법에 관한 것이다."}
{"patent_id": "10-2022-0139315", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "저조도(LOW-LIGHT) 조건에서 촬영된 이미지 즉, 카메라 플래시 없이 촬영한 이미지(이하, 논-플래시 이미지라 함)는 도 1의 (A)에 도시된 바와 같이 산만한 노이즈가 포함된다. 이러한 논-플래시 이미지에서 노이즈를 제거 하여 깨끗한 이미지로 복구하는 노이즈 제거는 중요한 컴퓨터 비전 문제이다. 한편, 카메라 플래시를 터트리고 촬영한 이미지(이하, 플래시 이미지라 함)는 도 1의 (B)에 도시된 바와 같이 노이즈가 많이 감소된 고주파수 디테일을 포함한다. 많은 연구에서 플래시 이미지를 이용하여 논-플래시 이미지 의 노이즈를 제거하는 방법이, 논-플래시 이미지만을 이용하여 노이즈를 제거하는 기존 방법들에 비해 깨끗한 이미지로 복원할 수 있음을 보여주고 있다. 논-플래시 이미지의 노이즈를 제거하여 참값 이미지(ground truth image)를 복원하는 심층 신경망 훈련이 최근 큰 주목을 받고 있으며, 특히 플래시 이미지와 논-플래시 이미지의 이미지 쌍을 융합하는데 심층 신경망이 널리 사용되고 있다. 백(Back) 연구진은 노이즈가 포함된 독립 이미지와 노이즈가 포함되지 않은 이상적인 상관 이미지를 결합하여 노이즈를 제거하는 심층 결합기(Deep Combiner)을 제안하였다(비특허문헌 1). 리(Li) 연구진은 플래시 이미지를이용하여 논-플래시 이미지를 복원하는 컨볼루션 신경망을 구축하였다(비특허문헌 2). 시아(Xia) 연구진은 두 입력 이미지 사이의 오정렬을 해결하면서 플래시/논-플래시 픽셀 색상을 강력하게 결합할 수 있도록 커널 예측 네트워크를 제안하였다(비특허문헌 3). 또한, 뎅(Deng)과 드래고티(Dragotti)는 서로 다른 소스 이미지를 융합 하기 위한 CU-Net(common and unique information splitting network)를 제안했으며 플래시와 논-플래시의 이 미지 쌍을 사용하여 뛰어난 노이즈 제거 결과를 보여주었다(비특허문헌 4). 한편, 플래시 이미지는 논-플래시 이미지에는 존재하지 않는 반사 하이라이트(specular highlights)와 하 드 섀도우(hard shadows)를 포함할 수 있으며, 반사 하이라이트와 하드 섀도우를 포함하는 비일관적인 플 래시 이미지(inconsistent flash image)는 참값(ground truth)과 다른 이미지 구조(예컨대, 에지)를 갖는다. 비특허문헌 1에 제시된 렌더링된 이미지 쌍을 융합하는 심층 신경망은 플래시 이미지의 비일관적인 반사 하이라 이트나 하드 섀도우 등을 고려하지 않기 때문에, 이러한 반사 하이라이트나 하드 섀도우로 의해 노이즈 제거에 한계가 있으며, 아티팩트(artifacts)(잔여 노이즈 또는 고스팅)를 생성하는 문제가 있다. 선행기술문헌 비특허문헌 (비특허문헌 0001) 문헌 1: Back, J.; Hua, B.-S.; Hachisuka, T.; and Moon, B. 2020. Deep Combiner for Independent and Correlated Pixel Estimates. ACM Trans. Graph., 39. (비특허문헌 0002) 문헌 2: Li et al, Y.; Huang, J.-B.; Narendra, A.; and Yang, M.-H. 2016. Deep Joint Image Filtering. In Eur. Conf. Comput. Vis., 154-169 (비특허문헌 0003) 문헌 3: Xia, Z.; Gharbi, M.; Perazzi, F.; Sunkavalli, K.; and Chakrabarti, A. 2021. Deep Denoising of Flash and No-Flash Pairs for Photography in Low-Light Environments. In IEEE Conf. Comput. Vis. Pattern Recog., 2063-2072. (비특허문헌 0004) 문헌 4: Deng, X.; and Dragotti, P. L. 2021. Deep Convolutional Neural Network for Multi-Modal Image Restoration and Fusion. IEEE Trans. Pattern Anal. Mach. Intell., 43: 3333-3348. (비특허문헌 0005) 문헌 5: Kostadin Dabov, V. K., Alessandro Foi; and Egiazarian, K. 2007. Image Denoising by Sparse 3-D Transform-Domain Collaborative Filtering. IEEE Trans. Image Process., 16: 2080-2095. (비특허문헌 0006) 문헌 6: Zhang, K.; Zuo, W.; and Zhang, L. 2018. FFDNet: Toward a Fast and Flexible Solution for CNN-Based Image Denoising. IEEE Trans. Image Process., 27: 4608-4622."}
{"patent_id": "10-2022-0139315", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명의 목적은 한 쌍의 플래시 이미지와 논-플래시 이미지의 최적 융합을 학습하여 논-플래시 이미지로부터 노이즈를 제거하고 참값 이미지를 추정할 수 있는 이미지 품질 향상 장치 및 방법을 제공하기 위한 것이다."}
{"patent_id": "10-2022-0139315", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명은 장치(시스템), 방법, 컴퓨터 판독 가능 매체에 저장된 컴퓨터 프로그램 또는 컴퓨터 프로그램이 저장 된 컴퓨터 판독 가능 매체를 포함한 다양한 방식으로 구현될 수 있다. 본 발명의 일 실시예에 따른 플래시 이미지를 이용한 논-플래시 이미지의 품질 향상 장치는, 플래시 이미지와 논-플래시 이미지의 이미지 쌍을 입력받아 학습되고 국부적인 플래시 이미지 패치와 논-플래시 이미지 패치로부 터 컨볼루셔널 커널(kc)과 합성 가중치(wci)를 출력하는 인공 신경망 모듈, 플래시 이미지 패치와 컨볼루셔널 커 널을 컨볼루션하여 일관된 플래시 이미지 패치를 생성하는 컨볼루션부 및 합성 가중치(wci)를 이용하여 논-플래 시 이미지 패치와 일관된 플래시 이미지 패치를 결합하여 노이즈 제거된 이미지를 생성하는 결합 모듈을 포함한 다.바람직하게는, 플래시 이미지 패치와 논-플래시 이미지 패치는 정렬된 이미지 쌍이다. 바람직하게는, 결합 모듈은 수학식 4의 추정 함수를 사용하여 참값 이미지의 픽셀 c의 색상값을 추정한다. 바람직하게는, 픽셀당 컨볼루셔널 커널(kc)은 정규화된다. 바람직하게는, 인공 신경망 모듈은 플래시 이미지와 논-플래시 이미지의 이미지 쌍을 입력받아 학습 가능한 파 라미터(θ)로 손실이 최소화되도록 훈련된다. 보다 바람직하게는, 인공 신경망 모듈의 최적의 학습 파라미터(θ햇)는 수학식 5로 정의된다. 본 발명의 일 실시예에 따른 플래시 이미지를 이용한 논-플래시 이미지의 품질 향상 방법은, 플래시 이미지와 논-플래시 이미지의 이미지 쌍을 입력받아 학습된 인공 신경망 모듈에 국부적인 플래시 이미지 패치와 논-플래 시 이미지 패치를 적용하여 컨볼루셔널 커널(kc)과 합성 가중치(wci)를 출력하는 단계, 컨볼루션부가 플래시 이 미지 패치와 컨볼루셔널 커널을 컨볼루션하여 일관된 플래시 이미지 패치를 생성하는 단계 및 결합 모듈이 합성 가중치(wci)를 이용하여 논-플래시 이미지 패치와 일관된 플래시 이미지 패치를 추정 함수로 결합하여 노이즈 제 거된 이미지를 생성하는 단계를 포함한다. 바람직하게는, 플래시 이미지 패치와 논-플래시 이미지 패치는 정렬된 이미지 쌍이다. 바람직하게는, 추정 함수는 수학식 4로 정의된다. 바람직하게는, 픽셀당 컨볼루셔널 커널(kc)은 정규화된다. 바람직하게는, 인공 신경망 모듈은 플래시 이미지와 논-플래시 이미지의 이미지 쌍을 입력받아 학습 가능한 파 라미터(θ)로 손실이 최소화되도록 훈련된다. 보다 바람직하게는, 인공 신경망 모듈의 최적의 학습 파라미터(θ햇)는 수학식 5로 정의된다."}
{"patent_id": "10-2022-0139315", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명에 따르면, 한 쌍의 플래시 이미지와 논-플래시 이미지의 최적 융합을 학습하여 논-플래시 이미지로부터 노이즈를 제거하고 아티팩트 생성을 최소화할 수 있다. 본 발명에 따르면, 픽셀당 컨볼루션 커널을 사용하여 플래시 이미지에서 일관적인 플래시 이미지 패치를 추론하 고, 일관적인 플래시 이미지 패치와 논-플래시 패치를 융합하여 참값 이미지(ground truth image)를 추정할 수 있다."}
{"patent_id": "10-2022-0139315", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 2, "content": "본 발명의 효과는 이상에서 언급한 효과로 제한되지 않으며, 언급되지 않은 다른 효과들은 청구범위의 기재로부"}
{"patent_id": "10-2022-0139315", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 3, "content": "터 본 발명이 속하는 기술분야에서 통상의 지식을 가진 자(\"통상의 기술자\"라 함)에게 명확하게 이해될 수 있을 것이다."}
{"patent_id": "10-2022-0139315", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하, 본 발명의 실시를 위한 구체적인 내용을 첨부된 도면을 참조하여 상세히 설명한다. 다만, 이하의 설명에 서는 본 발명의 요지를 불필요하게 흐릴 우려가 있는 경우, 널리 알려진 기능이나 구성에 관한 구체적 설명은 생략하기로 한다. 첨부된 도면에서, 동일하거나 대응하는 구성요소에는 동일한 참조부호가 부여되어 있다. 또한, 이하의 실시예들 의 설명에 있어서, 동일하거나 대응되는 구성요소를 중복하여 기술하는 것이 생략될 수 있다. 그러나, 구성요소 에 관한 기술이 생략되어도, 그러한 구성요소가 어떤 실시예에 포함되지 않는 것으로 의도되지는 않는다. 본 명세서에 개시된 실시예의 이점 및 특징, 그리고 그것들을 달성하는 방법은 첨부되는 도면과 함께 후술되어 있는 실시예들을 참조하면 명확해질 것이다. 그러나, 본 발명은 이하에서 개시되는 실시예들에 한정되는 것이 아니라 서로 다른 다양한 형태로 구현될 수 있으며, 단지 본 실시예들은 본 발명과 연관된 통상의 기술자에게 발명의 범주를 완전하게 알려주기 위해 제공되는 것일 뿐이다. 다른 정의가 없다면, 본 명세서에서 사용되는 모든 용어(기술 및 과학적 용어를 포함)는 본 발명이 속하는 기술 분야에서 통상의 지식을 가진 자에게 공통적으로 이해될 수 있는 의미로 사용될 수 있을 것이다. 또 일반적으로 사용되는 사전에 정의되어 있는 용어들은 명백하게 특별히 정의되어 있지 않은 한 이상적으로 또는 과도하게 해 석되지 않는다. 예를 들어, \"기술\"이라는 용어는 시스템, 방법, 컴퓨터 판독 가능 명령어, 모듈, 알고리즘, 하드웨어 로직 및/ 또는 상기 기술된 문맥에 의해 허용되고 문서 전체에 걸쳐 동작을 지칭할 수 있다. 본 명세서에서 사용되는 용어에 대해 간략히 설명하고, 개시된 실시예에 대해 구체적으로 설명하기로 한다. 본 명세서에서 사용되는 용어는 본 발명에서의 기능을 고려하면서 가능한 현재 널리 사용되는 일반적인 용어들을 선택하였으나, 이는 관련 분야에 종사하는 기술자의 의도, 판례 또는 새로운 기술의 출현 등에 따라 달라질 수 있다. 또한, 특정한 경우는 출원인이 임의로 선정한 용어도 있으며, 이 경우 해당되는 발명의 설명 부분에서 상 세히 그 의미를 기재할 것이다. 따라서, 본 발명에서 사용되는 용어는 단순한 용어의 명칭이 아닌, 그 용어가 가지는 의미와 본 발명의 전반에 걸친 내용을 토대로 정의되어야 한다. 본 명세서에서의 단수의 표현은 문맥상 명백하게 단수인 것으로 특정하지 않는 한, 복수의 표현을 포함한다. 또 한, 복수의 표현은 문맥상 명백하게 복수인 것으로 특정하지 않는 한, 단수의 표현을 포함한다. 명세서 전체에 서 어떤 부분이 어떤 구성요소를 포함한다고 할 때, 이는 특별히 반대되는 기재가 없는 한 다른 구성요소를 제 외하는 것이 아니라 다른 구성요소를 더 포함할 수 있음을 의미한다. 본 발명에서, '포함하다', '포함하는' 등의 용어는 특징들, 단계들, 동작들, 요소들 및/또는 구성요소들이 존재 하는 것을 나타낼 수 있으나, 이러한 용어가 하나 이상의 다른 기능들, 단계들, 동작들, 요소들, 구성요소들 및 /또는 이들의 조합이 추가되는 것을 배제하지는 않는다. 본 발명에서, 특정 구성요소가 임의의 다른 구성요소에 '결합', '조합', '연결', '연관' 되거나, '반응' 하는 것으로 언급된 경우, 특정 구성요소는 다른 구성요소에 직접 결합, 조합, 연결 및/또는 연관되거나, 반응할 수 있으나, 이에 한정되지 않는다. 예를 들어, 특정 구성요소와 다른 구성요소 사이에 하나 이상의 중간 구성요소 가 존재할 수 있다. 또한, 본 발명에서 \"및/또는\"은 열거된 하나 이상의 항목의 각각 또는 하나 이상의 항목의 적어도 일부의 조합을 포함할 수 있다. 본 발명에서, '제1', '제2' 등의 용어는 특정 구성요소를 다른 구성요소와 구별하기 위해 사용되는 것으로, 이 러한 용어에 의해 상술한 구성요소가 제한되진 않는다. 예를 들어, '제1' 구성 요소는 '제2' 구성 요소와 동일 하거나 유사한 형태의 요소를 지칭하기 위해 사용될 수 있다. 인공 지능(AI: Artificial Intelligence)은 인공적인 지능 또는 이를 만들 수 있는 방법론을 연구하는 분야를 의미하며, 머신 러닝(기계 학습, Machine Learning)은 인공 지능 분야에서 다루는 다양한 문제를 정의하고 그것 을 해결하는 방법론을 연구하는 분야를 의미한다. 머신 러닝은 어떠한 작업에 대하여 꾸준한 경험을 통해 그 작 업에 대한 성능을 높이는 알고리즘으로 정의하기도 한다. 인공 신경망(ANN: Artificial Neural Network)은 머신 러닝에서 사용되는 모델로써, 시냅스의 결합으로 네트워 크를 형성한 인공 뉴런(노드)들로 구성되는, 문제 해결 능력을 가지는 모델 전반을 의미할 수 있다. 인공 신경 망은 다른 레이어의 뉴런들 사이의 연결 패턴, 모델 내 학습 파라미터를 업데이트하는 학습 과정, 출력값을 생성하는 활성화 함수(Activation Function)에 의해 정의될 수 있다. 인공 신경망은 입력층(Input Layer), 출력층(Output Layer), 그리고 선택적으로 하나 이상의 은닉층(Hidden Layer)를 포함할 수 있다. 각 층은 하나 이상의 뉴런을 포함하고, 인공 신경망은 뉴런과 뉴런을 연결하는 시냅 스를 포함할 수 있다. 인공 신경망에서 각 뉴런은 시냅스를 통해 입력되는 입력 신호들, 각 층의 가중치, 편향 에 대한 활성 함수의 함숫값을 출력할 수 있다. 모델의 학습 파라미터는 학습을 통해 결정되는 파라미터를 의미하며, 시냅스 연결의 가중치와 뉴런의 편향 등이 포함된다. 그리고, 하이퍼 파라미터는 머신 러닝 알고리즘에서 학습 전에 설정되어야 하는 파라미터를 의미하며, 학습비율(Learning Rate), 반복 횟수, 미니 배치 크기, 초기화 함수 등이 포함된다. 인공 신경망의 학습의 목적은 손실 함수를 최소화하는 학습 파라미터를 결정하는 것으로 볼 수 있다. 손실 함수 는 인공 신경망의 학습 과정에서 최적의 학습 파라미터를 결정하기 위한 지표로 이용될 수 있다. 머신 러닝은 학습 방식에 따라 지도 학습(Supervised Learning), 비지도 학습(Unsupervised Learning), 강화학 습(Reinforcement Learning)으로 분류할 수 있다. 지도 학습은 학습 데이터에 대한 레이블(label)이 주어진 상태에서 인공 신경망을 학습시키는 방법을 의미하며, 레이블이란 학습 데이터가 인공 신경망에 입력되는 경우 인공 신경망이 추론해 내야 하는 정답(또는 결과 값)을 의미할 수 있다. 비지도 학습은 학습 데이터에 대한 레이블이 주어지지 않는 상태에서 인공 신경망을 학습시키 는 방법을 의미할 수 있다. 강화 학습은 어떤 환경 안에서 정의된 에이전트가 각 상태에서 누적 보상을 최대화 하는 행동 혹은 행동 순서를 선택하도록 학습시키는 학습 방법을 의미할 수 있다. 인공 신경망 중에서 복수의 은닉층을 포함하는 심층 신경망(DNN: Deep Neural Network)으로 구현되는 머신 러닝 을 딥 러닝(심층 학습, Deep Learning)이라 부르기도 하며, 딥 러닝은 머신 러닝의 일부이다. 이하에서, 머신 러닝은 딥 러닝을 포함하는 의미로 사용된다. 상기 인공지능은 인공 신경망 모듈에 의해서 수행될 수 있다. 본 발명은 비특허문헌 1에 제시된 심층 결합기를 변형하여 구현될 수 있다. 다만 비특허문헌 1에서는 동일한 조 명 조건에서 캡처된 두 이미지 쌍을 입력으로 하지만, 본 발명에서는 서로 다른 조명 조건(플래시/논-플래시)에 서 캡처된 두 이미지 쌍을 입력으로 한다. 플래시 이미지와 논-플래시 이미지의 이미지 쌍을 입력으로 하는 비 특허문헌 1에 제시된 심층 결합기에 대해 설명한다. 플래시 이미지(IF)의 픽셀 색상값은 참값 이미지(I)의 픽셀 색상값과 상관 관계에 있으며, 이를 수식으로 표현하 면 수학식 1과 같다. 수학식 1"}
{"patent_id": "10-2022-0139315", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "여기서, IF c는 플래시 이미지(IF)의 픽셀c 색상값이고, IF i는 플래시 이미지(IF)의 픽셀i 색상값이며, Ic는 참값 이미지(I)의 픽셀c 색상값이고, Ii는 참값 이미지(I)의 픽셀i 색상값이며, εci는 IF c-IF i 및 Ic-Ii의 차이에 따라 국부적으로 달라지는 오차항(error term)이다. 카메라 플래시는 일반적으로 이미지 전체의 밝기를 증가시키므로 플래시 이미지의 픽셀 색상값은 참값 이미지의 픽셀 색상값보다 밝을 수 있다. 하지만, 플래시 이미지와 참값 이미지의 전체적인 불일치는 색상값 자체 대신에 수학식 1과 같이 색상 차이를 모델링함으로써 오차항 εci에는 영향을 미치지 않는다. 비특허문헌 1에 제시된 이론적 모델을 기반으로 플래시 이미지로부터 논-플래시 이미지의 노이즈를 제거하여 참 값 이미지를 추정하는 수학적 모델은 수학식 2와 같다. 수학식 2 여기서, Ic햇은 참값 이미지의 픽셀c 추정 색상값이고, ΩC는 픽셀c를 중심으로 한 영역 윈도우(예컨대, 15×1 5)로서 픽셀c의 인접픽셀들의 집합이며, wci는 영역 윈도우(ΩC)에 포함되는 픽셀c의 인접픽셀인 픽셀i의 합성 가중치이고, IN i는 논-플래시 이미지(IN)의 픽셀i 색상값이고, IF c는 플래시 이미지(IF)의 픽셀c 색상값이고, IF i 는 플래시 이미지(IF)의 픽셀i 색상값이다. 수학식 2의 추정 함수에서, 참값 이미지의 픽셀c 추정 색상값(Ic햇)은 논-플래시 이미지의 인접픽셀들의 색상값 의 가중 평균값과 플래시 이미지의 인접픽셀과의 차이값들의 가중 평균값으로 추정할 수 있다. 따라서, 참값 이미지의 픽셀c 추정 색상값의 정확도를 높이기 위해, 픽셀c마다 합성 가중치 wci를 적절하게 결정 할 필요가 있으며, 비특허문헌 1에서는 합성 가중치 wci를 결정하기 위해 컨볼루션 신경망을 사용한다. 이러한 비특허문헌 1에서 제시된 두 이미지 쌍을 입력으로 노이즈를 제거하는 기술을 논-플래시 이미지와 플래 시 이미지에 바로 적용할 경우, 앞서 설명한 비일관적인 플래시 이미지에 의해 아티팩트(artifacts)(잔여 노이 즈 또는 고스팅)가 생성될 수 있다. 즉, 플래시 이미지는 논-플래시 이미지에는 존재하지 않는 하드 섀도우 및 반사 하이라이트가 존재하며, 이로 인해 참값 이미지와 이미지 구조(예컨대, 에지)가 동일하지 않다. 본 발명에서는 비일관적인 플래시 이미지를 국부적으로 참값 이미지와 유사한 일관된 플래시 이미지로 처리한 후 논-플래시 이미지와 융합하여, 이미지 품질을 향상하는 기술을 제안한다. 도 2는 본 발명의 일 실시예에 따른 플래시 이미지를 이용한 논-플래시 이미지의 품질 향상 장치를 보이는 도면 이다. 본 발명은 비일관적인 플래시 이미지의 국부적인 이미지 패치에 대해, 참값 이미지와 이미지 구조가 일치하는 일관된 플래시 이미지 패치를 추론한다. 이를 위해 플래시 이미지의 픽셀 색상값은 수학식 1에서 아래의 수학식 3과 같이 변형된다. 수학식 3"}
{"patent_id": "10-2022-0139315", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "여기서, kc*IF는 픽셀c에서, 크기가 K×K인 컨볼루셔널 커널(kc)과 플래시 이미지(IF) 사이의 컨볼루션 결과이고, (kc*IF)c는 (kc*IF)의 픽셀c 색상값이고, (kc*IF)i는 (kc*IF)의 픽셀i의 색상값이다. Ic는 참값 이미지 (I)의 픽셀c의 색상값이고, Ii는 참값 이미지(I)의 픽셀i의 색상값이며, εci는 (kc*IF)c - (kc*IF)i 및 Ic-Ii의 차 이에 따라 국부적으로 달라지는 오차항(error term)이다. 수학식 3에서 새롭게 정의된 일관된 플래시 이미지의 픽셀 색상값을 기반으로 참값 이미지를 추정하는 수학식 2 의 수학적 모델은 수학식 4와 같이 변형될 수 있다. 수학식 4"}
{"patent_id": "10-2022-0139315", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "여기서, Ic햇은 참값 이미지의 픽셀c 추정 색상값이고, ΩC는 픽셀c를 중심으로 한 영역 윈도우(예컨대, 15×1 5)로서 픽셀c의 인접픽셀들의 집합이며, wci는 영역 윈도우(ΩC)에 포함되는 픽셀c의 인접픽셀인 픽셀i의 합성 가중치이다. kc*IF는 픽셀c에서 컨볼루셔널 커널(kc)과 플래시 이미지(IF) 사이의 컨볼루션 결과로서 일관된 플래 시 이미지이고, (kc*IF)c는 (kc*IF)의 픽셀c 색상값이고, (kc*IF)i는 (kc*IF)의 픽셀i의 색상값이다. 수학식 4의 추정 함수에서, 참값 이미지의 픽셀c 추정 색상값(Ic햇)은 논-플래시 이미지의 인접픽셀들의 색상값 의 가중 평균값과 일관된 플래시 이미지의 인접픽셀과의 차이값들의 가중 평균값으로 추정할 수 있다. 여기서, 참값 이미지의 픽셀c 추정 색상값의 정확도를 높이기 위해, 픽셀c마다 합성 가중치 wci 및 일관된 플래 시 이미지를 생성하기 위한 컨볼루셔널 커널(kc)를 적절하게 결정할 필요가 있다. 도 2를 참조하여 본 발명에 따른 이미지 품질 향상 장치를 설명한다. 본 발명에 따른 이미지 품질 향상 장치는, 플래시 이미지에서 국부적인 플래시 이미지 패치(IF i)를 추출하는 플 래시 이미지 패치 추출부와, 논-플래시 이미지에서 국부적인 논-플래시 이미지 패치(IN i)를 추출하는 논-플 래시 이미지 패치 추출부와, 플래시 이미지와 논-플래시 이미지의 이미지 쌍을 학습하고 플래시 이미지 패 치(IF i)와 논-플래시 이미지 패치(IN i)로부터 컨볼루셔널 커널(kc)과 합성 가중치(wci)를 출력하는 인공 신경망 모 듈과, 플래시 이미지 패치(IF i)와 컨볼루셔널 커널(kc)을 컨볼루션하여 일관된 플래시 이미지 패치를 생성하는 컨볼루션부와, 합성 가중치(wci)를 이용하여 논-플래시 이미지 패치(IN i)와 일관된 플래시 이미지 패치를 결합하여 노이즈 제거된 이미지를 생성하는 결합 모듈을 포함한다. 플래시 이미지 패치 추출부는 플래시 이미지에서 국부적인 플래시 이미지 패치를 추출하고, 논-플래시 이 미지 패치 추출부는 논-플래시 이미지에서 국부적인 논-플래시 이미지 패치를 추출한다. 이미지 패치의 크 기는 64×64일 수 있으나, 이에 한정되지는 않는다. 인공 신경망 모듈은 플래시 이미지 패치와 논-플래시 패치의 이미지 쌍을 입력으로 하고, 픽셀당 컨볼루셔 널 커널(kc)과 합성 가중치(wci)를 생성하는 일반 컨볼루션 신경망을 활용하여 구현될 수 있다. 인공 신경망 모 듈은 9개의 컨볼루션 레이어로 구성될 수 있으며, 마지막 레이어는 K×K + |ΩC| 필터를 사용하여 각각 컨 볼루셔널 커널(kc)과 합성 가중치(wci)를 결정할 수 있다. 픽셀당 컨볼루셔널 커널(kc)은 정규화되어 요소의 합의 1이 되도록 할 수 있다. 각 컨볼루션 레이어는 ReLU(Rectified Linear Activation Function)을 사용할 수 있다. 여기서, 컨볼루셔널 커널의 크기(K×K)는 7×7일 수 있고, 영역 윈도우(ΩC)의 크기는 15×15일 수 있다. 인공 신경망 모듈은 플래시 이미지와 논-플래시 이미지의 이미지 쌍에 대한 합성 가중치 wci 및 컨볼루셔널 커널(kc)을 결정하기 위해, 학습 가능한 파라미터(θ)로 손실(참값 이미지의 추정 색상값과 참값 이미지의 색상 값의 차이값)이 최소화되도록 훈련될 수 있다. 컨볼루셔널 커널의 크기(K×K)가 7×7이고, 영역 윈도우(ΩC)의 크기가 15×15인 경우, 약184만개 파라미터가 도출될 수 있다. 인공 신경망 모듈의 최적의 학습 파라미터(θ햇)는 수학식 5로 정의될 수 있다. 수학식 5"}
{"patent_id": "10-2022-0139315", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 5, "content": "여기서, n은 참값 이미지 I의 전체 픽셀의 수이다. 컨볼루션부는 플래시 이미지 패치(IF i)와 컨볼루셔널 커널(kc)을 컨볼루션(kc*IF)하여 일관된 플래시 이미지 패치를 생성하고, 결합모듈은 합성 가중치(wci)를 이용하여 논-플래시 이미지 패치(IN i)와 일관된 플 래시 이미지 패치(kc*IF)를 결합하여 노이즈 제거된 이미지를 생성한다. 결합모듈에서 출력되는 노이즈 제거된 이미지의 픽셀c 추정 색상값은 수학식 4와 같다. 도 3은 본 발명의 일 실시예에 따른 플래시 이미지를 이용한 논-플래시 이미지의 품질 향상 방법을 나타내는 도 면이고, 도 4는 본 발명의 이미지 품질 향상 방법의 각 단계에서 얻어지는 이미지 결과 예시도이다.도 3 및 도 4를 참조하면서, 본 발명의 일실시예에 따른 이미지 품질 향상 방법을 설명한다. 도 4의 'A' 위치의 이미지 패치는 논-플래시 이미지와 플래시 이미지간 동일한 구조(에지 정보)를 포함할 때 본 발명의 컨벌루셔널 커널이 해당 구조(에지)를 블러 처리하여 구조(에지)를 훼손하지 않고 구조(에지)를 유지하 는 예시를 도시하고, 도 4의 'B' 위치의 이미지 패치는 반사 하이라이트가 본 발명에 의해 제거되는 예시를 도 시한다. 본 발명의 시스템에 논-플래시 이미지 및 플래시 이미지의 이미지 쌍이 입력될 수 있다(S301). 이 논 -플래시 이미지와 플래시 이미지는 정렬된 상태인 것이 바람직하다. 다음으로, 논-플래시 이미지 및 플래시 이미지에서, 동일한 위치 및 크기의 플래시 이미지 패치와 논 -플래시 이미지 패치의 이미지 쌍을 추출한다(S302). 도 4에는 두 위치('A', 'B')에서 각각 이미지 패치가 추출 된 예시를 도시한다. 도 4의 예시에서, 플래시 이미지의 'A' 위치의 이미지 패치와 논-플래시 이미지(40 1)의 'A' 위치의 이미지 패치는 유사한 에지 정보를 포함한다. 플래시 이미지의 'B' 위치의 이미지 패치에 는 논-플래시 이미지의 'B'위치의 이미지 패치에 없는 반사 하이라이트가 존재한다. 다음으로, 플래시 이미지 패치(411, 421)와 논-플래시 이미지 패치의 이미지 쌍을 인공 신경망 모듈에 적용하여 컨볼루셔널 커널(412, 422)과 합성 가중치(414, 424)를 결정한다(S303). 다음으로, 컨볼루셔널 커널과 플래시 이미지 패치를 컨볼루션하여 일관된 플래시 이미지 패치(413, 423)를 생성 한다(S304). 도 4를 참조하면, 플래시 이미지 패치(411, 421)에 비해 일관된 플래시 이미지 패치(413, 423)에는 'A' 위치의 경우 플래시 및 논-플래시에 존재하는 동일한 이미지 구조(에지)가 보존되고, 'B' 위치의 경우 플래 시 이미지에만 존재하는 반사 하이라이트가 제거되었음을 확인할 수 있다. 다음으로, 합성 가중치를 이용하여, 일관된 플래시 이미지 패치 및 논-플래시 이미지 패치를 결합하여 노이즈 제거된 이미지를 생성한다(S305). 본 발명에 따라 노이즈가 제거된 이미지는 논-플래시 이미지 대비 노이즈가 감소하였으며, 플래시 이미지와 논-플래시 이미지에 동일하게 존재하는 구조(에지)는 보존되고, 플래 시 이미지에 존재하였던 반사 하이라이트는 제거되었음을 확인할 수 있다. 도 5는 본 발명의 실시예에 따른 플래시 이미지를 이용한 논-플래시 이미지의 품질 향상 장치 및 방법의 효과를 나타내는 도면이다. 도 5의 (a)는 논-플래시 이미지 패치이고, (b)는 플래시 이미지 패치이고, (c)는 BM3D[Kostadin Dabov, V. K., Alessandro Foi; and Egiazarian, K. 2007.](비특허문헌 5)의 결과물이고, (d)는 FFDNet[Zhang, K.; Zuo, W.; and Zhang, L. 2018.](비특허문헌 6)의 결과물이고, (e)는 DJF[Li et al. 2016](비특허문헌 2)의 결과물이고, (f)는 CU-Net[Deng and Dragotti 2021](비특허문헌 4)의 결과물이고, (g) 는 DC[Back et al. 2020](비특허문헌 1)의 결과물이고, (h)는 본 발명의 결과물이다. 도 5를 참조하면, 본 발명의 실시예에 따른 이미지 품질 향상 장치 및 방법은 논-플래시 이미지의 노이즈를 보 다 깨끗하게 제거하며 아티팩트 생성이 최소화되는 결과를 나타낸다. 전술한 모든 방법 및 프로세스는 하나 이상의 범용 컴퓨터 또는 프로세서에 의해 실행되는 소프트웨어 코드 모 듈로 구현되고 완전 자동화될 수 있다. 코드 모듈은 임의의 유형의 컴퓨터 판독 가능 저장 매체 또는 다른 컴퓨 터 저장 장치에 저장될 수 있다. 일부 또는 모든 방법은 특수 컴퓨터 하드웨어로 구현될 수 있다. 본 명세서에 기술되고 및/또는 첨부 도면에 도시된 흐름도의 임의의 일상적인 설명, 요소 또는 블록은 특정 논 리 함수 또는 요소를 구현하기 위한 하나 이상의 실행 가능한 명령을 포함하는 코드, 모듈, 세그먼트 또는 부분 을 잠재적으로 나타내는 것으로 이해되어야 한다. 대안적인 예는 여기에 설명된 예의 범위 내에 포함되며, 여기 에서 이해될 수 있는 기능에 따라 실질적으로 동 기적으로 또는 역순으로 요소 또는 기능이 삭제되거나 도시되 거나 논의된 것으로부터 순서대로 실행될 수 있다. 상술된 실시예에 대해 많은 변형 및 수정이 이루어질 수 있으며, 그 요소는 다른 허용 가능한 예 중 하나인 것으로 이해되어야 한다. 이러한 모든 수정 및 변형은 본 개시의 범위 내에 포함되고 다음의 청구범위에 의해 보 호되도록 의도된다. 이상 설명된 본 발명에 따른 실시예들은 다양한 컴퓨터 구성요소를 통하여 수행될 수 있는 프로그램 명령어의 형태로 구현되어 컴퓨터 판독 가능한 기록 매체에 기록될 수 있다. 컴퓨터 판독 가능한 기록 매체는 프로그램 명령어, 데이터 파일, 데이터 구조 등을 단독으로 또는 조합하여 포함할 수 있다. 컴퓨터 판독 가능한 기록 매체에 기록되는 프로그램 명령어는 본 발명을 위하여 특별히 설계되고 구성된 것들이거나 컴퓨터소프트웨어 분야의 당업자에게 공지되어 사용 가능한 것일 수도 있다. 컴퓨터 판독 가능한 기록 매체의 예에는, 하드 디스크, 플로피 디스크 및 자기 테이프와 같은 자기 매체, CD-ROM, DVD와 같은 광기록 매체, 플롭티컬 디 스크(floptical disk)와 같은 자기-광 매체(magneto-optical media), 및 ROM, RAM, 플래시 메모리 등과 같은 프로그램 명령어를 저장하고 수행하도록 특별히 구성된 하드웨어 장치가 포함된다. 프로그램 명령어의 예에는, 컴파일러에 의해 만들어지는 것과 같은 기계어 코드뿐만 아니라 인터프리터 등을 사용해서 컴퓨터에 의해서 실 행될 수 있는 고급 언어 코드도 포함된다. 상기 하드웨어 장치는 본 발명에 따른 처리를 수행하기 위해 하나 이 상의 소프트웨어 모듈로서 작동하도록 구성될 수 있으며, 그 역도 마찬가지이다. 이상에서 본 발명이 구체적인 구성요소 등과 같은 특정 사항들과 한정된 실시예 및 도면에 의해 설명되었으나, 이는 본 발명의 보다 전반적인 이해를 돕기 위해서 제공된 것일 뿐, 본 발명이 상기 실시예들에 한정되는 것은"}
{"patent_id": "10-2022-0139315", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 6, "content": "아니며, 본 발명이 속하는 기술분야에서 통상적인 지식을 가진 자라면 이러한 기재로부터 다양한 수정 및 변형 을 꾀할 수 있다. 따라서, 본 발명의 사상은 상기 설명된 실시예에 한정되어서는 아니되며, 후술하는 특허청구범위 뿐만 아니라 이 특허청구범위와 균등하게 또는 등가적으로 변형된 모든 것들은 본 발명의 사상의 범주에 속한다고 할 것이다."}
{"patent_id": "10-2022-0139315", "section": "도면", "subsection": "도면설명", "item": 1, "content": "본 발명의 실시예들은, 이하 설명하는 첨부 도면들을 참조하여 설명될 것이며, 여기서 유사한 참조 번호는 유사 한 요소들을 나타내지만, 이에 한정되지는 않는다. 도 1은 동일 물체에 대한 논-플래시 이미지와 플래시 이미지의 예시도로서, (A)는 논-플래시 이미지이고, (B)는 플래시 이미지이다. 도 2는 본 발명의 일실시예에 따른 플래시 이미지를 이용한 논-플래시 이미지의 품질 향상 장치를 나타내는 도 면이다. 도 3은 본 발명의 일 실시예에 따른 플래시 이미지를 이용한 논-플래시 이미지의 품질 향상 방법을 나타내는 도 면이다. 도 4는 본 발명의 이미지 품질 향상 방법의 각 단계에서 얻어지는 이미지 결과 예시도이다. 도 5는 본 발명의 실시예에 따른 플래시 이미지를 이용한 논-플래시 이미지의 품질 향상 장치 및 방법의 효과를 나타내는 도면이다."}
