{"patent_id": "10-2023-0017726", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2024-0125109", "출원번호": "10-2023-0017726", "발명의 명칭": "인공 신경망 모델 기반 화재 조기 검출 장치 및 방법", "출원인": "옥수열", "발명자": "옥수열"}}
{"patent_id": "10-2023-0017726", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "화재 시 발생하는 화재 요소를 모델링한 파티클 집합체에 대응하는 화재 객체를 특정 실내 공간을 사전에 촬영한 깊이맵 영상을 배경으로 합성하여 라벨링 처리함에 따라 생성된 학습 데이터셋을 저장하는 학습 데이터셋 저장부;상기 학습 데이터셋에 기초한 합성곱 연산을 통해 이미지 내 객체의 특징 파라미터들을 획득함에 따라 해당 객체를 화재 요소에 대하여 기설정된 복수의 클래스 중 하나로 분류하도록 구성된 학습 모델을 훈련하는 학습 모델 훈련부;상기 실내 공간을 촬영한 현재 시점의 영상 이미지를 평가대상 이미지로 하여 기저장된 상기 학습 데이터셋에대응되도록 전처리한 전처리 이미지를 생성하는 이미지 전처리부;상기 전처리 이미지를 상기 학습 모델의 입력 데이터로 적용하여 상기 평가대상 이미지에 포함된 객체를 상기복수의 클래스 중 하나로 분류하는 확률값을 산출하는 클래스 분류부;불꽃 또는 연기 클래스로 분류된 적어도 하나 이상의 객체에 대응하여 산출된 확률값이 기설정된 기준값 이상인경우, 각각의 상기 객체의 객체 영역을 둘러싸는 검출 영역을 일정 시간 동안 추적한 객체 추적 영상을 획득하는 객체 추적부; 및상기 객체 추적 영상에 기초하여 실제 불꽃 또는 연기에 대응하는 화재 속성의 존재 여부를 판별한 결과에 따라화재 발생 여부를 판단하는 화재 판단 모듈;을 포함하는 것을 특징으로 하는 인공 신경망 모델 기반 화재 조기검출 장치."}
{"patent_id": "10-2023-0017726", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 화재 판단 모듈은,상기 객체 추적 영상 내 객체가 지속적으로 존재하는지 여부와 해당 객체의 움직임 특성에 따른 길이 및 각도의변동 정도를 판별한 결과에 기초하여, 상기 실내 공간에 대한 화재 발생 여부를 실시간으로 판단하는 것을 특징으로 하는 인공 신경망 모델 기반 화재 조기 검출 장치."}
{"patent_id": "10-2023-0017726", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제2항에 있어서,상기 화재 판단 모듈은,상기 객체 추적 영상 내 포함된 소정 객체를 검출하여 상기 객체에 대한 추적이 기설정된 라이프 타임 동안 지속적으로 유지되는지에 따라 해당 객체의 지속성 여부를 판별하는 객체 지속성 판별부;를 포함하는 것을 특징으로 하는 인공 신경망 모델 기반 화재 조기 검출 장치."}
{"patent_id": "10-2023-0017726", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제3항에 있어서,상기 화재 판단 모듈은,상기 지속성이 있다고 판별되는 경우, 상기 객체의 객체 영역에 대한 경계박스를 생성한 후 상기 경계박스의 대각선 길이와 중심점부터 대각선 꼭지점까지의 벡터에 대한 시간당 변화율에 기초하여 해당 객체의 플리커링 여부를 판별하는 객체 플리커링 판별부;를 포함하는 것을 특징으로 하는 인공 신경망 모델 기반 화재 조기 검출장치.공개특허 10-2024-0125109-3-청구항 5 제1항에 있어서,화재가 발생한 것으로 판단되는 경우, 상기 객체 추적 영상의 특정 프레임상에서 상기 검출 영역의 위치 및 크기를 강조 표시하되, 상기 검출 영역 내 객체에 대응하여 산출된 상기 확률값과 상기 평가대상 이미지를 촬영한카메라의 위치 데이터 중 적어도 하나를 해당 검출 영역의 경계 주변에 표시하는 알림 메시지를 생성하여 출력하는 화재 검출 알림부;를 더 포함하는 것을 특징으로 하는 인공 신경망 모델 기반 화재 조기 검출 장치."}
{"patent_id": "10-2023-0017726", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "화재 시 발생하는 화재 요소를 모델링한 파티클 집합체에 대응하는 화재 객체를 특정 실내 공간을 사전에 촬영한 깊이맵 영상을 배경으로 합성하여 라벨링 처리함에 따라 생성된 학습 데이터셋을 저장하는 단계;상기 학습 데이터셋에 기초한 합성곱 연산을 통해 이미지 내 객체의 특징 파라미터들을 획득함에 따라 해당 객체를 화재 요소에 대하여 기설정된 복수의 클래스 중 하나로 분류하도록 구성된 학습 모델을 훈련하는 단계;상기 실내 공간을 촬영한 현재 시점의 영상 이미지를 평가대상 이미지로 하여 기저장된 상기 학습 데이터셋에대응되도록 전처리한 전처리 이미지를 생성하는 단계;상기 전처리 이미지를 상기 학습 모델의 입력 데이터로 적용하여 상기 평가대상 이미지에 포함된 객체를 상기복수의 클래스 중 하나로 분류하는 확률값을 산출하는 단계;불꽃 또는 연기 클래스로 분류된 적어도 하나 이상의 객체에 대응하여 산출된 확률값이 기설정된 기준값 이상인경우, 각각의 상기 객체의 객체 영역을 둘러싸는 검출 영역을 일정 시간 동안 추적한 객체 추적 영상을 획득하는 단계; 및상기 객체 추적 영상에 기초하여 실제 불꽃 또는 연기에 대응하는 화재 속성의 존재 여부를 판별한 결과에 따라화재 발생 여부를 판단하는 단계;를 포함하는 것을 특징으로 하는 인공 신경망 모델 기반 화재 조기 검출 방법."}
{"patent_id": "10-2023-0017726", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제6항에 있어서,상기 화재 발생 여부를 판단하는 단계는,상기 객체 추적 영상 내 객체가 지속적으로 존재하는지 여부와 해당 객체의 움직임 특성에 따른 길이 및 각도의변동 정도를 판별한 결과에 기초하여, 상기 실내 공간에 대한 화재 발생 여부를 실시간으로 판단하는 것을 특징으로 하는 인공 신경망 모델 기반 화재 조기 검출 방법."}
{"patent_id": "10-2023-0017726", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제7항에 있어서,상기 화재 발생 여부를 판단하는 단계는,상기 객체 추적 영상 내 포함된 소정 객체를 검출하여 상기 객체에 대한 추적이 기설정된 라이프 타임 동안 지속적으로 유지되는지에 따라 해당 객체의 지속성 여부를 판별하는 단계;를 포함하는 것을 특징으로 하는 인공신경망 모델 기반 화재 조기 검출 방법."}
{"patent_id": "10-2023-0017726", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제8항에 있어서,상기 화재 발생 여부를 판단하는 단계는,상기 지속성 여부를 판별하는 단계 이후에 상기 지속성이 있다고 판별되는 경우, 상기 객체의 객체 영역에 대한경계박스를 생성한 후 상기 경계박스의 대각선 길이와 중심점부터 대각선 꼭지점까지의 벡터에 대한 시간당 변화율에 기초하여 해당 객체의 플리커링 여부를 판별하는 단계;를 포함하는 것을 특징으로 하는 인공 신경망 모델 기반 화재 조기 검출 방법.공개특허 10-2024-0125109-4-청구항 10 제6항에 있어서,화재가 발생한 것으로 판단되는 경우, 상기 객체 추적 영상의 특정 프레임상에서 상기 검출 영역의 위치 및 크기를 강조 표시하되, 상기 검출 영역 내 객체에 대응하여 산출된 상기 확률값과 상기 평가대상 이미지를 촬영한카메라의 위치 데이터 중 적어도 하나를 해당 검출 영역의 경계 주변에 표시하는 알림 메시지를 생성하여 출력하는 단계;를 더 포함하는 것을 특징으로 하는 인공 신경망 모델 기반 화재 조기 검출 방법."}
{"patent_id": "10-2023-0017726", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 인공 신경망 모델 기반 화재 조기 검출 장치 및 방법에 관한 것으로서, 화재 시 발생하는 화재 요소를 모델링한 파티클 집합체에 대응하는 화재 객체를 특정 실내 공간을 사전에 촬영한 깊이맵 영상을 배경으로 합성 하여 라벨링 처리함에 따라 생성된 학습 데이터셋을 저장하는 학습 데이터셋 저장부와, 상기 학습 데이터셋에 기 (뒷면에 계속)"}
{"patent_id": "10-2023-0017726", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 건물 실내 CCTV 영상과 다양한 화재 상황을 모델링한 이미지를 합성하여 생성한 화재 검출 훈련용 이 미지 데이터를 인공 신경망 모델에 적용하여 화재 발생 여부를 실시간으로 검출하는 인공 신경망 모델 기반 화 재 조기 검출 장치 및 방법에 관한 것이다."}
{"patent_id": "10-2023-0017726", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "화재는 특성상 발생하면 대형화재로 확대되어 심각한 인명 및 재산 피해를 유발할 가능성이 높다는 점에서 중요 한 도시 문제로 떠오르고 있다. 특히, 화재는 초기 대응이 매우 중요한데 초기 대응을 위해선 무엇보다 화재를 미리 감지하는 것이 우선적으로 요구된다. 이러한 화재 상황을 미리 감지하는 방법으로는 화재 발생 시 필수적으로 수반되는 연기, 열, 적외선 또는 자외 선 영역의 복사에너지를 각종 센서들을 이용해 검출하는 방식이 주로 이용되어 왔다. 그러나, 센서는 검출 원리에 따라 검출하기 적합한 감시 환경이 다른 특성을 가지기 때문에 감시 환경의 유형에 따라 적절한 센서 장비를 설치하는 경우에만 충분한 검출 성능을 발휘할 수 있고, 다양한 감시 환경에서 용장성 이 높은 동시에 초기 검출이 가능한 화재 센서의 실현은 현재 방재 분야에서 아직까지 해결하지 못한 과제로 남 아있다. 한편, 영상 기반의 화재 감지는 전술한 센서 기반의 화재 감지에서 발생하는 여러 문제점들을 해결할 수 있고, 별도의 센서 장비 없이도 기존에 설치된 CCTV를 이용할 수 있어 설치 비용을 최소화할 수 있으며, 경보에 따른 출동 전에 현장의 화재 상태를 미리 확인함으로써 오인 출동의 비율을 줄일 수 있는 장점이 있다. 그러나, 종래의 영상 기반 화재 감지 방법은 단순히 경험적 또는 실험적으로 획득한 임계치를 설정해두고 이를 기준으로 화재 여부를 감지하는 방식에 해당하여 실제 상황에 적용하기 어렵고, 화염과 유사한 개체에 대해 오 경보를 발생시킬 수 있다. 게다가, 이미지 기반의 심층학습과 같은 방법을 사용하여 정확도를 높이기 위해서는 많은 학습데이터를 필요로 하는데 실제 화재 영상만으로는 다양한 환경에 대한 데이터를 확보할 수 없기 때문에 실질적으로 이미지 학습 기반의 화재 검출을 수행하기가 어려운 실정이다. 선행기술문헌 특허문헌 (특허문헌 0001) KR 10-0918436 B1 (특허문헌 0002) KR 10-1932543 B1"}
{"patent_id": "10-2023-0017726", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명의 목적은 상기 문제점을 해결하기 위한 것으로서, 건물 실내 CCTV 영상과 다양한 화재 상황을 모델링한 이미지를 합성하여 생성한 화재 검출 훈련용 이미지 데이터를 인공 신경망 모델에 적용하여 화재 발생 여부를실시간으로 검출하는 인공 신경망 모델 기반 화재 조기 검출 장치 및 방법을 제공하는 것을 목적으로 한다."}
{"patent_id": "10-2023-0017726", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "상기와 같은 목적을 달성하기 위한 본 발명의 일면에 따른 인공 신경망 모델 기반 화재 조기 검출 장치는, 화재 시 발생하는 화재 요소를 모델링한 파티클 집합체에 대응하는 화재 객체를 특정 실내 공간을 사전에 촬영한 깊 이맵 영상을 배경으로 합성하여 라벨링 처리함에 따라 생성된 학습 데이터셋을 저장하는 학습 데이터셋 저장부 와, 상기 학습 데이터셋에 기초한 합성곱 연산을 통해 이미지 내 객체의 특징 파라미터들을 획득함에 따라 해당 객체를 화재 요소에 대하여 기설정된 복수의 클래스 중 하나로 분류하도록 구성된 학습 모델을 훈련하는 학습 모델 훈련부와, 상기 실내 공간을 촬영한 현재 시점의 영상 이미지를 평가대상 이미지로 하여 기저장된 상기 학 습 데이터셋에 대응되도록 전처리한 전처리 이미지를 생성하는 이미지 전처리부와, 상기 전처리 이미지를 상기 학습 모델의 입력 데이터로 적용하여 상기 평가대상 이미지에 포함된 객체를 상기 복수의 클래스 중 하나로 분 류하는 확률값을 산출하는 클래스 분류부와, 불꽃 또는 연기 클래스로 분류된 적어도 하나 이상의 객체에 대응 하여 산출된 확률값이 기설정된 기준값 이상인 경우, 각각의 상기 객체의 객체 영역을 둘러싸는 검출 영역을 일 정 시간 동안 추적한 객체 추적 영상을 획득하는 객체 추적부와, 상기 객체 추적 영상에 기초하여 실제 불꽃 또 는 연기에 대응하는 화재 속성의 존재 여부를 판별한 결과에 따라 화재 발생 여부를 판단하는 화재 판단 모듈을 포함하는 것을 특징으로 한다. 또한, 상기와 같은 목적을 달성하기 위한 본 발명의 다른 일면에 따른 인공 신경망 모델 기반 화재 조기 검출 방법은, 화재 시 발생하는 화재 요소를 모델링한 파티클 집합체에 대응하는 화재 객체를 특정 실내 공간을 사전 에 촬영한 깊이맵 영상을 배경으로 합성하여 라벨링 처리함에 따라 생성된 학습 데이터셋을 저장하는 단계와, 상기 학습 데이터셋에 기초한 합성곱 연산을 통해 이미지 내 객체의 특징 파라미터들을 획득함에 따라 해당 객 체를 화재 요소에 대하여 기설정된 복수의 클래스 중 하나로 분류하도록 구성된 학습 모델을 훈련하는 단계와, 상기 실내 공간을 촬영한 현재 시점의 영상 이미지를 평가대상 이미지로 하여 기저장된 상기 학습 데이터셋에 대응되도록 전처리한 전처리 이미지를 생성하는 단계와, 상기 전처리 이미지를 상기 학습 모델의 입력 데이터로 적용하여 상기 평가대상 이미지에 포함된 객체를 상기 복수의 클래스 중 하나로 분류하는 확률값을 산출하는 단 계와, 불꽃 또는 연기 클래스로 분류된 적어도 하나 이상의 객체에 대응하여 산출된 확률값이 기설정된 기준값 이상인 경우, 각각의 상기 객체의 객체 영역을 둘러싸는 검출 영역을 일정 시간 동안 추적한 객체 추적 영상을 획득하는 단계와, 상기 객체 추적 영상에 기초하여 실제 불꽃 또는 연기에 대응하는 화재 속성의 존재 여부를 판별한 결과에 따라 화재 발생 여부를 판단하는 단계를 포함하는 것을 특징으로 한다."}
{"patent_id": "10-2023-0017726", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명에 따르면, 시나리오 기반의 다양한 환경에서의 학습 데이터를 다량으로 생성할 수 있어 종래의 학습 데 이터 부족에 따른 화재 조기 검출 능력의 한계를 극복하고 매우 높은 수준의 검출률을 얻을 수 있는 효과가 있 다. 또한, 본 발명에 따르면, 새로운 형태의 비전 기반의 화재 검출 인공 지능 시스템을 구축할 수 있는 효과가 있 다."}
{"patent_id": "10-2023-0017726", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이상과 같은 본 발명에 대한 해결하려는 과제, 과제의 해결수단, 발명의 효과를 포함한 구체적인 사항들은 다음 에 기재할 실시예 및 도면에 포함되어 있다. 본 발명의 이점 및 특징, 그리고 그것을 달성하는 방법은 첨부되는 도면과 함께 상세하게 후술되어 있는 실시예를 참조하면 명확해질 것이다. 명세서 전체에 걸쳐 동일 참조 부호 는 동일 구성 요소를 지칭한다. 도 1은 본 발명의 일 실시예에 따른 인공 신경망 모델 기반 화재 조기 검출 장치의 구성을 나타낸 블록도이고, 도 2는 도 1의 학습 데이터셋 저장부에서 저장하는 학습 데이터셋의 생성 과정을 수행하는 구성들을 도시한 블 록도이고, 도 3은 도 2의 합성 이미지 생성부에 의해 파티클 합성 이미지를 생성하는 과정을 설명하기 위한 도 면이고, 도 4는 도 2의 합성 이미지 생성부에 의해 파티클 이미지와 합성되는 일부 RGB 이미지를 투명 처리하는 과정을 설명하기 위한 도면이고, 도 5는 도 2의 경계상자 생성부 및 경계상자 변환부에 의해 3D 경계상자 및 이 에 기초한 2D 경계영역이 생성되는 과정을 설명하기 위한 도면이고, 도 6은 도 1의 클래스 분류부의 분류 결과 에 따른 객체별 클래스 정보와 분류 성능 평가 결과의 일례를 나타낸 도면이고, 도 7은 도 1의 객체 지속성 판 별부에 의한 지속성 판별 동작을 설명하기 위한 도면이고, 도 8은 도 1의 객체 플리커링 판별부에 의해 생성되 는 제1 및 제2 경계박스, 제1 및 제2 대각선, 제1 내지 제4 벡터를 설명하기 위한 도면이고, 도 9는 도 1의 객 체 플리커링 판별부에 의한 플리커링 판별 조건을 설명하기 위한 도면이고, 도 10은 도 1의 화재 판단 모듈에 의한 판단 명령 알고리즘을 코딩한 소스 코드와 평가대상 이미지상에 검출영역 및 이에 대응되는 알림 메시지를 표시하는 일례를 나타낸 도면이고, 도 11은 본 발명의 일 실시예에 따른 인공 신경망 모델 기반 화재 조기 검출 방법을 나타낸 순서도이다. 이하, 전술한 도면들을 참조하여 본 발명의 바람직한 실시예에 따른 인공 신경망 모델 기반 화재 조기 검출 장 치 및 방법에 대해 설명하면 다음과 같다. 도 1을 참조하면, 본 발명에 따른 인공 신경망 모델 기반 화재 조기 검출 장치는 크게 학습 데이터셋 저장부 , 학습 모델 훈련부, 이미지 획득부, 이미지 전처리부, 클래스 분류부, 객체 추적부 , 화재 판단 모듈 및 화재 검출 알림부를 포함하여 구성된다. 학습 데이터셋 저장부는 화재 관련 객체에 대한 딥러닝 기반 이미지 분류 학습을 수행하기 위한 학습 데이 터셋(DS)을 저장한다. 학습 데이터셋 저장부는 화재 시 발생하는 화재 요소, 예컨대, 불꽃 또는 연기 등을 모델링한 파티클 집합 체(Pa)에 대응하는 화재 객체를 특정 실내 공간을 사전에 촬영한 깊이맵 영상(MD)을 배경으로 합성하여 라벨링 처리함에 따라 생성된 학습 데이터셋(DS)을 저장할 수 있다. 이때, 학습 데이터셋(DS)은 도 2에 도시된 학습 데이터 생성 모듈에 의해 생성된 것일 수 있으며, 구체적으 로, 학습 데이터 생성 모듈은 깊이맵 영상 획득부, 깊이 분할 영상 생성부, 파티클 이미지 생성 모 듈, 저장부, 경계상자 생성부, 경계상자 변환부, RGB 이미지 추출부, 합성 이미지 생성부 , 라벨링 처리부 및 제어부로 구성될 수 있다. 깊이맵 영상 획득부는 실내 공간에 대한 RGB 정보를 포함하는 3D 깊이맵 영상(MD)을 획득하기 위한 것이다. 깊이맵 영상 획득부는 실내 공간의 서로 다른 지점을 향하여 배치된 복수의 카메라(Cam1,Cam2,…,CamN, N 은 카메라 수)를 통해 해당 지점을 기준으로 촬영된 공간 영역에 대한 RGB 색상 정보 및 깊이 정보를 포함하는3D 깊이맵 영상(MD)을 획득할 수 있다. 여기서, 상기 카메라는 RGB 센서와 깊이 센서를 포함하는 RGB-D 카메라일 수 있고, 3D 깊이맵 영상(MD)은 상기 RGB 센서에 의해 획득되는 RGB 색 정보 영상과 상기 깊이 센서에 의해 획득되는 깊이 정보 영상을 포함할 수 있 다. 파티클 이미지 생성 모듈은 다양한 크기 및 형상의 불꽃 또는 연기를 포함하는 가상 화재 현상을 모델링한 파티클 집합체(Pa)에 대한 복수의 파티클 이미지(Pi)를 생성한다. 파티클 이미지 생성 모듈은 파티클 시스템 기반의 기설정된 복수의 파티클 입자를 이용하여 불꽃 또는 연 기를 포함하는 화재 요소를 유체 시뮬레이션 렌더링 기법을 통해 모델링함에 따른 파티클 집합체(Pa)를 구성한 후, 이를 깊이맵 영상(MD)과 동일한 영역 범위를 가지는 가상 평면상의 서로 다른 좌표 위치에 배치한 복수의 파 티클 이미지(Pi)를 생성할 수 있다. 이와 관련하여, 파티클 이미지 생성 모듈은 특성 정보 입력부, 파티클 집합체 구성부 및 파티클 이 미지 생성부를 세부 구성으로 포함할 수 있다. 특성 정보 입력부는 사용자로부터 상기 파티클 입자에 대한 색상, 크기 및 텍스처 좌표를 포함하는 파티클 특성 정보를 입력받는다. 여기서, 상기 파티클 특성 정보는 가상 공간상에 사용자가 원하는 시각 효과(VFX; Visual Effect)를 시뮬레이션 하는 파티클 시스템 기반 프로그램인 유니티(Unity)를 통해 사용자로부터 입력받는 해당 시각 효과를 구성하는 복수 개의 파티클 입자 각각에 대한 설정값으로서, 가상 공간 내의 파티클 입자의 위치(_position), 크기 (_size), 이동 속도(_velocity), 가속도(_acceleration), 색상(_color) 등을 포함할 수 있다. 파티클 집합체 구성부는 특성 정보 입력부를 통해 사용자로부터 복수의 상기 파티클 입자 각각에 대응 하여 입력된 파티클 특성 정보에 기초하여, 불꽃 또는 연기와 같은 유체 엔티티를 다양한 위치 및 크기로 시뮬 레이션하여 화재 현상을 모델링함에 따른 복수의 파티클 집합체(Pa)를 구성한다. 파티클 이미지 생성부는 파티클 집합체(Pa)를 깊이맵 영상(MD)과 동일한 영역 범위를 가지는 가상 평면상의 서로 다른 좌표 위치에 배치한 복수의 파티클 이미지(Pi)를 생성한다. 깊이 분할 영상 생성부는 깊이맵 영상 획득부에 의해 획득된 깊이맵 영상(MD)에 해당하는 제1 RGB 영상 (IR-1)을 깊이 레벨에 따라 복수의 RGB 이미지(IR)로 분할한 깊이 분할 영상(SD)을 생성한다. RGB 이미지 추출부는 깊이 분할 영상(SD)으로부터 각각의 파티클 이미지(Pi)상의 파티클 집합체(Pa)에 대한 픽셀 영역의 깊이값과 인접한 깊이 레벨에 대응되는 한 쌍의 RGB 이미지(IR1,IR2)를 추출한다. 합성 이미지 생성부는 각각의 파티클 이미지(Pi)와 이에 대응하여 추출된 한 쌍의 RGB 이미지(IR1,IR2)를 깊 이 위치 순서대로 배치하여 합성한 파티클 합성 이미지(IPC)를 생성한다. 예컨대, 도 3을 참조하면, 파티클 이미지 생성부에 의해 복수의 파티클 이미지(P1,P2,P3)가 생성되고 RGB 이미지 추출부에 의해 각 파티클 이미지의 깊이값과 인접한 깊이 레벨(Depth Level)에 대응되는 복수의 RGB 이미지(41,42,43)가 추출된 경우, 합성 이미지 생성부는 복수의 파티클 이미지(P1,P2,P3) 및 RGB 이미지 (41,42,43)를 깊이 위치 순서대로 배치함에 따라 가상의 화재 객체인 '화재 파티클'에 대응하는 각 파티클 이미 지를 기준으로 전후 위치에 실내 공간을 배경으로 하는 한 쌍의 RGB 이미지를 배치한 후 이를 하나로 합성하여 파티클 합성 이미지(IPC)를 생성하게 된다. 여기서, 합성 이미지 생성부는 도 4에 도시된 바와 같이 파티클 합성 이미지(IPC)의 생성 시 파티클 이미지 및 이에 대응되는 한 쌍의 RGB 이미지(51,53)를 깊이 위치 순서(Depth Level)에 따라 배치하되, 한 쌍의 RGB 이미지(51,53) 중에서 깊이 위치가 상대적으로 먼 위치에 있는 해당 RGB 이미지상의 픽셀 영역의 RGBA 색상값의 투명도를 조절하여 투명하게 처리한 후 합성할 수 있다. 저장부는 파티클 이미지 생성부에 의해 생성된 복수의 파티클 이미지(Pi) 각각에 대응되는 파티클 집합 체(Pa)에 대한 픽셀 영역의 크기 및 위치 정보를 각 파티클 이미지별로 저장한다.경계상자 생성부는 각각의 파티클 이미지(Pi)에 대응하는 파티클 집합체(Pa)에 대한 픽셀 영역의 크기 및 위치 정보를 기준으로 해당 파티클 집합체(Pa)를 둘러싸는 최소 부피의 육면체 형상에 대응하는 경계상자(BB; bounding box)를 생성한다. 경계상자 변환부는 경계상자 생성부에 의해 생성된 경계상자(BB)의 각 꼭지점을 2차원 평면상의 좌표로 변환한 결과에 대응하는 점들을 모두 포함하는 최소 크기의 사각형의 경계영역(BA)을 생성한다. 경계상자 변환부는 생성된 경계영역(BA)의 크기 및 위치 정보를 획득하여 이에 대응하는 파티클 이미지(P i)에 매칭 저장한다. 라벨링 처리부는 각각의 파티클 합성 이미지(IPC)에 대하여 해당 파티클 합성 이미지의 합성에 사용된 파티 클 이미지(Pi)에 대한 경계영역(BA)의 크기 및 위치 정보에 대응하는 특정 영역을 캡쳐해 라벨링 처리한 라벨링 이미지(IL)를 생성한다. 예컨대, 도 5를 참조하면, 복수의 파티클 이미지 각각에 대응하는 파티클 집합체를 둘러싸는 경계상자 (B1,B2,B3)가 경계상자 생성부에 의해 생성되면, 경계상자 변환부가 경계상자(B1,B2,B3)의 각 꼭지 점을 좌표 변환한 경계영역(A1,A2,A3)을 생성한 후 해당 경계영역(A)의 크기 및 위치 정보를 획득하고, 라벨링 처리부가 상기 경계영역을 캡처해 라벨링 처리한 라벨링 이미지를 생성하게 되며, 이러한 동작들은 딥러닝 기반 파이썬(Python) 언어를 기반으로 하는 코딩 설계를 통해 구현될 수 있다. 제어부는 라벨링 처리부에 의해 생성된 라벨링 이미지(IL)의 개수(Ni)가 기설정된 기준 개수(Nr)에 도 달할 때까지 라벨링 이미지(IL)를 반복해서 생성하도록 라벨링 처리부를 제어한다. 제어부는 라벨링 이미지(IL)의 개수(Ni)와 기준개수(Nr)가 일치하는 조건이 충족될 때까지 라벨링 이미지 (IL)의 생성 단계를 반복하도록 하는 명령에 대한 제어 알고리즘을 코딩함에 따라 라벨링 처리부를 제어할 수 있다. 이 경우, 학습 데이터셋 저장부는 기준 개수(Nr)만큼 생성된 라벨링 이미지(IL)를 전달받아 딥러닝 기반 이미지 분류 학습을 수행하기 위한 학습 데이터셋(DS)으로 저장할 수 있다. 이때, 학습 데이터셋(DS)은 실내 공간에 대한 깊이맵 영상(MD)에 해당하는 제1 RGB 영상(IR-1)에 포함된 화재 객 체에 대응하는 파티클 집합체(Pa)의 특징에 대응하여 검출된 픽셀 또는 픽셀들의 조합인 특징점들을 기반으로 하여 생성되는 것일 수 있다. 학습 모델 훈련부는 학습 데이터셋(DS)에 기초한 합성곱 연산을 통해 이미지 내 객체의 특징 파라미터들을 획득함에 따라 해당 객체를 화재 요소에 대하여 기설정된 복수의 클래스 중 하나로 분류하도록 구성된 학습 모 델(CM)을 훈련한다. 여기서, 학습 모델(CM)은 CNN 모델, YOLO 모델, Fast R-CNN 모델 중 어느 하나의 딥러닝 학습 모델에 의해 구현 되는 것일 수 있다. 이때, 학습 모델 훈련부는 입력 데이터별로 가중치(w)를 부여하여 상기 합성곱 연산을 적용할 수 있으며, 이 경우, 가중치(w)는 학습 모델 훈련부에 의해 사전 학습 완료된 학습 모델(CM)에 대한 입력 이미지 내 객체로부터 검출되는 특징점 및 윤곽선 정보와 상기 입력 이미지를 구성하는 픽셀들에 대한 콘트라스트값에 기 초하여 해당 입력 이미지가 가지는 이미지 특징 성분들의 상대적 비율을 계산함에 따라 연산되는 것일 수 있다. 이미지 획득부는 복수의 카메라 중 어느 하나에 의해 3D 깊이맵 영상(MD)과 동일한 실내 공간의 소정 지점 을 기준으로 실시간 촬영된 제2 RGB 영상(IR-2)에 기초한 현재 시점의 RGB 이미지를 평가대상 이미지(IE)로서 획 득한다. 이미지 전처리부는 평가대상 이미지(IE)를 기저장된 학습 데이터셋(DS)에 대응되도록 전처리한 전처리 이미 지(IP)를 생성한다. 클래스 분류부는 전처리 이미지(IP)를 학습 모델(CM)의 입력 데이터로 적용하여 평가대상 이미지(IE)에 포 함된 객체를 복수의 클래스 중 하나로 분류하는 확률값을 산출한다. 클래스 분류부는 도 6에 도시된 바와 같이 학습 모델(CM)에서 전처리 이미지(IP)의 입력에 대응하는 출력 값으로서, 전처리 이미지(IP)에 포함되는 복수의 객체들 각각에 대하여 불꽃(fire) 또는 연기(smoke) 클래스 중 하나로 분류하는 경우의 확률값을 산출할 수 있다. 이때, 산출된 확률값을 이용하여 기설정된 복수의 성능 평가 지표들(AP, precision, recall, RPN_recall)에 대 한 성능값을 클래스별로 산출함에 따라 학습 모델(CM)에 대한 분류 성능 평가를 수행할 수도 있다. 객체 추적부는 전처리 이미지(IP)에 포함된 화재 객체의 움직임을 검출 및 추적하는 객체 추적 영상(TO)을 획득한다. 객체 추적부는 클래스 분류부에 의해 불꽃 또는 연기 클래스로 분류된 적어도 하나 이상의 객체에 대 응하여 산출된 확률값이 기설정된 기준값 이상인 경우, 각각의 객체의 객체 영역을 둘러싸는 검출 영역(AD)을 일 정 시간 동안 추적한 객체 추적 영상(TO)을 획득할 수 있다. 화재 판단 모듈은 객체 추적부에 의해 획득된 객체 추적 영상(TO)에 기초하여 실제 불꽃 또는 연기에 대응하는 화재 속성의 존재 여부를 판별한 결과에 따라 화재 발생 여부를 판단한다. 화재 판단 모듈은 객체 추적 영상(TO) 내 객체가 지속적으로 존재하는지 여부와 해당 객체의 움직임 특성 에 따른 길이 및 각도의 변동 정도를 판별한 결과에 기초하여 특정 실내 공간에 대한 화재 발생 여부를 실시간 으로 판단할 수 있다. 구체적으로, 화재 판단 모듈은 도 1에 도시된 바와 같이 객체 지속성 판별부, 객체 플리커링 판별부 , 화재 여부 판별부를 포함할 수 있다. 객체 지속성 판별부는 객체 추적 영상(TO) 내 포함된 소정 객체를 검출하여 상기 객체에 대한 추적이 기설 정된 라이프 타임 동안 지속적으로 유지되는지에 따라 해당 객체의 지속성 여부를 판별한다. 객체 지속성 판별부는 객체 추적 영상(TO)을 구성하는 복수의 이미지 프레임들 각각에 포함되는 적어도 하 나 이상의 객체를 대상으로 하여 일정 개수 이상의 연속적인 이미지 프레임들에서 동일한 객체가 검출되면, 해 당 객체에 대하여 지속성이 있는 것으로 판별할 수 있다. 여기서, 상기 라이프 타임은 특정 객체가 객체 추적 영상(TO)에 존재하는 시간, 즉, 객체 수명을 의미하는 것으 로 각 이미지 프레임 간의 시차와 연속적인 이미지 프레임들의 개수를 곱한 값에 대응하는 값일 수 있고, 객체 지속성 판별부는 상기 라이프 타임값을 고려하여 지속성 판별 시 기준이 되는 연속적인 이미지 프레임들의 개수를 설정할 수 있다. 객체 플리커링 판별부는 객체 지속성 판별부에 의해 지속성이 있다고 판별되는 객체를 대상으로 하여 깜빡이는 현상인 플리커링이 발생하는지 여부를 판별한다. 객체 플리커링 판별부는 지속성이 있다고 판별된 객체의 객체 영역에 대한 경계박스를 생성한 후 상기 경 계박스의 대각선 길이와 중심점부터 대각선 꼭지점까지의 벡터에 대한 시간당 변화율에 기초하여 해당 객체의 플리커링 여부를 판별할 수 있다. 여기서, 객체 플리커링 판별부는 도 8 및 도 9a에 도시된 바와 같이 객체 추적 영상(TO) 내 포함되며 지속 성이 있다고 판별된 특정 객체(예, 불꽃)에 대하여, 제1 시점(t0)에 검출된 객체 영역에 대한 제1 경계박스 (first detection)와 상기 제1 시점 이후의 제2 시점(tt)에 검출된 객체 영역에 대한 제2 경계박스(detection after first)를 각각 생성한 후, 상기 제1 경계박스 및 상기 제2 경계박스 각각의 중심점을 통과하는 동일한 방 향의 제1 대각선(dist0) 및 제2 대각선(distt)을 생성할 수 있다. 또한, 객체 플리커링 판별부는 도 8에 도시된 바와 같이 상기 제1 경계박스의 중심점을 벡터 시점으로 고 정시킨 후, 상기 제1 대각선의 상단 꼭지점을 벡터 종점으로 하는 제1 벡터(firstVecLT)와, 상기 제1 대각선의 하단 꼭지점을 벡터 종점으로 하는 제2 벡터(firstVecRB)와, 상기 제2 대각선의 상단 꼭지점을 벡터 종점으로 하는 제3 벡터(vecLT)와, 상기 제2 대각선의 하단 꼭지점을 벡터 종점으로 하는 제4 벡터(vecRB)를 각각 생성할수 있다. 전술한 과정에 따라 경계박스, 대각선 및 벡터의 생성이 완료되면, 객체 플리커링 판별부는 화재 객체의 벡터 길이(LT) 변화를 감지하기 위한 제1 조건과, 화재 객체의 벡터 각도(RB) 변화를 감지하기 위한 제2 조건을 이용하여 객체의 플리커링 여부를 판별한다. 먼저, 객체 플리커링 판별부는 상기 제1 조건에 대한 판별을 위하여 현재 시점부터 일정 시간 이후 시점까 지의 이미지 프레임들(d1,d2,d3,…,d14,d15)을 대상으로 하여, 도 9a에 도시된 바와 같이 현재 시점에 대응하는 상기 제1 대각선(dist0)과 특정 미래 시점에 대응하는 상기 제2 대각선(distt)의 길이에 대한 시간별 차이값(d t)과 이를 누적한 결과값(dcumulative)을 아래의 수학식 1에 따라 산출할 수 있다. 수학식 1"}
{"patent_id": "10-2023-0017726", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "이 경우, 산출된 결과값(dcumulative)을 클래스별로 기설정된 제1 기준값과 비교하여 결과값(dcumulative)이 상기 제1 기준값 이상이면, 화재 객체의 벡터 길이(LT) 변화에 따른 플리커링이 발생한 것으로 판별하게 된다. 여기서, 상기 제1 기준값은 제1 대각선(dist0)과 클래스별 가중치(α)를 곱한 값일 수 있으며, 불꽃 클래스에 대한 가중치는 \"0.6\"이고, 연기 클래스에 대한 가중치는 \"0.9\"인 것이 바람직하다. 다음으로, 객체 플리커링 판별부는 상기 제2 조건에 대한 판별을 위하여 현재 시점부터 일정 시간 이후 시 점까지의 이미지 프레임들(d1,d2,d3,…,d14,d15)을 대상으로 하여, 도 9b에 도시된 바와 같이 현재 시점에 대응하 는 상기 제1 벡터(v0)와 특정 미래 시점에 대응하는 상기 제2 벡터(vt) 간의 사잇각(θ)에 대한 코사인 값을 아 래의 수학식 2에 따라 산출할 수 있다. 수학식 2"}
{"patent_id": "10-2023-0017726", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "이 경우, 복수의 이미지 프레임들을 기준으로 하여 산출된 코사인 값(cosθt)을 기설정된 제2 기준값과 각각 비 교하여 모두 상기 제2 기준값보다 작으면, 화재 객체의 벡터 각도(RB) 변화에 따른 플리커링이 발생한 것으로 판별하게 된다. 여기서, 상기 제2 기준값은 화재 객체가 불꽃인 경우엔 \"0.98\"이고 화재 객체가 연기인 경우엔 \"0.9\"인 것이 바 람직하다. 화재 여부 판단부는 객체 지속성 판별부와 객체 플리커링 판별부의 판별 결과에 기초하여 최종 적으로 특정 실내 공간에 화재가 발생하였는지 여부를 판단한다. 화재 여부 판단부는 객체 지속성 판별부에 의해 지속성이 있다고 판별된 객체가 존재할 때, 해당 객 체가 객체 플리커링 판별부에 의한 상기 제1 조건 또는 상기 제2 조건 중 적어도 하나를 만족하면, 해당 객체의 객체 추적 영상(TO)이 촬영된 실내 공간에 화재가 발생한 것으로 판단할 수 있다. 화재 검출 알림부는 화재 여부 판단부에 의해 특정 실내 공간에 화재가 발생한 것으로 최종 판단되는 경우, 객체 추적 영상(TO)의 특정 프레임상에 객체 검출 영역, 객체 클래스 확률값, 영상 촬영 위치 정보 중 적 어도 하나를 표시하는 알림 메시지를 생성하여 출력한다. 화재 검출 알림부는 객체 추적 영상(TO)의 특정 프레임상에서 검출 영역(AD)의 위치 및 크기를 강조 표시하 는 제1 알림 메시지를 생성하여 출력할 수 있다. 화재 검출 알림부는 클래스 분류부에 의해 검출 영역(AD) 내 객체에 대응하여 산출된 확률값과 평가 대상 이미지(IE)를 촬영한 카메라의 위치 데이터 중 적어도 하나를 해당 검출 영역의 경계 주변에 표시하는 제2 알림 메시지를 생성하여 출력할 수 있다. 전술한 도 1 및 도 2에 도시된 구성요소들에 대한 설명을 바탕으로 하여 본 발명에 따른 인공 신경망 모델 기반 화재 조기 검출 방법을 도 11을 참조하여 설명하면 다음과 같다. 본 발명의 일 실시예에 따른 인공 신경망 모델 기반 화재 조기 검출 방법은 크게 학습 데이터셋 저장 단계 (S100), 학습 모델 훈련 단계(S200), 평가대상 이미지 획득 단계(S300), 이미지 전처리 단계(S330), 객체 클래 스 분류 단계(S400), 이미지 객체 추적 단계(S500), 화재 객체 판단 단계(S600), 화재 검출 알림 단계(S700)를 포함한다. 먼저, 상기 S100 단계(학습 데이터셋 저장 단계)는, 화재 관련 객체에 대한 딥러닝 기반 이미지 분류 학습을 수 행하기 위한 학습 데이터셋(DS)을 저장하기 위한 것이다. 상기 S100 단계에서는, 화재 시 발생하는 화재 요소, 예컨대, 불꽃 또는 연기 등을 모델링한 파티클 집합체(P a)에 대응하는 화재 객체를 특정 실내 공간을 사전에 촬영한 깊이맵 영상(MD)을 배경으로 합성하여 라벨링 처리 함에 따라 생성된 학습 데이터셋(DS)을 저장할 수 있다. 다음으로, 상기 S200 단계(학습 모델 훈련 단계)는, 학습 데이터셋(DS)에 기초한 합성곱 연산을 통해 이미지 내 객체의 특징 파라미터들을 획득함에 따라 해당 객체를 화재 요소에 대하여 기설정된 복수의 클래스 중 하나로 분류하도록 구성된 학습 모델(CM)을 훈련한다. 여기서, 학습 모델(CM)은 CNN 모델, YOLO 모델, Fast R-CNN 모델 중 어느 하나의 딥러닝 학습 모델에 의해 구현 되는 것일 수 있다. 다음으로, 상기 S30 단계(평가대상 이미지 획득 단계)는, 복수의 카메라 중 어느 하나에 의해 3D 깊이맵 영상 (MD)과 동일한 실내 공간의 소정 지점을 기준으로 실시간 촬영된 제2 RGB 영상(IR-2)에 기초한 현재 시점의 RGB 이미지를 평가대상 이미지(IE)로서 획득한다. 다음으로, 상기 S330 단계(이미지 전처리 단계)는, 평가대상 이미지(IE)를 기저장된 학습 데이터셋(DS)에 대응되 도록 전처리한 전처리 이미지(IP)를 생성한다. 다음으로, 상기 S400 단계(객체 클래스 분류 단계)는, 전처리 이미지(IP)를 학습 모델(CM)의 입력 데이터로 적 용하여 평가대상 이미지(IE)에 포함된 객체를 복수의 클래스 중 하나로 분류하는 확률값을 산출한다. 상기 S400 단계에서는, 도 6에 도시된 바와 같이 학습 모델(CM)에서 전처리 이미지(IP)의 입력에 대응하는 출력 값으로서, 전처리 이미지(IP)에 포함되는 복수의 객체들 각각에 대하여 불꽃(fire) 또는 연기(smoke) 클래스 중 하나로 분류하는 경우의 확률값을 산출할 수 있다. 이때, 산출된 확률값을 이용하여 기설정된 복수의 성능 평가 지표들(AP, precision, recall, RPN_recall)에 대 한 성능값을 클래스별로 산출함에 따라 학습 모델(CM)에 대한 분류 성능 평가를 수행할 수도 있다. 다음으로, 상기 S500 단계(이미지 객체 추적 단계)는, 전처리 이미지(IP)에 포함된 화재 객체의 움직임을 검출 및 추적하는 객체 추적 영상(TO)을 획득한다. 상기 S500 단계에서는, 상기 S400 단계에 불꽃 또는 연기 클래스로 분류된 적어도 하나 이상의 객체에 대응하여 산출된 확률값이 기설정된 기준값 이상인 경우, 각각의 객체의 객체 영역을 둘러싸는 검출 영역(AD)을 일정 시간 동안 추적한 객체 추적 영상(TO)을 획득할 수 있다. 다음으로, 상기 S600 단계(화재 객체 판단 단계)는, 상기 S500 단계에 획득된 객체 추적 영상(TO)에 기초하여 실제 불꽃 또는 연기에 대응하는 화재 속성의 존재 여부를 판별한 결과에 따라 화재 발생 여부를 판단한다. 상기 S600 단계에서는, 객체 추적 영상(TO) 내 객체가 지속적으로 존재하는지 여부와 해당 객체의 움직임 특성 에 따른 길이 및 각도의 변동 정도를 판별한 결과에 기초하여 특정 실내 공간에 대한 화재 발생 여부를 실시간 으로 판단할 수 있다. 구체적으로, 상기 S600 단계는 도 11에 도시된 바와 같이 추적 객체의 지속성 여부 판별 단계(S620), 추적 객체 의 플리커링 여부 판별 단계(S640), 화재 여부 최종 판단 단계(S660)를 포함할 수 있다. 지속성 여부 판별 단계(S620)는 객체 추적 영상(TO) 내 포함된 소정 객체를 검출하여 상기 객체에 대한 추적이 기설정된 라이프 타임 동안 지속적으로 유지되는지에 따라 해당 객체의 지속성 여부를 판별한다. 상기 S620 단계에서는, 객체 추적 영상(TO)을 구성하는 복수의 이미지 프레임들 각각에 포함되는 적어도 하나 이상의 객체를 대상으로 하여 일정 개수 이상의 연속적인 이미지 프레임들에서 동일한 객체가 검출되면, 해당 객체에 대하여 지속성이 있는 것으로 판별할 수 있다. 여기서, 상기 라이프 타임은 특정 객체가 객체 추적 영상(TO)에 존재하는 시간, 즉, 객체 수명을 의미하는 것으 로 각 이미지 프레임 간의 시차와 연속적인 이미지 프레임들의 개수를 곱한 값에 대응하는 값일 수 있고, 객체 지속성 판별부는 상기 라이프 타임값을 고려하여 지속성 판별 시 기준이 되는 연속적인 이미지 프레임들의 개수를 설정할 수 있다. 플리커링 여부 판별 단계(S640)는 상기 S620 단계에 의해 지속성이 있다고 판별되는 객체를 대상으로 하여 깜빡 이는 현상인 플리커링이 발생하는지 여부를 판별한다. 상기 S640 단계에서는, 지속성이 있다고 판별된 객체의 객체 영역에 대한 경계박스를 생성한 후 상기 경계박스 의 대각선 길이와 중심점부터 대각선 꼭지점까지의 벡터에 대한 시간당 변화율에 기초하여 해당 객체의 플리커 링 여부를 판별할 수 있다. 여기서, 상기 S640 단계에는 도 8 및 도 9a에 도시된 바와 같이 객체 추적 영상(TO) 내 포함되며 지속성이 있다 고 판별된 특정 객체(예, 불꽃)에 대하여, 제1 시점(t0)에 검출된 객체 영역에 대한 제1 경계박스(first detection)와 상기 제1 시점 이후의 제2 시점(tt)에 검출된 객체 영역에 대한 제2 경계박스(detection after first)를 각각 생성한 후, 상기 제1 경계박스 및 상기 제2 경계박스 각각의 중심점을 통과하는 동일한 방향의 제1 대각선(dist0) 및 제2 대각선(distt)을 생성할 수 있다. 또한, 상기 S640 단계에는 도 8에 도시된 바와 같이 상기 제1 경계박스의 중심점을 벡터 시점으로 고정시킨 후, 상기 제1 대각선의 상단 꼭지점을 벡터 종점으로 하는 제1 벡터(firstVecLT)와, 상기 제1 대각선의 하단 꼭지점 을 벡터 종점으로 하는 제2 벡터(firstVecRB)와, 상기 제2 대각선의 상단 꼭지점을 벡터 종점으로 하는 제3 벡 터(vecLT)와, 상기 제2 대각선의 하단 꼭지점을 벡터 종점으로 하는 제4 벡터(vecRB)를 각각 생성할 수 있다. 전술한 과정에 따라 경계박스, 대각선 및 벡터의 생성이 완료되면, 상기 S640 단계는 화재 객체의 벡터 길이 (LT) 변화를 감지하기 위한 제1 조건과, 화재 객체의 벡터 각도(RB) 변화를 감지하기 위한 제2 조건을 이용하여 객체의 플리커링 여부를 판별한다. 먼저, 상기 S640 단계에는 상기 제1 조건에 대한 판별을 위하여 현재 시점부터 일정 시간 이후 시점까지의 이미 지 프레임들(d1,d2,d3,…,d14,d15)을 대상으로 하여, 도 9a에 도시된 바와 같이 현재 시점에 대응하는 상기 제1 대각선(dist0)과 특정 미래 시점에 대응하는 상기 제2 대각선(distt)의 길이에 대한 시간별 차이값(dt)과 이를 누적한 결과값(dcumulative)을 상기 수학식 1에 따라 산출할 수 있다. 이 경우, 산출된 결과값(dcumulative)을 클래스별로 기설정된 제1 기준값과 비교하여 결과값(dcumulative)이 상기 제1 기준값 이상이면, 화재 객체의 벡터 길이(LT) 변화에 따른 플리커링이 발생한 것으로 판별하게 된다. 여기서, 상기 제1 기준값은 제1 대각선(dist0)과 클래스별 가중치(α)를 곱한 값일 수 있으며, 불꽃 클래스에 대한 가중치는 \"0.6\"이고, 연기 클래스에 대한 가중치는 \"0.9\"인 것이 바람직하다. 다음으로, 상기 S640 단계에는 상기 제2 조건에 대한 판별을 위하여 현재 시점부터 일정 시간 이후 시점까지의 이미지 프레임들(d1,d2,d3,…,d14,d15)을 대상으로 하여, 도 9b에 도시된 바와 같이 현재 시점에 대응하는 상기 제1 벡터(v0)와 특정 미래 시점에 대응하는 상기 제2 벡터(vt) 간의 사잇각(θ)에 대한 코사인 값을 상기 수학식 2에 따라 산출할 수 있다. 이 경우, 복수의 이미지 프레임들을 기준으로 하여 산출된 코사인 값(cosθt)을 기설정된 제2 기준값과 각각 비 교하여 모두 상기 제2 기준값보다 작으면, 화재 객체의 벡터 각도(RB) 변화에 따른 플리커링이 발생한 것으로 판별하게 된다. 여기서, 상기 제2 기준값은 화재 객체가 불꽃인 경우엔 \"0.98\"이고 화재 객체가 연기인 경우엔 \"0.9\"인 것이 바 람직하다. 화재 여부 최종 판단 단계(S660)는 상기 S620 단계와 상기 S640 단계의 판별 결과에 기초하여 최종적으로 특정 실내 공간에 화재가 발생하였는지 여부를 판단한다. 상기 S660 단계에서는, 상기 S620 단계에 의해 지속성이 있다고 판별된 객체가 존재할 때, 해당 객체가 상기 S640 단계에 의한 상기 제1 조건 또는 상기 제2 조건 중 적어도 하나를 만족하면, 해당 객체의 객체 추적 영상 (TO)이 촬영된 실내 공간에 화재가 발생한 것으로 판단할 수 있다. 다음으로, 상기 S700 단계(화재 검출 알림 단계)는, 상기 S600 단계에 의해 특정 실내 공간에 화재가 발생한 것으로 최종 판단되는 경우, 객체 추적 영상(TO)의 특정 프레임상에 객체 검출 영역, 객체 클래스 확률값, 영상 촬영 위치 정보 중 적어도 하나를 표시하는 알림 메시지를 생성하여 출력한다. 상기 S700 단계에서는, 객체 추적 영상(TO)의 특정 프레임상에서 검출 영역(AD)의 위치 및 크기를 강조 표시하는 제1 알림 메시지를 생성하여 출력할 수 있다. 또한, 상기 S00 단계에서는, 상기 S400 단계에 의해 검출 영역(AD) 내 객체에 대응하여 산출된 확률값과 평가대 상 이미지(IE)를 촬영한 카메라의 위치 데이터 중 적어도 하나를 해당 검출 영역의 경계 주변에 표시하는 제2 알 림 메시지를 생성하여 출력할 수 있다. 이에 따라, 전술한 본 발명에 의하면, 시나리오 기반의 다양한 환경에서의 학습 데이터를 다량으로 생성할 수 있어 종래의 학습 데이터 부족에 따른 화재 조기 검출 능력의 한계를 극복하고 매우 높은 수준의 검출률을 얻을 수 있다. 또한, 본 발명에 의하면, 새로운 형태의 비전 기반의 화재 검출 인공 지능 시스템을 구축할 수 있는 이점이 있 다. 이상, 바람직한 실시예를 통하여 본 발명에 관하여 상세히 설명하였으나, 본 발명은 이에 한정되는 것은 아니며 특허청구범위 내에서 다양하게 실시될 수 있다. 특히, 전술한 내용은 후술할 발명의 청구범위를 더욱 잘 이해할 수 있도록 본 발명의 특징과 기술적 강점을 다 소 폭넓게 상술하였으므로, 상술한 본 발명의 개념과 특정 실시예는 본 발명과 유사 목적을 수행하기 위한 다른 형상의 설계나 수정의 기본으로써 즉시 사용될 수 있음이 해당 기술 분야의 숙련된 사람들에 의해 인식되어야 한다."}
{"patent_id": "10-2023-0017726", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "또한, 상기에서 기술된 실시예는 본 발명에 따른 하나의 실시예일 뿐이며, 해당 기술분야에서 통상의 지식을 가 진 자에 의해 본 발명의 기술적 사상의 범위에서 다양한 수정 및 변경된 형태로 구현될 수 있음을 이해할 수 있 을 것이다. 따라서, 개시된 실시예는 한정적인 관점이 아니라 설명적인 관점에서 고려되어야 하고, 이러한 다양 한 수정 및 변경 또한 본 발명의 기술적 사상의 범위에 속하는 것으로 전술한 본 발명의 청구범위에 나타나 있 으며, 그와 동등한 범위 내에 있는 모든 차이점은 본 발명에 포함된 것으로 해석되어야 할 것이다."}
{"patent_id": "10-2023-0017726", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 일 실시예에 따른 인공 신경망 모델 기반 화재 조기 검출 장치의 구성을 나타낸 블록도이고, 도 2는 도 1의 학습 데이터셋 저장부에서 저장하는 학습 데이터셋의 생성 과정을 수행하는 구성들을 도시한 블 록도이고, 도 3은 도 2의 합성 이미지 생성부에 의해 파티클 합성 이미지를 생성하는 과정을 설명하기 위한 도면이고, 도 4는 도 2의 합성 이미지 생성부에 의해 파티클 이미지와 합성되는 일부 RGB 이미지를 투명 처리하는 과정을 설명하기 위한 도면이고, 도 5는 도 2의 경계상자 생성부 및 경계상자 변환부에 의해 3D 경계상자 및 이에 기초한 2D 경계영역이 생성되 는 과정을 설명하기 위한 도면이고, 도 6은 도 1의 클래스 분류부의 분류 결과에 따른 객체별 클래스 정보와 분류 성능 평가 결과의 일례를 나타낸 도면이고,도 7은 도 1의 객체 지속성 판별부에 의한 지속성 판별 동작을 설명하기 위한 도면이고, 도 8은 도 1의 객체 플리커링 판별부에 의해 생성되는 제1 및 제2 경계박스, 제1 및 제2 대각선, 제1 내지 제4 벡터를 설명하기 위한 도면이고, 도 9는 도 1의 객체 플리커링 판별부에 의한 플리커링 판별 조건을 설명하기 위한 도면이고, 도 10은 도 1의 화재 판단 모듈에 의한 판단 명령 알고리즘을 코딩한 소스 코드와 평가대상 이미지상에 검출영 역 및 이에 대응되는 알림 메시지를 표시하는 일례를 나타낸 도면이고, 도 11은 본 발명의 일 실시예에 따른 인공 신경망 모델 기반 화재 조기 검출 방법을 나타낸 순서도이다."}
