{"patent_id": "10-2021-0022274", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2022-0118629", "출원번호": "10-2021-0022274", "발명의 명칭": "다양한 이상 침해에 대응 가능한 차량용 하이브리드 IDS", "출원인": "한국전자기술연구원", "발명자": "장수현"}}
{"patent_id": "10-2021-0022274", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "데이터를 수집하는 수집부;수집부에 의해 수집된 데이터를 기초로, 알고리즘 기반으로 이상 침해를 탐지하는 제1 처리부;수집부에 의해 수집된 데이터를 기초로, 인공지능 기반으로 이상 침해를 탐지하는 제2 처리부;를 포함하는 것을특징으로 하는 하이브리드 IDS(Intrusion Detection System)."}
{"patent_id": "10-2021-0022274", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "청구항 1에 있어서,수집부에서 수집된 데이터를 분석하여 이상 침해 탐지에 필요한 피처들을 추출하는 추출부;를 더 포함하고,제1 처리부는,추출부에 의해 추출된 피처들을 알고리즘의 입력으로 이용하며,제2 처리부는,추출부에 의해 추출된 피처들을 인공지능 모델의 입력으로 이용하는 것을 특징으로 하는 하이브리드 IDS."}
{"patent_id": "10-2021-0022274", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "청구항 2에 있어서,수집부에서 수집된 데이터를 분석하여 이상 침해 탐지에 필요한 피처들을 추가하는 추가부;를 더 포함하고,제2 처리부는,추출부에 의해 추출된 피처들과 추가부에 의해 추가된 피처들을 인공지능 모델의 입력으로 이용하는 것을 특징으로 하는 하이브리드 IDS."}
{"patent_id": "10-2021-0022274", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "청구항 3에 있어서,머신러닝 모델은,피처들을 입력받아 이상 침해 여부를 분류하도록 학습된 것을 특징으로 하는 하이브리드 IDS."}
{"patent_id": "10-2021-0022274", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "청구항 3에 있어서,제1 처리부의 이상 침해 탐지 결과와 제2 처리부의 이상 침해 탐지 결과를 취합하여, 이상 침해를 최종적으로검출하는 검출부;를 더 포함하는 것을 특징으로 하는 하이브리드 IDS."}
{"patent_id": "10-2021-0022274", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "공개특허 10-2022-0118629-3-청구항 5에 있어서,검출부는,제1 처리부의 이상 침해 탐지 결과와 제2 처리부의 이상 침해 탐지 결과를 OR 조건으로 결합하여, 이상 침해를검출하는 것을 특징으로 하는 하이브리드 IDS."}
{"patent_id": "10-2021-0022274", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "청구항 2에 있어서,알고리즘은,룰셋 기반 알고리즘이고,인공지능 모델은,머신러닝 모델이며,수집부는,차량 네트워크에서 데이터를 수집하는 것을 특징으로 하는 하이브리드 IDS."}
{"patent_id": "10-2021-0022274", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "데이터를 수집하는 단계;수집 단계에서 수집된 데이터를 기초로, 알고리즘 기반으로 이상 침해를 탐지하는 단계;수집 단계에서 수집된 데이터를 기초로, 인공지능 기반으로 이상 침해를 탐지하는 단계;를 포함하는 것을 특징으로 하는 하이브리드 침해 탐지 방법."}
{"patent_id": "10-2021-0022274", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "다양한 이상 침해에 대응 가능한 차량용 하이브리드 IDS가 제공된다. 본 발명의 실시예에 따른 하이브리드 IDS는 룰셋 알고리즘과 머신러닝 모델을 결합하여, 차량 내부 네트워크의 외부 침입 탐지를 수행한다. 이에 의해, 차량 내부 네트워크의 외부 침입 탐지을 빠르게 감지하면서도 다양한 새로운 이상 침해에 대해 효과적으로 검출할 수 있게 된다."}
{"patent_id": "10-2021-0022274", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 차량용 IDS(Intrusion Detection System)에 관한 것으로, 더욱 상세하게는 차량 제어에 필요한 정보 를 송수신하는 CAN(Controller Area Network)을 대상으로 차량 내부 네트워크에서 발생 되는 외부 침입 (Intrusion)을 탐지하기 위한 차량용 IDS에 관한 것이다."}
{"patent_id": "10-2021-0022274", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "최근, 차량 내부 네트워크 보안에 대한 관심이 높아지고 있으며, 이에 대한 예시로 2013년 미국의 Charlie Miller 연구팀은 도요타의 프리우스 모델 해킹에 성공사례 및 2016년 중국의 텐센트 연구소에서 테슬라 모델S를 원격으로 해킹 및 차량 제어에 성공한 자동차 해킹사례가 최근까지도 이어지고 있다. 특히, CAN bus에는 표준화된 보안 체계가 존재하지 않아, OTA(Over The Air)와 같은 무선 업데이트 기능이 내재 된 커넥티드카에서는 외부 이상 침해에 대응 가능한 IDS가 필수적이다. 이에 따라, 인공지능 기반의 지능형 IDS 개발이 확산되고 있으며, 다양한 이상 침해 및 주행 상황에 대해 높은 탐지율이 요구되고 있다."}
{"patent_id": "10-2021-0022274", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 2, "content": "발명의 내용"}
{"patent_id": "10-2021-0022274", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은 상기와 같은 문제점을 해결하기 위하여 안출된 것으로서, 본 발명의 목적은, 차량 내부 네트워크의 외부 침입 탐지를 효과적으로 수행하기 위한 방안으로, 룰셋 알고리즘과 머신러닝 모델을 결합한 하이브리드 IDS를 제공함에 있다. 또한 본 발명의 목적은, 하이브리드 IDS의 룰셋 알고리즘과 머신러닝 모델이 Feature를 공유할 수 있고 학습되 지 않은 데이터에 대해서도 분류 성능을 향상 시킬 수 있는 방법을 제공함에 있다."}
{"patent_id": "10-2021-0022274", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "상기 목적을 달성하기 위한 본 발명의 일 실시예에 따른 하이브리드 IDS는, 데이터를 수집하는 수집부; 수집부 에 의해 수집된 데이터를 기초로, 알고리즘 기반으로 이상 침해를 탐지하는 제1 처리부; 수집부에 의해 수집된 데이터를 기초로, 인공지능 기반으로 이상 침해를 탐지하는 제2 처리부;를 포함한다. 본 발명의 일 실시예에 따른 하이브리드 IDS는, 수집부에서 수집된 데이터를 분석하여 이상 침해 탐지에 필요한 피처들을 추출하는 추출부;를 더 포함하고, 제1 처리부는, 추출부에 의해 추출된 피처들을 알고리즘의 입력으로 이용하며, 제2 처리부는, 추출부에 의해 추출된 피처들을 인공지능 모델의 입력으로 이용할 수 있다. 본 발명의 일 실시예에 따른 하이브리드 IDS는, 수집부에서 수집된 데이터를 분석하여 이상 침해 탐지에 필요한 피처들을 추가하는 추가부;를 더 포함하고, 제2 처리부는, 추출부에 의해 추출된 피처들과 추가부에 의해 추가 된 피처들을 인공지능 모델의 입력으로 이용할 수 있다. 머신러닝 모델은, 피처들을 입력받아 이상 침해 여부를 분류하도록 학습될 수 있다. 본 발명의 일 실시예에 따른 하이브리드 IDS는, 제1 처리부의 이상 침해 탐지 결과와 제2 처리부의 이상 침해 탐지 결과를 취합하여, 이상 침해를 최종적으로 검출하는 검출부;를 더 포함할 수 있다. 검출부는, 제1 처리부의 이상 침해 탐지 결과와 제2 처리부의 이상 침해 탐지 결과를 OR 조건으로 결합하여, 이 상 침해를 검출할 수 있다. 알고리즘은, 룰셋 기반 알고리즘이고, 인공지능 모델은, 머신러닝 모델이며, 수집부는, 차량 네트워크에서 데이 터를 수집할 수 있다. 한편, 본 발명의 다른 실시예에 따른, 하이브리드 침해 탐지 방법은, 데이터를 수집하는 단계; 수집 단계에서 수집된 데이터를 기초로, 알고리즘 기반으로 이상 침해를 탐지하는 단계; 수집 단계에서 수집된 데이터를 기초 로, 인공지능 기반으로 이상 침해를 탐지하는 단계;를 포함한다."}
{"patent_id": "10-2021-0022274", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "이상 설명한 바와 같이, 본 발명의 실시예들에 따르면, 룰셋 알고리즘과 머신러닝 모델을 결합한 하이브리드 IDS를 통해, 차량 내부 네트워크의 외부 침입 탐지을 빠르게 감지하면서도 다양한 새로운 이상 침해에 대해 효 과적으로 검출할 수 있게 된다. 특히, 본 발명의 실시예들에 따르면, 하이브리드 IDS의 룰셋 알고리즘과 머신러닝 모델이 Feature를 공유함으로 써 아주 효과적인 데이터 운용과 활용이 가능해진다."}
{"patent_id": "10-2021-0022274", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하에서는 도면을 참조하여 본 발명을 보다 상세하게 설명한다. 이상 침해 검출을 위해 룰셋 기반 알고리즘을 활용할 수 있다. 또한 GAN(Generative Adversarial Network) 과 AutoEncoder 같은 인공지능 모델을 활용하는 것을 고려할 수도 있다. 룰셋 기반 알고리즘의 경우 별도의 사전학습이 필요 없고 정의된 규칙에 따라 이상 침해를 검출하여 실시간 처 리의 장점이 있지만, 모든 ECU에 대한 분석에는 한계가 있으며 정상과 비슷한 특징을 지닌 이상 침해에 대해서 는 사전학습 없이 탐지가 어렵다, 인공지능 모델 활용의 경우 차량의 이상 침해 케이스를 모두 정의할 수 없어, GAN, AutoEncoder와 같은 준지도 학습 모델이 주로 활용되고 있으나, 사전에 정의된 데이터로만 모델을 학습하고 데이터가 정상 범위 내에서 벗 어나거나 기준치 설정에 따라 이상 침해 분류 성능이 보장되지 않는다. 도 1에는 단일 AutoEncoder 모델을 활용 한 이상 침해 검출 모델을 나타내었다. 또한 침해 분류 성능을 보장하기 위해서는 다양한 정상 데이터에 대해 모델의 학습이 필요하지만, 도로 안전 주 행 여건에 따라 급격한 변화가 없는 정차 및 항속 주행 상황에서 수집된 데이터만을 활용하여 학습하는 한계가 있다. 이와 같이 차량의 정상 상황은 특정한 기준을 두고 정의할 수 없으며, 기존 준지도 학습 모델은 학습된 데이터 에 과적합 될 위험이 존재하므로 이상 침해 분류 성능을 높이는데 한계가 있는 것이다. 이에 따라, 이상 침해 패턴에 대한 인식률 저하를 보이는 룰셋 알고리즘과 과적합 및 실시간 처리에 문제가 있 는 준지도 학습 기반 인공지능 모델의 문제를 동시에 해결하고자 하기 위한 방안으로, 본 발명의 실예에서는 양 자를 결합한 차량용 IDS(Intrusion Detection System)를 제시한다. 도 2는 본 발명의 일 실시예에 따른 차량용 하이브리드 IDS의 블럭도이다. 본 발명의 실시예에 따른 차량용 하 이브리드 IDS는, 도시된 바와 같이, 데이터 수집, 피처 추출부, 피처 추가부, 룰셋 알고리즘 처 리부, 머신러닝 모델 처리부 및 침해 검출부를 포함하여 구성된다. 데이터 수집부는 차량 제어에 필요한 정보를 송수신하는 차량 내부 네트워크인 CAN(Controller Area Network)에서 데이터들을 수집한다. 피처 추출부는 데이터 수집부에서 수집된 CAN 데이터를 분석하여 이상 침해 탐지에 필요한 피처 (feature)들을 추출한다. 피처 추출부에 의해 추출되는 피처들에는, 이를 테면, Time interval, Datafield diff 가 포함될 수 있다. 도 3에는 CAN 데이터의 Time interval 분석 결과를 예시하였다. 하지만, 위에서 언급한 피처들은 본 발명의 실시예에 대한 설명을 위한 예시적인 것으로, 일부를 배제하거나 다 른 피처로 변경할 수 있음은 물론 다른 피처를 추가하는 것도 가능하다. 피처 추출부에서 추출된 피처들은 후술할 룰셋 알고리즘 처리부와 머신러닝 모델 처리부에 공유 되어 활용된다. 도 4와 도 5에는 피처 공유를 통해 룰셋 알고리즘과 머신러닝 모델이 처리되는 환경을 나타내었 다. 이와 같이, 본 발명의 실시예에서는 룰셋 알고리즘 처리부에서 이용할 피처들과 머신러닝 모델 처리부 에서 이용할 피처들을 별개가 아닌 통합적으로 추출하여, 피처 추출을 위한 데이터 분석에 요구되는 자원 과 복잡도를 최소화하였다. 피처 추가부는 피처 추출부에서 추출된 피처들 외에 머신러닝 모델 처리부에 더 필요한 피처를 추출하기 위한 구성이다. 이를 테면, 피처 추가부는 데이터 수집부에서 수집된 CAN 데이터를 분석하 여 ID_Lag를 추출할 수 있다. 도 4와 도 5를 비교하면, 머신러닝 모델 처리부는 룰셋 알고리즘 처리부와 달리 입력 변수에 ID_Lag 가 추가되어 있음을 확인할 수 있다. 룰셋 알고리즘 처리부은 피처 추출부에서 추출된 피처들을 입력으로 룰셋 기반으로 이상 침해를 탐지 한다. 도 4에는 룰셋 알고리즘 처리부에 적용가능한 룰셋 알고리즘을 예시하였다. 알고리즘 처리에 의한다는 점에서, 룰셋 알고리즘 처리부에 의한 이상 침해 탐지는, 전형적인 침해에 대해 정확도가 매우 높고 빠르다. 머신러닝 모델 처리부는 피처 추출부에서 추출된 피처들과 피처 추가부에 의해 추가된 피처들을 입력받아 침해 여부를 분류하도록 학습된 머신러닝 모델을 이용하여 이상 침해를 탐지한다. 도 5에는 머신러닝 모델 처리부에 적용가능한 머신러닝 모델을 예시하였다. 머신러닝에 의한다는 점에서, 머신러닝 모델 처리부에 의한 이상 침해 탐지는, 비전형적인 침해와 새로운 방식의 침해까지 탐지할 수 있다. 침해 검출부는 룰셋 알고리즘 처리부의 침해 탐지 결과와 머신러닝 모델 처리부의 침해 탐지 결 과를 취합하여, 이상 침해를 검출한다. 침해 검출 조건은 다양하게 구성이 가능하다. 가장 합리적으로는, 룰셋 알고리즘 처리부의 침해 탐지 결과 와 머신러닝 모델 처리부의 침해 탐지 결과를 OR 조건으로 결합할 수 있다. 즉, 둘 중 어느 하나에서만이 라도 침해가 탐지된 경우, 이상 침해가 발생한 것으로 취급하는 것이다. 가장 안전한 방식이다. 하지만, 룰셋 알고리즘 처리부의 침해 탐지 결과와 머신러닝 모델 처리부의 침해 탐지 결과를 AND 조 건으로 결합하여, 둘 모두에서 침해가 탐지된 경우, 이상 침해가 발생한 것으로 취급하는 것도 가능하다. 확실 한 침해에 대해서만 대응하기 위한 방식이다. 도 6은 본 발명의 실시예에 따른 차량용 하이브리드 IDS가 동작하는 과정을 나타낸 도면이다. 본 발명의 실시예에 따른 차량용 하이브리드 IDS에 대해, 사전학습 과정에서 각각의 CAN ID 별 단일 모델 분류 성능을 확인하였을 때, 전반적으로 많은 ID에서 룰셋 알고리즘의 성능이 좋으나, 특정 ID는 머신러닝 모델에서 더 나은 분류 성능을 나타내었는데, 해당 ID들을 업데이트 대상 ID로 정의할 수 있다. 결과적으로, 하이브리드 IDS 기반의 이상 침해 검출 시 전처리된 테스트 데이터에 대해 각각의 단일 모델로부터 결과를 도출하고, 룰셋 알고리즘의 결과 중 사전에 정의한 특정 ID의 결과는 머신러닝 모델의 결과로 업데이트 하여 최종 검출 성능을 향상시킬 수도 있다. 도 7은 본 발명의 다른 실시예에 따른 차량용 하이브리드 침해 탐지 방법의 설명에 제공되는 흐름도이다. 이상 침해 탐지를 위해, 먼저, 데이터 수집부는 CAN 데이터를 수집한다(S210). 그러면, 피처 추출부는 S210단계에서 수집된 CAN 데이터를 분석하여 이상 침해 탐지에 필요한 피처들을 추 출한다(S220). 그리고, 피처 추가부는 S220단계에서 추출된 피처들 외에 머신러닝 모델 처리부에 더 필요한 피처를 추출한다(S230). 이후, 룰셋 알고리즘 처리부은 S220단계에서 추출된 피처들을 입력으로 룰셋 기반으로 이상 침해를 탐지한 다(S240). 또한, 머신러닝 모델 처리부는 S220단계에서 추출된 피처들과 S230단계에서 추가된 피처들을 입력받아 머 신러닝 모델을 이용하여 이상 침해를 탐지한다(S250). 다음, 침해 검출부는 S240단계에서의 침해 탐지 결과와 S250단계에서의 침해 탐지 결과를 취합하여, 이상 침해를 검출한다(S260). 지금까지, 다양한 이상 침해에 대응 가능한 차량용 하이브리드 IDS에 대해 바람직한 실시예를 들어 상세히 설명 하였다. 본 발명의 실시예에서는, 차량 내부 네트워크의 외부 침입 탐지를 위한 IDS를 구성함에 있어, 룰셋 알고리즘과 머신러닝 모델을 결합한 하이브리드 타입을 제시하였다. 또한, 본 발명의 실시예에서는, 생성한 양자가 피처들을 공유하도록 하였으며, 머신러닝 모델에 더 필요한 피처 들은 추가가 가능하도록 구현하였다.이에 의해, 룰셋 알고리즘을 이용하여 전형적인 이상 침해의 빠르고 정확한 탐지가 가능하고, 머신러닝 모델을 이용하여 비전형적인 이상 침해에 대한 탐지도 가능해진다. 한편, 본 실시예에 따른 장치와 방법의 기능을 수행하게 하는 컴퓨터 프로그램을 수록한 컴퓨터로 읽을 수 있는 기록매체에도 본 발명의 기술적 사상이 적용될 수 있음은 물론이다. 또한, 본 발명의 다양한 실시예에 따른 기 술적 사상은 컴퓨터로 읽을 수 있는 기록매체에 기록된 컴퓨터로 읽을 수 있는 코드 형태로 구현될 수도 있다. 컴퓨터로 읽을 수 있는 기록매체는 컴퓨터에 의해 읽을 수 있고 데이터를 저장할 수 있는 어떤 데이터 저장 장 치이더라도 가능하다. 예를 들어, 컴퓨터로 읽을 수 있는 기록매체는 ROM, RAM, CD-ROM, 자기 테이프, 플로피 디스크, 광디스크, 하드 디스크 드라이브, 등이 될 수 있음은 물론이다. 또한, 컴퓨터로 읽을 수 있는 기록매체 에 저장된 컴퓨터로 읽을 수 있는 코드 또는 프로그램은 컴퓨터간에 연결된 네트워크를 통해 전송될 수도 있다. 또한, 이상에서는 본 발명의 바람직한 실시예에 대하여 도시하고 설명하였지만, 본 발명은 상술한 특정의 실시"}
{"patent_id": "10-2021-0022274", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "예에 한정되지 아니하며, 청구범위에서 청구하는 본 발명의 요지를 벗어남이 없이 당해 발명이 속하는 기술분야 에서 통상의 지식을 가진자에 의해 다양한 변형실시가 가능한 것은 물론이고, 이러한 변형실시들은 본 발명의 기술적 사상이나 전망으로부터 개별적으로 이해되어져서는 안될 것이다."}
{"patent_id": "10-2021-0022274", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 단일 AutoEncoder 모델을 활용한 이상 침해 검출 모델, 도 2는 본 발명의 일 실시예에 따른 차량용 하이브리드 IDS의 블럭도, 도 3은 CAN 데이터의 Time interval 분석 결과를 예시한 도면, 도 4는 룰셋 알고리즘을 예시한 도면,도 5는 머신러닝 모델을 예시한 도면, 도 6은 본 발명의 실시예에 따른 차량용 하이브리드 IDS가 동작하는 과정, 그리고, 도 7은 본 발명의 다른 실시예에 따른 차량용 하이브리드 침해 탐지 방법의 설명에 제공되는 흐름도이다."}
