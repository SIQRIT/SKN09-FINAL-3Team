{"patent_id": "10-2023-0015665", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2024-0123119", "출원번호": "10-2023-0015665", "발명의 명칭": "분자내 수소원자의 1H-Chemical Shift를 예측하는 인공지능모델", "출원인": "주식회사 엘지화학", "발명자": "조성인"}}
{"patent_id": "10-2023-0015665", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "컴퓨터 장치에 의한 신경망 연산을 통하여 선택된 분자를 구성하는 수소원자의 케미컬 쉬프트를 예측하는 인공신경망으로서, 상기 선택된 분자의 그래프 데이터를 입력받아 노드 피쳐 벡터, 로컬 에지 벡터, 글로벌 에지 벡터, 정션 노드피쳐 벡터, 정션 에지 벡터를 포함하는 임베딩 벡터를 추출하는 다수의 임베딩 레이어들로 구성된 임베딩 블럭;상기 임베딩 벡터로부터 각 노드의 특징값이 이웃하는 노드의 특징값들로부터 받는 영향을 연산하여 각 노드의특징값을 갱신하는 메시지 패싱 블럭;상기 메시지 패싱 블럭에 의해 최종 갱신된 각 노드의 특징값들로부터 수소원자의 케미컬 쉬프트 예측값을 연산하는 리드아웃 블럭;을 포함하여 구성되는 인공신경망 모델."}
{"patent_id": "10-2023-0015665", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "상기 메시지 패싱 블럭은, 결합으로 연결되지 않은 노드 사이를 가상으로 결합하여 그 정보를 전달하는 글로벌 메시지 패싱 레이어; 결합으로 연결된 노드 사이의 정보를 전달하는 로컬 메시지 패싱 레이어;방향족 고리를 하나의 정션으로 묶어 정션 단위로 정보를 전달하는 정션 메시지 패싱 레이어;를 포함하여 구성되는 것을 특징으로 하는 분자의 케미컬 쉬프트 예측 인공신경망 모델."}
{"patent_id": "10-2023-0015665", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제2항에 있어서, 상기 메시지 패싱 블럭은, 상기 로컬 메시지 패싱 레이어와 업데이트 레이어 사이에 다이렉트 멀티 홉 어텐션 레이어;를 추가로 구비하는 것을 특징으로 하는 분자의 케미컬 쉬프트 예측 인공신경망 모델."}
{"patent_id": "10-2023-0015665", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제1항 내지 제3항 중 어느 한 항의 인공신경망 모델이 기록된 기록매체."}
{"patent_id": "10-2023-0015665", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제1항 내지 제3항 중 어느 한 항의 인공신경망 모델의 전체 또는 일부를 읽어 들여 신경망 연산을 수행하는 프로세서."}
{"patent_id": "10-2023-0015665", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제1항 내지 제3항 중 어느 한 항의 인공신경망 모델을 학습시키는 학습 방법에 있어서, 다수의 분자구조 그래프 데이터와 소정의 분자특성을 라벨값으로 가지는 제1 데이터세트를 학습데이터로 하여상기 제1항 내지 제3항 중 어느 한 항의 인공신경망 모델을 학습시키고, 각 신경망의 파라미터 세트인 제1 파라미터 세트를 획득하는 제1 신경망 학습단계;상기 제1 파라미터 세트 중, 리드아웃 블럭의 신경망 파라미터를 제외한 신경망 파라미터들을 적용하고, 상기제1 데이터세트와는 다른 다수의 분자구조 그래프 데이터와 해당 분자구조의 각 원자들의 케미컬 쉬프트 값을라벨값으로 가지는 제2 데이터세트를 학습데이터로 하여 상기 제1항 내지 제3항 중 어느 한 항의 인공신경망 모공개특허 10-2024-0123119-3-델을 학습시키고, 각 신경망의 파라미터 세트인 제2 파라미터 세트를 획득하는 제2 신경망 학습단계;상기 제2 파라미터 세트를 적용하고, 방향족 분자들의 분자구조 그래프 데이터와 해당 분자구조의 각 원자들의케미컬 쉬프트 측정값을 라벨값으로 가지는 제3 데이터세트를 학습데이터로 하여 상기 제1항 내지 제3항 중 어느 한 항의 인공신경망 모델을 학습시켜, 각 신경망의 파라미터 세트인 제3 파라미터 세트를 획득하는 제3 신경망 학습단계:를 수행하고, 상기 제3 파라미터 세트를 상기 제1항 내지 제3항 중 어느 한 항의 인공신경망 모델의 최종 파라미터 세트로 획득하는 제1항 내지 제3항 중 어느 한 항의 인공신경망 모델의 학습방법."}
{"patent_id": "10-2023-0015665", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "선택된 분자를 구성하는 수소원자의 케미컬 쉬프트를 예측하는 방법에 있어서, 상기 선택된 분자의 분자구조를 그래프 데이터로 표현한 분자 그래프 데이터를 획득하는 분자 그래프 데이터 획득단계;획득한 분자 그래프 데이터를 상기 선택된 분자를 구성하는 수소원자의 케미컬 쉬프트의 예측값을 출력하도록학습된 인공신경망에 입력하는 신경망 입력단계;상기 신경망으로부터 상기 선택된 분자를 구성하는 각 수소원자의 케미컬 쉬프트 예측값을 획득하는 케미컬 쉬프트 예측값 획득단계;를 포함하여 구성되는 분자의 케미컬 쉬프트 예측 방법."}
{"patent_id": "10-2023-0015665", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제7항에 있어서, 상기 인공신경망은, 상기 선택된 분자의 그래프 데이터를 입력받아 노드 피쳐 벡터, 로컬 에지 벡터, 글로벌 에지 벡터, 정션 노드피쳐 벡터, 정션 에지 벡터를 포함하는 임베딩 벡터를 추출하는 다수의 임베딩 레이어들로 구성된 임베딩 블럭;상기 임베딩 벡터로부터 각 노드의 특징값이 이웃하는 노드의 특징값들로부터 받는 영향을 연산하여 각 노드의특징값을 갱신하는 메시지 패싱 블럭;상기 메시지 패싱 블럭에 의해 최종 갱신된 각 노드의 특징값들로부터 수소원자의 케미컬 쉬프트 예측값을 연산하는 리드아웃 블럭;을 포함하여 구성되는 것;을 특징으로 하는 분자의 케미컬 쉬프트 예측 방법."}
{"patent_id": "10-2023-0015665", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제8항에 있어서, 상기 메시지 패싱 블럭은, 결합으로 연결되지 않은 노드 사이를 가상으로 결합하여 그 정보를 전달하는 글로벌 메시지 패싱 레이어; 결합으로 연결된 노드 사이의 정보를 전달하는 로컬 메시지 패싱 레이어;방향족 고리를 하나의 정션으로 묶어 정션 단위로 정보를 전달하는 정션 메시지 패싱 레이어;를 포함하여 구성되는 것을 특징으로 하는 분자의 케미컬 쉬프트 예측 방법."}
{"patent_id": "10-2023-0015665", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제9항에 있어서, 상기 메시지 패싱 블럭은, 상기 로컬 메시지 패싱 레이어와 업데이트 레이어 사이에 다이렉트 멀티 홉 어텐션 레이어;공개특허 10-2024-0123119-4-를 추가로 구비하는 것을 특징으로 하는 분자의 케미컬 쉬프트 예측 방법."}
{"patent_id": "10-2023-0015665", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 방향족 고리를 포함한 고분자량 분자에 대하여 정확한 케미컬 쉬프트를 예측하는 방법 및 시스템에 관 한 것으로서, 분자구조를 그래프 데이터로 표현하고, 각 원자 및 원자들의 결합관계를 노드와 에지로 표현하고, 나아가, 결합으로 연결되지 않은 원자들 사이의 3차원 공간상의 거리를 글로벌 에지로 표현하며, 방향족 고리를 하나의 정션으로 표현하는 방식을 사용하여 분자를 표현하고, 각 노드와 정션 노드들간의 메시지 전달방식을 통 하여 케미컬 쉬프트를 인공신경망 학습함으로써, 정확한 케미컬 쉬프트 예측 방법 및 시스템을 제공한다."}
{"patent_id": "10-2023-0015665", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 고분자량 분자에 대한 1H-NMR chemical shift 예측 방법 및 시스템에 관한 것이다."}
{"patent_id": "10-2023-0015665", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "미지 물질의 분자구조 추정을 위해 1H-NMR 스펙트럼 분석을 진행한다. 1H-NMR 스펙트럼 분석으로 얻을 수 있는 정보들 중에, 케미컬 쉬프트(chemical shift)는 동일한 작용기에 있는 수소라 할지라도 주변구조의 영향을 받아 변하므로, 구조로부터 그 정확한 값을 예측하기 어렵다. 따라서, 물질의 분자구조 후보로 추정되는 구조로부터 각 수소가 나타내는 1H-NMR chemical shift를 정확하게 예측하는 기술이 요구된다. 이와 관련하여, 아래 비특허문헌 1, 2와 같은 화학적 이동값에 대한 예측 도구가 존재한다. 그러나 이들 종래기 술들은 작은 크기의 단순한 분자에 대해서만 높은 정확도를 보일뿐, 분자의 크기가 커지거나 방향족 고리 등 복 잡한 형상을 지니는 경우 예측 정확도가 크게 떨어진다. 예를 들어, OLED 물질은 분자크기가 크고, 방향족 고리를 다수 포함하고 있어 이러한 종래기술을 적용하는 경우 예측 정확도가 떨어진다. 이에, 방향족 고리를 포함한 고분자량 분자에 대한 1H-NMR chemical shift 예측 기술 이 필요하다. 선행기술문헌 비특허문헌 (비특허문헌 0001) 비특허문헌 1: Neural Message Passing for NMR Chemical Shift Prediction, Youngchun Kwon, Dongseon Lee, Youn-Suk Choi, Myeonginn Kang, and Seokho Kang, Journal of Chemical Information and Modeling 2020 60 , 2024-2030 (비특허문헌 0002) 비특허문헌 2: Direct Multi-hop Attention based Graph Neural Network, Wang, Guangtao et al. ArXivabs/2009.14332 (비특허문헌 0003) 비특허문헌 3: Molecular Mechanics-Driven Graph Neural Network with Multiplex Graph for Molecular Structures, Shuo Zhang, Yang Liu, Lei Xie, arXiv:2011.07457"}
{"patent_id": "10-2023-0015665", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은 상기 종래기술의 문제를 해결하고, 분자의 크기가 크거나 방향족 고리 등 복잡한 형상을 지니는 물질 에 대해서도 정확한 1H-NMR chemical shift 예측이 가능한 예측방법을 제공하고자 한다."}
{"patent_id": "10-2023-0015665", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "상술한 기술적 과제를 달성하기 위하여 본 발명은, 컴퓨터 장치에 의한 신경망 연산을 통하여 선택된 분자를 구 성하는 수소원자의 케미컬 쉬프트를 예측하는 인공신경망으로서, 상기 선택된 분자의 그래프 데이터를 입력받아 노드 피쳐 벡터, 로컬 에지 벡터, 글로벌 에지 벡터, 정션 노드 피쳐 벡터, 정션 에지 벡터를 포함하는 임베딩 벡터를 추출하는 다수의 임베딩 레이어들로 구성된 임베딩 블럭; 상기 임베딩 벡터로부터 각 노드의 특징값이 이웃하는 노드의 특징값들로부터 받는 영향을 연산하여 각 노드의 특징값을 갱신하는 메시지 패싱 블럭; 상기 메시지 패싱 블럭에 의해 최종 갱신된 각 노드의 특징값들로부터 수소원자의 케미컬 쉬프트 예측값을 연산하는 리드아웃 블럭;을 포함하여 구성되는 인공신경망 모델을 제공한다. 또한, 본 발명은, 상기 인공신경망 모델을 학습시키는 학습 방법으로서, 다수의 분자구조 그래프 데이터와 소정 의 분자특성을 라벨값으로 가지는 제1 데이터세트를 학습데이터로 하여 상기 제1항 내지 제3항 중 어느 한 항의 인공신경망 모델을 학습시키고, 각 신경망의 파라미터 세트인 제1 파라미터 세트를 획득하는 제1 신경망 학습단 계; 상기 제1 파라미터 세트 중, 리드아웃 블럭의 신경망 파라미터를 제외한 신경망 파라미터들을 적용하고, 상 기 제1 데이터세트와는 다른 다수의 분자구조 그래프 데이터와 해당 분자구조의 각 원자들의 케미컬 쉬프트 값 을 라벨값으로 가지는 제2 데이터세트를 학습데이터로 하여 상기 제1항 내지 제3항 중 어느 한 항의 인공신경망 모델을 학습시키고, 각 신경망의 파라미터 세트인 제2 파라미터 세트를 획득하는 제2 신경망 학습단계; 상기 제 2 파라미터 세트를 적용하고, 방향족 분자들의 분자구조 그래프 데이터와 해당 분자구조의 각 원자들의 케미컬 쉬프트 측정값을 라벨값으로 가지는 제3 데이터세트를 학습데이터로 하여 상기 제1항 내지 제3항 중 어느 한 항 의 인공신경망 모델을 학습시켜, 각 신경망의 파라미터 세트인 제3 파라미터 세트를 획득하는 제3 신경망 학습 단계: 를 수행하고, 상기 제3 파라미터 세트를 상기 제1항 내지 제3항 중 어느 한 항의 인공신경망 모델의 최종 파라미터 세트로 획득하는 인공신경망 모델의 학습방법을 제공한다. 또한, 본 발명은, 선택된 분자를 구성하는 수소원자의 케미컬 쉬프트를 예측하는 방법에 있어서, 상기 선택된 분자의 분자구조를 그래프 데이터로 표현한 분자 그래프 데이터를 획득하는 분자 그래프 데이터 획득단계; 획득 한 분자 그래프 데이터를 상기 선택된 분자를 구성하는 수소원자의 케미컬 쉬프트의 예측값을 출력하도록 학습 된 인공신경망에 입력하는 신경망 입력단계; 상기 신경망으로부터 상기 선택된 분자를 구성하는 각 수소원자의 케미컬 쉬프트 예측값을 획득하는 케미컬 쉬프트 예측값 획득단계; 를 포함하여 구성되는 분자의 케미컬 쉬프트 예측 방법을 제공한다. 이때, 상기 인공신경망은, 상기 선택된 분자의 그래프 데이터를 입력받아 노드 피쳐 벡터, 로컬 에지 벡터, 글 로벌 에지 벡터, 정션 노드 피쳐 벡터, 정션 에지 벡터를 포함하는 임베딩 벡터를 추출하는 다수의 임베딩 레이 어들로 구성된 임베딩 블럭; 상기 임베딩 벡터로부터 각 노드의 특징값이 이웃하는 노드의 특징값들로부터 받는 영향을 연산하여 각 노드의 특징값을 갱신하는 메시지 패싱 블럭; 상기 메시지 패싱 블럭에 의해 최종 갱신된 각 노드의 특징값들로부터 수소원자의 케미컬 쉬프트 예측값을 연산하는 리드아웃 블럭; 을 포함하여 구성되는 것;을 특징으로 한다. 또한, 본 발명은, 상기 인공신경망 모델을 포함하여 수소원자의 케미컬 쉬프트 예측값을 산출 시스템을 제공하 며, 본 시스템은 상기 인공신경망 모델이 기록된 기록매체, 상기 인공신경망 모델을 읽어들여 신경망 연산을 수 행하는 프로세서를 포함한다."}
{"patent_id": "10-2023-0015665", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명에 따른 인공신경망 모델은, 종래의 그래프 신경망 및 메시지 패싱 레이어를 이용한 케미컬 쉬프트 예측 방법에 비하여, 분자의 3차원 분자구조를 활용하여 글로벌 에지, 정션 노드, 정션 에지 벡터를 포함하여 연산함 으로써, 분자의 크기가 크거나 방향족 고리 등 복잡한 형상을 지니는 경우에도 정확한 예측을 가능하게 하는 효 과를 가져온다. 또한, 본 발명은, 신경망 학습방법에 있어서, 대형 데이터 세트를 사용하여 신경망을 학습하고, 그 학습결과로 획득되는 파라미터를 예측 대상 분자와 유사한 분자의 학습에 적용함으로써, 데이터세트가 적은 경우에도 학습의 정확도를 높이는 효과를 가져온다."}
{"patent_id": "10-2023-0015665", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "분자의 NMR(nuclear magnetic resonance) 스펙트럼에서, 케미컬 쉬프트(chemical shift)는 분자구조를 설명함 에 있어서 매우 중요한 요소이다. 본 발명은 분자구조 데이터를 입력값으로 하여 케미컬 쉬프트(chemical shift)를 예측하는 인공지능 모델의 구 축방법 및 해당 인공지능 모델을 이용한 케미컬 쉬프트(chemical shift) 예측 시스템을 제공한다. 본 발명에서 인공지능 모델(artificial intelligence model)이라 함은, 컴퓨터 장치를 이용하여 소정의 인공신경망 연산을 수행하는 인공신경망 알고리즘들의 일련의 집합을 의미한다. 이러한 인공지능 모델은 상기 인공신경망의 각 층 (layer)들 간의 입력에 대한 가중치 및 편향값들에 대하여 학습을 진행하여, 그 학습결과로 획득되는 상기 가중 치 및 편향값들 및 각 층들의 입출력 관계를 구성하는 파라미터들을 메모리 장치에 저장하고, 인공신경망 연산 수행시 프로세서가 이를 읽어들여 학습된 결과에 따라 인공신경망 연산을 수행하도록 구성된 컴퓨터 알고리즘을 포함한다. 이 때 상기 가중치 및 편항값들을 각 신경망 레이어의 파라미터라 한다. 신경망 레이어의 파라미터 세트는 해당 신경망의 전달함수를 결정하며, 신경망 학습에 의하여 최적화된다. 본 발명은 이와 같은 인공지능 모델이 기록된 컴퓨터 저장장치, 메모리를 포함하며, 또는 이들 인공지능 모델이 기록된 컴퓨터 저장장치, 메모 리를 포함하는 컴퓨터 장치 또는 연산 프로세서(calculating processor)를 포함한다."}
{"patent_id": "10-2023-0015665", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "이와 같은 인공지능 모델의 학습, 저장 및 사용은 이 기술분야에서 통상의 방식을 따르며, 본 발명의 기술적 특 징은 후술하는 인공신경망의 구조 및 그 입력값의 전처리 과정에 있다. 1. 데이터 전처리: 분자구조의 3차원 그래프 표현 본 발명은 소정의 분자의 분자구조 데이터를 입력값으로 하고, 입력값으로부터 해당 분자의 화학적 이동을 예측 하는 것을 목적으로 한다. 이를 인공지능 모형을 통하여 달성하기 위하여, 분자의 분자구조를 컴퓨터가 읽어들 일 수 있는 형태의 데이터로 변환하여야 한다. 특별히, 본 발명은 2차원 분자구조로부터 UFF(Universal Force Field) 혹은 MMFF(Merck Molecular Force Fidld) 등의 방법을 이용하여 분자의 3차원 구조를 추출하고 이를 아래에 설명하는 방식에 따라서, 3차원 그래 프 표현의 데이터로 전처리한다. A. 분자의 그래프 표현- 노드와 에지 개별 분자를 비방향성 그래프로 표현한다. 도 1은 분자구조를 분자 그래프로 변환한 형태를 보인다. 하나의 분 자 그래프는 G=(V, E) 로 표현되며, 분자를 이루는 원자를 노드(node), 원자간의 연결을 에지(edge)라 할 때, V, E는 각각 분자를 구성하는 노드세트와 에지세트를 표현하게 된다. 각각의 노드와 에지는 v_i V, e_i,j = e_j,i E 로 표현된다. 본 발명에서는 수소를 제외한 원자들인, 중원자(heavy atom)만을 노드로 표현하고 수 소원자는 노드로 표현하지 않았으며, 각 중원자에 결합된 수소원자의 개수를 후술하는 노드 특징값에 포함시킴 으로써 수소원자의 의미를 반영하였다. 결과적으로 본 발명에서 하나의 분자 그래프는 분자를 구성하는 중원자 수만큼의 노드와 중원자들이 결합으로 연결된 연결의 수만큼의 에지를 가지게 된다. 한편, 본 발명에서는 상기 에지세트 E를 노드들이 직접 결합된 것으로 보아, 로컬 에지라 표현하며, El 로 나타 낼 수 있다. 하지만 본 발명에서, 아래에 설명하는 글로벌 에지는 Eg로 별도로 표현하지 않는 에지 E는 로컬 에 지를 의미한다. B. 에지의 추가(글로벌 에지) 본 발명에서는 분자의 3D 구조 반영을 위하여, 결합으로 연결되지 않은 원자 간에서 가상의 에지를 연결하여 그 특징값(feature)으로 3차원 공간에서의 원자 간 거리, 그래프 상에서의 topological distance를 사용하였다. 본 발명에서 글로벌 에지는 Eg로 표현하였다. 후술하는 본 발명의 인공신경망에서는 3차원 공간상에서의 거리에 따 라 메시지를 주고 받을 수 있는 레이어를 추가하였다. 글로벌 에지의 예시를 도 2의 (b)에 보인다. C. 졍션 노드, 졍션 에지 본 발명에서는 또한, 방향족 고리를 하나의 정션(junction)으로 묶어 정션 단위로 메시지를 주고받을 수 있도록, 인공신경망에 졍션 레이어를 추가하였다. 이를 위하여 본 발명에서는 정션 노드 Vj, 정션 에지 Ej를 추 가로 포함하였다. 정션 노드와 정션 에지의 예를 도 2의 (c)에 보인다. D. 노드벡터, 에지벡터 각 노드, 에지는 특징값(feature)이 부여되어 벡터화된다. 노드i 벡터, 노드 i와 노드 j를 연결하는 에지벡터는 각각 v_i V, e-_i,j = e_j,i E 로 표현된다(i, j 는 노드번호). 글로벌 에지벡터는 eg_i,j Eg 로 표현 된다. 정션 에지벡터는 ej_i,j Ej 로 표현된다. 본 발명에서, 노드벡터 또는 노드피쳐 벡터는 동일한 의미로 사용되며, 에지벡터, 에지피쳐벡터 역시 동일한 의미로 사용된다. E. 노드 피쳐값(node features) 본 발명에서 사용된 노드 피쳐값(features)으로는 원자번호, 손대칭성 (chirality), degree, 형식전하, 결합된 수소 수, 라디칼 전자수, 혼성화 오비탈 정보, 방향족 여부, 고리원자 여부, explicit valence, implicit valence, total valence, total degree, 원자 반지름, 최외각전자수, N 인접원자 수가 있다. F. 에지 특징값(edge features) 로컬 에지 특징값으로는, 결합의 종류(결합차수, 방향족 결합), stereochemistry 정보, conjugation 여부, 고리 여부를 사용하였다. 글로벌 에지 특징값으로는, 3차원 공간에서의 원자간 거리, 그래프 상에서의 topological distance를 사용하였 다. 이와 같이 본 발명은, 본 발명에서는 2차원 분자구조를 그래프 데이터화하는 데이터 전처리를 수행한다. 데이터 전처리를 거쳐 분자구조를 노드피쳐벡터 Va, 로컬 에지벡터 El, 글로벌 에지벡터 Eg, 정션노드 피쳐 벡터 Vj, 정션에지벡터 Ej를 포함하는 3차원 그래프 데이터로 변환한다. 2. 본 발명에 따른 케미컬 쉬프트(chemical shift) 예측 모델의 구조 본 발명의 예측모델은 그래프 표현된 분자구조의 그래프 데이터를 입력받아 그로부터 1H chemical shift를 예측 하도록 학습되는 인공신경망을 포함하여 구성된다. 본 발명의 인공신경망은 기존의 MPNN의 구조를 개선하여 아 래와 같은 특징적 구조를 가진다. 본 발명은, 노드 및 로컬 에지에 대하여 메시지 패싱(message passing)을 통하여 학습을 진행함으로써, 각 노드 의 은닉상태를 연결하는 에지의 특징값과 결합하여 인접 노드들에 전달하여 인접노드의 은닉상태(hidden stat e)를 업데이트하는 종래의 MPNN 방식이 분자의 3D 구조를 반영하지 못하였던 점을 개선하고자, 글로벌 에지를 추가하였으며, 방향족 고리를 포함한 분자에서 일반적인 분자보다 더 먼 거리의 원자들끼리 상호작용하는 현상 을 반영하고자, 정션 노드, 정션 에지, 글로벌 에지를 추가하고 각각에 대하여 신경망을 학습한다. 또한 과중한 연산량을 경감하기 위하여 direct multi-hop attention 레이어를 추가하였다. 도 3에 본 발명에 따른 인공신경망의 구조를 보인다. 도 3에서, 로컬 노드 벡터는 v-a, 로컬 에지는 el, 글로벌 에지는 eg, 졍션 노드는 vj, 정션 에지는 ej로 표현되었으며, ha는 각 레이어를 거친 후, 노드 벡터 va의 히든 스테이트를 나타낸다. 아래에 설명하는 '레이어'는 소정의 신경망 연산을 수행하는 컴퓨터 알고리즘을 의미하며, '블럭'은 다수의 '레 이어'들의 집합체를 의미한다. A. 임베딩 블럭 임베딩 블럭은 인공신경망의 입력데이터를 입력받아 벡터화한다. 본 발명의 인공신경망은, 분자구조 데이터를 앞서 설명한 것과 같이 3차원 그래프 데이터로 전처리하여 획득한 노드피쳐벡터(node feature vector) Va, 로컬 에지벡터(local edge vector) El, 글로벌 에지벡터(global edge vector) Eg, 정션노드 피쳐 벡터(junction node feature vector) Vj, 정션에지벡터(junction edge vector) Ej를 입력받아, 소정의 임베딩함수로 임베딩하 여, 후술하는 메시지 패싱 블럭으로 전달한다. 다수의 임베딩 레이어들이 상기 각각의 벡터에 대응하 여 구성되며, 각각의 임베딩 함수로 임베딩하여 임베딩 벡터를 생성하여 메시지 패싱 블럭으로 전달한다. 각각의 임베딩 레이어는 노드피쳐벡터 Va, 로컬 에지벡터 El, 글로벌 에지벡터 Eg, 정션노드 피쳐 벡터 Vj, 정션에지벡터 Ej를 입력받아 임베딩하는 임베딩 함수를 결정하는 임베딩 파라미터들을 가지며, 임베딩 파라미터 들은 학습과정에서 최적화된다. B. 메시지 패싱 블럭 메시지 패싱 블럭은 임베딩 레이어를 통해 입력되는 각 노드 피쳐들이, 그에 연결되는 노드들로부터 받는 정보를 학습하는 신경망 레이어들로 구성된다. 도 3에 보인 메시지 패싱 블럭의 상단에 보인 레이어들은하나의 노드가 그와 로컬 에지로 연결된 노드들, 글로벌 에지로 연결된 노드들의 정보를 전달받아 노드 피쳐를 업데이트하며, 메시지 패싱 블럭의 하단에 보인 레이어들은 하나의 정션 노드가 정션 에지를 통하여 연결 된 다른 정션 노드들로부터 받는 영향을 전달받아 정션 노드 피쳐를 업데이트하는 것을 보인다. 이와 같은 과정 은 모든 노드들에 대하여 행해진다. 도 3의 메시지 패싱 블럭은 1차의 메시지 패싱 수행 과정을 도시한 것이며, 메시지 패싱이 소정의 N 차수만큼 반복될 수 있음은 통상의 기술자에게 자명하다. 글로벌 메시지 패싱 레이어 본 발명의 특징중의 하나로서, 결합으로 연결되지 않은 노드 사이에도 가상의 결합을 연결하여, 3차원 공간 상 에서의 거리에 따라 메시지를 주고 받을 수 있는 글로벌 메시지 패싱 레이어을 추가한다. 이는 앞서 설명한 글 로벌 에지 벡터를 노드 피쳐와 함께 메시지 전달한다(글로벌 메시지 패싱단계). 로컬 메시지 패싱 레이어 로컬 메시지 패싱 레이어는 공지의 MPNN 구조를 가진다. 글로벌 메시지 패싱 레이어를 통해 전달된 노드 피 쳐 벡터를, 로컬 에지벡터와 함께 메시지 전달(로컬 메시지 패싱단계)함으로써 로컬 에지로 연결된 다른 노드들 의 정보를 전달받는다. 다이렉트 멀티-홉 어텐션 레이어 2 결합 거리 이상의 정보가 1 인접 메시지로만 전달되는 경우, 거대분자 학습을 위해서는 신경망의 레이어가 깊 어져야 하기 때문에 과다한 연산자원이 소모되는 문제가 발생한다. 이러한 문제 해결을 위하여 본 발명은, 원거 리 원자의 정보를 획득하도록 어텐션 메커니즘을 개선한 다이렉트 멀티홉 어텐션 메커니즘을 수행하는 다이렉트 멀티홈 어텐션 레이어(direct multi-hop attention block)을 추가할 수 있다. 다이렉트 멀티홉 어텐션 레이어 자체의 구체적인 메커니즘은 선행문헌 2 등에 개시된다. 본 발명의 다이렉트 멀티홉 어텐션 레이어은 상기 로컬 메시지 패싱 레이어을 통해 업데이트된 정보와 로컬 에지 데이터를 입력받아 다음 단계의 노드 피쳐 벡터를 갱신한다. 정션 메시지 패싱 레이어 원자의 방향족 결합은 일반적인 결합보다 더 먼거리까지 원자의 영향을 전달하는 경향이 있으므로, 본 발명은 방향족 고리를 하나의 접합부(junction)로 묶어, 접합부 단위로 메시지를 주고받을 수 있는 정션 메시지 패싱 레이어를 추가하였다. 정션 메시지 패싱 레이어는 소정의 분자구조로부터 임베딩된 정션노드 피쳐 벡터(Vj)와 정션 에지 벡터(Ej)로부 터 정보를 전달받아 메시지 패싱 과정을 거쳐 최종적으로 정션 매핑 레이어로 전달한다. 정션 매핑 레이어 정션 매핑 레이어는 메시지 전달된 졍션 노드 벡터를 노드 벡터로 매핑하는 신경망층이다. 정션 노드 벡터 는 방향족 고리 노드를 하나의 정션 노드로 매핑한 것이기 때문에, 이후 리드아웃 블럭에서 최종 노드 벡터의 히든 스테이트를 갱신하기 위하여 각 노드들로 매핑하는 과정이 필요하다. 업데이트 레이어 업데이트 레이어는 앞서 설명한 로컬 메시지 패싱 레이어 또는 다이렉트 멀티홉 어텐션 레이어 을 거쳐 출력되는 노드 벡터의 히든 스테이트와 정션 매핑 레이어의 출력으로부터 갱신되는 노드 벡터의 히든 스테이트를 결합하는 층이다. 히든 스테이트 벡터 ha 히든 스테이트 벡터(ha)는 각각 글로벌 메시지 패싱 레이어, 로컬 메시지 패싱 레이어, 다이렉트 멀티 홉 어텐션 레이어, 정션 메시지 패싱 레이어, 정션 매핑 레이어, 업데이터 레이터의 후단에 연 결되어, 노드 벡터의 히든 상태를 업데이트한다. C. 리드아웃 블럭 리드아웃 레이어 리드아웃 레이어는 업데이트 레이어의 후단에 배치되어 최종 메시지 전달된 노드 벡터를 출력한다. 케미컬 쉬프트(y^) 상기 리드아웃 레이어로부터 각 노드에 대응하는 케미컬 쉬프트 예측값이 출력된다. 3. 본 발명의 예측 모델의 학습 A. 학습데이터 본 발명에 따른 인공신경망을 학습시키기 위하여 학습데이터세트를 마련하여야 한다. 학습데이터 세트는 로 표현할 수 있다. Gt는 학습데이터로 사용되는 분자의 그래프 정보이며, yt는 학습데이터로 사용되는 분자를 구성하는 각 원자의 수소의 케미컬 쉬프트(chemical shift) 값의 참값(labeled data)이다. 본 발명은, 방향족 거대분자에 대한 케미컬 쉬프트(chemical shift)를 예측하는 것을 목적으로 한다. 그런데, 방향족 거대분자에 대한 학습데이터 샘플이 충분하지 않기에 본 발명의 일 실시예는 대형 데이터 세트를 이용한 전이학습을 이용하여 학습의 정확도와 속도를 높였다. 본 발명의 일 실시예는 아래에 설명하는 것과 같이 2단계 의 전이학습 과정을 수행한 후, 실험실 레벨에서 획득한 거대방향족 분자에 대하여 학습을 진행하여 예측모델을 완성하였다. B. 전이학습 절차 제1 모델의 학습단계 제1 모델의 학습은, 다수의 2차원 분자구조와 소정의 분자특성을 라벨 데이터로 가지는 데이터세트로 상술한 본 발명의 인공신경망을 학습한다. 일예로, PubChemQC 데이터 380만여 종의 D1={G1, y1^}를 제1 학습데이터로 하여, 상술한 본 발명의 신경망을 학 습한다. 이 때, G1은 PubChemQC 데이터에 포함된 380만여 종의 분자의 그래프 데이터이며, y1^는 PubChemQC에 포함된 각 분자에 대한 HOMO-LUMO energy gap의 라벨 값이다. 제1 모델의 학습과정은 상기 PubChemQC 데이터 380만여 종의 분자구조를 그래프 정보화하여 상기 G1을 획득하는 데이터 전처리 과정을 포함한다. 제1 모델의 학습과정에서, 본 발명의 상기 본 발명의 신경망을 구성하는 임베딩 블럭, 메시지 패싱 블럭 , 리드아웃 블럭의 각 신경망의 파라미터들이 최적화되며, 이들 파라미터 세트를 P1 이라 한다. 비록, 케미컬 쉬프트값이 라벨로 주어지지 않았지만, 대량 데이터를 보유한 PubChemQC 데이터세트를 학습데이터 로 하여 본 발명의 신경망을 학습함으로써, 이후, 단계에서의 학습의 정확도를 높이고, 학습에 소요되는 시간을 줄일 수 있다. 제2 모델의 학습단계 제2 모델은 상기 제1 모델의 학습과정에서 학습된 파라미터 세트 P1 중 임베딩 블럭, 메시지 패싱 블럭 의 파리미터 세트를 이용하고, 추가로 제2 학습데이터를 이용하여 상술한 본 발명의 신경망을 학습한다. 제2 학습데이터는 라벨값으로 케미컬 쉬프트 값을 가지는 데이터 세트를 사용한다. 일예로, 제2 학습데이터로 NMRShiftDB2 데이터 13000여 종을 사용할 수 있다. 제2 학습데이터는 D2={G2, y2^} 로 구성되며, G2는 NMRShiftDB2 데이터 13000 종의 분자구조 그래프, y2^는 각 분자의 케미컬 쉬프트 값이다. 상기 제2 학습데이터로 상술한 본 발명의 인공신경망을 학습하되, 앞서 제1 모델의 학습단계에서 획득한 파라미 터 세트 P1에서 리드아웃 블럭ⓒ의 파라미터들만을 제외하고, 제2 모델의 학습에 적용하여 모델을 전이한다. 제2 모델의 학습을 통하여, 상기 본 발명의 신경망을 구성하는 임베딩 블럭, 메시지 패싱 블럭, 리드 아웃 블럭의 각 신경망의 파라미터들이 최적화되며, 이들 파라미터 세트를 P2라 한다. C. 방향족 분자의 학습 상술한 제2 모델의 학습과정에서 최적화된 본 발명의 신경망의 파라미터 세트 P2를 전이하고, 자체 수집한 OLED 분자 데이터 150여종의 데이터를 제3 학습데이터로 하여 상술한 본 발명의 인공신경망을 학습한다. 학습데이터 세트는 D={G, y^} 로 구성되며, G는 상기 OLED 분자 데이터 150여 종의 분자구조를 그래프정보화한 그래프 정보이며, y^는 각 분자의 케미컬 쉬프트 값이다. 이와 같은 학습데이터 세트 D로 상술한 본 발명의 인 공신경망을 학습하여, 상기 본 발명의 신경망을 구성하는 임베딩 블럭, 메시지 패싱 블럭, 리드아웃 블럭의 각 신경망의 파라미터들의 최적화된 파라미터 세트 P를 획득한다. 4. 본 발명에 따른 케미컬 쉬프트 예측방법 3차원 분자 그래프 데이터 획득단계 케미컬 쉬프트를 예측하고자 하는 대상물질의 분자구조의 그래프 데이터를 획득하고, 앞서 설명한 방식으로 데 이터를 전처리하여 분자구조를 그래프 데이터로 표현한 그래프 데이터를 획득한다. 본 발명의 그래프 데이터 획 득절차는 방향족 분자의 분자구조를 그래프 데이터로 표현한 분자구조 그래프 데이터를 획득한다. 본 발명의 데이터 전처리 단계는 종래의 분자구조를 그래프 데이터화하는 것에 더하여, 앞서 설명한 것과 같이 글로벌 에지, 정션 노드, 정션 에지 벡터를 추가로 획득하는 것을 특징으로 한다. 즉, 데이터 전처리 결과로 획득되는 대상물질의 그래프 데이터 G는 노드피쳐벡터 Va, 로컬 에지벡터 El, 글로벌 에지벡터 Eg, 정션노드 피쳐 벡터 Vj, 정션에지벡터 Ej를 포함한다. 학습된 신경망 모델의 신경망 연산단계 상기 데이터 전처리 단계에서 획득한, 케미컬 쉬프트를 예측하고자 하는 대상물질의 3차원 그래프 데이터를 앞 서 설명한 본 발명의 인공신경망 학습방법에 따라 학습된 신경망 모델에 입력한다. 상기 신경망 모델은 앞서 도 3을 들어 설명한 것처럼 임베딩 블럭, 메시지 패싱 블럭, 리드아웃 블럭 을 포함하여 구성되며, 메시지 패싱 블럭은 로컬 메시지 패싱 레이어에 더하여 글로벌 메시지 패 싱 레이어, 다이렉트 멀티-홉 어텐션 레이어, 정션 메시지 패싱 레이어를 포함하는 것을 특징으로 하며, 멀티-홉 어텐션 레이어는 선택적으로 포함되거나 배제될 수 있다. 또한 본 발명의 상기 신경망 모델은, 가장 많은 라벨값을 가지는 데이터 세트 D1에 대하여 1차 학습되고, 그 학 습결과로 상기 데이터 세트 D1에 대하여 최적화된 파라미터 세트 P1이 획득되는 것이다. 또한 본 발명의 상기 신경망 모델은 상기 파라미터 세트 P1을 적용하고, 상기 데이터 세트 D1과 다른 데이터 세 트 D2를 이용하여 2차 학습되고, 데이터 세트 D2에 대하여 최적화된 파라미터 세트 P2가 획득되는 것이다. 이때, 상기 데이터 세트 D1은 데이터 세트 D2 보다 많은 수의 데이터 수를 가진다. 또한 데이터 세트 D1은 대상 분자의 케미컬 쉬프트 값이 아닌 분자속성 중 소정의 다른 값을 라벨값으로 가지는 것일 수 있으며, 이 경우, 파라미터 세트 P2를 획득하기 위한 학습절차에서 파라미터 세트 P1을 모두 적용하지 않고, 임베딩 블럭, 메시지 패싱 블럭의 파리미터 세트만을 적용한다. D2는 케미컬 쉬프트 값을 라벨값으로 가지는 데이터 세 트이며, 후술하는 데이터 세트 D를 구성하는 분자들보다 작은 크기를 가지는 분자들이다. 예를 들어, 본 발명의 일실시예로서, D1={G1, y1^}에서, G1은 PubChemQC 데이터에 포함된 380만여 종의 분자의 그래프 데이터이며, 라벨값 y1^는 PubChem에 등록된 각 분자에 대하여 계산화학적 방법으로 구한 에너지 레벨 데이터인 HOMO-LUMO energy gap 데이터인 데이터세트를 제1 데이터 세트 D1으로 사용하였고, D2로는 NMRShiftDB2 1H-NMR 데이터 13,000여 종을 사용하였다. 이때, D2={G2, y2^}에서, G2는 NMRShiftDB2 1H-NMR 데 이터 13,000 종의 분자에 대하여 각 원자에 번호가 매겨진 분자구조 전처리한 분자구조 그래프, 라벨값 y2^로는 상기 DB에 저장된 각각의 수소원자에 대응하는 1H-NMR 케미컬 쉬프트 실험 측정값을 적용하였다. 본 발명의 상기 신경망 모델은, 상기 파라미터 세트 P2 적용하고, 방향족 분자 데이터 세트를 데이터 세트로 하 여 학습된 것이다. 일 실시예로, 방향족 분자 데이터 세트 학습데이터 세트 D={G, y^}에서, G는 OLED 분자 데이 터 150여 종의 분자구조를 그래프정보화한 그래프 정보이며, y^는 각 분자의 케미컬 쉬프트 값을 라벨값으로 사 용하여 학습하였다. 데이터 세트 D는 D2보다 그 수가 적을 수 있다. 데이터 세트 D의 일 실시예로, 본 발명은 평균 분자량 800amu, 평균 수소수 35개, 평균 방향족 고리 개수 10개인 방향족 고분자량 분자의 각 원자에 번호 가 매겨진 분자구조를 전처리한 그래프 정보를 G로, 각각의 수소 원자에 대응하는 1H-NMR 케미컬 쉬프트의 실험 측정값을 라벨값 y^ 로 사용하였다. 본 발명의 신경망 모델은 최종적으로 상기 데이터 세트 D로 학습을 진행하여, 본 발명의 신경망을 구성하는 임 베딩 블럭, 메시지 패싱 블럭, 리드아웃 블럭의 각 신경망의 파라미터들의 최적화된 파라미터 세트 P를 획득한 것이다. 케미컬 쉬프트 예측값 산출단계 상기 학습된 본 발명의 인공신경망 모델의 출력값 y^를, 입력된 분자구조를 구성하는 각 수소 원자에 대응하는 케미컬 쉬프트 값으로 산출하는 단계이다. 5. 본 발명에 따른 케미컬 쉬프트 예측 시스템 본 발명은 상술한 인공신경망 모델이 기록된 기록매체를 포함하며, 상기 기록매체를 구비하는 케미컬 쉬프트 예 측 시스템을 제공한다. 또한 본 발명의 케미컬 쉬프트 예측 시스템은 상기 인공신경망 모델의 전체 또는 일부를 읽어들여 신경망연산을 수행하는 프로세서를 포함한다. 상술한 본 발명의 인공신경망 모델을 읽어들여 인공신경망 연산을 수행하는 프로세서 및 상술한 인공신경망 모 델이 기록된 기록매체를 포함하는 컴퓨터 장치 또는 상기 프로세서를 포함하는 케미컬 쉬프트 예측 시스템을 구 성하는 방식은 통상의 기술자에게 자명하여 여기에서 상세한 설명을 생략하지만, 본 발명의 권리범위는, 상기 본 발명의 인공신경망 또는 그 인공신경망을 학습시키는 방법, 그 방법에 의해 학습된 인공신경망 모델을 포함 하는 이상, 상기 기록매체 또는 프로세서 또는 상기 기록매체 또는 프로세서를 포함하는 컴퓨터 장치 또는 케미 컬 쉬프트 예측 시스템을 그 권리범위에서 배재하지 않는다."}
{"patent_id": "10-2023-0015665", "section": "도면", "subsection": "도면설명", "item": 1, "content": "본 명세서에 첨부되는 다음의 도면들은 본 발명의 바람직한 실시예를 예시하는 것이며, 전술된 발명의 상세한 설명과 함께 본 발명의 기술사상을 더욱 이해시키는 역할을 하는 것이므로, 본 발명은 그러한 도면에 기재된 사 항에만 한정되어 해석되지 않아야 한다. 도 1은 본 발명에 따른 분자구조의 그래픽적 표현을 설명하는 도면이다. 도 2는 도 1의 'A' 영역에 대하여, 로컬 메시지 패싱, 글로벌 메시지 패싱, 정션 메시지 패싱, 다이렉트 멀티홉 어텐션의 개념을 각각 보이는 도면이다. 도 3은 본 발명에 따른 화학적 이동값 예측을 위한 인공신경망의 구조를 보이는 블럭도이다. 도 4는 본 발명의 전이학습 과정을 보이는 블럭도이다."}
