{"patent_id": "10-2022-0071767", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2023-0171325", "출원번호": "10-2022-0071767", "발명의 명칭": "약한 지도학습 기반의 행동 완성도 학습방법", "출원인": "연세대학교 산학협력단", "발명자": "변혜란"}}
{"patent_id": "10-2022-0071767", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "행동 프레임 검출 모델을 이용하여 행동 프레임을 검출하는 방법에 있어서,동영상 데이터를 입력받는 단계;상기 동영상 데이터의 특징을 추출하는 단계;상기 동영상 데이터의 특징을 이용하여 포인트 레이블 모델에 입력하여 1차 행동 프레임을 검출하는 단계;상기 1차 행동 프레임의 세그먼트 레벨의 행동 클래스 스코어 및 세그먼트 레벨의 배경스코어에 기초한 최종스코어를 도출하는 단계;상기 최종 스코어와 포인트 레이블을 이용하여 최적 시퀀스를 탐색하는 단계;상기 최적 시퀀스를 일종의 유사 레이블 (pseudo label)로 이용하여 스코어 대조 손실값 (score contrastiveloss) 및 특징 대조 손실값 (feature contrastive loss)을 계산하는 단계 및상기 스코어 대조 손실값 및 특징 대조 손실값 각각에 가중치를 부여하여 손실함수를 최적화함으로써 상기 행동프레임 검출 모델을 업데이트하는 단계를 포함하는,행동 프레임 검출 방법."}
{"patent_id": "10-2022-0071767", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제 1항에 있어서,상기 최종 스코어와 포인트 레이블을 이용하여 최적 시퀀스를 탐색하는 단계는, 행동 및 유사 배경 지점(action and pseudo background points)과 일치하는 모든 가능한 시퀀스 후보를 도출하는 단계 및 도출된 후보 중 모델에 완전성을 제공할 수 있는 최적의 시퀀스를 검출하는 단계를 포함하는,행동 프레임 검출 방법."}
{"patent_id": "10-2022-0071767", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제 2항에 있어서,시퀀스 후보를 도출하는 단계는, 상기 외부-내부-대비 알고리즘을 이용하여 도출한 행동 완전성 스코어가 기 설정된 값보다 큰 경우 완전한 행동인스턴스라고 판단하는 단계를 포함하는,행동 프레임 검출 방법."}
{"patent_id": "10-2022-0071767", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제 1항에 있어서,상기 스코어 대조 손실값(score contrastive loss)은 인공지능모델이 행동 및 배경 인스턴스를 분리하기 위한값을 의미하고,상기 최적 시퀀스를 일종의 유사 레이블 (pseudo label)로 이용하여 스코어 대조 손실값 (score contrastiveloss)을 계산하는 단계는,상기 스코어 대조 손실값을 이용하여 행동 인스턴스에 상응하는 특징이 검출된 구역을 추출하는 단계를 포함하는,공개특허 10-2023-0171325-3-행동 프레임 검출 방법."}
{"patent_id": "10-2022-0071767", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제 1항에 있어서,상기 특징 대조 손실값 (feature contrastive loss)을 계산하는 단계는,특징 대조 손실값은 같은 행동을 포함하는 프레임들의 특징들이 서로 비슷해지도록 유도하는 단계를 포함하는,행동 프레임 검출 방법."}
{"patent_id": "10-2022-0071767", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "컴퓨터 판독가능 저장 매체에 저장되어 컴퓨터로 하여금 이하의 동작들을 수행하도록 하는 명령들을 포함하는컴퓨터 프로그램으로서, 상기 동작들은;동영상 데이터를 입력받는 동작;상기 동영상 데이터의 특징을 추출하는 동작;상기 동영상 데이터의 특징을 이용하여 포인트 레이블 모델에 입력하여 1차 행동 프레임을 검출하는 동작;상기 1차 행동 프레임의 세그먼트 레벨의 행동 클래스 스코어 및 세그먼트 레벨의 배경스코어에 기초한 최종스코어를 도출하는 동작;상기 최종 스코어와 포인트 레이블을 이용하여 최적 시퀀스를 탐색하는 동작;상기 최적 시퀀스를 일종의 유사 레이블 (pseudo label)로 이용하여 스코어 대조 손실값 (score contrastiveloss) 및 특징 대조 손실값 (feature contrastive loss)을 계산하는 동작 및상기 스코어 대조 손실값 및 특징 대조 손실값 각각에 가중치를 부여하여 손실함수를 최적화함으로써 상기 행동프레임 검출 모델을 업데이트하는 동작을 포함하는, 컴퓨터 판독가능 저장 매체에 저장된 컴퓨터 프로그램."}
{"patent_id": "10-2022-0071767", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제 6항에 있어서,상기 최종 스코어와 포인트 레이블을 이용하여 최적 시퀀스를 탐색하는 동작은, 행동 및 유사 배경 지점(action and pseudo background points)과 일치하는 모든 가능한 시퀀스 후보를 도출하는 동작 및 도출된 후보 중 모델에 완전성을 제공할 수 있는 최적의 시퀀스를 검출하는 동작을 포함하는,컴퓨터 판독가능 저장 매체에 저장된 컴퓨터 프로그램."}
{"patent_id": "10-2022-0071767", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제 7항에 있어서,시퀀스 후보를 도출하는 동작은, 상기 외부-내부-대비 알고리즘을 이용하여 도출한 행동 완전성 스코어가 기 설정된 값보다 큰 경우 완전한 행동인스턴스라고 판단하는 동작을 포함하는,컴퓨터 판독가능 저장 매체에 저장된 컴퓨터 프로그램."}
{"patent_id": "10-2022-0071767", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제 6항에 있어서,상기 스코어 대조 손실값(score contrastive loss)은 인공지능모델이 행동 및 배경 인스턴스를 분리하기 위한값을 의미하고,상기 최적 시퀀스를 일종의 유사 레이블 (pseudo label)로 이용하여 스코어 대조 손실값 (score contrastive공개특허 10-2023-0171325-4-loss)을 계산하는 동작은,상기 스코어 대조 손실값을 이용하여 행동 인스턴스에 상응하는 특징이 검출된 구역을 추출하는 동작을 포함하는,컴퓨터 판독가능 저장 매체에 저장된 컴퓨터 프로그램."}
{"patent_id": "10-2022-0071767", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제 6항에 있어서,상기 특징 대조 손실값 (feature contrastive loss)을 계산하는 동작은,특징 대조 손실값은 같은 행동을 포함하는 프레임들의 특징들이 서로 비슷해지도록 유도하는 동작을 포함하는,컴퓨터 판독가능 저장 매체에 저장된 컴퓨터 프로그램."}
{"patent_id": "10-2022-0071767", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명의 실시 예는 행동 프레임 검출 모델을 이용하여 행동 프레임을 검출하는 방법에 있어서, 동영상 데이터 를 입력받는 단계, 상기 동영상 데이터의 특징을 추출하는 단계, 상기 동영상 데이터의 특징을 이용하여 포인트 레이블 모델에 입력하여 1차 행동 프레임을 검출하는 단계, 상기 1차 행동 프레임의 세그먼트 레벨의 행동 클래 스 스코어 및 세그먼트 레벨의 배경스코어에 기초한 최종스코어를 도출하는 단계, 상기 최종 스코어와 포인트 레 이블을 이용하여 최적 시퀀스를 탐색하는 단계, 상기 최적 시퀀스를 일종의 유사 레이블 (pseudo label)로 이용 하여 스코어 대조 손실값 (score contrastive loss) 및 특징 대조 손실값 (feature contrastive loss)을 계산하 는 단계 및 상기 스코어 대조 손실값 및 특징 대조 손실값 각각에 가중치를 부여하여 손실함수를 최적화함으로써 상기 행동 프레임 검출 모델을 업데이트하는 단계를 포함하는 행동 프레임 검출 방법을 개시한다."}
{"patent_id": "10-2022-0071767", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 약한 지도학습을 이용하여 비 정제 비디오 내에서 행동 프레임을 검출하는 방법에 관한 것이다."}
{"patent_id": "10-2022-0071767", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "행동 프레임 검출의 목표는 행동 인스턴스의 시작 및 종료 타임스탬프를 찾고 분류하는 데 있다. 종래에 동영상에서 사용자 행동 프레임 검출방법은 우선 입력된 동영상을 일정 단위의 세그먼트로 째간 후, 각 세그먼트를 특징 추출기에 넣음으로써 특징을 추출하고, 추출된 특징 벡터를 콘볼루션 네트워크를 이용하여 세 그먼트 레벵레서의 클래스 스코어 및 배경스코어를 예측하고 추후 정답 레이블과 비교를 통하여 사용자 행동 프 레임을 검출하였다. 즉, 기존 방법들은 주어진 단일 프레임 레이블을 이용해서 단순히 해당 단일 프레임에서만 분류 손실 함수를 계 산하는 방식으로 모델을 학습하였다. 하지만 이와 같은 방법으로 학습된 모델은 완전한 행동이 아닌 일부 행동만 검출하는 문제가 발생하였다. 구체 적인 예시로, 용상 (Clean and Jerk)의 경우, 역기를 바닥에서 어깨높이로 들어올리는 동작, 어깨에서 머리 위로 들어올리는 동작 등 여러 개의 부분동작으로 구성되어 있는데, 해당 모델들은 그 중에서 일부 동작만 을 예측하게 되는 등의 문제가 존재하였다."}
{"patent_id": "10-2022-0071767", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은 비 정제 비디오 내에서 행동 프레임을 정확하게 검출하기 위함이다. 더욱 구체적으로 행동 프레임을 검출하기 위한 인공지능모델의 학습시, 약한 지도학습을 이용하여 단일 프레임 단위의 행동 클래스를 정답 레이 블로 사용하기 위함이다."}
{"patent_id": "10-2022-0071767", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명의 실시 예에 따른 행동 프레임 검출 모델을 이용하여 행동 프레임을 검출하는 방법에 있어서, 동영상 데이터를 입력받는 단계, 상기 동영상 데이터의 특징을 추출하는 단계, 상기 동영상 데이터의 특징을 이용하여 포인트 레이블 모델에 입력하여 1차 행동 프레임을 검출하는 단계, 상기 1차 행동 프레임의 세그먼트 레벨의 행 동 클래스 스코어 및 세그먼트 레벨의 배경스코어에 기초한 최종스코어를 도출하는 단계, 상기 최종 스코어와 포인트 레이블을 이용하여 최적 시퀀스를 탐색하는 단계, 상기 최적 시퀀스를 일종의 유사 레이블 (pseudo label)로 이용하여 스코어 대조 손실값 (score contrastive loss) 및 특징 대조 손실값 (feature contrastive loss)을 계산하는 단계 및 상기 스코어 대조 손실값 및 특징 대조 손실값 각각에 가중치를 부여하여 손실함수를 최적화함으로써 상기 행동 프레임 검출 모델을 업데이트하는 단계를 포함하는 행동 프레임 검출 방법이 개시된 다.상기 최종 스코어와 포인트 레이블을 이용하여 최적 시퀀스를 탐색하는 단계는, 행동 및 유사 배경 지점(action and pseudo background points)과 일치하는 모든 가능한 시퀀스 후보를 도출하는 단계 및 도출된 후보 중 모델 에 완전성을 제공할 수 있는 최적의 시퀀스를 검출하는 단계를 포함할 수 있다. 또한, 시퀀스 후보를 도출하는 단계는, 상기 외부-내부-대비 알고리즘을 이용하여 도출한 행동 완전성 스코어가 기 설정된 값보다 큰 경우 완전한 행동 인스턴스라고 판단하는 단계를 포함할 수 있다. 또한, 상기 스코어 대조 손실값(score contrastive loss)은 인공지능모델이 행동 및 배경 인스턴스를 분리하기 위한 값을 의미하고, 상기 최적 시퀀스를 일종의 유사 레이블 (pseudo label)로 이용하여 스코어 대조 손실값 (score contrastive loss)을 계산하는 단계는, 상기 스코어 대조 손실값을 이용하여 행동 인스턴스에 상응하는 특징이 검출된 구역을 추출하는 단계를 포함할 수 있다. 또한, 상기 특징 대조 손실값 (feature contrastive loss)을 계산하는 단계는, 특징 대조 손실값은 같은 행동을 포함하는 프레임들의 특징들이 서로 비슷해지도록 유도하는 단계를 포함할 수 있다. 또한 컴퓨터 판독가능 저장 매체에 저장되어 컴퓨터로 하여금 이하의 동작들을 수행하도록 하는 명령들을 포함 하는 컴퓨터 프로그램으로서, 상기 동작들은, 동영상 데이터를 입력받는 동작, 상기 동영상 데이터의 특징을 추 출하는 동작, 상기 동영상 데이터의 특징을 이용하여 포인트 레이블 모델에 입력하여 1차 행동 프레임을 검출하 는 동작, 상기 1차 행동 프레임의 세그먼트 레벨의 행동 클래스 스코어 및 세그먼트 레벨의 배경스코어에 기초 한 최종스코어를 도출하는 동작, 상기 최종 스코어와 포인트 레이블을 이용하여 최적 시퀀스를 탐색하는 동작, 상기 최적 시퀀스를 일종의 유사 레이블 (pseudo label)로 이용하여 스코어 대조 손실값 (score contrastive loss) 및 특징 대조 손실값 (feature contrastive loss)을 계산하는 동작 및 상기 스코어 대조 손실값 및 특징 대조 손실값 각각에 가중치를 부여하여 손실함수를 최적화함으로써 상기 행동 프레임 검출 모델을 업데이트하는 동작을 포함하는 컴퓨터 판독가능 저장 매체에 저장된 컴퓨터 프로그램을 포함할 수 있다. 상기 프로그램은 행 동 프레임 검출 프로그램에 해당하며 앞서 언급한 방법들을 모두 포함할 수 있다."}
{"patent_id": "10-2022-0071767", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명은 행동 프레임을 검출하기 위한 인공지능모델의 학습시, 약한 지도학습을 이용하여 단일 프레임 단위의 행동 클래스를 정답 레이블로 사용하여 행동의 완전성 (Action completeness)를 학습하므로, 기존 기술들에 비 해 보다 정확하게 행동 프레임을 검출 할 수 있다."}
{"patent_id": "10-2022-0071767", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하, 첨부된 도면을 참조하여 본 명세서에 개시된 실시 예를 상세히 설명하되, 도면 부호에 관계없이 동일하거 나 유사한 구성요소는 동일한 참조 번호를 부여하고 이에 대한 중복되는 설명은 생략하기로 한다. 이하의 설명 에서 사용되는 구성요소에 대한 접미사 '모듈' 및 '부'는 명세서 작성의 용이함만이 고려되어 부여되거나 혼용 되는 것으로서, 그 자체로 서로 구별되는 의미 또는 역할을 갖는 것은 아니다. 또한, 본 명세서에 개시된 실시 예를 설명함에 있어서 관련된 공지 기술에 대한 구체적인 설명이 본 명세서에 개시된 실시 예의 요지를 흐릴 수 있다고 판단되는 경우 그 상세한 설명을 생략한다. 또한, 첨부된 도면은 본 명세서에 개시된 실시 예를 쉽게 이 해할 수 있도록 하기 위한 것일 뿐, 첨부된 도면에 의해 본 명세서에 개시된 기술적 사상이 제한되지 않으며, 본 발명의 사상 및 기술 범위에 포함되는 모든 변경, 균등물 내지 대체물을 포함하는 것으로 이해되어야 한다. 제1, 제2 등과 같이 서수를 포함하는 용어는 다양한 구성요소들을 설명하는데 사용될 수 있지만, 상기 구성요소 들은 상기 용어들에 의해 한정되지는 않는다. 상기 용어들은 하나의 구성요소를 다른 구성요소로부터 구별하는 목적으로만 사용된다. 어떤 구성요소가 다른 구성요소에 '연결되어' 있다거나 '접속되어' 있다고 언급된 때에는, 그 다른 구성요소에 직접적으로 연결되어 있거나 또는 접속되어 있을 수도 있지만, 중간에 다른 구성요소가 존재할 수도 있다고 이 해되어야 할 것이다. 반면에, 어떤 구성요소가 다른 구성요소에 '직접 연결되어' 있다거나 '직접 접속되어' 있다고 언급된 때에는, 중간에 다른 구성요소가 존재하지 않는 것으로 이해되어야 할 것이다. 본 개시에 나타난 각 구성부들은 서로 다른 특징적인 기능들을 나타내기 위해 독립적으로 도시한 것으로, 각 구 성부들이 분리된 하드웨어나 하나의 소프트웨어 구성단위로 이루어짐을 의미하지 않는다. 즉, 각 구성부는 설명 의 편의상 각각의 구성부로 나열하여 포함한 것으로 각 구성부 중 적어도 두 개의 구성부가 합쳐져 하나의 구성 부로 이루어지거나, 하나의 구성부가 복수개의 구성부로 나뉘어져 기능을 수행할 수 있고 이러한 각 구성부의 통합된 실시예 및 분리된 실시예도 본 발명의 본질에서 벗어나지 않는 한 본 발명의 권리범위에 포함된다. 또한, 일부의 구성 요소는 본 발명에서 본질적인 기능을 수행하는 필수적인 구성 요소는 아니고 단지 성능을 향 상시키기 위한 선택적 구성 요소일 수 있다. 본 발명은 단지 성능 향상을 위해 사용되는 구성 요소를 제외한 본 발명의 본질을 구현하는데 필수적인 구성부만을 포함하여 구현될 수 있고, 단지 성능 향상을 위해 사용되는 선 택적 구성 요소를 제외한 필수 구성 요소만을 포함한 구조도 본 발명의 권리범위에 포함된다. 도 1은 본 발명의 일 실시 예에 따른 모델을 도시한 도면이다. 도 1을 참고하면, 행동 프레임 검출을 위하여 입력된 영상으로부터 RGB 프레임과 옵티컬 플로우(optical flow) 프레임을 추출할 수 있다. 이후 추출된 프레임을 인공지능 모델에 입력하여 특징을 임베딩함으로써 세그먼트 레 벨에서의 행동 클래스 스코어와 세그먼트 레벨에서의 배경 스코어를 도출할 수 있다. 도출된 스코어를 혼합하여 최종 스코어를 도출할 수 있다. 예측된 최종 스코어와 포인트 레이블을 이용하여 최적 시퀀스(Optimal sequence)를 도출하여 행동 완전성을 학습할 수 있다. 이하 도 2에서 구체적으로 설명한다. 이하 본 발명이 실시하고자 하는 인공지능모델을 행동 프레임 검출 모델로 통칭하여 설명한다. 도 2는 본 발명의 일 실시 예에 따른 모델을 구체화하여 도시한 도면이다. 구체적으로 도 2는 본 발명의 실시 예에 따른 완전성 학습을 수행하는 프로세스를 나타내며, 최적의 시퀀스 검 색(Optimal sequence search) 이후, 행동스코어(action score) 및 특징 유사성(feature similarity)를 이용하 여 행동 완전성 학습을 수행하게 된다. 이하 구체적으로 설명한다. 본 발명의 일 실시 예에 따른 베이스 라인(Baseline, S201)은 일반적으로 사용되는 행동 프레임 검출을 위한 기 본 구성으로 구성된 인공지능 모델을 의미할 수 있다. 이하 베이스 라인(Baseline)에서 행동 프레임 검출 방법 에 대해 설명한다. 본 개시의 실시 예에 따른 행동 프레임 검출 방법에 있어서, 인공지능모델이 동영상 데이터를 입력받는 단계, 상기 동영상 데이터의 특징을 추출하는 단계를 포함할 수 있다. 이후, 입력으로 들어온 동영상으로부터 RGB 프 레임과 옵티컬 플로우(optical flow) 프레임을 추출할 수 있다. 예를들어, 동영상 데이터의 특징을 추출하기 위하여 추출된 프레임들을 특정 프레임 단위의 세그먼트로 쪼갠 후, 각 세그먼트를 특징 추출기에 넣음으로써 각 특정 차원의 RGB 특징과 옵티컬 플로우(optical flow)를 획득 하는 특징 추출(feature extraction)할 수 있다. 이때, 특정 프레임 단위 및 특정 차원은 실시예에 따라 다양하 게 설계될 수 있다. 이때, 옵티컬 플로우(Optical flow)는 이전 프레임과 현재 프레임의 차이를 이용하고 픽셀값과 주변 픽셀들과의 관계를 통해 각 픽셀의 이동(motion)을 계산하여 추출한 데이터를 의미할 수 있다. 추출된 특징은 단일 1D 컨볼루션을 거치며 임베디드된 특징(F)이 획득될 수 있으며, 행동 프레임 추출 모델은 얻어낸 RGB 특징과 optical flow 특징을 연결하여 제2 특정 차원의 특징 맵을 만들어 낸 후, 이것을 콘볼루션 네트워크의 입력으로 넣어줌으로써 특징을 임베딩(feature embedding)할 수 있다. 본 발명의 일 실시 예에 따르면, 특징 임베딩이 진행된 이후, 상기 동영상 데이터의 특징을 이용하여 포인트 레 이블 모델에 입력하여 행동 프레임을 검출하는 단계를 포함할 수 있다. 구체적으로 임베딩된 특징(F)을 다시 한 번 두 개의 콘볼루션 네트워크에 입력함으로써 각각 세그먼트 레벨에서 의 행동 클래스 스코어와 (segment-level action scores) 세그먼트 레벨에서의 배경 스코어 (segment-level background scores)를 예측할 수 있다. 행동 프레임 검출 모델은 상기 스코어들에 기초하여 최종 스코어를 (final scores) 도출할 수 있다. 행동 프레임 검출 모델은 이후, 이를 수집하여 비디오 레벨의 클래스 스코어를 생성한 후 정답 레이블과의 비교 를 통해 비디오 단위 분류 손실값 (video-level classification loss)을 계산할 수 있다. 또한 주어진 포인트레이블을 이용해서 포인트 단위 분류 손실값 (point-level classification loss)을 계산할 수 있다. 이때, 정 답 레이블은 동영상 전체의 행동에 대한 정답이 매핑된 것을 의미하여 포인트 레이블은 동영상에 포함된 특정 프레임에 대한 행동에 대한 정답이 매핑된 것을 의미할 수 있다. 이때, 비디오 단위 분류 손실값은 동일한 비디오의 모든 클립에 대한 교차 엔트로피 함수의 평균으로 계산될 수 있으며 비디오 전체에 대한 행동 특징을 최적화하기 위하여 상용될 수 있으며, 포인트 단위 분류 손실값은 특정 프레임에 대한 행동 특징을 최적화 하기 위하여 사용될 수 있다. 한편, 상기 방식대로 진행하게 되면, 단일 프레임에 레이블링된 데이터를사용하게 되므로, 레이블 희소성으로 인해 기존 작업은 작업 완전성을 학습하지 못하여 단편적인 작업 예측이 발생하는 문제가 추가로 존재한다. 이하 본 발명에서는 모델에 대한 완전성 지침을 제공하기 위해 조밀한 의사 레이블이 생성되는 새로운 프레임워 크를 개시한다. 도 2의 '완전성 학습(Completeness Learinign)'모델을 참고하면, 우선 Baseline 부분에서 예측된 최종 스코어(비디오 레벨의 클래스 스코어)와 포인트 레이블을 이용하여 최적 시퀀스를 탐색하는 단계를 포함할 수 있다(S203). 구체적으로 행동 및 유사 배경 지점(action and pseudo background points)과 일치하는 모든 가능한 시퀀스 후 보를 고려하여 그 중에서 모델에 완전성 지침을 제공할 수 있는 최적의 시퀀스를 검출할 수 있다. 이를 가능하게 하기 위해 우리는 외부-내부-대비(the outer-inner-contrast concept)알고리즘을 시퀀스의 완전 성 점수를 판단하기 위한 스코어를 도출할 수 있다. 본 발명의 일 실시 예에 따르면, 상기 외부-내부-대비 알고리즘은 검출된 시퀀스의 행동 완전성 점수를 판단하 기 위한 것으로 이하 개시된 종래 기술이 사용될 수 있다. 종래논문 : 'Zheng Shou, Hang Gao, Lei Zhang, Kazuyuki Miyazawa, and Shih-Fu Chang. Autoloc: Weakly- supervised temporal action localization in untrimmed videos. In ECCV, pages154-171, 2018.' 한편, 종래의 논문에서 상기 알고리즘은 매개변수 경계 회귀(parametric boundary regression)를 위하여 사용된"}
{"patent_id": "10-2022-0071767", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "것으로 본 발명의 행동 완전성 검출과는 기술분야에서 차이를 보임을 언급한다. 일반적으로 내부 점수(inner socre)와 외부 점수(outer score) 간의 대비(contrast)는 완전한 작업 인스턴스 (complete action instance)의 경우 클 수 있지만, 단편적인 작업 인스턴스(a fragmentary action instance)의 경우 작은 스코어를 가질 수 있다. 본 발명의 일 실시 예에 따른 방법은, 상기 외부-내부-대비 알고리즘을 이용하여 도출한 행동 완전성 스코어가 기 설정된 값보다 큰 경우 완전한 행동 인스턴스라고 판단할 수 있으며, 이는 행동 완전성 검출 모델이 행동 완 전성을 학습할 수 있는 최적의 시퀀스를 검색하기 위한 스코어링 기능으로 활용될 수 있다. 이하, 스코어링 기능을 자세히 설명하기 전에 후보 시퀀스를 도출하기 위한 방법을 설명한다. 본 발명의 일 실시 예에 따르면, 행동 프레임 검출 방법은 시간적 동작 지역화의 다중 레이블 특성(the multi- label nature of temporal action localization)을 가질 수 있다. 상기 특성을 가짐으로써 각 행동 클래스에 대한 클래스별 특정 시퀀스를 고려할 수 있다. 따라서 다른 행동 클 래스에 속하는 모든 세그먼트는 해당 행동 클래스의 시퀀스에 대한 배경으로 간주될 수 있다. 이때, 시퀀스는 다수 행동 및 배경 인스턴스로 정의될 수 있다. 다시말해서 시퀀스는 특정 인스턴스(행동 또는 배경)의 시작점과 끝점을 의미할 수 있다. 본 발명의 실시 예에 따르면, 행동검출모델은 입력 시퀀스가 입력되면 시퀀스에 포함된 개별 행동과 배경 인스 턴스의 대비 점수(contrast score)를 평균화하여 완성도 점수를 산출할 수 있다. 완성도 점수의 아래의 수학식 1과 같이 계산될 수 있다. 수학식 1"}
{"patent_id": "10-2022-0071767", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "는 클래스의 시퀀스를 의미한다. 는 시퀀스의 시작점, 은 시퀀스의 끝점, , 은 시퀀스의 시간적 길이, 는 상수, 는 익스턴스(행동 및 배경)의 총 개수. 상기 수학식 1을 통하여 최적 시퀀스를 도출할 수 있으며, 이 과정은 도 3에서 설명한다. 도 3은 본 발명의 실시 예에 따른 최적의 시퀀스를 도출하는 과정을 나타낸 것이다. 도 3을 참고하면, 행동 및 유사 배경 지점(action and pseudo background points)과 일치하는 모든 가능한 시 퀀스 후보를 고려하여, 그 중에서 모델에 완전성 지침을 제공할 수 있는 최적의 시퀀스를 검출할 수 있다. '수학식 1'을 통해 완전성 스코어를 평가함으로써 과소평가(a)와 과대평가(b) 구간을 도출하고 과소평가(a)구간 은 최적의 시퀀스에 포함시키고, 과대평가(b) 구간은 최적의 시퀀스에서 제거함으로써 최종 최적시퀀스를 도출 할 수 있다(S310). 본 발명은 상기 동작을 통해 획득한 최적의 시퀀스를 일종의 유사 레이블 (pseudo label)로 활용하여 스코어 대 조 손실값 (score contrastive loss)와 특징 대조 손실값(feature contrastive loss)을 산출하는 단계를 포함 할 수 있다(S205). 본 발명의 실시 예에 따르면, 스코어 대조 손실값은 예측된 최종 스코어와 유사 레이블이 일치하도록 매핑하고 특징 대조 손실값은 같은 행동을 포함하는 프레임들의 특징들이 서로 비슷해지도록 유도하는 단계를 포함할 수 있다(S207). 이때, 스코어 대조 손실값(score contrastive loss)은 인공지능모델이 행동 및 배경 인스턴스를 분리하기 위한 값을 의미할 수 있다. 인공지능모델은 스코어 대조 손실값을 이용하여 행동 인스턴스에 상응하는 특징이 검출된 구역을 추출할 수 있다(도 2의 (a)). 상기 스코어 대조 손실값은 아래의 수학식 2와 같이 산출될 수 있다. 수학식 2"}
{"patent_id": "10-2022-0071767", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "는 특정 클래스의 옵티멀 시퀀스 는 -square 이며 본 발명에서 = 2 또한 특징 대조 손실값(feature contrastive loss)은 서로 다른 클래스를 갖는 행동 인스턴스지만 동일한 동영 상에 포함된 경우, 다른 배경 인스턴스보다 서로 유사한 특징을 지닌다는 점을 이용한 것이다.(도 2의 (b)). 상기 특징 대조 손실값은 아래의 수학식 3과 같이 산출될 수 있다. 수학식 3"}
{"patent_id": "10-2022-0071767", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 5, "content": "는 클래스에 대한 부분 손실 은 시퀀스( )의 n번째 인스턴스에 대한 대표 특징 각 행동(또는 배경) 인스턴스에 대한 대표 특징을 추출하기 위하여, 각 입력 인스턴스를 균등하게 나누고, 나뉘 어진 입력 인스턴스를 특정 간격으로 각각의 단일 세그먼트가 무작위로 샘플링할 수 있다. 이후 샘플링된 세그 먼트의 포함된 특징을 평균화하여 시퀀스의 n번째 인스턴스에 대한 대표 특징을 생성할 수 있다. 정규화된 인스턴스 특성을 사용하여 특징 대조 손실값(feature contrastive loss)을 도출할 수 있다. 손실은 행 동수가 1보다 큰 클래스에 대해서만 계산될 수 있다. 즉 동영상에 두 개 이상의 행동 인스턴스가 존재하는 경우, 배경 인스턴스는 서로를 끌어들이지 않는 특징을 지니게 된다. 본 발명의 행동 프레임 검출 모델은 상기 스코어 대조 손실값 및 특징 대조 손실값에 각각 가중치를 부여하여 최종 손실함수를 도출하고, 상기 손실함수를 최적화하고 가중치를 업데이트 함으로써 행동의 완전성이 학습된 행동 프레임 검출 모델을 획득할 수 있다. 본 개시의 기술 분야에서 통상의 지식을 가진 자는 여기에 개시된 실시예들과 관련하여 설명된 다양한 예시적인 논리 블록들, 모듈들, 프로세서들, 수단들, 회로들 및 알고리즘 단계들이 전자 하드웨어, (편의를 위해, 여기에 서 소프트웨어로 지칭되는) 다양한 형태들의 프로그램 또는 설계 코드 또는 이들 모두의 결합에 의해 구현될 수 있다는 것을 이해할 것이다. 전술한 본 발명은, 프로그램이 기록된 매체에 컴퓨터가 읽을 수 있는 코드로서 구현하는 것이 가능하다. 컴퓨터 가 읽을 수 있는 매체는, 컴퓨터 시스템에 의하여 읽혀질 수 있는 데이터가 저장되는 모든 종류의 기록장치를 포함한다. 컴퓨터가 읽을 수 있는 매체의 예로는, HDD(Hard Disk Drive), SSD(Solid State Disk), SDD(Silicon Disk Drive), ROM, RAM, CD-ROM, 자기 테이프, 플로피 디스크, 광 데이터 저장 장치 등이 있다.도면 도면1 도면2 도면3"}
{"patent_id": "10-2022-0071767", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 일 실시 예에 따른 모델을 도시한 도면이다. 도 2는 본 발명의 일 실시 예에 따른 모델을 구체화하여 도시한 도면이다. 도 3은 본 발명의 일 실시 예에 따른 최적의 시퀀스를 도출하는 모델을 나타낸 도면이다."}
