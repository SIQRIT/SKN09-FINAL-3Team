{"patent_id": "10-2023-0092357", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2025-0012304", "출원번호": "10-2023-0092357", "발명의 명칭": "이미지 음영 및 대조 학습을 사용한 설명 가능한 인공지능", "출원인": "한양대학교 산학협력단", "발명자": "조인휘"}}
{"patent_id": "10-2023-0092357", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "설명 제공 시스템에 의해 수행되는 이미지 음영 및 대조 학습을 이용한 설명 제공 방법에 있어서,이미지 인식 모델을 통해 입력 이미지의 히트맵을 생성하는 단계; 상기 이미지 인식 모델을 통해 음영이 포함된 복수 개의 이미지의 히트맵을 생성하는 단계; 및 상기 생성된 입력 이미지의 히트맵과 상기 음영이 포함된 복수 개의 이미지의 히트맵에 대한 대조 학습을 수행함에 따라 획득된 비교 결과를 시각적으로 출력하는 단계 포함하는 이미지 음영 및 대조 학습을 이용한 설명 제공 방법."}
{"patent_id": "10-2023-0092357", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 입력 이미지의 히트맵과 상기 음영이 포함된 복수 개의 이미지의 히트맵은, CAM 또는 Grad-CAM을 이용하여생성된 것인, 이미지 음영 및 대조 학습을 이용한 설명 제공 방법."}
{"patent_id": "10-2023-0092357", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1항에 있어서,상기 입력 이미지의 히트맵을 생성하는 단계는, 이미지 배치에서 이미지 인식 모델에 입력하기 위한 입력 이미지를 선택하고, 상기 선택된 입력 이미지에서 이미지 인식 모델을 통해 교차 엔트로피 손실을 계산하는 단계를 포함하는 이미지 음영 및 대조 학습을 이용한 설명 제공 방법."}
{"patent_id": "10-2023-0092357", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제1항에 있어서,상기 입력 이미지의 히트맵을 생성하는 단계는, 상기 선택된 입력 이미지에 대해 이미지 인식 모델을 통해 입력 이미지의 클래스 활성화 맵을 생성하고, 상기생성된 입력 이미지의 클래스 활성화 맵에서 기 설정된 패치 크기의 그리드로 구분하여 이미지 음영을 위한 패치를 무작위로 추가하여 음영이 포함된 복수 개의 클래스 활성화 맵을 생성하는 단계를 포함하는 이미지 음영 및 대조 학습을 이용한 설명 제공 방법."}
{"patent_id": "10-2023-0092357", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제1항에 있어서, 상기 음영이 포함된 복수 개의 이미지의 히트맵을 생성하는 단계는,원본 이미지에서 기 설정된 패치 크기의 그리드로 구분하여 이미지 음영을 위한 패치를 생성하고, 상기 원본 이미지에 상기 생성된 패치를 무작위로 추가하여 음영이 포함된 복수 개의 이미지를 생성하는 단계 를 포함하는 이미지 음영 및 대조 학습을 이용한 설명 제공 방법."}
{"patent_id": "10-2023-0092357", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제1항에 있어서, 상기 시각적으로 출력하는 단계는,공개특허 10-2025-0012304-3-상기 생성된 입력 이미지의 히트맵에 패치가 추가되어 음영이 포함된 복수 개의 히트맵과 상기 음영이 포함된복수 개의 이미지의 히트맵에 대해 대조 학습을 수행함에 따라 일관성 손실을 계산하고, 상기 계산된 일관성 손실을 통해 비교 결과를 획득하는 단계를 포함하는 이미지 음영 및 대조 학습을 이용한 설명 제공 방법."}
{"patent_id": "10-2023-0092357", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제1항에 있어서, 상기 대조 학습은, 상기 입력 이미지의 히트맵과 상기 음영이 포함된 복수 개의 이미지의 히트맵 및 배치에 있는 다른 이미지의 히트맵과의 유사성 판단을 통해 일관성 손실이 계산되는 것을 특징으로 하는 이미지 음영 및 대조 학습을 이용한 설명 제공 방법."}
{"patent_id": "10-2023-0092357", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제1항 내지 제7항 중 어느 한 항의 이미지 음영 및 대조 학습을 이용한 설명 제공 방법을 상기 설명 제공 시스템에 실행시키기 위해 비-일시적인 컴퓨터 판독가능한 기록 매체에 저장되는 컴퓨터 프로그램."}
{"patent_id": "10-2023-0092357", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "설명 제공 시스템에 있어서,이미지 인식 모델을 통해 입력 이미지의 히트맵을 생성하는 제1 히트맵 생성부; 상기 이미지 인식 모델을 통해 음영이 포함된 복수 개의 이미지의 히트맵을 생성하는 제2 히트맵 생성부; 및 상기 생성된 입력 이미지의 히트맵과 상기 음영이 포함된 복수 개의 이미지의 히트맵에 대한 대조 학습을 수행함에 따라 획득된 비교 결과를 시각적으로 출력하는 시각적 설명부를 포함하는 설명 제공 시스템."}
{"patent_id": "10-2023-0092357", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제9항에 있어서,상기 입력 이미지의 히트맵과 상기 음영이 포함된 복수 개의 이미지의 히트맵은, CAM 또는 Grad-CAM을 이용하여생성된 것인, 설명 제공 시스템."}
{"patent_id": "10-2023-0092357", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "제9항에 있어서,상기 제1 히트맵 생성부는,이미지 배치에서 이미지 인식 모델에 입력하기 위한 입력 이미지를 선택하고, 상기 선택된 입력 이미지에서 이미지 인식 모델을 통해 교차 엔트로피 손실을 계산하는 것을 특징으로 하는 설명 제공 시스템."}
{"patent_id": "10-2023-0092357", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제9항에 있어서,상기 제1 히트맵 생성부는,상기 선택된 입력 이미지에 대해 이미지 인식 모델을 통해 입력 이미지의 클래스 활성화 맵을 생성하고, 상기생성된 입력 이미지의 클래스 활성화 맵에서 기 설정된 패치 크기의 그리드에 이미지 음영을 위한 패치를 무작위로 추가하여 음영이 포함된 복수 개의 클래스 활성화 맵을 생성하는 것을 특징으로 하는 설명 제공 시스템.공개특허 10-2025-0012304-4-청구항 13 제9항에 있어서, 상기 제2 히트맵 생성부는,원본 이미지에서 기 설정된 패치 크기의 그리드로 구분하여 이미지 음영을 위한 패치를 생성하고, 상기 원본 이미지에 상기 생성된 패치를 무작위로 추가하여 음영이 포함된 복수 개의 이미지를 생성하는 것을 특징으로 하는 설명 제공 시스템."}
{"patent_id": "10-2023-0092357", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_14", "content": "제9항에 있어서, 상기 시각적 설명부는,상기 생성된 입력 이미지의 히트맵에 패치가 추가되어 음영이 포함된 복수 개의 히트맵과 상기 음영이 포함된복수 개의 이미지의 히트맵에 대해 대조 학습을 수행함에 따라 일관성 손실을 계산하고, 상기 계산된 일관성 손실을 통해 비교 결과를 획득하는 것을 특징으로 하는 설명 제공 시스템."}
{"patent_id": "10-2023-0092357", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_15", "content": "제9항에 있어서, 상기 대조 학습은, 상기 입력 이미지의 히트맵과 상기 음영이 포함된 복수 개의 이미지의 히트맵 및 배치에 있는 다른 이미지의 히트맵과의 유사성 판단을 통해 일관성 손실이 계산되는 것을 특징으로 하는 설명 제공 시스템."}
{"patent_id": "10-2023-0092357", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "설명 제공 시스템에 의해 수행되는 이미지 음영 및 대조 학습을 이용한 설명 제공 방법은, 이미지 인식 모델을 통해 입력 이미지의 히트맵을 생성하는 단계; 상기 이미지 인식 모델을 통해 음영이 포함된 복수 개의 이미지의 히트맵을 생성하는 단계; 및 상기 생성된 입력 이미지의 히트맵과 상기 음영이 포함된 복수 개의 이미지의 히트 맵에 대한 대조 학습을 수행함에 따라 획득된 비교 결과를 시각적으로 출력하는 단계를 포함할 수 있다."}
{"patent_id": "10-2023-0092357", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "아래의 설명은 설명 가능한 인공지능 기술에 관한 것이다."}
{"patent_id": "10-2023-0092357", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "현재 인공지능 기술은 이미지 분류, 물체 감지 등 다양한 컴퓨터 비전 작업에서 인간 수준에 가까운 성능을 보 여주며 성공적으로 적용되었다. 현재 사용되는 모델은 정확성 측면에서 뛰어난 성능을 가지고 있지만, 적절한 설명을 제공하지 않고 블랙박스(Black-Box) 역할을 하고 있다. 따라서 블랙박스 모델을 투명하고 해석할 수 있 게 만드는 것도 인공지능 분야에서 중요한 연구이다. 모델을 투명하고 해석할 수 있게 만드는 기법을 설명 가능한 인공지능 기술(Explainable artificial intelligence; XAI) 기술이라고 한다. XAI 기술은 사용자가 모델이 좋은 결정을 하고 있다고 믿도록 함으로써 모델의 신뢰성을 높이도록 한다. 그리고 블랙박스 모델 내부를 시각화 할 수 있도록 모델의 성능을 개선할 수 있을 뿐만 아니라, 훈련되지 않은 일반인도 '강한' 모델과 '약한' 모델을 구분할 수 있다. 최근에는 딥러닝의 CNN(Convolutional Neural Networks) 기반의 객체 검출 및 분류 방법들이 많이 활용되고 있 다. 이에, CNN 기반의 이미지 분류 작업에서 시각적 설명을 제공하기 위한 기술이 제안될 필요가 있다."}
{"patent_id": "10-2023-0092357", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 2, "content": "발명의 내용"}
{"patent_id": "10-2023-0092357", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "이미지 음영 및 대조 학습을 사용하여 설명 가능한 인공지능 기술을 제공할 수 있다. 이미지 인식 모델에서 생성된 히트맵을 대조 학습(contrastive learning)을 통해 최적화하는 방법 및 시스템을 제공할 수 있다."}
{"patent_id": "10-2023-0092357", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "설명 제공 시스템에 의해 수행되는 이미지 음영 및 대조 학습을 이용한 설명 제공 방법은, 이미지 인식 모델을 통해 입력 이미지의 히트맵을 생성하는 단계; 상기 이미지 인식 모델을 통해 음영이 포함된 복수 개의 이미지의 히트맵을 생성하는 단계; 및 상기 생성된 입력 이미지의 히트맵과 상기 음영이 포함된 복수 개의 이미지의 히트 맵에 대한 대조 학습을 수행함에 따라 획득된 비교 결과를 시각적으로 출력하는 단계를 포함할 수 있다. 상기 입력 이미지의 히트맵과 상기 음영이 포함된 복수 개의 이미지의 히트맵은, CAM 또는 Grad-CAM을 이용하여 생성된 것일 수 있다. 상기 입력 이미지의 히트맵을 생성하는 단계는, 이미지 배치에서 이미지 인식 모델에 입력하기 위한 입력 이미 지를 선택하고, 상기 선택된 입력 이미지에서 이미지 인식 모델을 통해 교차 엔트로피 손실을 계산하는 단계를 포함할 수 있다. 상기 입력 이미지의 히트맵을 생성하는 단계는, 상기 선택된 입력 이미지에 대해 이미지 인식 모델을 통해 입력 이미지의 클래스 활성화 맵을 생성하고, 상기 생성된 입력 이미지의 클래스 활성화 맵에서 기 설정된 패치 크기 의 그리드에 이미지 음영을 위한 패치를 무작위로 추가하여 음영이 포함된 복수 개의 클래스 활성화 맵을 생성 하는 단계를 포함할 수 있다. 상기 음영이 포함된 복수 개의 이미지의 히트맵을 생성하는 단계는, 원본 이미지에서 기 설정된 패치 크기의 그 리드로 구분하여 이미지 음영을 위한 패치를 생성하고, 상기 원본 이미지에 상기 생성된 패치를 무작위로 추가 하여 음영이 포함된 복수 개의 이미지를 생성하는 단계를 포함할 수 있다. 상기 시각적으로 출력하는 단계는, 상기 생성된 입력 이미지의 히트맵에 패치가 추가되어 음영이 포함된 복수 개의 히트맵과 상기 음영이 포함된 복수 개의 이미지의 히트맵에 대해 대조 학습을 수행함에 따라 일관성 손실 을 계산하고, 상기 계산된 일관성 손실을 통해 비교 결과를 획득하는 단계를 포함할 수 있다. 상기 대조 학습은, 상기 입력 이미지의 히트맵과 상기 음영이 포함된 복수 개의 이미지의 히트맵 및 이미지 배 치에 있는 다른 이미지의 히트맵과의 유사성 판단을 통해 일관성 손실이 계산되는 것일 수 있다. 이미지 음영 및 대조 학습을 이용한 설명 제공 방법을 상기 설명 제공 시스템에 실행시키기 위해 비-일시적인 컴퓨터 판독가능한 기록 매체에 저장되는 컴퓨터 프로그램을 포함할 수 있다. 설명 제공 시스템은, 이미지 인식 모델을 통해 입력 이미지의 히트맵을 생성하는 제1 히트맵 생성부; 상기 이미 지 인식 모델을 통해 음영이 포함된 복수 개의 이미지의 히트맵을 생성하는 제2 히트맵 생성부; 및 상기 생성된 입력 이미지의 히트맵과 상기 음영이 포함된 복수 개의 이미지의 히트맵에 대한 대조 학습을 수행함에 따라 획 득된 비교 결과를 시각적으로 출력하는 시각적 설명부를 포함할 수 있다."}
{"patent_id": "10-2023-0092357", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "이미지 데이터를 처리할 때 Grad CAM을 사용하여 히트맵을 생성하고, 생성된 히트맵을 대조 학습에 사용하여 이 미지의 일부가 가려진 후에도 모델이 원래의 중요한 영역에 계속 초점을 맞추고 이전 히트맵에서 초점을 맞추지 않았던 이미지 객체와 관련된 다른 부분을 찾을 수 있다."}
{"patent_id": "10-2023-0092357", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하, 실시예를 첨부한 도면을 참조하여 상세히 설명한다. 도 1은 일 실시예에 있어서, 이미지 음영 및 대조 학습을 이용한 설명 제공 동작을 설명하기 위한 도면이다. 설명 제공 시스템은 이미지 인식 모델에서 생성된 히트맵을 대조 학습 (contrastive learning)을 통해 최적화할 수 있다. 대조 학습이란 동일한 클래스의 인스턴스 간의 공통 특징을 학습하고 다른 클래스의 인스턴스 간의 차이점을 구별하는데 중점을 둔다. 대조 학습은 의미적 수준(semantic level)에서 특징 공간(feature space)의 데이터를 구별하는 방법을 학습해야 하며, 일반화 능력이 강하다. 대조 학습의 목표는 같은 클래스의 데이터를 유사하게 인코딩하는 인코더(encoder)를 학습하고, 다른 클래스의 데이터의 인코딩 결과를 최대한 다르게 만드 는 것이다. 대조 학습은 지도 대조 손실과 비지도 대조 손실이 있다. 비지도 대조 손실은 일반적으로 이미지 확대 후 이미지와 원본 이미지로 표시될 수 있다. 지도 대조 손실은 동일한 배치에서 동일한 레이블이 있는 경 우 파지티브 사례로 간주되고, 다른 레이블이 있는 경우, 네거티브 사례로 간주될 수 있다. 대조 학습을 통해 동일한 레이블은 더 가까워지고 다른 레이블은 더 멀어지게 된다. 설명 제공 시스템은 입력 이미지(원본 이미지)를 기반으로 입력 이미지에 무작위로 패치를 추가하여 클래스 활성화 맵(Class Activation Map; CAM)을 생성하고, 생성된 클래스 활성화 맵을 대조 학습을 통해 원본 이미지의 클래스 활성화 맵과 비교할 수 있다. 설명 제공 시스템은 이미지에서 이미지 타겟에 대한 주의 를 유지함과 동시에 클래스 활성화 맵이 주목하지 않는 이미지 타겟이 속하는 영역에 대한 주의를 기울일 수 있 다. 설명 제공 시스템은 이미지 인식 모델을 통해 입력 이미지의 히트맵(heatmap)을 생성할 수 있다. 설명 제공 시스템은 생성된 입력 이미지의 히트맵에 기 설정된 패치 크기의 그리드로 구분하 여 이미지 음영을 위한 패치를 무작위로 추가하여 음영이 포함된 복수 개의 히트맵을 생성할 수 있다. 설 명 제공 시스템은 이미지 인식 모델을 통해 음영이 포함된 복수 개의 이미지의 히트맵을 생성할 수 있다. 이때, 입력 이미지의 히트맵과 음영이 포함된 복수 개의 이미지의 히트맵은, 클래스 활성화 맵 또는 그래드-클래스 활성화 맵(Grad-CAM)을 이용하여 생성된 것일 수 있다. 도 4를 참고하면, 히트맵 생성 동작을 설명하기 위한 도면이다. 이미지 인식 모델은 이미지 분류를 위해 이미 지의 가장 차별적인 부분(예를 들면, 개의 얼굴)에 초점을 맞추는 경향이 있다. 설명 제공 시스템은 이미지 패 치를 통해 일부 영역을 음영 처리하여 이미지를 특정 객체(예를 들면, '강아지')로 올바르게 분류하기 위해 이 미지 인식 모델이 객체의 다른 부분에 집중할 수 있도록 한다. 이미지 인식 모델은 이미지 내의 이미지 타겟에 주의를 기울임과 동시에 클래스 활성화 매핑이 주의하지 않는 이미지 타겟에 속하는 영역에 주의를 기울일 수 있다. 클래스 활성화 맵은 CNNs(Convolutional Neural Networks)의 시각화를 도와주는 도구이다. 컨볼루션 뉴럴 네 트워크의 시각화는 크게 컨볼루션 커널 시각화(visualizing convolution kernels), 특징맵 시각화(visualizing feature map), 활성화 히트맵 시각화(visualizing the activation heatmap)로 구분될 수 있다. 클래스 활성화 맵은 다양한 공간 위치에서 이러한 시각적 패턴의 존재 여부에 가중치를 부여한 선형 합(linear sum)이다. 클 래스 활성화 맵을 입력 이미지의 크기에 맞게 업샘플링(upsampling)하여 클래스 활성화 맵을 사용하면 정확한 이미지 분류라는 목적을 달성하기 위해 네트워크의 어느 영역에 집중하는 지 관찰할 수 있다. 히트맵에 따르면, 높은 응답 영역은 실제로 판단에 가장 유용하다고 생각되는 부분에 집중되어 있음을 알 수 있다. 보다 상세하게는, 클래스 활성화 맵이란 클래스 예측을 담당하는 영역을 로컬라이즈(localizing)하는 방식으로, CNN 의 완전히 연결된 레이어를 더 많은 컨볼루션 레이어와 글로벌 평균 풀링(global average pooling, GAP)으로 대 체한다. GAP은 최종 특징맵 값을 평균으로 구하는 계산 방식이다. 마지막 글로벌 평균 풀링을 통해 512개의 특징이 획득되고, 획득된 512개의 특징을 최종 선형 레이어(final linear layer)를 통해 512개의 특징 중 어떤 것이 더 큰 가중치를 갖는지 학습하도록 요청하여 최종 예측 결과를 획득할 수 있다. 그래드-클래스 활성화 맵이란 그라데이션 로컬라이제이션(gradient localization)에 기반한 딥 네트워크 시각화 기법이다. 그래드-클래스 활성화 맵은 최종 컨볼루션 특징맵에 대한 분류 점수의 그레디언트(gradient)를 활용 하여 입력 이미지에서 분류 점수에 가장 큰 영향을 미치는 부분을 식별한다. 이러한 그레디언트가 큰 부분은 바로 최종 점수가 데이터에 가장 크게 좌우되는 곳을 의미한다. 그래드-클래스 활성화 맵의 기본 개념은 신경 망에서 마지막 컨볼루션 레이어의 출력 특징맵이 분류 결과에 가장 큰 영향을 미치기 때문에 마지막 컨볼루션 레이어의 그레디언트의 글로벌 평균 풀링(global average pooling)을 사용하여 각 채널의 가중치를 계산할 수 있다는 것이다. 이러한 가중치를 사용하여 특징맵에 가중치를 부여하여 클래스 활성화 맵(CAM)을 생성할 수 있 으며, 각 픽셀(pixel)은 분류 결과에서 해당 픽셀 영역의 중요성을 나타낸다. 기존의 클래스 활성화 맵 방법과 비교했을 때 그래드-클래스 활성화 맵은 네트워크 구조를 수정하거나 특정 레이어 구조를 사용할 필요가 없기 때문에 모든 종류의 신경망을 처리할 수 있다. 보다 상세하게는, 이미지와 관심있는 클래스(예를 들면, 호랑이 고양이 또는 다른 유형의 차별화 가능한 출력)이 입력으로 주어지면 이미지 인식 모델의 CNN 부분을 통해 이미 지의 작업별 계산을 통해 카테고리를 위해 원시 점수가 획득될 수 있다. 그레디언트는 1로 설정된 클래스(호랑 이 고양이)를 제외한 모든 클래스에 대해 0으로 설정될 수 있다. 그런 다음 그레디언트는 수정된 컨볼루션 특 징맵으로 역전파되며, 특정 결정을 내리기 위해 모델이 찾아야 하는 위치를 나타내는 그래드-클래스 활성화 맵 의 지역화(파란색 히트맵)을 계산하기 위해 결합될 수 있다. 설명 제공 시스템은 선택된 입력 이미지에 대해 이미지 인식 모델을 통해 입력 이미지의 클래스 활성 화 맵을 생성할 수 있다. 설명 제공 시스템은 상위 예측 카테고리(top predicted category)에서 선택된 이미지 (원본 이미지)에 대한 그래드-클래스 활성화 맵을 계산하고, 이미지 배치의 모든 이미지에 무작위로 패치를 추 가하여 상위 예측 카테고리에 대한 복수의 그래드-클래스 활성화 맵을 생성할 수 있다. 여기서, 상위 예측 카 테고리란 특정 레이블을 포함하는 이미지들로 분류된 상위 개념을 의미할 수 있다. 설명 제공 시스템은 생성된 입력 이미지의 클래스 활성화 맵에 기 설정된 패치 크기의 그리드에 이미지 음영을 위한 패치를 무작위로 추가 하여 복수 개의 음영이 포함된 클래스 활성화 맵을 생성할 수 있다. 다시 말해서, 설명 제공 시스템은 선택된 입력 이미지에 대해 생성된 입력 이미지의 클래스 활성화 맵에 기 설정된 패치 크기의 그리드로 구분하여 이미 지 음영을 위한 패치를 무작위로 추가하여 음영이 포함된 복수 개의 클래스 활성화 매핑 히트맵을 생성할 수 있 다. 또한, 설명 제공 시스템은 이미지 배치에서 이미지 인식 모델에 입력하기 위한 입력 이미지를 선택하 고, 선택된 입력 이미지에서 이미지 인식 모델을 통해 교차 엔트로피 손실을 계산할 수 있다. 실제 레이블(true label) y가 1인 C차원 벡터이고 나머지는 0인 C차원 벡터라고 가정하고, x가 K 카테고리에 속 함을 나타낸다. 그런 다음, 설명 제공 시스템은 교차 엔트로피 손실을 사용하여 이미지 모델의 예측과 실제 레 이블 사이의 간격을 측정할 수 있다. 교차 엔트로피 손실은 다음과 같이 도출될 수 있다. 수학식 1:"}
{"patent_id": "10-2023-0092357", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "여기서, xi는 실제 레이블의 i번째 요소를 나타내고 yi는 이미지 인식 모델이 x가 i번째 카테고리에 속한다고 예 측될 확률을 나타낸다. 설명 제공 시스템은 원본 이미지에서 기 설정된 패치 크기의 그리드로 구분하여 이미지 음영을 위한 패치 를 생성하고, 원본 이미지에 생성된 패치를 무작위로 추가하여 음영을 위한 패치가 포함된 복수 개의 이미지 를 생성할 수 있다. 설명 제공 시스템은 이미지 인식 모델을 통해 음영을 위한 패치가 포함된 복수 개의 이미지의 클래스 활성화 매핑 히트맵을 생성할 수 있다. 예를 들면, 설명 제공 시스템은 W Х H Х 3 크기의 훈련 이미지 I가 주어지면 먼저 고정 패치 크기인 SХSХ3의 격자로 구분할 수 있다. 이를 통해 총 (W Х H)/(S Х S) 패치가 생성될 수 있다. 설명 제공 시스템은 입력 이미지의 히트맵(히트맵을 생성한 후 음영을 위한 패치가 추가된 히트맵)과 음영이 포 함된 복수 개의 이미지의 히트맵(음영을 위한 패치가 있는 이미지에 생성된 히트맵)에 대해 대조 학습을 수행함 에 따라 일관성 손실을 계산하고, 계산된 일관성 손실을 통해 비교 결과를 획득할 수 있다. 수학식 2는 대조 학습을 나타낸 것이다."}
{"patent_id": "10-2023-0092357", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "여기서, M은 미니 배치 사이즈, yi와 yj는 샘플 i와 샘플 j의 레이블을 나타내고, Myi는 미니 배치에서 yi인 샘플 의 수를 나타낸다. , 및 는 유사한 지시 함수이다. 예를 들면, i와 j가 일치 하지 않으면 =1이고, 그렇지 않으면 =0이다. 는 샘플 i와 샘플 j 사이의 코사인 유사도이다. 여기서, vi와 vj는 샘플 i와 샘플 j의 높은 수준 특징 벡터를 나타 낸다. t는 온도 하이퍼파라미터이다. 설명 제공 시스템은 음영이 포함된 복수 개의 이미지의 히트맵을 파지티브 히트맵으로 간주하고, 이미지 배치에 있는 다른 이미지의 히트맵을 네거티브 히트맵으로 간주할 수 있다. 설명 제공 시스템은 입력 이미지의 히트맵 (히트맵을 생성한 후 음영을 위한 패치가 추가된 히트맵), 파지티브 히트맵 및 네거티브 히트맵에 대해 대조 함 수를 통해 일관성 손실을 생성하여 히트맵의 주의 품질을 개선할 수 있다. 설명 제공 시스템은 교차 엔트로피 손실과 일관성 손실을 통해 최종 손실을 도출할 수 있다. 설명 제공 시스템 은 교차 엔트로피 손실과 일관성 손실의 합이 최소화된 결과를 출력할 수 있다. 도 2는 일 실시예에 있어서, 설명 제공 시스템의 구성을 설명하기 위한 블록도이고, 도 3은 일 실시예에 있어서, 이미지 음영 및 대조 학습을 이용한 설명 제공 방법을 설명하기 위한 흐름도이다. 설명 제공 시스템의 프로세서는 제1 히트맵 생성부, 제2 히트맵 생성부 및 시각적 설명부 를 포함할 수 있다. 이러한 프로세서의 구성요소들은 설명 제공 시스템에 저장된 프로그램 코드가 제공하는 제 어 명령에 따라 프로세서에 의해 수행되는 서로 다른 기능들(different functions)의 표현들일 수 있다. 프로 세서 및 프로세서의 구성요소들은 도 3의 이미지 음영 및 대조 학습을 이용한 설명 제공 방법이 포함하는 단계 들(310 내지 330)을 수행하도록 설명 제공 시스템을 제어할 수 있다. 이때, 프로세서 및 프로세서의 구성요소 들은 메모리가 포함하는 운영체제의 코드와 적어도 하나의 프로그램의 코드에 따른 명령(instruction)을 실행하 도록 구현될 수 있다. 프로세서는 이미지 음영 및 대조 학습을 이용한 설명 제공 방법을 위한 프로그램의 파일에 저장된 프로그램 코 드를 메모리에 로딩할 수 있다. 예를 들면, 설명 제공 시스템에서 프로그램이 실행되면, 프로세서는 운영체제 의 제어에 따라 프로그램의 파일로부터 프로그램 코드를 메모리에 로딩하도록 설명 제공 시스템을 제어할 수 있 다. 이때, 제1 히트맵 생성부, 제2 히트맵 생성부 및 시각적 설명부 각각은 메모리에 로딩된 프로그램 코드 중 대응하는 부분의 명령을 실행하여 이후 단계들(310 내지 330)을 실행하기 위한 프로세서의 서 로 다른 기능적 표현들일 수 있다. 단계에서 제1 히트맵 생성부는 이미지 인식 모델을 통해 입력 이미지의 히트맵을 생성할 수 있다. 이미지 인식 모델을 통해 입력 이미지에 대한 클래스 활성화 맵을 생성할 수 있다. 제1 히트맵 생성부는 이미지 배치에서 이미지 인식 모델에 입력하기 위한 입력 이미지를 선택하고, 선택된 입력 이미지에서 이미지 인식 모델을 통해 교차 엔트로피 손실을 계산할 수 있다. 제1 히트맵 생성부는 선택된 입력 이미지에 대 해 이미지 인식 모델을 통해 입력 이미지의 클래스 활성화 맵을 생성하고, 생성된 입력 이미지의 클래스 활성화 맵에서 기 설정된 패치 크기의 그리드에 이미지 음영을 위한 패치를 무작위로 추가하여 음영이 포함된 복수 개 의 클래스 활성화 맵을 생성할 수 있다. 단계에서 제2 히트맵 생성부는 이미지 인식 모델을 통해 음영이 포함된 복수 개의 이미지의 히트맵을 생성할 수 있다. 제2 히트맵 생성부는 입력 이미지로부터 생성된 음영이 포함된 복수 개의 이미지에 대해 이미지 인식 모델을 통해 음영이 포함된 복수 개의 이미지에 대한 클래스 활성화 맵을 생성할 수 있다. 제2 히 트맵 생성부는 원본 이미지에서 기 설정된 패치 크기의 그리드로 구분하여 이미지 음영을 위한 패치를 생 성하고, 원본 이미지에 생성된 패치를 무작위로 추가하여 음영이 포함된 복수 개의 이미지를 생성할 수 있다. 단계에서 시각적 설명부는 생성된 입력 이미지의 히트맵과 음영이 포함된 복수 개의 이미지의 히트맵 에 대한 대조 학습을 수행함에 따라 획득된 비교 결과를 시각적으로 출력할 수 있다. 시각적 설명부는 생 성된 입력 이미지의 클래스 활성화 맵(즉, 입력 이미지의 클래스 활성화 맵에 패치가 추가되어 생성된 음영이 포함된 복수 개의 클래스 활성화 맵)과 음영이 포함된 복수 개의 이미지의 클래스 활성화 맵의 대조 학습을 통 해 획득된 비교한 결과를 시각적 설명으로 출력할 수 있다. 시각적 설명부는 생성된 입력 이미지의 히트 맵에 패치가 추가되어 음영이 포함된 복수 개의 히트맵과 음영이 포함된 복수 개의 이미지의 히트맵에 대해 대 조 학습을 수행함에 따라 일관성 손실을 계산하고, 계산된 일관성 손실을 통해 비교 결과를 획득할 수 있다. 이때, 입력 이미지의 히트맵과 상기 음영이 포함된 복수 개의 이미지의 히트맵 및 배치에 있는 다른 이미지의 히트맵과의 유사성 판단을 통해 일관성 손실이 계산될 수 있다. 이상에서 설명된 장치는 하드웨어 구성요소, 소프트웨어 구성요소, 및/또는 하드웨어 구성요소 및 소프트웨어 구성요소의 조합으로 구현될 수 있다. 예를 들어, 실시예들에서 설명된 장치 및 구성요소는, 예를 들어, 프로 세서, 콘트롤러, ALU(arithmetic logic unit), 디지털 신호 프로세서(digital signal processor), 마이크로컴 퓨터, FPGA(field programmable gate array), PLU(programmable logic unit), 마이크로프로세서, 또는 명령 (instruction)을 실행하고 응답할 수 있는 다른 어떠한 장치와 같이, 하나 이상의 범용 컴퓨터 또는 특수 목적 컴퓨터를 이용하여 구현될 수 있다. 처리 장치는 운영 체제(OS) 및 상기 운영 체제 상에서 수행되는 하나 이상 의 소프트웨어 애플리케이션을 수행할 수 있다. 또한, 처리 장치는 소프트웨어의 실행에 응답하여, 데이터를 접근, 저장, 조작, 처리 및 생성할 수도 있다. 이해의 편의를 위하여, 처리 장치는 하나가 사용되는 것으로 설"}
{"patent_id": "10-2023-0092357", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "명된 경우도 있지만, 해당 기술분야에서 통상의 지식을 가진 자는, 처리 장치가 복수 개의 처리 요소 (processing element) 및/또는 복수 유형의 처리 요소를 포함할 수 있음을 알 수 있다. 예를 들어, 처리 장치 는 복수 개의 프로세서 또는 하나의 프로세서 및 하나의 콘트롤러를 포함할 수 있다. 또한, 병렬 프로세서 (parallel processor)와 같은, 다른 처리 구성(processing configuration)도 가능하다. 소프트웨어는 컴퓨터 프로그램(computer program), 코드(code), 명령(instruction), 또는 이들 중 하나 이상의 조합을 포함할 수 있으며, 원하는 대로 동작하도록 처리 장치를 구성하거나 독립적으로 또는 결합적으로 (collectively) 처리 장치를 명령할 수 있다. 소프트웨어 및/또는 데이터는, 처리 장치에 의하여 해석되거나 처리 장치에 명령 또는 데이터를 제공하기 위하여, 어떤 유형의 기계, 구성요소(component), 물리적 장치, 가상 장치(virtual equipment), 컴퓨터 저장 매체 또는 장치에 구체화(embody)될 수 있다. 소프트웨어는 네트워크로 연결된 컴퓨터 시스템 상에 분산되어서, 분산된 방법으로 저장되거나 실행될 수도 있다. 소프트웨어 및 데이터 는 하나 이상의 컴퓨터 판독 가능 기록 매체에 저장될 수 있다. 실시예에 따른 방법은 다양한 컴퓨터 수단을 통하여 수행될 수 있는 프로그램 명령 형태로 구현되어 컴퓨터 판 독 가능 매체에 기록될 수 있다. 상기 컴퓨터 판독 가능 매체는 프로그램 명령, 데이터 파일, 데이터 구조 등 을 단독으로 또는 조합하여 포함할 수 있다. 상기 매체에 기록되는 프로그램 명령은 실시예를 위하여 특별히 설계되고 구성된 것들이거나 컴퓨터 소프트웨어 당업자에게 공지되어 사용 가능한 것일 수도 있다. 컴퓨터 판 독 가능 기록 매체의 예에는 하드 디스크, 플로피 디스크 및 자기 테이프와 같은 자기 매체(magnetic media), CD-ROM, DVD와 같은 광기록 매체(optical media), 플롭티컬 디스크(floptical disk)와 같은 자기-광 매체 (magneto-optical media), 및 롬(ROM), 램(RAM), 플래시 메모리 등과 같은 프로그램 명령을 저장하고 수행하도 록 특별히 구성된 하드웨어 장치가 포함된다. 프로그램 명령의 예에는 컴파일러에 의해 만들어지는 것과 같은 기계어 코드뿐만 아니라 인터프리터 등을 사용해서 컴퓨터에 의해서 실행될 수 있는 고급 언어 코드를 포함한다."}
{"patent_id": "10-2023-0092357", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 5, "content": "이상과 같이 실시예들이 비록 한정된 실시예와 도면에 의해 설명되었으나, 해당 기술분야에서 통상의 지식을 가 진 자라면 상기의 기재로부터 다양한 수정 및 변형이 가능하다. 예를 들어, 설명된 기술들이 설명된 방법과 다 른 순서로 수행되거나, 및/또는 설명된 시스템, 구조, 장치, 회로 등의 구성요소들이 설명된 방법과 다른 형태 로 결합 또는 조합되거나, 다른 구성요소 또는 균등물에 의하여 대치되거나 치환되더라도 적절한 결과가 달성될 수 있다. 그러므로, 다른 구현들, 다른 실시예들 및 특허청구범위와 균등한 것들도 후술하는 특허청구범위의 범위에 속한 다.도면 도면1 도면2 도면3 도면4"}
{"patent_id": "10-2023-0092357", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 일 실시예에 있어서, 이미지 음영 및 대조 학습을 이용한 설명 제공 동작을 설명하기 위한 도면이다. 도 2는 일 실시예에 있어서, 설명 제공 시스템의 구성을 설명하기 위한 블록도이다. 도 3은 일 실시예에 있어서, 이미지 음영 및 대조 학습을 이용한 설명 제공 방법을 설명하기 위한 흐름도이다. 도 4는 일 실시예에 있어서, 히트맵 생성 동작을 설명하기 위한 도면이다."}
