{"patent_id": "10-2022-0138446", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2024-0057796", "출원번호": "10-2022-0138446", "발명의 명칭": "딥러닝 기반 동적 제스처 인식 시스템", "출원인": "주식회사 케이아이씨텍", "발명자": "박채민"}}
{"patent_id": "10-2022-0138446", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "TOF 센서로부터 동적 제스처 단위의 뎁스 이미지 집합을 수신하는 뎁스 이미지 집합 수신부;상기 수신한 동적 제스처 단위의 뎁스 이미지 집합을 전처리하는 동적 제스처 전처리부; 및상기 전처리한 동적 제스처 단위의 뎁스 이미지 집합을 입력하여 제스처를 인식하는 동적 제스처 인식부;를 포함하며,상기 뎁스 이미지 집합의 각 윤곽선을 따라 시계열 ROI(Region of Interest) 이진 이미지, 시계열 ROI 그레이스케일 이미지 혹은 이들의 조합을 딥러닝 학습모델에 적용함으로써 딥러닝 복잡도를 줄이면서 제스처의 인식률을 향상시키는 것을 특징으로 하는 딥러닝 기반 동적 제스처 인식 시스템."}
{"patent_id": "10-2022-0138446", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "청구항 1에 있어서,상기 동적 제스처 전처리부는,상기 수신한 동적 제스처 단위의 뎁스 이미지 집합에서 ROI를 설정하는 시계열 ROI 이미지를 설정하는 시계열ROI 설정부;상기 설정한 시계열 ROI 이미지로부터 윤곽선의 존재 여부와 위치를 추출하는 시계열 윤곽선 위치 추출부;상기 설정한 시계열 ROI 이미지로부터 윤곽선의 기울기의 크기와 방향을 추출하는 시계열 윤곽선 기울기추출부;상기 추출한 윤곽선의 존재 여부와 위치 및 상기 윤곽선의 기울기 크기와 방향을 조합하여 상기 시계열 ROI 이미지를 이진 이미지로 변환하여 시계열 ROI 이진 이미지를 생성하는 시계열 ROI 이진화부; 및상기 추출한 윤곽선의 존재여부와 위치 및 상기 윤곽선의 기울기 크기와 방향을 조합하여 상기 시계열 ROI 이미지를 윤곽선 주변 그레이스케일 이미지로 변환하여 시계열 ROI 윤곽선 주변 그레이스케일 이미지를 생성하는 시계열 ROI 윤곽선 주변 그레이스케일화부;를 포함하는 것을 특징으로 하는 딥러닝 기반 동적 제스처 인식시스템."}
{"patent_id": "10-2022-0138446", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "청구항 1에 있어서,상기 동적 제스처 인식부는,상기 전처리한 시계열 ROI 이진 이미지를 제1 학습모델에 입력하여 제1 동적 제스처 레이블 집합을 추출하는 제1 동적 제스처 추정부;상기 전처리한 시계열 ROI 윤곽선 주변 그레이스케일 이미지를 제2 학습모델에 입력하여 제2 동적 제스처 레이블 집합을 추출하는 제2 제스처 추정부; 또는이들의 조합을 포함하는 것을 특징으로 하는 딥러닝 기반 동적 제스처 인식 시스템."}
{"patent_id": "10-2022-0138446", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "청구항 3에 있어서,상기 동적 제스처 인식부는,상기 추정한 제1 동적 제스처 레이블 집합, 제2 동적 제스처 레이블 집합, 또는 이들의 조합으로부터 최종적인제스처 레이블을 추출하는 동적 제스처 레이블 앙상블부;를 더 포함하며,공개특허 10-2024-0057796-3-상기 제1 동적 제스처 레이블 집합과 제2 동적 제스처 레이블 집합의 각 레이블에서 동일한 레이블끼리 평균을구하여 제일 높은 확률을 가진 레이블을 추출하여 최종적인 레이블을 추출하는 것을 특징으로 하는 딥러닝 기반동적 제스처 인식 시스템."}
{"patent_id": "10-2022-0138446", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "청구항 4에 있어서,상기 제1 학습모델은,상기 전처리한 시계열 ROI 이진 이미지를 레이블링한 학습 데이터를 사용하여 하이브리드 CNN(ConvolutionalNeural Network)-RNN(Recurrent Neural Network)을 학습하여 생성한 것이며,상기 제2 학습모델은,상기 전처리한 시계열 ROI 윤곽선 주변 그레이스케일 이미지를 레이블링한 학습 데이터를 사용하여 하이브리드CNN(Convolutional Neural Network)-RNN(Recurrent Neural Network)을 학습하여 생성한 것이며,상기 추출한 최종적인 레이블을 각각 제1 학습모델과 제2 학습모델에 각각 연전파를 통해서 반영하여 제1 학습모델과 제2 학습모델을 각각 업데이트하는 것을 특징으로 하는 딥러닝 기반 동적 제스처 인식 시스템."}
{"patent_id": "10-2022-0138446", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "TOF 센서로부터 동적 제스처 단위의 뎁스 이미지 집합을 수신하는 뎁스 이미지 집합 수신 단계;상기 수신한 동적 제스처 단위의 뎁스 이미지 집합을 전처리하는 동적 제스처 전처리 단계; 및상기 전처리한 동적 제스처 단위의 뎁스 이미지 집합을 입력하여 제스처를 인식하는 동적 제스처 인식 단계;를포함하며,상기 뎁스 이미지 집합의 각 윤곽선을 따라 시계열 ROI(Region of Interest) 이진 이미지, 시계열 ROI 그레이스케일 이미지 혹은 이들의 조합을 딥러닝 학습모델에 적용함으로써 딥러닝 복잡도를 줄이면서 제스처의 인식률을 향상시키는 것을 특징으로 하는 딥러닝 기반 동적 제스처 인식 방법."}
{"patent_id": "10-2022-0138446", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "청구항 6에 있어서,상기 동적 제스처 전처리 단계는,상기 수신한 동적 제스처 단위의 뎁스 이미지 집합에서 ROI를 설정하는 시계열 ROI 이미지를 설정하는 시계열ROI 설정 단계;상기 설정한 시계열 ROI 이미지로부터 윤곽선의 존재 여부와 위치를 추출하는 시계열 윤곽선 위치 추출 단계;상기 설정한 시계열 ROI 이미지로부터 윤곽선의 기울기의 크기와 방향을 추출하는 시계열 윤곽선 기울기 추출단계;상기 추출한 윤곽선의 존재 여부와 위치 및 상기 윤곽선의 기울기 크기와 방향을 조합하여 상기 시계열 ROI 이미지를 이진 이미지로 변환하여 시계열 ROI 이진 이미지를 생성하는 시계열 ROI 이진화 단계; 및상기 추출한 윤곽선의 존재여부와 위치 및 상기 윤곽선의 기울기 크기와 방향을 조합하여 상기 시계열 ROI 이미지를 윤곽선 주변 그레이스케일 이미지로 변환하여 시계열 ROI 윤곽선 주변 그레이스케일 이미지를 생성하는 시계열 ROI 윤곽선 주변 그레이스케일화 단계;를 포함하는 것을 특징으로 하는 딥러닝 기반 동적 제스처 인식 방법."}
{"patent_id": "10-2022-0138446", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "청구항 6에 있어서,상기 동적 제스처 인식 단계는,상기 전처리한 시계열 ROI 이진 이미지를 제1 학습모델에 입력하여 제1 동적 제스처 레이블 집합을 추출하는 제공개특허 10-2024-0057796-4-1 동적 제스처 추정 단계;상기 전처리한 시계열 ROI 윤곽선 주변 그레이스케일 이미지를 제2 학습모델에 입력하여 제2 동적 제스처 레이블 집합을 추출하는 제2 동적 제스처 추정 단계; 또는이들의 조합을 포함하는 것을 특징으로 하는 딥러닝 기반 동적 제스처 인식 방법."}
{"patent_id": "10-2022-0138446", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "청구항 8에 있어서,상기 동적 제스처 인식 단계는,상기 추정한 제1 동적 제스처 레이블 집합, 제2 동적 제스처 레이블 집합, 또는 이들의 조합으로부터 최종적인제스처 레이블을 추출하는 동적 제스처 레이블 앙상블 단계;를 더 포함하며,상기 제1 동적 제스처 레이블 집합과 제2 동적 제스처 레이블 집합의 각 레이블에서 동일한 레이블끼리 평균을구하여 제일 높은 확률을 가진 레이블을 추출하여 최종적인 레이블을 추출하는 것을 특징으로 하는 딥러닝 기반동적 제스처 인식 방법."}
{"patent_id": "10-2022-0138446", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "청구항 9에 있어서,상기 제1 학습모델은,상기 전처리한 시계열 ROI 이진 이미지를 레이블링한 학습 데이터를 사용하여 하이브리드 CNN(ConvolutionalNeural Network)-RNN(Recurrent Neural Network)을 학습하여 생성한 것이며,상기 제2 학습모델은,상기 전처리한 시계열 ROI 윤곽선 주변 그레이스케일 이미지를 레이블링한 학습 데이터를 사용하여 하이브리드CNN(Convolutional Neural Network)-RNN(Recurrent Neural Network)을 학습하여 생성한 것이며,상기 추출한 최종적인 레이블을 각각 제1 학습모델과 제2 학습모델에 각각 연전파를 통해서 반영하여 제1 학습모델과 제2 학습모델을 각각 업데이트하는 것을 특징으로 하는 딥러닝 기반 동적 제스처 인식 방법."}
{"patent_id": "10-2022-0138446", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 딥러닝 기반 동적 제스처 인식 시스템에 관한 것으로, 특정 실내공간에서 사용자의 행동을 독립적인 하나의 제스처 단위로 수집하여, 해당 제스처 단위 내에 포함된 복수의 정적인 제스처의 특징 간 시계열적인 변 화를 딥러닝 학습모델로 학습하고, 해당 제스처를 적은 하드웨어 복잡도로 고속으로 정확하게 인식할 수 있도록 하는 딥러닝 기반 동적 제스처 인식 시스템에 관한 것이다."}
{"patent_id": "10-2022-0138446", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 딥러닝 기반 동적 제스처 인식 시스템에 관한 것으로, 더욱 상세하게는 특정 실내공간에서 사용자의 행동을 독립적인 하나의 제스처 단위로 수집하여, 해당 제스처 단위 내에 포함된 복수의 정적인 제스처의 특징 간 시계열적인 변화를 딥러닝 학습모델로 학습하고, 해당 제스처를 적은 하드웨어 복잡도로 고속으로 정확하게 인식할 수 있도록 하는 딥러닝 기반 동적 제스처 인식 시스템에 관한 것이다."}
{"patent_id": "10-2022-0138446", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "동적 제스처는 정적 제스처의 순차적인 집합으로 이루어져 있기 때문에 동적 제스처를 인식하기 위해서는 먼저 정적 제스처를 인식하고 이들 간의 시계열적인 관계를 파악하는 것이 중요하다. 이러한 동적 제스처는 자유도가 높고 왜곡이 많기 때문에 적확히 인식하는 것이 쉽지 않다. 본 발명에서는 동적 제스처를 인식하는데 사용되는 센서로 IR 기반 TOF 센서를 사용하고자 한다. TOF 센서의 경 우, 640x480 정도의 높은 해상도로 초당 30 프레임 정도의 프레임 레이트를 갖는 뎁스 이미지를 출력하는 것이 가능하다. 본 발명에 따르면 TOF 센서로부터 뎁스 이미지를 수집하고, 상기 뎁스 이미지를 시계열적인 이진 이미지로 전처 리함으로써, 제스처를 나타내는 객체(예: 손)와 배경을 용이하게 분리하고, 객체의 이동속도를 포함한 동적 제 스처에 대해서 레이블링하여 동적 제스처에 대한 인식을 수행하고자 한다. 3차원 이미지 센서는 사물까지의 거리를 측정함으로써 정밀하게 물체와 동작을 인식하여 3차원 이미지로 구현하 는 기능을 가진 센서를 말한다, 3차원 이미지 센서는 스테레오 방식, 구조 광 방식, ToF(Time of Flight) 방식으로 나뉘며, 세 가지 방식 모두 빛을 쏜 후 그것이 반사되는 성질을 이용하여 거리를 파악하는 것이다. 여기서 ToF 방식은 물체로부터 반사되는 빛의 이동시간을 계산하여 사물과의 거리, 즉, 뎁스(depth)를 인식하는 방식으로, 특정 공간에 대한 장면(scene)의 모든 픽셀에 대하여 변형된 빛 신호의 지연 또는 위상차를 측정하여 이동시간에 대한 정보를 획득한다. 이 빛 신호는 인간의 시력을 방해하지 않도록 근적외선 부근의 파장을 사용 하며, ToF 센서는 각 픽셀이 물체까지의 거리를 결정할 수 있는 픽셀 배열로 구성된다. 각 픽셀에서 수행된 함 수를 통해 이동시간 또는 지연을 해석하여 측정한 이미지의 뎁스를 결정한다. ToF 방식은 거리를 측정하는 방식에 따라 직접 ToF(direct ToF)와 간접 ToF(indirect ToF)로 나뉜다. 직접 ToF 는 되돌아오는 신호의 시차를 이용하는 것이고, 간접 ToF는 되돌아오는 신호의 위상차를 이용하는 것이다. 즉, 직접 ToF 방식은 펄스 레이저를 사물에 조사해 반사된 펄스 신호들이 이미지 센서에 도착하는 시간을 측정함으 로써 물체까지의 거리를 탐지하는 방식이다. 이 방식은 수십 혹은 수백 미터 이상 떨어진 물체와의 거리도 측정 할 수 있다는 장점이 있으나, 이를 위해서는 초고효율 특성을 제공하는 소자인 SPAD(Single-Photon Avalanche Diode)가 필요하다. 반면, 간접 ToF 방식은 특정 주파수로 변조된 레이저를 이용하여 물체로부터 반사되어 돌아온 신호와의 위상 차 이를 측정함으로써 물체까지의 거리를 측정하는 방식이다. 기존 포토다이오드(Photodiode) 소자를 이용하여 비 교적 수월하게 구현할 수 있다는 장점이 있으나, 광검출 소자의 낮은 효율로 인해 수 미터 이상 떨어진 물체와 의 거리를 측정하기 어렵다는 단점이 있다. 직접 ToF 방식은 하나의 광자를 검출하는 소자(SPAD)의 크기가 크고, 각 소자에 판독 회로를 쌓아야 하므로 해 상도에 한계가 있다. 반면에 간접 ToF 방식은 아날로그 전하 축적의 작동 원리에 따라 원거리에서 신호의 감쇄 가 있어, 측정 가능 거리 범위에 한계가 있다. 이러한 각각의 장단점으로 인해 두 방식의 장점을 활용할 수 있는 응용법 및 단점을 극복하려는 기술적인 연구 가 활발히 진행되고 있다. 본 발명에서는 높은 해상도와 센서 크기가 작은 간접 TOF 방식의 TOF 센서를 이용하여 근거리의 물체를 정밀하 게 감지하고자 하며, 실외보다 실내에서 사용하는 것을 상정한다. 즉, IR TOF 센서는 가시 영역 안의 사물을 높 은 해상도의 뎁스 이미지를 만들어, 손가락의 제스처를 인식하는 것이 가능하다. 스마트 홈에서 안전이나 편의 서비스의 제공을 위해 IR 뎁스 이미지 데이터를 대상으로 AI 분석기술 기반 동적 제스처 인식 기술을 제시하고 자 한다. 이러한 제스처 인식 기술은 공간 인식 기반 가전기기나 조명기기의 제어를 위해서 사용자 경험을 기반 한 실감 인터페이스를 제공하는데 활용될 수 있다. 다음으로 본 발명의 기술 분야에 존재하는 선행기술에 대하여 간단하게 설명하고, 이어서 본 발명이 상기 선행 기술에 비해서 차별적으로 이루고자 하는 기술적 사항에 대해서 기술하고자 한다. 먼저 한국공개특허 제2021-0067539호(2021.06.03.)는 정보 처리 방법 및 정보 저치 장치에 관한 것으로, 사용자 의 제스처를 포함하는 영상 정보를 획득하여 사용자가 지시하는 방향을 특정할 수 있도록 하는 것이다. 특히, 사용자의 제스처를 포함하는 영상 정보로부터 사용자의 스켈레톤(skeleton) 정보를 획득하고, 스켈레톤 정보로 부터 사용자의 어깨 관절의 위치와 손가락 관절의 위치를 이용하여 제어주체가 지시하는 방향을 특정하고자 하 는 것이다. 또한 한국공개특허 제2020-0056233호(2020.05.22)는 단일 카메라 기반의 인공지능 자세 분석 기술을 이용한 동 작 정확도 판정 시스템에 관한 것으로, 비접촉식 ToF 방식의 깊이 카메라 또는 RGB 카메라로 구성되는 단일 카 메라 기반의 인공지능 자세 분석 기술의 정확도 판정 시스템을 제시하고 있다. 위 선행기술들은 TOF 센서와 인공지능 기술을 사용하여 제스처를 인식하는 방법을 제시하고 있지만, 본 발명과 같이 특정 실내공간에서 사용자의 행동을 독립적인 하나의 동적 제스처 단위로 수집하여, 해당 동적 제스처 단 위 내에 포함된 복수의 정적인 제스처의 특징 간 시계열적인 변화를 딥러닝 학습모델로 학습하여, 해당 동적 제 스처를 적은 하드웨어 복잡도로 고속으로 정확하게 인식할 수 있도록 하는 딥러닝 기반 동적 제스처 인식 방법 을 제시하고 있지 않다. 따라서 본 발명과 위 선행기술들은 기술적 구성, 목적 및 효과에 있어서 현저한 차이점 이 있다."}
{"patent_id": "10-2022-0138446", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은 상기와 같은 문제점을 해결하기 위해 창작된 것으로서, 딥러닝 기반 동적 제스처 인식 시스템을 제 공함에 있어서, 동적 제스처 단위의 뎁스 이미지 집합에 대한 전처리와 그에 대한 딥러닝의 결합을 통해서 동적 제스처 인식의 정확도를 향상시키는 것을 목적으로 한다. 즉, 본 발명은 특정 실내공간에서 사용자의 행동을 독립적인 하나의 제스처 단위로 수집하여, 해당 제스처 단위 내에 포함된 복수의 정적인 제스처의 특징 간 시계열적인 변화를 딥러닝 학습모델로 학습하여, 해당 제스처를 적은 하드웨어 복잡도로 고속으로 정확하게 인식할 수 있도록 하는 딥러닝 기반 동적 제스처 인식 시스템을 제 공하는 것을 목적으로 한다. 또한 본 발명은 동적 제스처 단위의 뎁스 이미지에서 제스처를 인식하기 위한 대상 물체의 윤곽선이 형성하는 폐곡선과 배경이 선명하게 구분되도록 시계열 이진 이미지로 변환하고, 또한 시계열 윤곽선 주변 그레이스케일 이미지를 전처리하여, 각각을 입력으로 하는 인공지능 학습모델을 상호 보완적으로 운용하여 제스처의 인식 성 능을 향상시키는 것을 또 다른 목적으로 한다. 즉, 뎁스 이미지를 윤곽선을 선명하게 표현하는 이진 이미지와 상기 윤곽선을 중심으로 한 관심영역에 대해서만 선명도가 높은 그레이스케일 이미지로 변환하는 전처리를 통해 서 보다 간략화된 인공지능 학습모델을 통해서도 우수한 성능을 가지는 딥러닝 기반 동적 제스처 인식 시스템을 제공하는 것을 목적으로 한다. 또한 본 발명은 인공지능 학습모델을 정적인 제스처에 대해서는 CNN(Convolutional Neural Network)을 이용하여 해당 제스처에 대한 특징을 추출하고, 그 결과를 RNN(Recursive Neural Network)을 통해서 분류하는 방식을 적 용한 하이브리드 CNN-RNN 모델을 제시하고자 한다. 즉, ROI 이진 및 그레이스케일 이미지에 대한 공간적인 특징 을 CNN으로 추출하고, 그 결과에 대한 시계열적인 특징을 RNN으로 학습함으로써 동적 제스처를 시간과 공간영역 에서 연계하여 학습하도록 하고, 시간과 공간영역에서 동적 제스처를 추정하여 인식할 수 있도록 하는 것을 목 적으로 한다."}
{"patent_id": "10-2022-0138446", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명의 일 실시예에 따른 딥러닝 기반 동적 제스처 인식 시스템은, TOF 센서로부터 동적 제스처 단위의 뎁스 이미지 집합을 수신하는 뎁스 이미지 집합 수신부; 상기 수신한 동적 제스처 단위의 뎁스 이미지 집합을 전처리 하는 동적 제스처 전처리부; 및 상기 전처리한 동적 제스처 단위의 뎁스 이미지 집합을 입력하여 제스처를 인식 하는 동적 제스처 인식부;를 포함하며, 상기 뎁스 이미지 집합의 각 윤곽선을 따라 시계열 ROI(Region of Interest) 이진 이미지, 시계열 ROI 그레이 스케일 이미지 혹은 이들의 조합을 딥러닝 학습모델에 적용함으로써 딥러닝 복잡도를 줄이면서 제스처의 인식률을 향상시키는 것을 특징으로 한다. 상기 동적 제스처 전처리부는, 상기 수신한 동적 제스처 단위의 뎁스 이미지 집합에서 ROI를 설정하는 시계열 ROI 이미지를 설정하는 시계열 ROI 설정부; 상기 설정한 시계열 ROI 이미지로부터 윤곽선의 존재 여부와 위치를 추출하는 시계열 윤곽선 위치 추출부; 상기 설정한 시계열 ROI 이미지로부터 윤곽선의 기울기의 크기와 방향을 추출하는 시계열 윤곽선 기울기 추출부; 상기 추출한 윤곽선의 존재 여부와 위치 및 상기 윤곽선의 기울기 크기 와 방향을 조합하여 상기 시계열 ROI 이미지를 이진 이미지로 변환하여 시계열 ROI 이진 이미지를 생성하는 시 계열 ROI 이진화부; 및 상기 추출한 윤곽선의 존재여부와 위치 및 상기 윤곽선의 기울기 크기와 방향을 조합하 여 상기 시계열 ROI 이미지를 윤곽선 주변 그레이스케일 이미지로 변환하여 시계열 ROI 윤곽선 주변 그레이스케 일 이미지를 생성하는 시계열 ROI 윤곽선 주변 그레이스케일화부;를 포함하는 것을 특징으로 한다. 상기 동적 제스처 인식부는, 상기 전처리한 시계열 ROI 이진 이미지를 제1 학습모델에 입력하여 제1 동적 제스 처 레이블 집합을 추출하는 제1 동적 제스처 추정부; 상기 전처리한 시계열 ROI 윤곽선 주변 그레이스케일 이미 지를 제2 학습모델에 입력하여 제2 동적 제스처 레이블 집합을 추출하는 제2 제스처 추정부; 또는 이들의 조합 을 포함하는 것을 특징으로 한다. 상기 동적 제스처 인식부는, 상기 추정한 제1 동적 제스처 레이블 집합, 제2 동적 제스처 레이블 집합, 또는 이 들의 조합으로부터 최종적인 제스처 레이블을 추출하는 동적 제스처 레이블 앙상블부;를 더 포함하는 것을 특징 으로 한다. 상기 제1 동적 제스처 레이블 집합과 제2 동적 제스처 레이블 집합의 각 레이블에서 동일한 레이블 끼리 평균을 구하여 제일 높은 확률을 가진 레이블을 추출하여 최종적인 레이블을 추출하는 것을 특징으로 한다. 상기 제1 학습모델은, 상기 전처리한 시계열 ROI 이진 이미지를 레이블링한 학습 데이터를 사용하여 하이브리드 CNN(Convolutional Neural Network)-RNN(Recurrent Neural Network)을 학습하여 생성한 것이며, 상기 제2 학습 모델은, 상기 전처리한 시계열 ROI 윤곽선 주변 그레이스케일 이미지를 레이블링한 학습 데이터를 사용하여 하이브리드 CNN(Convolutional Neural Network)-RNN(Recurrent Neural Network)을 학습하여 생성한 것을 특징으 로 한다. 또한 상기 추출한 최종적인 레이블을 각각 제1 학습모델과 제2 학습모델에 각각 연전파를 통해서 반영하여 제1 학습모델과 제2 학습모델을 각각 업데이트하는 것을 특징으로 한다. 한편, 본 발명의 또 다른 일 실시예에 따른 딥러닝 기반 동적 제스처 인식 방법은, TOF 센서로부터 동적 제스처 단위의 뎁스 이미지 집합을 수신하는 뎁스 이미지 집합 수신 단계; 상기 수신한 동적 제스처 단위의 뎁스 이미 지 집합을 전처리하는 동적 제스처 단계; 및 상기 전처리한 동적 제스처 단위의 뎁스 이미지 집합을 입력하여 제스처를 인식하는 동적 제스처 인식 단계;를 포함하며, 상기 뎁스 이미지 집합의 각 윤곽선을 따라 시계열 ROI(Region of Interest) 이진 이미지, 시계열 ROI 그레이 스케일 이미지 혹은 이들의 조합을 딥러닝 학습모델 에 적용함으로써 딥러닝 복잡도를 줄이면서 제스처의 인식률을 향상시키는 것을 특징으로 한다. 상기 동적 제스처 전처리 단계는, 상기 수신한 동적 제스처 단위의 뎁스 이미지 집합에서 ROI를 설정하는 시계 열 ROI 이미지를 설정하는 시계열 ROI 설정 단계; 상기 설정한 시계열 ROI 이미지로부터 윤곽선의 존재 여부와 위치를 추출하는 시계열 윤곽선 위치 추출 단계; 상기 설정한 시계열 ROI 이미지로부터 윤곽선의 기울기의 크기 와 방향을 추출하는 시계열 윤곽선 기울기 추출 단계; 상기 추출한 윤곽선의 존재 여부와 위치 및 상기 윤곽선 의 기울기 크기와 방향을 조합하여 상기 시계열 ROI 이미지를 이진 이미지로 변환하여 시계열 ROI 이진 이미지 를 생성하는 시계열 ROI 이진화 단계; 및 상기 추출한 윤곽선의 존재여부와 위치 및 상기 윤곽선의 기울기 크기 와 방향을 조합하여 상기 시계열 ROI 이미지를 윤곽선 주변 그레이스케일 이미지로 변환하여 시계열 ROI 윤곽선 주변 그레이스케일 이미지를 생성하는 시계열 ROI 윤곽선 주변 그레이스케일화 단계;를 포함하는 것을 특징으로 한다. 상기 동적 제스처 인식 단계는, 상기 전처리한 시계열 ROI 이진 이미지를 제1 학습모델에 입력하여 제1 동적 제 스처 레이블 집합을 추출하는 제1 동적 제스처 추정 단계; 상기 전처리한 시계열 ROI 윤곽선 주변 그레이스케일 이미지를 제2 학습모델에 입력하여 제2 동적 제스처 레이블 집합을 추출하는 제2 제스처 추정 단계; 또는 이들 의 조합을 포함하는 것을 특징으로 한다. 또한 상기 동적 제스처 인식 단계는, 상기 추정한 제1 동적 제스처 레이블 집합, 제2 동적 제스처 레이블 집합, 또는 이들의 조합으로부터 최종적인 제스처 레이블을 추출하는 동적 제스처 레이블 앙상블 단계;를 더 포함하는 것을 특징으로 한다. 여기서 상기 제1 동적 제스처 레이블 집합과 제2 동적 제스처 레이블 집합의 각 레이블에 서 동일한 레이블끼리 평균을 구하여 제일 높은 확률을 가진 레이블을 추출하여 최종적인 레이블을 추출하는 것 을 특징으로 한다."}
{"patent_id": "10-2022-0138446", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "이상에서와 같이 본 발명의 딥러닝 기반 동적 제스처 인식 시스템 및 그 방법은 특정 공간에 대한 가시영역을 감지하는 TOF 센서를 통해서 동적 제스처 단위의 뎁스 이미지 집합을 획득하고, 상기 동적 제스처 단위의 뎁스 이미지 집합에서 제스처를 인식하기 위한 대상 물체의 윤곽선을 검출하여, 제스처와 관련한 중요한 정보를 포함 한 윤곽선과 상기 윤곽선 부근의 픽셀 정보를 집중적으로 처리함으로써, 동적 제스처를 보다 세밀하게 인식할 수 있도록 하는 효과가 있다. 또한 본 발명에 따른 딥러닝 기반 동적 제스처 인식 시스템 및 그 방법은 동적 제스처와 관련한 중요한 정보를 포함한 윤곽선과 상기 윤곽선 부근의 그레이스케일 이미지 데이터에 대한 전처리를 통해서 낮은 복잡도를 가진 학습모델을 사용하면서도 우수한 성능을 얻을 수 있는 효과가 있다."}
{"patent_id": "10-2022-0138446", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하, 첨부한 도면을 참조하여 본 발명의 딥러닝 기반 동적 제스처 인식 시스템 및 그 방법에 대한 바람직한 실 시예를 상세히 설명한다. 각 도면에 제시된 동일한 참조부호는 동일한 부재를 나타낸다. 또한 본 발명의 실시예 들에 대해서 특정한 구조적 내지 기능적 설명들은 단지 본 발명에 따른 실시예를 설명하기 위한 목적으로 예시 된 것으로, 다르게 정의되지 않는 한, 기술적이거나 과학적인 용어를 포함해서 여기서 사용되는 모든 용어들은"}
{"patent_id": "10-2022-0138446", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "본 발명이 속하는 기술분야에서 통상의 지식을 가진 자에 의해 일반적으로 이해되는 것과 동일한 의미를 가지고 있다. 일반적으로 사용되는 사전에 정의되어 있는 것과 같은 용어들은 관련 기술의 문맥상 가지는 의미와 일치 하는 의미를 가지는 것으로 해석되어야 하며, 본 명세서에서 명백하게 정의하지 않는 한, 이상적이거나 과도하 게 형식적인 의미로 해석되지 않는 것이 바람직하다. 본 발명에서 TOF 센서를 통한 뎁스 이미지를 이용하여 동적 제스처를 인식하고자 하는 것은 뎁스 이미지가 물체 와 배경을 분리하기에 용이하다는 점을 포함하고 있다. 또한 본 발명에서 사용하는 IR TOF 센서의 경우, 640x480 정도의 해상도를 가지는 시계열 뎁스 이미지의 집합을 출력할 수 있다. 동적 제스처를 인식하여 전자기기를 조작하는 경우, 동적 제스처의 위치를 컴퓨터상의 좌표에 매칭시켜 마우스 로 컨트롤하는 것과 동일한 원리로 조작할 필요가 있다. 시계열 뎁스 이미지의 집합을 이진 영상(이미지)으로 변환하면 제스처를 인식하기 위한 신체부위의 위치를 추적하기 쉬운 장점이 있다. 이하에서는 이러한 이해를 바 탕으로 본 발명의 기술적 특징에 대해서 설명하고자 한다. 도 1은 본 발명의 일 실시예에 따른 딥러닝 기반 동적 제스처 인식 시스템을 설명하기 위해 나타낸 개념도이다. 도 1에 도시한 바와 같이, 본 발명의 일 실시예에 따른 딥러닝 기반 동적 제스처 인식 시스템(이하 '동적 제스처 인식 시스템'이라 칭함)은 실내 환경에서 TOF 센서를 통해서 가시범위를 감지하는 경우에 적용된다. 즉, TOF 센서는 실내 환경을 감지하기 위해 설치되어 있다. TOF 센서로부터 상기 동적 제스처 인식 시스템에 입력되는 신호는 동적 제스처 단위의 뎁스 이미지 집합이다. 동적 제스처 단위의 뎁스 이미지 집합은 예컨대 엄지-검지간 움직임을 통해 음향의 레벨을 조정하는 것과 같이 엄지와 검지간의 거리를 빨리 혹은 느리게 움직여서 조정하는 것을 통해서 특정 전자기기를 제어할 수 있도록 할 수 있다. 따라서 뎁스 이미지 집합은 다양한 프레임 레이트로 동적 제스처의 속도를 인식하고 또한 제스처의 방향에 대한 인과관계를 인식할 수 있도록 할 수 있다. 그밖에도 스와이프(swipe), 포인팅 및 드레그에 대한 인 식을 포함한 다양한 동적 제스처의 인식이 가능하도록 할 수 있다. 동적 제스처 인식 시스템은 동적 제스처 단위의 뎁스 이미지 집합을 이용하여 미리 학습해둔 학습모델을 데이터베이스에 저장하여 두었다가 이를 불러와서 실내환경에서 움직이는 사용자의 동적 제스처를 인식한 다. 상기 동적 제스처의 인식은 사용자의 특정 동적 제스처를 딥러닝 학습모델을 이용하여 추정하여 최종적으로 인식하게 된다. 상기 추정한 결과는 가전기기, 조명기기 등 가정에 비치된 다양한 디지털 기기의 조 작을 위한 사용자 인터페이스(User Interface)를 제공하도록 연동될 수 있다. 상기 동적 제스처 인식 시스템은 입력된 동적 제스처 단위의 뎁스 이미지 집합에 해당하는 동적 제스처 레 이블을 추출하고 해당 동적 제스처 레이블로부터 사용자가 취한 제스처가 무엇인지 알 수 있게 된다. 즉, 동적 제스처의 레이블마다 해당 동적 제스처가 무엇인지 레이블링되어 있다. 예를 들어, 동적으로 손가락이 펴지는 형태에 따라 가전기기를 동작시키는 명령어가 매핑되어 있어서, 사용자의 동적 제스처가 특정 패턴을 가지는 것으로 인식되면 해당 패턴에 따라 해당 가전기기나 조명기기가 동작하도록 하면 된다. 본 발명에서는 동적 제스처 인식 결과를 가전기기나 조명기기와 어떻게 연결시키는지에 대해서는 그 범위에 포 함하고 있지 않으므로 구체적인 설명은 생략한다. 따라서 본 발명에서는 사용자의 동적 제스처를 가능한 적은하드웨어 리소스로 보다 정확하게 인식할 수 있는 방법과 그 시스템에 대해서 제시한다. 이어서 도 2를 참조하여 본 발명의 일 실시예에 따른 딥러닝 기반 동적 제스처 인식 시스템의 전체 구성에 대해 서 설명하고자 한다. 도 2는 본 발명의 일 실시예에 따른 딥러닝 기반 동적 제스처 인식 시스템의 구성을 나타낸 도면이다. 도 2에 도시된 바와 같이, 본 발명의 일 실시예에 따른 딥러닝 기반 동적 제스처 인식 시스템은, 뎁스 이 미지 집합 수신부, 동적 제스처 전처리부 및 동적 제스처 인식부를 포함하여 구성된다. 상기 뎁스 이미지 집합 수신부는, TOF 센서로부터 동적 제스처 단위의 뎁스 이미지 집합을 수신하는 것이다. 즉, 동적 제스처 단위의 뎁스 이미지 집합은 그레이스케일로 표현된 소정의 해상도를 가진 이미지 데이터이 다. 상기 동적 제스처 단위의 뎁스 이미지 집합은 TOF 센서가 감지하는 전체 장면의 이미지이다. 따라서 상기 뎁스 이미지 집합 수신부는 수신한 동적 제스처 단위의 뎁스 이미지 집합을 전처리하기에 적합한 소정의 크기나 방향으로 일관성있게 조정하여 저장하는 역할을 수행한다. 상기 동적 제스처 전처리부는, 상기 동적 제스처 단위의 뎁스 이미지 집합을 딥러닝 네트워크(하이브리드 CNN-RNN)에서 처리하기에 적합하도록 미리 수정, 가공, 편집 등을 포함한 처리를 수행하는 역할을 하는 것으로, 본 발명에서 동적 제스처 전처리부에서 딥러닝 네트워크의 복잡도를 낮추면서 성능을 향상시키기 위한 핵 심적인 역할을 수행한다. 즉, 전체 동적 제스처 단위의 뎁스 이미지 집합 중에서 관심영역인 시계열 ROI를 설정 하고, 해당 시계열 ROI 중에서 윤곽선 경계를 추출하고, 추출한 경계에 따라 딥러닝 네트워크에서 학습하기에 용이하도록 시계열 ROI 이진 이미지와 시계열 ROI 윤곽선 주변 그레이스케일 이미지를 생성하도록 한다. 여기서 시계열 ROI 윤곽선 주변 그레이스케일 이미지는 각 ROI를 중심으로 일정거리 내에 있는 픽셀들에 대해서 입력된 동적 제스처 단위의 뎁스 이미지 집합의 픽셀값들을 그대로 유지하고 나머지 부분들의 픽셀은 배경과 동 일하게 대체(예: '0')한 것일 수 있다. 상기 ROI를 중심으로 일정거리 내에 있는 픽셀들은 서브ROI라고 한다. 또한 본 발명에서는 ROI의 모양이나 서브ROI의 기하학적 모양은 사각형, 원형 등 그 제한이 없다. 상기 동적 제스처 인식부는, 상기 전처리된 시계열 ROI 이진 이미지와 시계열 ROI 윤곽선 주변 그레이스케 일 이미지를 각각 별도의 딥러닝 학습모델로 학습하여 생성하고, 상기 생성한 각 학습모델을 이용하여 동적 제 스처를 추정하는 역할을 한다. 즉, 동일한 입력 동적 제스처 단위의 시계열 뎁스 이미지 집합으로부터 시계열 ROI 이진 이미지를 통해서 추정한 제1 동적 제스처와 시계열 ROI 윤곽선 주변 그레이스케일 이미지를 통해서 추 정한 제2 동적 제스처를 이용하여 그 추정 결과가 동일하면 바로 해당 동적 제스처를 최종 결과로 선정하여 출 력하고, 동일하지 않고 상이하다면 양 결과를 평균하여 확률치가 가장 높은 추정 결과를 최종 결과로 선택하여 출력할 수 있도록 한다. 또한 상기 추정 결과가 상이하면, 성능평가를 수행하고 상기 성능평가 결과에 따라 제1 학습모델과 제2 학습모델 중 더 정밀한 학습모델의 결과를 최종 결과로 선택하여 출력할 수도 있다. 상기 학습모델의 학습과정에서는 학습 결과를 입력된 이미지와 비교, 검증하여 해당 결과를 역전파시켜 딥러닝 네트워크의 각 레이어에 대한 가중치를 업데이트하도록 함으로써 학습모델을 더욱 고도화시킨다. 이러한 역전파 과정을 통해서 각 학습모델의 성능은 상호 교차적으로 개선될 수 있게 된다. 이하에서는 도 3을 참조하여 상기 동적 제스처 전처리부의 구성을 더욱 자세하게 설명하고자 한다. 도 3은 본 발명의 일 실시예에 따른 딥러닝 기반 동적 제스처 인식 시스템에서 동적 제스처 단위의 뎁스 이미지 집합의 동적 제스처 전처리를 위한 구성을 나타낸 도면이다. 도 3의 (a)에 도시된 바와 같이, 상기 동적 제스처 전처리부는 시계열 ROI 설정부, 시계열 윤곽선 추 출부 및 시계열 전처리 ROI 이미지 생성부를 포함하여 구성된다. 먼저 상기 시계열 ROI 설정부는, 뎁스 이미지 집합 수신부로부터 입력된 TOF 센서의 전체 장면에서 관심영역(ROI)을 설정하는 역할을 한다. 관심영역은 동적 제스처를 발생시키는 사람의 전체적인 신체의 모양이 될 수도 있고, 손, 머리, 팔, 다리, 발 등 그 제한이 없다. 다만, 통상적으로 동적 제스처는 손 모양의 변화를 통해서 전달되므로, 손 모양의 변화를 대표적으로 취급하여 설명한다. 이러한 관점에서 보면, 수화를 인식하는 시스템으로 본 발명의 동적 제스처 인식 시스템의 용도를 확장할 수 있음이 당연하다. 상기 ROI는 관심영역을 포함하는 최외곽선에 포함된 영역을 말하는 것으로, 손을 ROI로 설정할 경우, 손바닥과 손가락을 포함한 영역이 될 수 있다. 즉, 굳이 팔을 포함하지 않아도 된다. 다만, 팔을 포함하여 팔의 방향이 위로 향할 때와 아래로 향할 때에 특별한 의미를 부여하여 레이블링할 경우 팔을 포함할 수도 있다.상기 시계열 윤곽선 추출부는, 시계열 윤곽선 위치 추출부(122a)와 시계열 윤곽선 기울기 추출부(122b)를 포함하여 구성된다. 상기 시계열 윤곽선 위치 추출부(122a)는 윤곽선의 존재여부와 윤곽선의 위치에 대한 좌표를 추출한다. 즉, 윤 곽선의 존재여부에 대해서는 ROI 동적 제스처 단위의 뎁스 이미지 집합에서 인접 픽셀간의 밝기에 대한 변화량 을 추출하고, 해당 변화량에 대해서 1차 미분을 통해서 윤곽선의 존재여부를 판단하는 과정을 수행하는 것이다. 다음으로 윤곽선의 위치는 상기 변화량을 1차 미분한 결과에 대해서 2차 미분을 수행하여 기울기의 부호로 윤곽 선 픽셀의 밝고 어두운 부분의 위치를 판별하여 획득한다. 상기 시계열 윤곽선 기울기 추출부(122b)는, 상기 판별한 인접 픽셀간의 기울기에서 기울기 벡터를 구하고, 벡 터의 크기와 방향을 산출하는 역할을 한다. 상기 기울기 벡터는 수평방향 및 수직방향 기울기를 포함하고, 상기 방향은 상기 벡터로부터 구해진다. 물론 상기 윤곽선을 구하는 것은 마스크 연산자를 사용하여도 된다. 이렇게 산출된 윤곽선의 유무, 위치, 크기 및 방향을 통해서 해당 ROI 이미지에서 윤곽선을 추출할 수 있다. 상기 시계열 전처리 ROI 이미지 생성부는 시계열 ROI 이진화부(123a)와 시계열 ROI 윤곽선 주변 그레이스 케일화부(123b)를 포함하여 구성된다. 상기 ROI 이진 이미지와 ROI 윤곽선 주변 그레이스케일 이미지는 도 3의 (b)에 도시되어 있다. 상기 시계열 ROI 이진화부(123a)는 상기 추출한 ROI 이미지 윤곽선에서 동적 제스처 인식 대상 신체부위(전경) 와 배경부분을 구분하여 이를 서로 다르게 각각 소정의 픽셀, 즉 0 혹은 1로 구성된 이진 이미지를 생성하는 역 할을 한다. 이 과정은 특정 색을 채워도 무방하다. 특정 색을 채울 경우, 해당 색을 표현하기 위한 더욱 많은 비트폭의 데이터가 필요하므로 하드웨어 복잡도 측면에서 불리할 수 있다. 상기 시계열 ROI 윤곽선 주변 그레이스케일화부(123b)는 상기 추출한 ROI 이미지 윤곽선에서 소정의 거리 이내 에 있는 픽셀들의 서브ROI에는 그레이스케일 값을 그대로 포함하도록 하고, 상기 소정의 거리를 벗어나는 부분 은 배경과 동일하게 처리하여 구분시킨 이미지를 생성한다. 예를 들어 '0'값으로 채운다. 이 경우 윤곽선 주변 의 픽셀 값만 존재하고 나머지 부분들은 전부 배경(예: '0')으로 처리함으로써 제스처를 더욱 세밀하게 인식하 고자 한다. 상기 윤곽선 주변의 그레이스케일 이미지 부분을 서브ROI라고 한다. 이렇게 생성된 시계열 ROI 이진 이미지 또는 시계열 ROI 윤곽선 주변 그레이스케일 이미지를 사용하면 각 딥러 닝 학습모델을 통해서 낮은 하드웨어 복잡도로 매우 높은 정확도를 가지고 원하는 동적 제스처 레이블을 각각 획득할 수 있는 장점이 있다. 이어서 상기 생성한 시계열 ROI 이진 이미지 또는 시계열 ROI 윤곽선 주변 그레이스케일 이미지를 각각 학습모 델에 입력하여 각각의 동적 제스처 레이블 집합을 생성하고, 각각 생성된 동적 제스처 레이블 집합으로 최종적 인 동적 제스처 레이블을 추출하는 과정에 대해서 도 4를 참조하여 설명하고자 한다. 도 4는 본 발명의 일 실시예에 따른 딥러닝 기반 동적 제스처 인식 시스템에서 딥러닝을 통한 동적 제스처 인식 을 위한 구성을 나타낸 도면이다. 도 4에 도시된 바와 같이, 본 발명의 일 실시예에 따른 딥러닝 기반 동적 제스처 인식 시스템의 상기 동적 제스처 인식부는 제1 동적 제스처 추정부, 제2 동적 제스처 인식부 및 동적 제스처 레이블 앙상 블부를 포함하여 구성된다. 상기 제1 동적 제스처 추정부는 복수의 수많은 시계열 ROI 이진 이미지들에 각 해당하는 동적 제스처 레이 블을 부가하여 학습하여 생성한 제1 학습모델을 이용하여, 시계열 ROI 이진 이미지를 입력하여 해당하는 제1 동 적 제스처 레이블 집합의 각 확률값을 추출한다. 또한 제2 동적 제스처 추정부는 복수의 수많은 시계열 ROI 윤곽선 주변 그레이스케일 이미지들에 각 해당 하는 동적 제스처 레이블을 부가하여 학습하여 생성한 제2 학습모델을 이용하여, 시계열 ROI 윤곽선 주변 그레 이스케일 이미지를 입력하여 해당하는 제2 동적 제스처 레이블 집합의 각 확률값을 추출한다. 상기 동적 제스처 레이블 앙상블부는, 상기 추출한 제1 및 제2 동적 제스처 레이블 집합의 각 확률값을 상 호 매칭하여 평균한 다음, 랭킹을 매겨 가장 높은 확률을 가진 동적 제스처 레이블을 최종 선정하여 동적 제스 처 레이블로 출력하고, 해당 동적 제스처 레이블이 동적 제스처를 추정한 결과가 된다. 이하에서는 본 발명의 일 실시예에 따라 상기 제1 동적 제스처 추정부와 제2 동적 제스처 추정부에 각각 사용되는 제1 학습모델과 제2 학습모델을 생성하는 방법에 대해서 설명하고자 한다. 도 5는 본 발명의 일 실시예에 따른 딥러닝 기반 동적 제스처 인식 시스템에서 제스처 추정을 위한 딥러닝 학습 모델의 생성 과정과 그 결과로 생성된 학습모델을 나타낸 도면이다. 예를 들어, 3장의 시계열 이미지 데이터가 입력되면, 각각의 이미지 데이터에 대해서 CNN을 통해서 이미지에 포 함된 특징정보를 학습하도록 한다. 원래 CNN은 컨볼루션 레이어와 서브 샘플링을 딥하게 반복하다가 최종적으로 는 완전 연관 네트워크(fully connected network)를 통해서 상기 특징을 분류하게 된다. 그러나 본 발명에서는 CNN의 완전 연관 네트워크를 RNN을 통해서 처리하도록 구성한다. 즉, CNN의 완전 연관 네 트워크 대신에 완전 연관 RNN을 수행함으로써, 완전 연관 RNN은 이미지 데이터 간의 시계열적인 관계를 학습하 여 분류하도록 한다. 즉, 복수의 이미지 프레임이 시계열적으로 변화하는 연관관계를 학습하도록 함으로써, 동적 제스처의 시계열적 인 특징을 학습하도록 하는 것이다. RNN은 도 5와 같이 자신의 상태를 재귀적으로 업데이트하는 것으로 표현되 며, 이는 평면적으로 나타낼 경우 2차원적인 상태 네트워크로 나타낼 수 있다. 이러한 2차원적인 상태 네트워크 가 복수의 이미지 프레임에 대해서 입체적으로 연결되면 3차원 RNN이 구성된다. 이러한 RNN을 Stacked RNN이라 고도 하며, Deep RNN이라고도 한다. 도 6은 본 발명의 일 실시예에 따른 딥러닝 기반 동적 제스처 인식 시스템에서 제스처 추정을 위한 딥러닝 학습 모델의 생성 과정과 그 결과로 생성된 학습모델의 구성을 상세하게 나타낸 도면이다. 도 6에 도시된 바와 같이, 본 발명의 일 실시예에 따른 딥러닝 기반 동적 제스처 인식 시스템에서 수행하는 제1 학습모델 및 제2 학습모델은 각각 하이브리드 CNN-RNN을 기반으로 구성하며, 제1 학습모델은 복수의 제스처에 대한 시계열 이진 이미지(binary image)를 레이블링하여 CNN에 입력하여 이미지의 특징을 학습하고, 이어서 완 전 연관 RNN을 통해서 시계열적인 특징을 분류하도록 네트워크 파라미터를 학습시킨 다음 출력을 기준 시계열 이진 이미지에 대한 동적 제스처 레이블과 대비하여 검증한 다음 해당 결과를 역전파하여 네트워크를 업데이트 하는 과정을 반복하여 학습모델을 생성한다. 제1 학습모델에서 CNN의 구성은 먼저, 각 이진 이미지 데이터를 입력하는 입력 레이어, 상기 입력 레이어의 이 진 이미지 데이터를 미리 설정한 스트라이드에 따라 이동해 가면서 소정 크기의 필터로 컨벌루션하는 컨벌루션 레이어, 및 상기 컨볼루션한 특정 부분을 최대값이나 평균값으로 풀링하여 서브샘플링(subsampling)을 수행하는 풀링 레이어(pooling layer) 및 완전 연관 RNN 레이어(fully connected RNN layer)로 구성된다. 완전 연관 RNN 레이어는 각 CNN의 결과를 입체적으로 연관시켜 학습하게 된다. 입력 레이어는 전처리 과정을 통해 이진 이미지화된 학습 데이터를 입력받으며, 상기 컨볼루션 레이어는 특정 사이즈의 필터를 가지고 미리 설정한 스트라이드(상기 커널의 이동단위를 의미함)에 따라 이동해 가면서 컨볼루 션하여, 상기 이진 이미지의 특정 부분에 대한 특징 맵(feature map)을 생성하여 출력한다. 풀링 레이어는 맥스 풀링(max pooling) 또는 평균값 풀링(average pooling)방법을 통해 상기 커널과 스트라이드 의 크기에 따라 상기 특징 맵을 풀링함으로써, 적어도 하나 이상의 서브 이미지 데이터로 서브 샘플링한다. 또한 상기 CNN은 상기 컨볼루션과 서브 샘플링 과정을 반복적으로 수행하여 특정 동적 제스처를 나타내는 시계 열 이진 이미지에 대한 동적 제스처 레이블에 대한 특징 맵을 생성할 수 있도록 한다. 완전 연관 RNN 레이어는 상기 특징 맵을 시계열적으로 연결하여 각 동적 제스처를 동적 레이블별로 분류하는 역 할을 한다. 이를 통해서 전체 동적 제스처 레이블의 총 확률값이 1이 되는 각 동적 제스처 레이블의 확률값이 출력된다. 즉, 입체적으로 연결된 완전 연관 레이어는 sigmoid 함수를 통과하여 출력되는 것이다. 이러한 과정 은 LSTM(Long-Short Term Memory)으로 구성하는 것도 가능하다. 입력 레이어를 통해서 입력된 시계열 이진 이미지에 대한 동적 제스처 레이블은 이미 알고 있는 상태에서 완전 연관 RNN 레이어를 통해서 출력되는 각 동적 제스처별 레이블에 대한 확률값을 비교하여 해당 동적 제스처 레이 블을 추정한 확률값을 높이도록 역전파를 통해 하이브리드 CNN-RNN의 네트워크 가중치를 조정할 수 있다. 이를 통해서 하이브리드 CNN-RNN의 정확도를 향상시킨다. 즉, 입력한 시계열 이진 이미지의 동적 제스처 레이블과 출력된 제1 동적 제스처 레이블의 각 확률값을 비교하 여 평가한 다음, 그 결과를 역전파하여 하이브리드 CNN-RNN 파라미터를 수정하도록 하는 과정을 반복하여 제1 학습모델을 생성한다.다음으로, 시계열 그레이스케일 이미지 데이터를 입력하여 컨벌루션 레이어를 실행하고, 이어서 그 결과를 서브 샘플링하는 과정을 반복한 후, 전체적으로 연결된 완전 연관 RNN 레이어를 통해서 제2 동적 제스처 레이블 집합 에 대한 확률값을 출력한다. 입력한 시계열 그레이스케일 이미지의 동적 제스처 레이블과 제2 동적 제스처 레이 블 집합의 각 확률값을 비교하여 평가한 다음 그 결과를 역전파하여 하이브리드 CNN-RNN 파라미터를 수정하도록 하는 과정을 반복하여 제2 학습모델을 생성한다. 상기 제1 동적 제스처 레이블 집합과 제2 동적 제스처 레이블 집합의 각 확률값을 상호 매칭하여 확률이 높은 순으로 정렬한 다음 제일 높은 확률을 가진 동적 제스처 레이블을 최종 출력(final output)으로 결정하게 된다. 상기 선정한 최종 출력을 역전파하여 하이브리드 CNN-RNN 파라미터를 수정하도록 하는 과정을 수행한다. 상기 역전파는 상기 제1 학습모델과 제2 학습모델을 별개로 하여 해당 출력을 입력과 비교 평가하여 역전파할 수도 있고, 최종 앙상블 평균(ensemble average)을 시계열 이진 이미지와 시계열 그레이스케일 이미지를 각각 비교하 여 평가한 다음 역전파하여 하이브리드 CNN-RNN 파라미터를 수정할 수도 있다. 이어서 본 발명의 일 실시예에 따른 딥러닝 기반 동적 제스처 인식 시스템의 구성을 설명하고자 한다. 도 7은 본 발명의 일 실시예에 따른 딥러닝 기반 동적 제스처 인식 시스템의 구성을 나타낸 블록도이다. 도 7에 도시된 바와 같이, 본 발명의 일 실시예에 따른 딥러닝 기반 동적 제스처 인식 시스템은 뎁스 이미 지 집합 수신부, 동적 제스처 전처리부 및 동적 제스처 인식부를 포함하여 구성된다. 여기서 상기 뎁스 이미지 집합 수신부는 TOF 센서를 통해서 동적 제스처 단위의 뎁스 이미지 집합을 수신 하는 역할을 한다. 본 발명에서는 복수의 동적 제스처 단위의 뎁스 이미지 집합을 획득하여 하나의 집합으로 구 성할 필요가 있다. 즉, 복수의 동적 제스처 단위의 뎁스 이미지 집합을 수신하여 저장한 다음 하나의 제스처에 해당하는 동적 제스처 단위의 뎁스 이미지 집합의 집합을 구성하는 것을 포함한다. 상기 동적 제스처 전처리부는 시계열 ROI 설정부, 시계열 윤곽선 추출부 및 시계열 전처리 ROI 이미지 생성부를 포함하여 구성된다. 상기 시계열 ROI 설정부는 적어도 하나 이상의 동적 제스처 단위의 뎁스 이미지 집합에 대해서 동적 제스 처 인식을 위한 객체를 포함하는 관심영역, 즉 ROI를 설정한다. ROI의 경우도 복수의 동적 제스처 단위의 뎁스 이미지 집합에 대해서 각각 ROI를 생성하여 ROI만을 포함한 동적 제스처 단위의 뎁스 이미지 집합의 집합을 생 성하는 역할을 한다. 상기 시계열 윤곽선 추출부는 동적 제스처 단위의 뎁스 이미지 집합의 ROI로부터 윤곽선의 존재여부, 위치, 기울기 및 방향을 포함한 윤곽선 정보를 추출한다. 동적 제스처의 경우에는 정적인 제스처의 시계열적인 집합을 구성하는 것을 포함한다. 상기 시계열 전처리 ROI 이미지 생성부는 상기 추출된 ROI의 윤곽선과 관련한 각 정보를 이용하여 해당 윤 곽선을 중심으로 이진 이미지를 생성하거나, 윤곽선의 소정 범위에 속한 동적 제스처 단위의 뎁스 이미지 집합 의 그레이스케일을 포함한 그레이스케일 이미지를 생성한다. 또한 복수의 시계열적인 ROI 동적 제스처 단위의 뎁스 이미지 집합에 대해서 생성한 이진 이미지나 그레이스케일 이미지의 집합을 생성한다. 상기 생성한 복수의 전처리 ROI 이미지를 이진 이미지 및 그레이스케일 이미지로 생성하여 각 학습모델에 입력 하도록 한다. 상기 동적 제스처 인식부는 제1 동적 제스처 추정부, 제2 동적 제스처 추정부 및 동적 제스처 레이블 앙상블부를 포함하여 구성된다. 상기 제1 동적 제스처 추정부는 상기 생성된 전처리 ROI 이진 이미지를 제1 학습모델에 입력하여 이진 이 미지로 입력된 동적 제스처 단위의 뎁스 이미지 집합의 제스처에 대한 레이블을 추출하여 해당 제스처를 추정한 다. 상기 추출한 레이블을 입력된 이진 이미지의 레이블과 대비하여 평가한 다음 제1 학습모델의 파라미터를 역 전파를 통해서 트레이닝한다. 상기 제2 동적 제스처 추정부는 상기 생성된 전처리 ROI 스레이스케일 이미지를 제2 학습모델에 입력하여 그레이스케일 이미지로 입력된 동적 제스처 단위의 뎁스 이미지 집합의 제스처에 대한 레이블을 추출하여 해당 제스처를 추정한다. 상기 추출한 레이블을 입력된 그레이스케일 이미지의 레이블과 대비하여 평가한 다음 제2 학습모델의 파라미터를 역전파를 통해서 트레이닝한다.상기 동적 제스처 레이블 앙상블부는 상기 제1 동적 제스처 추정부 및 제2 동적 제스처 추정부 를 통해서 추정한 제1 제스처 레이블 집합과 제2 제스처 레이블 집합을 상호 매칭하여, 제1 학습모델과 제2 학 습모델의 결과를 종합하여 전체적인 출력 레이블을 추출하는 역할을 한다. 이렇게 추출된 레이블을 이진 이미지 나 그레이스케일 이미지의 각 레이블과 대비하여 평가한 다음 선정한 최종 결과를 다시 제1 학습모델과 제2 학 습모델에 역전파하여 트레이닝하도록 한다. 이하에서는 도 8을 참조하여 딥러닝 기반 동적 제스처 인식 방법에 대해서 설명하고자 한다. 도 8은 본 발명의 일 실시예에 따른 딥러닝 기반 동적 제스처 인식 방법을 나타낸 흐름도이다. 도 8에 도시된 바와 같이, 본 발명의 일 실시예에 따른 딥러닝 기반 동적 제스처 인식 방법은 뎁스 이미지 집합 수신부를 통해서 TOF 센서로부터 동적 제스처 단위의 뎁스 이미지 집합을 수신하는 단계를 수행한다 (S110). 이어서 동적 제스처 전처리부를 통해서 상기 수신한 동적 제스처 단위의 뎁스 이미지 집합에서 ROI를 설정 하는 단계를 수행한다(S120). 상기 동적 제스처 전처리부에서는 ROI 동적 제스처 단위의 시계열 ROI 뎁스 이미지 집합을 전처리하는 단계를 수행한다(S130). 상기 동적 제스처 전처리 단계는 먼저 1) 윤곽선 존재여부 및 윤곽선 위치 추출하고, 다음으로 2) 윤곽선 기울기 크기/윤곽선 방향(x, y 축 기준)을 추출하며, 상기 윤곽 선의 존재여부, 위치, 기울기 크기 및 방향을 통해서 3) 시계열 이진 이미지 및 시계열 그레이스케일 이미지를 생성한다. 다음으로 상기 생성한 이진 이미지와 그레이스케일 이미지를 각각 이용하여 동적 제스처 인식 단계를 수행한다 (S140). 상기 동적 제스처 인식은 1) 상기 시계열 이진 이미지를 제1 학습모델에 입력하여 제1 동적 제스처 레 이블 집합을 추출한다. 또한 상기 동적 제스처 인식 단계는 2) 시계열 그레이 스케일 이미지를 제2 학습모델에 입력하여 제2 동적 제스처 레이블 집합을 추출한다. 다음으로 3) 1), 2)의 결과를 앙상블하여 최종 동적 레이블 을 추출한다. 여기서 학습단계에서는 상기 제1 및 제2 동적 제스처 레이블 집합을 상기 제1 학습모델과 제2 학 습모델에서 역전파를 통해서 파라미터를 갱신하도록 하여 최종적인 제1 학습모델과 제2 학습모델을 생성하게 된다. 다음으로 최종적인 동적 제스처 인식 결과를 동적 제스처 레이블로 출력하게 된다(S150). 이처럼, 본 발명의 딥러닝 기반 동적 제스처 인식 시스템 및 그 방법은 특정 공간에 대한 가시영역을 감지하는 TOF 센서를 통해서 동적 제스처 단위의 뎁스 이미지 집합을 획득하고, 상기 동적 제스처 단위의 뎁스 이미지 집 합에서 제스처를 인식하기 위한 대상 물체의 윤곽선을 검출하여, 동적 제스처와 관련한 중요한 정보를 포함한 윤곽선과 윤곽선 부근의 픽셀 정보를 집중적으로 처리함으로써, 동적 제스처를 보다 세밀하게 인식할 수 있도록 하는 효과가 있다. 또한 본 발명에 따른 딥러닝 기반 동적 제스처 인식 시스템 및 그 방법은 제스처와 관련한 중요한 정보를 포함 한 윤곽선과 상기 윤곽선 부근의 이미지 데이터에 대한 전처리를 통해서 낮은 복잡도를 가진 학습모델을 사용하 면서도 우수한 성능을 얻을 수 있는 효과가 있다. 이상에서와 같이 본 발명은 도면에 도시된 실시예를 참고로 하여 설명되었으나, 이는 예시적인 것에 불과하며, 당해 기술이 속하는 분야에서 통상의 지식을 가진 자라면 이로부터 다양한 변형 및 균등한 타 실시예가 가능하 다는 점을 이해할 것이다. 따라서 본 발명의 기술적 보호범위는 아래의 특허청구범위에 의해서 판단되어야 할 것이다."}
{"patent_id": "10-2022-0138446", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 일 실시예에 따른 딥러닝 기반 동적 제스처 인식 시스템을 설명하기 위해 나타낸 개념도이다. 도 2는 본 발명의 일 실시예에 따른 딥러닝 기반 동적 제스처 인식 시스템의 구성을 나타낸 도면이다. 도 3은 본 발명의 일 실시예에 따른 딥러닝 기반 동적 제스처 인식 시스템에서 동적 제스처 단위의 뎁스 이미지 집합의 동적 제스처 전처리를 위한 구성을 나타낸 도면이다. 도 4는 본 발명의 일 실시예에 따른 딥러닝 기반 동적 제스처 인식 시스템에서 딥러닝을 통한 동적 제스처 인식 을 위한 구성을 나타낸 도면이다.도 5는 본 발명의 일 실시예에 따른 딥러닝 기반 동적 제스처 인식 시스템에서 제스처 추정을 위한 딥러닝 학습 모델의 생성 과정과 그 결과로 생성된 학습모델을 나타낸 도면이다. 도 6은 본 발명의 일 실시예에 따른 딥러닝 기반 동적 제스처 인식 시스템에서 제스처 추정을 위한 딥러닝 학습 모델의 생성 과정과 그 결과로 생성된 학습모델의 구성을 상세하게 나타낸 도면이다. 도 7은 본 발명의 일 실시예에 따른 딥러닝 기반 동적 제스처 인식 시스템의 구성을 나타낸 블록도이다. 도 8은 본 발명의 일 실시예에 따른 딥러닝 기반 동적 제스처 인식 방법을 나타낸 흐름도이다."}
