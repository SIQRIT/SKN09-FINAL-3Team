{"patent_id": "10-2022-0151338", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2024-0071431", "출원번호": "10-2022-0151338", "발명의 명칭": "컴포넌트-인식 트랜스포머를 바탕으로 심방세동을 진단하는 전자 장치의 제어 방법", "출원인": "충북대학교병원", "발명자": "신윤미"}}
{"patent_id": "10-2022-0151338", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "전자 장치에 있어서,AF(Atrial Fibrillation)에 대한 진단을 수행하기 위한, 트랜스포머(Transformer) 기반의 CAT(Component-awareTransformer) 모델을 포함하는 메모리; 및ECG(electrocardiogram)에 컴포넌트 별로 토큰화를 수행하여 복수의 토큰(token)을 획득하고, 상기 복수의 토큰을 상기 CAT 모델에 입력하여 AF에 대한 진단 결과를 획득하는, 프로세서;를 포함하는, 전자 장치."}
{"patent_id": "10-2022-0151338", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 프로세서는,상기 ECG의 P, QRS, 및 T를 바탕으로 상기 ECG를 복수의 컴포넌트로 구분하고,상기 복수의 컴포넌트 각각을 일정한 차원 수에 따라 토큰화하여 복수의 토큰을 획득하는, 전자 장치."}
{"patent_id": "10-2022-0151338", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제2항에 있어서,상기 프로세서는,일 컴포넌트를 구성하는 신호의 시간 길이가 제1 길이 이상인 경우, 상기 신호 중 상기 제1 길이를 초과하는 부분을 잘라내고, 상기 컴포넌트를 구성하는 신호의 시간 길이가 상기 제1 길이 미만인 경우, 상기 신호의 시간길이가 상기 제1 길이가 되도록 제로 패딩을 수행하여, 상기 신호가 상기 제1 길이에 매칭되는 제1 차원 수를갖도록 재구성하는, 전자 장치."}
{"patent_id": "10-2022-0151338", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제3항에 있어서,상기 프로세서는,상기 재구성된 신호의 값을 나타내며 상기 제1 차원 수에 매칭되는 제1 벡터를 획득하고,상기 신호의 시간 길이를 나타내며 제2 차원 수에 매칭되는 제2 벡터를 획득하고,상기 신호의 유형을 나타내며 제3 차원 수에 매칭되는 제3 벡터를 획득하고,상기 제1 벡터, 상기 제2 벡터, 및 상기 제3 벡터를 포함하는 토큰을 획득하는, 전자 장치."}
{"patent_id": "10-2022-0151338", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제1항에 있어서,상기 CAT 모델은,단일 리드로 구성된 상기 ECG로부터 획득된 복수의 토큰 각각을 입력 받는 트랜스포머 인코더(TransformerEncoder); 및상기 트랜스포머 인코더의 출력을 바탕으로 AF 여부를 진단하는 MLP(Multi-Layer Perceptron) 헤드;를포함하는, 전자 장치."}
{"patent_id": "10-2022-0151338", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "공개특허 10-2024-0071431-3-제1항에 있어서,상기 ECG는 12-리드 ECG에 해당하고,상기 CAT 모델은,상기 ECG에 포함된 12가지 유형의 리드 각각에 매칭되며, 각 리드를 기초로 획득된 복수의 토큰을 입력 받는,서로 독립된 복수의 트랜스포머 인코더(Transformer Encoder); 및상기 복수의 트랜스포머 인코더의 출력들이 결합된 결합 토큰(concatenated token)이 획득되면, 상기 결합 토큰을 바탕으로 AF 여부를 진단하는 MLP(Multi-Layer Perceptron) 헤드;를 포함하는, 전자 장치."}
{"patent_id": "10-2022-0151338", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제1항에 있어서,상기 프로세서는,상기 ECG에 대해 저역 통과 필터링을 수행하여 저역 신호를 획득하고,커널 크기가 서로 다른 두 개의 median 필터를 바탕으로 상기 ECG의 추세 곡선을 추정하고,상기 저역 신호에서 상기 추세 곡선을 차감하여, 전처리된 ECG(preprocessed ECG)를 획득하고,상기 전처리된 ECG에 컴포넌트 별로 토큰화를 수행하여 상기 복수의 토큰을 획득하는, 전자 장치."}
{"patent_id": "10-2022-0151338", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "AF(Atrial Fibrillation)에 대한 진단을 수행하기 위한 트랜스포머(Transformer) 기반의 CAT(Component-awareTransformer) 모델을 포함하는 전자 장치의 제어 방법에 있어서,상기 전자 장치가, ECG(electrocardiogram)에 컴포넌트 별로 토큰화를 수행하여 복수의 토큰(token)을 획득하는단계; 및상기 전자 장치가, 상기 복수의 토큰을 상기 CAT 모델에 입력하여 AF에 대한 진단을 수행하는 단계;를포함하는, 전자 장치의 제어 방법."}
{"patent_id": "10-2022-0151338", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "전자 장치의 프로세서에 의해 실행되어 상기 전자 장치로 하여금 제8항의 제어 방법을 수행하도록 하는 컴퓨터프로그램이 저장된 비일시적 컴퓨터 판독 가능 매체."}
{"patent_id": "10-2022-0151338", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "전자 장치가 개시된다. 본 전자 장치는, AF(Atrial Fibrillation)에 대한 진단을 수행하기 위한, 트랜스포머 (Transformer) 기반의 CAT(Component-aware Transformer) 모델을 포함하는 메모리, ECG(electrocardiogram)에 컴포넌트 별로 토큰화를 수행하여 복수의 토큰(token)을 획득하고, 복수의 토큰을 상기 CAT 모델에 입력하여 AF 에 대한 진단 결과를 획득하는, 프로세서를 포함한다."}
{"patent_id": "10-2022-0151338", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 개시는 심방세동을 진단하는 전자 장치의 제어 방법에 관한 것으로, 보다 상세하게는, 트랜스포머 기반 인공 지능 모델을 통해 심방세동을 진단하는 전자 장치의 제어 방법에 관한 것이다."}
{"patent_id": "10-2022-0151338", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "심방세동(Atrial fibrillation, AF)은 비정상적인 심방 수축으로 인한 불규칙한 심장 박동을 특징으로 하는 심 장 부정맥의 한 유형이다. 심방세동은 심계 항진이나 현기증으로 인한 삶의 질 저하와 관련이 있으며 심부전, 전신 색전증, 허혈성 뇌졸중, 치매와 같은 동반 질환을 유발할 수 있다. 따라서 심방세동을 조기에 발견하면 심 방세동으로 인한 이환율과 사망률을 낮춤으로써 의료비를 줄일 수 있다. 심방세동은 불규칙한 R-R 간격과 불분명한 P파를 갖는 비정상적인 파형을 나타내는 심전도(ECG)를 기반으로 임 상적으로 진단된다. 심전도 기반 심방세동 진단은 심장 전문의의 임상 경험에 크게 의존하여 시간이 많이 걸리 고 관찰자 간 변동성에 취약할 수 있기 때문에, 자동 추출 및 고급 레벨 분석 등이 가능한 다양한 딥 러닝(DL) 모델이 개발되었다. AF 진단과 관련하여, Baalman et al.은 R-to-R 피크 검출기로 분리된 단일 주기 샘플을 활용하는 MLP(Multilayer Perceptron) 기반 모델을 제안했다. 또한, Cai et al.은 DDNN(Deep Densely-Connected NeuralNetwork)을 사용하여 12-리드 ECG 신호의 다중 스케일 기능을 고려한 AF 사례를 식별하였다. ECG 신호의 로컬 정보를 활용하기 위해 Fan et al.은 CNN(Convolutional Neural Network) 기반 방법을 설계했 다. O. Faust et al., Z. Zhang et al. 등 일부 방법은 ECG 신호에서 시간 정보를 추출하기 위해 순환 신경망 (RNN)을 사용했다. O. Faust et al.은 RR 간격 시간을 LSTM(Long Short Term Memory) 네트워크를 통해 측정하 고 분석했다. 또한 심전도 신호에서 시공간적 특징을 얻기 위해 CNN과 LSTM을 결합한 하이브리드 모델을 이용한 AF 진단 방법이 제안되었다(Z. Zhang et al.). 또한, 모델의 훈련 시간을 줄이기 위해 인간에 의해 검증된 반-지도(semi-supervised) 학습 기반의 방법도 제안 되었다(F. J. Esselius et al.). 비록, 앞서 언급한 연구들에서는 DL 알고리즘이 AF 진단에 적합하다는 것을 보여주었지만 대부분의 모델은 소규 모 데이터 셋에 대해 훈련 및 평가되어 과적합 문제가 발생할 수 있었다. 또한 임상 지식 기반 ECG 해석을 고려 하여 ECG 신호를 분석하지는 않았다. 최근, 일부 연구에서는 ECG 신호를 해석하기 위해 자연어 처리(NLP) 접근 방식을 적용하기도 했다(S. Mousavi et al.). 이때, 양방향 RNN 기반 모델은 non-AF로부터 AF를 식별했다. 이렇듯 자동 AF 진단을 위한 기술이 제안되었지만 대부분의 연구는 소규모 데이터 세트를 사용하여 수행되어 과 적합 문제가 발생했다. 또한, 심전도 신호를 임상적으로 중요한 요소인 P파, QRS복합체, T파로 나누고 이들 요 소 간의 관계를 고려하여 진단하는 심장 전문의의 접근 방식과 달리 P-파, QRS-복합체 및 T-파와 같은 ECG 컴포 넌트를 완전히 활용하지 못했다. 도 1은 심장의 구조 및 심장 박동 주기와 관련된 관련 지식을 설명하기 위한 도면이다. 인간의 심장은 심장 혈 관계를 통해 혈액을 펌핑하는 근육 기관이다. 4개의 방으로 구성된 기관은 2개의 심방과 2개의 심실로 구성되어 있으며 특수 전기 세포로 구성된 전도 시스템에 의해 정교하게 조절된다. 이러한 전기 셀의 기능은 전기 임펄스 의 생성 및 이러한 전기 신호의 변환으로 분류된다. 도 1의 (a)는 부비동 결절에서 발생된 전기 충격이 His 다 발 내에서 우심방을 통해 방실 결절로 전파되고 최종적으로 양 심실의 수축 세포에 도달하는 전도 단계를 보여 준다. 전기 전도 시스템에서 전기 신호의 생성 및 전송과 관련된 이벤트는 ECG에 반영된다. P파는 심방의 전기적 탈분극을 나타낸다. QRS-복합체는 심실 심근의 탈분극을 반영한다. 마지막으로 심실 재분 극은 T파로 표시된다. 이러한 다섯 가지 특징(P-, Q-, R-, S- 및 T-파)은 수축과 이완을 포함하는 단일 심장 박 동의 한 주기를 나타낸다. 따라서, ECG는 심방에서 심실로의 이완 이벤트인 시공간 흥분을 반영하는 전기 신호 를 관찰하기 위해 수행되는 테스트이다 AF 환자의 심방은 빠르게(분당 350~600회) 박동하고 부비동 결절에서 생성되는 정상적인 충격 대신 불규칙한 전 기 충격을 생성하므로 정상적인 P파는 더 이상 감지되지 않는다. 대신, ECG에서 거친 세동파가 관찰된다(도 1의 (c)). 더욱이, 심방의 빠른 전기 충격의 일부만이 무작위로 심실로 전달되고, 두 개의 연속적인 QRS 복합체 사 이에 매우 불규칙한 간격으로 심실 탈분극이 발생한다. 이러한 심방과 심실의 불규칙한 움직임은 좌심방에 혈전 을 형성하고 심장 혈류 감소로 인한 뇌허혈성 뇌졸중을 유발할 수 있다. 또한, 심실의 비효율적인 기계적 수축 과 관련된 심부전으로 이어질 수도 있다."}
{"patent_id": "10-2022-0151338", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 개시는 트랜스포머(transformer)를 기반으로 구성된 CAT(Component-aware Transformer)라고 명명되는 새로 운 AF 진단 모델을 이용하여 정밀한 AF 진단이 가능한 전자 장치의 제어 방법을 제공한다. 본 개시에 따른 전자 장치의 CAT 모델은 임상적 구성요소를 토대로 토큰화된 ECG 신호를 분석하고 심방세동의 확률을 예측한다. 본 개시의 목적들은 이상에서 언급한 목적으로 제한되지 않으며, 언급되지 않은 본 개시의 다른 목적 및 장점들 은 하기의 설명에 의해서 이해될 수 있고, 본 개시의 실시 예에 의해 보다 분명하게 이해될 것이다. 또한, 본 개시의 목적 및 장점들은 특허 청구 범위에 나타낸 수단 및 그 조합에 의해 실현될 수 있음을 쉽게 알 수 있을 것이다."}
{"patent_id": "10-2022-0151338", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 개시의 일 실시 예에 따른 전자 장치는, AF(Atrial Fibrillation)에 대한 진단을 수행하기 위한, 트랜스포머 (Transformer) 기반의 CAT(Component-aware Transformer) 모델을 포함하는 메모리, ECG(electrocardiogram)에 컴포넌트 별로 토큰화를 수행하여 복수의 토큰(token)을 획득하고, 상기 복수의 토큰을 상기 CAT 모델에 입력하 여 AF에 대한 진단 결과를 획득하는, 프로세서를 포함한다. 상기 프로세서는, 상기 ECG의 P, QRS, 및 T를 바탕으로 상기 ECG를 복수의 컴포넌트로 구분하고, 상기 복수의 컴포넌트 각각을 일정한 차원 수에 따라 토큰화하여 복수의 토큰을 획득할 수 있다. 이때, 상기 프로세서는, 일 컴포넌트를 구성하는 신호의 시간 길이가 제1 길이 이상인 경우, 상기 신호 중 상기 제1 길이를 초과하는 부분을 잘라내고, 상기 컴포넌트를 구성하는 신호의 시간 길이가 상기 제1 길이 미만인 경 우, 상기 신호의 시간 길이가 상기 제1 길이가 되도록 제로 패딩을 수행하여, 상기 신호가 상기 제1 길이에 매 칭되는 제1 차원 수를 갖도록 재구성할 수 있다. 여기서, 상기 프로세서는, 상기 재구성된 신호의 값을 나타내며 상기 제1 차원 수에 매칭되는 제1 벡터를 획득 하고, 상기 신호의 시간 길이를 나타내며 제2 차원 수에 매칭되는 제2 벡터를 획득하고, 상기 신호의 유형을 나 타내며 제3 차원 수에 매칭되는 제3 벡터를 획득하고, 상기 제1 벡터, 상기 제2 벡터, 및 상기 제3 벡터를 포함 하는 토큰을 획득할 수 있다. 한편, 상기 CAT 모델은, 단일 리드로 구성된 상기 ECG로부터 획득된 복수의 토큰 각각을 입력 받는 트랜스포머 인코더(Transformer Encoder), 상기 트랜스포머 인코더의 출력을 바탕으로 AF 여부를 진단하는 MLP(Multi- Layer Perceptron) 헤드를 포함할 수 있다. 또는, 상기 ECG가 12-리드 ECG에 해당하는 경우, 상기 CAT 모델은, 상기 ECG에 포함된 12가지 유형의 리드 각각 에 매칭되며, 각 리드를 기초로 획득된 복수의 토큰을 입력 받는, 서로 독립된 복수의 트랜스포머 인코더 (Transformer Encoder), 상기 복수의 트랜스포머 인코더의 출력들이 결합된 결합 토큰(concatenated token)이 획득되면, 상기 결합 토큰을 바탕으로 AF 여부를 진단하는 MLP(Multi-Layer Perceptron) 헤드를 포함할 수 있다. 한편, 상기 프로세서는, 상기 ECG에 대해 저역 통과 필터링을 수행하여 저역 신호를 획득하고, 커널 크기가 서 로 다른 두 개의 median 필터를 바탕으로 상기 ECG의 추세 곡선을 추정하고, 상기 저역 신호에서 상기 추세 곡 선을 차감하여, 전처리된 ECG(preprocessed ECG)를 획득하고, 상기 전처리된 ECG에 컴포넌트 별로 토큰화를 수 행하여 상기 복수의 토큰을 획득할 수도 있다. 본 개시의 일 실시 예에 따라 AF(Atrial Fibrillation)에 대한 진단을 수행하기 위한 트랜스포머(Transformer) 기반의 CAT(Component-aware Transformer) 모델을 포함하는 전자 장치의 제어 방법은, ECG(electrocardiogra m)에 컴포넌트 별로 토큰화를 수행하여 복수의 토큰(token)을 획득하는 단계, 상기 복수의 토큰을 상기 CAT 모 델에 입력하여 AF에 대한 진단을 수행하는 단계를 포함한다."}
{"patent_id": "10-2022-0151338", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 개시에 따른 CAT 모델을 이용하는 전자 장치의 제어 방법은, 기존의 모델/장치보다 더 높은 정확도로 ECG 분 석 결과에 따른 AF 진단 결과를 제공할 수 있다."}
{"patent_id": "10-2022-0151338", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "본 개시에 대하여 구체적으로 설명하기에 앞서, 본 명세서 및 도면의 기재 방법에 대하여 설명한다. 먼저, 본 명세서 및 청구범위에서 사용되는 용어는 본 개시의 다양한 실시 예들에서의 기능을 고려하여 일반적 인 용어들을 선택하였다. 하지만, 이러한 용어들은 당해 기술 분야에 종사하는 기술자의 의도나 법률적 또는 기 술적 해석 및 새로운 기술의 출현 등에 따라 달라질 수 있다. 또한, 일부 용어는 출원인이 임의로 선정한 용어 도 있다. 이러한 용어에 대해서는 본 명세서에서 정의된 의미로 해석될 수 있으며, 구체적인 용어 정의가 없으 면 본 명세서의 전반적인 내용 및 당해 기술 분야의 통상적인 기술 상식을 토대로 해석될 수도 있다. 또한, 본 명세서에 첨부된 각 도면에 기재된 동일한 참조번호 또는 부호는 실질적으로 동일한 기능을 수행하는 부품 또는 구성요소를 나타낸다. 설명 및 이해의 편의를 위해서 서로 다른 실시 예들에서도 동일한 참조번호 또 는 부호를 사용하여 설명한다. 즉, 복수의 도면에서 동일한 참조 번호를 가지는 구성요소가 모두 도시되어 있다 고 하더라도, 복수의 도면들이 하나의 실시 예를 의미하는 것은 아니다. 또한, 본 명세서 및 청구범위에서는 구성요소들 간의 구별을 위하여 \"제1\", \"제2\" 등과 같이 서수를 포함하는 용어가 사용될 수 있다. 이러한 서수는 동일 또는 유사한 구성요소들을 서로 구별하기 위하여 사용하는 것이며 이러한 서수 사용으로 인하여 용어의 의미가 한정 해석되어서는 안 된다. 일 예로, 이러한 서수와 결합된 구성 요소는 그 숫자에 의해 사용 순서나 배치 순서 등이 제한되어서는 안 된다. 필요에 따라서는, 각 서수들은 서로 교체되어 사용될 수도 있다. 본 명세서에서 단수의 표현은 문맥상 명백하게 다르게 뜻하지 않는 한, 복수의 표현을 포함한다. 본 출원에서, \"포함하다\" 또는 \"구성되다\" 등의 용어는 명세서상에 기재된 특징, 숫자, 단계, 동작, 구성요소, 부품 또는 이 들을 조합한 것이 존재함을 지정하려는 것이지, 하나 또는 그 이상의 다른 특징들이나 숫자, 단계, 동작, 구성 요소, 부품 또는 이들을 조합한 것들의 존재 또는 부가 가능성을 미리 배제하지 않는 것으로 이해되어야 한다. 본 개시의 실시 예에서 \"모듈\", \"유닛\", \"부(Part)\" 등과 같은 용어는 적어도 하나의 기능이나 동작을 수행하는 구성요소를 지칭하기 위한 용어이며, 이러한 구성요소는 하드웨어 또는 소프트웨어로 구현되거나 하드웨어 및 소프트웨어의 결합으로 구현될 수 있다. 또한, 복수의 \"모듈\", \"유닛\", \"부(Part)\" 등은 각각이 개별적인 특정 한 하드웨어로 구현될 필요가 있는 경우를 제외하고는, 적어도 하나의 모듈이나 칩으로 일체화되어 적어도 하나 의 프로세서로 구현될 수 있다. 또한, 본 개시의 실시 예에서, 어떤 부분이 다른 부분과 연결되어 있다고 할 때, 이는 직접적인 연결뿐 아니라, 다른 매체를 통한 간접적인 연결의 경우도 포함한다. 또한, 어떤 부분이 어떤 구성요소를 포함한다는 의미는, 특별히 반대되는 기재가 없는 한 다른 구성요소를 제외하는 것이 아니라 다른 구성요소를 더 포함할 수 있는 것 을 의미한다. 도 2a는 본 개시의 일 실시 예에 따른 전자 장치의 구성 및 동작을 설명하기 위한 블록도이다. 도 2a를 참조하면, 전자 장치는 메모리 및 프로세서를 포함한다. 전자 장치는 AF 진단을 위한 의료 진단 장치로 구성될 수 있으며, 또는 심전도 기기와 연결된 서버로 구현 될 수 있다. 이 밖에도, 전자 장치는 AF 진단을 위한 소프트웨어/애플리케이션을 실행할 수 있는 데스크탑 PC, 노트북 PC 등 다양한 단말 기기에 해당할 수 있다. 메모리는 전자 장치의 구성요소들의 전반적인 동작을 제어하기 위한 운영체제(OS: Operating System) 및 전자 장치의 구성요소와 관련된 적어도 하나의 인스트럭션 또는 데이터를 저장하기 위한 구성이다. 메모리는 ROM, 플래시 메모리 등의 비휘발성 메모리를 포함할 수 있으며, DRAM 등으로 구성된 휘발성 메모 리를 포함할 수 있다. 또한, 메모리는 하드 디스크, SSD(Solid state drive) 등을 포함할 수도 있다. 도 2a를 참조하면, 메모리는 AF(Atrial Fibrillation)에 대한 진단을 수행하기 위한, 트랜스포머 (Transformer) 기반의 CAT(Component-aware Transformer) 모델을 포함할 수 있다. CAT 모델의 구조와 관련된 실시 예들은 도 4 및 도 5를 통해 후술한다. 프로세서는 전자 장치를 전반적으로 제어하기 위한 구성이다. 구체적으로, 프로세서는 메모리 와 연결되는 한편 메모리에 저장된 적어도 하나의 인스트럭션을 실행함으로써 본 개시의 다양한 실시 예들에 따른 동작을 수행할 수 있다. 프로세서는 CPU, AP, DSP(Digital Signal Processor) 등과 같은 범용 프로세서, GPU, VPU(Vision Processing Unit) 등과 같은 그래픽 전용 프로세서 또는 NPU와 같은 인공지능 전용 프로세서 등을 포함할 수 있 다. 인공지능 전용 프로세서는, 특정 인공지능 모델의 훈련 내지는 이용에 특화된 하드웨어 구조로 설계될 수 있다. 프로세서는 메모리에 저장된 CAT 모델을 바탕으로 ECG에 대한 AF 진단을 수행할 수 있다. 여기 서, ECG는 전자 장치에 포함된 적어도 하나의 센서를 통해 획득된 데이터일 수도 있고, 심전도 기기 등 외 부 장치로부터 수신된 데이터일 수도 있다. ECG는 단일 리드 ECG일 수도 있고, 12-리드 ECG 등 복수의 리드를 가지는 ECG일 수 있다. 도 2a를 참조하면, 프로세서는 전처리 모듈, 토큰화 모듈, 진단 모듈 등을 제어할 수 있다. 본 모듈들은 소프트웨어 및/또는 하드웨어로 구현될 수 있는 기능 단위의 블록의 예시에 해당한다. 전처리 모듈은 ECG 이미지 내지는 ECG 신호에 대하여 전처리를 수행하기 위한 모듈이다. 구체적으로, 전처리 모듈은 ECG에 대해 저역 통과 필터링을 수행하여 저역 신호를 획득할 수 있다. 또한, 전처리 모듈은 커널 크기가 서로 다른 두 개의 median 필터를 바탕으로 ECG의 추세 곡선을 추정할 수 있다. 이때, 전처리 모듈은 저역 신호에서 추세 곡선을 차감하여, 전처리된 ECG(preprocessed ECG)를 획득할 수 있다. 토큰화 모듈은 ECG에 대하여 컴포넌트 별로 토큰화(Tokenization)를 수행하기 위한 모듈이다. 일 예로, 토 큰화 모듈은 전처리 모듈에 의해 전처리 된 ECG에 대하여 토큰화를 수행할 수 있으나, 전처리와 무관 하게 토큰화가 수행될 수도 있다. 토큰화 모듈은 ECG의 P, QRS, 및 T를 바탕으로 ECG를 복수의 컴포넌트로 구분하고, 복수의 컴포넌트 각각 을 일정한 차원 수에 따라 토큰화하여 복수의 토큰을 획득할 수 있다. 예를 들어, 일 컴포넌트를 구성하는 신호의 시간 길이가 제1 길이 이상인 경우, 토큰화 모듈은 해당 신호 중 제1 길이를 초과하는 부분을 잘라낼 수 있따. 반면, 일 컴포넌트를 구성하는 신호의 시간 길이가 제1 길이 미만인 경우, 토큰화 모듈은 해당 신호의 시간 길이가 제1 길이가 되도록 제로 패딩을 수행할 수 있다. 즉, 토큰화 모듈은 컴포넌트 별로 신호가 제1 길이에 매칭되는 제1 차원 수를 갖도록 재구성할 수 있다. 그리고, 토큰화 모듈은 재구성된 신호의 값을 나타내며 제1 차원 수에 매칭되는 제1 벡터(), 신호의 시간 길이를 나타내며 제2 차원 수에 매칭되는 제2 벡터(L), 신호의 유형을 나타내며 제3 차원 수에 매칭되는 제3 벡 터(T)를 각각 획득할 수 있다. 결과적으로, 제1 벡터, 제2 벡터, 및 제3 벡터를 포함하는 토큰이 컴포넌트마다 생성될 수 있다. 진단 모듈은 CAT 모델을 통해 AF 진단(예측)을 수행하기 위한 모듈이다. 구체적으로, 진단 모듈(12 3)은 토큰화가 수행된 ECG를 CAT 모델에 입력하여 진단을 수행할 수 있다. CAT 모델은 단일 리드 ECG를 위한 모델일 수도 있고, 12-리드 ECG 등 복수의 리드를 위한 모델일 수도 있 다. 단일 리드 ECG와 관련된 예로, CAT 모델은 단일 리드로 구성된 ECG로부터 획득된 복수의 토큰 각각을 입력 받는 트랜스포머 인코더(Transformer Encoder), 트랜스포머 인코더의 출력을 바탕으로 AF 여부를 진단하는 MLP(Multi-Layer Perceptron) 헤드를 포함할 수 있다. 12-리드 ECG와 관련된 예로, CAT 모델은 ECG에 포함된 12가지 유형의 리드 각각에 매칭되며, 각 리드를 기 초로 획득된 복수의 토큰을 입력 받는, 서로 독립된 복수의 트랜스포머 인코더(Transformer Encoder)를 포함할 수 있다. 또한, CAT 모델은 복수의 트랜스포머 인코더의 출력들이 결합된 결합 토큰(concatenated token) 이 획득되면, 결합 토큰을 바탕으로 AF 여부를 진단하는 MLP(Multi-Layer Perceptron) 헤드를 포함할 수 있다. 관련하여, 도 2b는 상술한 신호 전처리, 토큰화, 모델 예측의 과정들을 포함하는 본 개시의 일 실시 예에 따른 전자 장치의 동작을 설명하기 위한 도면이다. 도 2b와 같이, 본 개시의 일 실시 예에 따른 전자 장치의 제어 방법은 ECG 신호 전처리, 구성요소 토큰화, 모델 예측의 3단계로 구성된다. 첫째, 원시 ECG 신호에는 전력선 및 환자 움직임 간섭 신호와 같은 잡음 성분이 포함될 수 있으므로 ECG 신호는 잡음 제거 알고리즘을 통해 전처리된다. ECG 신호에는 근전도 검사, 추가 백색 가우스 잡음, 전력선 간섭과 같은 다른 신호 소스로 인한 고주파 잡음이 포함되는 경우가 많다. 또한 ECG 신호는 신체 또는 호흡 운동으로 인한 저주파 노이즈로 고통받을 수 있다. 이러한 노이즈는 진단 성능을 저하시킬 수 있으므로, 전자 장치는 노이즈 제거 알고리즘을 사용하여 원시 ECG 신호에서 노이즈를 제거할 수 있다. 저역 통과 필터링을 위해, 일 실시 예로, 신호 처리에서 가장 널리 사용되는 필터 중 하나인 버터워스 필터가 채택될 수 있다. 저역 통과 버터워스 필터의 주파수 응답 함수는 다음과 같이 표현될 수 있다. 수학식 1"}
{"patent_id": "10-2022-0151338", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "여기서 w는 라디안 단위의 각 주파수이고 n은 필터의 극 수이다. 일 예로, w 및 n은 각각 314.16rad/s(50Hz) 및 5로 설정될 수 있다. 이때, 전자 장치는 저주파 노이즈를 제거하기 위해 커널 크기가 다른 두 개의 중간값(median) 필터를 사용 하여 추세 곡선을 추정하고 저역 통과 필터링을 거친 ECG 신호에서 추세 곡선을 차감할 수 있다. 일 예로, 커널 크기가 각각 0.2초 및 0.6초인 중앙값 필터가 순차적으로 적용될 수 있으나, 이에 한정되는 것은 아니다. 둘째, 전자 장치는 ECG 신호를 P파, QRS복합체, T파와 같은 구성요소(component)로 분해하고 각 요소에 대 한 토큰화를 수행할 수 있다. 구체적으로, 전자 장치는 도 3과 같이 심전도 신호를 파동, 복합체, 구간으로 분해하고 이들 성분 간의 관 계를 토대로 AF 케이스를 검출할 수 있다. 도 3을 참조하면, ECG 컴포넌트는 P-파, P-Q 구간, QRS-복합체, S-T 구간, T-파, T-P 구간 등에 해당한다. 일 실시 예로, 1D U-Net 기반 분할 모델을 통해 ECG가 분할될 수 있다(도 9 참조). 구체적인 예로, 후술할 실험 에 사용된 Shaoxing 데이터베이스에는 P, QRS 및 T 컴포넌트의 레이블 데이터가 포함되어 있지 않으므로, 이러 한 U-Net 기반 분할 모델이 컴포넌트 분할에 활용될 수 있다. 본 개시의 일 실시 예에 따른 CAT 모델의 아키텍처는 배치 정규화 및 Relu 활성화 기능이 있는 컨볼루션 레이어, 맥스 풀링 레이어, 및 디컨볼루션 레이어로 구성될 수 있다. 일 예로, 마지막 레이어를 제외한 모든 컨볼루션 레이어는 커널 크기가 9이고 패딩이 0일 수 있다(마지막 컨볼 루션 레이어의 커널 크기는 1). 일 예로, 모든 디콘볼루션 레이어는 커널 크기 = 8, 보폭 = 2, 및 제로 패딩을 가질 수 있다. 여기서, 입력은 지속 시간이 4초인 12-리드 ECG 신호이고 출력은 분할 결과(P-파, QRS-복합체, T-파 및 배경)로 설정될 수 있다.일 실시 예로, LobachevskyUniversity electrocardiography database(LUDB)는 500Hz의 주파수에서 10초 동안 샘플링 된 12-리드 ECG로 구성된 본 개시의 모델을 훈련하는 데에 사용될 수 있다. 각 레코드에는 P, QRS, T의 온셋(onset) 및 오프셋(offset) 정보가 주석으로 표시될 수 있다. 데이터 증대를 위해 ECG 신호는 상술한 바와 같이 사전 처리되고 “length = 4초”의 슬라이딩 창으로 샘플링 될 수 있다. 훈련 셋과 테스트 셋의 비율은 8:2일 수 있으며, 훈련 셋은 1D U-Net 네트워크에 공급될 수 있다. Dice loss function(S. Jadon et al.)과 0.001의 learning rate의 사용과 함께 Adam optimizer가 사용되었다. 모델 성능을 평가하기 위해 세분화 모델에 광범위하게 사용되는 정량적 메트릭인 DSC(주사위 유사성 계수)가 사용되었다. 수학식 2"}
{"patent_id": "10-2022-0151338", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "여기서 TP, FN 및 FP는 각각 true positive, false negative 및 false positive의 수이다. 결과적으로, 본 개 시의 일 실시 예에 따른 인공지능 모델은 테스트 셋에서 0.937의 DSC를 달성했다. 분할 모델에 의해 도출된 ECG 신호의 구간 별 분류 결과의 예는 도 10에 도시되었다. 도 10은 분할 모델에 입력 된 ECG 신호(리드 II)의 예(a), 그에 대한 분류 결과(b)를 도시한다. 여기서, 클래스 0, 1, 2 및 3은 각각 배경, P, QRS 및 T를 의미한다. 세분화 결과를 개선하기 위해 D. Shanmugam et al.에서 제안한 TTA(Testtime Augmentation) 기법이 사용될 수 있다. 도 11에서 볼 수 있듯이 Shaoxing 데이터베이스의 입력 ECG 신호를 7개의 샘플((a): 0-4초, (b): 1-5초, (c): 2-6초, (d): 3-7초, (e): 4-8초, (f): 5-9초, (g): 6-10초)로 나눌 수 있으며, 분할 모델을 사용하여 각 샘플에 대한 예측을 얻은 후 TTA는 분할 오류를 줄이기 위해 중첩 결과 기간((h): 1-9초)에서 작동할 수 있다. NLP에서 문장은 단어 목록으로 토큰화되고 각 단어는 트랜스포머의 입력으로 벡터에 포함(embedded)된다. 토큰 화 메커니즘이 ECG 분석에 적용될 수 있도록, ECG는 임상적 의미가 있는 컴포넌트로 분해 및 토큰화 되었다. 토큰화 프로세스에 대한 자세한 설명은 도 4에 도시되어 있다. 토큰은 각각 신호 값, 길이, 및 유형을 나타내는 xV, xL 및 xT의 세 가지 벡터로 구성된다. xV에서 길이가 다른 컴포넌트를 토큰화하기 위해 각 ECG 컴포넌트는 먼저 고정 차원 을 가진 벡터로 변환된다. D보다 긴 ECG 컴포넌트는 잘리고 D보다 짧은 ECG 컴포넌트는 제로 패 딩을 통해 처리될 수 있다. 각 ECG 컴포넌트의 길이 정보를 활용하고 자르기 과정에서 xV 정보의 손실을 해결하 기 위해, D로 정규화된 길이 정보를 포함하는 xL이 사용될 수 있다. ECG 내 컴포넌트 별 길이의 분포도를 다룬 도 12에서 볼 수 있듯이, 대부분의 ECG 컴포넌트 길이는 250(약 0.5초) 미만일 수 있다. D보다 긴 컴포넌트에서 자르기로 인한 데이터 손실을 줄이기 위해 D는 사용자 매개 변수로서 500으로 설정될 수 있다. xT의 경우 표 1 과 같이 구성요소 유형의 수는 총 12개였으며 12차원 벡터 xT은 one-hot 인코딩 프로세스를 통해 구성되었다. 표 1"}
{"patent_id": "10-2022-0151338", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "그 결과, 컴포넌트 토큰 x는 3개의 벡터, 즉 500차원의 xV, 1차원의 xL, 12차원의 xT의 연결에 해당할 수 있다. 즉, 513차원 벡터로 표현될 수 있다. 셋째, 트랜스포머(transformer) 기반 모델은 토큰화된 컴포넌트를 사용하여 AF의 존재를 예측한다. 일 실시 예로, 본 개시에 따라 제안된 방법에서 AF 예측을 수행하는 CAT 모델은 도 5와 같이 MLP와 트랜스포머 인코더로 구성될 수 있다. 도 5는 단일 리드 ECG에 대하여 AF 예측을 수행하는 CAT 모델의 구조를 도시한 것이다. 입력 임베딩 레이어(Input Embedding Layer)는 MLP(Multi-Layer Perceptron)으로 구성될 수 있다. 모델의 입력 데이터를 의미하는 시퀀스 는 여러 개의 토큰 로 구성된다. 시퀀스 길이 은 토큰의 수를 나타낸다. 을 설정하기 위해 다음 두 가지 이유가 고려되었다. 1D U-Net으로 분할된 ECG 신호의 최소 컴포넌트 수는 20이다. 하나의 심장 박동에는 일반적으로 P, P-Q, QRS, S-T, T 및 T-P의 6가지 컴포넌트가 포함되지만 P파가 사라 진 AF의 경우에는 더 적은 수의 컴포넌트가 포함된다. 따라서 다중 심장박동을 분석하기 위한 예시로, 은 20으 로 설정될 수 있으나 이에 한정되지 않는다. NLP에서 단어 임베딩은 단어가 조밀한 차원에서 벡터로 표현되는 프로세스이다. 따라서, 임베딩은 입력 토큰 x 의 위치를 고유한 숫자 공간에 매핑하는 과정이다. 본 프로세스를 위해 시퀀스 X = (x1, x2, x3, ..., xN)에 MLP, 즉 입력 임베딩 레이어가 적용될 수 있다. 여기서 xk는 개별 토큰(k = 1, 2, 3, ... , N)에 해당한다. 임 베딩 프로세스의 출력 크기는 임베딩 차원 dmodel로 설정될 수 있으며, 임베딩 시퀀스 에 분류 작업에 사용된 클래스 토큰 xclass가 추가된다. 결과적으로, 는 와 같이 표현될 수 있으며, 는 개별적인 내장 토큰(embedded token)이다. LSTM 및 gated recurrent unit과 같은 RNN 기반 모델과 달리, 트랜스포머는 데이터 시퀀스 모호성을 처리하기 위해 상대 위치 정보가 필요하다. 따라서, 위치 정보를 제공하기 위해 정현파 함수의 주기성이 활용될 수 있다. 다음 공식은 위치 인코딩에 사용되는 정현파 함수이다. 수학식 3"}
{"patent_id": "10-2022-0151338", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 5, "content": "수학식 4"}
{"patent_id": "10-2022-0151338", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 6, "content": "Pos 및 i는 각각 내에서 내장 토큰 및 내에서 dmodel이 있는 위치 인코딩의 지수(index)를 나타낸다. 전자 장치는 내장 토큰에 수학식 3 및 4에서 얻은 위치 정보를 추가하여 위치 부호화를 수행할 수 있다. 일 실시 예로, 도 5와 같이 트랜스포머 인코더 레이어의 수는 2개이며 위치 정보가 포함된 시퀀스는 트랜스포머 인코더의 self-attention 메커니즘에 의해 분석될 수 있다. 중 xclass만 MLP 헤드를 통해 AF 또는 non-AF로 분 류된다. 12-리드 ECG 분석의 경우, 도 6과 같이 모든 ECG 채널에 대해 트랜스포머 인코더의 수가 12로 설정될 수 있다. 각 리드에 대한 토큰은 개별적으로 내장되어 서로 독립적인 12개의 트랜스포머 인코더와 병렬로 분석되며, 각각 의 트랜스포머 인코더는 모델 가중치를 공유하지 않는다. 또한, 각 리드의 모든 클래스가 이어지고 (concatenated) MLP 헤드를 통해 분류될 수 있다. 한편, 상술한 메모리 및 프로세서 외에, 전자 장치는 사용자 입력부, 통신부, 출력부 등을 더 포함할 수 있다. 사용자 입력부는, 사용자로부터 다양한 명령 내지는 정보를 입력 받기 위한 구성이다. 전자 장치는 사용자 입력부를 통해 수신된 사용자 명령에 따라 CAT 모델을 통한 AF 여부의 진단을 수행하고, 진단 결과를 제공 할 수 있다. 사용자 입력부는 키패드, 터치패드, 마이크(: 음성 인식), 카메라(: 이미지 내 텍스트 인식) 등을 포함할 수 있 다.통신부는, 전자 장치가 적어도 하나의 외부 장치와 통신을 수행하기 위한 구성으로 회로를 포함할 수 있다. 통신부는 유선 통신 및/또는 무선 통신을 통해 구현된 네트워크를 기반으로, 외부 장치와 연결될 수 있다. 이때, 통신부는 외부 장치와 직접적으로 연결될 수도 있지만, 네트워크를 제공하는 하나 이상의 외부 서버(ex. ISP(Internet Service Provider))를 통해서 외부 전자 장치와 연결될 수도 있다. 네트워크는 영역 또는 규모에 따라 개인 통신망(PAN; Personal Area Network), 근거리 통신망(LAN; Local Area Network), 광역 통신망(WAN; Wide Area Network) 등일 수 있으며, 네트워크의 개방성에 따라 인트라넷 (Intranet), 엑스트라넷(Extranet), 또는 인터넷(Internet) 등일 수 있다. 무선 통신은 LTE(long-term evolution), LTE-A(LTE Advance), 5G(5th Generation) 이동통신, CDMA(code division multiple access), WCDMA(wideband CDMA), UMTS(universal mobile telecommunications system), WiBro(Wireless Broadband), GSM(Global System for Mobile Communications), DMA(Time Division Multiple Access), WiFi(Wi-Fi), WiFi Direct, Bluetooth, NFC(near field communication), Zigbee 등의 통신 방식 중 적어도 하나를 포함할 수 있다. 유선 통신은 이더넷(Ethernet), 광 네트워크(optical network), USB(Universal Serial Bus), 선더볼트 (ThunderBolt) 등의 통신 방식 중 적어도 하나를 포함할 수 있다. 여기서, 통신부는 상술한 유무선 통신 방식에 따른 네트워크 인터페이스(Network Interface) 또는 네트워크 칩을 포함할 수 있다. 한편, 통신 방식은 상술한 예에 한정되지 아니하고, 기술의 발전에 따라 새롭게 등장하는 통신 방식을 포함할 수 있다. 일 실시 예로, 전자 장치는 통신부를 통해 심전도를 측정하는 심전도 기기와 연결되어 심전도 등을 포함하 는 데이터를 수신할 수 있다. 출력부는 다양한 정보를 제공하기 위한 구성이다. 출력부는 디스플레이, 스피커 등 이 밖에도 정보를 출력하기 위한 다양한 구성을 포함할 수 있다. 전자 장치는 출력부를 통해 AF 여부에 대한 진단 결과를 출력할 수 있다. 본 개시에 따른 전자 장치의 CAT 모델을 평가하기 위해, Champman University와 Shaoxing People's Hospital에 서 수집한 공개 ECG 데이터베이스인 Shaoxing 데이터베이스 (https://www.kaggle.com/datasets/erarayamorenzomuten/chapmanshaoxing-12lead-ecg-database)가 사용되었다. 본 데이터베이스에는 10,646명의 참가자(4세에서 98세 사이의 남성 5,956명 및 여성 4,690명)의 12 개 리드 ECG 기록이 포함되어 있다. 각 ECG 데이터는 500Hz의 주파수에서 10초 동안 샘플링된 것이다. 기록된 신호의 강도는 마이크로볼트(uV) 단위이다. GE MUSE ECG 시스템을 사용하여 데이터를 수집하고 전문가가 11개의 일반적인 리듬과 67개의 추가 심혈관 질환(CVD)으로 수동으로 레이블을 지정했다. 그 결과, 이하 표 2와 같이 AF 케이스와 non-AF 케이스가 선택되었다.표 2"}
{"patent_id": "10-2022-0151338", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 7, "content": "AF 분류를 위한 모델을 평가하기 위해 sensitivity, specificity, F1-score, 및 receiver operating characteristic curve under area (AUROC 또는 AUC) 등 4가지 표준 통계 지표가 사용되었다. 여기서 ROC 곡선 은 sensitivity와 (1-specificity) 사이의 균형에 대한 시각화에 해당한다. 수학식 5"}
{"patent_id": "10-2022-0151338", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 8, "content": "수학식 6"}
{"patent_id": "10-2022-0151338", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 9, "content": "수학식 7"}
{"patent_id": "10-2022-0151338", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 10, "content": "수학식 8"}
{"patent_id": "10-2022-0151338", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 11, "content": "여기서 TN은 true negative의 수이고, precision은 true positive 및 false positive 사이의 비율이다. sensitivity는 true positive 값과 전체 real positive 값 사이의 관계를 나타내고, specificity는 truenegative와 false positive의 비율을 나타낸다. F1-score는 데이터 불균형에 사용되는 지표로 소수 계층을 평가 할 때 precision과 sensitivity를 고려한다. 또한, 모델 성능을 더 잘 이해하기 위해 다음과 같이 주어진 지니 지수(Gini index), 엔트로피(Entropy), 및 파 이 계수(Phi coefficient)가 사용되었다. 수학식 9"}
{"patent_id": "10-2022-0151338", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 12, "content": "수학식 10"}
{"patent_id": "10-2022-0151338", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 13, "content": "수학식 11"}
{"patent_id": "10-2022-0151338", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 14, "content": "여기서 C 및 pj는 각각 클래스의 총 수 및 클래스 j로 레이블이 지정된 데이터의 비율이다. 지니 지수와 엔트로 피는 각각 모델 출력의 불순물과 불확실성 수준을 나타낸다. 따라서, 지니 지수와 엔트로피가 낮을수록 모델의 분류 성능이 더 우수하다. 파이 계수는 정답과 모델의 결과 간의 상관 관계를 계산하여 이진 분류 성능을 평가 하는 지표이다. 본 개시에 따라 제안된 CAT 모델과 최근의 세 가지 연구(S. W. Baalman et al., X. Zhang et al., W. Cai et al) 사이의 공정한 비교를 위해 대규모 데이터 셋인 Shaoxing 데이터베이스에서 다른 리듬으로부터의 AF를 식별 하는 실험이 수행되었다. S. W. Baalman et al.에서 제안한 MLP 기반 모델을 구현하기 위해 Savitzky-Golay 필터와 푸리에 코사인 시리 즈를 토대로 Lead II ECG 신호에서 노이즈 성분이 제거되었다. 그런 다음 NeuroKit2 라이브러리의 Pan-Tompkins 알고리즘을 통해 R-피크를 감지하고 ECG 신호를 심장 주기로 R-to-R 파동으로 분할했다. 이러한 신호들을 모델 에 입력하기 위해, 본 신호들은 80차원으로 스케일링 되었다. MLP 아키텍처는 dropout이 있는 7개의 레이어로 구성되었다. X. Zhang et al.에서, 10초의 Lead II ECG가 선택되어 통과대역 [0.5, 45]Hz, Hann window 기반 필터, 및 최소 -최대 정규화를 갖는 Butterworth 대역통과 필터를 통해 전처리되었다. 이 모델은 1D max pooling, LSTM, 1D CNN, full-connected layer로 구성된다. Cai et al.이 제안한 DDNN 모델은 통과대역 [0.5, 35]Hz 및 차수가 10인 타원형 대역통과 필터에 의해 필터링된 12-리드 ECG 신호에 대해 학습되었으며 Z-점수 정규화로 정규화되었다. DDNN 모델은 SE 블록과 dense 블록이 있 는 4개의 블록으로 구성된다. 본 개시에 따른 CAT와 비교하기 위해 DDNN 모델 역시 Lead II ECG를 통해 단일 리 드에서 평가되었다. 본 개시의 일 실시 예에 따른 CAT 모델은 단일 및 12-리드 ECG 신호 모두에서 평가되었다. 표 3은 단일 리드 및"}
{"patent_id": "10-2022-0151338", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 15, "content": "12-리드 ECG 분석에 대한 CAT의 하이퍼 파라미터가 요약된 것이다. 인코더와 리드의 수는 동일하게 설정되고 레 이어와 헤드의 수는 각각 2와 8로 설정되었다. 임베딩 및 토큰 차원은 모두 513으로 고정되었고 은 20으로 설정 되었다. 모델의 학습을 위해 학습율이 1.0e-4이고 이진 교차 엔트로피 손실이 있는 Adam optimizer 프로그램이 사용되었다. 배치(batch)의 크기는 12-리드 ECG 및 단일-리드 ECG에 대해 각각 512 및 1024로 설정되었다.표 3"}
{"patent_id": "10-2022-0151338", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 16, "content": "ECG 컴포넌트 xL 및 xT 정보의 영향을 조사하기 위해 CAT*을 통해 xL 및 xT를 제외하고 컴포넌트 xV만 훈련시키는 절제 연구가 수행되었다. CAT*에서는 dmodel과 토큰 차원을 제외한 모든 하이퍼 파라미터가 CAT와 동일하게 설정 되었다. xL 및 xT가 제거된 경우 dmodel 및 토큰 차원은 xV의 차원으로 설정되었으며 이는 D와 같다. 데이터 전처리 및 모델 구현은 TensorFlow 2를 사용하는 Python 3.8 환경에서 진행되었다. 모든 실험은 Intel Core i7-11700K 3.70GHz CPU, 96GB RAM 및 24GB NVIDIA GeForce RTX 3090 GPU가 장착된 데스크톱 컴퓨터에서 처리되었다. 과적합은 DL 모델 훈련 중에 발생할 수 있으므로 과적합을 피하기 위해 Tensorflow 2 라이브러리에 포함된 조기 중지 기능이 사용되었다. 본 실험에서 DL 모델의 훈련은 훈련 데이터 셋의 AUC가 40 epoch 동안 개선되지 않으 면 종료되었다. Shaoxing 데이터베이스에서 1,780건의 AF와 8,866건의 non-AF가 8:2의 비율로 훈련 셋과 테스트 셋으로 분할되 었다(훈련 데이터 및 테스트 데이터의 수는 각각 8,516 및 2,130). 그리고, 훈련 셋은 이진 분류를 위해 CAT에 제공되었다. CAT 성능을 평가하기 위해 테스트 셋에 대하여 CAT 모델은 상술한 기존의 세 가지 모델과 비교되었 다. 각 모델에 대한 정오분류표와 ROC 곡선은 각각 도 7과 도 8에 도시되었다. 표 4는 ROC 곡선에 의해 얻어진 최적 역치에 대한 전반적인 specificity, sensitivity, F1-score, 및 AUC를 제 시한다. 또한, 지니 계수, 엔트로피, 그리고 ground truth와 model 결과 사이의 파이 계수는 표 5(기존의 딥러 닝 기반 방법과 CAT의 성능 비교)에 정리되었다. ROC 곡선과 관련된 점수 분포의 가시화를 위해 도 13을 통해 클래스 별 모델 결과의 Gaussian 분포가 도시되었다. 도 12는 8개 모델에 대한 클래스 별 예측 결과의 가우스 분포이다. (a)-(e)는 단일 리드 ECG에 대한 것이고, (f)-(h) 12-리드 ECG에 대한 것이다. 빨간색과 파란색은 각 각 non-AF 및 AF의 모델 결과 분포를 나타낸다. 검은색 점선은 모델의 최적 임계값을 나타낸다.표 4"}
{"patent_id": "10-2022-0151338", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 17, "content": "표 5"}
{"patent_id": "10-2022-0151338", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 18, "content": "심장 전도 과정은 부비동 결절에서 양 심실의 수축 세포까지의 심장 탈분극 순서에 따라 여러 단계로 나눌 수 있다. 이에 따라, 본 개시의 전자 장치는 ECG 신호를 심장 근육 세포의 극성화된 위치에 해당하는 임상적 으로 의미 있는 부분으로 나누었으며(도 1 참조), ECG 신호는 상술한 바와 같이 심장 활동의 시공간 정보를 반 영하고, 트랜스포머 기반 모델에서 주의 메커니즘은 서로 다른 시간의 ECG 세그먼트 간의 관계를 탐구한다. 따 라서, 본 개시의 CAT는 각각 순차 및 로컬 정보를 사용하는 RNN 및 CNN 모델과 달리 ECG에서 시공간적 특징을 추출한다. 실험 결과는 본 개시에서 제안되는 CAT 모델과 기존 연구 사이에 상당한 성능 차이가 있음을 보여주었다. 표 4 와 같이 최적 임계점의 모든 모델은 균형 잡힌 분류 성능을 보였고 CAT 모델은 기존 연구와 비교하여 전체 지표 에서 우수한 성능을 보였다. 특히, CAT는 단일 및 12-리드 ECG에 대한 AUC 측면에서 각각 0.9767 및 0.9823을 달성했다. 또한 단일 리드 ECG에서 훈련된 모델을 비교할 때도 CAT만 F1-score > 80%의 최고의 성능을 보였다. 따라서 CAT는 광혈류측정기 (photoplethysmography) 및 혈압과 같은 단일 채널 파형에 대한 분석에 광범위하게 사용될 수 있을 것으로 기대 된다. S. W. Baalman et al.에서는 1,499개의 녹음에 대해 훈련된 MLP 모델이 0.97의 AUC와 0.94의 F1 점수를 달성했 다고 보고되었다. 유사하게 X. Zhang et al.에서 LSTM-CNN 모델은 97.73의 민감도와 95.19의 특이도를 보였다. 그러나 Shaoxing 데이터베이스에서는 두 모델 모두 원래 성능에 도달하지 않았으며, 이는 소규모 데이터 셋이 과적합 문제로 이어질 수 있음을 나타낸다. S. W. Baalman et al.에서는 스케일링 과정에서 신호의 길이 정보가 손실되어 모델이 풍부한 특징을 추출하지 못했다. DDNN은 단일 및 12-리드 ECG 모두에서 CAT에 비해 낮은 성능 을 보여 본 개시에 따른 토큰화 전략이 다중 규모 분석보다 우수함이 확인되었다. xL 및 xT의 효과를 조사하기 위한 절제 연구에서 표 4는 단일 및 12-리드 ECG에 대한 F1-score 측면에서 본 개 시의 CAT가 CAT*를 각각 5.7% 및 7.3% 능가함을 보여준다. 결과는 xL 및 xT가 AF 진단의 두 가지 주요 기능(불 규칙한 R-R 간격 및 불분명한 P파)을 탐색하고 CAT 토큰화 프로세스 중에 발생한 데이터 손실을 해결하는 데 중 요한 역할을 한다는 것을 검증한다. 또한 12-리드 ECG에 대해 훈련된 CAT는 단일-리드 ECG에 대해 훈련된 CAT에 비해 3.6% 개선되었다. 심장 전문의의 알려진 ECG 해석에 따르면, 다중 리드 ECG는 심장 활동 정보를 포괄적으 로 포함하기 때문에 단일 리드보다 다중 리드 ECG가 더 정확하다. 따라서 심장 전문의의 진단을 모방한 본 개시 의 CAT 모델은 단일 리드 신호보다 12-리드에 대해 학습할 때 더 풍부한 기능을 수행할 수 있다.과거 S. Mousavi et al.은 DL 기반 ECG 해석 방법에 NLP를 적용한 두 차례 연구를 수행하였다. 그러나, 두 연구 모두 세그먼트들(P-Q, S-T, T-P)에 대한 고려 없이 단순히 P-파, QRS-복합체, 및 T-파로만 분석되어 심전도 심 박 신호를 자세히 분석하지 못했다는 공통점이 있다. 또한, Mousavi et al.은 K-means 클러스터링으로 분류된 20가지 유형의 파동을 기반으로 NLP의 워드 임베딩과 같이 분할된 P-파, QRS-복합체, T-파를 임베딩한 이력도 있다. 다만, 결과적으로 임상 정보가 포함된 ECG 컴포넌트 유형 및 길이 데이터는 고려되지 않았다. 따라서, 본 개시에서 제안되는 CAT 모델 기반 예측은 NLP 기반의 방법에 비해 보다 상세한 정보를 추출할 수 있다. 한편, 이상에서 설명된 다양한 실시 예들은 서로 저촉되지 않는 한 복수의 실시 예가 결합되어 구현될 수 있다. 한편, 이상에서 설명된 다양한 실시 예들은 소프트웨어(Software), 하드웨어(Hardware) 또는 이들의 조합된 것 을 이용하여 컴퓨터(Computer) 또는 이와 유사한 장치로 읽을 수 있는 기록 매체 내에서 구현될 수 있다. 하드웨어적인 구현에 의하면, 본 개시에서 설명되는 실시 예들은 ASICs(Application Specific Integrated Circuits), DSPs(Digital Signal Processors), DSPDs(Digital Signal Processing Devices), PLDs(Programmable Logic Devices), FPGAs(Field Programmable Gate Arrays), 프로세서(Processors), 제어기 (Controllers), 마이크로 컨트롤러(Micro-controllers), 마이크로 프로세서(Microprocessors), 기타 기능 수행 을 위한 전기적인 유닛(Unit) 중 적어도 하나를 이용하여 구현될 수 있다. 일부의 경우에 본 명세서에서 설명되는 실시 예들이 프로세서 자체로 구현될 수 있다. 소프트웨어적인 구현에 의하면, 본 명세서에서 설명되는 절차 및 기능과 같은 실시 예들은 별도의 소프트웨어 모듈들로 구현될 수 있다. 상술한 소프트웨어 모듈들 각각은 본 명세서에서 설명되는 하나 이상의 기능 및 작동을 수행할 수 있다. 한편, 상술한 본 개시의 다양한 실시 예들에 따른 전자 장치에서의 처리동작을 수행하기 위한 컴퓨터 명령어 (Computer Instructions) 또는 컴퓨터 프로그램은 비일시적 컴퓨터 판독 가능 매체(Non-transitory Computer- readable Medium)에 저장될 수 있다. 이러한 비일시적 컴퓨터 판독 가능 매체에 저장된 컴퓨터 명령어 또는 컴 퓨터 프로그램은 전자 장치 등 특정 기기의 프로세서에 의해 실행되었을 때 상술한 다양한 실시 예에 따른 전자 장치의 동작을 상술한 특정 기기가 수행하도록 한다. 비일시적 컴퓨터 판독 가능 매체란 레지스터, 캐쉬, 메모리 등과 같이 짧은 순간 동안 데이터를 저장하는 매체 가 아니라 반영구적으로 데이터를 저장하며, 기기에 의해 판독(Reading)이 가능한 매체를 의미한다. 비일시적 컴퓨터 판독 가능 매체의 구체적인 예로는, CD, DVD, 하드 디스크, 블루레이 디스크, USB, 메모리카드, ROM 등 이 있을 수 있다. 이상에서는 본 개시의 바람직한 실시 예에 대하여 도시하고 설명하였지만, 본 개시는 상술한 특정의 실시 예에"}
{"patent_id": "10-2022-0151338", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 19, "content": "한정되지 아니하며, 청구범위에서 청구하는 본 개시의 요지를 벗어남이 없이 당해 개시에 속하는 기술분야에서 통상의 지식을 가진 자에 의해 다양한 변형실시가 가능한 것은 물론이고, 이러한 변형실시들은 본 개시의 기술 적 사상이나 전망으로부터 개별적으로 이해되어서는 안 될 것이다."}
{"patent_id": "10-2022-0151338", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 심장의 구조 및 심장 박동 주기와 관련된 관련 지식을 설명하기 위한 도면, 도 2a는 본 개시의 일 실시 예에 따른 전자 장치의 구성 및 동작을 설명하기 위한 블록도, 도 2b는 신호 전처리, 토큰화, 모델 예측으로 구성된 본 개시의 일 실시 예에 따른 전자 장치의 동작을 설명하 기 위한 도면, 도 3은 심장 박동의 정상 리듬 케이스에서 ECG의 구성 요소를 설명하기 위한 도면, 도 4는 본 개시의 일 실시 예에 따른 전자 장치의 토큰화 동작을 설명하기 위한 도면, 도 5는 본 개시의 일 실시 예에 따라 단일 리드의 ECG에 대한 진단을 수행하기 위한 CAT 모델의 구조를 도시한 블록도, 도 6은 본 개시의 일 실시 예에 따라 12-리드 ECG에 대한 진단을 수행하기 위한 CAT 모델의 구조를 도시한 블록 도,도 7은 본 개시에 따라 제안되는 CAT 모델 외 다양한 모델의 정오분류표를 비교하여 도시한 도면, 도 8은 도 7에서 다뤄진 8개 모델 각각의 ROC 및 AUC를 도시한 도면, 도 9는 본 개시의 일 실시 예에 따라 컴포넌트 분할에 활용될 수 있는 U-Net 모델을 도시한 블록도, 도 10은 분할 모델에 의해 도출된 ECG 신호의 구간 별 분류 결과를 도시한 그래프들, 도 11은 TTA 기법에 따라 분할된 서로 다른 시간 구간에 대한 샘플이 활용되는 동작을 설명하기 위한 그래프들, 도 12는 본 개시의 일 실시 예에 따른 ECG 내 컴포넌트 별 길이의 분포도를 도시한 그래프, 그리고 도 13은 클래스 별 모델 결과의 Gaussian 분포를 모델 별로 도시한 그래프들이다."}
