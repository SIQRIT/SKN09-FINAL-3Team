{"patent_id": "10-2022-0170823", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2023-0086632", "출원번호": "10-2022-0170823", "발명의 명칭": "체온, 마스크 착용, 전자출입명부 QR 코드 체킹을 지원하는 단독형 Covid -19 디지털 사이니", "출원인": "주식회사 큐브릭디지털", "발명자": "박건"}}
{"patent_id": "10-2022-0170823", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "본 발명 [도 2]와 식 (1) 에서 제공한 광학 이미지에서의 얼굴 검출 부위와 열화상 이미지에서의 얼굴 부위를매칭하는 방법 및 식 (1) 과 식 (2) 에 의해 열화상 이미지에서 얼굴 부위 사각형 좌상단 좌표 및 너비, 높이를구하는 방법"}
{"patent_id": "10-2022-0170823", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제 1항에 의해 검출된 열화상 이미지의 얼굴 부위에서 마스크 착용 부분, 안경 착용 부분, 그 밖의 가려진 부분을 결정하기 위해, 정상 체온 온도 범위 (예; 35℃ 이하, 40℃ 이상)의 열화상 온도 데이터를 제외하고 나머지열화상 온도 데이터의 평균과 이를 다수 프레임에 대해 다시 평균을 계산하여 체온을 결정하는 방법"}
{"patent_id": "10-2022-0170823", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "본 발명의 [도 6]의 워크플로우에서 제시한 얼굴 검출, 체온 검출, 마스크 검출, 전자명부 QR 코드 체킹의 체계적 처리 및 통합 과정"}
{"patent_id": "10-2022-0170823", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 1) 열화상센서로부터 획득한 열화상 이미지 데이터로부터 안정적으로 체온을 계산하는 방안을 제공하 는 것에 대한 것으로, 광학 이미지와 열화상 이미지 간의 좌표 매칭으로 열화상 이미지 데이터에서 얼굴 부위를 찾아낸 후에, 이 얼굴 범위 부분의 픽셀들에서 정상 체온 범위를 많이 넘어가는 열화상 이미지 픽셀값을 아웃라 이어로 제외하고 난 픽셀들을 순수한 얼굴 피부 부분의 픽셀로 간주하고 이를 여러 프레임에 걸쳐 평균하여 체온 을 결정함으로써 보다 안정적인 체온을 제공한다. 또한, 본 발명은 2) 체온 체킹, 마스크 착용 체킹, 전자명부 QR 코드 체킹 등의 태스크 들을 효과적으로 사이니지 시스템에 통합하는 절차 방안을 효과적으로 제공하여, 광고 콘텐츠 표출 외에 체온 체킹, 마스크 착용 체킹, 전자명부 QR 코드 체킹 등을 추가적으로 제공하는 다목적 사이 니지 시스템 구현이 가능하도록 한다."}
{"patent_id": "10-2022-0170823", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 디지털 사이니지 시스템의 응용 분야로 광고 콘텐츠를 표출하는 디지털 사이니지의 본래 기능에 더하 여, 광고 콘텐츠 시청 고객들의 Covid-19, 감기 등의 전염성 질환에 의한 발열을 체크하기 위한 신체 체온의 측 정, 호흡, 기침 등에 의한 타인에게로의 전염을 방지하기 위한 일환으로 마스크 착용이 요구되는 경우에 마스크 착용 여부 체킹, 출입처 요구에 따른 전자출입명부 QR 코드 체킹 기능을 제공하는 단독형 디지털 사이니지 시스 템 구현에 관한 발명이다."}
{"patent_id": "10-2022-0170823", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "인체는 끊임없이 열을 생산하고 방출하는데 인체 내부의 중심 온도는 인체 활동량이 변하더라도 정상 체온 범위 내로 유지되는 반면, 인체 표면(피부) 온도는 중심 체온에 비해 변화가 상대적으로 크며 외부 환경 및 외부 온 도에 따라 변하여 하루 시간의 변화에 따라 표면 체온은 등락을 하기 때문에, 열화상 센서 이미지를 활용하여 측정하는 신체 온도는 따라서 정확하기 힘들다. 따라서, 얼굴을 촬영하여 얻어진 열화상 센서 이미지로 계산되 는 체온은 정확하기 힘들다. 그런데, 현재 시중에 판매되는 보급형 개인용 체온 측정에 접촉식 체온기는 직접 이마 부위에 근접하여 측정하기 때문에 비교적 정확하며, 따라서 사용되는 열화상 센서는 화소 수가 클 필요가 없어 저해상도(보통 32 x 32)를 갖는 적외선 써모파일 어레이를 이용하여 만든 것이 많다. 한편 디지털 사이니 지 시스템은 고가의 고해상도 열화상 센서를 활용하기에는 가격 부담이 존재하며, 따라서 저가의 저해상도 열화 상 센서 활용이 요구된다. 그런데, 비접촉식으로 사용되는 디지털 사이니지 시스템에서의 저해상도 열화상 센서 는 얼굴 근접 촬영이 불가능하며 힘들며, 얼굴 외 부분(예; 머리, 가슴 부위 상의 등)이 촬영되며, 이 경우에 얼굴 부위만을 찾기 힘들다. 따라서, 비접촉식 저해상도 열화상 이미지 픽셀 온도 값들의 평균을 구하여 체온을 계산하는 경우에는 얼굴 외 부분의 열화상 이미지 픽셀 온도 값들이 포함되어 왜곡된 체온 계산이 된다. 따라서, 열화상 이미지에서 정확히 얼굴 부위를 찾아내는 것이 필요하며, 본 발명에서는 해상도가 높은 광학 이 미지를 이용하여 찾는 방안을 제시한다. 또한, 열화상 이미지에서 얼굴 부위를 검출해내었더라도 안경, 마스크 등에 의한 부분의 온도 데이터값은 체온 계산에 방해가 된다. 따라서, 얼굴 부위에서도 마스크, 안경 등에 가려지지 않은 순수 얼굴 피부 부분의 열화상 이미지 픽셀의 온도 값을 이용하는 것이, 더욱 정확한 체온 계산에 필 요하다. 안경, 마스크 부분 등의 열화상 온도 데이터는 정상 체온 온도 범위에서 벗어나는 것을 이용하여 이들 정상 체온 범위에서 벗어나는 것을 아웃라이어로 간주하고 이를 제외한 얼굴 부위 온도 데이터를 순수 얼굴 표 피 열화상 온도 데이터로 사용하는 방안을 제시하여 더욱 정확한 체온 계산이 되도록 하는 방안을 제시한다. 마스크 착용 여부는 보통 딥러닝 네트워크 모델 기반 마스크 검출 방법을 이용한다. 본 발명에서 마스크 검출을 위해 개발한 딥러닝 네트워크 모델은 이미 널리 알려진 딥러닝 네트워크 모델과 특별히 차이가 있지 않다. 또한, 전자출입명부 QR 코드 검사 또한 이미 잘 알려진 QR 코드 인식 알고리즘들과 별반 차이가 없다. 그러나, 체온 측정, 마스크 검출, QR 코드 인식 등의 절차들의 디지털 사이니지 시스템에 통합되어 구현되는 효과적 방 안의 고려는 필요하다. 본 발명은 이에 대해 효과적 통합 절차 방안을 제시한다. 선행기술문헌 특허문헌 (특허문헌 0001) [특허문헌 1] 한국공개특허 제10-2022-0082483호(공개일: 2022. 06.17) \" 열화상 센서를 이용 한 실체 안면 인식 체온 측정 시스템 및 방법 \" (특허문헌 0002) [특허문헌 2] 한국공개특허 제10-2022-0117719호(공개일: 2022.08.24) \" 안면인식 체온 측정 기 및 이를 이용한 체온 측정 방법 \" (특허문헌 0003) [특허문헌 3] 한국등록특허 제10-2324271호(등록일: 2021년11월03일) \" 열감지 키오스크 및 이 의 운용방법 \" (특허문헌 0004) [특허문헌 4] 한국등록특허 제10-2464186호(등록일: 2022년11월02일) \" 안면인식 및 열화상 검 출기능을 갖는 키오스크 시스템 및 이를 이용한 출입통제방법 \" (특허문헌 0005) [특허문헌 5] 한국등록특허 제10-2375778호(등록일: 2022년03월14일) \" 인공지능 기술 기반의 다기능 디지털 사이니지 시스템 \" 비특허문헌 (비특허문헌 0001) [논문 1] T. Ruffin, J. Steele, Y. Acquaah, N. Sharma, E. Sarku, R. Tesiero and B. Gokaraju, \" Non-invasive Low Cost Fever Detection Systems, \" SoutheastCon, 2021. (비특허문헌 0002) [논문 2] A. Somboonkaew, et al., \" Mobile-Platform for Automatic Fever Screening System Based on Infrared Forehead Temperature, \" OptoElectronics and Communications Conference, Not available, 2017. (비특허문헌 0003) [논문 3] J. Ahlberg, N. Markus, and A. Berg, \" Multi- Person Fever Screening Using a Thermal And A Visual Camera, \" Svenska Sallskapet for Automatiserad Bildanalys, 2015. (비특허문헌 0004) [논문 4] M. F. Azwan, Mushahar, and N. Zaini, \" Human Body Temperature Detection based on Thermal Imaging and Screening using YOLO Person Detection, \" IEEE International Conference on Control System, Computing and Engineering, pp. 27-28, 2021. (비특허문헌 0005) [논문 5] M.J. Lee, Y.M. Kim, and Y.M. Lim. \" Masked Face Temperature Measurement System Using Deep Learning, \" Journal of Korea Multimedia Society, Vol. 24, No. 2, pp. 208-214, 2021."}
{"patent_id": "10-2022-0170823", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은 1) 비접촉식 열화상 센서에 의한 체온 측정 계산의 정확성 개선 문제, 2) 체온 측정, 마스크 착용 체 킹, 전자정보 QR 코드 체킹 등을 기존 사이니지 시스템에 통합하는 절차 방안 등을 해결하고자 한다. 1) 비접촉식 열화상 센서에 의한 체온 측정 계산의 정확성 개선 문제 체온 측정을 위해 설계된 Non-Contact Infrared Thermometers (NCIT)과 Infrared Thermography (IRT; 열화상 이미지) 시스템들에는 ±0.3℃ 이내의 정확도가 요구된다. 열화상 이미지를 사용하여 체온 측정하는 경우에, 얼 굴 부위 영역에서 최대 온도 값을 체온으로 확정하는 NCIT 기기가 있으나, 이는 ISO 표준에서는 권고되지 않는 다. [특허문헌 1]에서는 눈 주변부의 온도를 측정하여 이를 체온으로 간주한다. 눈 주변 온도(특히 논 안쪽 꼬리 부 분)는 비교적 안정적인 것으로 알려져 있다. 그러나, [특허문헌 1] 은 열화상 이미지에서 어떻게 눈 주변부를 찾는지에 대한 자세한 설명이 주어지지 않는다. [특허문헌 2] 에서는 광학카메라를 이용하여 얼굴의 특징점을 추출하고 열화상 카메라를 통해 체온을 측정할 수있는 안면인식 체온측정기 및 이를 이용한 체온측정방법을 제 공한다. 그러나, 열화상 카메라에서 제공하는 픽셀의 값을 어떻게 가공하여 안정적인 체온을 제공하는지에 대한 자세한 설명은 제공하지 않고 있다. 단순히 열화상 카메라에서 제공하는 값으로 체온을 측정하는 것은 오차가 많다. [특허 문헌 3]에서는 열화상 카메라 이미지에서 미간을 찾아내고 미간 부분의 열화상 픽셀 온도 값을 체 온으로 확정한다. 그런데, 어떻게 열화상 이미지에서 얼굴 미간 부분을 찾는지에 대한 설명은 주어져 있지 않다. [특허문헌 4,5]에서는 열화상카메라에서 제공하는 체온 값을 그대로 이용한다. 상기 특허 문헌에서는 대부분 열화상 카메라에서 제공하는 체온 측정값을 이용할 뿐인데, 열화상 카메라에서 제 공하는 체온 값은 안정적인 것이 잘 알려져 있다. 관련 논문들에서는 열화상 센서로부터 얻어진 열화상 데이터 로부터 알고리즘을 적용하여 더욱더 안정적인 체온 값을 추정하는 방안들이 제안되고 있다. [논문 1]은 Lepton 3.5(160x120) 열화상 센서로 캡처된 열화상 이미지들에서 눈부분을 레이블링한 1,800장 열화 상 이미지의 훈련 데이터 세트를 만들고, 오픈소스 객체 검출 알고리즘인 'YOLOv5'를 통해 학습시켜, 열화상 이 미지에서 눈부분을 찾도록 한 후에, 눈부분 열상 이미지 픽셀의 평균으로부터 체온을 계산한다. 이 경우, 안경 을 쓰거나 눈의 일부 부위가 가려진 경우에는 해당 체온 계산 알고리즘은 처리에 문제가 있다. [논문 2]에서는 열화상 이미지에서 얼굴 부위를 찾고 얼굴 부위에서 가장 높은 온도 픽셀을 찾아 그 값을 체온으로 결정한다. 그런데, 그런데, 외부 환경에 영향을 받는 얼굴 표피에서 최고 온도 픽셀이 안정적으로 표피 체온을 대표한다고 할 수 없어 ISO 표준에서는 권고되지 않는다. [논문 3]은 광학 센서 이미지에서, 인체 표피 체온 측정 지점 가 운데, 가장 안정적 지점이라 잘 알려진 눈 안쪽 꼬리(눈물샘 근처)를 검출하고, 열화상 이미지에서의 대응점 온 도를 체온으로 결정한다. 그러나, 이 방법은 안경을 쓰거나 눈 안쪽 꼬리가 가려지는 경우에는 문제가 있다. [논문 4]는 열화상 이미지들을 오픈소스 컴퓨터 비전 라이브러리인 OpenCV 의 제공 함수로 인체 부위 검출을 훈 련한 다음, 입력 열화상 이미지에서 인체 부분을 검출하고, 인체 부분 픽셀의 온도 값들을 여러 프레임에 걸쳐 이들의 평균을 구하고 이를 체온으로 결정하였다. 이 방법의 문제점은 인체 부분 대부분이 옷을 입고 있어, 옷 으로부터의 온도 픽셀들이 사람 피부 부분에서의 온도 픽셀들보다 더 많아 평균을 구해도 왜곡이 된다. [논문 5]는 본 발명에서와같이 광학 이미지와 열화상 이미지와의 매칭을 통해, 광학 센서 이미지에서 검출된 얼굴 이 미지에 해당하는 열화상 이미지에서의 얼굴 부분을 찾는다. 이때, 광학 이미지 및 열화상 이미지에서 각각 4개 의 대응점을 찾아 이를 이용하여 호모그래피를 이용하여 호모그래프 행렬을 구하여 매칭을 수행한다. 그런데, 대응점들을 어떻게 찾는지에 대한 설명은 제공되지 않으며, 얼굴 부분에서 온도 최댓값을 찾아 이를 체온으로 정하며, 이는 앞서 언급한 대로 얼굴 표피에서 최고 온도 픽셀이 안정적으로 표피 체온을 대표한다고 할 수 없 다. 본 발명은 먼저 광학 센서로부터 얻어진 광학 이미지와 열화상 센서로부터 얻어진 열화상 이미지를 쉽게 매칭하 는 방법을 제공한다. 이후, 광학 이미지에서 영상처리 알고리즘으로부터 검출된 얼굴 부분과 머리 부분, 마스크 부분, 가려진 부분, 얼굴 이외 부분 등을 제거한 순수 얼굴 피부 영역을 분리해낸 후에, 제공된 매칭 방법에 따 라 매칭된 열화상 이미지의 대응 부분을 찾고, 해당 대응 영역에서의 열화상 센서 모듈이 획득한 데이터를 읽어 서 온도 이미지 픽셀값으로 직접 변환하고 이 온도 픽셀값들을 평균하고 또한 이를 여러 프레임에 대해 다시 평 균을 구한 것을 체온으로 계산함으로써 보다 안정적인 체온을 결정하는 방법을 제시한다. 2) 체온 측정, 마스크 착용 체킹, 전자정보 QR 코드 체킹 등을 기존 사이니지 시스템에 통합하는 절차 방안 [특허문헌 2] 는 안면 인식 특징 정보 및 체온 측정값 추출 후에 이를 서버에 전송하여 서버에서 이를 보관하는 시스템에 관해 설명하고 있어 이는 사이니지 시스템에 통합하는 것과는 차이가 있다. [특허문헌 3]은 열화상 카메라에서 획득한 체온 정보 및 QR 코드 스캐너에서 획득한 QR code 정보를 읽어서 키 오스크 시스템에서 저장하고 표출하는 데 활용한 것만이 제안되어 있다. [특허문헌 4, 5]는 모두 광학카메라 이미지 처리에서 얻어진 신원 확인 정보와 열화상 카메라에서 획득한 체온 정보를 읽어서 신원을 확인하고 체온 발열 여부를 점검한다는 설명 외에 시스템 내부에서 어떻게 통합할지에 대 한 설명이 주어져 있지 않다."}
{"patent_id": "10-2022-0170823", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명은 상기 [해결하고자 하는 과제]의 1) 비접촉식 열화상 센서에 의한 체온 계산의 정확성 개선 문제, 2) 체온 측정, 마스크 착용 체킹, 전자정보 QR 코드 체킹 등을 기존 사이니지 시스템에 통합하는 절차 방안을 다음 과 같은 방법으로 해결한다. 1) 비접촉식 열화상 센서에 의한 체온 측정 계산의 정확성 개선 문제 본 발명에서는 열화상 센서의 열화상 이미지에서의 순수 얼굴 피부 부위 픽셀들을 찾아 이를 평균하고 또한 여 러 프레임에 걸쳐 다시 평균을 구해 이를 체온 값으로 확정하는 것으로 열화상 센서의 체온 측정 계산의 정확성 을 개선하는 방안을 제안한다. 본 발명에서 중요한 것은 열화상 이미지에서 순수 얼굴 피부 부위 픽셀들을 찾는 방법이다. 이는 먼저 얼굴 부분을 검출하는 데에, 고해상도의 광학 이미지에서 잘 알려진 얼굴 검출 알고리즘을 통해 얼굴 부분을 검출한 후에, 광학 이미지와 열화상 이미지와의 좌표 매칭을 통해 열화상 이미지에서의 얼굴 부위 부분을 계산해낸다. 얼굴 부분은 안경, 마스크, 그 밖의 다른 물질(예; 커피 컵 등)에 의해 가려진 부분을 제외한 순수 얼굴 피부 부분 픽셀들만을 추려내어야 하는데, 정상 체온 온도 범위 (36~37.5℃)보다 많이 차이나 는 픽셀값들(예; 35℃ 이하, 40℃ 이상)을 제외하는 얼굴 부분 픽셀들이 이에 해당한다. 이 제외되는 부분은 머 리 부분, 모자와 안경 착용 부분, 다른 것으로 가려진 얼굴 부분, 얼굴 부분 사각형에서 얼굴 부위가 아닌 부분 등이다. 또한, 열화상 이미지는 주변 온도 변화에 민감하고 잡음이 존재하므로, 각 프레임에서의 평균을 여러 프레임(본 발명에서는 4 프레임)에 걸쳐 평균하여 최종적으로 체온을 확정한다. 한편, 열화상이미지에서 얼굴 부분의 화소 수가 일정 이상이어야 평균값 계산이 의미가 있다. 해당 열화상 센서는 32x32 (또는 64x64)이므로 최소 얼굴 부분 화소수가 10x10 픽셀 이상 이 되는 게 바람직하며, 이를 달성하기 위해 해당 열화상 센서에서는 열화상 센서와 사람 간의 거리가 30cm～50cm 이내로 권고된다. 2) 체온 측정, 마스크 착용 체킹, 전자정보 QR 코드 체킹 등을 기존 사이니지 시스템에 통합하는 절차 방안 본 발명에서 채택한 얼굴 검출 및 바코드 스캐닝 함수는 얼굴 및 QR 코드의 위치를 영상 이미지에서 가정하지 않는다. 얼굴 또는 QR 코드가 이미지에 어디에 있든지 검출하거나 인식한다. 얼굴 마스크 검출은 검출된 얼굴 이미지를 대상으로 마스크를 검출한다. 본 발명에서는 얼굴 검출, 마스크 검출, 체온 측정 및 QR 체크인의 동작 태스크들이 체계적 절차로 수행되어야 한다. 본 발명에서는 다음과 같은 절차로 이들 태스크 수행하도록 제공한다. ①광학 카메라에서 획득된 영상 이미지에 서 먼저 얼굴을 검출, ②검출된 얼굴 이미지 데이터를 이용하여, 얼굴 영역 좌표를 계산한 후, 이 좌표 정보를 이용하여 매칭된 열화상 이미지에서의 얼굴 이미지 부분 계산, 하는 데 넘겨주어, ③ 해당하는 열화상 얼굴 이 미지에서 체온 온도를 많이 넘어가는 아웃라이어 픽셀 온도 값들은 제거한 후에 나머지 픽셀들에 대해 평균을 취해 체온을 계산. ④ 한편 검출된 얼굴 이미지에서 마스크 검출, ⑤마스크가 검출되면, QR 체크인 코드 체킹 부분으로 넘어가 QR 코드를 체킹."}
{"patent_id": "10-2022-0170823", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명은 1) 열화상 센서로부터 획득된 열화상 이미지 데이터로부터 더욱 간편하게 효과적으로 안정적인 체온 정보를 제공하는 방법을 제공하며, 2) 사이니지 시스템에서 체온, 마스크 착용 여부, QR 코드 확인을 동시에 제 공하는 절차를 제시하여 실내에 출입하는 고객들에게 광고 콘텐츠 재생뿐만 아니라 발열 여부, 마스크 착용 여 부, 그리고 전자출입명부 신원 확인까지 편리하게 제공하는 다목적 사이니지 시스템 구축이 가능하게 한다."}
{"patent_id": "10-2022-0170823", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "1) 비접촉식 열화상 센서에 의한 체온 측정 계산의 정확성 개선 문제 다음의 가), 나), 다) 과정으로 개선된다. 가) 광학 이미지 영역에서의 열화상 이미지 영역에로의 좌표 매칭 광학 이미지와 열화상 이미지 사이에는 해상도(본 발명에서 사용한 광학 이미지 센서 모듈 해상도는 1920x1080 이며, 열화상 센서 모듈의 해상도는 32x32) 뿐만 아니라 시야각(본 발명에서 사용한 광학 카메라 센서 모듈의 시야각은 수평 68°수직 54°이며, 열화상 센서 모듈의 시야각은 수평 33°수직 33°에서 큰 차이가 있으므로 얼굴 좌표를 맞출 때 이 문제를 해결해야 한다. 즉, 열화상 이미지 영역([도 2]의 200)이 광학 이미지 영역([도 2]의 100)에서 어느 부분 ([도 2]의 101)인가를 알아내야 한다. 먼저, 해당 열화상 이미지 영역([도 2]의 200)이 광학 이미지 영역([도 2]의 100)에서 어디에 위치하는지([도 2]의 101)를 [도 1]의 사이니지 기기에서 카메라 이미지 전부와 열화상 이미지 전부를 표출하고, 직접 자를 이 용하여 측정하고 광학 이미지의 가로 길이 픽셀 수 (본 발명에서 사용한 광학 이미지 센서에서는 1920) 와 세로 길이 픽셀수 (본 발명에서 사용한 광학 이미지 센서에서는 1080) 값들을 이용하여, 광학 이미지에서의 열화상 이미지 대응 부분 사각형([도 2] 101)의 좌상단 좌표 (a,b) 및 너비 c, 높이 d를 구한다([도 2] 100에서의 a, b, c, d). 이때, a는 광학 이미지 가로 왼쪽 끝에서 [도 2] 101 ’빨간색 상자‘의 왼쪽 경계까지의 거리의 픽 셀 수이며, b는 광학 이미지 상단 끝에서 [도 2]의 101 ’빨간색 상자‘의 상단 경계까지의 거리의 픽셀 수, c 와 d는 [도 2] 101 ’빨간색 상자‘의 너비 픽셀 수 및 높이 픽셀 수를 나타낸다. 이때, [도 2]에서, 광학 이미지 [도 2] 101 에서의 점 p의 좌표 (x, y)와 이에 대응하는, 열화상 이미지 ([도 2] 200)에서의 대응점 p' 의 좌표 \u0000*x',y') 간의 좌표 관계는 다음과 계산된다. x'=(x-a)/(c/m), y'=(y-b)/(d/n) 이 때, m 과 n은 열화상 센서 모듈의 가로 해상도 픽셀 수(본 발명에서 채택된 열화상 센서의 경우 32) 및 세로 해상도 픽셀 수(본 발명에서 채택된 열화상 센서의 경우 32)를 나타낸다. 따라서, 식 에 의해, [도 2] 101의 모든 픽셀의 좌표에 대해 대응되는 열화상 이미지 [도 2] 200의 각 픽셀 의 좌표를 매칭하여 구할 수 있다. 나) 열화상 이미지에서의 얼굴 온도 영역 특정 앞서 언급한 바와 같이, 광학 이미지 (1920x1080)에서 얼굴 검출 알고리즘을 적용하여, 광학 이미지에서 얼굴을 포함하는 최소 사각형 영역을 검출할 수 있다([도 3] 101 내의 검정색 박스 영역). 이 최소 사각형의 좌상단 좌 표를 (x, y)라 하고, 사각형의 너비 및 높이를 각각 w, h 라 하면, 열화상 이미지에서 대응되는 얼굴 부위 최소 사각형의 좌상단 좌표 (x',y')은 식 과 같이 구해지며, 너비 및 높이 w′, h′은 각각 다음 식 와 같이 구해진다. w'=w*m/c, h'=h*n/d 이후, 열화상 이미지에서 얼굴 부위 온도 계산 영역을 좀 더 정확히 하기 위해 위에서 구한 매칭된 얼굴 영역 사각형을 좀 더 안쪽으로(10% 정도) 잘라내어 열화상 이미지에서의 최종 얼굴 온도 영역([도 3] 301)으로 특정 한다. 다) 얼굴 부위 체온 계산 사람의 정상 체온 범위는 35.5℃~37.5℃이며, 38℃ 이상의 체온인 경우에 발열이 있다고 판정된다. 얼굴 부위 영역에서 마스크나 안경 부위에서의 온도는 보통 사람의 체온보다는 낮다. 따라서, 얼굴 부위 영역 전체의 평균 을 구하게 되면, 이러한 얼굴 피부 이외의 부분에서의 측정된 온도 때문에 낮아지게 된다. 또한, 사람의 체온이 40℃ 이상이면 생명을 위협할 수준이므로, 돌아다닐 정도가 못 된다. 만일 얼굴 부위에서의 열화상 이미지 픽셀 이 40℃ 이상이면 노이즈이거나, 사람이 아닌 발열 물체에서 측정될 가능성이 매우 크다. 따라서, 본 발명에서 는 얼굴 부위 영역에서의 픽셀의 온도 값이 35℃ 미만이거나 40℃ 이상이면 적절한 데이터 값 범위를 넘어선 아 웃라이어로 간주하여 얼굴 부위 온도 평균 계산에서 제외하도록 한 후에 평균을 구하고 이를 다시 연속된 다수 프레임(본 발명 실험에서는 4 프레임)에 걸쳐 평균을 계산하여 이를 최종적으로 얼굴 부위 체온으로 결정한다. [도 4](a) 실험 대상 사람에 대해 얻어진 열화상 센서 이미지 [도 4] (b) 에서 노란색 부분들이 35℃~ 39 ℃ 사이의 온도 값을 갖는 픽셀들이다. [도 4] (c) 이미지는 [도 4] (b) 의 이미지 픽셀값을 엑셀로 옮겨 엑셀 의 제공하는 컬러맵을 이용하여 그린 이미지이며, [도 4] (d) 는 이를 확대한 이미지이다. [도 4] (d) 의 경우, 얼굴 부위 ([도 4] 401 초록색 박스) 내에서 아웃라이어를 제외한 픽셀들의 온도 평균값 은 36.31°이었다. [도 5]는 본 발명에서 제안한 체온 추정 알고리즘의 안정성을 보여 주는 그림으로 얼굴 근방에 뜨거운 컵을 들 고 있어도 본 발명의 제안은 체온을 안정적으로 결정하여 표출하여 보여 주는 그림으로도 5에서 체온은 정상 온 도 범위의 체온인 37.20℃를 보여 준다. 2) 체온 측정, 마스크 착용 체킹, 전자정보 QR 코드 체킹 등을 기존 사이니지 시스템에 통합하는 절차 방안 본 발명에서 사용한 얼굴 검출 및 바코드 스캐닝 알고리즘은 얼굴 및 QR 코드의 위치를 영상 이미지에서 가정하 지 않는다. 얼굴 또는 QR 코드가 이미지에 어디에 있든지 검출하거나 인식한다. 얼굴 마스크 검출은 검출된 얼 굴 이미지를 대상으로 마스크를 검출한다. [도 6]'은 본 발명에서 제안한 얼굴 검출, 마스크 검출, 체온 측정 및 QR 체크인 코드 체킹 등을 기존 사이니지 시스템에 통합하는 절차 방안의 동작플로우를 보여 준다. 본 발명에서 제안된 체온 측정, 마스크 착용 체킹, 전자정보 QR 코드 체킹의 사이니지 통합 절차는 ‘광학센서 처리 모듈’‘얼굴 및 마스크 검출 모듈’‘열화상센서 처리 모듈’‘코드 스캐닝 처리 모듈 ’으로 구성된다. 먼저 '광학센서 처리 모듈' 에서는 이미지 프레임을 획득하고 이를 ‘얼굴 및 마스크 검출 모듈(20 0)’로 전달한다. ‘얼굴 및 마스크 검출 모듈’에서는 전달받은 광학 카메라에서 획득된 영상 이미지에 대해 얼굴 검출 알 고리즘을 적용하여, 먼저 얼굴을 검출하고, 검출된 얼굴 부위 사각형의 크기를 점검하여 적절한경우에 얼굴 사각형 좌상단 좌표 (x, y), 얼굴 사각형 너비 w 및 높이 h ([도 2] 참조)를 구한다. 이후 이 (x, y, w, h) 정보는 ‘열화상센서 처리 모듈’로 전달되며, 또한 이 정보를 이용하여 광학 이미지에서 얼 굴 부위 이미지를 추출한다. 추출된 얼굴 이미지에 대해 마스크 검출 알고리즘을 적용하여, 마스크 검출 여부를 체킹하고, 이 결과를 화면에 표출한다. 이후 ‘열화상센서 처리 모듈’로 넘겨받은 체온 정보를 통해 발열 이상 여부를 체킹하여, 추후 사후 보고를 위해 해당 이상 체온 정보를 저장한다 . 이 작업이 끝나면, ‘코드 스캐닝 처리 모듈 ’를 기동시킨다. ‘열화상센서 처리 모듈’에서는 먼저 열화상 이미지를 획득한 후에, 넘겨받은 광학 이미지에서의 얼 굴 이미지 사각형 정보 (x, y, w, h)를 이용하여, 식 과 를 적용하여 열화상 이미지에서의 얼굴 부위 정보 (x’y’w’h’를 계산해내고 다시 10% 정도 적게 잘라내어 얼굴 부위를 확정한 후에 이 확정 얼굴 부위 열 화상 온도 데이터값들을 추출한다. 이후 이 얼굴 부위 열화상 온도 데이터에서 아웃라이어(35℃ 이하, 40 ℃ 이상 데이터)를 제외한 열화상 온도 데이터값의 평균을 구한다. 이후 다수 프레임(본 발명의 실험에서 는 4프레임)에 걸쳐 평균을 구하고 이를 체온으로 결정한다. 이 체온을 화면에 표출하고 이를 ‘얼굴 및 마스크 검출 모듈’에 전달한다. ‘코드 스캐닝 처리 모듈 ’에서는 QR 코드를 스캐닝하여 QR 코드값을 파악한다. 이후 QR 코드값을 저장한다."}
{"patent_id": "10-2022-0170823", "section": "도면", "subsection": "도면설명", "item": 1, "content": "[도 1]은 본 발명 대상의 사이니지 기기의 구조를 보여 주는 그림이다. [도 2]는 본 발명에서 광학 이미지에서 검출된 얼굴 이미지 부분((a))과 열화상 센서 이미지((b))에서의 얼굴 부분 매핑 과정을 도시적으로 보여 주는 그림이다. 점 p 는 광학 이미지에서의 점이며, 점 p'는 열화상 이미지 에서의 점 p 점에 대응되는 점이다. [도 3]은 광학 이미지에서 검출된 얼굴 부위((a))를 좌표 매칭에서 얻어진 열화상 이미지에서의 얼굴 부위 ((b)), 열화상 얼굴 부위를 더 안쪽으로(대략 10% 정도 안쪽) 잘라낸 열화상 얼굴 이미지((c))를 보여 주는 그 림이다. [도 4]는 열화상 이미지에서의 매핑된 얼굴 부분과 얼굴 부분에서의 열화상 이미지 데이터값을 보여 주며, 얼굴 피부 부분(주로 이마)과 마스크 부분, 안경 착용 부분 등의 픽셀값이 차이가 있음을 보여 주는 그림으로 (a) 는 실험 대상 사람에 대해 획득된 광학 이미지, (b) 는 획득된 열화상 이미지, (c) 는 엑셀 컬러맵을 이용하여 열 화상 이미지에서의 온도 데이터 및 온도 데이터값에 따른 색상(노란색 부분이 온도 데이터값이 정상 온도 범위 부분, 갈색 부분이 정상 온도 범위와 많이 차이나는 부분)을 보여 주는 이미지, (d) 는 (c) 온도 데이터 이미지 를 확대한 온도 데이터 이미지. [도 5]는 본 발명에서 제안한 체온 추정 알고리즘의 안정성을 보여 주는 그림으로 얼굴 근방에 뜨거운 컵을 들 고 있어도 본 발명의 제안은 체온을 안정적으로 결정하여 표출하여 보여 주는 그림으로 [도 5]에서 체온은 정상 온도 범위의 체온인 37.20℃를 보여 준다. [도 6]은 얼굴 검출, 체온 측정, 마스크 검출, 및 전자명부 QR 코드 체킹 등의 여러 태스크가 체계적으로 통합 처리되는 워크플로우를 보여 주는 그림이다. [도 7]은 본 발명 제안으로 구현한 사이니지 시스템의 동작 과정 이미지들을 보여 주는 그림이다. (a) 는 체온 이 정상인 경우의 동작 과정 이미지, (b) 는 마스크를 착용하지 않은 경우의 동작 과정 이미지, (c) 전자명부 QR check-in 체킹 경우의 동작 과정 이미지"}
