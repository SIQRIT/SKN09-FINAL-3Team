{"patent_id": "10-2023-0030180", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2024-0136778", "출원번호": "10-2023-0030180", "발명의 명칭": "인공지능기반 뇌대사 인지저하 패턴 점수를 초기시간획득 아밀로이드 PET영상으로부터 추출하", "출원인": "서울대학교병원", "발명자": "최홍윤"}}
{"patent_id": "10-2023-0030180", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "PET 영상 촬영 장치로부터 PET 이미지 데이터를 이미지 획득부를 통해 획득하는 PET 이미지 획득 단계;상기 PET 이미지 획득 단계에서 획득된 PET 이미지 데이터를 전처리부에서 전처리하는 전처리 단계;상기 PET 이미지 데이터로부터 소스 인코더의 소스 CNN을 선행 학습하여 예측부가 소스 클래스(Source class)를잘 구분하도록 학습 모델을 생성하는 학습 단계;소스 인코더의 소스 CNN을 투과하여 인코드된 FDG PET 이미지와 타겟 인코더의 타겟 CNN을 투과하여 인코드된FBB PET 이미지의 특성을 판별부가 구별하지 못하도록 예측부를 도메인 어뎁테이션(Domain Adaptation)을 수행하여 학습시키는 적대적 적응 단계;상기 적대적 적응 단계를 통해 학습된 예측부의 타겟 CNN을 이용하여 뇌대사 인지기능 저하를 점수를 매기는 스코어링 단계를 포함하는 것을 특징으로 하는, 인공지능기반 뇌대사 인지저하 패턴 점수를 초기시간획득 아밀로이드 PET 영상으로부터 추출하는 방법."}
{"patent_id": "10-2023-0030180", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "청구항 1에 있어서,상기 전처리 단계는, FDG PET 데이터 및 FBB PET 데이터를 공간 정규화하여 합성곱 신경망에 학습모델을 적용하기 위한 이미지 데이터셋을 획득하는 단계;주어진 PET 데이터를 각 복셀별 계수율 값을 뇌 전체의 평균 계수율 값으로 나누어 표준섭취계수율(SUVR)로 변환하는 단계; 상기 PET 이미지 데이터의 표준섭취계수율(SUVR) 분포를 정규화하는 단계; 및 뇌 영역에 해당하는 부분으로 이진화된 맵(마스크 파일)을 이용하여 뇌 영역에 해당하는 부분만의 표준섭취계수율(SUVR)을 얻는 단계를 포함하는 것을 특징으로 하는, 인공지능기반 뇌대사 인지저하 패턴점수를 초기시간획득아밀로이드 PET 영상으로부터 추출하는 방법."}
{"patent_id": "10-2023-0030180", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "청구항 1에 있어서,상기 적대적 적응 단계는, PET 이미지 데이터를 콘벌루션(convolution)하는 단계 및 풀링(pooling)하는 단계를수행하여 보다 낮은 차원의 데이터를 생성하는 것을 특징으로 하는, 인공지능기반 뇌대사 인지저하 패턴 점수를초기시간획득 아밀로이드 PET 영상으로부터 추출하는 방법."}
{"patent_id": "10-2023-0030180", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "청구항 1에 있어서,상기 스코어링 단계는,상기 추출된 특징맵(featuremap)을 한 개의 인공신경망 노드로 마지막 레이어에서 연산하여 뇌대사 인지저하 패턴 점수를 도출하는 것을 특징으로 하는, 인공지능기반 뇌대사 인지저하 패턴 점수를 초기시간획득 아밀로이드공개특허 10-2024-0136778-3-PET 영상으로부터 추출하는 방법."}
{"patent_id": "10-2023-0030180", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "청구항 3에 있어서,상기 스코어링 단계는,시그모이드(sigmoid) 함수를 적용하여 확률값으로 뇌대사 인지저하 패턴 점수를 도출하는 것을 특징으로 하는,인공지능기반 뇌대사 인지저하 패턴 점수를 초기시간획득 아밀로이드 PET 영상으로부터 추출하는 방법."}
{"patent_id": "10-2023-0030180", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 뇌 FDG(fluorodeoxyglucose) PET 데이터로부터 유사한 영상 이미지를 획득할 수 있는 아밀로이드 PET(Positron Emission Tomography) 트레이서(Tracer)의 초기영상 데이터를 활용해, 인공지능기반 뇌대사 인지 저하 패턴 점수를 추출하는 장치 및 방법을 제안한다."}
{"patent_id": "10-2023-0030180", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 뇌 FDG(fluorodeoxyglucose) PET 데이터로부터 분류모델 학습 방법과 유사한 영상 이미지를 획득할 수 있는 아밀로이드 PET(Positron Emission Tomography) 트레이서(Tracer)의 초기영상 데이터를 활용해, 인공 지능기반 뇌대사 인지저하 패턴 점수를 추출하는 방법에 관한 것이다."}
{"patent_id": "10-2023-0030180", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "PET(양전자 방출 단층촬영)은 방사성 핵종 스캔의 일종으로 방사성 핵종은 방사성 형태의 원소이며, 이는 방사 선으로 에너지를 방출함으로 이를 추적하여 체내 분포를 알아보는 방법이다. 하지만 사용되는 방사성 핵종의 종 류에 따라 추적자의 분포가 달라 다른 추적자 간의 비교나 딥러닝 모델을 적용시키는데 생물학적 이해 및 시각 적 해석에 제한이 있다. 또한 서로 추적자 간의 다른 조직이나 여러 조직 샘플을 비교할 대 샘플 간의 위치와 모양이 동일하지 않기 때 문에 데이터, 발달 진행과정 데이터, 조건이 다른 데이터 등 비교분석을 할 때 어려움이 있다. 뇌 아밀로이드 PET은 대개 주사 후 특정 시간(Florbetaben에서는 약 90분) 이 지난 후 영상을 획득하여 뇌회백 질의 아밀로이드 침착정도를 확인하는 목적의 검사이다. 해당 검사를 수행할 때 주사후 10분 이내에 촬영하는 초기 영상 검사에 대해서는 이러한 아밀로이드 침착의 분포가 아닌 뇌의 혈류량과 관련된 정보를 얻을 수 있다. 뇌 영상의 경우 FDG(fluorodeoxyglucose) PET(Positron Emission Tomography)은 뇌 대사정도를 반영하며, 뇌 혈류와 대사는 뇌의 활성도와 연결되어있어서 뇌대사 및 혈류 영상은 뇌의 기능적 정보를 획득하는데 이용될 수 있다. 뇌의 기능적 정보를 얻을 수 있는 FDG PET은 치매를 포함한 다양한 뇌질환의 검사에 응용이 된다. 특히 FDG PET이 치매 진단에 있어서는 치매 여부에 대한 감별과 알츠하이머치매, 전측두엽치매, 루이소체 치매 등에서 서로 다른 뇌활성도 저하 패턴이 나타나기 때문에 임상적으로 활용되며, 최근에는 A/T/N 진단 구분이라 는 것이 활용되기 시작하여 바이오마커 기반의 진단이 이루어진다. 이 가운데 A는 아밀로이드로서 아밀로이드 PET으로, T는 타우침착정도로서 타우 PET으로, N은 신경퇴행으로서 MRI 및 FDG PET으로 정보를 획득할 수 있다. 치매를 위한 진단에서는 아밀로이드 PET과 FDG PET을 모두 촬영하는 것이 위와 같은 서로 다른 종류의 정보를 얻기에 크게 도움이 되나, 환자의 비용적 측면 등을 고려할 때 실질적으로 두가지 검사를 모두 시행하기 어려운 경우가 많다는 문제점이 있었다. 선행기술문헌 특허문헌(특허문헌 0001) 대한민국 등록특허 제10-2288727호(2021.08.10.)"}
{"patent_id": "10-2023-0030180", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "상술한 바와 같은 문제점을 해결하기 위해, 본 발명은 서로 다른 추적자간의 영상 데이터로부터의 딥러닝 모델 을 적용하여 높은 정확도의 진단 모델을 개발하기 위해 도메인 어뎁테이션(Domain Adaptation)을 적용하여 범용 적으로 사용 가능한 인공지능기반 뇌대사 인지저하 패턴 점수를 초기시간 획득 아밀로이드 PET영상으로부터 추 출하는 방법을 제공하고자 한다."}
{"patent_id": "10-2023-0030180", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "전술한 목적을 달성하기 위한 본 발명의 일측면에 따른 인공지능기반 뇌대사 인지저하 패턴 점수를 초기시간획 득 아밀로이드 PET영상으로부터 추출하는 방법은, PET 영상 촬영 장치로부터 PET 이미지 데이터를 이미지 획득 부를 통해 획득하는 PET 이미지 획득 단계; 상기 PET 이미지 획득 단계에서 획득된 PET 이미지 데이터를 전처리 부에서 전처리하는 전처리 단계; 상기 PET 이미지 데이터로부터 소스 인코더의 소스 CNN을 선행 학습하여 예측 부가 소스 클래스(Source class)를 잘 구분하도록 학습 모델을 생성하는 학습 단계; 소스 인코더의 소스 CNN을 투과하여 인코드된 FDG PET 이미지와 타겟 인코더의 타겟 CNN을 투과하여 인코드된 FBB PET 이미지의 특성을 판 별부가 구별하지 못하도록 예측부를 도메인 어뎁테이션(Domain Adaptation)을 수행하여 학습시키는 적대적 적응 단계; 및 상기 적대적 적응 단계를 통해 학습된 예측부의 타겟 CNN을 이용하여 뇌대사 인지기능 저하를 점수를 매기는 스코어링 단계를 포함하는 것을 특징으로 한다. 또한, 본 발명의 일측면에 따른 인공지능기반 뇌대사 인지저하 패턴 점수를 초기시간획득 아밀로이드 PET영상으 로부터 추출하는 방법에서 상기 전처리 단계는, FDG PET 데이터 및 FBB PET 데이터를 공간 정규화하여 합성곱 신경망에 학습모델을 적용하기 위한 이미지 데이터셋을 획득하는 단계와, 주어진 PET데이터를 각 복셀별 계수율 값을 뇌 전체의 평균 계수율 값으로 나누어 표준섭취계수율(SUVR)로 변환하는 단계와, 상기 PET 이미지 데이터 의 표준섭취계수율(SUVR)을 정규화하는 단계 및, 뇌 영역에 해당하는 부분으로 이진화된 맵(마스크 파일)을 이 용하여 뇌 영역에 해당하는 부분만의 표준섭취계수율(SUVR)을 얻는 단계를 포함할 수 있다. 또한, 본 발명의 일측면에 따른 인공지능기반 뇌대사 인지저하 패턴 점수를 초기시간획득 아밀로이드 PET영상으 로부터 추출하는 방법에서 상기 적대적 적응 단계는, PET 이미지 데이터를 콘벌루션(convolution)하는 단계 및 풀링(pooling)하는 단계를 수행하여 보다 낮은 차원의 데이터를 생성하는 것을 특징으로 한다. 또한, 본 발명의 일측면에 따른 인공지능기반 뇌대사 인지저하 패턴 점수를 초기시간획득 아밀로이드 PET영상으 로부터 추출하는 방법에서 상기 스코어링 단계는, 상기 추출된 특징맵(featuremap)을 한 개의 인공신경망 노드 로 마지막 레이어에서 연산하여 뇌대사 인지저하 패턴 점수를 도출하는 것을 특징으로 한다. 또한, 본 발명의 일측면에 따른 인공지능기반 뇌대사 인지저하 패턴 점수를 초기시간획득 아밀로이드 PET영상으 로부터 추출하는 방법에서 상기 스코어링 단계는, 시그모이드(sigmoid) 함수를 적용하여 확률값으로 뇌대사 인 지저하 패턴 점수를 도출하는 것을 특징으로 한다."}
{"patent_id": "10-2023-0030180", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명에 따르면, PET 영상 분석에 결과에 기반한 딥러닝을 이용하여, 보다 다양한 퇴행성뇌질환을 포함한 뇌 질환 검사에서 객관적인 인지저하평가 점수를 제공하여, 뇌질환 진단에 활용될 수 있는 효과를 갖는다. 또한 본 발명에 따르면, 기존의 학습된 딥러닝 모델을 다른 초기시간획득 아밀로이드 PET에 적용하여 일관성있 고 정제된 학습 데이터의 양을 보충할 수 있어 범용적으로 보다 고성능의 딥러닝 모델을 생성할 수 있는 효과를 갖는다. 또한 본 발명에 따르면, 연산된 뇌대사 인지저하 점수를 사용함으로써, 인지저하에 관련한 뇌질환 진단의 정확 성을 향상시킬 수 있는 효과를 갖는다."}
{"patent_id": "10-2023-0030180", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "본 발명의 목적과 기술적 구성 및 그에 따른 작용 및 효과에 관한 자세한 사항은 본 발명의 명세서에 첨부된 도 면에 의거한 상세한 설명에 의해 보다 명확하게 이해될 것이다. 본 명세서에서 사용되는 용어는 단지 특정한 실시예를 설명하기 위해 사용되는 것으로 본 발명을 한정하려는 의 도가 아니다. 예컨대, 본 개시의 구성 요소를 설명하는 데 있어서, 제1, 제2, A, B, (a), (b) 등의 용어를 사용 할 수 있다. 이러한 용어는 그 구성 요소를 다른 구성 요소와 구별하기 위한 것일 뿐, 그 용어에 의해 해당 구 성 요소의 본질이나 차례 또는 순서 등이 한정되지 않는다. 어떤 구성 요소가 다른 구성요소에 \"연결\", \"결합\" 또는 \"접속\"된다고 기재된 경우, 그 구성 요소는 그 다른 구성요소에 직접적으로 연결되거나 또는 접속될 수 있 지만, 각 구성 요소 사이에 또 다른 구성 요소가 \"연결\", \"결합\" 또는 \"접속\"될 수도 있다고 이해되어야 할 것 이다. 본 개시에서 사용되는 \"포함한다 (comprises)\" 및/또는 \"포함하는 (comprising)\"은 언급된 구성 요소, 단계, 동 작 및/또는 소자는 하나 이상의 다른 구성 요소, 단계, 동작 및/또는 소자의 존재 또는 추가를 배제하지 않는다. 어느 하나의 실시예에 포함된 구성요소와, 공통적인 기능을 포함하는 구성 요소는, 다른 실시예에서 동일한 명 칭을 사용하여 설명될 수 있다. 반대되는 기재가 없는 이상, 어느 하나의 실시예에 기재된 설명은 다른 실시예 에도 적용될 수 있으며, 중복되는 범위 또는 당해 기술 분야에 속한 통상의 기술자가 자명하게 이해할 수 있는 범위 내에서 구체적인 설명은 생략될 수 있다. 도 1 내지 도 7을 참조하여 본 발명에 따른 인공지능기반 뇌영상기반 인지저하 패턴 점수를 초기시간 획득 아밀 로이드 PET(Positron Emission Tomography)영상으로부터 추출하는 장치 및 방법을 살펴보면, 본 발명은 뇌 FDG(fluorodeoxyglucose) 데이터로부터 분류모델 학습 방법과 유사한 영상 이미지를 획득할 수 있는 아밀로이드 PET 트레이서(Tracer)의 초기영상 데이터를 활용해 인공지능모델을 학습하고 뇌의 기능적 인지저하 관련 점수를 추출하는 장치 및 방법에 관한 것이다. 본 발명에 따르면, 아밀로이드 PET 단독 검사에서 초기영상을 획득하여 FDG PET에서 얻을 수 있는 추가적 정보 를 활용할 수 있다. 즉, 뇌 FDG PET에서 인지기능을 평가하기 위해서 정량화된 수치를 제공하여 인지 시그니처 (cognitive signature)를 인공지능 모델로 활용하여, 치매뿐 아니라, 파킨슨환자, 렘수면 행동장애 환자, 그리 고 뇌졸중 후 환자에서도 인지기능 저하를 객관적으로 평가할 수 있다. 따라서, AI(Artificial Intelligence)모 델을 아밀로이드(amyloid) PET 초기 영상에도 적용하여, 뇌대사 인지저하 패턴 점수를 획득할 수 있다. 도 1에 도시된 바와 같이, 본 발명에 따른 인공지능기반 뇌대사 인지저하 패턴 점수를 초기시간획득 아밀로이드 PET 영상으로부터 추출하는 장치는, 이미지 획득부, 전처리부, 예측부, 소스 인코더, 타겟 인코더, 판별부, 적대적 적응부 및 스코어링부를 포함할 수 있다. 보다 구체적으로 본 발명에 따른, 인공지능기반 뇌대사 인지저하 패턴 점수를 초기시간획득 아밀로이드 PET 영 상으로부터 추출하는 장치는, 이미지 획득부에서 FDG PET 영상 촬영 장치(미도시)로부터 FDG PET 이미지 데이터를 획득하여 FDG PET 이미지 데이터로부터 예측부와 소스 인코더의 소스 CNN을 선행 학습하여 소스 클래스(Source class)를 잘 구분하도록 학습모델을 생성한다. 또한, 초기 아밀로이드 PET 이미지를 이미지 획득부에서 PET 영상 촬영 장치(미도시)로부터 획득하여 소스 CNN을 투과한 피처맵(featuremap)과 타겟 인코더의 타겟 CNN에 투과시킨 피처맵을 판별부를 통해 형 성된 피처맵이 FDG PET 이미지 데이터와 초기 아밀로이드 PET 이미지 데이터를 구별할 수 있다. 판별부를 통해 FDG PET 이미지 데이터와 초기 아밀로이드 PET 이미지 데이터를 구별하여 생성된 라벨 데이 터를 판별부가 잘 구별하지 못하도록 타겟 인코더의 타겟 CNN을 적대적 적응부를 통해 적대적 손실 함수(adversarial loss function)를 사용하여 학습할 수 있다. 또한, 학습된 결과 데이터를 초기 아밀로이드 PET 이미지는 타겟 인코더를 사용하여 피처공간에 매핑되고 예측부에 의해 분류하여 아밀로이드 침착의 분포가 아닌 뇌의 혈류량과 관련된 정보를 활용하여 스코어링 부를 통해 뇌대사 인지기능 저하 점수를 추출할 수 있다. 따라서, 기존 FDG PET 이미지로 학습된 CNN을 새로운 도메인의 초기아밀로이드 PET 이미지 데이터에 적용해 인 지기능 저하 점수를 추출할 수 있다. 또한, 이미지 획득부에서 획득되는 PET 이미지 데이터는 전처리부에서 전처리 단계가 수행될 수 있으 며, 뇌 영역에 해당하는 부분으로 이진화된 맵을 얻고, 이 맵을 마스크로 활용하여 PET 이미지에 대응하여 PET 이미지 데이터로부터 뇌 영역에 해당하는 데이터를 얻을 수 있다. 또한, 뇌영역에 해당하는 데이터를 다른 대상의 뇌 스캔들과 동일한 위치에 해당하도록 전처리부에서 공간 정규화하는 이미지 등록할 수 있고, PET 이미지는 그리드 셀 이미지로 재배치될 수 있다. 또한, 정해진 크기의 가우시안(Gaussian) 필터를 이미지에 적용하여 이미지를 획득할 수 있다. 따라서 이미지 획득부에서 획득된 PET 이미지 데이터는 전처리부를 통해 전처리되어 학습될 수 있다 또한, 도 2에 도시된 바와 같이, 본 발명에 따른 인공지능기반 뇌대사 인지저하 패턴 점수를 초기시간획득 아밀 로이드 PET 영상으로부터 추출 방법은, 이미지 획득부에서 PET 영상 촬영 장치(미도시)로부터 FDG PET 이 미지 데이터를 획득하는 단계(S110)와, 이미지 획득부에서 획득되는 FDG PET 이미지 데이터는 전처리부 에서 전처리하는 전처리 단계(S120)와, FDG PET 이미지 데이터로부터 예측부와 소스 인코더의 소스 CNN을 선행 학습하여 소스 클래스(Source class)를 잘 구분하도록 학습 모델을 생성하는 학습 단계(S130) 와, 소스 인코더의 소스 CNN을 투과하여 인코드(Encode)된 FDG PET 이미지와 타겟 인코더의 타겟 CNN 을 투과하여 인코드된 FBB PET 이미지의 특성을 판별부가 구별하지 못하도록 타겟 인코더의 타겟 CNN 을 학습시키는 도메인 어뎁테이션(Domain Adaptation)을 수행하는 적대적 적응 단계(S140) 및 학습된 타겟 인코 더의 타겟 CNN 및 예측부를 이용하여 뉴럴 네트워크(Neural Net)를 통과하여 얻어진 텐서에 시그모이 드(sigmoid) 함수를 적용하여 뇌대사 인지기능 저하를 점수를 매기는 스코어링 단계(S150)를 포함할 수 있다. 즉, 상기 과정에서 구해진 마지막 텐서에 시그모이드 함수를 적용하여 확률 값으로 뇌대사 인지기능 저하 스코 어링이 가능한 것을 특징으로 한다. 이때 초기시간 획득 아밀로이드 PET 영상은 해당 검사를 수행할 때 아밀로이드 추적용 방사성의약품 주사후 10 분 이내에 촬영하는 초기 영상 검사에 대해서는 이러한 아밀로이드 침착의 분포가 아닌 뇌의 혈류량과 관련된 정보를 얻을 수 있는 것으로 뇌의 혈류량 관련 정보를 활용하는 것을 특징으로 한다. 즉, 초기시간 획득 아밀로이드 PET 영상은 아밀로이드 추적용 방사성의약품이 투여된 진단 대상자의 뇌를 단층 촬영함에 있어서 아밀로이드 추적용 방사성의약품 주사 후 10분 이내에 촬영된 영상을 의미한다. 따라서, 기존 FDG PET 이미지로 학습된 CNN을 새로운 도메인의 초기 아밀로이드 PET 이미지 데이터에 적용해 인 지기능 저하 점수를 추출할 수 있다. 또한, 전처리 단계(S120)는 뇌 영역에 해당하는 데이터를 다른 대상의 뇌 스캔 이미지들과 동일한 위치에 해당 하도록 공간 정규화하는 이미지 등록 단계(S121)와, PET 이미지 데이터에서 뇌 영역에 해당하는 부분으로 이진 화된 맵을 얻는 단계(S122)와, 이진화된 맵을 마스크로 활용 PET 이미지 데이터에 대응하여 PET 이미지 데이터 로부터 뇌 영역에 해당하는 데이터를 얻는 단계(S123)와, PET 이미지 데이터를 설정된 값으로 그리드 셀 이미지 로 재배치하는 단계(S124) 및 정해진 크기의 가우시안(Gaussian) 필터를 PET 이미지 데이터에 적용하여 이미지 를 획득하는 단계(S125)를 포함할 수 있다. 또한, 전처리 단계(S120)에서 이진화된 맵을 얻는 단계(S122)는 PET 이미지 데이터의 표준섭취계수율(SUVR: Standardized Uptake Value Ratio)을 정규화 하여 뇌 영역에 해당하는 부분으로 이진화된 맵을 얻을 수 있다. 이때 표준섭취계수율(SUVR) 분포를 0과 1범위로 정규화 할 수 있으며, 표준섭취계수율 분포는 설정값에 따라 다 르게(예: -1 내지 1, 0 내지 10) 설정할 수 있음은 물론이다. 또한, 전처리 단계(S120)에서 이미지 등록 단계(S124)는, FDG PET 데이터 및 FBB PET 데이터 값을 정규화하여 합성곱 신경망에 학습모델을 적용하기 위한 이미지 데이터셋을 획득할 수 있다. 또한, 그리드 셀 이미지 재배치 단계(S125)는, 예를들어 2mm 입방 셀에 배치된 91x109x91 셀로 설정된 값으로 재배치할 수 있다. 따라서 이미지 획득부에서 획득된 PET 이미지 데이터는 전처리부를 통해 전처리되어 학습될 수 있다. 따라서, 전처리 단계(S120)는, FDG PET 데이터나 FBB PET 데이터를 얻는 단계와, 공간 정규화 단계와, 뇌 (brain) 영역 마스크(mask)를 통해서 뇌(brain) 영역 부분을 얻는 단계(같은 template위에서 mask하기 위해)와, 이미지 데이터 값을 정규화(SUVR - brain 전체에 대한 값을 1로할때 상대적인 값)단계와, CNN input위 한 정규화 (0-1 값 또는 -1-1 값 등)단계로 진행된다. 이때 이미지 데이터 값을 정규화하는 단계는, 마스킹(masking)하는 뇌 영역 부분을 얻는 단계 이전에 진행할 수 있다. 또한, 적대적 적응 단계(S140)는, 초기 아밀로이드 PET 이미지를 이미지 획득부에서 PET 영상 촬영 장치 (미도시)로부터 획득하여 소스 인코더의 소스 CNN을 투과한 피처맵(featuremap)과 타겟 인코더의 타 겟 CNN에 투과시킨 피처맵을 판별부를 통해 형성된 피처맵이 FDG PET 이미지 데이터와 초기 아밀로이드 PET 이미지 데이터를 구별할 수 있으며, 판별부를 통해 FDG 이미지 데이터와 초기 아밀로이드 PET 이미지 데이터를 구별하여 생성된 라벨 데이터를 판별부가 잘 구별하지 못하도록 타겟 인코더은 적대적 적응 부를 통해 적대적 손실 함수(adversarial loss function)를 사용하여 학습하고, 학습된 결과 데이터를 초 기 아밀로이드 PET 이미지는 타겟 인코더를 사용하여 피처공간에 매핑되고 예측부에 의해 분류하여 아밀로 이드 침착의 분포가 아닌 뇌의 혈류량과 관련된 정보를 활용하여 스코어링부를 통해 뇌대사 인지기능 저하 점수를 추출할 수 있다. 따라서, 기존 FDG 이미지로 학습된 CNN을 새로운 도메인의 초기아밀로이드 PET 이미지 데이터에 적용해 인지기 능 저하 점수를 추출할 수 있다. 도 3은 도메인 어뎁테이션(Domain Adaptation)과정을 설명하기 위한 도면으로, 도 3(a)는 FDG(Fluorodeoxyglucose) PET(Positron Emission Tomography) 이미지를 활용하여 소스 인코더(Source encoder) CNN(Convolutional Nerual Network) 및 예측부(Predictor)를 소스 클래스(Source class)를 잘 구분하도록 사전 학습 시키는 선행 학습(Pre-training) 단계(S130)와, 도 3(b)는 소스 인코더(Source encoder)의 소스 CNN을 투 과하여 인코드(Encode) 된 FDG PET 이미지와 타겟 인코더(Target encoder) 타겟 CNN을 투과하여 인코드 (Encode) 된 FBB(Florbetaben) PET 이미지의 특성을 판별부(Discriminater)가 구별하지 못하도록 타겟 인코더 (Target encoder)의 타겟 CNN을 학습시키는 도메인 어뎁테이션(Domain Adaptation)을 수행하는 적대적 적응 (Adversarial Adaptation) 단계(S140)와, 도 3(c)는 타겟 인코더(Trarget encoder)의 타겟 CNN이 학습된 예측 부(Predictor)를 이용하여 상기 과정에서 신경망(neural Net)을 통과하여 얻어진 마지막 텐서(tensor)를 활용하 여 뇌대사 인지기능 저하를 스코어링 하는 단계(S150)를 나타낸다. 이미지 획득 단계(S110)는 PET촬영 이미지를 통해 아밀로이드 추적용 방사성의약품이 투여된 진단 대상자의 뇌 를 단층 촬영함에 따라 획득되는 복수 개의 단층 촬영 이미지를 입력받을 수 있다. 우선 환자의 알츠하이머 진단 여부가 라벨이 구분 되어있는 FDG PET 이미지 코호트를 활용한다. 여기서 코호트(cohort)는 통계적으로 동일한 특색이나 행동 양식을 공유하는) 집단, 즉 공통적인 특성을 가진 것들의 집단을 의미한다. 학습에 사용되는 PET 데이터를 추출하는 전처리 단계(S120)에 대한 실시 예는 도 4를 참조하여 보다 자세히 설 명될 수 있다. 도 4는 PET 이미지 데이터를 도시한다. 본 발명의 실시 예에서, PET 이미지 데이터는 학습을 진행하기 전에 수 행된다. 도 4(a)의 원본(original) PET 이미지 데이터를 도 4(b)에 도시된 바와 같이 정규화(normalized)를 진행하고, 도 4(c)와 같이 그리드 셀 이미지로 재배치하며, 도 4(d)에 도시된 바와 같이, 가우시안 필터를 이미지에 적용 하여 이미지를 획득할 수 있다. 보다 구체적으로 살펴보면, 전처리 단계(S120)의 PET 데이터는, 뇌 영역에 해당하는 부분으로 이진화된 맵을 얻 는 단계(S121)와, 상기 맵을 상하 반전하여 반전된 마스크를 얻는 단계(S122)와, 상기 반전된 마스크를 상기 PET 이미지에 대응하여 상기 PET 이미지 데이터로부터 뇌 영역에 해당하는 데이터를 얻는 단계(S123)와, 상기 뇌영역에 해당하는 데이터를 다른 대상의 뇌 스캔들과 동일한 위치에 해당하도록 공간 정규화하는 이미지 등록 단계(S124)와, 상기 PET 이미지는 2mm 입방 셀에 배치된 91x109x91 셀 이미지 그리드로 재배치하는 재배치 단계 (S125) 및, 정해진 크기의 가우시안(Gaussian) 필터를 이미지에 적용하여 이미지를 획득하는 단계(S126)을 포함 할 수 있다. 다음으로, CNN(Convolution Neural Networks)를 이용하여 상기 PET 이미지 데이터를 연산하여 가중치를 업데이 트하는 단계를 수행할 수 있다. 본 발명의 실시 예는 적대적 적응 단계(S140)에서 적대적 차별 도메인 어뎁테이션(Adversarial Discriminative Domain Adaptation)을 이용하여 후에 설명할 CNN의 매개 변수인 가중치를 조정하여 다른 도메인(Domain)의 이미 지 데이터로부터 알츠하이머 질병을 보다 정확하게 진단할 수 있다. 도 5은 CNN을 이용하여 상기 FDG PET 데이터를 연산하여 가중치를 업데이트하는 단계를 도시한 것이다. 즉, 타겟 도메인(target domain)과 소스 도메인(source domain)을 최대한 구별할 수 없게 하는 방식으로 학습하 면 소스 도메인에서 분류(classification) 성능이 높고, 소스 도메인과 타겟 도메인을 구별하지 못하는 모델을 만들 수 있다. 도 5 및 도 6을 참조하면, 상기 가중치를 업데이트하는 적대적 적응 단계(S140)는, PET 이미지 데이터를 콘벌루 션(convolution)하는 단계(S141) 및 풀링(pooling)하는 단계(S142)를 수행하여 보다 낮은 차원의 데이터를 생성 한다. 본 발명의 실시 예에서, CNN의 구조는 아래 수식으로 표현될 수 있다. 입력 영상은 합성곱 신경망을 통해 처리됨으로서 특징맵 영상을 출력할 수 있다. 합성곱 신경망(CNN, Convolution Neural Network)은 단층 촬영 이미지(영상)로부터 테두리, 선 색 등과 같은 특징(features)들을 추출하는 신경망 기법으로서, 복수의 계층들(layers)을 포함할 수 있다. 각각의 계층 (layer)은 입력 데이터를 수신하고, 해당 계층의 입력 데이터를 처리하여 출력 데이터를 생성할 수 있다. 합성 곱 신경망은 입력된 영상 또는 입력된 특징맵(feature map)을 필터 커널들(filter kernels)과 컨볼루션하여 생 성한 특징맵을 출력 데이터로서 출력할 수 있다. 합성곱 신경망의 초기 계층들은 입력으로부터 에지들 또는 그 레디언트들과 같은 낮은 레벨의 특징들을 추출하도록 동작될 수 있다. 또한, 합성곱 신경망은 컨볼루션 연산이 수행되는 합성곱 계층(Convolution Layer) 외에도 풀링 연산이 수행되 는 풀링 계층(Pooling Layer)도 포함할 수 있다. 풀링 기법은 풀링 계층에서 데이터의 공간적 크기를 축소하는 데 사용되는 기법이다. 구체적으로, 풀링 기법에는 해당 영역에서의 최대값을 선택하는 맥스 풀링(Max Pooling) 기법과 해당 영역의 평균값을 선택하는 평균 풀링(Average Pooling) 기법이 있으며, 이미지 인식 분야에서는 일 반적으로 맥스 풀링 기법이 사용된다. 풀링 기법에서는 일반적으로 풀링의 윈도우 크기와 간격(스트라이드, stride)을 같은 값으로 설정한다. 여기서, 스트라이드란 입력 데이터에 필터를 적용할 때 이동할 간격을 의미하 며, 스트라이드 또한 출력 데이터의 크기를 조절하기 위해 사용될 수 있다. 또한, 합성곱 신경망 모델에서 합성곱 계층(Convolution layer)을 통해서 특징맵이 추출되면, 고해상도 사진을 보고 물체를 판별할 수 있지만, 작은 사진을 가지고도 그 사진의 내용이 어떤 사진인지 판단할 수 있는 원리와 마찬가지로, 이 모든 특징을 가지고 판단을 할 필요가 없기 때문에 생성된 특징맵의 사이즈를 인위적으로 줄이는 풀링(Pooling) 작업을 수행하는 것일 수 있다. 합성곱 신경망은 복수 계층들을 통해 처리될 수 있으며, 일정한 크기의 필터를 적용하여 영상의 특징을 추출할 수 있다. 예를 들어, 복수의 계층들은 입력데이터의 좌측 상단 NxM 픽셀에 가중치를 곱해서 특징맵의 좌측 상단의 한 뉴 런에 매핑시킨다. 이 경우, 곱해지는 가중치도 NxM가 될 것이다. 상기 NxM은 예컨데, 3x3일 수 있으나, 이에 한정되지 않는다. 이후, 동일한 과정으로, 복수의 계층들은 입력 데이터를 좌측에서 우측으로, 그리고 상단에서 하단으로 k 칸씩 스캔하면서 가중치를 곱하여 특징맵의 뉴런에 매핑한다. 상기 k 칸은 합성곱 수행시 필터를 이동시킬 간격(stride)을 의미하며, 출력 데이터의 크기를 조절하기 위해 적 절히 설정될 수 있다. 예컨데, k는 1일 수 있다. 상기 NxM 가중치는 필터 또는 필터 커널이라고 한다. 즉, 복수의 계층들에서 필터를 적용하는 과정은 필터 커널과의 컨볼루션 연산을 수행하는 과정이며, 그 결과 추 출된 결과물을 특징맵(feature map)이라고 한다. 또한, 도 5에 도시된 바와 같이, 첫번째 합성곱 층(Convolution layer) 커널의 크기는 5x5x5 로 설정하고 간격 (stride)는 4로 연산을 수행하고 두번째 합성곱 층(Convolution layer) 커널의 크기는 5x5x5 로 설정 간격 (stride)는 2로 연산을 수행한다. 3번째 합성곱 층(Convolution layer)에서 커널의 크기는 5x5x5 로 설정하고 특징 맵(feature map)의 크기가 입력의 크기와 동일하게 유지하도록 패딩을 사용한다. 사전학습(Pre-training)단계에서 소스(Source) CNN 및 예측부(Predictor)는 라벨링(labeling) 된 FDG PET 데이 터를 이용하여 이미지의 치매여부를 잘 분류하도록 학습한다. 적대적 적응(Adversarial Adaptation)단계에서 상기 소스 인코더Source encoder)의 소스 CNN을 활용하여 타겟 도메인 이미지(target domain image)를 잘 분류하기 위해서 도 6의 적대적 손실(Adverarial loss)은 소스 매핑 (Source mapping(M_s))과 타겟 매핑(Target mapping(M_t))은 L_adv_M을 최소화한다. 다만 이 손실 함수(loss function) 에서는 logD(M_t(xt)), 타겟 매핑(target mapping)에 대해서만 적대적 (adversarial)한 목적식을 가진다. D(M_t(xt))=1 이 되는 것이 목표로, 판별부(Discriminator)가 타겟 매핑(target mapping)과 소스 매핑(source mapping)의 도메인(Domain)을 구별하지 못하도록 학습한다. 따라서 스코어링 단계에서 학습된 타겟 인코더(target encoder)의 타겟 CNN으로 FBB PET 이미지를 매핑 (mapping)하여 사전학습 단계에서 생성된 예측부(Predictor)를 활용해 다른 추적자로 촬영된 PET 이미지 데이터 에 사용될 수 있는 뇌대사 인지저하 패턴점수를 도출할 수 있다. 도 7은 본 발명에 따른 FDG PET 이미지 데이터를 사용해 학습된 예측부(Predictor)의 분류 정확성(accuracy) 및 손실(loss)의 학습과정을 나타내는 도면이다. 본 발명에 따르면, PET 영상 분석에 결과에 기반한 딥러닝을 이용하여, 보다 다양한 퇴행성뇌질환을 포함한 뇌 질환 검사에서 객관적인 인지저하평가 점수를 제공하여, 뇌질환 진단에 활용될 수 있는 효과를 갖는다. 또한 본 발명에 따르면, 기존의 학습된 딥러닝 모델을 다른 초기시간획득 아밀로이드 PET에 적용하여 일관성있 고 정제된 학습 데이터의 양을 보충할 수 있어 범용적으로 보다 고성능의 딥러닝 모델을 생성할 수 있는 효과를 갖는다. 또한 본 발명에 따르면, 연산된 뇌대사 인지저하 점수를 사용함으로써, 인지저하에 관련한 뇌질환 진단의 정확 성을 향상시킬 수 있는 효과를 갖는다. 이상, 바람직한 실시예를 통하여 본 발명에 관하여 상세히 설명하였으나, 본 발명은 이에 한정되는 것은 아니며 특허청구범위 내에서 다양하게 실시될 수 있다. 특히, 전술한 내용은 후술할 발명의 청구범위를 더욱 잘 이해할 수 있도록 본 발명의 특징과 기술적 강점을 다소 폭넓게 상술하였으므로, 상술한 본 발명의 개념과 특정 실시예 는 본 발명과 유사 목적을 수행하기 위한 다른 형상의 설계나 변경의 기본으로써 즉시 사용될 수 있음이 해당"}
{"patent_id": "10-2023-0030180", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "기술 분야의 숙련된 사람들에 의해 인식되어야 한다.또한, 상기에서 기술된 실시예는 본 발명에 따른 하나의 실시예일 뿐이며, 해당 기술분야에서 통상의 지식을 가 진 자에 의해 본 발명의 기술적 사상의 범위에서 다양한 수정 및 변경된 형태로 구현될 수 있음을 이해할 수 있 을 것이다. 따라서, 개시된 실시예는 한정적인 관점이 아니라 설명적인 관점에서 고려되어야 하고, 이러한 다양 한 수정 및 변경 또한 본 발명의 기술적 사상의 범위에 속하는 것으로 후술할 본 발명의 청구범위에 나타나 있 으며, 그와 동등한 범위 내에 있는 모든 차이점은 본 발명에 포함된 것으로 해석되어야 할 것이다."}
{"patent_id": "10-2023-0030180", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명에 따른 인공지능기반 뇌대사 인지저하 패턴 점수를 초기시간획득 아밀로이드 PET영상으로부터 추출하는 장치를 나타내는 블록도이다. 도 2는 본 발명에 따른 인공지능기반 뇌대사 인지저하 패턴 점수를 초기시간획득 아밀로이드 PET영상으로부터 추출하는 방법의 순서를 나타내는 도면이다. 도 3은 본 발명에 따른 도메인 어뎁테이션(domain adaptation)을 적용하여 딥러닝 모델을 학습하는 방법에 대한 모식도이다. 도 4는 본 발명에 따른 PET 이미지 데이터를 사용하기전 전처리 작업을 수행한 결과를 나타내는 도면이다. 도 5는 본 발명에 따른 CNN(Convolution Neural Networks)의 진행과정을 이미지로 나타내는 도면이다. 도 6은 본 발명에 따른 적대적 적응(Adversarial Adaptation) 단계에서 사용되는 손실함수(loss function)를 수식으로 나타낸 도면이다. 도 7은 본 발명에 따른 FDG PET 이미지 데이터를 사용해 학습된 예측부(Predictor)의 분류 정확성(accuracy) 및 손실(loss)의 학습과정을 나타내는 도면이다."}
