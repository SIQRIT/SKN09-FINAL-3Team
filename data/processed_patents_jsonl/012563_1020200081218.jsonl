{"patent_id": "10-2020-0081218", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2022-0003424", "출원번호": "10-2020-0081218", "발명의 명칭": "다층 랜덤 포레스트 기반의 시계열 데이터 학습 장치 및 방법", "출원인": "계명대학교 산학협력단", "발명자": "고병철"}}
{"patent_id": "10-2020-0081218", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "다층 랜덤 포레스트 기반의 시계열 데이터 학습 장치(100)로서,연속된 복수의 프레임의 시계열 영상으로 구성되는 학습 데이터의 각 프레임에서 후보 영역을 탐지하는 후보 검출부(110);상기 학습 데이터의 연속된 복수의 프레임에서 탐지된 후보 영역을 연결하여 튜브를 생성하는 튜브 생성부(120);시간의 흐름에 따른 변화를 반영하기 위해, 상기 튜브를 미리 정해진 개수의 프레임으로 분할하여 서브-튜브를생성하는 서브-튜브 생성부(130);상기 서브-튜브로부터 특징을 추출하는 특징 추출부(140); 및각 서브-튜브에 대응되는 복수의 레이어를 포함하여 구성되는 시계열 다층 랜덤 포레스트 분류기에, 상기 특징추출부(140)에서 각각의 서브-튜브로부터 추출된 특징을 각 서브-튜브에 대응되는 레이어의 입력으로 하여 상기시계열 다층 랜덤 포레스트 분류기를 학습하는 학습부(150)를 포함하는 것을 특징으로 하는, 다층 랜덤 포레스트 기반의 시계열 데이터 학습 장치(100)."}
{"patent_id": "10-2020-0081218", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서, 상기 서브-튜브 생성부(130)는,상기 튜브를 5 프레임 크기의 서브-튜브로 분할하여 복수의 서브-튜브를 순차적으로 생성하는 것을 특징으로 하는, 다층 랜덤 포레스트 기반의 시계열 데이터 학습 장치(100)."}
{"patent_id": "10-2020-0081218", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1항에 있어서, 상기 특징 추출부(140)는,상기 서브-튜브 생성부(130)에서 생성된 서브-튜브 중 일부로부터 정적 특징을 추출하고, 나머지 일부로부터 동적 특징을 추출하는 것을 특징으로 하는, 다층 랜덤 포레스트 기반의 시계열 데이터 학습 장치(100)."}
{"patent_id": "10-2020-0081218", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제3항에 있어서, 상기 특징 추출부(140)는,상기 서브-튜브 생성부(130)에서 생성된 n개의 서브-튜브 중 앞의 n-1개의 서브-튜브로부터 정적 특징을 추출하는 정적 특징 추출 모듈(141); 및상기 서브-튜브 생성부(130)에서 생성된 n개의 서브-튜브 중 마지막 1개의 서브-튜브로부터 시공간적 특성을 반영하도록 동적 특징을 추출하는 동적 특징 추출 모듈(142)을 포함하는 것을 특징으로 하는, 다층 랜덤 포레스트기반의 시계열 데이터 학습 장치(100)."}
{"patent_id": "10-2020-0081218", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제4항에 있어서, 상기 정적 특징 추출 모듈(141)은,상기 정적 특징 추출을 위해, 서브-튜브의 각 프레임 영상을 입력으로 받아 인공신경망 기반의 ResNet을 적용하공개특허 10-2022-0003424-3-고, Element-wise mean을 이용해 특징을 추출하는 것을 특징으로 하는, 다층 랜덤 포레스트 기반의 시계열 데이터 학습 장치(100)."}
{"patent_id": "10-2020-0081218", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제4항에 있어서, 상기 동적 특징 추출 모듈(142)은,상기 동적 특징 추출을 위해, 서브-튜브에 대해 HooF(Histogram of optical Flow)를 이용해 특징을 추출하는 것을 특징으로 하는, 다층 랜덤 포레스트 기반의 시계열 데이터 학습 장치(100)."}
{"patent_id": "10-2020-0081218", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제1항에 있어서, 상기 시계열 다층 랜덤 포레스트 분류기는,상기 서브-튜브 생성부(130)에서 생성된 서브-튜브의 개수의 레이어로 구성되는 것을 특징으로 하는, 다층 랜덤포레스트 기반의 시계열 데이터 학습 장치(100)."}
{"patent_id": "10-2020-0081218", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제7항에 있어서, 상기 학습부(150)는,첫 번째 서브-튜브에서 추출된 특징을 첫 번째 레이어에 입력하고, 첫 번째 레이어의 출력과 두 번째 서브-튜브에서 추출된 특징을 결합해 두 번째 레이어에 입력하며, 현재 레이어의 출력과 다음 서브-튜브에서 추출된 특징을 결합해 다음 레이어에 입력하며, 최종 레이어의 출력이 최종 출력값이 되도록, 상기 학습 데이터를 이용해상기 시계열 다층 랜덤 포레스트 분류기를 학습하는 것을 특징으로 하는, 다층 랜덤 포레스트 기반의 시계열 데이터 학습 장치(100)."}
{"patent_id": "10-2020-0081218", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "다층 랜덤 포레스트 기반의 시계열 데이터 학습 방법으로서,(1) 연속된 복수의 프레임의 시계열 영상으로 구성되는 학습 데이터의 각 프레임에서 후보 영역을 탐지하는 단계;(2) 상기 학습 데이터의 연속된 복수의 프레임에서 탐지된 후보 영역을 연결하여 튜브를 생성하는 단계;(3) 시간의 흐름에 따른 변화를 반영하기 위해, 상기 튜브를 미리 정해진 개수의 프레임으로 분할하여 서브-튜브를 생성하는 단계;(4) 상기 서브-튜브로부터 특징을 추출하는 단계; 및(5) 각 서브-튜브에 대응되는 복수의 레이어를 포함하여 구성되는 시계열 다층 랜덤 포레스트 분류기에, 상기단계 (4)에서 각각의 서브-튜브로부터 추출된 특징을 각 서브-튜브에 대응되는 레이어의 입력으로 하여 상기 시계열 다층 랜덤 포레스트 분류기를 학습하는 단계를 포함하는 것을 특징으로 하는, 다층 랜덤 포레스트 기반의시계열 데이터 학습 방법."}
{"patent_id": "10-2020-0081218", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제9항에 있어서, 상기 단계 (3)에서는,상기 튜브를 5 프레임 크기의 서브-튜브로 분할하여 복수의 서브-튜브를 순차적으로 생성하는 것을 특징으로 하는, 다층 랜덤 포레스트 기반의 시계열 데이터 학습 방법.공개특허 10-2022-0003424-4-청구항 11 제9항에 있어서, 상기 단계 (4)에서는,상기 단계 (3)에서 생성된 서브-튜브 중 일부로부터 정적 특징을 추출하고, 나머지 일부로부터 동적 특징을 추출하는 것을 특징으로 하는, 다층 랜덤 포레스트 기반의 시계열 데이터 학습 방법."}
{"patent_id": "10-2020-0081218", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제11항에 있어서, 상기 단계 (4)는,(4-1) 상기 단계 (3)에서 생성된 n개의 서브-튜브 중 앞의 n-1개의 서브-튜브로부터 정적 특징을 추출하는단계; 및(4-2) 상기 단계 (3)에서 생성된 n개의 서브-튜브 중 마지막 1개의 서브-튜브로부터 시공간적 특성을 반영하도록 동적 특징을 추출하는 단계를 포함하는 것을 특징으로 하는, 다층 랜덤 포레스트 기반의 시계열 데이터 학습방법."}
{"patent_id": "10-2020-0081218", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "제12항에 있어서, 상기 단계 (4-1)에서는,상기 정적 특징 추출을 위해, 서브-튜브의 각 프레임 영상을 입력으로 받아 인공신경망 기반의 ResNet을 적용하고, Element-wise mean을 이용해 특징을 추출하는 것을 특징으로 하는, 다층 랜덤 포레스트 기반의 시계열 데이터 학습 방법."}
{"patent_id": "10-2020-0081218", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_14", "content": "제12항에 있어서, 상기 단계 (4-2)에서는,상기 동적 특징 추출을 위해, 서브-튜브에 대해 HooF(Histogram of optical Flow)를 이용해 특징을 추출하는 것을 특징으로 하는, 다층 랜덤 포레스트 기반의 시계열 데이터 학습 방법."}
{"patent_id": "10-2020-0081218", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_15", "content": "제9항에 있어서, 상기 시계열 다층 랜덤 포레스트 분류기는,상기 단계 (3)에서 생성된 서브-튜브의 개수의 레이어로 구성되는 것을 특징으로 하는, 다층 랜덤 포레스트 기반의 시계열 데이터 학습 방법."}
{"patent_id": "10-2020-0081218", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_16", "content": "제15항에 있어서, 상기 단계 (5)에서는,첫 번째 서브-튜브에서 추출된 특징을 첫 번째 레이어에 입력하고, 첫 번째 레이어의 출력과 두 번째 서브-튜브에서 추출된 특징을 결합해 두 번째 레이어에 입력하며, 현재 레이어의 출력과 다음 서브-튜브에서 추출된 특징을 결합해 다음 레이어에 입력하며, 최종 레이어의 출력이 최종 출력값이 되도록, 상기 학습 데이터를 이용해상기 시계열 다층 랜덤 포레스트 분류기를 학습하는 것을 특징으로 하는, 다층 랜덤 포레스트 기반의 시계열 데이터 학습 방법."}
{"patent_id": "10-2020-0081218", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 다층 랜덤 포레스트 기반의 시계열 데이터 학습 장치에 관한 것으로서, 보다 구체적으로는 다층 랜덤 포레스트 기반의 시계열 데이터 학습 장치로서, 연속된 복수의 프레임의 시계열 영상으로 구성되는 학습 데이터 의 각 프레임에서 후보 영역을 탐지하는 후보 검출부; 상기 학습 데이터의 연속된 복수의 프레임에서 탐지된 후 (뒷면에 계속)"}
{"patent_id": "10-2020-0081218", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 시계열 데이터 학습 장치 및 방법에 관한 것으로서, 보다 구체적으로는 다층 랜덤 포레스트 기반의 시계열 데이터 학습 장치 및 방법에 관한 것이다."}
{"patent_id": "10-2020-0081218", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "최근 인공신경망 분야가 급속도로 발전하면서 높은 정확도뿐만 아니라, 다양한 정적/동적 데이터에 대해 학습 가능한 모델 개발에 관한 관심도 증가하고 있다. 초기 인공신경망 연구는 정적인 데이터에 대해 분류 정확도를 높이거나 수치적 회귀 모델을 활용한 연구가 대부분이었다면, 현재는 동적인 데이터의 연속적 변화나 시간의 흐 름에 따른 데이터의 변화 특성을 분석하는 방법이 소개되고 있다. 특히, Recurrent Neural Network (RNN)로 대변되는 시계열 특성 분석 신경망 분야는, 음성인식이나 자연어처리, 동영상 분석과 같이 시간적 변화의 특성을 반영할 수 있는 연구 분야에서 뛰어난 성능을 보이며 주목받고 있다. RNN 분야의 잘 알려진 방법론인 LSTM(Long Short-Term Memory)은 기존 RNN의 단점인 기울기 소멸 (Vanishing gradient problem)을 극복하기 위해 cell-state 개념을 추가해 높은 성능을 달성했다. 각 cell 내부에 기억의 흐름을 제어하는 forget gate와 input gate를 두어 state가 반복되더라도 기울기 변화가 비교적 잘 전달되도록 구성했다. 하지만 LSTM은 cell 구조가 복잡해짐에 따라 연산에 많은 시간이 소요되는 단점이 발생하고, 이를 극복하기 위 해 GRU(Gated Recurrent Unit)가 제안되었다. GRU는 LSTM의 cell-state 구조에서 내부 구조를 간소화하고 state 업데이트에 소요되는 연산을 줄여 보다 빠르게 동작할 수 있도록 설계되었다. 이같이, 복잡한 RNN을 효율적으로 동작시키는 다양한 방법이 제안되었지만, RNN 기반의 시계열 데이터 학습 기 법은 여전히 일반적인 인공신경망 모델에 비해 수많은 학습 파라미터가 필요하며 방대한 연산이 수반되기 때문 에 저사양의 실시간 시스템에 적용하기에 어려움이 있다. 한편, 본 발명과 관련된 선행기술로서, 공개특허 제10-2019-0114694호(발명의 명칭: 인공지능을 이용한 시계열 데이터 학습 및 분석 방법, 공개일자: 2019년 10월 10일) 등이 개시된 바 있다."}
{"patent_id": "10-2020-0081218", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은 기존에 제안된 방법들의 상기와 같은 문제점들을 해결하기 위해 제안된 것으로서, 연속된 복수의 프 레임의 시계열 영상으로 구성되는 학습 데이터에서 탐지된 후보 영역을 연결하여 튜브를 생성하고, 튜브를 분할 한 서브-튜브로부터 특징을 추출하여, 복수의 레이어를 포함해 구성되는 시계열 다층 랜덤 포레스트 분류기에 각각의 서브-튜브로부터 추출된 특징을 각 레이어의 입력으로 하여 학습을 수행함으로써, 유지해야 할 학습 파 라미터가 적고 단순한 의사결정 과정으로 인해 빠른 연산 속도를 제공하며, RNN 기반의 모델들보다 훨씬 유연하 게 동작할 수 있는, 다층 랜덤 포레스트 기반의 시계열 데이터 학습 장치 및 방법을 제공하는 것을 그 목적으로 한다."}
{"patent_id": "10-2020-0081218", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "상기한 목적을 달성하기 위한 본 발명의 특징에 따른 다층 랜덤 포레스트 기반의 시계열 데이터 학습 장치는, 다층 랜덤 포레스트 기반의 시계열 데이터 학습 장치로서, 연속된 복수의 프레임의 시계열 영상으로 구성되는 학습 데이터의 각 프레임에서 후보 영역을 탐지하는 후보 검 출부; 상기 학습 데이터의 연속된 복수의 프레임에서 탐지된 후보 영역을 연결하여 튜브를 생성하는 튜브 생성부; 시간의 흐름에 따른 변화를 반영하기 위해, 상기 튜브를 미리 정해진 개수의 프레임으로 분할하여 서브-튜브를 생성하는 서브-튜브 생성부; 상기 서브-튜브로부터 특징을 추출하는 특징 추출부; 및 각 서브-튜브에 대응되는 복수의 레이어를 포함하여 구성되는 시계열 다층 랜덤 포레스트 분류기에, 상기 특징 추출부에서 각각의 서브-튜브로부터 추출된 특징을 각 서브-튜브에 대응되는 레이어의 입력으로 하여 상기 시계 열 다층 랜덤 포레스트 분류기를 학습하는 학습부를 포함하는 것을 그 구성상의 특징으로 한다. 바람직하게는, 상기 서브-튜브 생성부는, 상기 튜브를 5 프레임 크기의 서브-튜브로 분할하여 복수의 서브-튜브를 순차적으로 생성할 수 있다. 바람직하게는, 상기 특징 추출부는, 상기 서브-튜브 생성부에서 생성된 서브-튜브 중 일부로부터 정적 특징을 추출하고, 나머지 일부로부터 동적 특 징을 추출할 수 있다. 더욱 바람직하게는, 상기 특징 추출부는, 상기 서브-튜브 생성부에서 생성된 n개의 서브-튜브 중 앞의 n-1개의 서브-튜브로부터 정적 특징을 추출하는 정 적 특징 추출 모듈; 및 상기 서브-튜브 생성부에서 생성된 n개의 서브-튜브 중 마지막 1개의 서브-튜브로부터 시공간적 특성을 반영하 도록 동적 특징을 추출하는 동적 특징 추출 모듈을 포함할 수 있다. 더더욱 바람직하게는, 상기 정적 특징 추출 모듈은, 상기 정적 특징 추출을 위해, 서브-튜브의 각 프레임 영상을 입력으로 받아 인공신경망 기반의 ResNet을 적용하 고, Element-wise mean을 이용해 특징을 추출할 수 있다. 더더욱 바람직하게는, 상기 동적 특징 추출 모듈은, 상기 동적 특징 추출을 위해, 서브-튜브에 대해 HooF(Histogram of optical Flow)를 이용해 특징을 추출할 수 있다. 바람직하게는, 상기 시계열 다층 랜덤 포레스트 분류기는, 상기 서브-튜브 생성부에서 생성된 서브-튜브의 개수의 레이어로 구성될 수 있다. 더욱 바람직하게는, 상기 학습부는, 첫 번째 서브-튜브에서 추출된 특징을 첫 번째 레이어에 입력하고, 첫 번째 레이어의 출력과 두 번째 서브-튜브 에서 추출된 특징을 결합해 두 번째 레이어에 입력하며, 현재 레이어의 출력과 다음 서브-튜브에서 추출된 특징 을 결합해 다음 레이어에 입력하며, 최종 레이어의 출력이 최종 출력값이 되도록, 상기 학습 데이터를 이용해 상기 시계열 다층 랜덤 포레스트 분류기를 학습할 수 있다. 또한, 상기한 목적을 달성하기 위한 본 발명의 특징에 따른 다층 랜덤 포레스트 기반의 시계열 데이터 학습 방 법은,다층 랜덤 포레스트 기반의 시계열 데이터 학습 방법으로서, 연속된 복수의 프레임의 시계열 영상으로 구성되는 학습 데이터의 각 프레임에서 후보 영역을 탐지하는 단 계; 상기 학습 데이터의 연속된 복수의 프레임에서 탐지된 후보 영역을 연결하여 튜브를 생성하는 단계; 시간의 흐름에 따른 변화를 반영하기 위해, 상기 튜브를 미리 정해진 개수의 프레임으로 분할하여 서브-튜 브를 생성하는 단계; 상기 서브-튜브로부터 특징을 추출하는 단계; 및 각 서브-튜브에 대응되는 복수의 레이어를 포함하여 구성되는 시계열 다층 랜덤 포레스트 분류기에, 상기 단계 에서 각각의 서브-튜브로부터 추출된 특징을 각 서브-튜브에 대응되는 레이어의 입력으로 하여 상기 시 계열 다층 랜덤 포레스트 분류기를 학습하는 단계를 포함하는 것을 그 구성상의 특징으로 한다. 바람직하게는, 상기 단계 에서는, 상기 튜브를 5 프레임 크기의 서브-튜브로 분할하여 복수의 서브-튜브를 순차적으로 생성할 수 있다. 바람직하게는, 상기 단계 에서는, 상기 단계 에서 생성된 서브-튜브 중 일부로부터 정적 특징을 추출하고, 나머지 일부로부터 동적 특징을 추 출할 수 있다. 더욱 바람직하게는, 상기 단계 는, (4-1) 상기 단계 에서 생성된 n개의 서브-튜브 중 앞의 n-1개의 서브-튜브로부터 정적 특징을 추출하는 단계; 및 (4-2) 상기 단계 에서 생성된 n개의 서브-튜브 중 마지막 1개의 서브-튜브로부터 시공간적 특성을 반영하도 록 동적 특징을 추출하는 단계를 포함할 수 있다. 더더욱 바람직하게는, 상기 단계 (4-1)에서는, 상기 정적 특징 추출을 위해, 서브-튜브의 각 프레임 영상을 입력으로 받아 인공신경망 기반의 ResNet을 적용하 고, Element-wise mean을 이용해 특징을 추출할 수 있다. 더더욱 바람직하게는, 상기 단계 (4-2)에서는, 상기 동적 특징 추출을 위해, 서브-튜브에 대해 HooF(Histogram of optical Flow)를 이용해 특징을 추출할 수 있다. 바람직하게는, 상기 시계열 다층 랜덤 포레스트 분류기는, 상기 단계 에서 생성된 서브-튜브의 개수의 레이어로 구성될 수 있다. 더욱 바람직하게는, 상기 단계 에서는, 첫 번째 서브-튜브에서 추출된 특징을 첫 번째 레이어에 입력하고, 첫 번째 레이어의 출력과 두 번째 서브-튜브 에서 추출된 특징을 결합해 두 번째 레이어에 입력하며, 현재 레이어의 출력과 다음 서브-튜브에서 추출된 특징 을 결합해 다음 레이어에 입력하며, 최종 레이어의 출력이 최종 출력값이 되도록, 상기 학습 데이터를 이용해상기 시계열 다층 랜덤 포레스트 분류기를 학습할 수 있다."}
{"patent_id": "10-2020-0081218", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명에서 제안하고 있는 다층 랜덤 포레스트 기반의 시계열 데이터 학습 장치 및 방법에 따르면, 연속된 복 수의 프레임의 시계열 영상으로 구성되는 학습 데이터에서 탐지된 후보 영역을 연결하여 튜브를 생성하고, 튜브 를 분할한 서브-튜브로부터 특징을 추출하여, 복수의 레이어를 포함해 구성되는 시계열 다층 랜덤 포레스트 분 류기에 각각의 서브-튜브로부터 추출된 특징을 각 레이어의 입력으로 하여 학습을 수행함으로써, 유지해야 할 학습 파라미터가 적고 단순한 의사결정 과정으로 인해 빠른 연산 속도를 제공하며, RNN 기반의 모델들보다 훨씬 유연하게 동작할 수 있다."}
{"patent_id": "10-2020-0081218", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하, 첨부된 도면을 참조하여 본 발명이 속하는 기술분야에서 통상의 지식을 가진 자가 본 발명을 용이하게 실 시할 수 있도록 바람직한 실시예를 상세히 설명한다. 다만, 본 발명의 바람직한 실시예를 상세하게 설명함에 있어, 관련된 공지 기능 또는 구성에 대한 구체적인 설명이 본 발명의 요지를 불필요하게 흐릴 수 있다고 판단 되는 경우에는 그 상세한 설명을 생략한다. 또한, 유사한 기능 및 작용을 하는 부분에 대해서는 도면 전체에 걸쳐 동일한 부호를 사용한다. 덧붙여, 명세서 전체에서, 어떤 부분이 다른 부분과 ‘연결’ 되어 있다고 할 때, 이는 ‘직접적으로 연결’ 되 어 있는 경우뿐만 아니라, 그 중간에 다른 소자를 사이에 두고 ‘간접적으로 연결’ 되어 있는 경우도 포함한다. 또한, 어떤 구성요소를 ‘포함’ 한다는 것은, 특별히 반대되는 기재가 없는 한 다른 구성요소를 제 외하는 것이 아니라 다른 구성요소를 더 포함할 수 있다는 것을 의미한다.도 1은 본 발명의 일실시예에 따른 다층 랜덤 포레스트 기반의 시계열 데이터 학습 장치의 구성을 도시한 도면이다. 도 1에 도시된 바와 같이, 본 발명의 일실시예에 따른 다층 랜덤 포레스트 기반의 시계열 데이터 학 습 장치는, 연속된 복수의 프레임의 시계열 영상으로 구성되는 학습 데이터의 각 프레임에서 후보 영역을 탐지하는 후보 검출부, 학습 데이터의 연속된 복수의 프레임에서 탐지된 후보 영역을 연결하여 튜브를 생 성하는 튜브 생성부, 시간의 흐름에 따른 변화를 반영하기 위해, 튜브를 미리 정해진 개수의 프레임으로 분할하여 서브-튜브를 생성하는 서브-튜브 생성부, 서브-튜브로부터 특징을 추출하는 특징 추출부, 및 각 서브-튜브에 대응되는 복수의 레이어를 포함하여 구성되는 시계열 다층 랜덤 포레스트 분류기에, 특징 추 출부에서 각각의 서브-튜브로부터 추출된 특징을 각 서브-튜브에 대응되는 레이어의 입력으로 하여 시계열 다층 랜덤 포레스트 분류기를 학습하는 학습부를 포함하여 구성될 수 있고, 특징 추출부는, 서브-튜 브 생성부에서 생성된 n개의 서브-튜브 중 앞의 n-1개의 서브-튜브로부터 정적 특징을 추출하는 정적 특징 추출 모듈, 및 서브-튜브 생성부에서 생성된 n개의 서브-튜브 중 마지막 1개의 서브-튜브로부터 시공 간적 특성을 반영하도록 동적 특징을 추출하는 동적 특징 추출 모듈을 포함하여 구성될 수 있다. 도 2는 본 발명의 일실시예에 따른 다층 랜덤 포레스트 기반의 시계열 데이터 학습 방법의 흐름을 도시한 도면 이다. 도 2에 도시된 바와 같이, 본 발명의 일실시예에 따른 다층 랜덤 포레스트 기반의 시계열 데이터 학습 방법은, 학습 데이터의 각 프레임에서 후보 영역을 탐지하는 단계(S110), 연속된 복수의 프레임에서 탐지된 후 보 영역을 연결하여 튜브를 생성하는 단계(S120), 튜브를 미리 정해진 개수의 프레임으로 분할하여 서브-튜브를 생성하는 단계(S130), 서브-튜브로부터 특징을 추출하는 단계(S140) 및 시계열 다층 랜덤 포레스트 분류기를 학 습하는 단계(S150)를 포함하여 구성될 수 있다. 본 발명의 일실시예에 따른 다층 랜덤 포레스트 기반의 시계열 데이터 학습 장치 및 방법에서는, 기존의 시계열 데이터를 학습하는 대표적인 방법인 RNN이 가진 방대한 수의 파라미터 및 연산을 필요로 하는 한계점을 극복하기 위해, 효율적인 방법으로 시계열 데이터를 학습할 수 있는 시계열 다층 랜덤 포레스트(Time series Multilayered Random Forest, TMRF)를 제안한다. TMRF는 이진 결정 트리 (Binary Decision Tree, BDT)를 연속 되는 여러 계층의 시간적 지식 변형(temporal knowledge transforming) 모듈로 사용하는 앙상블 학습 기법이다. BDT는 유지해야 할 학습 파라미터가 적고 단순한 의사결정 과정으로 인해 빠른 연산 속도를 제공하기 때문에 RNN 기반의 모델들보다 훨씬 유연한 동작이 가능하다. 즉, 본 발명에서는, 역전파(back-propagation)를 사용하 는 복잡한 인공신경망 대신, 단순한 구조의 BDT를 가지는 랜덤 포레스트(RF) 앙상블을 기반으로 하는 계층적 레 이어 구조를 가진 TMRF을 제안하고, TMRF를 이용해 효율적으로 시계열 데이터를 학습하는 기법을 제안한다. 도 3은 본 발명의 일실시예에 따른 다층 랜덤 포레스트 기반의 시계열 데이터 학습 장치 및 방법에서, 튜 브 및 서브-튜브를 생성하고 특징을 추출하는 구체적인 과정을 설명하기 위해 도시한 도면이고, 도 4는 본 발명 의 일실시예에 따른 다층 랜덤 포레스트 기반의 시계열 데이터 학습 장치 및 방법에서 제안하는, 시계열 다층 랜덤 포레스트 분류기를 설명하기 위해 도시한 도면이다. 도 4에 도시된 바와 같이, 본 발명에서 제안하 는 TMRF는, 여러 개의 랜덤 포레스트로 구성된 다층의 Main-stream 레이어와 각각의 Sub-stream 레이어를 배치 한 형태를 가질 수 있다. 이때, RF 각 노드들의 학습 방법에 따라 RF 혹은 Conditional RF(CRF)로 분류될 수 있다. RF는 데이터의 여러 특징값을 분석해 최적의 경우를 고려하기 때문에 학습이 느리다는 단점이 있지만 그 만큼 좋은 성능을 보일 수 있다. CRF는 랜덤하게 선택된 특징값만을 고려하기 때문에 학습이 빠르지만 항상 우 세한 성능을 보장하지는 않는다. 하지만 특징의 분석법을 다르게 함으로써 모델이 가지는 다양성이 높아지는 효과를 얻을 수 있다. 따라서 본 발명에서는, 다양성을 높이기 위해 RF 및 CRF를 조합하여 레이어를 구성할 수 있다. 이하에서는, 도 2 내지 도 4를 참조하여, 본 발명의 일실시예에 따른 다층 랜덤 포레스트 기반의 시계열 데이터 학습 방법의 각 단계에 대해 상세히 설명하도록 한다. 본 발명은 다층 랜덤 포레스트 기반의 시계열 데이터 학습 방법에 관한 것으로서, 본 발명의 특징에 따른 다층 랜덤 포레스트 기반의 시계열 데이터 학습 방법은, 메모리 및 프로세서를 포함한 하드웨어에서 기록되는 소프트 웨어로 구성될 수 있다. 예를 들어, 다층 랜덤 포레스트 기반의 시계열 데이터 학습 방법은, 개인용 컴퓨터, 노트북 컴퓨터, 서버 컴퓨터, PDA, 스마트폰, 태블릿 PC 등에 저장 및 구현될 수 있다. 이하에서는 설명의 편 의를 위해, 각 단계를 수행하는 주체는 생략될 수 있다. 단계 S110에서는, 후보 검출부가 연속된 복수의 프레임의 시계열 영상으로 구성되는 학습 데이터의 각 프 레임에서 후보 영역을 탐지할 수 있다. 즉, 단계 S110에서는, 시공간 정보를 포함하는 동영상 등 각종 시계열 영상을 학습 데이터로 사용할 수 있으며, 예를 들어 산불 조기 감지를 위한 산불 영상, 연기 영상 등에 적용될 수 있다. 단계 S110에서는, 학습 데이터에 대해 짧은 시간 내에 최대한 많은 후보 영역을 검출할 수 있어야 하므로, 영상 으로부터 후보 영역을 신속하게 검출할 수 있는 CNN(Convolutional Neural Network) 기반의 검출기를 이용해 후 보 영역을 검출할 수 있다. 예를 들어, 산불 조기 감지에 적용되는 경우, 다양한 연기의 형태를 반영하기 위해 서는 영상의 스케일 변화를 학습하는 딥러닝 모델의 적용이 요구되므로, 우수한 성능을 보이면서도 빠른 속도로 동작하는 YOLOv3를 검출기로 이용해 최적의 후보 영역을 검출할 수 있다. 단계 S120에서는, 튜브 생성부가 학습 데이터의 연속된 복수의 프레임에서 탐지된 후보 영역을 연결하여 튜브를 생성할 수 있다. 단계 S120에서는, 학습 데이터에서 생성 가능한 모든 튜브를 추출할 수 있다. 예를 들어, 산불 조기 감지에 적용되는 경우, 단계 S110에서 검출된 후보 연기 영역의 시계열 데이터를 반영하 기 위해 연속된 프레임으로부터 스모크-튜브(Smoke-tube)를 생성할 수 있다. 스모크-튜브는 검출된 후보 영역 을 기준으로 일정한 수 만큼의 프레임에 대해 잘라낸 패치 영역을 이어서 구성할 수 있다. 단계 S130에서는, 서브-튜브 생성부가 시간의 흐름에 따른 변화를 반영하기 위해, 튜브를 미리 정해진 개 수의 프레임으로 분할하여 서브-튜브를 생성할 수 있다. 보다 구체적으로, 단계 S130에서는, 튜브를 5 프레임 크기의 서브-튜브로 분할하여 복수의 서브-튜브를 순차적으로 생성할 수 있다. 즉, 도 3에 도시된 바와 같이, 단계 S130에서는 튜브로부터 시간의 흐름에 따른 변화를 반영하기 위해, 단계 S120에서 생성된 스모크-튜브를 t0부터 t4까지 더 작은 단위의 5 프레임의 크기를 가지는 5개의 서브-튜브로 분할할 수 있다. 단계 S140에서는, 특징 추출부가 서브-튜브로부터 특징을 추출할 수 있다. 보다 구체적으로, 단계 S140에 서는, 단계 S130에서 생성된 서브-튜브 중 일부로부터 정적 특징을 추출하고, 나머지 일부로부터 동적 특징을 추출할 수 있다. 도 5는 본 발명의 일실시예에 따른 다층 랜덤 포레스트 기반의 시계열 데이터 학습 방법의 단계 S140의 세부적 인 흐름을 도시한 도면이다. 도 5에 도시된 바와 같이, 본 발명의 일실시예에 따른 다층 랜덤 포레스트 기반의 시계열 데이터 학습 방법의 단계 S140은, n개의 서브-튜브 중 앞의 n-1개의 서브-튜브로부터 정적 특징을 추출 하는 단계(S141) 및 n개의 서브-튜브 중 마지막 1개의 서브-튜브로부터 동적 특징을 추출하는 단계(S142)를 포 함하여 구현될 수 있다. 단계 S141에서는, 정적 특징 추출 모듈이, 단계 S130에서 생성된 n개의 서브-튜브 중 앞의 n-1개의 서브- 튜브로부터 정적 특징을 추출할 수 있다. 보다 구체적으로, 단계 S141에서는, 정적 특징 추출을 위해, 서브-튜 브의 각 프레임 영상을 입력으로 받아 인공신경망 기반의 ResNet을 적용하고, Element-wise mean을 이용해 1×N 차원의 특징을 추출할 수 있다. 예를 들어, 도 3에 도시된 바와 같이, 총 5개의 서브-튜브 중에서 일부인 앞의 4개의 서브-튜브(t0~t3)는 고품질의 영상 특징을 추출하기 위해 ResNet50으로부터 CNN 특징을 추출할 수 있다.변환된 특징들을 정규화하기 위해 CNN 특징은 각 Tensor 값들의 평균을 취할 수 있다. 도 6은 본 발명의 일실시예에 따른 다층 랜덤 포레스트 기반의 시계열 데이터 학습 장치 및 방법을 산불 조기 감지에 적용하기 위해 정적 특징을 추출하는 과정을 도시한 도면이다. 도 6에 도시된 바와 같이, 본 발명 의 일실시예에 따른 다층 랜덤 포레스트 기반의 시계열 데이터 학습 장치 및 방법을 산불 조기 감지에 적 용하는 경우, 단계 S141에서는, 서브-튜브의 각 영상을 입력으로 받아 ResNet50을 적용할 수 있다. ResNet50은 마지막에 2개의 완전 연결(fully connected, FC) 레이어로 구성되며, 2개의 FC 레이어 별로 0.5의 드롭아웃 (dropout 0.5)을 적용하여 차원의 수를 줄일 수 있다. 입력 영상의 크기가 216×216×3일 때 출력 벡터의 차원 은 1024이 된다. 단계 S142에서는, 동적 특징 추출 모듈이, 단계 S130에서 생성된 n개의 서브-튜브 중 마지막 1개의 서브- 튜브로부터 시공간적 특성을 반영하도록 동적 특징을 추출할 수 있다. 보다 구체적으로, 단계 S142에서는, 동 적 특징 추출을 위해, 서브-튜브에 대해 HooF(Histogram of optical Flow)를 이용해 특징을 추출할 수 있다. 예를 들어, 도 3에 도시된 바와 같이, 총 5개의 서브-튜브 중에서 마지막 1개의 서브-튜브(t4)는 HooF 특징을 추출할 수 있으며, 변환된 특징들을 정규화하기 위해 동적 특징은 객체의 변화를 효과적으로 반영하기 위해 bag-of-word (BoW)를 이용한 code word 형태로 변형될 수 있다. 도 7은 본 발명의 일실시예에 따른 다층 랜덤 포레스트 기반의 시계열 데이터 학습 장치 및 방법을 산불 조기 감지에 적용하기 위해 동적 특징을 추출하는 과정을 도시한 도면이다. 도 7에 도시된 바와 같이, 본 발명 의 일실시예에 따른 다층 랜덤 포레스트 기반의 시계열 데이터 학습 장치 및 방법을 산불 조기 감지에 적 용하는 경우, 단계 S142에서는, 프레임의 시간적 흐름에 따른 객체의 변화량을 각도(Angle)와 크기(Magnitude) 값으로 수치화할 수 있다. 즉, 검출된 객체의 각도와 크기 변화를 결합한 후 히스토그램으로 누적시켜 특징값 을 구성할 수 있다. 단계 S150에서는, 학습부가 각 서브-튜브에 대응되는 복수의 레이어를 포함하여 구성되는 시계열 다층 랜 덤 포레스트 분류기에, 단계 S140에서 각각의 서브-튜브로부터 추출된 특징을 각 서브-튜브에 대응되는 레이어 의 입력으로 하여 시계열 다층 랜덤 포레스트 분류기를 학습할 수 있다. 시계열 다층 랜덤 포레스트 분류기는, 단계 S130에서 생성된 서브-튜브의 개수의 레이어로 구성될 수 있는데, 단계 S150에서는, 첫 번째 서브-튜브에서 추출된 특징을 첫 번째 레이어에 입력하고, 첫 번째 레이어의 출력과 두 번째 서브-튜브에서 추출된 특징을 결합해 두 번째 레이어에 입력하며, 현재 레이어의 출력과 다음 서브-튜 브에서 추출된 특징을 결합해 다음 레이어에 입력하며, 최종 레이어의 출력이 최종 출력값이 되도록, 학습 데이 터를 이용해 시계열 다층 랜덤 포레스트 분류기를 학습할 수 있다. 즉, 도 4에 도시된 바와 같이, 첫 번째 서브-튜브(t0)에서 추출된 특징을 첫 번째 레이어(L1)에 입력하고, 두 번 째 서브 튜브(t1)에서 추출된 특징을 랜덤 포레스트로 분석한 결과를 첫 번째 레이어(L1)의 출력과 결합해 새로 운 특징을 생성하여, 두 번째 레이어(L2)에 입력하게 된다. 같은 방식으로, n번째 레이어(Ln)의 출력과 다음 서 브-튜브(tn)에서 추출된 특징을 결합한 새로운 특징을 다음 레이어(Ln+1)에 입력해서, 최종 레이어까지 연쇄적으 로 학습하게 된다. 도 4에 도시된 바와 같이, TMRF는 이전 레이어의 출력과 서브-튜브의 특징을 결합해 다음 레이어를 위한 새로운 특징을 생성하기 위해 연쇄층(cancatenate layer)을 포함하여 구성될 수 있다. 이와 같 이, 레이어가 반복되며 시간적 변화를 반영할 수 있으며 정확도를 높일 수 있다.실험 본 발명의 일실시예에 따른 다층 랜덤 포레스트 기반의 시계열 데이터 학습 장치 및 방법을 이용해 학습을 수행하고 다른 RNN 기법들과 비교하기 위해, 직접 산불 연기 데이터세트를 구축하고 분석하였다. 데이터세트는 다음 조건을 고려해 구성되었다. ⅰ) Youtube 등의 웹으로부터 산불 연기 및 유사 객체를 다수 포함, ⅱ) 산불 연기 유사 객체는 구름, 산안개 등을 포함, ⅲ) 동영상의 형식은 avi 또는 mp4, ⅳ) 정지 영상의 경우 jpg로 구 성되었으며, 이는 레이블링에 이용, ⅴ) 동영상은 25fps 이상, 영상으로 변환할 때는 10fps 이상, ⅵ) 영상의 해상도는 640×480 이상의 해상도를 가짐. 도 8은 본 발명의 일실시예에 따른 다층 랜덤 포레스트 기반의 시계열 데이터 학습 장치 및 방법의 성능 비교를 위해 수집한 데이터세트의 예를 도시한 도면이고, 도 9는 본 발명의 일실시예에 따른 다층 랜덤 포레스 트 기반의 시계열 데이터 학습 장치 및 방법의 성능 비교를 위한 학습 데이터의 통계를 나타낸 도면이다. 총 데이터는 18개의 동영상으로 구성되며 산불 동영상 9개와 비산불 동영상 9개로 구성하였다. 비산불 데이터 세트는 공장 굴뚝 연기나 구름, 연무와 같이 연기와 비슷한 형태를 갖는 객체가 포함된다. 실험은 Intel i7- 7700 및 NVIDIA GeForce GTX 1080 Ti에서 수행되었다. 비교실험을 위해 다음과 같이 7개의 방법으로 데이터세트를 학습하고 테스트를 수행하였다. ① One LSTM: 한 개의 레이어로 구성된 LSTM, ② deep LSTMs: 입력 영상별로 3개의 레이어로 구성된 LSTM, ③ one Bi-LSTM: 한 개의 레이어를 가지며 영상별 레이어는 양방향(bidirectional)으로 연결된 LSTM, ④ deep Bi-LSTM: 3개의 계층 으로 연결된 양방향(bidirectional) LSTM, ⑤ One GRU: 한 개의 레이어로 구성된 GRU, ⑥ deep GRU: 3개의 레 이어로 구성된 GRU, ⑦ 본 발명의 일실시예에 따른 다층 랜덤 포레스트 기반의 시계열 데이터 학습 장치 및 방법에 따른 TMRF. 도 10은 본 발명의 일실시예에 따른 다층 랜덤 포레스트 기반의 시계열 데이터 학습 장치 및 방법의 성능 비교를 위한 deep LSTM의 구성을 도시한 도면이다. 즉, 실험을 위해 사용된 ② deep LSTMs의 기본 구조는 도 10과 같다. ResNet50으로 동일한 스모크-튜브로부터 특징을 추출하고 각 LSTM 레이어에 입력하여 출력된 결과 값을 결합하는 방법을 사용하였다. 도 11은 본 발명의 일실시예에 따른 다층 랜덤 포레스트 기반의 시계열 데이터 학습 장치 및 방법과 다른 RNN 방법들과의 성능 비교 결과를 나타낸 도면이다. 도 11에 도시된 바와 같이, 본 발명의 일실시예에 따른 다 층 랜덤 포레스트 기반의 시계열 데이터 학습 장치 및 방법에 따른 TMRF는, 인공신경망 기반 방법들보다 정밀도(precision)에서 0.41~3.85%, 재현율(recall)에서 4.49~9.92%, F1-score에서 3.73~3.96% 낮은 수치를 보 이긴 했으나, 검출된 후보 영역에 대해 비교적 높은 수준의 정확도를 보였으며, 연기와 비슷한 후보 영역들도 정확하게 비산불로 분류하는 것을 확인할 수 있었다. 또한, 처리 속도에서는 CPU만을 사용하더라도 다른 RNN 방법들보다 월등히 빠른 결과를 보였다. 전술한 바와 같이, 본 발명에서 제안하고 있는 다층 랜덤 포레스트 기반의 시계열 데이터 학습 장치 및 방 법에 따르면, 연속된 복수의 프레임의 시계열 영상으로 구성되는 학습 데이터에서 탐지된 후보 영역을 연결하여 튜브를 생성하고, 튜브를 분할한 서브-튜브로부터 특징을 추출하여, 복수의 레이어를 포함해 구성되는 시계열 다층 랜덤 포레스트 분류기에 각각의 서브-튜브로부터 추출된 특징을 각 레이어의 입력으로 하여 학습을 수행함 으로써, 유지해야 할 학습 파라미터가 적고 단순한 의사결정 과정으로 인해 빠른 연산 속도를 제공하며, RNN 기 반의 모델들보다 훨씬 유연하게 동작할 수 있다."}
{"patent_id": "10-2020-0081218", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "이상 설명한 본 발명은 본 발명이 속한 기술분야에서 통상의 지식을 가진 자에 의하여 다양한 변형이나 응용이 가능하며, 본 발명에 따른 기술적 사상의 범위는 아래의 특허청구범위에 의하여 정해져야 할 것이다."}
{"patent_id": "10-2020-0081218", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 일실시예에 따른 다층 랜덤 포레스트 기반의 시계열 데이터 학습 장치의 구성을 도시한 도면. 도 2는 본 발명의 일실시예에 따른 다층 랜덤 포레스트 기반의 시계열 데이터 학습 방법의 흐름을 도시한 도면. 도 3은 본 발명의 일실시예에 따른 다층 랜덤 포레스트 기반의 시계열 데이터 학습 장치 및 방법에서, 튜브 및 서브-튜브를 생성하고 특징을 추출하는 구체적인 과정을 설명하기 위해 도시한 도면. 도 4는 본 발명의 일실시예에 따른 다층 랜덤 포레스트 기반의 시계열 데이터 학습 장치 및 방법에서 제안하는, 시계열 다층 랜덤 포레스트 분류기를 설명하기 위해 도시한 도면. 도 5는 본 발명의 일실시예에 따른 다층 랜덤 포레스트 기반의 시계열 데이터 학습 방법의 단계 S140의 세부적 인 흐름을 도시한 도면. 도 6은 본 발명의 일실시예에 따른 다층 랜덤 포레스트 기반의 시계열 데이터 학습 장치 및 방법을 산불 조기 감지에 적용하기 위해 정적 특징을 추출하는 과정을 도시한 도면. 도 7은 본 발명의 일실시예에 따른 다층 랜덤 포레스트 기반의 시계열 데이터 학습 장치 및 방법을 산불 조기 감지에 적용하기 위해 동적 특징을 추출하는 과정을 도시한 도면. 도 8은 본 발명의 일실시예에 따른 다층 랜덤 포레스트 기반의 시계열 데이터 학습 장치 및 방법의 성능 비교를 위해 수집한 데이터세트의 예를 도시한 도면. 도 9는 본 발명의 일실시예에 따른 다층 랜덤 포레스트 기반의 시계열 데이터 학습 장치 및 방법의 성능 비교를 위한 학습 데이터의 통계를 나타낸 도면. 도 10은 본 발명의 일실시예에 따른 다층 랜덤 포레스트 기반의 시계열 데이터 학습 장치 및 방법의 성능 비교 를 위한 deep LSTM의 구성을 도시한 도면. 도 11은 본 발명의 일실시예에 따른 다층 랜덤 포레스트 기반의 시계열 데이터 학습 장치 및 방법과 다른 RNN 방법들과의 성능 비교 결과를 나타낸 도면."}
