{"patent_id": "10-2022-0105056", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2024-0027204", "출원번호": "10-2022-0105056", "발명의 명칭": "간 초음파 이미지를 이용하여 간 병변을 분류하는 인공지능 모델, 그 모델의 구축 방법, 및", "출원인": "가천대학교 산학협력단", "발명자": "김광기"}}
{"patent_id": "10-2022-0105056", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "복수의 간 초음파 이미지 중 소정의 제외기준에 해당하는 이미지를 배제하는 준비단계(S100);컴퓨터에 의해 실행되며, 상기 컴퓨터가,준비된 복수의 간 초음파 이미지를 원본 이미지로 입력받은 단계(S120);상기 원본 이미지를 간 병변 별로 복수의 폴드에 교차 할당하는 단계(S140);트레이닝을 위해 각각의 상기 원본 이미지를 영상처리하는 단계(S160);영상처리된 이미지를 이용하여 인공지능 모델을 트레이닝 하는 단계(S180);를 포함하는 것을 특징으로 하는 간초음파 이미지를 이용하여 간 병변을 분류하는 인공지능 모델의 구축방법."}
{"patent_id": "10-2022-0105056", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제 1 항에 있어서, 상기 제외기준은 상기 간 초음파 이미지에서 상기 간 병변의 최대 크기가 10cm 이상이거나 또는 최소 크기가1cm 이하인 것을 특징으로 하는 간 초음파 이미지를 이용하여 간 병변을 분류하는 인공지능 모델의 구축방법."}
{"patent_id": "10-2022-0105056", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제 1 항에 있어서, 상기 간 병변은 간세포 암종(Hepatocellular Carcinoma, HCC), 혈관종(Hemangioma), 낭종(Cyst) 중 적어도 2가지인 것을 특징으로 하는 간 초음파 이미지를 이용하여 간 병변을 분류하는 인공지능 모델의 구축방법."}
{"patent_id": "10-2022-0105056", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제 1 항에 있어서, 상기 할당 단계(S140)에서, 상기 각 폴드는 상기 간 병변 별로 구분되어 있고, 상기 원본 이미지는 각 폴드마다의 상기 간 병변 별로 할당되되,동일 피험자의 모든 간 병변은 동일한 폴드에 할당되도록 하는 것을 특징으로 하는 간 초음파 이미지를 이용하여 간 병변을 분류하는 인공지능 모델의 구축방법."}
{"patent_id": "10-2022-0105056", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제 4 항에 있어서, 상기 복수개의 폴드는 5개이고, 상기 간 병변은 간세포 암종(Hepatocellular Carcinoma, HCC), 혈관종(Hemangioma), 낭종(Cyst)으로 구분되어있는 것을 특징으로 하는 간 초음파 이미지를 이용하여 간 병변을 분류하는 인공지능 모델의 구축방법."}
{"patent_id": "10-2022-0105056", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제 1 항에 있어서, 상기 영상처리단계(S160)는, 상기 원본 이미지에 최소 최대 곡률 흐름 필터를 적용하여 노이즈를 감소시키는 단계(S162);공개특허 10-2024-0027204-3-상기 원본 이미지에 적응형 히스토그램 이퀄라이져이션을 수행하여 이미지를 향상시키는 단계(S164);상기 원본 이미지 중 이미지와 관련없는 부분을 크롭하여 삭제하는 단계(S166); 및상기 원본 이미지를 정사각형으로 제로-패딩(Zero-padding)하고, 소정크기로 리사이징 하는 단계(S168);를 포함하는 것을 특징으로 하는 간 초음파 이미지를 이용하여 간 병변을 분류하는 인공지능 모델의 구축방법."}
{"patent_id": "10-2022-0105056", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "컴퓨터에 의해 판독 가능하고, 제 1 항 내지 제 6 항 중 어느 한 항에 따른 구축 방법으로 구축된 인공지능 모델이 기록된 컴퓨터 판독가능 기록매체."}
{"patent_id": "10-2022-0105056", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "복수의 간 초음파 이미지 중 소정의 제외기준에 해당하는 이미지를 배제하는 준비단계(S100);컴퓨터에 의해 실행되며, 상기 컴퓨터가,준비된 복수의 간 초음파 이미지를 원본 이미지로 입력받은 단계(S120);상기 원본 이미지를 간 병변 별로 복수의 폴드에 교차 할당하는 단계(S140);트레이닝을 위해 각각의 상기 원본 이미지를 영상처리하는 단계(S160);영상처리된 이미지를 이용하여 인공지능 모델을 트레이닝 하는 단계(S180);실제 레이블 영상 중 상기 간 병변에 해당하는 경계상자와 상기 인공지능 모델이 상기 레이블 영상에 대해 추론한 간 병변의 경계상자 사이의 IoU(Intersection over Union)값을 산출하는 단계(S200);상기 IoU값이 임계치 이상인지를 판단하는 단계(S220);만약 상기 IoU값이 임계치 이상이면, 상기 인공지능 모델이 추론한 상기 경계상자를 소정 크기의 이미지로 크롭하고 리사이징 하는 단계(S240); 및상기 인공지능 모델이 크롭된 이미지를 복수의 간 병변 중 하나로 분류하는 단계(S260);를 포함하는 것을 특징으로 하는 인공지능 모델을 이용한 간 병변의 분류 방법."}
{"patent_id": "10-2022-0105056", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제 8 항에 있어서, 상기 IoU값의 산출단계(S200)는, 상기 레이블 영상을 분할(segmentation)하여 상기 간 병변을 나타내는 예측 마스크를 생성하는 단계(S202); 및상기 예측 마스크를 포함하는 경계상자를 그리는 검출(Detection)단계(S204);를 포함하는 것을 특징으로 하는인공지능 모델을 이용한 간 병변의 분류 방법."}
{"patent_id": "10-2022-0105056", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제 8 항에 있어서, 상기 임계치는 0.2인 것을 특징으로 하는 인공지능 모델을 이용한 간 병변의 분류 방법."}
{"patent_id": "10-2022-0105056", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "제 8 항에 있어서, 상기 크롭 및 리사이징 단계(S240)는, 상기 경계상자를 정사각형으로 변환하는 단계(S242);정사각형의 상기 경계상자를 크롭하는 단계(S246); 및크롭된 상기 경계상자를 소정크기로 리사이징 하는 단계(S248);를 포함하는 것을 특징으로 하는 인공지능 모델공개특허 10-2024-0027204-4-을 이용한 간 병변의 분류 방법."}
{"patent_id": "10-2022-0105056", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제 8 항에 있어서, 상기 분류단계(S160)에서 상기 간 병변은 간세포 암종(Hepatocellular Carcinoma, HCC), 혈관종(Hemangioma),낭종(Cyst) 중 적어도 2가지인 것을 특징으로 하는 인공지능 모델을 이용한 간 병변의 분류 방법."}
{"patent_id": "10-2022-0105056", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 간 초음파 이미지에 의한 간 병변의 분류에 관한 것으로, 보다 상세하게는 간 초음파 이미지를 이용하 여 간 병변을 분류하는 인공지능 모델, 그 모델의 구축 방법, 및 그 인공지능 모델을 이용한 간 병변의 분류 방 법에 관한 것이다. 이를 위해, 복수의 간 초음파 이미지 중 소정의 제외기준에 해당하는 이미지를 배제하는 준비 단계(S100); 컴퓨터에 의해 실행되며, 컴퓨터가, 준비된 복수의 간 초음파 이미지를 원본 이미지로 입력받은 단 계(S120); 원본 이미지를 간 병변 별로 복수의 폴드에 교차 할당하는 단계(S140); 트레이닝을 위해 각각의 원본 이미지를 영상처리하는 단계(S160); 영상처리된 이미지를 이용하여 인공지능 모델을 트레이닝 하는 단계(S180); 를 포함하는 것을 특징으로 하는 간 초음파 이미지를 이용하여 간 병변을 분류하는 인공지능 모델의 구축방법이 제공된다."}
{"patent_id": "10-2022-0105056", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 간 초음파 이미지에 의한 간 병변의 분류에 관한 것으로, 보다 상세하게는 간 초음파 이미지를 이용 하여 간 병변을 분류하는 인공지능 모델, 그 모델의 구축 방법, 및 그 인공지능 모델을 이용한 간 병변의 분류 방법에 관한 것이다."}
{"patent_id": "10-2022-0105056", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "일반적으로, 간 질환 또는 간 병변을 진단하기 위하여 간 초음파 촬영장치가 사용된다. 촬영된 간 초음파 이미 지를 분석하여 간세포 암종(Hepatocellular Carcinoma, HCC), 혈관종(Hemangioma), 낭종(Cyst)을 분류한다. 종래에는 이러한 영상 분석 작업이 사람(예 : 영상의학과 의사)에 의해 수행되었나 최근 인공지능의 발달로 인 공지능 모델에 의해 조력을 받는 사례가 점차 증가하고 있다. 그러나, 전체 간 초음파 이미지로부터 간 병변 영역만의 경계를 검출하여 분할(segmentation)하기가 쉽지 않고, 위치를 검출(Detection)하기도 쉽지 않았다. 그리고, 최종적으로 어떤 간 병변에 해당하는지를 정확히 추론하여 분류(Classification)하도록 하기 위해서는 원본 데이터셋을 잘 정리하고, 세밀한 인공지능 모델의 설계가 필수 적이다. 선행기술문헌 특허문헌 (특허문헌 0001) 대한민국 특허공개번호 제 10-2021-0095483 호 (CT영상을 이용한 인공지능 기반 측두하악관절 염 진단 기술)."}
{"patent_id": "10-2022-0105056", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "따라서, 본 발명은 상기와 같은 문제점을 해결하기 위하여 안출된 것으로서, 본 발명의 해결하고자 하는 과제는 간 초음파 이미지를 이용하여 간 병변을 분류하는 인공지능 모델, 그 모델의 구축 방법, 및 그 인공지능 모델을 이용한 간 병변의 분류 방법을 제공하는 것이다. 다만, 본 발명에서 이루고자 하는 기술적 과제들은 이상에서 언급한 기술적 과제들로 제한되지 않으며, 언급하"}
{"patent_id": "10-2022-0105056", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 2, "content": "지 않은 또 다른 기술적 과제들은 아래의 기재로부터 본 발명이 속하는 기술분야에서 통상의 지식을 가진 자에 게 명확하게 이해될 수 있을 것이다."}
{"patent_id": "10-2022-0105056", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "상기의 기술적 과제를 달성하기 위하여, 복수의 간 초음파 이미지 중 소정의 제외기준에 해당하는 이미지를 배 제하는 준비단계(S100); 컴퓨터에 의해 실행되며, 컴퓨터가, 준비된 복수의 간 초음파 이미지를 원본 이미지로 입력받은 단계(S120); 원본 이미지를 간 병변 별로 복수의 폴드에 교차 할당하는 단계(S140); 트레이닝을 위해 각각의 원본 이미지를 영상처리하는 단계(S160); 영상처리된 이미지를 이용하여 인공지능 모델을 트레이닝 하는 단계(S180);를 포함하는 것을 특징으로 하는 간 초음파 이미지를 이용하여 간 병변을 분류하는 인공지능 모델의구축방법이 제공된다. 또한, 제외기준은 간 초음파 이미지에서 간 병변의 최대 크기가 10cm 이상이거나 또는 최소 크기가 1cm 이하인 것이다. 또한, 간 병변은 간세포 암종(Hepatocellular Carcinoma, HCC), 혈관종(Hemangioma), 낭종(Cyst) 중 적어도 2 가지이다. 또한, 할당 단계(S140)에서, 각 폴드는 상기 간 병변 별로 구분되어 있고, 원본 이미지는 각 폴드마다의 상기 간 병변 별로 할당되되, 동일 피험자의 모든 간 병변은 동일한 폴드에 할당되도록 한다. 또한, 복수개의 폴드는 5개이고, 간 병변은 간세포 암종(Hepatocellular Carcinoma, HCC), 혈관종 (Hemangioma), 낭종(Cyst)으로 구분되어 있다. 또한, 영상처리단계(S160)는, 원본 이미지에 최소 최대 곡률 흐름 필터를 적용하여 노이즈를 감소시키는 단계 (S162); 원본 이미지에 적응형 히스토그램 이퀄라이져이션을 수행하여 이미지를 향상시키는 단계(S164); 원본 이미지 중 이미지와 관련없는 부분을 크롭하여 삭제하는 단계(S166); 및 원본 이미지를 정사각형으로 제로-패딩 (Zero-padding)하고, 소정크기로 리사이징 하는 단계(S168);를 포함한다. 상기와 같은 본 발명의 목적은 컴퓨터에 의해 판독 가능하고, 전술한 구축 방법으로 구축된 인공지능 모델이 기 록된 컴퓨터 판독 가능 기록매체에 의해 달성될 수 있다. 상기와 같은 본 발명의 목적은 또 다른 실시예로써, 복수의 간 초음파 이미지 중 소정의 제외기준에 해당하는 이미지를 배제하는 준비단계(S100); 컴퓨터에 의해 실행되며, 상기 컴퓨터가, 준비된 복수의 간 초음파 이미지 를 원본 이미지로 입력받은 단계(S120); 원본 이미지를 간 병변 별로 복수의 폴드에 교차 할당하는 단계(S140); 트레이닝을 위해 각각의 원본 이미지를 영상처리하는 단계(S160); 영상처리된 이미지를 이용하여 인공지능 모델 을 트레이닝 하는 단계(S180); 실제 레이블 영상 중 간 병변에 해당하는 경계상자와 인공지능 모델이 레이블 영 상에 대해 추론한 간 병변의 경계상자 사이의 IoU값을 산출하는 단계(S200); IoU값이 임계치 이상인지를 판단하 는 단계(S220); 만약 IoU값이 임계치 이상이면, 인공지능 모델이 추론한 경계상자를 소정 크기의 이미지로 크롭 하고 리사이징하는 단계(S240); 및 인공지능 모델이 크롭된 이미지를 복수의 간 병변 중 하나로 분류하는 단계 (S260);를 포함하는 것을 특징으로 하는 인공지능 모델을 이용한 간 병변의 분류 방법에 의해 달성될 수 있다. 또한, IoU값의 산출단계(S200)는, 레이블 영상을 분할(segmentation)하여 간 병변을 나타내는 예측 마스크를 생 성하는 단계(S202); 및 예측 마스크를 포함하는 경계상자를 그리는 검출(Detection)단계(S204);를 포함한다. 또한, 임계치는 0.2이다. 또한, 크롭 및 리사이징 단계(S240)는, 경계상자를 정사각형으로 변환하는 단계(S242); 정사각형의 경계상자를 크롭하는 단계(S246); 및 크롭된 경계상자를 소정크기로 리사이징하는 단계(S248);를 포함한다."}
{"patent_id": "10-2022-0105056", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명의 일실시예에 따르면, 인공지능 모델이 간 초음파 이미지로부터 간 병변의 종류를 빠르고 정확하게 분 류한다. 따라서, 간 초음파 이미지의 분석에 도움이 될 수 있고, 오진이나 미진을 사전에 방지할 수 있다. 다만, 본 발명에서 얻을 수 있는 효과는 이상에서 언급한 효과들로 제한되지 않으며, 언급하지 않은 또 다른 효"}
{"patent_id": "10-2022-0105056", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 2, "content": "과들은 아래의 기재로부터 본 발명이 속하는 기술분야에서 통상의 지식을 가진 자에게 명확하게 이해될 수 있을 것이다."}
{"patent_id": "10-2022-0105056", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "아래에서는 첨부한 도면을 참고로 하여 본 발명의 실시예에 대하여 본 발명이 속하는 기술분야에서 통상의 지식 을 가진 자가 용이하게 실시할 수 있도록 상세히 설명한다. 그러나 본 발명에 관한 설명은 구조적 내지 기능적 설명을 위한 실시예에 불과하므로, 본 발명의 권리범위는 본문에 설명된 실시예에 의하여 제한되는 것으로 해석 되어서는 아니 된다. 즉, 실시예는 다양한 변경이 가능하고 여러 가지 형태를 가질 수 있으므로 본 발명의 권리 범위는 기술적 사상을 실현할 수 있는 균등물들을 포함하는 것으로 이해되어야 한다. 또한, 본 발명에서 제시된 목적 또는 효과는 특정 실시예가 이를 전부 포함하여야 한다거나 그러한 효과만을 포함하여야 한다는 의미는 아 니므로, 본 발명의 권리범위는 이에 의하여 제한되는 것으로 이해되어서는 아니 될 것이다. 본 발명에서 서술되는 용어의 의미는 다음과 같이 이해되어야 할 것이다. \"제1\", \"제2\" 등의 용어는 하나의 구성요소를 다른 구성요소로부터 구별하기 위한 것으로, 이들 용어들에 의해 권리범위가 한정되어서는 아니 된다. 예를 들어, 제1 구성요소는 제2 구성요소로 명명될 수 있고, 유사하게 제2 구성요소도 제1 구성요소로 명명될 수 있다. 어떤 구성요소가 다른 구성요소에 \"연결되어\" 있다고 언급된 때에 는, 그 다른 구성요소에 직접적으로 연결될 수도 있지만, 중간에 다른 구성요소가 존재할 수도 있다고 이해되어 야 할 것이다. 반면에, 어떤 구성요소가 다른 구성요소에 \"직접 연결되어\" 있다고 언급된 때에는 중간에 다른구성요소가 존재하지 않는 것으로 이해되어야 할 것이다. 한편, 구성요소들 간의 관계를 설명하는 다른 표현들, 즉 \"~사이에\"와 \"바로 ~사이에\" 또는 \"~에 이웃하는\"과 \"~에 직접 이웃하는\" 등도 마찬가지로 해석되어야 한다. 단수의 표현은 문맥상 명백하게 다르게 뜻하지 않는 한 복수의 표현을 포함하는 것으로 이해되어야 하고, \"포함 하다\" 또는 \"가지다\" 등의 용어는 설시된 특징, 숫자, 단계, 동작, 구성요소, 부분품 또는 이들을 조합한 것이 존재함을 지정하려는 것이며, 하나 또는 그 이상의 다른 특징이나 숫자, 단계, 동작, 구성요소, 부분품 또는 이 들을 조합한 것들의 존재 또는 부가 가능성을 미리 배제하지 않는 것으로 이해되어야 한다. 여기서 사용되는 모든 용어들은 다르게 정의되지 않는 한, 본 발명이 속하는 분야에서 통상의 지식을 가진 자에 의해 일반적으로 이해되는 것과 동일한 의미를 가진다. 일반적으로 사용되는 사전에 정의되어 있는 용어들은 관 련 기술의 문맥상 가지는 의미와 일치하는 것으로 해석되어야 하며, 본 발명에서 명백하게 정의하지 않는 한 이 상적이거나 과도하게 형식적인 의미를 지니는 것으로 해석될 수 없다. 이하, 첨부된 도면을 참조하여 바람직한 실시예에 관해 상세히 설명하기로 한다. 도 12는 본 발명의 일 실시예 에 따른 간 초음파 이미지를 이용하여 간 병변을 분류하는 인공지능 모델의 구축과 분류 방법을 개략적으로 나 타내는 흐름도이다. 도 12에 도시된 바와 같이, 먼저 준비단계로서 복수의 간 초음파 이미지 중 소정의 제외기 준에 해당하는 이미지를 배제한다(S100). 간 초음파 이미지는 간 병변을 포함하는 흑백 그레이 이미지이며, 제 외기준에 따라 배제된 후 남은 이미지만을 사용한다. 제외기준은 간 초음파 이미지에서 간 병변의 최대 크기가 10cm 이상이거나 또는 최소 크기가 1cm 이하인 것이다. 간 병변이 너무 크면 분할하기가 어렵고, 너무 작으면 잘못된 추론을 하거나 학습 시간이 오래 걸릴 수 있기 때문이다. 제외기준에 따라 제외되고 트레이닝에 사용할 이미지는 간세포 암종(Hepatocellular Carcinoma, HCC)의 경우, 1,258명의 환자에 대한 3,714장의 이미지 및 3,739개의 간 병변을 포함한다. 혈관종(Hemangioma)의 경우 834명 의 환자에 대한 2,018장의 이미지 및 2,044개의 간 병변을 포함한다. 낭종(Cyst)의 경우 480명의 환자에 대한 980장의 이미지와 1,039개의 간 병변을 포함한다. 이러한 이미지는 간 병변의 종류로 구분한 것이며, 환자에 따 라 복수의 간 병변을 포함하거나 복수의 이미지를 포함한다. 이러한 준비단계는 초음파 장비에서 출력되는 간 병변의 크기 데이터를 이용하여 컴퓨터에서 일괄 수행되거나 작업자에 의해 수행될 수 있다. 그 다음, 준비된 복수의 간 초음파 이미지는 원본 이미지로써 컴퓨터에 입력되고, 저장된다(S120). 이를 위해 컴퓨터는 통상의 CPU, RAM, 하드디스크, 입력포트(예 : USB 포트) 등을 포함하며, 운영체계(예 : 윈도우, 리눅 스) 프로그램과 인공지능 프로그램(예 : Pytorch가 있는 Python 패키지 프로그램)이 설치되고 실행될 수 있다. 그 다음, 원본 이미지를 5등분 한 뒤, [표 1]과 같이 간 병변 별로 5개의 폴드(Fold)에 교차 할당한다(S140). [표 1]에서 트레이닝(Training)은 인공지능 모델의 학습에 사용되는 이미지(전체 이미지의 3/5에 해당)를 나타 내고, 검증(Validation)은 인공지능 모델의 학습 완료를 검증하기 이미지(전체 이미지의 1/5에 해당)이며, 테스 트(Test)는 인공지능 모델의 추론이 정확한지를 확인하기 위한 이미지(전체 이미지의 1/5에 해당)이다. 따라서, 5개의 폴드에 대해 5개의 교차검증(Cross Validation, CV)이 정의된다. 표 1 폴드1 폴드2 폴드3 폴드4 폴드5 CV1 트레이닝 트레이닝 트레이닝 검증 테스트 CV2 트레이닝 트레이닝 검증 테스트 트레이닝 CV3 트레이닝 검증 테스트 트레이닝 트레이닝 CV4 검증 테스트 트레이닝 트레이닝 트레이닝 CV5 테스트 트레이닝 트레이닝 트레이닝 검증 [표 2]에 도시된 바와 같이, 각 폴드는 간 병변 별로 구분되어 있고, 원본 이미지는 각 폴드마다의 상기 간 병 변 별로 할당되되, 동일 피험자의 모든 간 병변은 동일한 폴드에 할당되도록 한다. 이때, 간 병변은 간세포 암 종(Hepatocellular Carcinoma, HCC), 혈관종(Hemangioma), 낭종(Cyst)으로 구분되어 있다. 표 2 폴드 병변 이미지 대상폴드 1합계 1,123 1,104 520 간세포암종(HCC) 563 556 252 혈관종(Hemangioma) 370 367 169 낭종(Cyst) 190 181 99 폴드 2합계 1,294 1,275 520 간세포암종(HCC) 660 654 252 혈관종(Hemangioma) 411 411 169 낭종(Cyst) 223 210 99 폴드 3합계 1,503 1,479 520 간세포암종(HCC) 904 901 252 혈관종(Hemangioma) 395 391 169 낭종(Cyst) 204 187 99 폴드 4합계 1,434 1,417 520 간세포암종(HCC) 816 815 252 혈관종(Hemangioma) 448 438 169 낭종(Cyst) 170 164 99 폴드 5합계 1,468 1,437 520 간세포암종(HCC) 796 788 254 혈관종(Hemangioma) 420 411 170 낭종(Cyst) 252 238 96 [표 2]와 같이 각 폴드는 520명의 대상(환자)으로 할당되며, 트레이닝 셋트, 검증 셋트 및 테스트 셋트가 서로 독립적임을 알 수 있다. 그 다음, 컴퓨터는 트레이닝을 위해 각각의 원본 이미지를 영상처리한다(S160). 도 1은 간 초음파 이미지를 본 발명에 따라 영상처리하는 과정을 나타내는 설명도이다. 도 1에 도시된 바와 같이, 영상 처리단계(S160)는, 원본 이미지에 최소 최대 곡률 흐름 필터(Min max curvature flow filter)를 적용하여 노이 즈를 감소시킨다(S162). 그 다음, 원본 이미지에 적응형 히스토그램 이퀄라이져이션(Adaptive histogram equalization)을 수행하여 이미지를 향상(Enhancement)시킨다(S164). 그 다음, 원본 이미지 중 이미지와 관련없 는 부분(예 : 텍스트 부분)을 크롭하여 삭제한다(S166). 그 다음, 원본 이미지를 정사각형으로 제로-패딩(Zero- padding)하고, 소정크기(예 : 512 x 512)로 리사이징한다(S168). 제로 패딩은 패딩해야 할 모든 바이트를 0으로 채우는 방식이다. 영상처리단계(S160)를 위해 컴퓨터에는 통사의 이미지 프로세싱 프로그램이 탑재되어 실행될 수 있다. 그 다음, 전술한 바와 같이 영상처리된 이미지를 이용하여 인공지능 모델을 트레이닝 한다(S180). 인 공지능 프로그램은 상용의 \"Pytorch가 있는 파이톤(Python) 패키지 프로그램\" 및 AI 시스템 아키텍처로서 Deep lab V3-Resnet 101 모델 또는 Efficientnet-b2모델이 사용되었다. 인공지능 모델의 트레이닝을 위해 초기 학습률은 0.001로 설정하기 배치 크기는 4이다. 그리고, 트레이닝을 위 한 손실 함수(loss function)는 주사위(Dice) 손실 및 이진 교차 엔트로피(Binary Cross Entropy, BCE) 손실과 결합되었다. 또한 손실 함수의 최적화를 위해 모멘텀 0.9, 가중치 감소 0.0001의 확률적 경사 하강법 (Stochastic Gradient Descent, SGD)이 사용되었다. 확률적 경사 하강법(SGD)은 전체 데이터 세트에서 확률적 으로 선택된 하나의 예로 각 단계의 예측 경사를 계산하는 알고리즘이다. 그리고, 트레이닝 과정 중 간 병변의 위치를 나타내기 위하여 사각형의 경계 상자(Bounding Box)를 생성하였고, 회전, 이동, 뒤집기(flip), 크기 조정(scaling) 및 컬러 지터(color jitter)를 포함하는 온더플라이 데이터 증 대 전략(on-the-fly data augmentation strategies)이 실행되었다. 트레이닝의 결과 인공지능 모델이 8 에포크(epoch) 동안 검증 데이터의 손실이 감소하지 않을 때 학습률은 0.5 로 감소하였고, 20 에포크 동안 검증 데이터의 손실이 감소하지 않을 때 트레이닝 과정은 조기에 종료되었다. 학습률은 인공지능 모델이 학습을 하는 과정을 나타내는 척도로서, 인공지능 모델이 최적화되는 과정에서 조금 씩 최적해에 접근하는다는 의미이다. 트레이닝 과정의 종료 후 후반 처리 과정에서 0.1 cm2 보다 작은 물체는 제거되었고, 예측 마스크에 대해 7 x 7의 중간값 필터를 실행하였다. 이와 같은 트레이닝 과정을 통해 인공지능 모델이 완성된다. 그 다음, 테스트 과정으로써 컴퓨터는 실제 레이블 영상 중 간 병변에 해당하는 경계상자와 인공지능 모델이 레 이블 영상에 대해 추론한 간 병변의 경계상자 사이의 IoU값을 산출한다(S200). 먼저, 경계상자를 생성하는 과정은 다음과 같다. 도 2a는 본 발명에 따른 인공지능 모델이 실제 레이블 영상으 로부터 예측(Predicted) 마스크를 생성하는 단계를 도식적으로 나타낸 상태도이고, 도 2b는 도 2a에서 생성된 예측 마스크에 경계상자를 그리는 상태도이다. 도 2a 및 도 2b에 도시된 바와 같이, 간 병변 이미지에 대해 101 개의 레이어 연산이 이루어지고, 첫 레이어는 7x7 행렬에 대한 컨벌류선 연산을 통해 64채널로 이루어진다. 그 다음, 아트로스(Atrous) 공간 피라미드 풀링(ASPP)을 수행한다. 이는 아트로스 풀링을 피라미드 형태로 구축하 는 것이다. 이러한 아트로스 공간 피라미드 풀링 네트워크의 출력은 1x1 컨벌류션을 통해 업 샘플링(Up sampling)되어 간 병변 이미지 상에서 예측 마스크를 생성하게 된다(S202). 도 2b에 도시된 바와 같이, 예측 마스크를 포함하는 최소의 정사각형을 정의하고 이를 경계상자로 생성한다 (S204). 이러한 경계상자는 실제 레이블 영상 중 간 병변에 해당하는 경계상자와 인공지능 모델이 레이블 영상 에 대해 추론한 간 병변의 경계상자로 산출된다. S200 단계에서 산출한 IoU값이 0.2 이상인지를 판단한다(S220). 도 3a는 실제 레이블 영상의 경계상자와 인공지 능 모델이 추론한 경계상자 사이의 IoU(Intersection Over Union) 임계값이 0.2 이상일 때 예측 마스크를 참 양 성 예측(True Positive Prediction)으로 추론하는 이미지의 일예이고, 도 3b는 실제 레이블 영상의 경계상자와 인공지능 모델이 추론한 경계상자 사이의 IoU 임계값이 0.2 보다 작을 때 예측 마스크를 오탐지(Miss- detection)로 추론하는 이미지의 일예이다. 따라서 더 낮은 IoU 임계값(예 : 0.1, 0.15 등)으로 간 병변의 고감 도 검출을 달성할 수 있다. 도 2c는 도 2b에서 그려진 경계상자의 이미지가 참 양성 예측이라고 판단되면 이를 이용하여 간 병변을 분류하 는 과정을 나타낸 상태도이다. 도 2c에 도시된 바와 같이, 먼저 경계상자를 정사각형으로 변환하고(S242), 정사 각형의 경계상자를 크롭하여 잘라낸 후(S246), 크롭된 정사각형의 경계상자를 96 x 96 크기로 리사이징한다 (S248). 일예로써 도 4a는 간 초음파 이미지 중 간 병변으로 예측된 경계상자(Bounding Box)를 나타내는 이미지 이고, 도 4b는 도 4a에서 예측된 경계상자를 정사각형으로 변환한 이미지이며, 도 4c는 도 4b에서 변환된 정사 각형의 경계상자를 크롭(Crop)한 이미지이다. S242단계에서 직사각형의 경계상자 중 긴변의 길이를 기준으로 정 사각형을 변환한다. 그 다음, 리사이징된 이미지를 추론함으로서 간세포 암종(Hepatocellular Carcinoma, HCC), 혈관종 (Hemangioma), 낭종(Cyst) 중 하나로 분류하는 과정은 다음과 같다. 도 2c에 도시된 바와 같이, 우선, 23개의 모바일 인버티드 보틀넥 컨볼류션(Moblie inverted bottle neck convolution, MBConv)으로 구성된 컨볼류션 신 경망은 8 개의 특징을 추출한다. MBConv는 기존의 컨볼류션 연산보다 적은 수의 파라미터로 특징을 추출할 수 있도록 특징맵을 채널 별로 분리하여 연산을 수행하는 뎁스와이즈 컨볼루션(Depthwise convolution), 이를 1 x 1 컨볼류션 연산을 통해 다시 하나의 채널로 합치는 포인트와이즈 컨볼류션(Pointwise convolution), 채널 별 특징맵을 각 하나의 특징값으로 변환하는 스퀴즈 네트워크(Squeeze network)와 해당 특징값들의 중요도를 연산 하는 익사이테이션 네트워크(Excitation network)을 거쳐, 간 병변 분류를 위한 이미지의 특징을 추출하게 된다. 이러한 컨볼류션 신경망을 통한 특징 추출과 동시에, 라디오믹스(Radiomics) 방식을 이용한 특징 추출이 시행된다. 라디오믹스 방식에서는 이미지의 픽셀 강도 분포를 나타내는 1차 특징(First-order feature)과 근접 한 픽셀 사이의 신호 관계를 나타내는 질감 특징(Texture feature)이 추출된다. 이 중 질감 특징은 이미지에서 특정 값을 갖는 픽셀 쌍이 특정 공간에서 발생하는 빈도를 계산하는 GLCM(Gray Level Co-occurrence matrix), 이미지에서 같은 강도를 갖으며 연속적인 픽셀들의 길이를 계산하는 GLRLM(Gray Level Run Length Matrix), 이 미지에서 같은 강도를 갖는 서로 인접한 픽셀들의 크기를 계산하는 GLSZM(Gray Level Size Zone Matrix), 이미 지에서 특정 픽셀의 강도와 인접한 픽셀들의 평균 강도 사이의 차이를 계산하는 NGTDM(Neighboring Tone Difference Matrix), 이미지에서 특정 거리만큼 떨어져 있는 픽셀들 사이에서 픽셀 강도의 발생빈도를 계산하는 GLDM(Gray Level Dependence Matrix)이 적용된다. 그 다음, 분류 모델에서 과대적합을 방지하기 위해, 가중치 들의 절대값의 합이 0이 되도록 제약을 주는 라쏘 회귀(Lasso regression)를 통한 특징 선택을 시행한다. 따라 서 [표 3]에 도시된 바와 같이, 중요한 특징들이 선택된다. 선택된 특징들은 32-16-16-8의 레이어 구조를 갖는 다층 퍼셉트론(Multi layer perceptorn)에 입력되어, 다시 8개의 특징으로 변환되며, 이를 컨볼류션 방식으로 추출된 8개의 특징과 결합하여 HCC, Hemangioma, Cyst 중 하나로 분류하는 확률 값을 도출한다(S260). 표 3 특징 정의 First orderInterquartile range 이미지 강도 값들의 25 퍼센트 백분위수와 75 퍼센트 백분위수의 차이 GLCM Cluster shade GLCM의 왜도과 균일도 GLDM Dependence non-uniformity normalized이미지의 종속성 유사도 Large dependence low gray level emphasis낮은 강도와 큰 의존성의 결합 분포 NGTDM Coarseness 중심 픽셀과 그 이웃간의 평균 차이 Strength 이미지 픽셀 강도의 변화율 및 거침 정도의 차이 도 3a 내지 도 3c 및 [표 4]에 도시된 바와 같이, 본 발명의 인공지능 모델은 2,444명의 환자로부터의 6,077개 의 크롭된 병변 및 6,038장의 이미지를 3가지 간 병변으로 분류하였다. 표 4 폴드 병변(크롭) 이미지 대상 폴드 1합계 1,211 1,191 486 간세포암종(HCC) 655 655 233 혈관종(Hemangioma) 368 368 160 낭종(Cyst) 188 168 93 폴드 2합계 1,239 1,233 486 간세포암종(HCC) 656 656 233 혈관종(Hemangioma) 391 389 160 낭종(Cyst) 192 188 93 폴드 3합계 1,180 1,178 486 간세포암종(HCC) 645 645 233 혈관종(Hemangioma) 354 354 160 낭종(Cyst) 181 179 93 폴드 4합계 1,239 1,229 486 간세포암종(HCC) 658 681 233 혈관종(Hemangioma) 374 370 160 낭종(Cyst) 180 178 93 폴드 5합계 1,208 1,207 500 간세포암종(HCC) 640 640 232 혈관종(Hemangioma) 370 369 167 낭종(Cyst) 198 198 101 비교실험 이하는 상기와 같이 구축된 인공지능 모델의 다양한 비교 실험 결과이다. 먼저, 도 5a는 경계상자의 IoU가 각각 0.121, 0.261, 0.397일 때 실제 레이블 영상과 인공지능 모델의 추론 이미지 사이의 분할(segmentation)과 위치 검출(Detection)을 대비적으로 나타내는 일예이고, 도 5b는 경계상자의 IoU가 각각 0.487, 0.577, 0.624일 때 실제 레이블 영상과 인공지능 모델의 추론 이미지 사이의 분할과 위치 검출을 대비적으로 나타내는 일예이며, 도 5c는 경계상자의 IoU가 각각 0.790, 0.834, 0.964일 때 실제 레이블 영상과 인공지능 모델의 추론 이미지 사 이의 분할과 위치 검출을 대비적으로 나타내는 일예이다. 도 5a 내지 도 5c에서 첫 번째 컬럼은 원본 이미지이 며, 두 번째 컬럼의 적색은 레이블 영상에서의 병변 표시이며, 청색은 인공지능 모델이 추론한 예측 마스크의 표시이다. 세 번째 컬럼에서 적색은 레이블 영상의 병변을 포함하는 경계상자이며, 청색은 인공지능 모델이 추 론한 예측 마스크를 포함하는 경계상자이다. 도 5a에서 IoU가 0.1211 일 때, 더 큰 면적의 청색 경계상자는 적색 경계상자의 절반만을 포함하고 있음을 알 수 있다. 이는 인공지능 모델이 간 병변의 위치를 정확히 추론하고 있음을 나타낸다. 그러나 IoU가 0.2 이상일 때는 적색 경계상자와 청색 경계상자의 위치가 유사하게 근접함을 알 수 있었다. 특히 IoU의 값이 1에 근접할수로 경계상자의 위치가 매우 근접해짐을 알 수 있다. 도 6a 내지 도 6e는 폴드 1 내지 폴드 5에 대한 분류 결과를 나타내는 혼돈 행렬(Confusion matrix)의 일예이다. 도 6a에 도시된 바와 같이, 폴드 1에 대해 레이블 영상의 HCC를 인공지능 모델이 HCC로 분류하는 것 (옳바른 분류)은 461 케이스로 매우 높고, 잘못 분류하는 것은 151 + 28 = 179 케이스 였다. 폴드 1 내지 폴드 5에 걸쳐 유사한 분류 결과를 나타내고 있음을 확인할 수 있다. 도 7a 내지 도 7e는 폴드 1 내지 폴드 5에 대한 ROC(Receiver Operating Characteristic) 커브를 나타내는 그 래프이다. 폴드 1 내지 폴드 5에 걸쳐 유사한 분류 결과를 나타내고 있음을 확인할 수 있다. 그리고, 도 8은 도 6a 내지 도 6e에 도시된 혼돈 행렬을 종합한 분류 결과의 혼돈 행렬이며, 도 9는 도 7a 내지 도 7e에 도시된 ROC 커브를 종합한 ROC 커브의 그래프이다. 도 8에 도시된 바와 같이, 인공지능 모델은 낭종 (Cyst) 병변을 가장 잘 분류하였고, HCC와 Hemangioma의 분류 정확도가 상대적으로 낮았다. 도 9에서는 HCC와 혈관종의 ROC 커브가 유사한 형태(HCC의 AUC = 0.865, 혈관종의 AUC = 0.850)를 나타냈고, 낭종(Cyst)의 AUC = 0.990로 높게 나타났다. [표 5]는 간 병변의 분할(Segmentation) 성능(경계 검출)을 나타내는 그래프이고, 평균값은 괄호안에 표준편차 로 표시하였다. 표 5 타입 분할 성능 DSC(%) IoU(%) 합계 간 병변 0.728(0.272) 0.629(0.269) CV 1 0.706(0.290) 0.608(0.283) CV 2 0.716(0.278) 0.616(0.274) CV 3 0.740(0.259) 0.640(0.258) CV 4 0.720(0.280) 0.622(0.276) CV 5 0.755(0.246) 0.655(0.249) DSC(Dice Similarity coefficient) / IoU(Intersection Over union). 여기서, 주사위 유사성 계수(DSC)는 레이블이 지정된 마스크와 예측된 마스크 사이의 중첩 영역의 두 배를 레이 블이 지정된 마스크와 예측된 마스크의 전체 영역으로 나눈 값이다. 그리고 IoU점수는 레이블의 경계상자와 예 측된 경계상자 사이의 중첩된 영역을 레이블과 예측 간의 합집합으로 나눈 값이다. [표 5]에 도시된 바와 같이 CV1 ~ CV5를 통해 일정한 DSC성능과 IoU 성능을 나타내고 있음을 알 수 있고, 72.8% 의 DSC 성능과 62.9%의 교차 성능을 나타내고 있음을 확인하였다. 간 병병의 경계를 명확히 정의하기 어렵다는 특징을 감안할 때, 인공지능 모델의 분할 성능은 매우 뛰어난 것임을 확인할 수 있었다. [표 6]은 간 병변의 검출(detection) 성능(위치 검출)을 나타내는 그래프이고, 괄호안은 95%의 신뢰 구간이다. 표 6 타입 검출 성능 검출율(%) FPPI(%) 합계 간 병변0.891(0.879-0.903) 0.223(0.212-0.234) CV 1 0.868(0.839-0.897) 0.276(0.250-0.302) CV 2 0.878(0.848-0.908) 0.236(0.208-0.264) CV 3 0.903(0.878-0.928) 0.205(0.180-0.230) CV 4 0.883(0.857-0.909) 0.216(0.192-0.240) CV 5 0.921(0.899-0.943) 0.183(0.160-0.206) FPPI : False Positive Per Image 간 병변이 포함된 영역에 분할 마스크를 출력하지 않은 경우 참거짓의 개수(위양성)가 카운트되고, 이미지당 위 양성(FPPI)은 위양성의 개수를 총 이미수로 나눈 값이다. 검출 성능에서 본 발명의 인공지능 모델은 모든 폴드에서 0.891(95% CI: 0.879-0.903)의 검출율과 0.223(95% CI: 0.212-0.234)의 FPPI를 나타냈다. 인공지능 모델은 각 교차 검증 폴드에서 0.868-0.921의 검출율과 0.183- 0.276의 FPPI를 보였다. [표 7]은 간 초음파 이미지에서 인공지능 모델의 전체적인 분류 성능을 나타낸다. 표 7 분류 성능 타입 재현율(%) 정밀도(%) F1-점수 AUC 합계HCC Hemangioma Cyst0.753 (0.738-0.768) 0.691 (0.670-0.712) 0.930 (0.911-0.945)0.817 (0.803-0.831) 0.633 (0.612-0.654) 0.851 (0.828-0.872)0.784 (0.774-0.794) 0.661 (0.646-0.676) 0.889 (0.874-0.902)0.865 (0.856-0.874) 0.850 (0.838-0.861) 0.990 (0.985-0.994) CV 1HCC Hemangioma Cyst0.720 (0.684-0.754) 0.735 (0.688-0.779) 0.879 (0.826-0.919)0.812 (0.777-0.842) 0.631 (0.584-0.676) 0.833 (0.776-0.879)0.763 (0.738-0.786) 0.679 (0.646-0.711) 0.855 (0.817-0.887)0.860 (0.839-0.880) 0.861 (0.835-0.886) 0.987 (0.975-0.998) CV 2HCC Hemangioma Cyst0.745 (0.710-0.777) 0.701 (0.652-0.746) 0.973 (0.940-0.989)0.831 (0.798-0.860) 0.637 (0.589-0.683) 0.836 (0.779-0.880)0.786 (0.762-0.808) 0.668 (0.633-0.700) 0.899 (0.866-0.925)0.881 (0.862-0.900) 0.861 (0.836-0.887) 0.992 (0.983-1.000) CV 3HCC Hemangioma Cyst0.787 (0.753-0.816) 0.665 (0.616-0.711) 0.927 (0.881-0.957)0.805 (0.772-0.834) 0.658 (0.610-0.704) 0.877 (0.823-0.917)0.796 (0.773-0.817) 0.662 (0.627-0.694) 0.901 (0.867-0.928)0.863 (0.842-0.883) 0.840 (0.813-0.866) 0.991 (0.981-1.000) CV 4HCC Hemangioma Cyst0.758 (0.722-0.789) 0.706 (0.656-0.752) 0.961 (0.921-0.982)0.842 (0.809-0.869) 0.635 (0.585-0.682) 0.849 (0.793-0.893)0.789 (0.774-0.819) 0.668 (0.634-0.702) 0.902 (0.867-0.928)0.874 (0.854-0.894) 0.850 (0.823-0.876) 0.993 (0.985-1.000) CV 5HCC Hemangioma Cyst0.755 (0.721-0.786) 0.652 (0.602-0.699) 0.911 (0.859-0,945)0.800 (0.767-0.830) 0.605 (0.556-0.653) 0.863 (0.806-0.906)0.777 (0.754-0.799) 0.628 (0.593-0.662) 0.886 (0.850-0.915)0.854 (0.833-0.875) 0.840 (0.813-0.867) 0.990 (0.979-1.000) AUC : Area Under the receiver operating Characteristic Curve [표 7]에서 재현율(Recall)은 참 양성(True positive)인 병변의 수를 총 양성 병변의 수로 나눈 값이며, 임상의 사의 결정을 보조하는데 중요한 역할을 한다. 정밀도는 참 양성 병변의 수를 양성으로 예측된 총 병변의 수(진양성 및 위양성 병변의 수의 합)로 나누어 정의 된다. F1-점수는 재현율과 정밀도의 조화 평균으로 정의된다. 리시버 동작 특성 곡선의 아래 영역(AUC) 점수는 결정 임계값에 대한 위양성 비율에 대한 회수를 나타내는 리시버 동작 특성(ROC) 곡선 아래 영역으로 정의된다. [표 7]에 도시된 바와 같이 예를 들어, HCC의 분류는 0.753(95% CI : 0.738-0.768)의 재현율, 0.817(95% CI : 0.803-0.831)의 정밀도, 0.784(95% CI : 0.774-0.794)의 F1-점수 및 0.865(95% CI : 0.856-0.874)의 AUC 점수 를 나타냈다. 도 10a 내지 도 10i는 실제 레이블의 간 병변과 본 발명의 인공지능 모델이 분류한 간 병변을 대비한 이미지이 다. 도 10a에서 레이블 영상의 낭종(Cyst)은 낭종으로 올바르게 분류되었으나, 도 10b에서 레이블 영상의 낭종 (Cyst)은 혈관종으로 잘못 분류되었다. 도 11a는 간 병변 중 HCC와 혈관종 사이의 상호 분류를 나타내는 혼돈 행렬이고, [표 8]은 HCC와 혈관종 사이의 상호 분류를 나타내는 분류 성능이다. 표 8 분류 성능 타입 재현율(%) 정밀도(%) F1-점수 AUC 합계HCC Hemangioma0.724(0.708-0.739) 0.749(0.729-0.768)0.836(0.822-0.849) 0.606(0.585-0.625)0.776(0.765-0.786) 0.670(0.655-0.684)0.807(0.794-0.820)도 11a에 도시된 바와 같이, 레이블 영상의 HCC를 HCC로 올바르게 분류한 케이스는 2,375 케이스이고, 혈관종으 로 잘못 분류한 케이스는 906 케이스이다. 그리고, 레이블 영상의 혈관종을 혈관종으로 올바르게 분류한 케이스 는 1,391 케이스이고, HCC로 잘못 분류한 케이스는 466 케이스이다. 이에 따라 [표 8]에 도시된 바와 같이 HCC 와 혈관종 사이의 재현율은 0.724 ~ 0.749 사이임을 알 수 있다. 도 11b는 간 병변 중 HCC와 낭종 사이의 상호 분류를 나타내는 혼돈 행렬이고, [표 9]는 HCC와 낭종 사이의 상 호 분류를 나타내는 분류 성능이다. 표 9 분류 성능 타입 재현율(%) 정밀도(%) F1-점수 AUC 합계HCC Cyst0.949(0.941-0.956) 0.958(0.944-0.970)0.988(0.985-0.991) 0.843(0.820-0.864)0.968(0.963-0.972) 0.897(0.883-0.910)0.987(0.982-0.993) 도 11b에 도시된 바와 같이, 레이블 영상의 HCC를 HCC로 올바르게 분류한 케이스는 3,114 케이스이고, 낭종으로 잘못 분류한 케이스는 167 케이스이다. 그리고, 레이블 영상의 낭종을 낭종으로 올바르게 분류한 케이스는 900 케이스이고, HCC로 잘못 분류한 케이스는 39 케이스이다. 이에 따라 [표 9]에 도시된 바와 같이 HCC와 낭종 사 이의 재현율은 0.949 ~ 0.958 사이임을 알 수 있다. 이는 HCC와 혈관종 사이의 분류 보다 HCC와 낭종 사이의 분 류 성능이 훨씬 높다는 것을 나타낸다. 즉, 인공지능 모델이 HCC와 낭종 사이를 잘 구분한다는 의미이다. 도 11c는 간 병변 중 혈관종과 낭종 사이의 상호 분류를 나타내는 혼돈 행렬이고, [표 10]은 혈관종과 낭종 사 이의 상호 분류를 나타내는 분류성능이다. 표 10 분류 성능 타입 재현율(%) 정밀도(%) F1-점수 AUC 합계Hemangioma Cyst0.954(0.943-0.963) 0.967(0.953-0.977)0.983(0.976-0.988) 0.913(0.894-0.930)0.968(0.962-0.973) 0.939(0.928-0.949)0.991(0.986-0.995) 도 11c에 도시된 바와 같이, 레이블 영상의 혈관종을 혈관종으로 올바르게 분류한 케이스는 1,771 케이스이고, 낭종으로 잘못 분류한 케이스는 86 케이스이다. 그리고, 레이블 영상의 낭종을 낭종으로 올바르게 분류한 케이 스는 908 케이스이고, 혈관종으로 잘못 분류한 케이스는 31 케이스이다. 이에 따라 [표 10]에 도시된 바와 같이 혈관종과 낭종 사이의 재현율은 0.954 ~ 0.967 사이임을 알 수 있다. 이는 HCC와 혈관종 사이의 분류 보다 낭종 과 혈관종 사이의 분류 성능이 훨씬 높다는 것을 나타낸다. 즉, 인공지능 모델이 혈관종과 낭종 사이를 잘 구분 한다는 의미이다. 상술한 바와 같이 개시된 본 발명의 바람직한 실시예들에 대한 상세한 설명은 당업자가 본 발명을 구현하고 실 시할 수 있도록 제공되었다. 상기에서는 본 발명의 바람직한 실시예들을 참조하여 설명하였지만, 해당 기술 분 야의 숙련된 당업자는 본 발명의 영역으로부터 벗어나지 않는 범위 내에서 본 발명을 다양하게 수정 및 변경시 킬 수 있음을 이해할 수 있을 것이다. 예를 들어, 당업자는 상술한 실시예들에 기재된 각 구성을 서로 조합하는 방식으로 이용할 수 있다. 따라서, 본 발명은 여기에 나타난 실시형태들에 제한되려는 것이 아니라, 여기서 개 시된 원리들 및 신규한 특징들과 일치하는 최광의 범위를 부여하려는 것이다. 본 발명은 본 발명의 정신 및 필수적 특징을 벗어나지 않는 범위에서 다른 특정한 형태로 구체화될 수 있다. 따 라서, 상기의 상세한 설명은 모든 면에서 제한적으로 해석되어서는 아니 되고 예시적인 것으로 고려되어야 한다. 본 발명의 범위는 첨부된 청구항의 합리적 해석에 의해 결정되어야 하고, 본 발명의 등가적 범위 내에서 의 모든 변경은 본 발명의 범위에 포함된다. 본 발명은 여기에 나타난 실시형태들에 제한되려는 것이 아니라, 여기서 개시된 원리들 및 신규한 특징들과 일치하는 최광의 범위를 부여하려는 것이다. 또한, 특허청구범위에서 명시적인 인용 관계가 있지 않은 청구항들을 결합하여 실시예를 구성하거나 출원 후의 보정에 의해 새로운 청구 항으로 포함할 수 있다.부호의 설명"}
{"patent_id": "10-2022-0105056", "section": "도면", "subsection": "도면설명", "item": 1, "content": "본 명세서에서 첨부되는 다음의 도면들은 본 발명의 바람직한 실시예를 예시하는 것이며, 후술하는 발명의 상세 한 설명과 함께 본 발명의 기술사상을 더욱 이해시키는 역할을 하는 것이므로, 본 발명은 그러한 도면에 기재된 사항에만 한정되어서 해석되어서는 아니된다. 도 1은 간 초음파 이미지를 본 발명에 따라 영상처리하는 과정을 나타내는 설명도, 도 2a는 본 발명에 따른 인공지능 모델이 실제 레이블(lable) 영상으로부터 예측(Predicted) 마스크를 생성하는 단계를 도식적으로 나타낸 상태도, 도 2b는 도 2a에서 생성된 예측 마스크에 경계상자를 그리는 상태도, 도 2c는 도 2b에서 그려진 경계상자의 이미지를 이용하여 간 병변을 분류하는 과정을 나타낸 상태도, 도 3a는 실제 레이블 영상의 경계상자와 인공지능 모델이 추론한 경계상자 사이의 IoU(Intersection Over Union) 임계값이 0.2 이상일 때 예측 마스크를 참 양성 예측(True Positive Prediction)으로 추론하는 이미지 의 일예, 도 3b는 실제 레이블 영상의 경계상자와 인공지능 모델이 추론한 경계상자 사이의 IoU 임계값이 0.2 보다 작을 때 예측 마스크를 오탐지(Miss-detection)로 추론하는 이미지의 일예, 도 4a는 간 초음파 이미지 중 간 병변으로 예측된 경계상자(Bounding Box)를 나타내는 이미지의 일예, 도 4b는 도 4a에서 예측된 경계상자를 정사각형으로 변환한 이미지의 일예, 도 4c는 도 4b에서 변환된 정사각형의 경계상자를 크롭(Crop)한 이미지의 일예, 도 5a는 경계상자의 IoU가 각각 0.121, 0.261, 0.397일 때 실제 레이블 영상과 인공지능 모델의 추론 이미지 사 이의 분할(segmentation)과 위치 검출(Detection)을 대비적으로 나타내는 일예, 도 5b는 경계상자의 IoU가 각각 0.487, 0.577, 0.624일 때 실제 레이블 영상과 인공지능 모델의 추론 이미지 사 이의 분할과 위치 검출을 대비적으로 나타내는 일예, 도 5c는 경계상자의 IoU가 각각 0.790, 0.834, 0.964일 때 실제 레이블 영상과 인공지능 모델의 추론 이미지 사 이의 분할과 위치 검출을 대비적으로 나타내는 일예, 도 6a 내지 도 6e는 폴드 1 내지 폴드 5에 대한 분류 결과를 나타내는 혼돈 행렬(Confusion matrix)의 일예, 도 7a 내지 도 7e는 폴드 1 내지 폴드 5에 대한 ROC(Receiver Operating Characteristic) 커브를 나타내는 그 래프의 일예, 도 8은 도 6a 내지 도 6e에 도시된 혼돈 행렬을 종합한 분류 결과의 혼돈 행렬, 도 9는 도 7a 내지 도 7e에 도시된 ROC 커브를 종합한 ROC 커브의 그래프, 도 10a 내지 도 10i는 실제 레이블의 간 병변과 본 발명의 인공지능 모델이 분류한 간 병변을 대비한 이미지, 도 11a는 간 병변 중 HCC와 혈관종 사이의 상호 분류를 나타내는 혼돈 행렬, 도 11b는 간 병변 중 HCC와 낭종 사이의 상호 분류를 나타내는 혼돈 행렬, 도 11c는 간 병변 중 혈관종과 낭종 사이의 상호 분류를 나타내는 혼돈 행렬, 도 12는 본 발명의 일 실시예에 따른 간 초음파 이미지를 이용하여 간 병변을 분류하는 인공지능 모델의 구축과 분류 방법을 개략적으로 나타내는 흐름도이다."}
