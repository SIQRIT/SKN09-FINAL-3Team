{"patent_id": "10-2024-0039241", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2024-0043735", "출원번호": "10-2024-0039241", "발명의 명칭": "영상 융합을 위한 신경 프로세싱 유닛 및 인공신경망 시스템", "출원인": "주식회사 딥엑스", "발명자": "김녹원"}}
{"patent_id": "10-2024-0039241", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "하나의 객체에 대해서 서로 상이한 해상도 및 서로 상이한 영상 특성을 가지는 제1 영상 및 제2 영상을 입력하여, 새로운 제3 영상을 출력하도록 학습된 하나의 영상 융합 인공신경망 모델의 머신 코드를 입력받도록 구성된제어부; 상기 영상 융합 인공신경망 모델에 대응되는 복수의 입력 신호를 수신하도록 구성된 입력 회로;상기 영상 융합 인공신경망 모델의 주 연산을 수행하도록 구성된 프로세싱 엘리먼트 어레이;상기 영상 융합 인공신경망 모델의 특수 기능 연산을 수행하도록 구성된 특수 기능 유닛 회로; 및 상기 영상 융합 인공신경망 모델의 상기 주 연산 및/또는 상기 특수 기능 연산의 데이터를 저장하도록 구성된온-칩 메모리; 를 포함하고,상기 제어부는, 상기 머신-코드에 포함된 영상 융합 인공신경망 모델의 데이터 지역성 정보에 따라 상기 영상융합 인공신경망 모델의 연산 순서가 기 설정된 순서대로 처리되도록, 상기 프로세싱 엘리먼트 어레이, 상기 특수 기능 유닛 회로 및 상기 온-칩 메모리를 제어하도록 구성되며, 상기 제3 영상의 제3 해상도는, 상기 제1 영상의 제1 해상도와 동일하거나 작지만, 상기 제2 영상의 제2 해상도보다 높은 값을 가지며, 상기 제3 영상의 제3 영상 특성은, 상기 제2 영상의 제2 영상 특성과 적어도 일부 동일한, 영상 융합을 위한 신경 프로세싱 유닛."}
{"patent_id": "10-2024-0039241", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서, 상기 제1 영상은, 가시광선 이미지 센서를 통해 획득되는 영상인, 영상 융합을 위한 신경 프로세싱 유닛."}
{"patent_id": "10-2024-0039241", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1항에 있어서, 상기 제2 영상은, 열화상 이미지 센서를 통해 획득되는 영상인, 영상 융합을 위한 신경 프로세싱 유닛."}
{"patent_id": "10-2024-0039241", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제1항에 있어서, 상기 제1 영상 및 상기 제2 영상은, 하나의 객체에 대한 서로 다른 영상을 포함하며,상기 영상 특성은, 상기 제1 영상 및 상기 제2 영상을 획득하는 이미지 센서의 종류에 의해 결정되는, 영상 융합을 위한 신경 프로세싱 유닛."}
{"patent_id": "10-2024-0039241", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제4항에 있어서, 상기 영상 융합 인공신경망 모델은, 상기 제1 영상 및 상기 제2 영상에서 추출된 객체에서, 얼굴 영역에 대응되는 제1 부분 영상 및 제2 부분 영상만을 입력하도록 구성된 인공신경명 모델인 것을 특징으로 하는, 영상 융합을 위한 신경 프로세싱 유닛."}
{"patent_id": "10-2024-0039241", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제1항에 있어서, 공개특허 10-2024-0043735-3-상기 제3 영상은, 상기 제1 영상의 적어도 일부 영역에 상기 제2 영상에서 결정 가능한 적어도 하나의 특징이적용된 영상인, 영상 융합을 위한 신경 프로세싱 유닛."}
{"patent_id": "10-2024-0039241", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제1항에 있어서, 상기 영상 융합 인공신경망 모델은, 상기 제1 영상에서 결정 가능한 적어도 하나의 특징과 상기 제2 영상에서 결정 가능한 적어도 하나의 특징을 강조하기 위한 가중치가 적용된 모델인 것을 특징으로 하는, 영상 융합을 위한 신경 프로세싱 유닛."}
{"patent_id": "10-2024-0039241", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제1항에 있어서, 상기 영상 융합 인공신경망 모델은, 상기 제1 영상의 RGB 값 또는 상기 제1 영상의 픽셀 별 밝기 값만을 입력하도록 구성된 인공신경망 모델인 것을특징으로 하는, 영상 융합을 위한 신경 프로세싱 유닛."}
{"patent_id": "10-2024-0039241", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제1항에 있어서, 상기 제3 영상의 상기 제3 해상도는, 상기 제1 영상의 상기 제1 해상도와 동일한, 영상 융합을 위한 신경 프로세싱 유닛."}
{"patent_id": "10-2024-0039241", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제1항에 있어서, 상기 영상 융합 인공신경망 모델은, GAN(generative adversarial networks) 구조를 기초로 학습되며, 하나의 객체에 대한 서로 다른 영상을 입력으로 하여 새로운 영상을 생성하도록 구성된 생성기 (generator) 에대응되는, 영상 융합을 위한 신경 프로세싱 유닛."}
{"patent_id": "10-2024-0039241", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "제10항에 있어서, 상기 영상 융합 인공신경망 모델은, 상기 GAN을 구성하는 상기 생성기 및 상기 생성기에서 생성된 영상을 검증하는 검증기 (discriminator) 가 상호경쟁하여 상기 제3 영상의 상기 제3 해상도를 높이기 위한 가중치를 업데이트하도록 구성된 인공신경명 모델인것을 특징으로 하는, 영상 융합을 위한 신경 프로세싱 유닛."}
{"patent_id": "10-2024-0039241", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제1항에 있어서, 상기 영상 융합 인공신경망 모델은, 상기 제1 영상 및 상기 제2 영상과 실질적으로 유사한 형식의 학습 데이터 세트를 기초로 학습되는, 영상 융합을 위한 신경 프로세싱 유닛."}
{"patent_id": "10-2024-0039241", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "제1항에 있어서, 상기 프로세싱 엘리먼트 어레이는, 공개특허 10-2024-0043735-4-합성곱, 및 활성화 함수 연산을 처리하도록 구성된, 영상 융합을 위한 신경 프로세싱 유닛."}
{"patent_id": "10-2024-0039241", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_14", "content": "제1항에 있어서, 상기 프로세싱 엘리먼트 어레이는, 상기 제3 영상의 상기 제3 해상도를 높이기 위한, 행렬 곱셈, Dilated Convolution, Transposed Convolution,및 Bilinear Interpolation 연산 중 적어도 하나의 연산을 처리하도록 구성된, 영상 융합을 위한 신경 프로세싱유닛."}
{"patent_id": "10-2024-0039241", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_15", "content": "제1항에 있어서, 상기 프로세싱 엘리먼트 어레이에 의해서 Classification, Semantic segmentation, Object detection, Poseestimation, 및 Prediction 중 적어도 하나의 추론 연산을 처리하도록 학습된 상기 영상 융합 인공신경망 모델의 상기 적어도 하나의 추론 연산 결과를 출력하도록 구성된 출력부를 더 포함하는, 영상 융합을 위한 신경 프로세싱 유닛."}
{"patent_id": "10-2024-0039241", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_16", "content": "제1항에 있어서, 상기 특수 기능 유닛 회로는, 인공신경망 퓨전을 위한, Skip-connection 및 Concatenation 중 적어도 하나의 기능을 더 포함하는, 영상 융합을 위한 신경 프로세싱 유닛."}
{"patent_id": "10-2024-0039241", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_17", "content": "제1항에 있어서, 상기 제어부는 스케줄러를 더 포함하고,상기 스케줄러는, 상기 영상 융합 인공신경망 모델의 데이터 지역성 정보에 기초하여 상기 온-칩 메모리에 저장된 특정 데이터를 상기 영상 융합 인공신경망 모델의 특정 연산 단계까지 보존하도록, 상기 온-칩 메모리를 제어하도록 구성된, 영상 융합을 위한 신경 프로세싱 유닛."}
{"patent_id": "10-2024-0039241", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_18", "content": "제1항에 있어서, 상기 프로세싱 엘리먼트 어레이는 복수의 쓰레드를 더 포함하고,상기 제어부는 상기 영상 융합 인공신경망 모델의 데이터 지역성에 기초하여 상기 영상 융합 인공신경망 모델의병렬 구간을 처리하도록 상기 복수의 쓰레드를 제어하도록 구성된 영상 융합을 위한 신경 프로세싱 유닛."}
{"patent_id": "10-2024-0039241", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_19", "content": "하나의 객체에 대해서 제1 해상도 및 제1 영상 특성을 가지는 제1 영상을 획득하는 제1 센서;상기 객체에 대해서 상기 제1 해상도보다 작은 제2 해상도 및 상기 제1 영상 특성과 상이한 제2 영상 특성을 가지는 제2 영상을 획득하는 제2 센서; 및서로 상이한 해상도 및 영상 특성을 가지는 제1 영상 및 제2 영상을 입력하여, 새로운 제3 영상을 출력하도록학습된 하나의 영상 융합 인공신경망 모델을 처리하도록 구성된 신경 프로세싱 유닛; 을 포함하고, 상기 제3 영상의 제3 해상도는, 상기 제1 영상의 제1 해상도와 동일하거나 작지만, 상기 제2 영상의 제2 해상도보다 높은 값을 가지며, 상기 제3 영상의 제3 영상 특성은, 상기 제2 영상의 제2 영상 특성과 적어도 일부 동일한, 영상 융합을 위한 인공신경망 시스템.공개특허 10-2024-0043735-5-"}
{"patent_id": "10-2024-0039241", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 개시의 일 개시에 따르면, 영상 융합 인공신경망 모델을 위한 신경 프로세싱 유닛이 제공된다. 상기 신경 프 로세싱 유닛은, 서로 상이한 해상도 및 영상 특성을 가지는 제1 영상 및 제2 영상을 입력하여, 새로운 제3 영상 을 출력하도록 학습된 영상 융합 인공신경망 모델의 머신 코드를 입력받도록 구성된 제어부; 상기 영상 융합 인 (뒷면에 계속)"}
{"patent_id": "10-2024-0039241", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 개시는 영상 융합을 위한 신경 프로세싱 유닛 및 인공신경망 시스템에 관한 것이다."}
{"patent_id": "10-2024-0039241", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "열화상 이미지 센서는 촬영 시 외부에서 별도로 공급되는 광원이 없더라도 물체가 방사하는 복사 에너지를 모아 가시화하는 방식으로 열화상 영상(열영상)을 제공한다. 열영상은 적외선 주파수 대역에 따라 크게 NIR(near-infrared), SWIR(short-wave infrared), MWIR(medium-wave infrared), LWIR(long-wave infrared) 등으로 나뉜다. LWIR은 과거에 주로 군사용, 의료용과 같은 특수분야에 서 많이 사용되었다. 최근에는 열영상의 활용분야가 증가하여 사물 및 자동차의 야간물체 인식 목적으로도 사 용되고 있다. 특히, 야간에는 물체에 대한 인식 기술에서 열영상의 화질이 매우 중요하다. 그러나 해상도에 따라, 열화상 이 미지 센서의 가격 편차가 크기 때문에, 고해상도 적외선 이미지 센서는 경제적인 측면에서 부담이 된다. 그에 따라, 최근에는 인공 지능 기반의 학습 알고리즘을 통해 저해상도 열화상 센서에서 획득한 영상의 해상도 를 확대(upscaling)하는 초고해상도(super-resolution: SR) 기술이 개시되고 있다. 그러나, 열영상을 단일 입력 데이터로 사용할 경우, 일반적인 가시광 이미지 센서에서 획득 가능한 영상의 질감 정보를 고해상도로 표현하기에 한계가 있다. 이에, 이종의 영상을 입력 데이터로 하여, 이를 융합하기 위한 기 술이 개발되고 있다. 다만, 종래의 영상 융합 기술은 동기화 및 정합을 프레임 단위로 수행하는 과정에서 그 연 산량이 지나치게 커지는 문제점이 있다. 본 개시의 배경이 되는 기술은 본 개시에 대한 이해를 보다 용이하게 하기 위해 작성되었다. 본 개시의 배경이 되는 기술에 기재된 사항들이 선행기술로 존재한다고 인정하는 것으로 이해되어서는 안 된다."}
{"patent_id": "10-2024-0039241", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "이에, 이종의 이미지 센서로부터 획득되는 영상을 기초로 두 개의 특징을 융합한 하나의 영상을 생성하되, 그 연산량은 최소화하기 위한 신경 프로세싱 유닛(Neural Processing Unit: NPU) 및 이를 포함하는 인공신경망 시 스템이 요구된다. 본 개시의 발명자들은 하나의 객체에 대한 서로 다른 해상도 및 영상 특성을 가진 영상들을 조합하여, 상위 해 상도를 만족하는 하나의 영상을 생성하기 위한 인공신경망 모델을 효과적으로 처리할 수 있는 신경 프로세싱 유 닛 및 인공신경망 시스템을 개발하고자 하였다. 특히, 본 개시의 발명자들은 서로 다른 데이터를 효과적으로 처리 가능한 연접(concatenation) 동작, 건너뛰고 연결하기 (skip-connection) 동작을 수행하여, 고해상도의 영상을 빠르게 생성할 수 있는 신경 프로세싱 유닛 및 인공신경망 시스템을 개발하기에 이르렀다. 본 개시의 과제들은 이상에서 언급한 과제들로 제한되지 않으며, 언급되지 않은 또 다른 과제들은 아래의 기재 로부터 당업자에게 명확하게 이해될 수 있을 것이다."}
{"patent_id": "10-2024-0039241", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "전술한 바와 같은 과제를 해결하기 위해 영상 융합 인공신경망 모델을 위한 신경 프로세싱 유닛이 제공된다. 상 기 영상 융합 인공신경망 모델을 위한 신경 프로세싱 유닛은, 하나의 객체에 대해서 서로 상이한 해상도 및 서 로 상이한 영상 특성을 가지는 제1 영상 및 제2 영상을 입력하여, 새로운 제3 영상을 출력하도록 학습된 영상 융합 인공신경망 모델의 머신 코드를 입력받도록 구성된 제어부; 상기 영상 융합 인공신경망 모델에 대응되는 복수의 입력 신호를 수신하도록 구성된 입력 회로; 상기 영상 융합 인공신경망 모델의 주 연산을 수행하도록 구 성된 프로세싱 엘리먼트 어레이; 상기 영상 융합 인공신경망 모델 연산의 특수 기능 연산을 수행하도록 구성된 특수 기능 유닛 회로; 및 상기 영상 융합 인공신경망 모델의 상기 주 연산 및/또는 상기 특수 기능 연산의 데이터를 저장하도록 구성된 온-칩 메모리; 를 포함하고, 상기 제어부는, 상기 머신-코드에 포함된 영상 융합 인공 신경망 모델의 데이터 지역성 정보에 따라 상기 영상 융합 인공신경망 모델의 연산 순서가 기 설정된 순서대로 처리되도록, 상기 프로세싱 엘리먼트 어레이, 상기 특수 기능 유닛 회로 및 상기 온-칩 메모리를 제어하도록 구 성되며, 상기 제3 영상의 제3 해상도는, 상기 제1 영상의 제1 해상도와 동일하거나 작지만, 상기 제2 영상의 제 2 해상도 보다 높은 값을 가지며, 상기 제3 영상의 제3 영상 특성은, 상기 제2 영상의 제2 영상 특성과 적어도 일부 동일할 수 있다. 본 개시의 다른 개시에 따르면, 영상 융합 인공신경망 모델을 위한 시스템이 제공된다. 상기 시스템은, 하나의 객체에 대해서 제1 해상도 및 제1 영상 특성을 가지는 제1 영상을 획득하는 제1 센서; 상기 객체에 대해서 상기 제1 해상도보다 작은 제2 해상도 및 상기 제1 영상 특성과 상이한 제2 영상 특성을 가지는 제2 영상을 획득하는 제2 센서; 및 서로 상이한 해상도 및 영상 특성을 가지는 제1 영상 및 제2 영상을 입력하여, 새로운 제3 영상을 출력하도록 학습된 영상 융합 인공신경망 모델을 처리하도록 구성된 신경 프로세싱 유닛; 을 포함하고, 상기 제 3 영상의 제3 해상도는, 상기 제1 영상의 제1 해상도와 동일하거나 작지만, 상기 제2 영상의 제2 해상도 보다 높은 값을 가지며, 상기 제3 영상의 제3 영상 특성은, 상기 제2 영상의 제2 영상 특성과 적어도 일부 동일할 수 있다. 기타 예시의 구체적인 사항들은 상세한 설명 및 도면들에 포함되어 있다."}
{"patent_id": "10-2024-0039241", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 개시는 인공신경망 모델을 통해 고해상도의 열영상을 생성할 수 있다. 특히, 본 개시는 감시 카메라와 같이 불특정 다수의 사람을 촬영하기 위한 장치에서 고해상도의 열영상만을 생성하여 저장함으로써, 개인정보가 노출 되는 문제를 예방할 수 있다. 뿐만 아니라, 본 개시는, 사람의 얼굴 영역에만 열영상을 융합하여, 개인정보를 보호할 수 있다. 또한, 전문 디바이스가 아닌, 일반 디바이스에 내장되는 고해상도의 일반 가시광 이미지 센서와 저해상도의 열 영상 이미지 센서를 활용하여, 고해상도의 열영상을 생성할 수 있다. 이에 본 개시는 저비용으로 고해상도의 열 영상을 생성할 수 있다. 뿐만 아니라, 본 개시는 야간 식별을 위해 만들어진 디바이스가 아닌, 예를 들어, 사용 자 소지의 디바이스나 차량의 블랙박스 등에서도 영상의 야간 식별력을 향상시킬 수 있다. 또한, 본 개시는 기상 상황이 좋지 않은 날에도, 대상체를 관찰하기 위한 고해상도의 열영상을 생성할 수 있다. 뿐만 아니라, 본 개시는 이미지 센서 외에 대상체를 감지하기 위해 사용되는 레이저 센서, 전자기파 센서 및 초 음파 센서 등의 감도가 떨어지는 날에도, 대상체에 대한 고해상도의 열영상을 생성할 수 있다. 이에, 본 개시의 신경 프로세싱 유닛이 차량에 설치되어, 차량의 안전 사고를 예방할 수 있다. 또한, 본 개시는 고해상도의 열영상을 이용하여 사용자의 움직임을 추정(skeleton detection 또는 pose estimation)할 수 있다. 예를 들어, 본 개시는 특정 공간에 설치된 디바이스를 통해 사용자의 비정상적인 움직 임을 추정하거나, 사용자의 넘어짐을 추정할 수 있다. 또한, 본 개시는 이종의 이미지 센서로부터 획득한 영상을 토대로 새로운 영상을 생성하는 영상 융합 인공신경 망 모델을 구현하기 위한 신경 프로세싱 유닛이 보다 효율적으로 동작할 수 있도록 제어할 수 있다. 이에, 본 개시는 방대한 양의 데이터를 처리함에도 전력 소모를 절감할 수 있다. 이에 본 개시는 배터리 용량에 제한 받 지 않고, 다양한 디바이스에서 영상 융합 인공신경망 모델을 구현할 수 있다. 또한, 본 개시는 연접(concatenation) 동작, 건너뛰고 연결하기 (skip-connection) 동작을 통해 이종의 센싱 데이터를 효과적으로 처리할 수 있다. 이에 본 개시는 고해상도의 열영상을 연산량을 절감하면서도 빠르게 생성 할 수 있다. 또한, 본 개시는 온-칩 메모리에 저장된 데이터를 최대한 재사용하여, 고해상도의 영상을 융합하기 위해 필요한 데이터를 외부 메모리에서 획득하는 동안 소모되는 전력을 최소화할 수 있다. 본 개시에 따른 효과는 이상에서 예시된 내용에 의해 제한되지 않으며, 더욱 다양한 효과들이 본 개시 내에 포 함되어 있다."}
{"patent_id": "10-2024-0039241", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "본 개시의 이점 및 특징, 그리고 그것들을 달성하는 방법은 첨부되는 도면과 함께 상세하게 후술되어 있는 예시 들을 참조하면 명확해질 것이다. 그러나, 본 개시는 이하에서 개시되는 예시들에 한정되는 것이 아니라 서로 다른 다양한 형태로 구현될 것이다. 본 예시들은 본 개시의 개시가 완전하도록 하며, 본 개시가 속하는 기술분 야에서 통상의 지식을 가진 자에게 발명의 범주를 완전하게 알려주기 위해 제공되는 것이다. 본 개시는 청구항 의 범주에 의해 정의될 뿐이다. 도면의 설명과 관련하여, 유사한 구성요소에 대해서는 유사한 참조부호가 사용 될 수 있다.본 개시에서, \"가진다,\" \"가질 수 있다,\" \"포함한다,\" 또는 \"포함할 수 있다\" 등의 표현은 해당 특징(예: 수치, 기능, 동작, 또는 부품 등의 구성요소)의 존재를 가리키며, 추가적인 특징의 존재를 배제하지 않는다. 본 개시에서, \"A 또는 B,\" \"A 또는/및 B 중 적어도 하나,\" 또는 \"A 또는/및 B 중 하나 또는 그 이상\" 등의 표현 은 함께 나열된 항목들의 모든 가능한 조합을 포함할 수 있다. 예를 들면, \"A 또는 B,\" \"A 및 B 중 적어도 하 나,\" 또는 \"A 또는 B 중 적어도 하나\"는, 적어도 하나의 A를 포함, 적어도 하나의 B를 포함, 또는 적어도 하나의 A 및 적어도 하나의 B 모두를 포함하는 경우를 모두 지칭할 수 있다. 본 개시에서 사용된 \"제1,\" \"제2,\" \"첫째,\" 또는 \"둘째,\" 등의 표현들은 다양한 구성요소들을, 순서 및/또는 중 요도에 상관없이 수식할 수 있고, 한 구성요소를 다른 구성요소와 구분하기 위해 사용될 뿐 해당 구성요소들을 한정하지 않는다. 예를 들면, 제1 사용자 기기와 제2 사용자 기기는, 순서 또는 중요도와 무관하게, 서로 다른 사용자 기기를 나타낼 수 있다. 예를 들면, 본 개시에 기재된 권리범위를 벗어나지 않으면서 제1 구성요소는 제2 구성요소로 명명될 수 있고, 유사하게 제2 구성요소도 제1 구성요소로 바꾸어 명명될 수 있다. 어떤 구성요소(예: 제1 구성요소)가 다른 구성요소(예: 제2 구성요소)에 \"(기능적으로 또는 통신적으로) 연결되 어((operatively or communicatively) coupled with/to)\" 있다거나 \"접속되어(connected to)\" 있다고 언급된 때에는, 상기 어떤 구성요소가 상기 다른 구성요소에 직접적으로 연결되거나, 다른 구성요소(예: 제3 구성요 소)를 통하여 연결될 수 있다고 이해되어야 할 것이다. 반면에, 어떤 구성요소(예: 제1 구성요소)가 다른 구성 요소(예: 제2 구성요소)에 \"직접 연결되어\" 있다거나 \"직접 접속되어\" 있다고 언급된 때에는, 상기 어떤 구성요 소와 상기 다른 구성요소 사이에 다른 구성요소(예: 제3 구성요소)가 존재하지 않는 것으로 이해될 수 있다. 본 개시에서 사용된 표현 \"~하도록 구성된(또는 설정된)(configured to)\"은 상황에 따라, 예를 들면, \"~에 적합 한(suitable for),\" \"~하는 능력을 가지는(having the capacity to),\" \"~하도록 설계된(designed to),\" \"~하도 록 변경된(adapted to),\" \"~하도록 만들어진(made to),\" 또는 \"~ 를 할 수 있는(capable of)\"과 바꾸어 사용될 수 있다. 용어 \"~하도록 구성된(또는 설정된)\"은 하드웨어적으로 \"특별히 설계된(specifically designed to)\" 것 만을 반드시 의미하지 않을 수 있다. 대신, 어떤 상황에서는, \"~하도록 구성된 장치\"라는 표현은, 그 장치 가 다른 장치 또는 부품들과 함께 \"~할 수 있는\" 것을 의미할 수 있다. 예를 들면, 문구 \"A, B, 및 C를 수행하 도록 구성된(또는 설정된)프로세서\"는 해당 동작을 수행하기 위한 전용 프로세서(예: 임베디드 프로세서), 또는 메모리 장치에 저장된 하나 이상의 소프트웨어 프로그램들을 실행함으로써, 해당 동작들을 수행할 수 있는 범용 프로세서(generic-purpose processor)(예: CPU 또는 application processor)를 의미할 수 있다. 본 개시에서 사용된 용어들은 단지 특정한 예시를 설명하기 위해 사용된 것으로, 다른 예시의 범위를 한정하려 는 의도가 아닐 수 있다. 단수의 표현은 문맥상 명백하게 다르게 뜻하지 않는 한, 복수의 표현을 포함할 수 있"}
{"patent_id": "10-2024-0039241", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "다. 기술적이거나 과학적인 용어를 포함해서 여기서 사용되는 용어들은 본 개시에 기재된 기술분야에서 통상의 지식을 가진 자에 의해 일반적으로 이해되는 것과 동일한 의미를 가질 수 있다. 본 개시에 사용된 용어들 중 일 반적인 사전에 정의된 용어들은, 관련 기술의 문맥상 가지는 의미와 동일 또는 유사한 의미로 해석될 수 있다. 또한, 일반적인 사전에 정의된 용어들은 본 개시에서 명백하게 정의되지 않는 한, 이상적이거나 과도하게 형식 적인 의미로 해석되지 않는다. 경우에 따라서, 본 개시에서 정의된 용어일지라도 본 개시의 예시들을 배제하도 록 해석될 수 없다. 본 개시의 여러 예시들의 각각 특징들이 부분적으로 또는 전체적으로 서로 결합 또는 조합 가능하다. 본 개시의 여러 예시들의 각각 특징들은 당업자가 충분히 이해할 수 있듯이 기술적으로 다양한 연동 및 구동이 가능하며, 각 예시들이 서로에 대하여 독립적으로 실시 가능할 수도 있고 연관 관계로 함께 실시 가능할 수도 있다. 본 개시의 해석의 명확함을 위해, 이하에서는 본 개시에서 사용되는 용어들을 정의하기로 한다. NPU는 신경 프로세싱 유닛(Neural Processing Unit)의 약어로서, CPU(Central processing unit)과 별개로 인공 신경망 모델의 연산을 위해 특화된 프로세서를 의미할 수 있다. ANN은 인공신경망(artificial neural network)의 약어로서, 인간의 지능을 모방하기 위하여, 인간 뇌 속의 뉴런 들(Neurons)이 시냅스(Synapse)를 통하여 연결되는 것을 모방하여, 노드들을 레이어(Layer: 계층) 구조로 연결 시킨, 네트워크를 의미할 수 있다. *인공신경망 모델은 영상을 융합하기 위한 모델로, Image/Video Reconstruction, Image/Video Enhancement와 같은 추론을 수행하도록 훈련된 모델일 수 있다. 또한, 융합된 영상을 입력으로 하는 다른 인공신경망 모델은 Object Classification, Object Detection, Object Segmentation, Object Tracking, Event Recognition, Event Prediction, Anomaly Detection, Density Estimation, Event Search, Measurement 등의 추론을 수행하도록 훈련된 모델일 수 있다. 예를 들면, 인공신경망 모델은 Transformer, Bisenet, Shelfnet, Alexnet, Densenet, Efficientnet, EfficientDet, Googlenet, Mnasnet, Mobilenet, Resnet, Shufflenet, Squeezenet, VGG, Yolo, RNN, CNN, DBN, RBM, LSTM 등의 모델일 수 있다. 단, 본 개시는 이에 제한되지 않으며, NPU에서 동작 가능한 이 외의 새로 운 인공신경망 모델일 수 있다. 인공신경망의 구조에 대한 정보는 레이어의 개수에 대한 정보, 레이어 내의 노드의 개수, 각 노드의 값, 연산 처리 방법에 대한 정보, 각 노드에 적용 되는 가중치 행렬에 대한 정보 등을 포함한다. 영상 융합 인공신경망 모델의 데이터 지역성에 대한 정보는 인공신경망 및 인공신경망을 처리하는 신경 프로세 싱 유닛의 구조에 기초하여 결정된 메모리에 요청하는 데이터 접근 요청 순서를 포함하는 정보이다. DNN은 심층 신경망(Deep Neural Network)의 약어로서, 보다 높은 인공 지능을 구현하기 위하여, 인공신경망의 은닉 레이어의 개수를 늘린 것을 의미할 수 있다. CNN은 컨볼루션 신경망(Convolutional Neural Network)의 약어로서, 인간 뇌의 시각 피질에서 영상을 처리하는 것과 유사한 기능을 하는 신경망이다. 컨볼루션 신경망은 영상처리에 적합한 것으로 알려져 있으며, 입력 데이 터의 특징들을 추출하고, 특징들의 패턴을 파악하기에 용이한 것으로 알려져 있다. 커널은 CNN에 적용되는 가중치 행렬을 의미할 수 있다. 칩-외부 메모리는 NPU 내부에는 메모리 크기가 한정적임을 고려하여 배치된 메모리일 수 있다. 즉, 용량이 큰 데이터 저장을 위해서 칩 외부에 메모리가 배치될 수 있다. 칩-외 부 메모리는 ROM, SRAM, DRAM, Resistive RAM, Magneto-resistive RAM, Phase- change RAM, Ferroelectric RAM, Flash Memory, HBM 등과 같은 메모리 중 하나의 메모리를 포함할 수 있다. 칩-외부 메모리는 적어도 하나의 메모리 유닛으로 구성될 수 있다. 칩-외 부 메모리는 단일 (homogeneous) 메모리 유닛 또는 이종 (heterogeneous) 메모리 유닛으로 구성될 수 있다. 칩-내부 메모리는 NPU는 칩-내부 메모리를 포함할 수 있다. 칩-내부 메모리는 휘발성 메모리 및/또는 비휘발성 메모리를 포함할 수 있다. 예를 들면, 칩-내부 메모리는 ROM, SRAM, DRAM, Resistive RAM, Magneto-resistive RAM, Phase-change RAM, Ferroelectric RAM, Flash Memory, HBM 등과 같은 메모리 중 하나의 메모리를 포함할 수 있다. 칩-내부 메모리는 적어도 하나의 메모리 유닛으로 구성될 수 있다. 칩-내부 메모리는 단일 (homogeneous) 메모리 유닛 또는 이종 (heterogeneous) 메모리 유닛으로 구성될 수 있다. 이하, 첨부한 도면을 참조하여 본 개시의 일 예시를 상세히 설명하도록 한다. 도 1 및 도 2는 본 개시의 일 예시에 따른 영상 융합 인공신경망 모델을 설명하는 개략적인 개념도이다. 도 1을 참조하면, 신경 프로세싱 유닛은 영상 융합 인공신경망 모델의 연산을 수행하도록 구성된 프 로세싱 엘리먼트를 포함한다. 신경 프로세싱 유닛은 두 개의 영상(제1 영상, 제2 영상)을 기초로 새 로운 영상(제3 영상)을 생성할 수 있다. 제1 영상 및 제2 영상은 하나의 객체에 대한 서로 다른 영상으로, 이종 의 센서에서 획득된 영상일 수 있다. 예를 들어, 이종의 센서는 가시광선 촬영용 이미지 센서, 적외선 촬영용 이미지 센서 등일 수 있다. 가시광선 촬영용 이미지 센서는 R(Red, 적색), G(Green, 녹색), B(Blue, 청색) 픽셀을 통해 가시광 영역의 컬러 영상(color image)(제1 영상)을 획득한다. 적외선 촬영용 이미지 센서는 픽셀을 통해 열영상(Thermal color map)(제2 영상)을 획득할 수 있다. 일반적으로, 적외선 촬영용 이미지 센서는 가시광선보다 파장이 큰 에너지를 감지하기 때문에, 동일한 크기의 센서라도 픽셀 수, 즉 해상도가 낮을 수 밖에 없다. 본 개시에서는 높은 해상 도의 적외선 촬영용 이미지 센서를 이용하지 않고도, 영상 융합 인공신경망 모델을 통해 가시광선 촬영용 이미지 센서의 해상도를 만족하는 제3 영상을 생성할 수 있다. 이에, 신경 프로세싱 유닛은 서로 다른 해상도 및 영상 특성을 가지는 제1 영상 및 제2 영상을 입력하여, 새로운 제3 영상을 출력하도록 학습된 모델일 수 있다. 제3 영상은 제3 해상도는 제1 영상의 제1 해상도와 제2 영상의 제2 해상도 사이의 값을 가질 수 있다. 예를 들어, 제3 영상의 제3 해상도는 제1 영상의 제1 해상도와 동일할 수 있다. 또한, 제3 영상의 제3 영상 특성은, 제1 영상의 영상 특성 또는 제2 영상의 제2 영상 특성과 적어도 일부 동일할 수 있다. 예를 들어, 제1 영상의 RGB 채널 각각의 제1 해상도가 1024 x 786이고, 제2 영상의 열화상 채널 제2 해상도가 100 x 60일 때, 제3 영상의 제3 해상도는 1024 x 786일 수 있다. 즉, 제3 영상의 해상도는 제1 영상의 사이즈 및 제1 해상도와 동일하고, 제3 영상 특성에는 제2 영상 특성에 대응되는 열영상이 적용될 수 있다. 다른 예시에서, 신경 프로세싱 유닛은 영상 융합 인공신경망 모델이 상이한 입력 데이터를 이용할 수 있다. 구체적으로, 제1 영상이 컬러 영상인 경우, 신경 프로세싱 유닛의 처리 속도가 증가할 수 있다. 그 에 따라, 영상 융합 인공신경망 모델은 제1 영상의 픽셀 별 밝기 값 만을 입력으로 하여, 컬러 영상을 입 력으로 한 것과 동일한 제3 영상을 생성하면서도 신경 프로세싱 유닛의 처리 속도를 단축시킬 수 있다. 즉, 영상 융합 인공신경망 모델은 제1 영상의 RGB 값(3 channel) 또는 제1 영상의 픽셀 별 밝기 값(1 channel)만을 입력하도록 구성된 모델일 수 있다. 이와 같이, 서로 다른 영상들의 특성을 조합하여 새로운 영상 생성이 가능한 영상 융합 인공신경망 모델의 가중치 파라미터는 GAN(generative adversarial networks) 구조를 기초로 학습될 수 있다. GAN 구조는 가상의 영상 또는 실제 영상을 생성하는 생성기(generator)와 생성기에서 생성된 영상의 진위 여부를 판별하는 검증기 (discriminator)로 구성된다. GAN은 생성기와 검증기가 서로의 성능을 개선하도록 적대적으로 경쟁해 나가는 모 델일 수 있다. 구체적으로, 생성기는 실제 영상(real data)를 검증기에 제공하여 검증기가 해당 영상을 진짜로 판별하도록 학습하고, 두 번째로 생성기에서 생성한 가상의 영상(fake data)를 입력하여 검증기가 해당 영상을 가짜로 판별하도록 학습할 수 있다. 그리고, 생성기는 이 후 검증기를 속이기 위한 가상의 영상을 만들어 내도 록 학습함으로써, 서로 간의 경쟁에 따라 조화로운 영상을 생성하도록 발전할 수 있다. 즉, 학습 단계에서, 영상 융합 인공신경망 모델은 GAN을 구성하는 생성기 및 검증기가 상호 경쟁하여 제3 영상의 제3 해상도를 높이기 위한 가중치를 업데이트하도록 구성된 모델일 수 있다. 본 개시에서는 신경 프로세싱 유닛의 메모리 사용량을 최소화하기 위해 분류기(generator)를 통한 영상 생 성 학습은 별도의 장치/서버(미도시)에서 수행할 수 있다. 그리고, 신경 프로세싱 유닛이 연산하는 영상 융합 인공신경망 모델은 하나의 객체에 대한 서로 다른 영상(예. 1. 고해상도 가시광 영상, 2. 저해상도 열영상)을 입력으로 하여 새로운 영상(예. 고해상도 열영상)을 생성하도록 구성된 생성기(generator)에 대응될 수 있다. 한편, 영상 융합 인공신경망 모델은 제1 영상 및 제2 영상과 실질적으로 유사한 학습 데이터를 세트를 기 초로 학습될 수 있다. 즉, 학습에 사용되는 영상과 이후, 새로운 영상 생성을 위해 수신되는 영상은 상이할 수 있다. 이하, 영상 융합 인공신경망 모델을 통해 생성되는 영상을 예시적으로 설명한다. 도 3 및 도 4는 본 개시의 일 예시에 따른 영상 융합 인공신경망 모델을 통해 생성된 영상을 설명하는 개략적인 개념도이다. 도 3을 참조하면, 영상 융합 인공신경망 모델은 이종의 센서에서 획득된 영상들을 입력으로 할 수 있다. 예를 들어, 이종의 센서는 가시광 촬영용 이미지 센서, 적외선 촬영용 이미지 센서 등일 수 있다. 영상 융합 인공신 경망 모델은 하나의 객체에 대해 서로 다른 이미지 센서로 획득된 제1 영상 및 제2 영상을 입력으로 할 수 있다. 그리고, 영상 융합 인공신경망 모델은 이종의 이미지 센서에서 획득된 영상들을 기초로 이미지 센서 별 영상 특성이 융합된 영상을 생성할 수 있다. 즉, 영상 융합 인공신경망 모델은 제1 영상의 사이즈, 해상도는 유 지하면서, 제2 영상의 온도 정보(제2 영상 특성)가 반영된 제3 영상을 생성할 수 있다. 다른 예시에서, 영상 융합 인공신경망 모델은 제1 영상에서 결정 가능한 적어도 하나의 특징과 제2 영상에서 결 정 가능한 적어도 하나의 특징을 강조하기 위한 가중치가 적용된 모델일 수 있다. 구체적으로, 신경 프로세싱 유닛은 제1 영상과 제2 영상의 특징을 생성할 수 있다. 일 예로, 신경 프로세싱 유닛은 컬러 영상인, 제1 영상에서 고해상도의 엣지 컨텐츠의 특징을 추론한 특징맵을 생성할 수 있다. 특징맵은 히트맵(heatmap), 활성화맵, 또는 파라미터 등으로 지칭될 수 있다. 또한, 신경 프로세싱 유닛은 열영상인, 제2 영상에서 온도에 따른 세그멘테이션을 추론한 특징맵을 생성할 수 있다. 이어서 고해상도의 엣지 특징맵과 저해상도의 온도 세그멘테이선 특징맵을 기초로 고해상도의 열영상 의 영상 융합을 처리할 수 있다. 몇몇 예시로는, 신경 프로세싱 유닛은 제1 영상의 특징으로 객체의 존재를 더 검출할 수 있고, 제2 영상의 특징으로, 온도가 임계 값 이상인 영역을 결정할 수 있다. 그에 따라, 영상 융합 인공신경망 모델은 각각의 영상에서 결정 가능한 특징에 가중치를 적용한 새로운 영상을 생성할 수 있다. 예를 들어, 도 4와 같이, 신경 프 로세싱 유닛은 제1 영상 내 객체(사람)를 검출하고, 객체가 검출된 영역 내에서 특정 온도 이상인 영역만 열 영상화할 수 있다. 즉, 신경 프로세싱 유닛은 제1 영상의 적어도 일부 영역에 제2 영상에서 결정 가능 한 적어도 하나의 특징이 적용된 제3 영상 생성할 수 있다. 한편, 이와 같이 일부 영역에 한정된 고해상도의 열 영상을 생성하기 위해, 신경 프로세싱 유닛의 프로세 싱 엘리먼트 어레이는 Dilated Convolution, Transposed Convolution, 및 Bilinear Interpolation 연산 중 적 어도 하나의 연산을 처리하도록 구성될 수 있다. 또 다른 예시에서, 신경 프로세싱 유닛은 하나의 객체를 촬영한 제1 영상 및 제 2 영상에서 얼굴 영역에 대응되는 제1 부분 영상 및 제2 부분 영상을 추출할 수 있다. 그에 따라, 신경 프로세싱 유닛은 제1 부분 영상 및 제2 부분 영상만을 입력하도록 구성된 인공신경망 유닛을 이용하여 얼굴에만 영상 특징의 융합된 영상 을 생성할 수도 있다. 이와 같이, 신경 프로세시 유닛이 사람의 얼굴 영역에만 상이한 영상 특징을 적용시킨 영상을 융합 생성함 으로써, 개인정보를 보호할 수 있다. 이하, 영상 융합 인공신경망 모델의 연산을 수행하는 신경 프로세싱 유닛에 대하여 설명한다. 도 5는 본 개시의 일 예시에 따른 신경 프로세싱 유닛을 설명하는 개략적인 개념도이다. 도 5에 도시된, NPU는 영상 융합 인공신경망 모델을 위한 동작을 수행하도록 특화된 프로세서이다. 인공신경망은 여러 입력 또는 자극이 들어오면 각각 가중치를 곱해 더해주고, 추가적으로 편차를 더한 값을 활 성화 함수를 통해 변형하여 전달하는 인공 뉴런들이 모인 네트워크를 의미한다. 이렇게 학습된 인공신경망은 입 력 데이터로부터 추론(inference) 결과를 출력하는데 사용될 수 있다. NPU는 전기/전자 회로로 구현된 반도체일 수 있다. 전기/전자 회로라 함은 수많은 전자 소자, (예컨대 트 렌지스터, 커패시터)를 포함하는 것을 의미할 수 있다. 도 5를 참조하면, NPU는 프로세싱 엘리먼트(processing element: PE) 레이, NPU 내부 메모리, NPU 스케줄러, 및 NPU 인터페이스를 포함할 수 있다. 프로세싱 엘리먼트 어레이, NPU 내부 메모 리, NPU 스케줄러, 및 NPU 인터페이스 각각은 수많은 트렌지스터들이 연결된 반도체 회로일 수 있다. 따라서, 이들 중 일부는 육안으로는 식별되어 구분되기 어려울 수 있고, 동작에 의해서만 식별될 수 있다. 예컨대, 임의 회로는 프로세싱 엘리먼트 어레이으로 동작하기도 하고, 혹은 NPU 스케줄러로 동 작될 수도 있다. NPU 스케줄러는 NPU의 인공신경망 추론 동작을 제어하도록 구성된 제어부의 기능을 수행하도록 구성될 수 있다. 부연 설명하면, 제어부의 일부는 스케줄러로 지칭될 수 있다. NPU 스케줄러 는 제어부의 일부일 수 있다. NPU 스케줄러는 제어부로 지칭되는 것도 가능하다. 제어부는 NPU 스케 줄러를 포함할 수 있다. 제어부는 direct memory access(DMA) 등 NPU의 다양한 제어 기능들을 하는 회로의 통칭일 수 있다. 회로의 기능에 의해서 제어부가 정의되는 것도 가능하다. 부연 설명하면, 제어부가 인 공신경망 모델의 인공신경망 데이터 지역성에 기초하여 인공신경망 모델의 각 연산 단계의 순서에 따라 프로세 싱 엘리먼트 어레이를 제어하는 회로를 NPU 스케줄러로 정의할 수 있다. NPU는 프로세싱 엘리먼트 어레이, 프로세싱 엘리먼트 어레이에서 추론될 수 있는 영상 융합 인 공신경망 모델을 저장하도록 구성된 NPU 내부 메모리, 및 영상 융합 인공신경망 모델의 인공신경망 데이터 지역성 정보 또는 구조에 대한 정보에 기초하여 프로세싱 엘리먼트 어레이 및 NPU 내부 메모리를 제 어하도록 구성된 NPU 스케줄러를 포함할 수 있다. 여기서, NPU 내부 메모리는 영상 융합 인공신경망 모델의 인공신경망 데이터 지역성 정보 또는 구조에 대한 정보를 저장할 수 있다. 즉, 영상 융합 인공신경망 모 델은 특정 추론 기능(예컨대, 영상 융합, 객체의 움직임, 객체의 자세, 동작 추적 등)을 수행하도록 학습된 AI 인식모델을 의미할 수 있다. 프로세싱 엘리먼트 어레이는 인공신경망을 위한 동작을 수행할 수 있다. NPU 인터페이스는 시스템 버스(예컨대, 하나 이상의 통신 버스 또는 신호 라인)를 통해서 NPU와 연결 된 다양한 컴포넌트들, 예컨대 메모리와 통신할 수 있다. NPU 스케줄러는 신경 프로세싱 유닛의 추론 연산을 위한 프로세싱 엘리먼트 어레이의 연산 및 NPU 내부 메모리의 읽기 및 쓰기 순서를 제어하도록 구성된다. NPU 스케줄러는 영상 융합 인공신경망 모델의 인공신경망 데이터 지역성 정보 또는 구조에 대한 정보에 기 초하여 프로세싱 엘리먼트 어레이 및 NPU 내부 메모리을 제어하도록 구성될 수 있다. NPU 스케줄러는 프로세싱 엘리먼트 어레이에서 작동할 영상 융합 인공신경망 모델의 구조를 분석하거 나 또는 이미 분석된 정보를 제공받을 수 있다. 분석된 정보는 머신 코드에 포함될 수 있다. 예를 들면, 영상 융합 인공신경망 모델이 포함할 수 있는 인공신경망의 데이터는 각각의 레이어의 노드 데이터(즉, 특징맵), 레 이어들의 배치 데이터, 지역성 정보 또는 구조에 대한 정보, 각각의 레이어의 노드를 연결하는 연결망 각각의 가중치 데이터 (즉, 가중치 커널) 중 적어도 일부를 포함할 수 있다. 인공신경망의 데이터는 NPU 스케줄러 내부에 제공되는 메모리 또는 NPU 내부 메모리에 저장될 수 있다. NPU 스케줄러는 머신 코드에 의해 서 동작될 수 있다. NPU 스케줄러는 영상 융합 인공신경망 모델의 인공신경망 데이터 지역성 정보 또는 구조에 대한 정보에 기 초하여 NPU가 수행할 영상 융합 인공신경망 모델의 연산 순서를 스케줄링 할 수 있다. 머신 코드는 스케줄 링 데이터를 포함할 수 있다. NPU 스케줄러는 머신 코드에 포함된 스케줄링에 따라서 동작할 수 있다. 즉, NPU 스케줄러는 머신 코드에 의해서 동작하도록 구성될 수 있다. NPU 스케줄러는 영상 융합 인공신경망 모델의 인공신경망 데이터 지역성 정보 또는 구조에 대한 정보에 기 초하여 영상 융합 인공신경망 모델의 레이어의 특징맵 및 가중치 데이터가 저장된 메모리 어드레스 값을 획득할 수 있다. 예를 들면, NPU 스케줄러는 메모리에 저장된 영상 융합 인공신경망 모델의 레이어의 특징맵 및 가중치 데이터가 저장된 메모리 어드레스 값을 획득할 수 있다. 따라서 NPU 스케줄러는 구동할 영상 융합 인공신경망 모델의 레이어의 특징맵 및 가중치 데이터를 메모리에서 가져와서 NPU 내부 메모리에 저 장할 수 있다. 각각의 레이어의 특징맵은 대응되는 각각의 메모리 어드레스 값을 가질 수 있다. 각각의 가중치 데이터는 대응되는 NPU 내부 메모리의 각각의 메모리 어드레스 값을 가질 수 있다. NPU 스케줄러는 영상 융합 인공신경망 모델의 인공신경망 데이터 지역성 정보 또는 구조에 대한 정보, 예 를 들면, 영상 융합 인공신경망 모델의 인공신경망의 레이어들의 배치 데이터 지역성 정보 또는 구조에 대한 정 보에 기초해서 프로세싱 엘리먼트 어레이의 연산 순서를 스케줄링 할 수 있다. NPU 스케줄러는 영상 융합 인공신경망 모델의 인공신경망 데이터 지역성 정보 또는 구조에 대한 정보에 기 초하여 스케줄링 하기 때문에, 일반적인 CPU의 스케줄링 개념과 다르게 동작할 수 있다. 일반적인 CPU의 스케줄 링은 공평성, 효율성, 안정성, 반응 시간 등을 고려하여, 최상의 효율을 낼 수 있도록 동작한다. 즉, 우선 순위, 연산 시간 등을 고려해서 동일 시간내에 가장 많은 프로세싱을 수행하도록 스케줄링 한다. 종래의 CPU는 각 프로세싱의 우선 순서, 연산 처리 시간 등의 데이터를 고려하여 작업을 스케줄링 하는 알고리 즘을 사용하였다. 이와 다르게 NPU 스케줄러는 영상 융합 인공신경망 모델의 인공신경망 데이터 지역성 정보 또는 구조에 대 한 정보에 기초하여 결정된 NPU의 프로세싱 순서대로 NPU를 제어할 수 있다. 더 나아가면, NPU 스케줄러는 영상 융합 인공신경망 모델의 인공신경망 데이터 지역성 정보 또는 구조에 대한 정보 및/또는 사용하려는 신경 프로세싱 유닛의 데이터 지역성 정보 또는 구조에 대한 정보에 기초하 여 결정된 프로세싱 순서대로 NPU를 구동할 수 있다. 단, 본 개시는 NPU의 데이터 지역성 정보 또는 구조에 대한 정보에 제한되지 않는다. NPU 스케줄러는 인공신경망의 데이터 지역성 정보 또는 구조에 대한 정보를 저장하도록 구성될 수 있다. 즉, NPU 스케줄러는 적어도 영상 융합 인공신경망 모델의 인공신경망 데이터 지역성 정보 또는 구조에 대 한 정보만 활용하더라도 프로세싱 순서를 결정할 수 있다. 더 나아가서, NPU 스케줄러는 영상 융합 인공신경망 모델의 인공신경망 데이터 지역성 정보 또는 구조에 대한 정보 및 NPU의 데이터 지역성 정보 또는 구조에 대한 정보를 고려하여 NPU의 프로세싱 순서를 결정할 수 있다. 또한, 결정된 프로세싱 순서대로 NPU의 프로세싱 최적화도 가능하다. 프로세싱 엘리먼트 어레이는 인공신경망의 특징맵과 가중치 데이터를 연산하도록 구성된 복수의 프로세싱 엘리먼트들(PE1 to PE12)이 배치된 구성을 의미한다. 각각의 프로세싱 엘리먼트는 MAC (multiply andaccumulate) 연산기 및/또는 ALU (Arithmetic Logic Unit) 연산기를 포함할 수 있다. 단, 본 개시에 따른 예시 들은 이에 제한되지 않는다. 도 5에서는 예시적으로 복수의 프로세싱 엘리먼트들이 도시되었지만, 하나의 프로세싱 엘리먼트 내부에 MAC을 대체하여, 복수의 곱셈기(multiplier) 및 가산기 트리(adder tree)로 구현된 연산기들이 병렬로 배치되어 구성 되는 것도 가능하다. 이러한 경우, 프로세싱 엘리먼트 어레이는 복수의 연산기를 포함하는 적어도 하나의 프로세싱 엘리먼트로 지칭되는 것도 가능하다. 프로세싱 엘리먼트 어레이는 복수의 프로세싱 엘리먼트들(PE1 to PE12)을 포함하도록 구성된다. 도 3에 도 시된 복수의 프로세싱 엘리먼트들(PE1 to PE12)은 단지 설명의 편의를 위한 예시이며, 복수의 프로세싱 엘리먼 트들(PE1 to PE12)의 개수는 제한되지 않는다. 복수의 프로세싱 엘리먼트들(PE1 to PE12)의 개수에 의해서 프로 세싱 엘리먼트 어레이의 크기 또는 개수가 결정될 수 있다. 프로세싱 엘리먼트 어레이의 크기는 N x M 행렬 형태로 구현될 수 있다. 여기서 N 과 M은 0보다 큰 정수이다. 프로세싱 엘리먼트 어레이는 N x M 개의 프로세싱 엘리먼트를 포함할 수 있다. 즉, 프로세싱 엘리먼트는 1개 이상일 수 있다. 프로세싱 엘리먼트 어레이의 크기는 NPU이 작동하는 영상 융합 인공신경망 모델의 특성을 고려하여 설계할 수 있다. 따라서, 프로세싱 엘리먼트 어레이의 가동률(utilization rate %)이 향상될 수 있다. 프로세싱 엘리먼트 어레이는 인공신경망 연산에 필요한 덧셈, 곱셈, 누산 등의 기능을 수행하도록 구성된 다. 다르게 설명하면, 프로세싱 엘리먼트 어레이는 MAC(multiplication and accumulation) 연산을 수행하 도록 구성될 수 있다. 프로세싱 엘리먼트 어레이는 MAC 연산 결과를 양자화해서 출력하도록 구성될 수 있다. 단, 본 개시의 예시 들은 이에 제한되지 않는다. NPU 내부 메모리은 메모리 크기와 영상 융합 인공신경망 모델의 데이터 크기에 따라 영상 융합 인공신경망 모델의 전부 또는 일부를 저장할 수 있다. 이하, 프로세싱 엘리먼트 어레이 중 제1 프로세싱 엘리먼트(PE1)를 예를 들어 설명한다. 도 6은 도 5에 도시된 프로세싱 엘리먼트 어레이 중 하나의 프로세싱 엘리먼트를 설명하는 개략적인 개념도이다. 도 6을 참조하면, 제1 프로세싱 엘리먼트(PE1)는 곱셈기, 가산기, 누산기, 및 비트 양자화 유닛 을 포함할 수 있다. 단, 본 개시에 따른 예시들은 이에 제한되지 않으며, 프로세싱 엘리먼트 어레이 는 인공신경망의 연산 특성을 고려하여 변형 실시될 수도 있다. 곱셈기는 입력 받은 (N)bit 데이터와 (M)bit 데이터를 곱한다. 곱셈기의 연산 값은 (N+M)bit 데이터 로 출력된다. 곱셈기는 하나의 변수와 하나의 상수를 입력 받도록 구성될 수 있다. 누산기는 (L)loops 횟수만큼 가산기를 사용하여 곱셈기의 연산 값과 누산기의 연산 값을 누산 한다. 따라서 누산기의 출력부와 입력 회로의 데이터의 비트 폭은 (N+M+log2(L))bit로 출력될 수 있 다. 여기서 L은 0보다 큰 정수이다. 누산기는 누산이 종료되면, 초기화 신호(initialization reset)를 인가받아서 누산기 내부에 저장된 데이터를 0으로 초기화 할 수 있다. 단, 본 개시에 따른 예시들은 이에 제한되지 않는다. 비트 양자화 유닛은 누산기에서 출력되는 데이터의 비트 폭을 저감할 수 있다. 비트 양자화 유닛 은 NPU 스케줄러에 의해서 제어될 수 있다. 양자화된 데이터의 비트 폭은 (X)bit로 출력될 수 있다. 여기서 X는 0보다 큰 정수이다. 상술한 구성에 따르면, 프로세싱 엘리먼트 어레이는 MAC 연산을 수행하도 록 구성되고, 프로세싱 엘리먼트 어레이는 MAC 연산 결과를 양자화해서 출력할 수 있는 효과가 있다. 특히 이러한 양자화는 (L)loops가 증가할수록 소비 전력을 더 절감할 수 있는 효과가 있다. 또한 소비 전력이 저감되 면 발열도 저감할 수 있는 효과가 있다. 특히 발열을 저감하면 NPU의 고온에 의한 오동작 발생 가능성을 저감할 수 있는 효과가 있다. 비트 양자화 유닛의 출력 데이터(X)bit은 다음 레이어의 노드 데이터 또는 합성곱의 입력 데이터가 될 수 있다. 만약 영상 융합 인공신경망 모델이 양자화되었다면, 비트 양자화 유닛은 양자화된 특징맵 및/또는가중치를 영상 융합 인공신경망 모델에서 제공받도록 구성될 수 있다. 단, 이에 제한되지 않으며, NPU 스케줄러 는 영상 융합 인공신경망 모델을 분석하여 양자화된 정보를 추출하도록 구성되는 것도 가능하다. 따라서 양자화된 데이터 크기에 대응되도록, 출력 데이터(X)bit를 양자화 된 비트 폭으로 변환하여 출력될 수 있다. 비 트 양자화 유닛의 출력 데이터(X)bit는 양자화된 비트 폭으로 NPU 내부 메모리에 저장될 수 있다. 즉, 본 개시의 일 예시에 따른 NPU의 프로세싱 엘리먼트 어레이는 곱셈기, 가산기, 누산기 , 및 비트 양자화 유닛을 포함할 수 있다. 이하, 본 개시의 NPU의 다른 예시에 대하여 설명한다. 도 7은 도 5에 도시된 신경 프로세싱 유닛의 변형 예를 나타낸 개념도이다. 도 7을 설명하기에 앞서, 도 7에 도시된 NPU은 도 5에 예시적으로 도시된 프로세싱 유닛과 비교하면, 프로세싱 엘리먼트 어레이를 제외하곤 실질적으로 동일하기 때문에, 이하 설명의 편의를 위해서 중복 설명 은 생략한다. 도 7을 참조하면, 엘리먼트 어레이는 복수의 프로세싱 엘리먼트들(PE1 to PE12) 외에, 각각의 프로세싱 엘 리먼트들(PE1 to PE12)에 대응되는 각각의 레지스터 파일들(RF1 to RF12)을 더 포함할 수 있다. 다만, 도 7에 도시된 복수의 프로세싱 엘리먼트들(PE1 to PE12) 및 복수의 레지스터 파일들(RF1 to RF12)은 단 지 설명의 편의를 위한 예시이며, 복수의 프로세싱 엘리먼트들(PE1 to PE12) 및 복수의 레지스터 파일들(RF1 to RF12)의 개수는 제한되지 않는다. 복수의 프로세싱 엘리먼트들(PE1 to PE12) 및 복수의 레지스터 파일들(RF1 to RF12)의 개수에 의해서 프로세싱 엘리먼트 어레이의 크기 또는 개수가 결정될 수 있다. 프로세싱 엘리먼트 어레이 및 복수의 레지스터 파일들(RF1 to RF12)의 크기는 N x M 행렬 형태로 구현될 수 있다. 여기서 N 과 M은 0보다 큰 정수이다. 프로세싱 엘리먼트 어레이의 어레이 크기는 NPU이 작동하는 영상 융합 인공신경망 모델의 특성을 고 려하여 설계할 수 있다. 부연 설명하면, 레지스터 파일의 메모리 크기는 작동할 영상 융합 인공신경망 모델의 데이터 크기, 요구되는 동작 속도, 요구되는 소비 전력 등을 고려하여 결정될 수 있다. NPU의 레지스터 파일들(RF1 to RF12)은 프로세싱 엘리먼트들(PE1 to PE12)과 직접 연결된 정적 메모리 유 닛이다. 레지스터 파일들(RF1 to RF12)은 예를 들면, 플립플롭, 및/또는 래치 등으로 구성될 수 있다. 레지스터 파일들(RF1 to RF12)은 대응되는 프로세싱 엘리먼트들(PE1 to PE12)의 MAC 연산 값을 저장하도록 구성될 수 있 다. 레지스터 파일들(RF1 to RF12)은 NPU 내부 메모리와 가중치 데이터 및/또는 노드 데이터를 제공하거나 제공받도록 구성될 수 있다. 레지스터 파일들(RF1 to RF12)은 MAC 연산 시 누산기의 임시 메모리의 기능을 수행하도록 구성되는 것도 가능하 다. 레지스터 파일들(RF1 to RF12)은 연산이 끝난 특징맵을 임시 저장한 다음, 다음 연산에서 상기 특징맵을 재사용 하여 전력 소비를 저감하는 것도 가능하다. 이하, NPU에서 작동될 수 있는 예시적인 영상 융합 인공신경망 모델(110-10)의 연산에 대하여 설명한다. 도 8은 본 개시의 일 예시에 따른 영상 융합 인공신경망 모델을 예시적으로 나타낸 개념도이다. 도 8의 영상 융합 인공신경망 모델(110-10)은 도 5 또는 도 7에 도시된 NPU에서 학습되거나 별도의 기계 학습 장치에서 학습된 인공신경망일 수 있다. 영상 융합 인공신경망 모델(110-10)은 영상 속 객체의 움직임, 자 세 추정 등 다양한 추론 기능을 수행하도록 학습된 인공신경망일 수 있다. 영상 융합 인공신경망 모델(110-10)은 심층 신경망(DNN, Deep Neural Network)일 수 있다. 단, 본 개시의 예시 들에 따른 영상 융합 인공신경망 모델(110-10)은 심층 신경망에 제한되지 않는다. 예를 들면, 영상 융합 인공신경망 모델은 Image/Video Reconstruction, Image/Video Enhancement와 같은 추론 을 수행하도록 훈련된 모델일 수 있다. 또한, 융합된 영상을 입력으로 하는 다른 인공신경망 모델은 Super-resolution, Upscaling, Image fusion, Object Classification, Object Detection, Object Segmentation, Object Tracking, Event Recognition, Event Prediction, Anomaly Detection, Density Estimation, Event Search, Measurement 등의 추론을 수행하도록 훈련된 모델일 수 있다. 예를 들면, 영상 융합 인공신경망 모델은 Transformer, Bisenet, Shelfnet, Alexnet, Densenet, Efficientnet, EfficientDet, Googlenet, Mnasnet, Mobilenet, Resnet, Shufflenet, Squeezenet, VGG, Yolo, RNN, CNN, DBN, RBM, LSTM 등의 모델일 수 있다. 단, 단, 본 개시는 이에 제한되지 않으며, NPU에서 동작 가능한 이 외의 새로운 인공신경망 모델일 수 있다. 다양한 예시에서, 영상 융합 인공신경망 모델(110-10)은 적어도 두 개의 서로 다른 모델들에 기초한 앙상블 모 델일 수도 있다. 영상 융합 인공신경망 모델(110-10)의 각 레이어의 가중치 값, 노드 값, 누산된 값, 특징맵, 가중치 등의 파라 미터의 적어도 일부는 NPU의 NPU 내부 메모리에 저장될 수 있다. 구체적으로, 도 8을 참조하면, 영상 융합 인공신경망 모델(110-10)에 의한 추론 과정은 NPU에 의해서 수행 될 수 있다. 영상 융합 인공신경망 모델(110-10)은 입력 레이어(110-11), 제1 연결망(110-12), 제1 은닉 레이어(110-13), 제2 연결망(110-14), 제2 은닉 레이어(110-15), 제3 연결망(110-16), 및 출력 레이어(110-17)을 포함하는 예시 적인 심층 신경망 모델이다. 단, 본 개시는 도 8에 도시된 영상 융합 인공신경망 모델에만 제한되는 것은 아니 다. 제1 은닉 레이어(110-13) 및 제2 은닉 레이어(110-15)는 복수의 은닉 레이어로 지칭되는 것도 가능하다. 입력 레이어(110-11)는 예시적으로, x1 및 x2 입력 노드를 포함할 수 있다. 즉, 입력 레이어(110-11)는 2개의 입력 값에 대한 정보를 포함할 수 있다. 도 5 또는 도 7에 도시된 NPU 스케줄러는 입력 레이어(110-11)로 부터의 입력 값에 대한 정보가 저장되는 메모리 어드레스를 도 5 또는 도 7에 도시된 NPU 내부 메모리에 설정할 수 있다. 제1 연결망(110-12)은 예시적으로, 입력 레이어(110-11)의 각각의 노드를 제1 은닉 레이어(110-13)의 각각의 노 드로 연결시키기 위한 6개의 가중치 값에 대한 정보를 포함할 수 있다. 도 5 또는 도 7에 도시된 NPU 스케줄러 는 제1 연결망(110-12)의 가중치 값에 대한 정보가 저장되는 메모리 어드레스를 NPU 내부 메모리에 설정할 수 있다. 각각의 가중치 값은 입력 노드 값과 곱해지고, 곱해진 값들의 누산된 값이 제1 은닉 레이어 (110-13)에 저장된다. 여기서 누산된 값을 가지는 노드들은 특징맵으로 지칭될 수 있다. 제1 은닉 레이어(110-13)는 예시적으로 a1, a2, 및 a3 노드를 포함할 수 있다. 즉, 제1 은닉 레이어(110-13)는 3개의 노드 값에 대한 정보를 포함할 수 있다. 도 5 또는 도 7에 도시된 NPU 스케줄러는 제1 은닉 레이어 (110-13)의 노드 값에 대한 정보를 저장시키기 위한 메모리 어드레스를 NPU 내부 메모리에 설정할 수 있다. NPU 스케줄러는 제1 프로세싱 엘리먼트(PE1)가 제1 은닉 레이어(110-13)의 a1 노드의 MAC 연산을 수행하도 록 연산 순서를 스케줄링 하도록 구성될 수 있다. NPU 스케줄러는 제2 프로세싱 엘리먼트(PE2)가 제1 은닉 레이어(110-13)의 a2 노드의 MAC 연산을 수행하도록 연산 순서를 스케줄링 하도록 구성될 수 있다. NPU 스케줄 러는 제3 프로세싱 엘리먼트(PE3)가 제1 은닉 레이어(110-13)의 a3 노드의 MAC 연산을 수행하도록 연산 순 서를 스케줄링 하도록 구성될 수 있다. 여기서 NPU 스케줄러는 3개의 프로세싱 엘리먼트들이 병렬로 동시 에 MAC 연산을 각각 수행하도록 연산 순서를 미리 스케줄링 할 수 있다. 상기 스케줄링 정보는 머신 코드에 포 함될 수 있다. 따라서 NPU 스케줄러는 머신 코드에 포함된 스케줄링 정보에 따라 동작될 수 있다. 제2 연결망(110-14)은 예시적으로, 제1 은닉 레이어(110-13)의 각각의 노드를 제2 은닉 레이어(110-15)의 각각 의 노드로 연결시키기 위한 9개의 가중치 값에 대한 정보를 포함할 수 있다. 도 5 또는 도 7에 도시된 NPU 스케 줄러는 제2 연결망(110-14)의 가중치 값에 대한 정보를 저장시키기 위한 메모리 어드레스를 NPU 내부 메모 리에 설정할 수 있다. 상기 제2 연결망(110-14)의 가중치 값은 제1 은닉 레이어(110-13)로부터 입력되는 노드 값과 각기 곱해지고, 곱해진 값들의 누산된 값이 제2 은닉 레이어(110-15)에 저장된다. 제2 은닉 레이어(110-15)는 예시적으로 b1, b2, 및 b3 노드를 포함할 수 있다. 즉, 제2 은닉 레이어(110-15)는 3개의 노드 값에 대한 정보를 포함할 수 있다. NPU 스케줄러는 제2 은닉 레이어(110-15)의 노드 값에 대한 정보를 저장시키기 위한 메모리 어드레스를 NPU 내부 메모리에 설정할 수 있다. NPU 스케줄러는 제4 프로세싱 엘리먼트(PE4)가 제2 은닉 레이어(110-15)의 b1 노드의 MAC 연산을 수행하도 록 연산 순서를 스케줄링 하도록 구성될 수 있다. NPU 스케줄러는 제5 프로세싱 엘리먼트(PE5)가 제2 은닉 레이어(110-15)의 b2 노드의 MAC 연산을 수행하도록 연산 순서를 스케줄링 하도록 구성될 수 있다. NPU 스케줄러는 제6 프로세싱 엘리먼트(PE6)가 제2 은닉 레이어(110-15)의 b3 노드의 MAC 연산을 수행하도록 연산 순 서를 스케줄링 하도록 구성될 수 있다. 상기 스케줄링 정보는 머신 코드에 포함될 수 있다. 여기서 NPU 스케줄러는 3개의 프로세싱 엘리먼트들이 병렬로 동시에 MAC 연산을 각각 수행하도록 연산 순 서를 미리 스케줄링 할 수 있다. 여기서, NPU 스케줄러는 영상 융합 인공신경망 모델의 제1 은닉 레이어(110-13)의 MAC 연산 이후 제2 은닉 레이어(110-15)의 연산이 수행되도록 스케줄링을 결정할 수 있다. 즉, NPU 스케줄러는 영상 융합 인공신경망 모델의 인공신경망 데이터 지역성 정보 또는 구조에 대한 정보 에 기초하여 프로세싱 엘리먼트 어레이 및 NPU 내부 메모리을 제어하도록 구성될 수 있다. 제3 연결망(110-16)은 예시적으로, 제2 은닉 레이어(110-15)의 각각의 노드와 출력 레이어(110-17)의 각각의 노 드를 연결하는 6개의 가중치 값에 대한 정보를 포함할 수 있다. NPU 스케줄러는 제3 연결망(110-16)의 가 중치 값에 대한 정보를 저장시키기 위한 메모리 어드레스를 NPU 내부 메모리에 설정할 수 있다. 제3 연결 망(110-16)의 가중치 값은 제2 은닉 레이어(110-15)로부터 입력되는 노드 값과 각기 곱해지고, 곱해진 값들의 누산된 값이 출력 레이어(110-17)에 저장된다. 출력 레이어(110-17)는 예시적으로 y1, 및 y2 노드를 포함할 수 있다. 즉, 출력 레이어(110-17)는 2개의 노드 값에 대한 정보를 포함할 수 있다. NPU 스케줄러는 출력 레이어(110-17)의 노드 값에 대한 정보를 저장시 키기 위해 메모리 어드레스를 NPU 내부 메모리에 설정할 수 있다. NPU 스케줄러는 제7 프로세싱 엘리먼트(PE7)가 출력 레이어(110-17)의 y1 노드의 MAC 연산을 수행하도록 연산 순서를 스케줄링 하도록 구성될 수 있다. NPU 스케줄러는 제8 프로세싱 엘리먼트(PE8)가 출력 레이어 (110-15)의 y2 노드의 MAC 연산을 수행하도록 연산 순서를 스케줄링 하도록 구성될 수 있다. 상기 스케줄링 정 보는 머신 코드에 포함될 수 있다. 여기서 NPU 스케줄러는 2개의 프로세싱 엘리먼트들이 병렬로 동시에 MAC 연산을 각각 수행하도록 연산 순 서를 미리 스케줄링 할 수 있다. 여기서 NPU 스케줄러는 영상 융합 인공신경망 모델의 제2 은닉 레이어(110-15)의 MAC 연산 이후 출력 레이 어(110-17)의 연산이 수행되도록 스케줄링을 결정할 수 있다. 즉, NPU 스케줄러는 영상 융합 인공신경망 모델의 인공신경망 데이터 지역성 정보 또는 구조에 대한 정보 에 기초하여 프로세싱 엘리먼트 어레이 및 NPU 내부 메모리을 제어하도록 구성될 수 있다. 즉, NPU 스케줄러는 프로세싱 엘리먼트 어레이에서 작동할 영상 융합 인공신경망 모델의 구조를 분석 하거나 또는 분석된 정보를 제공받을 수 있다. 영상 융합 인공신경망 모델이 포함할 수 있는 인공신경망의 정보 는 각각의 레이어의 노드 값에 대한 정보, 레이어들의 배치 데이터 지역성 정보 또는 구조에 대한 정보, 각각의 레이어의 노드를 연결하는 연결망 각각의 가중치 값에 대한 정보를 포함할 수 있다. NPU 스케줄러는 예시적인 영상 융합 인공신경망 모델(110-10)의 인공신경망 데이터 지역성 정보 또는 구조 에 대한 정보를 제공받았기 때문에, NPU 스케줄러는 영상 융합 인공신경망 모델(110-10)의 입력부터 출력 까지의 연산 순서를 파악할 수 있다. 따라서, NPU 스케줄러는 각각의 레이어의 MAC 연산 값들이 저장되는 메모리 어드레스를 스케줄링 순서를 고려해서 NPU 내부 메모리에 설정할 수 있다. NPU 내부 메모리는 NPU의 추론 연산이 지속되는 동안 NPU 내부 메모리에 저장된 연결망들의 가 중치 데이터를 보존하도록 구성될 수 있다. 따라서 메모리 읽기 쓰기 동작을 저감할 수 있는 효과가 있다. 즉, NPU 내부 메모리는 추론 연산이 지속되는 동안 NPU 내부 메모리에 저장된 MAC 연산 값을 재사용 하도록 구성될 수 있다. 이하, 도 9 내지 도 12을 통해 본 개시의 영상 융합 인공신경망 모델의 구조에 대하여 설명한다. 도 9는 본 개시의 일 예시에 따른 영상 융합 인공신경망 모델을 구성하는 GAN의 일부 구조를 설명하기 위한 도 면이다. 도 9를 참조하면, 영상 융합 인공신경망 모델을 구성하는 GAN 신경망 구조는 고해상도의 열 영상을 생성하기 위 한 생성기(Generator)에 대응되는 구조를 가지고 있다. 즉, 신경 프로세싱 유닛의 스케줄러는 검증기(discriminator)가 배제된 영상 융합 인공신경망 모델이 컴파일된 머신 코드를 입력 받아 추론 연산을 처리하 도록 구성될 수 있다. 일 예시에서, 생성기에 대응되는 영상 융합 인공신경망 모델은 각각 RGB 3 채널의 가시광 영상과 1 채널의 열영 상을 입력 데이터로 이용할 수 있으며, 활성화 함수(ELU)가 적용된 합성곱(컨볼루션) 연산을 수행하여 특징맵 (feature map) 및/또는 활성화 맵을 출력할 수 있다. 예를 들어, 가시광 영상의 입력 데이터는 채널 각각이 3 x 3 크기의 필터 64개를 슬라이딩하고, 열영상의 입력 데이터는 3 x 3 크기의 필터 64개를 슬라이딩하여 연산될 수 있다. 즉, 가시광 영상의 입력 데이터는 영상 융합 전에 특징맵의 크기를 열영상의 입력 데이터에서 출력되 는 특징맵의 크기와 동일한 크기로 줄일 수 있다. 각각의 연산을 통해 출력된 출력 특징맵은 1× 1 크기의 필터 하나에 병합될 수 있다. 이와 같이 병합된 특징맵은 건너뛰고 연결하기 (Skip-connection) 동작을 통해 출력 결 과를 다른 레이어로 전달할 수 있으며, 복수의 레이어를 거쳐 최종적으로 고해상도의 열영상을 생성할 수 있다. 도 9는 GAN에서의 생성기를 구성하기 위한 하나의 예시일 뿐이며, 이에 제한되지 않고, 다양한 모델의 구성이 채용될 수 있다. 도 10은 도 9에 도시된 컨볼루션 레이어의 입력 데이터와 합성곱 연산 또는 행렬 곱셈에 사용되는 커널을 설명 하기 위한 도면이다. 도 10을 참조하면, 입력 데이터는 특정 크기의 행과 특정 크기의 열로 구성된 2차원적 행렬로 표시되는 이미지 또는 영상일 수 있다. 입력 데이터는 특징맵으로 지칭될 수 있다. 입력 데이터는 복 수의 채널을 가질 수 있는데, 여기서 채널은 입력 데이터 이미지의 컬러 RGB채널을 나타낼 수 있다. 한편, 커널은, 입력 데이터의 일정 부분을 스캐닝하면서 해당 부분의 특징을 추출하기 위한 합성곱에 사용되는 가중치 파라미터일 수 있다. 커널은, 입력 데이터 이미지와 마찬가지로 특정 크기의 행, 특 정 크기의 열, 특정 수의 채널을 갖도록 구성될 수 있다. 일반적으로 커널의 행, 열 의 크기는 동일하도록 설정되며, 채널의 수는 입력 데이터 이미지의 채널의 수와 동일할 수 있다. 도 11은 도 10에 도시된 커널을 사용하여 특징 맵을 생성하는 컨볼루션 신경망의 동작을 설명하기 위한 도면이 다. 도 11을 참조하면, 커널은, 입력 데이터를 지정된 간격으로 순회하며 합성곱을 실행함으로써, 최종적 으로 특징맵을 생성할 수 있다. 합성곱은, 입력 데이터의 일 부분에 커널을 적용하였을 때, 그 부분의 특정 위치의 입력 데이터 값들과 커널의 해당 위치의 값들을 각각 곱한 뒤 생성된 값들을 모두 더 하여 실행될 수 있다. 이러한 합성곱 과정을 통해, 특징맵의 계산 값들이 생성되며, 커널이 입력 데이터를 순회할 때마다 이러한 합성곱의 결과값들이 생성되어 특징맵을 구성할 수 있다. 특징맵의 각 구성요소 값들은 컨볼루션 레이어의 활성화 함수를 통해 활성화맵으로 변환될 수 있다. 도 11에서 컨볼루션 레이어에 입력되는 입력 데이터는 4 x 4의 크기를 갖는 2차원적 행렬로 표시되며, 커 널은 3 x 3 크기를 갖는 2차원적 행렬로 표시된다. 그러나, 컨볼루션 레이어의 입력 데이터 및 커널 의 크기는, 이에 한정되는 것은 아니며, 컨볼루션 레이어가 포함되는 컨볼루션 신경망의 성능 및 요구사항 에 따라 다양하게 변경될 수 있다. 도시된 바와 같이, 컨볼루션 레이어에 입력 데이터가 입력되면, 커널이 입력 데이터 상에서 사 전 결정된 간격(예를 들면, stride = 1)으로 순회하며, 입력 데이터와 커널의 동일 위치의 값들을 각 각 곱하고 각각의 값들을 더하는 MAC 연산을 수 있다. 구체적으로, 커널이 입력 데이터의 특정 위치에서 계산한 MAC 연산 값 “15”를 특징맵의 대응 요소에 배정한다. 커널이 입력 데이터의 다음 위치에서 계산한 MAC 연산 값 “16”을 특징맵의 대응 요소에 배정한다. 커널이 입력 데이터의 다음 위치에서 계산한 MAC 연 산 값 “6”을 특징맵의 대응 요소에 배정한다. 다음으로, 커널이 입력 데이터의 다음 위 치에서 계산한 MAC 연산 값 “15”를 특징맵의 대응 요소에 배정한다. 이와 같이 커널이 입력 데이터 상을 순회하면서 계산한 MAC 연산 값들을 특징맵에 모두 배정하 면, 2 x 2 크기의 특징맵이 완성될 수 있다. 이때, 입력 데이터가 예를 들어 3가지 채널(R채널, G채널, B채널)로 구성된다면, 동일 커널 또는 채널 별 상이한 채널을 각각 입력 데이터의 각 채널 별 데이터 상을 순회하며 다중 곱과 합을 진행하는 합성곱을 통해 채널 별 특징맵을 생성할 수 있다. 상기 MAC 연산을 위해서 스케줄러는 기 설정된 연산 순서를 기초로 각각의 MAC 연산을 수행할 프로세싱 엘 리먼트들(PE1 to PE12)을 할당하고, MAC 연산 값들이 저장되는 메모리 어드레스를 스케줄링 순서를 고려해서 NPU 내부 메모리에 설정할 수 있다. 도 12는 본 개시의 일 예시에 따른 영상 융합 인공신경망 모델을 예시적으로 나타낸 개념도이다. 도 12를 참고하면, 일 예시에서 RGB 카메라와 Thermal 이미지 센서로부터 제공되는 신호를 병렬 프로세싱을 통 해 처리하는 예가 나타나 있다. 병렬 프로세싱 도중에, 트랜스포머를 통해서 서로 다른 정보가 교환될 수 있다. 상기 방식은 후술하게 될 도 14에 도시된 심층 퓨전 방식일 수 있다. 한편, 도시되지는 않았으나, 이종 센서로부터 제공되는 서로 다른 데이터를 처리하기 위해 인공신경망은 연접 (Concatenation) 동작과 건너뛰고 연결하기 (Skip-connection) 동작을 포함할 수 있다. 연접 동작은 특정 레이 어의 출력 결과를 서로 합치는 것을 의미하고, 건너뛰고 연결하기 동작은 특정 레이어의 출력 결과를 후속 레이 어를 건너뛰고, 다른 레이어로 전달하는 것을 의미한다. 이러한, 연접 동작과 건너뛰고 연결하기 동작은 NPU의 내부 메모리의 제어 난이도 증가 및 사용량을 증가시킬 수 있다. 지금까지 이종 센서로부터 제공되는 서로 다른 데이터를 퓨전하여 처리하기 위한 인공신경망에 대해서 설명하였 으나, 위 설명된 내용들만으로는, 인공신경망의 성능 향상을 꾀할 수 없는 약점이 있었다. 이에, 이하에서는 최 적화된 인공신경망 및 NPU 구조에 대해서 설명하기로 한다. <이종 센서로부터의 서로 다른 데이터를 처리하기 위해 최적화된 퓨전(fusion) 인공신경망 및 NPU 구조> 먼저, 본 특허의 발명자는 이종 센서로부터의 서로 다른 데이터를 처리하기 위한 NPU에 대하여 연구하였다. 상기 NPU의 설계에 있어서 하기의 구성을 고려해야 한다: i. 이종 데이터 신호 처리(예컨대, RGB 카메라 + Thermal 이미지 센서)에 적합한 NPU 구조를 가지는 것이 필요 하다. ii. 이종 입력 신호 처리(예컨대, RGB 카메라 + Thermal 이미지 센서)에 적합한 NPU 메모리 제어가 필요하다. iii. 다중 입력 채널에 적합한 NPU 구조를 가지는 것이 필요하다. iv. 다중 입력 채널에 적합한 NPU 메모리 제어가 필요하다. v. 영상 융합 인공신경망 모델(퓨전(fusion) 인공신경망 모델) 연산에 적합한 NPU 구조를 가지는 것이 필요하다. vi. 실시간 적용을 위해서 16ms 이하의 빠른 처리 속도가 필요하다 vii. 배터리 구동을 위해서 저소비 전력 달성이 필요하다. 영상 융합 인공신경망 모델(퓨전(fusion) 인공신경망 모델)을 구현하기 위한 NPU는 하기의 기능을 지원해야 한 다. 예상되는 요구 사항들은 아래와 같다: i. CNN 기능 지원: 합성곱에 최적화된 PE 어레이 및 메모리를 제어할 수 있어야 한다. ii. Depthwise-separable convolution을 효율적으로 처리할 수 있어야 한다. PE 이용률 및 성능(throughput)을 향상시키는 구조를 가져야 한다. iii. Batch mode 기능 지원: 다중 채널(카메라 1~6), 이종 센서를 동시에 처리할 수 있도록 메모리 구성이 필요 하다.(PE 어레이의 크기와 메모리 크기가 적정한 비율이어야 한다) iv. 연접 (Concatenation) 기능 지원: 영상 융합 인공신경망 모델(퓨전(fusion) 인공신경망 모델)을 위한 NPU는 이종 입력 데이터 신호를 연접(Concatenation) 기능으로 처리할 수 있어야 한다. *v. 건너뛰고 연결하기 (Skip-connection) 기능 지원: 영상 융합 인공신경망 모델(퓨전(fusion) 인공신경망 모 델)을 위한 NPU는 건너뛰고 연결하기(skip) 기능을 제공할 수 있는 SFU(Special Function Unit)를 포함할 수 있다. vi. 딥러닝 영상 전처리 기능 지원: 영상 융합 인공신경망 모델(퓨전(fusion) 인공신경망 모델)을 위한 NPU는 서로 다른 데이터 신호를 전처리하는 기능을 제공할 수 있어야 한다. vii. 영상 융합 인공신경망 모델(퓨전(fusion) 인공신경망 모델)을 효율적으로 컴파일 할 수 있는 컴파일러가 제공되어야 한다. 본 개시의 일 실시예에서는 다음과 같은 특징을 가진 NPU가 제안된다. *i. NPU는 늦은 퓨전(Late Fusion), 조기 퓨전(Early Fusion), 심층 퓨전(Deep Fusion) 등, 영상 융합 인 공신경망 모델(퓨전(fusion) 인공신경망 모델)의 ANN 데이터 지역성 정보를 분석하는 머신 코드 처리할 수 있다. ii. NPU는 ADC(artificial neural network data locality controller)에 기초하여 이종의 센서 데이터를 처리하도록 PE 어레이를 제어하도록 구성될 수 있다. 즉, 영상 융합 인공신경망 모델(퓨전(fusion) 인공신경망 모델)은 센서에 따라 다양한 구조로 퓨전되며, 상기 구조에 대응되는 NPU를 제공함에 따라 PE 가동률 (utilization rate)을 향상 시킬 수 있다. iii. ANN 데이터 지역성 정보에 기초하여 이종의 센서 데이터를 처리하도록 칩-내부 메모리의 크기를 적절 히 설정하도록 구성될 수 있다. 즉, 영상 융합 인공신경망 모델(퓨전(fusion) 인공신경망 모델)의 인공신경망 데이터 지역성 정보를 분석하면 퓨전(fusion) 인공신경망을 처리하는 NPU의 메모리 대역폭을 개선할 수 있 다. iv. NPU는 영상 융합 인공신경망 모델(퓨전(fusion) 인공신경망 모델)에서 필요한 쌍선형 보간(Bilinear interpolation), 연접(Concatenation) 및 건너뛰고 연결하기(skip-connection 등)을 효율적으로 처리할 수 있 는 SFU(Special Function Unit)를 포함할 수 있다. 도 13은 본 개시의 일 예시에 따른 NPU의 퓨전 방식을 나타낸 예시도이다. 도 13을 참조하면, “F”는 퓨전 연산을 의미하며, 각각의 블록은 각각의 레이어를 의미한다. NPU는 늦은 퓨전(Late Fusion), 조기 퓨전(Early Fusion), 심층 퓨전(Deep Fusion)을 수행할 수 있다. 늦은 퓨전은 각 레 이어 별로 연산을 수행한 후, 마지막 과정에서 연산 결과를 퓨전 하는 것을 의미한다. 조기 퓨전은 조기에 서로 다른 데이터를 퓨전한 후, 레이어 별로 연산을 수행하는 것을 의미한다. 심층 퓨전은 서로 다른 데이터를 퓨전 한 후, 서로 다른 레이어에서 연산을 수행하고, 연산 수행 결과를 다시 퓨전한 후, 레이어 별로 연산을 수행하 는 것을 의미한다. 본 개시에서 조기 퓨전 연산을 통해서는 상이한 두 개의 영상을 복수의 레이어 연산 초기에 병합하고, 후속 레이어의 연산을 수행할 수 있다. 이와 다르게, 늦은 퓨전을 통해서는 상이한 두 개의 영상을 각각에 할당된 레이어 별로 연산을 수행한 뒤, 연산 결과를 병합한 후, 후속 레이어의 연산을 수행할 수 있다. 예를 들어, 상이한 두 개의 영상은 가시광선 이미지 센서를 통해 획득되는 영상과 열화상 이미지 센서를 통해 획득되는 영상일 수 있으나 이에 제한되지 않는다. 이하에서는 상기와 같은 특징을 개시할 수 있는 NPU의 구조에 대하여 설명한다. 도 14는 본 개시의 제1 예시에 따른 NPU 아키텍처를 포함하는 시스템을 예시적으로 나타낸 개념도이다. 도 14를 참조하면, 상기 NPU는 영상 융합 인공신경망 모델을 위한 PE 어레이, 칩-내부(On-chip) 메모 리, NPU 스케줄러, SFU(special function unit)을 포함할 수 있다. 도 14을 설명함에 있어서 중복되는 설명은 단지 설명의 편의를 위해 생략될 수 있다. 영상 융합 인공신경망 모델을 위한 PE 어레이는 적어도 하나의 퓨전 레이어를 가지는 다층 구조의 영상 융 합 인공신경망 모델의 합성곱을 처리하도록 구성된 PE 어레이를 의미할 수 있다. 즉, 퓨전 레이어는 이종 센서의 데이터가 퓨전 된 특징맵을 출력하도록 구성될 수 있다. 부연 설명하면, NPU의 SFU는 다중 센 서의 센서 데이터를 입력 받아 각각의 센서 입력 데이터를 퓨전 시키는 기능을 제공하도록 구성될 수 있다. 영 상 융합 인공신경망 모델을 위한 PE 어레이는 SFU에서 퓨전된 데이터를 입력 받아 합성곱을 처리하도 록 구성될 수 있다. NPU는 M개의 이종 센서들(311, 312)로부터 서로 다른 데이터를 수신할 수 있다. 상기 이종의 센서들은 서 로 다른 영상 특성과 해상도를 가진 이미지 센서들을 포함할 수 있다. 상기 NPU는 컴파일러로부터 영상 융합 인공신경망 모델(퓨전(fusion) 인공신경망(ANN))의 인공신경망 데이터 지역성 정보를 획득할 수 있다. 상기 영상 융합 인공신경망 모델의 적어도 하나의 레이어는 복수의 센서의 입력 데이터가 퓨전 된 레이어일 수 있다. 상기 NPU는 이종 센서 입력 데이터의 퓨전을 위해서 적어도 하나의 레이어에 연접 기능을 제공하도록 구성 될 수 있다. 연접된 레이어의 이종 센서들의 각각의 특징맵은 서로 연접되기 위해서 적어도 하나의 축의 크기는 서로 동일하게 처리될 수 있다. 예를 들면, X-축으로 이종 센서 데이터의 연접을 위해서 이종 센서 데이터 각각 의 X-축의 크기는 서로 동일할 수 있다. 예를 들면, Y-축으로 이종 센서 데이터의 연접을 위해서 이종 센서 데 이터 각각의 Y-축의 크기는 서로 동일할 수 있다. 예를 들면, Z-축으로 이종 센서 데이터의 연접을 위해서 이종 센서 데이터 각각의 Z-축의 크기는 서로 동일할 수 있다. NPU의 처리 효율 향상을 위해서 이종 센서 데이 터 중 하나의 데이터의 크기를 스케일-업 또는 스케일-다운 처리할 수 있다. 따라서, 이종 센서 데이터의 퓨전 된 데이터의 하나의 축의 크기가 서로 동일해지는 것도 가능하다. 부연 설명하면, 프로세싱 엘리먼트 어레이 는 N x M 행렬 형태이기 때문에, 센서 데이터의 적어도 하나의 축의 크기에 따라서 프로세싱 엘리먼트 어 레이 PE 가동률(utilization rate)이 달라질 수 있다. 상기 이종 센서들(311, 312)로부터 서로 다른 데이터를 제공받아 처리하기 위하여, 상기 NPU 스케줄러는 영상 융합 인공신경망 모델(퓨전(fusion) 인공신경망 모델)의 추론을 처리할 수 있다. 상기 NPU 스케줄러는 도시된 바와 같이 제어부 내에 포함될 수 있다. 상기 NPU 스케줄러는 컴파일러으로부터 영상 융합 인공신경망 모델(퓨전(fusion) 인공신경망)의 인공 신경망 데이터 지역성 정보를 획득 분석하고, 상기 칩-내부 메모리의 동작을 제어할 수 있다. 구체적으로 설명하면, 다음과 같다. 상기 컴파일러는 상기 NPU에서 처리할 퓨전(fusion) 인공신경망 의 인공신경망 데이터 지역성 정보를 생성할 수 있다. 상기 NPU 스케줄러는 상기 영상 융합 인공신경망 모델(퓨전(fusion) 인공신경망)에 필요한 특수 기능 (special function)에 대한 목록을 생성할 수 있다. 특수 기능은 합성곱 이외의 인공신경망 연산에 필요한 다양 한 기능 등을 의미할 수 있다. 상기 영상 융합 인공신경망 모델(퓨전(fusion) 인공신경망)의 인공신경망 데이터 지역성 정보를 활용하면, non- maximum suppression(NMS), 건너뛰고 연결하기(SKIP-CONNECTION), 병목(Bottleneck), 쌍선형 보간(Bilinear interpolation) 등 퓨전(fusion) 인공신경망에서 자주 발생하는 메모리 접근 증가 문제를 효율적으로 제어할 수 있다. 상기 영상 융합 인공신경망 모델(퓨전(fusion) 인공신경망)의 인공신경망 데이터 지역성 정보를 활용하면, 먼저 연산된 제1 출력 특징맵 정보와 그리고 더 늦게 처리되는 제2 출력 특징맵 정보가 퓨전될 때까지, 저장해야 하 는 데이터(예컨대, 제1 출력 특징맵)의 크기, 저장 기간 등을 컴파일 단계에서 알 수 있기 때문에, 칩-내부(on- chip) 메모리를 위한 메모리 맵을 사전에 효율적으로 설정할 수 있다. 상기 SFU은 영상 융합 인공신경망 모델(퓨전(fusion) 인공신경망)에 필요한 건너뛰고 연결하기(skip- connection), 및 연접(concatenation)을 수행할 수 있다. 부연 설명하면, 연접은 이종의 센서 데이터를 퓨전하 는데 활용될 수 있다. 연접을 위해서 각각의 센서 데이터의 크기는 재조정될 수 있다. 예를 들면, NPU는 크기조정(resize), 보간법(interpolation) 등의 기능을 제공하여 퓨전 인공신공망의 연접을 처리하도록 구성될 수 있다. 상기 NPU의 칩-내부 메모리는 영상 융합 인공신경망 모델의 인공신경망 데이터 지역성 정보에 기초하 여 PE 어레이 또는 SFU에 따른 특정 데이터를 특정 기간동안 선택적으로 보존할 수 있다. 상기 선택 적 보존 여부는 제어부에 의해서 제어될 수 있다. 또한 PE 어레이는 이종 센서의 개수에 대응되는 쓰레드(thread)의 개수를 가지도록 구성될 수 있다. 즉, 2 개의 센서 데이터를 입력 받도록 구성된 NPU의 어레이는 2개의 쓰레드를 가지도록 구성될 수 있다. 즉 하나의 쓰레드가 N x M 개의 프로세싱 엘리먼트들로 구성되면, 2개의 쓰레드는 N x M x 2 개의 프로세싱 엘리먼트들로 구성될 수 있다. 예를 들면, PE 어레이의 각각의 쓰레드는 각각의 이종 센서의 특징맵을 처리 하도록 구성될 수 있다. NPU의 복수의 쓰레드는 NPU의 멀티코어로 지칭될 수 있다. 상기 NPU는 상기 영상 융합 인공신경망 모델의 연산 결과를 출력부를 통해 출력할 수 있다. 전술한 제1 예시에 따른 NPU 아키텍처는 다양하게 변형될 수 있다. 도 15a는 본 개시의 제1 예시에 따른 영상 융합 인공신경망 모델이 포함하는 건너뛰고 연결하기(skip- connection)를 설명하기 위한 예시도이고, 도 15b는 도 15a에 도시된 영상 융합 인공신경망 모델의 인공신경망 데이터 지역성 정보를 나타낸 예시도이다. 도 15a을 참조하면, 건너뛰고 연결하기(Skip-connection) 동작을 포함하는 5개의 레이어를 연산하기 위해서, 도 15b 도시된 바와 같이 컴파일러는 예를 들면, 16개 단계의 순서를 가지는 영상 융합 인공신경망 모델의 인 공신경망 데이터 지역성 정보를 생성할 수 있다. NPU는 영상 융합 인공신경망 모델의 인공신경망 데이터 지역성 정보 순서 대로 칩-내부(On-chip) 메모리 에 데이터 오퍼레이션을 요청한다 건너뛰고 연결하기(Skip-connection) 동작의 경우, 제1 레이어의 출력 특징맵(OFMAP)은 제4 레이어의 출력 특징 맵(OFMAP)과 더해질 수 있다. 이와 같은, 건너뛰고 연결하기(Skip-connection) 동작을 위해서 제1 레이어의 출력 특징맵을 제5 레이어 연산까 지 보존해야 한다. 하지만, 다른 데이터들은 메모리 공간 활용을 위해서 연산 이후 삭제되어도 무방하다. 삭제된 메모리 영역에는 영상 융합 인공신경망 모델의 인공신경망 데이터 지역성 정보 순서를 기초로 이후에 연 산 될 데이터가 저장될 수 있다. 따라서, 영상 융합 인공신경망 모델의 데이터 지역 정보 순서를 따라 필요한 데이터를 칩-내부 메모리로 순차적으로 가져오고, 재사용되지 않는 데이터를 삭제할 수 있기 때문에, 칩- 내부(On-chip) 메모리의 메모리 크기가 작더라도 칩-내부 메모리의 동작 효율을 향상시킬 수 있다. 따라서 NPU는 영상 융합 인공신경망 모델의 인공신경망 데이터 지역성 정보에 기초하여 일정 기간 동안 칩 -내부 메모리의 특정 데이터를 선택적으로 보존하거나, 삭제할 수 있다. 이러한 메커니즘은 건너뛰고 연결하기(Skip-connection) 동작 뿐만 아니라, 연접(concatenation), non-maximum suppression(NMS), 쌍선형 보간(Bilinear interpolation) 등 다양한 동작에 적용될 수도 있다. 예를 들면, NPU는 칩-내부 메모리의 효율적인 제어를 위해서 제2 레이어의 합성곱 연산을 수행한 후, 제1 레이어의 출력 특징맵(OFMAP)을 제외한 제1 레이어의 데이터가 삭제되도록 할 수 있다. 또 다른 예를 들면, NPU는 칩-내부 메모리의 효율적인 제어를 위해서 제3 레이어의 연산을 수행한 후, 제1 레이어의 출력 특징맵(OFMAP)을 제외한 제2 레이어의 데이터가 삭제되도록 할 수 있다. 또 다른 예를 들면, NPU는 칩-내 부 메모리의 효율적인 제어를 위해서 제4 레이어의 연산을 수행한 후, 제1 레이어의 출력 특징맵(OFMAP)을 제외한 제3 레이어의 데이터가 삭제되도록 할 수 있다. 또한, NPU는 칩-내부 메모리의 효율적인 제어 를 위해서 제5 레이어의 연산을 수행한 후, 제1 레이어의 출력 특징맵(OFMAP)을 포함한 제4 레이어의 데이터가 삭제되도록 할 수 있다. 상기 영상 융합 인공신경망 모델의 인공신경망 데이터 지역성 정보는 하기에 나열된 조건들을 고려하여 컴파일 러가 생성하고 NPU가 수행할 데이터 처리 순서를 의미한다. 1. ANN 모델의 구조 (이종 센서 데이터를 입력 받도록 설계된 Resnet, YOLO, SSD, 등 퓨전(fusion) 인공신경망). 2. 프로세서의 구조 (예컨대, CPU, GPU, NPU 등의 아키텍처). NPU의 경우 PE 개수, PE의 구조(예컨대, 입력 고정(input stationary), 출력 고정(output stationary), 가중치 고정(weight stationary) 등), PE 어레이와 유기적으로 동작하도록 구성된 SFU 구조 등. 3. 칩-내부 메모리 크기(예컨대, 캐시가 데이터 보다 작을 때, 타일링(tiling) 알고리즘 적용 필요 등). 4. 처리할 영상 융합 인공신경망 모델의 각 레이어의 데이터 사이즈. 5. 프로세싱 정책. 즉, NPU가 입력 특징맵(IFMAP) 먼저 읽기 요청 또는 커널(Kernel) 먼저 읽기 요청할지 에 대한 순서 등을 결정. 이는, 프로세서 또는 컴파일러에 따라 다양해질 수 있다.도 16은 본 개시의 제2 예시에 따른 NPU 아키텍처를 포함하는 시스템을 예시적으로 나타낸 개념도이다. 도 16을 참조하면, 상기 NPU는 영상 융합 인공신경망 모델을 위한 PE 어레이, 칩-내부(On-chip) 메모 리, NPU 스케줄러, SFU(special function unit)을 포함할 수 있다. 도 16을 설명함에 있어서 중복되는 설명은 설명의 편의를 위해 생략될 수 있다. 상기 NPU 스케줄러는 도시된 바와 같이 제어부 내에 포함될 수 있다. 상기 NPU는 M개의 이종 센서들(311, 312)로부터 서로 다른 데이터를 수신할 수 있다. 상기 이종의 센서들 은 마이크, 터치 스크린, 카메라, 고도계, 기압계, 광혈류 측정센서, 심전도 측정센서, 관성 측정센서, 지오포 지셔닝 시스템, 광 센서, 온도계, 근전도 측정기 전극 측정기 등을 포함할 수 있다. 상기 NPU는 컴파일러로부터 영상 융합 인공신경망 모델의 인공신경망 데이터 지역성 정보를 획득할 수 있다. 상기 NPU는 N개의 출력부를 통하여 N개의 결과(예컨대, 이종의 추론 결과)를 출력할 수 있다. 상기 NPU로부터 출력되는 이종의 데이터는 Image fusion, Classification, Semantic segmentation, Object detection, Prediction 등일 수 있다. 도 17은 본 개시의 제3 예시에 따른 NPU 아키텍처를 포함하는 시스템을 예시적으로 나타낸 개념도이다. 도 17을 참조하면, 상기 NPU는 영상 융합 인공신경망 모델을 위한 PE 어레이, 칩-내부(On-chip) 메모 리, NPU 스케줄러, SFU(special function unit)을 포함할 수 있다. 도 17을 설명함에 있어서 중복되는 설명은 단지 설명의 편의를 위해 생략될 수 있다. 상기 NPU 스케줄러는 도시된 바와 같이 제어부 내에 포함될 수 있다. NPU는 M개의 이종 센서들(311, 312)로부터 서로 다른 데이터를 수신할 수 있다. 상기 이종의 센서들은 서 로 다른 영상 특성과 해상도를 가진 이미지 센서들을 포함할 수 있다. 상기 NPU는 컴파일러로부터 영상 융합 인공신경망 모델의 인공신경망 데이터 지역성 정보를 획득할 수 있다. 상기 NPU는 ADC(artificial neural network data locality controller)를 통해 칩-외부 메모리(50 0)로부터 영상 융합 인공신경망 모델의 연산에 필요한 데이터를 제공받을 수 있다. 상기 ADC는 상기 컴파일러로부터 제공되는 영상 융합 인공신경망 모델의 인공신경망 데이터 지역성 정보에 기초하여, 칩-외부 메모리에서 칩-내부 메모리로 데이터를 프리패치(prefetch)할 수 있다. 구체적으로, ADC는 상기 컴파일러로부터 영상 융합 인공신경망 모델의 인공신경망 데이터 지역성 정 보를 제공받아 분석하거나 또는 상기 컴파일러로부터 분석된 정보를 제공받아, 상기 칩-외부 메모리 의 동작을 제어할 수 있다. 상기 ADC는 상기 영상 융합 인공신경망 모델의 인공신경망 데이터 지역성 정보에 따라, 상기 칩-외부 메모 리 내에 저장된 데이터를 읽어와서 칩-내부 메모리에 사전에 캐싱할 수 있다. 칩-외부 메모리는 상기 영상 융합 인공신경망 모델의 모든 가중치 커널이 저장될 수 있으며, 칩-내부 메모리는 칩-외부 메모리 에 저장된 모든 가중치 커널 중 영상 융합 인공신경망 모델의 인공신경망 데이터 지역성 정보에 따라 필요 한 적어도 일부의 가중치 커널만 저장할 수 있다. 칩-외부 메모리의 메모리 용량은 칩-내부 메모리의 메모리 용량보다 더 클 수 있다. ADC는 영상 융합 인공신경망 모델의 인공신경망 데이터 지역성 정보에 기초하여 NPU와 연동하거나 또 는 독립적으로 NPU에 필요한 데이터를 칩-외부 메모리로부터 사전에 준비할 수 있다. 따라서 NPU의 추론 동작의 레이턴시가 저감되거나 또는 동작 속도가 향상될 수 있다. 상기 NPU는 N개의 출력부를 통하여 N개의 결과(예컨대, 이종의 추론 결과)를 출력할 수 있다. 도 18은 본 개시의 제4 예시에 따른 NPU 아키텍처를 포함하는 시스템을 예시적으로 나타낸 개념도이고, 도 19는 도 12에 도시된 영상 융합 인공신경망 모델을 도 18에 도시된 제4 예시에 따라 쓰레드로 구분한 예를 나타낸다. 도 18을 참조하면, 상기 NPU는 영상 융합 인공신경망 모델을 위한 PE 어레이, 칩-내부(On-chip) 메모 리, NPU 스케줄러, SFU(special function unit)을 포함할 수 있다.상기 NPU 스케줄러는 도시된 바와 같이 제어부 내에 포함될 수 있다. 상기 NPU는 M개의 이종 센서들(311, 312)로부터 서로 다른 데이터를 수신할 수 있다. 상기 이종의 센서들 은 서로 다른 영상 특성 및 해상도를 가지는 이미지 센서들을 포함할 수 있다. 상기 NPU는 컴파일러로부터 영상 융합 인공신경망 모델의 인공신경망 데이터 지역성 정보를 획득할 수 있다. 상기 NPU는 N개의 이종 데이터(예컨대, 이종의 추론 결과)를 출력할 수 있다. 상기 NPU로부터 출력되 는 이종의 데이터는 Image fusion, Classification, Semantic segmentation, Object detection, Prediction 등일 수 있다. 상기 PE 어레이는 다중 쓰레드를 처리할 수 있다. 도 19에 도시된 바와 같이, 카메라로부터 얻은 RGB 이미 지 데이터를 쓰레드 #1을 통해서 처리하고, Transformer 모델 처리는 쓰레드 #2를 통해서 처리하고, Thermal 이 미지 센서로부터 얻은 데이터는 쓰레드 #3을 통해서 처리할 수 있다. PE 어레이의 다중 쓰레드는 NPU의 멀 티코어로 지칭될 수 있다. 즉, 각각의 쓰레드는 독립적인 PE 어레이를 지칭할 수 있다. 이를 위해, 컴파일러는 영상 융합 인공신경망 모델을 분석하고, 병렬 연산 흐름을 기초로, 쓰레드를 구분 할 수 있다. *NPU의 PE 어레이는 영상 융합 인공신경망 모델의 병렬 처리 연산이 가능한 레이어를 다중 쓰레드를 통해서 연산 효율을 향상시킬 수 있다. 각각의 쓰레드는 서로 동일하거나 또는 상이한 개수의 프로세싱 엘리먼트들을 포함하도록 구성될 수 있다. NPU는 PE 어레이 내의 각 쓰레드가 칩-내부(On-chip) 메모리와 통신할 수 있도록 제어할 수 있 다. NPU는 쓰레드 별 칩-내부(On-chip) 메모리 내부 공간을 선택적으로 할당할 수 있다. NPU는 쓰레드 별로 적절한 칩-내부(On-chip) 메모리를 할당할 수 있다. 칩-내부 메모리의 메모 리 할당은 영상 융합 인공신경망 모델의 인공신경망 데이터 지역성 정보에 기초하여 제어부가 결정할 수 있다. NPU는 퓨전(fusion) 인공신경망에 기초하여, PE 어레이 내에 쓰레드를 설정할 수 있다. 상기 NPU는 N개의 출력부를 통하여 N개의 결과(예컨대, 이종의 추론 결과)를 출력할 수 있다. 도 20은 본 개시의 제5 예시에 따른 NPU 아키텍처를 포함하는 시스템을 예시적으로 나타낸 개념도이고, 도 21은 도 20에 도시된 SFU의 파이프라인 구조의 제1 예시를 나타낸 예시도이다. 도 20을 참조하면, 상기 NPU는 영상 융합 인공신경망 모델을 위한 PE 어레이, 칩-내부(On-chip) 메모 리, NPU 스케줄러, SFU(special function unit)을 포함할 수 있다. 상기 NPU는 M개의 이종 센서들(311, 312)로부터 서로 다른 데이터를 수신할 수 있다. 상기 이종의 센서들 은 서로 다른 영상 특성과 해상도를 가진 이미지 센서들을 포함할 수 있다. 상기 NPU는 컴파일러로부터 영상 융합 인공신경망 모델(퓨전(fusion) 인공신경망(ANN))의 인공신경망 데이터 지역성 정보를 획득할 수 있다. 상기 NPU는 N개의 이종 데이터(예컨대, 이종의 추론 결과)를 출력할 수 있다. 상기 NPU로부터 출력되 는 이종의 데이터는 Image fusion, Classification, Semantic segmentation, Object detection, Prediction 등일 수 있다. 도 21에 도시된 바와 같이, 상기 SFU은 여러 기능 유닛을 포함한다. 각각의 기능 유닛은 선택적으로 동작 될 수 있다. 각각의 기능 유닛은 선택적으로 턴-온되거나 턴-오프될 수 있다. 즉, 각각의 기능 유닛은 설정이 가능하다. 프로세싱 엘리먼트 어레이는 영상 융합 인공신경망 모델의 주 연산을 수행하도록 구성된 회로부를 지칭할 수 있 다. 주 연산은 Convolution or matrix multiplication을 지칭할 수 있다. 즉, 주 연산은 인공신경망(ANN)(예컨 대, 퓨전(Fusion) 인공신경망)에서의 대부분의 연산을 지칭할 수 있다. 특수 기능 유닛(SFU)은 영상 융합 인공신경망 모델의 특수 기능 연산을 선택적으로 수행하도록 구성된 복수의 특수 기능 회로부들의 집합을 지칭할 수 있다. 즉, 특수 기능 유닛(SFU)은 특수 기능을 추가적으로 연산할 수 있으며, 특수 기능 연산은 다양한 인공신경망(ANN))(예컨대, 퓨전(Fusion) 인공신경망)에서의 부가 연산을 지칭 할 수 있다. 영상 융합 인공신경망 모델의 주 연산의 연산량은 특수 기능 연산의 연산량보다 연산량이 상대적으로 더 많을 수 있다. 다시 말해서, 상기 SFU은 영상 융합 인공신경망 모델의 추론에 필요한 다양한 기능 유닛들을 포함할 수 있 다. 예를 들면, 상기 SFU의 기능 유닛들은 건너뛰고 연결하기(skip-connection) 동작을 위한 기능 유닛, 활성 화 함수(activation function) 동작을 위한 기능 유닛, 풀링(pooling) 동작을 위한 기능 유닛, 양자화 (quantization) 동작을 위한 기능 유닛, NMS(non-maximum suppression) 동작을 위한 기능 유닛, 정수 및 부동 소수점 변환(INT to FP32) 동작을 위한 기능 유닛, 배치 정규화(batch-normalization) 동작을 위한 기능 유닛, 보간법(interpolation) 동작을 위한 기능 유닛, 연접(concatenation) 동작을 위한 기능 유닛, 및 바이아스 (bias) 동작을 위한 기능 유닛 등을 포함할 수 있다. 상기 SFU의 기능 유닛들은 영상 융합 인공신경망 모델의 인공신경망 데이터 지역성 정보에 의해서 선택적 으로 턴-온되거나 혹은 턴-오프될 수 있다. 부연 설명하면, 영상 융합 인공신경망 모델의 각각의 레이어가 필요 로 하는 특수 기능 연산들의 종류는 각 레이어마다 상이할 수 있다. 머신 코드에 포함된 인공신경망 데이터 지 역성 정보는 특정 레이어를 위한 연산이 수행될 때, 해당 기능 유닛의 턴-온 또는 턴-오프와 관련된 제어 정보 를 포함할 수 있다. 도 22a는 도 20에 도시된 SFU의 일 예시를 나타낸 예시도이고, 도 22b는 도 20에 도시된 SFU의 다른 예시를 나 타낸 예시도이다. 도 22a 및 도 22b를 참조하면, 상기 SFU의 기능 유닛들 중 활성화된 유닛은 턴-온 될 수 있다. 구체적으로 도 22a에 도시된 바와 같이, SFU는 건너뛰고 연결하기(skip-connection) 동작과 연접 (concatenation) 동작을 선택적으로 활성화 할 수 있다. 예시적으로, 활성화된 각각의 기능 유닛은 해칭 (hatching)으로 표기될 수 있다. 예를 들면, SFU는 퓨전 동작을 위해서 이종 센서 데이터를 연접할 수 있다. 예를 들면, SFU의 건너뛰 고 연결하기 동작을 위해서 제어부는 칩-내부 메모리와 SFU를 제어할 수 있다. 구체적으로 도 22b에 도시된 바와 같이, 양자화(quantization) 동작과 바이아스(bias) 동작을 선택적으로 활성 화할 수 있다. 예를 들면, PE 어레이에서 출력되는 특징맵 데이터의 크기를 저감하기 위해서 PE 어레이 에서 출력되는 특징맵을 SFU의 양자화 기능 유닛이 입력 받아 특징맵을 특정 비트폭으로 양자화 할 수 있다. 그리고 양자화된 특징맵을 칩-내부 메모리에 저장할 수 있다. 일련의 동작들은 제어부를 통해서 순차적으로 할 수 있으며, NPU 스케쥴러가 상기 동작들의 동작 순서를 제어하도록 구성될 수 있다. 이와 같이 SFU의 일부 기능 유닛을 선택적으로 턴-오프하는 경우, NPU의 소비 전력을 절감할 수 있다. 한편, 일부 기능 유닛을 턴-오프하기 위하여, 파워 게이팅(power gating)을 이용할 수 있다. 또는, 일부 기능 유닛을 턴-오프하기 위하여, 클럭 게이팅(clock gating)을 수행할 수도 있다. 도 23은 본 개시의 제6 예시에 따른 NPU 아키텍처를 포함하는 시스템을 예시적으로 나타낸 개념도이다. 도 23을 참조하면, NPU 배치 모드(Batch mode)가 적용될 수 있다. 배치 모드(Batch mode)가 적용되는 NPU(10 0)는 영상 융합 인공신경망 모델을 위한 PE 어레이, 칩-내부(On-chip) 메모리, NPU 스케줄러, SFU(special function unit)을 포함할 수 있다. 상기 NPU 스케줄러는 도시된 바와 같이 제어부 내에 포함될 수 있다. 상기 NPU는 컴파일러로부터 영상 융합 인공신경망 모델의 인공신경망 데이터 지역성 정보를 획득할 수 있다. 본 예시에서 개시하는 배치 모드는 하나의 영상 융합 인공신경망 모델로 다수의 동일 센서를 순차적으로 처리하 여 상기 하나의 영상 융합 인공신경망 모델의 가중치를 상기 다수의 동일 센서의 개수만큼 재사용하도록 하여저전력을 달성하도록 구성된 모드를 의미한다. 배치 모드 동작을 위해서 NPU의 제어부는 칩-내부 메모리에 저장되는 가중치가 각각의 배치 채널에 입력되 는 센서의 개수만큼 재사용되도록 NPU 스케줄러를 제어하도록 구성될 수 있다. 즉, 예시적으로, NPU 가 M개의 센서로 배치 모드로 동작되도록 구성될 수 있다. 이때, NPU의 상기 배치 모드 동작은 영상 융합 인공신경망 모델로 동작하도록 구성될 수 있다. 영상 융합 인공신경망 모델의 동작을 위해서 NPU는 퓨전을 위한 복수의 배치 채널들(BATCH CH#1, BATCH CH#2)을 가지도록 구성될 수 있다. 각각의 배치 채널은 동일한 복수의 센서들을 포함하도록 구성될 수 있다. 제 1 배치 채널(BATCH CH#1)은 복수의 제1 센서들로 구성될 수 있다. 이때, 제1 센서들은 M개일 수 있다. 제K 배치 채널(BATCH CH#K)은 복수의 제2 센서들로 구성될 수 있다. 이때, 제2 센서들은 M개일 수 있다. 상기 NPU는 제1 배치 채널을 통해 센서들(311, 312)로부터의 입력을 위해 대응되는 가중치를 칩-내부 메모 리에서 재사용하며 처리할 수 있다. 그리고, 상기 NPU는 제2 배치 채널을 통해 센서들(321, 322)로부 터의 입력을 위해 대응되는 가중치를 칩-내부 메모리에서 재사용하며 처리할 수 있다. 이와 같이, 상기 NPU는 복수의 배치 채널을 통해 여러 센서들로부터 입력을 제공받고 가중치를 재사용하며 배치 모드로 영상 융합 인공신경망 모델을 처리할 수 있다. 상기 복수의 배치 채널들 중 적어도 하나의 채널의 센서와 다른 적어도 하나의 채널의 센서는 서로 상이할 수 있다. 상기 NPU 내의 칩-내부(On-chip) 메모리는 복수의 배치 채널에 대응되는 저장 공간을 가지도록 설정 될 수 있다. 상기 NPU 내의 NPU 스케줄러는 배치 모드에 따라 PE 어레이를 동작시킬 수 있다. 상기 NPU 내의 SFU는 적어도 하나의 퓨전 동작을 처리하기 위한 특수 기능을 제공할 수 있다. 상기 NPU는 복수의 배치 채널들을 통해 각각의 출력을 전달할 수 있다. 상기 복수의 배치 채널들 중 적어도 하나의 채널은 영상 융합 인공신경망 모델망의 추론 데이터일 수 있다. 도 24는 본 개시의 제7 예시에 따라 복수의 NPU를 활용하는 예를 나타낸 예시도이고, 도 25는 도 12에 도시된 퓨전(fusion) 인공신경망을 도 24에 도시된 복수의 NPU를 통해 처리하는 예를 나타낸 예시도이다. 도 24를 참조하면, 퓨전 영상을 생성하기 위하여 복수개의, 예시적으로 M개의 NPU가 사용될 수 있다. M개의 NPU 중에서 제1 NPU(100-1)는 예컨대 센서#1로부터 제공되는 데이터를 처리할 수 있고, M번째 NPU(100-M)는 예 컨대 센서#M로부터 제공되는 데이터를 처리할 수 있다. 상기 복수의 NPU(예컨대 100-1, 100-2)는 ADC/DMA(Direct Memory Access)을 통하여 칩-외부 메모리에 접근할 수 있다. 상기 복수의 NPU(예컨대 100-1, 100-2)는 컴파일러로부터 영상 융합 인공신경망 모델의 인공신경망 데이터 지역성 정보를 획득할 수 있다. 각각의 NPU는 영상 융합 인공신경망 모델을 처리하고 퓨전(fusion)을 위한 연산을 ADC/DMA를 통해서 서로 다른 NPU로 전달할 수 있다. 상기 ADC/DMA는 상기 컴파일러로부터 퓨전(fusion) 영상 융합 인공신경망 모델의 인공신경망을 위한 데이터 지역성 정보를 획득할 수 있다. 상기 컴파일러는 영상 융합 인공신경망 모델의 인공신경망 데이터 지역성 정보에 따른 연산들 중에서 병렬 처리되어야 하는 연산들이 각 NPU에서 처리될 수 있도록, 인공신경망 데이터 지역성 정보를 데이터 지역성 정보 #1 그리고 데이터 지역성 정보#M으로 분리하여 생성할 수 있다. 상기 칩-외부 메모리는 복수의 NPU들이 공유가능한 데이터를 저장하고, 각각의 NPU에 전달할 수 있다. 도 25를 참조하면, 카메라로부터 제공되는 데이터를 처리하기 위한 제1 인공신경망을 NPU#1가 담당할 수 있고, Thermal 이미지 센서로부터 제공되는 데이터를 처리하기 제2 인공신경망을 NPU#2가 담당할 수 있다. 또한, 상기 NPU#2는 제1 인공신경망과 제2 인공신경망의 퓨전을 위한 변환을 담당할 수 있다. 지금까지 본 개시의 다양한 예시에 따른 영상 융합 인공신경망 모델을 위한 NPU에 대하여 설명하였다. 본 개시에 따르면, 전문 디바이스가 아닌, 일반 디바이스에 내장되는 고해상도의 일반 가시광 이미지 센서와 저해 상도의 열영상 이미지 센서를 활용하여, 고해상도의 열영상을 생성할 수 있다. 이에 본 개시는 저비용으로 고해상도의 열영상을 생성할 수 있다. 뿐만 아니라, 본 개시는 야간 식별을 위해 만들어진 디바이스가 아닌, 예를 들어, 사용자 소지의 디바이스나 차량의 블랙박스 등에서도 영상의 야간 식별력을 향상시킬 수 있다. <본 개시의 개시들의 간략 정리> 본 개시의 일 개시에 따르면, 영상 융합 인공신경망 모델을 위한 신경 프로세싱 유닛이 제공된다. 상기 영상 융 합 인공신경망 모델을 위한 신경 프로세싱 유닛은, 서로 상이한 해상도 및 영상 특성을 가지는 제1 영상 및 제2 영상을 입력하여, 새로운 제3 영상을 출력하도록 학습된 영상 융합 인공신경망 모델의 머신 코드를 입력받도록 구성된 제어부; 상기 영상 융합 인공신경망 모델에 대응되는 복수의 입력 신호를 수신하도록 구성된 입력 회로; 상기 영상 융합 인공신경망 모델 연산의 주 연산을 수행하도록 구성된 프로세싱 엘리먼트 어레이; 상기 영상 융 합 인공신경망 모델의 특수 기능 연산을 수행하도록 구성된 특수 기능 유닛 회로; 및 상기 영상 융합 인공신경 망 모델의 상기 주 연산 및/또는 상기 특수 기능 연산의 데이터를 저장하도록 구성된 온-칩 메모리; 를 포함하 고, 상기 제어부는, 상기 머신-코드에 포함된 영상 융합 인공신경망 모델의 데이터 지역성 정보에 따라 상기 영 상 융합 인공신경망 모델의 연산 순서가 기 설정된 순서대로 처리되도록, 상기 프로세싱 엘리먼트 어레이, 상기 특수 기능 유닛 회로 및 상기 온-칩 메모리를 제어하도록 구성되며, 상기 제3 영상의 제3 해상도는, 상기 제1 영상의 제1 해상도와 상기 제2 영상의 제2 해상도 사이의 값을 가지며, 상기 제3 영상의 제3 영상 특성은, 상기 제1 영상의 제1 영상 특성 또는 상기 제2 영상의 제2 영상 특성과 적어도 일부 동일할 수 있다. 상기 제1 영상은, 가시광선 이미지 센서를 통해 획득되는 영상일 수 있다. 상기 제2 영상은, 열화상 이미지 센서를 통해 획득되는 영상일 수 있다. 상기 제1 영상 및 제2 영상은, 하나의 객체에 대한 서로 다른 영상을 포함하며, 상기 영상 특성은, 상기 제1 영 상 및 제2 영상을 획득하는 이미지 센서의 종류에 의해 결정될 수 있다. 상기 영상 융합 인공신경망 모델은, 상기 제1 영상 및 제2 영상에서 추출된 객체에서, 얼굴 영역에 대응되는 제1 부분 영상 및 제2 부분 영상만을 입력하도록 구성된 인공신경명 모델일 수 있다. 상기 제3 영상은, 상기 제1 영상의 적어도 일부 영역에 상기 제2 영상에서 결정 가능한 적어도 하나의 특징이 적용된 영상일 수 있다. 상기 영상 융합 인공신경망 모델은, 상기 제1 영상에서 결정 가능한 적어도 하나의 특징과 상기 제2 영상에서 결정 가능한 적어도 하나의 특징을 강조하기 위한 가중치가 적용된 모델일 수 있다. 상기 영상 융합 인공신경망 모델은, 상기 제1 영상의 RGB 값 또는 상기 제1 영상의 픽셀 별 밝기 값만을 입력하 도록 구성된 인공신경망 모델일 수 있다. 상기 제3 영상의 상기 제3 해상도는, 상기 제1 영상의 상기 제1 해상도와 동일할 수 있다. 상기 영상 융합 인공신경망 모델은, GAN(generative adversarial networks) 구조를 기초로 학습되며, 하나의 객체에 대한 서로 다른 영상을 입력으로 하여 새로운 영상을 생성하도록 구성된 생성기(generator)에 대응될 수 있다. 상기 영상 융합 인공신경망 모델은, 상기 GAN을 구성하는 상기 생성기 및 상기 생성기에서 생성된 영상을 검증 하는 검증기(discriminator)가 상호 경쟁하여 상기 제3 영상의 상기 제3 해상도를 높이기 위한 가중치를 업데이 트하도록 구성된 인공신경명 모델일 수 있다. 상기 영상 융합 인공신경망 모델은, 상기 제1 영상 및 상기 제2 영상과 실질적으로 유사한 형식의 학습 데이터 세트를 기초로 학습될 수 있다. 상기 프로세싱 엘리먼트 어레이는, 합성곱, 및 활성화 함수 연산을 처리하도록 구성될 수 있다. 상기 프로세싱 엘리먼트 어레이는, 상기 제3 영상의 상기 제3 해상도를 높이기 위한, Dilated Convolution, Transposed Convolution, 및 Bilinear Interpolation 연산 중 적어도 하나의 연산을 처리하도록 구성될 수 있 다. 상기 프로세싱 엘리먼트 어레이에 의해서 Classification, Semantic segmentation, Object detection, 및 Prediction 중 적어도 하나의 추론 연산을 처리하도록 학습된 상기 영상 융합 인공신경망 모델의 상기 적어도 하나의 추론 연산 결과를 출력하도록 구성된 출력부를 더 포함할 수 있다. 상기 특수 기능 유닛 회로는, 인공신경망 퓨전을 위한, Skip-connection 및 Concatenation 중 적어도 하나의 기 능을 더 포함할 수 있다. 상기 제어부는 스케줄러를 더 포함하고, 상기 스케줄러는, 상기 영상 융합 인공신경망 모델의 데이터 지역성 정 보에 기초하여 상기 온-칩 메모리에 저장된 특정 데이터를 상기 영상 융합 인공신경망 모델의 특정 연산 단계까 지 보존하도록, 상기 온-칩 메모리를 제어하도록 구성될 수 있다. 상기 프로세싱 엘리먼트 어레이는 복수의 쓰레드를 더 포함하고, 상기 제어부는 상기 영상 융합 인공신경망 모 델의 데이터 지역성에 기초하여 상기 영상 융합 인공신경망 모델의 병렬 구간을 처리하도록 상기 복수의 쓰레드 를 제어하도록 구성될 수 있다. 본 개시의 또 다른 개시에 따르면, 영상 융합 인공신경망 모델을 위한 시스템이 제공된다. 상기 시스템은, 제1 해상도 및 제1 영상 특성을 가지는 제1 영상을 획득하는 제1 센서; 상기 제1 해상도보다 작은 제2 해상도 및 상 기 제1 영상 특성과 상이한 제2 영상 특성을 가지는 제2 영상을 획득하는 제2 센서; 및 서로 상이한 해상도 및 영상 특성을 가지는 제1 영상 및 제2 영상을 입력하여, 새로운 제3 영상을 출력하도록 학습된 영상 융합 인공신 경망 모델을 처리하도록 구성된 신경 프로세싱 유닛; 을 포함하고, 상기 제3 영상의 제3 해상도는, 상기 제1 영 상의 제1 해상도와 상기 제2 영상의 제2 해상도 사이의 값을 가지며, 상기 제3 영상의 제3 영상 특성은, 상기 제1 영상의 제1 영상 특성 또는 상기 제2 영상의 제2 영상 특성과 적어도 일부 동일할 수 있다. 이상 첨부된 도면을 참조하여 본 개시의 일 예시들을 더욱 상세하게 설명하였으나, 본 개시는 반드시 이러한 예 시로 국한되는 것은 아니고, 본 개시의 기술사상을 벗어나지 않는 범위 내에서 다양하게 변형 실시될 수 있다. 따라서, 본 개시에 개시된 예시들은 본 개시의 기술 사상을 한정하기 위한 것이 아니라 설명하기 위한 것이고, 이러한 예시에 의하여 본 개시의 기술 사상의 범위가 한정되는 것은 아니다. 그러므로, 이상에서 기술한 예시 들은 모든 면에서 예시적인 것이며 한정적이 아닌 것으로 이해해야만 한다. 본 개시의 보호 범위는 아래의 청 구범위에 의하여 해석되어야 하며, 그와 동등한 범위 내에 있는 모든 기술 사상은 본 개시의 권리범위에 포함되 는 것으로 해석되어야 할 것이다."}
{"patent_id": "10-2024-0039241", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1 및 도 2는 본 개시의 일 예시에 따른 영상 융합 인공신경망 모델을 설명하는 개략적인 개념도이다. 도 3 및 도 4는 본 개시의 일 예시에 따른 영상 융합 인공신경망 모델을 통해 생성된 영상을 설명하는 개략적인 개념도이다. 도 5은 본 개시의 일 예시에 따른 신경 프로세싱 유닛을 설명하는 개략적인 개념도이다. 도 6은 도 5에 도시된 프로세싱 엘리먼트 어레이 중 하나의 프로세싱 엘리먼트를 설명하는 개략적인 개념도이다. 도 7은 도 5에 도시된 신경 프로세싱 유닛의 변형 예를 나타낸 개념도이다. 도 8은 본 개시의 일 예시에 따른 영상 융합 인공신경망 모델을 예시적으로 나타낸 개념도이다. 도 9는 본 개시의 일 예시에 따른 영상 융합 인공신경망 모델을 구성하는 GAN 신경망의 일부 구조를 설명하기 위한 도면이다. 도 10은 도 9에 도시된 컨볼루션 레이어의 입력 데이터와 합성곱 연산에 사용되는 커널을 설명하기 위한 도면이 다. 도 11는 도 10에 도시된 커널을 사용하여 특징 맵을 생성하는 컨볼루션 신경망의 동작을 설명하기 위한 도면이 다. 도 12는 본 개시의 일 예시에 따른 영상 융합 인공신경망 모델을 예시적으로 나타낸 개념도이다. 도 13은 본 개시의 일 예시에 따른 NPU의 퓨전 방식을 나타낸 예시도이다. 도 14는 본 개시의 제1 예시에 따른 NPU 아키텍처를 포함하는 시스템을 예시적으로 나타낸 개념도이다. 도 15a는 본 개시의 제1 예시에 따른 영상 융합 인공신경망 모델이 포함하는 건너뛰고 연결하기(skip- connection)를 설명하기 위한 예시도이다. 도 15b는 도 15a에 도시된 영상 융합 인공신경망 모델의 인공신경망 데이터 지역성 정보를 나타낸 예시도이다. 도 16은 본 개시의 제2 예시에 따른 NPU 아키텍처를 포함하는 시스템을 예시적으로 나타낸 개념도이다. 도 17은 본 개시의 제3 예시에 따른 NPU 아키텍처를 포함하는 시스템을 예시적으로 나타낸 개념도이다. 도 18은 본 개시의 제4 예시에 따른 NPU 아키텍처를 포함하는 시스템을 예시적으로 나타낸 개념도이다. 도 19는 도 12에 도시된 영상 융합 인공신경망 모델을 도 18에 도시된 제4 예시에 따라 쓰레드로 구분한 예를 나타낸다. 도 20은 본 개시의 제5 예시에 따른 NPU 아키텍처를 포함하는 시스템을 예시적으로 나타낸 개념도이다. 도 21은 도 20에 도시된 SFU의 파이프라인 구조의 제1 예시를 나타낸 예시도이다. 도 22a는 도 20에 도시된 SFU의 일 예시를 나타낸 예시도이다. 도 22b는 도 20에 도시된 SFU의 다른 예시를 나타낸 예시도이다. 도 23은 본 개시의 제6 예시에 따른 NPU 아키텍처를 포함하는 시스템을 예시적으로 나타낸 개념도이다. 도 24는 본 개시의 제7 예시에 따라 복수의 NPU를 활용하는 예를 나타낸 예시도이다. 도 25는 도 12에 도시된 퓨전(fusion) 인공신경망을 도 24에 도시된 복수의 NPU를 통해 처리하는 예를 나타낸 예시도이다."}
