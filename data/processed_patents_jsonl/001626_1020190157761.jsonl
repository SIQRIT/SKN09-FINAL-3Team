{"patent_id": "10-2019-0157761", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2021-0067788", "출원번호": "10-2019-0157761", "발명의 명칭": "전자 장치, 시스템 및 그 제어 방법", "출원인": "삼성전자주식회사", "발명자": "김민호"}}
{"patent_id": "10-2019-0157761", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "전자 장치에 있어서,학습된 제1 인공 지능 모델을 이용하여 영상을 다운스케일링하고, 다운스케일링된 영상을 부호화하는 프로세서;를 포함하며, 상기 프로세서는, 학습된 제2 인공 지능 모델을 이용하여 획득된 상기 영상의 품질 정보에 기초하여 상기 영상의 다운스케일링을제어하며,상기 제2 인공 지능 모델은,상기 제1 인공 지능 모델로부터 획득된 상기 영상의 특성 정보를 이용하여 학습된, 전자 장치."}
{"patent_id": "10-2019-0157761", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 프로세서는, 상기 제2 인공 지능 모델을 이용하여 획득된 상기 영상의 품질 정보에 기초하여 상기 다운스케일링된 영상의 부호화를 제어하는, 전자 장치."}
{"patent_id": "10-2019-0157761", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제2항에 있어서,상기 영상의 품질 정보는, 상기 영상과 관련된 해상도 정보 및 전송률 정보의 상이한 조합에 대응되는 복수의 품질 지표를 포함하며, 상기 프로세서는, 상기 복수의 품질 지표 중 어느 하나에 대응되는 해상도 정보 및 전송률 정보에 기초하여 상기 영상의 다운 스케일링 비율 및 상기 다운스케일된 영상의 전송률을 결정하며, 상기 결정된 다운 스케일링 비율에 기초하여 상기 영상의 다운스케일링을 제어하고, 상기 결정된 전송률에 기초하여 상기 다운스케일된 영상의 부호화를 제어하는, 전자 장치."}
{"patent_id": "10-2019-0157761", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제2항에 있어서,통신 인터페이스;를 더 포함하며, 상기 프로세서는, 상기 통신 인터페이스가 연결된 네트워크의 상태 정보를 획득하고, 상기 네트워크의 상태 정보 및 상기 영상의품질 정보에 기초하여 상기 영상의 다운스케일링을 제어하는, 전자 장치."}
{"patent_id": "10-2019-0157761", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제4항에 있어서,상기 영상의 품질 정보는, 상기 영상과 관련된 복수의 해상도 정보 및 복수의 전송률 정보의 상이한 조합에 대응되는 복수의 품질 지표를공개특허 10-2021-0067788-3-포함하며, 상기 프로세서는, 상기 네트워크의 상태 정보에 기초하여 상기 복수의 품질 지표 중 적어도 하나의 품질 지표를 결정하고, 타겟품질 지표에 기초하여 상기 적어도 하나의 품질 지표 중 하나의 품질 지표를 결정하며, 상기 결정된 품질 지표에 대응되는 해상도 정보에 기초하여 상기 영상의 다운스케일링을 제어하고, 상기 결정된품질 지표에 대응되는 전송률 정보에 기초하여 상기 다운스케일링된 영상의 부호화를 제어하는, 전자 장치."}
{"patent_id": "10-2019-0157761", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제1항에 있어서, 상기 제2 인공 지능 모델은, 적어도 하나의 신경망 레이어를 포함하며, 상기 적어도 하나의 신경망 레이어의 파라미터는, 상기 제1 인공 지능 모델에 포함된 적어도 일부 레이어의 파라미터와 연계되어 학습되는, 전자 장치."}
{"patent_id": "10-2019-0157761", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제1항에 있어서,상기 프로세서는, 상기 영상의 현재 프레임에 기초하여 획득된 품질 정보에 기초하여 상기 현재 프레임의 다운스케일링을 제어하거나, 상기 영상의 적어도 하나의 이전 프레임에 기초하여 예측된 품질 정보에 기초하여 상기 현재 프레임의 다운스케일링을 제어하는, 전자 장치."}
{"patent_id": "10-2019-0157761", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제7항에 있어서,상기 제2 인공 지능 모델은, 적어도 하나의 이전 프레임에 대응되는 특성 정보에 기초하여 상기 현재 프레임의 품질 정보를 예측하도록 학습된 적어도 하나의 RNN(Recurrent Neural Networks) 레이어를 포함하는, 전자 장치."}
{"patent_id": "10-2019-0157761", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제1항에 있어서,상기 영상의 품질 정보는, 상기 영상과 관련된 복수의 해상도 정보 및 복수의 전송률 정보의 상이한 조합에 대응되는 복수의 품질 지표를포함하며, 상기 제2 인공 지능 모델은, 훈련 영상과 관련된 복수의 해상도 정보 및 복수의 전송률 정보의 상이한 조합에 대응되는 복수의 품질 지표 및상기 훈련 영상을 상기 제2 인공 지능 모델에 입력하여 출력되는 복수의 품질 지표 간 차이를 손실 함수로 하여지도 학습되는, 전자 장치."}
{"patent_id": "10-2019-0157761", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제1항에 있어서,상기 프로세서는, 상기 영상의 품질 정보에 기초하여 상기 영상의 다운스케일링 비율 및 상기 다운스케일된 영상의 전송률을 결정공개특허 10-2021-0067788-4-하고, 상기 결정된 다운스케일링 비율에 따라 상기 영상을 다운스케일링하고 상기 결정된 전송률에 기초하여 상기 다운스케일링된 영상을 부호화하고, 상기 부호화된 영상에 기초하여 패킷을 생성하고 상기 생성된 패킷을 전송하며, 상기 해상도 정보 및 상기 전송률 정보는 상기 패킷의 헤더 영역에 포함되는, 전자 장치."}
{"patent_id": "10-2019-0157761", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "송신 장치 및 수신 장치를 포함하는 시스템에 있어서, 학습된 제1 인공 지능 모델을 이용하여 영상을 다운스케일링하고, 다운스케일링된 영상을 부호화하여 전송하는송신 장치; 및상기 송신 장치로부터 수신된 영상을 복호화하고, 상기 복호화된 영상을 업스케일링하여 출력 영상을 획득하는수신 장치;를 포함하며,상기 송신 장치는, 학습된 제2 인공 지능 모델을 이용하여 획득된 상기 영상의 품질 정보에 기초하여 상기 영상의 다운스케일링을제어하며,상기 제2 인공 지능 모델은, 상기 제1 인공 지능 모델로부터 획득된 상기 영상의 특성 정보를 이용하여 학습된, 시스템."}
{"patent_id": "10-2019-0157761", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제11항에 있어서, 상기 송신 장치는, 상기 제2 인공 지능 모델을 이용하여 획득된 상기 영상의 품질 정보에 기초하여 상기 다운스케일링된 영상의 부호화를 제어하는, 전자 장치."}
{"patent_id": "10-2019-0157761", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "제11항에 있어서, 상기 수신된 영상은, 전송률 정보 또는 해상도 정보 중 적어도 하나를 포함하며, 상기 수신 장치는, 상기 수신된 영상에 포함된 상기 전송률 정보에 기초하여 상기 복호화된 영상을 복호화하고, 상기 수신된 영상에 포함된 상기 해상도 정보에 기초하여 상기 복호화된 영상을 업스케일링하는, 시스템."}
{"patent_id": "10-2019-0157761", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_14", "content": "전자 장치의 제어 방법에 있어서,학습된 제1 인공 지능 모델을 이용하여 영상을 다운스케일링하는 단계; 및상기 다운스케일링된 영상을 부호화하는 단계;를 포함하고, 상기 영상을 다운스케일링하는 단계는, 학습된 제2 인공 지능 모델을 이용하여 획득된 상기 영상의 품질 정보에 기초하여 상기 영상의 다운스케일링을제어하며, 상기 제2 인공 지능 모델은, 상기 제1 인공 지능 모델로부터 획득된 상기 영상의 특성 정보를 이용하여 학습된, 제어 방법."}
{"patent_id": "10-2019-0157761", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_15", "content": "공개특허 10-2021-0067788-5-제14항에 있어서,상기 다운스케일링된 영상을 부호화하는 단계는, 상기 제2 인공 지능 모델을 이용하여 획득된 상기 영상의 품질 정보에 기초하여 상기 다운스케일링된 영상의 부호화를 제어하는, 제어 방법."}
{"patent_id": "10-2019-0157761", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_16", "content": "제15항에 있어서,상기 영상의 품질 정보는, 상기 영상과 관련된 해상도 정보 및 전송률 정보의 상이한 조합에 대응되는 복수의 품질 지표를 포함하며, 상기 영상을 다운스케일링하는 단계는, 상기 복수의 품질 지표 중 어느 하나의 품질 지표에 기초하여 상기 영상의 다운 스케일링 비율을 결정하고, 상기 결정된 다운 스케일링 비율에 기초하여 상기 영상의 다운스케일링을 제어하며, 상기 다운스케일링된 영상을 부호화하는 단계는, 상기 어느 하나의 품질 지표에 기초하여 상기 다운스케일된 영상의 전송률을 결정하고 상기 결정된 전송률에 기초하여 상기 다운스케일링된 영상의 부호화를 제어하는, 제어 방법."}
{"patent_id": "10-2019-0157761", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_17", "content": "제15항에 있어서,네트워크의 상태 정보를 획득하는 단계;를 더 포함하며, 상기 영상을 다운스케일링하는 단계는, 상기 네트워크의 상태 정보 및 상기 영상의 품질 정보에 기초하여 상기 영상의 다운스케일링을 제어하고, 상기 다운스케일링된 영상을 부호화하는 단계는, 상기 네트워크의 상태 정보 및 상기 영상의 품질 정보에 기초하여 상기 다운스케일링된 영상의 부호화를 제어하는, 제어 방법."}
{"patent_id": "10-2019-0157761", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_18", "content": "제17항에 있어서,상기 영상의 품질 정보는, 상기 영상과 관련된 복수의 해상도 정보 및 복수의 전송률 정보의 상이한 조합에 대응되는 복수의 품질 지표를포함하며, 상기 네트워크의 상태 정보에 기초하여 상기 복수의 품질 지표 중 적어도 하나의 품질 지표를 결정하고, 타겟품질 지표에 기초하여 상기 적어도 하나의 품질 지표 중 하나의 품질 지표를 결정하는 단계;를 더 포함하며, 상기 영상을 다운스케일링하는 단계는, 상기 결정된 품질 지표에 대응되는 해상도 정보에 기초하여 상기 영상의 다운스케일링을 제어하고, 상기 다운스케일링된 영상을 부호화하는 단계는, 상기 결정된 품질 지표에 대응되는 전송률 정보에 기초하여 상기 다운스케일링된 영상의 부호화를 제어하는, 제어 방법."}
{"patent_id": "10-2019-0157761", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_19", "content": "제14항에 있어서, 상기 제2 인공 지능 모델은, 공개특허 10-2021-0067788-6-적어도 하나의 신경망 레이어를 포함하며, 상기 적어도 하나의 신경망 레이어의 파라미터는, 상기 제1 인공 지능 모델에 포함된 적어도 일부 레이어의 파라미터와 연계되어 학습되는, 제어 방법."}
{"patent_id": "10-2019-0157761", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_20", "content": "제14항에 있어서,상기 영상을 다운스케일링하는 단계는, 상기 영상의 현재 프레임에 기초하여 획득된 품질 정보에 기초하여 상기 현재 프레임의 다운스케일링을 제어하거나, 상기 영상의 적어도 하나의 이전 프레임에 기초하여 예측된 품질 정보에 기초하여 상기 현재 프레임의 다운스케일링을 제어하는, 제어 방법."}
{"patent_id": "10-2019-0157761", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "전자 장치가 개시된다. 전자 장치는, 학습된 제1 인공 지능 모델을 이용하여 영상을 다운스케일링하고, 다운스케 일링된 영상을 부호화하는 프로세서를 포함하며, 프로세서는, 학습된 제2 인공 지능 모델을 이용하여 획득된 영 상의 품질 정보에 기초하여 영상의 다운스케일링을 제어하며, 제2 인공 지능 모델은, 제1 인공 지능 모델로부터 획득된 영상의 특성 정보를 이용하여 학습될 수 있다."}
{"patent_id": "10-2019-0157761", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 개시는 전자 장치 및 그 제어 방법에 관한 것으로, 더욱 상세하게는 인공 지능 모델을 이용하여 영상 처리를 수행하는 전자 장치, 시스템 및 그 제어 방법에 관한 것이다."}
{"patent_id": "10-2019-0157761", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "전자 기술의 발달에 힘입어 다양한 유형의 전자 기기가 개발 및 보급되고 있다. 특히, 가정, 사무실, 공공 장소 등 다양한 장소에서 이용되는 디스플레이 장치는 최근 수년 간 지속적으로 발전하고 있다. 최근 지상파/케이블/IPTV/위성방송과 같은 전통 유로 방송을 끊는 코드 커팅 (Cord-Cutting) 트렌드와, 공공 인 터넷 망을 통한 넷플릭스/아마존 프라임과 같은 OTT (Over-The-Top) 서비스 및 유튜브/트위터/페이스북과 같은 1인 미디어 방송 플랫폼의 확산 추세로 실시간 라이브 스트리밍 응용에 대한 소비자의 요구 사항이 늘어나고 있 다. OTT 업체들은 실시간 방송이나 스포츠 이벤트와 같이 실시간성이 중요한 컨텐츠에 대해 라이브 스트리밍 서비스 를 제공하고 있으며, 향후 실시간 Betting 등 시청자와의 상호 작용이 필요한 서비스로의 확장을 준비 중이다. 1인 미디어 방송 플랫폼은 이미 채팅창을 통해 시청자와의 상호 작용을 할 수 있도록 서비스 중이며, 다자간 화 상 통화 / 화상 회의가 가능한 플랫폼으로 진화하고 있다. 이러한 실시간 라이브 스트리밍 응용에서 시청자의 체감 품질을 좌우하는 가장 중요한 요소는 영상의 품질과 지 연 시간이다. 예를 들어, Supply Chain(Live event>Capturing>Encoding>First-Mile Delivery>CDN propagation>Last-Mile Delivery>User Device)과 같이 공공 인터넷 망을 사용하여 서비스하기 때문에 주어진 네트워크 환경에서 최적의 영상 품질로 스트리밍 해야 하며, 실시간성이 중요한 서비스이므로 소비자의 체감 지 연 시간을 최소화해야 한다. 예를 들어 스포츠 이벤트와 같은 서비스는 지연 시간을 1초 이내로 하여 스포일러 효과(Spoiler Effect)를 최소화 해야 하며, 화상 통화와 같은 Interactive 서비스에서는 소비자가 지연을 체감 하지 못하려면 최소 200ms 이하의 지연 시간으로 서비스해야 한다. 위와 같은 인터넷을 통한 서비스의 확산과 IoT/All-IP 트렌드로 인해 휴대폰이나 태블릿과 같은 모바일 기기 뿐 만 아니라 노트 PC, 스마트 TV 등에도 기본적으로 IP 통신이 가능한 WiFi 등의 통신 모듈을 탑재하고 있으며, 이를 이용하여 댁 내에서 기기간 Direct로 스트리밍 하는 응용 시나리오도 발전하고 있다. 스크린 미러링은 기기간 Direct 스트리밍 응용 시나리오의 대표적인 예로, 휴대폰, 태블릿과 같은 상대적으로 작은 화면에서 보던 컨텐츠를 TV와 같은 대형 스크린으로 전송하여 보는 방식이다. TV 업계에서는 얇은 Display Form Factor를 유지하고자 전원부, 케이블 커넥터 등과 같이 부피가 큰 부분을 외부 Box로 분리하는 설계를 하 는데, 외부 Box 와 Display 간의 거추장스러운 케이블 연결을 무선 통신 모듈을 활용한 Direct 데이터 스트리밍 으로 대체할 수 있다. 이와 같은 기기간 Direct 스트리밍 응용에서의 Data Path 와 인터넷을 통한 실시간 라이브 스트리밍 응용 예의 Supply Chain 을 비교하면, 네트워크 환경만 다를 뿐 종단 시스템의 기술적인 유사성이 매우 높으며, 시청자의체감 품질에 대한 요구 사항은 상대적으로 더 높다. 예를 들어 Wireless TV 시나리오의 영상 품질은 시각적 무 손실(Visually Lossless)에 가까워야 하며, 지연 시간은 10 ms 이내 수준이 되어야 소비자의 체감 품질 저하를 방지할 수 있다."}
{"patent_id": "10-2019-0157761", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 개시는 상술한 필요성에 따른 것으로, 본 개시의 목적은 실시간으로 스트리밍되는 영상의 품질을 예측하여 최적의 해상도 및 전송률로 영상을 처리할 수 있는 전자 장치, 시스템 및 그 제어 방법을 제공함에 있다."}
{"patent_id": "10-2019-0157761", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "이상과 같은 목적을 달성하기 위한 일 실시예에 따른 전자 장치는, 학습된 제1 인공 지능 모델을 이용하여 영상 을 다운스케일링하고, 다운스케일링된 영상을 부호화하는 프로세서를 포함하며, 상기 프로세서는, 학습된 제2 인공 지능 모델을 이용하여 획득된 상기 영상의 품질 정보에 기초하여 상기 영상의 다운스케일링을 제어하며, 상기 제2 인공 지능 모델은, 상기 제1 인공 지능 모델로부터 획득된 상기 영상의 특성 정보를 이용하여 학습될 수 있다. 또한, 상기 프로세서는, 상기 제2 인공 지능 모델을 이용하여 획득된 상기 영상의 품질 정보에 기초하여 상기 다운스케일링된 영상의 부호화를 제어할 수 있다. 또한, 상기 영상의 품질 정보는, 상기 영상과 관련된 해상도 정보 및 전송률 정보의 상이한 조합에 대응되는 복 수의 품질 지표를 포함하며, 상기 프로세서는, 상기 복수의 품질 지표 중 어느 하나에 대응되는 해상도 정보 및 전송률 정보에 기초하여 상기 영상의 다운 스케일링 비율 및 상기 다운스케일된 영상의 전송률을 결정하며, 상 기 결정된 다운 스케일링 비율에 기초하여 상기 영상의 다운스케일링을 제어하고, 상기 결정된 전송률에 기초하 여 상기 다운스케일된 영상의 부호화를 제어할 수 있다. 또한, 통신 인터페이스를 더 포함하며, 상기 프로세서는, 상기 통신 인터페이스가 연결된 네트워크의 상태 정보 를 획득하고, 상기 네트워크의 상태 정보 및 상기 영상의 품질 정보에 기초하여 상기 영상의 다운스케일링을 제 어할 수 있다. 또한, 상기 영상의 품질 정보는, 상기 영상과 관련된 복수의 해상도 정보 및 복수의 전송률 정보의 상이한 조합 에 대응되는 복수의 품질 지표를 포함하며, 상기 프로세서는, 상기 네트워크의 상태 정보에 기초하여 상기 복수 의 품질 지표 중 적어도 하나의 품질 지표를 결정하고, 타겟 품질 지표에 기초하여 상기 적어도 하나의 품질 지 표 중 하나의 품질 지표를 결정하며, 상기 결정된 품질 지표에 대응되는 해상도 정보에 기초하여 상기 영상의 다운스케일링을 제어하고, 상기 결정된 품질 지표에 대응되는 전송률 정보에 기초하여 상기 다운스케일링된 영 상의 부호화를 제어할 수 있다. 또한, 상기 제2 인공 지능 모델은, 적어도 하나의 신경망 레이어를 포함하며, 상기 적어도 하나의 신경망 레이 어의 파라미터는, 상기 제1 인공 지능 모델에 포함된 적어도 일부 레이어의 파라미터와 연계되어 학습될 수 있 다. 또한, 상기 프로세서는, 상기 영상의 현재 프레임에 기초하여 획득된 품질 정보에 기초하여 상기 현재 프레임의 다운스케일링을 제어하거나, 상기 영상의 적어도 하나의 이전 프레임에 기초하여 예측된 품질 정보에 기초하여 상기 현재 프레임의 다운스케일링을 제어할 수 있다. 또한, 상기 제2 인공 지능 모델은, 적어도 하나의 이전 프레임에 대응되는 특성 정보에 기초하여 상기 현재 프 레임의 품질 정보를 예측하도록 학습된 적어도 하나의 RNN(Recurrent Neural Networks) 레이어를 포함할 수 있 다. 또한, 상기 영상의 품질 정보는, 상기 영상과 관련된 복수의 해상도 정보 및 복수의 전송률 정보의 상이한 조합 에 대응되는 복수의 품질 지표를 포함하며, 상기 제2 인공 지능 모델은, 훈련 영상과 관련된 복수의 해상도 정 보 및 복수의 전송률 정보의 상이한 조합에 대응되는 복수의 품질 지표 및 상기 훈련 영상을 상기 제2 인공 지 능 모델에 입력하여 출력되는 복수의 품질 지표 간 차이를 손실 함수로 하여 지도 학습될 수 있다. 또한, 상기 프로세서는, 상기 영상의 품질 정보에 기초하여 상기 영상의 다운스케일링 비율 및 상기 다운스케일 된 영상의 전송률을 결정하고, 상기 결정된 다운스케일링 비율에 따라 상기 영상을 다운스케일링하고, 상기 결정된 전송률에 기초하여 상기 다운스케일링된 영상을 부호화하고, 상기 부호화된 영상에 기초하여 패킷을 생성 하고, 상기 생성된 패킷을 전송하며, 상기 해상도 정보 및 상기 전송률 정보는 상기 패킷의 헤더 영역에 포함될 수 있다. 한편, 본 개시의 일 실시 예에 따른 송신 장치 및 수신 장치를 포함하는 시스템은, 학습된 제1 인공 지능 모델 을 이용하여 영상을 다운스케일링하고, 다운스케일링된 영상을 부호화하여 전송하는 송신 장치 및, 상기 송신 장치로부터 수신된 영상을 복호화하고, 상기 복호화된 영상을 업스케일링하여 출력 영상을 획득하는 수신 장치 를 포함하며, 상기 송신 장치는, 학습된 제2 인공 지능 모델을 이용하여 획득된 상기 영상의 품질 정보에 기초 하여 상기 영상의 다운스케일링을 제어하며,상기 제2 인공 지능 모델은, 상기 제1 인공 지능 모델로부터 획득된 상기 영상의 특성 정보를 이용하여 학습될 수 있다. 또한, 상기 송신 장치는, 상기 제2 인공 지능 모델을 이용하여 획득된 상기 영상의 품질 정보에 기초하여 상기 다운스케일링된 영상의 부호화를 제어할 수 있다. 또한, 상기 수신된 영상은, 전송률 정보 또는 해상도 정보 중 적어도 하나를 포함하며, 상기 수신 장치는, 상기 수신된 영상에 포함된 상기 전송률 정보에 기초하여 상기 복호화된 영상을 복호화하고, 상기 수신된 영상에 포 함된 상기 해상도 정보에 기초하여 상기 복호화된 영상을 업스케일링할 수 있다. 또한, 본 개시의 일 실시 예에 따른 전자 장치의 제어 방법은, 학습된 제1 인공 지능 모델을 이용하여 영상을 다운스케일링하는 단계 및, 상기 다운스케일링된 영상을 부호화하는 단계를 포함하고, 상기 영상을 다운스케일 링하는 단계는, 학습된 제2 인공 지능 모델을 이용하여 획득된 상기 영상의 품질 정보에 기초하여 상기 영상의 다운스케일링을 제어하며, 상기 제2 인공 지능 모델은, 상기 제1 인공 지능 모델로부터 획득된 상기 영상의 특 성 정보를 이용하여 학습될 수 있다. 또한, 상기 다운스케일링된 영상을 부호화하는 단계는, 상기 제2 인공 지능 모델을 이용하여 획득된 상기 영상 의 품질 정보에 기초하여 상기 다운스케일링된 영상의 부호화를 제어할 수 있다. 또한, 상기 영상의 품질 정보 는, 상기 영상과 관련된 해상도 정보 및 전송률 정보의 상이한 조합에 대응되는 복수의 품질 지표를 포함하며, 상기 영상을 다운스케일링하는 단계는, 상기 복수의 품질 지표 중 어느 하나의 품질 지표에 기초하여 상기 영상 의 다운 스케일링 비율을 결정하고, 상기 결정된 다운 스케일링 비율에 기초하여 상기 영상의 다운스케일링을 제어하며, 상기 다운스케일링된 영상을 부호화하는 단계는, 상기 어느 하나의 품질 지표에 기초하여 상기 다운 스케일된 영상의 전송률을 결정하고, 상기 결정된 전송률에 기초하여 상기 다운스케일링된 영상의 부호화를 제 어할 수 있다. 또한, 네트워크의 상태 정보를 획득하는 단계를 더 포함하며, 상기 영상을 다운스케일링하는 단계는, 상기 네트 워크의 상태 정보 및 상기 영상의 품질 정보에 기초하여 상기 영상의 다운스케일링을 제어하고, 상기 다운스케 일링된 영상을 부호화하는 단계는, 상기 네트워크의 상태 정보 및 상기 영상의 품질 정보에 기초하여 상기 다운 스케일링된 영상의 부호화를 제어할 수 있다. 또한, 상기 영상의 품질 정보는, 상기 영상과 관련된 복수의 해상도 정보 및 복수의 전송률 정보의 상이한 조합 에 대응되는 복수의 품질 지표를 포함할 수 있다. 이 경우, 상기 제어 방법은, 상기 네트워크의 상태 정보에 기 초하여 상기 복수의 품질 지표 중 적어도 하나의 품질 지표를 결정하고, 타겟 품질 지표에 기초하여 상기 적어 도 하나의 품질 지표 중 하나의 품질 지표를 결정하는 단계를 더 포함하며, 상기 영상을 다운스케일링하는 단계 는, 상기 결정된 품질 지표에 대응되는 해상도 정보에 기초하여 상기 영상의 다운스케일링을 제어하고, 상기 다 운스케일링된 영상을 부호화하는 단계는, 상기 결정된 품질 지표에 대응되는 전송률 정보에 기초하여 상기 다운 스케일링된 영상의 부호화를 제어할 수 있다. 또한, 상기 제2 인공 지능 모델은, 적어도 하나의 신경망 레이어를 포함하며, 상기 적어도 하나의 신경망 레이 어의 파라미터는, 상기 제1 인공 지능 모델에 포함된 적어도 일부 레이어의 파라미터와 연계되어 학습될 수 있 다. 또한, 상기 영상을 다운스케일링하는 단계는, 상기 영상의 현재 프레임에 기초하여 획득된 품질 정보에 기초하 여 상기 현재 프레임의 다운스케일링을 제어하거나, 상기 영상의 적어도 하나의 이전 프레임에 기초하여 예측된 품질 정보에 기초하여 상기 현재 프레임의 다운스케일링을 제어할 수 있다."}
{"patent_id": "10-2019-0157761", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "상술한 다양한 실시 예에 따르면, 상술한 다양한 실시 예에 따르면, 실시간으로 예측된 영상 품질, 네트워크 상 태를 기반으로 최적 해상도와 전송률을 제어할 수 있게 된다. 이에 따라 네트워크 대역폭을 효율적으로 사용할 수 있으며, 주어진 네트워크 환경에서 소비자 체감 품질을 최대화할 수 있다. 또한 다운스케일링 과정 중에 획득된 영상의 특성 정보를 공유하여 영상 품질을 예측함으로써, 인공 지능 모델 의 효율적 학습이 가능하며 H/W 구현 복잡도를 최소화할 수 있다."}
{"patent_id": "10-2019-0157761", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "본 개시는 다양한 변경을 가할 수 있고 여러 가지 실시예를 가질 수 있는 바, 특정 실시예들을 도면에 예시하고, 이를 상세한 설명을 통해 상세히 설명하고자 한다. 그러나, 이는 본 개시의 실시 형태에 대해 한정 하려는 것이 아니며, 본 개시는 여러 실시예들의 사상 및 기술 범위에 포함되는 모든 변경, 균등물 내지 대체물 을 포함하는 것으로 이해되어야 한다.실시예를 설명함에 있어서, 관련된 공지 기술에 대한 구체적인 설명이 본 개시의 요지를 불필요하게 흐릴 수 있 다고 판단되는 경우 그 상세한 설명을 생략한다. 또한, 명세서의 설명 과정에서 이용되는 숫자(예를 들어, 제 1, 제2 등)는 하나의 구성요소를 다른 구성요소와 구분하기 위한 식별기호에 불과하다. 또한, 본 명세서에서, 일 구성요소가 다른 구성요소와 \"연결된다\" 거나 \"접속된다\" 등으로 언급된 때에는, 상기 일 구성요소가 상기 다른 구성요소와 직접 연결되거나 또는 직접 접속될 수도 있지만, 특별히 반대되는 기재가 존재하지 않는 이상, 중간에 또 다른 구성요소를 매개하여 연결되거나 또는 접속될 수도 있다고 이해되어야 할 것이다. 또한, 본 명세서에서 '~부(유닛)', '모듈' 등으로 표현되는 구성요소는 2개 이상의 구성요소가 하나의 구성요소 로 합쳐지거나 또는 하나의 구성요소가 보다 세분화된 기능별로 2개 이상으로 분화될 수도 있다. 또한, 이하에 서 설명할 구성요소 각각은 자신이 담당하는 주기능 이외에도 다른 구성요소가 담당하는 기능 중 일부 또는 전 부의 기능을 추가적으로 수행할 수도 있으며, 구성요소 각각이 담당하는 주기능 중 일부 기능이 다른 구성요소 에 의해 전담되어 수행될 수도 있음은 물론이다. 또한, 본 명세서에서, '영상(image)' 또는 '픽처'는 정지영상, 복수의 연속된 정지영상(또는 프레임)으로 구성 된 동영상, 또는 비디오를 나타낼 수 있다. 또한, 본 명세서에서 'DNN(deep neural network)'은 뇌 신경을 모사한 인공신경망 모델의 대표적인 예시로써, 특정 알고리즘을 사용한 인공신경망 모델로 한정되지 않는다. 또한, 본 명세서에서 '파라미터'는 뉴럴 네트워크를 이루는 각 레이어의 연산 과정에서 이용되는 값으로서 예를 들어, 입력 값을 소정 연산식에 적용할 때 이용되는 가중치를 포함할 수 있다. 또한, 파라미터는 매트릭스 형태 로 표현될 수 있다. 파라미터는 훈련의 결과로 설정되는 값으로서, 필요에 따라 별도의 훈련 데이터(training data)를 통해 갱신될 수 있다. 또한, 본 명세서에서 '제1 DNN'은 영상의 AI 다운스케일을 위해 이용되는 DNN을 의미하고, '제2 DNN'은 영상의 AI 업스케일을 위해 이용되는 DNN을 의미한다. 또한, 본 명세서에서 'DNN 설정 정보'는 DNN을 구성하는 요소와 관련된 정보로서 전술한 파라미터를 포함한다. DNN 설정 정보를 이용하여 제1 DNN 또는 제2 DNN이 설정될 수 있다. 또한, 본 명세서에서 '영상'은 AI 부호화의 대상이 되는 영상을 의미하고, '제1 영상'은 AI 부호화 과정에서 영 상의 AI 다운스케일 결과 획득된 영상을 의미한다. 또한, '제2 영상'은 AI 복호화 과정에서 제1 복호화를 통해 획득된 영상을 의미하고, '제3영상'은 AI 복호화 과정에서 제2 영상을 AI 업스케일하여 획득된 영상을 의미한다. 또한, 본 명세서에서 'AI 다운스케일'은 AI 기반으로 영상의 해상도를 감소시키는 처리를 의미하고, '제1 부호 화'는 주파수 변환 기반의 영상 부호화 방법에 의한 부호화 처리를 의미한다. 또한, '제1 복호화'는 주파수 변 환 기반의 영상 복원 방법에 의한 복호화 처리를 의미하고, 'AI 업스케일'은 AI 기반으로 영상의 해상도를 증가 시키는 처리를 의미한다. 도 1a 내지 도 1c는 일 실시예에 따른 인공 지능 신경망 기반 영상 처리 방법을 설명하기 위한 도면들이다. 4K, 8K 등의 고화질/고해상도 영상을 네트워크를 통해 스트리밍하기 위해서는, 네트워크 요구 대역폭을 줄일 수 있는 영상 부호화 기술과 Up/Down Scaling 기술이 중요하다. 영상 부호화 기술은 H.264/265, VP8/9, AV1 과 같 은 표준 코덱이 널리 사용되고 있으며, OTT 업체의 경우 4K 영상을 H.265 기준 약 15 Mbps 까지 압 하여 서비 스를 하고 있다. 사용자마다 서로 다른 네트워크 환경에 맞게 서비스를 하려면, 여러 조합의 영상 해상도와 전 송률로 압축을 해야 하는데 이 때 사용되는 기술이 Up/Down Scaling 기술이다. 예를 들어 8K 영상을 약 15 Mbps 수준으로 전송하고자 할 때, 송신단에서는 영상을 Down-Scaling 하여 해상도를 4K로 Down-Scaling 하여 코 덱 인코더로 전달하며, 수신단에서는 코덱 디코더의 4K 출력을 8K 영상으로 복구하기 위해 Up-Scaling을 한 다. Up/Down Scaling 시 Bi-Linear 또는 Bi-Cubic 과 같은 간단한 Interpolation 방식을 사용하기도 하지만, 최근 연구에 따르면 합성곱 신경망(CNN)을 활용하여 Up/Down Scaling 을 함으로써 소비자의 체감 품질을 더욱 개선 할 수 있는 것으로 알려져 있다. 특히 이 방법은 어떤 압축 코덱을 사용하더라도 쉽게 호환되는 장점이 있 어, 현재 널리 사용되는 H.265/VP9 표준 코덱에 적용하여 쉽게 확장될 수 있다. 일반적으로 영상 해상도와 영상 종류에 따라 압축 효율이 상이하다. 예를 들어 도 1b에 도시된 바와 같이 특징 이 상이한 두 영상을 똑같은 해상도와 전송률로 압축한 경우, 소비자 체감 품질 저하는 상대적으로 복잡한 우측 영상의 경우에 더 민감할 가능성이 높다. 반대로 좌측 영상과 같이 상대적으로 덜 복잡한 영상의 경우 압축 효 율이 좋으므로 전송률을 낮추어 보냄으로써 불필요하게 낭비되는 네트워크 대역폭을 절감할 수 있다. 또한, 영상 종류에 따라 전송률을 최적화할 때 해상도도 함께 고려되는데, 도 1c의 좌측 그래프와 같이 일반적 으로 해상도가 높을수록 전송률을 높이는 것이 사용자 체감 품질 향상에 도움이 되기 때문이다. 이에 컨텐츠 제 공자는 도 1c의 우측 그래프와 같이 다양한 해상도와 전송률 조합에 대해 Optimal Point를 찾아 인코딩을 함으 로써 각 사용자의 주어진 네트워크 환경에 대해 최적 품질로 서비스할 수 있도록 노력하고 있다. 다만, VoD 서비스의 경우, 영상을 미리 인코딩하여 서버에 저장해 두고 서비스를 하므로 충분한 시간과 컴퓨팅 파워를 투자하여 Offline으로 영상 품질을 최적화할 수 잇지만, 실시간 라이브 스트리밍 응용에서는 지연 시간 및 컴퓨팅 리소스 제약으로 인해 이와 같은 방법을 사용할 수 없게 된다. 이하에서는, 컨텐츠의 실시간 스트리밍시 최적의 품질로 컨텐츠를 제공할 수 있는 다양한 실시 예에 대해 설명 하도록 한다. 도 2a 및 도 2b는 일 실시예에 따른 전자 장치의 구성을 나타내는 블럭도들이다. 도 2a에 따르면, 전자 장치는 프로세서를 포함하고, 도 2b에 따르면, 전자 장치는 프로세서 및 메모리를 포함한다. 본 개시의 실시 예에 따른 인공 지능 모델에 관한 정보가 프로세서 내부 메모리에 저장되거나, 외부 메모 리, 즉 메모리에 저장될 수 있으므로, 도 2a 및 도 2b를 구분하여 도시하였으나, 이하에서는, 도 2b를 기 준으로 설명하도록 한다. 전자 장치는 서버, 예를 들어, 컨텐츠 제공 서버, PC 등 컨텐츠를 제공할 수 있는 다양한 타입의 장치로 구현될 수 있다. 또는 전자 장치는 클라우딩 컴퓨팅 환경이 구축된 시스템 자체일 수도 있다. 이에 한정되 는 것은 아니며, 전자 장치는 셋톱 박스(Set-top box), DVD(digital video disk) 플레이어, 게임 콘솔(예: XboxTM, PlayStationTM), VR(Virtual Reality) 장치, 태블릿 PC(tablet personal computer), 이동 전 화기(mobile phone), 전자북(e-book), 데스크탑 PC(desktop personal computer), 랩탑 PC(laptop personal computer), 넷북 컴퓨터(netbook computer), PDA(personal digital assistant), PMP(portable multimedia player), MP3 플레이어, 모바일 의료기기, 냉장고 등과 같은 가전 기기, 카메라(camera), 캠코더(camcorder), 전자 액자 또는 웨어러블 장치(wearable device)(예를 들어, head-mounted-device(HMD) 스마트 와치(smart watch), 전자 의복, 전자 팔찌, 전자 목걸이, 글래스(glass) 등), NED(Near Eye Display) 등 영상을 처리하여 외부 전자 장치로 전송하는 다양한 유형의 영상 처리 장치로 구현될 수도 있음은 물론이다. 일 예에 따라 전자 장치는 영상을 다양한 해상도의 영상, 다양한 압축 영상으로 변환하여 전송할 수 있다. 전자 장치에 의해 처리되는 영상은 컨텐츠 제공자에 의해 제작된 영상일 수 있으나, 반드시 이에 한정되는 것은 아니며 영상에 추가 영상 처리된 영상일 수도 있다. 다만 이하에서는 설명의 편의를 위하여 전자 장치 에 의해 처리되는 영상이 영상인 것으로 상정하여 설명하도록 한다. 예를 들어, 전자 장치는 영상(또는 입력 영상)을 720x480의 SD(Standard Definition), 1280x720의 HD(High Definition), 1920x1080의 FHD(Full High Definition), 2560x1440의 QHD(Quad High Definition), 3840x2160의 4K UHD(Ultra High Definition), 7680x4320의 8K UHD(Ultra High Definition) 뿐 아니라, 그 이 상의 해상도(예를 들어, 16K, 32K) 영상 중 적어도 하나의 영상으로 변환하여 전송할 수 있다. 또한, 전자 장치 는 영상을 MPEG(Moving Picture Experts Group)(예를 들어, MP2, MP4, MP7 등), JPEG(joint photographic coding experts group), AVC(Advanced Video Coding), H.264, H.265, HEVC(High Efficiency Video Codec), VC-1, VP8, VP9 및 AV1(AOMedia Video 1) 등으로 압축된 형태로 압축하여 전송할 수 있다. 메모리는 본 개시의 다양한 실시 예를 위해 필요한 데이터를 저장할 수 있다. 메모리는 데이터 저장 용도에 따라 전자 장치에 임베디드된 메모리 형태로 구현되거나, 전자 장치에 탈부착이 가능한 메모 리 형태로 구현될 수도 있다. 예를 들어, 전자 장치의 구동을 위한 데이터의 경우 전자 장치에 임베 디드된 메모리에 저장되고, 전자 장치의 확장 기능을 위한 데이터의 경우 전자 장치에 탈부착이 가능 한 메모리에 저장될 수 있다. 한편, 전자 장치에 임베디드된 메모리의 경우 휘발성 메모리(예: DRAM(dynamic RAM), SRAM(static RAM), 또는 SDRAM(synchronous dynamic RAM) 등), 비휘발성 메모리(non- volatile Memory)(예: OTPROM(one time programmable ROM), PROM(programmable ROM), EPROM(erasable and programmable ROM), EEPROM(electrically erasable and programmable ROM), mask ROM, flash ROM, 플래시 메모리(예: NAND flash 또는 NOR flash 등), 하드 드라이브, 또는 솔리드 스테이트 드라이브(solid state drive(SSD)) 중 적어도 하나로 구현될 수 있다. 또한, 전자 장치에 탈부착이 가능한 메모리의 경우 메모리 카드(예를 들어, CF(compact flash), SD(secure digital), Micro-SD(micro secure digital), Mini-SD(mini secure digital), xD(extreme digital), MMC(multi-media card) 등), USB 포트에 연결가능한 외부 메모리(예를 들어, USB 메모리) 등과 같은 형태로 구현될 수 있다. 일 예에 따라, 메모리는 전자 장치를 제어하기 위한 적어도 하나의 인스트럭션(instruction) 또는 인 스트럭션들을 포함하는 컴퓨터 프로그램을 저장할 수 있다 다른 예에 따라, 메모리는 복수의 레이어를 포함하는 인공 지능 모델에 관한 정보를 저장할 수 있다. 여기 서, 인공 지능 모델에 관한 정보를 저장한다는 것은 인공 지능 모델의 동작과 관련된 다양한 정보, 예를 들어 인공 지능 모델에 포함된 복수의 레이어에 대한 정보, 복수의 레이어 각각에서 이용되는 파라미터(예를 들어, 필터 계수, 바이어스 등)에 대한 정보 등을 저장한다는 것을 의미할 수 있다. 예를 들어, 메모리는 본 개 시의 일 실시예에 따라 영상을 다운스케일링(downscaling)하도록 학습된 제1 인공 지능 모델에 대한 정보를 저 장할 수 있다. 또한, 메모리는 본 개시의 일 실시예에 따라 영상의 품질 정보를 획득하도록 학습된 제2 인 공 지능 모델에 대한 정보를 저장할 수 있다. 다만, 후술하는 프로세서의 구현 형태에 따라 인공 지능 모 델에 관한 정보가 프로세서의 내부 메모리에 저장될 수 있음은 물론이다. 예를 들어, 프로세서가 전 용 하드웨어로 구현되는 경우, 인공 지능 모델에 관한 정보는 프로세서 내부 메모리에 저장될 수도 있다. 또 다른 예에 따라, 메모리는 외부 서버, 외부 장치, 외부 저장 매체(예를 들어, USB), 외부 서버(예를 들 어 웹 하드) 등으로부터 수신된 영상을 저장할 수 있다. 여기서, 영상은 디지털 동영상이 될 수 있으나 이에 한 정되는 것은 아니다. 또 다른 예에 따라, 메모리는 다운 스케일링에 필요한 정보, 압축 처리에 필요한 정보, 화질 처리에 필요 한 다양한 정보, 예를 들어 Noise Reduction, Detail Enhancement, Tone Mapping, Contrast Enhancement, Color Enhancement 또는 Frame rate Conversion 중 적어도 하나를 수행하기 위한 정보, 알고리즘, 화질 파라미 터 등을 저장할 수 있다. 또한, 메모리는 영상 처리에 의해 생성된 최종 출력 영상을 저장할 수도 있다. 본 개시의 일 실시예에 따르면, 메모리는 본 개시에 따른 다양한 동작들에서 생성되는 데이터를 저장하는 단일 메모리로 구현될 수 있다. 다만, 본 개시의 다른 실시 예에 따르면, 메모리는 상이한 타입의 데이터 를 각각 저장하거나, 상이한 단계에서 생성되는 데이터를 각각 저장하는 복수의 메모리를 포함하도록 구현될 수 도 있다. 상술한 실시 예에서는 다양한 데이터가 프로세서의 외부 메모리에 저장되는 것으로 설명하였으나, 상 술한 데이터 중 적어도 일부는 전자 장치 또는 프로세서 중 적어도 하나의 구현 예에 따라 프로세서 내부 메모리에 저장될 수도 있다. 프로세서는 메모리와 전기적으로 연결되어 전자 장치의 전반적인 동작을 제어한다. 프로세서 는 하나 또는 복수의 프로세서로 구성될 수 있다. 구체적으로, 프로세서는 메모리에 저장된 적 어도 하나의 인스트럭션(instruction)을 실행함으로써, 본 개시의 다양한 실시 예에 따른 전자 장치의 동 작을 수행할 수 있다. 일 실시예에 따라 프로세서는 디지털 영상 신호를 처리하는 디지털 시그널 프로세서(digital signal processor(DSP), 마이크로 프로세서(microprocessor), GPU(Graphics Processing Unit), AI(Artificial Intelligence) 프로세서, NPU (Neural Processing Unit), TCON(Time controller)으로 구현될 수 있다. 다만, 이에 한정되는 것은 아니며, 중앙처리장치(central processing unit(CPU)), MCU(Micro Controller Unit), MPU(micro processing unit), 컨트롤러(controller), 어플리케이션 프로세서(application processor(AP)), 또 는 커뮤니케이션 프로세서(communication processor(CP)), ARM 프로세서 중 하나 또는 그 이상을 포함하거나, 해당 용어로 정의될 수 있다. 또한, 프로세서는 프로세싱 알고리즘이 내장된 SoC(System on Chip), LSI(large scale integration)로 구현될 수도 있고, ASIC(application specific integrated circuit), FPGA(Field Programmable gate array) 형태로 구현될 수도 있다. 또한, 일 실시예에 따른 인공 지능 모델을 실행하기 위한 프로세서는 CPU, AP, DSP(Digital Signal Processor) 등과 같은 범용 프로세서, GPU, VPU(Vision Processing Unit)와 같은 그래픽 전용 프로세서 또는 NPU와 같은 인공 지능 전용 프로세서일 수 있다. 프로세서는, 메모리에 저장된 기 정의된 동작 규칙 또는 인공 지능 모델에 따라, 입력 데이터를 처리하도록 제어할 수 있다. 또는, 프로세서가 인공 지능 전용 프로세서인 경우, 특정 인공 지능 모델의 처리에 특화된 하드웨어 구조로 설계될 수 있다. 예를 들어, 특정 인공 지능 모델의 처리에 특화된 하드웨어는 ASIC, FPGA 등의 하드웨어 칩으로 설계될 수 있다. 프로세서는 입력 데이터를 처리하여 출력 데이터를 획득한다. 여기서, 입력 데이터는 텍스트, 이미지 또는 사용자 음성 중 적어도 하나를 포함할 수 있다. 예를 들어, 입력 데이터는, 외부 장치와 통신 가능한 통신부, 키보드 또는 터치 패드 등과 같은 사용자 입력부, 카메라, 마이크 등을 통해 입력될 수 있다. 출력 데이터는 인 공 지능 모델의 종류에 따라 다양한 형태가 될 수 있다. 예를 들어 출력 데이터는, 해상도가 향상된 이미지, 이 미지 내에 포함된 오브젝트 관련 정보, 음성에 대응되는 텍스트 등이 될 수 있다. 일 예에 따라, 프로세서는 영상을 영상 처리하여 출력 영상을 획득한다. 여기서, 영상은 정지 영상, 복수 의 연속된 정지 영상(또는 프레임), 또는 비디오를 포함할 수 있다. 또한, 영상은 원본 영상이 될 수 있으나, 이에 한정되는 것은 아니다. 영상 처리는 영상 개선(image enhancement), 영상 복원(image restoration), 영상 변환(image transformation), 영상 분석(image analysis), 영상 인식(image understanding) 또는 영상 압축 (image compression) 중 적어도 하나를 포함하는 디지털 영상 처리가 될 수 있다. 일 실시예에 따라, 프로세서는 인공 지능 모델을 이용하여 영상, 예를 들어 원본 영상을 영상 처리할 수 있다. 예를 들어, 프로세서는 인공 지능 모델을 이용하기 위하여, 메모리, 예를 들어 DRAM과 같은 외 부 메모리에 저장된 인공 지능 모델 관련 정보를 로딩하여 이용할 수 있다. 일 실시 예에 따르면, 프로세서는 영상을 다운스케일링하고, 다운스케일링된 영상을 부호화(또는 압축)할 수 있다. 또한, 프로세서은 영상의 품질 정보에 기초하여 영상의 다운스케일링 또는 다운스케일링된 영상 의 부호화 중 적어도 하나를 제어할 수 있다. 여기서, 영상의 다운스케일링은 제1 인공 지능 모델을 이용하여 수행될 수 있다. 또한, 영상의 품질 정보는 제2 인공 지능 모델을 통해 획득될 수 있다. 이 경우, 제2 인공 지 능 모델은 제1 인공 지능 모델로부터 획득되는 영상의 특성 정보에 기초하여 학습될 수 있다. 도 3은 일 실시예에 따른 프로세서의 동작을 자세히 설명하기 위한 도면이다. 본 개시의 일 실시예에 따르면, 프로세서는 다운스케일러, 인코더 및 품질 추정부을 포함 할 수 있다. 여기서, 다운스케일러, 인코더 및 품질 추정부는 설명의 편의를 위하여 프로세서 의 기능을 구분한 것으로, 다운스케일러, 인코더 및 품질 추정부는 프로세서 내의 적 어도 하나의 소프트웨어, 적어도 하나의 하드웨어 또는 이들의 조합으로 구현될 수 있다. 일 실시예에 따라 다운스케일러는 제1 인공 지능 모델을 이용하여 영상을 다운스케일링할 수 있다. 여기서, 제1 인공 지능 모델의 출력은 다운스케일링(downscaling)된 영상이 될 수 있다. 또한, 제1 인공 지능 모델은 전자 장치로부터 처리된 영상을 수신하는 수신 장치(도 1, 20)에 포함된 영상의 업스케일링을 위한 인공 지능 모델과 연계되어 학습(joint trained connectively)될 수 있다. 여기서, 인공 지능 모델이 학습된다는 것은, 기본 인공 지능 모델(예를 들어 임의의 랜덤한 파라미터를 포함하 는 인공 지능 모델)이 학습 알고리즘에 의하여 다수의 훈련 데이터들을 이용하여 학습됨으로써, 원하는 특성(또 는, 목적)을 수행하도록 설정된 기 정의된 동작 규칙 또는 인공 지능 모델이 만들어짐을 의미한다. 이러한 학습 은 별도의 서버 및/또는 시스템을 통해 이루어질 수 있으나, 이에 한정되는 것은 아니며 전자 장치에서 이루어 질 수도 있다. 학습 알고리즘의 예로는, 지도형 학습(supervised learning), 비지도형 학습(unsupervised learning), 준지도형 학습(semi-supervised learning) 또는 강화 학습(reinforcement learning)이 있으나, 전 술한 예에 한정되지 않는다. 여기서, 제1 인공 지능 모델은, 예를 들어, CNN (Convolutional Neural Network), RNN (Recurrent Neural Network), RBM (Restricted Boltzmann Machine), DBN (Deep Belief Network), BRDNN(Bidirectional Recurrent Deep Neural Network) 또는 심층 Q-네트워크 (Deep Q-Networks) 등으로 구현될 수 있으나, 이에 한정되지 않는 다. 여기서, 다운스케일링 방식으로는, 예를 들어 bilinear interpolation, nearest neighbor interpolation, bicubic interpolation, deconvolution interpolation, subpixel convolution interpolation, polyphase interpolation, trilinear interpolation, linear interpolation 중 적어도 하나의 보간 기법이 이용될 수 있 다. 일 실시예에 따라 인코더는 다운스케일러에 의해 다운스케일링된 영상을 부호화(또는 압축)할 수 있 다. 예를 들어, 프로세서는 MPEG(Moving Picture Experts Group)(예를 들어, MP2, MP4, MP7 등),JPEG(joint photographic coding experts group), AVC(Advanced Video Coding), H.264, H.265, HEVC(High Efficiency Video Codec)), VC-1, VP8, VP9 및 AV1(AOMedia Video 1), VC-1, VP8, VP9 및 AV1(AOMedia Video 1) 등의 다양한 압축 방법 중 하나를 통해 다운스케일링된 영상을 부호화할 수 있다. 한편, 품질 예측부는 영상의 품질을 예측하고, 예측된 품질에 기초하여 다운스케일러 또는 인코더 중 적어도 하나를 제어할 수 있다. 구체적으로, 품질 예측부는 영상의 품질 정보를 획득하고, 획득 된 품질 정보에 기초하여 다운스케일러의 다운스케일링 처리 또는 인코더의 부호화 처리 중 적어도 하나를 제어할 수 있다. 여기서, 품질 정보는 해상도 정보 또는 전송률(또는 압축 강도) 정보 중 적어도 하나에 대응되는 품질 지표를 포함할 수 있다. 다만, 품질 정보의 구현 형태는, 반드시 이에 한정되지 않고 다운스케일 러 또는 인코더 중 적어도 하나를 제어할 수 있는 다른 형태의 정보로 구현될 수도 있다. 예를 들어, 품질 정보는 다운스케일링 정보(예를 들어, 다운스케일링 비율) 또는 전송률(또는 압축 강도) 정보 중 적어도 하나에 대응되는 품질 지표를 포함할 수 있다. 품질 예측부는 영상에 최적인 품질 정보에 대응되는 해상도 정보 및 전송률 정보가 획득되면, 획득된 해상 도 정보를 다운스케일러로 제공하고, 획득된 전송률 정보를 인코더로 제공할 수 있다. 즉, 프로세서 는 실시간으로 영상 품질 기반으로 영상의 최적 해상도와 전송률을 제어할 수 있다. 일 실시예에 따라 품질 예측부는 영상의 품질 정보를 획득하도록 학습된 제2 인공 지능 모델을 이용하여 영상의 품질 정보를 획득하고, 획득된 품질 정보에 기초하여 영상의 다운스케일링 또는 다운스케일된 영상의 부 호화 중 적어도 하나를 제어할 수 있다. 이 경우, 제2 인공 지능 모델은, 제1 인공 지능 모델로부터 획득된 영 상의 특성 정보를 이용하여 영상의 품질 정보를 획득하도록 학습될 수 있다. 일 예로, 제2 인공 지능 모델은 기 정의된 해상도와 전송률 조합에 대한 영상 품질 지표를 벡터 형태로 예측하여 출력할 수 있다. 여기서, 벡터 형 태란 기 정의된 해상도와 전송률 조합에 대한 다양한 품질 지표가 획득되는 것을 의미할 수 있다. 다만, 다른 예로, 제2 인공 지능 모델은 기 정의된 다운스케일링 비율과 전송률 조합에 대한 영상 품질 지표를 벡터 형태로 예측하여 출력할 수도 있다. 도 4는 일 실시예에 따른 제1 인공 지능 모델 및 제2 인공 지능 모델 간 관계를 설명하기 위한 도면이다. 도 4에 도시된 바와 같이 제1 인공 지능 모델은 복수의 신경망 레이어를 포함하고 복수의 신경망 레이어들 각각은 복수의 파라미터를 포함할 수 있다. 이 경우, 제1 인공 지능 모델은 이전 레이어의 연산 결과와 복 수의 파라미터들 간의 연산을 통해 신경망 연산을 수행할 수 있다. 일 예에 따라, 임의의 레이어에서 컨벌루션 필터 적용 후 활성화 함수, 예를 들어 ReLU(Rectified Linear Unit) 연산을 통해 출력되는 연산 데이터가 출력될 수 있다. 이 경우, 레이어에서 출력되는 연산 데이터는 다채널 데 이터로서, 예를 들어, 64 개의 피쳐 맵(또는 액티베이션 맵) 데이터가 출력되어 다음 레이어로 제공될 수 있다. 다만, 일 예에 따라 피쳐 맵 데이터가 메모리(내부 버퍼, 또는 외부 메모리)에 저장된 후 다음 레이어로 제공될 수 있으나, 도 4에서는 해당 구성은 생략하였다. 여기서, 파라미터는 필터의 가중치(또는 계수)와 동일한 의미 일 수 있다. 이 경우, 제1 인공 지능 모델은 Identity Function, Logistic Sigmoid Function, Hyperbolic Tangent(tanh) Function, ReLU Function, Leaky ReLU Function 등 다양한 유형의 활성화 함수(Activation function)를 이용하여 연산을 수행할 수 있다. 도 4에 도시된 바와 같이 제2 인공 지능 모델 또한, 복수의 신경망 레이어를 포함하고 복수의 신경망 레이 어들 각각은 복수의 파라미터를 포함할 수 있다. 일 실시 예에 따라 제2 인공 지능 모델에 포함된 적어도 하나의 레이어는 제1 인공 지능 모델에 포함된 적어도 하나의 레이어와 연계되어 학습될 수 있 다. 일 예로, 제2 인공 지능 모델은 제1 인공 지능 모델과 적어도 하나의 레이어를 공유하도록 구현 될 수 있다. 다른 예로, 제2 인공 지능 모델은 제1 인공 지능 모델로부터 출력되는 특성 정보를 이용 하는 적어도 하나의 레이어 만을 포함하도록 구현될 수도 있다. 다만, 이하에서는 설명의 편의를 위하여 제2 인공 지능 모델이 제1 인공 지능 모델과 적어도 하나의 레이어를 공유하도록 구현되는 경우 를 상정하여 설명하도록 한다. 구체적으로 제2 인공 지능 모델은 제1 인공 지능 모델에 포함된 복수의 레이어 중 특정 레이어 에서 출력되는 피쳐 맵 데이터를 입력받는 적어도 하나의 레이어를 포함할 수 있다. 이에 따라 제2 인공 지능 모델은 제1 인공 지능 모델에 포함된 적어도 일부 레이어 및 추가된 적어도 하나의 레이어 을 포함하는 형태로 구현될 수 있다. 여기서, 특정 레이어는 원본 해상도 도메인에 속하는 레이어일수 있다. 예를 들어, 제1 인공 지능 모델은 예를 들어, bicubic과 같은 보간 작업을 통해 다운스케일링을 수행할 수 있는데, 이러한 보간 작업이 수행되기 전 도메인의 레이어로부터 출력되는 피쳐 맵 데이터가 제2 인 공 지능 모델로 제공될 수 있다. 이는 제2 인공 지능 모델로부터 출력되는 품질 정보 중 해상도 정보 가 제1 인공 지능 모델로 피드백되어 제1 인공 지능 모델의 다운스케일링을 제어하기 때문이다. 이에 따라 다운스케일링이 수행되기 전의 피쳐 맵 데이터가 제2 인공 지능 모델로 제공되어야 한다. 일 구현 예에 따라 제2 인공 지능 모델은, 제1 인공 지능 모델과 공유하는 적어도 하나의 레이어 의 파라미터는 고정시키고, 제1 인공 지능 모델과 공유하지 않는 나머지 레이어의 파라미터를 학습시키는 형태로 구현될 수 있다. 즉, 제2 인공 지능 모델의 학습에는 전이 학습이 이용될 수 있다. 여 기서, 전이 학습이란, 특정 응용에 대해 잘 학습된 모델을 다른 응용에서 재사용해서 학습하는 방법이다. 예를 들어 도 5의 상단과 같이 영상 내의 동물을 Classification 하는 용도로 잘 학습된 모델이 있다고 가정하면, 도 5의 하단과 같이 동물의 종류가 더 추가된 모델을 생성할 때, 처음부터 다시 학습할 필요 없이 기존의 학습된 모델을 재사용하고 Classifier 부분만 추가로 학습하여 새로운 모델을 만들 수 있다. 전이 학습 방식은 적은 양 의 데이터로 빠르게 학습을 할 수 있는 장점이 있으며, 성능 면에서도 우수한 것으로 알려져 있다. 이미 잘 훈 련된 모델이 있고, 해당 모델과 유사한 문제를 해결하고자 할 때 이와 같은 방법을 사용하는 것이 효율적이다. 이와 같이 제2 인공 지능 모델은 다운스케일링을 위해 잘 학습된 제1 인공 지능 모델의 적어도 일부 레이어를 이용하고, 나머지 추가된 레이어만 추가로 학습시키는 형태로 구현될 수 있다. 다만, 제2 인공 지능 모델이 제1 인공 지능 모델에 포함된 적어도 하나의 레이어로부터 출력되는 피 쳐 맵 데이터를 수신하는 적어도 하나의 레이어 만을 포함하는 형태로 구현되는 경우에도 제2 인공 지능 모델에 포함된 적어도 하나의 레이어의 파라미터는, 상술한 바와 같이 제1 인공 지능 모델에 포 함된 적어도 일부 레이어의 파라미터와 연계되어 학습될 수 있다. 상술한 바와 같이 제2 인공 지능 모델을, 제1 인공 지능 모델로부터 획득된 영상의 특성 정보를 공유 하도록 구현함으로써, 제2 인공 지능 모델의 효율적 학습이 가능하며 H/W 구현 복잡도를 최소화할 수 있다. 일 실시예에 따라 제2 인공 지능 모델은 입력 영상의 특징 정보를 추출하기 위한 합성곱 신경망 (Convolutional Neural Network:CNN), 2 차원 영상을 1 차원의 품질 정보로 변환하기 위한 완전 연결 네트워크 (full connected network:FCN)를 포함할 수 있다. 경우에 따라 제2 인공 지능 모델는 영상의 프레임 별 시간적 변화를 예측하여 위한 RNN(Recurrent Neural Network) 레이어를 더 포함할 수 있다. 이와 같이 제2 인공 지능 모델은 영상의 품질을 예측하기에 적합한 다양한 타입의 인공 지능 모델을 포함하도록 구현될 수도 있다. 본 개시의 일 실시예에 따라 제2 인공 지능 모델로부터 출력되는 영상의 품질 정보는, 영상과 관련된 복수 의 해상도 정보 및 복수의 전송률 정보의 상이한 조합에 대응되는 복수의 품질 지표를 포함할 수 있다. 여기서, 복수의 해상도 정보 및 복수의 전송률 정보의 조합은 제2 인공 지능 모델의 학습을 위해 기정의되어 있을 수 있다. 본 개시의 일 실시예에 따라 영상의 품질 정보는, 해상도 정보 및 전송률 정보에 대응되는 품질 지표를 포함할 수 있다. 예를 들어 해상도 정보는 SD(Standard Definition), HD(High Definition), FHD(Full High Definition), QHD(Quad High Definition), 4K UHD(Ultra High Definition), 8K UHD(Ultra High Definition) 또는 그 이상의 해상도를 포함할 수 있다. 또한, 전송률 정보는, 영상의 비트레이트 정보 예를 들어 Bit Rate_0, Bit Rate_1, Bit Rate_2,..., Bit Rate_N 과 같은 형태일 수 있다. 또한, 품질 지표는 VQ Metric_0, VQ Metric_1, VQ Metric_2,..., VQ Metric_N 과 같은 형태일 수 있다. 여기서, VQ Metric은 PSNR(Peak Signal to Noise Ratio), VMAF(Video Multimethod Assessment Fusion), SSIM(Structural Similarity), NIQE(Naturalness Image Quality Evaluator), MSAD, MSE(Mean Squared Error) 등의 영상의 품질을 평가할 수 있는 다양한 품질 메트릭으로 구현될 수 있다. 일 예에 따라, 제2 인공 지능 모델로부터 출력되는 영상의 품질 정보는, 해상도, 전송율 및 품질 지표를 포함하는 형태의 쌍 데이터 형태일 수 있다. 예를 들어, 제2 인공 지능 모델은, 기정의된 해상도 및 전송 율 조합에 대한 품질 지표를 출력하도록 학습될 수 있다. 예를 들어, 제2 인공 지능 모델로부터 출력되는 영상의 품질 정보는, (FHD, Bit Rate_0, VQ Metric_0), (FHD, Bit Rate_1, VQ Metric_1), (FHD, Bit Rate_2, VQ Metric_2), (FHD, Bit Rate_3, VQ Metric_3), (2K,Bit Rate_4, VQ Metric_4), (2K, Bit Rate_5, VQ Metric_5), (2K, Bit Rate_6, VQ Metric_6), (2K, Bit Rate_7, VQ Metric_7), (4K, Bit Rate_8, VQ Metric_8), (4K, Bit Rate_9, VQ Metric_9), (4K, Bit Rate_10, VQ Metric_10),(4K, Bit Rate_11, VQ Metric_11) 과 같은 상이한 해상도 정보 및 상이한 전송률 정보에 대응되 는 복수의 품질 지표를 포함할 수 있다. 여기서, 1 내지 N는 Bit Rate 및 VQ Metric을 식별하기 위한 수치일 뿐 이며 Bit Rate 및 VQ Metric는 다양한 수치로 표현될 수 있음은 물론이다. 일 실시예에 따라 제2 인공 지능 모델은, 샘플 영상과 관련된 복수의 해상도 정보 및 복수의 전송률 정보 의 상이한 조합에 대응되는 복수의 제1 샘플 품질 지표 및, 샘플 영상을 제2 인공 지능 모델에 입력하여 출력되는 복수의 제2 품질 지표 간 차이에 기초하여 학습될 수 있다. 여기서, 제1 샘플 품질 지표는 전자 장치 에서 처리된 영상을 수신 장치에서 복원한 복원 영상의 실제 품질 지표가 될 수 있다. 일 구현 예에 따라 제2 인공 지능 모델은 도 6에 도시된 바와 같이 제2 인공 지능 모델로부터 출력되 는 품질 정보 및 실제 영상의 품질 정보 간 차이를 손실 함수(Loss Function)으로 하여 지도 학습 방식으로 학 습될 수 있다. 여기서, 실제 영상의 품질 정보는 일 예에 따라 전자 장치에서 원본 훈련 영상을 다운스케 일링 및 부호화한 후, 네트워크를 통해 수신 장치로 전송된 후, 수신 장치에서 수신된 영상을 디코딩 및 업스케일링처리하여 복원된 영상과 원본 훈련 영상을 비교함으로써 획득될 수 있다. 제2 인공 지능 모델 은 도 6에 도시된 바와 같이 입력 영상의 특징 정보를 추출하기 위한 합성곱 신경망(Convolutional Neural Network:CNN), 2 차원 영상을 1 차원의 품질 정보로 변환하기 위한 완전 연결 네트워크(full connected network:FCN)를 포함할 수 있다. 경우에 따라 제2 인공 지능 모델는 영상의 프레임 별 시간적 변화를 예측 하여 위한 RNN(Recurrent Neural Network) 레이어를 더 포함할 수 있다. 예를 들어, 실제 영상 품질 지표가 PSNR로 구현되는 경우, 실제 영상 품질 지표를 나타내는 PSNR은 하기와 같은 수학식 1 및 2에 기초하여 산출될 수 있다. 수학식 1"}
{"patent_id": "10-2019-0157761", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "수학식 2"}
{"patent_id": "10-2019-0157761", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "이 경우, C(i, j)는 영상, R(i, j)는 복원 영상이 될 수 있다. 도 2a 및 도 2b로 돌아와서, 일 실시예에 따라 프로세서는 제2 인공 지능 모델로부터 출력되는 복수 의 품질 지표 중 어느 하나에 대응되는 해상도 정보 및 전송률 정보에 기초하여 영상의 다운 스케일링 비율 및 다운스케일된 영상의 전송률을 결정할 수 있다. 일 예에 따라, 프로세서는 복수의 품질 지표 중 최상의 품질 지표, 예를 들어 제1 품질 지표에 대응되는 대응되는 해상도 정보 및 전송률 정보에 기초하여 영상의 다운 스케일링 비율 및 다운스케일된 영상의 전송률을 결정할 수 있다. 구체적으로, 프로세서는 제1 품질 지표에 대응되는 해상도 정보에 기초하여 제1 인공 지 능 모델의 다운스케일 동작을 제어하고, 제1 품질 지표에 대응되는 비트 레이트 정보에 기초하여 제1 인공 지능 모델로부터 출력되는 다운스케일링된 영상의 압축 강도를 제어할 수 있다. 다만, 최상의 품질 지표는 예를 든 것이며, 프로세서를 복수의 품질 지표 중 평균 품질 지표를 이용하거나, 기정의된 임계 품질 지표 (예를 들어 최상으로부터 10% 아래에 해당하는 품질 지표)에 대응되는 품질 지표를 이용할 수 있다. 다른 실시 예에 따라, 프로세서는 네트워크 상태 정보를 획득하고, 네트워크의 상태 정보 및 영상의 품질 정보에 기초하여 영상의 다운스케일링 또는 다운스케일된 영상의 부호화 중 적어도 하나를 제어할 수 있다. 여 기서, 네트워크 상태 정보는, 네트워크의 가용 Bandwidth, 패킷 손실률, 패킷의 Round-Trip Time, 패킷의Delay-Gradient, RSSI(Received signal strength indicator) 정보, 통신 채널 정보, 링크 스피드 정보, 채널 간섭 정보 또는 재시도 레이트 정보 중 적어도 하나를 포함할 수 있다. 즉, 네트워크 상태 정보는 네트워크의 혼잡, 거리, 전송 속도에 따라 영향을 받는 다양한 네트워크 관련 정보가 될 수 있다. 패킷의 Round-Trip Time (또는 Round trip delay)은 네트워크에서 수신단까지 패킷이 왕복하는데 걸리는 시간을 의미할 수 있다. 패킷의 Delay-Gradient는 송신단에서 전송되는 패킷들의 전송 시간 간격 및 수신단에서 수신되는 패킷들의 수신 시간 간격 간 차이가 될 수 있다. 통신 채널 정보는 채널 및 주파수 중 적어도 하나에 대한 정보를 포함할 수 있다. 링크 스피드 정보는, 송신단에서 수신단으로 전송되는 패킷들의 레이트에 대한 정보가 될 수 있다. 채널 간섭 정보는, Channel active time, Channel busy time 및 Channel transmit time와 같은 다양한 채널 RF 파라미터 를 이용하여 측정된 각 채널에 대한 간섭 팩터에 기초하여 획득될 수 있다. 재시도 레이트 정보는, 초 단위로 재시도되는 전송 패킷(TX packets)의 퍼센티지를 나타낼 수 있다. 일 예에 따라 네트워크 상태 정보는 전자 장치(100, 100')와 네트워크를 통해 연결된 컨텐츠 수신 장치(또는 컨 텐츠 출력 장치)(예를 들어, 도 1a, 20)로부터 수신될 수 있다. 이 경우, 컨텐츠 수신 장치(또는 컨텐츠 출력 장치)(예를 들어, 도 1a, 20)는 네트워크 상태를 모니터링하여 네트워크 상태 정보를 수집하고, 수집된 네트워 크 상태 정보를 기설정된 주기 또는 전자 장치(100, 100')의 요청이 잇는 경우, 전자 장치(100, 100')로 전송할 수 있다. 예를 들어, 네트워크가 인터넷 기반의 TCP/IP 통신 프로토콜로 구현되는 경우, TCP/IP는 Link layer, Internet layer, Transport layer, Application layer로 구현될 수 있다. 이 경우, 네트워크 상태 정보는, 어 플리케이션 레이어에서 네트워크 상태를 실시간으로 모니터링하여 수집될 수 있으나, 이에 한정되는 것은 아니 다. 다만, 경우에 따라 전자 장치(100, 100')가 직접 네트워크 상태를 모니터링하여 네트워크 상태 정보를 수집 하는 것도 가능하다. 일 예에 따라 프로세서는 네트워크의 상태 정보 및 영상의 품질 정보에 기초하여 영상의 다운스케일링 또 는 다운스케일된 영상의 부호화 중 적어도 하나를 제어할 수 있다. 구체적으로, 프로세서는 네트워크의 상 태 정보에 기초하여 복수의 품질 지표 중 적어도 하나의 품질 지표를 결정하고, 타겟 품질 지표에 기초하여 적 어도 하나의 품질 지표 중 하나의 품질 지표를 결정할 수 있다. 이 경우, 프로세서는 현재 네트워크 상태 에서 전송 가능한 비트레이트에 기초하여 하나의 품질 지표를 결정할 수 있다. 프로세서는 현재 네트워크 상태에서 전송 가능한 비트레이트가 복수 개 즉, 해당 비트레이트에 대응되는 품질 지표가 복수 개인 경우, 가 장 낮은 전송률의 품질 지표를 선택할 수 있다. 이에 따라 네트워크 대역폭을 최대한 절감할 수 있게 된다. 이어서, 프로세서는 결정된 품질 지표에 대응되는 해상도 정보 및 전송률 정보에 기초하여 영상의 다운 스 케일링 비율 및 다운스케일된 영상의 전송률을 결정할 수 있다. 예를 들어, 영상의 품질 지표 벡터 값을 VQM(Video Quaility Metric), 네트워크 상태 벡터 값을 NS(Network Status)라 하고, 타겟 VQM 값(최대 품질 기준, e.g., PSNR 45dB 이상)을 설정하였다고 가정하면, 하기와 같은 방법으로 최적 해상도 및 전송률을 결정할 수 있다. ⅰ) 먼저, 제2 인공 지능 모델로부터 출력되는 복수의 VQM 중 현재의 네트워크 상태에서 전송 가능한 VQM Set(VQM')를 추정한다. ⅱ) 이어서, VQM' 중 Target VQM 값을 만 족하는 Set을 구한다. ⅲ) Target VQM 값을 만족하는 Set이 없으면(예를 들어, 네트워크 상태가 좋지 않은 경우) Target VQM을 10% 낮추고 ⅰ)및 ⅱ)를 재수행한다. 또는 Target VQM 값을 만족하는 Set이 있으면 이 중 전송률이 가장 작은 전송률 및 해상도 조합을 선택한다. 다른 예에 따라, 제2 인공 지능 모델로부터 출력되는 영상의 품질 정보는, 해상도, 비트레이트 및 품질지 표를 포함하는 형태의 쌍 데이터 및 해당 데이터의 확률 정보를 추가로 포함할 수 있다. 예를 들어, 제2 인공 지능 모델로부터 출력되는 영상의 품질 정보는, 제2 인공 지능 모델로부터 출력 되는 영상의 품질 정보는, (FHD, Bit Rate_0, VQ Metric_0, probability_0), (FHD, Bit Rate_1, VQ Metric_1, probability_1), (FHD, Bit Rate_2, VQ Metric_2, probability_2), (FHD, Bit Rate_3, VQ Metric_3, probability_3), (2K, Bit Rate_4, VQ Metric_4, probability_4), (2K, Bit Rate_5, VQ Metric_5, probability_5), (2K, Bit Rate_6, VQ Metric_6, probability_6), (2K, Bit Rate_7, VQ Metric_7, probability_07), (4K, Bit Rate_8, VQ Metric_8, probability_8), (4K, Bit Rate_9, VQ Metric_9, probability_9), (4K, Bit Rate_10, VQ Metric_10, probability_10), (4K, Bit Rate_11, VQ Metric_11, probability_11) 과 같은 상이한 해상도 정보 및 상이한 전송률 정보에 대응되는 복수의 품질 지표 및 각 품질 지표에 대응되는 확률 값을 포함할 수 있다. 여기서, 1 내지 N는 Bit Rate 및 VQ Metric을 식별하기 위한 수치 일 뿐이며 Bit Rate, VQ Metric, probability는 다양한 수치로 표현될 수 있음은 물론이다. 여기서, 확률 값은 임계 범위의 품질을 제공할 수 있는 최소의 비트레이트일 확률을 나타낼 수 있다. 예를 들어 도 7을 참고하면, 전자 장치에서 요구하는 임계 범위의 품질이 710 범위와 같이 설정되는 경우, 특정 비트 레이트가 해상 임계 범위의 품질을 만족하는 최소의 비트레이트일 수 있다. 다만, 설명의 편의를 위하여 해상도는 하나인 것을 가정하였다. 이와 같이 확률 값은 특정 데이터 쌍이 최소의 비트레이트에 대응될 확률을 나타낼 수 있다. 전자 장치는 비트레이트 A 및 비트레이트 B(A<B)로 압축하더라도 유사한 품질, 임계 범위 의 품질을 제공한다면 큰 비트레이트 B로 압축하지 않고 작은 비트레이트 A로 압축하는 것이 압축 효율 측면에 서 유리하므로 상기의 확률 값은 의미를 가질 수 있다. 이 경우, 제2 인공 지능 모델은, 영상의 품질 정보 즉, 해상도, 비트레이트 및 품질 지표를 포함하는 형태의 쌍 데이터 뿐 아니라, 해당 데이터의 확률 정보를 추가로 출력하도록 학습될 수 있다. 상술한 실시 예에 따르면, 네트워크 대역폭을 효율적으로 사용할 수 있으며, 주어진 네트워크 환경에서 소비자 체감 품질을 최대화할 수 있다. 도 2a 및 도 2b로 돌아와서, 일 실시예에 따르면 프로세서는 영상의 현재 프레임으로부터 예측된 품질 정 보에 기초하여 현재 프레임의 다운스케일링 또는 부호화 중 적어도 하나를 제어할 수 있다. 다른 실시 예에 따 르면, 프로세서는 영상의 적어도 하나의 이전 프레임으로부터 예측된 품질 정보에 기초하여 현재 프레임의 다운스케일링 또는 부호화 중 적어도 하나를 제어할 수 있다. 도 8a 및 도 8b는 본 개시의 다양한 실시 예에 따라 현재 또는 이전 프레임의 품질 정보를 이용하는 경우를 설 명하기 위한 도면들이다. 도 8a는 일 실시예에 따라 프로세서가 영상의 현재 프레임에 대응되는 품질 정보에 기초하여 현재 프레임 의 다운스케일링 또는 부호화 중 적어도 하나를 제어하는 경우를 설명하기 위한 도면이다. 도 8a에 따르면, 프로세서는 제1 영상 프레임(현재 영상 프레임)이 제1 인공 지능 모델로 입력되면, 제1 인공 지능 모델에 포함된 특정 레이어로부터 출력되는 영상 특성 정보, 예를 들어, 제1 영상 프레임 (현재 영상 프레임)에 대응되는 피쳐 맵 데이터를 제2 인공 지능 모델로 입력할 수 있다. 여기서, 특정 레 이어는 원본 해상도 도메인에 속하는 레이어 예를 들어, 보간 처리가 수행되기 전 해상도에 대응되는 레이어일 수 있다. 프로세서는 특정 레이어로부터 출력되는 제1 영상 프레임(현재 영상 프레임)의 특성 정보, 즉 피 쳐 맵 데이터를 프레임 버퍼에 저장하고, 제2 인공 지능 모델로부터 출력되는 품질 정보에 기초하여 프레임 버퍼에 저장된 피쳐 맵 데이터를 다운스케일링하여 다운스케일링된 프레임을 획득할 수 있다. 이에 따라, 다운스케일링된 프레임은 1 프레임 지연(60 FPS 기준 약 16.7ms)되어 비디오 인코더로 입력될 수 있다. 하지만, 예측 정확도를 높이고 복잡도를 줄일 수 있는 장점이 있다. 도 8b는 다른 실시 예에 따라 프로세서가 영상의 이전 프레임에 대응되는 품질 정보에 기초하여 현재 프레 임의 다운스케일링 또는 부호화 중 적어도 하나를 제어하는 경우를 설명하기 위한 도면이다. 예를 들어, 프로세 서는 N-1,N-2,…N-k 프레임에 기초하여 N 프레임의 품질 정보를 예측하고 이에 기초하여 N 프레임의 다운 스케일링 또는 부호화 중 적어도 하나를 제어할 수 있다. 도 8b에 따르면, 프로세서는 제2 영상 프레임(이전 영상 프레임)이 제1 인공 지능 모델로 입력되면, 제1 인공 지능 모델에 포함된 특정 레이어로부터 출력되는 영상 특성 정보, 예를 들어, 제2 영상 프레임 (이전 영상 프레임)에 대응되는 피쳐 맵 데이터를 제2 인공 지능 모델로 입력할 수 있다. 여기서, 특정 레 이어는 실질적인 다운스케일링 예를 들어, Bicubic 처리가 수행되기 전의 영상의 해상도 도메인에 속하는 레이 어일 수 있다. 프로세서는 특정 레이어로부터 출력되는 제2 영상 프레임(이전 영상 프레임)의 특성 정보, 즉 피쳐 맵 데이터를 프레임 버퍼(예를 들어, FIFO)에 저장하고, 프레임 버퍼에 저장된 피쳐 맵 데이터 에 기초하여 품질 정보를 획득할 수 있다. 이어서, 프로세서는 제3 영상 프레임(현재 프레임)이 제1 인공 지능 모델에 입력되면, 적어도 하나의 제2 영상 프레임(이전 영상 프레임)에 기초하여 예측된 품질 정보에 기초하여 제3 영상 프레임(현재 프레임)에 대한 다운 스케일링 예를 들어, bicubic을 수행할 수 있다. 이에 따 라, 다운스케일링된 현재 프레임은 지연없이 비디오 인코더로 입력될 수 있다. 이를 위해, 제2 인공 지능 모델은, 도 8b에 도시된 바와 같이 적어도 하나의 이전 프레임에 대응되는 특성 정보에 기초하여 현재 프레임의 품질 정보를 예측하도록 학습된 적어도 하나의 RNN(Recurrent Neural Networks) 레이어를 포함할 수 있다. 이는, 도 8b의 실시 예의 경우, 이전 영상 프레임의 품질 정보에 기초하여 현재 영상 프레임의 품질 정보를 예측해야 하는데, RNN이 시간 차이를 두고 순차적으로 입력되는 데이터의 해석과 이에 기 초한 미래 예측에 적합한 네트워크이기 때문이다. 도 8a 및 도 8b에서 제2 인공 지능 모델의 마지막 레이어에서 FCN(full connected network) 세 개로 구분 하여 표시한 것은 상이한 해상도(예를 들어 도 6의 4K, 2K, FHD)를 구분하여 표시한 것이나, 하나의 FCN으로 구 현될 수 있음은 물론이다. 상술한 실시 예에서는 제1 인공 지능 모델에서 bicubic 처리가 마지막 신경망 레이어 후단에서 수행되는 것으로 도시하였으나, bicubic 처리는 중간 신경망 레이어 후단에서 수행될 수도 있으며, 이 경우, bicubic 처 리 이전의 신경망 레이어에서 출력되는 피쳐 맵 데이터가 제2 인공 지능 모델(820, 830)로 제공될 수 있다. 또한, 상술한 실시 예에서, 제1 및 제2 인공 지능 모델(810, 820, 830)에 포함된 신경망 레이어, 보간 처리(예 를 들어, bicubic)는 소프트웨어, 하드웨어 또는 이들의 조합으로 구현될 수 있다. 한편, 프로세서는 상술한 방법와 같이 부호화된 영상에 기초하여 패킷(또는 프레임)을 패킷을 생성하고, 생성된 패킷을 전송할 수 있다. 일 예에 따라 프로세서는 수신 장치(도 1, 200)로 부호화된 영상을 포함하 는 패킷(또는 프레임)을 전송할 수 있다. 이 경우, 해상도 정보 및 전송률 정보는 패킷의 헤더 영역에 포함되고, 부호화된 영상은 패킷의 페이로드 영역에 포함될 수 있다. 일 실시예에 따르면, 적어도 하나의 프레 임 단위로 해상도와 전송률이 변경될 수 있으며, 적어도 하나의 프레임 단위에 대응되는 해상도 및 전송률이 패 킷의 헤더에 포함될 수 있다. 도 9는 일 실시예에 따른 전자 장치의 구성을 나타내는 블럭도이다. 도 9에 도시된 전자 장치는, 도 2a 및 도 2b에 도시된 전자 장치(100, 100')로부터 컨텐츠를 수신하여 출력하는 장치로 구현될 수 있으며, 전자 장치(100, 100')와 구별하기 위하여 수신 장치라고 명명하도록 한다. 도 9에 따르면, 수신 장치는 메모리, 통신 인터페이스 및 프로세서를 포함한다. 수신 장치는 TV 또는 set-top box 로 구현될 수 있으나, 이에 한정되는 것은 아니며 스마트 폰, 태블릿 PC(tablet personal computer), 이동 전화기(mobile phone), 전자북(e-book), 데스크탑 PC(desktop personal computer), 랩탑 PC(laptop personal computer), 넷북 컴퓨터(netbook computer), PDA(personal digital assistant), PMP(portable multimedia player), MP3 플레이어, 모바일 의료기기, 카메라(camera), 캠코더 (camcorder), 전자 액자 또는 웨어러블 장치(wearable device)(예를 들어, head-mounted-device(HMD) 스마트 와치(smart watch), 전자 의복, 전자 팔찌, 전자 목걸이 등), NED(Near Eye Display), LFD(large format display), Digital Signage(디지털 간판), DID(Digital Information Display), 비디오 월(video wall), 프로젝 터 디스플레이 등과 같이 디스플레이 기능을 갖춘 다양한 유형의 장치로 구현될 수 있다. 이에 한정되는 것은 아니며, 인공 지능 모델을 이용하여 데이터를 처리하는 장치라면 한정되지 않고 적용 가능하다. 일 예에 따라 다양한 해상도의 영상, 다양한 압축 영상을 수신할 수 있다. 예를 들어, 수신 장치는 SD(Standard Definition), HD(High Definition), FHD, UHD 영상, UHD 이상의 해상도 영상 중 적어도 하나의 영 상을 수신할 수 있다. 또한, 전자 장치는 MPEG(Moving Picture Experts Group)(예를 들어, MP2, MP4, MP7 등), JPEG(joint photographic coding experts group), AVC(Advanced Video Coding), H.264, H.265, HEVC(High Efficiency Video Codec), VC-1, VP8, VP9 및 AV1(AOMedia Video 1) 등으로 압축된 형태로 영상을 수신할 수 있다. 여기서, 수신된 영상은 전자 장치(100, 100')로부터 부호화 처리된 영상일 수 있다. 메모리는 본 개시의 다양한 실시 예를 위해 필요한 데이터를 저장할 수 있다. 메모리의 구현 형태는 도 2b에 도시된 메모리의 구현 형태와 동일 유사하므로 자세한 설명은 생략하도록 한다. 일 예에 따라, 메모리는 수신 장치를 제어하기 위한 적어도 하나의 인스트럭션(instruction) 또는 인 스트럭션들을 포함하는 컴퓨터 프로그램을 저장할 수 있다 다른 예에 따라, 메모리는 복수의 레이어를 포함하는 인공 지능 모델에 관한 정보를 저장할 수 있다. 여기 서, 인공 지능 모델에 관한 정보를 저장한다는 것은 인공 지능 모델의 동작과 관련된 다양한 정보, 예를 들어 인공 지능 모델에 포함된 복수의 레이어에 대한 정보, 복수의 레이어 각각에서 이용되는 파라미터(예를 들어, 필터 계수, 바이어스 등)에 대한 정보 등을 저장한다는 것을 의미할 수 있다. 예를 들어, 메모리는 본 개 시의 일 실시예에 따라 영상을 업스케일링(upscaling)하도록 학습된 인공 지능 모델에 대한 정보를 저장할 수 있다. 다만, 후술하는 프로세서의 구현 형태에 따라 인공 지능 모델에 관한 정보가 프로세서의 내부 메모리에 저장될 수 있음은 물론이다. 예를 들어, 프로세서가 전용 하드웨어로 구현되는 경우, 인공 지능 모델에 관한 정보는 프로세서 내부 메모리에 저장될 수도 있다. 또 다른 예에 따라, 메모리는 외부 서버, 외부 장치, 외부 저장 매체(예를 들어, USB), 외부 서버(예를 들 어 웹 하드) 등으로부터 수신된 영상을 저장할 수 있다. 여기서, 영상은 디지털 동영상이 될 수 있으나 이에 한정되는 것은 아니다. 또 다른 예에 따라, 메모리는 업 스케일링에 필요한 정보, 압축 처리에 필요한 정보, 화질 처리에 필요한 다양한 정보, 예를 들어 Noise Reduction, Detail Enhancement, Tone Mapping, Contrast Enhancement, Color Enhancement 또는 Frame rate Conversion 중 적어도 하나를 수행하기 위한 정보, 알고리즘, 화질 파라미터 등 을 저장할 수 있다. 또한, 메모리는 영상 처리에 의해 생성된 최종 출력 영상을 저장할 수도 있다. 상술한 실시 예에서는 다양한 데이터가 프로세서의 외부 메모리에 저장되는 것으로 설명하였으나, 상 술한 데이터 중 적어도 일부는 수신 장치 또는 프로세서 중 적어도 하나의 구현 예에 따라 프로세서 내부 메모리에 저장될 수도 있다. 통신 인터페이스는 다양한 타입의 컨텐츠를 입력받는다. 예를 들어 통신 인터페이스는 AP 기반의 Wi- Fi(와이파이, Wireless LAN 네트워크), 블루투스(Bluetooth), 지그비(Zigbee), 유/무선 LAN(Local Area Network), WAN(Wide Area Network), 이더넷(Ethernet), IEEE 1394, HDMI(High-Definition Multimedia Interface), USB(Universal Serial Bus), MHL(Mobile High-Definition Link), AES/EBU(Audio Engineering Society/ European Broadcasting Union), 옵티컬(Optical), 코액셜(Coaxial 등과 같은 통신 방식을 통해 외부 장치(예를 들어, 소스 장치), 외부 저장 매체(예를 들어, USB 메모리), 외부 서버(예를 들어 웹 하드) 등으로부 터 스트리밍 또는 다운로드 방식으로 영상 신호를 입력받을 수 있다. 일 실시예에 따라, 통신 인터페이스 는 인터넷 통신 네트워크를 통해 전자 장치(100, 100')로부터 실시간 비디오 영상을 수신할 수 있다. 프로세서는 메모리와 전기적으로 연결되어 수신 장치의 전반적인 동작을 제어한다. 프로세서 는 하나 또는 복수의 프로세서로 구성될 수 있다. 구체적으로, 프로세서는 메모리에 저장된 적 어도 하나의 인스트럭션(instruction)을 실행함으로써, 본 개시의 다양한 실시 예에 따른 수신 장치의 동 작을 수행할 수 있다. 프로세서의 구현 형태는 도 2a 및 도 2b에 도시된 프로세서의 구현 형태와 동 일 유사하므로 자세한 설명은 생략하도록 한다. 프로세서는 입력 데이터를 처리하여 출력 데이터를 획득한다. 여기서, 입력 데이터는 텍스트, 이미지 또는 사용자 음성 중 적어도 하나를 포함할 수 있다. 예를 들어, 입력 데이터는, 외부 장치와 통신 가능한 통신부, 키보드 또는 터치 패드 등과 같은 사용자 입력부, 카메라, 마이크 등을 통해 입력될 수 있다. 출력 데이터는 인 공 지능 모델의 종류에 따라 다양한 형태가 될 수 있다. 예를 들어 출력 데이터는, 해상도가 향상된 이미지, 이 미지 내에 포함된 오브젝트 관련 정보, 음성에 대응되는 텍스트 등이 될 수 있다. 일 예에 따라, 프로세서는 입력 영상을 영상 처리하여 출력 영상을 획득한다. 영상 처리는 영상 개선 (image enhancement), 영상 복원(image restoration), 영상 변환(image transformation), 영상 분석(image analysis), 영상 인식(image understanding) 또는 영상 압축(image compression) 중 적어도 하나를 포함하는 디지털 영상 처리가 될 수 있다. 일 예에 따라 입력 영상이 압축 영상인 경우 프로세서는 압축 영상을 디 코딩한 후 영상 처리할 수 있다. 일 실시예에 따르면, 프로세서는 입력 영상, 예를 들어 전자 장치(100, 100')에서 다운스케일링된 후 부호 화된 영상이 수신되면, 수신된 영상을 복호화(또는 압축 해제)한 후 복호화된 영상을 업스케일링하여 출력 영상 을 획득할 수 있다. 일 예에 따라, 프로세서는 수신된 영상의 압축 방식에 기초하여 수신된 영상을 복호화할 수 있다. 이어서, 프로세서는 인공 지능 모델을 이용하여 복호화된 영상을 업스케일링할 수 있다. 일 실시 예에 따르면, 적어도 하나의 프레임 단위로 영상 해상도와 영상 전송률이 변할 수 있으므로, 프로세서 는 전송된 영상의 해상도와 전송률을 알아야 한다. 구체적으로, 프로세서는 패킷 형태의 입력 영상이 수신되면, 패킷을 역 패킷화하여 헤더 영역에 포함된 해상도 정보 및 전송률 정보를 획득하고, 페이로드 영역에 포함된 부호화 영상을 획득할 수 있다. 여기서, 헤더 영역에 포함된 해상도 정보 및 전송률 정보는, 전자 장치 (100, 100')에서 수행된 다운스케일링과 관련된 해상도 정보 및 영상 압축과 관련된 전송률 정보일 수 있다. 프로세서는 획득된 전송률 정보에 기초하여 부호화된 영상에 대한 복호화를 수행하고, 획득된 해상도 정보 에 기초하여 복호화된 영상에 대한 업스케일링을 수행할 수 있다. 도 10a 내지 도 10c는 일 실시예에 따른 인공 지능 모델을 이용한 업스케일링 방법을 자세히 설명하기 위한 도 면이다. 일 실시예에 따른 업스케일링을 위한 인공 지능 모델은 Super Resolution 처리를 위한 학습 네트워크 모 델로 구현될 수 있다. Super Resolution이란 해상도가 낮은 영상을 일련의 미디어 처리를 통해 높은 해상도로 변환하는 처리를 의미한다. 일 예에 따라 프로세서는 도 10a에 도시된 바와 같이 복수의 신경망 레이어들로 구성된 인공 지능 모델 을 이용하여 복호화된 영상을 업스케일링 처리할 수 있다. 복수의 신경망 레이어들 각각은 복수의 파 라미터(parameters)(또는 복수의 가중치(weight values))를 포함하며, 이전(previous) 레이어의 연산 결과와 복수의 파라미터들 간의 연산을 통해 신경망 연산을 수행할 수 있다. 복수의 신경망 레이어들에 포함된 파라미 터들은 인공지능 모델의 학습 결과에 의해 최적화될 수 있다. 예를 들어, 학습 과정 동안 인공 지능 모델에서 획득한 로스(loss) 값 또는 코스트(cost) 값이 감소 또는 최소화되도록 파라미터들이 갱신될 수 있다. 인공 신 경망은 심층 신경망(DNN:Deep Neural Network)를 포함할 수 있으며, 예를 들어, CNN (Convolutional Neural Network), RNN (Recurrent Neural Network), GAN(Generative Adversarial Networks), RBM (Restricted Boltzmann Machine), DBN (Deep Belief Network), BRDNN(Bidirectional Recurrent Deep Neural Network) 또는 심층 Q-네트워크 (Deep Q-Networks) 등이 있으나, 전술한 예에 한정되지 않는다. 다른 예에 따라 프로세서는 도 10b에 도시된 바와 같이 복호화된 영상에 대해 보간 처리를 수행 하고, 보간 처리된 영상을 제2 인공 지능 모델에 입력하여 잔차 영상을 획득할 수 있다. 즉, 인 공 지능 모델은 Residual neural network로 구현될 수 있다. 여기서, Residual neural network를 구성하 는 복수의 레이어 각각은 상이한 파라미터를 포함하는 필터를 이용하여 보간 처리된 영상에 대한 잔차 영상을 생성할 수 있다. 다만, 인공 지능 모델이 반드시 잔차 영상 만을 생성하는 것은 아니며, 인공 지능 모델 의 구현 예에 따라 다양한 방식으로 입력된 영상을 처리하고, 처리된 영상을 출력할 수 있다. 이 경우, 프로세서는 보간 처리된 영상을 잔차 영상과 결합하여 출력 영상, 예를 들어 고해상도 영상을 획득할 수 있다. 여기서, 보간 처리는 해상도가 낮은 영상을 높은 해상도로 스케일링하는 처리를 의미하며, 예 를 들어 bilinear interpolation, nearest neighbor interpolation, bicubic interpolation, deconvolution interpolation, subpixel convolution interpolation, polyphase interpolation, trilinear interpolation, linear interpolation 중 적어도 하나의 보간 기법이 이용될 수 있다. 또한, 잔차 영상(residual image)은 잔 차 정보 만을 포함하는 영상을 의미할 수 있다. 여기서, 잔차 정보는 입력 영상과 기준 영상의 차이에 따른 정 보로서, 예를 들어, 에지(edge) 방향, 에지 강도, 노이즈 정보 또는 텍스처(texture) 정보 중 적어도 하나를 포 함할 수 있으나, 이에 한정되는 것은 아니다. 다른 예에 따라 잔차 정보는 계조 정보, 밝기 정보 또는 감마 정 보 중 적어도 하나를 포함할 수 있다. 다른 예에 따라 프로세서는 도 10c에 도시된 바와 같이 복호화된 영상을 인공 지능 모델에 입력 하여 잔차 영상(13’)을 획득하고, 잔차 영상(13')을 보간 처리하여 보간 처리된 잔차 영상(13\")을 획득 할 수 있다. 또한, 프로세서는 복호화 영상에 대해 보간 처리를 수행하여 보간 처리된 영상(1 2)을 획득할 수 있다. 이어서, 프로세서는 보간 처리된 영상을 보간 처리된 잔차 영상(13\")과 결합하 여 출력 영상, 예를 들어 고해상도 영상을 획득할 수 있다. 즉, 도 10c에 도시된 실시 예에 따르면, 도 10b 에 도시된 실시 예와 달리 복호화된 영상을 인공 지능 모델에 입력하여 잔차 영상(13’)을 획득할 수 도 있다. 다만, 본 개시의 다른 실시 예에 따르면, 인공 지능 모델 외의 타 인공 지능 모델을 추가로 포함할 수 있 음은 물론이다. 이 경우 인공 지능 모델 및 타 인공 지능 모델은 순차적으로 동작하거나, 병렬적으로 동 작할 수 있다. 일 예로, 프로세서는 인공 지능 모델에 복호화된 영상을 입력하고, 인공 지능 모 델의 출력을 타 인공 지능 모델에 입력한 후 타 인공 지능 모델로부터 출력되는 영상에 기초하여 출력 영 상을 획득할 수 있다. 다른 예로 프로세서는 인공 지능 모델 및 타 인공 지능 모델 각각에 복호화된 영상을 입력하고, 인공 지능 모델 및 타 인공 지능 모델로부터 병렬적으로 출력되는 복수의 영상에 기초하여 출력 영상을 획득할 수 있다. 예를 들어, 인공 지능 모델은 제1 잔차 영상을 생성하는 모델이고, 타 인공 지능 모델은 제2 잔차 영상을 생성하는 모델을 포함할 수 있다. 또는 인공 지능 모델 은 해상도의 업 스케일링을 위한 모델이고, 타 인공 지능 모델은 상술한 다양한 영상 처리 중 하나(예를 들어 Noise reduction)를 위한 모델일 수 있다. 또는 인공 지능 모델은 객체 영역 처리를 위한 모델이고, 타 인공 지능 모델은 배경 영역 처리를 위한 모델일 수 있다. 도 11a 및 도 11b는 일 실시예에 따른 전자 장치 및 수신 장치의 일 구현 예를 설명하기 위한 도면들이다. 도 11a는 일 실시예에 따른 전자 장치의 구현 예를 도시한 것으로, 도 11a에 따르면, 전자 장치(100\")는 프로세 서, 메모리 및 통신 인터페이스를 포함한다. 여기서, 프로세서 및 메모리는 도 2a 및도 2b에 도시된 구성과 중복되므로 자세한 설명은 생략하도록 한다. 통신 인터페이스는 외부 장치와 통신을 수행할 수 있다. 예를 들어 통신 인터페이스는 AP 기반의 Wi- Fi(와이파이, Wireless LAN 네트워크), 블루투스(Bluetooth), 지그비(Zigbee), 유/무선 LAN(Local Area Network), WAN(Wide Area Network), 이더넷(Ethernet), IEEE 1394, HDMI(High-Definition Multimedia Interface), USB(Universal Serial Bus), MHL(Mobile High-Definition Link), AES/EBU(Audio Engineering Society/ European Broadcasting Union), 옵티컬(Optical), 코액셜(Coaxial 등과 같은 통신 방식을 통해 외부 장치(예를 들어, 소스 장치), 외부 저장 매체(예를 들어, USB 메모리), 외부 서버(예를 들어 웹 하드) 등으로부 터 스트리밍 또는 다운로드 방식으로 영상 신호를 입력받을 수 있다. 일 실시예에 따라, 통신 인터페이스 는 인터넷 통신 네트워크를 통해 도 9에 도시된 수신 장치로 실시간 비디오 영상을 전송할 수 있다. 도 11b는 일 실시예에 따른 수신 장치의 구현 예를 도시한 것으로, 도 11b에 따르면, 수신 장치(200')는 메모리 , 통신 인터페이스, 프로세서, 디스플레이, 출력부 및 사용자 인터페이스를 포 함한다. 여기서, 메모리, 통신 인터페이스 및 프로세서는 도 9에 도시된 구성과 중복되므로 자 세한 설명은 생략하도록 한다. 디스플레이는 자발광 소자를 포함하는 디스플레이 또는, 비자발광 소자 및 백라이트를 포함하는 디스플레 이로 구현될 수 있다. 예를 들어, LCD(Liquid Crystal Display), OLED(Organic Light Emitting Diodes) 디스플 레이, LED(Light Emitting Diodes), 마이크로 LED(micro LED), Mini LED, PDP(Plasma Display Panel), QD(Quantum dot) 디스플레이, QLED(Quantum dot light-emitting diodes) 등과 같은 다양한 형태의 디스플레이 로 구현될 수 있다. 디스플레이 내에는 a-si TFT, LTPS(low temperature poly silicon) TFT, OTFT(organic TFT) 등과 같은 형태로 구현될 수 있는 구동 회로, 백라이트 유닛 등도 함께 포함될 수 있다. 한 편, 디스플레이는 터치 센서와 결합된 터치 스크린, 플렉시블 디스플레이(flexible display), 롤러블 디스 플레이(rollable display), 3차원 디스플레이(3D display), 복수의 디스플레이 모듈이 물리적으로 연결된 디스 플레이 등으로 구현될 수 있다. 프로세서는 상술한 다양한 실시 예에 따라 획득된 출력 영상을 출력하도록 디스플레이를 제어할 수 있다. 여기서, 출력 영상은, 4K 또는 8K 이상의 고해상도 영상일 수 있다. 출력부는 음향 신호를 출력한다. 예를 들어, 출력부는 프로세서에서 처리된 디지털 음향 신호를 아날로그 음향 신호로 변환하고 증폭하여 출력할 수 있다. 예를 들어, 출력부는 적어도 하나의 채널을 출 력할 수 있는, 적어도 하나의 스피커 유닛, D/A 컨버터, 오디오 앰프(audio amplifier) 등을 포함할 수 있다. 일 예에 따라 출력부는 다양한 멀티 채널 음향 신호를 출력하도록 구현될 수 있다. 이 경우, 프로세서 는 입력 영상의 인핸스 처리에 대응되도록 입력된 음향 신호를 인핸스 처리하여 출력하도록 출력부를 제어할 수 있다. 예를 들어, 프로세서는 입력된 2채널 음향 신호를 가상의 멀티 채널(예를 들어, 5.1 채널) 음향 신호로 변환하거나, 수신 장치(200')가 놓인 위치를 인식해 공간에 최적화된 입체 음향 신호로 처리 하거나, 입력 영상의 타입(예를 들어 컨텐츠 장르)에 따라 최적화된 음향 신호를 제공할 수 있다. 사용자 인터페이스는 버튼, 터치 패드, 마우스 및 키보드와 같은 장치로 구현되거나, 상술한 디스플레이 기능 및 조작 입력 기능도 함께 수행 가능한 터치 스크린, 리모콘 송수신부 등으로 구현될 수 있다. 리모콘 송 수신부는 적외선 통신, 블루투스 통신 또는 와이파이 통신 중 적어도 하나의 통신 방식을 통해 외부 원격 제어 장치로부터 리모콘 신호를 수신하거나, 리모콘 신호를 송신할 수 있다. 수신 장치(200')는 구현 예에 따라 튜너 및 복조부를 추가적으로 포함할 수 있다. 튜너(미도시)는 안테나를 통 해 수신되는 RF(Radio Frequency) 방송 신호 중 사용자에 의해 선택된 채널 또는 기 저장된 모든 채널을 튜닝하 여 RF 방송 신호를 수신할 수 있다. 복조부(미도시)는 튜너에서 변환된 디지털 IF 신호(DIF)를 수신하여 복조하 고, 채널 복호화 등을 수행할 수도 있다. 일 실시예에 따라 튜너를 통해 수신된 입력 영상은 복조부(미도시)를 통해 처리된 후, 일 실시예에 따른 영상 처리를 위해 프로세서로 제공될 수 있다. 도 12는 일 실시예에 따른 송수신 시스템의 동작을 설명하기 위한 도면이다. 도 12에서 점선으로 구분된 좌측은 송신 장치(예를 들어, 전자 장치(100, 100', 100\") 동작을 나타내고, 우측은 수신 장치(예를 들어 수신 장치(200, 200'))의 동작을 나타낼 수 있다. 이하에서는 설명의 편의를 위하여 좌측 의 동작은 전자 장치가 수행하고, 우측의 동작은 수신 장치가 수행하는 것으로 가정하도록 한다. 전자 장치는 다운스케일러, 영상 인코더, 송신부, 영상 품질 예측부 및 영상 품 질 제어부를 포함하고, 수신 장치는 수신부, 영상 디코더 및 업스케일러를 포함 할 수 있다. 여기서, 각 구성(1210 내지 1280)은 다양한 프로세싱을 위한 IP로 구현될 수 있다. 여기서, IP는,재이용 가능한 기능 블록을 지칭하며 적어도 하나의 하드웨어 또는 소프트웨어 기능 블록 또는 적어도 하나의 소프트웨어 및 적어도 하나의 하드웨어의 조합으로 구현될 수 있다. 전자 장치 내의 각 구성 요소(1210 내 지 1250)은 적어도 하나의 프로세싱 칩 내에 구현되고, 수신 장치 내의 각 구성 요소(1260 내지 1280) 또 한 적어도 하나의 프로세싱 칩 내에 구현될 수 있다. 다운스케일러은 제1 인공 지능 모델(410, 810)을 이용하여 영상 프레임을 다운스케일링할 수 있다. 비디 오 인코더은 다운스케일링된 영상 프레임을 인코딩할 수 있다. 송신부은 인코딩된 영상 프레임을 수신 장치로 전송할 수 있다. 이 경우, 영상 품질 예측부는 다운스케일러의 다운스케일링 과정에서 획득되는 영상 프레임의 특성 정보에 기초하여 영상 프레임의 품질를 추정할 수 있다. 여기서, 영상 프레임의 특성 정보는, 예를 들어, 제1 인공 지능 모델(410, 810)에 포함된 특정 레이어에서 출력되는 피쳐 맵 정보가 될 수 있다. 예를 들어, 영상 품질 예측부는 제2 인공 지능 모델(420, 820)로 구현될 수 있다. 제2 인공 지능 모델 (420, 820)은 제1 인공 지능 모델(410, 810)와 포함된 적어도 일부 레이어와 적어도 일부 레이어, 영상 프레임의 특성 정보를 품질 정보로 변환하기 위한 추가 레이어를 포함할 수 있다. 경우에 따라 도 8b에서 설명한 바와 같이 영상의 시간적 변화를 예측하기 위한 RNN 레이어을 더 포함할 수 있다. 제2 인공 지능 모델(420, 820)로부터 출력되는 현재 영상 프레임(또는 이전 영상 프레임)의 품질 정보는 도시된 바와 같이 복 수의 해상도 및 전송률(Bit-Rate) 셋에 대응되는 복수의 품질 지표(VQ_Metric)을 포함할 수 있다. 예를 들어 도 13에 도시된 바와 같이 품질 정보는 각 프레임 인덱스 별 품질 정보, 즉 해상도 및 전송률에 대응되는 품질 지 표가 될 수 있다. 영상 품질 제어부는 제2 인공 지능 모델(420, 820)로부터 출력되는 복수의 품질 지표 중 전자 장치 의 타겟 품질 지표, 네트워크 상태 등을 고려하여 하나의 품질 지표를 선택하고, 선택된 품질 지표에 대응되는 해상도 정보 및 전송률 정보를 각각 다운스케일러 및 영상 인코더로 제공할 수 있다. 여기서, 제공 되는 해상도 정보 및 전송률 정보는 현재 영상 프레임에 기초하여 획득되거나, 이전 영상 프레임에 기초하여 예 측된 정보일 수 있다. 이 경우, 다운스케일러 및 영상 인코더는 각각 수신된 해상도 정보 및 전송률 정보에 기초하여 다 운스케일링 및 부호화 처리를 수행할 수 있다. 송신부는 영상 인코더로부터 출력되는 부호화 영상을 패킷화하여 수신 장치로 전송할 수 있다. 수신 장치에 포함된 수신부는 송신 장치로부터 패킷이 수신되면, 수신된 패킷을 압축 영상 포 맷으로 역패킷화(De-Packetizing)할 수 있다. 영상 디코더은 수신부로부터 출력되는 영상 데이터를 복호화(또는 압축 해제)할 수 있다. 업스케일러는 복호화된 영상 데이터를 출력 해상도로 업스케일링하여 출력 영상을 획득할 수 있다. 이와 같이 획득된 출력 영상을 디스플레이를 통해 디스플레이될 수 있다. 이 경우, 수신된 패킷의 헤더에는 다운스케일러의 다운스케일링과 관련된 해상도 정보 및 영상 인코더(122 0)의 부호화와 관련된 전송률 정보가 포함될 수 있다. 영상 디코더는 헤더에 포함된 전송률 정보에 기초 하여 복호화를 수행하고, 업스케일러는 헤더에 포함된 해상도 정보에 기초하여 업스케일링을 수행할 수 있다. 한편, 도 12에 도시된 실시 예에서 제2 인공 지능 모델(420, 820)의 학습은 제2 인공 지능 모델(420, 820)로부 터 출력되는 품질 정보 및 실제 영상의 품질 정보 간 차이를 손실 함수(Loss Function)으로 하여 지도 학습 방 식으로 학습될 수 있다. 여기서, 실제 영상의 품질 정보는 일 예에 따라 원본 훈련 영상이 다운스케일러, 영상 인코더, 송신부, 수신부, 영상 디코더 및 업스케일러를 거쳐 복원된 영상 및 원본 훈련 영상을 비교함으로써 획득될 수 있다. 도 14는 일 실시예에 따른 전자 장치의 제어 방법을 설명하기 위한 흐름도이다. 도 14에 도시된 전자 장치의 제어 방법에 따르면, 전자 장치(100, 100', 100\")는 학습된 제1 인공 지능 모델을 이용하여 영상을 다운스케일링한다(S1410). 이어서, 전자 장치(100, 100', 100\")는 다운스케일링된 영상을 부호 화한다(S1420). 이 경우, 1410 단계에서는, 학습된 제2 인공 지능 모델을 이용하여 획득된 영상의 품질 정보에 기초하여 영상의 다운스케일링을 제어할 수 있다(S1430). 여기서, 제2 인공 지능 모델은, 제1 인공 지능 모델로부터 획득된 영상의 특성 정보를 이용하여 학습될 수 있다. 또한, S1420 단계에서는, 제2 인공 지능 모델을 이용하여 획득된 영상의 품질 정보에 기초하여 다운스케일링된 영상의 부호화를 제어할 수 있다. 여기서, 영상의 품질 정보는, 영상과 관련된 해상도 정보 및 전송률 정보의 상이한 조합에 대응되는 복수의 품 질 지표를 포함할 수 있다. 이 경우, S1410 단계에서는, 복수의 품질 지표 중 어느 하나의 품질 지표에 기초하 여 영상의 다운 스케일링 비율을 결정하고, 결정된 다운 스케일링 비율에 기초하여 영상의 다운스케일링을 제어 할 수 있다. 또한, S1420 단계에서는, 복수의 품질 지표 중 어느 하나의 품질 지표에 기초하여 다운스케일된 영 상의 전송률을 결정하고, 결정된 전송률에 기초하여 다운스케일링된 영상의 부호화를 제어할 수 있다. 또한, 전자 장치(100, 100', 100\")의 제어 방법은, 네트워크의 상태 정보를 획득하는 단계를 더 포함할 수 있다. 이 경우, S1410 단계에서는, 네트워크의 상태 정보 및 영상의 품질 정보에 기초하여 영상의 다운스케일링 을 제어할 수 있다. 또한, S1420 단계에서는, 네트워크의 상태 정보 및 영상의 품질 정보에 기초하여 다운스케 일링된 영상의 부호화를 제어할 수 있다. 또한, 전자 장치(100, 100', 100\")의 제어 방법은, 네트워크의 상태 정보에 기초하여 복수의 품질 지표 중 적어 도 하나의 품질 지표를 결정하고, 타겟 품질 지표에 기초하여 적어도 하나의 품질 지표 중 하나의 품질 지표를 결정하는 단계를 더 포함할 수 있다. 이 경우, S1410 단계에서는, 결정된 품질 지표에 대응되는 해상도 정보에 기초하여 영상의 다운스케일링을 제어할 수 있다. 또한, S1420 단계에서는, 결정된 품질 지표에 대응되는 전송 률 정보에 기초하여 다운스케일링된 영상의 부호화를 제어할 수 있다. 이 경우, 제2 인공 지능 모델은, 적어도 하나의 신경망 레이어를 포함하며, 적어도 하나의 신경망 레이어의 파 라미터는, 제1 인공 지능 모델에 포함된 적어도 일부 레이어의 파라미터와 연계되어 학습될 수 있다. 또한, S1410 단계에서는, 영상의 현재 프레임에 기초하여 획득된 품질 정보에 기초하여 현재 프레임의 다운스케 일링을 제어하거나, 영상의 적어도 하나의 이전 프레임에 기초하여 예측된 품질 정보에 기초하여 현재 프레임의 다운스케일링을 제어할 수 있다. 또한, 제2 인공 지능 모델은, 적어도 하나의 이전 프레임에 대응되는 특성 정보에 기초하여 현재 프레임의 품질 정보를 예측하도록 학습된 적어도 하나의 RNN(Recurrent Neural Networks) 레이어를 포함할 수 있다. 또한, 제2 인공 지능 모델은, 훈련 영상과 관련된 복수의 해상도 정보 및 복수의 전송률 정보의 상이한 조합에 대응되는 복수의 실제 품질 지표 및 훈련 영상을 제2 인공 지능 모델에 입력하여 출력되는 복수의 품질 지표 간 차이를 손실 함수로 하여 지도 학습될 수 있다. 여기서, 실제 품질 지표에 대해서는 도 6에서 상술하였으므로 자세한 설명은 생략하도록 한다. 또한, 전자 장치(100, 100', 100\")의 제어 방법은, 부호화된 영상에 기초하여 패킷을 생성하고 생성된 패킷을 전송하는 단계를 더 포함할 수 있다. 이 경우, 영상의 해상도 정보 및 전송률 정보는 패킷의 헤더 영역에 포함 될 수 있다. 상술한 다양한 실시 예에 따르면, 실시간으로 예측된 영상 품질, 네트워크 상태를 기반으로 최적 해상도 및 전 송률을 제어할 수 있게 된다. 이에 따라 네트워크 대역폭을 효율적으로 사용할 수 있으며, 주어진 네트워크 환 경에서 소비자 체감 품질을 최대화할 수 있다. 특히, 지연 시간(Latency) 제약이 있는 실시간 라이브 스트리밍 (Live Streaming)에서 영상의 해상도 및 전송률을 최적으로 제어함으로써 네트워크 대역폭을 효율적으로 사용할 수 있게 된다. 또한 다운스케일링 과정 중에 획득된 영상의 특성 정보를 공유하여 영상 품질을 예측함으로써, 인공 지능 모델 의 효율적 학습이 가능하며 H/W 구현 복잡도를 최소화할 수 있다. 이하에서는, 도면을 참조하여 일 실시예에 따른 AI 부호화 과정 및 AI 복호화 과정에 대해 설명하도록 한다. 도 15는 일 실시예에 따른 AI(artificial intelligence) 부호화 과정 및 AI 복호화 과정을 설명하기 위한 도면 이다. 전술한 바와 같이 영상의 해상도가 급격히 커짐에 따라 부호화/복호화를 위한 정보 처리량이 많아지게 되고, 이 에 따라 영상의 부호화 및 복호화 효율을 향상시키기 위한 방안이 필요하다. 도 15에 도시된 바와 같이, 본 개시의 일 실시예에 따르면, 해상도가 큰 영상을 AI 다운스케일하여 제1 영상을 획득한다. 그리고, 상대적으로 작은 해상도의 제1 영상을 대상으로 하여 제1 부호화 및 제1 복호화를 수행하므로, 영상을 대상으로 하여 제1 부호화 및 제1 복호화 를 수행하는 경우에 비해 처리되는 비트레이트를 크게 감소시킬 수 있다. 도 15를 참조하여 상세히 설명하면, 일 실시예는 AI 부호화 과정에서, 영상을 AI 다운스케일하여 제 1 영상을 획득하고, 제1 영상을 제1 부호화한다. AI 복호화 과정에서는, AI 부호화 결과 획 득된 AI 데이터와 영상 데이터를 포함하는 AI 부호화 데이터를 수신하고, 제1 복호화를 통해 제2 영상 을 획득하고, 제2 영상을 AI 업스케일하여 제3 영상을 획득한다. AI 부호화 과정을 좀 더 상세히 살펴보면, 영상을 입력받으면, 소정 해상도 또는 소정 화질의 제1 영상 을 획득하기 위해 영상을 AI 다운스케일한다. 이때, AI 다운스케일은 AI 기반으로 수 행되는데, AI 다운스케일을 위한 AI는 제2 영상의 AI 업스케일을 위한 AI와 연계되어 훈련되 어야(joint trained ) 한다. 왜냐하면, AI 다운스케일을 위한 AI와 AI 업스케일을 위한 AI가 분리 되어 훈련되는 경우, AI 부호화 대상인 영상과 AI 복호화를 통해 복원된 제3영상 사이의 차이가 커 지게 되기 때문이다. 본 개시의 실시예에서는, AI 부호화 과정과 AI 복호화 과정에서 이러한 연계 관계를 유지하기 위해, AI 데이터 를 이용할 수 있다. 따라서, AI 부호화 과정을 통해 획득된 AI 데이터는 업스케일 타겟을 나타내는 정보를 포함 하여야 하고, AI 복호화 과정에서는 AI 데이터에 기초하여 확인되는 업스케일 타겟에 따라 제2 영상을 AI 업스케일하여야 한다. AI 다운스케일을 위한 AI 및 AI 업스케일을 위한 AI는 DNN(deep neural network)으로 구현될 수 있다. 도 23을 참조하여 후술하는 바와 같이, 제1 DNN과 제2 DNN은 소정 타겟 하에 손실 정보의 공유를 통해 연 계 훈련되므로, AI 부호화 장치는 제1 DNN과 2 DNN이 연계 훈련할 때 이용된 타겟 정보를 AI 복호화 장치로 제 공하고, AI 복호화 장치는 제공받은 타겟 정보에 기초하여 제2 영상을 타겟하는 해상도로 AI 업스케일 할 수 있다. 도 1에 도시된 제1 부호화 및 제1 복호화에 대해 상세히 설명하면, 영상으로부터 AI 다운스 케일된 제1 영상은 제1 부호화를 통해 정보량이 감축될 수 있다. 제1 부호화는, 제1 영 상을 예측하여 예측 데이터를 생성하는 과정, 제1 영상과 예측 데이터 사이의 차이에 해당하는 잔 차 데이터를 생성하는 과정, 공간 영역 성분인 잔차 데이터를 주파수 영역 성분으로 변환(transformation)하는 과정, 주파수 영역 성분으로 변환된 잔차 데이터를 양자화(quantization)하는 과정 및 양자화된 잔차 데이터를 엔트로피 부호화하는 과정 등을 포함할 수 있다. 이와 같은 제1 부호화 과정은 MPEG-2, H.264 AVC(Advanced Video Coding), MPEG-4, HEVC(High Efficiency Video Coding), VC-1, VP8, VP9 및 AV1(AOMedia Video 1) 등 주파수 변환을 이용한 영상 압축 방법 중의 하나를 통해 구현될 수 있다. 제1 영상에 대응하는 제2 영상은 영상 데이터의 제1 복호화를 통해 복원될 수 있다. 제1 복 호화는, 영상 데이터를 엔트로피 복호화하여 양자화된 잔차 데이터를 생성하는 과정, 양자화된 잔차 데이 터를 역양자화하는 과정, 주파수 영역 성분의 잔차 데이터를 공간 영역 성분으로 변환하는 과정, 예측 데이터를 생성하는 과정 및 예측 데이터와 잔차 데이터를 이용하여 제2 영상을 복원하는 과정 등을 포함할 수 있다. 이와 같은 제1 복호화 과정은 제1 부호화 과정에서 사용된 MPEG-2, H.264, MPEG-4, HEVC, VC-1, VP8, VP9 및 AV1 등 주파수 변환을 이용한 영상 압축 방법 중의 하나에 대응되는 영상 복원 방법을 통해 구현될 수 있다. AI 부호화 과정을 통해 획득된 AI 부호화 데이터는, 제1 영상의 제1 부호화 결과 획득된 영상 데이 터 및 영상의 AI 다운스케일과 관련된 AI 데이터를 포함할 수 있다. 영상 데이터는 제1 복호화 과정에서 이용될 수 있으며, AI 데이터는 AI 업스케일 과정에서 이용될 수 있다. 영상 데이터는 비트스트림 형태로 전송될 수 있다. 영상 데이터는 제1 영상 내 픽셀 값들에 기초하여 획 득되는 데이터, 예를 들어, 제1 영상과 제1 영상의 예측 데이터 사이의 차이인 잔차 데이터를 포함 할 수 있다. 또한, 영상 데이터는 제1 영상의 제1 부호화 과정에서 이용된 정보들을 포함한다. 예 를 들어, 영상 데이터는 제1 영상을 제1 부호화하는데 이용된 예측 모드(mode) 정보, 움직임 정보, 및 제1 부호화에서 이용된 양자화 파라미터 관련 정보 등을 포함할 수 있다. 영상 데이터는 MPEG-2, H.264 AVC, MPEG-4, HEVC, VC-1, VP8, VP9 및 AV1 등 주파수 변환을 이용하는 영상 압축 방법 중 제1 부호화 과정에서 이용된 영상 압축 방법의 규칙, 예를 들어, 신택스(syntax)에 따라 생성될 수 있다. AI 데이터는 제2 DNN에 기반한 AI 업스케일에 이용된다. 전술한 바와 같이, 제1 DNN과 제2 DNN은 연계 훈 련되기 때문에, AI 데이터는 제2 DNN을 통한 제2 영상의 정확한 AI 업스케일이 수행될 수 있게 하는 정보를 포함한다. AI 복호화 과정에서는 AI 데이터에 기반하여 제2 영상을 타겟하는 해상도 및/또는 화질 로 AI 업스케일할 수 있다. AI 데이터는 비트스트림의 형태로 영상 데이터와 함께 전송될 수 있다. 또는, 구현예에 따라, AI 데이터는 프레 임이나 패킷 형태로 영상 데이터와 구분되어 전송될 수도 있다. AI 부호화 결과 획득된 영상 데이터와 AI 데이 터는 동일한 네트워크 또는 서로 상이한 네트워크를 통해 전송될 수 있다. 도 16은 일 실시예에 따른 AI 복호화 장치의 구성을 도시하는 블록도이다. 도 16을 참조하면, 일 실시예에 따른 AI 복호화 장치는 수신부 및 AI 복호화부를 포함할 수 있다. 수신부는 통신부, 파싱부 및 출력부를 포함할 수 있다. AI 복호화부는 제1 복호화부 및 AI 업스케일부를 포함할 수 있다. 수신부는 AI 부호화 결과 획득된 AI 부호화 데이터를 수신 및 파싱하고, 영상 데이터와 AI 데이터를 구분 하여 AI 복호화부로 출력한다. 구체적으로, 통신부는 네트워크를 통해 AI 부호화 결과 획득된 AI 부호화 데이터를 수신한다. AI 부호화 결과 획득된 AI 부호화 데이터는 영상 데이터와 AI 데이터를 포함한다. 영상 데이터와 AI 데이터는 동종 네트워 크 또는 이종 네트워크를 통해 수신될 수 있다. 파싱부는 통신부를 통해 수신된 AI 부호화 데이터를 전달받아 파싱(parsing)하여 영상 데이터와 AI 데이터로 구분한다. 예를 들어, 통신부로부터 획득된 데이터의 헤더를 읽어, 해당 데이터가 영상 데이터 인지 또는 AI 데이터인지를 구분할 수 있다. 일 예에서, 파싱부는 통신부를 통해 수신된 데이터의 헤더를 통해 영상 데이터와 AI 데이터를 구분하여 출력부로 전달하고, 출력부는 각각의 구분된 데 이터를 제1 복호화부 및 AI 업스케일부로 전달한다. 이 때, AI 부호화 데이터에 포함된 영상 데이 터가 소정의 코덱(예를 들어, MPEG-2, H.264, MPEG-4, HEVC, VC-1, VP8, VP9 또는 AV1)을 통해 획득된 영상 데 이터인 것으로 확인할 수도 있다. 이 경우, 영상 데이터가 상기 확인된 코덱으로 처리될 수 있도록, 출력부 를 통해 해당 정보를 제1 복호화부로 전달할 수 있다. 일 실시예에서, 파싱부가 파싱하는 AI 부호화 데이터는, 하드 디스크, 플로피 디스크 및 자기 테이프와 같은 자기 매체, CD-ROM 및 DVD와 같은 광기록 매체, 플롭티컬 디스크(floptical disk)와 같은 자기-광 매체 (magneto-optical medium) 등을 포함하는 데이터 저장 매체로부터 획득된 것일 수도 있다. 제1 복호화부는 영상 데이터에 기초하여 제1 영상에 대응하는 제2 영상을 복원한다. 제1 복 호화부에 의해 획득된 제2 영상은 AI 업스케일부로 제공된다. 구현예에 따라서는, 영상 데이 터에 포함된 예측 모드 정보, 움직임 정보, 양자화 파라미터 정보 등의 제1 복호화 관련 정보가 AI 업스케일부 로 더 제공될 수 있다. AI 데이터를 수신한 AI 업스케일부는 AI 데이터에 기초하여 제2 영상을 AI 업스케일한다. 구현예에 따라서는, 영상 데이터에 포함된 예측 모드 정보, 양자화 파라미터 정보 등의 제1 복호화 관련 정보를 더 이용 하여 AI 업스케일 할 수 있다. 일 실시예에 따른 수신부 및 AI 복호화부는 개별적인 장치로 설명되었으나, 하나의 프로세서를 통 해 구현될 수 있다. 이 경우, 수신부 및 AI 복호화부는 전용 프로세서로 구현될 수도 있고, AP 또 는 CPU, GPU와 같은 범용 프로세서와 S/W의 조합을 통해 구현될 수도 있다. 또한, 전용 프로세서의 경우, 본 개 시의 실시예를 구현하기 위한 메모리를 포함하여 구현되거나, 외부 메모리를 이용하기 위한 메모리 처리부를 포 함하여 구현될 수 있다. 또한, 수신부 및 AI 복호화부는 복수의 프로세서로 구성될 수도 있다. 이 경우, 전용 프로세서들의 조합으로 구현될 수도 있고, AP 또는 CPU, GPU와 같은 다수의 범용 프로세서들과 S/W의 조합을 통해 구현될 수 도 있다. 마찬가지로 AI 업스케일부와 제1 복호화부도 각각 서로 다른 프로세서로 구현될 수 있다. AI 업스케일부로 제공되는 AI 데이터는, 제2 영상을 AI 업스케일할 수 있게 하는 정보들을 포함한 다. 이때, 업스케일 타겟은 제1 DNN의 다운스케일에 대응하여야 한다. 따라서, AI 데이터는 제1 DNN의 다운스케일 타겟을 확인할 수 있는 정보가 포함되어야 한다. AI 데이터에 포함된 정보를 구체적으로 예시하면, 영상의 해상도와 제1 영상의 해상도의 차이 정보, 제1 영상 관련 정보가 있다. 차이 정보는, 영상 대비 제1 영상의 해상도 변환 정도에 대한 정보(예를 들어, 해상도 변환률 정보)로 표현될 수 있다. 그리고, 복원된 제2 영상의 해상도를 통해 제1 영상의 해상도를 알게 되 고 이를 통해 해상도 변환 정도를 확인할 수 있기 때문에, 차이 정보는 영상의 해상도 정보만으로 표현될 수도 있다. 여기서 해상도 정보는 가로/세로의 화면 사이즈로 표현될 수도 있고, 비율(16:9, 4:3 등)과 한 축의 사이즈로 표현될 수도 있다. 또한, 기 설정된 해상도 정보가 있는 경우는 인덱스 또는 플래그의 형태로 표현될 수도 있다. 그리고, 제1 영상 관련 정보는, 제1 영상의 제1 부호화 결과 획득된 영상 데이터의 비트레이트 및 제1 영상의 제1 부호화시 이용된 코덱 타입 중 적어도 하나에 대한 정보를 포함할 수 있다. AI 업스케일부는 AI 데이터에 포함된 차이 정보 및 제1 영상 관련 정보 중 적어도 하나에 기초하여 제2 영상의 업스케일 타겟을 결정할 수 있다. 업스케일 타겟은 예를 들어, 제2 영상을 어느 정도의 해상도로 업스케일하여야 하는지를 나타낼 수 있다. AI 업스케일부는 업스케일 타겟이 결정되면, 업스케 일 타겟에 대응하는 제3영상을 획득하기 위해 제2 DNN을 통해 제2 영상을 AI 업스케일한다. AI 업스케일부가 업스케일 타겟에 맞춰 제2 영상을 AI 업스케일하는 방법을 설명하기에 앞서, 제2 DNN을 통한 AI 업스케일 과정에 대해 도 3 및 도 4를 참조하여 설명한다. 도 17은 제2 영상의 AI 업스케일을 위한 제2 DNN을 나타내는 예시적인 도면이고, 도 18는 도 17에 도시된 제1 컨볼루션 레이어에서의 컨볼루션 연산을 도시하고 있다. 도 17에 도시된 바와 같이, 제2 영상은 제1 컨볼루션 레이어로 입력된다. 도 17에 도시된 제1 컨볼 루션 레이어에 표시된 3X3X4는 3 x 3의 크기의 4개의 필터 커널을 이용하여 1개의 입력 영상에 대해 컨볼 루션 처리를 하는 것을 예시한다. 컨볼루션 처리 결과 4개의 필터 커널에 의해 4개의 특징 맵이 생성된다. 각 특징 맵은 제2 영상의 고유한 특성들을 나타낸다. 예를 들어, 각 특징 맵은 제2 영상의 수직 방향 특성, 수평 방향 특성 또는 에지 특성 등을 나타낼 수 있다. 도 18을 참조하여, 제1 컨볼루션 레이어에서의 컨볼루션 연산에 대해 상세히 설명한다. 제1 컨볼루션 레이어에서 이용되는 3 X 3의 크기를 갖는 필터 커널의 파라미터들과 그에 대응하는 제 2 영상 내 픽셀 값들 사이의 곱 연산 및 덧셈 연산을 통해 하나의 특징 맵이 생성될 수 있다. 제1 컨볼루션 레이어에서는 4개의 필터 커널이 이용되므로, 4개의 필터 커널을 이용한 컨볼루션 연산 과정을 통해 4개의 특징 맵이 생성될 수 있다. 도 18에서 제2 영상에 표시된 I1 내지 I49는 제2 영상의 픽셀들을 나타내고, 필터 커널에 표 시된 F1 내지 F9는 필터 커널의 파라미터들을 나타낸다. 또한, 특징 맵에 표시된 M1 내지 M9는 특징 맵의 샘플들을 나타낸다. 도 18은 제2 영상이 49개의 픽셀을 포함하는 것으로 예시하고 있으나, 이는 하나의 예시일 뿐이며, 제2 영상이 4K의 해상도를 갖는 경우, 예를 들어, 3840 X 2160개의 픽셀을 포함할 수 있다. 컨볼루션 연산 과정에서, 제2 영상의 I1, I2, I3, I8, I9, I10, I15, I16, I17의 픽셀 값들 각각과 필터 커널의 F1, F2, F3, F4, F5, F6, F7, F8 및 F9 각각의 곱 연산이 수행되고, 곱 연산의 결과 값들을 조합 (예를 들어, 덧셈 연산)한 값이 특징 맵의 M1의 값으로 할당될 수 있다. 컨볼루션 연산의 스트라이드 (stride)가 2라면, 제2 영상의 I3, I4, I5, I10, I11, I12, I17, I18, I19의 픽셀 값들 각각과 필터 커 널의 F1, F2, F3, F4, F5, F6, F7, F8 및 F9 각각의 곱 연산이 수행되고, 곱 연산의 결과 값들을 조합한 값이 특징 맵의 M2의 값으로 할당될 수 있다. 필터 커널이 제2 영상의 마지막 픽셀에 도달할 때까지 스트라이드에 따라 이동하는 동안 제2 영상 내 픽셀 값들과 필터 커널의 파라미터들 사이의 컨볼루션 연산이 수행됨으로써, 소정 크기를 갖는 특징 맵이 획득될 수 있다. 본 개시에 따르면, 제1 DNN과 제2 DNN의 연계 훈련을 통해 제2 DNN의 파라미터들, 예를 들어, 제2 DNN의 컨볼루 션 레이어들에서 이용되는 필터 커널의 파라미터들(예를 들어, 필터 커널의 F1, F2, F3, F4, F5, F6, F7,F8 및 F9)의 값이 최적화될 수 있다. 전술한 바와 같이, AI 업스케일부는 AI 데이터에 기초하여, 제1 DNN 의 다운스케일 타겟에 대응하는 업스케일 타겟을 결정하고, 결정된 업스케일 타겟에 대응하는 파라미터들을 제2 DNN의 컨볼루션 레이어들에서 이용되는 필터 커널의 파라미터들로 결정할 수 있다. 제1 DNN 및 제2 DNN에 포함된 컨볼루션 레이어들은 도 4와 관련하여 설명한 컨볼루션 연산 과정에 따른 처리를 할 수 있으나, 도 4에서 설명한 컨볼루션 연산 과정은 하나의 예시일 뿐이며, 이에 한정되는 것은 아니다. 다시 도 17을 참조하면, 제1 컨볼루션 레이어에서 출력된 특징 맵들은 제1 활성화 레이어로 입력된다. 제1 활성화 레이어는 각각의 특징 맵에 대해 비선형(Non-linear) 특성을 부여할 수 있다. 제1 활성화 레이어는 시그모이드 함수(sigmoid function), Tanh 함수, ReLU(Rectified Linear Unit) 함수 등 을 포함할 수 있으나, 이에 한정되는 것은 아니다. 제1 활성화 레이어에서 비선형 특성을 부여하는 것은, 제1 컨볼루션 레이어의 출력인, 특징 맵의 일 부 샘플 값을 변경하여 출력하는 것을 의미한다. 이때, 변경은 비선형 특성을 적용하여 수행된다. 제1 활성화 레이어는 제1 컨볼루션 레이어로부터 출력되는 특징 맵들의 샘플 값들을 제2 컨볼루션 레 이어로 전달할지 여부를 결정한다. 예를 들어, 특징 맵들의 샘플 값들 중 어떤 샘플 값들은 제1 활성화 레 이어에 의해 활성화되어 제2 컨볼루션 레이어로 전달되고, 어떤 샘플 값들은 제1 활성화 레이어(32 0)에 의해 비활성화되어 제2 컨볼루션 레이어로 전달되지 않는다. 특징 맵들이 나타내는 제2 영상의 고유 특성이 제1 활성화 레이어에 의해 강조된다. 제1 활성화 레이어에서 출력된 특징 맵들은 제2 컨볼루션 레이어로 입력된다. 도 3에 도시된 특 징 맵들 중 어느 하나는 도 4와 관련하여 설명한 특징 맵이 제1 활성화 레이어에서 처리된 결과 이다. 제2 컨볼루션 레이어에 표시된 3X3X4는 3 x 3의 크기의 4개의 필터 커널을 이용하여 입력된 특징 맵들 에 대해 컨볼루션 처리하는 것을 예시한다. 제2 컨볼루션 레이어의 출력은 제2 활성화 레이어로 입력된다. 제2 활성화 레이어는 입력 데이터에 대해 비선형 특성을 부여할 수 있다. 제2 활성화 레이어에서 출력된 특징 맵들은 제3컨볼루션 레이어로 입력된다. 도 3에 도시된 제3 컨볼루션 레이어에 표시된 3X3X1는 3 x 3의 크기의 1개의 필터 커널을 이용하여 1개의 출력 영상을 만들기 위해 컨볼루션 처리를 하는 것을 예시한다. 제3컨볼루션 레이어는 최종 영상을 출력하기 위한 레이어로서 1개의 필터 커널을 이용하여 1개의 출력을 생성한다. 본 개시의 예시에 따르면, 제3컨볼루션 레이어는 컨 벌루션 연산 결과를 통해 제3영상을 출력할 수 있다. 제2 DNN의 제1 컨볼루션 레이어, 제2 컨볼루션 레이어 및 제3컨볼루션 레이어의 필터 커널 의 개수, 필터 커널의 파라미터 등을 나타내는 DNN 설정 정보는 후술하는 바와 같이 복수 개일 수 있는데, 복수 의 DNN 설정 정보는 제1 DNN의 복수의 DNN 설정 정보와 연계되어야 한다. 제2 DNN의 복수의 DNN 설정 정보와 제 1 DNN의 복수의 DNN 설정 정보 사이의 연계는, 제1 DNN 및 제2 DNN의 연계 학습을 통해 구현될 수 있다. 도 17은 제2 DNN이 세 개의 컨볼루션 레이어(310, 330, 350)와 두 개의 활성화 레이어(320, 340)를 포함 하고 있는 것으로 도시하고 있으나, 이는 하나의 예시일 뿐이며, 구현예에 따라서, 컨볼루션 레이어 및 활성화 레이어의 개수는 다양하게 변경될 수 있다. 또한, 구현예에 따라서, 제2 DNN은 RNN(recurrent neural network)을 통해 구현될 수도 있다. 이 경우는 본 개시의 예시에 따른 제2 DNN의 CNN 구조를 RNN 구조로 변경하는 것을 의미한다. 일 실시예에서, AI 업스케일부는 전술한 컨볼루션 연산 및 활성화 레이어의 연산을 위한 적어도 하나의 ALU(Arithmetic logic unit)를 포함할 수 있다. ALU는 프로세서로 구현될 수 있다. 컨볼루션 연산을 위해, ALU 는 제2 영상 또는 이전 레이어에서 출력된 특징 맵의 샘플 값들과 필터 커널의 샘플 값들 사이의 곱 연산 을 수행하는 곱셈기 및 곱셈의 결과 값들을 더하는 가산기를 포함할 수 있다. 또한, 활성화 레이어의 연산을 위 해, ALU는 미리 결정된 시그모이드 함수, Tanh 함수 또는 ReLU 함수 등에서 이용되는 가중치를 입력된 샘플 값 에 곱하는 곱셈기, 및 곱한 결과와 소정 값을 비교하여 입력된 샘플 값을 다음 레이어로 전달할지를 판단하는 비교기를 포함할 수 있다. 이하에서, AI 업스케일부가 업스케일 타겟에 맞춰 제2 영상을 AI 업스케일하는 방법을 설명한다. 일 실시예에서, AI 업스케일부는 제2 DNN에 세팅 가능한 복수의 DNN 설정 정보를 저장할 수 있다. 여기서, DNN 설정 정보는 제2 DNN에 포함되는 컨볼루션 레이어의 수, 컨볼루션 레이어별 필터 커널의 개수 및 각 필터 커널의 파라미터 중 적어도 하나에 대한 정보를 포함할 수 있다. 복수의 DNN 설정 정보는 다양한 업스 케일 타겟에 각각 대응될 수 있으며, 특정 업스케일 타겟에 대응되는 DNN 설정 정보에 기반하여 제2 DNN이 동작 할 수 있다. DNN 설정 정보에 따라 제2 DNN이 서로 다른 구조를 가질 수 있다. 예를 들어, 어느 DNN 설정 정보 에 따라 제2 DNN이 3개의 컨볼루션 레이어를 포함할 수 있고, 다른 DNN 설정 정보에 따라 제2 DNN이 4개의 컨볼 루션 레이어를 포함할 수 있다. 일 실시예에서, DNN 설정 정보는 제2 DNN에서 사용되는 필터 커널의 파라미터만을 포함할 수도 있다. 이 경우, 제2 DNN의 구조는 변경되지 않는 대신, DNN 설정 정보에 따라 내부의 필터 커널의 파라미터만이 달라질 수 있다. AI 업스케일부는 복수의 DNN 설정 정보 중 제2 영상의 AI 업스케일을 위한 DNN 설정 정보를 획득할 수 있다. 여기서 사용되는 복수의 DNN 설정 정보 각각은 미리 결정된 해상도 및/또는 미리 결정된 화질의 제3영 상을 획득하기 위한 정보로, 제1 DNN과 연계하여 훈련된 것이다. 예를 들어, 복수의 DNN 설정 정보 중 어느 하나의 DNN 설정 정보는 제2 영상의 해상도보다 2배 큰 해상도 의 제3영상, 예를 들어, 2K (2048*1080)의 제2 영상보다 2배 큰 4K(4096*2160)의 제3영상을 획득하기 위한 정보들을 포함할 수 있고, 다른 하나의 DNN 설정 정보는 제2 영상의 해상도보다 4배 큰 해 상도의 제3영상, 예를 들어, 2K (2048*1080)의 제2 영상보다 4배 큰 8K(8192*4320)의 제3영상 을 획득하기 위한 정보들을 포함할 수 있다. 복수의 DNN 설정 정보 각각은 AI 부호화 장치의 제1 DNN의 DNN 설정 정보와 연계되어 만들어진 것이며, AI 업스케일부는 제1 DNN의 DNN 설정 정보의 축소 비율에 대응되는 확대 비율에 따라 복수의 DNN 설정 정보 중 하나의 DNN 설정 정보를 획득한다. 이를 위해, AI 업스케일부는 제1 DNN의 정보를 확인하여야 한다. 제1 DNN의 정보를 AI 업스케일부가 확인하기 위해, 일 실시예에 따른 AI 복호화 장치는 AI 부호화 장치로부터 제1 DNN의 정보를 포함하는 AI 데이터를 수신한다. 다시 말하면, AI 업스케일부는 AI 부호화 장치로부터 수신되는 정보들을 이용하여, 제1 영상 을 획득하기 위해 이용된 제1 DNN의 DNN 설정 정보가 타겟하는 정보를 확인하고, 그와 연계 훈련된 제2 DNN의 DNN 설정 정보를 획득할 수 있는 것이다. 복수의 DNN 설정 정보 중 제2 영상의 AI 업스케일을 위한 DNN 설정 정보가 획득되면, 획득된 DNN 설정 정 보에 따라 동작하는 제2 DNN에 기초하여 입력 데이터가 처리될 수 있다. 예를 들어, 어느 하나의 DNN 설정 정보가 획득되면, 도 17에 도시된 제2 DNN의 제1 컨볼루션 레이어, 제2 컨볼루션 레이어 및 제3컨볼루션 레이어 각각에 대해서, 각 레이어에 포함되는 필터 커널의 개수 와 필터 커널의 파라미터들을, 상기 획득된 DNN 설정 정보에 포함된 값으로 설정한다. 구체적으로, 도 4에 도시된 제2 DNN의 어느 하나의 컨볼루션 레이어에서 이용되는 3 X 3의 필터 커널의 파라미 터들이 {1, 1, 1, 1, 1, 1, 1, 1, 1}로 세팅되도록 하고, 이후 DNN 설정 정보의 변경이 있는 경우, 이를 변경된 DNN 설정 정보에 포함된 파라미터들인 {2, 2, 2, 2, 2, 2, 2, 2, 2}로 교체할 수 있는 것이다. AI 업스케일부는 AI 데이터에 포함된 정보에 기초하여 복수의 DNN 설정 정보 중 제2 영상을 업스케 일하기 위한 DNN 설정 정보를 획득할 수 있는데, DNN 설정 정보를 획득하는데 이용되는 AI 데이터에 대해 구체 적으로 설명한다. 일 실시예에서, AI 업스케일부는 AI 데이터에 포함된 차이 정보에 기초하여, 복수의 DNN 설정 정보 중 제 2 영상을 업스케일하기 위한 DNN 설정 정보를 획득할 수 있다. 예를 들어, 차이 정보에 기초하여 영상 의 해상도(예를 들어, 4K(4096*2160))가 제1 영상의 해상도(예를 들어, 2K (2048*1080))보다 2배 큰 것으로 확인된 경우, AI 업스케일부는 제2 영상의 해상도를 2배 증가시킬 수 있는 DNN 설정 정 보를 획득할 수 있다. 다른 실시예에서, AI 업스케일부는 AI 데이터에 포함된 제1 영상 관련 정보에 기초하여, 복수의 DNN 설정 정보 중 제2 영상을 AI 업스케일하기 위한 DNN 설정 정보를 획득할 수 있다. AI 업스케일부 는 영상 관련 정보들과 DNN 설정 정보들 사이의 매핑 관계를 미리 결정하고, 제1 영상 관련 정보에 매핑된 DNN 설정 정보를 획득할 수 있다.도 19는 여러 영상 관련 정보들과 여러 DNN 설정 정보들 사이의 매핑 관계를 나타내는 예시적인 도면이다. 도 19에 따른 실시예를 통해, 본 개시의 일 실시예의 AI 부호화/AI 복호화 과정은 해상도의 변화만을 고려하는 것이 아님을 알 수 있다. 도 19에 도시된 바와 같이, SD, HD, Full HD와 같은 해상도, 10Mbps, 15Mbps, 20Mbps 와 같은 비트레이트, 그리고 AV1, H.264, HEVC와 같은 코덱 정보를 개별적으로 또는 모두 고려하여 DNN 설정 정 보의 선택이 이루어질 수 있다. 이러한 고려를 위해서는 AI 훈련 과정에서 각각의 요소들을 고려한 훈련이 부호 화, 복호화 과정에 연계되어 이루어져야 한다(도 23 참조). 따라서, 훈련 내용에 따라서 도 19에 도시된 바와 같이, 코덱 타입, 영상의 해상도 등을 포함하는 영상 관련 정 보에 기반하여 복수의 DNN 설정 정보가 구비된 경우, AI 복호화 과정에서 전달받는 제1 영상 관련 정보에 기반하여 제2 영상의 AI 업스케일을 위한 DNN 설정 정보를 획득할 수 있다. 즉, AI 업스케일부는 도 19에 도시된 표의 좌측에 도시된 영상 관련 정보와 표 우측의 DNN 설정 정보를 매칭하고 있음으로써, 영상 관련 정보에 따른 DNN 설정 정보를 사용할 수 있는 것이다. 도 19에 예시된 바와 같이, 제1 영상 관련 정보로부터 제1 영상의 해상도가 SD이고, 제1 영상 의 제1 부호화 결과 획득된 영상 데이터의 비트레이트가 10Mbps이고, 제1 영상이 AV1 코덱으로 제1 부호화된 것으로 확인되면, AI 업스케일부는 복수의 DNN 설정 정보 중 A DNN 설정 정보를 사용할 수 있다. 또한, 제1 영상 관련 정보로부터 제1 영상의 해상도가 HD이고, 제1 부호화 결과 획득된 영상 데이 터의 비트레이트가 15Mbps이고, 제1 영상이 H.264 코덱으로 제1 부호화된 것으로 확인되면, AI 업스케일 부는 복수의 DNN 설정 정보 중 B DNN 설정 정보를 사용할 수 있다. 또한, 제1 영상 관련 정보로부터 제1 영상의 해상도가 Full HD이고, 제1 영상의 제1 부호화 결과 획득된 영상 데이터의 비트레이트가 20Mbps이고, 제1 영상이 HEVC 코덱으로 제1 부호화된 것으로 확 인되면, AI 업스케일부는 복수의 DNN 설정 정보 중 C DNN 설정 정보를 사용하고, 제1 영상의 해상 도가 Full HD이고, 제1 영상의 제1 부호화 결과 획득된 영상 데이터의 비트레이트가 15Mbps이고, 제1 영 상이 HEVC 코덱으로 제1 부호화된 것으로 확인되면, AI 업스케일부는 복수의 DNN 설정 정보 중 D DNN 설정 정보를 사용할 수 있다. 제1 영상의 제1 부호화 결과 획득된 영상 데이터의 비트레이트가 20Mbps인지 또는 15Mbps인지에 따라 C DNN 설정 정보와 D DNN 설정 정보 중에서 어느 하나가 선택된다. 동일 해 상도의 제1 영상을 동일 코덱으로 제1 부호화하였을 때, 영상 데이터의 비트레이트가 서로 상이하다는 것 은, 복원되는 영상의 화질이 서로 상이하다는 것을 의미한다. 따라서, 제1 DNN과 제2 DNN은 소정 화질에 기반하 여 연계 훈련될 수 있으며, 이에 따라 AI 업스케일부는 제2 영상의 화질을 나타내는, 영상 데이터 의 비트레이트에 따라 DNN 설정 정보를 획득할 수 있다. 또 다른 실시예에서, AI 업스케일부는 제1 복호화부로부터 제공되는 정보(예측 모드 정보, 움직임 정보, 양자화 파라미터 정보 등)와 AI 데이터에 포함된 제1 영상 관련 정보를 모두 고려하여 복수의 DNN 설정 정보 중 제2 영상을 AI 업스케일하기 위한 DNN 설정 정보를 획득할 수도 있다. 예를 들어, AI 업스 케일부는 제1 복호화부로부터 제1 영상의 제1 부호화 과정에서 이용된 양자화 파라미터 정보 를 전달받고, AI 데이터로부터 제1 영상의 부호화 결과 획득된 영상 데이터의 비트레이트를 확인하고, 양 자화 파라미터 및 비트레이트에 대응하는 DNN 설정 정보를 획득할 수도 있다. 동일한 비트레이트라도 영상의 복 잡도에 따라 복원 영상의 화질 정도에 차이가 있을 수 있으며, 비트레이트는 제1 부호화되는 제1 영상 전 체를 대표하는 값으로서 제1 영상 내에서도 각 프레임의 화질이 서로 다를 수 있다. 따라서, 제1 복호화 부로부터 각 프레임 별로 획득할 수 있는 예측 모드 정보, 움직임 정보 및/또는 양자화 파라미터를 함께 고려하면, AI 데이터만 이용하는 것에 비해 제2 영상에 보다 적합한 DNN 설정 정보를 획득할 수 있다. 또한, 구현예에 따라, AI 데이터는 상호 약속된 DNN 설정 정보의 식별자를 포함할 수 있다. DNN 설정 정보의 식 별자는, 제1 DNN의 다운스케일 타겟에 대응하는 업스케일 타겟으로, 제2 영상을 AI 업스케일할 수 있도록, 제1 DNN과 제2 DNN 간 연계 훈련된 DNN 설정 정보의 쌍을 구분하기 위한 정보이다. AI 업스케일부 는 AI 데이터에 포함된 DNN 설정 정보의 식별자를 획득한 후, DNN 설정 정보의 식별자에 대응하는 DNN 설 정 정보를 사용하여 제2 영상을 AI 업스케일할 수 있다. 예를 들어, 제1 DNN에 설정 가능한 복수의 DNN 설정 정보 각각을 가리키는 식별자와 제2 DNN에 설정 가능한 복수의 DNN 설정 정보 각각을 가리키는 식별자가 미리 지정되어 있을 수 있다. 이 경우, 제1 DNN 및 제2 DNN 각각에 설정 가능한 DNN 설정 정보의 쌍에 대해 동 일한 식별자가 지정될 수 있다. AI 데이터는 영상의 AI 다운스케일을 위해 제1 DNN에 설정된 DNN 설정 정보의 식별자를 포함할 수 있다. AI 데이터를 수신한 AI 업스케일부는 복수의 DNN 설정 정보 중 AI 데이터 에 포함된 식별자가 가리키는 DNN 설정 정보를 이용하여 제2 영상을 AI 업스케일할 수 있다. 또한, 구현예에 따라, AI 데이터는 DNN 설정 정보를 포함할 수도 있다. AI 업스케일부는 AI 데이터에 포 함된 DNN 설정 정보를 획득한 후, 해당 DNN 설정 정보를 사용하여 제2 영상을 AI 업스케일할 수도 있다. 구현예에 따라, DNN 설정 정보를 구성하는 정보들(예를 들어, 컨볼루션 레이어의 수, 컨볼루션 레이어별 필터 커널의 개수, 각 필터 커널의 파라미터 등)들이 룩업 테이블 형태로 저장되어 있는 경우, AI 업스케일부 는 AI 데이터에 포함된 정보에 기초하여 룩업 테이블 값들 중에서 선택된 일부를 조합하여 DNN 설정 정보를 획 득하고, 획득된 DNN 설정 정보를 사용하여 제2 영상을 AI 업스케일할 수도 있다. 구현예에 따라, AI 업스케일부는 업스케일 타겟에 대응되는 DNN의 구조가 결정되면, 결정된 DNN의 구조에 대응하는 DNN 설정 정보, 예를 들어, 필터 커널의 파라미터들을 획득할 수도 있다. AI 업스케일부는 제1 DNN과 관련된 정보를 포함하는 AI 데이터를 통해 제2 DNN의 DNN 설정 정보를 획득하 고, 획득된 DNN 설정 정보로 세팅된 제2 DNN을 통해 제2 영상을 AI 업스케일하는 데, 이는, 제2 영상 의 특징을 직접 분석하여 업스케일하는 것과 비교하여 메모리 사용량과 연산량이 감소될 수 있다. 일 실시예에서, 제2 영상이 복수의 프레임으로 구성된 경우, AI 업스케일부는 소정 개수의 프레임 별로 DNN 설정 정보를 독립적으로 획득할 수 있고, 또는, 전체 프레임에 대해 공통된 DNN 설정 정보를 획득할 수도 있다. 도 20은 복수의 프레임으로 구성된 제2 영상을 도시하는 도면이다. 도 20에 도시된 바와 같이, 제2 영상은 t0 내지 tn에 대응하는 프레임들로 이루어질 수 있다. 일 예시에서, AI 업스케일부는 AI 데이터를 통해 제2 DNN의 DNN 설정 정보를 획득하고, 획득한 DNN 설정 정보에 기초하여 t0 내지 tn에 대응하는 프레임들을 AI 업스케일할 수 있다. 즉, t0 내지 tn에 대응하는 프레임 들이 공통된 DNN 설정 정보에 기초하여 AI 업스케일될 수 있다. 다른 예시에서, AI 업스케일부는 t0 내지 tn에 대응하는 프레임들 중 일부의 프레임들, 예를 들어, t0 내 지 ta에 대응하는 프레임들을 AI 데이터로부터 획득한 'A' DNN 설정 정보로 AI 업스케일하고, ta+1 내지 tb에 대응하는 프레임들을 AI 데이터로부터 획득한 'B' DNN 설정 정보로 AI 업스케일할 수 있다. 또한, AI 업스케일 부는 tb+1 내지 tn에 대응하는 프레임들을 AI 데이터로부터 획득한 'C' DNN 설정 정보로 AI 업스케일할 수 있다. 다시 말하면, AI 업스케일부는 복수의 프레임들 중 소정 개수의 프레임을 포함하는 그룹마다 DNN 설정 정보를 독립적으로 획득하고, 그룹 각각에 포함된 프레임들을 독립적으로 획득한 DNN 설정 정보로 AI 업스케일할 수 있다. 또 다른 예시에서, AI 업스케일부는 제2 영상을 구성하는 프레임별로 DNN 설정 정보를 독립적으로 획득할 수도 있다. 즉, 제2 영상이 3개의 프레임으로 구성되어 있는 경우, AI 업스케일부는 첫 번 째 프레임과 관련하여 획득한 DNN 설정 정보로 첫 번째 프레임을 AI 업스케일하고, 두 번째 프레임과 관련하여 획득한 DNN 설정 정보로 두 번째 프레임을 AI 업스케일하고, 세 번째 프레임과 관련하여 획득한 DNN 설정 정보 로 세 번째 프레임을 AI 업스케일할 수 있다. 전술한, 제1 복호화부로부터 제공되는 정보(예측 모드 정보, 움직임 정보, 양자화 파라미터 정보 등)와 AI 데이터에 포함된 제1 영상 관련 정보에 기초하여 DNN 설정 정보가 획득되는 방식에 따라, 제2 영상을 구성하는 프레임별로 DNN 설정 정보가 독립적으로 획득될 수 있다. 왜냐하면, 모드 정보, 양자화 파라미터 정보 등은 제2 영상을 구성하는 프레임마다 독립적으로 결정될 수 있기 때문이다. 또 다른 예시에서, AI 데이터는 AI 데이터에 기초하여 획득되는 DNN 설정 정보가 어느 프레임까지 유효한 것인 지를 나타내는 정보를 포함할 수 있다. 예를 들어, AI 데이터 내에 DNN 설정 정보가 ta 프레임까지 유효하다는 정보가 포함되어 있는 경우, AI 업스케일부는 AI 데이터에 기초하여 획득한 DNN 설정 정보로 t0 내지 ta 프레임들을 AI 업스케일한다. 그리고, 다른 AI 데이터 내에 DNN의 설정 정보가 tn 프레임까지 유효하다는 정보 가 포함되어 있는 경우, AI 업스케일부는 상기 다른 AI 데이터에 기초하여 획득한 DNN 설정 정보로 ta+1 내지 tn 프레임들을 AI 업스케일할 수 있다. 이하에서는, 도 21을 참조하여, 영상의 AI 부호화를 위한 AI 부호화 장치에 대해 설명한다. 도 21은 일 실시예에 따른 AI 부호화 장치의 구성을 도시하는 블록도이다. 도 21을 참조하면, AI 부호화 장치는 AI 부호화부 및 전송부를 포함할 수 있다. AI 부호화부 는 AI 다운스케일부 및 제1 부호화부를 포함할 수 있다. 전송부는 데이터 처리부 및 통신부를 포함할 수 있다. 도 7은 AI 부호화부 및 전송부를 개별적인 장치로 도시하고 있으나, AI 부호화부 및 전송부 는 하나의 프로세서를 통해 구현될 수 있다. 이 경우, 전용 프로세서로 구현될 수도 있고, AP 또는 CPU, GPU와 같은 범용 프로세서와 S/W의 조합을 통해 구현될 수도 있다. 또한, 전용 프로세서의 경우, 본 개시의 실 시예를 구현하기 위한 메모리를 포함하여 구현되거나, 외부 메모리를 이용하기 위한 메모리 처리부를 포함하여 구현될 수 있다. 또한, AI 부호화부 및 전송부는 복수의 프로세서로 구성될 수도 있다. 이 경우, 전용 프로세서들의 조합으로 구현될 수도 있고, AP 또는 CPU, GPU와 같은 다수의 범용 프로세서들과 S/W의 조합을 통해 구현될 수 도 있다. AI 다운스케일부와 제1 부호화부도 각각 서로 다른 프로세서로 구현될 수 있다. AI 부호화부는 영상의 AI 다운스케일 및 제1 영상의 제1 부호화를 수행하고, AI 데이터 및 영 상 데이터를 전송부로 전달한다. 전송부는 AI 데이터 및 영상 데이터를 AI 복호화 장치로 전송 한다. 영상 데이터는 제1 영상의 제1 부호화 결과 획득된 데이터를 포함한다. 영상 데이터는 제1 영상 내 픽셀 값들에 기초하여 획득되는 데이터, 예를 들어, 제1 영상과 제1 영상의 예측 데이터 사이의 차 이인 잔차 데이터를 포함할 수 있다. 또한, 영상 데이터는 제1 영상의 제1 부호화 과정에서 이용된 정보 들을 포함한다. 예를 들어, 영상 데이터는 제1 영상을 제1 부호화하는데 이용된 예측 모드 정보, 움직임 정보 및 제1 영상을 제1 부호화하는데 이용된 양자화 파라미터 관련 정보 등을 포함할 수 있다. AI 데이터는, AI 업스케일부가 제1 DNN의 다운스케일 타겟에 대응하는 업스케일 타겟으로 제2 영상(153 5)을 AI 업스케일할 수 있게 하는 정보들을 포함한다. 일 예에서, AI 데이터는 영상과 제1 영상 사 이의 차이 정보를 포함할 수 있다. 또한, AI 데이터는 제1 영상 관련 정보를 포함할 수도 있다. 제1 영상 관련 정보는, 제1 영상의 해상도, 제1 영상의 제1 부호화 결과 획득된 영상 데이터의 비트 레이트 및 제1 영상의 제1 부호화시 이용된 코덱 타입 중 적어도 하나에 대한 정보를 포함할 수 있다. 일 실시예에서, AI 데이터는, 제1 DNN의 다운스케일 타겟에 대응하는 업스케일 타겟으로 제2 영상이 AI 업스케일될 수 있도록, 상호 약속된 DNN 설정 정보의 식별자를 포함할 수 있다. 또한, 일 실시예에서, AI 데이터는 제2 DNN에 세팅 가능한 DNN 설정 정보를 포함할 수도 있다. AI 다운스케일부는 제1 DNN을 통해 영상으로부터 AI 다운스케일된 제1 영상을 획득할 수 있다. AI 다운스케일부는 미리 결정된 기준에 기초하여 영상의 다운스케일 타겟을 결정할 수 있다. 다운스케일 타겟에 부합하는 제1 영상의 획득을 위해, AI 다운스케일부는 제1 DNN에 세팅 가능한 복 수의 DNN 설정 정보를 저장할 수 있다. AI 다운스케일부는 복수의 DNN 설정 정보 중 다운스케일 타겟에 대 응하는 DNN 설정 정보를 획득하고, 획득된 DNN 설정 정보로 세팅된 제1 DNN을 통해 영상을 AI 다운스케일 한다. 상기 복수의 DNN 설정 정보 각각은 미리 결정된 해상도 및/또는 미리 결정된 화질의 제1 영상을 획득하기 위해 훈련된 것일 수 있다. 예를 들어, 복수의 DNN 설정 정보 중 어느 하나의 DNN 설정 정보는 영상의 해 상도보다 1/2배만큼 작은 해상도의 제1 영상, 예를 들어, 4K(4096*2160)의 영상보다 1/2배 작은 2K (2048*1080)의 제1 영상을 획득하기 위한 정보들을 포함할 수 있고, 다른 하나의 DNN 설정 정보는 영 상의 해상도보다 1/4배만큼 작은 해상도의 제1 영상, 예를 들어, 8K(8192*4320)의 영상보다 1/4배 작은 2K (2048*1080)의 제1 영상을 획득하기 위한 정보들을 포함할 수 있다. 구현예에 따라, DNN 설정 정보를 구성하는 정보들(예를 들어, 컨볼루션 레이어의 수, 컨볼루션 레이어별 필터 커널의 개수, 각 필터 커널의 파라미터 등)들이 룩업 테이블 형태로 저장되어 있는 경우, AI 다운스케일부(61 2)는 다운스케일 타겟에 따라 룩업 테이블 값들 중에서 선택된 일부를 조합하여 DNN 설정 정보를 획득하고, 획 득된 DNN 설정 정보를 사용하여 영상을 AI 다운스케일할 수도 있다. 구현예에 따라, AI 다운스케일부는 다운스케일 타겟에 대응되는 DNN의 구조를 결정하고, 결정된 DNN의 구 조에 대응하는 DNN 설정 정보, 예를 들어, 필터 커널의 파라미터들을 획득할 수도 있다.영상의 AI 다운스케일을 위한 복수의 DNN 설정 정보는, 제1 DNN과 제2 DNN이 연계 훈련됨으로써, 최적화 된 값을 가질 수 있다. 여기서, 각 DNN 설정 정보는 제1 DNN에 포함되는 컨볼루션 레이어의 수, 컨볼루션 레이 어별 필터 커널의 개수 및 각 필터 커널의 파라미터 중 적어도 하나를 포함한다. AI 다운스케일부는 영상의 AI 다운스케일을 위해 결정된 DNN 설정 정보로 제1 DNN을 세팅하여, 소정 해상도 및/또는 소정 화질의 제1 영상을 제1 DNN을 통해 획득할 수 있다. 복수의 DNN 설정 정보 중 영상 의 AI 다운스케일을 위한 DNN 설정 정보가 획득되면, 제1 DNN 내 각 레이어는 DNN 설정 정보에 포함된 정 보들에 기초하여 입력된 데이터를 처리할 수 있다. 이하에서는, AI 다운스케일부가 다운스케일 타겟을 결정하는 방법에 대해 설명한다. 상기 다운스케일 타겟 은 예를 들어, 영상으로부터 얼마나 해상도가 감소한 제1 영상을 획득해야 하는지를 나타낼 수 있 다. 일 실시예에서, AI 다운스케일부는 압축률(예를 들어, 영상과 제1 영상 사이의 해상도 차이, 타겟 비트레이트), 압축 품질(예를 들어, 비트레이트 타입), 압축 히스토리 정보 및 영상의 타입 중 적어 도 하나에 기초하여 다운스케일 타겟을 결정할 수 있다. 일 예에서, AI 다운스케일부는 미리 설정되거나, 사용자로부터 입력받은 압축률 또는 압축 품질 등에 기반 하여 다운스케일 타겟을 결정할 수 있다. 다른 예로, AI 다운스케일부는 AI 부호화 장치에 저장된 압축 히스토리 정보를 이용하여 다운스케일 타겟을 결정할 수도 있다. 예를 들어, AI 부호화 장치가 이용할 수 있는 압축 히스토리 정보에 따르면, 사 용자가 선호하는 부호화 품질 또는 압축률 등이 결정될 수 있으며, 압축 히스토리 정보에 기초하여 결정된 부호 화 품질 등에 따라 다운스케일 타겟이 결정될 수 있다. 예를 들면, 압축 히스토리 정보에 따라 가장 많이 이용 된 적이 있는 부호화 품질에 따라 제1 영상의 해상도, 화질 등이 결정될 수 있다. 또 다른 예로, AI 다운스케일부는 압축 히스토리 정보에 따라 소정의 임계 값보다 많이 이용된 적이 있는 부호화 품질(예를 들면, 소정의 임계값보다 많이 이용된 적이 있는 부호화 품질의 평균 품질)에 기초하여 다운 스케일 타겟을 결정할 수도 있다. 또 다른 예로, AI 다운스케일부는 영상의 해상도, 타입(예를 들어, 파일의 형식)등에 기초하여 다운 스케일 타겟을 결정할 수도 있다. 일 실시예에서, 영상이 복수의 프레임으로 구성된 경우, AI 다운스케일부는 소정 개수의 프레임 별 로 다운스케일 타겟을 독립적으로 결정할 수 있고, 또는, 전체 프레임에 대해 공통된 다운스케일 타겟을 결정할 수도 있다. 일 예시에서, AI 다운스케일부는 영상을 구성하는 프레임들을 소정 개수의 그룹으로 구분하고, 각 그룹별로 다운스케일 타겟을 독립적으로 결정할 수 있다. 각 그룹에 대해 서로 동일하거나 서로 상이한 다운스 케일 타겟이 결정될 수 있다. 그룹들에 포함된 프레임들의 개수는 그룹별로 동일하거나 상이할 수 있다. 다른 예시에서, AI 다운스케일부는 영상을 구성하는 프레임별로 다운스케일 타겟을 독립적으로 결정 할 수 있다. 각각의 프레임에 대해 서로 동일하거나 서로 상이한 다운스케일 타겟이 결정될 수 있다. 이하에서는, AI 다운스케일의 기반이 되는 제1 DNN의 예시적인 구조에 대해 설명한다. 도 22는 영상의 AI 다운스케일을 위한 제1 DNN을 나타내는 예시적인 도면이다. 도 22에 도시된 바와 같이, 영상은 제1 컨볼루션 레이어로 입력된다. 제1 컨볼루션 레이어는 5 x 5의 크기의 32개의 필터 커널을 이용하여 영상에 대해 컨볼루션 처리를 한다. 컨볼루션 처리 결과 생성 된 32개의 특징 맵은 제1 활성화 레이어로 입력된다. 제1 활성화 레이어는 32개의 특징 맵에 대해 비 선형(Non-linear) 특성을 부여할 수 있다. 제1 활성화 레이어는 제1 컨볼루션 레이어로부터 출력되는 특징 맵들의 샘플 값들을 제2 컨볼루션 레 이어로 전달할지 여부를 결정한다. 예를 들어, 특징 맵들의 샘플 값들 중 어떤 샘플 값들은 제1 활성화 레 이어에 의해 활성화되어 제2 컨볼루션 레이어로 전달되고, 어떤 샘플 값들은 제1 활성화 레이어(72 0)에 의해 비활성화되어 제2 컨볼루션 레이어로 전달되지 않는다. 제1 컨볼루션 레이어로부터 출력되 는 특징 맵들이 나타내는 정보가 제1 활성화 레이어에 의해 강조된다.제1 활성화 레이어의 출력이 제2 컨볼루션 레이어로 입력된다. 제2 컨볼루션 레이어는 5 x 5의 크기의 32개의 필터 커널을 이용하여 입력 데이터에 대해 컨볼루션 처리를 한다. 컨볼루션 처리 결과 출력 된 32개의 특징 맵은 제2 활성화 레이어로 입력되고, 제2 활성화 레이어는 32개의 특징 맵에 대해 비 선형 특성을 부여할 수 있다. 제2 활성화 레이어의 출력은 제3컨볼루션 레이어로 입력된다. 제3컨볼루션 레이어는 5 x 5 의 크기의 1개의 필터 커널을 이용하여 입력된 데이터에 대해 컨볼루션 처리를 한다. 컨볼루션 처리 결과 제3컨 볼루션 레이어로부터 1개의 영상이 출력될 수 있다. 제3컨볼루션 레이어는 최종 영상을 출력하기 위 한 레이어로서 1개의 필터 커널을 이용하여 1개의 출력을 획득한다. 본 개시의 예시에 따르면, 제3컨볼루션 레 이어는 컨벌루션 연산 결과를 통해 제1 영상을 출력할 수 있다. 제1 DNN의 제1 컨볼루션 레이어, 제2 컨볼루션 레이어 및 제3컨볼루션 레이어의 필터 커널 의 개수, 필터 커널의 파라미터 등을 나타내는 DNN 설정 정보는 복수 개일 수 있는데, 복수의 DNN 설정 정보는 제2 DNN의 복수의 DNN 설정 정보와 연계되어야 한다. 제1 DNN의 복수의 DNN 설정 정보와 제2 DNN의 복수의 DNN 설정 정보 사이의 연계는, 제1 DNN 및 제2 DNN의 연계 학습을 통해 구현될 수 있다. 도 22는 제1 DNN이 세 개의 컨볼루션 레이어(710, 730, 750)와 두 개의 활성화 레이어(720, 740)를 포함 하고 있는 것으로 도시하고 있으나, 이는 하나의 예시일 뿐이며, 구현예에 따라서, 컨볼루션 레이어 및 활성화 레이어의 개수는 다양하게 변경될 수 있다. 또한, 구현예에 따라서, 제1 DNN은 RNN(recurrent neural network)을 통해 구현될 수도 있다. 이 경우는 본 개시의 예시에 따른 제1 DNN의 CNN 구조를 RNN 구조로 변경하는 것을 의미한다. 일 실시예에서, AI 다운스케일부는 컨볼루션 연산 및 활성화 레이어의 연산을 위한 적어도 하나의 ALU를 포함할 수 있다. ALU는 프로세서로 구현될 수 있다. 컨볼루션 연산을 위해, ALU는 영상 또는 이전 레이어 에서 출력된 특징 맵의 샘플 값들과 필터 커널의 샘플 값들 사이의 곱 연산을 수행하는 곱셈기 및 곱셈의 결과 값들을 더하는 가산기를 포함할 수 있다. 또한, 활성화 레이어의 연산을 위해, ALU는 미리 결정된 시그모이드 함수, Tanh 함수 또는 ReLU 함수 등에서 이용되는 가중치를 입력된 샘플 값에 곱하는 곱셈기, 및 곱한 결과와 소정 값을 비교하여 입력된 샘플 값을 다음 레이어로 전달할지를 판단하는 비교기를 포함할 수 있다. 다시 도 22를 참조하면, AI 다운스케일부로부터 제1 영상을 전달받은 제1 부호화부는 제1 영상 을 제1 부호화하여 제1 영상이 가지는 정보량을 감축시킬 수 있다. 제1 부호화부에 의한 제1 부호화 결과 제1 영상에 대응하는 영상 데이터가 획득될 수 있다. 데이터 처리부는 AI 데이터 및 영상 데이터 중 적어도 하나가 소정의 형태로 전송될 수 있게 처리한다. 예 를 들어, AI 데이터 및 영상 데이터를 비트스트림 형태로 전송하여야 하는 경우, 데이터 처리부는 AI 데이 터가 비트스트림 형태로 표현되도록 AI 데이터를 처리하고, 통신부를 통해 하나의 비트스트림 형태의 AI 데이터 및 영상 데이터를 전송한다. 다른 예로, 데이터 처리부는 AI 데이터가 비트스트림 형태로 표현되도 록 AI 데이터를 처리하고, 통신부를 통해 AI 데이터에 해당하는 비트스트림 및 영상 데이터에 해당하는 비 트스트림 각각을 통신부를 통해 전송한다. 또 다른 예로, 데이터 처리부는 AI 데이터가 프레임 또는 패킷으로 표현되도록 AI 데이터를 처리하고, 비트스트림 형태의 영상 데이터와, 프레임 또는 패킷 형태의 AI 데 이터를 통신부를 통해 전송한다. 통신부는 네트워크를 통해 AI 부호화 결과 획득된 AI 부호화 데이터를 전송한다. AI 부호화 결과 획득된 AI 부호화 데이터는 영상 데이터와 AI 데이터를 포함한다. 영상 데이터와 AI 데이터는 동종 네트워크 또는 이종 네트워크를 통해 전송될 수 있다. 일 실시예에서, 데이터 처리부의 처리 결과 획득된 AI 부호화 데이터는 하드 디스크, 플로피 디스크 및 자 기 테이프와 같은 자기 매체, CD-ROM 및 DVD와 같은 광기록 매체, 플롭티컬 디스크(floptical disk)와 같은 자 기-광 매체(magneto-optical medium) 등을 포함하는 데이터 저장 매체에 저장될 수도 있다. 이하에서는, 도 23을 참조하여, 제1 DNN과 제2 DNN을 연계 훈련시키는 방법에 대해 설명한다. 도 23은 제1 DNN 및 제2 DNN을 훈련시키는 방법을 설명하기 위한 도면이다. 일 실시예에서 AI 부호화 과정을 통해 AI 부호화된 영상이 AI 복호화 과정을 통해 제3영상으로 복 원되는데, AI 복호화 결과 획득된 제3영상과 영상과의 유사성을 유지하기 위해서는 AI 부호화 과정 및 AI 복호화 과정에 연관성이 필요하다. 즉, AI 부호화 과정에서 손실된 정보를 AI 복호화 과정에서 복원할 수있어야 하는데, 이를 위해 제1 DNN과 제2 DNN의 연계 훈련이 요구된다. 정확한 AI 복호화를 위해서는 궁극적으로 도 9에 도시된 제3훈련 영상과 원본 훈련 영상 사이의 비교 결과에 대응하는 퀄리티 손실 정보를 감소시킬 필요가 있다. 따라서, 퀄리티 손실 정보는 제1 DNN 및 제2 DNN의 훈련 모두에 이용된다. 먼저, 도 23에 도시된 훈련 과정에 대해 설명한다. 도 23에서, 원본 훈련 영상(original training image)은 AI 다운스케일의 대상이 되는 영상이고, 제1 훈 련 영상(first training image)은 원본 훈련 영상로부터 AI 다운스케일된 영상이다. 또한, 제3훈련 영상(third training image)은 제1 훈련 영상으로부터 AI 업스케일된 영상이다. 원본 훈련 영상은 정지 영상 또는 복수의 프레임으로 이루어진 동영상을 포함한다. 일 실시예에서, 원본 훈련 영상은 정지 영상 또는 복수의 프레임으로 이루어진 동영상으로부터 추출된 휘도 영상을 포함할 수도 있다. 또한, 일 실시예에서, 원본 훈련 영상은 정지 영상 또는 복수의 프레임으로 이루어진 동영상에서 추 출된 패치 영상을 포함할 수도 있다. 원본 훈련 영상이 복수의 프레임으로 이루어진 경우, 제1 훈련 영상 , 제2 훈련 영상 및 제3훈련 영상 역시 복수의 프레임으로 구성된다. 원본 훈련 영상의 복수의 프레임이 순차적으로 제1 DNN에 입력되면, 제1 DNN 및 제2 DNN을 통해 제1 훈련 영상, 제 2 훈련 영상 및 제3훈련 영상의 복수의 프레임이 순차적으로 획득될 수 있다. 제1 DNN 및 제2 DNN의 연계 훈련을 위해, 원본 훈련 영상이 제1 DNN으로 입력된다. 제1 DNN으로 입력된 원본 훈련 영상은 AI 다운스케일되어 제1 훈련 영상으로 출력되고, 제1 훈련 영 상이 제2 DNN에 입력된다. 제1 훈련 영상에 대한 AI 업스케일 결과 제3훈련 영상이 출력된 다. 도 23을 참조하면, 제2 DNN으로 제1 훈련 영상이 입력되고 있는데, 구현예에 따라, 제1 훈련 영상 의 제1 부호화 및 제1 복호화 과정을 거쳐 획득된 제2 훈련 영상(second training image)이 제2 DNN(30 0)으로 입력될 수도 있다. 제2 훈련 영상을 제2 DNN으로 입력시키기 위해 MPEG-2, H.264, MPEG-4, HEVC, VC-1, VP8, VP9 및 AV1 중 어느 하나의 코덱이 이용될 수 있다. 구체적으로, 제1 훈련 영상의 제1 부호화 및 제1 훈련 영상에 대응하는 영상 데이터의 제1 복호화에, MPEG-2, H.264, MPEG-4, HEVC, VC-1, VP8, VP9 및 AV1 중 어느 하나의 코덱이 이용될 수 있다. 도 23을 참조하면, 제1 DNN을 통해 제1 훈련 영상이 출력되는 것과 별개로, 원본 훈련 영상으로 부터 레거시 다운스케일된 축소 훈련 영상이 획득된다. 여기서, 레거시 다운스케일은 바이리니어 (bilinear) 스케일, 바이큐빅(bicubic) 스케일, 란조스(lanczos) 스케일 및 스테어 스탭(stair step) 스케일 중 적어도 하나를 포함할 수 있다. 영상의 구조적 특징을 기준으로 제1 영상의 구조적 특징이 크게 벗어나는 것을 방지하기 위해, 원 본 훈련 영상의 구조적 특징을 보존하는 축소 훈련 영상을 획득하는 것이다. 훈련의 진행 전 제1 DNN 및 제2 DNN은 미리 결정된 DNN 설정 정보로 세팅될 수 있다. 훈련이 진행됨 에 따라 구조적 손실 정보, 복잡성 손실 정보 및 퀄리티 손실 정보가 결정될 수 있다. 구조적 손실 정보는 축소 훈련 영상과 제1 훈련 영상의 비교 결과에 기초하여 결정될 수 있다. 일 예에서, 구조적 손실 정보는 축소 훈련 영상의 구조적 정보와 제1 훈련 영상의 구조적 정보 사이의 차이에 해당할 수 있다. 구조적 정보는, 영상의 휘도, 대비, 히스토그램 등 영상으로부터 추출 가능한 다양한 특징을 포함할 수 있다. 구조적 손실 정보는 원본 훈련 영상의 구조적 정보가 제1 훈련 영상 에서 어느 정도로 유지되고 있는지를 나타낸다. 구조적 손실 정보가 작을수록 제1 훈련 영상의 구조적 정보가 원본 훈련 영상의 구조적 정보와 유사해진다. 복잡성 손실 정보는 제1 훈련 영상의 공간적 복잡도에 기반하여 결정될 수 있다. 일 예에서, 공간적 복잡도로서, 제1 훈련 영상의 총 분산(total variance)값이 이용될 수 있다. 복잡성 손실 정보는 제1 훈련 영상을 제1 부호화하여 획득한 영상 데이터의 비트레이트와 관련된다. 복잡성 손실 정보가 작을 수록 영상 데이터의 비트레이트가 작은 것으로 정의된다. 퀄리티 손실 정보는 원본 훈련 영상과 제3훈련 영상의 비교 결과에 기초하여 결정될 수 있다. 퀄리티 손실 정보는 원본 훈련 영상과 제3훈련 영상의 차이에 대한 L1-norm 값, L2-norm 값, SSIM(Structural Similarity) 값, PSNR-HVS(Peak Signal-To-Noise Ratio-Human Vision System) 값, MS-SSIM(Multiscale SSIM) 값, VIF(Variance Inflation Factor) 값 및 VMAF(Video Multimethod Assessment Fusion) 값 중 적어도 하나를 포함할 수 있다. 퀄리티 손실 정보는 제3훈련 영상이 원본 훈련 영상 과 어느 정도로 유사한지를 나타낸다. 퀄리티 손실 정보가 작을수록 제3훈련 영상이 원본 훈련 영상에 더 유사해진다. 도 23을 참조하면, 구조적 손실 정보, 복잡성 손실 정보 및 퀄리티 손실 정보가 제1 DNN의 훈련에 이용되고, 퀄리티 손실 정보는 제2 DNN의 훈련에 이용된다. 즉, 퀄리티 손실 정보는 제1 DNN 및 제2 DNN의 훈련에 모두 이용된다. 제1 DNN은 구조적 손실 정보, 복잡성 손실 정보 및 퀄리티 손실 정보에 기초하여 결정된 최종 손실 정보가 감소 또는 최소화되도록 파라미터를 갱신할 수 있다. 또한, 제2 DNN은 퀄리티 손실 정보 가 감소 또는 최소화되도록 파라미터를 갱신할 수 있다. 제1 DNN 및 제2 DNN의 훈련을 위한 최종 손실 정보는 아래의 수학식 3과 같이 결정될 수 있다. 수학식 3"}
{"patent_id": "10-2019-0157761", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "상기 수학식 3에서, LossDS는 제1 DNN의 훈련을 위해 감소 또는 최소화되어야 할 최종 손실 정보를 나타내 고, LossUS는 제2 DNN의 훈련을 위해 감소 또는 최소화되어야 할 최종 손실 정보를 나타낸다. 또한, a, b, c, d는 미리 결정된 소정의 가중치에 해당할 수 있다. 즉, 제1 DNN은 수학식 1의 LossDS가 감소되는 방향으로 파라미터들을 갱신하고, 제2 DNN은 LossUS가 감소되는 방향으로 파라미터들을 갱신하게 된다. 훈련 과정에서 도출된 LossDS에 따라 제1 DNN의 파라미터 들이 갱신되면, 갱신된 파라미터에 기초하여 획득되는 제1 훈련 영상이 이전 훈련 과정에서의 제1 훈련 영 상과 달라지게 되고, 그에 따라 제3훈련 영상 역시 이전 훈련 과정에서의 제3훈련 영상과 달라 지게 된다. 제3훈련 영상이 이전 훈련 과정에서의 제3훈련 영상과 달라지게 되면, 퀄리티 손실 정보 역시 새롭게 결정되며, 그에 따라 제2 DNN은 파라미터들을 갱신한다. 퀄리티 손실 정보가 새롭 게 결정되면, LossDS 역시 새롭게 결정되므로, 제1 DNN은 새롭게 결정된 LossDS에 따라 파라미터들을 갱신 한다. 즉, 제1 DNN의 파라미터 갱신은, 제2 DNN의 파라미터 갱신을 야기하고, 제2 DNN의 파라미 터 갱신은 제1 DNN의 파라미터 갱신을 야기하는 것이다. 다시 말하면, 제1 DNN 및 제2 DNN은 퀄 리티 손실 정보의 공유를 통해 연계 훈련되므로, 제1 DNN의 파라미터들과 제2 DNN의 파라미터들 이 서로 연관성을 가지고 최적화될 수 있는 것이다 . 수학식 3을 참조하면, LossUS가 퀄리티 손실 정보에 따라 결정되는 것을 알 수 있으나, 이는 하나의 예시 이며, LossUS는 구조적 손실 정보 및 복잡성 손실 정보 중 적어도 하나와, 퀄리티 손실 정보에 기초하여 결정될 수도 있다. 앞서, AI 복호화 장치의 AI 업스케일부 및 AI 부호화 장치의 AI 다운스케일부는 복수의 DNN 설정 정보를 저장하는 것으로 설명하였는데, AI 업스케일부 및 AI 다운스케일부에 저장되는 복 수의 DNN 설정 정보 각각을 훈련시키는 방법에 대해 설명한다. 수학식 3과 관련하여 설명한 바와 같이, 제1 DNN의 경우, 제1 훈련 영상의 구조적 정보와 원본 훈련 영상의 구조적 정보 사이의 유사 정도(구조적 손실 정보), 제1 훈련 영상의 제1 부호화 결과 획 득되는 영상 데이터의 비트레이트(복잡성 손실 정보) 및 제3훈련 영상과 원본 훈련 영상 사이의 차이(퀄리티 손실 정보)를 고려하여 파라미터를 갱신하게 된다. 자세히 설명하면, 원본 훈련 영상의 구조적 정보와 유사하면서, 제1 부호화를 하였을 때 획득되는 영상 데 이터의 비트레이트가 작은 제1 훈련 영상이 획득 가능하도록 하는 동시에, 제1 훈련 영상을 AI 업스 케일하는 제2 DNN이 원본 훈련 영상에 유사한 제3훈련 영상을 획득할 수 있도록, 제1 DNN 의 파라미터가 갱신될 수 있다. 수학식 3의 a, b, c의 가중치가 조절됨으로써, 제1 DNN의 파라미터들이 최적화되는 방향이 상이해지게 된 다. 예를 들어, b의 가중치를 높게 결정하는 경우, 제3훈련 영상의 퀄리티보다 비트레이트가 낮아지는 것 에 더 중요도를 두고 제1 DNN의 파라미터가 갱신될 수 있다. 또한, c의 가중치를 높게 결정하는 경우, 비 트레이트가 높아지는 것이나, 원본 훈련 영상의 구조적 정보가 유지되는 것보다 제3훈련 영상의 퀄리 티가 증가하도록 하는 것에 더 중요도를 두고 제1 DNN의 파라미터가 갱신될 수 있다. 또한, 제1 훈련 영상을 제1 부호화하는데 이용되는 코덱의 타입에 따라 제1 DNN의 파라미터들이 최적 화되는 방향이 상이해질 수 있다. 왜냐하면, 코덱의 종류에 따라, 제2 DNN으로 입력될 제2 훈련 영상이 달 라질 수 있기 때문이다. 즉, 가중치 a, 가중치 b, 가중치 c 및 제1 훈련 영상의 제1 부호화를 위한 코덱의 종류에 기반하여 제1 DNN의 파라미터들과 제2 DNN의 파라미터들이 연계하여 갱신될 수 있는 것이다. 따라서, 가중치 a, 가 중치 b, 가중치 c 각각을 소정의 값으로 결정하고, 코덱의 종류를 소정의 종류로 결정한 후, 제1 DNN과 제 2 DNN을 훈련시키면, 서로 연계되어 최적화된 제1 DNN의 파라미터들과 제2 DNN의 파라미터들이 결정될 수 있다. 그리고, 가중치 a, 가중치 b, 가중치 c 및 코덱의 종류를 변경한 후, 제1 DNN과 제2 DNN을 훈련시키 면, 서로 연계되어 최적화된 제1 DNN의 파라미터들과 제2 DNN의 파라미터들이 결정될 수 있다. 다시 말하면, 가중치 a, 가중치 b, 가중치 c 및 코덱의 종류 각각의 값을 변경하면서 제1 DNN과 제2 DNN을 훈련시키면 서로 연계되어 훈련된 복수의 DNN 설정 정보가 제1 DNN 및 제2 DNN에서 결정될 수 있는 것이다. 앞서, 도 19와 관련하여 설명한 바와 같이, 제1 DNN 및 제2 DNN의 복수의 DNN 설정 정보들은 제1 영 상 관련 정보들에 매핑되어 있을 수 있다. 이러한 매핑 관계의 설정을 위해, 제1 DNN에서 출력되는 제1 훈 련 영상을 특정 비트레이트에 따라 특정 코덱으로 제1 부호화하고, 제1 부호화 결과 획득된 비트스트림을 제1 복호화하여 획득한 제2 훈련 영상을 제2 DNN으로 입력할 수 있다. 즉, 특정 해상도의 제1 훈련 영상 이 특정 코덱에 의해 특정 비트레이트로 제1 부호화되도록 환경을 설정한 후, 제1 DNN 및 제2 DNN을 훈련시킴으로써, 제1 훈련 영상의 해상도, 제1 훈련 영상의 제1 부호화에 이용된 코덱의 종류 및 제1 훈련 영상의 제1 부호화 결과 획득된 비트스트림의 비트레이트에 매핑된 DNN 설정 정보 쌍이 결정될 수 있는 것이다. 제1 훈련 영상의 해상도, 제1 훈련 영상의 제1 부호화에 이용된 코덱의 종류 및 제1 훈련 영상의 제1 부호화에 따라 획득되는 비트스트림의 비트레이트를 다양하게 변경시킴으로써, 제 1 DNN 및 제2 DNN의 복수의 DNN 설정 정보들과 제1 영상 관련 정보들 사이의 매핑 관계가 결정될 수 있다. 도 24는 훈련 장치에 의한 제1 DNN 및 제2 DNN의 훈련 과정을 설명하기 위한 도면이다. 도 23과 관련하여 설명한 제1 DNN 및 제2 DNN의 훈련은 훈련 장치에 의해 수행될 수 있다. 훈 련 장치는 제1 DNN 및 제2 DNN을 포함한다. 훈련 장치는 예를 들어, AI 부호화 장치 또는 별도의 서버일 수 있다. 훈련 결과 획득된 제2 DNN의 DNN 설정 정보들은 AI 복호화 장치(160 0)에 저장된다. 도 24를 참조하면, 훈련 장치는 제1 DNN 및 제2 DNN의 DNN 설정 정보를 초기 세팅한다(S840, S845). 이에 의해, 제1 DNN 및 제2 DNN은 미리 결정된 DNN 설정 정보에 따라 동작할 수 있다. DNN 설정 정보는 제1 DNN 및 2 DNN에 포함되는 컨볼루션 레이어의 수, 컨볼루션 레이어별 필터 커널의 개 수, 컨볼루션 레이어별 필터 커널의 크기 및 각 필터 커널의 파라미터 중 적어도 하나에 대한 정보를 포함할 수 있다. 훈련 장치는 원본 훈련 영상을 제1 DNN으로 입력한다(S850). 원본 훈련 영상은 정지 영상 또는 동영상을 구성하는 적어도 하나의 프레임을 포함할 수 있다. 제1 DNN은 초기 세팅된 DNN 설정 정보에 따라 원본 훈련 영상을 처리하고, 원본 훈련 영상으로 부터 AI 다운스케일된 제1 훈련 영상을 출력한다(S855). 도 10은 제1 DNN으로부터 출력된 제1 훈련 영상이 제2 DNN으로 바로 입력되는 것으로 도시되어 있으나, 제1 DNN으로부터 출력된 제1 훈련 영상이 훈련 장치에 의해 제2 DNN으로 입력될 수 있다. 또한, 훈련 장치는 제1 훈련 영 상을 소정의 코덱으로 제1 부호화 및 제1 복호화한 후, 제2 훈련 영상을 제2 DNN으로 입력할 수 있다. 제2 DNN은 제1 훈련 영상 또는 제2 훈련 영상을 초기 세팅된 DNN 설정 정보에 따라 처리하고, 제1 훈 련 영상 또는 제2 훈련 영상으로부터 AI 업스케일된 제3훈련 영상을 출력한다(S860). 훈련 장치는 제1 훈련 영상에 기초하여 복잡성 손실 정보를 산출한다(S865). 훈련 장치는 축소 훈련 영상과 제1 훈련 영상을 비교하여 구조적 손실 정보를 산출한다 (S870). 훈련 장치는 원본 훈련 영상과 제3훈련 영상을 비교하여 퀄리티 손실 정보를 산출한다 (S875). 제1 DNN은 최종 손실 정보에 기초한 역전사(back propagation) 과정을 통해 초기 세팅된 DNN 설정 정보를 갱신한다(S880). 훈련 장치는 복잡성 손실 정보, 구조적 손실 정보 및 퀄리티 손실 정보 에 기초하여 제1 DNN의 훈련을 위한 최종 손실 정보를 산출할 수 있다. 제2 DNN은 퀄리티 손실 정보 또는 최종 손실 정보에 기초한 역전사 과정을 통해 초기 세팅된 DNN 설정 정 보를 갱신한다(S885). 훈련 장치는 퀄리티 손실 정보에 기초하여 제2 DNN의 훈련을 위한 최종 손실 정보를 산출할 수 있다. 이후, 훈련 장치, 제1 DNN 및 제2 DNN은 최종 손실 정보들이 최소화될 때까지 S850 내지 S885 과정을 반복하면서 DNN 설정 정보를 갱신한다. 이 때, 각 반복 과정 동안 제1 DNN 및 제2 DNN은 이전 과정 에서 갱신된 DNN 설정 정보에 따라 동작한다. 아래의 표 1은 본 개시의 일 실시예에 따라 영상을 AI 부호화 및 AI 복호화한 경우와, HEVC로 영상(150 5)을 부호화 및 복호화한 경우의 효과를 나타낸다. 표 1"}
{"patent_id": "10-2019-0157761", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 5, "content": "표 1에서 알 수 있듯이, 본 개시의 일 실시예에 따라 8K 해상도의 300개의 프레임들로 이루어진 컨텐츠들을 AI 부호화 및 AI 복호화한 경우의 주관적 화질이 HEVC로 부호화 및 복호화한 경우의 주관적 화질보다 높음에도, 비 트레이트가 50% 이상 감소한 것을 알 수 있다. 도 25는 영상의 AI 다운스케일을 위한 장치(10') 및 제2 영상의 AI 업스케일을 위한 장치(20')를 도시하는 예시적인 도면이다. 장치(10')는 영상을 수신하고, AI 다운스케일부 및 변환 기반 부호화부를 이용하여 영상 데 이터 및 AI 데이터를 장치(20')로 제공한다. 일 실시예에서, 영상 데이터는 도 15의 영상 데이터에 대응하고, AI 데이터는 도 15의 AI 데이터에 대응한다. 또한, 일 실시예에서, 변환 기반 부호화부는 도 21의 제1 부호화부에 대응하고, AI 다운스케일부는 도 21의 AI 다운스케일부에 대응한다. 장치(20')는 AI 데이터 및 영상 데이터를 수신하고, 변환 기반 복호화부 및 AI 업스케일부(254 4)를 이용하여 제3영상을 획득한다. 일 실시예에서, 변환 기반 복호화부는 도 16의 제1 복호화부 에 대응하고, AI 업스케일부는 도 16의 AI 업스케일부에 대응한다. 일 실시예에서, 장치(10')는 CPU, 메모리 및 인스트럭션들을 포함하는 컴퓨터 프로그램을 포함한다. 컴퓨터 프 로그램은 메모리에 저장된다. 일 실시예에서, CPU에 의한 컴퓨터 프로그램의 실행에 따라, 장치(10')는 도 25와 관련하여 설명할 기능을 수행한다. 일 실시예에서, 전용 하드웨어 칩 및/또는 CPU에 의해 도 25와 관련하여 설 명할 기능이 수행된다. 일 실시예에서, 장치(20')는 CPU, 메모리 및 인스트럭션들을 포함하는 컴퓨터 프로그램을 포함한다. 컴퓨터 프 로그램은 메모리에 저장된다. 일 실시예에서, CPU에 의한 컴퓨터 프로그램의 실행에 따라, 장치(20')는 도 25와 관련하여 설명할 기능을 수행한다. 일 실시예에서, 전용 하드웨어 칩 및/또는 CPU에 의해 도 25와 관련하여 설 명할 기능이 수행된다. 도 25에서, 구성 제어부는 하나 이상의 입력 값을 수신한다. 일 실시예에서, 하나 이상의 입력 값 은 AI 다운스케일부 및 AI 업스케일부를 위한 타겟 해상도 차이, 영상 데이터의 비트레이 트, 영상 데이터의 비트레이트 타입(예를 들어, variable bitrate 타입, constant bitrate 타입 또는 average bitrate 타입 등) 및 변환 기반 부호화부를 위한 코덱 타입 중 적어도 하나를 포함할 수 있다. 하나 이상의 입력 값은 장치(10')에 미리 저장되거나, 사용자로부터 입력받은 값을 포함할 수 있다. 구성 제어부는 수신된 입력 값에 기초하여 AI 다운스케일부 및 변환 기반 부호화부의 동 작을 제어한다. 일 실시예에서, 구성 제어부는 수신된 입력 값에 따라 AI 다운스케일부를 위한 DNN 설정 정보를 획득하고, 획득한 DNN 설정 정보로 AI 다운스케일부를 세팅한다. 일 실시예에서, 구성 제어부는 수신된 입력 값을 AI 다운스케일부로 전달하고, AI 다운스케일부는 수신된 입 력 값에 기초하여 영상을 AI 다운스케일하기 위한 DNN 설정 정보를 획득할 수 있다. 일 실시예에서, 구성 제어부는 입력 값과 함께 추가 정보, 예를 들어, AI 다운스케일이 적용되는 컬러 포맷(휘도 성 분, 색차 성분, 레드 성분, 그린 성분 또는 블루 성분 등) 정보, HDR(high dynamic range)의 톤 매핑(tone mapping) 정보 등을 AI 다운스케일부로 제공하고, AI 다운스케일부는 입력 값 및 추가 정보를 고려하여 DNN 설정 정보를 획득할 수도 있다. 일 실시예에서, 구성 제어부는 수신된 입력 값의 적어 도 일부를 변환 기반 부호화부로 전달하여 변환 기반 부호화부가 특정 값의 비트레이트, 특정 타입 의 비트레이트 및 특정 코덱으로 제1 영상을 제1 부호화하게 한다. AI 다운스케일부는 영상을 수신하고, 제1 영상을 획득하기 위해 도 15, 도 21, 도 22, 도 23 및 도 24 중 적어도 하나와 관련하여 설명한 동작을 수행한다. 일 실시예에서, AI 데이터는 장치(20')로 제공된다. AI 데이터는 영상과 제1 영상 사이의 해상도 차이 정보 및 제1 영상 관련 정보 중 적어도 하나를 포함할 수 있다. 해상도 차이 정보는 입력 값 의 타겟 해상도 차이에 기반하여 결정될 수 있고, 제1 영상 관련 정보는 타겟 비트레이트, 비트레이 트 타입 및 코덱 타입 중 적어도 하나에 기반하여 결정될 수 있다. 일 실시예에서, AI 데이터는 AI 업스케 일 과정에 이용되는 파라미터들을 포함할 수도 있다. AI 데이터는 AI 다운스케일부로부터 장치(20')로 제 공될 수도 있다. 제1 영상은 변환 기반 부호화부에 의해 처리되어 영상 데이터가 획득되고, 영상 데이터는 장치(20')로 전달된다. 변환 기반 부호화부는 MPEG-2, H.264 AVC, MPEG-4, HEVC, VC-1, VP8, VP9 또는 AV1에 따라 제1 영상을 처리할 수 있다. 구성 제어부 는 AI 데이터에 기초하여 AI 업스케일부의 동작을 제어한다. 일 실시예에서, 구성 제어부는 수신된 AI 데이터에 따라 AI 업스케일부를 위한 DNN 설정 정보를 획득하고, 획득한 DNN 설정 정보로 AI 업스케일부를 세팅한다. 일 실시예에서, 구성 제어부는 수신된 AI 데이터 을 AI 업스케일부로 전달하고, AI 업스케일부는 AI 데이터에 기초하여 제2 영상을 AI 업 스케일하기 위한 DNN 설정 정보를 획득할 수 있다. 일 실시예에서, 구성 제어부는 AI 데이터와 함께 추가 정보, 예를 들어, AI 업스케일이 적용되는 컬러 포맷(휘도 성분, 색차 성분, 레드 성분, 그린 성분 또는 블루 성분 등) 정보, HDR(high dynamic range)의 톤 매핑 정보 등을 AI 업스케일부로 제공하고, AI 업스 케일부는 AI 데이터 및 추가 정보를 고려하여 DNN 설정 정보를 획득할 수도 있다. 일 실시예에서, AI 업스케일부는 구성 제어부로부터 AI 데이터를 수신하고, 변환 기반 복호화부로부터 예측 모드 정보, 움직임 정보 및 양자화 파라미터 정보 중 적어도 하나를 수신하고, 예측 모드 정보, 움직임 정보 및 양자화 파라미터 정보 중 적어도 하나와 AI 데이터에 기초하여 DNN 설정 정보를 획득할 수도 있다. 변환 기반 복호화부는 영상 데이터를 처리하여 제2 영상을 복원한다. 변환 기반 복호화부 는 MPEG-2, H.264 AVC, MPEG-4, HEVC, VC-1, VP8, VP9 또는 AV1에 따라 영상 데이터를 처리할 수 있 다. AI 업스케일부는 세팅된 DNN 설정 정보를 기초로 변환 기반 복호화부로부터 제공되는 제2 영상 을 AI 업스케일하여 제3영상을 획득한다. AI 다운스케일부는 제1 DNN을 포함하고, AI 업스케일부는 제2 DNN을 포함할 수 있는데, 일 실시예 에서, 제1 DNN 및 제2 DNN을 위한 DNN 설정 정보들은 도 23 및 도 24와 관련하여 설명한 훈련 방법에 따라 훈련 된다. 본 개시의 다양한 실시 예들은 서버 뿐 아니라, 셋탑 박스와 같은 영상 처리 장치 등 영상 처리가 가능한 모든 전자 장치에 적용될 수 있음은 물론이다. 또한, 상술한 본 개시의 다양한 실시 예들은 전자 장치에 구비된 임베 디드 서버, 또는 영상 처리 장치의 외부 서버를 통해 수행되는 것도 가능하다. 한편, 상술한 본 개시의 다양한 실시 예들에 따른 방법들은, 기존 전자 장치에 설치 가능한 어플리케이션 또는 소프트웨어 형태로 구현될 수 있다. 또한, 상술한 본 개시의 다양한 실시 예들에 따른 방법들은, 기존 전자 장치에 대한 소프트웨어 업그레이드, 또 는 하드웨어 업그레이드 만으로도 구현될 수 있다. 한편, 본 개시의 일시 예에 따르면, 이상에서 설명된 다양한 실시 예들은 기기(machine)(예: 컴퓨터)로 읽을 수 있는 저장 매체(machine-readable storage media)에 저장된 명령어를 포함하는 소프트웨어로 구현될 수 있다. 기기는, 저장 매체로부터 저장된 명령어를 호출하고, 호출된 명령어에 따라 동작이 가능한 장치로서, 개시된 실 시 예들에 따른 영상 처리 장치(예: 영상 처리 장치(A))를 포함할 수 있다. 명령이 프로세서에 의해 실행될 경 우, 프로세서가 직접, 또는 프로세서의 제어 하에 다른 구성요소들을 이용하여 명령에 해당하는 기능을 수행할 수 있다. 명령은 컴파일러 또는 인터프리터에 의해 생성 또는 실행되는 코드를 포함할 수 있다. 기기로 읽을 수 있는 저장 매체는, 비일시적(non-transitory) 저장매체의 형태로 제공될 수 있다. 여기서, '비일시적'은 저장매 체가 신호(signal)를 포함하지 않으며 실재(tangible)한다는 것을 의미할 뿐 데이터가 저장매체에 반영구적 또 는 임시적으로 저장됨을 구분하지 않는다. 또한, 본 개시의 일 실시예에 따르면, 이상에서 설명된 다양한 실시 예들에 따른 방법은 컴퓨터 프로그램 제품 (computer program product)에 포함되어 제공될 수 있다. 컴퓨터 프로그램 제품은 상품으로서 판매자 및 구매자 간에 거래될 수 있다. 컴퓨터 프로그램 제품은 기기로 읽을 수 있는 저장 매체(예: compact disc read only memory (CD-ROM))의 형태로, 또는 어플리케이션 스토어(예: 플레이 스토어TM)를 통해 온라인으로 배포될 수 있 다. 온라인 배포의 경우에, 컴퓨터 프로그램 제품의 적어도 일부는 제조사의 서버, 어플리케이션 스토어의 서버, 또는 중계 서버의 메모리와 같은 저장 매체에 적어도 일시 저장되거나, 임시적으로 생성될 수 있다. 또한, 상술한 다양한 실시 예들에 따른 구성 요소(예: 모듈 또는 프로그램) 각각은 단수 또는 복수의 개체로 구 성될 수 있으며, 전술한 해당 서브 구성 요소들 중 일부 서브 구성 요소가 생략되거나, 또는 다른 서브 구성 요 소가 다양한 실시 예에 더 포함될 수 있다. 대체적으로 또는 추가적으로, 일부 구성 요소들(예: 모듈 또는 프로 그램)은 하나의 개체로 통합되어, 통합되기 이전의 각각의 해당 구성 요소에 의해 수행되는 기능을 동일 또는 유사하게 수행할 수 있다. 다양한 실시 예들에 따른, 모듈, 프로그램 또는 다른 구성 요소에 의해 수행되는 동 작들은 순차적, 병렬적, 반복적 또는 휴리스틱하게 실행되거나, 적어도 일부 동작이 다른 순서로 실행되거나, 생략되거나, 또는 다른 동작이 추가될 수 있다. 이상에서는 본 개시의 바람직한 실시 예에 대하여 도시하고 설명하였지만, 본 개시는 상술한 특정의 실시 예에"}
{"patent_id": "10-2019-0157761", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 6, "content": "한정되지 아니하며, 청구범위에서 청구하는 본 개시의 요지를 벗어남이 없이 당해 개시에 속하는 기술분야에서 통상의 지식을 가진 자에 의해 다양한 변형실시가 가능한 것은 물론이고, 이러한 변형실시들은 본 개시의 기술 적 사상이나 전망으로부터 개별적으로 이해되어서는 안될 것이다."}
{"patent_id": "10-2019-0157761", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1a 내지 도 1c는 일 실시예에 따른 인공 지능 신경망 기반 영상 처리 방법을 설명하기 위한 도면들이다. 도 2a 및 도 2b는 일 실시예에 따른 전자 장치의 구성을 나타내는 블럭도들이다. 도 3은 일 실시예에 따른 프로세서의 동작을 설명하기 위한 도면이다. 도 4는 일 실시예에 따른 제1 인공 지능 모델 및 제2 인공 지능 모델 간 관계를 설명하기 위한 도면이다. 도 5는 일 실시예에 따른 제2 인공 지능 모델의 학습 방법을 설명하기 위한 도면이다. 도 6은 일 실시예에 따른 제2 인공 지능 모델의 학습 방법을 설명하기 위한 도면이다. 도 7은 일 실시예에 따른 제2 인공 지능 모델의 학습 방법을 설명하기 위한 도면이다. 도 8a 및 도 8b는 본 개시의 다양한 실시 예에 따라 현재 또는 이전 프레임의 품질 정보를 이용하는 경우를 설 명하기 위한 도면들이다. 도 9는 일 실시예에 따른 전자 장치의 구성을 나타내는 블럭도이다. 도 10a 내지 도 10c는 일 실시예에 따른 인공 지능 모델을 이용한 업스케일링 방법을 자세히 설명하기 위한 도 면이다. 도 11a 및 도 11b는 일 실시예에 따른 전자 장치 및 수신 장치의 일 구현 예를 설명하기 위한 도면들이다. 도 12는 일 실시예에 따른 송수신 시스템의 동작을 설명하기 위한 도면이다. 도 13은 일 실시예에 따른 품질 정보를 설명하기 위한 도면이다. 도 14는 일 실시예에 따른 전자 장치의 제어 방법을 설명하기 위한 흐름도이다. 도 15는 일 실시예에 따른 AI 부호화 과정 및 AI 복호화 과정을 설명하기 위한 도면이다. 도 16은 일 실시예에 따른 AI 복호화 장치의 구성을 나타내는 블록도이다. 도 17은 제2 영상의 AI 업스케일을 위한 제2 DNN을 나타내는 예시적인 도면이다. 도 18은 컨볼루션 레이어에 의한 컨볼루션 연산을 설명하기 위한 도면이다. 도 19는 여러 영상 관련 정보들과 여러 DNN 설정 정보들 사이의 매핑 관계를 나타내는 예시적인 도면이다. 도 20은 복수의 프레임으로 구성된 제2 영상을 도시하는 도면이다. 도 21은 일 실시예에 따른 AI 부호화 장치의 구성을 나타내는 블록도이다. 도 22는 영상의 AI 다운스케일을 위한 제1 DNN을 나타내는 예시적인 도면이다. 도 23은 제1 DNN 및 제2 DNN을 훈련시키는 방법을 설명하기 위한 도면이다. 도 24는 훈련 장치에 의한 제1 DNN 및 제2 DNN의 훈련 과정을 설명하기 위한 도면이다. 도 25는 영상의 AI 다운스케일을 위한 장치 및 제2 영상의 AI 업스케일을 위한 장치를 도시하는 예시적인 도면 이다."}
