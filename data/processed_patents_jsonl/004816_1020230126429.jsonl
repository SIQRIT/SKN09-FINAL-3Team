{"patent_id": "10-2023-0126429", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2025-0043089", "출원번호": "10-2023-0126429", "발명의 명칭": "유증상 장기 분류 정보를 활용한 반려동물의 질병 진단과 시각화 방법 및 장치", "출원인": "에스케이텔레콤 주식회사", "발명자": "정홍규"}}
{"patent_id": "10-2023-0126429", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "반려동물의 질병 진단을 위한 딥러닝 모델을 훈련하는 컴퓨터 구현 방법으로서, 수의영상에 유증상 장기 정보가 태깅된 제1 훈련데이터를 이용하여 유증상 장기 분류모델을 훈련하는 과정;훈련된 유증상 장기 분류모델을 통해 상기 수의영상으로부터 예측된 유증상 장기의 위치 정보 및 상기 위치 정보에 대응하는 유증상 장기의 명칭을 획득하는 과정; 및상기 수의영상에 세부 질병 정보가 태깅된 제2 훈련데이터와 상기 위치 정보 및 상기 명칭을 이용하여 세부 질병 분류모델을 훈련하는 과정을 포함하는, 방법."}
{"patent_id": "10-2023-0126429", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1 항에 있어서,상기 제1 훈련데이터는, 상기 제2 훈련데이터를 이용하여 생성되는, 방법."}
{"patent_id": "10-2023-0126429", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1 항에 있어서,상기 유증상 장기 분류모델을 훈련하는 과정은,상기 수의영상으로부터 예측된 유증상 장기 정보와 태깅된 유증상 장기 정보에 기초한 다중 레이블 이진 교차엔트로피(MBCE, Multi-label Binary Cross Entropy)를 최소화하도록 훈련하는, 방법."}
{"patent_id": "10-2023-0126429", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제1 항에 있어서,상기 획득하는 과정은,상기 유증상 장기 분류모델을 이용하여 상기 수의영상에 대응하는 유증상 장기를 예측하는 과정;예측된 유증상 장기 별로 CAM(Class Activation Map)을 계산하는 과정;상기 CAM을 이용하여 대응하는 유증상 장기의 바운딩 박스를 생성하는 과정; 및상기 바운딩 박스 및 상기 바운딩 박스에 대응하는 유증상 장기의 명칭을 획득하는 과정을 포함하는, 방법."}
{"patent_id": "10-2023-0126429", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제4 항에 있어서,상기 수의영상에 대응하는 유증상 장기를 예측하는 과정은,상기 유증상 장기 분류모델을 이용하여 유증상 장기 별 확률 값을 획득하는 과정; 및상기 유증상 장기 별 확률 값이 임계값 이상인 경우, 상기 수의영상에 대응하는 유증상 장기로 예측하는 과정을포함하는, 방법."}
{"patent_id": "10-2023-0126429", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제1 항에 있어서,상기 세부 질병 분류모델을 훈련하는 과정은,상기 위치 정보를 기반으로 상기 수의영상으로부터 추출된 특징맵으로부터 영역 별 특징을 추출하는 과정;공개특허 10-2025-0043089-3-추출된 영역 별 특징에 기초하여 영역 별 세부 질병 별 확률 값을 획득하는 과정;상기 명칭과 상기 제2 훈련데이터에 태깅된 세부 질병 정보를 이용하여 위치 별 학습 레이블을 결정하는 과정;및상기 영역 별 세부 질병 별 확률 값 및 상기 위치 별 학습 레이블에 기초한 영역 별 다중 레이블 이진 교차 엔트로피(MBCE)의 합을 최소화하도록 훈련하는 과정을 포함하는, 방법."}
{"patent_id": "10-2023-0126429", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "반려동물의 질병을 진단하는 컴퓨터 구현 방법으로서,대상 수의영상을 수신하고, 훈련된 유증상 장기 분류모델을 이용하여 상기 대상 수의영상에 대응하는 유증상 장기를 예측하는 과정;예측된 유증상 장기의 위치 정보 및 상기 위치 정보에 대응하는 유증상 장기의 명칭을 획득하는 과정; 및 상기 대상 수의영상, 상기 위치 정보 및 상기 명칭을 훈련된 세부 질병 분류모델에 입력하여 상기 대상 수의영상에 대응하는 세부 질병 정보를 예측하는 과정을 포함하는 방법."}
{"patent_id": "10-2023-0126429", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제7 항에 있어서,상기 획득하는 과정은,상기 예측된 유증상 장기 별로 CAM(Class Activation Map)을 계산하는 과정;상기 CAM을 이용하여 대응하는 유증상 장기의 바운딩 박스를 생성하는 과정; 및상기 바운딩 박스 및 상기 바운딩 박스에 대응하는 유증상 장기의 명칭을 획득하는 과정을 포함하는, 방법."}
{"patent_id": "10-2023-0126429", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제7 항에 있어서,상기 세부 질병 정보를 예측하는 과정은,상기 대상 수의영상 및 상기 위치 정보를 상기 세부 질병 분류모델에 입력하여 세부 질병 분류 결과를 획득하는과정;상기 세부 질병 분류 결과와 상기 명칭 간의 연관성이 있는지 판단하는 과정; 및상기 연관성이 있다고 판단된 경우, 상기 세부 질병 분류 결과를 상기 대상 수의영상에 대응하는 세부 질병 정보로 예측하는 과정을 포함하는, 방법."}
{"patent_id": "10-2023-0126429", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제7 항에 있어서,상기 예측된 세부 질병 정보와 상기 위치 정보를 상기 대상 수의영상에 오버레이(overlay)하여 시각화하는 과정을 더 포함하는, 방법."}
{"patent_id": "10-2023-0126429", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "하나 이상의 프로세서 및 하나 이상의 프로세서와 동작 가능하게 결합된 메모리를 포함하는 장치로서,상기 메모리는 하나 이상의 프로세서에 의한 명령의 실행에 응답하여 하나 이상의 프로세서로 하여금 동작들을수행하게 하는 명령을 저장하고,상기 동작들은,수의영상에 유증상 장기 정보가 태깅된 제1 훈련데이터를 이용하여 유증상 장기 분류모델을 훈련하는 과정;훈련된 유증상 장기 분류모델을 통해 상기 수의영상으로부터 예측된 유증상 장기의 위치 정보 및 상기 위치 정공개특허 10-2025-0043089-4-보에 대응하는 유증상 장기의 명칭을 획득하는 과정; 및상기 수의영상에 세부 질병 정보가 태깅된 제2 훈련데이터와 상기 위치 정보 및 상기 명칭을 이용하여 세부 질병 분류모델을 훈련하는 과정을 포함하는, 장치."}
{"patent_id": "10-2023-0126429", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "유증상 장기 분류 정보를 활용한 반려동물의 질병 진단과 시각화 방법 및 장치를 개시한다. 본 개시의 일 측면에 의하면, 반려동물의 질병 진단을 위한 딥러닝 모델을 훈련하는 컴퓨터 구현 방법으로서, 수의영상에 유증상 장기 정보가 태깅된 제1 훈련데이터를 이용하여 유증상 장기 분류모델을 훈련하는 과정; 훈련 된 유증상 장기 분류모델을 통해 상기 수의영상으로부터 예측된 유증상 장기의 위치 정보 및 상기 위치 정보에 대응하는 유증상 장기의 명칭을 획득하는 과정; 및 상기 수의영상에 세부 질병 정보가 태깅된 제2 훈련데이터와 상기 위치 정보 및 상기 명칭을 이용하여 세부 질병 분류모델을 훈련하는 과정을 포함하는, 방법을 제공한다."}
{"patent_id": "10-2023-0126429", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 개시는 유증상 장기 분류 정보를 활용한 반려동물의 질병 진단과 시각화 방법 및 장치에 관한 것이다."}
{"patent_id": "10-2023-0126429", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "이하에 기술되는 내용은 단순히 본 실시예와 관련되는 배경 정보만을 제공할 뿐 종래기술을 구성하는 것이 아니 다. 저출산 및 고령화로 인해 반려동물을 가족처럼 생각하고 키우는 사람들이 늘면서, 반려동물의 건강이나 질병 관 리에 대한 수요가 증가하는 추세이다. 특히, 딥러닝 모델을 이용하여 수의영상(veterinary image)으로부터 질병 을 분석하여 조언해주는 인공지능 기반의 반려동물 질병 진단 서비스에 대한 관심이 높다. 종래의 반려동물 질병 진단 기술은 일반적으로 동물의 방사선 영상(radiographic image)으로부터 질병을 분류하 도록 딥러닝 모델을 훈련하고, 훈련된 딥러닝 모델을 이용하여 질병을 진단한다. 이 때, 분류 대상으로서 \"위 확장, 위 확장 및 염전, 소장 확장, 소간증, 비장 비대, 신장 결석, 신장 비대, 요관 결석, 방광 결석, 복강내 종괴(간, 비장 등), 전립선 종대 등\" 실제 수의사들이 반려동물을 진단할 때 필요한 세부적인 질병을 분류하도 록 딥러닝 모델을 훈련하며, 훈련 데이터도 그에 맞게 수집된다. 그러나, 반려동물의 방사선 영상은 실생활 영상과 다르게 진단이 필요한 장기간 구별이 힘들다. 방사선 영상으 로부터 처음부터 세부적인 질병을 진단하도록 딥러닝 모델을 훈련한다면, 분별력 있는 특징을 추출하기 보다는 훈련 데이터의 패턴을 외워버리는 과적합(overfitting) 등의 문제를 발생시킬 수 있다. 또한, 이러한 훈련의 어 려움은 추론 시 질병을 오분류할 가능성을 높일 수 있다. 또한, 서로 다른 질병임에도 불구하고 방사선 영상들에서 시각적 특징이 유사하게 나타날 수 있다. 예를 들어, 간의 특정 부위가 커지는 간 비대 및 복강내종괴(간)는 서로 다른 질병이지만 방사선 영상들에서 유사한 시각적 특징을 보인다. 따라서, 한번에 세부적으로 질병을 진단하도록 딥러닝 모델을 훈련하는 경우, 유사한 시각적 특 징을 갖는 서로 다른 질병을 다수 구분해야 하기 때문에 훈련 과정에 어려움을 더욱 가중시킬 수 있다."}
{"patent_id": "10-2023-0126429", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 개시는, 유증상 장기 분류 정보를 활용한 반려동물의 질병 진단 방법 및 장치를 제공하는 데 주된 목적이 있 다. 본 개시는, 반려동물의 질병 진단과 함께 질병 의심 부위에 대한 시각적 정보를 제공할 수 있는 인공지능 모델 의 훈련 및 추론 방법을 제공하는 데 일 목적이 있다. 본 발명이 해결하고자 하는 과제들은 이상에서 언급한 과제들로 제한되지 않으며, 언급되지 않은 또 다른 과제 들은 아래의 기재로부터 통상의 기술자에게 명확하게 이해될 수 있을 것이다."}
{"patent_id": "10-2023-0126429", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 개시의 일 측면에 의하면, 반려동물의 질병 진단을 위한 딥러닝 모델을 훈련하는 컴퓨터 구현 방법으로서, 수의영상에 유증상 장기 정보가 태깅된 제1 훈련데이터를 이용하여 유증상 장기 분류모델을 훈련하는 과정; 훈 련된 유증상 장기 분류모델을 통해 상기 수의영상으로부터 예측된 유증상 장기의 위치 정보 및 상기 위치 정보 에 대응하는 유증상 장기의 명칭을 획득하는 과정; 및 상기 수의영상에 세부 질병 정보가 태깅된 제2 훈련데이 터와 상기 위치 정보 및 상기 명칭을 이용하여 세부 질병 분류모델을 훈련하는 과정을 포함하는, 방법을 제공한 다. 본 개시의 다른 측면에 의하면, 반려동물의 질병을 진단하는 컴퓨터 구현 방법으로서, 대상 수의영상을 수신하 고, 훈련된 유증상 장기 분류모델을 이용하여 상기 대상 수의영상에 대응하는 유증상 장기를 예측하는 과정; 예 측된 유증상 장기의 위치 정보 및 상기 위치 정보에 대응하는 유증상 장기의 명칭을 획득하는 과정; 및 상기 대 상 수의영상, 상기 위치 정보 및 상기 명칭을 훈련된 세부 질병 분류모델에 입력하여 상기 대상 수의영상에 대 응하는 세부 질병 정보를 예측하는 과정을 포함하는 방법을 제공한다. 본 개시의 또 다른 측면에 의하면, 하나 이상의 프로세서 및 하나 이상의 프로세서와 동작 가능하게 결합된 메 모리를 포함하는 장치로서, 상기 메모리는 하나 이상의 프로세서에 의한 명령의 실행에 응답하여 하나 이상의 프로세서로 하여금 동작들을 수행하게 하는 명령을 저장하고, 상기 동작들은, 수의영상에 유증상 장기 정보가 태깅된 제1 훈련데이터를 이용하여 유증상 장기 분류모델을 훈련하는 과정; 훈련된 유증상 장기 분류모델을 통 해 상기 수의영상으로부터 예측된 유증상 장기의 위치 정보 및 상기 위치 정보에 대응하는 유증상 장기의 명칭 을 획득하는 과정; 및 상기 수의영상에 세부 질병 정보가 태깅된 제2 훈련데이터와 상기 위치 정보 및 상기 명 칭을 이용하여 세부 질병 분류모델을 훈련하는 과정을 포함하는, 장치를 제공한다."}
{"patent_id": "10-2023-0126429", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 개시의 실시예에 의하면, 반려동물의 질병 진단의 정확도를 향상시키는 효과가 있다. 본 개시의 실시예에 의하면, 질병 진단 결과와 질병 의심 부위에 대한 시각적 정보를 함께 사용자에게 제공함으 로써, 질병 진단 보조 서비스로서의 신뢰도를 높일 수 있다. 본 개시의 효과들은 이상에서 언급한 효과들로 제한되지 않으며, 언급되지 않은 또 다른 효과들은 아래의 기재 로부터 통상의 기술자에게 명확하게 이해될 수 있을 것이다."}
{"patent_id": "10-2023-0126429", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하, 본 개시의 일부 실시예들을 예시적인 도면을 이용해 상세하게 설명한다. 각 도면의 구성 요소들에 참조 부호를 부가함에 있어서, 동일한 구성 요소들에 대해서는 비록 다른 도면 상에 표시되더라도 가능한 한 동일한 부호를 가지도록 하고 있음에 유의해야 한다. 또한, 본 개시를 설명함에 있어, 관련된 공지 구성 또는 기능에대한 구체적인 설명이 본 개시의 요지를 흐릴 수 있다고 판단되는 경우에는 그 상세한 설명은 생략한다. 본 개시에 따른 실시예의 구성요소를 설명하는 데 있어서, 제1, 제2, i), ii), a), b) 등의 부호를 사용할 수 있다. 이러한 부호는 그 구성요소를 다른 구성 요소와 구별하기 위한 것일 뿐, 그 부호에 의해 해당 구성요소의 본질 또는 차례나 순서 등이 한정되지 않는다. 명세서에서 어떤 부분이 어떤 구성요소를 '포함' 또는 '구비'한 다고 할 때, 이는 명시적으로 반대되는 기재가 없는 한 다른 구성요소를 제외하는 것이 아니라 다른 구성요소를 더 포함할 수 있는 것을 의미한다. 첨부된 도면과 함께 이하에 개시될 상세한 설명은 본 개시의 예시적인 실시형태를 설명하고자 하는 것이며, 본 개시가 실시될 수 있는 유일한 실시형태를 나타내고자 하는 것이 아니다. 본 명세서에서 수의영상은 동물의 질병 진단, 치료, 예방 등을 위해 방사선을 이용하여 동물을 촬영한 방사선 영상을 말하며, 용어 '수의영상'은 용어 '방사선 영상' 또는 용어 'X-ray 영상'과 혼용될 수 있다. 본 개시는 반려동물 질병 진단에 있어서 하나의 딥러닝 모델을 통해 질병을 세부적으로 진단하는 종래 기술과 다르게, 수의영상에서 질병이 의심되는 동물의 신체 부위 내지 장기(이하 '유증상 장기')를 먼저 파악하고 유증 상 장기를 중심으로 세부적인 질병의 종류를 진단할 수 있는 반려동물 질병 진단방법을 제공한다. 또한, 유증상 장기를 바운딩 박스(bounding box) 형태로 시각화하여 사용자에게 질병 진단 이유에 대한 신뢰성 있는 정보를 제공한다. 본 개시는 수의영상으로부터 유증상 장기를 먼저 추출하고 추출된 유증상 장기를 중심으로 세부 질병을 진단하 는 방법을 제공한다. 이를 위해, 복수의 모델 즉, 유증상 장기 분류모델과 세부 질병 분류모델을 순 차적으로 훈련시킨다. 훈련된 복수의 모델을 이용하여 진단 대상 수의영상으로부터 질병을 진단하는 과정에서는, 추출된 질병이 추출된 유증상 장기에서 발생하는지 여부에 기초하여 결과를 출력한다. 도 1 내지 도 6을 참조하여 본 개시의 일 실시예에 따른 질병 진단을 위한 복수의 딥러닝 모델을 훈련하는 과정 을 총 4 단계로 나누어 설명한다. 첫 번째는 유증상 장기 데이터셋 구축 단계로, 수의영상에 유증상 장기 정보가 태깅된 데이터셋(110, 이하 ' 유 증상 장기 데이터셋')을 구축한다. 이는 세부 질병 데이터를 바로 학습에 이용하면 진단 성능 및 시각화 결과가 불안정할 가능성이 높으므로 문제의 어려움을 완화시키고자 유증상 장기 분류모델을 먼저 지도학습시키기 위함이다. 반려동물 질병 진단모델을 훈련시키기 위한 데이터셋은 일반적으로 \"위 확장, 위 내 이물, 위 확장 및 염전, 소 장 확장, 소간증, 비장 비대, 신장 결석, 신장 비대, 요관 결석, 방광 결석, 복강내종괴(간, 비장 등), 전립선 석회화, 전립선 종대, 자궁 확장\" 등 실제 수의사들이 반려동물을 진단할 때 필요한 세부적인 질병을 분류하도 록 구축된다. 즉, 기존의 데이터셋은 수의영상에 세부 질병 정보가 태깅된 데이터셋(100, 이하 ' 세부 질병 데 이터셋')이다. 세부 질병과 해당 질병이 발생하는 장기 간의 관계에 대한 지식을 전제로, 기존의 세부 질병 데이터셋을 이용하여 추가적인 데이터 수집 없이 \"위, 소장, 간, 비장, 신장, 비뇨기관, 전립선, 자궁 등\"과 같은 유증상 장기 분류를 위한 유증상 장기 데이터셋을 새롭게 구성한다. 예를 들어, 특정 X-ray 영상에 태깅된 세부 질병이 \"위 확장\" 이라면 해당 영상의 유증상 장기는 \"위\"로 생성할 수 있다. 도 2에 추가적인 예시가 도시되어 있다. 두 번째는 유증상 장기 분류모델 학습 단계로, 구축한 유증상 장기 데이터셋을 기반으로 유증상 장기 분류 모델이 훈련된다. 유증상 장기 분류모델은 합성곱 신경망(CNN, Convolutional Neural Network), 트 랜스포머(Transformer) 등 영상을 입력으로 받아 특징 추출기(feature extractor)와 분류기(classifier)가 존 재하는 딥러닝 네트워크를 모두 사용할 수 있다. 유증상 장기 분류모델은 수의영상이 주어졌을 때 존재할 가능성이 있는 모든 유증상 장기를 추론하는 다중 레이블 분류(multi-label classification)를 수행하도록 구성 된다. 유증상 장기 분류모델의 훈련과 추론은 후술하는 바와 같이 이루어 질 수 있으나 다중 레이블 분류 를 수행할 수 있으면 그 방법을 한정하지는 않는다. 유증상 장기 분류모델의 훈련 과정을 설명한다. 유증상 장기 데이터셋에 포함된 X-ray 영상 x와 해당 영상에 정답으로 주어진 유증상 장기 정보 y가 있다 고 가정하자. 여기서 로 이루어지고 각 이며 은 진단하는 유증상 장기의 개수이다. 또한, 유증상 장기 분류모델의 특징 추출기 를 통한 특징 가 주어졌을 때 분류기 를 통해 획득한 유증상 장기 별 확률 값을 벡터 로 표현한다면, X-ray 영상 x에 대한 훈련은 수학식 1의 MBCE(Multi-label Binary Cross Entropy) 손실 함수를 최소화하기 위해 이루어 진다. 수학식 1"}
{"patent_id": "10-2023-0126429", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "여기서, 는 의 번째 장기에 질병이 존재할 확률 값을 의미한다. 또한, 훈련을 위해 주어진 데이터가 L개이면 로 확장 가능하다. 훈련이 완료된 유증상 장기 분류모델은 장기 별 임계치(Threshold)를 기반으로 유증상 장기 여부를 결정할 수 있다. 즉, X-ray 영상 x을 입력 받아 유증상 장기 별 확률 값 가 추론되었을 때, 이면 i번째 장기에 문제가 있다고 판단할 수 있다. 여기서, 각 장기의 임계치는 Youden's J Statistics로 구할 수 있으나 그 방법을 한정하지는 않는다. 세 번째는 유증상 장기 부위 바운딩박스 생성 단계로, 훈련이 완료된 유증상 장기 분류모델을 기반으로 추 론된 유증상 장기의 입력 X-ray 영상 x 내 위치 즉, 바운딩 박스 정보를 생성한다. 이는, 세부 질병 분류모델 이 질병이 의심되는 부위에 집중하여 훈련되도록, 유증상 장기 부위 정보를 바운딩 박스 형태로 추출하여 세부 질병 분류모델에 입력으로 제공하기 위함이다. 훈련이 완료된 유증상 장기 분류모델을 이용하여 추론 과정을 수행한다. 즉, 유증상 장기 데이터셋에 포함된 X-ray 영상 x와 유증상 장기 분류모델을 통한 유증상 장기 별 확률 값 가 주어졌 을 때, 에 해당하는 질병이 의심되는 유증상 장기의 인덱스 집합 를 획득한다. 이 때, 이다. 이 과정을 통해 추론된 유증상 장기(즉, )에 대해서만 CAM(Class Activation Map)을 획득하여 X-ray 영상 x 내 어느 위치 때문에 해당 장기에 문제가 있다고 유증상 장기 분류모델이 판단했는지 시각화 한다. CAM 시각화를 위해서 딥러닝 모델의 분류 이유를 시각화 할 수 있는 설명 가능 인공지능(XAI, eXplainable Artificial Intelligence) 알고리즘을 사용할 수 있다. 이후, 번째 유증상 장기의 CAM 결과를 라고 한다면 값 보다 α%이상 작은 값은 모두 제거하고 남은 영역을 기반으로 i 번째 장기에 문제가 있다고 판단한 부위에 대한 바운딩 박스를 생성한다. 여기서, α는 사용자에 의해 정의되는 하이퍼파라미터(Hyperparameter)며 노이지(noisy) 영역을 제거 하기 위해 사용된다. 도 3은 유증상 장기 부위 바운딩박스 생성 단계의 일 예시를 보여준다. ① 내지 ④의 과정을 거쳐 최종적으로 바운딩 박스 위치 정보인 (예: )와 해당 바운딩 박스 위치에 해당하는 유증상 장기 명칭인 (예: 위, 장, 간 등)를 최종 결과로 저장한다. 예를 들어, 분류 결과가 임계값보다 큰 것은 \"간\"과 \"비장\"이므 로 이며, 도 3에서 예시를 든 \"간\"과 마찬가지로 \"비장\"도 개별적으로 ① 내지 ④의 과정을 수행하여 BB4 위치 및 O4 (비장) 정보를 저장한다. 마지막은 세부 질병 분류모델 학습 단계로, 세부 질병 분류모델을 훈련한다. 전술한 첫 번째 내지 세 번째 단계가 모두 완료된 후 세부 질병 분류모델의 훈련 과정을 수행한다. 세부 질병 분류모델은 합성곱신경망, 트랜스포머 등 영상을 입력으로 받아 특징 추출기와 분류기가 존재하는 딥러닝 네트워크를 모두 사용할 수 있다. 세부 질병 분류모델은 수의영상이 주어졌을 때 존재할 가능성이 있는 모든 세부 질병을 추론하는 다중 레이블 분류를 수행하도록 구성된다. 세부 질병 데이터셋에 포함된 X-ray 영상 x과 해당 영상에 정답으로 주어진 세부 질병 명칭 , 유증상 장 기 부위 바운딩박스 생성 단계를 통해 획득한 유증상 장기 부위의 바운딩 박스 위치 정보 와 유증상 장기 명 칭 를 입력으로 활용한다. 이 때, 이다. 도 4를 참조하면, 세부 질병 분류모델 훈련 과정의 전체적인 도 식도를 보여준다. 특징 추출기를 이용하여 X-ray 영상 x로부터 특징맵을 추출한다(S410). 유증상 장기 부위의 를 기반으로 추출된 특징맵으로부터 영역 별 특징을 추출하는 과정(이하 '영역 별 특징 추출')을 수행한다(S420). 이는 유증상 장기 부위를 중심으로 세부 질병을 분류하도록 모델을 훈련시키 기 위함이다. 추출된 특징맵은 크기를 갖는다고 가정한다. 이 때, 각 가 특징맵에 해당하는 좌표와 겹치는 특 징들의 영역을 라고 한다면, 해당 영역을 위한 최종 특징 는 전역 평균 풀링(GAP, Global Average Pooling)을 통해 크기의 영역 별 특징으로 획득한다. 에 해당하지 않은 특징맵 영역을 으로 정의하면, 에 해당하는 영역은 특별한 변환없이 크기의 특징을 그 대로 활용한다. 도 5는 영역 별 특징 추출의 일 예시를 보여준다. 영역 별로 세부 질병 별 확률 값을 획득한다(S430). 세부 질병 분류모델의 분류기 를 통해 획득한 질 병 별 확률 값을 벡터 로 표현한다. 여기서, 는 진단하고자 하는 세부 질병의 개수이고 는 S420 과정에서 설명한 혹은 이다. 한편, 유증상 장기 부위를 중심으로 세부 질병을 분류하도록 세부 질병 분류모델을 훈련시키기 위해, 위치 별 학습 레이블을 결정한다(S440). 구체적으로, 유증상 장기 명칭 와 입력 영상 x에 대한 정답인 세 부 질병 명칭 를 이용하여 위치 별 학습 레이블을 결정할 수 있다. 여기서, n은 입력 영상 x에 대한 정답으로 주어지는 세부 질병의 개수이다. 여기서, 위치 별 학습 레이블은, S420 과정에서 추출한 영 역 별 특징인 각 에 대한 학습을 위한 최종 세부 질병 명칭의 정답(ground truth) 을 말한다. 먼저, 세부 질병 명칭 을 이용해 각 에 대응되는 유증상 장기 명칭"}
{"patent_id": "10-2023-0126429", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "를 생성한다. 이후, 에 해당하는 명칭 와 유증상 장기 명칭 을 비교하여 일치하는 요소가 있는지 확인한 다. 일치하는 유증상 장기가 없다면 에 정상 명칭을 부여한다. 일치하는 유증상 장기가 있다면 를 사용한다. 도 6에 위치 별 학습 레이블을 결정하는 예시가 도시되어 있다. 최종적으로, 세부 질병 명칭의 정답 을 원-핫 인코딩(One-hot encoding)하여 0 혹은 1로 이루어진 다중 레이 블 로 변환한다. 각 명칭에 대응되는 내 위치는 사용자가 사전에 정의한다. 바운딩 박스에 해당하지 않은 영역의 특징인 는 유증상 장기 부위로 추론된 영역이 아니므로 에는 정상 명 칭을 이용하여 원-핫 인코딩을 수행한다. 예를 들어, 정상 명칭에 대한 원-핫 인코딩은 을 사 용할 수 있다.영역 별로 획득한 세부 질병 별 확률 값 및 위치 별 결정된 학습 레이블에 기초하여 세부 질병 분류모델을 학습한다(S450). 주어진 입력 영상 x에 대한 훈련은 수학식 2의 손실 함수를 최소화하기 위해 이루어 질 수 있 다. 수학식 2"}
{"patent_id": "10-2023-0126429", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "여기서, 은 수학식 3의 MBCE(Multi-label Binary Cross Entropy)를 사용할 수 있으며, 다중 레이블 분 류를 수행할 수 있다면 그 방법을 한정하지는 않는다. 수학식 3"}
{"patent_id": "10-2023-0126429", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 5, "content": "여기서, 로 이루어져 있고 각 은 입력 영상 x에 i번째 세부 질병의 존재 유무 를 나타내는 정답 값이다. 본 개시의 일 실시예에 따른 유증상 장기 분류 정보를 활용하여 질병을 진단하는 과정을 설명한다. 도 7 내지 도 8을 참조하면, X-ray 영상을 수신하고, 학습이 완료된 유증상 장기 분류모델을 이용하 여 X-ray 영상에 대응하는 유증상 장기 분류 정보를 획득한다. 구체적으로, 유증상 장기 분류모델을 이용하여 X-ray 영상으로부터 특징맵을 추출하고, 유증상 장기 별 확률 값을 획득할 수 있다. 유증상 장기 바운딩 박스 생성 단계를 통해, 유증상 장기 별 위치 및 명칭 을 획득한다. 구체적으로, 유증상 장기 별 확률 값을 대응하는 임계값과 비교하여 유증상 장기를 추론하고, 추론된 유증상 장 기에 대해 CAM 알고리즘을 이용하여 유증상 장기 별 위치 및 명칭 을 획득할 수 있다. 세부 질병 분류모델의 입력으로 X-ray 영상과 유증상 장기 별 위치 및 명칭 을 활용한다. 특징 추출기를 이용하여 X-ray 영상으로부터 특징맵을 추출할 수 있다(S810). 세부 질병 분류모델의 학습 과정과 달리, 의 특징맵 영역에 해당하는 특징인 에 대해서만 영역 별 특 징 추출한다(S820). 즉, 바운딩 박스 이외의 영역은 추론 시 고려하지 않는다. 이 후, 분류기 를 사용하여 영역 별 세부 질병 별 확률 값 를 획득하고(S830),"}
{"patent_id": "10-2023-0126429", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 6, "content": "이면 번째 질병이 있다고 추론한다. 여기서, 각 세부 질병의 임계치는 Youden's J Statistics로 구할 수 있으 나 그 방법을 한정 하지 않는다. 마지막으로, 추론된 세부 질병과 입력으로 받은 유증상 장기 명칭 간의 연관성을 판단한다(S840). 구체적으 로 추론된 세부 질병에 대응하는 유증상 장기 부위 명칭(유증상 장기 데이터셋 구축 단계를 활용하여 변환 가능 함)과 입력으로 받은 유증상 장기 명칭 가 일치하는지 판단한다. 일치한다면 세부 질병 추론 결과를 최종 진단 결과로 활용하고, 일치하지 않는다면 정상으로 간주한다. 즉, 세 부 질병 추론 결과(예: 간 비대)가 유증상 장기 (예: 전립선)의 하위 질병에 속하지 않으면 세부 질병 추론결과가 정확하지 않다고 판단한다. 또한, 질병이 의심되는 부위의 시각화를 위해서, 최종 진단 결과(세부 질병 명칭 및 추론한 확률 값)와 유증상 장기 부위 위치 를 영상에 출력하여 보여준다(S850). 이 때, 세부 질병 분류모델을 이용하여 다시 시 각화 기술을 적용하는 대신 유증상 장기 분류 과정의 결과를 재활용하면 되므로 효율적이라고 볼 수 있다. 도 9는 유증상 장기 정보 기반의 세부 질병 진단 방법을 이용한 입력 영상 및 진단 결과를 시각화한 예시를 보 여준다. 도 9를 참조하면, 사용자는 최종적으로 반려동물이 보유한 세부적인 질병 명칭과 신뢰도 값 및 해당 질 병이 속한 장기의 어떤 부위에 문제가 있는지 바운딩 박스 형태로 시각화된 결과를 제공받을 수 있다. 도 10은 본 개시의 일 실시예에 따른 반려동물의 질병 진단을 위한 딥러닝 모델을 훈련하는 방법의 순서도이다. 도 10을 참조하면, 수의영상에 유증상 장기 정보가 태깅된 제1 훈련데이터를 구성한다(S1010). 상기 수의영상에 세부 질병 정보가 태깅된 제2 훈련데이터를 변경하여 제1 훈련데이터를 구성할 수 있다. 제1 훈련데이터를 이용하여 유증상 장기 분류모델을 훈련한다(S1020). 구체적으로, 상기 수의영상으로부터 예측된 유증상 장기 정보와 태깅된 유증상 장기 정보에 기초한 다중 레이블 이진 교차 엔트로피(MBCE, Multi-label Binary Cross Entropy)를 최소화하도록 유증상 장기 분류모델을 훈련할 수 있다. 훈련이 완료된 유증상 장기 분류모델을 이용하여 상기 수의영상으로부터 예측된 유증상 장기의 바운딩 박 스 및 명칭에 관한 정보를 생성한다(S1030). 구체적으로, 유증상 장기 분류모델을 이용하여 상기 수의영상에 대응하는 유증상 장기를 예측한다. 예측된 유증상 장기 별로 CAM(Class Activation Map)을 계산한다. 계산된 CAM을 이용하여 대응하는 유증상 장기의 바운 딩 박스를 생성한다. 생성된 바운딩 박스 및 대응하는 유증상 장기의 명칭을 획득한다. 세부 질병 데이터셋과 유증상 장기의 바운딩 박스 및 명칭을 이용하여 세부 질병 분류모델을 훈련한다 (S1040). 구체적으로, 상기 바운딩 박스를 기반으로 상기 수의영상으로부터 추출된 특징맵으로부터 영역 별 특징을 추출 한다. 추출된 영역 별 특징에 기초하여 영역 별 세부 질병 별 확률 값을 획득한다. 상기 명칭과 제2 훈련데이터 에 태깅된 세부 질병 정보를 이용하여 위치 별 학습 레이블을 결정한다. 상기 영역 별 세부 질병 별 확률 값 및 상기 위치 별 학습 레이블에 기초한 영역 별 다중 레이블 이진 교차 엔트로피(MBCE)의 합을 최소화하도록 세부 질병 분류모델을 훈련한다. 도 11은 본 개시의 일 실시예에 따른 유증상 장기 분류 정보를 활용하여 반려동물의 질병을 진단하는 방법의 순 서도이다. 도 11을 참조하면, 대상 수의영상을 수신한다(S1110). 훈련된 유증상 장기 분류모델을 이용하여 대상 수의영상에 대응하는 유증상 장기를 예측한다(S1120). 예측된 유증상 장기의 바운딩 박스 및 명칭을 획득한다(S1130). 구체적으로, 예측된 유증상 장기 별로 CAM(Class Activation Map)을 계산한다. 계산된 CAM을 이용하여 대응하는 유증상 장기의 바운딩 박스를 생성한 다. 생성된 바운딩 박스 및 상기 바운딩 박스에 대응하는 유증상 장기의 명칭을 획득한다. 상기 대상 수의영상, 상기 바운딩 박스 및 상기 명칭을 훈련된 세부 질병 분류모델에 입력하여 상기 대상 수의영상에 대응하는 세부 질병을 진단한다(S1140). 구체적으로, 대상 수의 영상 및 바운딩 박스를 세부 질병 분류모델에 입력하여 세부 질병 분류 결과를 획득한다. 획득된 세부 질병 분류 결과와 상기 명칭 간의 연 관성이 있는지 판단한다. 연관성이 있다고 판단된 경우, 획득된 세부 질병 분류 결과를 진단결과로 예측한다. 연관성이 없다고 판단된 경우, 세부 질병이 없는 정상으로 예측한다. 예측된 세부 질병 정보와 바운딩 박스를 대상 수의영상에 오버레이(overlay)하여 시각화하여 진단결과를 사용자 에게 제공할 수 있다. 도 12는 본 개시의 일 실시예에 따른 반려동물의 질병 진단장치의 블록구성도이다. 도 12를 참조하면, 질병 진단장치는 입출력 인터페이스(input output interface, 1210), 프로세서 (processor, 1220) 및 메모리(memory, 1230)를 전부 또는 일부 포함한다. 여기서, 입출력 인터페이스,프로세서 및 메모리는 버스를 통하여 상호간 데이터를 전송하는 것이 가능하다. 입출력 인터페이스는 외부 장치와 연결되어 동물의 질병 진단을 위한 수의영상을 수신할 수 있다. 입출력 인터페이스는 통신 연결을 구성하기 위하여 네트워크 인터페이스 카드, 네트워크 인터페이스 칩 및 네트 워킹 인터페이스 포트 등과 같은 하드웨어 모듈 또는 네트워크 디바이스 드라이버 또는 네트워킹 프로그램과 같 은 소프트웨어 모듈을 더 포함할 수 있다. 입출력 인터페이스는 프로세서가 생성한 질병 진단결과 데이터를 외부 서버 또는 저장장치에 전송 할 수 있다. 예를 들면, 질병 진단장치는 입출력 인터페이스를 통하여 질병 진단결과 데이터를 질 병 진단 서비스 관리 서버에 전송하고, 서비스 제공자는 실시간 질병 진단결과 데이터를 이용자에게 제공할 수 있다. 프로세서는 본 개시의 일 실시예에 따른 반려동물의 질병 진단을 위한 딥러닝 모델을 훈련하는 방법의 모 든 과정들을 수행할 수 있다. 프로세서는 본 개시의 일 실시예에 따른 유증상 장기 분류 정보를 활용하여 반려동물의 질병을 진단하는 방법의 모든 과정들을 수행할 수 있다. 메모리는 질병 진단장치에 의해 사용되거나 그에 의해 출력되는 정보를 저장하기 위한 휘발성 메모 리, 영구, 가상 또는 다른 종류의 메모리를 포함할 수 있다. 예를 들면, 메모리는 랜덤 액세스 메모리 (random access memory, RAM) 또는 다이내믹 RAM(dynamic RAM, DRAM)을 포함할 수 있다. 메모리는 질병 진단장치의 동작을 위한 기본 프로그램, 응용 프로그램, 네트워크 설정 정보 등을 저장한다. 그리고, 메모리는 입출력 인터페이스 및 프로세서 중 어느 하나의 요청에 따라 저 장된 정보를 제공할 수 있다 메모리는 질병 진단장치의 처리 또는 제어를 위한 다양한 데이터를 저장할 수 있다. 예를 들면, 메 모리에는 훈련이 완료된 유증상 장기 분류모델 및 세부 질병 분류모델 등이 저장될 수 있다. 또한, 메모리는 질병 진단장치가 생성한 다양한 데이터를 저장할 수 있다. 예를 들면, 메모리 에는 프로세서가 생성한 유증상 장기의 바운딩박스 및 해당 명칭에 관한 데이터 등이 저장될 수 있 다. 본 발명에 따른 장치 또는 방법의 각 구성요소는 하드웨어 또는 소프트웨어로 구현되거나, 하드웨어 및 소프트 웨어의 결합으로 구현될 수 있다. 또한, 각 구성요소의 기능이 소프트웨어로 구현되고 마이크로프로세서가 각 구성요소에 대응하는 소프트웨어의 기능을 실행하도록 구현될 수도 있다. 본 명세서에 설명되는 시스템들 및 기법들의 다양한 구현예들은, 디지털 전자 회로, 집적회로, FPGA(field programmable gate array), ASIC(application specific integrated circuit), 컴퓨터 하드웨어, 펌웨어, 소프 트웨어, 및/또는 이들의 조합으로 실현될 수 있다. 이러한 다양한 구현예들은 프로그래밍가능 시스템 상에서 실 행 가능한 하나 이상의 컴퓨터 프로그램들로 구현되는 것을 포함할 수 있다. 프로그래밍가능 시스템은, 저장 시 스템, 적어도 하나의 입력 디바이스, 그리고 적어도 하나의 출력 디바이스로부터 데이터 및 명령들을 수신하고 이들에게 데이터 및 명령들을 전송하도록 결합되는 적어도 하나의 프로그래밍가능 프로세서(이것은 특수 목적 프로세서일 수 있거나 혹은 범용 프로세서일 수 있음)를 포함한다. 컴퓨터 프로그램들(이것은 또한 프로그램들, 소프트웨어, 소프트웨어 애플리케이션들 혹은 코드로서 알려져 있음)은 프로그래밍가능 프로세서에 대한 명령어 들을 포함하며 \"컴퓨터가 읽을 수 있는 기록매체\"에 저장된다. 컴퓨터가 읽을 수 있는 기록매체는, 컴퓨터 시스템에 의하여 읽혀질 수 있는 데이터가 저장되는 모든 종류의 기 록장치를 포함한다. 이러한 컴퓨터가 읽을 수 있는 기록매체는 ROM, CD-ROM, 자기 테이프, 플로피디스크, 메모 리 카드, 하드 디스크, 광자기 디스크, 스토리지 디바이스 등의 비휘발성(non-volatile) 또는 비일시적인(non- transitory) 매체일 수 있으며, 또한 데이터 전송 매체(data transmission medium)와 같은 일시적인 (transitory) 매체를 더 포함할 수도 있다. 또한, 컴퓨터가 읽을 수 있는 기록매체는 네트워크로 연결된 컴퓨터 시스템에 분산되어, 분산방식으로 컴퓨터가 읽을 수 있는 코드가 저장되고 실행될 수도 있다. 본 명세서의 흐름도/타이밍도에서는 각 과정들을 순차적으로 실행하는 것으로 기재하고 있으나, 이는 본 개시의 일 실시예의 기술 사상을 예시적으로 설명한 것에 불과한 것이다. 다시 말해, 본 개시의 일 실시예가 속하는 기 술 분야에서 통상의 지식을 가진 자라면 본 개시의 일 실시예의 본질적인 특성에서 벗어나지 않는 범위에서 흐 름도/타이밍도에 기재된 순서를 변경하여 실행하거나 각 과정들 중 하나 이상의 과정을 병렬적으로 실행하는 것으로 다양하게 수정 및 변형하여 적용 가능할 것이므로, 흐름도/타이밍도는 시계열적인 순서로 한정되는 것은 아니다. 이상의 설명은 본 실시예의 기술 사상을 예시적으로 설명한 것에 불과한 것으로서, 본 실시예가 속하는 기술 분 야에서 통상의 지식을 가진 자라면 본 실시예의 본질적인 특성에서 벗어나지 않는 범위에서 다양한 수정 및 변 형이 가능할 것이다. 따라서, 본 실시예들은 본 실시예의 기술 사상을 한정하기 위한 것이 아니라 설명하기 위 한 것이고, 이러한 실시예에 의하여 본 실시예의 기술 사상의 범위가 한정되는 것은 아니다. 본 실시예의 보호 범위는 아래의 청구범위에 의하여 해석되어야 하며, 그와 동등한 범위 내에 있는 모든 기술 사상은 본 실시예의 권리범위에 포함되는 것으로 해석되어야 할 것이다."}
{"patent_id": "10-2023-0126429", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 개시의 일 실시예에 따른 질병 진단을 위한 복수의 딥러닝 모델을 훈련하는 과정의 구성 및 데이터 흐름을 설명하기 위한 도면이다. 도 2는 본 개시의 일 실시예에 따른 기존의 세부 질병 분류를 위한 훈련 데이터셋으로부터 유증상 장기 분류를 위한 훈련 데이터셋을 구성한 예시도이다. 도 3은 본 개시의 일 실시예에 따른 추론된 유증상 장기의 바운딩 박스 및 명칭 정보를 생성하는 과정을 설명하 기 위한 도면이다. 도 4는 본 개시의 일 실시예에 따른 세부 질병 분류모델의 세부적인 훈련 과정을 설명하기 위한 도면이다. 도 5는 본 개시의 일 실시예에 따른 유증상 장기의 바운딩 박스 정보에 기초하여 특징맵으로부터 영역 별 특징 을 추출하는 과정을 설명하기 위한 도면이다. 도 6은 본 개시의 일 실시예에 따른 위치 별 학습 레이블을 결정하는 일 예시를 나타내는 도면이다. 도 7은 본 개시의 일 실시예에 따른 유증상 장기 분류 정보를 활용하여 질병을 추론하는 과정의 구성 및 데이터 흐름을 설명하기 위한 도면이다. 도 8은 본 개시의 일 실시예에 따른 세부 질병 분류모델의 세부적인 추론 과정을 설명하기 위한 도면이다. 도 9는 본 개시의 일 실시예에 따른 유증상 장기 정보 기반의 질병 진단 방법을 이용한 입력 영상 및 진단 결과 를 시각화한 예시를 보여준다. 도 10은 본 개시의 일 실시예에 따른 반려동물의 질병 진단을 위한 딥러닝 모델을 훈련하는 방법의 순서도이다. 도 11은 본 개시의 일 실시예에 따른 유증상 장기 분류 정보를 활용하여 반려동물의 질병을 진단하는 방법의 순 서도이다. 도 12는 본 개시의 일 실시예에 따른 반려동물의 질병 진단장치의 블록구성도이다."}
