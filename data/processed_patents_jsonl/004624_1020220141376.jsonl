{"patent_id": "10-2022-0141376", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2023-0062430", "출원번호": "10-2022-0141376", "발명의 명칭": "스토리 기반 이미지 시퀀스 결정 방법, 장치 및 시스템", "출원인": "서울대학교산학협력단", "발명자": "김건우"}}
{"patent_id": "10-2022-0141376", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "인공지능 모델 기반 이미지 시퀀스 결정 장치에 의해 실행되는 스토리 기반 이미지 시퀀스 결정 방법에 있어서,스토리 인코더(Story encoder)를 이용하여, 텍스트 기반 스토리의 현재문장의 토큰 단위로 상기 스토리 상의 적어도 하나의 이전 문장과 상기 현재문장 간의 연관도에 기반하여 상기 현재문장을 인코딩하는 단계;인코딩된 상기 현재문장과 기 저장된 이미지 간 유사도를 기반으로 주어진 이미지 데이터베이스에서 상기 현재문장과 연관된 복수의 제1 후보 이미지를 검색하는 단계;이미지 간 씬 그래프(Scene Graph) 유사도를 기반으로 상기 이미지 데이터베이스에서 상기 현재문장의 직전문장의 최적 이미지와 연관된 복수의 제2 후보 이미지를 검색하는 단계; 및상기 복수의 제1 후보 이미지 및 상기 복수의 제2 후보 이미지에 기반하여 상기 현재문장의 최적 이미지를 결정하는 단계를 포함하는,스토리 기반 이미지 시퀀스 결정 방법."}
{"patent_id": "10-2022-0141376", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제 1 항에 있어서,상기 현재문장을 인코딩하는 단계는,상기 현재문장의 각 토큰과 상기 적어도 하나의 이전 문장과의 어텐션(attention)을 계산하여 상기 현재문장의토큰 단위로 상기 연관도를 결정하는 단계를 포함하는,스토리 기반 이미지 시퀀스 결정 방법."}
{"patent_id": "10-2022-0141376", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제 1 항에 있어서,상기 제1 후보 이미지를 검색하는 단계는,상기 현재문장을 벡터화하여 잠재벡터를 생성하는 단계;상기 이미지 데이터베이스에 저장된 이미지들의 잠재벡터와 상기 현재문장의 잠재벡터를 코사인-유사도 기반으로 분석하는 단계; 및상기 이미지 데이터베이스에 저장된 이미지들 중 상기 분석의 결과에 따라 유사도가 높은 순으로 소정 개수의상기 복수의 제1 후보 이미지를 선출하는 단계를 포함하는,스토리 기반 이미지 시퀀스 결정 방법."}
{"patent_id": "10-2022-0141376", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제 1 항에 있어서,상기 씬 그래프는,이미지에 포함된 적어도 하나의 객체의 종류를 꼭지점(vertex)으로, 상기 객체들 간 작용관계를 간선(edge)으로갖는 자료 구조인,스토리 기반 이미지 시퀀스 결정 방법."}
{"patent_id": "10-2022-0141376", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제 1 항에 있어서,공개특허 10-2023-0062430-3-상기 복수의 제2 후보 이미지를 검색하는 단계는,상기 직전문장의 최적 이미지의 씬 그래프를 생성하고, 이를 그래프 신경망에 통과시켜 잠재벡터를 획득하는 단계;상기 이미지 데이터베이스에 저장된 이미지들의 잠재벡터와 상기 직전문장의 최적 이미지의 잠재벡터를 코사인-유사도 기반으로 분석하는 단계; 및상기 이미지 데이터베이스에 저장된 이미지들 중 상기 분석의 결과에 따라 유사도가 높은 순으로 소정 개수의상기 복수의 제2 후보 이미지를 선출하는 단계를 포함하는,스토리 기반 이미지 시퀀스 결정 방법."}
{"patent_id": "10-2022-0141376", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제 3 항 및 제 5 항 중 어느 한 항에 있어서,상기 현재문장의 최적 이미지를 결정하는 단계는,상기 복수의 제1 후보 이미지의 잠재벡터들을 상기 직전문장의 최적 이미지의 잠재벡터와 유사 분석하여, 상기복수의 제1 후보 이미지에 대한 각 유사도를 산출하는 단계;상기 복수의 제2 후보 이미지의 잠재벡터들을 상기 직전문장의 최적 이미지의 잠재벡터와 유사 분석하여, 상기복수의 제2 후보 이미지에 대한 각 유사도를 산출하는 단계; 및상기 복수의 제1 후보 이미지에 대한 각 유사도 및 상기 복수의 제2 후보 이미지에 대한 각 유사도를 평균하여가장 유사도가 높은 이미지를 상기 최적 이미지로 결정하는 단계를 포함하는,스토리 기반 이미지 시퀀스 결정 방법."}
{"patent_id": "10-2022-0141376", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제 1 항에 있어서,상기 현재문장이 상기 텍스트 기반 스토리의 첫 문장인 경우,상기 첫 문장을 벡터화하여 잠재벡터를 생성하는 단계;상기 이미지 데이터베이스에 저장된 이미지들의 잠재벡터와 상기 첫 문장의 잠재벡터를 코사인-유사도 기반으로분석하는 단계; 및상기 이미지 데이터베이스에 저장된 이미지들 중 상기 분석의 결과에 따라 유사도가 가장 높은 이미지를 상기최적 이미지로 결정하는 단계를 포함하는,스토리 기반 이미지 시퀀스 결정 방법."}
{"patent_id": "10-2022-0141376", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제 1 항에 있어서,상기 현재문장의 최적 이미지를 결정하는 단계는,상기 현재문장이 상기 텍스트 기반 스토리의 마지막 문장이 될 때까지 순차적으로 각 문장에 대해 상기 최적 이미지를 결정하는,스토리 기반 이미지 시퀀스 결정 방법."}
{"patent_id": "10-2022-0141376", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제 1 항에 있어서,상기 인공지능 모델을 학습시키는 단계를 더 포함하고,상기 인공지능 모델을 학습시키는 단계는,공개특허 10-2023-0062430-4-복수의 문장을 포함하는 텍스트 기반 스토리로 구성된 학습 데이터셋을 구비하는 단계;상기 복수의 문장을 상기 인공지능 모델에 입력시켜 복수의 최적 이미지를 획득하는 단계;상기 복수의 최적 이미지를 BiLSTM 및 디코더를 이용하여 텍스트 기반 스토리로 복원하는 단계;상기 복원된 스토리와 원본 스토리를 비교하여 산술적 차이를 계산하는 단계; 및상기 산술적 차이를 기반으로 상기 이미지 시퀀스 결정 모델을 역전파 방식으로 학습시키는 단계를 포함하는,스토리 기반 이미지 시퀀스 결정 방법."}
{"patent_id": "10-2022-0141376", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "텍스트 기반 스토리를 수신하는 통신부;텍스트 기반 스토리를 묘사하는 이미지를 결정하도록 학습된 인공지능 모델을 저장하는 메모리; 및상기 메모리 및 통신부를 제어하는 프로세서를 포함하고,상기 프로세서는,스토리 인코더(Story encoder)를 이용하여, 텍스트 기반 스토리의 현재문장의 토큰 단위로 상기 스토리 상의 적어도 하나의 이전 문장과 상기 현재문장 간의 연관도에 기반하여 상기 현재문장을 인코딩하고,인코딩된 상기 현재문장과 기 저장된 이미지 간 유사도를 기반으로 주어진 이미지 데이터베이스에서 상기 현재문장과 연관된 복수의 제1 후보 이미지를 검색하며,이미지 간 씬 그래프(Scene Graph) 유사도를 기반으로 상기 이미지 데이터베이스에서 상기 현재문장의 직전문장의 최적 이미지와 연관된 복수의 제2 후보 이미지를 검색하고,상기 복수의 제1 후보 이미지 및 상기 복수의 제2 후보 이미지에 기반하여 상기 현재문장의 최적 이미지를 결정하는,스토리 기반 이미지 시퀀스 결정 장치."}
{"patent_id": "10-2022-0141376", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "제 10 항에 있어서,상기 프로세서는,상기 현재문장의 각 토큰과 상기 적어도 하나의 이전 문장과의 어텐션(attention)을 계산하여 상기 현재문장의토큰 단위로 상기 연관도를 결정하는, 스토리 기반 이미지 시퀀스 결정 장치."}
{"patent_id": "10-2022-0141376", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제 10 항에 있어서,상기 프로세서는,상기 현재문장을 벡터화하여 잠재벡터를 생성하고,상기 이미지 데이터베이스에 저장된 이미지들의 잠재벡터와 상기 현재문장의 잠재벡터를 코사인-유사도 기반으로 분석하며,상기 이미지 데이터베이스에 저장된 이미지들 중 상기 분석의 결과에 따라 유사도가 높은 순으로 소정 개수의상기 복수의 제1 후보 이미지를 선출하는,스토리 기반 이미지 시퀀스 결정 장치."}
{"patent_id": "10-2022-0141376", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "제 10 항에 있어서,공개특허 10-2023-0062430-5-상기 씬 그래프는,이미지에 포함된 적어도 하나의 객체의 종류를 꼭지점(vertex)으로, 상기 객체들 간 작용관계를 간선(edge)으로갖는 자료 구조인,스토리 기반 이미지 시퀀스 결정 장치."}
{"patent_id": "10-2022-0141376", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_14", "content": "제 10 항에 있어서,상기 프로세서는,상기 직전문장의 최적 이미지의 씬 그래프를 생성하고, 이를 그래프 신경망에 통과시켜 잠재벡터를 획득하고,상기 이미지 데이터베이스에 저장된 이미지들의 잠재벡터와 상기 직전문장의 최적 이미지의 잠재벡터를 코사인-유사도 기반으로 분석하며,상기 이미지 데이터베이스에 저장된 이미지들 중 상기 분석의 결과에 따라 유사도가 높은 순으로 소정 개수의상기 복수의 제2 후보 이미지를 선출하는,스토리 기반 이미지 시퀀스 결정 장치."}
{"patent_id": "10-2022-0141376", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_15", "content": "제 13 항 및 제 15 항 중 어느 한 항에 있어서,상기 프로세서는,상기 복수의 제1 후보 이미지의 잠재벡터들을 상기 직전문장의 최적 이미지의 잠재벡터와 유사 분석하여, 상기복수의 제1 후보 이미지에 대한 각 유사도를 산출하고,상기 복수의 제2 후보 이미지의 잠재벡터들을 상기 직전문장의 최적 이미지의 잠재벡터와 유사 분석하여, 상기복수의 제2 후보 이미지에 대한 각 유사도를 산출하며,상기 복수의 제1 후보 이미지에 대한 각 유사도 및 상기 복수의 제2 후보 이미지에 대한 각 유사도를 평균하여가장 유사도가 높은 이미지를 상기 최적 이미지로 결정하는,스토리 기반 이미지 시퀀스 결정 장치."}
{"patent_id": "10-2022-0141376", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_16", "content": "제 10 항에 있어서,상기 프로세서는,상기 현재문장이 상기 텍스트 기반 스토리의 첫 문장인 경우,상기 첫 문장을 벡터화하여 잠재벡터를 생성하고,상기 이미지 데이터베이스에 저장된 이미지들의 잠재벡터와 상기 첫 문장의 잠재벡터를 코사인-유사도 기반으로분석하며,상기 이미지 데이터베이스에 저장된 이미지들 중 상기 분석의 결과에 따라 유사도가 가장 높은 이미지를 상기최적 이미지로 결정하는,스토리 기반 이미지 시퀀스 결정 장치."}
{"patent_id": "10-2022-0141376", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_17", "content": "제 10 항에 있어서,상기 프로세서는,상기 현재문장이 상기 텍스트 기반 스토리의 마지막 문장이 될 때까지 순차적으로 각 문장에 대해 상기 최적 이공개특허 10-2023-0062430-6-미지를 결정하는,스토리 기반 이미지 시퀀스 결정 장치."}
{"patent_id": "10-2022-0141376", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_18", "content": "제 10 항에 있어서,상기 인공지능 모델을 학습시키는 학습부를 더 포함하고,상기 학습부는,복수의 문장을 포함하는 텍스트 기반 스토리로 구성된 학습 데이터셋을 구비하고, 상기 복수의 문장을 상기 인공지능 모델에 입력시켜 복수의 최적 이미지를 획득하며, 상기 복수의 최적 이미지를 BiLSTM 및 디코더를 이용하여 텍스트 기반 스토리로 복원하고, 상기 복원된 스토리와 원본 스토리를 비교하여 산술적 차이를 계산하여,상기 산술적 차이를 기반으로 상기 이미지 시퀀스 결정 모델을 역전파 방식으로 학습시키는,스토리 기반 이미지 시퀀스 결정 장치."}
{"patent_id": "10-2022-0141376", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_19", "content": "텍스트 기반의 복수의 문장으로 구성된 스토리를 전송하는 사용자 디바이스;학습된 이미지 시퀀스 결정 모델을 기반으로 상기 사용자 디바이스로부터 입력된 스토리의 현재문장과 이전 문장들의 문맥 연관성을 고려하고, 동시에 직전문장에 대응하여 선출된 최적 이미지와 시각적 맥락을 유지하면서,현재문장을 의미상 가장 높은 유사도로 묘사하는 이미지를 선출하는 이미지 시퀀스 결정 서버; 및상기 이미지 시퀀스 결정 모델의 추론에 이용되는 이미지들 및 상기 이미지들마다 사전 정의된 씬 그래프를 매핑하여 저장하는 데이터베이스;를 포함하는,스토리 기반 이미지 시퀀스 결정 시스템."}
{"patent_id": "10-2022-0141376", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 스토리 기반 이미지 시퀀스 결정 방법, 장치 및 이미지 시퀀스 결정 시스템에 관한 것으로, 더욱 상세 하게는 텍스트를 문장의 문맥과 시각적 맥락을 고려하며 묘사하는 이미지를 선출하는 스토리 기반 이미지 시퀀스 결정 방법, 장치 및 이미지 시퀀스 결정 시스템에 관한 것이다."}
{"patent_id": "10-2022-0141376", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 스토리 기반 이미지 시퀀스 결정 방법, 장치 및 시스템에 관한 것으로, 더욱 상세하게는 텍스트를 문 장의 문맥과 시각적 맥락을 고려하며 묘사하는 이미지 시퀀스를 선출하는 스토리 기반 이미지 시퀀스 결정 방법, 장치 및 시스템에 관한 것이다."}
{"patent_id": "10-2022-0141376", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "현존하는 이미지 검색 시스템의 대부분은 단일 문장 또는 단일 이미지 질의를 입력 받아 의미적으로 또는 시각 적으로 가장 유사한 이미지 한 장을 검색하는 단일 입출력 구조를 가진다. 대한민국 등록특허 제10-173254호는 \"복수의 이미지를 검색하기 위한 컴퓨터 구현 방법으로서, 이미지를 포함하 는 검색 질의를 수신하는 단계와, 컴퓨팅 장치에 의해, 상기 검색 질의에 기반하여 적어도 한 개의 제1 서술자 식별자를 식별하는 단계- 상기 적어도 한 개의 제1 서술자 식별자는 이미지 내 관심 포인트를 기술하는 서술자 에 해당함-, 상기 적어도 한 개의 제1 서술자 식별자를 복수의 인덱스된 이미지 각각과 연관된 한 개 이상의 제 2 서술자 식별자와 비교함으로써 상기 복수의 인덱스된 이미지를 검색하는 단계, 및 상기 비교결과에 기반하여 상기 인덱스된 이미지 중 한 개 이상을 순위화하는 단계\"를 포함하는 구성을 개시한다. 대한민국 공개특허 제10-2021-009347호는 \"이미지 검색엔진 검색 결과에 기초하여 검색 이미지 및 이미지 주소 중 적어도 하나를 포함하는 검색 정보와 사용자 질의를 획득하는 단계; 획득된 상기 사용자 질의의 종류에 기초 하여 키워드-카테고리 조합을 검출하는 단계; 검출된 상기 키워드-카테고리 조합과 매치되는 캐시 데이터의 존 재 여부를 판단하는 단계; 상기 키워드-카테고리 조합과 매치되는 캐시 데이터가 존재하지 않는 경우 획득된 상 기 검색 정보에 대한 인공 지능 기술 기반 객체 검출을 통해 객체-카테고리 조합을 생성하는 단계; 획득된 상기 키워드-카테고리 조합과 상기 객체-카테고리 조합 간의 매칭을 수행하여 매칭이 되는 경우 상기 객체-카테고리 조합이 검출된 이미지를 표시하는 단계; 및 상기 키워드-카테고리 조합과 상기 검색 정보를 맵핑하여 새로운 캐 시 데이터로 저장하는 단계를 포함하고, 상기 인공지능 기술은 자연어 처리 기술 및 이미지 객체 인식 기술 중적어도 하나\"를 포함하는 구성을 개시한다. 이러한 선행 발명의 이미지 검색 시스템 대부분은 단일 문장 또는 단일 이미지 질의를 입력받아 의미나 시각적 으로 가장 유사한 이미지 한 장을 검색하는 단일 입출력 구조를 갖는다. 선행기술문헌 특허문헌 (특허문헌 0001) 대한민국 등록특허 제10-173254호 (특허문헌 0002) 대한민국 공개특허 제10-2021-009347호"}
{"patent_id": "10-2022-0141376", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "따라서, 본 발명은 학습된 인공지능 모델을 기반으로 스토리를 문장의 문맥과 시각적 맥락을 고려하며 묘사하는 이미지 시퀀스를 선출하는 스토리 기반 이미지 시퀀스 결정 모델 방법, 장치 및 이미지 시퀀스 결정 시스템을 제공하는데 목적이 있다. 본 발명의 목적은 이상에서 언급한 것으로 제한되지 않으며, 언급되지 않은 또 다른 목적들은 아래의 기재로부 터 본 발명이 속하는 기술 분야의 통상의 지식을 가진 자에게 명확히 이해될 수 있을 것이다."}
{"patent_id": "10-2022-0141376", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "상기와 같은 목적을 달성하기 위한 본 발명의 실시예에 따른 스토리 기반 이미지 시퀀스 결정 방법은, 이미지 시퀀스 결정 모델에 의해 실행되는 스토리 기반 이미지 시퀀스 결정 방법에 있어서, 스토리 인코더(Story encoder)를 이용하여, 텍스트 기반 스토리의 현재문장의 토큰 단위로 상기 스토리 상의 적어도 하나의 이전 문 장과 상기 현재문장 간의 연관도에 기반하여 상기 현재문장을 인코딩하는 단계와, 인코딩된 상기 현재문장과 기 저장된 이미지 간 유사도를 기반으로 주어진 이미지 데이터베이스에서 상기 현재문장과 연관된 복수의 제1 후보 이미지를 검색하는 단계와, 이미지 간 씬 그래프(Scene Graph) 유사도를 기반으로 상기 이미지 데이터베이스에 서 상기 현재문장의 직전문장의 최적 이미지와 연관된 복수의 제2 후보 이미지를 검색하는 단계, 및 상기 복수 의 제1 후보 이미지 및 상기 복수의 제2 후보 이미지에 기반하여 상기 현재문장의 최적 이미지를 결정하는 단계 를 포함할 수 있다. 본 발명의 다른 실시예에 따른 텍스트 기반 스토리를 수신하는 통신부와, 텍스트 기반 스토리를 묘사하는 이미 지를 결정하도록 학습된 이미지 시퀀스 결정 모델을 저장하는 메모리 및 상기 메모리 및 통신부를 제어하는 프 로세서를 포함하고, 상기 프로세서는, 스토리 인코더(Story encoder)를 이용하여, 텍스트 기반 스토리의 현재문 장의 토큰 단위로 상기 스토리 상의 적어도 하나의 이전 문장과 상기 현재문장 간의 연관도에 기반하여 상기 현 재문장을 인코딩하고, 인코딩된 상기 현재문장과 기 저장된 이미지 간 유사도를 기반으로 주어진 이미지 데이터 베이스에서 상기 현재문장과 연관된 복수의 제1 후보 이미지를 검색하며, 이미지 간 씬 그래프(Scene Graph) 유 사도를 기반으로 상기 이미지 데이터베이스에서 상기 현재문장의 직전문장의 최적 이미지와 연관된 복수의 제2 후보 이미지를 검색하고, 상기 복수의 제1 후보 이미지 및 상기 복수의 제2 후보 이미지에 기반하여 상기 현재 문장의 최적 이미지를 결정할 수 있다. 본 발명의 다른 실시예에 따른 스토리 기반 이미지 시퀀스 결정 시스템은, 텍스트 기반의 복수의 문장으로 구성 된 스토리를 전송하는 사용자 디바이스와, 학습된 이미지 시퀀스 결정 모델을 기반으로 상기 사용자 디바이스로 부터 입력된 스토리의 현재문장과 이전 문장들의 문맥 연관성을 고려하고, 동시에 직전문장에 대응하여 선출된 최적 이미지와 시각적 맥락을 유지하면서, 현재문장을 의미상 가장 높은 유사도로 묘사하는 이미지를 선출하는 이미지 시퀀스 결정 서버, 및 상기 이미지 시퀀스 결정 모델의 추론에 이용되는 이미지들 및 상기 이미지들마다 사전 정의된 씬 그래프를 매핑하여 저장하는 데이터베이스를 포함할 수 있다."}
{"patent_id": "10-2022-0141376", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명의 실시예에 따른 스토리 기반 이미지 시퀀스 결정 방법, 장치 및 시스템에 의하면, 이미지 결정 모델을 스토리 기반 이미지 시퀀스 검색 목적에 맞게 조합하여 파이프라인을 구성한 데에서 그 효과가 발휘된다. 즉, 본 발명의 실시예에 따른 스토리 기반 이미지 시퀀스 결정 방법, 장치 및 시스템에 의하면, 스토리를 구성 하는 문장들의 문맥과 이미지들의 시각적 맥락을 고려하며 스토리를 가장 최적으로 묘사하는 이미지 시퀀스를 산출할 수 있다."}
{"patent_id": "10-2022-0141376", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 2, "content": "본 발명의 효과는 이상에서 언급한 것으로 제한되지 않으며, 언급되지 않은 또 다른 효과들은 아래의 기재로부 터 본 발명이 속하는 기술 분야의 통상의 지식을 가진 자에게 명확히 이해될 수 있을 것이다."}
{"patent_id": "10-2022-0141376", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "본 발명의 목적 및 효과, 그리고 그것들을 달성하기 위한 기술적 구성들은 첨부되는 도면과 함께 상세하게 뒤에 설명이 되는 실시 예들을 참조하면 명확해질 것이다. 본 발명을 설명함에 있어서 공지 기능 또는 구성에 대한 구체적인 설명이 본 발명의 요지를 불필요하게 흐릴 수 있다고 판단되는 경우에는 그 상세한 설명을 생략할 것 이다. 그리고 뒤에 설명되는 용어들은 본 발명에서의 구조, 역할 및 기능 등을 고려하여 정의된 용어들로서 이 는 사용자, 운용자의 의도 또는 관례 등에 따라 달라질 수 있다. 그러나 본 발명은 이하에서 개시되는 실시 예들에 한정되는 것이 아니라 서로 다른 다양한 형태로 구현될 수 있"}
{"patent_id": "10-2022-0141376", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "다. 단지 본 실시 예들은 본 발명의 개시가 완전하도록 하고, 본 발명이 속하는 기술분야에서 통상의 지식을 가 진 자에게 발명의 범주를 완전하게 알려주기 위해 제공되는 것이며, 본 발명은 오로지 특허청구범위에 기재된 청구항의 범주에 의하여 정의될 뿐이다. 그러므로 그 정의는 본 명세서 전반에 걸친 내용을 토대로 내려져야 할 것이다. 명세서 전체에서, 어떤 부분이 어떤 구성요소를 \"포함\"한다고 할 때, 이는 특별히 반대되는 기재가 없는 한 다 른 구성요소를 제외하는 것이 아니라 다른 구성요소를 더 포함할 수 있는 것을 의미한다. 이하에서는 첨부한 도면을 참조하며, 본 발명의 바람직한 실시예들을 보다 상세하게 설명하기로 한다. 도 1은 본 발명의 일 실시예에 따른 스토리 기반 이미지 시퀀스 결정 시스템의 구성을 도시하는 블록도이고, 도 2는 본 발명의 일 실시예에 따른 스토리 기반 이미지 시퀀스 결정 시스템의 개념을 도시하는 개념도이며, 도 3 은 본 발명의 일 실시예에 따른 이미지 시퀀스 결정장치의 구성을 도시하는 블록도이고, 도 5는 본 발명의 일 실시예에 따른 스토리 인코더의 개념을 도시하는 개념도다. 도 1 및 도 2를 참조하면, 본 발명의 일 실시예에 따른 스토리 기반 이미지 시퀀스 결정 시스템은 사용자 디바이스, 데이터베이스, 이미지 시퀀스 결정 서버를 포함할 수 있다. 이하 이미지 시퀀스 결정 서버는 이미지 시퀀스 결정 장치와 명칭이 혼용될 수 있다. 사용자 디바이스는 텍스트 기반의 복수의 문장으로 구성된 스토리를 입력하는 장치일 수 있다. 일 예로, 사용자 디바이스는 자신이 입력하는 복수의 문장으로 구성된 스토리를 의미와 시각적으로 가장 유사하게묘사하는 이미지 시퀀스를 검색하고자 하는 사용자의 단말일 수 있다. 사용자 디바이스는 일 예로, 스마트폰(smartphone), 태블릿 PC(tablet personal computer), 이동 전화기 (mobile phone), 영상 전화기, 전자책 리더기(e-book reader), 데스크탑 PC (desktop PC), 랩탑 PC(laptop PC), 넷북 컴퓨터(netbook computer), 워크스테이션(workstation), 서버, PDA(personal digital assistant), PMP(portable multimedia player), MP3 플레이어, 모바일 의료기기, 카메라, 또는 웨어러블 장치(wearable device) 중 적어도 하나로 구비될 수 있으며, 이에 한정하지 않는다. 데이터베이스는 문장을 묘사하는 이미지를 해당 문장과 미리 매핑하여 저장하고, 이미지마다 사전 정의된 씬 그래프를 매핑하여 저장할 수 있다. 여기서, 데이터베이스에 각각 저장되는 정보들은 매핑테이블의 형식으로 저장될 수 있다. 각 매핑테이블은 서로 관계되어 실행되는 관계형 데이터베이스일 수 있다. 관계형 데이터베이스는 일련의 정형화된 테이블로 구 성된 데이터 항목들의 집합체이다. 관계형 데이터베이스는 공지된 기술임에 따라 자세한 설명은 생략한다. 이미지 시퀀스 결정 서버는 통신망을 통하여 데이터베이스에 접속할 수 있다. 통신망을 통하여 데이 터베이스에 접속하는 경우 데이터베이스는 특정 하나의 IP(Internet Protocol) 주소를 갖는 서버뿐만 아니라, 통신망을 통해 연결되며 서로 다른 다양한 IP 주소를 갖는 복수의 서버일 수도 있다. 다만, 이에 한정되는 것은 아니고 일 예로, 데이터베이스는 이미지 시퀀스 결정 서버에 포함되는 구 성일 수도 있다. 일 실시예에서, 이미지 시퀀스 결정 서버는 전적으로 하드웨어이거나, 또는 부분적으로 하드웨어이고 부분 적으로 소프트웨어인 측면을 가질 수 있다. 예컨대, 이미지 시퀀스 결정 서버는 특정 형식 및 내용의 데이 터를 전자통신 방식으로 주고 받기 위한 장치 및 이에 관련된 소프트웨어를 통칭할 수 있다. 본 명세서에서 \"부 (unit)\", \"장치\" 또는 \"단말\" 등의 용어는 하드웨어 및 해당 하드웨어에 의해 구동되는 소프트웨어의 조합을 지 칭하는 것으로 의도된다. 예를 들어, 여기서 하드웨어는 CPU 또는 다른 프로세서를 포함하는 데이터 처리 기기 일 수 있다. 또한, 하드웨어에 의해 구동되는 소프트웨어는 실행중인 프로세스, 객체, 실행파일, 실행 스레드, 프로그램 등을 지칭할 수 있다. 이미지 시퀀스 결정 서버는 학습된 이미지 시퀀스 결정 모델을 기반으로 현재문장과 이전 문장들의 문맥 연관성을 고려하고, 동시에 직전문장에 대응하여 선출된 최적 이미지와 시각적 맥락을 유지하면서, 현재문장을 의미상 가장 유사도 높게 묘사하는 이미지를 선출할 수 있다. 이를 위해, 먼저 이미지 시퀀스 결정 모델의 학습이 선행된다. 이에, 스토리 기반 이미지 시퀀스 결정 모델의 학습 장치는 도 3에 도시된 바와 같이, 통신부, 메모 리 학습부 및 프로세서40)를 포함할 수 있다. 여기서, 스토리 기반 이미지 시퀀스 결정 장치를 구성하는 각각의 부는 반드시 물리적으로 구분되는 별개 의 구성요소를 지칭하는 것으로 의도되지 않는다. 즉, 도 3에서 스토리 기반 이미지 시퀀스 결정 장치의 각 부(310~340)는 서로 구분되는 별개의 블록으로 도시되었으나, 이는 스토리 기반 이미지 시퀀스 결정 장치 를 이에 의해 실행되는 동작에 의해 기능적으로 구분한 것이다. 실시예에 따라서는 전술한 각 부(310-340) 중 일부 또는 전부가 동일한 하나의 장치 내에 집적화될 수 있으며, 또는 하나 이상의 부가 다른 부와 물리적으로 구분되는 별개의 장치로 구현될 수도 있다. 예컨대, 스토리 기반 이미지 시퀀스 결정 장치의 각 부는 분산 컴퓨팅 환경 하에서 서로 통신 가능하게 연결된 컴포넌트들일 수 도 있다. 프로세서는 스토리 인코더(Story encoder)를 이용하여, 텍스트 기반 스토리의 현재문장의 토큰 단위로 상 기 스토리 상의 적어도 하나의 이전 문장과 상기 현재문장 간의 연관도에 기반하여 상기 현재문장을 인코딩할수 있다. 이를 위해, 프로세서는 상기 현재문장의 각 토큰과 상기 적어도 하나의 이전 문장과의 어텐션(attention) 을 계산하여 상기 현재문장의 토큰 단위로 상기 연관도를 결정할 수 있다. 프로세서는 인코딩된 상기 현재문장과 기 저장된 이미지 간 유사도를 기반으로 주어진 이미지 데이터베이 스에서 상기 현재문장과 연관된 복수의 제1 후보 이미지를 검색할 수 있다. 이를 위해, 구체적으로 프로세서는 상기 현재문장을 벡터화하여 잠재벡터를 생성하고, 이미지 데이터베이 스에 저장된 이미지들의 잠재벡터와 상기 현재문장의 잠재벡터를 코사인-유사도 기반으로 분석하여, 이미 지 데이터베이스에 저장된 이미지들 중 상기 분석의 결과에 따라 유사도가 높은 순으로 소정 개수의 상기 복수의 제1 후보 이미지를 선출할 수 있다. 여기서, 스토리 인코더는 N번째부터 1번째까지의 이전 문장들과 현재문장 간의 문맥 연관성을 반영하며, 인코딩 을 통해 현재문장의 공유잠재공간 벡터를 획득할 수 있다. (N은 2이상의 자연수) 여기서, 스토리 인코더는 이전에 입력된 문장들과의 의미관계를 반영해 현재문장을 인코딩하는 새로운 문장 인 코더를 의미한다. 도 5에 도시된 바와 같이, 스토리 인코더는 현재문장을 인코딩하기 위해서 우선 단어 형태의 의미 단위인 토큰(token)들로 쪼갠다. 각 토큰은 순환형 신경망 구조(Recurrent Neural Network) 중 하나인 이중 장단기 메모리 네트워크(Bi-LSTM)를 통과해 각각에 상응하는 1차 토큰 벡터를 획득한다. 각 1차 토큰 벡터는 이전 문장들과 어텐션(Attention) 알고리즘을 통해 이전 문장들과의 의미 관계를 반영한 2 차 토큰 벡터로 변환된다. 어텐션은 쿼리(query, 타겟)에 대해 키(key, 비교 대상)들을 쿼리와의 연관도에 따라 얼만큼 반영하여 밸류 (value, 새로운 출력물)를 만들어낼지 학습하는 결정 알고리즘이다. 스토리 인코더는 토큰마다 이전 문장들과 어텐션을 계산하여 토큰 단위로 이전 문장들과의 문맥 연관성을 고려 하는 것이 기존 문장 인코더와 차별되는 포인트이다. 1차 토큰 벡터 하나(쿼리)는 이전 문장들의 벡터 표현(키) 각각과 단일 신경망 층(softmax층)을 통과하여 0에서 1 사이의 점수로 전환된다. 각 점수는 해당 토큰과 이전 문장과의 연관도를 표현하는데, 학습과정에서 토큰과 가장 연관있는 내용을 담고 있을 법한 문장과의 점수값은 1에 가까워지게 된다. 최종적으로 1차 토큰 벡터와 점수들 간의 가중합을 2차 토큰 벡터(밸류)로 정의한다. 즉, 2차 토큰 벡터는 현재 문장의 한 토큰이 이전 문장 각각과 얼마나 연관도가 있는지를 종합적으로 표현한 값이다. 이후 1차, 2차 토큰 벡터를 연결(concatenate)하여 새로운 장단기 메모리 네트워크(LSTM)을 통과시켜 3차 토큰 벡터를 획득한다. 상기 과정을 현재문장 내 모든 토큰들에 반복하여 얻은 3차 토큰 벡터들의 평균 값을 최종적 으로 현재문장의 벡터표현으로 정의한다. 프로세서는 이미지 간 씬 그래프(Scene Graph) 유사도를 기반으로 상기 이미지 데이터베이스에서 상기 현 재문장의 직전문장의 최적 이미지와 연관된 복수의 제2 후보 이미지를 검색할 수 있다. 여기서, 씬 그래프는, 이미지에 포함된 적어도 하나의 객체의 종류를 꼭지점(vertex)으로, 상기 객체들 간 작용 관계를 간선(edge)으로 갖는 자료 구조를 의미한다. 일 예로, 씬 그래프는 대용량 디지털 이미지 데이터를 사전학습(pre-train)한 인공신경망 기반 객체 탐지 모델 을 사용해 생성될 수 있다. 이미지를 객체 탐지 모델에 입력했을 때, 모델은 객체의 위치를 bounding box와 XY 좌표로 하여 객체가 어떤 종류에 속하는지 0에서 1 사이의 확률로 사전 학습한 데이터를 기준으로 예측할 수 있 다. 각 객체는 예측한 종류명, 예측된 확률을 key:value 형태로 정보 쌍이 매핑되어 자료구조 딕셔너리 (dictionary)로 저장될 수 있다. 두 개의 객체간 작용관계는 씬 그래프 시드 데이터인 Visual Genome의 연결관 계통계를 기준으로 예측될 수 있다. 씬 그래프를 그래프 신경망(Graph neural network)에 입력하면 이미지 내 객체 및 연관 관계를 함축적으로 표현한 추가정보표현을 얻을 수 있기 때문에 본 발명의 이미지 간 유사성 비교 에 활용될 수 있다. 구체적으로, 프로세서는 상기 직전문장의 최적 이미지의 씬 그래프를 생성하고, 이를 그래프 신경망에 통 과시켜 잠재벡터를 획득하고, 상기 이미지 데이터베이스에 저장된 이미지들의 잠재벡터와 상기 직전문장의 최적 이미지의 잠재벡터를 코사인-유사도 기반으로 분석하여, 상기 이미지 데이터베이스에 저장된 이미지 들 중 상기 분석의 결과에 따라 유사도가 높은 순으로 소정 개수의 상기 복수의 제2 후보 이미지를 선출할 수 있다. 프로세서는 상기 복수의 제1 후보 이미지 및 상기 복수의 제2 후보 이미지에 기반하여 상기 현재문장의 최 적 이미지를 결정할 수 있다. 구체적으로, 프로세서는 현재문장의 최적 이미지를 결정하기 위해서, 상기 복수의 제1 후보 이미지의 잠재 벡터들을 상기 직전문장의 최적 이미지의 잠재벡터와 유사 분석하여, 상기 복수의 제1 후보 이미지에 대한 각 유사도를 산출한다. 그리고, 프로세서는 상기 복수의 제2 후보 이미지의 잠재벡터들을 상기 직전문장의 최적 이미지의 잠재벡 터와 유사 분석하여, 상기 복수의 제2 후보 이미지에 대한 각 유사도를 산출한다. 이어, 프로세서는 상기 복수의 제1 후보 이미지에 대한 각 유사도 및 상기 복수의 제2 후보 이미지에 대한 각 유사도를 평균하여 가장 유사도가 높은 이미지를 최적 이미지, 즉 현재문장을 묘사하는 최적 이미지로 결정 할 수 있다. 프로세서는 현재문장이 텍스트 기반 스토리의 마지막 문장이 될 때까지 순차적으로 각 문장에 대해 전술한 과정을 실행하여 최적 이미지를 결정할 수 있다. 예를 들어, 5문장으로 구성된 스토리에 대해 5장의 최적 이미 지가 결정될 수 있다. 여기서, 현재문장이 텍스트 기반 스토리의 첫 문장인 경우에 프로세서는 첫 문장을 벡터화하여 잠재벡터를 생성하고, 이미지 데이터베이스에 저장된 이미지들의 잠재벡터와 상기 첫 문장의 잠재벡터를 코사인-유사 도 기반으로 분석한다. 이에, 이미지 데이터베이스에 저장된 이미지들 중 상기 분석의 결과에 따라 유사도 가 가장 높은 이미지를 상기 최적 이미지로 결정할 수 있다. 학습부는 전술한 이미지 시퀀스 결정 모델을 학습시킬 수 있다. 구체적으로, 학습부는 복수의 문장을 포함하는 텍스트 기반 스토리로 구성된 학습 데이터셋을 구비할 수 있다. 그리고, 상기 복수의 문장을 이미지 시퀀스 결정 모델에 입력시켜 복수의 최적 이미지를 획득한다. 그리고, 복수의 최적 이미지를 BiLSTM 및 디코더를 이용하여 텍스트 기반 스토리로 복원하고, 상기 복원된 스토 리와 원본 스토리를 비교하여 산술적 차이를 계산한다. 이어, 상기 산술적 차이를 기반으로 상기 이미지 시퀀스 결정 모델을 역전파 방식으로 학습시킬 수 있다. 도 4는 본 발명의 일 실시예에 따른 이미지 시퀀스 결정 모델의 학습과정을 설명하기 위한 개념도다. 도 4를 참 조하여, 본 발명의 일 실시예에 따른 이미지 시퀀스 결정 모델의 학습 과정의 일 예를 설명하기로 한다. 본 발명의 일 실시예에 따른 스토리 기반 이미지 시퀀스 결정 모델은 크게 '스토리 인코딩 - 관련 이미지 1차 분류 - 직전문장의 최적 이미지의 그래프 표현 획득 - 관련 이미지 2차 분류 및 최종 검색 - 캡션 생성기로 전 달'의 5 단계로 구성된 학습과정을 거쳐 개발될 수 있다. 도 4처럼, S1, S2, S3의 세 문장으로 구성된 텍스트 스토리에 문장 상 문맥과 이미지상 맥락이 의미적으로 연관 되는 이미지를 검색하기 위해 우선 스토리를 인코딩할 수 있다. 문장과 이미지는 서로 다른 종류의 인지 정보이 기 때문에, 동일한 차원을 가진 공유 잠재공간으로 인코딩해야 두 정보의 연관성을 정략적으로 비교할 수 있기 때문이다. 본 발명에서 순환신경망(Recurrent neural network)과 동일 정보 내 의미연관성을 계산하는 심층학습의 최신 연 산기법인 어텐션(Attention)을 활용해 새롭게 개발한 스토리 인코더를 통해 시간스텝마다 각 문장을 공유 잠재 공간으로 매핑한다. 스토리 인코더는 도 5를 참조하여 상세히 전술한 바 있다. 현재 시간 스텝에 인가된 문장에 대응하는 이미지를 검출하기 위해, 이미지 인코더를 통해 학습데이터의 모든 이미지들 또한 벡터표현과 매핑한다. 실제 학습 시엔 계산의 효율성을 위해 이미지들을 미리 매핑하여 저장할 수 있다. 문장의 잠재벡터와 이미지들의 잠재벡터간 코사인-유사도를 계산하여 예를 들어, 최대 100장의 연관된 이미지를 1차 검색할 수 있다. 첫 번째 시간스텝의 문장, 즉 입력된 스토리의 첫 번째 문장의 경우엔 1차 검색에서 가장 유사도가 높은 1장의 사진을 최종 검색결과로 선택할 수 있다. 이미지 간 구조적 유사성을 기반으로 2차 검색은 두 번째 시간 스텝부터 적용한다. 직전 스텝에서 최종 선택된 이미지의 씬 그래프를 생성하고, 그리고 이전과 동일하게 현재 시간스텝의 문장에 대응하는 이미지 100장을 1차 검색한다. 이어서, 100장의 그래프 잠재표현을 획득하고, 직전 스텝의 그래프 잠재 표현과 코사인-유사도를 계 산하여 매긴 순위를 1차 검색 순위와 평균을 구해 새로운 순위를 산출할 수 있다. 이와 같이 그래프 잠재표현을 활용한 것이 2차 분류이다. 2차 분류의 결과 가장 순위가 높은 이미지가 최종 선택된다. 전술한 과정을 세 번째 타임 스텝까지 반복하여, 세 문장을 포함하는 스토리에 대해 문장의 문멕과 이미지의 구 조적 유사도를 고려한 이미지 3장을 최종 획득할 수 있다. 마지막으로, 최종 획득한 이미지 3장을 캡션 생성기에 입력하여, 초기에 입력한 원본 스토리를 복원할 수 있다. 캡션 생성기는 GLACNet의 구조를 활용할 수 있다. 선출한 이미지 3장의 유사도가 높을수록 캡션 생성기 입장에서는 원본 스토리를 복원하기 수월할 것이다. 캡션 생성기가 복원한 스토리와 원본 스토리와의 차이를 확률 통계적 비교를 통해 산술적으로 계산한다. 이 계산에 따라 2차 분류 결과와 실제 이미지 시퀀스와 산술적 차이를 기반으로 본 발명의 시퀀스 이미지 결정 모델을 학습시키는 데에 이용되는 손실 함수를 생성할 수 있다. 시퀀스 이미지 결정 모델은 인공신경망 기반이 므로 학습은 상기 손실 함수를 기반으로 역전파(backpropagation) 방식으로 실행될 수 있다. 도 4는 본 발명의 일 실시예에 따른 이미지 시퀀스 결정 모델의 학습과정을 설명하기 위한 개념도다. 도 4를 참조하여, 본 발명의 일 실시예에 따른 이미지 시퀀스 결정 모델의 학습 과정의 일 예를 설명하기로 한 다. 본 발명의 일 실시예에 따른 스토리 기반 이미지 시퀀스 결정 모델은 크게 '스토리 인코딩 - 관련 이미지 1차 분류 - 직전 이미지의 그래프 표현 획득 - 관련 이미지 2차 분류 및 최종 검색 - 캡션 생성기로 전달'의 5 단계 로 구성된 학습과정을 거쳐 개발될 수 있다. 도 4처럼, S1, S2, S3의 세 문장으로 구성된 텍스트 스토리에 문장 상 문맥과 이미지상 맥락이 의미적으로 연관 되는 이미지를 검색하기 위해 우선 스토리를 인코딩할 수 있다. 문장과 이미지는 서로 다른 종류의 인지 정보이 기 때문에, 동일한 차원을 가진 공유 잠재공간으로 인코딩해야 두 정보의 연관성을 정략적으로 비교할 수 있기 때문이다. 본 발명에서 순환신경망(Recurrent neural network)과 동일 정보 내 의미연관성을 계산하는 심층학습의 최신 연 산기법인 어텐션(Attention)을 활용해 새롭게 개발한 스토리 인코더를 통해 시간스텝마다 각 무장을 공유 잠재 공간으로 매핑한다. 스토리 인코더는 도 5를 참조하여 전술한 바 있다. 현재 시간 스텝에 인가된 문장에 대응하는 이미지를 검출하기 위해, 이미지 인코더를 통해 학습데이터의 모든 이미지들 또한 벡터표현과 매핑한다. 실제 학습 시엔 계산의 효율성을 위해 이미지들을 미리 매핑하여 저장할 수 있다. 문장의 잠재벡터와 이미지들의 잠재벡터간 코사인-유사도를 계산하여 예를 들어, 최대 100장의 연관된 이미지를 1차 검색할 수 있다. 첫 번째 시간스텝의 문장, 즉 입력된 스토리의 첫 번째 문장의 경우엔 1차 검색에서 가장 유사도가 높은 1장의 사진을 최종 검색결과로 선택할 수 있다. 이미지 간 구조적 유사성을 기반으로 2차 검색은 두 번째 시간 스텝부터 적용한다. 직전 스텝에서 최종 선택된 이미지의 씬 그래프를 생성하고, 그리고 이전과 동일하게 현재 시간스텝의 문장에 대응하는 이미지 100장을 1차 검색한다. 이어서, 100장의 그래프 잠재표현을 획득하고, 직전 스텝의 그래프 잠재 표현과 코사인-유사도를 계 산하여 매긴 순위를 1차 검색 순위와 평균을 구해 새로운 순위를 산출할 수 있다. 이와 같이 그래프 잠재표현을 활용한 것이 2차 분류이다. 2차 분류의 결과 가장 순위가 높은 이미지가 최종 선택된다. 전술한 과정을 세 번째 타임 스텝까지 반복하여, 세 문장을 포함하는 스토리에 대해 문장의 문멕과 이미지의 구 조적 유사도를 고려한 이미지 3장을 최종 획득할 수 있다. 마지막으로, 최종 획득한 이미지 3장을 캡션 생성기에 입력하여, 초기에 입력한 원본 스토리를 복원할 수 있다. 캡션 생성기는 GLACNet의 구조를 활용할 수 있다. 선출한 이미지 3장의 유사도가 높을수록 캡션 생성기 입장에서는 원본 스토리를 복원하기 수월할 것이다. 캡션 생성기가 복원한 스토리와 원본 스토리와의 차이를 확률 통계적 비교를 통해 산술적으로 계산한다. 이 계산에 따라 2차 분류 결과와 실제 이미지 시퀀스와 산술적 차이를 기반으로 본 발명의 시퀀스 이미지 결정 모델을 학습시키는 데에 이용되는 손실 함수를 생성할 수 있다. 시퀀스 이미지 결정 모델은 인공신경망 기반이 므로 학습은 상기 손실 함수를 기반으로 역전파(backpropagation) 방식으로 이뤄질 수 있다. 도 6은 본 발명의 일 실시예에 따른 스토리 기반 이미지 시퀀스 결정 방법을 설명하기 위한 순서도이다. 본 발명의 일 실시예에 따른 스토리 기반 이미지 시퀀스 결정방법은, 도 3의 스토리 기반 이미지 시퀀스 결정 장치와 실질적으로 동일한 구성에서 진행될 수 있다. 따라서, 도 3의 장치와 동일한 구성요소는 동일 한 도면부호를 부여하고, 반복되는 설명은 생략한다. 또한, 본 실시예에 따른 스토리 기반 이미지 시퀀스 결정 방법은 소프트웨어(어플리케이션)에 의해 실행될 수 있다. 도 6을 참조하면, 일 실시예에 따른 인공지능 모델 기반 이미지 시퀀스 결정 장치에 의해 실행되는 스토리 기반 이미지 시퀀스 결정 방법은, 먼저, 스토리 인코더(Story encoder)를 이용하여, 텍스트 기반 스토리의 현재문장의 토큰 단위로 상기 스토리 상의 적어도 하나의 이전 문장과 상기 현재문장 간의 연관도에 기반하여 상기 현재문장을 인코딩할 수 있다 (S110). 이를 위해, 현재문장의 각 토큰과 상기 적어도 하나의 이전 문장과의 어텐션(attention)을 계산하여 상기 현재 문장의 토큰 단위로 상기 연관도를 결정하는 단계를 포함할 수 있다. 다음으로, 인코딩된 상기 현재문장과 기 저장된 이미지 간 유사도를 기반으로 주어진 이미지 데이터베이스에서 상기 현재문장과 연관된 복수의 제1 후보 이미지를 검색할 수 있다(S120). 이를 위해, 이미지 시퀀스 결정 장치는 상기 현재문장을 벡터화하여 잠재벡터를 생성하는 단계와, 상기 이미지 데이터베이스에 저장된 이미지들의 잠재벡터와 상기 현재문장의 잠재벡터를 코사인-유사도 기반으로 분석하는 단계, 및 상기 이미지 데이터베이스에 저장된 이미지들 중 상기 분석의 결과에 따라 유사도가 높은 순으로 소정 개수의 상기 복수의 제1 후보 이미지를 선출하는 단계를 실행할 수 있다. 다음으로, 이미지 간 씬 그래프(Scene Graph) 유사도를 기반으로 상기 이미지 데이터베이스에서 상기 현재문장 의 직전문장의 최적 이미지와 연관된 복수의 제2 후보 이미지를 검색할 수 있다(S130). 여기서, 씬 그래프는, 이미지에 포함된 적어도 하나의 객체의 종류를 꼭지점(vertex)으로, 상기 객체들 간 작용 관계를 간선(edge)으로 갖는 자료 구조를 의미한다. 이를 위해, 이미지 시퀀스 결정 장치는, 상기 직전문장의 최적 이미지의 씬 그래프를 생성하고, 이를 그래프 신 경망에 통과시켜 잠재벡터를 획득하는 단계와, 상기 이미지 데이터베이스에 저장된 이미지들의 잠재벡터와 상기 직전문장의 최적 이미지의 잠재벡터를 코사인-유사도 기반으로 분석하는 단계, 및 상기 이미지 데이터베이스에 저장된 이미지들 중 상기 분석의 결과에 따라 유사도가 높은 순으로 소정 개수의 상기 복수의 제2 후보 이미지를 선출하는 단계를 실행할 수 있다. 다음으로, 상기 복수의 제1 후보 이미지 및 상기 복수의 제2 후보 이미지에 기반하여 상기 현재문장의 최적 이 미지를 결정할 수 있다(S140). 이를 위해, 구체적으로 상기 복수의 제1 후보 이미지의 잠재벡터들을 상기 직전문장의 최적 이미지의 잠재벡터 와 유사 분석하여, 상기 복수의 제1 후보 이미지에 대한 각 유사도를 산출하는 단계와, 상기 복수의 제2 후보 이미지의 잠재벡터들을 상기 직전문장의 최적 이미지의 잠재벡터와 유사 분석하여, 상기 복수의 제2 후보 이미 지에 대한 각 유사도를 산출하는 단계, 및 상기 복수의 제1 후보 이미지에 대한 각 유사도 및 상기 복수의 제2 후보 이미지에 대한 각 유사도를 평균하여 가장 유사도가 높은 이미지를 상기 최적 이미지로 결정하는 단계를 포함할 수 있다. 한편, 현재문장이 상기 텍스트 기반 스토리의 첫 문장인 경우, 첫 문장을 벡터화하여 잠재벡터를 생성하고, 상 기 이미지 데이터베이스에 저장된 이미지들의 잠재벡터와 상기 첫 문장의 잠재벡터를 코사인-유사도 기반으로 분석하여, 상기 이미지 데이터베이스에 저장된 이미지들 중 상기 분석의 결과에 따라 유사도가 가장 높은 이미 지를 상기 최적 이미지로 결정할 수 있다. 그리고, 현재문장이 상기 텍스트 기반 스토리의 마지막 문장이 될 때까지 순차적으로 각 문장에 대해 전술한 단 계(S110~S140)를 반복 실행하여 스토리를 묘사하는 적어도 하나 이상의 최적 이미지를 결정할 수 있다. 도 7은 본 발명의 일 실시예에 따른 이미지 시퀀스 결정 모델을 학습하는 방법을 설명하기 위한 순서도이다. 도 7을 참조하면, 먼저 복수의 문장을 포함하는 텍스트 기반 스토리로 구성된 학습 데이터셋을 구비할 수 있다 (S210). 다음으로, 상기 복수의 문장을 이미지 시퀀스 결정 모델에 입력시켜 복수의 최적 이미지를 획득할 수 있다 (S220). 다음으로, 복수의 최적 이미지를 BiLSTM 및 디코더를 이용하여 텍스트 기반 스토리로 복원할 수 있다(S230). 다음으로, 상기 복원된 스토리와 원본 스토리를 비교하여 산술적 차이를 계산하고, 상기 산술적 차이를 기반으 로 상기 이미지 시퀀스 결정 모델을 역전파 방식으로 학습시킬 수 있다(S240). 본 발명의 실시예에 따른 스토리 기반 이미지 시퀀스 결정 모델 학습 방법, 장치 및 결정 시스템에 의하면, 기 존에 공개된 이미지 결정 모델을 스토리 기반 이미지 시퀀스 검색이라는 목적에 맞게 조합하여 파이프라인을 구 성한 데에서 그 효과가 발휘된다. 전술한 스토리 기반 이미지 시퀀스 결정 모델 학습 방법, 장치 및 결정 시스템은, 프로세서, 메모리, 사용자 입 력장치, 프레젠테이션 장치 중 적어도 일부를 포함하는 컴퓨팅 장치에 의해 구현될 수 있다. 메모리는, 프로세 서에 의해 실행되면 특정 태스크를 수행할 수 있도록 코딩되어 있는 컴퓨터-판독가능 소프트웨어, 애플리케이션, 프로그램 모듈, 루틴, 인스트럭션(instructions), 및/또는 데이터 등을 저장하는 매체이다. 프로 세서는 메모리에 저장되어 있는 컴퓨터-판독가능 소프트웨어, 애플리케이션, 프로그램 모듈, 루틴, 인스트럭션, 및/또는 데이터 등을 판독하여 실행할 수 있다. 사용자 디바이스는 사용자로 하여금 프로세서에게 특정 태스크를 실행하도록 하는 명령을 입력하거나 특정 태스 크의 실행에 필요한 데이터를 입력하도록 하는 수단일 수 있다. 사용자 디바이스는 물리적인 또는 가상적인 키 보드나 키패드, 키버튼, 마우스, 조이스틱, 트랙볼, 터치-민감형 입력수단, 또는 마이크로폰 등을 포함할 수 있 다. 프레젠테이션 장치는 디스플레이, 프린터, 스피커, 또는 진동장치 등을 포함할 수 있다. 컴퓨팅 장치는 스마트폰, 태블릿, 랩탑, 데스크탑, 서버, 클라이언트 등의 다양한 장치를 포함할 수 있다. 컴퓨 팅 장치는 하나의 단일한 스탠드-얼론 장치일 수도 있고, 통신망을 통해 서로 협력하는 다수의 컴퓨팅 장치들로이루어진 분산형 환경에서 동작하는 다수의 컴퓨팅 장치를 포함할 수 있다. 또한 전술한 스토리 기반 이미지 시퀀스 결정 방법, 장치 및 결정 시스템은, 프로세서를 구비하고, 또한 프로세 서에 의해 실행되면 인공지능 모델을 활용한 스토리 기반 이미지 시퀀스 결정 방법 및 검색 방법을 수행할 수 있도록 코딩된 컴퓨터 판독가능 소프트웨어, 애플리케이션, 프로그램 모듈, 루틴, 인스트럭션, 및/또는 데이터 구조 등을 저장한 메모리를 구비하는 컴퓨팅 장치에 의해 실행될 수 있다. 상술한 본 실시예들은 다양한 수단을 통해 구현될 수 있다. 예를 들어, 본 실시예들은 하드웨어, 펌웨어 (firmware), 소프트웨어 또는 그것들의 결합 등에 의해 구현될 수 있다. 하드웨어에 의한 구현의 경우, 본 실시예들에 따른 인공지능 모델을 활용한 영상 진단 방법은 하나 또는 그 이 상의 ASICs(Application Specific Integrated Circuits), DSPs(Digital Signal Processors), DSPDs(Digital Signal Processing Devices), PLDs(Programmable Logic Devices), FPGAs(Field Programmable Gate Arrays), 프로세서, 컨트롤러, 마이크로 컨트롤러 또는 마이크로 프로세서 등에 의해 구현될 수 있다. 예를 들어, 실시예들에 따른 스토리 기반 이미지 시퀀스 결정 방법 및 학습 방법은 심층 신경망의 뉴런(neuro n)과 시냅스(synapse)가 반도체 소자들로 구현된 인공지능 반도체 장치를 이용하여 구현될 수 있다. 이때 반도 체 소자는 현재 사용하는 반도체 소자들, 예를 들어 SRAM이나 DRAM, NAND 등일 수도 있고, 차세대 반도체 소자 들, RRAM이나 STT MRAM, PRAM 등일 수도 있고, 이들의 조합일 수도 있다. 실시예들에 따른 스토리 기반 이미지 시퀀스 결정 방법을 인공지능 반도체 장치를 이용하여 구현할 때, 인공지 능 모델을 소프트웨어로 학습한 결과(가중치)를 어레이로 배치된 시냅스 모방소자에 전사하거나 인공지능 반도 체 장치에서 학습을 진행할 수도 있다. 펌웨어나 소프트웨어에 의한 구현의 경우, 본 실시예들에 따른 이미지 시퀀스 결정 방법은 이상에서 설명된 기 능 또는 동작들을 수행하는 장치, 절차 또는 함수 등의 형태로 구현될 수 있다. 소프트웨어 코드는 메모리 유닛 에 저장되어 프로세서에 의해 구동될 수 있다. 메모리 유닛은 상기 프로세서 내부 또는 외부에 위치하여, 이미 공지된 다양한 수단에 의해 프로세서와 데이터를 주고 받을 수 있다. 또한, 위에서 설명한 \"시스템\", \"프로세서\", \"컨트롤러\", \"컴포넌트\", \"모듈\", \"인터페이스\", \"모델\", 또는 \"유 닛\" 등의 용어는 일반적으로 컴퓨터 관련 엔티티 하드웨어, 하드웨어와 소프트웨어의 조합, 소프트웨어 또는 실 행 중인 소프트웨어를 의미할 수 있다. 예를 들어, 전술한 구성요소는 프로세서에 의해서 구동되는 프로세스, 프로세서, 컨트롤러, 제어 프로세서, 개체, 실행 스레드, 프로그램 및/또는 컴퓨터일 수 있지만 이에 국한되지 않는다. 예를 들어, 컨트롤러 또는 프로세서에서 실행 중인 애플리케이션과 컨트롤러 또는 프로세서가 모두 구 성 요소가 될 수 있다. 하나 이상의 구성 요소가 프로세스 및/또는 실행 스레드 내에 있을 수 있으며, 구성 요 소들은 하나의 장치(예: 시스템, 컴퓨팅 디바이스 등)에 위치하거나 둘 이상의 장치에 분산되어 위치할 수 있다. 한편, 또 다른 실시예는 전술한 이미지 시퀀스 결정 방법을 수행하는, 컴퓨터 기록매체에 저장되는 컴퓨터 프로 그램을 제공한다. 또한 또 다른 실시예는 전술한 이미지 시퀀스 결정 방법 및 검색 방법을 실현시키기 위한 프 로그램을 기록한 컴퓨터로 읽을 수 있는 기록매체를 제공한다. 기록매체에 기록된 프로그램은 컴퓨터에서 읽히어 설치되고 실행됨으로써 전술한 단계들을 실행할 수 있다. 이 와 같이, 컴퓨터가 기록매체에 기록된 프로그램을 읽어 들여 프로그램으로 구현된 기능들을 실행시키기 위하여, 전술한 프로그램은 컴퓨터의 프로세서(CPU)가 컴퓨터의 장치 인터페이스(Interface)를 통해 읽힐 수 있는 C, C++, JAVA, 기계어 등의 컴퓨터 언어로 코드화된 코드(Code)를 포함할 수 있다. 이러한 코드는 전술한 기능들을 정의한 함수 등과 관련된 기능적인 코드를 포함할 수 있고, 전술한 기능들을 컴 퓨터의 프로세서가 소정의 절차대로 실행시키는데 필요한 실행 절차 관련 제어 코드를 포함할 수도 있다. 또한, 이러한 코드는 전술한 기능들을 컴퓨터의 프로세서가 실행시키는데 필요한 추가 정보나 미디어가 컴퓨터 의 내부 또는 외부 메모리의 어느 위치(주소 번지)에서 참조 되어야 하는지에 대한 메모리 참조 관련 코드를 더 포함할 수 있다. 또한, 컴퓨터의 프로세서가 전술한 기능들을 실행시키기 위하여 원격(Remote)에 있는 어떠한 다른 컴퓨터나 서 버 등과 통신이 필요한 경우, 코드는 컴퓨터의 프로세서가 컴퓨터의 통신 모듈을 이용하여 원격(Remote)에 있는 어떠한 다른 컴퓨터나 서버 등과 어떻게 통신해야만 하는지, 통신 시 어떠한 정보나 미디어를 송수신해야 하는지 등에 대한 통신 관련 코드를 더 포함할 수도 있다. 이상에서 전술한 바와 같은 프로그램을 기록한 컴퓨터로 읽힐 수 있는 기록매체는, 일 예로, ROM, RAM, CD-ROM, 자기 테이프, 플로피디스크, 광 미디어 저장장치 등이 있다. 또한 컴퓨터가 읽을 수 있는 기록매체는 네트워크로 연결된 컴퓨터 시스템에 분산되어, 분산방식으로 컴퓨터가 읽을 수 있는 코드가 저장되고 실행될 수 있다. 그리고, 본 발명을 구현하기 위한 기능적인(Functional) 프로그램과 이와 관련된 코드 및 코드 세그먼트 등은,"}
{"patent_id": "10-2022-0141376", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "기록매체를 읽어서 프로그램을 실행시키는 컴퓨터의 시스템 환경 등을 고려하여, 본 발명이 속하는 기술분야의 프로그래머들에 의해 용이하게 추론되거나 변경될 수도 있다. 이미지 시퀀스 결정 방법은, 컴퓨터에 의해 실행되는 애플리케이션이나 프로그램 모듈과 같은 컴퓨터에 의해 실 행 가능한 명령어를 포함하는 기록 매체의 형태로도 구현될 수 있다. 컴퓨터 판독 가능 매체는 컴퓨터에 의해 액세스될 수 있는 임의의 가용 매체일 수 있고, 휘발성 및 비휘발성 매체, 분리형 및 비분리형 매체를 모두 포 함한다. 또한, 컴퓨터 판독가능 매체는 컴퓨터 저장 매체를 모두 포함할 수 있다. 컴퓨터 저장 매체는 컴퓨터 판독가능 명령어, 데이터 구조, 프로그램 모듈 또는 기타 데이터와 같은 정보의 저장을 위한 임의의 방법 또는 기술로 구현된 휘발성 및 비휘발성, 분리형 및 비분리형 매체를 모두 포함한다. 전술한 이미지 시퀀스 결정 방법은, 단말기에 기본적으로 설치된 애플리케이션(이는 단말기에 기본적으로 탑재 된 플랫폼이나 운영체제 등에 포함된 프로그램을 포함할 수 있다)에 의해 실행될 수 있고, 사용자가 애플리케이 션 스토어 서버, 애플리케이션 또는 해당 서비스와 관련된 웹 서버 등의 애플리케이션 제공 서버를 통해 마스터 단말기에 직접 설치한 애플리케이션(즉, 프로그램)에 의해 실행될 수도 있다. 이러한 의미에서, 전술한 문장 기 반 스케치 추천 방법은 단말기에 기본적으로 설치되거나 사용자에 의해 직접 설치된 애플리케이션(즉, 프로그램)으로 구현되고 단말기에 등의 컴퓨터로 읽을 수 있는 기록매체에 기록될 수 있다. 이상, 본 발명의 특정 실시예에 대하여 상술하였다. 그러나, 본 발명의 사상 및 범위는 이러한 특정 실시예에 한정되는 것이 아니라, 본 발명의 요지를 변경하지 않는 범위 내에서 다양하게 수정 및 변형이 가능하다는 것을 본 발명이 속하는 기술 분야에서 통상의 지식을 가진 자라면 이해할 것이다."}
{"patent_id": "10-2022-0141376", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "따라서, 이상에서 기술한 실시예들은 본 발명이 속하는 기술분야에서 통상의 지식을 가진 자에게 발명의 범주를 완전하게 알려주기 위해 제공되는 것이므로, 모든 면에서 예시적인 것이며 한정적이 아닌 것으로 이해해야만 하 며, 본 발명은 청구항의 범주에 의해 정의될 뿐이다."}
{"patent_id": "10-2022-0141376", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 일 실시예에 따른 스토리 기반 이미지 시퀀스 결정 시스템의 구성을 도시하는 블록도이다. 도 2는 본 발명의 일 실시예에 따른 스토리 기반 이미지 시퀀스 결정 시스템의 개념을 도시하는 개념도이다. 도 3은 본 발명의 일 실시예에 따른 이미지 시퀀스 결정 장치의 구성을 도시하는 블록도이다. 도 4는 본 발명의 일 실시예에 따른 이미지 시퀀스 결정 모델의 학습과정을 설명하기 위한 개념도이다. 도 5는 본 발명의 일 실시예에 따른 스토리 인코더의 개념을 도시하는 개념도이다. 도 6은 본 발명의 일 실시예에 따른 스토리 기반 이미지 시퀀스 결정 방법을 설명하기 위한 순서도이다. 도 7은 본 발명의 일 실시예에 따른 스토리 기반 이미지 시퀀스 결정 모델을 학습시키는 방법 중 일부를 구체적 으로 설명하기 위한 순서도이다."}
