{"patent_id": "10-2022-0184256", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2024-0102321", "출원번호": "10-2022-0184256", "발명의 명칭": "다중 진열 상품 인식 훈련 모델 생성 장치", "출원인": "주식회사 에이블에이아이", "발명자": "심재용"}}
{"patent_id": "10-2022-0184256", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "다중 진열 상품 인식 훈련 모델 생성 장치에 있어서,Region Proposal을 사용하여 여러 상품의 bounding box 를 구하며, 각 상품의 bounding box를 crop하여 query이미지를 생성하기 위한 다중상품검출부(100);와보유하고 있는 각각의 상품 이미지를 reference로 사용하여 Global descriptor를 생성하여 reference DB를 미리 구성하며, 다중상품검출부에서 생성한 상기 query 이미지를 사용하여 실시간으로 Global descriptor를 생성하기 위한 엠베더부(200);와query 이미지의 Global descriptor를 사용하여 reference DB를 검색하여 인식하기 위한 레커나이저부(300);와잘못된 detection을 제거하고 K-NN 순위를 보정하여 인식 성능을 높이기 위한 리파이너부(400);를 포함하여 구성되는 것을 특징으로 하는 다중 진열 상품 인식 훈련 모델 생성 장치."}
{"patent_id": "10-2022-0184256", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제 1항에 있어서,새로운 상품일 경우, reference 이미지만을 추가로 하여 Global descriptor를 생성하여 업데이트할 수 있도록해당 상품 이미지에 대한 Global descriptor를 생성하기 위하여 엠베더부(200)에 해당 상품 이미지를 제공하기위한 업데이터부(500);를 더 포함하여 구성되는 것을 특징으로 하는 다중 진열 상품 인식 훈련 모델 생성 장치."}
{"patent_id": "10-2022-0184256", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제 2항에 있어서,상기 업데이터부(500)로부터 새로운 상품 이미지를 제공받을 경우에 상기 엠베더부(200)는 새로운 상품의reference image 만 추가로 Global descriptor를 생성하여 reference DB를 업데이트하며, 상기 레커나이저부(300)는 새로운 상품의 reference 이미지만 추가하여 transfer learning을 실행하여 인식 모델을 업데이트시키는 것을 특징으로 하는 다중 진열 상품 인식 훈련 모델 생성 장치."}
{"patent_id": "10-2022-0184256", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 다중 진열 상품 인식 훈련 모델 생성 장치에 관한 것으로서, 더욱 상세하게는 진열대에 진열된 다양한 상품에 대하여 인공지능 기술을 이용하여 인식할 수 있도록 인공지능 모델을 훈련시키기 위한 다중 진열 상품 인 식 훈련 모델 생성 장치에 관한 것이다. 본 발명을 통해, 매장 재고 상황 및 진열대의 상품 진열 상황을 인공지능 기술로 파악이 가능하도록 하기 위하여 인공지능 모델을 훈련시키기 위한 다중 진열 상품 인식 훈련 모델 생성 장치를 제공함으로써, 매장 재고 관리 상 황, 진열대의 상품 진열 상황 관리 등을 실시간으로 수행할 수 있게 됨으로써, 다단 진열대의 상품인식 및 수량 추정 효과, 재고관리 상황(재고 없음, 재고적음, 위치오류, 가격오류) 인식 효과, 유통 상품 상태인식 효과를 제 공하게 되는 것이다."}
{"patent_id": "10-2022-0184256", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 다중 진열 상품 인식 훈련 모델 생성 장치에 관한 것으로서, 더욱 상세하게는 진열대에 진열된 다양 한 상품에 대하여 인공지능 기술을 이용하여 인식할 수 있도록 인공지능 모델을 훈련시키기 위한 다중 진열 상 품 인식 훈련 모델 생성 장치에 관한 것이다."}
{"patent_id": "10-2022-0184256", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "코로나 19로 유통매장의 식재료 구매 빈도 및 구매량 증가로 재고 부족률도 증가하는 추세이다. 예를 들어, 해외 유통매장 재고관리 로봇 모니터링에 따르면 코로나19 이전 평균 재고 부족률이 3~6% 였지만 2020년 2월 초부터 30%이상으로 급증하였다. 이는 외식 등 식당에서 식사를 해결하는 대신 가정 요리를 위한 식재료 구매가 증가된 것으로 파악된다. 특히, 국내 중대형 마트(하나로 마트)의 객단가 39,026원에서 45,288원으로 약 6,262원 증가하였는데, 이는 코 로나 19로 국민에게 지급된 재난지원금이 식재료 구매로 이어졌기 때문으로 추정되며, 가정 내에서 모든 끼니를 해결하기 위해 1회 외출에 많은 양의 식재료를 한번에 구매하는 경향 때문으로 파악된다. 그리고, 중대형급 유통매장은 빠르게 소진되는 상품의 재고 진열을 위한 수량 및 발주가 필요한 예상되고 있으 나, 상품을 예측할 수 있는 빅데이터 기반 재고관리 통합 플랫폼 구축에 어려움을 겪고 있다. 특히, 재고 왜곡으로 인한 유통매장 손실이 심각한 수준으로서, 예를 들어, 상품의 일시적 품절(OOS ; Out-of- Stuck)과 과잉재고 결합 때문으로 파악된다. 또한, 매장 직원을 활용한 재고 조사의 한계점이 발생하였다. 예를 들어, 중형 마트 내 입점 상품 수, 평균 2만개이며 중대형마트는 4만~5만개 상품 진열이 되는데, 잘못 배 치된 상품 확인, 재고 확인을 위해 점원의 확인 작업을 늘리거나 점검 횟수를 늘리면 업무가 증가하고 다른 작 업에 영향을 줄 수 있는 문제점이 발생하였으며, 중형 마트 매장 관리 직원 1인 인건비의 경우, 업계 평균 월 200만원으로, 매장 관리 직원 500평 기준 최소 20인 이상이 소요되므로 상품 관리의 한계점이 발생하였다. 따라서, 본 발명에서는 상기한 문제점을 해결하고자 매장 재고 상황 및 진열대의 상품 진열 상황을 인공지능 기 술로 파악이 가능하도록 하기 위하여 인공지능 모델을 훈련시키기 위한 다중 진열 상품 인식 훈련 모델 생성 장 치를 제안하게 된 것이다. 선행기술문헌 특허문헌 (특허문헌 0001) (선행문헌 1) 대한민국등록특허공보 제10-2284675호"}
{"patent_id": "10-2022-0184256", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "따라서, 본 발명은 상기 종래의 문제점을 해소하기 위해 안출된 것으로, 본 발명의 목적은 진열대에 진열된 다양한 상품에 대하여 인공지능 기술을 이용하여 인식할 수 있도록 인공지능 모델을 훈련시키기 위한 다중 진열 상품 인식 훈련 모델 생성 장치를 제공하고자 한다."}
{"patent_id": "10-2022-0184256", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명이 해결하고자 하는 과제를 달성하기 위하여, 본 발명의 일실시예에 따른 다중 진열 상품 인식 훈련 모델 생성 장치는, Region Proposal을 사용하여 여러 상품의 bounding box 를 구하며, 각 상품의 bounding box를 crop하여 query 이미지를 생성하기 위한 다중상품검출부;와 보유하고 있는 각각의 상품 이미지를 reference로 사용하여 Global descriptor를 생성하여 reference DB를 미 리 구성하며, 다중상품검출부에서 생성한 상기 query 이미지를 사용하여 실시간으로 Global descriptor를 생성 하기 위한 엠베더부;와 query 이미지의 Global descriptor를 사용하여 reference DB를 검색하여 인식하기 위한 레커나이저부;와 잘못된 detection을 제거하고 K-NN 순위를 보정하여 인식 성능을 높이기 위한 리파이너부;를 포함하여 구 성됨으로써, 본 발명의 과제를 해결하게 된다."}
{"patent_id": "10-2022-0184256", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명에 따른 다중 진열 상품 인식 훈련 모델 생성 장치는, 매장 재고 상황 및 진열대의 상품 진열 상황을 인공지능 기술로 파악이 가능하도록 하기 위하여 인공지능 모델 을 훈련시키기 위한 다중 진열 상품 인식 훈련 모델 생성 장치를 제공함으로써, 매장 재고 관리 상황, 진열대의상품 진열 상황 관리 등을 실시간으로 수행할 수 있게 됨으로써, 다단 진열대의 상품인식 및 수량 추정 효과, 재고관리 상황(재고 없음, 재고적음, 위치오류, 가격오류) 인식 효과, 유통 상품 상태인식 효과를 제공하게 되 는 것이다."}
{"patent_id": "10-2022-0184256", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "본 발명의 일실시예에 따른 다중 진열 상품 인식 훈련 모델 생성 장치는, Region Proposal을 사용하여 여러 상품의 bounding box 를 구하며, 각 상품의 bounding box를 crop하여 query 이미지를 생성하기 위한 다중상품검출부;와 보유하고 있는 각각의 상품 이미지를 reference로 사용하여 Global descriptor를 생성하여 reference DB를 미 리 구성하며, 다중상품검출부에서 생성한 상기 query 이미지를 사용하여 실시간으로 Global descriptor를 생성 하기 위한 엠베더부;와 query 이미지의 Global descriptor를 사용하여 reference DB를 검색하여 인식하기 위한 레커나이저부;와 잘못된 detection을 제거하고 K-NN 순위를 보정하여 인식 성능을 높이기 위한 리파이너부;를 포함하여 구 성되는 것을 특징으로 한다. 이때, 부가적인 양상에 따라, 본 발명인 다중 진열 상품 인식 훈련 모델 생성 장치는, 새로운 상품일 경우, reference 이미지만을 추가로 하여 Global descriptor를 생성하여 업데이트할 수 있도록 해당 상품 이미지에 대한 Global descriptor를 생성하기 위하여 엠베더부에 해당 상품 이미지를 제공하기 위한 업데이터부;를 더 포함하여 구성되는 것을 특징으로 한다. 이때, 상기 업데이터부로부터 새로운 상품 이미지를 제공받을 경우에 상기 엠베더부는 새로운 상품의 reference image 만 추가로 Global descriptor를 생성하여 reference DB를 업데이트하며, 상기 레커나이저부 는 새로운 상품의 reference 이미지만 추가하여 transfer learning을 실행하여 인식 모델을 업데이트시키 는 것을 특징으로 한다. 이하, 본 발명에 의한 다중 진열 상품 인식 훈련 모델 생성 장치의 실시예를 통해 상세히 설명하도록 한다. 도 1은 본 발명의 일실시예에 따른 다중 진열 상품 인식 훈련 모델 생성 장치의 전체 구성도이다. 도 1에 도시한 바와 같이, 본 발명인 다중 진열 상품 인식 훈련 모델 생성 장치는, 크게, 다중상품검출부 , 엠베더부, 레커나이저부, 리파이너부를 포함하여 구성되는 것을 특징으로 한다. 구체적으로 설명하자면, 상기 다중상품검출부는 Region Proposal을 사용하여 여러 상품의 bounding box 를 구하며, 각 상품의 bounding box를 crop하여 query 이미지를 생성하기 위한 기능을 수행하게 된다. 즉, 한 장의 사진에는 선반에 진열된 여러 종류의 상품이 있으며, Region Proposal을 사용하여 여러 상품의 bounding box 를 구하게 된다. 이때, 특징적인 것은 각 상품의 bounding box를 crop하여 query image를 생성하게 된다. 그리고, 도 2에 도시한 바와 같이, 본 발명의 적용은 특정 상품이 아니라, 다단의 진열대에 진열된 일반적인 상 품(generic product)을 인식하도록 훈련하는 것이다. 이때, 상기 엠베더부(200, Embedder)는 보유하고 있는 각각의 상품 이미지를 reference로 사용하여 Global descriptor를 생성하여 reference DB를 미리 구성하며, 다중상품검출부에서 생성한 상기 query 이미지를 사용하 여 실시간으로 Global descriptor를 생성하기 위한 기능을 수행하게 된다. 즉, 보유하고 있는 각각의 상품 image를 reference 로 사용하여 Global descriptor를 생성하여 reference DB를 미리 구성하게 된다. 이후, 다중상품검출부에서 생성한 상기 query 이미지를 사용하여 실시간으로 Global descriptor를 생성하게 된 다. 이때, 상기 엠베더부(200, Embedder)는 Global descriptor 사이의 유사도를 사용하여 K-NN으로 인식하는 것을 특징으로 한다. 예를 들어, ImagaNet dataset으로 훈련한 ResNet-50 backbone에서 VGG16을 base로 하고, MAC (maximum activation of convolutions) descriptor를 사용하는 encoder로 embedding을 하여 1024-element MAC descriptors를 생성하게 되는 것이다. 이때, 상기 embedding = 상품갯수 * 1024 tensor 인 것을 특징으로 한다. 예를 들어, 도 3에 도시한 바와 같은 소스 코드를 통해 생성하게 되는 것이며, 도 4에 도시한 바와 같이, 이를 2D 스페이스로 차원을 줄여서 상품 이미지를 배치하게 된다. 그리고, 상기 레커나이저부(300, Recognizer)는 query 이미지의 Global descriptor를 사용하여 reference DB를 검색하여 인식하기 위한 기능을 수행하게 된다. 이때, 특징적인 것으로서, 상기 레커나이저부(300, Recognizer)는 Embedding space에서의 유사도를 계산하여, nearest neighbor classification 이나 K-NN 등을 사용하여 분류하는 것을 특징으로 한다. 예를 들어, 도 5 내지 도 6에 도시한 바와 같이, 인식 모델에서 사용된 상품 예로서, ResNet-50을 base로 하여 ImageNet 훈련 모델에, test로 사용한 63개 상품의 사진을 사용하여 transfer-learning을 실행하여 인식 모델을 생성하였다. 이후, 도 7에 도시한 바와 같이, 잘못 검출되어 detection score < 0.8 (조정)인 box 들을 제외하였다. 이후, 도 8에 도시한 바와 같이, 남은 Query image를 인식하였다. 이때, 상기 잘못 검출될 경우에 잘못된 detection을 제거하며, K-NN 순위를 보정하여 인식 성능을 높이기 위하 여 리파이너부를 구성하게 된다. 즉, 상기 리파이너부는 잘못된 detection을 제거하고 K-NN 순위를 보정하여 인식 성능을 높이기 위한 기능 을 수행하게 된다. 예를 들어, 잘못된 detection을 제거하고 K-NN 순위를 보정하거나 softmax score를 조절하여 인식 성능을 높이 게 된다. 또한, 상기 리파이너부는 Local feature를 사용하여 weight를 조정하거나, OCR 결과를 추가로 사용하여 유 사한 상품 간의 인식율을 높이는 것을 특징으로 한다. 따라서, Image에 포함된 텍스트 정보를 Image embedding 데이터와 결합하여 모델이 Image와 텍스트를 함께 학습 할 수 있는 것이다.이때, 상품의 텍스트는 상품을 인식하는데 있어 중요한 정보이므로, Image 기반 인식 모델의 결과와 OCR로 검출 된 텍스트와 제품명 사이의 유사도를 통해 얻은 결과를 이중으로 확인하여 보정하게 되는 것이다. 예를 들어, 도 9에 도시한 바와 같이, 상품 개별 사진의 배경을 제거하고 제품만을 남긴 경우가 OCR 결과가 가 장 우수한 것으로 나타났다. 그리고, 제품 및 상호명과 중량 등, 제품을 판단하는데 있어 중요한 텍스트가 다른 사진과 비교했을 때 가장 많 이 나오므로 상품 개별 사진을 CROP한 이미지를 사용하여 레퍼런스 DB를 구축하게 되는 것이다. 그리고, 도 10 내지 도 11에 도시한 바와 같이, 1차 상품인식의 결과에서, 157번 동서 루이보스 보리차로 인식 하는 점수가 높지 않거나 애매한 경우에, OCR 유사도 점수가 0.964286으로 아주 높으므로, 리파이너부에서 최종적으로 157번 동서 루이보스 보리차로 보정하여 인식이 가능하게 된다. 한편, 부가적인 양상에 따라, 본 발명인 다중 진열 상품 인식 훈련 모델 생성 장치는, 새로운 상품일 경우, reference 이미지만을 추가로 하여 Global descriptor를 생성하여 업데이트할 수 있도록 해당 상품 이미지에 대한 Global descriptor를 생성하기 위하여 엠베더부에 해당 상품 이미지를 제공하기 위한 업데이터부;를 더 포함하여 구성되는 것을 특징으로 한다. 이때, 상기 업데이터부로부터 새로운 상품 이미지를 제공받을 경우에 상기 엠베더부는 새로운 상품의 reference image 만 추가로 Global descriptor를 생성하여 reference DB를 업데이트하며, 상기 레커나이저부 는 새로운 상품의 reference 이미지만 추가하여 transfer learning을 실행하여 인식 모델을 업데이트시키 는 것을 특징으로 한다. 구체적으로 설명하자면, 매장에는 새로운 상품이 나오거나 단종되는 등 변화가 심한데, 그럴 때마다 상품 인식 모델을 새로 훈련시키려면 너무 많은 비용이 발생할 수 있게 된다. 이러한 문제점을 개선하고자 상기와 같이 업데이터부를 구성하게 된다. 따라서, 상기 업데이터부(500, Updater)는 최소한의 재훈련만으로 시스템 모델을 갱신하게 되는 것이다. 이때, 엠베더부는 새로운 상품의 reference image 만 추가로 Global descriptor를 생성하여 update 하면 되며, 레커나이저부는 새로운 상품의 reference image 만 추가하여 transfer learning을 실행하여 인식 모델을 update하게 되는 것이다. 본 발명에 의하면, 매장 재고 상황 및 진열대의 상품 진열 상황을 인공지능 기술로 파악이 가능하도록 하기 위 하여 인공지능 모델을 훈련시키기 위한 다중 진열 상품 인식 훈련 모델 생성 장치를 제공함으로써, 매장 재고 관리 상황, 진열대의 상품 진열 상황 관리 등을 실시간으로 수행할 수 있게 됨으로써, 다단 진열대의 상품인식 및 수량 추정 효과, 재고관리 상황(재고 없음, 재고적음, 위치오류, 가격오류) 인식 효과, 유통 상품 상태인식 효과를 제공하게 되는 것이다."}
{"patent_id": "10-2022-0184256", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "이상에서와 같은 내용의 본 발명이 속하는 기술분야의 당업자는 본 발명의 기술적 사상이나 필수적 특징을 변경 하지 않고서 다른 구체적인 형태로 실시될 수 있다는 것을 이해할 수 있을 것이다. 그러므로 이상에서 기술한 실시 예들은 모든 면에서 예시된 것이며 한정적인 것이 아닌 것으로서 이해해야만 한다. 본 발명의 범위는 상기 상세한 설명보다는 후술하는 특허청구범위에 의하여 나타내어지며, 특허청구 범위의 의 미 및 범위 그리고 그 등가 개념으로부터 도출되는 모든 변경 또는 변형된 형태가 본 발명의 범위에 포함되는 것으로 해석되어야 한다."}
{"patent_id": "10-2022-0184256", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 일실시예에 따른 다중 진열 상품 인식 훈련 모델 생성 장치의 전체 구성도이다. 도 2는 본 발명의 일실시예에 따른 다중 진열 상품 인식 훈련 모델 생성 장치의 다중상품검출부를 통해 다 단 진열대에 진열된 다양한 형태의 상품에 대한 Detect된 bounding box 들을 각각 crop 하여 query image들을 생성한 예시도이다. 도 3은 본 발명의 일실시예에 따른 다중 진열 상품 인식 훈련 모델 생성 장치의 엠베더부를 통해 상품갯수 * 1024 tensor 하는 코드 예시도이며, 도 4는 2D space로 차원을 줄여서 상품 image를 배치한 예시도이다. 도 5 내지 도 6은 본 발명의 일실시예에 따른 다중 진열 상품 인식 훈련 모델 생성 장치의 레커나이저부를 통해 인식 모델에서 사용된 63개 상품 이미지 예시도이다. 도 7은 본 발명의 일실시예에 따른 다중 진열 상품 인식 훈련 모델 생성 장치의 레커나이저부를 통해 일부 만 잘못 검출되어 detection score < 0.8 (조정)인 box 들을 제외한 예시도이다. 도 8은 본 발명의 일실시예에 따른 다중 진열 상품 인식 훈련 모델 생성 장치의 레커나이저부를 통해 남은 Query image를 인식하는 예시도이다. 도 9는 본 발명의 일실시예에 따른 다중 진열 상품 인식 훈련 모델 생성 장치의 리파이너부를 통해 OCR 검 출 사진 비교 예시도이다. 도 10 내지 도 11은 본 발명의 일실시예에 따른 다중 진열 상품 인식 훈련 모델 생성 장치의 리파이너부를 통해 OCR 검출 및 유사도 계산 과정을 나타낸 예시도이다."}
