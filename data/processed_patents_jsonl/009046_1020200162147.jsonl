{"patent_id": "10-2020-0162147", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2022-0074069", "출원번호": "10-2020-0162147", "발명의 명칭": "뇌파 데이터 기반 수면 단계 분석 방법", "출원인": "한국전자기술연구원", "발명자": "조영창"}}
{"patent_id": "10-2020-0162147", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "EEG 신호를 입력받는 단계;입력된 EEG 신호를 다수의 구간들로 세그먼테이션 하는 단계;세그먼테이션된 EEG 신호의 각 구간들에 수면 단계를 라벨링하여, 각 구간 별로 라벨링 데이터를 생성하는 제1생성단계;슬라이딩 윈도우를 이용하여, EEG 신호의 각 구간 별로 변환하여 변환 이미지를 생성하는 제2 생성단계;제1 생성단계에서 생성된 라벨링 데이터들과 제2 생성단계에서 생성된 변환 이미지들을 이용하여, 수면 단계를추론하는 인공지능 모델을 학습시키는 단계;를 포함하는 것을 특징으로 하는 수면 단계 분석 방법."}
{"patent_id": "10-2020-0162147", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "청구항 1에 있어서,슬라이딩 윈도우의 크기는,주파수 대역에 따라 가변되는 것을 특징으로 하는 수면 단계 분석 방법."}
{"patent_id": "10-2020-0162147", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "청구항 2에 있어서,제2 생성 단계는,EEG 신호의 각 구간 별로 웨이블릿 변환(wavelet transform)하여 웨이블릿 이미지를 생성하는 것을 특징으로 하는 수면 단계 분석 방법."}
{"patent_id": "10-2020-0162147", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "청구항 3에 있어서,EEG 신호는,다채널 EEG 신호이며,제2 생성 단계는,채널 별로 웨이블릿 이미지를 생성하는 것을 특징으로 하는 수면 단계 분석 방법."}
{"patent_id": "10-2020-0162147", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "에 있어서,EEG 신호를 입력받는 단계;입력된 EEG 신호를 다수의 구간들로 세그먼테이션 하는 단계;슬라이딩 윈도우를 이용하여, 세그먼테이션된 EEG 신호의 각 구간 별로 변환하여 웨이블릿 이미지를 생성하는단계;생성된 웨이블릿 이미지를 학습된 인공지능 모델에 입력하여, 수면 단계를 추론하는 단계;를 포함하는 것을 특징으로 하는 수면 단계 분석 방법."}
{"patent_id": "10-2020-0162147", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "청구항 1에 있어서,입력된 EEG 신호에서 노이즈를 제거하는 단계;를 더 포함하고,세그먼테이션 단계는,노이즈가 제거된 EEG 신호를 다수의 구간들로 세그먼테이션 하는 것을 특징으로 하는 수면 단계 분석 방법."}
{"patent_id": "10-2020-0162147", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "EEG 신호를 입력받는 입력부;입력된 EEG 신호를 다수의 구간들로 세그먼테이션 하고, 세그먼테이션된 EEG 신호의 각 구간들에 수면 단계를라벨링하여 각 구간 별로 라벨링 데이터를 생성하고, 슬라이딩 윈도우를 이용하여 EEG 신호의 각 구간 별로 변환하여 변환 이미지를 생성하는 신호 처리부; 및신호 처리부에서 생성된 라벨링 데이터들과 변환 이미지들을 이용하여, 수면 단계를 추론하는 인공지능 모델을학습시키는 프로세서;를 포함하는 것을 특징으로 하는 수면 단계 분석 시스템."}
{"patent_id": "10-2020-0162147", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "뇌파 데이터 기반 수면 단계 분석 방법이 제공된다. 본 발명의 실시예에 따른 본 발명의 실시예에 따른, 수면 단 계 분석 방법은, EEG 신호를 입력받아 다수의 구간들로 세그먼테이션 하고, 세그먼테이션된 EEG 신호의 각 구간 들에 수면 단계를 라벨링하여 각 구간 별로 라벨링 데이터를 생성하며, 슬라이딩 윈도우를 이용하여 EEG 신호의 각 구간 별로 변환하여 변환 이미지를 생성하고, 생성된 라벨링 데이터들과 변환 이미지들을 이용하여 수면 단계 를 추론하는 인공지능 모델을 학습시킨다. 이에 의해, EEG 신호를 웨이블릿 변환한 후 CNN에 입력하여 수면 단계 를 분석함으로써, 기존 다른 방식들 보다 정확하게 수면 단계를 파악할 수 있게 된다."}
{"patent_id": "10-2020-0162147", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 수면 뇌파 분석 기술에 관한 것으로, 더욱 상세하게는 수면 뇌파를 수집하여 수면 단계를 인공지능 기술로 분석하는 방법 및 이를 위한 전처리 방법에 관한 것이다."}
{"patent_id": "10-2020-0162147", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "사람은 대략 한 평생의 1/3을 자는데, 나이에 따라 그 수면시간이 달라진다. 성인이 되면 전체 수면시간이 8시 간 정도가 되는데, 건강한 삶을 영위하기 위해서는 수면 시간 뿐만 아니라 수면의 질도 중요하다. 즉, 충분한 수면을 취하고 있음에도 수면의 질이 떨어진다면, 낮 동안에 각성을 유지하지 못 하는 상태가 될 수 있는 것이다. 이에 따라, 수면 상태를 파악하기 위한 검사에서는, 먼저 환자의 현재 수면 단계가 어떠한지에 대한 판단이 전"}
{"patent_id": "10-2020-0162147", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 2, "content": "제된다. 뇌파를 이용한 다양한 알고리즘으로 수행되고 있는데, 정확도가 높지 않다는 문제가 있다.발명의 내용"}
{"patent_id": "10-2020-0162147", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은 상기와 같은 문제점을 해결하기 위하여 안출된 것으로서, 본 발명의 목적은, EEG 신호를 웨이블릿 변 환(wavelet transform)하고 인공지능 모델로 수면 단계를 분석하는 방법을 제공함에 있다."}
{"patent_id": "10-2020-0162147", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "상기 목적을 달성하기 위한 본 발명의 일 실시예에 따른, 수면 단계 분석 방법은, EEG 신호를 입력받는 단계; 입력된 EEG 신호를 다수의 구간들로 세그먼테이션 하는 단계; 세그먼테이션된 EEG 신호의 각 구간들에 수면 단 계를 라벨링하여, 각 구간 별로 라벨링 데이터를 생성하는 제1 생성단계; 슬라이딩 윈도우를 이용하여, EEG 신 호의 각 구간 별로 변환하여 변환 이미지를 생성하는 제2 생성단계; 제1 생성단계에서 생성된 라벨링 데이터들 과 제2 생성단계에서 생성된 변환 이미지들을 이용하여, 수면 단계를 추론하는 인공지능 모델을 학습시키는 단 계;를 포함한다. 슬라이딩 윈도우의 크기는, 주파수 대역에 따라 가변될 수 있다. 제2 생성 단계는, EEG 신호의 각 구간 별로 웨 이블릿 변환(wavelet transform)하여 웨이블릿 이미지를 생성할 수 있다. EEG 신호는, 다채널 EEG 신호이며, 제2 생성 단계는, 채널 별로 웨이블릿 이미지를 생성할 수 있다. 학습 단계는, 웨이블릿 이미지들을 인공지능 모델의 입력에 인가하고, 라벨링 데이터들을 인공지능 모델의 출력 에 인가하여, 인공지능 모델을 학습시킬 수 있다. 본 발명의 실시예에 따른 수면 단계 분석 방법은, EEG 신호를 입력받는 단계; 입력된 EEG 신호를 다수의 구간들 로 세그먼테이션 하는 단계; 슬라이딩 윈도우를 이용하여, 세그먼테이션된 EEG 신호의 각 구간 별로 변환하여 웨이블릿 이미지를 생성하는 단계; 생성된 웨이블릿 이미지를 학습된 인공지능 모델에 입력하여, 수면 단계를 추론하는 단계;를 더 포함할 수 있다. 본 발명의 실시예에 따른 수면 단계 분석 방법은, 입력된 EEG 신호에서 노이즈를 제거하는 단계;를 더 포함하고, 세그먼테이션 단계는, 노이즈가 제거된 EEG 신호를 다수의 구간들로 세그먼테이션 할 수 있다. 한편, 본 발명의 다른 실시예에 따른, 수면 단계 분석 시스템은, EEG 신호를 입력받는 입력부; 입력된 EEG 신호 를 다수의 구간들로 세그먼테이션 하고, 세그먼테이션된 EEG 신호의 각 구간들에 수면 단계를 라벨링하여 각 구 간 별로 라벨링 데이터를 생성하고, 슬라이딩 윈도우를 이용하여 EEG 신호의 각 구간 별로 변환하여 변환 이미 지를 생성하는 신호 처리부; 및 신호 처리부에서 생성된 라벨링 데이터들과 변환 이미지들을 이용하여, 수면 단 계를 추론하는 인공지능 모델을 학습시키는 프로세서;를 포함한다."}
{"patent_id": "10-2020-0162147", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "이상 설명한 바와 같이, 본 발명의 실시예들에 따르면, EEG 신호를 웨이블릿 변환한 후 CNN에 입력하여 수면 단 계를 분석함으로써, 기존 다른 방식들 보다 정확하게 수면 단계를 파악할 수 있게 된다."}
{"patent_id": "10-2020-0162147", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하에서는 도면을 참조하여 본 발명을 보다 상세하게 설명한다. 본 발명의 실시예에서는 EEG(Electroencephalogram) 신호를 이용하여 인공지능 모델 기반으로 수면 단계를 분석 하는 방법을 제시한다. 이를 위해서는, 먼저, EEG 신호를 처리하여 변환 이미지를 생성하고, 생성한 이미지로 인공지능 모델을 학습시킨 후 학습된 인공지능 모델로 수면 단계를 추론시키는 것이 필요하다. 먼저, EEG 신호 처리 프로세스에 대해 상세히 설명한다. 도 1은 EEG 신호의 처리 과정의 설명에 제공되는 도면 이다. 도시된 바와 같이, 먼저, Raw EEG 신호를 입력받아, 전처리를 수행한다. 전처리 과정에서는, 먼저 입력된 EEG 신호에 대해 Law Pass Filter의 일종인 노치 필터(notch filter)를 이용한 노이즈 제거가 수행된다. 제거되는 노이즈에는, 전원으로 인해 발생한 노이즈 및 움직임으로 인해 발생한 노이즈 등이 포함된다. 노치 필 터는 예시적인 것이므로, 다른 종류의 잡음 제거 필터로 대체될 수 있음은 물론이다. 다음, 노이즈가 제거된 EEG 신호를 세그먼테이션한다. 구체적으로, 노이즈 제거된 EEG 신호를 주파수 대역 별로 분리하고, 각 주파수 대역 신호들을 다수의 구간들로 분할한다. 그리고, 세그먼테이션된 EEG 신호의 각 구간들에 수면 단계를 라벨링하여, 각 구간 별로 라벨링 데이터를 생성 한다. 생성된 라벨링 데이터는 후술할 인공지능 모델을 학습시키는데 이용된다. 수면 단계는 다음과 같이 구분할 수 있다. Awake 단계 8~12Hz 뇌파 발생 Non-REM Sleep 1) 1단계 옅은 수면으로 옮겨가는 단계 전체 수면 시간의 약 5% 3~7Hz 의 뇌파가 발생 2) 2단계 약 5~15분, 전체 45~55% 호흡, 맥박, 뇌파 등 생체신호가 느려짐 K complex 발생 3) 3단계 깊은 수면 눈동자와 신체의 움직임이 없어짐 0.5~2Hz Delta waves 발생 REM Sleep Low-voltage, sawtooth waves 발생 불규칙적인 뇌파 발생 이후, 전처리된 EEG 신호에 대해, 슬라이딩 윈도우를 이용하여, 각 구간 별로 웨이블릿 변환(wavelet transform) 하여 웨이블릿 이미지들을 생성한다. 신호를 분리하기 위한 전처리 방법으로는 STFT(Short Term Firm Transportation), 웨이블릿 변환 등이 존재한 다. STFT의 경우 윈도우 크기를 고정하여 분리하므로, 윈도우 크기에 따라 시간 축의 해상도와 주파수의 해상도 가 반비례할 수 있어 특정 부분만을 추출하기가 어렵다. 반면, 웨이블릿 변환의 경우 주파수 대역 마다 유동적 으로 윈도우의 크기가 변화하여 주파수 영역의 특징을 더 효과적으로 분석할 수 있다. 도 2에는 깨어 있는 경우와 수면 중인 경우의 EEG에 대한 STFT 결과를 제시하였고, 도 3에는 깨어 있는 경우와 수면 중인 경우의 EEG에 대한 웨이블릿 변환 결과를 제시하였다. 도 2와 도 3을 비교해 보면, STFT 결과 보다는 웨이블릿 변환 결과에서, 깨어 있는 경우와 수면 중인 경우의 차 이가 보다 더 극명하게 보이고 있음을 확인할 수 있다. 이에 따라, 본 발명의 실시예에서는, 웨이블릿 변환으로 수면 시의 EEG 신호를 변환한다. 한편, EEG는 환자의 전두엽에서 부착된 다수의 전극/패치들로부터 수집되므,로, 다채널 신호이다. 도 1에 나타 낸 절치에 의해 신호 처리는 한 채널의 EEG 신호에 대한 것이다. 따라서, 다채널 EEG 신호들 각각에 대해, 도 1 에 도시된 신호 처리 절차가 수행된다. 즉, 위이블릿 이미지는, 채널 별로 생성되는 것이다. EEG 신호를 5채널 신호라고 가정한다면, 주파수 대역 별 그리고 시구간 별로 각각 5개의 위이블릿 이미지가 생 성될 것이다. 생성된 웨이블릿 이미지와 라벨링 데이터는 인공지능 모델의 학습에 이용된다. 구체적으로, 도 4에 도시된 바와 같이, 수면 단계를 추론하기 위해 설계된 CNN(Convolutional Neural Networ k)의 입력에 웨이블릿 이미지들을 다채널로 인가하고, 출력을 라벨링 데이터로 하여, CNN을 학습시킨다. 수면 단계를 추론하기 위해 설계된 CNN의 구조를 도 5에 나타내었다. 도시된 구조는 예시적인 것이므로, 변형이 가능함은 물론이다. CNN 학습이 완료되면 EEG 신호를 이용하여 수면 단계를 추론할 수 있다. 구체적으로, 획득된 EEG 신호에 대해 도 1에 도시된 방법으로 신호처리 하여 웨이블릿 이미지를 생성하고, 생성된 웨이블릿 이미지를 도 5에 도시된 바와 같이 CNN에 입력하여 CNN에서 수면 단계가 출력 되도록 하는 것이다. 도 6은 본 발명의 일 실시예에 따른 뇌파 데이터 기반 수면 단계 분석을 위한 네트워크 학습 방법의 설명에 제 공되는 흐름도이다. 도시된 바와 같이, 먼저 EEG 신호를 입력받아(S110), 노치 필터로 노이즈를 제거하고(S120), 노이즈가 제거된 EEG 신호를 세그먼테이션한다(S130). S130단계에서는 EEG 신호를 주파수 대역 별로 분리하고, 각 주파수 대역 신호들을 다수의 구간들로 분할한다. 다음, 세그먼테이션된 EEG 신호의 각 구간들에 수면 단계를 라벨링하여, 각 구간 별로 라벨링 데이터를 생성한 다(S140). 이후, 세그먼테이션된 EEG 신호에 대해, 슬라이딩 윈도우를 이용하여, 각 구간 별로 웨이블릿 변환하여 웨이블 릿 이미지들을 생성한다(S150). 그리고, S150단계에서 생성한 웨이블릿 이미지와 S140단계에 생성된 라벨링 데이터를 이용하여 수면 단계 추론 네트워크 모델을 학습시킨다(S160). 도 7은 본 발명의 일 실시예에 따른 뇌파 데이터 기반 수면 단계 분석을 위한 수면 단계 추론 방법의 설명에 제 공되는 흐름도이다. 도시된 바와 같이, 먼저 EEG 신호를 입력받아(S210), 노치 필터로 노이즈를 제거하고(S220), 노이즈가 제거된 EEG 신호를 세그먼테이션한다(S230). S210단계 내지 S230단계는 도 6의 S110 단계 내지 S130단계와 실질적으로 동일한 처리 절차이다. 이후, 세그먼테이션된 EEG 신호에 대해, 슬라이딩 윈도우를 이용하여, 각 구간 별로 웨이블릿 변환하여 웨이블 릿 이미지들을 생성한다(S240). 다음, S240단계에서 생성한 웨이블릿 이미지와 도 6의 S160단계에 의해 학습된 수면 단계 추론 네트워크 모델에 입력한다(S250). 이에, 수면 단계 추론 네트워크 모델은 수면 단계를 추론하여 출력한다(S260). 도 8은 본 발명의 일 실시예에 따른 뇌파 데이터 기반 수면 단계 분석 시스템의 블럭도이다. 본 발명의 실시예 에 따른 수면 단계 분석 시스템은, 도시된 바와 같이, 입력부, 신호 처리부, 프로세서 및 출력 부를 포함하여 구성된다. 입력부는 뇌파 측정 장치(미도시)로부터 측정되는 환자의 전두엽 부분의 EEG 신호를 입력받아 신호 처리부 로 인가한다. 신호 처리부는 인가되는 EEG 신호에 대해 도 1에 도시된 신호처리를 수행하여, 라벨링 데이터와 웨이블릿 이미지를 생성한다. 프로세서는 수면 단계 추론 네트워크 모델을 구동하고, 학습시키기 위한 CPU와 GPU들의 집합이다. 학습 단계에서, 프로세서는 신호 처리부에서 생성된 라벨링 데이터와 웨이블릿 이미지를 이용하여 수 면 단계 추론 네트워크 모델을 학습시킨다. 추론 단계에서 프로세서는 신호 처리부에서 생성된 웨이 블릿 이미지를 이용하여 수면 단계 추론 네트워크 모델로 학습 단계를 추론시킨다. 출력부는 수면 단계 추론 네트워크 모델에 의한 추론 결과를 출력하는 수단이다. 지금까지, 뇌파 데이터 기반 수면 단계 분석 방법에 대해 바람직한 실시예를 들어 상세히 설명하였다. 위 실시예에서는, EEG 신호를 웨이블릿 변환한 후 CNN에 입력하여 수면 단계를 분석함으로써, 기존 다른 방식들 보다 정확하게 수면 단계를 파악할 수 있도록 하였다. 한편, 본 실시예에 따른 장치와 방법의 기능을 수행하게 하는 컴퓨터 프로그램을 수록한 컴퓨터로 읽을 수 있는 기록매체에도 본 발명의 기술적 사상이 적용될 수 있음은 물론이다. 또한, 본 발명의 다양한 실시예에 따른 기 술적 사상은 컴퓨터로 읽을 수 있는 기록매체에 기록된 컴퓨터로 읽을 수 있는 코드 형태로 구현될 수도 있다. 컴퓨터로 읽을 수 있는 기록매체는 컴퓨터에 의해 읽을 수 있고 데이터를 저장할 수 있는 어떤 데이터 저장 장 치이더라도 가능하다. 예를 들어, 컴퓨터로 읽을 수 있는 기록매체는 ROM, RAM, CD-ROM, 자기 테이프, 플로피 디스크, 광디스크, 하드 디스크 드라이브, 등이 될 수 있음은 물론이다. 또한, 컴퓨터로 읽을 수 있는 기록매체 에 저장된 컴퓨터로 읽을 수 있는 코드 또는 프로그램은 컴퓨터간에 연결된 네트워크를 통해 전송될 수도 있다. 또한, 이상에서는 본 발명의 바람직한 실시예에 대하여 도시하고 설명하였지만, 본 발명은 상술한 특정의 실시"}
{"patent_id": "10-2020-0162147", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "예에 한정되지 아니하며, 청구범위에서 청구하는 본 발명의 요지를 벗어남이 없이 당해 발명이 속하는 기술분야 에서 통상의 지식을 가진자에 의해 다양한 변형실시가 가능한 것은 물론이고, 이러한 변형실시들은 본 발명의 기술적 사상이나 전망으로부터 개별적으로 이해되어져서는 안될 것이다."}
{"patent_id": "10-2020-0162147", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 EEG 신호의 처리 과정의 설명에 제공되는 도면, 도 2는 EEG에 대한 STFT 결과, 도 3은 EEG에 대한 웨이블릿 변환 결과, 도 4는 CNN 학습 방법을 개념적으로 나타낸 도면, 도 5는 CNN 추론 방법을 개념적으로 나타낸 도면. 도 6은 본 발명의 일 실시예에 따른 뇌파 데이터 기반 수면 단계 분석을 위한 네트워크 학습 방법의 설명에 제공되는 흐름도, 도 7은 본 발명의 일 실시예에 따른 뇌파 데이터 기반 수면 단계 분석을 위한 수면 단계 추론 방법의 설명에 제 공되는 흐름도, 도 8은 본 발명의 일 실시예에 따른 뇌파 데이터 기반 수면 단계 분석 시스템의 블럭도이다."}
