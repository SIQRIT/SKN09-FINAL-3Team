{"patent_id": "10-2023-0121050", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2025-0038394", "출원번호": "10-2023-0121050", "발명의 명칭": "사전학습과 전이학습을 이용한 수요 예측 장치 및 그 방법", "출원인": "(주)임팩티브에이아이", "발명자": "홍참길"}}
{"patent_id": "10-2023-0121050", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "수요 예측을 위한 수요예측데이터셋을 입력시키는 데이터입력부;상기 입력된 수요예측데이터셋을 이용하여 인공신경망모델을 학습시키는 기반모델학습부;상기 수요예측데이터셋을 SHAP값(SHapley Additive exPlanations value)을 이용하여 복수의 클러스터별로 분류하는 클러스터분류부; 및상기 복수의 클러스터별로 상기 인공신경망모델에 각각 입력시켜 전이학습(Transfer learning)을 통해 각 가중치를 재학습시키는 복수의 전이학습부;를 포함하는 사전학습과 전이학습을 이용한 수요 예측 장치."}
{"patent_id": "10-2023-0121050", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "청구항 1에 있어서,상기 인공신경망모델은,MLP(Multi-Layer Perceptron) 모델 또는 FFNN(Feed Forward Neural Network) 모델을 포함하는사전학습과 전이학습을 이용한 수요 예측 장치."}
{"patent_id": "10-2023-0121050", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "청구항 2에 있어서,상기 클러스터분류부는,상기 수요예측데이터셋의 각 데이터에 대한 상기 SHAP값에 대응하는 변수들의 영향력에 따라 클러스터링하여 분류하는사전학습과 전이학습을 이용한 수요 예측 장치."}
{"patent_id": "10-2023-0121050", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "청구항 3에 있어서,상기 클러스터분류부는,상기 SHAP값을 이용하여 클러스터링하되, 상기 수요예측데이터셋을 K-평균 클러스터링(K-means clustering) 방식을 적용하여 상기 복수의 클러스터별로 분류하는사전학습과 전이학습을 이용한 수요 예측 장치."}
{"patent_id": "10-2023-0121050", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "청구항 4에 있어서,상기 복수의 전이학습부는,공개특허 10-2025-0038394-3-상기 인공신경망모델을 사전학습모델로 사용하되, 상기 복수의 클러스터별로 파인튜닝(fine-tuning)을 수행하는사전학습과 전이학습을 이용한 수요 예측 장치."}
{"patent_id": "10-2023-0121050", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "데이터입력부에서 수요 예측을 위한 수요예측데이터셋을 입력시키는 단계;기반모델학습부에서 상기 입력된 수요예측데이터셋을 이용하여 인공신경망모델을 학습시키는 단계;클러스터분류부에서 상기 수요예측데이터셋을 SHAP값(SHapley Additive exPlanations value)을 이용하여 복수의 클러스터별로 분류하는 단계; 및복수의 전이학습부에서 상기 복수의 클러스터별로 상기 인공신경망모델에 각각 입력시켜 전이학습(Transferlearning)을 통해 각 가중치를 재학습시키는 단계;를 포함하는 사전학습과 전이학습을 이용한 수요 예측 방법."}
{"patent_id": "10-2023-0121050", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "청구항 6에 있어서,상기 인공신경망모델은,MLP(Multi-Layer Perceptron) 모델 또는 FFNN(Feed Forward Neural Network) 모델을 포함하는사전학습과 전이학습을 이용한 수요 예측 방법."}
{"patent_id": "10-2023-0121050", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "청구항 7에 있어서,상기 복수의 클러스터별로 분류하는 단계는,상기 클러스터분류부에서 상기 수요예측데이터셋의 각 데이터에 대한 상기 SHAP값에 대응하는 변수들의 영향력에 따라 클러스터링하여 분류하는사전학습과 전이학습을 이용한 수요 예측 방법."}
{"patent_id": "10-2023-0121050", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "청구항 8에 있어서,상기 복수의 클러스터별로 분류하는 단계는,상기 클러스터분류부에서 상기 SHAP값을 이용하여 클러스터링하되, 상기 수요예측데이터셋을 K-평균 클러스터링(K-means clustering) 방식을 적용하여 상기 복수의 클러스터별로 분류하는사전학습과 전이학습을 이용한 수요 예측 방법."}
{"patent_id": "10-2023-0121050", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "청구항 9에 있어서,상기 각 가중치를 재학습시키는 단계는,상기 복수의 전이학습부에서 상기 인공신경망모델을 사전학습모델로 사용하되, 상기 복수의 클러스터별로 파인공개특허 10-2025-0038394-4-튜닝(fine-tuning)을 수행하는사전학습과 전이학습을 이용한 수요 예측 방법."}
{"patent_id": "10-2023-0121050", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 사전학습과 전이학습을 이용한 수요 예측 장치 및 그 방법에 관한 것으로, 수요 예측을 위한 수요예측 데이터셋을 입력시키는 데이터입력부; 상기 입력된 수요예측데이터셋을 이용하여 인공신경망모델을 학습시키는 기반모델학습부; 상기 수요예측데이터셋을 SHAP값(SHapley Additive exPlanations value)을 이용하여 복수의 클 러스터별로 분류하는 클러스터분류부; 및 상기 복수의 클러스터별로 상기 인공신경망모델에 각각 입력시켜 전이 학습(Transfer learning)을 통해 각 가중치를 재학습시키는 복수의 전이학습부;를 포함함으로써, 시계열데이터를 통해 나타내는 수요 패턴의 다양성을 만족시킬 수 있도록 최적의 수요 예측 기법을 제공할 수 있다."}
{"patent_id": "10-2023-0121050", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 입력변수들의 영향력이 비슷한 품목을 클러스터링 후, 클러스터별로 예측 모델을 산출하여 품목별 특 성을 반영하는 모델링 프레임워크를 제공함으로써, 시계열데이터를 통해 나타내는 수요 패턴의 다양성을 만족시 킬 수 있도록 최적의 수요 예측 기법을 제공할 수 있는 사전학습과 전이학습을 이용한 수요 예측 장치 및 그 방 법에 관한 것이다."}
{"patent_id": "10-2023-0121050", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "잘 알려진 바와 같이, 기업은 안전재고를 유지함으로써, 여러 불확실한 요인에 대처할 수 있는데, 적절한 수요 예측을 통한 안전재고의 유지는 기업의 비용절감 및 서비스수준의 향상으로 이어질 수 있다. 이에 따라, 다양한 산업 환경에서 수요 예측모델을 도입하고 있는데, 예를 들면, 과거의 기록을 수집하고 패턴 을 분석하여 미래를 예측하도록 고안된 ARIMA(Auto-Regressive Integrated Moving Average) 모델, 슬라이딩 윈 도우(Sliding window) 방식을 사용한 선형 회귀(Linear regression) 등과 같은 선형 모델, 랜덤 포레스트 (Random forest) 등과 같은 앙상블 모델들이 수요 예측을 위해 오랫동안 널리 사용되고 있다. 최근에는 RNN(Recurrent Neural Network) 계열의 인공신경망을 통한 시계열데이터 예측 연구도 활발하게 진행되 고 있는데, 이들 모델은 기존 전통적인 모델들보다 더 높은 정확도를 제공할 수 있는 것으로 판단되어 시계열데 이터 분석 분야에서 높은 관심을 받고 있다. 하지만, 상술한 바와 같이 시계열데이터를 통해 나타내는 수요 패턴의 다양성으로 인해 일반적으로 적용할 수 있는 최적의 수요 예측 기법을 제공하는데 어려움이 있으며, 최적의 수요 예측 기법에 대한 연구가 지속적으로 진행되고 있는 실정이다. 선행기술문헌 특허문헌 (특허문헌 0001) 1. 한국등록특허 제10-2050855호(2019.11.26.등록)"}
{"patent_id": "10-2023-0121050", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은 입력변수들의 영향력이 비슷한 품목을 클러스터링 후, 클러스터별로 예측 모델을 산출하여 품목별 특 성을 반영하는 모델링 프레임워크를 제공함으로써, 시계열데이터를 통해 나타내는 수요 패턴의 다양성을 만족시 킬 수 있도록 최적의 수요 예측 기법을 제공할 수 있는 사전학습과 전이학습을 이용한 수요 예측 장치 및 그 방 법을 제공하고자 한다. 또한, 본 발명은 품목별 수요를 예측하기 위해 MLP(Multi-Layer Perceptron) 또는 FFNN(Feed Forward Neural Network)를 포함하는 인공신경망 모델을 사용하고, SHAP값(SHapley Additive exPlanations value)을 활용해 모 델의 입력변수별 영향력의 크기가 비슷한 품목들로 분류한 후, 클러스터별 모델을 생성하되, 전체 품목을 대상 으로 학습한 단일 모델을 사전학습모델(pre-trained model)로 활용하고, 클러스터별 전이학습(transfer learning)을 적용하여, 최종 모델을 산출함으로써, 클러스터에 따라 발생하는 데이터 부족으로 인한 과소적합 문제를 효과적으로 해결할 수 있는 사전학습과 전이학습을 이용한 수요 예측 장치 및 그 방법을 제공하고자 한 다. 본 발명의 실시예들의 목적은 이상에서 언급한 목적으로 제한되지 않으며, 언급되지 않은 또 다른 목적들은 아 래의 기재로부터 본 발명이 속하는 기술 분야에서 통상의 지식을 가진 자에게 명확하게 이해될 수 있을 것이다."}
{"patent_id": "10-2023-0121050", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명의 일 측면에 따르면, 수요 예측을 위한 수요예측데이터셋을 입력시키는 데이터입력부; 상기 입력된 수 요예측데이터셋을 이용하여 인공신경망모델을 학습시키는 기반모델학습부; 상기 수요예측데이터셋을 SHAP값 (SHapley Additive exPlanations value)을 이용하여 복수의 클러스터별로 분류하는 클러스터분류부; 및 상기 복수의 클러스터별로 상기 인공신경망모델에 각각 입력시켜 전이학습(Transfer learning)을 통해 각 가중치를 재학습시키는 복수의 전이학습부;를 포함하는 사전학습과 전이학습을 이용한 수요 예측 장치가 제공될 수 있다. 또한, 본 발명의 일 측면에 따르면, 상기 인공신경망모델은, MLP(Multi-Layer Perceptron) 모델 또는 FFNN(Feed Forward Neural Network) 모델을 포함하는 사전학습과 전이학습을 이용한 수요 예측 장치가 제공될 수 있다. 또한, 본 발명의 일 측면에 따르면, 상기 클러스터분류부는, 상기 수요예측데이터셋의 각 데이터에 대한 상기 SHAP값에 대응하는 변수들의 영향력에 따라 클러스터링하여 분류하는 사전학습과 전이학습을 이용한 수요 예측 장치가 제공될 수 있다. 또한, 본 발명의 일 측면에 따르면, 상기 클러스터분류부는, 상기 SHAP값을 이용하여 클러스터링하되, 상기 수 요예측데이터셋을 K-평균 클러스터링(K-means clustering) 방식을 적용하여 상기 복수의 클러스터별로 분류하는 사전학습과 전이학습을 이용한 수요 예측 장치가 제공될 수 있다. 또한, 본 발명의 일 측면에 따르면, 상기 복수의 전이학습부는, 상기 인공신경망모델을 사전학습모델로 사용하 되, 상기 복수의 클러스터별로 파인튜닝(fine-tuning)을 수행하는 사전학습과 전이학습을 이용한 수요 예측 장 치가 제공될 수 있다. 본 발명의 다른 측면에 따르면, 데이터입력부에서 수요 예측을 위한 수요예측데이터셋을 입력시키는 단계; 기반 모델학습부에서 상기 입력된 수요예측데이터셋을 이용하여 인공신경망모델을 학습시키는 단계; 클러스터분류부 에서 상기 수요예측데이터셋을 SHAP값(SHapley Additive exPlanations value)을 이용하여 복수의 클러스터별로 분류하는 단계; 및 복수의 전이학습부에서 상기 복수의 클러스터별로 상기 인공신경망모델에 각각 입력시켜 전 이학습(Transfer learning)을 통해 각 가중치를 재학습시키는 단계;를 포함하는 사전학습과 전이학습을 이용한 수요 예측 방법이 제공될 수 있다. 또한, 본 발명의 다른 측면에 따르면, 상기 인공신경망모델은, MLP(Multi-Layer Perceptron) 모델 또는 FFNN(Feed Forward Neural Network) 모델을 포함하는 사전학습과 전이학습을 이용한 수요 예측 방법이 제공될 수 있다. 또한, 본 발명의 다른 측면에 따르면, 상기 복수의 클러스터별로 분류하는 단계는, 상기 클러스터분류부에서 상 기 수요예측데이터셋의 각 데이터에 대한 상기 SHAP값에 대응하는 변수들의 영향력에 따라 클러스터링하여 분류 하는 사전학습과 전이학습을 이용한 수요 예측 방법이 제공될 수 있다. 또한, 본 발명의 다른 측면에 따르면, 상기 복수의 클러스터별로 분류하는 단계는, 상기 클러스터분류부에서 상 기 SHAP값을 이용하여 클러스터링하되, 상기 수요예측데이터셋을 K-평균 클러스터링(K-means clustering) 방식 을 적용하여 상기 복수의 클러스터별로 분류하는 사전학습과 전이학습을 이용한 수요 예측 방법이 제공될 수 있 다. 또한, 본 발명의 다른 측면에 따르면, 상기 각 가중치를 재학습시키는 단계는, 상기 복수의 전이학습부에서 상 기 인공신경망모델을 사전학습모델로 사용하되, 상기 복수의 클러스터별로 파인튜닝(fine-tuning)을 수행하는 사전학습과 전이학습을 이용한 수요 예측 방법이 제공될 수 있다."}
{"patent_id": "10-2023-0121050", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명은 입력변수들의 영향력이 비슷한 품목을 클러스터링 후, 클러스터별로 예측 모델을 산출하여 품목별 특 성을 반영하는 모델링 프레임워크를 제공함으로써, 시계열데이터를 통해 나타내는 수요 패턴의 다양성을 만족시 킬 수 있도록 최적의 수요 예측 기법을 제공할 수 있다. 또한, 본 발명은 품목별 수요를 예측하기 위해 MLP 또는 FFNN를 포함하는 인공신망 모델을 사용하고, SHAP값을 활용해 모델의 입력변수별 영향력의 크기가 비슷한 품목들로 분류한 후, 클러스터별 모델을 생성하되, 전체 품 목을 대상으로 학습한 단일 모델을 사전학습모델로 활용하고, 클러스터별 전이학습을 적용하여, 최종 모델을 산출함으로써, 클러스터에 따라 발생하는 데이터 부족으로 인한 과소적합 문제를 효과적으로 해결할 수 있다."}
{"patent_id": "10-2023-0121050", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "본 발명의 실시예들에 대한 이점 및 특징, 그리고 그것들을 달성하는 방법은 첨부되는 도면과 함께 상세하게 후 술되어 있는 실시예들을 참조하면 명확해질 것이다. 그러나 본 발명은 이하에서 개시되는 실시예들에 한정되는 것이 아니라 서로 다른 다양한 형태로 구현될 수 있으며, 단지 본 실시예들은 본 발명의 개시가 완전하도록 하"}
{"patent_id": "10-2023-0121050", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "고, 본 발명이 속하는 기술분야에서 통상의 지식을 가진 자에게 발명의 범주를 완전하게 알려주기 위해 제공되 는 것이며, 본 발명은 청구항의 범주에 의해 정의될 뿐이다. 명세서 전체에 걸쳐 동일 참조 부호는 동일 구성 요소를 지칭한다. 본 발명의 실시예들을 설명함에 있어서 공지 기능 또는 구성에 대한 구체적인 설명이 본 발명의 요지를 불필요 하게 흐릴 수 있다고 판단되는 경우에는 그 상세한 설명을 생략할 것이다. 그리고 후술되는 용어들은 본 발명의 실시예에서의 기능을 고려하여 정의된 용어들로서 이는 사용자, 운용자의 의도 또는 관례 등에 따라 달라질 수 있다. 그러므로 그 정의는 본 명세서 전반에 걸친 내용을 토대로 내려져야 할 것이다. 이하, 첨부된 도면을 참조하여 본 발명의 실시예를 상세히 설명하기로 한다. 도 1은 본 발명의 일 실시예에 따른 사전학습과 전이학습을 이용한 수요 예측 장치의 블록구성도이고, 도 2 내 지 도 4는 본 발명의 일 실시예에 따른 사전학습과 전이학습을 이용한 수요 예측 장치의 상세구성을 설명하기 위한 도면이다. 도 1 내지 도 4를 참조하면, 본 발명의 일 실시예에 따른 사전학습과 전이학습을 이용한 수요 예측 장치는 데이 터입력부, 기반모델학습부, 클러스터분류부, 복수의 전이학습부 등을 포함할 수 있다. 데이터입력부는 수요 예측을 위한 수요예측데이터셋을 입력시키는 구성부로, 도 2에 도시한 바와 같이 수 요(즉, 출고량)를 예측하기 위해 판매 및 재고와 관련된 데이터셋을 수요예측데이터셋(Total data)으로 입력시 킬 수 있다. 예를 들면, 수요예측데이터셋은 판매 및 재고 데이터셋을 사용하되, 품목별 가격, 한달마다의 출고량, 수입여부 등의 정보를 포함할 수 있고, 모든 품목 중에서 데이터 수집 전체 기간(예를 들면, 53개월 등)의 정보를 모두 포함하는 품목(예를 들면, 541개의 품목)에 대응하는 데이터셋을 사용할 수 있다. 또한, 수요를 예측하고자 하는 타겟은 안전재고 분량인 기 설정된 기간(예를 들면, 4개월 등)의 출고량으로, 수 요 예측을 수행하는 해당 월을 기준으로 3달 전부터 현재 월의 출고량을 합산한 변수(MOVING_SUM)를 사용할 수 있고, 해당 변수의 예측을 위해 지난 1년 간의 출고량 합산 변수(MOVING_SUM)의 변화를 입력변수로 활용할 수 있다. 그리고, 해당 월의 출고량 합산 변수(MOVING_SUM)를 예측하기 위한 입력변수로, 1개월 전부터 12개월 전까지의 출고량 합산 변수(MOVING_SUM)와, 각각 2, 3, 6, 12개월 전까지의 평균 출고량 합산 변수(MOVING_SUM), 마지막 으로 해당 월 전까지의 출고량 합산 변수(MOVING_SUM)의 누적 평균 등 총 17가지의 변수를 사용할 수 있다. 예를 들면, 2018.8월에서 2022.12월까지의 데이터 중 출고량 합산 변수(MOVING_SUM)를 계산할 수 있는 기간은 2018.10월에서 2022.11월까지 총 50개월이며, 입력변수를 사용하기 위해 타겟변수로부터 최소 1년 전부터의 기 간을 사용함으로써, 타겟변수로 사용할 수 있는 기간은 2019.10월에서 2022.11월까지 총 38개월이기 때문에, 데 이터 전처리 후에, 품목별로 38개의 인스턴스(instance), 즉 총 20558개가 확보되어 수요예측 데이터셋으로 입 력될 수 있다. 여기에서, 품목별 출고량 합산 변수(MOVING_SUM)의 평균값은 0.1-100000 사이로, 품목별로 척도의 차이가 매우 크게 나타날 수 있다. 기반모델학습부는 입력된 수요예측데이터셋을 이용하여 인공신경망모델을 학습시키는 구성부로, 도 2에 도 시한 바와 같이 인공신경망모델은 예를 들면, MLP(Multi-Layer Perceptron) 모델 또는 FFNN(Feed Forward Neural Network) 모델을 포함할 수 있다. 여기에서, MLP는 입력층, 은닉층 및 출력층으로 구성되고, 각 은닉층의 개수와 뉴런 수는 사용자가 필요에 따라 설정 및 구성할 수 있으며, 은닉층의 뉴런들은 각각 가주치와 편향값을 가지고 있고, 이를 통해 입력값의 선형 결합을 계산한 후, 비선형 활성화함수(예를 들면, 시그모이드, 렐루(ReLU), 하이퍼볼릭탄젠트 등)를 거쳐 출력 값을 계산하는 방식으로 수요예측데이터셋을 이용한 기반모델학습을 수행할 수 있다. 또한, FFNN은 MLP와 유사한 과정으로 수요예측데이터셋을 이용한 기반모델학습을 수행할 수 있는데, 처리되는 정보는 한 방향으로만 전달되되, 입력층에서 출력층으로 데이터가 전달될 수 있고, 은닉층은 이러한 전달 과정 중에 중간 계산을 수행할 수 있다. 한편, 인공신경망모델의 학습 및 평가에는 손실함수를 사용하여 실제값과 모델 예측값 간의 차이를 측정한 후 그 차이를 최소화할 수 있는데, 역전파(back propagation)알고리즘을 사용하여 손실함수의 그래디언트를 계산하 고, 모델의 가중치 및 편향을 조정하여 손실을 감소시킬 수 있으며, 회귀 문제에서 주로 사용하는 함수인 MSE(Mean Squared Error) 사용 시 출고량의 단위가 큰 품목들의 영향력이 과하게 커지는 단점이 있기 때문에, 실제값과 예측값 간의 백분율 오차를 평균화한 값으로 나타내는 MAPE(Mean Absolute Percentage Error)를 사용 할 수 있다. 상술한 바와 같은 기반모델학습부는 수요예측데이터셋을 이용한 기반모델학습을 수행한 후에, 이 인공신경 망모델을 사전학습모델(Pre-training model)로서 복수의 전이학습부로 각각 제공할 수 있다. 클러스터분류부는 수요예측데이터셋을 SHAP값(SHapley Additive exPlanations value)을 이용하여 복수의 클러스터별로 분류하는 구성부로, SHAP값은 머신러닝 모델에서 각각의 특징(Feature)이 예측값에 어떤 영향을 미치는지 설명하기 위한 값이며, 의사결정 메커니즘이 유사한 품목별로 모델을 예측할 수 있도록 입력변수들의 SHAP값을 이용하여 데이터입력부로부터 제공되는 수요예측데이터셋을 변수들의 영향력이 비슷한 품목별로 클러스터링할 수 있다. 이러한 클러스터분류부는 도 2에 도시한 바와 같이 수요예측데이터셋의 각 데이터에 대한 SHAP값에 대응하 는 변수들의 영향력에 따라 클러스터링하여 분류할 수 있다. 또한, 클러스터분류부는 SHAP값을 이용하여 클러스터링하되, 수요예측데이터셋을 K-평균 클러스터링(K- means clustering) 방식을 적용하여 복수의 클러스터별로 분류할 수 있다. 예를 들면, 클러스터분류부는 수요예측데이터셋의 전체 품목에 대해 산출된 인공신경망모델인 MLP 모델을 활용하여 총 20558개의 인스턴스로, SHAP값을 산출할 수 있는데, 17개 입력변수들의 SHAP값을 활용하여 클러스 터링을 수행하되, 산출된 SHAP값에 절대값을 취하고, 품목별 평균을 계산하여 품목별 SHAP값 평균벡터를 구한 후, K-평균 클러스터링 알고리즘을 통해 품목들을 총 4개의 클러스터로 분류할 수 있다. 여기에서, K-평균 클러스터링 알고리즘에서는 데이터 내의 패턴을 찾고, 비슷한 특성을 갖는 데이터들을 동일한 그룹 또는 클러스터로 분류할 수 있는데, 클러스터 개수인 K를 결정하고, K개의 클러스터 중심을 무작위로 초기 화하며, 각각의 데이터를 유클리드거리 등을 기반으로 가장 가까운 클러스터 중심으로 할당하고, 각 클러스터에 속한 데이터 포인트들의 평균을 계산하여 새로운 클러스터 중심으로 업데이트하는 방식으로 복수의 데이터를 효 과적으로 분류할 수 있다. 또한, K-평균 클러스터링 알고리즘에서 클러스터 개수인 K를 결정하는데 엘보우(elbow) 기법을 사용할 수 있는 데, 이는 클러스터 개수 K를 선택하고, K값의 후보집합을 준비한 후에, 각 K값에 대해 K-평균 클러스터링을 수 행하며, 클러스터링 결과에 대해 적합도(또는 비용함수값)를 산출할 수 있고, 이 비용함수값은 각 데이터 포인 트와 해당 클러스터 중심 간의 거리합계인 이너시아(Inertia) 또는 왜곡(Distortion)으로 계산될 수 있다. 이 후, 각 K값에 대한 이너시아값을 그래프로 그린 후, 그 그래프가 팔꿈치(elbow)처럼 꺾이는 지점을 검출하는 방식으로 클러스터 개수인 K를 선택할 수 있다. 여기에서, 엘보우 지점이 비용함수값이 급격하게 감소하는 지점 으로 최적의 클러스터 개수로 간주될 수 있다. 복수의 전이학습부는 복수의 클러스터별로 인공신경망모델에 각각 입력시켜 전이학습(Transfer learning) 을 통해 각 가중치를 재학습시키는 구성부로, 도 2에 도시한 바와 같이 인공신경망모델을 사전학습모델로 사용 하되, 복수의 클러스터별로 파인튜닝(fine-tuning)을 수행할 수 있다. 이러한 복수의 전이학습부는 전체 품목을 수요예측데이터셋을 이용하여 학습한 인공신경망모델을 사전학습 모델로 사용할 수 있고, 복수의 클러스터별로 전이학습의 파인튜닝을 통해 전체 레이어에 적용하여 가중치를 재 학습할 수 있다. 예를 들면, 복수의 전이학습부는 수요예측데이터셋을 이용한 학습을 통해 전체 품목을 예측하도록 구축된 단일모델은 다양한 품목의 특성들을 전부 반영하기에 어려움이 있기 때문에, 전이학습을 통해 이미 학습된 단일 모델의 일부 또는 전체를 새로운 문제를 해결하는데 사용할 수 있고, 파인튜닝을 통해 사전학습모델(즉, 단일모 델)을 복수의 클러스터별로 SHAP값을 반영하여 일부 또는 전체 레이어를 재학습할 수 있다. 이 때, 복수의 전이학습부는 사전학습모델로 MLP 모델을 이용하여 분류된 복수의 클러스터별로 파인튜닝하 는 방식으로 각 SHAP값에 대응하는 가중치를 반영하여 재학습을 수행함으로써, 클러스터링에 따라 발생하는 데 이터 부족으로 인한 과소적합 문제를 효과적으로 해결할 수 있다. 상술한 바와 같은 과정을 통해 복수의 전이학습부는 도 2에 도시한 바와 같이 최종 수요예측모델(Model 1- Model k)을 생성할 수 있다. 상술한 바와 같은 본 발명의 일 실시예에 따른 사전학습과 전이학습을 이용한 수요 예측 장치를 구현하고, 실제 데이터를 이용하여 수요 예측한 시뮬레이션과 그 결과에 대해 설명하기로 한다. 먼저, 수요예측데이터셋을 이용하여 학습할 인공지능모델로서 MLP 모델을 사용할 수 있는데, MLP 모델은 파이썬 의 PyTorch 라이브러리를 사용하여 구현하였으며, Optuna를 통하여 최적 하이퍼파라미터를 선정하였다. 그 범위는 각 은닉층(Hidden Layer)의 노드 개수는 [30,150], 학습율(learning_rate)은 [1e-5,1e-1], 가중치 감쇠(weight_decay)는 [1e-5,1e-1], 드롭아웃(drop_out)은 [5e-2,5e-1]로 설정하였고, MAPE 기준 최적의 하이 퍼파라미터 값인 노드 개수는 [71,119], 학습율은 0.0003, 가중치 감쇠는 0.01, 드롭아웃은 0.06으로, 에포크 (epoch)는 100, 옵티마이저는 AdamW를 사용하여 학습을 진행하였다. 여기에서, 손실 함수(Loss function)로는 회귀 문제에서 주로 사용하는 함수인 MSE 사용할 경우 출고량의 단위 가 큰 품목들의 영향력이 과하게 커지는 단점이 있어 MAPE를 사용하였다. 한편, 평가 방법에서는 시계열 데이터의 교차 검증(Cross-validation)을 수행하기 위해서 도 3에 도시한 바와 같은 방식으로 데이터를 분리하였고, 테스트 데이터셋(Test set)은 4개월 단위로 구성하였으며, 5-폴드 교차검 증으로 2021.4월에서 2022.11월까지 총 20개우러을 테스트 데이터셋으로 사용하였다. 그리고, 평가 지표로는 RMSE(Root Mean Squared Error), MAPE, MAE, R-squared 등을 사용하였고, 베이스라인으 로 단순 한달전의 타겟변수를 예측값으로 한 경우와, 트리 기반의 랜덤포레스트 모델을 사용하여 성능을 비교하 였다. 상술한 바와 같은 시뮬레이션을 수행한 결과에 대해 설명하면, 아래의 표 1에는 품목 전체의 예측 결과인 5-폴 드의 각 평가지표별 평균과 표준편차를 나타내고 있다. 표 1"}
{"patent_id": "10-2023-0121050", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "이러한 표 1을 참조하면, RMSE, MAPE, MAE 및 R-squared의 모든 지표에서 전이학습 모델의 성능이 가장 우수하 였음을 확인할 수 있다. 또한, 품목 전체의 결과 외에도 개별 품목 예측 성능의 비교를 위해 MLP와 전이학습 모델에서 품목별로 MAPE와 RMSE를 계산하였는데, 전이학습 후의 RMSE가 20 % 이상 감소한 품목은 541개 중 14개이고, 전이학습 후의 RMSE가 클러스터링 이전의 RMSE보다 20 % 이상 증가한 품목은 없었음을 확인할 수 있으며, 전이학습 후의 MAPE가 20 % 이상 감소, 증가한 품목은 각각 18개, 2개로 품목별로도 예측 성능의 향상을 확인할 수 있었고, 도 4에 도시 한 바와 같이 전이학습 후의 예측에서 주기성이 강한 품목의 예측 성능이 크게 향상되었음을 확인할 수 있다. 상술한 바와 같은 시뮬레이션 결과를 분석해 보면, 5-폴드 교차 검증의 평균에서는 모든 평가지표에서 전이학습 된 모델이 가장 좋은 성능을 나타내고 있고, 그 뒤로 MLP, 1달 전, 랜덤포레스트 순으로 예측이 잘 되었음을 확 인할 수 있다. 여기에서, 트리 기반의 앙상블 모델인 랜덤포레스트 모델이 단순히 한달 전의 값을 사용한 예측보다 좋지 않은 성능을 보이는 것은 사용된 입력변수 간 강한 상관관계가 있기 때문으로 판단될 수 있다. 그리고, 전체 품목 예측의 평균뿐만 아니라, 품목별 예측에서도 제안하는 전이학습 기법을 적용한 모델이 MLP 단일 모델보다 더 나은 성능을 나타내고 있음을 확인할 수 있는데, 이는 의사결정 메커니즘이 비슷한 항목별로 클러스터링하여 하나의 모델이 아닌 여러 개의 모델로 표현되어 개별 특성이 더 잘 반영되었음을 알 수 있다. 한편, 전이학습 기법을 사용하지 않고 각 클러스터별로 MLP 모델을 학습할 경우 그 결과는 RMSE가 266.93± 58.94, MAPE가 13.65±0.94fh 나타나 단일 모델보다 오히려 성능이 하락하거나 미미하게 증가하고 있는데, k개 의 클러스터별 모델을 적용할 경우 학습데이터는 산술적으로 1/k개로 감소하기 때문에, 전이학습이 아닌 클러스 터별 MLP 모델 학습 시 학습데이터 부족으로 과소적합 현상이 발생하는 문제가 있으며, 본 발명의 실시예에 따 른 수요 예측 기법을 통해 이를 효과적으로 해결할 수 있음을 확인할 수 있다. 따라서, 본 발명의 일 실시예에 따르면, 입력변수들의 영향력이 비슷한 품목을 클러스터링 후, 클러스터별로 예 측 모델을 산출하여 품목별 특성을 반영하는 모델링 프레임워크를 제공함으로써, 시계열데이터를 통해 나타내는 수요 패턴의 다양성을 만족시킬 수 있도록 최적의 수요 예측 기법을 제공할 수 있다. 또한, 본 발명의 일 실시예에 따르면, 품목별 수요를 예측하기 위해 MLP 또는 FFNN를 포함하는 인공신경망 모델 을 사용하고, SHAP값을 활용해 모델의 입력변수별 영향력의 크기가 비슷한 품목들로 분류한 후, 클러스터별 모 델을 생성하되, 전체 품목을 대상으로 학습한 단일 모델을 사전학습모델로 활용하고, 클러스터별 전이학습을 적 용하여, 최종 모델을 산출함으로써, 클러스터에 따라 발생하는 데이터 부족으로 인한 과소적합 문제를 효과적으 로 해결할 수 있다. 도 5는 본 발명의 다른 실시예에 따라 사전학습과 전이학습을 이용하여 수요를 예측하는 과정을 나타낸 플로우 차트이다. 도 5를 참조하면, 데이터입력부에서 수요 예측을 위한 수요예측데이터셋을 입력시킬 수 있다(단계210). 여기에서, 데이터입력부에서는 수요(즉, 출고량)를 예측하기 위해 판매 및 재고와 관련된 데이터셋을 수요 예측데이터셋으로 입력시킬 수 있는데, 수요예측데이터셋은 판매 및 재고 데이터셋을 사용하되, 품목별 가격, 한달마다의 출고량, 수입여부 등의 정보를 포함할 수 있고, 모든 품목 중에서 데이터 수집 전체 기간(예를 들면, 53개월 등)의 정보를 모두 포함하는 품목(예를 들면, 541개의 품목)에 대응하는 데이터셋을 사용할 수 있 다. 또한, 수요를 예측하고자 하는 타겟은 안전재고 분량인 기 설정된 기간(예를 들면, 4개월 등)의 출고량으로, 수 요 예측을 수행하는 해당 월을 기준으로 3달 전부터 현재 월의 출고량을 합산한 변수(MOVING_SUM)를 사용할 수 있고, 해당 변수의 예측을 위해 지난 1년 간의 출고량 합산 변수(MOVING_SUM)의 변화를 입력변수로 활용할 수 있다. 그리고, 해당 월의 출고량 합산 변수(MOVING_SUM)를 예측하기 위한 입력변수로, 1개월 전부터 12개월 전까지의 출고량 합산 변수(MOVING_SUM)와, 각각 2, 3, 6, 12개월 전까지의 평균 출고량 합산 변수(MOVING_SUM), 마지막 으로 해당 월 전까지의 출고량 합산 변수(MOVING_SUM)의 누적 평균 등 총 17가지의 변수를 사용할 수 있다. 그리고, 기반모델학습부에서 데이터입력부를 통해 입력된 수요예측데이터셋을 이용하여 인공신경망모 델을 학습시킬 수 있다(단계220). 여기에서, 인공신경망모델은 예를 들면, MLP 모델 또는 FFNN 모델을 포함할 수 있는데, MLP는 입력층, 은닉층 및 출력층으로 구성되고, 각 은닉층의 개수와 뉴런 수는 사용자가 필요에 따라 설정 및 구성할 수 있으며, 은닉 층의 뉴런들은 각각 가주치와 편향값을 가지고 있고, 이를 통해 입력값의 선형결합을 계산한 후, 비선형 활성화 함수(예를 들면, 시그모이드, 렐루(ReLU), 하이퍼볼릭탄젠트 등)를 거쳐 출력값을 계산하는 방식으로 수요예측데이터셋을 이용한 기반모델학습을 수행할 수 있다. 또한, FFNN은 MLP와 유사한 과정으로 수요예측데이터셋을 이용한 기반모델학습을 수행할 수 있는데, 처리되는 정보는 한 방향으로만 전달되되, 입력층에서 출력층으로 데이터가 전달될 수 있고, 은닉층은 이러한 전달 과정 중에 중간 계산을 수행할 수 있다. 한편, 인공신경망모델의 학습 및 평가에는 손실함수를 사용하여 실제값과 모델 예측값 간의 차이를 측정한 후 그 차이를 최소화할 수 있는데, 역전파알고리즘을 사용하여 손실함수의 그래디언트를 계산하고, 모델의 가중치 및 편향을 조정하여 손실을 감소시킬 수 있으며, 회귀 문제에서 주로 사용하는 함수인 MSE 사용 시 출고량의 단 위가 큰 품목들의 영향력이 과하게 커지는 단점이 있기 때문에, 실제값과 예측값 간의 백분율 오차를 평균화한 값으로 나타내는 MAPE를 사용할 수 있다. 상술한 바와 같은 기반모델학습부에서는 수요예측데이터셋을 이용한 기반모델학습을 수행한 후에, 이 인공 신경망모델을 사전학습모델로서 복수의 전이학습부로 각각 제공할 수 있다. 다음에, 클러스터분류부에서 데이터입력부를 통해 입력된 수요예측데이터셋을 SHAP값을 이용하여 복 수의 클러스터별로 분류할 수 있다(단계230). 이러한 복수의 클러스터별로 분류하는 단계에서는, 클러스터분류부에서 수요예측데이터셋의 각 데이 터에 대한 SHAP값에 대응하는 변수들의 영향력에 따라 클러스터링하여 분류할 수 있다. 또한, 복수의 클러스터별로 분류하는 단계에서는, 클러스터분류부에서 SHAP값을 이용하여 클러스터링 하되, 수요예측데이터셋을 K-평균 클러스터링 방식을 적용하여 복수의 클러스터별로 분류할 수 있다. 예를 들면, 클러스터분류부에서는 의사결정 메커니즘이 유사한 품목별로 모델을 예측할 수 있도록 입력변 수들의 SHAP값을 이용하여 데이터입력부로부터 제공되는 수요예측데이터셋을 변수들의 영향력이 비슷한 품 목별로 클러스터링할 수 있다. 또한, 클러스터분류부에서는 SHAP값을 이용하여 클러스터링하되, 수요예측데이터셋을 K-평균 클러스터링 방식을 적용하여 복수의 클러스터별로 분류할 수 있는데, 17개 입력변수들의 SHAP값을 활용하여 클러스터링을 수행하되, 산출된 SHAP값에 절대값을 취하고, 품목별 평균을 계산하여 품목별 SHAP값 평균벡터를 구한 후, K-평 균 클러스터링 알고리즘을 통해 품목들을 총 4개의 클러스터로 분류할 수 있다. 여기에서, K-평균 클러스터링 알고리즘과, 클러스터 개수인 K를 결정하는데 사용되는 엘보우 기법 등에 대해서 는 본 발명의 일 실시예에서 상세하게 기재하였으므로 여기서는 생략하기로 한다. 다음에, 복수의 전이학습부에서 복수의 클러스터별로 인공신경망모델에 각각 입력시켜 전이학습(Transfer learning)을 통해 각 가중치를 재학습시킬 수 있다(단계240). 이러한 각 가중치를 재학습시키는 단계에서는, 복수의 전이학습부에서 인공신경망모델을 사전학습모 델로 사용하되, 복수의 클러스터별로 파인튜닝을 수행할 수 있다. 예를 들면, 복수의 전이학습부에서는 전체 품목을 수요예측데이터셋을 이용하여 학습한 인공신경망모델을 사전학습모델로 사용할 수 있고, 복수의 클러스터별로 전이학습의 파인튜닝을 통해 전체 레이어에 적용하여 가 중치를 재학습할 수 있다. 이 때, 복수의 전이학습부에서는 사전학습모델로 MLP 모델을 이용하여 분류된 복수의 클러스터별로 파인튜 닝하는 방식으로 각 SHAP값에 대응하는 가중치를 반영하여 재학습을 수행함으로써, 클러스터링에 따라 발생하는 데이터 부족으로 인한 과소적합 문제를 효과적으로 해결할 수 있다. 상술한 바와 같은 과정을 통해 복수의 전이학습부에서는 최종 수요예측모델(Model 1-Model k)을 생성할 수 있다. 따라서, 본 발명의 다른 실시예에 따르면, 입력변수들의 영향력이 비슷한 품목을 클러스터링 후, 클러스터별로 예측 모델을 산출하여 품목별 특성을 반영하는 모델링 프레임워크를 제공함으로써, 시계열데이터를 통해 나타내 는 수요 패턴의 다양성을 만족시킬 수 있도록 최적의 수요 예측 기법을 제공할 수 있다. 또한, 본 발명의 다른 실시예에 따르면, 품목별 수요를 예측하기 위해 MLP 또는 FFNN를 포함하는 인공신경망 모 델을 사용하고, SHAP값을 활용해 모델의 입력변수별 영향력의 크기가 비슷한 품목들로 분류한 후, 클러스터별 모델을 생성하되, 전체 품목을 대상으로 학습한 단일 모델을 사전학습모델로 활용하고, 클러스터별 전이학습을적용하여, 최종 모델을 산출함으로써, 클러스터에 따라 발생하는 데이터 부족으로 인한 과소적합 문제를 효과적 으로 해결할 수 있다. 이상의 설명에서는 본 발명의 다양한 실시예들을 제시하여 설명하였으나 본 발명이 반드시 이에 한정되는 것은"}
{"patent_id": "10-2023-0121050", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "아니며, 본 발명이 속하는 기술분야에서 통상의 지식을 가진 자라면 본 발명의 기술적 사상을 벗어나지 않는 범 위 내에서 여러 가지 치환, 변형 및 변경이 가능함을 쉽게 알 수 있을 것이다."}
{"patent_id": "10-2023-0121050", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 일 실시예에 따른 사전학습과 전이학습을 이용한 수요 예측 장치의 블록구성도이고, 도 2 내지 도 4는 본 발명의 일 실시예에 따른 사전학습과 전이학습을 이용한 수요 예측 장치의 상세구성을 설 명하기 위한 도면이며, 도 5는 본 발명의 다른 실시예에 따라 사전학습과 전이학습을 이용하여 수요를 예측하는 과정을 나타낸 플로우 차트이다."}
