{"patent_id": "10-2023-0112442", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2025-0031104", "출원번호": "10-2023-0112442", "발명의 명칭": "심층신경망에서 수치형 변수의 크기 정보를 보존하면서 범주형 변수로 변환하는 인코딩 방법", "출원인": "강태신", "발명자": "강태신"}}
{"patent_id": "10-2023-0112442", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "심층신경망에서 수치형 변수의 크기 정보를 보존하면서 범주형 변수로 변환하는 인코딩 방법 및 이를 이용하는시스템에 있어서,심층신경망이 학습하고 출력하고자 하는, 양적 정보를 가지는, 수치형 변수;유한한 개수의 범주를 가지는 범주형 변수;각각의 범주를 대표하는 실수(real number)인, 대푯값;상기 수치형 변수를 상기 범주형 변수로 변환할 때 기준이 되는, 밀도 함수;상기 대푯값과 상기 수치형 변수의 거리를 계산하고, 이 거리를 상기 밀도 함수에 입력하고, 상기 밀도 함수에서 출력된 양의 실수를 각각의 범주에 배정하여, 상기 수치형 변수를 상기 범주형 변수로 변환하는, 소프트 인코딩;을 포함하는상기 밀도 함수를 이용하여, 상기 수치형 변수의 크기 정보를 보존하면서 상기 범주형 변수로 변환하고, 상기범주형 변수와 교차 엔트로피를 이용하여 심층신경망을 학습시키는 것을 특징으로 하는 인코딩 방법 및 이를 이용하는 시스템."}
{"patent_id": "10-2023-0112442", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 밀도 함수는;정의역이 모든 실수이고, 치역이 양의 실수이며,0을 중심으로 종 모양의 분포를 하고 있어, 0에서 가장 큰 값을 출력하고 0에서 멀어질수록 작은 값을출력하며,모든 실수 범위에서의 적분값이 한 개의 실수로 수렴하는 것을 특징으로 하는,수치형 변수의 크기 정보를 보존하면서 범주형 변수로 변환하는 인코딩 방법 및 이를 이용하는 시스템."}
{"patent_id": "10-2023-0112442", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1항에 있어서,상기 범주형 변수는;심층신경망에서 출력된 결괏값에, 상응하는 상기 대푯값을 각각 곱하고, 전부 더한, 결괏값과 상기 대푯값의 내적을 생성하고, 이 내적을 상기 밀도 함수의 적분값으로 나누어 수치형 변수인 복원값을 생성할 수 있음을 특징으로 하는,수치형 변수의 크기 정보를 보존하면서 범주형 변수로 변환하는 인코딩 방법 및 이를 이용하는 시스템."}
{"patent_id": "10-2023-0112442", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 수치형 변수를 범주형 변수로 변환할 때 발생하는 원핫인코딩과 교차엔트로피의 문제점을 해결하기 위 하여 안출된 것으로서, 심층신경망에서 수치형 변수의 크기 정보를 보존하면서 범주형 변수로 변환하는 방법과, 심층신경망에서 생성된 범주형 변수를 다시 수치형 변수로 복원하는 방법, 그리고 이를 이용하는 시스템을 고안 (뒷면에 계속)"}
{"patent_id": "10-2023-0112442", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 심층신경망에서 수치형 변수(numerical variable)의 크기 정보(quantitative information)를 보존하 면서 범주형 변수(categorical variable)로 변환하는 인코딩 방법 및 이를 이용하는 시스템에 대한 것으로, 더 욱 상세하게는 확률 밀도 함수를 응용한 인코딩 방법으로, 수치형 변수를 범주형 변수로 변환할 때 발생하는 크 기 정보의 소실을 줄이고, 이 범주형 변수를 다시 수치형 변수로 복원할 수 있도록 하는 소프트 인코딩(soft encoding)과 이를 이용하는 시스템에 관한 것이다."}
{"patent_id": "10-2023-0112442", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "변수(variable)는 키, 몸무게와 같이 양적 정보를 가지고 있어 서로 크기를 비교할 수 있는 수치형 변수 (numerical variable)와 인종, 성별과 같이 양적 정보를 가지지 않은 범주형 변수(categorical variable)로 나 뉜다. 수치형 변수와 범주형 변수는 심층신경망(Deep neural network)에서 사용하는 손실함수(loss function)가 다르다. 전통적으로 수치형 변수에 대해서는 평균 제곱 오차(mean square error)를 주로 사용하며, 범주형 변수 에 대해서는 교차엔트로피(cross entropy)를 사용한다. 평균 제곱 오차는 출력값(output)과 라벨(label)의 사이 거리를 계산하고, 이 거리를 제곱하여 손실(loss)을 계산하는 방법이고, 교차엔트로피는 출력값과 라벨을 확률 로 간주하여 출력값과 라벨 사이의 확률 차이를 계산하는 방법이다. 두 방법 모두 그동안 심층신경망에서 훌륭 한 성능을 보여주었으나, 양적 정보를 가진 수치형 변수를 추론하는 데에 있어서 몇 가지 제한점이 남아 있었다. 평균 제곱 오차(mean square error)는 출력값과 라벨의 거리를 \"제곱\"하여 손실을 측정하기 때문에 발생하는 대 표적인 두 가지 제한점이 알려져 있다. 첫째로, 큰 오차는 \"제곱\"하게 되면 매우 큰 오차가 된다. 따라서 평균 제곱 오차는 초기 변수 설정에 영향을 많이 받는다. 최적의 결과를 만들기 위해서는 여러 번 반복 학습을 해야 만 하며, 최적의 결과에 수렴하지 못할 수도 있다. 또한 특잇값(outlier)에 영향을 많이 받는데, 대다수의 데이 터를 잘 학습하더라도 일부 특잇값에서 손실이 급등하는 현상을 보일 수 있고, 심하면 기계학습이 제대로 이루 어지지 못하고 모델이 붕괴(collapse)하는 경우도 발생할 수 있다. 두 번째로 작은 오차는 \"제곱\"하면 매우 작 은 오차가 된다. 그래서 출력값과 라벨의 간격이 가까워지면 손실이 기하급수적으로 작아진다는 문제가 있다. 결국 평균 제곱 오차를 사용하는 심층신경망은, 매우 정확한 결괏값과 어느 정도 정확한 결괏값을 구분하지 못 하기 때문에, 매우 정확한 결괏값을 생성하지 못한다. 평균 제곱 오차의 상기한 두 제한점은 상호작용하면서 심층신경망의 학습에 부정적인 결과를 만든다. 평균 제곱 오차를 사용하는 심층신경망은 정확한 결과를 내기보다는 한 개의 큰 오차를 줄이는데 집중하게 된다. 이는 매 우 정확한 결과를 수십 수백 개를 생성하는 것보다 큰 손실 한 개를 줄이는 것이 손실 측면에서 이익이 되기 때 문이다. 또한 심층신경망은 특잇값(outlier)에 영향을 많이 받게 되며, 이는 전체 모델의 성능을 떨어트리게 된 다. 따라서 평균 제곱 오차를 사용하려면 특잇값이 없도록 학습 데이터를 아주 정교하게 다듬어야 한다. 또한 학습이 어느정도 이루어지는 과정에서, 손실이 급등과 급락을 반복하는 현상이 보일 수 있는데, 이는 몇몇 특잇 값에 의해 전체 데이터에 적대적인 변수가 설정되면서 발생하는 현상이다. 교차 엔트로피(cross entropy)는 로그(log)함수를 사용하기 때문에, 앞서 언급한 평균 제곱 오차의 제한점들에 영향을 적게 받는다.. 교차 엔트로피는 초기 변수설정에 영향을 적게 받으며, 특잇값에도 영향을 적게 받는다. 또한 출력값과 라벨의 거리가 가까워지더라도 평균 제곱 오차보다 빠르게 수렴할 수 있다. 그러나 교차 엔트로 피는 범주형 변수를 위해 개발된 손실함수이기 때문에, 양적 정보를 지닌 수치형 변수에 바로 적용할 수 없다. 심층신경망에서 수치형 변수에 교차 엔트로피를 적용하기 위해 주로 사용하는 방법이 원 핫 인코딩(one hot encoding)이다. 이 방법은 유한한 수의 범주를 가지는 범주형 변수를 생성하고, 각 범주가 가지는 값의 범위를 정한다. 이때 각 범주가 가지는 범위들은 서로소(disjoint)이며, 서로 겹치지 않는다. 한 개의 수치형 변수는 한 개의 범주에만 속할 수 있으며, 이 범주에만 1을 배정하고, 나머지 범주들에는 0을 배정한다. 심층신경망에서 원 핫 인코딩으로 수치형 변수를 범주형 변수로 변환하고, 손실 함수로 교차엔트로피를 사용하 는 방법은, 상기한 제한점들에 영향을 적게 받아, 평균 제곱 오차보다 효과적인 학습이 이루어진다. 따라서 정 확도 측면에서 평균 제곱 오차를 사용할 때보다 우월한 결과를 보여주는 경우가 많다. 그러나 수치형 변수를 범 주형 변수로 변환할 때에 두 단계에 걸쳐 크기 정보의 손실이 일어난다. 먼저, 변환 과정은 반올림과 유사하기 때문에, 변환 과정에서 상당수의 유효숫자 정보가 소실된다. 범주형 변수는 유한한 개수의 범주를 가지고 있으 며, 범주형 변수로 표현된 수치형 변수는, 범주의 개수 정보만 남고, 대부분의 수량적 정보는 생략된다. 두 번 째로, 원핫 인코딩을 통해 생성된 범주 간에는 양적인 비교를 할 수 없다. 예를 들어 혈당을 기준으로 순서대로정상군, 당뇨전단계군, 당뇨군으로 나누었을 때, 정상군의 데이터와 당뇨전단계군의 거리는 정상군과 당뇨군 사 이의 거리보다 가까워야 한다. 하지만, 원 핫 인코딩을 사용하면 심층신경망은 정상군, 당뇨전단계군, 당뇨군 사이의 양적 관계를 알 수 없다. 그리하여 정상군 데이터를 당뇨군으로 예측하였을때와 당뇨전단계로 예측하였 을 때 손실은 동일하다. 의학 분야에는 혈압, 혈당과 같은 수치형 변수들이 많다. 그동안 심층신경망으로 이들 수치형 변수를 예측할 때, 손실함수로 평균 제곱 오차 또는 원 핫 인코딩과 교차 엔트로피를 이용했었다. 실제 모델을 생성해 보면, 평균 제곱 오차의 앞서 언급한 제한점들로 인해 정확도 및 예측력이 많이 부족함을 경험하게 된다. 그래서 많은 연구에서 원 핫 인코딩과 교차 엔트로피를 채택하였으나, 이 또한 양적 정보가 많이 소실되기 때문에, 생성된 결과가 부정확한 경우가 많았다. 본 발명에서는 밀도함수를 이용하여 심층신경망에서 수치형 변수의 크기 정보를 보존하면서 범주형 변수로 변환 하는 인코딩 방법과 이를 이용하는 시스템을 제안한다. 이 발명은 세 가지의 목적이 있다. 첫째는 수치형 변수 를 범주형 변수로 변환할 때 발생하는 정보의 손실을 줄여 심층신경망이 더욱 정확한 데이터를 가지고 학습할 수 있도록 하는 것이다. 두 번째는 심층신경망에서 출력한 범주형 변수를 다시 수치형 변수로 복원할 수 있도록 하는 것이다. 세 번째는 심층신경망이 범주들의 크기 관계를 알 수 있게 하여 학습 과정에서 더욱 정확한 결과 를 생성할 수 있도록 하는 것이다."}
{"patent_id": "10-2023-0112442", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은 상기한 수치형 변수를 범주형 변수로 변환하는 과정에서 발생하는, 원 핫 인코딩과 교차 엔트로피의 문제점을 해결하기 위하여 안출된 것으로서, 심층신경망에서 수치형 변수의 크기 정보를 보존하면서 범주형 변 수로 변환하는 방법과, 심층신경망에서 생성된 범주형 변수를 다시 수치형 변수로 복원하는 방법, 그리고 이를 이용하는 시스템을 고안하는 데에 그 목적이 있다."}
{"patent_id": "10-2023-0112442", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명의 일 실시예에서는 심층신경망과 심전도를 이용하여 심박출률을 추정하는 방법을 제시한다. 본 발명의 실시 예들에서 얻을 수 있는 효과는 이로 제한되지 않으며, 언급하지 않은 또 다른 효과들은 이하의 본 발명의"}
{"patent_id": "10-2023-0112442", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 2, "content": "실시 예들에 대한 기재로부터 본 발명이 속하는 기술분야에서 통상의 지식을 가진 자에게 명확하게 도출되고 이 해될 수 있다. 즉, 본 발명을 실시함에 따른 의도하지 않은 효과들 역시 본 발명의 실시 예들로부터 당해 기술 분야의 통상의 지식을 가진 자에 의해 도출될 수 있다. 확률 밀도 함수를 이용하여 수치형 변수를 범주형 변수로 변환한다는 본 발명의 핵심 개념은, 모든 측정값은 확 률로 표현될 수 있다는 양자역학의 개념과 유사하다. 한 개의 실수 측정값은 확률 분포로 변환할 수 있다. 우리 는 임의의 밀도함수를 이용하여, 실수 측정값을 범주형 변수의 모든 범주에 분배한다. 이를 통하여 우리는 수치 형 변수를 정보가 잘 보존된 범주형 변수로 변환할 수 있다. 또한 이렇게 변환된 범주형 변수는 교차엔트로피를 이용하여 손실을 계산할 수 있다. 또한 범주형 변수를 다시 수치형 변수로 복원할 수 있다. 본 발명의 일 실시예에 따른 심층신경망에서 수치형 변수의 크기 정보를 보존하면서 범주형 변수로 변환하는 인 코딩 방법 및 이를 이용하는 시스템은, 심층신경망으로 추론하고자 하는 수치형 변수(numerical variable), 수 치형 변수를 변환하여 생성한 유한한 수의 범주를 가지는 범주형 변수(categorical variable), 각 범주를 대표 하는 대푯값(representative value), 수치형 변수를 범주형 변수로 변환할 때 기준이 되는 밀도 함수(density function), 대푯값과 수치형 변수의 거리를 계산하고, 이를 밀도 함수에 입력하고, 밀도 함수에서 출력된 양의 실수를 각각의 범주에 배정하는 소프트 인코딩(soft encoding)으로 구성된다. 심층신경망과 심전도를 이용하여 심박출률을 추정하는 본 발명의 일 실시예에서는 수치형 변수인 심박출률을 밀도 함수를 이용하여 범주형 변수 로 변환하고, 이를 교차엔트로피로 손실을 계산하여 심층신경망을 학습시킨다. 심박출률은 0에서 100 사이의 값을 가질 수 있으며, 본 발명의 일 실시예에서는 심박출률을 10의 간격으로 10에 서 80까지 총 7개의 구간으로 나누어 각각 범주형 변수로 설정한다. 각 범주형 변수의 대푯값은 각 범주에 해당 하는 구간의 중앙값인 15, 25, 35, 45, 55, 65, 75로 정했다. 기존의 원핫인코딩에서는 한 개의 수치형 변수는 한 개의 범주에만 1을 배정하고, 나머지 범주들에는 0을 배정 한다. 그러나 본 발명의 일 실시예에서는 한 개의 수치형 변수는 모든 범주에 나뉘어져서 배정된다. 이때 분배하는 규칙이 밀도함수이다. 구체적인 방법으로는 각 범주의 대푯값과 수치형 변수 사이의 거리를 각각 계산하고, 이 거리를 각각 밀도 함수에 대입하여 밀도를 계산하고, 이 밀도를 각 범주에 배정한다. 본 발명의 일 실시예에 따른 밀도 함수는 세 가지의 특성이 있어야 한다. 첫째로 정의역은 모든 실수이며, 치역 은 양의 실수이다. 정의역이 모든 실수이기 때문에, 범주가 어떠한 대푯값을 가지더라도 밀도 함수에 입력할 수 있다. 이러한 특성에 의해 한 개의 수치형 변수는 범주형 변수의 모든 범주에 분산될 수 있다. 두 번째로, 밀도 함수는 정규분포와 같이 종 모양의 분포를 가지고 있어서, 0에 가까울수록 커지며, 0에서 멀어질수록 점점 작아 지는 형상이어야 한다. 이는 심층신경망이 정답에서 먼 범주를 선택할 때 더욱 많은 손실이 발생하도록 한다. 이 특성에 의해 심층신경망은 각 범주 사이의 양적 관계를 학습할 수 있게 된다. 셋째로 밀도함수의 적분값은 발산하지 않고 수렴해야 한다. 밀도함수의 적분값이 수렴해야만 추후 결괏값을 이용하여 범주형 변수를 수치형 변수로 복원할 수 있기 때문이다. 이 특성들을 만족하면서 밀도함수로 사용할 수 있는 함수에는 정규분포, 등비 수열 등이 있다. 본 발명의 일 실시예에서는 계산의 편의를 위해 평균이 0, 표준 편차가 1인 표준 정규 분포를 사용한다. 본 발명의 일 실시예에서 만약 심박출률이 52일 때, 이 수치형 변수를 각각의 범주에 배정하는 방법은 다음과 같다. 우선 심박출률과 각각의 범주의 대푯값 사이의 거리를 계산한다. 예를 들어 40에서 50 사이의 범위를 가 지는 범주는 대푯값이 45이며, 45와 52 사이의 거리는 7이다. 두 번째로, 이 거리를 구간의 크기로 나눈다. 본 발명의 일 실시예에서 구간의 크기는 10이므로 0.7이 출력된다. 이 값을 표준 정규 분포의 확률 밀도 함수 (possibility density function)에 대입한다. 이때 출력되는 값은 0.31이다. 그러면 우리는 40에서 50 사이의 범위를 가지는 범주에 0.31을 배정할 수 있다. 이 과정을 각각의 범주에 반복 시행한다. 그리하여 우리는 한 개 의 수치형 변수를 이용하여 모든 범주에 양의 실수를 배정할 수 있다. 한 개 이상의 범주가 0 이외의 값을 가질 수 있도록 허용하는 기존의 소프트 인코딩과 본 발명에서 제안하는 수 치형 변수의 크기 정보를 보존하면서 범주형 변수로 변환하는 소프트 인코딩은 형태적으로는 비슷하지만, 완전 히 다른 개념이다. 가장 큰 차이점은 기존의 소프트 인코딩 방식은 범주형 변수의 각 범주는 개개의 클래스를 의미하지만, 본 발명에서는 범주형 변수의 모든 범주는 단 한 개의 수치형 변수를 의미한다는 점이다. 두 번째 로 기존의 소프트 인코딩에서 각각의 범주들은 서로 독립적인 값을 가지지만, 본 발명에서의 범주들은 독립적이 지 않다. 본 발명의 소프트 인코딩에서 각각의 범주 단독으로는 의미가 없으며, 모든 범주를 결합했을 때만 의 미를 지니다. 또한 기존의 소프트 인코딩에서 각 범주가 가지는 값의 분포는 서로 독립적이기 때문에 다양한 모 양이 가능하지만, 본 발명의 소프트 인코딩에서 범주들값은 밀도함수의 근사인 종 모양으로 분포한다. 본 발명의 일 실시예에서 범주형 변수를 수치형 변수로 복원하는 과정은 다음과 같다. 우선 상기한 밀도함수의 적분값을 계산한다. 이 적분값은 범주형 변수를 수치형 변수로 복원할 때 크기 조정을 위해 사용된다. 다음으로 심층신경망에서 출력된 결괏값에 대푯값을 각각 곱하고 모두 더하여, 결괏값과 대푯값의 내적을 계산한다. 이 값을 상기한 적분값으로 나누어 크기 단위(scale)를 보정한다. 본 발명의 일 실시예에서 심전도를 입력받은 심 층신경망이 [0.00, 0.01, 0.09, 0.31, 0.38, 0.17, 0.03]을 출력하였다면, 이 출력값에 각 범주의 대표값인 [15, 25, 35, 45, 55, 65, 75]를 각각 곱한다. 생성된 [0.00, 0.25, 3.15, 13.95, 20.90, 11.05, 2.25]를 모두 더하면 51.6이 생성된다. 본 발명의 일 실시예에서는 밀도함수로 표준정규분포를 사용했으므로, 적분값은 \"1\"이 다. 51.6을 1로 나누면 51.6가 생성되며 이 값이 복원된 수치형 변수이다."}
{"patent_id": "10-2023-0112442", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명에서 제안하고 있는 수치형 변수의 크기 정보를 보존하면서 범주형 변수로 변환하는 인코딩 방법과 심층 신경망 그리고 이를 이용하는 시스템은 한 개의 수치형 변수를, 미리 정의된 밀도 함수를 이용하여 모든 범주형 변수에 배정하여 범주형 변수로 변환한다. 이를 통해 정보의 손실을 줄이고, 더욱 풍부한 값으로 심층신경망이 학습할 수 있도록 한다. 또한 종 모양 밀도함수 형태를 통해, 심층신경망은 각 범주가 가지고 있는 양적인 관계 를 학습하게 된다. 이를 통해 더 높은 정확도를 가지는 수치형 변수를 생성할 수 있도록 한다."}
{"patent_id": "10-2023-0112442", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "본 발명의 일 실시예에서는 소프트 인코딩을 통해 수치형 변수인 심박출률을 범주형 변수로 변환하고, 심층신경 망과 심전도를 이용하여 결괏값을 출력하고, 이를 복원하는 방법을 제시한다. 후술하는 본 발명에 대한 상세한 설명은, 본 발명이 실시될 수 있는 특정 실시예를 예시로서 도시하는 첨부 도면을 참조한다. 이들 실시예는 당 업자가 본 발명을 실시할 수 있기에 충분하도록 상세히 설명된다. 본 발명의 다양한 실시예는 서로 다르지만 상 호 배타적일 필요는 없음이 이해되어야 한다. 예를 들어, 여기에 기재되어 있는 특정 형상, 구조 및 특성은 일 실시예에 관련하여 본 발명의 정신 및 범위를 벗어나지 않으면서 다른 실시예로 구현될 수 있다. 또한, 각각의 개시된 실시예 내의 개별 구성요소의 위치 또는 배치는 본 발명의 정신 및 범위를 벗어나지 않으면서 변경될 수 있음이 이해되어야 한다. 따라서, 후술하는 상세한 설명은 한정적인 의미로서 취하려는 것이 아니며, 본 발명의 범위는, 적절하게 설명된다면, 그 청구항들이 주장하는 것과 균등한 모든 범위와 더불어 첨부된 청구항에 의해 서만 한정된다. 도면에서 유사한 참조부호는 여러 측면에 걸쳐서 동일하거나 유사한 기능을 지칭한다. 또한, 본 발명의 상세한 설명 및 청구항들에 걸쳐, \"포함하다\"라는 단어 및 그것의 변형은 다른 기술적 특징들, 부가물들, 구성요소들 또는 단계들을 제외하는 것으로 의도된 것이 아니다. 통상의 기술자에게 본 발명의 다른 목적들, 장점들 및 특성들이 일부는 본 설명서로부터, 그리고 일부는 본 발명의 실시로부터 드러날 것이다. 아 래의 예시 및 도면은 실례로써 제공되며, 본 발명을 한정하는 것으로 의도된 것이 아니다. 한편, 첨부된 블록도의 블록들이나 흐름도의 단계들은 범용 컴퓨터, 특수용 컴퓨터, 휴대용 노트북 컴퓨터, 네 트워크 컴퓨터 등 데이터 프로세싱이 가능한 장비의 프로세서나 메모리에 탑재되어 지정된 기능들을 수행하는 컴퓨터 프로그램 명령들(instructions)을 의미하는 것으로 해석될 수 있다. 이들 컴퓨터 프로그램 명령들은 컴 퓨터 장치에 구비된 메모리 또는 컴퓨터에서 판독 가능한 메모리에 저장될 수 있기 때문에, 블록도의 블록들 또 는 흐름도의 단계들에서 설명된 기능들은 이를 수행하는 명령 수단을 내포하는 제조물로 생산될 수도 있다. 아 울러, 각각의 블록 또는 각각의 단계는 특정된 논리적 기능(들)을 실행하기 위한 하나 이상의 실행 가능한 명령 들을 포함하는 모듈, 세그먼트 또는 코드의 일부를 나타낼 수 있다. 또, 몇 가지 대체 가능한 실시예들에서는 블록들 또는 단계들에서 언급된 기능들이 정해진 순서와 달리 실행되는 것도 가능함을 주목해야 한다. 예컨대, 잇달아 도시되어 있는 두 개의 블록들 또는 단계들은 실질적으로 동시에 수행되거나, 역순으로 수행될 수 있으 며, 경우에 따라 일부 블록들 또는 단계들이 생략된 채로 수행될 수도 있다."}
{"patent_id": "10-2023-0112442", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "이하, 본 발명이 속하는 기술분야에서 통상의 지식을 가진 자가 본 발명을 용이하게 실시할 수 있도록 하기 위 하여, 본 발명의 바람직한 실시예들에 관하여 첨부된 도면을 참조하여 상세히 설명하기로 한다. 도 1은 본 발명의 일 실시예에 따른, 심층신경망과 심전도를 이용하여 심박출률을 추정할 때, 전체 모델에서 정 규화, 원 핫 인코딩, 소프트 인코딩의 어떠한 차이가 있는지를 대략적으로 보여주는 도면이다. 도 1을 참조하면, 심층신경망을 학습하기 위해서는 입력값과 라벨이 필요하다. 상기 입력값은 수치형 변수, 범주형 변수를 모두 포함하며, 이미지, 음성, 문장, 숫자 등 다양한 형식의 데이터를 사용할 수 있다. 이 입력값은 심층신경망에서 처리하기 용이하도록 정규화 및 변환을 거친 후 심층신경망에 입력된다. 본 발명 의 일 실시예에서는 심전도가 입력값에 해당한다. 상기 입력값을 심층신경망에 입력하면 결괏값을 생성한다. 이 결괏값의 형태는 손실함수에 따라 달라지는데, 평균 제곱 오차에서 평균 제곱 오차 결괏값은 한 개의 실수이고, 교차 엔트로피에서 교차 엔트로피 결괏값은 범주와 동일한 개수의 실수이다. 본 발명의 일 실시예에서는 범주의 수가 7개 이기 때문에, 교차 엔트로피 결괏값도 7개의 실수로 구성된다. 라벨은 심층신경망을 통해 추론하고자 하는 변수이다. 본 발명의 일실시예에서는 심박출률이 라벨에 해당 한다. 라벨은 손실 함수에 따라 상이한 전처리 과정을 거친다. 평균 제곱 오차에서는 라벨을 정규화 하여 심층신경망이 학습하기 용이한 형태로 변환하는데, 일반적으로 0에서 1사이의 크기를 가지는 소수로 변환 한다. 본 발명의 일 실시예에서는 심박출률이 0에서 100사이의 값을 가지기 때문에 2의 7승인 \"128\"로 나누었다. 수치형 변수에 대해 교차 엔트로피를 손실함수로 사용하기 위해서서 기존에는 원 핫 인코딩 을 주로 사용한다. 본 발명에서는 밀도함수을 통해 수치형 변수를 범주형 변수로 변환하는 소프트 인 코딩 방법을 제시한다. 도 2는 본 발명의 일 실시예에 따른, 심층신경망과 심전도를 이용하여 심박출률을 추정할 때, 수치형 변수인 심 박출률을 정규화, 원 핫 인코딩, 소프트 인코딩을 통해 각각 변환하는 방법을 비교하여 나타내는 도면이다. 도 2를 참조하면, 정규화는 심층신경망이 학습하기 용이하도록 0에서 1사이의 값을 가지도록 수치형 변수 의 크기를 변환하며, 이 과정에서 라벨의 형태와 특성은 변하지 않는다. 본 발명의 일 실시예에서 52 (%)의 심 박출률은 128로 나뉘어져 0.406으로 변환된다. 이 때 라벨과 정규화 과정을 거친 정규화 라벨은 동일하게 한 개의 숫자로 구성된 수치형 변수이다. 원 핫 인코딩은 수치형 변수를 범주형 변수로 변환하는 방법이다. 본 발명의 일 실시예어서 52 (%)의 심박출률은 50에서 60사이의 구간을 가지는 Y5에 해당한다. 원 핫 인코딩에서는 라벨이 해당하는 Y5에 1을 배정하고, 나머지 Y1, Y2, Y3, Y4, Y6, Y7 에는 0을 배정하여 원 핫 인코 딩 라벨을 생성한다. 본 발명에서 고안한 소프트 인코딩은 밀도함수을 이용하여 Y1, Y2, Y3, Y4, Y5, Y6, Y7 모두에 양의 실수를 배정하여 소프트 인코딩 라벨을 생성한다. 본 발명의 소프트 인코딩은, 한 개 이상의 범주가 0 이외의 값을 가질 수 있도록 허용하는 기존의 소프트 인코 딩과 형태적으로는 비슷하지만, 완전히 다른 개념이다. 가장 큰 차이점은 기존의 소프트 인코딩 방식은 범주형 변수의 각 범주들은 개개의 클래스를 의미하지만, 본 발명에서는 범주형 변수의 모든 범주들은 단 한 개의 수치 형 변수를 의미한다는 점이다. 두 번째로 기존의 소프트 인코딩에서 각각의 범주들은 서로 독립적인 값을 가지 지만, 본 발명에서의 범주들은 독립적이지 않다. 또한 기존의 소프트 인코딩에서 각 범주가 가지는 값의 분포는 서로 독립적이기 때문에 다양한 모양이 가능하지만, 본 발명의 소프트 인코딩에서 범주들값은 밀도함수의 근사 인 종모양으로 분포한다. 본 발명에서 제안하는 밀도 함수는 양자 역학의 기본 개념에서 유래한다. 양자 역학에서 측정값은 고정되 어 있지 않으며, 확률로 표현될 수 있다. 이를 본 발명의 일 실시예에 적용하면 심박출률은 52 (%)로 측정되었 지만, 실제로는 52를 중심으로 하는 종모양의 확률 분포를 가진다고 생각할 수 있다. 따라서 우리는 이를 임의 의 밀도함수를 통해 한 개의 수치형 변수를 모든 범주형 변수에 분배할 수 있다. 이를 통하여 우리는 수치형 변 수를 정보가 잘 보존된 범주형 변수로 변환할 수 있다. 이렇게 변환된 범주형 변수는 교차엔트로피를 이용하여 손실함수를 계산하는데 사용되며, 다시 수치형 변수로 복원할 수도 있다. 도 2를 참조하면 밀도 함수는 세 가지 특성을 가진다. 첫째로 밀도함수의 정의역은 모든 실수이며, 치역은 양의 실수이다. 밀도 함수는 어떠한 실수라도 입력받으면 양의 실수를 출력할 수 있다. 따라서 소프트 인코딩 에서, 라벨과 각 범주의 대푯값이 큰 차이가 나더라도, 항상 양의 실수를 배정할 수 있다. 둘째로 밀 도함수는 0근처에서 볼록한 종 모양이다. 이는 심층신경망이 교차 엔트로피 결괏값을 생성할 때, 라벨 과 큰 차이가 나는 범주로 예측할 때에는 더 큰 손실을 부여하고, 작은 차이가 나는 범주로 예측할 때는 작은 손실을 부여할 수 있게 한다. 본 발명의 일 실시예에서 라벨은 52이기 때문에 원 핫 인코딩에서 는 Y5만 정답이고, Y1과 Y4은 모두 동일하게 오답이다. 그러나, 소프트 인코딩에서 Y1은 라벨에서 거리가 멀 기 때문에 작은 값을 가지고, Y4는 라벨과 가깝기 때문에 상대적으로 큰의 값을 가진다. 따라서 심층신경망이 생 성한 교차 엔트로피 결괏값도 라벨과 가까운 Y4에서는 손실이 작지만, 라벨과 먼 Y1에서는 손실이 커진다. 이를 통해 심층신경망은 정답에 가까운 범주에 가중치를 줄 수 있도록 학습하며, 각 범주형 변수간의 양적인 관계를 학습할 수 있게 된다. 셋째로 밀도함수의 적분값은 발산하지 않고 수렴해야 한다. 밀도함수의 적분값이 수 렴해야만 추후 결괏값을 이용하여 수치형 변수로 복원할 수 있기 때문이다. 도 2를 참조하면, 소프트 인코딩 라벨의 분포는 밀도함수에 근사한다. 또한 소프트 인코딩 라벨의 적분값 은 밀도함수의 적분값에 근사한다. 본 발명의 일 실시예에서는 계산의 편의를 위해 밀도함수로 표준정규분포를 사용하였으나, 상기한 밀도 함수의 조건들을 만족한다면, 어떠한 함수도 밀도함수로 사용할 수 있다. 도 3은 본 발명의 일 실시예에 따른, 심층신경망과 심전도를 이용하여 심박출률을 추정할 때, 심층신경망에서 출력된 결괏값을, 정규화, 원 핫 인코딩, 소프트 인코딩 각각에서 본래의 수치형 변수로 복원하는 방법을 비교 하여 나타내는 도면이다. 도 3을 참조하면, 평균 제곱 오차 결괏값과 교차엔트로피 결괏값 모두 원래의 라벨 형태로 복원 할 수 있다. 정규화 복원은 정규화 수식의 역산을 거쳐 평균 제곱 오차 결괏값으로 정규화 복원값 을 생성한다. 본 발명의 일 실시예에서는 128로 나누어 정규화를 수행하였기 때문에, 정규화 복원 은 128을 곱하여 정규화 복원값을 생성한다. 원 핫 인코딩 복원은 교차엔트로피 결괏값에 서 가장 큰 범주에는 1을 배정하고, 나머지 범주의 값들은 버린다. 원 핫 인코딩 복원에서는 가장 큰 값을 가졌던 범주의 대푯값이 원 핫 인코딩 복원값이 된다. 본 발명의 일 실시예에서는 50에서 60 사이의 Y5가 가장 큰 0.38의 값을 가지기 때문에, Y5의 대푯값인 55가 원 핫 인코딩 복원값이 된다. 소프트 인코딩 복 원에서는 원 핫 인코딩 복원과 달리 모든 범주의 값을 사용한다. 우선 각각의 범주형 변수에 대푯값 을 곱한다. 이 후 이 곱한 값들을 모두 더하여 총 합을 계산한다. 이 값을 상기한 적분값으로 나누어 크기 단위 (scale)을 보정한다. 본 발명의 일 실시예에서 심전도를 입력받은 심층신경망이 [0.00, 0.01, 0.09, 0.31, 0.38, 0.17, 0.03]을 출력하였다면, 이 출력값에 대표값인 [15, 25, 35, 45, 55, 65, 75]을 각각 곱한다. 생성 된 [0.00, 0.25, 3.15, 13.95, 20.90, 11.05, 2.25] 을 모두 더하면 51.55이 생성된다. 본 발명의 일 실시예에 서는 표준정규분포를 사용하였기 때문에, 적분값이 \"1\"이다. 51.6을 1로 나누면 51.6가 생성되며 이 값이 복원 된 수치형 변수이다. 도 3을 참조하면, 본래의 라벨이 가진 52의 값에 가장 가까운 값을 복원하는 방법은 정규화 복원으로, 52의 값을 오차 없이 그대로 복원할 수 있다. 원 핫 인코딩 복원은 3만큼의 오차가 발생하 여 가장 큰 복원 오차를 보여주는데, 이는 원 핫 인코딩 과정에서 많은 양적 정보가 소실되기 때문이다. 소프트 인코딩 또한 범주형 변수를 밀도 함수에 근사하는 과정에서 양적 정보가 일부 소실된다. 이로 인해 소프트 인코딩 복원 0.4 만큼의 오차가 발생하였는데, 이는 원 핫 인코딩 복원값 오차에 비하면 매우 작은 수준이다. 도 4는 본 발명의 일 실시예에 따른, 심층신경망과 심전도를 이용하여 심박출률을 학습할 때에 정규화, 원 핫 인코딩, 소프트 인코딩 각각의 예측 오차를 비교하여 나타내는 도면이다. 도 4를 참조하면, 예측 오차는 라벨과, 복원된 값 사이의 L2거리이다. 평균 제곱 오차를 사용하 는 정규화(210; 파란선)는 초기값에 영향을 많이 받기 때문에, 초기에 압도적으로 큰 예측 오차를 보여준다. 반 면 교차 엔트로피를 사용하는 원 핫 인코딩과 소프트 인코딩은 초기 예측 오차가 상대적으로 작 다. 정규화(210; 파란선)의 예측 오차는 학습 중에 급등과 급락을 여려차례 보여준다. 이 역시 상기했듯, 평균 제곱 오차는 일부 특잇값에 영향을 많이 받기 때문이다. 학습이 어느정도 끝났을 때에는 원 핫 인코딩의 예측 오차가 가장 큰데, 이는 원 핫 인코딩은 변환과 복원 도중에 라벨이 지닌 양적 정보가 많이 소 실되기 때문이다. 최종적으로 소프트 인코딩이 가장 우수한 성능을 보여주었다. 도 5는 본 발명의 일 실시예에 따른, 심층신경망과 심전도를 이용하여 심박출률을 예측할 때, 정규화, 원 핫 인 코딩, 소프트 인코딩 각각에서 라벨과 복원값 사이의 산점도를 나타내는 도면이다. 도 5를 참조하면, 정규화의 산점도는 직선이라기 보다는 타원에 가깝다. 이는 평균 제곱 오차가 가진 특성 으로, 매우 정확한 결과 여러개를 생성하기 보다 한 두 개의 특잇값을 줄이는게 손실 측면에서 도움이 되기 때 문이다. 원 핫 인코딩의 산점도는 비교적 잘 모여있으나, 상관관계 r은 정규화보다 작다. 이는 원 핫 인코딩에서 오답을 생성하는 경우 완전히 잘못된 값을 생성하더라도 추가적인 패널티가 없기 때문에, 완전 히 잘못된 예측을 종종 내놓기 때문이다. 도 5를 참조하면, 소프트 인코딩의 산점도는 거의 일직선으로 모여있으며, 상관관계 r도 다른 두 방법에 비해 많이 개선된 경향을 보인다. 이는 변환 및 복원 과정에서 양적 정보가 보존되었고, 손실함수로교차 엔트로피를 사용하여 평균 제곱 오차에 비해 안정적으로 학습을 수행했기 때문이다. 도 6은 본 발명의 일 실시예에 따른, 심층신경망과 심전도를 이용하여 심박출률을 예측할 때의 정확도를 정규화, 원 핫 인코딩, 소프트 인코딩 각각에서 혼동행렬을 통해 시각화하는 도면이다. 도 6를 참조하면, 정규화의 혼동행렬은 산점도와 같이 퍼져 있는 경향을 보이며, 정확도도 49.2%로 가장 낮다. 원 핫 인코딩은 54.8%로 정확도가 개선되었으나, 중심에서 벗어난 완전한 오답을 생성하는 비율이 높았다. 도 6를 참조하면, 소프트 인코딩이 가장 정확한 56.8% 결과를 출력한다. 본 발명의 긍정적인 효과는 심층신경망이 수치형 변수를 효과적으로 학습할 수 있도록 하는 것이다. 그 동안 심 층신경망에서 수치형 변수를 추론하는데 주로 사용하던 최소 제곱 오차는 초기 변수 설정과 학습 데이터의 질에 영향을 많이 받았기 때문에 정확도가 떨어지는 문제가 있었다. 또한 원 핫 인코딩을 이용한 교차 엔트로피 방법 은 초기 변수 설정과 학습 데이터의 질에 영향을 적게 받고 학습도 안정적이지만, 변환 과정에서 정보가 많이 소실되기 때문에, 가끔 완전한 오답을 생성하는 경우가 있었다. 본 발명에서 고안한 소프트 인코딩 방법은 상기 두 방법에 비해 수치형 변수를 학습하는데 장점이 있기 때문에, 인공지능 분야 발전에 큰 도움이 될 것으로 기 대된다."}
{"patent_id": "10-2023-0112442", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "본 발명 기술분야의 통상의 기술자에게 이해될 수 있는 바로서, 위에서 설명된 이미지, 예컨대 원본 이미지, 원 본 레이블 및 추가 레이블과 같은 이미지 데이터의 송수신이 학습 장치 및 테스트 장치의 통신부들에 의하여 이 루어질 수 있으며, 특징 맵과 연산을 수행하기 위한 데이터가 학습 장치 및 테스트 장치의 프로세서(및/또는 메 모리)에 의하여 보유/유지될 수 있고, 컨벌루션 연산, 디컨벌루션 연산, 로스 값 연산 과정이 주로 학습 장치 및 테스트 장치의 프로세서에 의하여 수행될 수 있으나, 본 발명이 이에 한정되지는 않을 것이다. 이상 설명된 본 발명에 따른 실시예들은 다양한 컴퓨터 구성요소를 통하여 수행될 수 있는 프로그램 명령어의 형태로 구현되어 컴퓨터 판독 가능한 기록 매체에 기록될 수 있다. 상기 컴퓨터 판독 가능한 기록 매체는 프로 그램 명령어, 데이터 파일, 데이터 구조 등을 단독으로 또는 조합하여 포함할 수 있다. 상기 컴퓨터 판독 가능 한 기록 매체에 기록되는 프로그램 명령어는 본 발명을 위하여 특별히 설계되고 구성된 것들이거나 컴퓨터 소프 트웨어 분야의 당업자에게 공지되어 사용 가능한 것일 수도 있다. 컴퓨터 판독 가능한 기록 매체의 예에는, 하 드 디스크, 플로피 디스크 및 자기 테이프와 같은 자기 매체, CD-ROM, DVD와 같은 광기록 매체, 플롭티컬 디스 크(floptical disk)와 같은 자기-광 매체(magneto-optical media), 및 ROM, RAM, 플래시 메모리 등과 같은 프 로그램 명령어를 저장하고 수행하도록 특별히 구성된 하드웨어 장치가 포함된다. 프로그램 명령어의 예에는, 컴 파일러에 의해 만들어지는 것과 같은 기계어 코드뿐만 아니라 인터프리터 등을 사용해서 컴퓨터에 의해서 실행 될 수 있는 고급 언어 코드도 포함된다. 상기 하드웨어 장치는 본 발명에 따른 처리를 수행하기 위해 하나 이상 의 소프트웨어 모듈로서 작동하도록 구성될 수 있으며, 그 역도 마찬가지이다. 이상에서 본 발명이 구체적인 구성요소 등과 같은 특정 사항들과 한정된 실시예 및 도면에 의해 설명되었으나, 이는 본 발명의 보다 전반적인 이해를 돕기 위해서 제공된 것일 뿐, 본 발명이 상기 실시예들에 한정되는 것은"}
{"patent_id": "10-2023-0112442", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "아니며, 본 발명이 속하는 기술분야에서 통상적인 지식을 가진 자라면 이러한 기재로부터 다양한 수정 및 변형 을 꾀할 수 있다. 따라서, 본 발명의 사상은 상기 설명된 실시예에 국한되어 정해져서는 아니 되며, 후술하는 특허청구범위뿐만 아니라 이 특허청구범위와 균등하게 또는 등가적으로 변환된 모든 것들은 본 발명의 사상의 범주에 속한다고 할 것이다.도면 도면1 도면2 도면3 도면4 도면5 도면6"}
{"patent_id": "10-2023-0112442", "section": "도면", "subsection": "도면설명", "item": 1, "content": "본 발명의 실시예의 설명에 이용되기 위하여 첨부된 아래 도면들은 본 발명의 실시예들 중 단지 일부일 뿐이며,"}
{"patent_id": "10-2023-0112442", "section": "도면", "subsection": "도면설명", "item": 2, "content": "본 발명이 속한 기술분야에서 통상의 지식을 가진 자(이하 \"통상의 기술자\")에게 있어서는 발명적 작업이 이루어짐 없이 이 도면들에 기초하여 다른 도면들이 얻어질 수 있다. 도 1은 본 발명의 일 실시예에 따른, 심층신경망과 심전도를 이용하여 심박출률을 추정할 때, 전체 모델에서 정 규화, 원 핫 인코딩, 소프트 인코딩의 어떠한 차이가 있는지를 대략적으로 보여주는 도면. 도 2는 본 발명의 일 실시예에 따른, 심층신경망과 심전도를 이용하여 심박출률을 추정할 때, 수치형 변수인 심 박출률을 정규화, 원 핫 인코딩, 소프트 인코딩을 통해 각각 변환하는 방법을 비교하여 나타내는 도면. 도 3은 본 발명의 일 실시예에 따른, 심층신경망과 심전도를 이용하여 심박출률을 추정할 때, 심층신경망에서 출력된 결괏값을, 정규화, 원 핫 인코딩, 소프트 인코딩 각각에서 본래의 수치형 변수로 복원하는 방법을 비교 하여 나타내는 도면. 도 4는 본 발명의 일 실시예에 따른, 심층신경망과 심전도를 이용하여 심박출률을 학습할 때에 정규화, 원 핫 인코딩, 소프트 인코딩 각각의 예측 오차를 비교하여 나타내는 도면. 도 5는 본 발명의 일 실시예에 따른, 심층신경망과 심전도를 이용하여 심박출률을 예측할 때 정규화, 원 핫 인 코딩, 소프트 인코딩 각각에서 라벨과 복원값 사이의 산점도를 비교하여 나타내는 도면. 도 6은 본 발명의 일 실시예에 따른, 심층신경망과 심전도를 이용하여 심박출률을 예측할 때의 정확도를, 정규 화, 원 핫 인코딩, 소프트 인코딩 각각에서 혼동행렬을 통해 비교하여 시각화한 도면."}
