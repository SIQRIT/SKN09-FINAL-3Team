{"patent_id": "10-2021-0139303", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2023-0055659", "출원번호": "10-2021-0139303", "발명의 명칭": "시계열적 이미지 세트에 대한 세그멘테이션 방법 및 장치", "출원인": "주식회사 온택트헬스", "발명자": "김세근"}}
{"patent_id": "10-2021-0139303", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "이미지 세그멘테이션 방법에 있어서,적어도 하나의 이미지를 획득하는 단계; 및시계열 데이터 모델링을 포함하는 인공지능 모델에 기초하여 상기 적어도 하나의 이미지를 세그멘테이션(segmentation)하는 단계;를 포함하되,상기 인공지능 모델은, 기준 이미지로부터 전파된 이미지(propagated image) 및 상기 기준 이미지에 부가된 레이블로부터 전파된 레이블(propagated label)에 기초하여 학습되고, 손실 함수(loss function) 연산 시 적용되는 상기 전파된 이미지에 대한 가중치는, 상기 기준 이미지에 대한 가중치보다 낮은, 방법."}
{"patent_id": "10-2021-0139303", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 기준 이미지는, 시계열적 이미지들 중 일부인, 방법."}
{"patent_id": "10-2021-0139303", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1항에 있어서,상기 적어도 하나의 이미지는, 심장 이미지이고, 상기 레이블은, 상기 심장 이미지의 적어도 하나의 챔버의 경계를 지시하는, 방법."}
{"patent_id": "10-2021-0139303", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제3항에 있어서,상기 기준 이미지는, 심장 사이클(cardiac cycle) 중 적어도 하나의 상태에 촬영된 이미지를 포함하는, 방법."}
{"patent_id": "10-2021-0139303", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제4항에 있어서,상기 적어도 하나의 상태는, 이완기 중기(Mid-systole), 이완기 말기(End-systole), 수축기 중기(Mid-diastole) 및 수축기 말기(End-diastole) 중 적어도 하나를 포함하고,상기 전파된 이미지는, 상기 심장 사이클 중 상기 적어도 하나의 상태 외 나머지 상태를 표현하는, 방법."}
{"patent_id": "10-2021-0139303", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제2항에 있어서,상기 전파된 이미지 및 상기 전파된 레이블은, 모션 벡터 필드(motion vector field)에 기초하여 획득되고,공개특허 10-2023-0055659-3-상기 모션 벡터 필드는, 상기 기준 이미지 및 상기 기준 이미지와 다른 시간에 촬영된 이미지에 기초하여 결정되는, 방법."}
{"patent_id": "10-2021-0139303", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제6항에 있어서,상기 인공지능 모델은, 시계열적 이미지들을 입력 데이터로서 수용하고, 하나의 시간에 생성된 히든 상태를 다음 시간에서의 예측을 위해 순환적으로 사용하는 구조를 가지는, 방법."}
{"patent_id": "10-2021-0139303", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "이미지 세그멘테이션 장치에 있어서,인공지능 모델을 저장하는 저장부; 및상기 저장부와 연결된 적어도 하나의 프로세서를 포함하며,상기 적어도 하나의 프로세서는, 적어도 하나의 이미지를 획득하고,시계열 데이터 모델링을 포함하는 인공지능 모델에 기초하여 상기 적어도 하나의 이미지를 세그멘테이션(segmentation)하도록 제어하되,상기 인공지능 모델은, 기준 이미지로부터 전파된 이미지(propagated image) 및 상기 기준 이미지에 부가된 레이블로부터 전파된 레이블(propagated label)에 기초하여 학습되고, 손실 함수(loss function) 연산 시 적용되는 상기 전파된 이미지에 대한 가중치는, 상기 기준 이미지에 대한 가중치보다 낮은, 장치."}
{"patent_id": "10-2021-0139303", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "프로세서에 의해 동작되면 제1항 내지 제7항 중의 어느 한 항에 따른 방법을 실행하기 위해 매체에 저장된 프로그램."}
{"patent_id": "10-2021-0139303", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 시계열적 이미지 세트에 대한 세그멘테이션을 수행하기 위한 것으로, 이미지 세그멘테이션 방법은, 적 어도 하나의 이미지를 획득하는 단계 및 시계열 데이터 모델링을 포함하는 인공지능 모델에 기초하여 상기 적어 도 하나의 이미지를 세그멘테이션(segmentation)하는 단계를 포함할 수 있다. 상기 인공지능 모델은, 기준 이미 지로부터 전파된 이미지(propagated image) 및 상기 기준 이미지에 부가된 레이블로부터 전파된 레이블 (propagated label)에 기초하여 학습될 수 있다. 손실 함수(loss function) 연산 시 적용되는 상기 전파된 이미 지에 대한 가중치는, 상기 기준 이미지에 대한 가중치보다 낮다."}
{"patent_id": "10-2021-0139303", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 이미지 세그멘테이션(segmentation) 방법에 관한 것으로서, 특히 시계열적 이미지 세트에 대한 세그 멘테이션을 수행하기 위한 방법 및 장치에 관한 것이다."}
{"patent_id": "10-2021-0139303", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "질병은 인간의 심신에 장애를 일으켜서 정상적인 기능을 저해하는 상태를 의미하는 것으로, 질병에 따라 인간은 고통을 받고 심지어 생을 유지하지 못할 수 있다. 따라서, 질병을 진단하고, 치료하고 나아가 예방하기 위한 다 양한 사회적 시스템 및 기술들이 인류의 역사와 함께 발전해왔다. 질병의 진단 및 치료에 있어서, 기술의 눈부 신 발전에 따라 다양한 도구들 및 방식들이 개발되어 왔지만, 아직까지, 종국적으로는 의사의 판단에 의존하고 있는 현실이다. 한편, 최근 인공지능(artificial intelligence, AI) 기술이 크게 발전하면서 다양한 분야에서 주목되고 있다. 특히, 방대한 양의 누적된 의료 데이터와, 영상 위주의 진단 데이터 등의 환경으로 인해, 의료 분야에 인공지능 알고리즘을 접목하려는 다양한 시도와 연구가 진행 중이다. 구체적으로, 질병을 진단, 예측하는 등 종래의 임상적 판단에 머물러 있던 작업들을 인공지능 알고리즘을 이용하여 해결하려는 다양한 연구가 이루어지고 있다."}
{"patent_id": "10-2021-0139303", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은 효과적인 이미지 세그멘테이션(segmentation)을 위한 방법 및 장치를 제공하기 위한 것이다. 본 발명은 시계열적 이미지 세트에 대한 세그멘테이션을 위한 방법 및 장치를 제공하기 위한 것이다. 본 발명은 시계열적 이미지 세트 중 일부에 대한 레이블(label)에 기반하여 레이블링된 시계열적 이미지 세트를 생성하기 위한 방법 및 장치를 제공하기 위한 것이다. 본 발명은 시계열적 이미지 세트 중 일부에 대한 레이블을 이용하여 시계열적 이미지를 입력으로 수용 가능하도 록 인공지능 모델을 훈련하기 위한 방법 및 장치를 제공하기 위한 것이다. 본 발명에서 이루고자 하는 기술적 과제들은 이상에서 언급한 기술적 과제들로 제한되지 않으며, 언급하지 않은"}
{"patent_id": "10-2021-0139303", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 2, "content": "또 다른 기술적 과제들은 아래의 기재로부터 본 발명이 속하는 기술분야에서 통상의 지식을 가진 자에게 명확하 게 이해될 수 있을 것이다."}
{"patent_id": "10-2021-0139303", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명의 일 실시 예로서, 이미지 세그멘테이션 방법은 적어도 하나의 이미지를 획득하는 단계 및 시계열 데이 터 모델링을 포함하는 인공지능 모델에 기초하여 상기 적어도 하나의 이미지를 세그멘테이션(segmentation)하는 단계를 포함할 수 있다. 상기 인공지능 모델은 기준 이미지로부터 전파된 이미지(propagated image) 및 상기 기 준 이미지에 부가된 레이블로부터 전파된 레이블(propagated label)에 기초하여 학습될 수 있다. 손실 함수 (loss function) 연산 시 적용되는 상기 전파된 이미지에 대한 가중치는, 상기 기준 이미지에 대한 가중치보다 낮다. 상기 기준 이미지는 시계열적 이미지들 중 일부일 수 있다. 상기 적어도 하나의 이미지는 심장 이미지일 수 있다. 상기 레이블은 상기 심장 이미지의 적어도 하나의 챔버의 경계를 지시할 수 있다. 상기 기준 이미지는 심장 사이클(cardiac cycle) 중 적어도 하나의 상태에 촬영된 이미지를 포함할 수 있다. 상기 적어도 하나의 상 태는 이완기 중기(Mid-systole), 이완기 말기(End-systole), 수축기 중기(Mid-diastole) 및 수축기 말기(End- diastole) 중 적어도 하나를 포함할 수 있다. 상기 전파된 이미지는 상기 심장 사이클 중 상기 적어도 하나의 상태 외 나머지 상태를 표현할 수 있다. 상기 전파된 이미지 및 상기 전파된 레이블은 모션 벡터 필드(motion vector field)에 기초하여 획득될 수 있다. 상기 모션 벡터 필드는 상기 기준 이미지 및 상기 기준 이미지와 다 른 시간에 촬영된 이미지에 기초하여 결정될 수 있다. 상기 인공지능 모델은 시계열적 이미지들을 입력 데이터 로서 수용하고, 하나의 시간에 생성된 히든 상태를 다음 시간에서의 예측을 위해 순환적으로 사용하는 구조를 가질 수 있다. 본 발명의 일 실시 예로서, 이미지 세그멘테이션 장치는 인공지능 모델을 저장하는 저장부 및 상기 저장부와 연 결된 적어도 하나의 프로세서를 포함할 수 있다. 상기 적어도 하나의 프로세서는 적어도 하나의 이미지를 획득 하고, 시계열 데이터 모델링을 포함하는 인공지능 모델에 기초하여 상기 적어도 하나의 이미지를 세그멘테이션 (segmentation)하도록 제어할 수 있다. 상기 인공지능 모델은 기준 이미지로부터 전파된 이미지(propagated image) 및 상기 기준 이미지에 부가된 레이블로부터 전파된 레이블(propagated label)에 기초하여 학습될 수 있 다. 손실 함수(loss function) 연산 시 적용되는 상기 전파된 이미지에 대한 가중치는 상기 기준 이미지에 대한 가중치보다 낮다. 본 발명의 일 실시 예에 따른, 매체에 저장된 프로그램은, 프로세서에 의해 동작되면 전술한 방법을 실행할 수 있다."}
{"patent_id": "10-2021-0139303", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 2, "content": "본 발명에 대하여 위에서 간략하게 요약된 특징들은 후술하는 본 발명의 상세한 설명의 예시적인 양상일 뿐이며, 본 발명의 범위를 제한하는 것은 아니다."}
{"patent_id": "10-2021-0139303", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명에 따르면, 장치가 시계열적 이미지 세트로부터 목표 대상을 효과적으로 세그멘테이션(segmentation)할 수 있다."}
{"patent_id": "10-2021-0139303", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 2, "content": "본 발명에서 얻을 수 있는 효과는 이상에서 언급한 효과들로 제한되지 않으며, 언급하지 않은 또 다른 효과들은 아래의 기재로부터 본 발명이 속하는 기술분야에서 통상의 지식을 가진 자에게 명확하게 이해될 수 있을 것이다."}
{"patent_id": "10-2021-0139303", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하에서는 첨부한 도면을 참고로 하여 본 발명의 실시 예에 대하여 본 발명이 속하는 기술 분야에서 통상의 지 식을 가진 자가 용이하게 실시할 수 있도록 상세히 설명한다. 그러나, 본 발명은 여러 가지 상이한 형태로 구현 될 수 있으며 여기에서 설명하는 실시 예에 한정되지 않는다. 본 발명의 실시 예를 설명함에 있어서 공지 구성 또는 기능에 대한 구체적인 설명이 본 발명의 요지를 흐릴 수 있다고 판단되는 경우에는 그에 대한 상세한 설명은 생략한다. 그리고, 도면에서 본 발명에 대한 설명과 관계없 는 부분은 생략하였으며, 유사한 부분에 대해서는 유사한 도면 부호를 붙였다. 본 발명은 인공지능 알고리즘을 이용하여 이미지 세그멘테이션을 수행하기 위한 것으로서, 구체적으로, 인공지 능을 이용하여 시계열적 이미지 셋트에 대한 세그멘테이션 기술에 관한 것이다. 도 1은 본 발명의 일 실시 예에 따른 시스템을 도시한다. 도 1을 참고하면, 시스템은 서비스 서버, 데이터 서버, 적어도 하나의 클라이언트 장치를 포함 한다. 서비스 서버는 인공지능 모델 기반의 서비스를 제공한다. 즉, 서비스 서버는 인공지능 모델을 이용하 여 학습 및 예측 동작을 수행한다. 서비스 서버는 네트워크를 통해 데이터 서버 또는 적어도 하나의 클라이언트 장치와 통신을 수행할 수 있다. 예를 들어, 서비스 서버는 데이터 서버로부터 인공 지능 모델을 훈련하기 위한 학습 데이터를 수신하고, 훈련을 수행할 수 있다. 서비스 서버는 적어도 하나 의 클라이언트 장치로부터 학습 및 예측(prediction) 동작에 필요한 데이터를 수신할 수 있다. 또한, 서비 스 서버는 적어도 하나의 클라이언트 장치에게 예측 결과에 대한 정보를 송신할 수 있다. 데이터 서버는 서비스 서버에 저장된 인공지능 모델의 훈련을 위한 학습 데이터를 제공한다. 다양한 실시 예들에 따라, 데이터 서버는 누구나 접근 가능한 공공 데이터를 제공하거나 또는 허가를 필요로 하는 데이터를 제공할 수 있다. 필요에 따라, 학습 데이터는 데이터 서버에 의해 또는 서비스 서버에 의해전처리할 수 있다. 다른 실시 예에 따라, 데이터 서버는 생략될 수 있다. 이 경우, 서비스 서버는 외 부에서 훈련된 인공지능 모델을 사용하거나 또는 서비스 서버에 오프라인으로 학습 데이터가 제공될 수 있 다. 적어도 하나의 클라이언트 장치는 서비스 서버에 의해 운용되는 인공지능 모델에 관련된 데이터를 서 비스 서버와 송신 및 수신한다. 적어도 하나의 클라이언트 장치는 사용자에 의해 사용되는 장비이며, 사용자에 의해 입력되는 정보를 서비스 서버에게 송신하고, 서비스 서버로부터 수신되는 정보를 저장 하거나 사용자에게 제공(예: 표시)할 수 있다. 경우에 따라, 어느 하나의 클라이언트로부터 송신된 데이터에 기 반하여 예측 동작이 수행되고, 예측의 결과에 관련된 정보가 다른 클라이언트에게 제공될 수 있다. 적어도 하나 의 클라이언트 장치는 데스크탑 컴퓨터, 랩탑 컴퓨터, 스마트폰, 타블렛, 웨어러블 기기 등 다양한 형태의 컴퓨팅 장치일 수 있다. 도 1에 도시되지 아니하였으나, 시스템은 서비스 서버를 관리하기 위한 관리 장치를 더 포함할 수 있다. 관리 장치는 서비스를 관리하는 주체에 의해 사용되는 장치로서, 서비스 서버의 상태를 모니터링하거나, 서비스 서버의 설정을 제어한다. 관리 장치는 네트워크를 통해 서비스 서버에 접속하거나 또는 케이 블 연결을 통해 직접 연결될 수 있다. 관리 장치의 제어에 따라, 서비스 서버는 동작을 위한 파라미터를 설정할 수 있다. 도 1을 참고하여 설명한 바와 같이, 서비스 서버, 데이터 서버, 적어도 하나의 클라이언트 장치 , 관리 장치 등이 네트워크를 통해 연결되고, 상호작용할 수 있다. 여기서, 네트워크는 유선 네트워크 및 무선 네트워크 중 적어도 하나를 포함할 수 있고, 셀룰러 네트워크, 근거리 네트워크, 광역 네트워크 중 어느 하나 또는 둘 이상의 조합으로 이루어질 수 있다. 예를 들어, 네트워크는 LAN(local area network), WLAN(wireless LAN), 블루투스(bluetooth), LTE(long term evolution), LTE-A(LTE-advanced), 5G(5th generation) 중 적어도 하나에 기반하여 구현될 수 있다. 도 2는 본 발명의 일 실시 예에 따른 질병 발생 가능성을 예측하는 장치의 구조를 도시한다. 도 2에 예시된 구 조는 도 1의 서비스 서버, 데이터 서버, 적어도 하나의 클라이언트 장치의 구조로 이해될 수 있 다. 도 2를 참고하면, 장치는, 통신부, 저장부, 제어부를 포함한다. 통신부는 네트워크에 접속하고, 다른 장치와 통신을 수행하기 위한 기능을 수행한다. 통신부는 유선 통신 및 무선 통신 중 적어도 하나를 지원할 수 있다. 통신을 위해, 통신부는 RF(radio frequency) 처리 회로, 디지털 데이터 처리 회로 중 적어도 하나를 포함할 수 있다. 경우에 따라, 통신부는 케이블을 연결 하기 위한 단자를 포함하는 구성요소로 이해될 수 있다. 통신부는 데이터, 신호를 송신 및 수신하기 위한 구성요소이므로, '송수신부(transceiver)'라 지칭될 수 있다. 저장부는 장치의 동작을 위해 필요한 데이터, 프로그램, 마이크로 코드, 명령어 집합, 어플리케이션 등을 저장한다. 저장부는 일시적 또는 비일시적 저장 매체로 구현될 수 있다. 또한, 저장부는 장치에 고정 되어 있거나, 또는 분리 가능한 형태로 구현될 수 있다. 예를 들어, 저장부는 콤팩트 플래시(compact flash, CF) 카드, SD(secure digital) 카드, 메모리 스틱(memory stick), 솔리드 스테이트 드라이브(solid- state drive; SSD) 및 마이크로(micro) SD 카드 등과 같은 낸드 플래시 메모리(NAND flash memory), 하드 디스 크 드라이브(hard disk drive; HDD) 등과 같은 마그네틱 컴퓨터 기억 장치 중 적어도 하나로 구현될 수 있다. 제어부는 장치의 전반적인 동작을 제어한다. 이를 위해, 제어부는 적어도 하나의 프로세서, 적어도 하나의 마이크로 프로세서 등을 포함할 수 있다. 제어부는 저장부에 저장된 프로그램을 실행하고, 통 신부를 통해 네트워크에 접속할 수 있다. 특히, 제어부는 후술하는 다양한 실시 예들에 따른 알고리 즘들을 수행하고, 후술하는 실시 예들에 따라 장치가 동작하도록 제어할 수 있다. 도 1 및 도 2를 참고하여 설명한 구조에 기반하여, 본 발명의 다양한 실시 예들에 따른 인공지능 알고리즘 기반 의 서비스가 제공될 수 있다. 여기서, 인공지능 알고리즘을 구현하기 위해 인공 신경망으로 이루어진 인공지능 모델이 사용될 수 있다. 인공 신경망의 구성 단위인 퍼셉트론(perceptron) 및 인공 신경망의 개념은 다음과 같 다.퍼셉트론은 생물의 신경 세포를 모델링한 것으로서, 다수의 신호들을 입력으로 삼아 하나의 신호를 출력하는 구 조를 가진다. 도 3은 본 발명에 적용 가능한 인공지능 모델을 구성하는 퍼셉트론의 예를 도시한다. 도 3을 참고 하면, 퍼셉트론은 입력 값들(예: x1, x2, x3, …, xn) 각각 대하여 가중치들(302-1 내지 302-n)(예: w1j, w2j, w3j, …, wnj)을 곱한 후, 가중치 곱해진(weighted) 입력 값들을 변환 함수(transfer function)을 이용하여 합산한다. 합산 과정에서, 바이어스(bias) 값(예: bk)이 더해질 수 있다. 퍼셉트론은 변환 함수의 출력인 네트(net) 입력 값(예: netj)에 대하여 활성 함수(activation function)을 적용함으로써, 출력 값(예: o j)를 생성한다. 경우에 따라, 활성 함수은 임계치(예: θj)에 기반하여 동작할 수 있다. 활성 함수는 다양 하게 정의될 수 있다. 본 발명이 이에 제한되는 것은 아니나, 예를 들어, 활성 함수로서, 스텝 함수(step function), 시그모이드(sigmoid), Relu, Tanh 등이 사용될 수 있다. 도 3와 같은 퍼셉트론들이 나열되고, 레이어를 이룸으로써 인공 신경망이 설계될 수 있다. 도 4는 본 발명에 적 용 가능한 인공지능 모델을 구성하는 인공 신경망의 예를 도시한다. 도 4에서, 원으로 표현된 각 노드는 도 3의 퍼셉트론으로 이해될 수 있다. 도 4를 참고하면, 인공 신경망은 입력 레이어(input layer), 복수의 은닉 레이어(hidden layer)들(404a, 404b), 출력 레이어(output layer)를 포함한다. 예측을 수행하는 경우, 입력 레이어의 각 노드로 입력 데이터가 제공되면, 입력 데이터는 입력 레이어 , 은닉 레이어들(404a, 404b)을 이루는 퍼셉트론들에 의한 가중치 적용, 변환 함수 연산 및 활성 함수 연 산 등을 거쳐 출력 레이어까지 순전파(forward propagation)된다. 반대로, 훈련을 수행하는 경우, 출력 레 이어로부터 입력 레이어를 향한 역전파(backward propagation)를 통해 오차가 계산되고, 계산된 오차 에 따라 각 퍼셉트론에 정의된 가중치 값들이 갱신될 수 있다 RNN(recurrent neural network)은 과거에 입력된 정보를 이용하여 현재의 상태를 판단하는 구조를 발현한 인공 신경망이다. RNN은 반복적 구조를 이용하여 이전 단계에서 획득된 정보를 지속적으로 이용한다. RNN의 일종으로 서, LSTM(long short-term memory) 네트워크가 제안된 바 있다. LSTM 네트워크는 장기(long-term) 의존성을 제 어하기 위해 제안된 것으로서, RNN과 마찬가지로 반복적 구조를 가진다. LSTM 네트워크의 구조는 이하 도 5a 및 도 5b와 같다. 도 5a 및 도 5b는 본 발명에 적용 가능한 LSTM 네트워크의 예를 도시한다. 도 5a를 참고하면, LSTM 네트워크는 이전 상태 (t-1)의 h와 현재 상태 (t)의 입력(xt)을 통해 다음 네트워크에 전달할 현 상태 h를 제공한다. LSTM 네트워크는 내부적으로 이전 상태 정보를 이용할지 결정하는 r의 상태를 통 하여 이전 상태를 시계열적으로 계산한다. 은닉 네트워크는 시그모이드 네트워크들(502a, 502b), tanh 네트워크 들, 곱셈 연산자들(506a, 506b, 506c), 덧셈 연산자을 포함한다. 시그모이드 네트워크들(502a, 502b) 각각은 가중치 및 바이어스를 가지며, 활성 함수로서 시그모이드 함수를 사용한다. tanh 네트워크는 가중치 및 바이어스를 가지며, 활성 함수로서 시그모이드 tanh 함수를 사용한다. 시그모이드 네트워크(502a)는 ht-1 및 xt의 가중치 합을 적용한 후, 결과 값 rt를 곱셈 연산자(506a)에게 제공한다. 시그모이드 네트워크(502 b)는 ht-1 및 xt의 가중치 합을 적용한 후, 결과 값 zt를 곱셈 연산자(506b, 506c)에게 제공한다. 시그모이드 네 트워크(502b)는 결과 값을 1- 연산자를 통해 곱셈 연산자(506b)에게 제공한다. 곱셈 연산자(506b)는 ht-1 및 시 그모이드 네트워크(502b)로부터 1-연산자를 통해 제공된 값에 곱셈을 적용하여 덧셈 연산자에게 제공한다. tanh 네트워크는 현재 시점 t의 입력 xt에 대해 tanh 함수를 적용한 후, 결과 값 를 곱셈 연산자(506b) 를 통해 덧셈 연산자에게 제공한다. 덧셈 연산자는 입력 받은 값들을 적용하여 ht를 결과값으로 출력한다. 도 5b를 참고하면, LSTM 네트워크는 입력 레이어 및 출력 레이어 사이의 은닉 네트워크(510-1 내지 510-3)이 반 복되는 구조를 가진다. 이에 따라, 시간의 흐름에 따른 입력들 xt-1, xt, xt+1 등이 제공되면, 시점 t-1에서의 입 력 xt-1를 위한 은닉 네트워크(510-1)에서 출력되는 은닉 상태(hidden state) 값은 다음 시점 t에서의 입력 xt와 함께 다음 시점 t를 위한 은닉 네트워크(510-2)로 입력된다. 은닉 네트워크(510-2)는 시그모이드 네트워크들 (512a, 512b, 512c), tanh 네트워크들(514a, 514b), 곱셈 연산자들(516a, 516b, 516c), 덧셈 연산자을 포함한다. 시그모이드 네트워크들(512a, 512b, 512c) 각각은 가중치 및 바이어스를 가지며, 활성 함수로서 시그모 이드 함수를 사용한다. tanh 네트워크들(514a, 514b) 각각은 가중치 및 바이어스를 가지며, 활성 함수로서 시그 모이드 tanh 함수를 사용한다. 시그모이드 네트워크(512a)은 망각 게이트(forget gate)로서 기능한다. 시그모이드 네트워크(512a)은 이전 시점 의 은닉 레이어의 은닉 상태 값 ht-1 및 현재 시점의 입력 xt의 가중치 합에 대해 시그모이드 함수를 적용한 후, 결과 값을 곱셈 연산자(516a)로 제공한다. 시그모이드 함수의 결과 값은 곱셈 연산자(516a)에 의해 이전 시점의 셀 메모리(cell memory) 값 Ct-1와 곱해진다. 이를 통해, LSTM 네트워크는 이전 시점의 메모리 값을 망각할지 여 부를 판단할 수 있다. 즉, 시그모이드 네트워크(512a)의 출력 값은 이전 시점의 셀 메모리 값 Ct-1를 얼마나 유 지할 것인지를 지시한다. 시그모이드 네트워크(512b) 및 tanh 네트워크는 입력 게이트(input gate)로서 기능한다. 시그모이드 네트 워크(512b)은 이전 시점 t-1의 은닉 상태 값 ht-1 및 현재 시점 t의 입력 xt의 가중치 합에 대해 시그모이드 함 수를 적용한 후, 결과 값 it를 곱셈 연산자(516b)로 제공한다. tanh 네트워크는 이전 시점 t-1의 은닉 상 태 값 ht-1 및 현재 시점 t의 입력 xt의 가중치 합에 대해 tanh 함수를 적용한 후, 결과 값 를 곱셈 연산자 (516b)로 제공한다. 시그모이드 네트워크(512b)의 결과 값 it 및 tanh 네트워크의 결과 값 은 곱셈 연 산자(516b)에 의해 곱해진 후, 덧셈 연산자에 제공된다. 이를 통해, LSTM 네트워크는 현재 시점의 셀 메모 리 값 Ct에 현재 시점의 입력 xt를 얼마나 반영할지를 결정하고, 결정에 따라 스케일링(scaling)할 수 있다. 덧 셈 연산자에 의해, 망각 계수와 곱해진 이전 시점의 셀 메모리 값 Ct-1·ft 및 가 합산된다. 이를 통해, LSTM 네트워크는 현재 시점의 셀 메모리 값 Ct를 결정할 수 있다. 시그모이드 네트워크(512c), tanh 네트워크(514b), 곱셈 연산자(516c)는 출력 게이트로서 기능한다. 출력 게이 트는 현재 시점의 셀 상태에 기반하여 필터링된 값을 출력한다. 시그모이드 네트워크(512c)는 이전 시점 t-1의 은닉 상태 값 ht-1 및 현재 시점 t의 입력 xt의 가중치 합에 대해 시그모이드 함수를 적용한 후, 결과 값 ot를 곱 셈 연산자(516b)로 제공한다. tanh 네트워크(514b)는 현재 시점t의 셀 메모리 값 Ct에 대해 tanh 함수를 적용한 후, 결과 값을 곱셈 연산자(516c)에 제공한다. 곱셈 연산자(516c)는 tanh 네트워크(514b)의 결과 값 및 시그모 이드 네트워크(512c)의 결과 값을 곱함으로써 현재 시점 t의 은닉 상태 값 ht를 생성한다. 이를 통해, LSTM 네 트워크는 현재 시점의 셀 메모리 값을 은닉 레이어에서 얼마나 유지할지를 제어할 수 있다. LSTM 모델은 다양한 변형 모델을 가진다. 도 5b는 LSTM 변형 모델의 일 예를 도시한다. 본 발명에서 이용되는 LSTM 모델은 상술한 실시예로 제한되지 않으며 다양한 변형 모델들이 이용될 수 있다. 이미지 세그멘테이션은 이미지 분석 작업의 일종으로, 이미지 내에 표현된 대상(object)들 중 관심 있는 목표 (target) 대상을 표현한 영역(예: 픽셀들 또는 복셀들의 집합)을 검출 또는 추출하는 연산을 의미한다. 일반적 으로, 촬영을 통해 획득된 이미지는 관심 대상 외 주변의 다른 대상들을 함께 표현하고 있기 때문에, 이미지 세 그멘테이션을 통해 관심 대상과 그 외의 대상을 구분하는 것이 요구된다. 이미지 세그멘테이션은 단일 이미지에 대하여 수행될 수 있으나, 시계열적인 이미지 세트가 존재하는 경우, 세그멘테이션이 수행될 이미지의 전 또는 후의 몇몇 이미지들을 더 이용함으로써 이미지 세그멘테이션의 정확도가 향상될 가능성이 있다. 이에, 본 발명 은 시계열적인 이미지 세트를 이용하여 이미지 세그멘테이션을 수행하는 다양한 실시 예들을 설명한다. 특히, 본 발명은, 시계열적인 이미지 세트 중 일부 이미지에만 세그멘테이션 결과를 표현하는 레이블(label)이 부가된 경우, 나머지 주변 이미지들에 대응하는 레이블링된(labeled) 이미지를 생성하고, 생성된 레이블링된 이미지들 을 활용하는 다양한 실시 예들을 설명한다. 도 6은 본 발명의 일 실시 예에 따라 이미지 세그멘테이션을 위한 훈련(training) 절차를 도시한다. 도 6은 연 산 능력을 가진 장치(예: 도 1의 서비스 서버)의 동작 방법을 예시한다.도 6을 참고하면, S601 단계에서, 장치는 이미지 및 레이블을 획득한다. 여기서, 레이블은 이미지에서 세그먼테 이션된 영역을 특정하는 지시자를 포함할 수 있다. 예를 들어, 레이블은 이미지에서 검출 대상의 경계를 지시할 수 있다. 이미지는 시계열적 이미지들 중 일부이며, 시계열적 이미지들은 주기성을 가지고 활동하는 대상을 촬 영한 이미지들을 포함할 수 있다. 이에 따라, 이미지들 역시 주기성을 가질 수 있다. 다만, 서로 다른 사이클들 의 동일한 상태에 대응하는 이미지들이 동일함이 보장되지는 않는다. 본 절차에서, 레이블을 가지는 이미지는 기준 이미지라 지칭될 수 있다. S603 단계에서, 장치는 기준 이미지로부터 전파된 이미지 및 전파된 레이블을 획득할 수 있다. 구체적으로, 장 치는 기준 이미지 및 기준 이미지와 시간 차를 가지는 이미지에 기초하여 모션 벡터 필드(motion vector fiel d)를 결정하고, 모션 벡터 필드에 기초하여 전파된 이미지 및 전파된 레이블을 획득할 수 있다. 즉, 장치는 학 습 데이터를 증강할 수 있다. 이를 통해, 장치는 인공지능 모델에 대한 학습을 수행하는데 필요한 데이터셋을 획득할 수 있다. 여기서, 모션 벡터 필드는 두 이미지들 간 차이점을 나타내는 정보로서, 이미지에 표현된 대상 이 두 이미지들이 촬영된 시점들 간 어떻게 변화하였는지를 나타낸다. 장치는 인공지능 모델에 기초하여 모션 벡터 필드를 결정하거나, 또는 옵티컬 플로우(optical flow)에 기반하여 모션을 측정할 수 있다. 일 예로, 장치 는 LiteflowNet에 기반하여 모션을 측정할 수 있다. 여기서, 인공지능 모델은 CNN(convolutional neural network)에 기반할 수 있다, S605 단계에서, 장치는 시계열 데이터 모델링을 포함하는 인공지능 모델을 학습한다. 여기서, 시계열 데이터 모 델링은 시계열적 데이터(예: 이미지들)을 기반으로 예측을 수행하도록 구조화하는 것을 의미한다. 구체적으로, 장치는 획득한 기준 이미지 및 레이블, 전파된 이미지 및 전파된 레이블에 기초하여 인공지능 모델을 학습할 수 있다. 일 실시 예에 따라, 인공지능 모델은 순환 구조의 인공 신경망을 가질 수 있다. 도 6을 참고하여 상술하였듯이, 장치는 모션 벡터 필드에 기초하여 이미지 및 레이블을 전파함으로써 추가적인 레이블링된 이미지를 획득할 수 있다. 예를 들어, 모션 벡터 필드를 이용하면, 장치는 시간 t에서의 이미지로부 터 이와 근접한 다른 시간들(예: 시간 t-1, 시간 t+1)에서의 이미지들을 획득할 수 있다. 일 실시 예에 따라, 장치는 획득된 복수의 이미지들에 기초하여 학습할 수 있다. 즉, 장치는 시간 t-1에서의 이미지, 시간 t에서의 이미지, 시간 t+1에서의 이미지의 특징(feature)들을 추출하고, 추출된 특징들 및 레이블들을 훈련을 위해 이용 할 수 있다. 또한, 상술하였듯이, 인공지능 모델은 순환 구조를 가질 수 있다. 예를 들어, 인공지능 모델은 이하 도 7과 같 은 구조를 가질 수 있다. 도 7은 본 발명의 일 실시 예에 따른 인공지능 모델의 구조를 도시한다. 인공지능 모 델은 시간(time)에 따른 입력을 가진다. 즉, 장치는 시간 별 이미지들(예: 시간 1 내지 시간 7의 이미지들)을 인공지능 모델에 입력할 수 있다. 구체적으로, 장치는 이미지들을 순차적으로 히든 레이어(hidden layer)에 입력하고, 히든 레이어에서 추출된 특징은 출력으로 제공되고 또한 순환 경로에 따라 다시 다음 시간의 히든 레이어로 입력된다. 이에 따라, 현재의 히든 상태 및 과거의 히든 상태들에 기반한 출력 이 생성될 수 있다. 전술한 바와 같이 인공지능 모델이 훈련될 수 있다. 일반적으로, 훈련은 역전파(back-propagation)를 통해 가중 치를 갱신하는 과정을 포함하며, 이때 예측 결과의 오차를 결정하기 위해 가중치화된 손실 함수(weighted loss function)가 사용될 수 있다. 가중치화된 손실 함수는 복수의 이미지들로부터 예측된 결과 및 복수의 이미지들 의 레이블들 간 오차를 가중치 합(weighted sum)함으로써 손실 값을 결정한다. 이때, 전파를 통해 생성된 이미 지에 부여되는 가중치는 기준 이미지에 부여되는 가중치보다 낮을 수 있다. 다시 말해, 전파된 레이블에 대한 가중치가 레이블에 대한 가중치보다 낮을 수 있다. 전파를 통해 생성된 이미지 및 레이블은 수도(pseudo) 이미 지 및 레이블이기 때문이다. 전파된 이미지에 대한 가중치를 기준 이미지 보다 낮게 설정함으로써, 전파에 의해 생성된 이미지 및 레이블의 상대적으로 낮은 신뢰성이 훈련에 반영될 수 있다. 도 8은 본 발명의 실시 예에 따른 이미지 세그멘테이션 절차를 도시한다. 도 8은 연산 능력을 가진 장치(예: 도 1의 서비스 서버)의 동작 방법을 예시한다. 도 8을 참고하면, S801 단계에서, 장치는 이미지를 획득한다. 장치는 복수의 이미지들을 획득할 수 있다. 획득 한 복수의 이미지들은 시계열적 관계를 가질 수 있다. 예를 들어, 복수의 이미지들은 일정한 시간 간격으로 촬 영된 이미지들을 포함할 수 있다. S803 단계에서, 장치는 시계열 데이터 모델링을 포함하는 인공지능 모델을 이용하여 획득한 이미지를 세그멘테 이션한다. 여기서, 인공지능 모델은 전파된 이미지, 전파된 레이블을 이용하여 학습된 상태이며, 시계열적 이미 지들을 입력으로 수용할 수 있다. 일 실시 예에 따라, 장치는 시계열적 이미지들(예: 시간 t 내지 시간 t+n-1 까지의 n개의 이미지들)을 입력 데이터로서 사용하고, 시간 t 내지 시간 t+n-1 중 하나의 시간, 시간 t+n-1 이 후의 시간 또는 시간 t 이전의 시간에서의 이미지에 대한 세그먼테이션 결과를 생성할 수 있다. 즉, 장치는 시 계열적 이미지들 각각에서 특징들을 추출하고, 특징들에 기반하여 관심 영역을 검출할 수 있다. 일 실시 예에 따라, 도 8을 참고하여 설명한 실시 예에서 사용되는 인공지능 모델은 도 7과 같은 순환 구조를 가질 수 있다. 예를 들어, 순환 구조로서 LSTM 네트워크가 사용되고, 특징을 추출하기 위한 네트워크로서 ResNet이 사용될 수 있다. 이 경우, 전체적인 인공지능 모델의 구성은 도 9와 같다. 도 9는 본 발명의 일 실시 예에 따른 인공지능 모델의 구체적인 구현 예를 도시한다. 도 9를 참고하면, 인공지 능 모델은 ResNet(910a, 910b) 및 LSTM(920a, 920b)을 포함한다. 도 9에서, ResNet(910a, 910b)은 복수의 네트 워크들로 표현되었으나, 이는 ResNet(910a, 910b)에 의한 특징 추출 동작이 시점 별로 수행됨을 표현한 것으로, 인공지능 모델은 하나의 ResNet을 포함할 수 있다. 유사하게, LSTM(920a, 920b)은 복수의 네트워크들로 표현되 었으나, 인공지능 모델은 출력이 입력으로 피드백되는 재귀적 구조를 가지는 하나의 LSTM을 포함할 수 있다. 도 9을 참고하면, 장치는 시간 t에서의 이미지뿐만 아니라 이와 근접한 시간 t-1에서의 이미지 및 시간 t+1 이 미지를 이용하여 시간 t에서의 이미지에 대한 예측을 수행한다. ResNet(910a)는 시간 t-1에서의 이미지, 시간 t 에서의 이미지, 시간 t+1에서의 이미지의 특징들을 추출할 수 있다. 추출된 특징들은 시계열 데이터 모델링을 구현하기 위한 LSTM(920a)에 입력된다. LSTM(920a)은 특징들에 기반하여 예측 결과(930a)를 생성하고, LSTM(920b)으로 예측 결과(930a)에 대응하는 히든 상태를 전달한다. ResNet(910b)는 시간 t에서의 이미지, 시간 t+1에서의 이미지, 시간 t+2에서의 이미지의 특징들을 추출하고, LSTM(920b)는 추출된 특징들 및 LSTM(920a)으 로부터 제공된 히든 상태에 기반하여 예측 결과(930b)를 생성한다. 전술한 인공지능 모델의 훈련 및 훈련된 인공지능 모델을 이용한 예측의 실시 예들은 심장 이미지에 대한 세그 멘테이션을 위해 적용될 수 있다. 심장 이미지 세그멘테이션의 실시 예가 이하 도 10 및 도 12를 참고하여 설명 된다. 도 10 및 도 12는 본 발명의 실시 예에 따라 심장 이미지 세그멘테이션을 위한 절차를 도시한다. 여기서, 심장 이미지는 심장에 대한 엑스레이, 초음파, CT(computerized tomography), MRI(magnetic resonance imaging), PET(positron emission tomography) 등 다양한 형태의 의료 이미지들 중 하나일 수 있다. 도 10은 본 발명의 일 실시 예에 따른 심장 이미지 세그멘테이션을 위한 훈련 절차를 도시한다. 도 10은 연산 능력을 가진 장치(예: 도 1의 서비스 서버)의 동작 방법을 예시한다. 도 10를 참고하면, S1001 단계에서, 장치는 심장 이미지 및 레이블을 획득한다. 심장 이미지는 시계열적 이미지 들 중 일부이며, 심장 이미지들은 주기성을 가질 수 있다. 심장 이미지는 기준 이미지일 수 있다. 레이블은 심 장 이미지의 적어도 하나의 챔버의 경계를 지시할 수 있다. 즉, 레이블은 심장 이미지의 좌심실, 좌심방, 우심 실 및 우심방 중 적어도 하나의 경계를 지시할 수 있다. 레이블은 경우에 따라 주석, 마스크, 그라운드 트루 라 벨(ground truth label) 등으로 표현될 수 있다. 또 다른 예로, 장치는 폐에 대한 초음파 이미지 및 레이블을 획득할 수 있다. 폐에 대한 초음파 이미지는 시계 열적 이미지들 중 일부이며 호기 및 흡기의 주기성을 가질 수 있다. 레이블은 폐 초음파 이미지의 적어도 하나 의 경계를 지시할 수 있다. 본 발명은 주기성을 가지는 시계열적 이미지들의 세그멘테이션을 위해 적용될 수 있 으며, 상술한 실시예로 제한되지 않는다. 폐 초음파는 민감도(sensitivity)가 높은 진단 방법이다. 일 예로, 장 치는 폐 초음파를 통해 환자 침상에서 촬영되는 흉부 X선과 달리 폐렴, 무기폐, 종양, 횡격막상승 및 흉막삼출 을 구별할 수 있다. 흉부 X선은 중심정맥도관 삽입 등의 술기 후 기흉 또는 수흉증 등의 발생을 평가하기 위해 일상적으로 시행된다. 다만, 흉부 X선의 민감도는 이런 술기 후 생기는 소량의 기흉 또는 수흉증을 발견하기에 매우 낮다. 이에 반하여, 폐초음파는 극소량의 기흉(Pneumothorax), 경화(Consolidation), 폐부종(Pulmonary edema), 무기폐, 폐렴 및 흉막삼출(Pleural effusion) 등에 대하여 진단이 가능하다. S1003 단계에서, 장치는 획득한 심장 이미지에 기초하여 전파된 심장 이미지 및 전파된 레이블을 획득할 수 있 다. 장치는 S701a 단계에서 획득한 심장 이미지 및 상기 심장 이미지와 시계열적 관계를 가지는 이미지를 사용 하여 전파된 심장 이미지 및 전파된 레이블을 획득할 수 있다. 구체적으로, 장치는 S1001 단계에서 획득한 심장 이미지 및 상기 심장 이미지와 시계열적 관계를 가지는 이미지의 모션 벡터 필드를 추정할 수 있다. 예를 들어, 장치는 인공지능 모델에 기초하여 모션 벡터 필드를 추정할 수 있다. 여기서, 장치는 CNN을 이용하여 모션 벡터필드를 추정할 수 있다. 또한, 장치는 옵티컬 플로우(optical flow)에 기반하여 모션을 측정할 수 있다. 일 예 로, 장치는 LiteflowNet에 기반하여 모션을 측정할 수 있다. 장치는 모션 벡터 필드에 기초하여 전파된 심장 이 미지 및 전파된 레이블을 획득할 수 있다. 즉, 장치는 심장 이미지를 증강할 수 있다. 이에 따라, 장치는 심장 주기를 가지는 이미지들 중 일부인 기준 이미지에 기초하여 주기에 포함되는 이미지들을 증강할 수 있다. 장치 는 시계열 데이터 모델링을 수행하는데 충분한 데이터셋을 획득할 수 있다. 즉, 장치는 후술하듯이 도 9에서 후 술되는 각 시간에서의 이미지들을 획득할 수 있다. S1005 단계에서, 장치는 시계열 데이터 모델링을 포함하는 인공지능 모델을 학습할 수 있다. 구체적으로, 장치 는 획득한 심장 이미지 및 레이블, 전파된 심장 이미지 및 전파된 레이블에 기초하여 인공지능 모델을 학습할 수 있다. 예를 들어, 인공지능 모델은 LSTM에 기반할 수 있다. 도 10을 참고하여 설명한 실시 예에 따르면, 장치는 시간 t에서의 심장 이미지뿐만 아니라 이와 근접한 시간 t- 1에서의 심장 이미지 및 시간 t+1 이미지를 획득할 수 있다. 장치는 획득한 이미지에 기초하여 시간 t에서의 예 측을 수행하기 위해 학습할 수 있다. 즉, 장치는 시간 t에서의 심장 이미지에 대하여 예측(prediction)을 수행 하기 위하여 시간 t-1에서의 심장 이미지, 시간 t에서의 심장 이미지 및 시간 t+1에서의 심장 이미지에 기초하 여 특징(feature)를 추출할 수 있다. 일 예로, 장치는 ResNet에 기초하여 특징을 추출할 수 있다. 또한, 장치는 추출한 특징을 LSTM에 기초하여 학습할 수 있다. 또한, 장치는 시계열적 심장 이미지 모델링을 위하여 ConvLSTM 을 사용할 수 있다. 또한, 장치는 근접 프레임들(adjacent frames)을 이용하여 시계열 데이터 모델링을 하기 위 해 3D Conv를 사용할 수 있다. 심장 이미지에서 추출한 특징은 심장 이미지의 좌심실, 좌심방, 우심실 및 우심 방 중 적어도 하나의 경계와 관련될 수 있다. 장치는 복수의 이미지에 기초하여 특징을 추출할 수 있으며, 상술 한 실시 예의 개수로 제한되지 않는다. 다양한 시계열 데이터 모델링과 관련된 인공지능 모델이 사용될 수 있으 며, 상술한 실시예로 제한되지 않는다. 도 10을 참고하여 설명한 실시 예들에 따라, 심장에 대한 이미지가 증강될 수 있다. 증강된 이미지들의 일 예는 이하 도 11과 같다. 도 11는 본 발명의 일 실시 예에 따른 심장 이미지 및 전파된 심장 이미지를 도시한다. 심장 이미지들은 심장 주기(cardiac cycle)를 가질 수 있다. 장치는 심장 이미지들 중에서 기준 이미지로서 이완기 중기(Mid- Diastole), 이완기 말기(End-Diastole), 수축기 중기(Mid-Systole) 및 수축기 말기(End- Systole) 중 적어도 하나의 이미지를 획득할 수 있다. 즉, 기준 이미지는 심장 사이클(cardiac cycle) 중 적어도 하나의 상태에 촬영된 이미지를 포함하는 포함할 수 있으며, 이때 심장 상태는 좌심실의 크기를 기준으 로 파악될 수 있다. 구체적인 일 예로, 장치는 이완기 말기 및 수축기 말기의 이미지들을 기준 이 미지로서 획득할 수 있다. 기준 이미지는 그라운드 트루(groud truth, GT) 레이블을 포함하는 이미지를 의미한 다. 이미지들은 서로 시계열적 관계를 가지고 있으며 시계열 데이터 모델링에 이용되기에 적합하다. 다만, 장치 가 한 번의 심장 주기에서 2장에서 4장 내지의 기준 이미지를 획득한 것 만으로는 시계열 데이터 모델링 구조의 인공지능을 학습하기에 부족할 수 있다. 장치는 상술한 바와 같이 모션 벡터 필드에 기초하여 기준 이미지로부 터 이미지 및 레이블을 전파할 수 있다. 이에 따라, 장치는 복수의 수도 GT(Pseudo GT)들(1122a 내지 1122h)을 획득할 수 있다. 수도 GT들(1122a 내지 1122h)은 전파된 이미지로서 기준 이미지와 함께 심장 주기를 구성할 수 있다. 인공지능 모델의 훈련 중 손실 함수에 의한 손실 값 계산 시, 수도 GT들(1122a 내지 1122h)에 관련된 예 측 결과에 적용되는 가중치는 기준 이미지보다 낮게 설정될 수 있다. 한편, 영상의 모션 추정 값에 기초하여 생성된 수도 이미지(Pseudo image) 및 수도 GT는 실제 심장의 형태와 다 를 수 있다. 이에 따라, 가중치는 실제 이미지 및 실제 GT에서 네트워크 학습을 통한 파라미터 가중치 (parameter weight) 값의 업데이트를 위해 이용될 수 있다. 생성된 수도 이미지 및 수도 GT는 실제 이미지 및 실제 GT와 움직임이 클수록 왜곡될 수 있다. 즉, 한 심장 주기 내 시간 차이가 클수록 심장 모션의 추정이 어렵 다. 따라서 가중치는 실제 영상 생성 기준이 되는 영상과의 시간차이(r) 값이 클수록 감소할 수 있다. 즉, 가중 치는 기준 이미지와의 거리가 멀수록 작아질 수 있다. 여기서, 가중치는 실험 값으로 정해질 수 있다. 또한, 상 기 심장 주기는 일 예로, 정상인의 경우, 분당 맥박수가 60내지 100일 수 있다. 또한, 심장박동이 느린 서맥 환 자의 경우, 분당 맥박수가 60 이하일 수 있다. 또한, 심장박동이 빠른 빈맥 환자의 경우, 분당 맥박수가 100 이 상일 수 있다. 도 12는 본 발명의 실시 예에 따른 심장 이미지에 대한 세그멘테이션 절차를 도시한다. 도 12는 연산 능력을 가 진 장치(예: 도 1의 서비스 서버)의 동작 방법을 예시한다.도 12를 참고하면, 1201 단계에서, 장치는 연속 촬영된 심장 이미지들을 획득한다. 즉, 장치는 복수의 심장 이 미지들을 획득할 수 있다. 획득한 복수의 이미지들은 시계열적 관계를 가질 수 있다. 예를 들어, 심장 이미지들 은 초음파 장비에 의한 촬영 동안 실시간으로 제공될 수 있다. S1203 단계에서, 장치는 시계열 데이터 모델링을 포함하는 인공지능 모델을 이용하여 획득한 심장 이미지를 세 그멘테이션할 수 있다. 여기서, 인공지능 모델은 도 6에서 상술하였듯이 전파된 심장 이미지, 전파된 레이블 및 가중치에 기초하여 학습될 수 있다. 도 13a 내지 도 13c는 본 발명의 일 실시 예에 따른 데이터 증강의 구체적인 예를 도시한다. 구체적으로, 도 13 은 A2CH 심초음파 뷰(echocardiography view)의 일 예를 도시한다. 도 13a는 오리지널 이미지 및 주석 마스크 (annotation mask)를 나타낸다. 도 13b는 오리지널 이미지 및 전파된 마스크(propagated mask)를 나타낸다. 도 13c는 전파된 이미지(propagated image) 및 전파된 마스크를 나타낸다. 각 사진의 윗 부분은 시각화된 이미지 (visualization of image) 및 마스크를 나타낸다. 각 사진의 아랫 부분은 확대된 뷰(magnified of view)를 나 타내며, 초록색 라인은 LV의 경계를 나타낸다. 레이블(label)과 마스크(mask)는 혼용되어 사용될 수 있다. 심장 이미지들은 시간에 따라 변하는 2D 이미지이다. 심장 이미지 및 주석이 달린 마스크(annotated mask)를 효 율적으로 증강하기 위해서, 장치는 심장 모션 벡터 필드(cardiac motion vector field)를 측정하고, 기준 데이 터(reference data)를 전파(propagate)할 수 있다. 여기서, 전파(propagate)는 뉴럴 네트워크 상의 전파 (propagate)와 달리 이미지 변환 방법의 일 예를 가리키는 용어일 수 있다. 예를 들어, 장치는 CNN(convolutional neural network)에 기초하여 심장 모션 벡터 필드를 측정할 수 있다. 장치는 레이블 및 이미지로 구성된 페어와이즈 데이터(pairwise data)를 생성할 수 있다. 일 예로, 장치는 전파 된 레이블(propagated label) 및 그라운드 트루 레이블(ground truth label)이 없는 이미지로 구성된 페어와이 즈 데이터(pairwise data)를 생성할 수 있다. 장치는 이러한 데이터를 증강할 수 있다. 기준 영상에서 m(프레임)만큼 떨어진 시점에서 그라운드 트루 라벨이 없는 이미지는 와 같이 표현될 수 있다. m번째 증 강된 전파된 레이블은 와 같이 표현될 수 있다. 증강된 그라운드 트루 라벨이 없는 이미지와 증강된 전파된 레이블은 경계가 일치하지 않을 수 있다. 예를 들어, 증강된 라벨이 없는 이미지와 증강되고 전파된 레이블은 모션 벡터 필드의 에러(erroneous)에 기초하여 경계가 일치하지 않을 수 있다. 또한, 증강된 라벨이 없는 이미지와 증강되고 전파된 레이블은 전파 스텝이 커 질수록 경계의 오차가 커질 수 있다. 도 13b를 참고하면, 전파되지 않은 이미지와 전파된 레이블의 전파 스텝 사이즈가 2인 경우 이미지와 레이블의 오차가 존재한다. 도 13c를 참고하면, 전파되지 않은 이미지와 전파된 레 이블의 전파 스텝 사이즈가 6인 경우 오차가 존재하며, 스텝 사이즈가 2인 경우에 비해서 오차가 큰 것을 확인 할 수 있다. 과거 이미지 및 현재 이미지를 사용하여 모션 벡터 필드를 추정하는 순차적 전파(sequential propagation)는 모션 벡터 필드의 에러를 야기할 수 있으며, 오리지널 이미지를 왜곡시킬 수 있다. 장치는 레이블뿐만 아니라 이미지를 전파함으로써 모션 벡터 필드의 에러를 감소시킬 수 있다. 또한, 장치는 레 이블의 전파 스텝과 이미지의 전파 스텝을 동일하게 함으로써 정확한 데이터를 증강할 수 있다. 도 14는 본 발명의 일 실시 예에 따른 심장 이미지 세그멘테이션의 결과를 나타낸다. 도 14를 참고하면, 심장 이미지는 좌/우심실, 좌/우심방, 좌/우심근, Triscupid valve, Mitral valve 및 Aortic Valve로 세그멘테이션 될 수 있다. 도 14를 참고하면, 영상 분할 결과는 가시화를 위하여 입력영상과 중첩하여 나타낼 수 있다. 도 14 를 참고하면, 민트색 라인(1402a, 1402b)은 좌심근(LV wall)(민트색 두 선(1402a, 1402b)의 두께가 좌심근의 두께를 나타냄)을, 안쪽 민트색 라인 내부(1402b)는 좌심실(LV)을, 하얀색 라인은 좌심방(LA)을, 살구색 (1406a, 1406b) 및 갈색은 승모판막 (Mitral valve)을 나타낸다. 본 발명의 예시적인 방법들은 설명의 명확성을 위해서 동작의 시리즈로 표현되어 있지만, 이는 단계가 수행되는 순서를 제한하기 위한 것은 아니며, 필요한 경우에는 각각의 단계가 동시에 또는 상이한 순서로 수행될 수도 있다. 본 발명에 따른 방법을 구현하기 위해서, 예시하는 단계에 추가적으로 다른 단계를 포함하거나, 일부의 단 계를 제외하고 나머지 단계를 포함하거나, 또는 일부의 단계를 제외하고 추가적인 다른 단계를 포함할 수도 있 다. 본 발명의 다양한 실시 예는 모든 가능한 조합을 나열한 것이 아니고 본 발명의 대표적인 양상을 설명하기 위한 것이며, 다양한 실시 예에서 설명하는 사항들은 독립적으로 적용되거나 또는 둘 이상의 조합으로 적용될 수도 있다. 또한, 본 발명의 다양한 실시 예는 하드웨어, 펌웨어(firmware), 소프트웨어, 또는 그들의 결합 등에 의해 구현 될 수 있다. 하드웨어에 의한 구현의 경우, 하나 또는 그 이상의 ASICs(Application Specific Integrated Circuits), DSPs(Digital Signal Processors), DSPDs(Digital Signal Processing Devices), PLDs(Programmable Logic Devices), FPGAs(Field Programmable Gate Arrays), 범용 프로세서(general processor), 컨트롤러, 마이크로 컨트롤러, 마이크로 프로세서 등에 의해 구현될 수 있다. 본 발명의 범위는 다양한 실시 예의 방법에 따른 동작이 장치 또는 컴퓨터 상에서 실행되도록 하는 소프트웨어 또는 머신-실행가능한 명령들(예를 들어, 운영체제, 애플리케이션, 펌웨어(firmware), 프로그램 등), 및 이러한 소프트웨어 또는 명령 등이 저장되어 장치 또는 컴퓨터 상에서 실행 가능한 비-일시적 컴퓨터-판독가능 매체 (non-transitory computer-readable medium)를 포함한다."}
{"patent_id": "10-2021-0139303", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 일 실시 예에 따른 시스템을 도시한다. 도 2는 본 발명의 일 실시 예에 따른 장치의 구조를 도시한다. 도 3은 본 발명에 적용 가능한 인공지능 모델을 구성하는 퍼셉트론(perceptron)의 예를 도시한다. 도 4는 본 발명에 적용 가능한 인공지능 모델을 구성하는 인공 신경망의 예를 도시한다. 도 5a 및 도 5b는 본 발명에 적용 가능한 LSTM 네트워크의 예를 도시한다. 도 6은 본 발명의 일 실시 예에 따라 이미지 세그멘테이션을 위한 훈련(training) 절차를 도시한다. 도 7은 본 발명의 일 실시 예에 따른 인공지능 모델의 구조를 도시한다. 도 8은 본 발명의 실시 예에 따른 이미지 세그멘테이션 절차를 도시한다. 도 9는 본 발명의 일 실시 예에 따른 인공지능 모델의 구체적인 구현 예를 도시한다. 도 10은 본 발명의 일 실시 예에 따른 심장 이미지 세그멘테이션을 위한 훈련 절차를 도시한다. 도 11는 본 발명의 일 실시 예에 따른 심장 이미지 및 전파된 심장 이미지를 도시한다. 도 12는 본 발명의 실시 예에 따른 심장 이미지에 대한 세그멘테이션 절차를 도시한다. 도 13a 내지 도 13c는 본 발명의 일 실시 예에 따른 데이터 증강의 구체적인 예를 도시한다. 도 14는 본 발명의 일 실시 예에 따른 심장 이미지 세그멘테이션의 결과를 나타낸다."}
