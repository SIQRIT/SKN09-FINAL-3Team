{"patent_id": "10-2019-0030345", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2020-0110878", "출원번호": "10-2019-0030345", "발명의 명칭": "충치 조기진단을 위한 딥러닝 기반 진단 방법 및 시스템", "출원인": "민경준", "발명자": "민경준"}}
{"patent_id": "10-2019-0030345", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "(1) 치아를 포함한 구강 이미지로부터 경면 반사 영역을 검출하여 보정하는 단계;(2) 상기 경면 반사 영역을 검출하여 보정한 이미지를 대상으로 잇몸 영역을 최소화 하는 단계;(3) 상기 잇몸 영역을 최소화한 이미지를 대상으로 노이즈를 제거하는 단계;(4) 상기 노이즈를 제거한 이미지를 대상으로 윤곽선을 검출하는 단계;를 포함하는 충치 조기진단을 위한 구강이미지 전처리 방법."}
{"patent_id": "10-2019-0030345", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제 1항에 있어서,상기 경면 반사 영역을 검출하여 보정하는 단계는,(a) 치아를 포함한 구강 이미지 영상을 반전시켜 경면 반사 영역을 검출하는 단계;(b) 상기 반전시켜 검출한 영역에 Median 필터를 적용하는 단계;를 포함하는 것을 특징으로 하는 충치 조기진단을 위한 구강 이미지 전처리 방법."}
{"patent_id": "10-2019-0030345", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제 1항에 있어서,상기 경면 반사 영역을 검출하여 보정한 이미지를 대상으로 잇몸 영역을 최소화 하는 단계는,(a) 적색 채널과 녹색 채널 영상의 차이값을 구하는 단계;(b) 녹색 채널과 상기 차이값의 차이값을 다시 구하여 잇몸 영역의 스펙트럼 영역을 제거하는 단계;를 포함하는것을 특징으로 하는 충치 조기진단을 위한 구강 이미지 전처리 방법."}
{"patent_id": "10-2019-0030345", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제 1항에 있어서,상기 잇몸 영역을 최소화한 이미지를 대상으로 노이즈를 제거하는 단계는,(a) 정해진 크기의 윈도우가 상기 잇몸 영역을 최소화한 이미지를 옮겨 다니면서 각 Pixel 값을 검사를 하여 하나라도 0이 있다면 대상 Pixel을 제거하는 Erosion 단계;(b) 상기 (a)단계를 거친 대상 이미지에 대해 OR연산을 수행하여, 겹치는 부분이 하나라도 있으면 이미지를 확장하는 Dilation 단계;를 포함하는 것을 특징으로 하는 충치 조기진단을 위한 구강 이미지 전처리 방법."}
{"patent_id": "10-2019-0030345", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제 1항의 충치 조기진단을 위한 구강 이미지 전처리 방법을 사용하여 전처리를 하고, 전처리된 구강 이미지에대하여 딥러닝 인공지능을 이용하여 충치의 존재 여부를 진단하는 시스템.공개특허 10-2020-0110878-3-청구항 6 제 5항에 있어서,상기 딥러닝 인공지능은 CNN(Convolutional Neural Network), R-CNN(Regional Convolutional Neural Network)및 YOLO로 구성되는 군으로부터 선택되는 하나 이상의 인공지능 알고리즘을 이용하는 것을 특징으로 하는 충치의 존재 여부를 진단하는 시스템."}
{"patent_id": "10-2019-0030345", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "구강 이미지영상 단말기(10);인공지능 서버(20); 및분석 작업과 추천 작업을 수행하는 데이터베이스(30);를 포함하는, 딥러닝 인공지능을 이용하여 충치의 존재 여부를 진단하는 시스템."}
{"patent_id": "10-2019-0030345", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제 7항에 있어서,상기 구강 이미지영상 단말기(10)와 외장 인터페이스를 통해 연결되는 구강카메라(40);를 더 포함하는, 딥러닝인공지능을 이용하여 충치의 존재 여부를 진단하는 시스템."}
{"patent_id": "10-2019-0030345", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제 7항에 있어서,상기 구강 이미지영상 단말기(10)는, 소프트웨어로 구강 이미지를 실시간으로 촬영하는 이미지처리 모듈(12)과충치 진행단계 측정 모듈(14) 및 상태 비교 모듈(16)을 포함하고,상기 인공지능 서버(20)는, 이미지 송수신 모듈(22)과 이미지분석 모듈(24) 및 치과 추천 모듈(26)을 포함하여,이미지 분석 모듈(24)은 딥러닝 방법을 통해 이미지를 분석한 후 분석된 이미지를 이미지영상 단말기(10)로 되돌려 보내는 것을 특징으로 하는,딥러닝 인공지능을 이용하여 충치의 존재 여부를 진단하는 시스템."}
{"patent_id": "10-2019-0030345", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 딥러닝 알고리즘을 이용하여 충치를 조기에 진단하기 위해 사전에 구강 이미지를 전처리하고 전처리된 이미지를 이용해 간편하고 빠르게 충치를 진단하는 시스템 및 방법에 관한 것이다. 상기와 같은 본 발명에 따르면, 구강 검진 자료를 딥러닝 방식으로 분석하면, 구강에 대한 검진 자료 이미지를 간편하고도 객관적으로 파악할 수 있으며, 구강 이미지 중에서 어떤 치아가 충치의 후보가 되는지 선별하고, 이 를 통해 충치를 조기 진단할 수 있다. 이러한 시스템을 통해 시간 및 비용 측면에서 크게 절감할 수 있게 하고, 스마트폰과 인터넷 환경을 이용해 편리하게 이용할 수 있다."}
{"patent_id": "10-2019-0030345", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 딥러닝 알고리즘을 이용하여 충치를 조기에 진단하기 위해 사전에 구강 이미지를 전처리하고 전처리 된 이미지를 이용해 간편하고 빠르게 충치를 진단하는 시스템 및 방법에 관한 것이다."}
{"patent_id": "10-2019-0030345", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "치과 관련 질환은 다른 질환보다도 생명에 직접적인 위해를 가하는 정도가 다소 낮다 보니 실제 치아에 문제가 발생하여 일상생활에 불편을 초래할 정도가 되어야 찾는 경우가 많고, 이는 적당한 시기에 적절한 치료만 받았 어도 하는 아쉬움이 많이 남게 된다. 이러다 보니 치료시기가 늦어 적지 않은 치료비용을 부담하게 되어 가계 경제에 부담을 주거나 큰 질병으로 전이되는 경우가 많다. 식생활의 서구화로 인한 구강질환의 증가로 인하여, 우리나라의 12세 충치경험 영구치아 수는 1.8개로 주요선진 국 1.6개와 비교하면 높은 수준이다(보건복지부, 국민구강건강실태조사, 2012). 또한 구강질환에 따라 개인 및 사회적 부담이 가중되는데, 국내 외래진료 빈도가 많은 질병 현황 순위 내에 구강관련 2개 질병이 포함되어 있 으며, 이 중 1위가 치아 및 치주질환으로 나타났고, 12위는 치아우식증(충치)으로 나타났다.특히, 구강질환 발생의 고위험군인 영유아 및 학령기 어린이의 구강질환은 그 예방과 조기진단이 중요한데, 의 료기관 이용 빈도 격차로 인해 고위험 시기인 영유아 세대부터 구강건강 불평등이 매우 높게 나타난다. 이와 같 이 구강질환의 조기 예방과 치료의 중요성 증가에 대한 사회적 관심이 증가하고 있음에도 불구하고, 현실적으로 이를 위한 적절한 대응은 조기진단인데, 여러 가지 불편함이 있고 정확히 알기 힘들다는 한계가 있다. 구강질환, 특히 충치 발생의 고위험군인 영유아 및 학령기 어린이들의 구강건강 관리를 위해서는 가정에서의 구 강 위생 행동과 관련된 교육 및 관리뿐만 아니라 전문 의료기관의 검진 및 예방 진료 연계를 통해서 연령에 따 른 구강관리 방법을 숙지해야 한다. 이를 위해 사용자가 전문 의료기관을 직접 방문하여 주기별 구강질환 위험 도를 평가하고, 구강건강 상태에 따른 예방 진료 혹은 구강 관리 방법을 이행하는 것이 가장 바람직하나, 현실 적으로 의료 기관 방문을 위한 비용과 시간이 많이 들고, 주기적인 방문의 어려움으로 인해 적절한 예방 및 치 료 시기를 놓쳐 보다 심각한 구강질환으로 진행될 우려가 있다. 구강 질환, 특히 치아우식증(충치)은 적절한 예방 치료 및 꾸준한 관리를 통해서 높은 예방 효과를 얻을 수 있 지만, 많은 구강 질환 환자들은 구강 건강에 문제가 발생하지 않으면 의사에게 진단을 받거나 치료를 의뢰하지 않는 등 아직까지는 구강예방에 대한 인식이 부족한 실정이다. 또한, 환자의 현재 구강 상태를 측정함에 있어 치과 의사나 치위생사의 주관적 견해가 아닌, 정확한 검사 및 진단 결과와 그에 따른 객관적 수치 정보가 필요 하지만 구강의 건강 상태를 객관적으로 산출하는 방법 또는 시스템이 부족하다. 또한, 최근 보편화된 스마트폰, 태블릿 PC 등의 휴대용 통신 환경과 접목할 수 있다면 상당한 효과가 기대되는 상황이다. 이러한 문제점을 해결하며, 우리나라의 뛰어난 인터넷 이용환경과 발달된 정보통신기술을 구강검진 영역에 활용 하면 시간 및 비용 측면의 절감을 할 수 있다는 점을 착안하여, 본 발명자들은 구강 검진 자료를 사진으로 찍어 그 중에서 충치의 후보가 되는 치아를 선별하고 이를 통해 충치를 조기 진단할 수 있는 방법을 개발하여 잘 작 동함을 확인하여 발명을 완성하였다."}
{"patent_id": "10-2019-0030345", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명의 목적은, 구강에 대한 이미지를 얻어 이러한 자료를 딥러닝 방식으로 분석하여 충치를 빠르고 용이하 게 객관적으로 파악하며, 이를 위해 구강에 대한 이미지를 사전 처리하고, 딥러닝 방식으로 분석하며, 치과 추 천을 받기 위한 시스템을 제공하기 위한 것이다."}
{"patent_id": "10-2019-0030345", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "상기 목적을 달성하기 위하여, 본 발명은 치아를 포함한 구강 이미지로부터 경면 반사 영역을 검출하여 보 정하는 단계; 상기 경면 반사 영역을 검출하여 보정한 이미지를 대상으로 잇몸 영역을 최소화 하는 단계; 상기 잇몸 영역을 최소화한 이미지를 대상으로 노이즈를 제거하는 단계; 상기 노이즈를 제거한 이미지 를 대상으로 윤곽선을 검출하는 단계;를 포함하는 충치 조기진단을 위한 구강 이미지 전처리 방법을 제공한다. 상기 경면 반사 영역을 검출하여 보정하는 단계는, (a) 치아를 포함한 구강 이미지 영상을 반전시켜 경면 반사 영역을 검출하는 단계; (b) 상기 반전시켜 검출한 영역에 Median 필터를 적용하는 단계;를 포함하는 것을 특징 으로 한다. 상기 경면 반사 영역을 검출하여 보정한 이미지를 대상으로 잇몸 영역을 최소화 하는 단계는, (a) 적색 채널과 녹색 채널 영상의 차이값을 구하는 단계; (b) 녹색 채널과 상기 차이값의 차이값을 다시 구하여 잇몸 영역의 스 펙트럼 영역을 제거하는 단계;를 포함하는 것을 특징으로 한다. 상기 잇몸 영역을 최소화한 이미지를 대상으로 노이즈를 제거하는 단계는, (a) 정해진 크기의 윈도우가 상기 잇 몸 영역을 최소화한 이미지를 옮겨 다니면서 각 Pixel 값을 검사를 하여 하나라도 0이 있다면 대상 Pixel을 제 거하는 Erosion 단계; (b) 상기 (a)단계를 거친 대상 이미지에 대해 OR연산을 수행하여, 겹치는 부분이 하나라 도 있으면 이미지를 확장하는 Dilation 단계;를 포함하는 것을 특징으로 한다. 또한 본 발명은 상기 충치 조기진단을 위한 구강 이미지 전처리 방법을 사용하여 전처리를 하고, 전처리된 구강 이미지에 대하여 딥러닝 인공지능을 이용하여 충치의 존재 여부를 진단하는 시스템을 제공한다. 상기 딥러닝 인공지능은 CNN(Convolutional Neural Network), R-CNN(Regional Convolutional Neural Network) 및 YOLO로 구성되는 군으로부터 선택되는 하나 이상의 인공지능 알고리즘을 이용하는 것을 특징으로 한다.또한 본 발명은 구강 이미지영상 단말기; 인공지능 서버; 및 분석 작업과 추천 작업을 수행하는 데이터 베이스;를 포함하는, 딥러닝 인공지능을 이용하여 충치의 존재 여부를 진단하는 시스템을 제공한다. 상기 구강 이미지영상 단말기와 외장 인터페이스를 통해 연결되는 구강카메라;를 더 포함하는 것을 특 징으로 한다. 상기 구강 이미지영상 단말기는, 소프트웨어로 구강 이미지를 실시간으로 촬영하는 이미지처리 모듈과 충치 진행단계 측정 모듈 및 상태 비교 모듈을 포함하고, 상기 인공지능 서버는, 이미지 송수신 모 듈과 이미지분석 모듈 및 치과 추천 모듈을 포함하여, 이미지 분석 모듈은 딥러닝 방법을 통해 이미지를 분석한 후 분석된 이미지를 이미지영상 단말기로 되돌려 보내는 것을 특징으로 한다."}
{"patent_id": "10-2019-0030345", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "구강 검진 자료를 딥러닝 방식으로 분석하면, 구강에 대한 검진 자료 이미지를 간편하고도 객관적으로 파악할 수 있으며, 구강 이미지 중에서 어떤 치아가 충치의 후보가 되는지 선별하고, 이를 통해 충치를 조기 진단할 수 있다. 이러한 시스템을 통해 시간 및 비용 측면에서 크게 절감할 수 있게 하고, 스마트폰과 인터넷 환경을 이용 해 편리하게 이용할 수 있다."}
{"patent_id": "10-2019-0030345", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하, 본 발명을 상세히 설명한다. 일 관점에서, 본 발명은 치아를 포함한 구강 이미지로부터 경면 반사 영역을 검출하여 보정하는 단계; 상기 경면 반사 영역을 검출하여 보정한 이미지를 대상으로 잇몸 영역을 최소화 하는 단계; 상기 잇몸 영역 을 최소화한 이미지를 대상으로 노이즈를 제거하는 단계; 상기 노이즈를 제거한 이미지를 대상으로 윤곽선 을 검출하는 단계;를 포함하는 충치 조기진단을 위한 구강 이미지 전처리 방법을 제공한다. 상기 경면 반사 영역을 검출하여 보정하는 단계는, (a) 치아를 포함한 구강 이미지 영상을 반전시켜 경면 반사 영역을 검출하는 단계; (b) 상기 반전시켜 검출한 영역에 Median 필터를 적용하는 단계;를 포함할 수 있다. 이 는 아래에 기술하는 실시예 2와 실시예 3에서 구체적으로 상술된다. 상기 경면 반사 영역을 검출하여 보정한 이미지를 대상으로 잇몸 영역을 최소화 하는 단계는, (a) 적색 채널과 녹색 채널 영상의 차이값을 구하는 단계; (b) 녹색 채널과 상기 차이값의 차이값을 다시 구하여 잇몸 영역의 스 펙트럼 영역을 제거하는 단계;를 포함할 수 있다. 이는 아래에 기술하는 실시예 4에서 구체적으로 상술된다. 상기 잇몸 영역을 최소화한 이미지를 대상으로 노이즈를 제거하는 단계는, (a) 정해진 크기의 윈도우가 상기 잇 몸 영역을 최소화한 이미지를 옮겨 다니면서 각 Pixel 값을 검사를 하여 하나라도 0이 있다면 대상 Pixel을 제 거하는 Erosion 단계; (b) 상기 (a)단계를 거친 대상 이미지에 대해 OR연산을 수행하여, 겹치는 부분이 하나라 도 있으면 이미지를 확장하는 Dilation 단계;를 포함할 수 있다. 이는 아래에 기술하는 실시예 5에서 구체적으 로 상술된다. 또한 본 발명은 상기 충치 조기진단을 위한 구강 이미지 전처리 방법을 사용하여 전처리를 하고, 전처리된 구강 이미지에 대하여 딥러닝 인공지능을 이용하여 충치의 존재 여부를 진단하는 시스템을 제공한다. 상기 딥러닝 인공지능은 CNN(Convolutional Neural Network), R-CNN(Regional Convolutional Neural Network) 및 YOLO로 구성되는 군으로부터 선택되는 하나 이상의 인공지능 알고리즘을 이용할 수 있다. 또한 본 발명은 구강 이미지영상 단말기; 인공지능 서버; 및 분석 작업과 추천 작업을 수행하는 데이터 베이스;를 포함하는, 딥러닝 인공지능을 이용하여 충치의 존재 여부를 진단하는 시스템을 제공한다. 상기 구강 이미지영상 단말기와 외장 인터페이스를 통해 연결되는 구강카메라;를 더 포함할 수 있다. 상기 구강 이미지영상 단말기는, 소프트웨어로 구강 이미지를 실시간으로 촬영하는 이미지처리 모듈과 충치 진행단계 측정 모듈 및 상태 비교 모듈을 포함하고, 상기 인공지능 서버는, 이미지 송수신 모 듈과 이미지분석 모듈 및 치과 추천 모듈을 포함하여, 이미지 분석 모듈은 딥러닝 방법을 통해 이미지를 분석한 후 분석된 이미지를 이미지영상 단말기로 되돌려 보낼 수 있다. 전술한 목적을 이루기 위하여 본 발명은 충치 조기진단을 위한 시스템을 구현하였다. 본 발명의 충치 조기진단 을 위한 시스템의 기본 원리는 (도 1)과 (도 2)에서 개괄적으로 설명되었는데, (도 1)은 후보영역 추출을 위한 충치 진단 영역 탐색 방법의 처리 순서도(process flow diagram)이다. Input 이미지로 RGB영상이 들어온 뒤 붉은 색 영역을 제거하는 연산을 거친 뒤 Threshold를 활용하여 영상 이진 화를 진행한다. 이 후, 치아 강조 영상을 얻기 위해 불필요한 노이즈를 제거하기 위해 Morphology연산을 거치고 윤곽선을 그려낸다. 윤곽선을 그려낸 부분들은 학습된 모델에 Input으로 들어가기 위한 후보영역이 되는 과정을 거치며, 이 과정을 (도 1)에서 순서도와 해당 사진들로 표시하였다. (도 2)는 (도 1)에서의 마지막 단계인 윤곽선 추출 과정을, 중심점 정보를 이용하여 padding을 주며, 32 x 32 x 3의 크기로 후보영역이 Convolution, Relu, Max Pooling, Fully Connected 레이어로 구성된 CNN(Convolutional Neural Network)의 입력이 되도록 하는 절차를 나타낸, CNN 네트워크를 이용하는 전후 처리 방법의 순서도이다. 해당 결과는 미리 검증과정을 거쳐 학습이 완료된 모델을 거쳐 분류결과가 나오게 되며, 학습은 총 5개 클래스 (충치, 금속, 건강한 치아, 잇몸, 혀)로 하였지만 분류 결과는 2개가 나오는데, 그 이유는 앞서서 수행한 후보 영역 추출을 통해서 불필요한 영역을 제거하였고, 그리고 난 다음 CNN을 통해 분류결과가 나오는 시스템이기 때 문이다. 혹시 모를 오-분류를 방지하기 위해 다음 실시예들과 같이 학습을 진행하였고 결과는 2가지로 분류가 되게끔 하였다. 실시예 1. 후보가 되는 영역의 검출과 빛 반사의 제거 카메라로부터 받아오는 영상에서 충치인지 아닌지, CNN(Convolutional Neural Network)을 이용하여 분류를 해내 기 위해서는 구강에 대한 다양한 컬러 영상으로부터 치아영역을 획득하는 것이 중요하다. 획득한 구강에 대한 컬러 영상에 대하여 치아 영역을 검출하는 것에 대해서는 몇 가지 연구가 이루어져 왔다. 그 방법으로는 Threshold를 이용한 방법, watershed 기법을 활용한 방법, edge 기반 검출을 이용한 방법 등이 있다. 이 중 watershed 기법 및 edge 기반 검출 방법은, 치아의 특성과 경면 반사를 고려하지 않아 치아의 검출율과 정확도 가 떨어진다는 단점이 존재하였다. 따라서, 기존의 치아 영역을 검출하는 연구에서 발생하는 단점을 보완하기 위하여, 치아의 색 분포를 이용한 영 상 변환 방법을 이용한, Threshold를 이용한 방법으로, 치아 영역을 검출하는 후보 영역 검출 방법(형태학적 특 징을 이용한 향상된 치아 검출방법)을 사용하였다. (도 3)은 본 발명에서 사용한 치아 검출 과정 흐름의 순서도이다. 컬러 영상에서 빨강, 초록, 파랑으로 나누어, 치아와 빛 간의 픽셀분석으로 그 차이를 이해하고(Color tooth image) 행렬 연산을 통해 치아 검출에서 노이즈 로 볼 수 있는 빛 반사를 제거하기 위한 노력을 하였으며(Remove Light), 치아 이외의 다른 붉은색 부분을 픽셀 분석을 통해 제거(Remove Red Region) 하고, Threshold 값을 적용(Threshold, Morphology)하고, 치아 검출에 사용될 윤곽선을 효과적으로 검출(Contouring)하였다. 빛 반사를 제거하기 위한 노력(Remove Light)부터 더 자세히 설명하면, 다음과 같다. 물체의 색은 광원의 색과 물체 표면의 특성에 의해 결정된다. 즉, 광원으로부터 발생한 빛이 물체에 닿으면 물 체의 표면에서 특정 색상이 흡수됨과 동시에 반사가 발생하고, 이 반사를 통해 사물의 색이 인지된다. 결국 반 사가 존재하기 때문에 사물의 고유색이 식별되는 원리이다. 반사는 주변반사, 확산 반사, 그리고 경면반사로 분 류가 되는데, 주변 반사는 광원에 직접 노출되지 않고, 다른 물체에서 반사되는 주변 광을 통해 발생되는 반사 를 말한다. 또한 확산 반사는 물체에 3차원적인 입체감을 부여하며, 물체 표면의 고유한 굴곡에 의해 여러 방향 으로 확산되는 것이 특징이다. 이와는 대조적으로 경면 반사는 주로 유광면을 가진 물체 표면에서 발생할 가능 성이 높으며, 빛의 정반사가 주요한 원인이 된다. 본 발명에서는 구강카메라를 활용하여 구강 영상을 얻기 위해 빛을 사용하게 되는데, 치아 영상 촬영 시에, 치 아 표면을 구성하고 잇는 법랑질 또는 에나멜질 역시 유광면의 특성을 가지고 있기 때문에, 조명에 의한 경면 반사가 발생하기 쉽다. 따라서 치아의 표면에서 발생한 경면 반사는 치아의 고유한 색상을 왜곡 시키게 되어 치아 영상 분석의 성능을 저하시키는 요소가 된다. 그러므로 효율적인 영상처리 과정을 수행하기 위해서는 경면 반사를 제거하는 전처리 과정이 반드시 필요하게 된다. 실시예 2. 경면 반사의 검출 실시예 1에서 언급한 전처리 과정으로서, 영상의 화소 값을 이용한 픽셀 분석 과정을, 다음과 같이 수행하였다. 컬러 영상은 R,G,B의 3 가지 컬러 성분의 조합으로 표현된다. 따라서 각각의 RGB 라인 프로파일(Line Intensity Profile)은 컬러 치아 영상을 이용하여 반사 영역을 판단하는데 중요한 특징 값을 제공한다. (도 4)를 살펴보면 치아의 표면에서 발생한 경면 반사 영역을 눈으로도 쉽게 확인할 수 있는데, 반사 영역에서 화소의 밝기 값이 매우 크다는 사실을 알 수 있다. (도 4)를 보면 알수 있듯이 경면 반사가 발생한 지점은 화소의 밝기 값이 매우 크다는 사실을 확인할 수 있다. 경면반사가 일어난 지점은 육안으로 보기에도 백색에 가까우므로 R,G,B값이 모두 255에 이르는 큰 값을 가진다. 이러한 문제점을 해결하기 위하여, 영상을 반전시키는 전처리 과정을 수행하였으며, 식 은 영상의 반전을 수 행하기 위해 사용된 식을 보여 주고 있다."}
{"patent_id": "10-2019-0030345", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "상기 식 에서 I_Green(x,y)는 G 채널에서의 화소 값, I_Blue(x,y)는 B 채널에서의 화소 값을 의미한다. (도 5)은 식 을 이용하여 반전된 영상을 보여주고 있다. 식을 이용하여 영상을 반전하여, (도 5)과 같이 반전된 영상에서, 빛 반사가 일어난 지점의 픽셀 분석을 해 보면 R값이 매우 큰 값을 나타내고 있는 반면, 반전된 B, G값은 매우 작다는 사실을 확인할 수 있다. 따라서 이 와 같은 특징을 활용하면 치아 영상에서 경면 반사를 효율적으로 검출할 수 있다. 실시예 3. Median 필터를 이용한 경면 반사 보정 실시예 1에서 언급한 전처리 과정으로서, Median 필터를 이용한 경면 반사 보정 과정을, 다음과 같이 수행하였 다. 공간 필터는 특정한 주파수 성분을 커널 윈도우를 통해 선택적으로 통과시켜 영상의 질을 개선하는 역할을 한다. salt-and-pepper 노이즈 제거에 가장 효과적인 Median Filter는 커널 윈도우와 pixel의 값들을 정렬한 후에 중간 값을 선택하여 적용하면 된다. 예를 들어 아래의 표와 같이 커널 윈도우를 적용시킨 결과가 다음과 같다면 크기순으로 정렬을 하면 33, 54, 67, 84, 102, 163, 189, 212, 224이다. 이 중에 중간 값인 102가 중앙값으로 결정이 되는 것이다. (중앙에 있 는 189가 102로 변경된다는 의미.)"}
{"patent_id": "10-2019-0030345", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "Median 필터를 이용하여 경면 반사 제거를 수행하기 위하여, 우선적으로 상기 식 을 이용하여 반사 부분을 검출하고, 그 후에 검출된 영역의 반사 효과를 제거하고자 하였으며, 결국 (도 6)과 같이 경면 반사의 효과가 어느 정도 제거된 치아 영상을 얻을 수 있었다. 실시예 4. 붉은 색 잇몸 영역 최소화 실시예 1에서 언급한 전처리 과정 이후, 붉은 색 영역을 제거하는 과정을 거친다. 학습된 CNN모델을 통해 충치를 보다 효과적으로 발견해 내기 위해서는 치아를 Segmentaion을 해야 한다. 이를 위해 치아 영상에 대한 이해가 필요하다. 치아 영상에서는 일반 적으로 잇몸, 혀 영역과 치아영역으로 나뉘게 되는데 이는 서로 상이한 RGB특성을 보인다. 즉, 잇몸의 영역은 붉은 색을 띠고 있기 때문에 G와 B값에 비해 상대적으로 큰 R값을 갖는다. 반면에 치아 영역은 RGB의 값이 골고루 높다는 특성을 가진다. 따라서 잇몸 영역은 치아 영역을 검출하는 데에 있어서 방해 요소로 작용하기 때문에 RGB값 연산을 통하여 잇몸 영역을 최소화시켜야 한다. 결과적으로 R채널과 G채널의 영상의 차이를 수행하면 양쪽 채널 모두에서 강한 특성 값을 가진 치아 영역의 정 보가 최소화되는 반면에, 잇몸의 특성만이 강하게 표출된다. 그리고 G 채널과 잇몸 특성이 강한 영상에 대해 다 시 뺄셈 연산을 수행하면 잇몸 영역의 스펙트럼을 가지고 있는 영역들이 대부분이 제거되어 치아 영역의 특성만 남게 된다. RGB 채널 연산에 대한 순서와 수식은 아래 식 , 와 같으며, (도 7)은 RGB채널 사이의 차이 연산 후 대부 분의 잇몸 영역들이 제거된 결과를 보여준다."}
{"patent_id": "10-2019-0030345", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "실시예 5. 노이즈 제거를 통한 윤곽선 검출 앞선 실시예들을 통해, 빛 반사 및 붉은 색 영역 제거에 대한 전처리를 통해 윤곽선을 보다 잘 검출해 낼 수 있 게 되었다. 하지만 위의 과정을 통해서도 아직도 남아있는 노이즈가 존재하므로 이에 대해 처리할 방법이 필요 하다. 이를 위해 Morphological 변환을 이용한다. 해당 방법은 이미지를 Segmentation하여 단순화, 제거, 보정을 통해 서 형태를 파악하는 목적으로 사용한다. 사용하는 방법으로는 Dilation(팽창), Erosion(침식), 그리고 2개를 조합한 Opening과 Closing이 있다. 노이즈 제거를 위해 Morphological 변환을 사용하므로 Erosion 방법을 사용하 는데 이에 초기 충치와 같이 작은 부분도 침식을 통해 제거될 수 있기 때문에 Erosion을 거친 뒤 Dilation해주 는 Opening방법을 사용한다. 먼저 Erosion이란 정해진 크기의 윈도우가 이미지를 옮겨 다니면서 각 Pixel 값을 검사를 하는데 하나라도 0이 있다면 대상 Pixel을 제거하는 방법이다. 제거한 뒤 Erosion과는 반대로 Dilation을 통해 대상에 대해 OR연산 을 수행하는데, 이는 겹치는 부분이 하나라도 있으면 이미지를 확장한다는 의미이다. Opening을 통해 얻을 수 있는 결과는 경계가 부드러워지고, 구멍이 메꿔지는 효과를 얻을 수 있다는 것이고 이 를 통해 작은 object나 Detection에 방해 될 수 있는 돌기제거에 효과적이다. (도 8)의 원본 치아사진은, 빛 반 사 및 붉은 영역 제거한 뒤 이미지에 Treshold 적용한 결과인 (도 9)와, Erosion과 Dilation(Opening)을 거친 결과인 (도 10)을 거치게 된다. 원본 치아 사진으로부터 얻은 윤곽선 검출 결과 사진인 (도 11)와 같이, 윤곽선 검출을 위해서 행해지는 앞선 과정을 통해, 최초 영상 사진으로부터 치아를 찾을 수 있게 되는데, 치아 윤곽선 안에 있는 충치 또한 잡아내기 위해서는 Opencv 라이브러리 findContours()함수의 mode 변수를 cv2.RETR_CCOMP로 설정해 주어 수행한다. 실시예 6. 학습 진행과 그 결과 치과에서 제공받은 데이터를 대상으로 하여, (도 12)과 같은 과정을 거치고, (도 13)으로 나타낸 CNN 학습 네트 워크를 이용하여, 데이터 선별을 하고 학습을 진행하였다. CNN 알고리즘 대신에 R-CNN 또는 YOLO 알고리즘을 이 용할 수도 있다. Convolutional Neural Network (CNN) 알고리즘은, 모델이 직접 이미지, 비디오, 텍스트 또는 사운드를 분류하 는 머신 러닝의 한 유형인 딥러닝에서 가장 많이 사용되는 알고리즘이다. CNN은 이미지에서 객체, 얼굴, 장면을 인식하기 위해 패턴을 찾는 데 특히 유용하며, CNN은 데이터에서 직접 특징을 추출하고 학습하며, 이를 통해 이 미지를 분류한다. 따라서 학습을 위해 별도로 특징을 추출하는 등의 작업을 요구하지 않는다는 특징이 있다. 자율 주행 자동차, 얼굴 인식 애플리케이션과 같이 객체 인식과 컴퓨터 비전이 필요한 분야에서 CNN 알고리즘이 많이 사용되어진다. CNN이 갖는 장점은, (i) CNN은 특징을 직접 학습하기 때문에 특징을 수동으로 특징을 추출 할 필요가 없다는 점. 즉, End-to-End Learning이 가능하다. (ii) CNN은 높은 수준의 인식 결과를 보이는 점, (iii) 기존 네트워크를 바탕으로 한 새로운 인식 작업을 위해 CNN을 재학습하는 Transfer Learning기법을 이용 할 수 있는 점이 있다. (도 14)는 CNN을 이용하여 사진을 분류하는 과정을 나타내고 있다. 하지만 위와 같이 전통적인 CNN은 해당 이미지가 전체적으로 무엇을 의미하는지 분류하는 역할만 할 수 있다. 만약 전체 영상에서 특정 위치에 어떠한 물체가 있는지 찾는 Object detection을 수행하려면 CNN을 확장한 Regional CNN (R-CNN)을 고려해야 한다. Regional CNN (R-CNN) 알고리즘으로 누구나 쉽게 떠올릴 수 있는 간단한 방법은, 물체가 존재할 수 있는 모든 크기의 영역에 대해 sliding window 방식으로 이미지를 모두 탐색하면서 classification을 수행하는 것이다. 하 지만, 탐색해야 하는 영역의 수가 너무 많기 때문에 classifier가 충분히 빠르지 않다면 연산 시간이 너무 오래 걸리는 비효율적인 방법이다. 이에 실시간으로 물체를 탐지해낼 수 있는 Faster R-CNN이라는 기법이 개발되었다. 이름에서도 알 수 있듯이 더욱 빠른 object detection을 수행하기 위한 모델로 직전에 개발되었던 것이 Fast R-CNN이다. 그런데 Fast R-CNN에서 속도의 bottleneck이었던 region proposal 생성을 CNN 외부의 별 도 알고리즘이 아닌, CNN 내부에 region proposal을 생성할 수 있는 network를 설계함으로써 더욱 빠르면서도 정확한 region proposal을 생성할 수 있는 알고리즘이 Faster R-CNN다. Faster R-CNN은 기존의 Fast R-CNN에 Region proposal network을 추가한 것이 핵심이라고 볼 수 있다. Faster R-CNN의 대략적인 구조는 (도 15)에서 확인할 수 있다. YOLO 알고리즘은 네트워크의 최종 출력단에서 bounding boc를 위치 찾기와 클래스 분류가 동시에 이뤄진다는 특 징이 있다. 단 하나의 네트워크가 한번에 특징도 추출하고, bounding box도 만들고, 클래스도 분류한다. 그러므 로 간단하고 빠르다. (도 16)에서 좌측의 입력 영상이 네트워크를 통과하면 중앙의 2개의 데이터를 얻으며 이것 이 네트워크의 최종 출력이 된다. 이 안에는 수많은 bounding box들과 영상을 7x7그리드로 나눴을 때 해당 grid cell안에는 어떤 클래스가 있는지에 대한 정보(도 16에서 가운데 2개 그림)가 encoding되어 있다. (도 16)에서 우측의 이미지는 네트워크의 최종 출력물을 이용해 생성하는 것으로 네트워크가 직접 생성한 것이 아니다. 가운 데 위쪽은 bounding box에 대한 정보이다. 서로 다른 크기의 상당히 많은 bounding box들이 그려져 있다. 네트 워크는 영상을 7x7 grid로 나누고, 각 grid에서 중심을 grid 내부로 정하면서 크기가 일정하지 않은 boundingbox를 2개씩 생성한다. Grid cell이 7 * 7 = 49 개이므로 bounding box는 총 98개가 만들어 진다. 이 중 bounding box 안쪽에 어떤 오브젝트가 있을 것 같다고 확신(confidence score)할수록 박스를 굵게 그려준다. 굵 은 bounding box들만 남기고 얇은 bounding box(어떤 오브젝트도 없는 것 같다고 여겨지는 것들)를 지운다. 남 은 후보 bounding box들을 Nom-maximal suppression 알고리즘를 이용해 선별하면 우측의 이미지처럼 최종적으로 탐지된 object를 나타낼 수 있게 된다. 이와 같은 딥러닝 인공지능 알고리즘 중 하나를 이용하여 (도 17), (도 18), (도 19)와 같은 결과를 얻을 수 있 었다. 이는 원본 치아 사진에서 Metal과 Cavity를 식별한 결과 사진들이므로, 영상 사진에서 시작하여 자동으로 충치여부를 진단했다는 것을 의미한다. 결론적으로 본 발명은 (도 20), (도 21)과 같은 구성 시스템에서 구현된다. 영상 단말기에는, 이미지처리 모듈이 있어서 사용자로 하여금 소프트웨어(앱)으로 구강 이미지를 실시간으로 촬영하고, 인공지능 서버 로 보내어 이미지 송수신 모듈이 받아서 이미지분석 모듈로 딥러닝 방법을 통해 이미지를 분석하도 록 한다. 분석된 이미지는 다시 영상단말기로 보내지게 되고, 충치 진행단계 측정 모듈이 있어서 구강 이미지로부터 충치 진행단계를 측정하며, 이전의 구강 상태와의 비교 작업은 상태 비교 모듈이 수행한다. 치과 치료가 필요한 경우 다시 인공지능 서버의 치과 추천 모듈에 요청하여 추천 사항을 받아 전시한다. 인공지능 서버는 분석 작업과 추천 작업을 위해 데이터베이스를 사용하며, 이 작업은 데이터 베이스의 관리모듈에 의해 이루어진다. 인공지능 서버는 GPU를 탑재하여 인공지능 연산에 이용할 수 있다. 영상단말기가 자체적으로 구강 이미지를 촬영할 수도 있으나, USB 등 외장 인터페이스를 통해 연결되는 구 강카메라를 이용하여 촬영될 수도 있다. 구강카메라는 카메라 모듈을 탑재한다. 이와 같이 구성된 본 발명의 시스템을 통해, (도 22)와 같이 자가진단으로 치아의 충치여부를 쉽게 확인할 수 있으며, 이는 조기진단까지 이어질 수 있다는 것을 확인하였다. 이상, 본 발명내용의 특정한 부분을 상세히 기술하였는바, 당업계의 통상의 지식을 가진 자에게 있어서, 이러한 구체적인 기술은 단지 바람직한 실시양태일 뿐이며, 이에 의해 본 발명의 범위가 제한되는 것이 아닌 점은 명백 할 것이다. 따라서 본 발명의 실질적인 범위는 첨부된 청구항들과 그것들의 등가물에 의해 정의된다고 할 것이다."}
{"patent_id": "10-2019-0030345", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명에 따른, 충치 진단 영역 탐색 방법의 처리 순서도. 도 2는 본 발명에서, CNN 네트워크를 이용하는 전후 처리 방법의 순서도. 도 3은 본 발명에서 사용한 치아 검출 과정 흐름의 순서도. 도 4는 치아의 표면에서 발생한 경면 반사 영역의 모습. 도 5은 도 4를 반전시킨 모습. 도 6은 본 발명으로 경면 반사의 효과가 어느 정도 제거된 사진. 도 7은 본 발명으로 연산과정을 거쳐 잇몸 영역들이 제거된 결과가 나오는 과정을 보여주는 사진. 도 8은 연산과정을 거치기 전의 원본 치아 사진. 도 9는 빛 반사 및 붉은 영역 제거한 뒤 이미지에 Treshold 적용한 결과 사진. 도 10은 Erosion과 Dilation(Opening)을 거친 결과 사진. 도 11은 원본 치아 사진으로부터 윤곽선을 검출한 결과 사진. 도 12는 본 발명으로 데이터 선별을 하고 데이터를 증진시키고 겅제하는 과정을 나타낸 과정도. 도 13은 본 발명으로 CNN 학습 네트워크를 이용하여, 학습을 진행하는 과정을 나타낸 과정도. 도 14은 본 발명으로 CNN 학습 네트워크를 이용하여, 학습을 진행하는 과정을 나타낸 과정도. 도 15은 본 발명으로 CNN 학습 네트워크를 이용하여, 학습을 진행하는 과정을 나타낸 과정도. 도 16은 본 발명으로 CNN 학습 네트워크를 이용하여, 학습을 진행하는 과정을 나타낸 과정도. 도 17은 본 발명으로 원본 치아 사진에서 Metal과 Cavity를 식별한 결과 사진 1. 도 18은 본 발명으로 원본 치아 사진에서 Metal과 Cavity를 식별하고 충치가 진행된 것도 확인한 결과 사진 2. 도 19는 본 발명으로 원본 치아 사진에서 Cavity를 식별한 결과 사진 3. 도 20은 본 발명의 충치 진단 영역 탐색과, 인공지능을 이용하여 충치 영역을 식별하는 시스템의 구성도. 도 21은 본 발명의 충치 진단 영역 탐색과, 인공지능을 이용하여 충치 영역을 식별하는 시스템의 내부기능 구 성도. 도 22는 본 발명을 이용하여, 구강카메라와 스마트폰을 통해, 자가진단으로 치아의 충치 여부를 쉽게 확인할 수 있다는 개념도."}
