{"patent_id": "10-2023-0069397", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2024-0062901", "출원번호": "10-2023-0069397", "발명의 명칭": "인공지능 기반 심방세동 예측 장치 및 이의 동작 방법", "출원인": "사회복지법인 삼성생명공익재단", "발명자": "박경민"}}
{"patent_id": "10-2023-0069397", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "적어도 하나의 프로세서에 의해 동작하는 심방세동 예측 장치로서,일정 기간을 두고 측정된 개인의 심전도 쌍을 획득하고, 상기 심전도 쌍의 차이를 인공지능 모델의 입력 데이터로 생성하는 심전도 전처리기,심전도 차이로부터 심방세동 발생 가능성을 예측하도록 훈련되고, 상기 입력 데이터로부터 예측한 심방세동 발생 확률을 출력하는 인공지능 모델, 그리고상기 심방세동 발생 확률을 포함하는 심방세동 예측을 지정된 장치에게 제공하는 예측 정보 제공기를 포함하는 심방세동 예측 장치."}
{"patent_id": "10-2023-0069397", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에서,상기 심전도 전처리기는 상기 심전도 쌍에 포함된 각 심전도의 심전도 신호들로부터 심전도 특징들을 추출하고, 두 심전도들의 특징 차이를 상기 입력 데이터로 생성하는, 심방세동 예측 장치."}
{"patent_id": "10-2023-0069397", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제2항에서,상기 심전도 특징들은 P-QRS-T 파형 특징들을 포함하는, 심방세동 예측 장치."}
{"patent_id": "10-2023-0069397", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제3항에서,상기 심전도 특징들은 심전도 비트 유사도, 세동 파 에너지, 그리고 P파 특징 중 적어도 하나를 더 포함하는,심방세동 예측 장치."}
{"patent_id": "10-2023-0069397", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제1항에서,상기 입력 데이터는 상기 개인의 성별과 연령 중 적어도 하나를 더 포함하는, 심방세동 예측 장치."}
{"patent_id": "10-2023-0069397", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제1항에서,상기 인공지능 모델은 훈련 데이터를 사용하여 입력과 상기 입력에 태깅된 레이블의 관계를 학습함으로써, 상기 입력 데이터에 대해예측한 0과 1 사이의 값을 출력하고,상기 훈련 데이터는 제1 방문과 제2 방문에서 측정한 제1 심전도와 제2 심전도가 정상이고, 제3 방문에서 측정한 제3 심전도가 정상 또는 심방세동인 환자들의 심전도들을 이용하여 생성되는데, 상기 입력은 상기 제1 심전도와 상기 제2 심전도의 차이이고, 상기 레이블은 해당 환자의 제3 심전도에 따라 부여되는, 심방세동 예측 장치."}
{"patent_id": "10-2023-0069397", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "공개특허 10-2024-0062901-3-제1항에서,상기 심방세동 예측은 상기 심방세동 발생 확률에 대한 성능 지표를 더 포함하는 심방세동 예측 장치."}
{"patent_id": "10-2023-0069397", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제1항에서,상기 예측 정보 제공기는상기 심방세동 예측에 관계된 의사결정 보조 정보를 제공하는, 심방세동 예측 장치."}
{"patent_id": "10-2023-0069397", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "적어도 하나의 프로세서에 의해 동작하는 심방세동 예측 장치의 동작 방법으로서,일정 기간을 두고 측정된 개인의 심전도 쌍을 획득하는 단계, 그리고심전도 차이로부터 심방세동 발생 가능성을 예측하도록 훈련된 인공지능 모델을 사용하여, 상기 심전도 쌍의 심전도 차이에 대한 심방세동 발생 확률을 예측하는 단계를 포함하는 동작 방법."}
{"patent_id": "10-2023-0069397", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제9항에서,상기 인공지능 모델은 훈련 데이터를 사용하여 입력과 상기 입력에 태깅된 레이블의 관계를 학습함으로써, 상기 입력 데이터에 대해예측한 0과 1 사이의 값을 출력하고,상기 훈련 데이터는 제1 방문과 제2 방문에서 측정한 제1 심전도와 제2 심전도가 정상이고, 제3 방문에서 측정한 제3 심전도가 정상 또는 심방세동인 환자들의 심전도들을 이용하여 생성되는데, 상기 입력은 상기 제1 심전도와 상기 제2 심전도의 차이이고, 상기 레이블은 해당 환자의 제3 심전도에 따라 부여되는, 동작 방법."}
{"patent_id": "10-2023-0069397", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "제9항에서,상기 심전도 쌍에 포함된 각 심전도의 심전도 신호들로부터 심전도 특징들을 추출하고, 두 심전도들의 특징 차이를 상기 인공지능 모델의 입력 데이터로 생성하는 단계를 더 포함하는 동작 방법."}
{"patent_id": "10-2023-0069397", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제11항에서,상기 심전도 특징들은 P-QRS-T 파형 특징들을 포함하는, 동작 방법."}
{"patent_id": "10-2023-0069397", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "제12항에서,상기 심전도 특징들은 심전도 비트 유사도, 세동 파 에너지, 그리고 P파 특징 중 적어도 하나를 더 포함하는,동작 방법."}
{"patent_id": "10-2023-0069397", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_14", "content": "제11항에서,상기 입력 데이터는 상기 개인의 성별과 연령 중 적어도 하나를 더 포함하는, 동작 방법.공개특허 10-2024-0062901-4-청구항 15 제9항에서,상기 심방세동 발생 확률을 포함하는 심방세동 예측, 그리고 상기 심방세동 예측에 관계된 의사결정 보조 정보를 지정된 장치에게 제공하는 단계를 더 포함하는 동작 방법."}
{"patent_id": "10-2023-0069397", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_16", "content": "제15항에서,상기 심방세동 예측은 상기 심방세동 발생 확률에 대한 성능 지표를 더 포함하는 동작 방법."}
{"patent_id": "10-2023-0069397", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_17", "content": "적어도 하나의 프로세서에 의해 동작하는 심방세동 예측 장치의 동작 방법으로서,심전도를 측정한 환자가 과거에도 심전도를 측정한 재진 환자인지 초진 환자인지를 식별하는 단계,재진 환자라면 심전도 차이로부터 심방세동 발생 가능성을 예측하도록 훈련된 연속 심전도 모델을 사용해서, 상기 환자의 과거와 현재의 심전도 차이에 대해 예측된 심방세동 발생 확률을 획득하는 단계, 초진 환자라면 단일 심전도로부터 심방세동 발생 가능성을 예측하도록 훈련된 단일 심전도 모델을 사용해서, 상기 환자의 현재 심전도에 대해 예측된 심방세동 발생 확률을 획득하는 단계, 그리고상기 환자의 심방세동 발생 확률을 포함하는 심방세동 예측을 지정된 장치에게 제공하는 단계를 포함하는 동작 방법."}
{"patent_id": "10-2023-0069397", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_18", "content": "제17항에서,상기 연속 심전도 모델은 훈련 데이터를 사용하여 입력과 상기 입력에 태깅된 레이블의 관계를 학습함으로써, 상기 환자의 심전도 차이에대해 예측한 0과 1 사이의 값을 출력하고,상기 훈련 데이터는 제1 방문과 제2 방문에서 측정한 제1 심전도와 제2 심전도가 정상이고, 제3 방문에서 측정한 제3 심전도가 정상 또는 심방세동인 환자들의 심전도들을 이용하여 생성되는데, 상기 입력은 상기 제1 심전도와 상기 제2 심전도의 차이이고, 상기 레이블은 해당 환자의 제3 심전도에 따라 부여되는, 동작 방법."}
{"patent_id": "10-2023-0069397", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_19", "content": "제17항에서,상기 단일 심전도 모델은 훈련 데이터를 사용하여 입력과 상기 입력에 태깅된 레이블의 관계를 학습함으로써, 상기 입력 데이터에 대해예측한 0과 1 사이의 값을 출력하고,상기 훈련 데이터는 제1 방문에서 측정한 제1 심전도가 정상이고, 제2 방문에서 측정한 제2 심전도가 정상 또는심방세동인 환자들의 심전도들을 이용하여 생성되는데, 상기 입력은 상기 제1 심전도의 특징들이고, 상기 레이블은 해당 환자의 제2 심전도에 따라 부여되는, 동작 방법."}
{"patent_id": "10-2023-0069397", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_20", "content": "제17항에서,상기 심방세동 예측에 관계된 의사결정 보조 정보를 지정된 장치에게 제공하는 단계공개특허 10-2024-0062901-5-를 더 포함하는, 동작 방법."}
{"patent_id": "10-2023-0069397", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "적어도 하나의 프로세서에 의해 동작하는 심방세동 예측 장치는 일정 기간을 두고 측정된 개인의 심전도 쌍을 획 득하고, 상기 심전도 쌍의 차이를 인공지능 모델의 입력 데이터로 생성하는 심전도 전처리기, 심전도 차이로부터 심방세동 발생 가능성을 예측하도록 훈련되고, 상기 입력 데이터로부터 예측한 심방세동 발생 확률을 출력하는 인공지능 모델, 그리고 상기 심방세동 발생 확률을 포함하는 심방세동 예측을 지정된 장치에게 제공하는 예측 정 보 제공기를 포함한다."}
{"patent_id": "10-2023-0069397", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 개시는 심방세동 예측에 관한 것이다."}
{"patent_id": "10-2023-0069397", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "심방세동(atrial fibrillation, AF)은 가장 흔한 부정맥 질환(arrhythmia)으로서 고령화로 인해 매년 심방세동 환자가 급격히 증가하고 있고, 이로 인한 합병증과 의료비 또한 증가하고 있다. 심방세동 환자는 정상인에 비해 뇌졸중 발생 위험이 5배가 높고, 심방세동 환자의 30%는 일생을 살아가는 도중 에 한 번 이상 뇌졸중을 경험하는 것으로 알려져 있다. 신경과 보고에 의하면 급성 뇌졸중으로 입원한 환자들의 30-40% 정도가 심방세동과 관련이 있었고, 이들 중 50% 정도는 입원 전이 아닌 입원 이후 심전도 검사나 장기간 의 심전도 모니터링에서 발견되는 경우가 많다고 알려져 있다. 심방세동 환자의 뇌졸중을 예방하는 핵심은 조기 진단을 통한 항응고 치료이다. 하지만 초기에는 심방세동이 아 주 발작적으로 짧게 나타나는 경우가 대부분이기 때문에 조기 진단이 어려운 문제가 있다. [비특허문헌] Raghunath S, et al. Deep Neural Networks Can Predict New-Onset Atrial Fibrillation From the 12-Lead ECG and Help Identify Those at Risk of Atrial Fibrillation-Related Stroke. Circulation 2021; 143: 1287-98."}
{"patent_id": "10-2023-0069397", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 개시는 인공지능 기반 심방세동 예측 장치 및 이의 동작 방법에 관한 것이다. 본 개시는 심전도(electrocardiograms, ECGs) 변화로부터 환자의 심방세동 발생을 예측하는 인공지능 모델에 관 한 것이다."}
{"patent_id": "10-2023-0069397", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "한 실시예에 따른 적어도 하나의 프로세서에 의해 동작하는 심방세동 예측 장치로서, 일정 기간을 두고 측정된 개인의 심전도 쌍을 획득하고, 상기 심전도 쌍의 차이를 인공지능 모델의 입력 데이터로 생성하는 심전도 전처 리기, 심전도 차이로부터 심방세동 발생 가능성을 예측하도록 훈련되고, 상기 입력 데이터로부터 예측한 심방세 동 발생 확률을 출력하는 인공지능 모델, 그리고 상기 심방세동 발생 확률을 포함하는 심방세동 예측을 지정된 장치에게 제공하는 예측 정보 제공기를 포함한다. 상기 심전도 전처리기는 상기 심전도 쌍에 포함된 각 심전도의 심전도 신호들로부터 심전도 특징들을 추출하고, 두 심전도들의 특징 차이를 상기 입력 데이터로 생성할 수 있다. 상기 심전도 특징들은 P-QRS-T 파형 특징들을 포함할 수 있다. 상기 심전도 특징들은 심전도 비트 유사도, 세동 파 에너지, 그리고 P파 특징 중 적어도 하나를 더 포함할 수 있다. 상기 입력 데이터는 상기 개인의 성별과 연령 중 적어도 하나를 더 포함할 수 있다. 상기 인공지능 모델은 훈련 데이터를 사용하여 입력과 상기 입력에 태깅된 레이블의 관계를 학습함으로써, 상기 입력 데이터에 대해 예측한 0과 1 사이의 값을 출력할 수 있다. 상기 훈련 데이터는 제1 방문과 제2 방문에서 측정한 제1 심전도와 제2 심전도가 정상이고, 제3 방문에서 측정한 제3 심전도가 정상 또는 심방세동인 환자들 의 심전도들을 이용하여 생성되는데, 상기 입력은 상기 제1 심전도와 상기 제2 심전도의 차이이고, 상기 레이블 은 해당 환자의 제3 심전도에 따라 부여될 수 있다.상기 심방세동 예측은 상기 심방세동 발생 확률에 대한 성능 지표를 더 포함할 수 있다. 상기 예측 정보 제공기는 상기 심방세동 예측에 관계된 의사결정 보조 정보를 제공할 수 있다. 한 실시예 따른 적어도 하나의 프로세서에 의해 동작하는 심방세동 예측 장치의 동작 방법으로서, 일정 기간을 두고 측정된 개인의 심전도 쌍을 획득하는 단계, 그리고 심전도 차이로부터 심방세동 발생 가능성을 예측하도록 훈련된 인공지능 모델을 사용하여, 상기 심전도 쌍의 심전도 차이에 대한 심방세동 발생 확률을 예측하는 단계 를 포함한다. 상기 인공지능 모델은 훈련 데이터를 사용하여 입력과 상기 입력에 태깅된 레이블의 관계를 학습함으로써, 상기 입력 데이터에 대해 예측한 0과 1 사이의 값을 출력할 수 있다. 상기 훈련 데이터는 제1 방문과 제2 방문에서 측정한 제1 심전도와 제2 심전도가 정상이고, 제3 방문에서 측정한 제3 심전도가 정상 또는 심방세동인 환자들 의 심전도들을 이용하여 생성되는데, 상기 입력은 상기 제1 심전도와 상기 제2 심전도의 차이이고, 상기 레이블 은 해당 환자의 제3 심전도에 따라 부여될 수 있다. 상기 동작 방법은 상기 심전도 쌍에 포함된 각 심전도의 심전도 신호들로부터 심전도 특징들을 추출하고, 두 심 전도들의 특징 차이를 상기 인공지능 모델의 입력 데이터로 생성하는 단계를 더 포함할 수 있다. 상기 심전도 특징들은 P-QRS-T 파형 특징들을 포함할 수 있다. 상기 심전도 특징들은 심전도 비트 유사도, 세동 파 에너지, 그리고 P파 특징 중 적어도 하나를 더 포함할 수 있다. 상기 입력 데이터는 상기 개인의 성별과 연령 중 적어도 하나를 더 포함할 수 있다. 상기 동작 방법은 상기 심방세동 발생 확률을 포함하는 심방세동 예측, 그리고 상기 심방세동 예측에 관계된 의 사결정 보조 정보를 지정된 장치에게 제공하는 단계를 더 포함할 수 있다. 상기 심방세동 예측은 상기 심방세동 발생 확률에 대한 성능 지표를 더 포함할 수 있다. 한 실시예에 따른 적어도 하나의 프로세서에 의해 동작하는 심방세동 예측 장치의 동작 방법으로서, 심전도를 측정한 환자가 과거에도 심전도를 측정한 재진 환자인지 초진 환자인지를 식별하는 단계, 재진 환자라면 심전도 차이로부터 심방세동 발생 가능성을 예측하도록 훈련된 연속 심전도 모델을 사용해서, 상기 환자의 과거와 현재 의 심전도 차이에 대해 예측된 심방세동 발생 확률을 획득하는 단계, 초진 환자라면 단일 심전도로부터 심방세 동 발생 가능성을 예측하도록 훈련된 단일 심전도 모델을 사용해서, 상기 환자의 현재 심전도에 대해 예측된 심 방세동 발생 확률을 획득하는 단계, 그리고 상기 환자의 심방세동 발생 확률을 포함하는 심방세동 예측을 지정 된 장치에게 제공하는 단계를 포함한다. 상기 연속 심전도 모델은 훈련 데이터를 사용하여 입력과 상기 입력에 태깅된 레이블의 관계를 학습함으로써, 상기 환자의 심전도 차이에 대해 예측한 0과 1 사이의 값을 출력할 수 있다. 상기 훈련 데이터는 제1 방문과 제 2 방문에서 측정한 제1 심전도와 제2 심전도가 정상이고, 제3 방문에서 측정한 제3 심전도가 정상 또는 심방세 동인 환자들의 심전도들을 이용하여 생성되는데, 상기 입력은 상기 제1 심전도와 상기 제2 심전도의 차이이고, 상기 레이블은 해당 환자의 제3 심전도에 따라 부여될 수 있다. 상기 단일 심전도 모델은 훈련 데이터를 사용하여 입력과 상기 입력에 태깅된 레이블의 관계를 학습함으로써, 상기 입력 데이터에 대해 예측한 0과 1 사이의 값을 출력할 수 있다. 상기 훈련 데이터는 제1 방문에서 측정한 제1 심전도가 정상이고, 제2 방문에서 측정한 제2 심전도가 정상 또는 심방세동인 환자들의 심전도들을 이용하 여 생성되는데, 상기 입력은 상기 제1 심전도의 특징들이고, 상기 레이블은 해당 환자의 제2 심전도에 따라 부 여될 수 있다. 상기 동작 방법은 상기 심방세동 예측에 관계된 의사결정 보조 정보를 지정된 장치에게 제공하는 단계를 더 포 함할 수 있다."}
{"patent_id": "10-2023-0069397", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 개시에 따르면, 개인의 특성을 고려한 진화된 인공지능 모델을 통해 미래에 심방세동이 발생할 환자들을 정 확히 선별할 수 있다. 본 개시에 따르면, 심방세동 발생 확률이 높은 환자에게 적극적인 심전도 모니터링 검사나 선제적 항응고 치료 와 같은 의료인의 의사결정을 지원할 수 있고, 이를 통해 심방세동 진단률을 높일 수 있다. 본 개시에 따르면, 심방세동 발생 가능성에 따라 적절한 후속 임상 절차를 추천할 수 있고, 심방세동 예측의 정 확도를 고려하여 최적의 추적 관찰 기간(예를 들면, 3개월)을 결정할 수 있다."}
{"patent_id": "10-2023-0069397", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "아래에서는 첨부한 도면을 참고로 하여 본 개시의 실시예에 대하여 본 개시가 속하는 기술 분야에서 통상의 지 식을 가진 자가 용이하게 실시할 수 있도록 상세히 설명한다. 그러나 본 개시는 여러 가지 상이한 형태로 구현 될 수 있으며 여기에서 설명하는 실시예에 한정되지 않는다. 그리고 도면에서 본 개시를 명확하게 설명하기 위 해서 설명과 관계없는 부분은 생략하였으며, 명세서 전체를 통하여 유사한 부분에 대해서는 유사한 도면 부호를 붙였다. 명세서 전체에서, 어떤 부분이 어떤 구성요소를 \"포함\"한다고 할 때, 이는 특별히 반대되는 기재가 없는 한 다 른 구성요소를 제외하는 것이 아니라 다른 구성요소를 더 포함할 수 있는 것을 의미한다. 또한, 명세서에 기재 된 \"…부\", \"…기\", \"모듈\" 등의 용어는 적어도 하나의 기능이나 동작을 처리하는 단위를 의미하며, 이는 하드 웨어나 소프트웨어 또는 하드웨어 및 소프트웨어의 결합으로 구현될 수 있다. 심전도(electrocardiogram, ECG)는 몸에 부착한 전극을 통해 얻은 신호들로서, 심전도 검사는 주로 부정맥 질환 을 감별하기 위해 이용되는 심장 검사이다. 표준 12-유도 심전도는 양쪽의 손목, 발목, 가슴에 부착한 전극들을 통해 얻는데, 표준팔다리유도Ⅰ, Ⅱ, Ⅲ, 증폭된(augmented) 단극팔다리유도 aVR, aVL, aVF, 가슴유도 V1, V2, V3, V4, V5, V6를 포함한다. 인공지능 기술의 발전에 따라 다양한 의료 예측에 인공지능 기술이 활용되고 있고, 12-유도 심전도로부터 심방 세동을 예측하고자 하는 연구도 진행되고 있다. 종래 기술은 한 개인에서 얻은 하나의 정상동율동(Normal Sinus Rhythm, NSR) 심전도를 이용하여 심방세동을 예측하는 것이 대부분이다. 이는, 심전도를 통해 심방세동을 예측 하는 것은 미래에 심방세동이 발생할 사람과 그렇지 않은 사람의 NSR 심전도가 서로 다를 것이라는 이론적 배경 에 기초하고 있다. 하지만, 개인마다 심장의 모양, 크기, 회전, 흉곽과의 상대적인 위치, 그리고 체성분의 구성 등이 모두 다르기 때문에, 실제로 심혈관 질환이 없는 건강한 성인에서 얻어진 NSR 파형조차 개인마다 큰 차이 를 보인다. 따라서, 사람의 눈으로 구별하기 불가능할 정도의 미묘한 변화로 나타나는 심방세동을 예측해야 하 지만, 사람의 눈으로 판별 가능할 정도인 정상동율동 파형들로 인공지능 모델이 훈련되기 때문에, 예측 성능을 어느 정도의 이상으로 높이는데 한계가 있다. 이러한 종래 기술과 달리, 본 개시는 개인마다 심전도 파형이 다양하고, 심방세동이 일어나기 전 심장의 리모델 링(cardiac remodeling)이 선행하며, 이런 미묘한 변화들이 인공지능 수준에서만 분별 가능한 심전도 변화를 야 기하므로, 이러한 심전도 변화로부터 미래의 심방세동 발생을 예측하는 인공지능 모델을 제시한다. 도 1은 한 실시예에 따른 인공지능 기반 심방세동 예측 장치를 설명하는 도면이고, 도 2는 심전도 신호의 예시 이고, 도 3은 P-QRS-T 분석의 예시이고, 도 4는 한 실시예에 따른 심전도 비트 유사도 계산 방법을 설명하는 도면이다. 도 1을 참고하면, 적어도 하나의 프로세서에 의해 동작하는 심방세동 예측 장치는 심전도 (electrocardiogram, ECG)로부터 심방세동 발생(occurrence of atrial fibrillation)을 예측하도록 훈련된 인 공지능(Artificial intelligence, AI) 모델을 포함한다. 심방세동 예측 장치는 환자의 심방세동 발생 가능성을 포함하는 심방세동 예측을 출력하는데, 과거와 현재의 심전도 변화로부터 미래의 심방세동 발생 가능 성을 예측할 수 있다. 심방세동 예측 장치는 인공지능 모델을 통해, 현재는 정상 심전도이지만, 미래 에 새롭게 발생할 심장세동(new-onset AF)을 예측할 수 있다. 심방세동 예측 장치는 환자의 심방세동 발생 가능성을 단말의 인터페이스 화면에 제공하고, 의사결정 보조 정보를 단말의 인터페이스 화면에 추가적으로 제공할 수 있다. 심방세동 예측 장치는 본 개시를 수행하는 프로그램 및 이를 실행하는 하드웨어를 탑재한 컴퓨팅 장치로 구현될 수 있다. 컴퓨팅 장치는 본 개시 를 수행하는 프로그램을 설치하고, 실행함으로써, 심방세동 예측 장치로 동작할 수 있다. 심방세동 예측 장치는 유무선 네트워크를 통해 적어도 하나의 심전도 측정 장치, 환자 정보 및 심전도 데이터베이스를 포함하는 의료 데이터베이스, 그리고 적어도 하나의 단말과 연동하도록 구축될 수 있다. 이외에도, 심방세동 예측 장치는 다양한 형태로 구축될 수 있는데, 예를 들면, 심전도 측정 장치(2 0)와 일체형으로 구축될 수 있고, 또는 심전도 측정 장치가 위치한 로컬 사이트마다 개별적으로 구축될 수 있다. 심방세동 예측 장치는 심전도 신호들로부터 인공지능 모델의 입력 데이터를 생성하는 심전도 전처리기 , 그리고 입력 데이터로부터 심방세동 발생을 예측하는 인공지능 모델을 포함할 수 있다. 심방세동 예측 장치는 환자의 심전도로부터 예측된 심방세동 발생 가능성, 그리고 심방세동 예측에 관계된 의사결정 보조 정보를 단말에 제공하는 예측 정보 제공기를 더 포함할 수 있다. 심전도 전처리기는 심전도 측정 장치에서 실시간으로 측정된 심전도 데이터를 입력받을 수 있고, 또는 의료 데이터베이스에 저장된 심전도 데이터를 입력받을 수 있다. 심전도 전처리기는 환자의 심전도 신호들로부터 심전도 특징들(ECG features)을 추출하고, 심전도 특징들 을 이용하여 인공지능 모델에 맞는 입력 데이터를 생성할 수 있다. 인공지능 모델의 입력 데이터는 심전도 특징들의 조합에 의해 다양하게 정의될 수 있다. 심전도 특징들로서, P-QRS-T 파형 특징들(wave features), 심전도 비트 유사도, 세동 파(fibrillatory wave, F-wave) 에너지, P파 특징 등이 사용될 수 있다. 심전도 전처리기의 동작에 대해서는 다음에서 자세히 설명한다. 심전도 전처리기는 인공지능 모델 의 훈련 데이터를 생성할 수 있다. 인공지능 모델은 심방세동 발생 가능성을 포함하는 심방세동 예측을 출력하는데, 심방세동 발생 가능성은 발생 시점과 함께 제공될 수 있다. 심방세동 발생 가능성은 확률, 점수, 위험도(상, 중, 하) 등으로 표현될 수 있고, 주로 확률을 예로 들어 설명할 수 있다. 심방세동 발생 시점은 예를 들면, 3개월 후, 6개월 후, 1년 후 등으로 제공될 수 있다. 인공지능 모델에서 출력되는 심방세동 예측은 훈련 데이터에 따라 다양하게 변경 될 수 있다. 인공지능 모델은 입력으로부터 심방세동 발생 가능성을 출력하도록 훈련 가능한 다양한 모델로 구현될 수 있다. 예를 들면, 인공지능 모델은 결정 트리 기반의 배깅(Bagging), 부스팅(Boosting) 계열 모델이 모두 사용될 수 있는데, 상대적으로 부스팅 계열 모델이 배깅 계열 모델보다 예측 정확도가 높다. 부스팅 계열 중에 서 GBM(Gradient Boosting Machine), 입력 변수의 일부가 누락되어도 사용 가능한 LGBM(Light Gradient Boosting Machine), XGBoost 등이 사용될 수 있다. 부스팅 기반 인공지능 모델은 부스팅 결정 트리에 기반하여 일정 시점(예를 들면, 1달) 이후의 심방세동 발생 확률을 출력할 수 있다. 인공지능 모델은 심전도 변화로부터 심방세동 발생 가능성을 예측하도록 훈련된 연속 심전도 모델(serial ECG model)을 포함할 수 있다. 여기서, 심전도 변화는 일정 기간을 두고 측정된 개인의 심전도 쌍으로부터 획득될 수 있다. 인공지능 모델은 현재 심전도로부터 심방세동 발생 가능성을 예측하도록 훈련된 단일 심 전도 모델(single ECG model)을 더 포함할 수 있다. 연속 심전도 모델이 심방세동이 일어나기 전의 미묘한 변화로부터 심방세동을 예측하므로, 단일 심전도 모델보다 예측 정확도가 우수할 수 있다. 따라서, 심방세동 예측 장치는 환자가 과거에도 심전도를 측정한 재진 환자인지 초진 환자인지를 식별하고, 재진 환 자라면, 연속 심전도 모델을 사용해서 심방세동 발생 확률을 획득할 수 있다. 그리고 초진 환자라면, 심방 세동 예측 장치는 단일 심전도 모델을 사용해서 심방세동 발생 확률을 획득할 수 있다. 인공지능 모델은 정상동율동(NSR) 심전도를 훈련 데이터로 사용하는데, 훈련 데이터를 구성하는 입력 데이 터와 레이블은 모델에 따라 다르게 생성될 수 있다. NSR 심전도는 정상 심전도라고 부를 수 있다. 예를 들면, 연속 심전도 모델은 3번 이상 방문해서 심전도를 측정한 환자들의 심전도를 사용하여 훈련되는 데, 첫 번째 방문과 두 번째 방문에서 측정한 심전도는 NSR이고, 세 번째 방문에서 측정한 심전도는 NSR 또는 심방세동(AF)인 심전도들이 사용될 수 있다. 이 경우, 첫 번째 방문과 두 번째 방문의 NSR 심전도 차이가 입력 데이터인데, 세 번째 방문의 심전도가 NSR이라면 입력 데이터에 레이블 0이 태깅되고, 세 번째 방문의 심전도가 AF라면 입력 데이터에 레이블 1이 태깅될 수 있다. 심전도에 대한 진단(NSR 또는 AF)은 심전도 데이터에 포함되 거나, 해당 환자의 의료 기록에 표시되어 있을 수 있다. 단일 심전도 모델은 2번 이상 방문해서 심전도를 측정한 환자들의 심전도를 사용하여 훈련되는데, 첫 번째 방문에서 측정한 심전도는 NSR이고, 두 번째 방문에서 측정한 심전도는 NSR 또는 AF인 심전도들이 사용될 수 있 다. 이 경우, 첫 번째 방문의 NSR 심전도 특징이 입력 데이터이고, 두 번째 방문의 심전도가 NSR이라면 입력 데 이터에 레이블 0이 태깅되고, 두 번째 방문의 심전도가 AFib이라면 입력 데이터에 레이블 1이 태깅될 수 있다. 예측 정보 제공기는 인공지능 모델에서 출력된 환자의 심방세동 예측, 그리고 심방세동 예측에 관계 된 의사결정 보조 정보를 단말에 제공할 수 있다. 심방세동 예측은 심방세동 발생 확률, 예측값에 대한성능 지표 등을 포함할 수 있다. 성능 지표는 예를 들면, 민감도(sensitivity), 특이도(specificity), 정확도 (accuracy), PPV(positive predictive value), NPV(negative predictive value)를 포함할 수 있다. 심방세동 예측은 적어도 하나의 기간에 대한 심방세동 발생 확률을 포함할 수 있다. 의사결정 보조 정보는 의료인의 진단 및 의사결정을 보조하기 위한 정보로서, 심방세동 예측에 따라 추천된 후속 임상 절차를 포함할 수 있다. 후속 임상 절차는 예를 들면, 적극적인 심전도 모니터링 검사, 추가 검사 없이 추적관찰 종료, 일정 기간 이후에 심 전도 검사 재시행 등을 포함할 수 있다. 예를 들어, 심방세동 발생 확률이 높은 환자의 경우, 심방세동 예측 장 치는 웨어러블 디바이스로 생활하면서 심전도를 측정하고 이를 이용하여 모니터링하는 적극적인 심전도 모 니터링 검사를 추천할 수 있다. 심방세동 예측 장치는 의료인이 심방세동 예측 장치를 통해 미래에 심방세동이 발생할 환자들을 선별할 수 있도록 지원할 수 있다. 또한, 심방세동 예측 장치는 심방세동 발생 확률이 높은 환자에게 적극적인 심 전도 모니터링 검사나 선제적 항응고 치료와 같은 의료인의 의사결정을 지원할 수 있고, 이를 통해 심방세동 진 단률을 높일 수 있다. 환자들은 심방세동 발생을 미리 대비할 수 있어서 심방세동으로 인한 뇌졸중과 같은 위험 한 합병증을 예방할 수 있다. 다음에서, 심전도 전처리기가 인공지능 모델의 입력 데이터를 생성하기 위해 심전도 특징들을 추출하 는 방법에 대해 자세히 설명한다. 심전도 전처리기는 환자의 심전도 데이터를 입력받는다. 심전도 데이터는 일반적으로 12-유도 심전도를 통 해 측정된 신호 정보, 환자의 기본 정보를 포함하는 원시 데이터로서, XML 파일 형식으로 저장될 수 있다. 정상 심전도인 경우, XML 데이터에는 <Diagnosis> 태그 내 <Statement> 태그에 Sinus rhythm이라는 정보가 입력되고, 정상이 아닌 경우, 다른 병명이 입력될 수 있다. XML 데이터는 측정 값들을 저장하고, 측정 값들은 심전도 파형으로 변환될 수 있다. 심전도 전처리기는 심전도 데이터로부터 심전도 신호를 생성할 수 있다. 심전도 전처리기는 심전도 데이터에 포함된 레이블을 심전도 신호에 연결시킬 수 있다. 도 2를 참고하면, 심전도 신호는 12-유도(Ⅰ, Ⅱ, Ⅲ, aVR, aVL, aVF, V1, V2, V3, V4, V5, V6)로 측정된 신호 파형으로 표현될 수 있다. 심전도 전처리기는 심전도 신호에 포함된 잡음(noise)을 제거할 수 있다. 정상적으로 심전도가 측정된 경 우라도 잡음이 드물게 포함될 수 있다. 예를 들면, 심전도 신호에 전력선 잡음(Power line interference)이나 기저선 변동 잡음(Baseline wander)이 포함될 수 있다. 전력선 잡음은 기계적인 잡음으로 모든 신호에 섞여 있 고, 50~60Hz 주파수에 많이 분포되어 있다. 기저선 변동 잡음은 파형이 출렁이는 형태로 나타나고, 1Hz 이하 주 파수에 많이 포함되어 있다. 따라서, 0.5 ~ 45Hz 대역 통과 필터를 통해 심전도 신호에 포함된 잡음을 제거할 수 있다. 이외에도 알려진 잡음 제거 방법이 사용될 수 있다. 심전도 전처리기는 심전도 신호에 포함된 이상치(outlier)를 제거할 수 있다. 잡음이 제거된 심전도 신호 라도 이상치가 존재할 수 있다. 심전도 전처리기는 심전도 신호를 구성하는 데이터 포인트들에 대해서, 표 준 점수(Standard-score)라고 하는 Z-점수(Z-score)를 계산하고, 임계값(예를 들면, 10)보다 큰 데이터 포인트 를 이상값으로 간주하고, 제거할 수 있다. Z-점수를 통해 데이터 포인트가 평균에서 얼마나 떨어져 있는지를 알수 있다. 심전도 전처리기는 다음과 같이 심전도 신호의 특징들(심전도 특징들)을 추출할 수 있다. 심전도 전처리기는 심전도 신호의 파형 특징들(wave features)을 추출할 수 있다. 파형 특징들은 P-QRS-T 파형에서 추출된 변수들의 통계들로 구성될 수 있다. 통계들은 예를 들면, 최소값, 최대값, 평균, 표준편차 중 적어도 하나로 계산될 수 있고, 중앙값 등의 다양한 통계 함수로 계산될 수 있다. 먼저, 심전도 신호는 도 3과 같이 P파, QRS군(QRS complex) 및 T파로 구성되는 단위 파형이 주기적으로 반 복된다. P파는 심방에 전달된 자극이 심방을 탈분극(depolarization)시키면서 나타나는 파형이다. Q파, R파 및 S파로 구성된 QRS군은 심실의 탈분극에 의해 생성되는 파형이다. T파는 심실의 재분극(repolarization)에서 나 타나는 파형이다. PR 간격(PR interval)은 P파의 시작부터 QRS 시작까지의 간격이고, PR 세그먼트(PR segmen t)은 P파의 끝부터 QRS 시작까지의 간격이다. ST 간격(ST interval)은 S파의 끝부터 T파의 끝까지의 간격이고, ST 세그먼트(ST segment)은 S파의 끝부터 T파의 시작까지의 간격이다. QRS 구간(QRS duration)은 Q파부터 S파 까지의 구간이다. QT 간격(QT interval)은 Q파의 시작부터 T파의 끝까지의 간격이다. 심전도 전처리기는 R파를 먼저 추출하고, P파, QRS군, 그리고 T 파를 순서대로 추출할 수 있다. 심전도 전 처리기는 단위 파형마다 변수들(각 파의 전압, 간격, 세그먼트, 구간 등)의 값을 측정하고, 각 변수의 통 계들(statistics)을 파형 특징으로 사용할 수 있다. 통계들은 최소값, 최대값, 평균, 표준편차 등을 포함할 수 있다. 심전도 전처리기는 표 1과 같은 파형 특징들을 획득할 수 있다. 파형 특징은 P-피크 통계(P-Peak statistics), Q-피크 통계(Q-Peak statistics), R-피크 통계(R-Peak statistics), S-피크 통계(S-Peak statistics), T-피크 통계(T-Peak statistics)를 포함할 수 있고, P-QRS-T파 각각의 피크 진폭 값에 대한 통계 이다. 파형 특징은 PP 간격 통계(PP interval statistics), PR 간격 통계(PR interval statistics), QQ 간격 통계(QQ interval statistics), RR 간격 통계(RR interval statistics), SS 간격 통계(SS interval statistics), TT 간격 통계(TT interval statistics), QT 간격 통계(QT interval statistics)를 포함할 수 있 고, P파와 P파의 간격(PP interval)과 같이, 지정된 간격 값에 대한 통계이다. 파형 특징은 PR 세그먼트 통계 (PR segment statistics), ST 세그먼트 통계(ST segment statistics)를 포함할 수 있고, 지정된 세그먼트 값에 대한 통계이다. 파형 특징은 P 구간 통계(P duration statistics), QRS 구간 통계(QRS duration statistics)를 포함할 수 있고, 지정된 구간 값에 대한 통계이다. 파형 특징은 P-온셋-피크 통계(P-Onset-Peak statistics), P-오프셋-피크 통계(P-Offset-Peak statistics)를 포함할 수 있다. 파형 특징은 P파의 수와 R파의 수를 포함할 수 있다. 표 1 파형 특징 설명 P-Peak statistics Q-Peak statistics R-Peak statistics S-Peak statistics T-Peak statistics진폭 값에 대한 통계 (statistics of amplitude value) PP interval statistics QQ interval statistics RR interval statistics SS interval statistics TT interval statistics PR interval statistics QT interval statistics 간격 값에 대한 통계 (statistics of interval value) PR segment statistics ST segment statistics세그먼트 값에 대한 통계 (statistics of segment value) P duration statisticsQRS duration statistics 구간 값에 대한 통계 (statistics of duration value) P-Onset-Peak statistics P-Offset-Peak statistics전압 값에 대한 통계 (statistics of amplitude value) P wave NumberR wave Number P파의 수 R파의 수심전도 전처리기는 심전도 비트 유사도를 심전도 특징으로 추출할 수 있다. 심전도 비트 유사도는 심장 박 동이 일정한지를 나타내는 척도이다. 심전도 신호는 일정 시간(예를 들면, 10초) 동안 측정된 데이터로 리듬 (Rhythm)이라는 단위를 사용하고, 이를 R-피크마다 나눈 구간을 비트(Beat)라고 한다. 심전도 비트 유사도는 상 관 관계(Beat-wise correlation) 연산을 통해 계산될 수 있는데, 비트 단위 상관 관계 계수의 평균(Mean of Beat-wise Correlation Coefficient)으로 정의될 수 있다. 비트 단위 상관 관계를 계산하는 방법은 다양할 수 있다. 도 4를 참고하면, 심전도 전처리기는 심전도 신호에서 기준이 되는 첫 번째 비트(beat1)을 추출하고, 첫 번째 비트와 나머지 비트들(beat2~beatN)의 유사도를 계산하고, 비트간에 계산된 유사도들의 평균을 심전도 비 트 유사도로 추출할 수 있다. 여기서 비트 간 유사도는 상관 관계 계수로 표현될 수 있다. 심전도 전처리기는 세동 파(fibrillatory wave, F-wave) 에너지를 심전도 특징으로 추출할 수 있다. 심방 세동의 경우 주로 4 ~ 9Hz의 세동 파(F-wave)가 측정되므로, 이 주파수 대역의 에너지를 세동 파 에너지로 추정 할 수 있다. 세동 파 에너지는 다양하게 측정될 수 있다. 세동 파 에너지는 예를 들면, F-wave index로 계산될 수 있다. 심전도 전처리기는 심전도 신호에서 관심 비트(Beat Of Interest, BOI)를 선정하고, 관심 비트에 서 세동 파 주파수 대역(4 ~ 9 Hz)를 추출한 후, 추출한 주파수 대역의 에너지를 계산할 수 있다. 그리고, 심전 도 전처리기는 관심 비트를 제외한 일정의 비트들(residual beat of interest, RBOI)에서도 세동 파 주파 수 대역의 에너지를 계산하고, BOI에 대한 RBOI의 비율을 F-wave index로 계산할 수 있다. 심전도 전처리기는 심전도 신호에서 P파 특징을 추출할 수 있다. 심방세동과 연관이 높은 P파의 특징을 사 용함으로써, 심전도 신호로부터 심방세동을 정확이 에측할 수 있다. 심전도 전처리기는 심전도 신호에서 P 파를 추출하고, P파의 왜도(Skewness)와 첨도(Kurtosis)를 P파 특징으로 사용할 수 있다. 이와 같이, 심전도 전처리기는 심전도 신호마다 다양한 심전도 특징들을 추출하고, 표 2와 같이, 환자의 심전도에서 얻은 심전도 특징값들을 저장할 수 있다. 이때, 심전도 전처리기는 심방세동 예측에서 개인의 특성을 고려하기 위해 환자 정보를 심전도 특징들과 함께 저장할 수 있고, 환자 정보는 예를 들면, 성별과 연령 을 포함할 수 있다. 표 2 종류 심전도 특징들 N 유도(leads) 설명 환자 정보 성별 1 - - 연령 1 - - 파형 P-Peak statistics Q-Peak statistics R-Peak statistics S-Peak statistics T-Peak statistics24 24 24 24 246 Leads 4 statistics PP interval statistics QQ interval statistics RR interval statistics SS interval statistics TT interval statistics PR interval statistics QT interval statistics 24 24 24 24 24 24 246 Leads 4 statistics PR segment statistics ST segment statistics24 246 Leads 4 statistics P duration statistics QRS duration statistics24 246 Leads 4 statistics P-Onset-Peak statistics P-Offset-Peak statistics24 246 Leads 4 statistics P wave NumberR wave Number 6 66 Leads심전도 비트 유사도 Beat Correlation statistics6 6 LeadsMean of Beat-wise Correlation Coefficient 세동 파 에너지f-wave index 4 I, III, V3, V5 P파 P wave statistics 12 6 Leads Skewness, Kurtosis 표 2를 참고하면, 12-유도를 통해 측정된 12개의 심전도 신호들이 모두 심방세동 예측에 사용될 필요는 없고, 일부 유도들을 통해 측정된 신호들로부터 심전도 특징들이 추출될 수 있다. 이를 통해, 인공지능 모델로 입력되는 데이터 차원을 대폭 줄이면서도 심방세동 예측을 할 수 있다. 예를 들면, P-QRS-T 파형 특징들, 심전 도 비트 유사도, P파 특징은 6개의 유도들(Lead I, Lead II, Lead V1, Lead V3, Lead V4, Lead V5)에서 측정된 신호들로부터 추출되고, 세동 파 에너지는 4개의 유도들(I, III, V3, V5)에서 측정된 신호들로부터 추출될 수 있다. 당연히, 이보다 더 많은 유도들에서 측정된 신호들로부터 심전도 특징을 추출할 수 있고, 이와 다른 조합 의 유도들에서 측정된 신호들로부터 심전도 특징을 추출할 수도 있으며, Lead I과 Lead II에서 측정된 신호들로 부터 심전도 특징을 추출할 수 있다. 각 변수의 특징값은 4가지 통계 함수(최소값, 최대값, 평균, 표준편차)로 계산될 수 있는데, 통계 함수의 종류 나 개수는 변경될 수 있다. 예를 들어, 파형 특징 중의 하나인 P-피크 통계(P-Peak statistics)는 6-유도에서 측정된 심전도 신호들로부터 추출되는데, P-피크의 진폭 값이 4가지 통계 함수로 계산되므로, 총 24개의 특징값 으로 표현될 수 있다. 심전도 비트 유사도는 6-유도에서 측정된 심전도 신호들마다 추출되므로, 총 6개의 특징 값으로 표현될 수 있다. 세동 파 에너지는 4-유도에서 측정된 심전도 신호들마다 추출되므로, 총 4개의 특징값 으로 표현될 수 있다. P파 특징은 6-유도에서 측정된 심전도 신호들마다의 왜도와 첨도이므로, 총 12개의 특징 값으로 표현될 수 있다. 여기서, 한 심전도에 대해 얻은 모든 심전도 특징들이 인공지능 모델의 입력 데이터를 만드는데 사용될 필 요는 없고, 인공지능 모델의 입력 데이터는 심전도 특징들의 조합에 의해 다양하게 정의될 수 있다. 여기 서, 연속 심전도 모델에 대한 분산분석(Analysis of variance, ANOVA))와 F-테스트 결과에 따르면, 두 NSR 심전도 간의 P파 진폭 차이가 심방세동(AF)과 정상동율동(NSR)을 구별하는 가장 강력한 심전도 파라미터로 분석되었다. 따라서, P파 진폭 차이(P-피크 통계의 차이)를 포함하는 입력 데이터를 통해, 심방세동(AF)의 예측 성능을 향상시킬 수 있다. 예를 들어, 인공지능 모델의 입력 데이터는 성별, 연령, 그리고 적어도 일부의 P-QRS-T 파형 특징들로 구 성될 수 있고, 적어도 일부의 P-QRS-T 파형 특징들은 P, Q, R, S, T 각각의 피크 통계, P, Q, R, S, T 각각의 간격 통계, PR 간격 통계, QRS 구간 통계를 포함할 수 있다. 성별, 연령, 그리고 적어도 일부의 P-QRS-T 파형 특징들 이외에, 나머지 P-QRS-T 파형 특징들, 심전도 비트 유사도, 세동 파 에너지, P파 특징이 선택적으로 인 공지능 모델의 입력 데이터에 포함될 수 있다. 연속 심전도 모델이나 단일 심전도 모델의 입력 데이터는 적어도 일부의 심전도 특징들로 구성되는데, 입력 데이터 값이 다르게 채워질 수 있다. 즉, 심전도 변화를 입력받는 연속 심전도 모델로는 일정 기간을 두고 측정된 심전도 쌍의 특징 차이가 입력될 수 있다. 단일 심전도 모델로는 단일 심전도의 특징이 그대로 입력될 수 있다. 도 5는 한 실시예에 따른 인공지능 모델의 훈련을 설명하는 도면이고, 도 6은 한 실시예에 따른 연속 심전도 모 델의 훈련 데이터 생성 방법을 설명하는 도면이며, 도 7은 한 실시예에 따른 단일 심전도 모델의 훈련 데이터 생성 방법을 설명하는 도면이다. 도 5를 참고하면, 훈련 장치는 인공지능 모델의 훈련을 위한 훈련 데이터를 생성하고, 인공지능 모델 을 훈련시킬 수 있다. 인공지능 모델은 연속 심전도 모델을 포함하고, 단일 심전도 모델을 더 포함할 수 있다. 훈련 장치는 의료 DB에서 환자들의 심전도들을 추출한다. 훈련 장치는 심방세동(AF) 심전도 이전 에 적어도 하나의 정상동율동(NSR) 심전도가 있고, 의료 기록 또는 진단 코드를 기반으로 AF 진단이 확인된 환 자를 AF 그룹으로 분류할 수 있다. 훈련 장치는 최소 2개의 NSR 심전도가 있고 AF 진단 병력이 없는 환자 를 NSR 그룹으로 분류할 수 있다. 훈련 장치는 심전도측정 간격이 최소 기간(예를 들면, 1달)보다 짧거나,최대 기간(예를 들면, 1년)보다 길면 두 심전도 중 어느 하나를 유효하지 않은 심전도로 간주하고, 환자들을 분 류할 수 있다. 도 6을 참고하면, 연속 심전도 모델의 훈련을 위해, 훈련 장치는 NSR 그룹과 AF 그룹 에서, 3개 이상의 유효한 심전도를 가진 환자들을 추출할 수 있다. 훈련 장치는 첫 번째 방문, 두 번째 방 문, 세 번째 방문에서 측정한 심전도가 모두 NSR인 환자의 심전도들을 추출하고, 첫 번째 심전도와 두 번째 심 전도의 차이를 입력 데이터로 생성하고, 입력 데이터에 레이블 0을 태깅할 수 있다. 또한, 훈련 장치는 AF 그룹에서, AF 심전도 이전에 측정된 두 심전도들이 NSR인 환자의 심전도들을 추출하고, 첫 번째 NSR 심전도와 두 번째 NSR 심전도의 차이를 입력 데이터로 생성하고, 입력 데이터에 레이블 1을 태깅할 수 있다. 훈련 장치 는 레이블 1과 레이블 0이 태깅된 입력 데이터를 사용하여, 연속 심전도 모델이 입력 데이터와 태깅 된 레이블의 관계를 학습하고, 입력에 대해 예측된 0과 1 사이의 값을 출력하도록 훈련시킨다. 이를 통해, 연속 심전도 모델은 심전도 차이를 입력받고, 심방세동이 발생할 확률을 출력할 수 있다. 연속 심전도 모델 은 기간별(예를 들면, 3개월, 6개월 12개월 등) 심방세동 발생 확률을 예측하도록 훈련될 수 있고, 필요에 따라 복수의 서브 모델들로 구성될 수 있다. 도 7을 참고하면, 단일 심전도 모델의 훈련을 위해, 훈련 장치는 NSR 그룹과 AF 그룹에서, 2개 이상 의 유효한 심전도를 가진 환자들을 추출할 수 있다. 훈련 장치는 첫 번째 방문과 두 번째 방문에서 측정한 심전도가 모두 NSR인 환자의 첫 번째 NSR 심전도를 추출하고, 첫 번째 NSR 심전도의 특징들을 입력 데이터로 생 성하고, 입력 데이터에 레이블 0을 태깅할 수 있다. 또한, 훈련 장치는 AF 그룹에서, AF 심전도 이전에 측 정된 심전도가 NSR인 환자의 NSR 심전도를 추출하고, NSR 심전도 특징들을 입력 데이터로 생성하고, 입력 데이 터에 레이블 1을 태깅할 수 있다. 훈련 장치는 레이블 1과 레이블 0이 태깅된 입력 데이터를 사용하여, 단 일 심전도 모델이 입력 데이터와 태깅된 레이블의 관계를 학습하고, 입력에 대해 예측된 0과 1 사이의 값 을 출력하도록 훈련시킨다. 이를 통해, 단일 심전도 모델은 단일 심전도로부터 다음에 심방세동이 발생할 확률을 예측할 수 있다. 단일 심전도 모델은 기간별(예를 들면, 3개월, 6개월 12개월 등) 심방세동 발생 확률을 예측하도록 훈련될 수 있고, 필요에 따라 복수의 서브 모델들로 구성될 수 있다. 훈련 데이터는 훈련 셋(Training Set), 검증 셋(Validation Set), 테스트 셋(Test Set)으로 나누어 사용될 수 있다. 이때, 훈련 셋, 검증 셋, 테스트 셋에 같은 환자가 섞이지 않도록 분류될 수 있다. 한편, AF 심전도 이전에 NSR 심전도를 가진 환자 수가 부족해서, 실제로 레이블 1의 훈련 데이터가 레이블 0의 훈련 데이터에 비해 상당히 적을 수밖에 없다. 인공지능 모델의 성능을 높이기 위해서는 이러한 데이터 불균형 문제가 해결되어야 한다. 대체로 데이터 불균형 문제는 데이터 증강을 통해 해결하는데, AF 환자의 NSR 심전도 를 합성해서 생성하더라도 심방세동을 일으키는 미묘한 심전도 변화를 반영하는 것이 어렵다. 따라서, 증강 데 이터로 훈련된 인공지능 모델이 심방세동 발생 가능성을 정확히 예측하기 어려운 한계가 있다. 따라서, 인공지 능 모델의 학습률(Learning Rate)을 0.01 이하로 설정하고, 클래스 가중치(class_weight)를 ‘balanced’로 설 정함으로써, 데이터 불균형 문제를 해소할 수 있다. 한편, 인공지능 모델을 통해 블랭킹 기간(blanking period)과 최적의 추적 관찰 기간(follow up period) 을 알아낼 수 있다. 블랭킹 기간은 심방 리모델링이 발생하는 동안 인공지능 모델이 심방의 미묘한 변화를 구별 할 수 있는 최소 기간으로 정의될 수 있다. 단일 심전도 모델의 경우, AF 심전도에서 일정 기간(1개월, 2개월, 3개월 등)의 NSR 심전도를 제외한 데이 터로 인공지능 모델을 훈련시키고, 인공지능 모델의 성능을 비교함으로써, 최적의 블랭킹 기간을 결정할 수 있 다. 실험 결과, 단일 심전도 모델의 AUROC는 블랭킹 기간 1개월에 대해 0.912, 2개월에 대해 0.927, 3개월 에 대해 0.917라서, 새로운 심장세동 발병을 예측하기 위한 모델 성능은 2개월의 블랭킹 기간에서 최고의 예측 도를 보인다. 이를 통해, 블랭킹 기간을 2개월로 정의할 수 있고, 심방세동 발병 2개월 전에 심방 리모델링에 의한 미묘한 변화를 감지할 가능성이 높다. 연속 심전도 모델의 경우, 하나의 NSR 심전도는 정의된 블랭킹 기간에 포함되도록 선택하고, 다른 NSR 심 전도는 블랭킹 기간 이전의 심전도를 선택해서 인공지능 모델을 훈련시키고, 인공지능 모델의 성능을 비교할 수 있다. 실험 결과, 연속 심전도 모델의 AUROC는 1개월 이내 추적 관찰에 대해 0.917, 1개월 추적 관찰에 대 해 0.936, 3개월 추적 관찰에 대해 0.944, 12개월 추적 관찰에 대해 0.935라서, 새로운 심장세동 발병을 예측하 기 위한 모델 성능은 3개월 추적 관찰 기간에 최고의 예측도를 보인다. 이를 통해, 심전도 간 최적의 추적 관찰 기간은 심방 리모델링을 반영하기 위해 3개월 이상으로 정의될 수 있다. 도 8은 한 실시예에 따른 심방세동 예측 장치의 동작 방법을 나타내는 흐름도이다. 도 8을 참고하면, 심방세동 예측 장치는 일정 기간을 두고 측정된 개인의 심전도 쌍을 획득한다(S110). 예 를 들면, 심전도 쌍 중 어느 하나는 이번 방문에서 측정된 심전도이고, 다른 하나는 이전 방문에서 측정된 심전 도일 수 있다. 심방세동 예측 장치는 이전 방문들이 복수인 경우, 이번 방문(기준 시점)으로부터 지정된 기 간(예를 들면, 3개월) 전에 측정된 심전도를 심방세동 예측에 사용할 수 있다. 심방세동 예측 장치는 이전 방문에서 측정한 심전도가 존재하더라도, 이번 방문(기준 시점)으로부터 지정된 기간(예를 들면, 1년) 전에 측 정된 심전도라면, 이를 심전도 쌍의 하나로 사용하지 않을 수 있다. 심방세동 예측 장치는 심전도 차이로부터 심방세동 발생 가능성을 예측하도록 훈련된 인공지능 모델을 사용 하여, 심전도 쌍의 심전도 차이에 대한 심방세동 발생 확률을 예측한다(S120). 인공지능 모델은 연속 심전도 모 델일 수 있다. 심방세동 예측 장치는 심전도 쌍에 포함된 각 심전도를 지정된 절차에 따라 노이즈 제 거나 이상치 제거를 하고, 심전도 신호들로부터 심전도 특징들을 추출해서, 인공지능 모델의 입력 데이터를 생 성할 수 있다. 연속 심전도 모델은 수치적으로 표현되는 심전도 쌍의 특징 차이를 입력 데이터로 사용할 수 있다. 심전도 특징은 적어도 일부의 P-QRS-T 파형 특징들로 구성될 수 있고, 적어도 일부의 P-QRS-T 파형 특 징들은 P, Q, R, S, T 각각의 피크 통계, P, Q, R, S, T 각각의 간격 통계, PR 간격 통계, QRS 구간 통계를 포 함할 수 있다. 또한, 심전도 특징은 나머지 P-QRS-T 파형 특징들, 심전도 비트 유사도, 세동 파 에너지, P파 특 징 중 적어도 일부를 더 포함할 수 있다. 한편, 연속 심전도 모델의 입력 데이터는 심전도 쌍의 특징값 차 이와 함께, 개인 정보(성별, 연령)를 더 포함할 수 있다. 심방세동 예측 장치는 심방세동 발생 확률을 포함하는 심방세동 예측을 지정된 장치에게 제공한다(S130). 심방세동 발생 확률은 적어도 하나의 기간에 대해 예측될 수 있다. 심방세동 발생 확률은 심장세동 발생 가능성 을 표현하는 한 방법으로서, 점수, 위험도(상, 중, 하) 등으로도 표현될 수 있다. 심방세동 예측은 예측값에 대 한 성능 지표(예를 들면, 민감도, 특이도, 정확도 등)를 더 포함할 수 있다. 심방세동 발생 확률은 적어도 하나 의 기간에 대해 예측될 수 있다. 심방세동 예측 장치는 심방세동 예측에 관계된 의사결정 보조 정보를 더 제공할 수 있다. 의사결정 보조 정보는 심방세동 예측에 따라 추천된 후속 임상 절차를 포함할 수 있다. 지정된 장치는 예를 들면, 의료인이 이용하는 단말일 수 있는데, 이에 한정될 필요는 없다. 도 9는 다른 실시예에 따른 심방세동 예측 장치의 동작 방법을 나타내는 흐름도이다. 도 9를 참고하면, 심방세동 예측 장치는 심전도를 측정한 환자가 과거에도 심전도를 측정한 재진 환자인지 초진 환자인지를 식별한다(S210). 심방세동 예측 장치는 의료 DB참고하여, 이전 방문에서 측정된 유효 심전도를 가진 환자를 재진 환자로 결정할 수 있다. 유효 심전도는 심전도 측정 시기에 따라 결정될 수 있다. 심방세동 예측 장치는 재진 환자라면 심전도 차이로부터 심방세동 발생 가능성을 예측하도록 훈련된 연속 심전도 모델을 사용해서, 과거와 현재의 심전도 차이에 대해 예측된 심방세동 발생 확률을 획득한다 (S220). 심방세동 예측 장치는 초진 환자라면 단일 심전도로부터 심방세동 발생 가능성을 예측하도록 훈련된 단일 심전도 모델을 사용해서, 현재 심전도에 대해 예측된 심방세동 발생 확률을 획득한다(S230). 심방세동 예측 장치는 환자의 심방세동 발생 확률을 포함하는 심방세동 예측과 의사결정 보조 정보를 지정 된 장치에게 제공한다(S240). 심방세동 예측 장치는 심방세동 발생 확률과 식별된 환자 타입에 따라 의사결 정 보조 정보를 결정할 수 있다. 예를 들면, 심방세동 예측 장치는 심방세동 발생 확률에 따라 추천된 후속 임상 절차(예를 들면, 적극적인 심전도 모니터링 검사, 추가 검사 없이 추적관찰 종료, 일정 기간 이후에 심전 도 검사 재시행 등)를 의사결정 보조 정보로 제공할 수 있다. 심방세동 발생 확률에 따라 추천되는 후속 임상 절차는 임상 프로토콜에 따라 미리 정해져 있다고 가정한다. 심방세동 예측 장치는 심방세동 발생 확률이 기준보다 높은 경우, 적극적인 심전도 모니터링 검사를 추천할 수 있다. 심방세동 예측 장치는 초진 환자이 고 심방세동 발생 확률이 기준 이하인 경우, 3개월 후 2차 심전도 검사를 추천할 수 있다. 심방세동 예측 장치 는 초진 후 3개월만에 심전도 검사를 받은 재진 환자이고 심방세동 발생 확률이 기준 이하인 경우, 6개월마 다의 심전도 검사를 추천할 수 있다. 지정된 장치는 예를 들면, 의료인이 이용하는 단말일 수 있는데, 이에 한정될 필요는 없다. 도 10은 한 실시예에 따른 심방세동 예측 장치의 하드웨어 구성도이다. 도 10을 참고하면, 심방세동 예측 장치는 적어도 하나의 프로세서에 의해 동작하는 컴퓨팅 장치로 구현될 수 있다. 심방세동 예측 장치는 하나 이상의 프로세서, 프로세서에 의하여 수행되는 컴퓨터 프로그 램을 로드하는 메모리, 컴퓨터 프로그램 및 각종 데이터를 저장하는 저장 장치, 통신 인터페이스,그리고 이들을 연결하는 버스를 포함할 수 있다. 이외에도, 심방세동 예측 장치는 다양한 구성 요소가 더 포함될 수 있다. 프로세서는 심방세동 예측 장치의 동작을 제어하는 장치로서, 컴퓨터 프로그램에 포함된 명령어들을 처 리하는 다양한 형태의 프로세서일 수 있고, 예를 들면, CPU(Central Processing Unit), MPU(Micro Processor Unit), MCU(Micro Controller Unit), GPU(Graphic Processing Unit) 또는 본 개시의 기술 분야에 잘 알려진 임 의의 형태의 프로세서 중 적어도 하나를 포함하여 구성될 수 있다. 메모리는 각종 데이터, 명령 및/또는 정보를 저장한다. 메모리는 본 개시의 동작을 실행하도록 기술된 명령어들이 프로세서에 의해 처리되도록 해당 컴퓨터 프로그램을 저장 장치로부터 로드할 수 있다. 메 모리는 예를 들면, ROM(read only memory), RAM(random access memory) 등 일 수 있다. 저장 장치는 컴퓨터 프로그램, 각종 데이터를 비임시적으로 저장할 수 있다. 저장 장치는 ROM(Read Only Memory), EPROM(Erasable Programmable ROM), EEPROM(Electrically Erasable Programmable ROM), 플래시 메모리 등과 같은 비휘발성 메모리, 하드 디스크, 착탈형 디스크, 또는 본 개시가 속하는 기술 분야에서 잘 알 려진 임의의 형태의 컴퓨터로 읽을 수 있는 기록 매체를 포함하여 구성될 수 있다. 통신 인터페이스는 유/무선 통신을 지원하는 유/무선 통신 모듈일 수 있다. 버스는 심방세동 예측 장치의 구성 요소 간 통신 기능을 제공한다. 컴퓨터 프로그램은, 프로세서에 의해 실행되는 명령어들(instructions)을 포함하고, 비일시적-컴퓨터 판독 가능 저장매체(non-transitory computer readable storage medium)에 저장되며, 명령어들은 프로세서가 본 개시의 동작을 실행하도록 만든다. 컴퓨터 프로그램은 네트워크를 통해 다운로드되거나, 제품 형태로 판매될 수 있다. 인공지능 모델은 프로세서에 의해 실행되는 컴퓨터 프로그램으로 구현될 수 있다. 컴퓨터 프로그램은, 프로세서에 의해 실행됨으로써, 심방세동 예측 장치가 일정 기간을 두고 측정된 개 인의 심전도 쌍을 획득하고, 심전도 차이로부터 심방세동 발생 가능성을 예측하도록 훈련된 인공지능 모델을 사 용하여, 심전도 쌍의 심전도 차이에 대해 예측된 심방세동 발생 확률을 획득한 후, 심방세동 발생 확률을 포함 하는 심방세동 예측을 지정된 장치에게 제공하도록 만드는 명령어들을 포함할 수 있다. 또한, 컴퓨터 프로그램 은 프로세서에 의해 실행됨으로써, 심방세동 예측 장치가 환자가 과거에도 심전도를 측정한 재진 환자 인지 초진 환자인지를 식별하고, 재진 환자라면 연속 심전도 모델을 사용해서 심방세동 발생 확률을 획득 하고, 초진 환자라면 단일 심전도 모델을 사용해서 심방세동 발생 확률을 획득한 후, 심방세동 발생 확률 을 포함하는 심방세동 예측과 의사결정 보조 정보를 지정된 장치에게 제공하도록 만드는 명령어들을 포함할 수 있다. 이와 같이, 본 개시에 따르면, 개인의 특성을 고려한 진화된 인공지능 모델을 통해 미래에 심방세동이 발생할 환자들을 정확히 선별할 수 있다. 본 개시에 따르면, 심방세동 발생 확률이 높은 환자에게 적극적인 심전도 모니터링 검사나 선제적 항응고 치료 와 같은 의료인의 의사결정을 지원할 수 있고, 이를 통해 심방세동 진단률을 높일 수 있다. 본 개시에 따르면, 심방세동 발생 가능성에 따라 적절한 후속 임상 절차를 추천할 수 있고, 심방세동 예측의 정 확도를 고려하여 최적의 추적 관찰 기간(예를 들면, 3개월)을 결정할 수 있다. 이상에서 설명한 본 개시의 실시예는 장치 및 방법을 통해서만 구현이 되는 것은 아니며, 본 개시의 실시예의 구성에 대응하는 기능을 실현하는 프로그램 또는 그 프로그램이 기록된 기록 매체를 통해 구현될 수도 있다. 이상에서 본 개시의 실시예에 대하여 상세하게 설명하였지만 본 개시의 권리범위는 이에 한정되는 것은 아니고 다음의 청구범위에서 정의하고 있는 본 개시의 기본 개념을 이용한 당업자의 여러 변형 및 개량 형태 또한 본 개시의 권리범위에 속하는 것이다.도면 도면1 도면2 도면3 도면4 도면5 도면6 도면7 도면8 도면9 도면10"}
{"patent_id": "10-2023-0069397", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 한 실시예에 따른 인공지능 기반 심방세동 예측 장치를 설명하는 도면이다. 도 2는 심전도 신호의 예시이다. 도 3은 P-QRS-T 분석의 예시이다. 도 4는 한 실시예에 따른 심전도 비트 유사도 계산 방법을 설명하는 도면이다. 도 5는 한 실시예에 따른 인공지능 모델의 훈련을 설명하는 도면이다. 도 6은 한 실시예에 따른 연속 심전도 모델의 훈련 데이터 생성 방법을 설명하는 도면이다. 도 7은 한 실시예에 따른 단일 심전도 모델의 훈련 데이터 생성 방법을 설명하는 도면이다. 도 8은 한 실시예에 따른 심방세동 예측 장치의 동작 방법을 나타내는 흐름도이다. 도 9는 다른 실시예에 따른 심방세동 예측 장치의 동작 방법을 나타내는 흐름도이다. 도 10은 한 실시예에 따른 심방세동 예측 장치의 하드웨어 구성도이다."}
