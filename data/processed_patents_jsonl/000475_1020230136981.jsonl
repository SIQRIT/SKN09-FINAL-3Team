{"patent_id": "10-2023-0136981", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2024-0119812", "출원번호": "10-2023-0136981", "발명의 명칭": "인공지능 모델을 이용하여 조직학 이미지로부터 패치 단위의 유전자 발현을 예측하는 방법 및", "출원인": "성균관대학교산학협력단", "발명자": "정영민"}}
{"patent_id": "10-2023-0136981", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "전자 장치가 인공지능 모델을 이용하여 조직학 이미지(histology image)로부터 유전자 발현(gene expression)을예측하는 방법에 있어서,복수의 패치로 분할된 상기 조직학 이미지의 제1 패치, 상기 제1 패치의 초기 피쳐 데이터 및 상기 조직학 이미지의 제2 패치의 초기 피쳐 데이터를 식별하는 단계;제1 인공지능 모델을 이용하여, 상기 제1 패치의 초기 피쳐 데이터 및 상기 제2 패치의 초기 피쳐 데이터를 기반으로, 상기 제1 패치의 글로벌 피쳐 데이터를 추출하는 단계;제2 인공지능 모델을 이용하여, 상기 제1 패치로부터 상기 제1 패치의 로컬 피쳐 데이터를 추출하는 단계; 및제3 인공지능 모델을 이용하여, 상기 제1 패치의 글로벌 피쳐 데이터와 상기 제1 패치의 로컬 피쳐 데이터를 기반으로, 상기 제1 패치에 대한 유전자 발현 값을 예측하는 단계를 포함하는, 방법."}
{"patent_id": "10-2023-0136981", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 복수의 패치로 분할된 상기 조직학 이미지의 제1 패치, 상기 제1 패치의 초기 피쳐 데이터 및 상기 조직학이미지의 제2 패치의 초기 피쳐 데이터를 식별하는 단계는,기 학습된 인공지능 모델을 이용하여 상기 제1 패치로부터 상기 제1 패치의 초기 피쳐 데이터를 추출하고, 상기제2 패치로부터 상기 제2 패치의 초기 피쳐 데이터를 추출하는 단계를 포함하는, 방법."}
{"patent_id": "10-2023-0136981", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1항에 있어서,상기 제1 패치에 대한 유전자 발현 값을 예측하는 단계는,상기 제1 패치의 글로벌 피쳐 데이터와 상기 제1 패치의 로컬 피쳐 데이터를 연결함으로써, 상기 제1 패치의 로컬-글로벌 피쳐 데이터를 생성하는 단계; 및상기 제3 인공지능 모델을 이용하여, 상기 제1 패치의 로컬-글로벌 피쳐 데이터를 기반으로 상기 제1 패치에 대한 유전자 발현 값을 예측하는 단계를 포함하는, 방법."}
{"patent_id": "10-2023-0136981", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제1항에 있어서, 상기 제2 인공지능 모델을 이용하여, 상기 제1 패치로부터 상기 제1 패치의 로컬 피쳐 데이터를 추출하는 단계는,상기 제2 인공지능 모델을 이용하여, 상기 제1 패치로부터 상기 제1 패치의 제1 로컬 피쳐 데이터 및 제2 로컬피쳐 데이터를 추출하는 단계를 포함하고,상기 제1 패치에 대한 유전자 발현 값을 예측하는 단계는, 상기 제1 패치의 제1 로컬 피쳐 데이터와 상기 제1 패치의 글로벌 피쳐 데이터를 연결한 제1 로컬-글로벌 피쳐데이터 및 상기 제1 패치의 제2 로컬 피쳐 데이터와 상기 제1 패치의 글로벌 피쳐 데이터를 연결한 제2 로컬-글공개특허 10-2024-0119812-3-로벌 피쳐 데이터를 생성하는 단계;상기 제3 인공지능 모델을 이용하여, 상기 제1 로컬-글로벌 피쳐 데이터를 기초로 상기 제1 패치에 대한 제1 유전자 발현 값을 예측하고, 상기 제2 로컬-글로벌 피쳐 데이터를 기초로 상기 제1 패치에 대한 제2 유전자 발현값을 예측하는 단계; 및상기 제1 유전자 발현 값 및 상기 제2 유전자 발현 값 중 적어도 하나를 기초로, 상기 제1 패치에 대한 최종 유전자 발현 값을 결정하는 단계를 포함하는, 방법."}
{"patent_id": "10-2023-0136981", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제4항에 있어서,상기 제2 인공지능 모델은, 순차적으로 연결된 복수의 레이어를 포함하고, 상기 제1 로컬 피쳐 데이터는, 상기 복수의 레이어 중 심층 레이어의 출력 데이터이고,상기 제2 로컬 피쳐 데이터는, 상기 복수의 레이어 중 상기 심층 레이어가 아닌 다른 레이어의 출력 데이터를기초로 생성된 데이터인, 방법."}
{"patent_id": "10-2023-0136981", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제1항에 있어서,상기 제1 인공지능 모델은, 상기 조직학 이미지에서의 패치 위치 정보를 인코딩하는 위치 정보 인코더를 포함하고,상기 제1 인공지능 모델을 이용하여, 상기 제1 패치의 초기 피쳐 데이터 및 상기 제2 패치의 초기 피쳐 데이터를 기반으로, 상기 제1 패치의 글로벌 피쳐 데이터를 추출하는 단계는,상기 위치 정보 인코더를 이용하여, 상기 제1 패치의 위치 정보가 인코딩된 상기 제1 패치의 글로벌 피쳐 데이터를 추출하는 단계를 포함하는, 방법."}
{"patent_id": "10-2023-0136981", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제6항에 있어서,상기 위치 정보 인코더를 이용하여, 상기 제1 패치의 위치 정보가 인코딩된 상기 제1 패치의 글로벌 피쳐 데이터를 추출하는 단계는,상기 제1 패치의 초기 피쳐 데이터 및 상기 제2 패치의 초기 피쳐 데이터를 기초로, 셀프 어텐션 연산을 수행하는 단계;상기 제1 패치의 위치 정보 및 상기 제2 패치의 위치 정보를 기초로, 상기 셀프 어텐션 연산의 결과 데이터에대하여 컨볼루션 연산을 수행하는 단계;상기 제1 패치의 위치 정보 및 상기 제2 패치의 위치 정보를 기초로, 상기 셀프 어텐션 연산의 결과 데이터에대하여 변형 가능한 컨볼루션 연산을 수행하는 단계; 및상기 컨볼루션 연산의 결과 데이터 및 상기 변형 가능한 컨볼루션 연산의 결과 데이터를 기초로, 상기 제1 패치의 위치 정보가 인코딩된 상기 제1 패치의 글로벌 피쳐 데이터를 추출하는 단계를 포함하는, 방법."}
{"patent_id": "10-2023-0136981", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제1항에 있어서,상기 제1 인공지능 모델, 상기 제2 인공지능 모델 및 상기 제3 인공지능 모델은, 엔드 투 엔드(end-to-end)로공개특허 10-2024-0119812-4-연결되어 동시에 학습되는, 방법."}
{"patent_id": "10-2023-0136981", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제1항에 있어서,상기 제1 인공지능 모델, 상기 제2 인공지능 모델 및 상기 제3 인공지능 모델은, 학습 이미지에 포함된 타겟 패치에 대하여 예측되는 유전자 발현 값과 상기 타겟 패치에 대한 정답 유전자 발현 값 사이의 차이를 기반으로하는 손실 함수를 이용하여 학습되는, 방법."}
{"patent_id": "10-2023-0136981", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제1항에 있어서,상기 제1 인공지능 모델, 상기 제2 인공지능 모델 및 상기 제3 인공지능 모델은, 학습 이미지에 포함된 타겟 패치에 대한 제1 로컬-글로벌 피쳐 데이터와 상기 타겟 패치에 대한 제2 로컬-글로벌 피쳐 데이터 사이의 차이를기반으로 하는 손실 함수를 이용하여 학습되고,상기 타겟 패치에 대한 제1 로컬-글로벌 피쳐 데이터는, 상기 타겟 패치에 대한 상기 제2 인공지능 모델의 심층레이어의 출력 데이터인 상기 타겟 패치의 제1 로컬 피쳐 데이터와 상기 타겟 패치의 글로벌 피쳐 데이터를 연결함으로써 생성되고,상기 타겟 패치에 대한 제2 로컬-글로벌 피쳐 데이터는, 상기 타겟 패치에 대한 상기 제2 인공지능 모델의 상기심층 레이어가 아닌 다른 레이어의 출력 데이터를 기반으로 하는 상기 타겟 패치의 제2 로컬 피쳐 데이터와 상기 타겟 패치의 글로벌 피쳐 데이터를 연결함으로써 생성되는, 방법."}
{"patent_id": "10-2023-0136981", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "제1항에 있어서,상기 제1 인공지능 모델, 상기 제2 인공지능 모델 및 상기 제3 인공지능 모델은, 학습 이미지에 포함된 타겟 패치에 대한 제1 유전자 발현 값 및 상기 타겟 패치에 대한 제2 유전자 발현 값 사이의 차이를 기반으로 하는 손실 함수를 이용하여 학습되고,상기 타겟 패치에 대한 제1 유전자 발현 값은, 상기 타겟 패치에 대한 상기 제2 인공지능 모델의 심층 레이어의출력 데이터를 기초로 예측되고,상기 타겟 패치에 대한 제2 유전자 발현 값은, 상기 타겟 패치에 대한 상기 제2 인공지능 모델의 상기 심층 레이어가 아닌 다른 레이어의 출력 데이터를 기초로 예측되는, 방법."}
{"patent_id": "10-2023-0136981", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제1항 내지 제11항 중 어느 한 항의 방법을 컴퓨터에서 수행하기 위한 프로그램이 기록된 컴퓨터로 읽을 수 있는 기록매체."}
{"patent_id": "10-2023-0136981", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "인공지능 모델을 이용하여 조직학 이미지(histology image)로부터 유전자 발현(gene expression)을 예측하는 하는 전자 장치에 있어서,하나 이상의 명령어를 저장하는 메모리; 및상기 메모리에 저장된 상기 하나 이상의 명령어를 실행하는 적어도 하나의 프로세서를 포함하고,공개특허 10-2024-0119812-5-상기 적어도 하나의 프로세서는 상기 하나 이상의 명령어(instruction)를 실행함으로써,복수의 패치로 분할된 상기 조직학 이미지의 제1 패치, 상기 제1 패치의 초기 피쳐 데이터 및 상기 조직학 이미지의 제2 패치의 초기 피쳐 데이터를 식별하고,제1 인공지능 모델을 이용하여, 상기 제1 패치의 초기 피쳐 데이터 및 상기 제2 패치의 초기 피쳐 데이터를 기반으로, 상기 제1 패치의 글로벌 피쳐 데이터를 추출하고,제2 인공지능 모델을 이용하여, 상기 제1 패치로부터 상기 제1 패치의 로컬 피쳐 데이터를 추출하고,제3 인공지능 모델을 이용하여, 상기 제1 패치의 글로벌 피쳐 데이터와 상기 제1 패치의 로컬 피쳐 데이터를 기반으로, 상기 제1 패치에 대한 유전자 발현 값을 예측하는, 전자 장치."}
{"patent_id": "10-2023-0136981", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_14", "content": "제13항에 있어서,상기 적어도 하나의 프로세서는,기 학습된 인공지능 모델을 이용하여 상기 제1 패치로부터 상기 제1 패치의 초기 피쳐 데이터를 추출하고, 상기제2 패치로부터 상기 제2 패치의 초기 피쳐 데이터를 추출하는, 전자 장치."}
{"patent_id": "10-2023-0136981", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_15", "content": "제13항에 있어서,상기 적어도 하나의 프로세서는,상기 제1 패치의 글로벌 피쳐 데이터와 상기 제1 패치의 로컬 피쳐 데이터를 연결함으로써, 상기 제1 패치의 로컬-글로벌 피쳐 데이터를 생성하고,상기 제3 인공지능 모델을 이용하여, 상기 제1 패치의 로컬-글로벌 피쳐 데이터를 기반으로 상기 제1 패치에 대한 유전자 발현 값을 예측하는, 전자 장치."}
{"patent_id": "10-2023-0136981", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_16", "content": "제13항에 있어서,상기 적어도 하나의 프로세서는,상기 제2 인공지능 모델을 이용하여, 상기 제1 패치로부터 상기 제1 패치의 제1 로컬 피쳐 데이터 및 제2 로컬피쳐 데이터를 추출하고,상기 제1 패치의 제1 로컬 피쳐 데이터와 상기 제1 패치의 글로벌 피쳐 데이터를 연결한 제1 로컬-글로벌 피쳐데이터 및 상기 제1 패치의 제2 로컬 피쳐 데이터와 상기 제1 패치의 글로벌 피쳐 데이터를 연결한 제2 로컬-글로벌 피쳐 데이터를 생성하고,상기 제3 인공지능 모델을 이용하여, 상기 제1 로컬-글로벌 피쳐 데이터를 기초로 상기 제1 패치에 대한 제1 유전자 발현 값을 예측하고, 상기 제2 로컬-글로벌 피쳐 데이터를 기초로 상기 제1 패치에 대한 제2 유전자 발현값을 예측하고,상기 제1 유전자 발현 값 및 상기 제2 유전자 발현 값 중 적어도 하나를 기초로, 상기 제1 패치에 대한 최종 유전자 발현 값을 결정하는, 전자 장치."}
{"patent_id": "10-2023-0136981", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_17", "content": "공개특허 10-2024-0119812-6-제16항에 있어서,상기 제2 인공지능 모델은, 순차적으로 연결된 복수의 레이어를 포함하고,상기 제1 로컬 피쳐 데이터는, 상기 복수의 레이어 중 심층 레이어의 출력 데이터이고,상기 제2 로컬 피쳐 데이터는, 상기 복수의 레이어 중 상기 심층 레이어가 아닌 다른 레이어의 출력 데이터를기초로 생성된 데이터인, 전자 장치."}
{"patent_id": "10-2023-0136981", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_18", "content": "제13항에 있어서,상기 제1 인공지능 모델은, 상기 조직학 이미지에서의 패치 위치 정보를 인코딩하는 위치 정보 인코더를 포함하고,상기 적어도 하나의 프로세서는,상기 위치 정보 인코더를 이용하여, 상기 제1 패치의 위치 정보가 인코딩된 상기 제1 패치의 글로벌 피쳐 데이터를 추출하는, 전자 장치."}
{"patent_id": "10-2023-0136981", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_19", "content": "제18항에 있어서,상기 적어도 하나의 프로세서는,상기 제1 패치의 초기 피쳐 데이터 및 상기 제2 패치의 초기 피쳐 데이터를 기초로, 셀프 어텐션 연산을 수행하고,상기 제1 패치의 위치 정보 및 상기 제2 패치의 위치 정보를 기초로, 상기 셀프 어텐션 연산의 결과 데이터에대하여 컨볼루션 연산을 수행하고,상기 제1 패치의 위치 정보 및 상기 제2 패치의 위치 정보를 기초로, 상기 셀프 어텐션 연산의 결과 데이터에대하여 변형 가능한 컨볼루션 연산을 수행하고,상기 컨볼루션 연산의 결과 데이터 및 상기 변형 가능한 컨볼루션 연산의 결과 데이터를 기초로, 상기 제1 패치의 위치 정보가 인코딩된 상기 제1 패치의 글로벌 피쳐 데이터를 추출하는, 전자 장치."}
{"patent_id": "10-2023-0136981", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_20", "content": "제13항에 있어서,상기 제1 인공지능 모델, 상기 제2 인공지능 모델 및 상기 제3 인공지능 모델은, 학습 이미지에 포함된 타겟 패치에 대한 제1 유전자 발현 값 및 상기 타겟 패치에 대한 제2 유전자 발현 값 사이의 차이를 기반으로 하는 손실 함수를 이용하여 학습되고,상기 타겟 패치에 대한 제1 유전자 발현 값은, 상기 타겟 패치에 대한 상기 제2 인공지능 모델의 심층 레이어의출력 데이터를 기초로 예측되고,상기 타겟 패치에 대한 제2 유전자 발현 값은, 상기 타겟 패치에 대한 상기 제2 인공지능 모델의 상기 심층 레이어가 아닌 다른 레이어의 출력 데이터를 기초로 예측되는, 전자 장치."}
{"patent_id": "10-2023-0136981", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "전자 장치가 인공지능 모델을 이용하여 조직학 이미지(histology image)로부터 유전자 발현(gene expression)을 예측하는 방법은 복수의 패치로 분할된 상기 조직학 이미지의 제1 패치, 상기 제1 패치의 초기 피쳐 데이터 및 상기 조직학 이미지의 제2 패치의 초기 피쳐 데이터를 식별하는 단계, 제1 인공지능 모델을 이용하여, 상기 제1 패치의 초기 피쳐 데이터 및 상기 제2 패치의 초기 피쳐 데이터를 기반으로, 상기 제1 패치의 글로벌 피쳐 데이 터를 추출하는 단계, 제2 인공지능 모델을 이용하여, 상기 제1 패치로부터 상기 제1 패치의 로컬 피쳐 데이터를 추출하는 단계 및 제3 인공지능 모델을 이용하여, 상기 제1 패치의 글로벌 피쳐 데이터와 상기 제1 패치의 로컬 피쳐 데이터를 기반으로, 상기 제1 패치에 대한 유전자 발현 값을 예측하는 단계를 포함할 수 있다."}
{"patent_id": "10-2023-0136981", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 개시는 인공지능 모델을 이용하여 조직학 이미지로부터 패치 단위의 유전자 발현을 예측하는 방법 및 전자 장치에 관한 것이다. 본 연구는 삼성미래기술육성사업의 지원을 받아 수행되었음(과제번호: SRFC-MA2102-05)."}
{"patent_id": "10-2023-0136981", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "배아, 뇌 또는 종양과 같은 많은 기관계들(biological systems)의 기능은 조직 내 세포들의 공간적 구조 및 기 관계들의 유전자들의 공간적으로 연관된 조절(spatially coordinated regulation)에 의존할 수 있다. 특히, 암 세포에서는 건강한 세포와는 현저히 다르게 유전자 발현의 조정(coordination of gene expression)이 나타날 수 있다. 따라서, 암 환자에 대한 정확한 진단 및 치료를 위해 암 세포의 독특한 공간적 구조를 깊이 이해하는 것 이 필요할 수 있다. 최근 대규모 공간 전사체(spatial transcriptome, ST)를 시퀀싱하는 기술이 발전함에 따라, 조직학 이미지에서 기 정의된 그리드(grid)를 따라 조직들과 세포들의 공간적 콘텍스트 내에서 다수의 유전자의 mRNA 발현을 정량 화하는 것이 가능하게 되었다. 그러나, 발전된 ST 시퀀싱 기술은 높은 비용을 필요로 할 수 있다."}
{"patent_id": "10-2023-0136981", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 개시는 방법, 시스템, 장치 또는 컴퓨터 판독가능 저장매체에 저장된 컴퓨터 프로그램을 포함한 다양한 방식 으로 구현될 수 있다. 본 개시의 일 실시예에 따른 전자 장치가 인공지능 모델을 이용하여 조직학 이미지(histology image)로부터 패 치 단위의 유전자 발현(gene expression)을 예측하는 방법은, 복수의 패치로 분할된 상기 조직학 이미지의 제1 패치, 상기 제1 패치의 초기 피쳐 데이터 및 상기 조직학 이미지의 제2 패치의 초기 피쳐 데이터를 식별하는 단 계를 포함할 수 있다. 일 실시예에서, 상기 방법은, 제1 인공지능 모델을 이용하여, 상기 제1 패치의 초기 피쳐 데이터 및 상기 제2 패치의 초기 피쳐 데이터를 기반으로, 상기 제1 패치의 글로벌 피쳐 데이터를 추출하는 단 계를 포함할 수 있다. 일 실시예에서, 상기 방법은, 제2 인공지능 모델을 이용하여, 상기 제1 패치로부터 상기 제1 패치의 로컬 피쳐 데이터를 추출하는 단계를 포함할 수 있다. 일 실시예에서, 상기 방법은, 제3 인공지능 모델을 이용하여, 상기 제1 패치의 글로벌 피쳐 데이터와 상기 제1 패치의 로컬 피쳐 데이터를 기반으로, 상기 제1 패치에 대한 유전자 발현 값을 예측하는 단계를 포함할 수 있다. 본 개시의 일 실시예에 따른 인공지능 모델을 이용하여 조직학 이미지로부터 패치 단위의 유전자 발현을 예측하 는 방법을 컴퓨터에서 수행하기 위한 프로그램은 컴퓨터로 읽을 수 있는 기록 매체에 기록될 수 있다. 본 개시의 일 실시예에 따른 인공지능 모델을 이용하여 조직학 이미지로부터 패치 단위의 유전자 발현을 예측하 는 전자 장치는, 하나 이상의 명령어를 저장하는 메모리; 및 상기 메모리에 저장된 상기 하나 이상의 명령어를 실행하는 적어도 하나의 프로세서를 포함할 수 있다. 일 실시예에서, 상기 적어도 하나의 프로세서는 상기 하나 이상의 명령어(instruction)를 실행함으로써, 복수의 패치로 분할된 상기 조직학 이미지의 제1 패치, 상기 제1 패치의 초기 피쳐 데이터 및 상기 조직학 이미지의 제2 패치의 초기 피쳐 데이터를 식별할 수 있다. 일 실시예 에서, 상기 적어도 하나의 프로세서는 제1 인공지능 모델을 이용하여, 상기 제1 패치의 초기 피쳐 데이터 및 상 기 제2 패치의 초기 피쳐 데이터를 기반으로, 상기 제1 패치의 글로벌 피쳐 데이터를 추출할 수 있다. 일 실시 예에서, 상기 적어도 하나의 프로세서는 제2 인공지능 모델을 이용하여, 상기 제1 패치로부터 상기 제1 패치의 로컬 피쳐 데이터를 추출할 수 있다. 일 실시예에서, 상기 적어도 하나의 프로세서는 제3 인공지능 모델을 이용 하여, 상기 제1 패치의 글로벌 피쳐 데이터와 상기 제1 패치의 로컬 피쳐 데이터를 기반으로, 상기 제1 패치에 대한 유전자 발현 값을 예측할 수 있다."}
{"patent_id": "10-2023-0136981", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "본 개시는 다양한 변경을 가할 수 있고 여러 가지 실시예를 가질 수 있는 바, 특정 실시예들을 도면에 예시하고, 이를 상세한 설명을 통해 설명하고자 한다. 그러나, 이는 본 개시를 특정한 실시 형태에 대해 한정하 려는 것이 아니며, 본 개시의 사상 및 기술 범위에 포함되는 모든 변경, 균등물 내지 대체물을 포함하는 것으로 이해되어야 한다. 실시예를 설명함에 있어서, 관련된 공지 기술에 대한 구체적인 설명이 요지를 불필요하게 흐릴 수 있다고 판단 되는 경우 그 상세한 설명을 생략한다. 또한, 실시예의 설명 과정에서 이용되는 숫자(예를 들어, 제1, 제2 등) 는 하나의 구성요소를 다른 구성요소와 구분하기 위한 식별 기호에 불과하다. 아래에서는 첨부한 도면을 참고하여 본 개시의 실시예에 대하여 본 개시가 속하는 기술 분야에서 통상의 지식을 가진 자가 용이하게 실시할 수 있도록 상세히 설명한다. 그러나 본 개시는 여러 가지 상이한 형태로 구현될 수 있으며 여기에서 설명하는 실시예에 한정되지 않는다. 발명에 대한 구체적인 설명에 앞서, 이하 본 명세서에서 사용되는 용어는 다음과 같이 정의되거나 이해될 수 있다. 본 명세서에서 일 구성요소가 다른 구성요소와 '연결된다' 거나 다른 구성요소에 '접속한다' 등으로 언급된 때 에는, 상기 일 구성요소가 상기 다른 구성요소와 직접 연결되거나 또는 다른 구성요소와 직접 접속할 수도 있지 만, 특별히 반대되는 기재가 존재하지 않는 이상, 중간에 또 다른 구성요소를 매개하여 연결되거나 또는 접속할 수도 있다고 이해되어야 할 것이다. 또한, '연결'은 무선 연결 또는 유선 연결을 의미할 수 있다. 또한, 본 명세서에서, '~부(유닛)', '모듈' 등으로 표현되는 구성요소는 2개 이상의 구성요소가 하나의 구성요 소로 합쳐지거나 또는 하나의 구성요소가 보다 세분화된 기능별로 2개 이상으로 분화될 수도 있다. 또한, 이하 에서 설명할 구성요소 각각은 자신이 담당하는 주기능 이외에도 다른 구성요소가 담당하는 기능 중 일부 또는 전부의 기능을 추가적으로 수행할 수도 있으며, 구성요소 각각이 담당하는 주기능 중 일부 기능이 다른 구성요 소에 의해 전담되어 수행될 수도 있음은 물론이다. 본 개시에서, '조직학 이미지(histology image)'란, 인체에서 떼어낸 조직 등을 관찰하기 위해 일련의 화학적 처리 과정을 거쳐 고정 및 염색(예: H&E 염색(hematoxylin and eosin stain))된 슬라이드를 슬라이드 스캐너, 현미경 및 카메라 등으로 촬영함으로써 생성된 디지털 이미지를 지칭할 수 있다. 예를 들어, '조직학 이미지'는 현미경을 이용하여 촬영된 디지털 이미지를 지칭할 수 있으며, 인체 내의 세포(cell), 조직(tissue) 및/또는 구 조(structure)에 대한 정보를 포함할 수 있다. 일 실시예에서, '조직학 이미지'는 전체 슬라이드에 대한 고 해 상도의 이미지를 포함하는 전체 슬라이드 이미지(whole slide image, WSI), 또는 병리 슬라이드를 촬영한 병리 슬라이드 이미지를 지칭할 수 있다. 일 실시예에서, '조직학 이미지'는 고 해상도의 전체 슬라이드 이미지의 일 부를 지칭할 수 있다. '조직학 이미지'는 하나 이상의 패치를 포함할 수 있다. 본 명세서에서, '패치(patch)', '패치 이미지(patch image)', '스팟(spot)' 및 '스팟 이미지(spot image)'는 조직학 이미지의 일부 영역을 의미하는 것으로 서로 혼용될 수 있다. 예를 들어, '패치', '패치 이미지', '스팟' 및 '스팟 이미지'는 조직학 이미지의 복수의 픽셀 중 적어도 일부의 픽셀로 구성될 수 있다. 일 실시예에서, 조직학 이미지는 사각형 형태의 복수의 패치로 분할될 수 있으나, 패치의 형태가 사각형으로 한정되는 것 은 아니다. 예를 들어, 조직학 이미지에 포함된 유효 영역(예: 조직 영역, 세포 영역 등)의 형태에 따라 패치의 형태가 달라질 수 있다. 일 실시예에서, 조직학 이미지는 복수의 패치가 서로 오버랩되지 않도록 분할될 수 있 으나, 이에 한정되지 않는다. 예를 들어, 조직학 이미지는 패치의 적어도 일부 영역이 다른 패치의 적어도 일부 영역과 오버랩되도록 분할될 수도 있다. 본 명세서에서, '유전자 발현'은 하나 이상의 유전자의 발현에 대한 정보를 의미할 수 있다. 예를 들어, 하나 이상의 유전자의 발현에 대한 정보는 하나 이상의 유전자의 발현 여부, 발현 정도, 발현 레벨, 발현 값(예: m- RNA expression value), 발현 패턴 등을 포함할 수 있다. 따라서, '유전자 발현을 예측하는 것'은 하나 이상의 예측 대상 유전자의 발현에 대한 정보를 예측하는 것을 의미할 수 있다. 예측 대상이 되는 하나 이상의 유전자 는 A2M, AKAP13, BOLA3, CDK6, C5orf38, DHX16, FAIM2, HSPB11, MED13L, MID1IP1, ZFP36L2 등의, 생물의 세포, 조직 등에서 발현되는 유전자일 수 있으나, 이에 한정되지 않는다. 일 실시예에서, 세포 및/또는 조직에 따라 예측 대상이 되는 유전자는 상이할 수 있다. 예를 들어, 생물의 제1 영역의 조직에서 유전자 발현이 예측 되는 유전자들과 생물의 제2 영역의 조직에서 유전자 발현이 예측되는 유전자들은 서로 동일하거나, 완전히 상 이하거나, 일부 상이할 수 있다. 본 명세서에서, '패치 단위의 유전자 발현'은 패치들 별 유전자 발현을 의미할 수 있다. 본 명세서에서, '패치 에 대한 유전자 발현', '패치의 유전자 발현' 및 '패치에 대한 유전자 발현 정보'는 조직학 이미지 중 특정 패 치의 위치에서의 유전자 발현을 의미할 수 있다. 예를 들어, '패치에 대한 유전자 발현', '패치 단위의 유전자 발현', 및 '패치에 대한 유전자 발현 정보'는 조직학 이미지 중 특정 패치의 위치에서의 하나 이상의 유전자의 발현 여부, 발현 정도, 발현 레벨, 발현 값 등을 포함할 수 있다. 본 명세서에서, '로컬(local) 정보'는 조직학 이미지에서 임의의 패치에 국한된 정보 및 데이터를 의미할 수 있 다. 일 실시예에서, 특정 패치의 '로컬 정보'는 특정 패치로부터 도출되는 피쳐 데이터를 포함할 수 있다. 일 실시예에서, '로컬 정보'는 의미를 인지할 수 있는 정보 및 데이터를 포함할 수 있다. 일 실시예에서, '로컬 정 보'는 직접적인 의미를 인지할 수 없는 정보 및 데이터를 포함할 수 있다. 예를 들어, 특정 패치의 '로컬 정 보'는 입력 데이터(예: 이미지 데이터)로부터 피쳐를 추출하는 인공지능 모델에 특정 패치(또는, 특정 패치에 대한 데이터)를 입력함으로써 출력되는 피쳐 데이터를 포함할 수 있다. 본 명세서에서, '글로벌 콘텍스트(global context)' 및 '글로벌 정보'는 조직학 이미지에서의 패치들의 전반적 이고 전역적인 정보 및 데이터를 의미할 수 있다. 즉, '글로벌 콘텍스트' 및 '글로벌 정보'는 상기 로컬 정보와 는 달리, 임의의 패치의 정보 및 데이터에 국한되지 않을 수 있다. 일 실시예에서, 특정 패치의 '글로벌 정보' 는 특정 패치 뿐만 아니라 다른 패치들을 함께 기초로 하여, 도출되는 피쳐 데이터를 포함할 수 있다. 예를 들 어, 특정 패치의 '글로벌 정보'는 특정 패치에 대한 데이터와 다른 패치들에 대한 데이터 사이의 상관 관계 및/ 또는 특정 패치의 조직학 이미지에서의 위치를 고려하여, 도출되는 피쳐 데이터를 포함할 수 있다. 일 실시예에 서, '글로벌 콘텍스트' 및 '글로벌 정보'는 의미를 인지할 수 있는 정보 및 데이터를 포함할 수 있다. 일 실시 예에서, '글로벌 콘텍스트' 및 '글로벌 정보'는 직접적인 의미를 인지할 수 없는 정보 및 데이터를 포함할 수 있다. 예를 들어, 특정 패치의 '글로벌 정보'(또는, '글로벌 콘텍스트')는 입력 데이터(예: 이미지 데이터, 벡 터 데이터, 피쳐맵 데이터)로부터 피쳐를 추출하는 인공지능 모델에 복수의 패치(또는, 복수의 패치에 대한 데 이터)를 입력함으로써 출력되는 피쳐 데이터를 포함할 수 있다. 본 명세서에서, 임의의 구성 요소, 임의의 모델 또는 임의의 모듈이 임의의 동작을 수행한다는 것은, 상기 구성 요소, 모델 또는 모듈이 포함된 전자 장치(또는, 전자 장치의 프로세서)가 상기 동작을 수행/실행하는 것을 의 미할 수 있다. 일 실시예에서, 전자 장치는, 상기 구성 요소, 모델 또는 모듈에 의한 동작, 인스트럭션 (instruction), 계산을 수행/실행할 수 있다. 일 실시예에서, 전자 장치는 상기 구성 요소, 모델 또는 모듈을 이용하여, 동작을 수행할 수 있다. 본 명세서에서, 'A 모델을 이용하여(또는 A 모델을 기초로), B를 기반으로 (또는 B로부터) C를 추출, 산출, 예 측 또는 생성하는 것'은, B 또는 B와 연관된 데이터 중 적어도 하나를 A 모델에 입력함에 따라, A 모델로부터 C 또는 C와 연관된 데이터 중 적어도 하나가 출력됨으로써, C를 획득, 생성 또는 식별하는 것을 의미할 수 있으나, 이에 한정되지 않는다. 예를 들어, B와 연관된 데이터는, B에 임의의 처리(예: 전처리(pre- processing)), 동작 또는 연산이 수행되어 생성된 데이터, B로부터 추출 또는 산출된 데이터, B를 기초로 산출, 생성 또는 결정된 데이터 및 B의 일부 중 적어도 하나를 의미할 수 있다. 예를 들어, C와 연관된 데이터는, 임 의의 처리(예: 후처리(post-processing)), 동작 또는 연산이 수행됨으로써 C가 생성되는 데이터, C가 추출 또는산출되는 데이터, C를 산출, 생성 또는 결정하는데 기초가 되는 데이터 및 C의 적어도 일부를 포함하는 데이터 중 적어도 하나를 의미할 수 있다. 한편, 'A 모델을 이용하여(또는 A 모델을 기초로), B를 기반으로 (또는 B로 부터) C를 추출, 산출, 예측 또는 생성하는 것'에 있어서, A 모델에 입력되는 B 또는 B와 연관된 데이터 중 적 어도 하나 외에 A 모델에는 추가적인 다른 데이터가 더 입력될 수 있으며, 마찬가지로, A 모델이 출력하는 C 또 는 C와 연관된 데이터 중 적어도 하나 외에 A 모델은 추가적인 다른 데이터를 더 출력할 수도 있다. 도 1a 내지 도 1c는 본 개시의 일 실시예에 따른 조직학 이미지로부터 패치 단위의 유전자 발현을 예측하는 예 시를 나타내는 도면이다. 도 1a는 조직학 이미지의 패치들의 로컬 정보를 기초로 조직학 이미지로부터 패치 단위의 유전자 발 현을 예측하는 예시를 나타내는 도면이다. 일 실시예에서, 전자 장치(예: 전자 장치의 적어도 하나의 프로세 서)는 조직학 이미지에서 특정 패치(즉, 특정 스팟 이미지)의 데이터만을 이용하여 특정 패치에 대한 유전 자 발현을 예측할 수 있다. 즉, 전자 장치는 전체 조직학 이미지에서 특정 패치에 국한된 로컬 정보만을 이용하여, 특정 패치에 대한 유전자 발현을 예측할 수 있다. 도 1a를 참조하면, 전자 장치는 조직학 이미지 의 복수의 패치들 중에서 제1 패치만을 기초로 제1 패치에서의 유전자 발현을 예측할 수 있다. 이 경우, 전자 장치는 다른 패치들 또는 조직학 이미지 전반적인 정보를 고려하지 않고, 제1 패치에 포함된 정보 및 데이터만을 이용하여 제1 패치에 대한 유전자 발현을 예측할 수 있다. 일 실시예에서, 전자 장치는 기 학습된 CNN(convolutional neural network) 기반의 모델을 이용하여, 조직학 이미지(또는, WSI)의 개별적인 패치들에서의 공간적 유전자 발현 패턴을 예측할 수 있다. 예를 들어, 전자 장치는 조직학 이미지를 복수의 패치로 분할하고, 패치들 각각을 하나의 입력으로 인공지능 모델에 입력함 으로써, 각 패치에 대한 유전자 발현 값을 예측할 수 있다. 예를 들어, 전자 장치에서 동작하는 인공지능 모델 은 각 패치들을 개별적인 입력 데이터로서 입력받아, 각 패치들에 대한 유전자 발현 예측 결과를 출력할 수 있 다. 즉, 제1 패치는 다른 패치들에 대한 유전자 발현 예측 결과에 영향을 미치지 않을 수 있고, 마찬가지 로, 제1 패치에 대한 유전자 발현 예측 결과는 다른 패치들의 영향을 받지 않을 수 있다. 도 1b는 조직학 이미지의 패치들의 글로벌 정보를 기초로 조직학 이미지로부터 패치 단위의 유전자 발현을 예측하는 예시를 나타내는 도면이다. 일 실시예에서, 전자 장치는 조직학 이미지에서의 복수의 패 치들(114_1, 114_2, 114_3, 114_4, ...)(예: 모든 패치들)의 데이터를 함께 이용하여 복수의 패치들(114_1, 114_2, 114_3, 114_4, ...)에 대한 유전자 발현을 예측할 수 있다. 즉, 전자 장치는 조직학 이미지에서의 패치들의 글로벌 콘텍스트(또는, 글로벌 정보)를 기초로 패치들에 대한 유전자 발현을 예측할 수 있다. 도 1b를 참조하면, 전자 장치는 조직학 이미지의 복수의 패치들(114_1, 114_2, 114_3, 114_4, ...)을 동시에 기초 하여, 각 패치들에서의 유전자 발현을 예측할 수 있다. 일 실시예에서, 전자 장치는 ViT(vision transformer) 기반의 모델을 사용하여, 조직학 이미지(또는 WS I)의 복수의 패치들(114_1, 114_2, 114_3, 114_4, ...)(예: 전체 패치들)로부터의 공간적 유전자 발현 패턴을 동시에 예측할 수 있다. 예를 들어, 전자 장치는 조직학 이미지를 복수의 패치들(114_1, 114_2, 114_3, 114_4, ...)로 분할하고, 복수의 패치들(114_1, 114_2, 114_3, 114_4, ...)에 대한 데이터를 하나의 입력으로 인공지능 모델에 입력함으로써, 각 패치에 대한 유전자 발현 값을 예측할 수 있다. 예를 들어, 전자 장치에서 동작하는 인공지능 모델은 복수의 패치들(114_1, 114_2, 114_3, 114_4, ...)을 하나의 입력 데이터로서 입력받 아, 패치들에 대한 유전자 발현 예측 결과를 출력할 수 있다. 즉, 임의의 패치는 다른 패치에 대한 유전자 발현 예측 결과에 영향을 미칠 수 있다. 데이터 크기가 큰 복수의 패치들(114_1, 114_2, 114_3, 114_4, ...)을 그대로, 즉, 각 패치 이미지 데이터들을 그대로 동시에 인공지능 모델에 입력하여 예측을 수행하는 경우, 전자 장치에 계산 부담이 가중될 수 있다. 이 에 따라, 전자 장치는 복수의 패치들(114_1, 114_2, 114_3, 114_4, ...) 각각에서 초기 피쳐를 추출하고, 추출 된 초기 피쳐를 입력 데이터로서 사용할 수 있다. 예를 들어, 전자 장치는 제1 패치로부터 제1 패치의 초기 피 쳐를 추출하고, 제2 패치로부터 제2 패치의 초기 피쳐를 추출할 수 있다. 전자 장치는 추출된 제1 패치의 초기 피쳐, 제2 패치의 초기 피쳐, ...및 제n 패치의 초기 피쳐를 하나의 입력 데이터로 인공지능 모델에 입력함으로 써, 각 패치들에서의 유전자 발현을 예측할 수 있다. 상술한 하나 이상의 실시예에서는, 로컬 정보 또는 글로벌 콘텍스트에만 초점을 맞추어 예측을 수행하기 때문에, 예측에 사용되는 정보가 제한적일 수 있다. 세포의 형태, 세포 소기관 등과 같은 로컬 특성이 유전자 발현에 직접적으로 연관될 수 있으므로, 유전자 발현 예측에 세분화된 로컬 정보가 중요할 수 있다. 또한, 세포 의 유전자 발현은 조직 내 다른 세포의 유전자 발현과 상호 연관성이 높으므로, 유전자 발현 예측에 글로벌 콘텍스트 역시 중요할 수 있다. 따라서, 글로벌 콘텍스트에만 초점을 맞추어 예측을 수행하는 경우, 패치의 로컬 정보를 반영하지 않으므로 유전자 발현 예측에 대한 성능이 저조할 수 있으며, 다른 패치들의 정보와 이미지 전 반적인 정보를 고려하지 않고 패치의 로컬 정보만을 기초로 예측을 수행하는 경우 역시 유전자 발현 예측에 대 한 성능이 저조할 수 있다. 도 1c는 조직학 이미지의 패치들의 로컬 정보 및 글로벌 정보를 기초로 조직학 이미지로부터 패치 단 위의 유전자 발현을 예측하는 예시를 나타내는 도면이다. 일 실시예에서, 유전자 발현 예측 성능을 향상시키기 위해, 전자 장치는 패치들의 로컬 정보와 글로벌 정보를 통합하고, 통합된 정보를 기초로 패치 단위의 유전자 발현 예측을 수행할 수 있다. 도 1c를 참조하면, 전자 장치는 조직학 이미지에서 제2 패치로부터 제2 패치의 로컬 정보를 추출하고, 조직학 이미지의 복수의 패치들(114_1, 114_2, 114_3, 114_4, ...)을 기초로 제2 패치의 글로벌 정보를 추출할 수 있다. 전자 장치는 제2 패치의 로컬 정보와 제2 패치 의 글로벌 정보(즉, 조직학 이미지에서의 글로벌 콘텍스트)를 모두 이용하여, 제2 패치에 대한 유전 자 발현을 예측할 수 있다. 즉, 전자 장치는 제2 패치의 로컬 정보와 제2 패치의 글로벌 정보를 통합 하고, 통합된 정보를 기초로 제2 패치에 대한 유전자 발현을 예측할 수 있다. 한편, 기존의 유전자 발현을 예측하기 위해 사용된 인공지능 모델은 조직학 이미지 분석에 적절하지 않을 수 있 다. 즉, 조직학 이미지는 일반적인 이미지와는 다른 특성을 가지므로, 일반적인 이미지 분석에 사용되는 모델 및 방식은 조직학 이미지를 분석하는데 적절하지 않을 수 있다. 예를 들어, 기존의 인공지능 모델은, 일반적인 이미지 분석을 위해 설계된 기 학습된 이미지 네트워크 모델(예: CNN 모델)일 수 있다. 예를 들어, 기존의 인공 지능 모델은, ST 시퀀싱과 함께 제공되는 소량의 조직 이미지를 사용하여 훈련된 패치 임베딩 모듈(또는, 모 델)일 수 있다. 조직 생검(tissue biopsy)의 임의적인 형태로 인해, 조직학 이미지는 기존의 이미지 네트워크 모델(예: ImageNet) 또는 다른 일반적인 리소스에서 사용될 수 있는 일반적인 이미지와는 달리 정방형으로 쉽게 정형화될 수 없다는 특성이 있다. ST 데이터의 제한된 수의 패치들만으로 고해상도의 조직학 이미지들로부터 강건한 표현 (robust representation)을 추출하는 것과, 기존의 위치 인코딩 방식으로 패치의 위치를 적절히 인코딩하는 것 은 쉽지 않을 수 있다. 따라서, 기존의 모델 및 기존의 방식으로는 조직학 이미지로부터의 유전자 발현 예측에 있어서, 강건한 예측(robust prediction), 즉, 높은 예측 성능을 달성하기 어려울 수 있다. 본 개시의 일 실시예에 따르면, 조직학 이미지(예: 암 조직학 이미지)의 가속 이중 임베딩(accelerated dual embedding)을 통한 공간적인 유전자 발현을 예측하는 방법 및 전자 장치가 제공될 수 있다. 일 실시예에서, 전 자 장치는 조직학 이미지의 로컬 피쳐 및 글로벌 피쳐를 동시에 임베딩하고, 두 정보를 모두 활용하여 유전자 발현을 예측할 수 있다. 예를 들어, 전자 장치는 로컬 임베딩 모델 및 글로벌 임베딩 모델을 이용하여, 유전자 발현을 예측할 수 있다. 로컬 임베딩 모델은 기 학습된 모델(예: Resnet 18)을 포함하며, 타겟 패치로부터 세분 화된 로컬 특징을 학습할 수 있다. 글로벌 임베딩 모델은 인공지능 모델(예: ViT 모델)을 이용하여, 조직학 이 미지(예: WSI)의 모든 패치들로부터 글로벌 콘텍스트 인지(global context-aware) 특징을 학습할 수 있다. 일 실시예에서, 전자 장치는 강건한 피쳐들을 추출하기 위해, 자기 지도 학습(self supervised learning) 방식 을 이용하여, 다양한 소스의 조직학 이미지들로 기 학습된 모델(예: Resnet 18 모델)을 조정(tune)할 수 있다. 전자 장치는 조정된 모델을 이용하여, 조직학 이미지의 복수의 패치들로부터 피쳐들(예: 초기 피쳐)을 추출함으 로써, 글로벌 임베딩 모델에 대한 계산 비용(computational cost)(예: 글로벌 임베딩 모델의 동작으로 인한 전 자 장치의 계산 부담)을 완화할 수 있다. 일 실시예에서, 로컬 임베딩 모델은 기 학습된 모델(예: Resnet 18 모델)을 미세 조정하여, 세분화된 로컬 정보 를 포착(capture)할 수 있다. 일 실시예에서, 전자 장치는 로컬 임베딩 모델 및 글로벌 임베딩 모델을 포함하는 통합 모델의 성능을 향상시키기 위해, 자기 증류(self distillation) 방식을 이용하여 학습을 수행할 수 있다. 일 실시예에서, 이미지 분석에서의 기존의 위치 인코딩의 한계를 극복하기 위해, 전자 장치는 고해상도 조직학 이미지에 맞춤화된 위치 임베딩 모델(예: 위치 정보 인코더, 위치 임베딩 모듈)를 사용할 수 있다. 도 1a 및 도 1c에서, 예측 결과는 각 유전자에 대한 유전자의 발현 값을 2차원의 막대 그래프 형태로 나타내고 있으나, 예측 결과의 표현 방법 및 형태는 이에 한정되지 않는다. 또한, 도 1b에서, 예측 결과는 각 패치들에서 의 각 유전자에 대한 유전자 발현 값을 3차원의 막대 그래프 형태로 도시하고 있으나, 예측 결과의 표현 방법 및 형태는 이에 한정되지 않는다. 또한, 도 1a 내지 도 1c에서, 예측 결과는 4 가지 종류의 유전자의 발현 값을 포함하고 있으나, 예측 대상이 되 는 유전자의 수는 이에 한정되지 않는다. 도 1b 및 도 1c의 복수의 패치들(114_1, 114_2, 114_3, 114_4, ...)는 도 1a의 제1 패치 또는 도 1c의 제 2 패치 중 적어도 하나를 포함할 수 있다. 도 2는 본 개시의 일 실시예에 따른 전자 장치가 인공지능 모델을 이용하여 조직학 이미지로부터 패치 단위의 유전자 발현을 예측하는 방법을 나타내는 흐름도이다. 도 2를 참조하면, 일 실시예에 따른 인공지능 모델을 이용하여 조직학 이미지로부터 패치 단위의 유전자 발현을 예측하는 방법은 단계 210 내지 240을 포함할 수 있다. 일 실시예에서, 단계 210 내지 240은 전자 장치에 포함되는 적어도 하나의 프로세서에 의해 실행될 수 있다. 하나 이상의 실시예에서, 전자 장치가 인공지능 모델 을 이용하여 조직학 이미지로부터 패치 단위의 유전자 발현을 예측하는 방법은 도 2에 도시된 바에 한정되 지 않으며, 도 2에 도시되지 않은 단계를 더 포함하거나, 일부 단계가 생략될 수 있다. 단계 210에서, 전자 장치(예: 전자 장치의 프로세서)는 복수의 패치로 분할된 상기 조직학 이미지의 제1 패치, 상기 제1 패치의 초기 피쳐 데이터 및 상기 조직학 이미지의 제2 패치의 초기 피쳐 데이터를 식별할 수 있다. 예를 들어, 패치의 초기 피쳐 데이터는, 패치에 포함된 픽셀들 중 적어도 일부의 데이터를 포함할 수 있다. 예 를 들어, 패치의 초기 피쳐 데이터는, 패치에 포함된 픽셀들 중 적어도 일부의 데이터에 피쳐 추출을 위한 연산 을 수행함으로써 산출될 수 있다. 일 실시예에서, 제1 패치의 초기 피쳐 데이터는 기 학습된 인공지능 모델(예: Resnet 모델)에 의해 제1 패치로 부터 추출될 수 있으며, 제2 패치의 초기 피쳐 데이터는 기 학습된 인공지능 모델에 의해 제2 패치로부터 추출 될 수 있다. 예를 들어, 각 패치의 초기 피쳐 데이터는 벡터 데이터일 수 있다. 예를 들어, 패치로부터 패치의 초기 피쳐 데이터를 추출하는 기 학습된 인공지능 모델은, 비교적 계산 부담이 적은 가벼운 모델, 학습이 완료 된 모델, 다양한 유형의 이미지 데이터에 일반화된 피쳐 추출 모델, 조직학 이미지를 학습 이미지로 사용하여 학습된 모델, 일반적인 이미지를 학습 이미지로 사용하여 학습된 모델 등일 수 있으나, 이에 한정되지 않는다. 일 실시예에서, 전자 장치는 유/무선으로 연결되거나 통신 가능한 다른 장치 또는 다른 서버로부터 조직학 이미 지를 수신할 수 있다. 일 실시예에서, 전자 장치는, 내장되거나 포함되거나 연결된 이미지 생성 장치(예: 촬영 장치, 이미지 센서 등)에 의해 조직학 이미지를 생성/획득할 수 있다. 전자 장치는 수신, 생성 또는 획득된 조 직학 이미지를 복수의 패치로 분할하고, 기 학습된 인공지능 모델을 이용하여, 제1 패치로부터 제1 패치의 초기 피쳐 데이터를 추출하고, 제2 패치로부터 제2 패치의 초기 피쳐 데이터를 추출할 수 있다. 일 실시예에서, 전자 장치는 유/무선으로 연결되거나 통신 가능한 다른 장치 또는 다른 서버로부터 조직학 이미 지의 하나 이상의 패치를 수신할 수 있다. 일 실시예에서, 전자 장치는 기 학습된 인공지능 모델을 이용하여, 수신된 하나 이상의 패치로부터 초기 피쳐 데이터를 추출할 수 있다. 예를 들어, 전자 장치는 수신된 제1 패치 로부터 제1 패치의 초기 피쳐 데이터를 추출하고, 수신된 제2 패치로부터 제2 패치의 초기 피쳐 데이터를 추출 할 수 있다. 일 실시예에서, 전자 장치는 유/무선으로 연결되거나 통신 가능한 다른 장치 또는 다른 서버로부터 조직학 이미지의 하나 이상의 패치의 초기 피쳐 데이터를 수신할 수 있다. 예를 들어, 전자 장치는 다른 장치 또는 다른 서버로부터 조직학 이미지의 제1 패치의 초기 피쳐 데이터 및 제2 패치의 초기 피쳐 데이터를 수신할 수 있다. 단계 220에서, 전자 장치는 제1 인공지능 모델을 이용하여, 상기 제1 패치의 초기 피쳐 데이터 및 상기 제2 패 치의 초기 피쳐 데이터를 기반으로, 상기 제1 패치의 글로벌 피쳐 데이터를 추출할 수 있다. 일 실시예에서, 제 1 인공지능 모델은 하나 이상의 인코더 및 조직학 이미지에서의 패치 위치 정보를 인코딩하는 위치 정보 인코더 를 포함할 수 있다. 예를 들어, 하나 이상의 인코더는 셀프 어텐션 연산을 수행할 수 있다. 일 실시예에서, 전 자 장치는 위치 정보 인코더를 이용하여, 제1 패치의 위치 정보가 인코딩된 제1 패치의 글로벌 피쳐 데이터를 추출할 수 있다. 예를 들어, 전자 장치는 제1 패치의 초기 피쳐 데이터 및 상기 제2 패치의 초기 피쳐 데이터를 기초로, 셀프 어텐션 연산을 수행할 수 있다. 전자 장치는 제1 패치의 위치 정보 및 제2 패치의 위치 정보를 기 초로, 상기 셀프 어텐션 연산의 결과 데이터에 대하여 컨볼루션 연산 및 변형 가능한 컨볼루션 연산을 각각 수 행할 수 있다. 전자 장치는 컨볼루션 연산의 결과 데이터와 변형 가능한 컨볼루션 연산의 결과 데이터를 기초로, 제1 패치의 위치 정보가 인코딩된 상기 제1 패치의 글로벌 피쳐 데이터를 추출할 수 있다. 단계 230에서, 전자 장치는 제2 인공지능 모델을 이용하여, 상기 제1 패치로부터 상기 제1 패치의 로컬 피쳐 데 이터를 추출할 수 있다. 일 실시예에서, 전자 장치는 제2 인공지능 모델을 이용하여, 상기 제1 패치로부터 상기 제1 패치의 제1 로컬 피쳐 데이터 및 제2 로컬 피쳐 데이터를 추출할 수 있다. 예를 들어, 제2 인공지능 모델은순차적으로 연결된 복수의 레이어를 포함하고, 제1 로컬 피쳐 데이터는 복수의 레이어 중 심층 레이어(예: 마지 막 레이어)의 출력 데이터이고, 제2 로컬 피쳐 데이터는 복수의 레이어 중 다른 레이어의 출력 데이터를 기초로 생성된 데이터일 수 있다. 단계 240에서, 전자 장치는 제3 인공지능 모델을 이용하여, 상기 제1 패치의 글로벌 피쳐 데이터와 상기 제1 패 치의 로컬 피쳐 데이터를 기반으로, 상기 제1 패치에 대한 유전자 발현 값을 예측할 수 있다. 일 실시예에서, 전자 장치는 제1 패치의 글로벌 피쳐 데이터와 상기 제1 패치의 로컬 피쳐 데이터를 연결함으로써, 상기 제1 패 치의 로컬-글로벌 피쳐 데이터를 생성하고, 생성된 제1 패치의 로컬-글로벌 피쳐 데이터를 기반으로 제3 인공지 능 모델을 이용하여, 제1 패치에 대한 유전자 발현 값을 예측할 수 있다. 일 실시예에서, 상기 단계220 내지 240에서 전자 장치가 이용하는 제1 인공지능 모델, 제2 인공지능 모델 및 제 3 인공지능 모델은, 하나의 인공지능 모델을 구성하는 서브 모델일 수 있다. 예를 들어, 제1 인공지능 모델, 제 2 인공지능 모델 및 제3 인공지능 모델은 엔드 투 엔드로 연결되어 동시에 학습/업데이트될 수 있으나, 이에 한 정되지 않는다. 제1 인공지능 모델, 제2 인공지능 모델 및 제3 인공지능 모델 중 적어도 하나의 모델은 개별적 으로 학습/업데이트될 수도 있다. 도 3은 본 개시의 일 실시예에 따른 조직학 이미지로부터 패치 단위의 유전자 발현을 예측하는 모델의 일례를 나타내는 도면이다. 도 3은 조직학 이미지로부터 패치 단위의 유전자 발현을 예측하는 모델의 구조의 일례를 나타낼 수 있다. 도 3을 참조하면, 모델은 글로벌 임베딩 모델, 로컬 임베딩 모델 및 결합 예측 모델을 서 브 모델로서 포함할 수 있다. 도 3에서는, 패치로부터 초기 피쳐 데이터를 추출하는 모델(예: ResNet 모델 )을 모델과는 별도의 전처리 모델로 도시하고 있으나, 이에 한정되지 않는다. 예를 들어, 패치로부터 초기 피쳐 데이터를 추출하는 모델이 모델의 글로벌 임베딩 모델에 포함될 수 있다. 전자 장치는 타겟 조직학 이미지의 타겟 패치를 식별할 수 있다. 일 실시예에서, 전자 장치는 타겟 조직학 이미지를 식별하고, 타겟 조직학 이미지를 복수의 패치로 분할함으로써, 타겟 패치를 식 별할 수 있다. 일 실시예에서, 전자 장치는 복수의 패치로 분할된 타겟 조직학 이미지를 획득하여, 복수의 패치들 중 타겟 패치를 식별할 수 있다. 예를 들어, 타겟 조직학 이미지는 전자 장치에 포함되거나 연결된 입력 장치를 통해 전자 장치에 입력될 수 있다. 예를 들어, 타겟 조직학 이미지는 전자 장치와 유 무선으로 통신가능한 다른 장치 및/또는 다른 서버로부터 전자 장치로 수신될 수 있다. 패치는 약 224x224 픽셀 의 이미지로 일반적인 이미지의 전체 사이즈와 유사할 수 있다. 따라서, 패치의 수가 커질수록 전자 장치가 패 치들을 임베딩하기 위한 연산량이 커질 수 있다. 전자 장치는 다수(예: 300개)의 패치들에 대한 글로벌 임베딩 모델의 계산 부담을 줄이기 위해, 타겟 조직 학 이미지의 초기 피쳐 맵을 식별할 수 있다. 타겟 조직학 이미지의 초기 피쳐 맵은, 타겟 조직학 이 미지의 복수의 패치들 중 적어도 일부 패치들로부터의 초기 피쳐 데이터, 즉, 적어도 일부 패치들 각각에 대응하는 초기 피쳐 데이터를 포함할 수 있다. 일 실시예에서, 전자 장치는 타겟 조직학 이미지의 초기 피 쳐 맵을 전자 장치와 유무선으로 연결되거나 통신가능한 다른 장치 및/또는 서버로부터 수신할 수 있다. 예를 들어, 전자 장치는 타겟 조직학 이미지의 적어도 일부 패치들 각각에 대응하는 초기 피쳐 데이터를 수신할 수 있다. 일 실시예에서, 전자 장치는 패치의 초기 피쳐 데이터를 추출하는 모델(이하, '사전 모델')을 이용하여, 타겟 조직학 이미지의 적어도 일부 패치들을 기초로 초기 피쳐 맵을 추출할 수 있다. 즉, 전자 장치는 타겟 조 직학 이미지의 적어도 일부 패치들에 대한 사전 임베딩 작업을 수행할 수 있다. 예를 들어, 전자 장치는 타겟 조직학 이미지의 적어도 일부 패치들 각각을 기 학습된 ResNet 모델에 입력함으로써, 적어도 일 부 패치들 각각으로부터의 초기 피쳐 데이터를 포함하는 초기 피쳐 맵을 생성/획득할 수 있다. 도 3에 도시된 바와 같이, 전자 장치는 타겟 패치를 기 학습된 ResNet 모델에 입력함으로써, 타겟 패치에 대응 하는 초기 피쳐 데이터를 포함하는 초기 피쳐 맵을 생성할 수 있다. 사전 모델(예: ResNet 모델)은 다수의 학습 조직학 이미지를 기반으로, 입력 패치들을 d 차원의 피쳐 벡터로 임베딩하도록 학습된 모델일 수 있다. 전자 장치는 글로벌 임베딩 모델에 타겟 조직학 이미지의 초기 피쳐 맵을 입력함으로써, 타겟 조직학 이미지의 글로벌 피쳐 맵을 생성할 수 있다. 타겟 조직학 이미지의 글로벌 피쳐 맵은, 타겟 조직학 이미지의 복수의 패치들 중 적어도 일부 패치들에 대응하는 글로벌 피쳐 데이터를 포함할 수 있다. 예를들어, 타겟 조직학 이미지의 글로벌 피쳐 맵은, 타겟 패치에 대응하는 글로벌 피쳐 데이터를 포 함할 수 있다. 예를 들어, 글로벌 임베딩 모델은, 다수의 패치들을 집계하는 비전 트랜스포머(vision transformer, ViT) 모델을 포함할 수 있다. 기가 픽셀의 해상도를 갖는 조직학 이미지(또는, WSI)을 처리하기 위해 다중 인스턴스 학습(multiple instance learning, MIL) 모델이 사용될 수 있다. MIL 모델은 패치를 집계하기 위해, 어텐션 기 반의 네트워크를 사용할 수 있다. 일 실시예에서, 전자 장치는 패치들의 글로벌 콘텍스트를 고려하기 위해, ViT 기반의 어그리게이터(aggregator)를 사용할 수 있다. 글로벌 임베딩 모델은 타겟 조직학 이미지의 적어도 일부 패치들(예: 모든 패치들)로부터 글로벌 정 보를 인코딩할 수 있다. 일 실시예에서, 전자 장치는 글로벌 임베딩 모델을 이용하여, 타겟 조직학 이미지 의 적어도 일부 패치들의 초기 피쳐 데이터를 기초로, 타겟 패치의 글로벌 피쳐 데이터를 추출 할 수 있다. 즉, 전자 장치는 타겟 패치의 초기 피쳐 데이터 뿐만 아니라 다른 패치들의 초기 피쳐 데이터 를 함께 고려함으로써, 타겟 패치의 글로벌 피쳐 데이터를 추출할 수 있다. 타겟 패치의 글로벌 피쳐 데이터는 타겟 패치에 한정된 정보가 아닌, 타겟 패치와 다른 패치들 간의 상관 관계 등의 타겟 조직학 이미지 전반에서의 전역적인 콘텍스트 정보가 인코딩된 것일 수 있다. 글로벌 임베딩 모델은 타겟 조직학 이미지의 복수의 패치들 중 적어도 일부 패치들의 공간적 정보를 고려하여, 적어도 일부 패치들 간의 상관 관계를 학습할 수 있다. 일 실시예에서, 글로벌 임베딩 모델은 패치들 간의 상관 관계를 인코딩하는 하나 이상의 인코더(322, 326)를 포함할 수 있다. 예를 들어, 하나 이상의 인코더(322, 326)는 타겟 조직학 이미지의 적어도 일부 패치들 간의 상관 관계를 인코딩하기 위한 셀프 어 텐션(self attention) 연산을 수행할 수 있다. 예를 들어, 글로벌 임베딩 모델은 셀프 어텐션 연산을 통해 롱 텀 의존성(long-term dependency)를 학습하는 ViT 모델을 포함할 수 있다. 일 실시예에서, 글로벌 임베딩 모델은 타겟 조직학 이미지의 적어도 일부 패치들의 공간적 정보를 인 코딩하기 위한 위치 정보 인코더를 포함할 수 있다. 따라서, 글로벌 임베딩 모델의 출력 데이터는 패 치들의 위치 정보가 인코딩된 패치들의 글로벌 피쳐 데이터를 포함할 수 있다. 도 3을 참조하면, 전자 장치는 글로벌 임베딩 모델의 제1 인코더를 이용하여, 타겟 조직학 이미지의 초기 피쳐 맵을 기초로 패 치들 간의 상관 관계를 인코딩함으로써 패치들에 대한 토큰들(예: 패치들에 대응하는 제1 토큰들)을 생성할 수 있다. 전자 장치는 위치 정보 인코더를 이용하여, 생성된 패치들에 대한 토큰들을 기초로 패치들의 위치 정보가 인코딩된 토큰들(예: 패치들에 대응하는 제2 토큰들)을 생성할 수 있다. 즉, 전자 장치는 초기 피쳐 맵 을 제1 인코더에 입력함으로써 패치들에 대한 토큰들을 추출하고, 패치들에 대한 토큰들을 위치 정보 인코 더에 입력함으로써, 위치 정보가 인코딩된 패치들에 대한 토큰들을 추출할 수 있다. 예를 들어, 하나의 토 큰은 하나의 패치에 대응하는 벡터 데이터일 수 있다. 전자 장치는, 제1 인코더의 출력 토큰들(예: 패치들에 대응하는 제1 토큰들)과 위치 정보 인코더의 출력 토큰들(예: 패치들에 대응하는 제2 토큰들)을 기초로, 글로벌 임베딩 모델의 나머지 인코더들을 이용하여, 패치들 간의 상관 관계를 L-1회(L은 1 이상의 자연수) 인코딩할 수 있다. 예를 들어, 전자 장치는 제 1 인코더의 출력 토큰들과 위치 정보 인코더의 출력 토큰들을 더하여(예: element-wise sum) 제2 인 코더에 입력하고, 순차적으로 L-1 회 인코딩을 수행할 수 있다. 예를 들어, 전자 장치는 타겟 패치에 대응 하는 제1 토큰과 타겟 패치에 대응하는 제2 토큰을 더하여, 제2 인코더에 입력할 수 있다. 도 3에서는, 글로벌 임베딩 모델의 제1 인코더의 출력 토큰들이 위치 정보 인코더에 입력되는 것으로 도시하고 있으나, 이에 한정되지 않는다. 예를 들어, 글로벌 임베딩 모델의 제e 인코더(e는, 1 이 상 L 이하의 자연수)의 출력 토큰들이 위치 정보 인코더에 입력될 수 있다. 일 실시예에서, 전자 장치는 위치 정보 인코더의 출력 토큰들과 제e 인코더의 출력 토큰들을 더하여 제e+1 인코더에 입력할 수 있다. 일 실시예에서, 전자 장치는 위치 정보 인코더의 출력 토큰들과 제e 인코더의 출력 토큰들을 더하여, 글로 벌 피쳐 맵을 산출할 수 있다. 도 3의 위치 정보 인코더에 대한 설명은 도 4 및 도 5를 참조하여 후술될 수 있으며, 중복된 설명은 생략될 수 있다. 전자 장치는 로컬 임베딩 모델에 타겟 조직학 이미지의 개별적인 패치를 입력함으로써, 입력된 패치 의 로컬 피쳐 데이터를 생성/획득할 수 있다. 예를 들어, 로컬 임베딩 모델은, 입력되는 타겟 패치로 부터 세분화된 로컬 정보를 포착하고, 공간적 유전자 발현 패턴을 예측하도록, 기 학습된 CNN 모델(예: Resnet 18 모델)을 미세 조정(fine-tune)한 것일 수 있다. 일 실시예에서, 전자 장치는 로컬 임베딩 모델을 이용 하여, 타겟 패치로부터 타겟 패치의 로컬 피쳐 데이터를 추출할 수 있다. 로컬 임베딩 모델은글로벌 임베딩 모델과는 다르게 다른 패치들을 기초로 하지 않을 수 있다. 즉, 전자 장치는 타겟 패치 의 로컬 피쳐 데이터를 추출하는데 있어서, 다른 패치들의 정보는 고려하지 않을 수 있다. 예를 들어, 전 자 장치는 제1 패치를 로컬 임베딩 모델에 입력함으로써 제1 패치의 로컬 피쳐 데이터를 추출하고, 제2 패 치를 로컬 임베딩 모델에 입력함으로써 제2 패치의 로컬 피쳐 데이터를 추출할 수 있다. 전자 장치는 로컬 임베딩 모델에 타겟 패치를 입력함으로써 타겟 패치의 하나 이상의 로컬 피쳐 데이터를 추출/산출할 수 있다. 즉, 로컬 임베딩 모델은 하나의 입력에 대하여 복수의 출력 데이터를 출력할 수 있 다. 예를 들어, 도시된 바와 같이, 로컬 임베딩 모델은 타겟 패치에 대하여, 제1 로컬 피쳐 데이터, 제2 로컬 피쳐 데이터, 제3 로컬 피쳐 데이터 및 제4 로컬 피쳐 데이터를 출력할 수 있다. 제1 로컬 피쳐 데이 터, 제2 로컬 피쳐 데이터 및 제3 로컬 피쳐 데이터 각각은, 로컬 임베딩 모델의 타겟 패치에 대한 추론 동작 중 생성되는 중간 출력 데이터를 기초로 산출될 수 있다. 타겟 패치에 대한 로컬 임베딩 모델 의 복수의 출력 데이터의 포맷은 서로 동일할 수 있으나, 이에 한정되지 않는다. 일 실시예에서, 로컬 임베딩 모델은 하나 이상의 블록을 포함하는 모델일 수 있다. 블록은, 하나 이상의 레이어를 포함할 수 있다. 예를 들어, 로컬 임베딩 모델은 복수의 레이어를 포함할 수 있으며, 복수의 레 이어가 하나 이상의 블록으로 분할될 수 있다. 예를 들어, 도시된 바와 같이, 로컬 임베딩 모델이 Resnet 18 모델을 포함하는 경우, Resnet 18 모델이 4개의 ResBlock으로 분할되어 로컬 임베딩 모델에 포함될 수 있다. 이 경우, 로컬 임베딩 모델의 각 블록은 순차적/직렬적으로 연결될 수 있다. 일 실시예에서, 로컬 임베딩 모델의 각 블록은 로컬 임베딩 모델에 입력되는 타겟 패치에 대한 연산을 수행할 수 있다. 예를 들어, 로컬 임베딩 모델의 각 블록은 타겟 패치에 대한 중간 출력 데이 터 또는 심층 출력 데이터를 산출, 생성 및 출력할 수 있다. 타겟 패치에 대한 로컬 임베딩 모델의 심층 출력 데이터는, 로컬 임베딩 모델의 심층 블록(또는, 심층 레이어, 마지막 블록, 마지막 레이어)의 출력 데이터를 의미할 수 있으며, 중간 출력 데이터는 로컬 임베딩 모델의 다른 블록(또는, 다른 레이어) 의 출력 데이터를 의미할 수 있다. 도 3을 참조하면, 제1 ResBlock은 타겟 패치를 입력받아 연산을 수행함으로써, 제1 중간 출력 데이터 를 출력하고, 제2 ResBlock은 제1 중간 출력 데이터를 입력받아 연산을 수행함으로써, 제2 중간 출력 데이 터를 출력하고, 제3 ResBlock은 제2 중간 출력 데이터를 입력받아 연산을 수행함으로써, 제3 중간 출력 데 이터를 출력하고, 제4 ResBlock, 즉, 마지막 블록은 제3 중간 출력 데이터를 입력받아 연산을 수행함으로 써, 심층 출력 데이터(즉, 제4 로컬 피쳐 데이터)를 출력할 수 있다. 도 3에서는 로컬 임베딩 모델이 Resnet 모델을 포함하고, 로컬 임베딩 모델의 각 블록이 ResBlock인 것으로 도시하고 있으나, 이에 한정되 지 않는다. 로컬 임베딩 모델의 블록들은 동일한 수 또는 상이한 수의 레이어들을 포함할 수 있다. 일 실시예에서, 로컬 임베딩 모델은 중간 출력 데이터로부터 로컬 피쳐 데이터를 추출/산출하는 하나 이상 의 추가 레이어(예: Bottleneck 레이어)를 포함할 수 있다. 예를 들어, 도 3을 참조하면, 로컬 임베딩 모델 은 제1 ResBlock과 연관된 제1 Bottleneck 레이어, 제2 ResBlock과 연관된 제2 Bottleneck 레이어, 제3 ResBlock과 연관된 제3 Bottleneck 레이어를 포함할 수 있다. 추가 레 이어는, 입력되는 데이터(즉, 타겟 패치에 대한 중간 출력 데이터)를 로컬 임베딩 모델의 타겟 패치 에 대한 심층 출력 데이터와 동일한 포맷으로 인코딩할 수 있다. 로컬 임베딩 모델은 타겟 패치에 대한 중간 출력 데이터 및/또는 심층 출력 데이터를 기초로, 하나 이상의 로컬 피쳐 데이터를 산출할 수 있다. 일 실시예에서, 로컬 임베딩 모델의 하나 이상의 추가 레이어 는 연관된 블록에서 출력되는 중간 출력 데이터를 기초로 로컬 피쳐 데이터를 추출/산출할 수 있다. 예를 들어, 도 3을 참조하면, 제1 Bottleneck 레이어는 제1 ResBlock로부터의 타겟 패치에 대한 제1 중간 출력 데이터를 입력받아 타겟 패치에 대한 제1 로컬 피쳐 데이터를 출력하고, 제2 Bottleneck 레이어(34 2)는 제2 ResBlock로부터의 타겟 패치에 대한 제2 중간 출력 데이터를 입력받아 타겟 패치에 대 한 제2 로컬 피쳐 데이터를 출력하고, 제3 Bottleneck 레이어는 제3 ResBlock로부터의 타겟 패치 에 대한 제3 중간 출력 데이터를 입력받아 타겟 패치에 대한 제3 로컬 피쳐 데이터를 출력할 수 있다. 일 실시예에서, 로컬 임베딩 모델은 심층 출력 데이터를 타겟 패치에 대한 제4 로컬 피쳐 데이 터로 결정할 수 있다. 심층 블록과 연관된 로컬 피쳐 데이터(즉, 심층 출력 데이터)가 다른 블록과 연관된 로컬 피쳐 데이터(즉, 중간 출력 데이터로부터의 로컬 피쳐 데이터)보다 타겟 패치의 로컬 정보를 보다 잘 반영한 데이터일 수 있다. 예를 들어, 제4 블록의 제4 로컬 피쳐 데이터가 제2 블록의 제2 로컬 피쳐 데이터 보다 타겟 패치의 로컬정보를 보다 잘 반영한 피쳐 데이터일 수 있다. 전자 장치는 결합 예측 모델을 이용하여, 타겟 패치의 글로벌 피쳐 데이터와 타겟 패치의 로컬 피쳐 데이터를 기반으로 타겟 패치에 대한 유전자 발현(예: 유전자 발현 레벨)을 예측할 수 있다. 일 실시예에서, 전자 장치는 타겟 패치의 글로벌 피쳐 데이터와 하나 이상의 로컬 피쳐 데이터를 결합할 수 있다. 예를 들어, 전자 장치는 타겟 패치의 글로벌 피쳐 데이터와 하나 이상의 로컬 피쳐 데이터 를 연결(concatenate)함으로써, 타겟 패치의 하나 이상의 로컬-글로벌 피쳐 데이터를 생성할 수 있다. 전자 장치는 결합 예측 모델에 타겟 패치의 로컬-글로벌 피쳐 데이터를 입력함으로써, 타겟 패치 에 대한 유전자 발현 값을 산출할 수 있다. 결합 예측 모델은 로컬-글로벌 피쳐 데이터로부터 유전자 발현 값을 산출하는 하나 이상의 예측기(predictor)를 포함할 수 있다. 결합 예측 모델의 각 예측기는 로 컬 임베딩 모델의 각 블록에 대응할 수 있다. 일 실시예에서, 결합 예측 모델의 예측기는 입력되는 로컬-글로벌 피쳐 데이터를 기초로 유전자 발현 값을 산출하기 위한 레이어(예: 완전 연결 레이어(fully connected layer, FC 레이어))를 포함할 수 있다. 예를 들어, 전자 장치는 하나 이상의 로컬-글로벌 피쳐 데이터를 각각 FC 레이어에 입력함으로써, 하나 이상의 유전 자 발현 값을 산출할 수 있다. 도 3을 참조하면, 결합 예측 모델의 FC 레이어는 타겟 패치의 제1 로 컬-글로벌 피쳐 데이터를 입력받아, 타겟 패치에 대한 제1 출력(즉, 제1 유전자 발현 값)을 출 력하고, 타겟 패치의 제2 로컬-글로벌 피쳐 데이터를 입력받아, 타겟 패치에 대한 제2 출력 (즉, 제2 유전자 발현 값)을 출력하고, 타겟 패치의 제3 로컬-글로벌 피쳐 데이터를 입력받아, 타겟 패치에 대한 제3 출력(즉, 제3 유전자 발현 값)을 출력하고, 타겟 패치의 제4 로컬-글로벌 피쳐 데이터를 입력받아, 타겟 패치에 대한 제4 출력(즉, 제4 유전자 발현 값)을 출력할 수 있 다. 도 3에 도시된 결합 예측 모델의 FC 레이어들은 서로 동일하거나, 상이하거나, 일부 상이할 수 있다. 전자 장치는 타겟 패치에 대하여 산출된 복수의 유전자 발현 값을 기초로 타겟 패치에 대한 최종 유 전자 발현 값을 결정할 수 있다. 일 실시예에서, 전자 장치는 복수의 유전자 발현 값의 평균 값을, 타겟 패치 에 대한 최종 유전자 발현 값으로 결정할 수 있다. 예를 들어, 전자 장치는 제3 출력 및 제4 출력 의 평균 값을 타겟 패치에 대한 유전자 발현 값으로 결정할 수 있다. 예를 들어, 전자 장치는 타겟 패치에 대한 모든 유전자 발현 값(즉, 제1 출력, 제2 출력, 제3 출력 및 제4 출력) 의 평균 값을, 타겟 패치에 대한 최종 유전자 발현 값으로 결정할 수 있다. 일 실시예에서, 전자 장치는 복수의 유전자 발현 값 중 하나를 최종 유전자 발현 값으로 결정할 수 있다. 예를 들어, 전자 장치는 제4 출력 (즉, 심층 블록과 연관된 유전자 발현 값)을 타겟 패치에 대한 최종 유전자 발현 값으로 결정할 수 있다. 일 실시예에서, 전자 장치는, 아래 수학식 과 같이, 글로벌 임베딩 모델을 이용하여 타겟 조직학 이미 지의 복수의 패치들을 인코딩하고, 아래 수학식 와 같이, 로컬 임베딩 모델을 이용하여 타겟 패치 를 인코딩하고, 아래 수학식 과 같이, 각 인코딩 출력 데이터들을 결합하여 타겟 패치에 대한 유 전자 발현을 예측할 수 있다. 수학식"}
{"patent_id": "10-2023-0136981", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "수학식"}
{"patent_id": "10-2023-0136981", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "수학식"}
{"patent_id": "10-2023-0136981", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "상기 수학식 내지 에서, 는 타겟 조직학 이미지의 패치들을 나타내고, 는 타겟 패치를 나타내고, n은 패치의 수를 나타내고, H는 패치의 높이를 나타내고, W는 패치 의 너비를 나타낼 수 있다. g는 글로벌 임베딩 모델을 나타내고, 은 에 대응하는 d 차원의 글 로벌 피쳐 데이터, 즉, 의 글로벌 피쳐 데이터를 나타낼 수 있다. 상기 수학식 에서의 글로벌 임베딩 모 델은 패치로부터 초기 피쳐 데이터를 추출하는 모델을 포함할 수 있다. h는 로컬 임베딩 모델을 나타내고, 은 의 d 차원의 로컬 피쳐 데이터를 나타낼 수 있다. 또한, || 기호는 벡터들의 연결 (concatenation)을 의미하고, f는 결합 예측 모델(즉, 예측기)을 나타내고, 는 에 대한 m 차원의 유전자 발현 예측 결과를 나타내고, m은 예측 대상 유전자의 수를 나타낼 수 있다. 전자 장치는 모델의 추론 동작 및/또는 학습 동작에서 상술한 하나 이상의 실시예를 수행할 수 있다. 한편, 모델의 추론 동작이 수행되는 전자 장치와 모델의 학습 동작이 수행되는 전자 장치는 서로 상 이하거나 동일할 수 있다. 모델의 추론 동작에서, 도 3의 타겟 조직학 이미지는 모델의 추론 대 상이 되는 이미지이고, 타겟 패치는 추론 대상이 되는 패치일 수 있다. 모델의 학습 동작에서, 도 3 의 타겟 조직학 이미지는 모델의 학습을 위한 학습 이미지이고, 타겟 패치는 모델의 학습 을 위한 학습 패치일 수 있다. 추가적으로 또는 대안적으로, 전자 장치는 모델의 추론 동작을 수행함과 동 시에, 모델을 업데이트할 수도 있다. 전자 장치는 학습 데이터를 이용하여, 모델을 학습/업데이트할 수 있다. 학습 데이터는, 학습 이미지들(즉, 학습 조직학 이미지들), 학습 이미지의 패치들에 대한 정답 레이블(즉, 유전자 발현 값)을 포함할 수 있다. 일 실시예에서, 모델을 구성하는 모델들(320, 330, 350)은 엔드 투 엔드로 연결되어 동시에 학습 될 수 있다. 사전 모델(즉, 패치의 초기 피쳐 데이터를 추출하는 모델)은 다른 모델들과 함께 학습되지 않을 수 있다. 예를 들어, 사전 모델은 모델들(320, 330, 350)과는 개별적으로 학습/업데이트될 수 있으며, 최초에 학습 된 후 업데이트되지 않을 수 있다. 예를 들어, 사전 모델과 로컬 임베딩 모델은 동일한 구조의 모델(예: Resnet 18 모델)을 포함할 수 있으나, 모델이 학습되는 동안 사전 모델의 파라미터 값은 업데이트되지 않 고, 로컬 임베딩 모델의 파라미터 값은 업데이트될 수 있다. 전자 장치는 지도 학습 방식을 적용하여 모델을 학습할 수 있다. 일 실시예에서, 모델은, 타겟 조직 학 이미지의 타겟 패치에 대하여 예측되는 유전자 발현 값과 정답 유전자 발현 값(즉, 정답 레이블) 사이의 차이를 기반으로 하는 손실 함수를 이용하여 학습될 수 있다. 예를 들어, 전자 장치는 모델에 의해 예측된 하나 이상의 유전자 발현 값과 정답 유전자 발현 값 사이의 차이가 줄어드는 방향으로 학습할 수 있다. 도 3을 참조하면, 모델의 타겟 패치에 대한 제1 출력과 레이블 사이의 차이, 제2 출력 과 레이블 사이의 차이, 제3 출력과 레이블 사이의 차이 및 제4 출력과 레이블 차이가 줄어들도록, 모델의 파라미터들을 업데이트할 수 있다. 전자 장치는 자기 증류(self distillation) 방식을 적용하여 모델을 학습함으로써, 로컬-글로벌 피쳐 데이 터를 이용한 유전자 발현 예측에 대한 성능, 즉, 모델의 예측 성능을 향상시킬 수 있다. 일 실시예에서, 모델은, 학습 이미지에 포함된 타겟 패치에 대한 로컬 임베딩 모델의 심층 레이어의 출력 데이 터를 기초로 산출된 유전자 발현 값과 타겟 패치에 대한 로컬 임베딩 모델의 다른 레이어의 출력 데 이터를 기초로 산출된 유전자 발현 값 사이의 차이를 기반으로 하는 손실 함수를 이용하여 학습될 수 있다. 전자 장치는 모델 학습에 있어서, Be Your Own Teacher(BYOT) 방식을 적용하거나 BYOT 방식을 수정하여 적용할 수 있다. 이 경우, 소량의 레이어(즉, 추가 레이어, Bottleneck 레이어)를 추가하는 것만으로도 모델의 예측 정확도가 향상될 수 있다. 일 실시예에서, 전자 장치는 결합 예측 모델의 복수의 예측기 중, 로컬 임 베딩 모델의 심층 블록과 연관된 예측기를 교사 모델(teacher)로, 로컬 임베딩 모델의 다른 블록과 연관된 예측기를 학생 모델(student)로서 자기 증류 학습을 수행할 수 있다. 모델은 타겟 패치에 대 한 교사 모델의 출력 데이터와 학생 모델의 출력 데이터 사이의 차이를 기반으로 하는 손실 함수를 이용하여 학 습/업데이트될 수 있다. 즉, 학생 모델이 교사 모델의 출력을 기초로 학습할 수 있다. 도 3을 참조하면, 교사 모델의 출력인 제4 출력과 학생 모델의 출력인 제1 출력 사이의 차이, 교사 모델의 출력인 제4 출력과 학생 모델의 출력인 제2 출력 사이의 차이 및 교사 모델의 출력인 제4 출 력과 학생 모델의 출력인 제3 출력 사이의 차이 기반의 손실 값이 줄어드는 방향으로 모델이 학 습/업데이트될 수 있다. 일 실시예에서, 모델은, 타겟 패치에 대한 로컬 임베딩 모델의 심층 레이어(또는, 심층 블록)의 출력 데이터를 기초로 생성된 로컬-글로벌 피쳐 데이터와 타겟 패치에 대한 로컬 임베딩 모델의 다른 레이어(또는, 다른 블록)의 출력 데이터를 기초로 생성된 로컬-글로벌 피쳐 데이터 사이의 차이를 기반으로 하 는 손실 함수를 이용하여 학습될 수 있다. 예를 들어, 학생 모델(즉, 학생 예측기)에 입력되는 데이터(예: 피쳐 데이터, 피쳐맵)를 교사 모델(즉, 교사 예측기)에 입력되는 데이터에 맞추기 위하여, 모델은 교사 모델과각 학생 모델의 입력 데이터 사이의 L2 로스를 최소화하는 방향으로 학습될 수 있다. 예를 들어, 도 3에서, 제4 로컬-글로벌 피쳐 데이터와 제3 로컬-글로벌 피쳐 데이터 사이의 차이, 제4 로컬-글로벌 피쳐 데이터 와 제2 로컬-글로벌 피쳐 데이터 사이의 차이 및 제4 로컬-글로벌 피쳐 데이터와 제1 로컬-글로 벌 피쳐 데이터 사이의 차이 기반의 손실 값이 줄어드는 방향으로, 모델이 학습/업데이트될 수 있다. 일 실시예에서, 로컬 임베딩 모델의 각 블록의 타겟 패치에 대한 출력 데이터 기반의 로컬-글로벌 피 쳐 데이터가 다음 블록의 타겟 패치에 대한 출력 데이터 기반의 로컬-글로벌 피쳐 데이터와의 차이가 줄어 드는 방향으로 모델이 학습/업데이트될 수 있다. 예를 들어, 도시된 바와 같이, 제4 로컬-글로벌 피쳐 데 이터와 제3 로컬-글로벌 피쳐 데이터 사이의 차이, 제3 로컬-글로벌 피쳐 데이터와 제2 로컬-글 로벌 피쳐 데이터 사이의 차이 및 제2 로컬-글로벌 피쳐 데이터와 제1 로컬-글로벌 피쳐 데이터 사이의 차이 기반의 손실 값이 줄어드는 방향으로 모델이 학습/업데이트될 수 있다. 일 실시예에서, 전자 장치는 모델을 학습하기 위해 아래 수학식 및 의 손실 함수를 사용할 수 있다. 수학식"}
{"patent_id": "10-2023-0136981", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 5, "content": "수학식"}
{"patent_id": "10-2023-0136981", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 6, "content": "상기 수학식 및 에서, 는 i번째 예측기의 k번째 유전자의 발현 예측 값을 나타내고, 는 k번째 유 전자에 대한 정답 레이블(즉, 정답 유전자 발현 값)을 나타낼 수 있다. 는 교사 모델(즉, 교사 예측기)의 k 번째 유전자의 발현 예측 값을 나타낼 수 있다. 는 i번째 예측기의 입력 데이터(예: 입력 피쳐 맵)을 나타내 고, 는 교사 모델의 입력 데이터를 나타낼 수 있다. m은 예측하고자 하는 유전자의 수를 의미할 수 있다. α 및 λ은 로스들 간의 균형을 위한 하이퍼 파라미터일 수 있다. 따라서, 상기 수학식 에 따르면, 전자 장치는 모델의 복수의 예측기에 대한 손실()의 합()을 모델의 손실 함수로서 사용하여, 모델을 학습할 수 있다. 전자 장치는 상기 수학식 및 의 손실 함수를 이용하여 모델을 학습할 수 있으나, 모델 학습을 위한 손실 함수는 상기 수학식 및 에 한정되지 않는다. 일 실시예에서, 전자 장치는 모델을 학습하 기 위해, 예측 값과 정답 레이블 간의 교차 엔트로피 로스, 교사 모델과 학생 모델 사이의 쿨백-라이블러 발산 (Kullback-Leibler divergence, KLD), 교사 모델과 학생 모델의 입력 데이터 또는 출력 데이터(예: 피쳐 맵) 사이의 L2 로스(또는, L1 로스) 등의 로스를 포함하는 손실 함수를 이용하여, 모델을 학습할 수 있다. 도 3에서는 전자 장치가 타겟 조직학 이미지의 복수의 패치들 중 하나의 타겟 패치에 대하여 유전자 발현을 예측하는 예시를 도시하고 있으나, 전자 장치는 타겟 조직학 이미지의 적어도 일부 패치들 각각을 타겟 패치로서, 적어도 일부 패치들 각각에 대하여 유전자 발현을 예측할 수 있다. 즉, 전자 장치는 적어도 일 부 패치들 각각을 타겟 패치로서 모델에 입력함으로써, 적어도 일부 패치들 각각에서의 유전자 발현 값을 예측할 수 있다. 이 경우, 타겟 패치가 달라짐에 따라, 로컬 임베딩 모델에 입력되는 패치가 달라질 수 있 으며, 타겟 조직학 이미지의 글로벌 피쳐 맵 중에서 로컬 피쳐 데이터와 연결되는 글로벌 피쳐 데이터가 달라질 수 있다. 도 3에서, 로컬 임베딩 모델은 4개의 블록을 포함하고, 4개의 로컬 피쳐 데이터를 출력하는 것으로 도시하 고 있으나, 이에 한정되지 않는다. 즉, 로컬 임베딩 모델의 블록의 수 및 출력 데이터의 수는 4개로 한정 되지 않으며, 1 이상의 임의의 수일 수 있다. 도 4는 본 개시의 일 실시예에 따라 조직학 이미지에서의 패치의 위치 정보를 인코딩하는 예시를 나타내는 도면 이다. 도 4는 도 3의 위치 정보 인코더의 동작의 일례를 나타낼 수 있다. 전자 장치(예: 전자 장치에서 동작하는 위치 정보 인코더)는 패치들의 위치 정보(또는 공간 정보)가 반영된 글로벌 피쳐를 추출하기 위해, 조직학 이미지(또는, WSI)에 대한 위치 인코딩을 수행할 수 있다. 일 실시예에서, 전자 장치는 위치 정보 인코더를 포 함하는 글로벌 임베딩 모델을 사용할 수 있으며, 위치 정보 인코더를 이용하여 패치들의 위치 정보를 인코 딩하는 동작들을 수행할 수 있다. 예를 들어, 전자 장치는 글로벌 임베딩 모델의 제1 인코더(또는, 제e 인코 더)로부터 출력되는 패치들에 대한 토큰들을 위치 정보 인코더에 입력함으로써, 위치 정보가 반영된 토큰들을 생성할 수 있다. 크기가 고정적인 입력 이미지에 대하여 적용 가능한 기존의 위치 인코딩 방식은 입력 이미지의 크기가 가변적인 경우에는 적용되기 어려울 수 있다. 전자 장치는 고정적 또는 가변적인 크기를 갖는 입력 이미지에 대하여 조건 부 위치 인코딩(conditional positional encoding, CPE) 방식으로 위치 인코딩을 수행할 수 있다. 일 실시예에 서, 전자 장치는 패치들에 대한 데이터를 재구성함으로써 패치들의 본래 주변 위치 정보를 복원하고, 주변 위치 정보가 복원된 패치들에 대한 데이터에 제로 패딩의 컨볼루션 레이어를 적용할 수 있다. 전자 장치는 컨볼루션 레이어가 적용된 패치들에 대한 데이터를 다시 재구성한 후 원래의 패치들에 대한 데이터와 결합시킬 수 있다. 이 경우, 패치들의 절대적인 위치 정보가 미리 정의되지 않더라도, 패치들의 위치 정보는 동적으로 인코딩 될 수 있다. 즉, 입력 이미지의 크기가 달라지더라도, 패치들의 위치 정보가 인코딩될 수 있다. 일 실시예에서, 전자 장치는 글로벌 임베딩 모델의 제1 인코더(또는, 제e 인코더)로부터 출력된 패치들에 대한 토큰들(즉, 패치들에 대응하는 제1 토큰들)을, 조직학 이미지 내에서의 패치들의 위치에 따라 배치함으로 써, 위치 정보가 복원된 공간 데이터를 생성할 수 있다. 도 4를 참조하면, 전자 장치는 타겟 조직학 이미지의 적어도 일부 패치들에 대한 토큰들을 획득하거나, 산출하거나, 생성할 수 있다. 패치들에 대한 토큰들은 글로벌 임베딩 모델의 하나 이상의 인코더에 의해 산출된 데이터로서, 패치들 간의 상관 관 계가 반영된 데이터일 수 있다. 전자 장치는 위치 정보가 복원된 공간 데이터에 대하여 위치 정보 인코딩 연산을 수행함으로써, 위치 정보가 인코딩된 패치들에 대한 토큰들(즉, 패치들에 대응하는 제2 토큰들)을 산출할 수 있다. 일 실시예 에서, 전자 장치는 위치 정보 인코딩 연산이 수행된 제2 토큰들을 기초로 패치들에 대한 토큰들을 업데이 트하고, 업데이트된 토큰들을 기초로 이후의 동작들을 수행할 수 있다. 예를 들어, 전자 장치는 패치들에 대한 토큰들을 기존의 제1 토큰들에서 제2 토큰들로 업데이트하고, 업데이트된 토큰들을 이용하여 이후의 동작 (예: 글로벌 임베딩 모델의 인코더 연산)을 수행할 수 있다. 예를 들어, 전자 장치는 기존의 제1 토큰들과 위치 정보가 인코딩된 제2 토큰들을 결합(예: element-wise sum)한 데이터로 패치들에 대한 토큰들을 업데이트 하고, 업데이트된 토큰들을 기초로 이후의 동작들을 수행할 수 있다. 도 4를 참조하면, 타겟 패치에 대한 토큰(즉, 타겟 패치에 대응하는 토큰)은, 글로벌 임베 딩 모델의 하나 이상의 인코더에 의해 타겟 조직학 이미지의 적어도 일부 패치들(예: 적어도 일부 패치들 의 초기 피쳐 데이터)을 기초로 산출될 수 있다. 예를 들어, 타겟 패치에 대한 토큰은 하나 이상의 인코더에 의해 타겟 패치와 다른 패치들과의 상관 관계를 기초로 산출될 수 있다. 예를 들어, 타겟 패치 에 대한 토큰은, d 차원의 벡터 데이터로, 패치들에 대한 토큰들은 공간(여기서, n은 패 치들의 수)의 데이터일 수 있다. 전자 장치는 패치들의 타겟 조직학 이미지 내에서의 위치 정보를 기초로 패치들에 대한 토큰들 을 공간에 배치함으로써 공간 데이터의 형태로 재구성할 수 있다. 전자 장치는 공간 데이터의 형태로 재구성된 토큰들에 대하여 위치 정보를 인코딩하기 위한 연산을 수행 할 수 있다. 전자 장치는 위치 정보 인코딩 연산의 결과를 기존의 패치들에 대한 토큰들에 반영함으로써, 토큰들을 업데이트할 수 있다. 예를 들어, 전자 장치는 타겟 패치에 대한 토큰과 인접 토큰들을 기반으로 위치 정보 인코딩 연산을 수행하여, 타겟 패치에 대한 위치 정보가 반영된 토큰을 산출하고, 위치 정보가 반영된 토큰을 기초로 타겟 패치에 대한 토큰을 업데이트할 수 있다. 일 실시예에서, 전자 장치는 위치 인코딩 생성기(positional encoding generator, PEG)를 글로벌 임베딩 모델 의 위치 정보 인코더로서 이용하여, CPE 방식으로 위치 인코딩을 수행할 수 있다. 예를 들어, 전자 장치는 커널 k(k ≥ 3)와 (k-1)/2 제로 패딩의 2차원 컨볼루션으로 구현되는 PEG를 이용하여, 패치들에 대한 위치 인코딩을 수행할 수 있다. 일 실시예에서, 전자 장치는 PEG를 WSI에 적용한 피라미드 위치 인코딩 생성기(Pyramid Position Encoding Generator, PPEG)를 글로벌 임베딩 모델의 위치 정보 인코더로서 이용하여, 패치들에 대한위치 인코딩을 수행할 수 있다. 예를 들어, 전자 장치는 PPEG를 이용하여, 다양한 크기의 커널을 적용하고, 융 합함으로써 위치 정보를 인코딩할 수 있다. PPEG는 WSI의 패치 토큰들을 인공적인 2차원 사각형 피쳐 맵으로 재 구성하여 CPE 방식을 적용할 수 있다. PPEG는 사각 형태가 아닌 WSI를 이미지 스캐너에서 출력되는 순서에 따라 사각 형태로 배치하므로, 본래 위치 정보대로 배치되지 않을 수 있으며, 사각 형태로 만드는 과정에서 토큰들 수가 제곱수가 아닌 경우에는 불필요한 중복을 생성할 수도 있다. 한편, 조직 검사(biopsy)로부터의 조직 슬라이스들(즉, 조직학 이미지 및 WSI)은 불규칙적인 형태를 가지므로, 조직학 이미지(또는, WSI)들은 대부분의 일반적인 이미지와는 다르게 이미지 영역이 사각 형태가 아닐 수 있으 며, 도 4에 도시된 바와 같이, 패치들 사이에 비어 있는 영역이 존재할 수 있다. 이러한 조직학 이미지의 특성 으로 인해, 조직학 이미지를 위해 설계된 것이 아닌 방식(예: PEG에 의한 CPE 방식)을 조직학 이미지에 적용하 는 경우, 패치들의 절대적 위치를 포착하는 것이 어려울 수 있다. 이에 따라, 일 실시예에서, 전자 장치는 조직 학 이미지를 위한 위치 인코딩 생성기(position encoding generator for histology images, PEGH)를 글로벌 임 베딩 모델의 위치 정보 인코더로서 이용하여, 패치들에 대한 위치 인코딩을 수행할 수 있다. 조직학 이미지를 위한 위치 인코딩 생성기, PEGH에 대한 설명은 도 5를 참조하여 후술될 수 있으며, 중복되는 설명은 생략될 수 있다. 도 4의 위치 정보 인코딩 연산은, PEG의 연산, PPEG의 연산 또는 PEGH 연산일 수 있으나, 이에 한정되지 않는다. 도 5는 본 개시의 일 실시예에 따른 조직학 이미지에서의 패치의 위치 정보를 인코딩하는 예시를 나타내는 도면 이다. 도 5는 도 4에 도시된 위치 정보 인코딩 연산의 일례로, 도 4의 위치 정보 인코딩 연산이 도 5에 도시된 바에 한정되지는 않는다. 일 실시예에서, 전자 장치(예: 전자 장치의 적어도 하나의 프로세서)는 조직학 이미지를 위 한 위치 인코딩 생성기 PEGH를 위치 정보 인코더로서 사용하여, 위치 정보를 인코딩할 수 있다. 예를 들어, 전 자 장치는 글로벌 임베딩 모델의 제e 인코더로부터 출력되는 패치들에 대한 토큰들(t)을 기초로 위치 정보 인코 더를 이용하여 패치 위치 정보를 인코딩할 수 있다. 전자 장치는 패치들의 위치 정보를 기초로 패치들의 본래 공간을 복원하고, 컨볼루션 레이어로 패치들에 위치 정보를 인코딩할 수 있다. 일 실시예에서, 위치 정보 인코더 PEGH(또는, PEGH가 동작하는 전자 장치)는 획득된 패치들의 상대 중심 좌표 (relative center coordinate)를 사용하여, d 차원의 n 개의 토큰들( )을 원래의 공간( , h와 w는 x와 y의 최대 좌표값)에 배치하고, 빈 영역(예: 조직, 세포가 없는 영역)의 위치에는 0을 채움으로써, 공간 데이터(예: 도 4의 430)를 생성할 수 있다. 전자 장치는, 생성된 공간 데이터(즉, 토큰들이 배치된 공간의 데이터)에 컨볼루션 레이어를 적용할 수 있다. 즉, 전자 장치는 생성된 공간 데이터를 컨 볼루션 레이어에 입력함으로써 연산을 수행할 수 있다. 전자 장치는 컨볼루션 레이어의 연산 수행 결과로서, 컨 볼루션 레이어의 입력 공간 데이터와 동일한 형태(예: )의 출력 공간 데이터를 획득/생성/산 출할 수 있다. 본 개시의 일 실시예에 따르면, 전자 장치는 위치 정보 인코더 PEGH의 컨볼루션 레이어에 의해, 변형 가능한 컨 볼루션(deformable convolution) 연산 및/또는 표준 컨볼루션 연산을 수행할 수 있다. 즉, 위치 정 보 인코더 PEGH의 컨볼루션 레이어는 표준 컨볼루션 커널 및/또는 변형 가능한 컨볼루션 커널을 포함할 수 있다. 변형 가능한 컨볼루션은 직사각형 격자 형태로 수신 필드가 제한된 컨볼루션 레이어를 확장하기 위해 사 용될 수 있다. 전자 장치는 학습 가능한 오프셋을 사용하여 컨볼루션 커널의 수신 필드를 동적 형태로 확장하여 조직학 이미지의 임의적인(즉, 가변적인) 형태를 포착할 수 있다. 일 실시예에서, 전자 장치는 임의적인 형태에 해당하는 조직학 이미지를 처리하기 위해 동일한 레이어에서 표준 컨볼루션 커널 외에 변형 가능한 컨볼루션 커 널을 이용한 연산을 수행할 수 있다. 즉, 전자 장치는 표준 컨볼루션 연산과 변형 가능한 컨볼루션 연산 을 모두 수행함으로써, 빈 공간(즉, 조직이 나타나지 않는 공간)을 포함하는 조직학 이미지의 특징을 더 잘 반영한 피쳐를 추출할 수 있다. 도 5에서는, 공간의 데이터의 적어도 일부를 x-y 평면으로 간략화하여 도시한 것일 수 있다. 일 실시예에서, 전자 장치는 공간에 배치된 토큰들(즉, 입력 공간 데이터)에 대하여, 표준 컨볼루션 커널을 이용한 연산을 수행할 수 있다. 예를 들어, 도 5를 참조하면, 전자 장치는, 공간에 배치된 타겟 패치에 대한 토큰과 주변에 위치한 토큰들 및 비어있는 영역들(즉, 제로 영역)을 기초로, 3x3 표준 컨볼루션 연산을 수행할 수 있다. 일 실시예에서, 전자 장치는 공간에 배치된 토큰들(즉, 입력 공간 데이터)에 대하여, 변형 가능한 컨볼루 션 커널을 이용한 연산을 수행할 수 있다. 도 5를 참조하면, 전자 장치는, 공간에 배치된 타겟 패치에 대한 토 큰과 주변에 위치한 유효한 토큰들을 기초로, 3x3 변형가능한 컨볼루션 연산을 수행할 수 있다. 즉, 전자 장치는 오프셋으로 인해 제로 영역들 대신 주변의 유효한 토큰들을 기초로 변형 가능한 컨볼루션 연산 을 수행할 수 있다. 예를 들어, 도 5에서, 전자 장치는 오프셋으로 인해 타겟 패치에 대한 토큰의 오 른쪽에 위치한 0 데이터(즉, 제로 영역) 대신 해당 0 데이터의 오른쪽에 위치한 토큰을 기초로 컨볼루션 연산을 수행할 수 있다. 일 실시예에서, 전자 장치는 표준 컨볼루션 연산의 결과와 변형 가능한 컨볼루션 연산의 결과를 결합 함으로써, 컨볼루션 레이어의 출력 공간 데이터를 생성할 수 있다. 예를 들어, 전자 장치는 표준 컨볼루션 연산 의 결과와 변형 가능한 컨볼루션 연산의 결과를 원소 별로(element-wise) 더할 수 있다. 일 실시예에서, 전자 장치는 입력 공간 데이터에서 0으로 채워진 위치(즉, 제로 영역)에 대응하는 출력 공 간 데이터에서의 위치에 다시 0을 채움으로써, 위치 정보가 인코딩된 공간 데이터를 생성할 수 있다. 위치 정보가 인코딩된 공간 데이터는 위치 정보가 인코딩된 토큰들을 포함할 수 있다. 예를 들어, 위치 정보가 인코딩된 공간 데이터는, 타겟 패치의 위치 정보가 반영된 토큰, 즉, 위치 정보가 인코딩된 타겟 패치에 대한 토큰을 포함할 수 있다. 전자 장치는 위치 정보가 인코딩된 토큰들을, 위치 정보 인코더에 입력된 토큰들의 원래 형태(즉, )로 되돌릴 수 있다. 전자 장치는, 형태의 위치 정보가 인코딩된 토큰들을 기초로, 글로벌 임베딩 모델의 하나 이상의 인코더에 의한 셀프 어텐션 연산을 수행함으로써, 위치 정보가 인코딩된 글로벌 피쳐 데이터(또는, 글로벌 피쳐 맵)을 산출/생성할 수 있다. 일 실시예에서, 전자 장치는 위치 정보 인코더의 출력 토큰들(즉, 위 치 정보가 인코딩된 토큰들)과 위치 정보 인코더의 입력 토큰들을 원소 별로 더하여(element-wise sum), 셀프 어텐션 연산을 수행할 수 있다. 예를 들어, 전자 장치는 위치 정보 인코더에 입력된 타겟 패치에 대한 토큰 과 위치 정보 인코더로부터 출력된 타겟 패치에 대한 토큰(즉, 위치 정보가 인코딩된 타겟 패치에 대한 토 큰)을 원소 별로 더하여, 글로벌 임베딩 모델의 다음 인코더에 입력할 수 있다. 도 5에서는 표준 컨볼루션 연산과 변형 가능한 컨볼루션 연산을 모두 이용하여 위치 인코딩을 수행하 는 예시를 도시하고 있으나, 이에 한정되지 않는다. 예를 들어, 전자 장치는 위치 인코딩을 위해, 표준 컨볼루 션 연산 또는 변형 가능한 컨볼루션 연산을 이용할 수 있다. 예를 들어, 전자 장치는 위치 인코딩을 위해, 다른 형태의 컨볼루션 연산을 수행함으로써, 위치 인코딩을 수행할 수 있다. 도 6은 본 개시의 일 실시예에 따른 조직학 이미지로부터 패치 단위의 GNAS 유전자 발현 예측 결과와 GNAS 유전 자 발현 정답의 일례를 나타내는 도면이다. 전자 장치는 입력 이미지에 대하여 본 개시의 일 실시예에 따른 유전자 발현 예측 방법을 적용함으로써, 입력 이미지 내의 각 패치에서의 유전자 발현을 예측할 수 있다. 일 실시예에서, 전자 장치는 입력 조직학 이미지의 각 패치에서의 GNAS 유전자의 발현 값을 산출할 수 있다. 일 실시예에서, 전자 장치는 입력 조직학 이미지의 각 패치에서의 GNAS 유전자의 발현 레벨을 결정할 수 있다. 유전자 발현 레벨은 유전자 발현 값을 기초로 결정될 수 있다. 도시된 바와 같이, 특정 유전자의 발현 레벨은 입력 이미지의 각 패치 영역에서 색채(예: 명도, 채도)로 표시될 수 있다. 예를 들어, 높은 명도일수록 특정 유전자 발현 레벨이 낮은 것을 나타내고, 낮은 명도일수록 특정 유 전자 발현 레벨이 높은 것을 나타낼 수 있으나, 이에 한정되지 않는다. 특정 유전자의 발현, 즉, 발현 값 또는 발현 레벨)은 각 패치에 대하여, 수치 데이터, 그래프 데이터 등 다양한 방법으로 표시될 수 있다. 도 6에 도시된 바와 같이, 제1 입력 데이터에 대한 제1 출력 데이터의 좌측 하단 영역은 제1 입 력 데이터에 대한 정답 데이터의 좌측 하단 영역과 같이 명도가 높게 나타나는 등 이미지 전반 에서의 GNAS 유전자 발현 레벨 분포에 있어서 제1 출력 데이터가 정답 데이터와 유사한 경향성을 나 타내고 있다. 마찬가지로, 제2 입력 데이터에 대한 제2 출력 데이터의 중간 하단 영역은 제2 입 력 데이터에 대한 정답 데이터의 중간 하단 영역과 같이 명도가 높게 나타나고, 제2 출력 데이 터의 우측 하단 영역은 정답 데이터의 우측 하단 영역과 같이 다른 영역들과 구분되도록명도가 높게 나타나는 등 이미지 전반에서의 GNAS 유전자 발현 레벨 분포에 있어서 제2 출력 데이터가 정 답 데이터와 유사한 경향성을 나타내고 있다. 마찬가지로, 제3 입력 데이터에 대한 제3 출력 데이터 의 상단 넓은 영역은 제3 입력 데이터에 대한 정답 데이터의 상단 넓은 영역과 같이 다른 영역들과 구분되도록 명도가 높게 나타나는 등 이미지 전반에서의 GNAS 유전자 발현 레벨의 분포에 있어서 제3 출력 데이터가 정답 데이터와 유사한 경향성을 나타내고 있다. 각 입력 데이터에 대한 정답 데이터(616, 628, 646)는 조직 검사를 통해 획득된 정답 데이터로서, 입력 이미지 의 각 패치들에서의 GNAS 유전자 발현 레벨을 각 패치의 위치에 색채로 나타낸 것일 수 있다. 도 7a 내지 7f는 본 개시의 일 실시예에 따른 인공지능 모델의 유전자 발현을 예측하는 성능을 정량적으로 나타 내는 도면이다. 도 7a 및 도 7b는 일 실시예에 따른 유전자 발현 예측 모델('SPREAD')의 유전자 발현 예측 성능과 다른 실시예 에 따른 유전자 발현 예측 모델들('ST-net', 'HistoGene', 'Hist2ST', 'CPVT')의 유전자 발현 예측 성능을 비 교하기 위한 표를 도시한다. 도 7a 및 도 7b에서 각 모델들의 유전자 발현 예측 성능은, 각 모델들을 이용한 유 전자 발현 예측에 대한 성능으로, 예측 정확도를 의미할 수 있으며, 예측 정확도가 높을수록 예측 성능이 높은 것을 나타낼 수 있다. 예측 정확도는 모델을 이용하여 예측되는 유전자 발현 값과 정답 유전자 발현 값을 기초 로 산출/평가될 수 있다. 도 7a 및 도 7b에서 'SPREAD'는 도 3에 도시된 모델(즉, 도 3의 314 및 300)을 나타내고, 'ST-net'는 제1 선행 논문(Abubakar Abid, Alma Andersson, Ake Borg, Jonas Maaskola, Joakim Lundeberg, and James Zou. Integrating spatial gene expression and breast tumour morphology via deep learning. Nature biomedical engineering, 4:827-834, 2020.)에 기재된 모델을 나타내고, 'HistoGene'은 제2 선행 논문(Minxing Pang, Kenong Su, and Mingyao Li. Leveraging information in spatial transcriptomics to predict super- resolution gene expression from histology images in tumors. bioRxiv, 2021.)에 기재된 모델을 나타내고, 'Hist2ST'는 제3 선행 논문(Yuansong Zeng, Zhuoyi Wei, Weijiang Yu, Rui Yin, Yuchen Yuan, Bingling Li, Zhonghui Tang, Yutong Lu, and Yuedong Yang. Spatial transcriptomics pre- diction from histology jointly through transformer and graph neural networks. Briefings in Bioinformatics, 23:bbac297, 2022.)에 기재된 모델을 나타낼 수 있다. 도 7a 및 도 7b에서 'ST-net', 'HistoGene', 'Hist2ST'는 각 선행 논 문에서 사용한 하이퍼 파라미터를 채택하여 학습된 모델일 수 있다. 도 7a 및 도 7b에서 'CPVT'는 하나 이상의 인코더와 PEG로 구성된 기존의 CPVT 모델을 일부 수정한 것으로, PEG를 제외한 다른 구성에 대해서는 'SPREAD' 의 글로벌 임베딩 모델과 동일한 하이퍼 파라미터가 적용될 수 있다. 'CPVT'의 예측 성능을 통해, 글로벌 정보 및 로컬 정보를 모두 고려하는 'SPREAD'와 글로벌 정보에만 초점을 맞추어 예측을 수행하는 모델(예: 'CPVT')의 성능을 비교할 수 있다. 도 7a는 유방암 ST 데이터 세트('ST-Breast')와 피부암 ST 데이터 세트('ST-Skin') 두 가지의 공개 ST 데이터 세트로 수행한 테스트 결과를 나타낼 수 있다. 도 7b는 10X 유전체학의 3 가지 외부 Visium 데이터(예: 더 높은 해상도를 갖는 ST의 차기 버전)('10X Visium-1', '10X Visium-2', '10X Visium-3')로 수행한 테스트 결과를 나 타낼 수 있다. 도 7a는 ST 데이터 세트를 이용한 각 모델에 대한 리브-원-아웃 교차 검증(Leave-One-Out Cross-Validation, LOOCV) 결과로서, PCC(A), PCC(M), MSE 및 MAE 값을 포함할 수 있다. 도 7b는 외부 Visium 데이터를 이용한 각 모델에 대한 일반화 성능 테스트 결과로서, PCC(A), PCC(M), MSE 및 MAE 값을 포함할 수 있다. 도 7a 및 도 7b 에서, PCC는 피어슨 상관관계 상관계수(Pearson correlation coefficient)를 의미하고, MSE는 평균 제곱 오차 (mean squared error)를 의미하고, MAE는 평균 절대 오차(mean absolute error)를 의미할 수 있으며, PCC, MSE 및 MAE는 회귀 작업의 정확도를 평가하기 위한 척도로 사용될 수 있다. PCC(A) 및 PCC(M)은 각각 평균 PCC 및 중간 PCC를 의미할 수 있으며, '-' 표시는 이용 불가능함을 나타낼 수 있다. 도 7a는 ST 데이터를 이용하여, 각 환자 데이터에 대한 LOOCV로서 산출된 모든 폴드로부터의 평균 PCC, MSE 및 MAE를 포함할 수 있다. 도 7b는 유방암 ST 데이터로 훈련된 모델을 각 Visium 데이터를 이용하여 수행된 테스트 결과를 포함할 수 있다. 각 모델의 성능 테스트를 위한 이미지를 전처리로서, WSI들은 중심 좌표를 이용하여, 224x224 사이즈의 패치들로 크롭될 수 있다. 유전자 발현 값들은 각 지점 내에서의 유전자 발현 값들의 합으로 정규화되고, 로그 변환이 적용될 수 있다. 도 7a 및 도 7b의 'SPREAD'모델의 성능 검증을 위한 모델 훈련 단계에서, 모델의 웨이트를 업데이트하기 위해 0.0001의 일정한 학습률을 가진 아담 옵티마이저(Adam optimizer)가 사용될 수 있다. 'SPREAD' 모델의 자기 증 류를 위해, 하이퍼 파라미터인 α와 γ는 0.3과 0.03로 설정될 수 있으며, 'SPREAD' 모델의 글로벌 임베딩 모델 은 4개의 인코딩 레이어(즉, 인코더)와 제1 인코더 뒤에 위치한 하나의 PEGH를 포함할 수 있다. 모델 훈련 단계에서는 미니 배치 크기가 256으로, 모델 테스트 단계에서는 미니 배치 크기가 1로 설정될 수 있 다. 훈련 단계에서는 학습 WSI의 모든 패치들 중 미니 배치 크기 만큼의 패치와 학습 WSI의 각 패치로부터 추출 된 초기 피쳐 데이터들, 즉, 미니 배치 크기 만큼의 (패치, WSI의 각 패치로부터 추출된 초기 피쳐 데이터들) 쌍을 이용하여 모델이 학습될 수 있다. 테스트 단계에서는 학습 WSI의 모든 패치들과 학습 WSI의 각 패치들로부 터 추출된 초기 피쳐 데이터들, 즉, 모든 (패치, WSI의 각 패치로부터 추출된 초기 피쳐들) 쌍을 이용하여, 모 델이 추론을 수행할 수 있다. 또한, ST 데이터에 포함된 WSI와 유전자 발현 매트릭스 쌍이 정답 레이블(즉, 정 답 유전자 발현 값)로서 사용될 수 있다. 유방암 ST 데이터 세트는 7명의 환자에게 대한 데이터로서 각 환자 별로 4 또는 5개의 사본(replicate)을 포함 할 수 있다. 피부 ST 데이터 세트는 4명의 환자에 대한 데이터로서, 각 환자 별로 3개의 사본을 포함할 수 있다. 사본들은 완전히 동일한 조직 샘플에서 생성되므로, 정확한 평가를 위해 각 환자마다 LOOCV를 수행할 수 있다. 즉, 하나의 환자에 대한 사본들은 모델 학습 또는 테스트 중 하나에 사용될 수 있다. 성능 평가를 위한 예측 대상 유전자를 결정하기 위해, 필터링 과정이 수행될 수 있다. 구체적으로, 각 데이터 내에서 변동이 심한 상위 N개(예: 1000 개)의 유전자가 선별된 후, 모든 패치들에서 임계값(예: 1000) 미만으로 발현하는 유전자는 제외될 수 있다. 도 7a는, 상술한 필터링 과정에 의해 유방암 ST 데이터에서 선정된 785개의 유전자와 피부암 ST 데이터에서 선정된 171개의 유전자의 발현에 대한 예측 성능에 대한 평가 결과를 나타낼 수 있다. 즉, 도 7a의 'ST-Breast' 열은 유방암 ST 데이터를 이용하여 LOOCA를 수행함에 따른 각 모델의 785개의 유전자 발현에 대한 예측 성능을 나타내고, 'ST-Skin' 열은 피부암 ST 데이터를 이용하여 LOOCA를 수행함에 따 른 각 모델의 171개의 유전자 발현에 대한 예측 성능을 나타낼 수 있다. 도 7a의, 유방암 ST 데이터 세트와 피부암 ST 데이터 세트에 대한 평가 지표의 값에 따르면, 'SPREAD'의 성능이 다른 모델들의 성능에 비해 우수한 성능을 나타낸다. 구체적으로, 도 7a는 'SPREAD'가, 다른 모델들 중 가장 성 능이 우수한 'ST-net'와 비교하여, 유방암 ST 데이터 세트에서 평균 PCC('PCC(A)')의 45.5 % 증가 및 MSE의 2.8% 감소를 달성함을 나타낸다. 또한, 도 7a는 'SPREAD'가, 'ST-net'와 비교하여 피부암 데이터 세트에서 평균 PCC의 13.6% 증가 및 MSE의 9.6% 감소를 달성함을 나타낸다. 또한, 'SPREAD'는 유전자 발현을 예측하기 위해 글 로벌 정보만을 사용하는 'CPVT'와 비교하여, 유방암 ST 데이터 세트에서 평균 PCC의 30 % 증가 및 MSE의 2.5 % 감소를 달성한다. 따라서, 도 7a는, 'SPREAD'가 다른 모델들에 비해 향상된 예측 성능을 달성함을 나타낼 수 있 으며, 조직학 이미지(또는 WSI)로부터 공간 유전자 발현을 예측하는데 있어서, 로컬 정보와 글로벌 콘텍스트가 모두 중요함을 시사할 수 있다. 도 7b는, 다양한 소스의 독립적인 데이터 세트에서의 각 모델의 성능 평가 결과를 나타낼 수 있다. 도 7b의 성 능 평가에서는, 독립적인 코호트에서 모델을 테스트하기 위해, 세 명의 서로 다른 환자들로부터의 공개적으로 사용가능한 세 가지 10X 유전체학 Visium 데이터가 사용될 수 있다. 성능 평가를 위해, 10X 유전체학 Visium 데 이터는 ST 데이터에 대하여 수행된 것과 같은 방식으로 전처리될 수 있다. 예를 들어, 10X 유전체학 Visium 데 이터 포함된 조직학 이미지로부터 224x224의 사이즈로 크롭된 패치들이 사용될 수 있으며, 글로벌 임베딩 모델 의 입력 데이터로 사용하기 위해, 패치들은 사전 임베딩될 수 있다. 도 7b는 세 가지 10X 유전체학 Visium 데이 터 각각에 대하여 성능 평가 결과를 나타낼 수 있다. 도 7b는, 외부 테스트 데이터에 대한 일반화 성능을 테스트한 결과이다. 성능 테스트 대상 모델들은 도 7a의 LOOCV 결과에 따라 산출된 최적의 에포크 수 및 유방암 ST 데이터 세트를 기반으로 훈련될 수 있다. 유방암 ST 데이터 세트로 훈련된 각 모델들은 Visium 데이터를 이용하여 테스트될 수 있다. 도 7b는, 'SPREAD'가 'ST-net' 및 'CPVT'에 비해, PCC(A) 및 PCC(M)에서 가장 우수한 성능을 달성함을 나타낸다. 따라서, 도 7b는, 'SPREAD' 가 다른 모델들보다 강건하고 일반화 가능한 모델임을 시사할 수 있다. 한편, 도 7b는 'CPVT'가 두번째로 우수 한 성능을 달성하며, 오류 매트릭(즉, MSE, MAE)에서는 가장 우수한 성능을 달성함을 나타낸다. 따라서, 도 7b 는, 강건한 예측 성능을 위해서는 글로벌 콘텍스트를 고려한 피쳐 임베딩이 중요함을 시사할 수 있다. 따라서, 도 7a 및 도 7b는, 본 개시의 일 실시예에 따른 'SPREAD' 모델이 ST 데이터 세트에 대하여 다른 실시예 들에 따른 모델들보다 우수한 성능을 달성하며, 다른 외부 데이터에 대하여도 우수한 성능을 달성하는 바, 더 잘 일반화된 모델임을 나타낼 수 있다.도 7c 및 도 7d는, 도 7a의 유방암 ST 데이터 세트에 대한 성능 결과를 그래프로 도시한다. 도 7e 및 도 7f는, 도 7a의 피부암 ST 데이터 세트에 대한 성능 결과를 그래프로 도시한다. 도 7c 및 도 7e의 x 축은 테스트 데이 터로 사용된 환자의 데이터를 나타낼 수 있다. 예를 들어, 도 7c의 x 축에서 'A'는, 각 모델을 'B, C, D, E, F, G' 환자 데이터를 이용하여 학습하고, 'A' 환자 데이터로 테스트를 수행하였음을 나타낼 수 있다. 마찬가지로, 도 7e의 x 축에서 'P2'는, 각 모델을 'P5, P9, P10' 환자 데이터를 이용하여 학습하고 'P2' 환자 데이터로 테스 트를 수행하였음을 나타낼 수 있다. 도 7c 및 도 7e의 y축은 예측 대상 유전자들에 대한 PCC 값을 나타낼 수 있 다. 도 7c 및 도 7e의 각 분포 그래프는, 각 모델의 복수의 유전자들에 대한 PCC 값의 분포를 나타낼 수 있다. 도 7d 및 도 7f는 각 유전자에 대한 복수의 폴드에서의 PCC 값들의 평균 값 분포와 중간 값 분포를 나타낼 수 있다. 예를 들어, 7개의 폴드들에서의 제1 유전자에 대한 PCC 값의 평균이 제1 유전자의 평균 PCC로서, 7개의 폴드들에서의 제1 유전자에 대한 PCC 값의 중간값이 제1 유전자의 중간 PCC로서 도 7d의 분포 그래프에 포함될 수 있다. 마찬가지로, 4개의 폴드들에서의 제1 유전자에 대한 PCC 값의 평균이 제1 유전자의 평균 PCC로서, 4개 의 폴드들에서의 제1 유전자에 대한 PCC 값의 중간값이 제1 유전자의 중간 PCC로서 도 7f의 분포 그래프에 포함 될 수 있다. 도 7d 및 도 7f는, 본 개시의 일 실시예에 따른 \"SPREAD\" 모델이 다른 실시예들에 따른 모델들에 비해 평균 PCC와 중간 PCC의 분포가 높이 위치함을 나타낼 수 있다. 도 7a 내지 도 7f에서 상술한 성능 평가를 위한 설정들은, 도 8a, 도 8b, 도 9a 및 도 9b에도 적용될 수 있다. 도 8a 및 8b는 본 개시의 일 실시예에 따른 인공지능 모델의 예측 성능을 정성적으로 나타내는 도면이다. 유방암 ST 데이터의 조직 유형 어노테이션(annotation)을 이용하여, 본 개시의 일 실시예에 따른 유전자 발현 예측 모델('SPREAD')의 성능에 대한 간접적이고 정성적인 평가가 이루어질 수 있다. 유전자 발현은 조직 유형에 따라 상당히 달라지므로, 유전자 발현 예측 성능이 좋은 모델(또는, 방법)은 레이블 정보 없이도, 서로 다른 조 직 유형들을 구별할 수 있을 것으로 가정될 수 있다. 도 8b의 그래프들(820, 830, 840, 850, 860)은, 'SPREAD'와 다른 모델들('ST-net', 'CPVT', 'LEO', 'GEO')의 도 8a의 조직학 이미지에 대한 잠재 피쳐 맵(latent feature map)(예: FC 레이어에 입력되는 피쳐 맵, 중 간 생성 피쳐 맵)을 시각화한 그래프일 수 있다. 구체적으로, 도 8b는 각 모델들을 이용하여 도 8a의 조직학 이 미지 내의 모든 패치들로부터 피쳐 맵(즉, 잠재 피쳐 맵)을 추출하고, 추출된 피쳐맵을 UMAP 알고리즘을 이용하여, 2 차원 공간에 투영(project)한 것일 수 있다. 'SPREAD'는 도 3에 도시된 모델(예: 도 3의 300)을 나 타내고, 'ST-net'는 제1 선행 논문(Abubakar Abid, Alma Andersson, Ake Borg, Jonas Maaskola, Joakim Lundeberg, and James Zou. Integrating spatial gene expression and breast tumour morphology via deep learning. Nature biomedical engineering, 4:827-834, 2020.)에 기재된 모델을 나타내고, 'LEO'는 도 3에 도시된 로컬 임베딩 모델(즉, 도 3의 330)을 나타내고, 'GEO'는 도 3에 도시된 글로벌 임베딩 모델(즉, 도 3의 320)을 나타낼 수 있다. 도 8b의 그래프들(820, 830, 840, 850, 860)에서, 각 패치에 대한 피쳐 데이터(즉, 모델에 의해 추출된 각 패치 에 대한 피쳐 맵)는 2 차원 공간에 투영됨으로써, 각 패치에 대응하는 점(dot)으로 표시될 수 있다. 점의 음영 은, 해당 위치의 패치의 조직 유형(예: 주요 조직 유형)이 4 가지 조직 유형(침습성 암(Invasive canscer), 결 합 조직(Connective tissue), 가슴샘(Breast glands), 지방 조직(Adiopose tissue)) 중 무엇인지 나타낼 수 있 다. 도 8b를 참조하면, 'SPREAD'의 그래프에서 동일한 조직 유형에 해당하는 점들이 유사한 위치에 분포되 고, 다른 조직 유형에 해당하는 점들은 서로 구별되어 분포된다. 따라서, 도 8b의 그래프들(820, 830, 840, 850, 860)은 'SPREAD'가 다른 모델들과 비교하여 4 가지 조직 유형들을 더 잘 구분함을 나타낼 수 있다. 4 가지 조직 유형들 중 결합 조직과 지방 조직은 로컬 영역에 초점을 맞추면 거의 구별할 수 없고, 글로벌 스케 일에서 이미지 전반으로 비교해야 명확히 구별할 수 있다. 도 8b의 'SPREAD'의 그래프는 'SPREAD'가 결합 조직과 지방 조직의 패치들을 잘 구분함을 나타낸다. 또한, 도 8b의 그래프들(820, 830, 840, 850, 860)에 따르 면, 패치들의 로컬 피쳐에 의존하는 모델인 'STnet', 'LEO'은 글로벌 콘텍스트를 고려하는 모델인 'CPVT', 'GEO', 'SPREAD'에 비해 결합 조직과 지방 조직을 구분하는 성능이 떨어지는 경향이 나타난다. 따라서, 도 8b은 공간적 유전자 발현을 예측하는데 있어서, 로컬 피쳐와 함께 글로벌 콘텍스트를 고려하는 것이 중요함을 간접적 으로 나타낼 수 있다. 도 9a 및 9b는 본 개시의 일 실시예에 따른 인공지능 모델의 각 구성의 성능 기여를 나타내는 도면이다. 도 9a 및 9b는 애블레이션 연구(ablation study)를 통한 본 개시의 일 실시예에 따른 유전자 발현 예측 모델 ('SREAD')의 각 구성(또는, 각 구성 모델)의 기여도를 나타낼 수 있다. 'SPREAD'는 도 3에 도시된 모델(예: 도3의 300)을 의미할 수 있다. 모델의 유전자 발현 예측 성능은, 상기 모델을 이용한 유전자 발현 예측에 대한 성 능을 의미할 수 있다. 도 9a 및 도 9b의 PCC(A), PCC(M), MSE 및 MAE는 예측 성능 지표로서, PCC(A) 및 PCC (M)의 값이 클수록, MSE 및 MAE의 값이 작을수록 높은 성능을 의미할 수 있다. 9a 및 도 9b는 유방암 ST 데이터 세트를 이용한 성능 테스트로, 본 개시의 일 실시예에 따른 'SPREAD' 모델의 각 구성의 기여도를 나타낼 수 있다. 구체적으로, 도 9a는 각 구성이 제외된 모델의 예측 성능을 나타낼 수 있 다. 도 9a에서 제외되는 SPREAD의 구성은 글로벌 임베딩 모델('GEO'), 로컬 임베딩 모델('LEO') 및 SPREAD 모델 의 학습 방법 구성인 자기 증류 방식('SD')을 포함할 수 있다. 자기 증류 방식은 학습 단계에서 적용될 수 있으 며, 추론 단계에서도 최종 유전자 발현 예측 값을 산출하는데 적용될 수 있다. 도 9a에서 'No GEO'는 'SPREAD' 에서 글로벌 임베딩 모델을 제거한 모델을 나타내고, 'No LEO'는 'SPREAD'에서 로컬 임베딩 모델 및 자기 증류 방식을 제거한 모델을 나타내고, 'No SD'는 'SPREAD'에서 자기 증류 방식을 제거한 모델을 나타낼 수 있다. 도 9a를 참조하면, 자기 증류 방식을 적용하지 않는 경우에 예측 성능이 저하된다. 이러한 결과는 본 개시의 일 실시예에 따른 자기 증류 방식이 로컬-글로벌 정보의 통합과, 이중 임베디드 피쳐를 사용한 유전자 발현을 예측 하는데 크게 기여함을 나타낼 수 있다. 또한, 글로벌 임베딩 모델이 제외된 모델('No GEO'에서 성능 저하가 가 장 크게 나타난다. 또한, SPREAD 모델이 가장 큰 PCC 값 및 가장 작은 MSE 값을 가지므로, 도 9a는 SPREAD 모델 의 성능이 가장 우수함을 나타낼 수 있다. 도 9b는 각 위치 인코딩 방식에 따른 성능 차이를 나타낼 수 있다. 예를 들어, 도 9b는, 위치 인코딩을 수행하 지 않는 경우('No PEG'), PEG 방식으로 위치 인코딩을 수행하는 경우('PEG'), PPEG 방식으로 위치 인코딩을 수 행하는 경우('PPEG'), 표준 3X3 컨볼루션 커널만을 이용하는 PEGH 방식으로 위치 인코딩을 수행하는 경우 ('PEGH(SC)'), 변형 가능한 3X3 컨볼루션 커널만을 이용한 PEGH 방식으로 위치 인코딩을 수행하는 경우 ('PEGH(DC)'), 표준 3X3 컨볼루션 커널과 변형가능한 3X3 컨볼루션 커널을 모두 이용한 PEGH 방식으로 위치 인 코딩을 수행하는 경우('PEGH(SC+DC)')의 평균 PCC, 중간 PCC, MSE, MAE를 포함한다. 도 9b를 참조하면, PEGH를 적용한 모델의 예측 성능(도 9b의 'PEGH(SC)', 'PEGH(DC)', 'PEGH(SC+DC)')이 위치 인코딩을 수행하지 않는 모델 및 PEG 또는 PPEG 방식으로 위치 인코딩을 수행하는 모델의 예측 성능보다 우수하 다. 또한, 위치 인코딩을 수행하지 않는 모델의 성능이 PEG 또는 PPEG 방식으로 위치 인코딩을 수행하는 모델의 예측 성능과 비슷하거나 오히려 우수하다. 단순히 컨볼루션 연산을 수행하는 것만으로는 패치 간의 공간 정보를 포착하기 어려울 수 있다. 도 9b를 참조하면, 표준 3X3 컨볼루션 커널과 변형가능한 3X3 컨볼루션 커널을 모두 이용한 PEGH 방식으로 위치 인코딩을 수행하는 모델이 가장 높은 PCC 값을 가진다. 한편, 변형 가능한 3X3 컨볼루션 커널만을 이용한 PEGH 방식으로 위치 인코딩을 수행하는 모델이 가장 낮은 MSE 및 MAE 값을 가진다. 따라서, 임의적인 형태를 갖는 WSI를 처리하는 데 있어서, 변형 가능한 컨볼루션 커널을 활용하는 위치 인코딩 방식이 모델의 유전자 발현 예 측 성능을 향상 시킬 수 있다. 도 10은 본 개시의 일 실시예에 따른 전자 장치의 일례를 나타내는 블록도이다. 도 10에 도시된 전자 장치는, 인공지능 모델을 이용하여 조직학 이미지로부터 패치 단위의 유전자 발현을 예측하는 장치로, 사용자 단말 또는 서버 장치일 수 있다. 예를 들어, 전자 장치는 데스크탑 컴퓨터 (desktop computer), 랩탑 컴퓨터(laptop computer), 노트북(notebook), 스마트폰(smart phone), 태블릿 PC(tablet PC), 모바일폰(mobile phone), 스마트 워치(smart watch), 웨어러블 디바이스(wearable device), AR 디바이스(augmented reality device), VR 디바이스(virtual reality device) 등의 사용자 단말일 수 있다. 일 실시예에서, 조직학 이미지로부터 패치 단위의 유전자 발현을 예측하기 위한 인공지능 모델을 학습/업데이트 하는 전자 장치는, 인공지능 모델을 이용하여 예측/추론을 수행하는 전자 장치와 동일하거나, 상이한 사 용자 단말 또는 서버 장치일 수 있다. 예를 들어, 인공지능 모델을 학습/업데이트하는 전자 장치와 전자 장치 (즉, 추론 동작을 수행하는 전자 장치)가 상이한 경우, 전자 장치는 인공지능 모델을 학습/업데이 트하는 전자 장치로부터, 학습/업데이트된 인공지능 모델을 제공받을 수 있다. 전자 장치에 대하여 후술 하는 하나 이상의 실시예는, 조직학 이미지로부터 패치 단위의 유전자 발현을 예측하기 위한 인공지능 모델을 학습/업데이트하는 전자 장치에도 적용될 수 있다. 일 실시예에서, 인공지능 모델은 추론 동작이 수행됨에 따라, 업데이트될 수 있다. 예를 들어, 인공지능 모델을 업데이트하는 전자 장치와 전자 장치가 동일한 경우, 전자 장치는 인공지능 모델을 이용하여 예측/ 추론을 수행하며, 동시에 인공지능 모델을 업데이트할 수 있다. 예를 들어, 인공지능 모델을 업데이트하는 전자장치와 전자 장치가 상이한 경우, 인공지능 모델을 업데이트하는 전자 장치는, 전자 장치가 인공지 능 모델을 이용하여 예측/추론을 수행하며 식별/생성/산출한 데이터들을 수신하여, 수신된 데이터를 기초로 인 공지능 모델을 업데이트할 수 있다. 일 실시예에서, 전자 장치는 적어도 하나의 프로세서 및 메모리를 포함할 수 있으나, 이에 한정되지 않는다. 프로세서는 전자 장치에 포함된 구성들과 전기적으로 연결되어, 전자 장치(100 0)에 포함된 구성들의 제어 및/또는 통신에 관한 연산이나 데이터 처리를 실행할 수 있다. 일 실시예에서, 프로 세서는 다른 구성들 중 적어도 하나로부터 수신된 요청, 명령 또는 데이터를 메모리에 로드하여 처리하고, 처리 결과 데이터를 메모리에 저장할 수 있다. 다양한 실시예에 따르면, 프로세서는 CPU(central processing unit), AP(application processor), DSP(Digital Signal Processor) 등과 같은 범용 프로세서, GPU(graphic processing unit), VPU(Vision Processing Unit)와 같은 그래픽 전용 프로세서, 또는 NPU(neural processing unit)와 같은 인공지능 전용 프로세서 중 적어도 하나를 포함할 수 있다. 프로세서는, 메모리에 저장된 기 정의된 동작 규칙 또는 인공지능 모델(예: 뉴럴 네트워크 모델)에 따라, 입력 데이터를 처리하도록 제어할 수 있다. 프로세서가 인공지능 전용 프로세서인 경우, 인공지능 전용 프로세서는, 특정 인공지능 모델의 처리에 특화된 하드웨어 구조로 설계될 수 있다. 기 정의된 동작 규칙 또는 인공지능 모델은 학습을 통해 만들어진 것을 특징으로 할 수 있다. 여기서, 학습을 통해 만들어진다는 것은, 기본 인공지능 모델이 학습 알고리즘에 의하여 다수의 학습 데이터들을 이용하여 학습 됨으로써, 원하는 특성(또는, 목적)을 수행하도록 설정된 기 정의된 동작 규칙 또는 인공지능 모델이 만들어짐 을 의미할 수 있다. 이러한 학습은 본 개시에 따른 인공지능이 수행되는 기기 자체에서 이루어질 수도 있고, 별 도의 서버 및/또는 시스템을 통해 이루어 질 수도 있다. 학습 알고리즘의 예로는, 지도형 학습(supervised learning), 비지도형 학습(unsupervised learning), 준지도형 학습(semi-supervised learning) 또는 강화 학습 (reinforcement learning)이 있으나, 전술한 예에 한정되지 않는다. 메모리는 프로세서와 전기적으로 연결되고 전자 장치에 포함된 구성들의 동작과 관련된 하나 이상의 모듈, 적어도 하나의 학습 모델, 프로그램, 명령어 또는 데이터를 저장할 수 있다. 예를 들어, 메모리 는 프로세서의 처리 및 제어를 위한 하나 이상의 모듈, 학습 모델, 프로그램, 명령어 또는 데이터 를 저장할 수 있다. 메모리는 플래시 메모리 타입(flash memory type), 하드디스크 타입(hard disk type), 멀티미디어 카드 마이크로 타입(multimedia card micro type), 카드 타입의 메모리(예를 들어, SD 또는 XD 메모리 등), 램(RAM, Random Access Memory) SRAM(Static Random Access Memory), 롬(ROM, Read-Only Memory), EEPROM(Electrically Erasable Programmable Read-Only Memory), PROM(Programmable Read-Only Memory), 자기 메모리, 자기 디스크, 광디스크 중 적어도 하나의 타입의 저장매체를 포함할 수 있다. 일 실시예에서, 메모리는 전자 장치가 수신하거나 생성한 데이터, 정보를 저장할 수 있다. 예를 들 어, 메모리는 수신된 조직학 이미지, 인공지능 모델의 가중치 값 등을 저장할 수 있다. 예를 들어, 메모 리는 조직학 이미지(또는 패치)에 대한 유전자 발현 예측 결과 등을 저장할 수 있다. 예를 들어, 메모리 는 전자 장치가 수신하거나 생성한 데이터, 정보를 압축된 형태로 저장할 수 있다. 메모리에 포함된 모듈 또는 모델은, 프로세서의 제어 또는 명령에 따라 실행되며, 입력 데이터에 대한 출력 데이터를 도출하는 동작들을 수행하도록 구성된 프로그램, 모델 또는 알고리즘을 포함할 수 있다. 메 모리는 이미지 처리를 위한 적어도 하나의 뉴럴 네트워크 모델, 인공지능 모델, 기계학습 모델, 통계 모 델, 알고리즘 등을 포함할 수 있다. 일 실시예에서, 메모리는 조직학 이미지로부터 패치 단위의 유전자 발현을 예측/추론하는 인공지능 모델을 포함할 수 있다. 메모리는 인공지능 모델을 구성하는 복수의 파라 미터 값(가중치 값)을 포함할 수 있다. 인공지능 모델은, 복수의 신경망 레이어들로 구성될 수 있다. 복수의 신경망 레이어들 각각은 복수의 가중치들 (weight values)을 갖고 있으며, 이전(previous) 레이어의 연산 결과와 복수의 가중치들 간의 연산을 통해 신경 망 연산을 수행할 수 있다. 복수의 신경망 레이어들이 갖고 있는 복수의 가중치들은 인공지능 모델의 학습 결과 에 의해 최적화될 수 있다. 예를 들어, 학습 과정 동안 인공지능 모델에서 획득한 로스(loss) 값 또는 코스트 (cost) 값이 감소 또는 최소화되도록 복수의 가중치들이 갱신될 수 있다. 인공지능 모델은 심층 신경망(DNN: Deep Neural Network)를 포함할 수 있으며, 예를 들어, CNN(Convolutional Neural Network), LSTM(Long Short- Term Memory), DNN(Deep Neural Network), RNN(Recurrent Neural Network), RBM(Restricted Boltzmann Machine), DBN(Deep Belief Network), BRDNN(Bidirectional Recurrent Deep Neural Network), 트랜스포머 (Transformer)또는 심층 Q-네트워크(Deep Q-Networks) 등이 있으나, 이에 한정되지 않는다. 인공지능 모델은 통계 방법 모델을 포함할 수 있으며, 예를 들어, 로지스틱 회귀(logistic regression), GMM(Gaussian Mixture Model), SVM(Support Vector Machine), LDA(Latent Dirichlet Allocation), 또는 의사 결정 나무(decision tree) 등이 있으나, 이에 한정되지 않는다. 인공지능 모델은 하나 이상의 서브 모델로 구성될 수 있다. 예를 들어, 인공지능 모델은 기능, 출력 또는 구조 로 구분가능한 서브 모델을 포함할 수 있다. 일 실시예에서, 조직학 이미지로부터 유전자 발현을 예측하는 모델 은, 초기 피쳐 추출 모델, 글로벌 피쳐 추출 모델(즉, 글로벌 임베딩 모델), 로컬 피쳐 추출 모델(즉, 로컬 임 베딩 모델), 결합 예측 모델을 포함할 수 있다. 글로벌 피쳐 추출 모델은 하나 이상의 인코더(또는, 인코딩 모 델)과 위치 정보 인코더(또는, 위치 정보 인코딩 모델)을 포함할 수 있다. 예를 들어, 적어도 하나의 서브 모델 은 하나의 독립적인 인공지능 모델로서 개별적으로 학습되거나 추론을 수행할 수 있다. 예를 들어, 적어도 하나 의 서브 모델은 인공지능 모델을 구성하는 다른 서브 모델과 함께 학습되거나 추론을 수행할 수 있다. 전자 장치의 적어도 하나의 동작을 수행하는 일부 모듈은 하드웨어 모듈, 소프트웨어 모듈 및/또는 그 조 합으로 구현될 수 있다. 메모리는 상술한 전자 장치의 동작들 중 적어도 일부를 수행하는 소프트웨 어 모듈들을 포함할 수 있다. 일 실시예에서, 메모리에 포함된 모듈은 프로세서에 의해 실행됨으로 써, 동작을 수행할 수 있다. 예를 들어, 메모리에 포함된 모델은 모듈을 구성하거나, 모듈에 포함되거나, 모듈에 의해 실행되거나, 모듈 그 자체일 수 있다. 전자 장치의 모듈 중 적어도 일부는 복수의 서브 모듈 로 구성되거나, 하나의 모듈을 구성할 수 있다. 도 10을 참조하면, 전자 장치는 글로벌 피쳐 추출 모듈, 로컬 피쳐 추출 모듈 및 유전자 발 현 예측 모듈을 포함할 수 있으나, 이에 한정되지는 않는다. 예를 들어, 전자 장치는 글로벌 피쳐 추출 모듈, 로컬 피쳐 추출 모듈 및 유전자 발현 예측 모듈 중 일부만을 포함할 수 있다. 이 경우, 나머지 일부 모듈은 적어도 하나의 다른 전자 장치에 포함되고, 전자 장치와 다른 전자 장치는 서 로 유/무선으로 연결되거나 통신함으로써 시스템을 구성할 수 있다. 도 10에서, 글로벌 피쳐 추출 모듈, 로컬 피쳐 추출 모듈 및 유전자 발현 예측 모듈은 프로 세서 및 메모리와는 별도의 구성 요소로 도시되어 있으나, 이에 한정되지 않는다. 예를 들어, 글로 벌 피쳐 추출 모듈, 로컬 피쳐 추출 모듈 및 유전자 발현 예측 모듈 중 적어도 하나의 모듈 은 하드웨어 모듈로서 프로세서에 포함되거나, 별도의 하드웨어 모델일 수 있다. 예를 들어, 글로벌 피쳐 추출 모듈, 로컬 피쳐 추출 모듈 및 유전자 발현 예측 모듈 중 적어도 하나의 모듈은 소프트 웨어 모듈로서, 메모리에 포함될 수 있다. 예를 들어, 각 모듈의 소프트웨어 구성 요소는 메모리에 포함될 수 있다. 일 실시예에서, 글로벌 피쳐 추출 모듈은 조직학 이미지로부터 패치 단위의 글로벌 피쳐를 추출하는 모델 (즉, 글로벌 피쳐 추출 모델, 글로벌 임베딩 모델, 제1 인공지능 모델)을 포함할 수 있다. 일 실시예에서, 로컬 피쳐 추출 모듈은 조직학 이미지로부터 패치 단위의 로컬 피쳐를 추출하는 모델(즉, 로컬 피쳐 추출 모델, 로컬 임베딩 모델, 제2 인공지능 모델)을 포함할 수 있다. 일 실시예에서, 유전자 발현 예측 모듈 은 조직학 이미지의 패치 단위의 글로벌 피쳐 및 로컬 피쳐를 기초로, 패치 단위의 유전자 발현을 예측하는 모 델(예: 결합 예측 모델, 예측기, 제3 인공지능 모델)을 포함할 수 있다. 전자 장치는 도 10에 도시된 구성 요소들보다 더 많은 구성 요소들을 포함할 수 있다. 예를 들어, 전자 장치는, 외부 장치와의 통신을 위한 통신 인터페이스(또는 통신 모듈)을 더 포함할 수 있다. 예를 들어, 전자 장치는 입출력 장치 및/또는 입출력 인터페이스를 더 포함할 수 있다. 일례로, 전자 장치는 조직학 이미지를 생성하기 위한 카메라 센서 등을 더 포함할 수 있다. 도 1a 내지 도 10에서 중복되는 설명들은 생략된 것일 수 있으며, 도 1a 내지 도 10 각각에서 상술한 실시예들 은 서로 조합되어 적용/실시될 수 있다. 적어도 하나의 프로세서는 도 1a 내지 도 10에 개시된 적어도 하나의 실시예에 따라 전자 장치가 동작할 수 있도록 일련의 과정을 제어할 수 있다. 즉, 적어도 하나의 프로세서는 전자 장치의 각 구성이 동작할 수 있도록 제어할 수 있다. 일 실시예에서, 적어도 하나의 프로세서는 메모리에 저장된 하 나 이상의 명령어를 실행할 수 있다. 일 실시예에서, 적어도 하나의 프로세서는 하나 이상의 명령어를 실 행함으로써, 인공지능 모델을 이용하여 조직학 이미지로부터 패치 단위의 유전자 발현을 예측하기 위한 동작을 수행할 수 있다. 일 실시예에서, 상기 적어도 하나의 프로세서는 복수의 패치로 분할된 상기 조직학 이미지의 제1 패치, 상기 제 1 패치의 초기 피쳐 데이터 및 상기 조직학 이미지의 제2 패치의 초기 피쳐 데이터를 식별할 수 있다. 일 실시 예에서, 상기 적어도 하나의 프로세서는 제1 인공지능 모델을 이용하여, 상기 제1 패치의 초기 피쳐 데이터 및 상기 제2 패치의 초기 피쳐 데이터를 기반으로, 상기 제1 패치의 글로벌 피쳐 데이터를 추출할 수 있다. 일 실 시예에서, 상기 적어도 하나의 프로세서는 제2 인공지능 모델을 이용하여, 상기 제1 패치로부터 상기 제1 패치 의 로컬 피쳐 데이터를 추출할 수 있다. 일 실시예에서, 상기 적어도 하나의 프로세서는 제3 인공지능 모델을 이용하여, 상기 제1 패치의 글로벌 피쳐 데이터와 상기 제1 패치의 로컬 피쳐 데이터를 기반으로, 상기 제1 패 치에 대한 유전자 발현 값을 예측할 수 있다. 일 실시예에서, 상기 적어도 하나의 프로세서는 기 학습된 인공지능 모델을 이용하여 상기 제1 패치로부터 상기 제1 패치의 초기 피쳐 데이터를 추출하고, 상기 제2 패치로부터 상기 제2 패치의 초기 피쳐 데이터를 추출할 수 있다. 일 실시예에서, 상기 적어도 하나의 프로세서는 상기 제1 패치의 글로벌 피쳐 데이터와 상기 제1 패치의 로컬 피쳐 데이터를 연결함으로써, 상기 제1 패치의 로컬-글로벌 피쳐 데이터를 생성할 수 있다. 일 실시예에서, 상 기 적어도 하나의 프로세서는 상기 제3 인공지능 모델을 이용하여, 상기 제1 패치의 로컬-글로벌 피쳐 데이터를 기반으로 상기 제1 패치에 대한 유전자 발현 값을 예측할 수 있다. 일 실시예에서, 상기 적어도 하나의 프로세서는 상기 제2 인공지능 모델을 이용하여, 상기 제1 패치로부터 상기 제1 패치의 제1 로컬 피쳐 데이터 및 제2 로컬 피쳐 데이터를 추출할 수 있다. 일 실시예에서, 상기 적어도 하 나의 프로세서는 상기 제1 패치의 제1 로컬 피쳐 데이터와 상기 제1 패치의 글로벌 피쳐 데이터를 연결한 제1 로컬-글로벌 피쳐 데이터 및 상기 제1 패치의 제2 로컬 피쳐 데이터와 상기 제1 패치의 글로벌 피쳐 데이터를 연결한 제2 로컬-글로벌 피쳐 데이터를 생성할 수 있다. 일 실시예에서, 상기 적어도 하나의 프로세서는 상기 제3 인공지능 모델을 이용하여, 상기 제1 로컬-글로벌 피쳐 데이터를 기초로 상기 제1 패치에 대한 제1 유전자 발현 값을 예측하고, 상기 제2 로컬-글로벌 피쳐 데이터를 기초로 상기 제1 패치에 대한 제2 유전자 발현 값을 예측할 수 있다. 일 실시예에서, 상기 적어도 하나의 프로세서는 상기 제1 유전자 발현 값 및 상기 제2 유전자 발현 값 중 적어도 하나를 기초로, 상기 제1 패치에 대한 최종 유전자 발현 값을 결정할 수 있다. 일 실시예에서, 상기 제2 인공지능 모델은, 순차적으로 연결된 복수의 레이어를 포함할 수 있다. 일 실시예에서, 상기 제1 로컬 피쳐 데이터는, 상기 복수의 레이어 중 심층 레이어의 출력 데이터일 수 있다. 일 실시예에서, 상기 제2 로컬 피쳐 데이터는, 상기 복수의 레이어 중 상기 심층 레이어가 아닌 다른 레이어의 출 력 데이터를 기초로 생성된 데이터일 수 있다. 일 실시예에서, 상기 제1 인공지능 모델은, 상기 조직학 이미지에서의 패치 위치 정보를 인코딩하는 위치 정보 인코더를 포함할 수 있다. 일 실시예에서, 상기 적어도 하나의 프로세서는 상기 위치 정보 인코더를 이용하여, 상기 제1 패치의 위치 정보가 인코딩된 상기 제1 패치의 글로벌 피쳐 데이터를 추출할 수 있다. 일 실시예에서, 상기 적어도 하나의 프로세서는 상기 제1 패치의 초기 피쳐 데이터 및 상기 제2 패치의 초기 피 쳐 데이터를 기초로, 셀프 어텐션 연산을 수행할 수 있다. 일 실시예에서, 상기 적어도 하나의 프로세서는 상기 제1 패치의 위치 정보 및 상기 제2 패치의 위치 정보를 기초로, 상기 셀프 어텐션 연산의 결과 데이터에 대하여 컨볼루션 연산을 수행할 수 있다. 일 실시예에서, 상기 적어도 하나의 프로세서는 상기 제1 패치의 위치 정보 및 상기 제2 패치의 위치 정보를 기초로, 상기 셀프 어텐션 연산의 결과 데이터에 대하여 변형 가능한 컨볼루션 연산을 수행할 수 있다. 일 실시예에서, 상기 적어도 하나의 프로세서는 상기 컨볼루션 연산의 결과 데이터 및 상기 변형 가능한 컨볼루션 연산의 결과 데이터를 기초로, 상기 제1 패치의 위치 정보가 인코딩된 상기 제1 패 치의 글로벌 피쳐 데이터를 추출할 수 있다. 본 개시의 일 실시예에 따른 인공지능 모델을 이용하여 조직학 이미지로부터 패치 단위의 유전자 발현을 예측하 는 방법은 전자 장치에 의해 수행될 수 있다. 일 실시예에서, 상기 방법은 복수의 패치로 분할된 상기 조직학 이미지의 제1 패치, 상기 제1 패치의 초기 피쳐 데이터 및 상기 조직학 이미지의 제2 패치의 초기 피쳐 데이터 를 식별하는 단계를 포함할 수 있다. 일 실시예에서, 상기 방법은 제1 인공지능 모델을 이용하여, 상기 제1 패 치의 초기 피쳐 데이터 및 상기 제2 패치의 초기 피쳐 데이터를 기반으로, 상기 제1 패치의 글로벌 피쳐 데이터 를 추출하는 단계를 포함할 수 있다. 일 실시예에서, 상기 방법은 제2 인공지능 모델을 이용하여, 상기 제1 패 치로부터 상기 제1 패치의 로컬 피쳐 데이터를 추출하는 단계를 포함할 수 있다. 일 실시예에서, 상기 방법은 제3 인공지능 모델을 이용하여, 상기 제1 패치의 글로벌 피쳐 데이터와 상기 제1 패치의 로컬 피쳐 데이터를 기 반으로, 상기 제1 패치에 대한 유전자 발현 값을 예측하는 단계를 포함할 수 있다.일 실시예에서, 상기 복수의 패치로 분할된 상기 조직학 이미지의 제1 패치, 상기 제1 패치의 초기 피쳐 데이터 및 상기 조직학 이미지의 제2 패치의 초기 피쳐 데이터를 식별하는 단계는, 기 학습된 인공지능 모델을 이용하 여 상기 제1 패치로부터 상기 제1 패치의 초기 피쳐 데이터를 추출하고, 상기 제2 패치로부터 상기 제2 패치의 초기 피쳐 데이터를 추출하는 단계를 포함할 수 있다. 일 실시예에서, 상기 제1 패치에 대한 유전자 발현 값을 예측하는 단계는, 상기 제1 패치의 글로벌 피쳐 데이터 와 상기 제1 패치의 로컬 피쳐 데이터를 연결함으로써, 상기 제1 패치의 로컬-글로벌 피쳐 데이터를 생성하는 단계를 포함할 수 있다. 일 실시예에서, 상기 제1 패치에 대한 유전자 발현 값을 예측하는 단계는, 상기 제3 인 공지능 모델을 이용하여, 상기 제1 패치의 로컬-글로벌 피쳐 데이터를 기반으로 상기 제1 패치에 대한 유전자 발현 값을 예측하는 단계를 포함할 수 있다. 일 실시예에서, 상기 제2 인공지능 모델을 이용하여, 상기 제1 패치로부터 상기 제1 패치의 로컬 피쳐 데이터를 추출하는 단계는, 상기 제2 인공지능 모델을 이용하여, 상기 제1 패치로부터 상기 제1 패치의 제1 로컬 피쳐 데 이터 및 제2 로컬 피쳐 데이터를 추출하는 단계를 포함할 수 있다. 일 실시예에서, 상기 제1 패치에 대한 유전 자 발현 값을 예측하는 단계는, 상기 제1 패치의 제1 로컬 피쳐 데이터와 상기 제1 패치의 글로벌 피쳐 데이터 를 연결한 제1 로컬-글로벌 피쳐 데이터 및 상기 제1 패치의 제2 로컬 피쳐 데이터와 상기 제1 패치의 글로벌 피쳐 데이터를 연결한 제2 로컬-글로벌 피쳐 데이터를 생성하는 단계를 포함할 수 있다. 일 실시예에서, 상기 제1 패치에 대한 유전자 발현 값을 예측하는 단계는, 상기 제3 인공지능 모델을 이용하여, 상기 제1 로컬-글로 벌 피쳐 데이터를 기초로 상기 제1 패치에 대한 제1 유전자 발현 값을 예측하고, 상기 제2 로컬-글로벌 피쳐 데 이터를 기초로 상기 제1 패치에 대한 제2 유전자 발현 값을 예측하는 단계를 포함할 수 있다. 일 실시예에서, 상기 제1 패치에 대한 유전자 발현 값을 예측하는 단계는, 상기 제1 유전자 발현 값 및 상기 제2 유전자 발현 값 중 적어도 하나를 기초로, 상기 제1 패치에 대한 최종 유전자 발현 값을 결정하는 단계를 포함할 수 있다. 일 실시예에서, 상기 제2 인공지능 모델은, 순차적으로 연결된 복수의 레이어를 포함할 수 있다. 일 실시예에서, 상기 제1 로컬 피쳐 데이터는, 상기 복수의 레이어 중 심층 레이어의 출력 데이터일 수 있다. 일 실시예에서, 상기 제2 로컬 피쳐 데이터는, 상기 복수의 레이어 중 상기 심층 레이어가 아닌 다른 레이어의 출 력 데이터를 기초로 생성된 데이터일 수 있다. 일 실시예에서, 상기 제1 인공지능 모델은 상기 조직학 이미지에서의 패치 위치 정보를 인코딩하는 위치 정보 인코더를 포함할 수 있다. 일 실시예에서, 상기 제1 인공지능 모델을 이용하여, 상기 제1 패치의 초기 피쳐 데 이터 및 상기 제2 패치의 초기 피쳐 데이터를 기반으로, 상기 제1 패치의 글로벌 피쳐 데이터를 추출하는 단계 는, 상기 위치 정보 인코더를 이용하여, 상기 제1 패치의 위치 정보가 인코딩된 상기 제1 패치의 글로벌 피쳐 데이터를 추출하는 단계를 포함할 수 있다. 일 실시예에서, 상기 위치 정보 인코더를 이용하여, 상기 제1 패치의 위치 정보가 인코딩된 상기 제1 패치의 글 로벌 피쳐 데이터를 추출하는 단계는, 상기 제1 패치의 초기 피쳐 데이터 및 상기 제2 패치의 초기 피쳐 데이터 를 기초로, 셀프 어텐션 연산을 수행하는 단계를 포함할 수 있다. 일 실시예에서, 상기 위치 정보 인코더를 이 용하여, 상기 제1 패치의 위치 정보가 인코딩된 상기 제1 패치의 글로벌 피쳐 데이터를 추출하는 단계는, 상기 제1 패치의 위치 정보 및 상기 제2 패치의 위치 정보를 기초로, 상기 셀프 어텐션 연산의 결과 데이터에 대하여 컨볼루션 연산을 수행하는 단계를 포함할 수 있다. 일 실시예에서, 상기 위치 정보 인코더를 이용하여, 상기 제 1 패치의 위치 정보가 인코딩된 상기 제1 패치의 글로벌 피쳐 데이터를 추출하는 단계는, 상기 제1 패치의 위치 정보 및 상기 제2 패치의 위치 정보를 기초로, 상기 셀프 어텐션 연산의 결과 데이터에 대하여 변형 가능한 컨 볼루션 연산을 수행하는 단계를 포함할 수 있다. 일 실시예에서, 상기 위치 정보 인코더를 이용하여, 상기 제1 패치의 위치 정보가 인코딩된 상기 제1 패치의 글로벌 피쳐 데이터를 추출하는 단계는, 상기 컨볼루션 연산의 결과 데이터 및 상기 변형 가능한 컨볼루션 연산의 결과 데이터를 기초로, 상기 제1 패치의 위치 정보가 인코딩 된 상기 제1 패치의 글로벌 피쳐 데이터를 추출하는 단계를 포함할 수 있다. 일 실시예에서, 상기 제1 인공지능 모델, 상기 제2 인공지능 모델 및 상기 제3 인공지능 모델은, 엔드 투 엔드 (end-to-end)로 연결되어 동시에 학습될 수 있다. 일 실시예에서, 상기 제1 인공지능 모델, 상기 제2 인공지능 모델 및 상기 제3 인공지능 모델은, 학습 이미지에 포함된 타겟 패치에 대하여 예측되는 유전자 발현 값과 상기 타겟 패치에 대한 정답 유전자 발현 값 사이의 차 이를 기반으로 하는 손실 함수를 이용하여 학습될 수 있다. 일 실시예에서, 상기 제1 인공지능 모델, 상기 제2 인공지능 모델 및 상기 제3 인공지능 모델은, 학습 이미지에 포함된 타겟 패치에 대한 제1 로컬-글로벌 피쳐 데이터와 상기 타겟 패치에 대한 제2 로컬-글로벌 피쳐 데이터 사이의 차이를 기반으로 하는 손실 함수를 이용하여 학습될 수 있다. 일 실시예에서, 상기 타겟 패치에 대한 제 1 로컬-글로벌 피쳐 데이터는, 상기 타겟 패치에 대한 상기 제2 인공지능 모델의 심층 레이어의 출력 데이터인 상기 타겟 패치의 제1 로컬 피쳐 데이터와 상기 타겟 패치의 글로벌 피쳐 데이터를 연결함으로써 생성될 수 있 다. 일 실시예에서, 상기 타겟 패치에 대한 제2 로컬-글로벌 피쳐 데이터는, 상기 타겟 패치에 대한 상기 제2 인공지능 모델의 상기 심층 레이어가 아닌 다른 레이어의 출력 데이터를 기반으로 하는 상기 타겟 패치의 제2 로컬 피쳐 데이터와 상기 타겟 패치의 글로벌 피쳐 데이터를 연결함으로써 생성될 수 있다. 일 실시예에서, 상기 제1 인공지능 모델, 상기 제2 인공지능 모델 및 상기 제3 인공지능 모델은, 학습 이미지에 포함된 타겟 패치에 대한 제1 유전자 발현 값 및 상기 타겟 패치에 대한 제2 유전자 발현 값 사이의 차이를 기 반으로 하는 손실 함수를 이용하여 학습될 수 있다. 일 실시예에서, 상기 타겟 패치에 대한 제1 유전자 발현 값 은, 상기 타겟 패치에 대한 상기 제2 인공지능 모델의 심층 레이어의 출력 데이터를 기초로 예측될 수 있다. 일 실시예에서, 상기 타겟 패치에 대한 제2 유전자 발현 값은, 상기 타겟 패치에 대한 상기 제2 인공지능 모델의 상기 심층 레이어가 아닌 다른 레이어의 출력 데이터를 기초로 예측될 수 있다. 본 개시의 일 실시예에 따른 인공지능 모델을 이용하여 조직학 이미지로부터 패치 단위의 유전자 발현을 예측하 는 방법을 컴퓨터에서 수행하기 위한 프로그램은 컴퓨터로 읽을 수 있는 기록 매체에 기록될 수 있다. 기기로 읽을 수 있는 저장매체는, 비일시적(non-transitory) 저장매체의 형태로 제공될 수 있다. 여기서, ‘비 일시적 저장매체'는 실재(tangible)하는 장치이고, 신호(signal)(예: 전자기파)를 포함하지 않는다는 것을 의미 할 뿐이며, 이 용어는 데이터가 저장매체에 반영구적으로 저장되는 경우와 임시적으로 저장되는 경우를 구분하 지 않는다. 예로, '비일시적 저장매체'는 데이터가 임시적으로 저장되는 버퍼를 포함할 수 있다. 일 실시예에 따르면, 본 문서에 개시된 다양한 실시예들에 따른 방법은 컴퓨터 프로그램 제품(computer program product)에 포함되어 제공될 수 있다. 컴퓨터 프로그램 제품은 상품으로서 판매자 및 구매자 간에 거래될 수 있 다. 컴퓨터 프로그램 제품은 기기로 읽을 수 있는 저장 매체(예: compact disc read only memory (CD-ROM))의 형태로 배포되거나, 또는 어플리케이션 스토어를 통해 또는 두개의 사용자 장치들(예: 스마트폰들) 간에 직접, 온라인으로 배포(예: 다운로드 또는 업로드)될 수 있다. 온라인 배포의 경우에, 컴퓨터 프로그램 제품(예: 다운 로더블 앱(downloadable app))의 적어도 일부는 제조사의 서버, 어플리케이션 스토어의 서버, 또는 중계 서버의 메모리와 같은 기기로 읽을 수 있는 저장 매체에 적어도 일시 저장되거나, 임시적으로 생성될 수 있다."}
{"patent_id": "10-2023-0136981", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1a 내지 도 1c는 본 개시의 일 실시예에 따른 조직학 이미지로부터 패치 단위의 유전자 발현을 예측하는 예 시를 나타내는 도면이다. 도 2는 본 개시의 일 실시예에 따른 전자 장치가 인공지능 모델을 이용하여 조직학 이미지로부터 패치 단위의 유전자 발현을 예측하는 방법을 나타내는 흐름도이다. 도 3은 본 개시의 일 실시예에 따른 조직학 이미지로부터 패치 단위의 유전자 발현을 예측하는 모델의 일례를나타내는 도면이다. 도 4는 본 개시의 일 실시예에 따라 조직학 이미지에서의 패치의 위치 정보를 인코딩하는 예시를 나타내는 도면 이다. 도 5는 본 개시의 일 실시예에 따른 조직학 이미지에서의 패치의 위치 정보를 인코딩하는 예시를 나타내는 도면 이다. 도 6은 본 개시의 일 실시예에 따른 조직학 이미지로부터 패치 단위의 GNAS 유전자 발현 예측 결과와 GNAS 유전 자 발현 정답의 일례를 나타내는 도면이다. 도 7a 내지 7f는 본 개시의 일 실시예에 따른 인공지능 모델의 유전자 발현을 예측하는 성능을 정량적으로 나타 내는 도면이다. 도 8a 및 8b는 본 개시의 일 실시예에 따른 인공지능 모델의 예측 성능을 정성적으로 나타내는 도면이다. 도 9a 및 9b는 본 개시의 일 실시예에 따른 인공지능 모델의 각 구성의 성능 기여를 나타내는 도면이다. 도 10은 본 개시의 일 실시예에 따른 전자 장치의 일례를 나타내는 블록도이다."}
