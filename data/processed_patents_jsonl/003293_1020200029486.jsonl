{"patent_id": "10-2020-0029486", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2021-0114169", "출원번호": "10-2020-0029486", "발명의 명칭": "객체검증을 이용한 모니터링 영상 분석 방법 및 이를 위한 장치", "출원인": "한국전자통신연구원", "발명자": "이승익"}}
{"patent_id": "10-2020-0029486", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "모니터링 영상의 영상 프레임을 추출하여 입력 프레임을 생성하는 단계;상기 입력 프레임으로부터 관심객체의 이미지가 포함된 복수개의 이미지 패치들을 생성하는 단계;상기 복수개의 이미지 패치들 중 적어도 하나 이상의 객체 중심 이미지 패치를 선택하는 단계;상기 객체 중심 이미지 패치를 기반으로 선택된 정상 상황 이미지 패치를 이용하여 생성형 신경망을 학습하는단계;상기 객체 중심 이미지 패치를 상기 생성형 신경망에 입력하여 생성된 재생성 이미지와 상기 객체 중심 이미지패치를 비교하여 이상 점수를 산출하는 단계; 및상기 이상 점수와 임계값을 비교하여 이상신호를 생성하는 단계를 포함하는, 객체검증을 이용한 모니터링 영상분석 방법."}
{"patent_id": "10-2020-0029486", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "기재된 실시예는 모니터링 영상의 영상 프레임을 추출하여 입력 프레임을 생성하는 단계; 상기 입력 프레임으로 부터 관심객체의 이미지가 포함된 복수개의 이미지 패치들을 생성하는 단계; 상기 복수개의 이미지 패치들 중 적 어도 하나 이상의 객체 중심 이미지 패치를 선택하는 단계; 상기 객체 중심 이미지 패치를 기반으로 선택된 정상 상황 이미지 패치를 이용하여 생성형 신경망을 학습하는 단계; 상기 객체 중심 이미지 패치를 상기 생성형 신경 망에 입력하여 생성된 재생성 이미지와 상기 객체 중심 이미지 패치를 비교하여 이상 점수를 산출하는 단계; 및 상기 이상 점수와 임계값을 비교하여 이상신호를 생성하는 단계를 포함하는, 객체검증을 이용한 모니터링 영상 분석 방법에 관한 것이다."}
{"patent_id": "10-2020-0029486", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 모니터링 영상 분석 방법에 관한 것으로, 감시 지역의 모니터링 영상으로부터 이상 상황을 감지하는 기술에 관한 것이다."}
{"patent_id": "10-2020-0029486", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "기존의 이상 감지 기술들은 영상에서 관심객체의 추출과 이벤트 발생 탐지를 위해 프레임 전체를 이용하는 방법 또는 그리드 추출 혹은 객체 검출기 등을 이용해 이미지 패치(Image patch)를 이용하는 방법을 사용하고 있다. 한국공개특허 제 10-2019-0079110호는 자가 학습 기반의 모니터링 영상 분석 장치 및 방법을 개시하고 있다. 상 기 장치 및 방법은 촬영된 영상의 프레임을 누적하고 프레임을 추출한다. 추출된 프레임을 오토인코더에 적용하 여 출력되는 오차를 이용하여 이상을 감지한다. 즉, 이상 감지를 위한 데이터로 프레임 전체를 시간에 따라 누 적하여 이를 인공지능의 입력으로 이용한다. 그러나 상기 선행특허의 경우 프레임 전체를 사용하기 때문에 모션 추출이나 분할(Segmentation)이 적절히 이루어지지 않는다면 실제 객체보다 배경이 지배적인 영향을 끼치는 문 제가 있다. 이러한 문제를 해결하기 위하여 실제 관심 대상만을 추출한 이미지 패치를 이용하기도 한다. 그러나 이와 같이 추출한 이미지 패치는 항상 온전한 객체를 포함하지는 못한다. 이때 잘못된 객체 검출은 시스템의 오경보를 유 발하고 정확도를 떨어트린다. 한국등록특허 제 10-1980551호는 기계학습 객체 검출을 이용한 실시간 지능형 CCTV 영상 분석 행위 탐지 시스템 및 방법을 개시하고 있다. 상기 시스템 및 방법은 영상프레임에서 사전에 기 입력된 기준설정객체와 매칭되는 객체를 검출하고, 기 입력된 객체 행동과 매칭되는 위험행동객체를 검출한다. 이 기술의 경우 해당 이미지 패치 가 온전한 객체를 포함하는지 확인하는 과정이 없기 때문에 잘못된 객체를 검출하였을 경우, 잘못된 이상 감지 로 이어질 수 있다는 문제점이 있다. 따라서 위 종래 기술들이 가지는 문제점을 해결하고 이상 검출의 정확도를 높인 이상 상황을 감지하는 기술의 필요성이 대두된다."}
{"patent_id": "10-2020-0029486", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명의 목적은 객체검증을 이용한 모니터링 영상 분석 방법 및 그 장치를제공함으로써 촬영된 영상에서 객체 중심의 이미지 패치를 추출하고 객체검증을 통해 선별된 데이터를 이용하여 오경보율을 낮추고 이상 검출의 정 확도를 높인 이상 감지 시스템을 제공함에 있다. 또한 이상 검출을 위해 생성형 신경망 학습을 이용함으로써 이상검출의 정확도를 더 높인 이상 감지 시스템을 제공함에 있다."}
{"patent_id": "10-2020-0029486", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "실시예에 따른 객체검증을 이용한 모니터링 영상 분석 방법은, 모니터링 영상의 영상 프레임을 추출하여 입력 프레임을 생성하는 단계; 상기 입력 프레임으로부터 관심객체의 이미지가 포함된 복수개의 이미지 패치들을 생 성하는 단계; 상기 복수개의 이미지 패치들 중 적어도 하나 이상의 객체 중심 이미지 패치를 선택하는 단계; 상 기 객체 중심 이미지 패치를 기반으로 선택된 정상 상황 이미지 패치를 이용하여 생성형 신경망을 학습하는 단 계; 상기 객체 중심 이미지 패치를 상기 생성형 신경망에 입력하여 생성된 재생성 이미지와 상기 객체 중심 이 미지 패치를 비교하여 이상 점수를 산출하는 단계; 및 상기 이상 점수와 임계값을 비교하여 이상신호를 생성하 는 단계를 포함한다. 상기 이미지 패치들을 생성하는 단계는 상기 입력 프레임으로부터 관심객체를 추출하는 단계; 상기 입력 프레임 으로부터 상기 관심객체의 이미지가 포함된 복수개의 이미지 패치를 생성하는 단계를 포함할 수 있다. 상기 객체 중심 이미지 패치는 상기 복수개의 이미지 패치들 중 상기 관심 객체의 이미지가 가장 온전히 포함된 것일 수 있다. 상기 생성형 신경망을 학습하는 단계는 상기 객체 중심 이미지 패치 중 정상 상황을 나타내는 정상 이미지 패치 를 적어도 하나 이상 선택하는 단계; 상기 정상 이미지 패치를 이용하여 생성형 신경망을 학습하는 단계; 학습 된 생성형 신경망을 저장하는 단계를 포함할 수 있다. 상기 이상 점수를 산출하는 단계는 상기 객체 중심 이미지 패치를 상기 학습된 생성형 신경망을 이용하여 재생 성 이미지를 생성하는 단계; 상기 객체 중심 이미지 패치를 상기 재생성 이미지와 비교하여 차이값을 계산하는 단계; 상기 복수개의 객체 중심 이미지 패치에 대하여 상기 차이값을 수집하는 단계를 포함하고, 수집한 차이값 을 종합하여 개별 이상 점수를 계산하는 것일 수 있다. 상기 이상 점수를 산출하는 단계는 복수의 관심객체에 대하여 상기 개별 이상 점수를 수집하는 단계를 더 포함 하고, 상기 개별 이상 점수 중 가장 큰 점수를 상기 입력 프레임에 대한 이상 점수로 정하는 것일 수 있다. 상기 관심객체는 기 정의된 객체 집합에 대한 이미지 비교 탐색 알고리즘 또는 객체 탐지용 인공지능 알고리즘 을 이용하여 얻는 것일 수 있다. 상기 입력 프레임을 생성하는 단계는 상기 입력 프레임으로부터 모션 지도를 생성하는 단계를 포함하고, 상기 이미지 패치들을 생성하는 단계는 상기 모션 지도에 기반하여 움직임이 큰 지역을 관심영역으로 생성하는 단계; 상기 관심객체와 상기 관심영역간의 거리에 기반하여 상기 이미지 패치를 생성하는 단계를 포함할 수 있다. 상기 이상신호를 생성하는 단계는 상기 이상신호에 기반하여 사용자에게 경고음 또는 알림 메시지를 발생하는 단계를 포함할 수 있다. 실시예에 따른 객체검증을 이용한 모니터링 영상 분석 장치는 모니터링 영상의 영상 프레임을 추출하여 입력 프 레임을 생성하는 프레임전처리부; 상기 입력 프레임으로부터 관심객체의 이미지가 포함된 복수개의 이미지 패치 들을 생성하는 객체탐지부; 상기 복수개의 이미지 패치들 중 적어도 하나 이상의 객체 중심 이미지 패치를 선택 하는 객체검증부; 상기 객체 중심 이미지 패치를 기반으로 선택된 정상 상황 이미지 패치를 이용하여 생성형 신 경망을 학습하는 모델학습부; 상기 객체 중심 이미지 패치를 상기 생성형 신경망에 입력하여 생성된 재생성 이 미지와 상기 객체 중심 이미지 패치를 비교하여 이상 점수를 산출하는 이상점수산출부; 및 상기 이상 점수와 임 계값을 비교하여 이상신호를 생성하는 이상검출부를 포함한다."}
{"patent_id": "10-2020-0029486", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명에 따르면 객체검증을 이용한 모니터링 영상 분석 방법 및 그 장치를제공함으로써 촬영된 영상에서 객체 중심의 이미지 패치를 추출하고 객체검증을 통해 선별된 데이터를 이용하여 오경보율을 낮추고 이상 검출의 정 확도를 높인 이상 감지 시스템을 제공할 수 있다. 또한 이상 검출을 위해 생성형 신경망 학습을 이용함으로써 이상검출의 정확도를 더 높인 이상 감지 시스템을 제공할 수 있다."}
{"patent_id": "10-2020-0029486", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "본 발명의 이점 및 특징, 그리고 그것들을 달성하는 방법은 첨부되는 도면과 함께 상세하게 후술되어 있는 실시 예들을 참조하면 명확해질 것이다. 그러나 본 발명은 이하에서 개시되는 실시예들에 한정되는 것이 아니라 서 로 다른 다양한 형태로 구현될 것이며, 단지 본 실시예들은 본 발명의 개시가 완전하도록 하며, 본 발명이 속하"}
{"patent_id": "10-2020-0029486", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "는 기술분야에서 통상의 지식을 가진 자에게 발명의 범주를 완전하게 알려주기 위해 제공되는 것이며, 본 발명 은 청구항의 범주에 의해 정의될 뿐이다. 명세서 전체에 걸쳐 동일 참조 부호는 동일 구성 요소를 지칭한다. 비록 \"제1\" 또는 \"제2\" 등이 다양한 구성요소를 서술하기 위해서 사용되나, 이러한 구성요소는 상기와 같은 용 어에 의해 제한되지 않는다. 상기와 같은 용어는 단지 하나의 구성요소를 다른 구성요소와 구별하기 위하여 사 용될 수 있다. 따라서, 이하에서 언급되는 제1 구성요소는 본 발명의 기술적 사상 내에서 제2 구성요소일 수도 있다. 본 명세서에서 사용된 용어는 실시예를 설명하기 위한 것이며 본 발명을 제한하고자 하는 것은 아니다. 본 명세 서에서, 단수형은 문구에서 특별히 언급하지 않는 한 복수형도 포함한다. 명세서에서 사용되는 \"포함한다 (comprises)\" 또는 \"포함하는(comprising)\"은 언급된 구성요소 또는 단계가 하나 이상의 다른 구성요소 또는 단 계의 존재 또는 추가를 배제하지 않는다는 의미를 내포한다."}
{"patent_id": "10-2020-0029486", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "다른 정의가 없다면, 본 명세서에서 사용되는 모든 용어는 본 발명이 속하는 기술분야에서 통상의 지식을 가진 자에게 공통적으로 이해될 수 있는 의미로 해석될 수 있다. 또한, 일반적으로 사용되는 사전에 정의되어 있는 용어들은 명백하게 특별히 정의되어 있지 않는 한 이상적으로 또는 과도하게 해석되지 않는다. 이하에서는, 도 1 내지 도 5를 참조하여 실시예에 따른 객체검증을 이용한 모니터링 영상 분석 방법 및 장치가 상세히 설명된다. 도 1은 실시예에 따른 객체검증을 이용한 모니터링 영상 분석 장치의 일 예를 나타낸 블록도이다. 도 1을 참조하면, 객체검증을 이용한 모니터링 영상 분석 장치는 영상 촬영부, 객체 중심 이미지 생성부 , 모델 학습부, 이상점수 산출부, 이상 검출부를 포함한다. 영상 촬영부는 감시 대상 영역에 대한 영상을 수집한다. 객체 중심 이미지 생성부는 영상촬영부(11 0)에서 수집한 영상으로부터 객체 중심 이미지를 생성한다. 모델 학습부는 상기 객체 중심 이미지 중 정상 상황 이미지를 이용해 생성형 신경망을 학습한다. 이상점수 산출부는 상기 객체 중심 이미지로부터 이상점 수를 산출한다. 이상 검출부는 상기 이상 점수에 따라 이상 신호를 생성하는 동작을 수행한다. 구체적으로 각 구성의 동작을 설명하면 다음과 같다. 영상 촬영부는 고정형 CCTV와 같은 영상촬영 장치로 감시 대상 영역에대한 비디오 영상을 수집한다. 객체 중심 이미지 생성부는 우선 영상 촬영부에서 수집한 영상으로부터 모니터링 영상의 영상 프레임 을 추출하여 입력 프레임을 생성한다. 또한 상기 입력 프레임으로부터 관심객체의 이미지가 포함된 복수개의 이 미지 패치들을 생성한다. 그리고 상기 복수개의 이미지 패치들 중 적어도 하나 이상의 객체 중심 이미지 패치를 선택하는 동작을 수행한다. 상기 입력 프레임을 생성할 때 입력 프레임을 생성하는 추출 프레임률(Frame Per Second = FPS)은 사용자나 응 용이 요구하는 정확도에 따라 달리 정할 수 있는데, 일반적으로 10 FPS 정도의 추출 프레임률을 사용함이 적당하다. 그리고 상기 입력 프레임을 생성하는 과정에서 상기 입력 프레임으로부터 모션 지도를 생성하는 동작을 추가할 수 있다. 그리고 상기 모션 지도로부터 얻은 정보를 이후 이미지 패치를 생성하는 데 이용할 수 있다. 이 때 모 션 지도는 연속적인 프레임의 차이(Frame Subtraction), 광학 흐름(Optical Flow), 배경 제거(Background Subtraction) 등의 기법을 통해 생성할 수 있다. 객체 중심 이미지 생성부는 상기 입력 프레임으로부터 관심객체의 이미지가 포함된 복수개의 이미지 패치 들을 생성한다. 이때 상기 복수개의 이미지 패치들을 생성하는 동작은 상기 입력 프레임으로부터 관심객체를 추 출하고, 상기 입력 프레임으로부터 상기 관심객체의 이미지가 포함된 복수개의 이미지 패치를 생성하는 동작을 포함할 수 있다. 우선 상기 관심객체를 추출하는 동작은 사전 정의 된 객체집합에 대한 이미지 비교 탐색 알고리즘이나 SSD(Single-Shot Detector), YOLO(You Only Look Once)등과 같은 객체 탐지용 딥러닝망을 이용하여 수행할 수 있다. 이렇게 하여 관심객체의 위치와 종류를 검출한다. 검출된 관심객체들은 각 관심객체마다 관심객체의 위치를 중심으로 일정한 크기의 바운딩 박스내의 이미지를 추 출하여 이미지 패치를 생성할 수 있다. 이미지 패치를 생성할 때 가로와 세로의 비율이 1:1로 같은 바운딩 박스 뿐만 아니라 가로 세로의 비율이 2:1, 2:2, 1.5: 0.8 등으로 다른 바운딩 박스를 사용할 수도 있다. 또한 이미지 패치를 생성하는 과정에서 앞서 생성된 모션 지도의 정보를 이용할 수 있다. 상기 모션 지도에서 해당 입력 프레임 내의 움직임이 큰 지역을 관심 영역(Region of Interest)으로 정한다. 관심객체의 위치와 상 기 관심 영역의 거리 차를 오프셋으로 하여 상기 바운딩 박스의 위치를 상하좌우로 움직이거나 상기 관심객체의 위치에서 관심영역 방향으로 이동할 수도 있다. 각 관심객체마다 복수개의 이미지 패치들이 생성되면, 상기 복수개의 이미지 패치들 중 상기 관심 객체의 이미 지가 가장 온전히 포함된 이미지 패치를 객체 중심 이미지 패치로 선택하고, 상기 객체 중심 이미지 패치는 적 어도 하나 이상 선택할 수 있다. 상기 객체 중심 이미지 패치를 선택하는 동작은 관심객체의 집합을 사전 정의하여 이미지 패치와 대조하는 알고 리즘이나 이미지 분류를 위해 사전학습된 딥러닝망(Image Classifier)을 이용할 수 있는데, 실제 이미지 패치 내에 해당 관심객체가 있는지, 분류가 정확한지 등을 확인할 수 있다. 예를 들어 딥러닝망을 사용하여 객체 중심 이미지 패치를 선택하는 경우, 입력 이미지가 주어질 때 결과물로써 특정 클래스에 현재 이미지가 속할 확률이 나온다. 이 확률로부터 분류 신뢰도(Classification Confidence)가 높은, 즉 실제 검출 클래스에 속할 확률이 높은 이미지 패치들을 객체 중심 이미지 패치로 선별할 수 있다. 그리고 이렇게 선별된 객체 중심 이미지 패치들은 이상 검출을 위한 모델의 학습과 이상 검출에 이용할 수 있다. 모델 학습부는 상기 객체 중심 이미지 패치 중 정상 상황을 나타내는 정상 이미지 패치를 적어도 하나 이 상 선택한다. 또한 상기 정상 이미지 패치를 이용하여 생성형 신경망을 학습하고, 학습된 생성형 신경망 모델을 저장하는 동작을 수행할 수 있다. 이때 상기 생성형 신경망은 VAE(Variational Auto Encoder), GAN(Generative Adversarial Net), AAE(Adversarial Auto Encoder)등의 구조에 컨볼루션(Convolution) 레이어를 사용해 구성될 수 있다. 상기 생 성형 신경망은 주어진 객체 중심 이미지 패치를 인코딩(Encoding)해 잠재 변수(Latent Code)를 추출하고 이로부 터 다시 원래 이미지를 디코딩(Decoding)하는 학습을 통해 정상 상황만을 학습데이터로 받아 정상의 정의와 기 준을 설정하고 이렇게 정상 상황만을 학습한 생성형 신경망 모델을 저장한다. 이상점수 산출부는 상기 객체 중심 이미지 패치를 상기 학습된 생성형 신경망 모델을 이용하여 재생성 이 미지를 생성하고, 상기 객체 중심 이미지 패치를 상기 재생성 이미지와 비교하여 차이값을 계산하며, 상기 복수 개의 객체 중심 이미지 패치에 대하여 상기 차이값들을 수집하는 동작을 수행하고, 수집한 차이값들을 종합하여 개별 이상 점수를 계산할 수 있다. 그리고 복수의 관심객체에 대하여 상기 개별 이상 점수들을 수집하는 동작을 더 수행하여 상기 개별 이상 점수 들 중 가장 큰 점수를 상기 입력 프레임에 대한 이상 점수로 정할 수 있다. 학습된 생성형 신경망 모델에 정상 상황을 나타내는 입력 이미지가 입력된 경우 인코딩과 디코딩이 원할하게 이 루어져 원본 입력 이미지와 유사한 재생성 이미지가 만들어진다. 반면 기존에 학습되지 않은 이상 상황을 나타 내는 입력 이미지가 입력된 경우 원본 입력 이미지와 차이가 큰 재생성 이미지가 만들어진다. 따라서 상기 생성 형 신경망 모델의 입력인 원본 이미지와 상기 생성형 신경망 모델의 출력인 재생성 이미지의 차이값을 계산하면, 상기 차이값은 입력 이미지가 모델이 학습한 정상 상황 이미지(또는 정상 기준)와 유사할수록 낮아지 고, 상기 정상 상황 이미지와 다를수록 높아진다. 이 때 하나의 입력 프레임에는 여러 개의 관심객체가 존재할 수 있고, 한 관심 객체에 대하여 복수의 이미지 패 치가 추출될 수 있다. 따라서 우선 각 관심객체의 복수의 이미지 패치에 대하여 상기 차이값들을 수집, 종합하 여 해당 객체의 이상 점수인 개별 이상 점수를 계산할 수 있다. 이 때 개별 이상 점수는 각 차이값들의 평균, 차이값들 중 가장 높은 값, 또는 분류 신뢰도가 가장 높았던 객체 중심 이미지 패치의 값 등으로 결정할 수 있 다. 이렇게 해서 모든 객체에 대하여 개별 이상 점수를 계산하게 되면, 해당 입력 프레임의 이상 점수는 해당 프레 임에 속한 개별 이상 점수 중 가장 높은 점수로 결정할 수 있다. 도 2는 도 1에 도시된 객체 중심 이미지 생성부의 일 예를 나타낸 블록도이다. 객체 중심 이미지 생성부는 프레임 전처리부, 객체 탐지부, 객체 검증부를 포함할 수 있다. 프레임 전처리부는 영상 촬영부에서 수집한 영상으로부터 모니터링 영상의 영상 프레임을 추출하여 입력 프레임을 생성한다. 객체 탐지부는 상기 입력 프레임으로부터 관심객체의 이미지가 포함된 복수개의 이미지 패치들을 생성한다. 객체 검증부는 상기 복수개의 이미지 패치들 중 적어도 하나 이상의 객체 중심 이미지 패치를 선택하는 동작을 수행한다. 프레임 전처리부가 입력 프레임을 생성하는 추출 프레임률은 사용자나 응용이 요구하는 정확도에 따라 달 리 정할 수 있다. 프레임 전처리부는 상기 입력 프레임으로부터 모션 지도를 생성하는 동작을 수행할 수 있다. 그리고 상기 모션 지도로부터 얻은 정보를 이후 이미지 패치를 생성하는 데 이용할 수 있다. 이 때 모션 지도는 연속적인 프레임의 차이, 광학 흐름, 배경 제거 등의 기법을 통해 생성할 수 있다. 객체 탐지부는 상기 입력 프레임으로부터 관심객체의 이미지가 포함된 복수개의 이미지 패치들을 생성한다. 이때 상기 복수개의 이미지 패치들을 생성하는 동작은 상기 입력 프레임으로부터 관심객체를 추출하 고, 상기 입력 프레임으로부터 상기 관심객체의 이미지가 포함된 복수개의 이미지 패치를 생성하는 동작을 포함 할 수 있다. 우선 상기 관심객체를 추출하는 동작은 사전 정의된 객체집합에 대한 이미지 비교 탐색 알고리즘이나 SSD, YOLO 등과 같은 객체 탐지용 딥러닝망을 이용하고, 관심객체의 위치와 종류를 검출하게 된다. 이렇게 검출된 관심객체들은 각 관심객체마다 관심객체의 위치를 중심으로 일정한 크기의 바운딩 박스내의 이미 지를 추출하여 이미지 패치를 생성할 수 있다. 이미지 패치를 생성할 때 가로와 세로의 비율을 달리한 여러 개 의 바운딩 박스들을 사용할 수도 있다. 또한 객체 탐지부가 이미지 패치를 생성하는 과정에서 프레임 전처리부에서 생성된 모션 지도의 정보 를 이용할 수 있다. 상기 모션 지도에서 해당 입력 프레임 내의 움직임이 큰 지역을 관심 영역으로 정하고, 관 심객체의 위치와 상기 관심 영역의 거리 차를 오프셋으로 하여 상기 바운딩 박스의 위치를 움직이거나 상기 관 심객체의 위치에서 관심영역 방향으로 이동할 수도 있다. 객체 검증부는 객체 탐지부에서 생성한 상기 복수개의 이미지 패치들 중 상기 관심 객체의 이미지가 가장 온전히 포함된 이미지 패치를 객체 중심 이미지 패치로 선택하고, 상기 객체 중심 이미지 패치는 적어도 하나 이상 선택할 수 있다. 상기 객체 중심 이미지 패치를 선택하는 동작은 관심객체의 집합을 사전 정의하여 이미지 패치와 대조하는 알고 리즘이나 이미지 분류를 위해 사전학습된 딥러닝망을 이용할 수 있다. 이때 실제 이미지 패치 내에 해당 관심객 체가 있는지, 분류가 정확한지 등을 확인할 수 있다. 예를 들어 딥러닝망을 사용하여 객체 중심 이미지 패치를 선택하는 경우, 입력 이미지가 주어질 때 결과물로써 특정 클래스에 현재 이미지가 속할 확률이 나오고, 이 확 률로부터 분류 신뢰도가 높은 이미지 패치들을 객체 중심 이미지 패치로 선별할 수 있다. 그리고 이상과 같이 선별된 객체 중심 이미지 패치들은 이상 검출을 위한 모델의 학습과 이상 검출에 이용할 수 있다. 도 3은 도 1에 도시된 객체 중심 이미지 생성부의 활용예를 나타낸 도면이다. 도 3를 참조하면, 영상 촬영부에서 수집된 영상이 객체 중심 이미지 생성부의 입력으로 들어간다. 상기 수 집된 영상에서 각 사각형은 영상의 프레임을 나타내고, 그 중 검정색으로 칠해진 사각형이 이후 프레임 전 처리부에서 추출될 프레임에 해당한다. 이후, 프레임 전처리부는 상기 수집된 영상으로부터 입력 프레임을 추출하고, 상기 입력 프레임으로 부터 모션 지도을 생성한다. 즉, 프레임 전처리부는 프레임 단위로 전처리를 수행하는데, 입력 프레임에 대해 쌍을 이루는 모션 지도를 계산하여 생성한다. 프레임 전처리부가 상기 입력 프레임을 생성할 때 입력 프레임을 생성하는 추출 프레임률은 사용자나 응용이 요 구하는 정확도에 따라 달리 정할 수 있는 것은 앞서 도 1과 도 2에서 설명한 바와 같고, 도 3에서는 6개의 프레 임 중 1개의 프레임을 선택하고 있는 예를 보여준다. 그리고 프레임 전처리부가 상기 입력 프레임으로부터 모션 지도를 생성하는 동작을 수행할 수 있다. 그리고 상 기 모션 지도로부터 얻은 정보를 이후 이미지 패치를 생성하는 데 이용할 수 있다. 이 때 모션 지도는 연속적인 프레임의 차이(Frame Subtraction), 광학 흐름(Optical Flow), 배경 제거(Background Subtraction)등의 기법을 통해 생성할 수 있는데, 도 3에서는 광학 흐름(Optical Flow)을 이용하여 모션 지도를 계산한 예를 보여주고 있 다. 이렇게 생성된 모션 지도를 기반으로 프레임 내의 움직임이 가장 많은 부분을 관심 영역(Region of Interest)로 지정한다. 이렇게 쌍을 이루는 입력 프레임과 모션 지도는 객체 탐지부로 같이 전달될 수 있다. 객체 탐지부는 프레임 전처리부가 생성한 모션 지도에 기반하여 입력 프레임내의 관심객체의 종류와 위치를 추 출하고, 상기 입력 프레임으로부터 상기 관심객체의 이미지가 포함된 복수개의 이미지 패치들을 생성 한다. 도 3에서 찾아낸 객체의 종류는 사람이고, 상기 객체의 위치는 관심객체가 추출된 입력 프레임의 회 색으로 칠해진 바운딩 박스로 탐지할 수 있다. 그리고 상기 바운딩 박스뿐만 아니라 관심 영역의 크기, 위치를 고려해 복수의 새로운 바운딩 박스를 설정하여 복수의 이미지 패치를 추출할 수 있다. 즉, 객체의 위치를 나타 내는 바운딩 박스뿐만 아니라 상기 바운딩 박스와 가로 세로 비율과 크기를 달리하고, 관심 영역과 객체 위치의 차를 오프셋으로 하여 위치를 이동한 여러 개의 바운딩 박스들을 얻는다. 그리고 상기 바운딩 박스들 내의 이미 지들을 추출하여 복수개의 이미지 패치들을 생성할 수 있다. 객체 탐지부는 앞서 설명한 바와 같이 상기 입력 프레임으로부터 관심객체의 이미지가 포함된 복수개의 이미지 패치들을 생성한다. 이때 상기 복수개의 이미지 패치들을 생성하는 동작은 상기 입력 프레임으로부터 관심객체 를 추출하고, 상기 입력 프레임으로부터 상기 관심객체의 이미지가 포함된 복수개의 이미지 패치를 생성하는 동 작을 포함할 수 있다. 우선 상기 관심객체를 추출하는 동작은 사전 정의된 객체집합에 대한 이미지 비교 탐색 알고리즘이나 SSD, YOLO 등과 같은 객체 탐지용 딥러닝망을 이용하고, 관심객체의 위치와 종류를 검출하게 된다. 이렇게 검출된 관심객 체들은 각 관심객체마다 관심객체의 위치를 중심으로 일정한 크기의 바운딩 박스내의 이미지를 추출하여 이미지 패치를 생성할 수 있다. 이미지 패치를 생성할 때 가로와 세로의 비율을 달리한 여러 개의 바운딩 박스들을 사 용할 수도 있다. 또한 객체 탐지부가 이미지 패치를 생성하는 과정에서 프레임 전처리부에서 생성된 모션 지도의 정보를 이용하 여, 상기 모션 지도에서 해당 입력 프레임 내의 움직임이 큰 지역을 관심 영역으로 정하고, 관심객체의 위치와 상기 관심 영역의 거리 차를 오프셋으로 하여 상기 바운딩 박스의 위치를 움직이거나 상기 관심객체의 위치에서 관심영역 방향으로 이동할 수도 있다. 객체 검증부는 상기 복수개의 이미지 패치들 중 상기 관심객체의 이미지가 가장 온전히 포함된 이미지 패치인 객체 중심 이미지 패치를 적어도 하나 이상 선택한다. 즉, 상기 복수개의 이미지 패치들 중 선택된 객체인 사람에 맞는 이미지가 최대한 온전히 포함된, 높은 신뢰도의 이미지 패치를 객체 중심 이미지 패치로 선택한다. 도 3에서는 두 개의 객체 중심 이미지 패치가 선택되는 예를 보여주고 있다. 이와 같이 객체 검증부는 객체 탐지부에서 생성한 상기 복수개의 이미지 패치들 중 상기 관심 객체의 이미지가 가장 온전히 포함된 이미지 패치를 객체 중심 이미지 패치로 선택하고, 상기 객체 중심 이미지 패치는 적어도하나 이상 선택할 수 있다. 상기 객체 중심 이미지 패치를 선택하는 동작은 관심객체의 집합을 사전 정의하여 이미지 패치와 대조하는 알고 리즘이나 이미지 분류를 위해 사전학습된 딥러닝망(Image Classifier)을 이용할 수 있다. 예를 들어 딥러닝망을 사용하여 객체 중심 이미지 패치를 선택하는 경우, 입력 이미지가 주어질 때 결과물로써 특정 클래스에 현재 이 미지가 속할 확률로부터 분류 신뢰도가 높은 이미지 패치들을 객체 중심 이미지 패치로 선별하는 것이다. 이상과 같은 방법으로 객체검증부에서 선택된 객체 중심 이미지 패치는 이후 생성형 신경망 학습과 이상 검출에 이용된다. 도 4는 실시예에 따른 객체검증을 이용한 모니터링 영상 분석 방법의 일 예를 나타낸 동작 흐름도이다. 도 4를 참조하면, 영상 촬영부에서 수집한 영상이 객체 중심 이미지 생성부로 입력된다(S410). 객체 중심 이미지 생성부의 프레임 전처리부는 프레임 전처리 동작을 수행하는데(S420), 영상 촬영부에서 수집 한 영상으로부터 모니터링 영상의 영상 프레임을 추출하여 입력 프레임을 생성한다. 상기 입력 프레임을 생성하는 추출 프레임률(Frame Per Second = FPS)은 사용자나 응용에 따라 달리 정할 수 있 고, 상기 입력 프레임을 생성하는 과정에서 상기 입력 프레임으로부터 모션 지도를 생성하는 동작을 수행할 수 도 있다. 그리고 상기 모션 지도로부터 얻은 정보를 이후 이미지 패치를 생성하는 데 이용할 수 있다. 이 때 모 션 지도는 연속적인 프레임의 차이, 광학 흐름, 배경 제거 등의 기법을 통해 생성할 수 있다. 이후, 객체 중심 이미지 생성부의 객체 탐지부는 객체 탐지 동작을 수행한다(S430). 즉, 상기 객체 탐지부는 상 기 입력 프레임으로부터 관심객체의 이미지가 포함된 복수개의 이미지 패치들을 생성한다. 이때 상기 복수개의 이미지 패치들을 생성하는 동작은 상기 입력 프레임으로부터 관심객체를 추출하고, 상기 입력 프레임으로부터 상기 관심객체의 이미지가 포함된 복수개의 이미지 패치를 생성하는 동작을 포함할 수 있다. 우선 상기 관심객체를 추출하는 동작은 사전 정의 된 객체집합에 대한 이미지 비교 탐색 알고리즘 등과 같은 객 체 탐지용 딥러닝망을 이용하여 수행하고, 관심객체의 위치와 종류를 검출한다. 이렇게 검출된 관심객체들은 각 관심객체마다 관심객체의 위치를 중심으로 일정한 크기의 바운딩 박스내의 이미지를 추출하여 이미지 패치를 생 성할 수 있다. 상기 바운딩 박스는 가로와 세로의 비율을 달리한 여러 개일 수 있다. 또한 이미지 패치를 생성하는 과정에서 앞서 생성된 모션 지도의 정보를 이용할 수 있다. 상기 모션 지도에서 해당 입력 프레임 내의 움직임이 큰 지역인 관심 영역의 정보를 이용하여 바운딩박스들을 이동하는 것이다. 이상과 같이 객체 탐지가 이루어지고 나면, 객체 중심 이미지 생성부의 객체 검증부는 객체 검증 동작을 수행하 는데(S440), 상기 복수개의 이미지 패치들 중 적어도 하나 이상의 객체 중심 이미지 패치를 선택한다. 즉, 각 관심객체마다 생성된 복수개의 이미지 패치들 중 상기 관심 객체의 이미지가 가장 온전히 포함된 이미지 패치를 객체 중심 이미지 패치로 선택할 수 있다. 상기 객체 중심 이미지 패치는 적어도 하나 이상 선택할 수 있다. 상기 객체 중심 이미지 패치를 선택하는 동작은 관심객체의 집합을 사전 정의하여 이미지 패치와 대조하는 알고 리즘이나 이미지 분류를 위해 사전학습된 딥러닝망(Image Classifier)을 이용할 수 있다. 예를 들어 딥러닝망을 사용하여 객체 중심 이미지 패치를 선택하는 경우, 입력 이미지가 주어질 때 결과물로써 특정 클래스에 현재 이 미지가 속할 확률로부터 분류 신뢰도가 높은, 즉 실제 검출 클래스에 속할 확률이 높은 이미지 패치들을 객체 중심 이미지 패치로 선별할 수 있다. 그리고 이렇게 선별된 객체 중심 이미지 패치들은 이상 검출을 위한 모델 의 학습과 이상 검출에 이용할 수 있다. 모델 학습부는 상기 객체 중심 이미지 중 정상 상황 이미지를 이용해 생성형 신경망을 학습하는 정상 모델 학습 동작을 수행한다(S450). 모델 학습부는 상기 객체 중심 이미지 패치 중 정상 상황을 나타내는 정상 이미지 패치를 적어도 하나 이상 선 택한다. 또한 상기 정상 이미지 패치를 이용하여 생성형 신경망을 학습한다. 그리고 학습된 생성형 신경망 모델 을 저장하는 동작을 수행할 수 있다. 이때 상기 생성형 신경망은 VAE, GAN, AAE 등의 구조에 컨볼루션 레이어를 사용해 구성될 수도 있다. 상기 생성 형 신경망은 주어진 객체 중심 이미지 패치를 인코딩해 잠재 변수를 추출하고 이로부터 다시 원래 이미지를 디 코딩하는 학습을 통해, 정상 상황만을 학습데이터로 받아 정상의 정의와 기준을 설정하고 이렇게 정상 상황만을학습한 생성형 신경망 모델을 저장하는 것이다. 이상점수 산출부는 상기 객체 중심 이미지로부터 이상점수를 산출하는 이상점수 산출 동작을 수행한다(S460). 이상점수 산출부는 상기 객체 중심 이미지 패치를 상기 학습된 생성형 신경망 모델을 이용하여 재생성 이미지를 생성하고, 상기 객체 중심 이미지 패치를 상기 재생성 이미지와 비교하여 차이값을 계산한다. 상기 복수개의 객 체 중심 이미지 패치에 대하여 상기 차이값들을 수집하는 동작을 수행한다. 그리고 수집한 차이값들을 종합하여 개별 이상 점수를 계산할 수 있다. 이상점수 산출부는 복수의 관심객체에 대하여 상기 개별 이상 점수들을 수집하는 동작을 더 수행하여 상기 개별 이상 점수들 중 가장 큰 점수를 상기 입력 프레임에 대한 이상 점수로 정할 수 있다. 학습된 생성형 신경망 모델에 기존에 학습된 정상 상황을 나타내는 입력 이미지가 입력된 경우 인코딩과 디코딩 이 원할하게 이루어져 원본 입력 이미지와 유사한 재생성 이미지가 만들어진다. 반면 이상 상황을 나타내는 입 력 이미지가 입력된 경우 원본 입력 이미지와 차이가 큰 재생성 이미지가 만들어진다. 따라서 상기 생성형 신경 망 모델의 입력인 원본 이미지와 상기 생성형 신경망 모델의 출력인 재생성 이미지의 차이값을 계산하면, 상기 차이값은 입력 이미지가 모델이 학습한 정상 상황 이미지(또는 정상 기준)와 유사할수록 낮아지고, 상기 정상 상황 이미지와 다를수록 높아진다. 이 때 하나의 입력 프레임에는 여러 개의 관심객체가 존재할 수 있고, 한 관심 객체에 대하여 복수의 이미지 패 치가 추출될 수 있다. 따라서 우선 각 관심객체의 복수의 이미지 패치에 대하여 상기 차이값들을 수집, 종합하 여 해당 객체의 이상 점수인 개별 이상 점수를 계산할 수 있다. 이 때 개별 이상 점수는 각 차이값들의 평균, 차이값들 중 가장 높은 값, 또는 분류 신뢰도가 가장 높았던 객체 중심 이미지 패치의 값 등으로 결정할 수 있 다. 모든 객체에 대하여 개별 이상 점수를 계산하게 되면, 해당 입력 프레임의 이상 점수는 해당 프레임에 속한 개 별 이상 점수 중 가장 높은 점수로 결정할 수 있다. 이상 검출부는 이상점수 산출부에서 생성한 상기 이상 점수를 설정된 임계값과 비교한다(S470). 상기 이상 점수 가 임계값보다 작거나 같으면 다시 프레임 전처리 단계(S420)로 돌아가 다음 프레임에 대해 영상 분석을 시작한 다. 만약 상기 이상 점수가 임계값보다 크다면 이상 신호를 발생하는 이상 검출 동작을 수행하고(S480), 사용자 에게 경고음, 알림 메시지 등의 방법을 통해 이상 상황의 발생 사실을 알릴 수도 있다. 도 5는 실시예에 따른 컴퓨터 시스템 구성을 나타낸 도면이다. 실시예에 따른 객체검증을 이용한 모니터링 영상 분석 장치는 컴퓨터로 읽을 수 있는 기록매체와 같은 컴퓨터 시스템에서 구현될 수 있다. 컴퓨터 시스템은 버스를 통하여 서로 통신하는 하나 이상의 프로세서, 메모리, 사용자 인 터페이스 입력 장치, 사용자 인터페이스 출력 장치 및 스토리지를 포함할 수 있다. 또한, 컴퓨 터 시스템은 네트워크에 연결되는 네트워크 인터페이스를 더 포함할 수 있다. 프로세서는 중앙 처리 장치 또는 메모리나 스토리지에 저장된 프로그램 또는 프로세싱 인스트럭션들을 실행하는 반도체 장치일 수 있다. 메모리 및 스토리지는 휘발성 매체, 비휘발성 매체, 분리형 매체, 비분리형 매체, 통신 매체, 또는 정보 전달 매체 중에서 적어도 하나 이상을 포함하는 저장 매체일 수 있다. 예를 들어, 메모리는 ROM이나 RAM을 포함할 수 있다. 이상에서 설명된 실시예에 따르면, 객체검증을 이용한 모니터링 영상 분석 방법 및 그 장치를 제공함으로써 촬 영된 영상에서 객체 중심의 이미지 패치를 추출하고 객체검증을 통해 선별된 데이터를 이용하여 오경보율을 낮 추고 이상 검출의 정확도를 높인 이상 감지 시스템을 제공할 수 있다. 또한 이상 검출을 위해 생성형 신경망 학습을 이용함으로써 이상검출의 정확도를 더 높인 이상 감지 시스템을 제공할 수 있다."}
{"patent_id": "10-2020-0029486", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "이상에서 첨부된 도면을 참조하여 본 발명의 실시예들을 설명하였지만, 본 발명이 속하는 기술분야에서 통상의 지식을 가진 자는 본 발명이 그 기술적 사상이나 필수적인 특징을 변경하지 않고서 다른 구체적인 형태로 실시 될 수 있다는 것을 이해할 수 있을 것이다. 그러므로 이상에서 기술한 실시예들은 모든 면에서 예시적인 것이며 한정적이 아닌 것으로 이해해야만 한다.부호의 설명 110: 영상 촬영부 120: 객체 중심 이미지 생성부 130: 모델 학습부 140: 이상점수 산출부 150: 이상 검출부"}
{"patent_id": "10-2020-0029486", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 실시예에 따른 객체검증을 이용한 모니터링 영상 분석 장치의 일 예를 나타낸 블록도이다. 도 2는 도 1에 도시된 객체 중심 이미지 생성부의 일 예를 나타낸 블록도이다. 도 3은 도 1에 도시된 객체 중심 이미지 생성부의 활용예를 나타낸 도면이다. 도 4는 실시예에 따른 객체검증을 이용한 모니터링 영상 분석 방법의 일 예를 나타낸 동작 흐름도이다. 도 5는 실시예에 따른 컴퓨터 시스템 구성을 나타낸 도면이다."}
