{"patent_id": "10-2023-0139559", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2025-0055869", "출원번호": "10-2023-0139559", "발명의 명칭": "시계열 데이터를 위한 준지도 학습 방법 및 장치", "출원인": "한국과학기술원", "발명자": "이재길"}}
{"patent_id": "10-2023-0139559", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "적어도 하나의 프로세서에 의해 동작하는 장치의 동작 방법으로서,시계열 데이터에서 타겟 인스턴스를 샘플링하는 단계,상기 타겟 인스턴스에 주변 시퀀스의 컨텍스트를 추가하여 적어도 하나의 증강 인스턴스 쌍을 생성하는 단계,상기 증강 인스턴스 쌍에 포함된 두 증강 인스턴스들 각각을 훈련 대상인 모델로 입력하고, 상기 모델의 출력을이용하여 상기 타겟 인스턴스의 타임스탬프들에서 대한 두 의사 레이블셋들을 생성하는 단계, 그리고상기 증강 인스턴스 쌍으로 얻은 상기 두 의사 레이블셋들을 대응하는 의사 레이블끼리 신뢰도 기반으로 병합하여 하나의 인공 레이블셋을 생성하는 단계를 포함하는 동작 방법."}
{"patent_id": "10-2023-0139559", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에서,상기 증강 인스턴스 쌍으로부터 생성된 상기 인공 레이블셋과 상기 타겟 인스턴스의 정답 레이블셋 사이의 손실을 기초로, 상기 모델을 업데이트하는 단계를 더 포함하는 동작 방법."}
{"patent_id": "10-2023-0139559", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1항에서,상기 적어도 하나의 증강 인스턴스 쌍을 생성하는 단계는상기 타겟 인스턴스에 이전 시퀀스의 컨텍스트를 추가하여 이전 방향으로 증강된 제1 증강 인스턴스를생성하고, 상기 타겟 인스턴스에 후속 시퀀스의 컨텍스트를 추가하여 후속 방향으로 증강된 제2 증강 인스턴스를 생성하고, 상기 제1 증강 인스턴스와 상기 제2 증강 인스턴스로 구성된 상기 증강 인스턴스 쌍을 생성하는,동작 방법."}
{"patent_id": "10-2023-0139559", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제1항에서,상기 두 의사 레이블셋들을 생성하는 단계는상기 모델로부터 상기 두 증강 인스턴스들 각각에 대해 추론된 분류 확률 벡터를 획득하고, 각 분류 확률 벡터에 신뢰 임계값을 적용하여 타임스탬프별 의사 레이블을 결정하는, 동작 방법."}
{"patent_id": "10-2023-0139559", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제1항에서,상기 하나의 인공 레이블셋을 생성하는 단계는동일 타임스탬프에 대해 추론된 두 의사 레이블들 각각의 신뢰도를 기반으로 가중치를 계산하고, 상기 가중치를사용하여 상기 두 의사 레이블들을 병합하는, 동작 방법."}
{"patent_id": "10-2023-0139559", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제1항에서,공개특허 10-2025-0055869-3-상기 적어도 하나의 증강 인스턴스 쌍은상기 타겟 인스턴스에 추가되는 컨텍스트의 길이와 상기 타겟 인스턴스에 추가되는 컨텍스트의 위치를조절하여, 생성되는, 동작 방법."}
{"patent_id": "10-2023-0139559", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제1항에서,각 증강 인스턴스의 특정 타임스탬프에서 획득된 의사 레이블의 신뢰도는, 상기 특정 타임스탬프가 해당 증강인스턴스의 중심에 가까울수록 큰 값을 가지는, 동작 방법."}
{"patent_id": "10-2023-0139559", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "메모리, 그리고상기 메모리에 저장된 명령어들을 실행하는 프로세서를 포함하고,상기 프로세서는, 상기 명령어들을 실행함으로써,시계열 데이터에서 타겟 인스턴스를 샘플링하고, 상기 타겟 인스턴스에 주변 시퀀스의 컨텍스트를 추가하여 적어도 하나의 증강 인스턴스 쌍을 생성하고, 상기 증강 인스턴스 쌍에 포함된 두 증강 인스턴스들 각각을 훈련대상인 모델로 입력하고, 상기 모델의 출력을 이용하여 상기 타겟 인스턴스의 타임스탬프들에서 대한 두 의사레이블셋들을 생성하며, 상기 증강 인스턴스 쌍으로 얻은 상기 두 의사 레이블셋들을 대응하는 의사 레이블끼리신뢰도 기반으로 병합하여 하나의 인공 레이블셋을 생성하는, 모델 훈련 장치."}
{"patent_id": "10-2023-0139559", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제8항에서,상기 프로세서는상기 증강 인스턴스 쌍으로부터 생성된 상기 인공 레이블셋과 상기 타겟 인스턴스의 정답 레이블셋 사이의 손실을 기초로, 상기 모델을 업데이트하는, 모델 훈련 장치."}
{"patent_id": "10-2023-0139559", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제8항에서,상기 프로세서는상기 타겟 인스턴스에 이전 시퀀스의 컨텍스트를 추가하여 이전 방향으로 증강된 제1 증강 인스턴스를생성하고, 상기 타겟 인스턴스에 후속 시퀀스의 컨텍스트를 추가하여 후속 방향으로 증강된 제2 증강 인스턴스를 생성하고, 상기 제1 증강 인스턴스와 상기 제2 증강 인스턴스로 구성된 상기 증강 인스턴스 쌍을 생성하는,모델 훈련 장치."}
{"patent_id": "10-2023-0139559", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "제8항에서,상기 프로세서는상기 모델로부터 상기 두 증강 인스턴스들 각각에 대해 추론된 분류 확률 벡터를 획득하고, 각 분류 확률 벡터에 신뢰 임계값을 적용하여 타임스탬프별 의사 레이블을 결정하는, 모델 훈련 장치."}
{"patent_id": "10-2023-0139559", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제8항에서,상기 프로세서는동일 타임스탬프에 대해 추론된 두 의사 레이블들 각각의 신뢰도를 기반으로 가중치를 계산하고, 상기 가중치를사용하여 상기 두 의사 레이블들을 병합하는, 모델 훈련 장치.공개특허 10-2025-0055869-4-청구항 13 제8항에서,상기 프로세서는상기 타겟 인스턴스에 추가되는 컨텍스트의 길이와 상기 타겟 인스턴스에 추가되는 컨텍스트의 위치를조절하여, 상기 적어도 하나의 증강 인스턴스 쌍을 생성하는, 모델 훈련 장치."}
{"patent_id": "10-2023-0139559", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_14", "content": "제8항에서,각 증강 인스턴스의 특정 타임스탬프에서 획득된 의사 레이블의 신뢰도는, 상기 특정 타임스탬프가 해당 증강인스턴스의 중심에 가까울수록 큰 값을 가지는, 모델 훈련 장치."}
{"patent_id": "10-2023-0139559", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_15", "content": "비일시적-컴퓨터 판독가능 저장매체에 저장되는 컴퓨터 프로그램으로서,프로세서에 의해 실행됨으로써, 상기 프로세서로 하여금, 시계열 데이터에서 타겟 인스턴스를 샘플링하는 단계,상기 타겟 인스턴스에 주변 시퀀스의 컨텍스트를 추가하여 적어도 하나의 증강 인스턴스 쌍을 생성하는 단계,상기 증강 인스턴스 쌍에 포함된 두 증강 인스턴스들 각각을 훈련 대상인 모델로 입력하고, 상기 모델의 출력을이용하여 상기 타겟 인스턴스의 타임스탬프들에서 대한 두 의사 레이블셋들을 생성하는 단계, 그리고상기 증강 인스턴스 쌍으로 얻은 상기 두 의사 레이블셋들을 대응하는 의사 레이블끼리 신뢰도 기반으로 병합하여 하나의 인공 레이블셋을 생성하는 단계를 수행하도록 만드는 명령어들을 포함하는, 컴퓨터 프로그램."}
{"patent_id": "10-2023-0139559", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "적어도 하나의 프로세서에 의해 동작하는 장치의 동작 방법으로서, 시계열 데이터에서 타겟 인스턴스를 샘플링하 는 단계, 상기 타겟 인스턴스에 주변 시퀀스의 컨텍스트를 추가하여 적어도 하나의 증강 인스턴스 쌍을 생성하는 단계, 상기 증강 인스턴스 쌍에 포함된 두 증강 인스턴스들 각각을 훈련 대상인 모델로 입력하고, 상기 모델의 출력을 이용하여 상기 타겟 인스턴스의 타임스탬프들에서 대한 두 의사 레이블셋들을 생성하는 단계, 그리고 상 기 증강 인스턴스 쌍으로 얻은 상기 두 의사 레이블셋들을 대응하는 의사 레이블끼리 신뢰도 기반으로 병합하여 하나의 인공 레이블셋을 생성하는 단계를 포함한다."}
{"patent_id": "10-2023-0139559", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 개시는 시계열 데이터 학습에 관한 것이다."}
{"patent_id": "10-2023-0139559", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "시계열 데이터는 연속적인 데이터 포인트들의 집합으로, 시간적으로 일관된(temporally coherent) 타임스탬프 레이블이 어노테이션된다. 이때, 실제로 일관된 레이블의 경계를 알 수 없으므로 분류기는 각 타임스탬프의 레 이블을 예측하도록 훈련한다. 그러나 시계열의 길이와 복잡성으로 인해 시계열의 모든 타임스탬프에 레이블을 지정하려면 엄청나게 많은 비용이 필요하므로 시계열에서는 일반적으로 레이블이 희소하다. 일관성 정규화(Consistency regularization)는 최근에 가장 성능이 좋은 준지도 학습 방법 중 하나로서, 증강된 데이터 포인트에 대한 레이블을 추론함으로써 희소 레이블에서 모델을 훈련하는 유망한 방법이다. 일관성 정규 화는 데이터 증강을 통해 데이터를 변형시킨 뒤, 변형된 데이터 인스턴스의 모델 출력과 변형하지 않은 데이터 인스턴스의 모델 출력을 비슷하게 만들어 모델을 훈련시킴으로 일관성을 강화하는 방법이다. 따라서, 데이터 증 강은 일관성 정규화에서 중요한 역할을 하는데, 주어진 데이터 인스턴스를 직접 교란(perturbation)하는 데이터 증강 방식이 주로 사용된다. 이러한 일관성 정규화는 레이블이 희소한 시계열 데이터를 분류하기 위해서 사용될 수 있다. 하지만, 데이터 도 메인에 맞는 데이터 증강 방식이 필요해 다양한 시계열 데이터에 적용하기 어렵다. 또한 기존의 데이터 증강은 주어진 데이터 인스턴스를 직접 조작하여 증강 인스턴스를 획득하기 때문에, 변형된 데이터에 의해 학습 성능이 영향받을 수 있다."}
{"patent_id": "10-2023-0139559", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 2, "content": "발명의 내용"}
{"patent_id": "10-2023-0139559", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 개시는 시계열 데이터를 위한 준지도 학습 방법 및 장치에 관한 것이다. 본 개시는 시계열 데이터의 타겟 인스턴스를 컨텍스트 추가 증강(context-attached augmentation) 방법으로 증 강시키고, 한 쌍의 증강 인스턴스들에 대한 모델의 출력을 신뢰도 기반으로 병합하여 인공 레이블을 생성하고 이를 이용하여 모델을 훈련시키는 방법에 관한 것이다."}
{"patent_id": "10-2023-0139559", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "한 실시예에 따라 적어도 하나의 프로세서에 의해 동작하는 장치의 동작 방법으로서, 시계열 데이터에서 타겟 인스턴스를 샘플링하는 단계, 상기 타겟 인스턴스에 주변 시퀀스의 컨텍스트를 추가하여 적어도 하나의 증강 인 스턴스 쌍을 생성하는 단계, 상기 증강 인스턴스 쌍에 포함된 두 증강 인스턴스들 각각을 훈련 대상인 모델로 입력하고, 상기 모델의 출력을 이용하여 상기 타겟 인스턴스의 타임스탬프들에서 대한 두 의사 레이블셋들을 생 성하는 단계, 그리고 상기 증강 인스턴스 쌍으로 얻은 상기 두 의사 레이블셋들을 대응하는 의사 레이블끼리 신 뢰도 기반으로 병합하여 하나의 인공 레이블셋을 생성하는 단계를 포함한다. 상기 동작 방법은 상기 증강 인스턴스 쌍으로부터 생성된 상기 인공 레이블셋과 상기 타겟 인스턴스의 정답 레 이블셋 사이의 손실을 기초로, 상기 모델을 업데이트하는 단계를 더 포함할 수 있다. 상기 적어도 하나의 증강 인스턴스 쌍을 생성하는 단계는 상기 타겟 인스턴스에 이전 시퀀스의 컨텍스트를 추가 하여 이전 방향으로 증강된 제1 증강 인스턴스를 생성하고, 상기 타겟 인스턴스에 후속 시퀀스의 컨텍스트를 추 가하여 후속 방향으로 증강된 제2 증강 인스턴스를 생성하고, 상기 제1 증강 인스턴스와 상기 제2 증강 인스턴 스로 구성된 상기 증강 인스턴스 쌍을 생성할 수 있다. 상기 두 의사 레이블셋들을 생성하는 단계는 상기 모델로부터 상기 두 증강 인스턴스들 각각에 대해 추론된 분 류 확률 벡터를 획득하고, 각 분류 확률 벡터에 신뢰 임계값을 적용하여 타임스탬프별 의사 레이블을 결정할 수 있다. 상기 하나의 인공 레이블셋을 생성하는 단계는 동일 타임스탬프에 대해 추론된 두 의사 레이블들 각각의 신뢰도 를 기반으로 가중치를 계산하고, 상기 가중치를 사용하여 상기 두 의사 레이블들을 병합할 수 있다. 상기 적어도 하나의 증강 인스턴스 쌍은 상기 타겟 인스턴스에 추가되는 컨텍스트의 길이와 상기 타겟 인스턴스 에 추가되는 컨텍스트의 위치를 조절하여, 생성될 수 있다. 각 증강 인스턴스의 특정 타임스탬프에서 획득된 의사 레이블의 신뢰도는, 상기 특정 타임스탬프가 해당 증강 인스턴스의 중심에 가까울수록 큰 값을 가질 수 있다. 한 실시예에 따른 모델 훈련 장치로서, 메모리, 그리고 상기 메모리에 저장된 명령어들을 실행하는 프로세서를 포함하고, 상기 프로세서는, 상기 명령어들을 실행함으로써, 시계열 데이터에서 타겟 인스턴스를 샘플링하고, 상기 타겟 인스턴스에 주변 시퀀스의 컨텍스트를 추가하여 적어도 하나의 증강 인스턴스 쌍을 생성하고, 상기 증강 인스턴스 쌍에 포함된 두 증강 인스턴스들 각각을 훈련 대상인 모델로 입력하고, 상기 모델의 출력을 이용 하여 상기 타겟 인스턴스의 타임스탬프들에서 대한 두 의사 레이블셋들을 생성하며, 상기 증강 인스턴스 쌍으로 얻은 상기 두 의사 레이블셋들을 대응하는 의사 레이블끼리 신뢰도 기반으로 병합하여 하나의 인공 레이블셋을 생성할 수 있다. 상기 프로세서는 상기 증강 인스턴스 쌍으로부터 생성된 상기 인공 레이블셋과 상기 타겟 인스턴스의 정답 레이 블셋 사이의 손실을 기초로, 상기 모델을 업데이트할 수 있다. 상기 프로세서는 상기 타겟 인스턴스에 이전 시퀀스의 컨텍스트를 추가하여 이전 방향으로 증강된 제1 증강 인 스턴스를 생성하고, 상기 타겟 인스턴스에 후속 시퀀스의 컨텍스트를 추가하여 후속 방향으로 증강된 제2 증강 인스턴스를 생성하고, 상기 제1 증강 인스턴스와 상기 제2 증강 인스턴스로 구성된 상기 증강 인스턴스 쌍을 생 성할 수 있다. 상기 프로세서는 상기 모델로부터 상기 두 증강 인스턴스들 각각에 대해 추론된 분류 확률 벡터를 획득하고, 각 분류 확률 벡터에 신뢰 임계값을 적용하여 타임스탬프별 의사 레이블을 결정할 수 있다. 상기 프로세서는 동일 타임스탬프에 대해 추론된 두 의사 레이블들 각각의 신뢰도를 기반으로 가중치를 계산하 고, 상기 가중치를 사용하여 상기 두 의사 레이블들을 병합할 수 있다. 상기 프로세서는 상기 타겟 인스턴스에 추가되는 컨텍스트의 길이와 상기 타겟 인스턴스에 추가되는 컨텍스트의 위치를 조절하여, 상기 적어도 하나의 증강 인스턴스 쌍을 생성할 수 있다. 각 증강 인스턴스의 특정 타임스탬프에서 획득된 의사 레이블의 신뢰도는, 상기 특정 타임스탬프가 해당 증강 인스턴스의 중심에 가까울수록 큰 값을 가질 수 있다. 한 실시예에 따른 비일시적-컴퓨터 판독가능 저장매체에 저장되는 컴퓨터 프로그램으로서, 프로세서에 의해 실 행됨으로써, 상기 프로세서로 하여금, 시계열 데이터에서 타겟 인스턴스를 샘플링하는 단계, 상기 타겟 인스턴 스에 주변 시퀀스의 컨텍스트를 추가하여 적어도 하나의 증강 인스턴스 쌍을 생성하는 단계, 상기 증강 인스턴 스 쌍에 포함된 두 증강 인스턴스들 각각을 훈련 대상인 모델로 입력하고, 상기 모델의 출력을 이용하여 상기 타겟 인스턴스의 타임스탬프들에서 대한 두 의사 레이블셋들을 생성하는 단계, 그리고 상기 증강 인스턴스 쌍으 로 얻은 상기 두 의사 레이블셋들을 대응하는 의사 레이블끼리 신뢰도 기반으로 병합하여 하나의 인공 레이블셋 을 생성하는 단계를 수행하도록 만드는 명령어들을 포함할 수 있다."}
{"patent_id": "10-2023-0139559", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 개시에 따르면, 시계열 데이터의 레이블이 희소하더라도 시계열 데이터를 분류하는 모델을 안정적으로 훈련 시킬 수 있고, 다양한 종류의 시계열 데이터에 적용 가능한 범용성 있는 준지도 학습 방법을 제공할 수 있다. 본 개시에 따르면, 희소 레이블을 가진 시계열 데이터를 이용한 학습 시, 데이터 자체를 변경할 필요 없이, 데 이터 인스턴스를 유지하면서 다양한 컨텍스트로 증강된 데이터 인스턴스를 생성하고 신뢰성 있는 레이블을 추론 할 수 있다."}
{"patent_id": "10-2023-0139559", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "아래에서는 첨부한 도면을 참고로 하여 본 개시의 실시예에 대하여 본 개시가 속하는 기술 분야에서 통상의 지 식을 가진 자가 용이하게 실시할 수 있도록 상세히 설명한다. 그러나 본 개시는 여러 가지 상이한 형태로 구현 될 수 있으며 여기에서 설명하는 실시예에 한정되지 않는다. 그리고 도면에서 본 개시를 명확하게 설명하기 위 해서 설명과 관계없는 부분은 생략하였으며, 명세서 전체를 통하여 유사한 부분에 대해서는 유사한 도면 부호를 붙였다. 설명에서, 도면 부호 및 이름은 설명의 편의를 위해 붙인 것으로서, 장치들이 반드시 도면 부호나 이름으로 한 정되는 것은 아니다. 설명에서, 어떤 부분이 어떤 구성요소를 \"포함\"한다고 할 때, 이는 특별히 반대되는 기재가 없는 한 다른 구성 요소를 제외하는 것이 아니라 다른 구성요소를 더 포함할 수 있는 것을 의미한다. 또한, 명세서에 기재된 \"…부\", \"…기\", \"모듈\" 등의 용어는 적어도 하나의 기능이나 동작을 처리하는 단위를 의미하며, 이는 하드웨어 나 소프트웨어 또는 하드웨어 및 소프트웨어의 결합으로 구현될 수 있다. 본 개시의 장치는 적어도 하나의 프로세서가 명령어들(instructions)을 실행함으로써, 본 개시의 동작을 수행할 수 있도록 구성 및 연결된 컴퓨팅 장치이다. 컴퓨터 프로그램은 프로세서가 본 개시의 동작을 실행하도록 기술 된 명령어들(instructions)을 포함하고, 비일시적-컴퓨터 판독가능 저장매체(non-transitory computer readable storage medium)에 저장될 수 있다. 컴퓨터 프로그램은 네트워크를 통해 다운로드되거나, 제품 형태로 판매될 수 있다. 도 1은 한 실시예에 따른 모델 훈련 장치의 개념도이고, 도 2는 한 실시예에 따른 컨텍스트 추가 증강을 설명하 는 도면이다. 도 1을 참고하면, 모델 훈련 장치는 적어도 하나의 프로세서에 의해 동작하는 컴퓨팅 장치로서, 인공지능 (Artificial Intelligence, AI) 기반 모델이 입력 시계열 데이터를 클래스들로 분류하도록 훈련시킨다. 모델 훈련 장치는 컴퓨터 프로그램의 명령어들을 저장하는 메모리, 명령어들을 실행하는 적어도 하나의 프 로세서를 포함하는 컴퓨팅 장치로서, 프로세서가 명령어들을 실행하여 본 개시의 동작을 수행할 수 있다. 컴퓨 터 프로그램은 컴퓨터 판독 가능한 저장매체에 저장되고, 프로세서에 의해 실행되는 명령어들을 포함한다. 시계열 데이터는 연속적인 데이터 포인트들의 집합으로서, 레이블이 희소하다고 가정한다. 따라서, 타임스탬프 t에서의 데이터 포인트 xt는 레이블이 있거나 없을 수 있다. 모델은 레이블이 희소한 시계열 데이터를 이용하여 준지도 학습을 한다고 가정한다. 모델은 다양한 종류의 인공지능 모델일 수 있는데, 예를 들면 분 류기(classifier)일 수 있고, 그 구조는 다양할 수 있다. 모델은 시계열 데이터를 입력받고, 타임스탬프에 서의 레이블을 예측하는 훈련을 할 수 있다. 시계열 데이터의 희소 레이블을 고려하여, 모델 훈련 장치는 일관성 정규화(Consistency regularization) 를 통한 준지도 학습 방법을 사용할 수 있다. 일관성 정규화는 레이블이 지정되지 않은 데이터 포인트에 대한 레이블을 추론함으로써 희소 레이블 데이터를 이용한 모델 훈련에 사용되는데, 일관성 정규화에서 데이터 증강 이 중요한 역할을 한다. 종래에는 주어진 데이터 인스턴스를 직접 변형해서 증강 데이터를 생성하는 증강 방식 이 사용되었으나, 이는 시계열 데이터에 적합한 증강 방식으로 보기 어렵다. 따라서, 모델 훈련 장치는 시 계열 데이터의 특성에 적합한 새로운 데이터 증강 방법 및 이를 활용한 일관성 정규화 방법을 제공하고, 이를 통해 모델을 학습시킨다. 이를 CrossMatch라고 부를 수 있다. 모델 훈련 장치는 컨텍스트 추가 증강(context-attached augmentation) 기반의 데이터 증강부, 신뢰 도 기반 레이블 병합부, 그리고 모델 훈련부를 포함할 수 있다. 데이터 증강부는 일관성 정규화에서 시계열 데이터의 순차적 특성을 활용하기 위해, 주변 시퀀스를 컨텍스 트로서 타겟 인스턴스에 추가하여 증강 인스턴스를 형성할 수 있다. 이를 컨텍스트 추가 증강이라고 부를 수 있 다. 도 2를 참고하면, 데이터 증강부는 입력 시계열 데이터의 일부 구간을 타겟 인스턴스 X로 결정하고, 타겟 인스턴스의 앞뒤에 이전 및 후속 시퀀스의 컨텍스트를 다양하게 추가하여 하나의 타겟 인스턴스로부터 증 강된 인스턴스 쌍들을 생성할 수 있다. 데이터 증강부는 타겟 인스턴스의 앞뒤에 추가되는 컨텍스트 길이 를 다양하게 조절하여, 다양한 증강 인스턴스 쌍들을 생성할 수 있다. 이러한 컨텍스트 추가 증강 방식은 타겟 인스턴스를 변형하지 않고 증강 데이터를 얻을 수 있다. 따라서, 컨텍 스트 추가 증강 방식으로 증강된 데이터는 타겟 인스턴스와 정확히 동일하기 때문에 증강 인스턴스 간의 일관성 을 보다 안정적으로 유지할 수 있다. 또한, 타겟 인스턴스의 앞뒤에 추가되는 컨텍스트 길이를 다양하게 조절함 으로써, 다양한 상황에 따라 충분한 수의 증강 데이터를 쉽게 얻을 수 있다. 또한, 컨텍스트 추가 증강을 위해 시계열 데이터에서 하위 시퀀스를 검색하기만 하면 되고, 계산 비용이 저렴하며, 기존 데이터 증강 기술과 함께 사용할 수 있다. 타겟 인스턴스 X로부터 증강된 한 쌍의 증강 인스턴스들, 예를 들면, Xleft , Xright이 모델로 입력된다. 모델 은 증강 인스턴스 각각에 대한 추론을 출력한다. 모델은 증강 인스턴스 각각에 대한 클래스 분류 확률 을 예측하고, 이를 타임스탬프들에 대한 분류 확률 벡터 fθ(Xleft), fθ(Xright)로 출력할 수 있다 이때, 증강 인스 턴스의 전체 타임스탬프들에 대한 분류 확률을 사용하는 대신, 타겟 인스턴스의 타임스탬프 구간에 대한 값만 사용할 수 있다. 레이블 병합부는 증강 인스턴스들로부터의 추론을 정규화하기 위해, 두 증강 인스턴스들로부터 추론된 의 사 레이블들(pseudo-labels)을 신뢰성 기반으로 혼합하여 타겟 인스턴스에 대해 추론된 하나의 인공 레이블셋 (artificial label set)을 생성할 수 있다. 레이블 병합부는 증강 인스턴스 각각에 대한 모델의 출력, 즉, 분류 확률 벡터 fθ(Xleft), fθ(Xright)를 이용하여, 각 증강 인스턴스의 타임스탬프별 의사 레이블(pseudo-label)을 생성할 수 있다. 레이블 병합부(12 0)는 각 타임스탬프에서가장 큰 소프트맥스 확률(maximum softmax probability)이 일정 수준을 넘으면, 의사 레이블을 부여하고, 그렇지 않으면 의사 레이블을 부여하지 않을 수 있다. 레이블 병합부는 증강 인스턴스 쌍에 대한 두 의사 레이블셋들을 각 의사 레이블의 신뢰도 기반으로 병합 하여 하나의 인공 레이블셋 을 생성할 수 있다. 신뢰도는 다양한 방법으로 정의될 수 있는데, 타겟 인스턴스에 추가되는 컨텍스트 길이를 기초로 신뢰도가 결정 될 수 있다. 레이블 병합부는 신뢰도를 가중치로 사용하여 두 의사 레이블셋을 병합하여 하나의 인공 레이 블셋을 생성할 수 있는데, 의사 레이블들을 단일 크로스-윈도우 레이블(single cross-window label)로 혼합 (mix)할 수 있다. 단일 크로스-윈도우 레이블은 두 증강 인스턴스들의 두 소프트맥스 확률과 일치할 수 있다. 증강된 인스턴스 각각에 대한 모델의 출력이 소프트 레이블(soft label)의 형태로 교차되고, 서로 다른 컨 텍스트를 가진 여러 증강 인스턴스의 출력 중 타겟 인스턴스 부분의 출력 레이블을 똑같게 만들 수 있다. 모델 훈련부는 한 쌍의 증강된 인스턴스들로부터 생성된 타겟 인스턴스의 인공 레이블셋 과 정답 레이 블셋 Y 사이의 손실을 기초로, 손실이 최소화되도록 모델을 훈련시킬 수 있다. 이러한 데이터 증강, 레이블 병합 및 모델 업데이트 절차는 각 훈련 반복(iteration)에서 반복될 수 있다. 이와 같이, 모델 훈련 장치는 다양한 데이터 증강과 신뢰할 수 있는 의사 레이블을 통해 모델을 업데 이트하기 위한 유익한 가이드를 제공하고자 하는 일관성 정규화의 목표를 달성할 수 있다. 모델 훈련 장치(10 0)는 타겟 인스턴스의 앞뒤에 이전 및 후속 인스턴스의 컨텍스트를 추가하는 데이터 증강 방식을 사용함으로써, 모든 시계열 데이터의 준지도 학습에 활용할 수 있는 범용성을 가진다. 또한, 모델 훈련 장치는 신뢰도 기 반 레이블 병합 방식을 사용함으로써, 추론한 레이블의 신뢰성을 높일 수 있다. 구체적으로, 시계열 데이터 D는 수학식 1과 같이 정의된다고 가정한다. 수학식 1에서 T는 타임스탬프들의 인덱 스 셋이고, xt는 타임스탬프 t에서 d차원의 데이터 포인트이다. yt는 레이블을 가진 xt라면 클래스 레이블이고, 레이블이 없는 xt라면 null일 수 있다. 여기서, TU는 레이블이 없는 타임스탬프들의 인덱스 셋이라고 가정하고, TL은 레이블이 있는 타임스탬프들의 인덱스 셋이라고 가정하는데, TL이 희소하다고 가정한다. 수학식 1"}
{"patent_id": "10-2023-0139559", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "시계열 데이터에서 연속된 타임스탬프들로 구성된 인스턴스 단위로 훈련된다고 가정한다. 인스턴스 X={xt | t∈ [m-w:m+w)}는 타임스탬프 m을 중심으로 한 연속적인 2w개의 데이터 포인트들의 목록이다. 여기서, [m-w:m+w)는 m-w부터 m+w-1까지의 정수 간격을 나타낸다. 인스턴스의 레이블 Y={yt|t∈[m-w:m+w)}는 타임스탬프 m을 중심으 로 한 연속적인 2w개의 데이터 포인트들의 레이블 목록이다. 여기서, yt∈{1, ..., K}이고 K는 클래스 수이다. fθ로 표현되는 모델은 2w 데이터 포인트들로 구성된 입력 X의 타임스탬프마다의 클래스 분류 확률, 즉 순차 적 소프트맥스 확률 fθ(X)∈ [0,1]2w×K를 출력한다. 수학식 2를 참고하면, 각 타임스탬프 t∈[m-w:m+w)에서 의사 레이블 는 각 인스턴스 X에 대해, 신뢰 임계값 τ에 따라 조건화된 최대 소프트맥스 확률을 사용하여 계산될 수 있다. 수학식 2 인스턴스 X에 대한 의사 레이블들의 집합인 의사 레이블셋 은 수학식 2에 의해 획 득될 수 있다. 의사 레이블들은 모델이 계산된 손실을 기초로 업데이트되면 버려질 수 있다. 타겟 인스턴스 X={xt | t∈[m-w:m+w)}에 c개의 주변 데이터 포인트들이 추가되는 증강 인스턴스 Ai(X)={xt|t∈ [m-w-c:m+w+i)}는 컨텍스트를 선택하는 방법에 따라 c+1개 생성될 수 있다. 임베딩 공간에서 차이가 더 큰 증강 인스턴스를 선택하면 일관성 정규화를 통해 더 효과적인 학습이 유도된다고 알려져 있고, 중첩되는 데이터 포인 트 수가 적을수록 두 증강 인스턴스의 임베딩 거리가 멀어진다. 따라서 임베딩 공간에서 거리가 가장 먼 두 증 강 인스턴스들을 얻기 위해, 타겟 인스턴스에 이전 시퀀스(왼쪽)의 컨텍스트가 부가된 증강 인스턴스 Xleft와 타 겟 인스턴스에 후속 시퀀스(오른쪽)의 컨텍스트가 부가된 증강 인스턴스 Xright를 선택할 수 있다. 한편, 일관성 정규화에 직접적인 영향을 미치는 요소가 컨텍스트 길이 c이다. 컨텍스트 길이가 너무 짧으면 두 증강 인스턴스들이 너무 유사해져서 모델이 거의 업데이트되지 않을 수 있다. 반면에 c가 너무 길면 임베딩이 분기되어 다른 클래스의 인스턴스 표현을 결합하게 될 수 있다. 따라서, 이를 절충하기 위해 최적의 컨텍스트 길이를 찾는 것이 중요하다. 최적의 컨텍스트 길이는 각 데이터세트의 평균 세그먼트 길이와 높은 상관관계가 있다. 따라서 데이터세트의 평균 세그먼트 길이에 관계된 최적의 컨텍스트 길이를 실험적으로 찾을 수 있다. 예 를 들면, 데이터세트의 평균 세그먼트 길이의 1/5과 1/2 사이에서 컨텍스트 길이가 결정될 수 있다. 도 3은 한 실시예에 따른 신뢰도 기반 레이블 병합 방법을 설명하는 도면이다. 도 3을 참고하면, 타겟 인스턴스의 타임스탬프들에 대해 생성된 의사 레이블들은 수학식 2의 신뢰도 임계값을 충족하지만, 의사 레이블의 신뢰도에 따라 다르게 처리할 수 있다. 이는, 모델 fθ가 타임스탬프 t의 왼쪽과 오 른쪽에서 더 많은 데이터 포인트들을 수신하고, 데이터 포인트 수가 양측 간에 균형을 이루면 타임스탬프 t의 의사 레이블을 더 신뢰할 수 있고, 예측이 이전 또는 후속 시퀀스에 편향되지 않는다는 것에 근거할 수 있다. 이를 이용하여 각 의사 레이블의 신뢰도를 계산하는 신뢰도 함수가 설계될 수 있다. fθ(Xleft)t와 fθ(Xright)t로부터 두 의사 레이블들 와 생성된다고 가정한다. 타겟 인스턴스 X의 타임스 탬프 t에서, 증강 인스턴스의 왼쪽 길이 와 오른쪽 길이 는 수학식 3과 같이 계산될 수 있다. 수학 식 3에서, loc는 컨텍스트가 추가된 위치를 나타낸다. 수학식 3"}
{"patent_id": "10-2023-0139559", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "신뢰도 점수는 와 가 크고 비슷할수록 크다고 가정하면, 수학식4와 같은 벨형 함수(bell-shaped function)에 의해 계산될 수 있다. 수학식 4에서, p는 0과 1 사이의 값이고, 증강 인스턴스의 전체 길이에 대한 또는 의 정규화 값일 수 있다. 수학식 4"}
{"patent_id": "10-2023-0139559", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "레이블 병합부는 신뢰도 함수를 기초로, 한 쌍의 증강된 인스턴스들 Xleft , Xright로부터 얻은 타임스탬프 t에 서의 의사 레이블에 대한 신뢰도 점수 r(pleft(t)), r(pright(t))를 획득할 수 있다. 신뢰도 점수는 증강 인스턴스 의 중심에 가까울수록 큰 값을 가지고, 중심에서 최대값을 가질 수 있다. 신뢰도 점수 r(pleft(t)), r(pright(t))를 기초로 의사 레이블을 다르게 처리하기 위해, 각 의사 레이블에 신뢰도 점수로 계산된 가중치 βtloc를 적용할 수 있다. 가중치 βtloc는 두 신뢰도 점수 r(pleft(t)), r(pright(t))를 정규 화한 값으로 정의될 수 있으나, 이에 한정되는 것은 아니다. 레이블 병합부는 신뢰도 기반으로 계산된 가중치를 사용하여 의사 레이블들을 단일 크로스-윈도우 레이블 (single cross-window label)로 혼합할 수 있다. 수학식 5를 참고하면, 타임스탬프 t에서의 인공 레이블(소프트 레이블) 은, 왼쪽 증강 인스턴스 Xleft와 오른쪽 증강 인스턴스 Xright로부터 얻은 의사 레이블 와 에 해당 의사 레이블의 가중치 βtleft와 βtright를 곱해서 더한 값으로 계산될 수 있다. 수학식 5에서 onehot 함수는 스칼라 값을 원핫벡터로 변환하는 함수일 수 있다. 수학식 5"}
{"patent_id": "10-2023-0139559", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 5, "content": "타겟 인스턴스의 인공 레이블셋 은 수학식 6과 같이, 인공 레이블들의 집합으로 표현될 수 있다. 수학식 6"}
{"patent_id": "10-2023-0139559", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 6, "content": "타겟 인스턴스의 인공 레이블셋 과 정답 레이블셋 Y 사이의 손실을 기초로, 모델이 파라미터들을 업데이 트하면서 학습할 수 있다. 손실 함수는 다양하게 설계될 수 있다. 도 4는 한 실시예에 따른 시계열 데이터를 위한 준지도 학습 방법의 흐름도이다. 도 4를 참고하면, 모델 훈련 장치는 시계열 데이터에서 타겟 인스턴스를 샘플링한다(S110). 타겟 인스턴스 의 길이는 데이터셋의 특성을 고려하여 결정될 수 있다. 모델 훈련 장치는 타겟 인스턴스에, 연속된 주변 시퀀스의 컨텍스트를 추가하여 적어도 하나의 증강 인스 턴스 쌍을 생성한다(S120). 모델 훈련 장치는 추가되는 컨텍스트의 길이와 추가되는 컨텍스트 위치를 다양 하게 조절하여 하나의 타겟 인스턴스로부터 복수의 증강 인스턴스 쌍들을 생성할 수 있다. 모델 훈련 장치 는 일관성 정규화를 위해, 증강 인스턴스 쌍에서 중첩되는 데이터 포인트 수가 적도록(임베딩 공간에서의 거리가 멀어지도록), 타겟 인스턴스에 추가되는 컨텍스트를 선택할 수 있다. 예를 들면, 모델 훈련 장치는 타겟 인스턴스에 이전 시퀀스의 컨텍스트를 추가하여 이전 방향(왼쪽 방향)으로 증강된 인스턴스 Xleft를 생성하고, 타겟 인스턴스에 후속 시퀀스의 컨텍스트를 추가하여 후속 방향(오른쪽 방향)으로 증강된 인스턴스 Xrigh를 생성할 수 있다. 모델 훈련 장치는 두 증강 인스턴스 각각을 훈련 대상인 모델로 입력하고, 모델의 출력을 이용하 여 타겟 인스턴스의 타임스탬프들에 대한 두 의사 레이블셋들을 생성한다(S130). 모델 훈련 장치는 모델 로부터 증강 인스턴스 각각에 대해 추론된 분류 확률 벡터를 획득할 수 있다. 이때, 분류 확률 벡터는 타겟 인스턴스의 타임스탬프 구간에 대한 값만 사용할 수 있다. 모델은 증강 인스턴스의 타임스탬프별 분류 확률 을 추론할 수 있다. 모델 훈련 장치는 증강 인스턴스 각각에 대해 추론된 분류 확률 벡터에 신뢰 임계값을 적용하여, 타임스탬프별 의사 레이블을 결정할 수 있다. 모델 훈련 장치는 증강 인스턴스 쌍으로 얻은 두 의사 레이블셋들을 대응하는 의사 레이블끼리 신뢰도 기 반으로 병합하여 하나의 인공 레이블셋을 생성한다(S140). 모델 훈련 장치는 의사 레이블들을 단일 크로스 -윈도우 레이블(single cross-window label)로 혼합하여 인공 레이블(소프트 레이블)을 결정할 수 있다. 모델 훈련 장치는 특정 타임스탬프에서의 두 의사 레이블들을 해당 레이블의 신뢰도 기반으로 병합하여 타겟 인 스턴스에 대한 추론을 정규화할 수 있다. 모델 훈련 장치는 각 의사 레이블의 신뢰도 기반 가중치를 이용 하여 두 의사 레이블들을 혼합할 수 있다. 여기서, 각 증강 인스턴스의 특정 타임스탬프에서 획득된 의사 레이 블의 신뢰도는, 특정 타임스탬프가 해당 증강 인스턴스의 중심에 가까울수록 큰 값을 가질 수 있고, 신뢰도 계 산을 위한 함수는 다양하게 정의될 수 있다. 모델 훈련 장치는 증강 인스턴스 쌍으로부터 생성된 인공 레이블셋과 타겟 인스턴스의 정답 레이블셋 사이 의 손실을 기초로, 모델을 업데이트한다(S150). 모델 업데이트를 위한 손실 함수는 다양하게 정의될 수 있 다. 모델 훈련 동안, 단계 S110부터 S150은 반복될 수 있다. 모델 훈련 장치의 명령어들을 실행하는 프로세서를 포함하고, 프로세서는 명령어들을 실행함으로써, 시계 열 데이터에서 타겟 인스턴스를 샘플링하고, 타겟 인스턴스에, 연속된 주변 시퀀스의 컨텍스트를 추가하여 적어 도 하나의 증강 인스턴스 쌍을 생성하고, 두 증강 인스턴스 각각을 훈련 대상인 모델로 입력하고, 모델(1 0)의 출력을 이용하여 타겟 인스턴스의 타임스탬프들에 대한 두 의사 레이블셋들을 생성하고, 증강 인스턴스 쌍 으로 얻은 두 의사 레이블셋들을 대응하는 의사 레이블끼리 신뢰도 기반으로 병합하여 하나의 인공 레이블셋을 생성할 수 있다. 프로세서는 명령어들을 실행함으로써, 증강 인스턴스 쌍으로부터 생성된 인공 레이블셋과 타겟 인스턴스의 정답 레이블셋 사이의 손실을 기초로, 모델을 업데이트할 수 있다. 도 5는 한 실시예에 따른 모델 훈련 장치의 하드웨어 구성도이다. 도 10을 참고하면, 모델 훈련 장치는 적어도 하나의 프로세서에 의해 동작하는 컴퓨팅 장치일 수 있 다. 컴퓨팅 장치는 하나 이상의 프로세서, 프로세서에 의하여 실행되는 컴퓨터 프로그램을 로드 하는 메모리, 컴퓨터 프로그램 및 각종 데이터를 저장하는 스토리지, 통신 인터페이스, 그리고 이들을 연결하는 버스를 포함할 수 있다. 이외에도, 컴퓨팅 장치는 다양한 구성 요소가 더 포함될 수 있다. 프로세서는 컴퓨팅 장치의 각 구성의 전반적인 동작을 제어한다. 프로세서는 CPU(Central Processing Unit), MPU(Micro Processor Unit), MCU(Micro Controller Unit), GPU(Graphic Processing Unit) 또는 본 개시의 기술 분야에 잘 알려진 임의의 형태의 프로세서 중 적어도 하나를 포함하여 구성될 수 있다. 또 한, 프로세서는 본 개시의 다양한 실시예들에 따른 방법/동작을 실행하기 위한 적어도 하나의 애플리케이 션 또는 프로그램에 대한 연산을 수행할 수 있다. 메모리는 각종 데이터, 명령 및/또는 정보를 저장한다. 메모리는 본 개시의 다양한 실시예들에 따른 방법/동작을 실행하기 위하여 스토리지로부터 하나 이상의 프로그램을 로드할 수 있다. 메모리는 RAM 과 같은 휘발성 메모리로 구현될 수 있을 것이나, 본 개시의 기술적 범위는 이에 한정되지 않는다. 스토리지는 프로그램을 비임시적으로 저장할 수 있다. 스토리지는 ROM(Read Only Memory), EPROM(Erasable Programmable ROM), EEPROM(Electrically Erasable Programmable ROM), 플래시 메모리 등과 같은 비휘발성 메모리, 하드 디스크, 착탈형 디스크, 또는 본 개시가 속하는 기술 분야에서 잘 알려진 임의의 형태의 컴퓨터로 읽을 수 있는 기록 매체를 포함하여 구성될 수 있다. 통신 인터페이스는 컴퓨팅 장치의 유무선 통신을 지원한다. 이를 위해, 통신 인터페이스는 본 개시의 기술 분야에 잘 알려진 통신 모듈을 포함하여 구성될 수 있다. 버스는 컴퓨팅 장치의 구성 요소 간 통신 기능을 제공한 다. 버스는 주소 버스(Address Bus), 데이터 버스(Data Bus) 및 제어 버스(Control Bus) 등 다양한 형태의 버스로 구현될 수 있다. 컴퓨터 프로그램은 프로세서에 의해 실행되는 명령어들(instructions)을 포함하고, 비일시적-컴퓨터 판독 가능 저장매체(non-transitory computer readable storage medium)에 저장되며, 명령어들은 프로세서로 하여금 본 개시의 다양한 실시예에 따른 방법/동작을 수행하도록 만든다. 즉, 프로세서는 명령어들을 실행 함으로써, 본 개시의 다양한 실시예에 따른 방법/동작들을 수행할 수 있다. 명령어는 기능을 기준으로 묶인 일 련의 컴퓨터 판독가능 명령어들로서 컴퓨터 프로그램의 구성 요소이자 프로세서에 의해 실행되는 것을 가리킨다. 컴퓨터 프로그램은 네트워크를 통해 다운로드되거나, 제품 형태로 판매될 수 있다. 이와 같이, 본 개시에 따르면, 시계열 데이터의 레이블이 희소하더라도 시계열 데이터를 분류하는 모델을 안정 적으로 훈련시킬 수 있고, 다양한 종류의 시계열 데이터에 적용 가능한 범용성 있는 준지도 학습을 제공할 수 있다. 본 개시에 따르면, 희소 레이블을 가진 시계열 데이터를 이용한 학습 시, 데이터 자체를 변경할 필요 없이, 데 이터 인스턴스를 유지하면서 다양한 컨텍스트로 증강된 데이터 인스턴스를 생성하고 신뢰성 있는 레이블을 추론 할 수 있다. 이상에서 설명한 본 개시의 실시예는 장치 및 방법을 통해서만 구현이 되는 것은 아니며, 본 개시의 실시예의 구성에 대응하는 기능을 실현하는 프로그램 또는 그 프로그램이 기록된 기록 매체를 통해 구현될 수도 있다. 이상에서 본 개시의 실시예에 대하여 상세하게 설명하였지만 본 개시의 권리범위는 이에 한정되는 것은 아니고 다음의 청구범위에서 정의하고 있는 본 개시의 기본 개념을 이용한 당업자의 여러 변형 및 개량 형태 또한 본 개시의 권리범위에 속하는 것이다.도면 도면1 도면2 도면3 도면4 도면5"}
{"patent_id": "10-2023-0139559", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 한 실시예에 따른 모델 훈련 장치의 개념도이다. 도 2는 한 실시예에 따른 컨텍스트 추가 증강을 설명하는 도면이다. 도 3은 한 실시예에 따른 신뢰도 기반 레이블 병합 방법을 설명하는 도면이다. 도 4는 한 실시예에 따른 시계열 데이터를 위한 준지도 학습 방법의 흐름도이다. 도 5는 한 실시예에 따른 모델 훈련 장치의 하드웨어 구성도이다."}
