{"patent_id": "10-2021-0053080", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2022-0146159", "출원번호": "10-2021-0053080", "발명의 명칭": "메시지 암호화를 위한 종단 장치 및 그 방법", "출원인": "주식회사 케이티", "발명자": "황은지"}}
{"patent_id": "10-2021-0053080", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "메시지를 암호화하여 송수신하는 종단 장치에 있어서,암호화 키를 생성하는 암호화 키 생성부;메시지 원문 및 상기 암호화 키 생성부에서 생성된 신규 암호화 키를, 상기 암호화 키 생성부에서 생성되어 상대 종단 장치와 공유하고 있는 현재 암호화 키로 암호화하여 암호화 메시지를 생성하는 암호화부; 및상기 암호화 메시지를 상기 상대 종단 장치로 전송하는 송수신부를 포함하는 종단 장치."}
{"patent_id": "10-2021-0053080", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 암호화부는,상기 암호화 메시지에 대해 상기 상대 종단 장치로부터 수신 응답이 수신되는 경우, 상기 신규 암호화 키를 현재 암호화 키로서 사용하여 상기 수신 응답 이후의 메시지 원문을 암호화하는 것을 특징으로 하는 종단 장치."}
{"patent_id": "10-2021-0053080", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제2항에 있어서,상기 송수신부는,상기 수신 응답이 수신되기 전에, 상기 상대 종단 장치로부터 다른 신규 암호화 키를 포함하는 암호화 메시지가수신되는 경우 그 암호화 메시지에 대해 수신 응답을 미전송하는 것을 특징으로 하는 종단 장치."}
{"patent_id": "10-2021-0053080", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제1항에 있어서,상기 암호화부는,상기 암호화 메시지에 대해 상기 상대 종단 장치로부터 일정 시간 동안 수신 응답이 미수신되는 경우, 상기 신규 암호화 키는 폐기하고 상기 현재 암호화 키를 계속 사용하는 것을 특징으로 하는 종단 장치."}
{"patent_id": "10-2021-0053080", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제1항에 있어서,상기 암호화부는,상기 메시지 원문 및 상기 현재 암호화 키를 이용하여 해쉬 연산한 결과를 상기 현재 암호화 키로 더 암호화하여 상기 암호화 메시지를 생성하는 것을 특징으로 하는 종단 장치."}
{"patent_id": "10-2021-0053080", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제1항에 있어서,상기 암호화부는,상기 상대 종단 장치에서 상기 메시지 원문을 확인할 수 있도록 상기 암호화 메시지의 헤더에 상기 메시지 원문의 길이 정보를 포함하는 것을 특징으로 하는 종단 장치."}
{"patent_id": "10-2021-0053080", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "공개특허 10-2022-0146159-3-메시지를 암호화하여 송수신하는 종단 장치에 있어서,메시지 원문 및 신규 암호화 키를 포함하는 제1 암호화 메시지를 상대 종단 장치로부터 수신하는 송수신부; 및상기 상대 종단 장치와 공유하고 있는 현재 암호화 키로 상기 제1 암호화 메시지를 복호화하여, 상기 메시지 원문 및 상기 신규 암호화 키를 추출하고, 그 이후 상기 송수신부에서 수신하는 제2 암호화 메시지를 상기 추출한신규 암호화 키로 복호화하는 복호화부를 포함하는 종단 장치."}
{"patent_id": "10-2021-0053080", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제7항에 있어서,상기 복호화부는,상기 상대 종단 장치에서 상기 신규 암호화 키를 현재 암호화 키로서 사용할 수 있도록 상기 상대 종단 장치로상기 제1 암호화 메시지에 대한 수신 응답을 전송하는 것을 특징으로 하는 종단 장치."}
{"patent_id": "10-2021-0053080", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제7항에 있어서,상기 제2 암호화 메시지는, 해쉬 연산 값을 포함하고,상기 복호화부는,상기 제2 암호화 메시지를 상기 현재 암호화 키를 이용하여 복호화하고, 복호화한 메시지 원문 및 상기 현재 암호화 키를 이용하여 해쉬 연산한 제1 결과와, 복호화한 상기 해쉬 연산 값이 일치할 경우, 상기 추출한 신규 암호화 키는 미사용하고 상기 현재 암호화 키를 계속 사용하는 것을 특징으로 하는 종단 장치."}
{"patent_id": "10-2021-0053080", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제9항에 있어서,상기 복호화부는,상기 제1 결과와, 복호화한 상기 해쉬 연산 값이 일치하지 않을 경우,상기 제2 암호화 메시지를 상기 추출한 신규 암호화 키를 이용하여 복호화하고, 복호화한 메시지 원문 및 상기추출한 신규 암호화 키를 이용하여 해쉬 연산한 제2 결과와, 복호화한 상기 해쉬 연산 값을 비교하여, 일치할경우, 기존 현재 암호화 키는 폐기하고 상기 추출한 신규 암호화 키를 현재 암호화 키로서 사용하는 것을 특징으로 하는 종단 장치."}
{"patent_id": "10-2021-0053080", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "종단 장치에서 메시지를 암호화하여 송수신하는 방법에 있어서,상대 종단 장치와 현재 암호화 키를 공유하여 저장하는 단계;신규 암호화 키를 생성하는 단계;메시지 원문 및 상기 신규 암호화 키를, 상기 현재 암호화 키로 암호화하여 암호화 메시지를 생성하는 단계; 및상기 암호화 메시지를 상기 상대 종단 장치로 전송하는 단계를 포함하는 방법."}
{"patent_id": "10-2021-0053080", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제11항에 있어서,상기 암호화 메시지에 대해 상기 상대 종단 장치로부터 수신 응답을 수신하는 단계; 및상기 수신 응답의 수신에 따라, 상기 신규 암호화 키를 현재 암호화 키로서 사용하여 상기 수신 응답 이후의 메시지 원문을 암호화하여 상기 상대 종단 장치로 전송하는 단계를 더 포함하는 것을 특징으로 하는 방법."}
{"patent_id": "10-2021-0053080", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "공개특허 10-2022-0146159-4-제12항에 있어서,상기 수신 응답을 수신하는 단계 이전에,상기 상대 종단 장치로부터 다른 신규 암호화 키를 포함하는 암호화 메시지를 수신하고, 그 암호화 메시지에 대해 수신 응답을 미전송하는 단계를 더 포함하는 것을 특징으로 하는 방법."}
{"patent_id": "10-2021-0053080", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_14", "content": "제11항에 있어서,상기 암호화 메시지에 대해 상기 상대 종단 장치로부터 일정 시간 동안 수신 응답이 미수신되는 경우, 상기 신규 암호화 키를 폐기하는 단계를 더 포함하는 것을 특징으로 하는 방법."}
{"patent_id": "10-2021-0053080", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_15", "content": "제11항에 있어서,상기 암호화 메시지를 생성하는 단계는,상기 메시지 원문 및 상기 현재 암호화 키를 이용하여 해쉬 연산한 결과를 상기 현재 암호화 키로 더 암호화하여 상기 암호화 메시지를 생성하는 것을 특징으로 하는 방법."}
{"patent_id": "10-2021-0053080", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_16", "content": "제11항에 있어서,상기 암호화 메시지를 생성하는 단계는,상기 상대 종단 장치에서 상기 메시지 원문을 확인할 수 있도록 상기 암호화 메시지의 헤더에 상기 메시지 원문의 길이 정보를 포함하는 것을 특징으로 하는 방법."}
{"patent_id": "10-2021-0053080", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "종단간 통신 중에 수시로 암호화 키를 변경하여 메시지를 암호화함으로써, 공격자가 빠른 연산 능력으로 특정 암 호화된 메시지로부터 암호화 키를 알아내더라도 더 이상의 공격을 하지 못하도록 방어할 수 있는, 메시지 암호화 를 위한 종단 장치 및 그 방법이 개시된다. 일 실시예에 따른 메시지를 암호화하여 송수신하는 종단 장치는, 암 호화 키를 생성하는 암호화 키 생성부; 메시지 원문 및 상기 암호화 키 생성부에서 생성된 신규 암호화 키를, 상 기 암호화 키 생성부에서 생성되어 상대 종단 장치와 공유하고 있는 현재 암호화 키로 암호화하여 암호화 메시지 를 생성하는 암호화부; 및 상기 암호화 메시지를 상기 상대 종단 장치로 전송하는 송수신부를 포함한다."}
{"patent_id": "10-2021-0053080", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은, 종단간 암호화 기술에 관한 것으로, 보다 구체적으로 종단간 통신 중에 수시로 암호화 키를 변경하 여 메시지를 암호화하여 송수신하는 종단 장치 및 방법에 관한 것이다."}
{"patent_id": "10-2021-0053080", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "종단간 암호화(End-to-End Encryption)란 메시지를 전송하는 곳부터 수신하는 곳까지 모든 과정에서 암호화된 상태로 메시지를 전달하는 암호화 방식을 말한다. 종단간 암호화 통신에서 중간에 누군가 메시지를 가로채더라 도 암호화되어 있어 메시지의 원문을 알 수 없다. 종단간 암호화를 적용하게 되면 종단 장치에만 암호화 키가 존재하게 되어 암호화된 메시지가 서버를 거치더라도 서버의 관리자는 암호화 키를 갖고 있지 않기 때문에 메시 지의 원문을 확인할 수 없다. 수신측 종단 장치만이 자신의 내부에 저장되어 있는 암호화 키로 암호화된 메시지 를 복호화할 수 있으므로 보안/프라이버시가 중요시되는 메시징 서비스(Ex. 텔레그램) 등에 종단간 암호화 기술 이 적용되어 있다. 종단간 암호화 기술의 대표적인 적용 예는 SSL(Secure Socket Layers)/TLS(Transport Layer Security)가 있다. SSL/TLS는 네트워크 통신시 TCP 기반의 어플리케이션(Application)에 대한 종단간 보안 서비스를 제공하기 위해 만들어진 전송 계층 보안 프로토콜이다. SSL/TLS에서는 핸드쉐이킹(handshaking) 절차를 거쳐 키를 교환하고, 메시지의 무결성 및 신뢰성 보장을 위해 사용할 MAC(Message Authentication Code) 알고리즘을 협상한 후 메시 지를 암호화하여 전송하게 된다. SSL/TLS에서의 대표적인 키 교환 알고리즘은 RSA(Rivest Shamir Adleman) 알고 리즘이다. SSL/TLS에서 사용되고 있는 RSA 암호화 알고리즘을 현재의 컴퓨팅 기술로는 풀어낼 수 없다. RSA 알고리즘은 매 우 큰 두 개의 소수를 곱한 값을 키로 사용하는데, 현재의 컴퓨팅 연산 능력으로는 빠르게 소인수분해를 할 수 없기 때문이다. 하지만 한 번에 많은 양의 연산을 단시간내에 수행 가능한 컴퓨팅 기술이 도래할 경우, 이러한암호화 방식은 무용지물이 된다. 공격자가 암호화 키를 알아내고 나면 같은 암호화 키로 암호화된 메시지를 중 간에 가로채어 원문을 확인할 수 있기 때문이다. 따라서 종단간 통신을 하는 동안 빠른 연산 능력에 의해 공격 자가 암호화 키를 알아내더라도 암호화된 메시지로부터 원문을 알아낼 수 없도록 강화된 암호화 방식이 필요하 다."}
{"patent_id": "10-2021-0053080", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은 상술한 문제점을 해결하기 위해 제안된 것으로, 종단간 통신 중에 수시로 암호화 키를 변경하여 메시 지를 암호화함으로써, 공격자가 빠른 연산 능력으로 특정 암호화된 메시지로부터 암호화 키를 알아내더라도 더 이상의 공격을 하지 못하도록 방어할 수 있는, 메시지 암호화를 위한 종단 장치 및 그 방법을 제공하는데 그 목 적이 있다."}
{"patent_id": "10-2021-0053080", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "일 실시예에 따른 메시지를 암호화하여 송수신하는 종단 장치는, 암호화 키를 생성하는 암호화 키 생성부; 메시 지 원문 및 상기 암호화 키 생성부에서 생성된 신규 암호화 키를, 상기 암호화 키 생성부에서 생성되어 상대 종 단 장치와 공유하고 있는 현재 암호화 키로 암호화하여 암호화 메시지를 생성하는 암호화부; 및 상기 암호화 메 시지를 상기 상대 종단 장치로 전송하는 송수신부를 포함한다. 상기 암호화부는, 상기 암호화 메시지에 대해 상기 상대 종단 장치로부터 수신 응답이 수신되는 경우, 상기 신 규 암호화 키를 현재 암호화 키로서 사용하여 상기 수신 응답 이후의 메시지 원문을 암호화할 수 있다. 상기 송수신부는, 상기 수신 응답이 수신되기 전에, 상기 상대 종단 장치로부터 다른 신규 암호화 키를 포함하 는 암호화 메시지가 수신되는 경우 그 암호화 메시지에 대해 수신 응답을 미전송할 수 있다. 상기 암호화부는, 상기 암호화 메시지에 대해 상기 상대 종단 장치로부터 일정 시간 동안 수신 응답이 미수신되 는 경우, 상기 신규 암호화 키는 폐기하고 상기 현재 암호화 키를 계속 사용할 수 있다. 상기 암호화부는, 상기 메시지 원문 및 상기 현재 암호화 키를 이용하여 해쉬 연산한 결과를 상기 현재 암호화 키로 더 암호화하여 상기 암호화 메시지를 생성할 수 있다. 상기 암호화부는, 상기 상대 종단 장치에서 상기 메시지 원문을 확인할 수 있도록 상기 암호화 메시지의 헤더에 상기 메시지 원문의 길이 정보를 포함할 수 있다. 다른 실시예에 따른, 메시지를 암호화하여 송수신하는 종단 장치는, 메시지 원문 및 신규 암호화 키를 포함하는 제1 암호화 메시지를 상대 종단 장치로부터 수신하는 송수신부; 및 상기 상대 종단 장치와 공유하고 있는 현재 암호화 키로 상기 제1 암호화 메시지를 복호화하여, 상기 메시지 원문 및 상기 신규 암호화 키를 추출하고, 그 이후 상기 송수신부에서 수신하는 제2 암호화 메시지를 상기 추출한 신규 암호화 키로 복호화하는 복호화부를 포함한다. 상기 복호화부는, 상기 상대 종단 장치에서 상기 신규 암호화 키를 현재 암호화 키로서 사용할 수 있도록 상기 상대 종단 장치로 상기 제1 암호화 메시지에 대한 수신 응답을 전송할 수 있다. 상기 제2 암호화 메시지는, 해쉬 연산 값을 포함하고, 상기 복호화부는, 상기 제2 암호화 메시지를 상기 현재 암호화 키를 이용하여 복호화하고, 복호화한 메시지 원문 및 상기 현재 암호화 키를 이용하여 해쉬 연산한 제1 결과와, 복호화한 상기 해쉬 연산 값이 일치할 경우, 상기 추출한 신규 암호화 키는 미사용하고 상기 현재 암호 화 키를 계속 사용할 수 있다. 상기 복호화부는, 상기 제1 결과와, 복호화한 상기 해쉬 연산 값이 일치하지 않을 경우, 상기 제2 암호화 메시 지를 상기 추출한 신규 암호화 키를 이용하여 복호화하고, 복호화한 메시지 원문 및 상기 추출한 신규 암호화 키를 이용하여 해쉬 연산한 제2 결과와, 복호화한 상기 해쉬 연산 값을 비교하여, 일치할 경우, 기존 현재 암호 화 키는 폐기하고 상기 추출한 신규 암호화 키를 현재 암호화 키로서 사용할 수 있다. 또 다른 실시예에 따른 종단 장치에서 메시지를 암호화하여 송수신하는 방법은, 상대 종단 장치와 현재 암호화 키를 공유하여 저장하는 단계; 신규 암호화 키를 생성하는 단계; 메시지 원문 및 상기 신규 암호화 키를, 상기 현재 암호화 키로 암호화하여 암호화 메시지를 생성하는 단계; 및 상기 암호화 메시지를 상기 상대 종단 장치로전송하는 단계를 포함한다. 상기 방법은, 상기 암호화 메시지에 대해 상기 상대 종단 장치로부터 수신 응답을 수신하는 단계; 및 상기 수신 응답의 수신에 따라, 상기 신규 암호화 키를 현재 암호화 키로서 사용하여 상기 수신 응답 이후의 메시지 원문 을 암호화하여 상기 상대 종단 장치로 전송하는 단계를 더 포함할 수 있다. 상기 방법은, 상기 수신 응답을 수신하는 단계 이전에, 상기 상대 종단 장치로부터 다른 신규 암호화 키를 포함 하는 암호화 메시지를 수신하고, 그 암호화 메시지에 대해 수신 응답을 미전송하는 단계를 더 포함할 수 있다. 상기 방법은, 상기 암호화 메시지에 대해 상기 상대 종단 장치로부터 일정 시간 동안 수신 응답이 미수신되는 경우, 상기 신규 암호화 키를 폐기하는 단계를 더 포함할 수 있다. 상기 암호화 메시지를 생성하는 단계는, 상기 메시지 원문 및 상기 현재 암호화 키를 이용하여 해쉬 연산한 결 과를 상기 현재 암호화 키로 더 암호화하여 상기 암호화 메시지를 생성할 수 있다. 상기 암호화 메시지를 생성하는 단계는, 상기 상대 종단 장치에서 상기 메시지 원문을 확인할 수 있도록 상기 암호화 메시지의 헤더에 상기 메시지 원문의 길이 정보를 포함할 수 있다."}
{"patent_id": "10-2021-0053080", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명은, 종단간 통신 중에 수시로 암호화 키를 변경하여 메시지를 암호화함으로써, 공격자가 빠른 연산 능력 으로 특정 암호화된 메시지로부터 암호화 키를 알아내더라도 더 이상의 공격을 하지 못하도록 방어할 수 있다. 즉, 공격자가 특정 암호화 메시지로부터 암호화 키를 알아내더라도, 그 이후의 암호화 메시지의 암호화 키는 변 경되므로, 공격자는 더 이상의 해킹을 할 수 없어, 종단간 통신의 보안성이 향상된다."}
{"patent_id": "10-2021-0053080", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "상술한 목적, 특징 및 장점은 첨부된 도면과 관련한 다음의 상세한 설명을 통하여 보다 분명해 질 것이며, 그에"}
{"patent_id": "10-2021-0053080", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "따라 본 발명이 속하는 기술분야에서 통상의 지식을 가진 자가 본 발명의 기술적 사상을 용이하게 실시할 수 있 을 것이다. 또한, 본 발명을 설명함에 있어서 본 발명과 관련된 공지 기술에 대한 구체적인 설명이 본 발명의 요지를 불필요하게 흐릴 수 있다고 판단되는 경우에 그 상세한 설명을 생략하기로 한다. 이하, 첨부된 도면을 참조하여 본 발명에 따른 바람직한 일 실시예를 상세히 설명하기로 한다. 도 1은 본 발명의 일 실시예에 따른 종단 장치들을 나타낸 도면이다. 도 1을 참조하면, 두 종단 장치(110, 12 0)는 네트워크를 통해 통신을 하며, 통신 중에 메시지를 암호화 키로 암호화하여 송수신한다. 종단 장치 (110, 120)는 통신 경로상의 끝에 존재하는 통신 장치로서, 예를 들어, 가스 센서, 화재 감지 센서, 카메라, 인 공지능 스피커, 스마트폰 등의 통신 단말이나, 이러한 통신 단말과 통신하는 서버를 포함한다. 종단 장치(110, 120)는, 메모리와 프로세서 및 통신 회로 등을 포함하여 다른 종단 장치(110, 120)와 통신할 수 있다. 여기서 네트워크는, 유선 네트워크, 무선 네트워크, 또는 이들의 결합을 포함한다. 유선 네트워크는, TCP/IP 프로 토콜을 지원하는 근거리 또는 광역 인터넷을 포함한다. 무선 네트워크는, 기지국에 기반한 무선 통신망, 위성통신망, 와이파이와 같은 근거리 무선 통신망 또는 이들의 결합을 포함한다. 도 1을 참조하면, 종단 장치(110, 120)는, 송수신부(111, 121), 암호화 키 생성부(112, 122), 암호화부(113, 123) 및 복호화부(114, 124)를 포함한다. 이러한 구성요소들은 프로그램으로 구현되어 메모리에 저장되고 적어 도 하나의 프로세서에 의해 실행될 수 있고, 또는 하드웨어 및 소프트웨어의 조합으로 구현되어 실행될 수 있다. 이하에서는, 두 종단 장치(110, 120) 중 제1 종단 장치를 송신 장치로, 제2 종단 장치를 수신 장치로 설명한다. 송신 장치의 송수신부는, 수신 장치와 데이터를 송수신한다. 암호화된 암호화 메시지를 송수신 할 수 있고, 또는 암호화 키를 생성하기 위한 데이터를 송수신할 수 있으며, 각종 메시지의 수신 응답을 송수신 할 수 있다. 송신 장치의 암호화 키 생성부는, 최초에 상기 송수신부를 통해 SSL/TLS 프로토콜에 따라 핸드 쉐이킹 절차를 거쳐 수신 장치와 키를 교환하여 상호 동일한 암호화 키를 생성하고, 또한 메시지의 무결성 및 신뢰성 보장을 위해 사용할 MAC(Message Authentication Code) 알고리즘을 협상한다. 핸드쉐이킹 절차에서 키 교환 알고리즘으로서 RSA(Rivest Shamir Adleman) 알고리즘이 사용될 수 있으나, 여기에 제한되지 않는다. 또한 SSL/TLS 프로로콜에 따라 초기 암호화 키 생성을 설명하지만 여기에 제한되는 것은 아니다. 송신 장치의 암호화 키 생성부는, 상술한 바와 같이 최초에 수신 장치와 동일한 암호화 키를 생 성하고, 이후에는 암호화부의 요청에 따라 매번 다른 암호화 키를 생성한다. 즉, 최초에만 핸드쉐이킹 절 차를 통해 송신 장치와 수신 장치 간에 동일한 암호화 키를 생성하고, 이후에는 송신 장치의 암 호화 키 생성부에서 수시로 신규 암호화 키를 생성하고, 이하에서 설명하는 바와 같이 신규 암호화 키가 메시지 원문과 함께 암호화되어 수신 장치로 전송 및 공유된다. 송신 장치의 암호화부는, 상기와 같이 최초 암호화 키가 생성된 후, 암호화 대상 메시지인 메시지 원 문(plaintext)과 상기 최초 암호화 키를 이용하여 해쉬 연산을 하여 MAC(Message Authentication Code)를 생성 한다. 그리고 암호화부는, 상기 암호화 키 생성부로 신규 암호화 키 생성을 요청하여 수신되는 신규 암호화 키를 상기 MAC와 함께 상기 최초 암호화 키로 암호화한 암호화 메시지를 상기 송수신부를 통해 수 신 장치로 전송한다. 일 실시예에서, 암호화부는, 암호화 대상 메시지가 발생할 때마다, 상기 암호화 키 생성부로 신규 암 호화 키 생성을 요청하고, 이로부터 생성된 신규 암호화 키를 별도의 저장부에 보관한 후, 현재 암호화 키와 현 재 암호화 대상 메시지를 이용하여 생성한 MAC과 함께 신규 암호화 키를 현재 암호화 키로 암호화하고, 그 암호 화 메시지를 상기 송수신부를 통해 수신 장치로 전송한다. 따라서, 여기서의 현재 암호화 키는, 이전 직전에 수신 장치로 암호화하여 전송한 신규 암호화 키일 수 있다. 즉, 암호화부는, 암호화 대상 메 시지가 발생할 때마다, 매번 다른 신규 암호화 키를 메시지 원문과 함께 직전의 신규 암호화 키로 암호화하여 수신 장치로 전송함으로써, 암호화 키를 변경한다. 일 실시예에서, 암호화부는, 메시지가 발생할 때마다, 현재 암호화 키로 암호화한다. 암호화부는, 메 시지가 발생할 때마다 신규 암호화 키를 포함하여 암호화하지 않고, 임의의 시간에 신규 암호화 키를 포함하여 암호화할 수 있다. 메시지가 발생할 때마다 신규 암호화 키를 생성하고 신규 암호화 키를 포함하여 메시지를 암 호화할 경우 부하를 가중시킬 수 있으므로, 현재 암호화 키로 여러 번 메시지를 암호화하고, 임의의 랜덤한 시 간에 상기 암호화 키 생성부에서 생성된 신규 암호화 키를 포함하여 메시지를 암호화하는 것이 바람직하다. 도 2는 본 발명의 일 실시예에 따른 송신 장치에서 신규 암호화 키를 메시지 원문과 함께 암호화하는 과정을 설 명하는 도면이다. 도 2를 참조하면, 송신 장치는, 메시지 원문(Plaintext)과 현재 암호화 키 (Key1)를 이용하여 해쉬 연산(Hash Function)을 하여 MAC을 생성한다. 그리고 송신 장치 는, 신규 암호화 키(Key2)를 생성하고, 그 신규 암호화 키(Key2)와 상기 메시지 원문 그리고 상 기 MAC을 함께 상기 현재 암호화 키(Key1)로 암호화(Encryption)하고, 암호화 메시지 (Ciphertext)를 수신 장치로 전송한다. 다른 실시예에서, 암호화부는, 신규 암호화 키를 포함하는 암호화 메시지를 수신 장치로 전송한 후, 송수신부를 통해 수신 장치로부터 해당 암호화 메시지에 대한 수신 응답이 수신되면, 그때부터 수신 장치로 전송하였던 상기 신규 암호화 키를 이용하여 암호화를 수행한다. 즉, 암호화부는, 기존에 사 용하던 암호화 키는 폐기하고, 신규 암호화 키를 현재 암호화 키로 사용한다. 도 2를 참조하면, 암호화 메시지를 수신 장치로 전송한 후, 수신 장치로부터 수신 응답이 수신되면, 그때부터 암호화부는, 신규 암호화 키(Key2)를 현재 암호화 키로서 사용한다. 복호화부는, 수신 장치로부터 전송되어 상기 송수신부를 통해 수신되는 암호화 메시지를 현재 암호화 키로 복호화한다. 수신 장치는, 송신 장치로부터 수신된 암호화 메시지에 포함되어 있는 신규 암호화 키를 복호화하여 보관하고, 그 신규 암호화 키를 이용하여 암호화한 암호화 메시지를 송신 장치로 전송할 수 있다. 이에 따라 복호화부는, 별도의 저장부에 저장된 신규 암호화 키를 현재 암호화 키로서 사 용하여 수신 장치로부터 수신된 암호화 메시지를 복호화한다. 바람직하게, 복호화부는, 신규 암호화 키를 포함하는 암호화 메시지가 수신 장치로 전송된 후, 송수신부를 통해 수신 장치로부터 해당 암호화 메시지에 대한 수신 응답이 수신되면, 그때부터 신규 암호화 키를 현재 암호화 키로서 사용한다. 복호화 부는, 수신 장치로부터 수신된 암호화 메시지에 대한 복호화가 완료되면, 송수신부를 통해 수신 장치로 수신 응답을 전송할 수 있다. 도 1을 참조하면, 수신 장치의 송수신부는, 송신 장치와 데이터를 송수신한다. 암호화된 암호화 메시지를 송수신할 수 있고, 또는 암호화 키를 생성하기 위한 데이터를 송수신할 수 있으며, 각종 메시지의 수 신 응답을 송수신할 수 있다. 수신 장치의 암호화 키 생성부는, 최초에 상기 송수신부를 통해 SSL/TLS 프로토콜에 따라 핸드 쉐이킹 절차를 거쳐 송신 장치와 키를 교환하여 상호 동일한 암호화 키를 생성하고, 또한 메시지의 무결성 및 신뢰성 보장을 위해 사용할 MAC(Message Authentication Code) 알고리즘을 협상한다. 핸드쉐이킹 절차에서 키 교환 알고리즘으로서 RSA(Rivest Shamir Adleman) 알고리즘이 사용될 수 있으나, 여기에 제한되지 않는다 . 또한 SSL/TLS 프로로콜에 따라 초기 암호화 키 생성을 설명하지만 여기에 제한되는 것은 아니다. 수신 장치의 암호화 키 생성부는, 수신 장치가 송신 장치로서 동작할 때, 앞서 설명한 송신 장 치의 암호화 키 생성부와 동일한 기능 및 동작을 수행한다. 또한, 수신 장치의 암호화 키 생성 부는, 수신 장치가 본 실시예에서 설명하는 수신 장치로서 동작하지만 송신 장치로 메시지 를 전송할 때 송신 장치로부터 수신된 암호화 키가 아닌 수신 장치의 암호화 키 생성부에서 생 성된 신규 암호화 키를 사용할 경우, 앞서 설명한 송신 장치의 암호화 키 생성부와 동일한 기능 및 동작을 수행할 수 있다. 수신 장치의 암호화부는, 송신 장치로 메시지를 전송할 경우, 송신 장치와 동일하게 공유 하고 있는 암호화 키를 이용하여 메시지 원문을 암호화한 암호화 메시지를 상기 송수신부를 통해 송신 장 치로 전송한다. 여기서 송신 장치와 동일하게 공유하고 있는 암호화 키는, 송신 장치로부터 수 신된 암호화 메시지에 포함되어 있는 신규 암호화 키이다. 즉, 암호화부는, 최초에는 핸드쉐이킹 절차를 통해 송신 장치와 동일하게 공유하는 암호화 키를 이용하여 암호화를 수행하다가 이후 송신 장치로부 터 수신되는 암호화 메시지에 포함되어 있는 신규 암호화 키를 이용하여 암호화를 수행한다. 일 실시예에서, 수신 장치가 송신 장치로서 동작할 때, 수신 장치의 암호화부는, 앞서 설명한 송신 장치의 암호화부와 동일한 기능 및 동작을 수행한다. 또한, 수신 장치가 본 실시예에서 설 명하는 수신 장치로서 동작하지만 송신 장치로 메시지를 전송할 때 송신 장치로부터 수신된 신 규 암호화 키가 아닌 수신 장치의 암호화 키 생성부에서 생성된 신규 암호화 키를 사용할 경우, 수신 장치의 암호화부는, 앞서 설명한 송신 장치의 암호화부와 동일한 기능 및 동작을 수행할 수 있다. 복호화부는, 상기 송수신부에서 수신되는 암호화 메시지를 현재 암호화 키로 복호화한다. 복호화부 는, 암호화 메시지로부터 복호화되는 신규 암호화 키를 별도의 저장부에 저장할 수 있다. 복호화부는, 암호화 메시지의 복호화가 성공하면, 상기 송수신부를 통해 송신 장치로 수신 응답 을 전송할 수 있다. 일 실시예에서, 복호화부는, 암호화 메시지를 현재 암호화 키로 복호화하여 메시지 원문을 추출한 후, 추 출한 메시지 원문과 기 사용 중인 현재 암호화 키를 이용하여 해쉬 연산을 하여 MAC을 생성한다. 그리고 복호화 부는, 그 생성한 MAC과 상기 암호화 메시지로부터 복호화된 MAC이 일치하는지 검증하고, 일치할 경우, 상 기 암호화 메시지로부터 복호화된 신규 암호화 키를 별도의 저장부에 저장한다. 도 3은 본 발명의 일 실시예에 따른 수신 장치에서 신규 암호화 키를 수신하여 보관하는 과정을 설명하는 도면 이다. 도 3을 참조하면, 수신 장치는, 송신 장치로부터 암호화 메시지(Ciphertext)를 수신하고,수신된 암호화 메시지(Ciphertext)를 현재 암호화 키(Key1)로 복호화한다. 수신 장치는, 현재 암호화 키(Key1)로 복호화된 메시지 원문(Plaintext)과 현재 암호화 키(Key1)를 이용하여 해쉬 연산(Hash Function)을 하여 MAC을 생성한다. 그리고 수신 장치는, 그 생성한 MAC과 상기 암호화 메시지로부터 복호화된 MAC을 비교하여 일치하는지 검증한다. 수신 장치는, MAC이 일치하는 경우, 상기 암호화 메시지로부터 복호화된 신규 암호화 키(Key2)를 별도의 저장부에 저장하 여 보관한다. 일 실시예에서, 복호화부는, 암호화 메시지를 현재 암호화 키로 복호화하여 메시지 원문을 추출한 후, 추 출한 메시지 원문과 기 사용 중인 현재 암호화 키를 이용하여 해쉬 연산을 하여 MAC을 생성하고, 그 생성한 MAC 과 상기 암호화 메시지로부터 복호화된 MAC이 일치하지 않는 경우, 별도의 저장부에 보관 중인 신규 암호화 키 를 이용하여 동일한 과정을 수행하여 MAC이 일치하는지 검증한다. 복호화부는, 보관 중인 신규 암호화 키 로 MAC을 검증한 결과 일치할 경우, 기존 사용 중이던 암호화 키는 폐기하고, 보관 중인 신규 암호화 키를 현재 암호화 키로서 사용한다. 만약, 보관 중인 신규 암호화 키로 암호화 메시지를 복호화한 결과, 해당 암호화 메시 지로부터 또 다른 신규 암호화 키가 추출되는 경우, 그 또 다른 신규 암호화 키는 별도의 저장부에 보관하여 미 래에 앞서 설명한 검증을 통해 사용한다. 도 4는 본 발명의 일 실시예에 따른 수신 장치에서 보관 중인 신규 암호화 키를 현재 암호화 키로 사용하는 과 정을 설명하는 도면이다. 본 실시예에서, 송신 장치는 메시지를 신규 암호화 키(Key2)로 암호화하여 수신 장치로 전송한 경우이다. 도 4를 참조하면, 수신 장치는, 송신 장치로부터 암호화 메시지 (Ciphertext)를 수신하고, 수신된 암호화 메시지(Ciphertext)를 현재 암호화 키(Key1)로 복호 화한다. 수신 장치는, 현재 암호화 키(Key1)로 복호화된 메시지 원문(Plaintext)과 현재 암호화 키(Key1)를 이용하여 해쉬 연산(Hash Function)을 하여 MAC을 생성한다. 그리고 수신 장치는, 그 생성한 MAC과 상기 암호화 메시지로부터 복호화된 MAC을 비교하여 일치하는지 검증하는데, 본 실시예에서 일치하지 않는다. 따라서, 수신 장치는, 암호화 메시지(Ciphertext)를 기 보관 중인 신규 암호화 키(Key2)로 복 호화한다. 수신 장치는, 복호화된 메시지 원문(Plaintext)과 신규 암호화 키(Key2)를 이 용하여 해쉬 연산(Hash Function)을 하여 MAC을 생성한다. 그리고 수신 장치는, 그 생성한 MAC과 상기 암호화 메시지로부터 복호화된 MAC을 비교하여 일치하는지 검증하는데, 본 실시예에 서 일치한다. 따라서, 수신 장치는, 기존 사용하던 암호화 키(Key1)는 폐기하고 이후 수신되는 암호 화 메시지를 신규 암호화 키(Key2)로 복호화하고, 또한 송신 장치로 전송하는 메시지를 신규 암호화 키(Key2)로 암호화한다. 이상의 실시예에서는, 송신 장치가 신규 암호화 키를 암호화 메시지에 포함하여 수신 장치로 전송하 는 예를 설명한다. 수신 장치는 수시로 수신되는 신규 암호화 키를 보관하였다가 기존 암호화 키를 폐기하 고 보관 중인 신규 암호화 키를 사용한다. 그러나 이러한 실시예에 제한되는 것은 아니며, 수신 장치가 신 규 암호화 키를 생성하고 암호화 메시지에 포함하여 송신 장치로 전송할 수도 있다. 이 경우, 송신 장치 와 수신 장치는 암호화 키로서 어떤 암호화 키를 사용해야 하는지 정확히 판단할 수 없다. 즉, 송신 장치는 수신 장치로 자신이 생성한 신규 암호화 키를 전송하였는데 수신 장치로부터 또 다른 신 규 암호화 키를 수신하게 되므로, 자신이 생성한 신규 암호화 키를 사용하여 암호화를 해야 할지, 아니면 수신 장치로부터 수신된 신규 암호화 키를 사용하여 암호화를 해야 할지 정확이 판단할 수 없다. 수신 장치 도 마찬가지이다. 이러한 암호화 키의 꼬임을 방지하기 위해, 송신 장치와 수신 장치는, 자신이 생성한 신규 암호화 키 를 포함한 암호화 메시지를 상대 장치로 전송한 후 이에 대한 수신 응답이 수신되기 전에, 상대 장치로부터 또 다른 신규 암호화 키를 포함하는 암호화 메시지가 수신되는 경우, 해당 암호화 메시지에 대해 수신 응답을 상대 장치로 전송하지 않음으로써, 키 교환을 중단한다. 즉, 송신 장치의 복호화부는, 송신 장치에서 생성한 신규 암호화 키를 포함한 암호화 메시지가 수신 장치로 전송된 후 이에 대한 수신 응답이 수신되기 전에, 수신 장치로부터 또 다른 신규 암호화 키를 포함하는 암호화 메시지가 수신되는 경우, 해당 수신 장치로부터 수신된 암호화 메시지에 대해 수신 응답을 수신 장치로 전송하지 않는다. 수신 장치의 복호화부도 마찬가지로 수신 응답을 송신 장 치로 전송하지 않는다. 그리고, 송신 장치와 수신 장치는, 상대 장치로 수신 응답을 전송하지 않은 상태에서 일정한 시간 동 안 상대 장치로부터, 신규 암호화 키를 포함한 암호화 메시지의 전송에 대한 수신 응답이 수신되지 않거나, 상 대 장치로부터 수신된 신규 암호화 키로 암호화된 암호화 메시지가 상대 장치로부터 수신되지 않는 경우, 상대 장치로 전송하였던 신규 암호화 키 그리고 상대 장치로부터 수신하였던 또 다른 신규 암호화 키를 모두 폐기하 고, 기 사용 중인 현재 암호화 키를 계속 사용한다. 이후에, 송신 장치 또는 수신 장치 중 어느 하나 의 종단 장치에서만 또 다른 신규 암호화 키를 포함하는 암호화 메시지를 상대 장치로 전송할 경우, 앞서 설명 한 절차에 따라 현재 암호화 키를 그 신규 암호화 키로 변경하여 사용한다. 도 5는 본 발명의 일 실시예에 따른 암호화 메시지에 신규 암호화 키를 삽입하는 계층을 나타낸 도면이다. 본 실시예에서 신규 암호화 키를 삽입하는 계층을 키 변환 계층(key transformation layer)이라고 정의한다. 키 변 환 계층은 TCP 통신에서 사용되는 SSL/TLS와 같이 별도의 네트워크 계층으로 정의되어 메시지를 암호화하는데 사용될 수 있다. 키 변환 계층은, 암호화부(113, 123) 및 복호화부(114, 124)에 구현된다. 메시지 원문을 암호화하여 전송할 때, 도 5에 도시된 바와 같이, 키 변환 계층은, 상위 계층(Upper Layer)으로부터 메시지 원문(Plaintext)를 수신하면, 메시지 원문을 여러 개의 조각(Fragmentation)으로 분할한다. 이어서, 키 변환 계층은, 첫 번째 조각을 압축(compression)하고, 그 압축된 조각의 뒤에 다음 에 사용된 신규 암호화 키(Keyn+1)와 MAC을 덧붙인다. 이때, 신규 암호화 키가 삽입되는 필드는 고정된 길이의 암호화 키 값으로 채워지거나, 암호화 키가 없을 때는 0으로 채워질 수 있다. 혹은 초기 암호화 키를 생성하는 데 있어서 교환하는 핸드쉐이크 과정에서 정한 임의의 값일 수 있다. 그리고 MAC은, 해당 조각과 기 사용 중인 현재 암호화 키를 이용하여 해쉬 연산으로 생성된 값이다. 키 변환 계층은, 첫 번째 조각과 여기에 덧붙여진 신규 암호화 키(Keyn+1) 및 MAC을 현재 암호화 키로 암호 화한다. 이때, 키 변환 계층은, 조각과 신규 암호화 키 그리고 MAC을 각각 암호화하여 연결하여 하나의 암 호화된 조각으로 만들거나, 또는 조각과 신규 암호화 키 그리고 MAC을 모두 연결한 상태에서 암호화하여 하나의 암호화된 조각을 만들 수 있다. 이후 키 변환 계층은, 하위 계층(Lower Layer)으로 보내기 전 암호화된 조 각 앞에 키 변환 헤더(Key Transforming Header)를 덧붙인다. 키 변환 헤더에는 상기 신규 암호화 키 및 MAC을 제외한 조각의 길이를 나타내는 길이(Length) 필드가 있으며 이 길이 필드는 고정된 크기를 갖고(예: 1 Byte와 같은 작은 크기), 해당 조각의 길이에 대한 값이 기록된다. 이와 같은 첫 번째 조각을 암호화하여 전송한 후 이어지는 조각들도 동일한 과정으로 암호화되어 전송된다. 이 때, 신규 암호화 키가 삽입되는 필드에는 또 다른 신규 암호화 키의 값이 삽입될 수 있고, 또는 신규 암호화 키 의 값이 삽입되지 않고 0으로 값이 채워질 수 있다. 또 다른 신규 암호화 키의 값이 채워질 경우, 해당 조각은 이전 신규 암호화 키로 암호화되고, 0으로 값이 채워질 경우에는, 첫 번째 조각과 동일한 현재 암호화 키로 암 호화된다. 위와 같이 암호화된 암호화 메시지를 수신한 측의 키 변환 계층은, 하위 계층으로부터 암호화 메시지 를 수신하고, 키 변환 헤더로부터 길이 필드 정보를 확인한다. 그리고 키 변환 계층은, 키 변환 헤더를 제 거한 후에 현재 암호화 키로 해당 암호화 메시지를 복호화하고, 상기 길이 필드 정보를 기초로 해당 복호화된 조각으로부터 메시지 원문의 조각을 찾아 압축을 풀어 메시지 원문의 조각을 확인한다. 이때, 키 변환 계층 은, 현재 암호화 키로 MAC 검증에 실패할 경우, 기 보관 중인 신규 암호화 키를 사용하여 MAC 검증을 하게 된다. MAC 검증에 성공한 경우, 키 변환 계층은, 신규 암호화 키가 삽입된 고정된 길이의 필드의 값을 확 인하여, 0 혹은 핸드쉐이크 과정에서 정한 임의의 값이 아닌 경우, 해당 필드의 값을 다음에 사용할 신규 암호 화 키로서 보관한다. 이상에서 설명한 키 변환 계층은 응용 계층과 SSL/TLS 계층 사이에서 동작할 수도 있고, 또는 SSL/TLS 계 층의 하위에서 동작할 수도 있다. 응용 계층과 SSL/TLS 계층 사이에서 동작할 경우, 키 변환 계층은, 응용 계층에서 수신되는 메시지 원문을 수시로 변하는 암호화 키로 1차 암호화하여 SSL/TLS 계층으로 전달하고, SSL/TLS 계층은 기존과 동일하게 항상 고정된 암호화 키로 2차 암호화하여 상대 종단 장치로 전송할 수 있다. 또는, SSL/TLS 계층의 하위에서 동작할 경우, 키 변환 계층은, SSL/TLS 계층에서 1차 암호화된 암호화 메 시지를 수신하여 수시로 변하는 암호화 키로 2차 암호화하여 상대 종단 장치로 전송할 수 있다. 이와 같이 키 변환 계층이 동작하는 네트워크 계층은 어느 특정한 계층으로 제한되지 않는다. 도 6은 본 발명의 일 실시예에 따른 신규 암호화 키의 전송 및 신규 암호화 키의 사용 시점을 설명하는 메시지 송수신 흐름도이다. 도 6을 참조하면, 단계 S601에서, 송신 장치는, 현재 암호화 키(Key1)로 메시지 원문을 암호화하여 수신 장치로 전송한다. 이때의 현재 암호화 키(Key1)는, 송신 장치와 수신 장치 간에 핸드쉐이크 과 정을 겨처 공유한 암호화 키일 수 있고, 또는 이전에 이하에서 설명하는 바와 같이, 송신 장치가 수신 장 치로 전송한 암호화 키일 수 있다. 단계 S602에서, 송신 장치는, 새로운 메시지 원문을 암호화하여 수신 장치로 전송한다. 이때, 송신 장치는, 신규 암호화 키(Key2)를 새로운 메시지 원문과 함께 현재 암호화 키(Key1)로 암호화하여 전송한다. 단계 S603에서, 수신 장치는, 단계 S602에서 수신된 암호화 메시지에 대한 수신 응답(ACK)을 송신 장치 로 전송한다. 일 실시예에서, 수신 장치는, 단계 S602에서 수신된 암호화 메시지의 복호화가 정상적 으로 완료되었을 때 수신 응답을 송신 장치로 전송할 수 있다. 단계 S604에서, 송신 장치는, 또 다른 새로운 메시지 원문을 수신 장치로 전송해야 하는데, 상기 단 계 S603에서 수신 장치가 전송한 수신 응답(ACK)이 아직 수신되지 않았으므로, 현재 암호화 키(Key1)로 해 당 새로운 메시지 원문을 암호화하여 수신 장치로 전송한다. 단계 S605에서, 송신 장치는, 또 다른 새로운 메시지 원문을 수신 장치로 전송하려고 한다. 이 시점 에서는, 상기 단계 S603에서 수신 장치가 전송한 수신 응답(ACK)이 수신된 상태이므로, 송신 장치는, 해당 새로운 메시지 원문을 단계 S602에서 수신 장치로 전송하였던 신규 암호화 키(Key2)로 암호화하여 수 신 장치로 전송한다. 신규 암호화 키(Key2)로 암호화된 메시지를 수신한 수신 장치는 현재 암호화 키 (Key1)로 MAC 검증에 실패하고 신규 암호화 키(Key2)로 MAC 검증에 성공하므로, 해당 시점부터는 현재 암호화 키(Key1)는 폐기하고, 신규 암호화 키(Key2)를 현재 암호화 키로서 사용한다. 도 7은 본 발명의 일 실시예에 따른 암호화 키 꼬임을 방지하는 방법을 설명하는 메시지 송수신 흐름도이다. 앞 서 설명한 도 6을 참조한 실시예에서는 송신 장치만 신규 암호화 키를 수신 장치로 전송하고, 수신 장치는 신규 암호화 키를 송신 장치로 전송하지 않는다. 그러나 수신 장치도 신규 암호화 키를 송신 장치로 전송할 수 있다. 이 경우, 송신 장치와 수신 장치는 어떤 암호화 키를 현재 암호화 키로 사용해야 하는지 판단할 수 없다. 도 7을 참조한 본 실시예에는 이러한 암호화 키 꼬임을 방지하는 방법을 설명한다. 도 7을 참조하면, 단계 S701에서, 송신 장치는, 현재 암호화 키(Key1)로 메시지 원문을 암호화하여 수신 장치로 전송한다. 이때의 현재 암호화 키(Key1)는, 송신 장치와 수신 장치 간에 핸드쉐이크 과 정을 겨처 공유한 암호화 키일 수 있고, 또는 도 6을 참조하여 설명한 바와 같이, 송신 장치가 수신 장치 로 전송한 암호화 키일 수 있다. 단계 S702에서, 송신 장치는, 새로운 메시지 원문을 암호화하여 수신 장치로 전송한다. 이때, 송신 장치는, 신규 암호화 키(Key2)를 새로운 메시지 원문과 함께 현재 암호화 키(Key1)로 암호화하여 전송한다. 단계 S702에서 송신 장치가 전송한 암호화 메시지가 수신 장치에 도착하기 전에, 단계 S703에서, 수 신 장치는, 또 다른 신규 암호화 키(Key3)를 생성하고 그 신규 암호화 키(Key3)와 송신 장치로 전송 할 메시지 원문을 함께 현재 암호화 키(Key1)로 암호화하여 송신 장치로 전송한다. 단계 S704에서, 송신 장치는, 단계 S703에서 수신 장치가 전송한 암호화 메시지에 신규 암호화 키 (Key3)가 포함되어 있으므로 수신 응답을 전송해야 하지만, 단계 S702에서 신규 암호화 키(Key2)를 포함하여 수 신 장치로 전송한 암호화 메시지에 대해 아직 수신 장치로부터 수신 응답(ACK)이 수신되지 않았으므 로, 암호화 키의 꼬임 방지를 위해, 수신 응답(ACK)을 전송하지 않는다. 이후 단계 S706에서, 수신 장치는, 단계 S702에서 송신 장치가 전송한 암호화 메시지를 수신하고, 해 당 암호화 메시지에는 신규 암호화 키(Key2)가 포함되어 있으므로 수신 응답을 전송해야 하지만, 단계 S703에서 신규 암호화 키(Key3)를 포함하여 송신 장치로 전송한 암호화 메시지에 대해 아직 송신 장치로부터 수신 응답(ACK)이 수신되지 않았으므로, 암호화 키의 꼬임 방지를 위해, 수신 응답(ACK)을 전송하지 않는다. 이상과 같이, 송신 장치와 수신 장치는 모두 현재 암호화 키(Key1)와 두 개의 신규 암호화 키(Key2, Key3)를 보관하고 있지만, 각각 수신 응답(ACK)을 수신하지 못한 상태이므로, 두 개의 신규 암호화 키(Key2, Key3)를 모두 사용하지 않고, 현재 암호화 키(Key1)를 계속해서 사용하여 암호화 키의 꼬임을 방지한다. 송신 장치와 수신 장치 각각은, 신규 암호화 키(Key2 또는, Key3)를 포함하는 암호화 메시지를 상대 장치로 전송한 후, 일정 시간 이내에 수신 응답(ACK)이 수신되지 않는 경우, 보관하고 있는 두 개의 신규 암호화 키 (Key2, Key3)를 모두 폐기한다. 이후에, 송신 장치 또는 수신 장치 중 어느 하나의 종단 장치에서만 또 다른 신규 암호화 키를 포함하는 암호화 메시지를 상대 장치로 전송할 경우, 도 6을 참조하여 설명한 절차에 따라 현재 암호화 키를 그 신규 암호화 키로 변경하여 사용하여 암호화 키 변경 절차를 진행한다. 본 명세서는 많은 특징을 포함하는 반면, 그러한 특징은 본 발명의 범위 또는 특허청구범위를 제한하는 것으로 해석되어서는 안 된다. 또한, 본 명세서에서 개별적인 실시예에서 설명된 특징들은 단일 실시예에서 결합되어 구현될 수 있다. 반대로, 본 명세서에서 단일 실시예에서 설명된 다양한 특징들은 개별적으로 다양한 실시예에 서 구현되거나, 적절히 결합되어 구현될 수 있다. 도면에서 동작들이 특정한 순서로 설명되었으나, 그러한 동작들이 도시된 바와 같은 특정한 순서로 수행되는 것으로, 또는 일련의 연속된 순서, 또는 원하는 결과를 얻기 위해 모든 설명된 동작이 수행되는 것으로 이해되어 서는 안 된다. 특정 환경에서 멀티태스킹 및 병렬 프로세싱이 유리할 수 있다. 아울러, 상술한 실시예에서 다양 한 시스템 구성요소의 구분은 모든 실시예에서 그러한 구분을 요구하지 않는 것으로 이해되어야 한다. 상술한 프로그램 구성요소 및 시스템은 일반적으로 단일 소프트웨어 제품 또는 멀티플 소프트웨어 제품에 패키지로 구 현될 수 있다. 상술한 바와 같은 본 발명의 방법은 프로그램으로 구현되어 컴퓨터로 읽을 수 있는 형태로 기록매체(시디롬, 램, 롬, 플로피 디스크, 하드 디스크, 광자기 디스크 등)에 저장될 수 있다. 이러한 과정은 본 발명이 속하는 기술 분야에서 통상의 지식을 가진 자가 용이하게 실시할 수 있으므로 더 이상 상세히 설명하지 않기로 한다."}
{"patent_id": "10-2021-0053080", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "이상에서 설명한 본 발명은, 본 발명이 속하는 기술분야에서 통상의 지식을 가진 자에게 있어 본 발명의 기술적 사상을 벗어나지 않는 범위 내에서 여러 가지 치환, 변형 및 변경이 가능하므로 전술한 실시예 및 첨부된 도면 에 의해 한정되는 것이 아니다."}
{"patent_id": "10-2021-0053080", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 일 실시예에 따른 종단 장치들을 나타낸 도면이다. 도 2는 본 발명의 일 실시예에 따른 송신 장치에서 신규 암호화 키를 메시지 원문과 함께 암호화하는 과정을 설 명하는 도면이다. 도 3은 본 발명의 일 실시예에 따른 수신 장치에서 신규 암호화 키를 수신하여 보관하는 과정을 설명하는 도면 이다. 도 4는 본 발명의 일 실시예에 따른 수신 장치에서 보관 중인 신규 암호화 키를 현재 암호화 키로 사용하는 과 정을 설명하는 도면이다. 도 5는 본 발명의 일 실시예에 따른 암호화 메시지에 신규 암호화 키를 삽입하는 계층을 나타낸 도면이다. 도 6은 본 발명의 일 실시예에 따른 신규 암호화 키의 전송 및 신규 암호화 키의 사용 시점을 설명하는 메시지 송수신 흐름도이다. 도 7은 본 발명의 일 실시예에 따른 암호화 키 꼬임을 방지하는 방법을 설명하는 메시지 송수신 흐름도이다."}
