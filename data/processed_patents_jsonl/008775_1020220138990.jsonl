{"patent_id": "10-2022-0138990", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2024-0058349", "출원번호": "10-2022-0138990", "발명의 명칭": "다변수 LSTM 딥러닝 네트워크를 이용한 육계 시세 예측 모델", "출원인": "주식회사 업데이터", "발명자": "황동현"}}
{"patent_id": "10-2022-0138990", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "다변수 LSTM 딥러닝 네트워크를 이용한 육계 시세 예측 방법으로, 육계 시세의 형성과 관련된 시계열 데이터를 수집하고 분석하는 단계와,수집된 데이터를 동일한 시간단위로 정제하고 융합하는 단계와,개발된 다변수 LSTM 모델을 학습데이터와 분리된 10%의 테스트 데이터를 통해 검증하는 단계를 포함하는 mini-batch 방식에 기초한 육계시세 예측 방법."}
{"patent_id": "10-2022-0138990", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "국내 닭고기 산업은 2022년 전체 시장 규모가 4,000억원을 돌파할 것으로 예상되고 성장 속도 또한 매우 가파르 다. 하지만 닭고기 생산 업체들의 영업이익률은 계속 낮아지는 추세로, 기업은 닭고기의 판매가를 예측하여 적정 재고량을 관리하고 영업 손실을 줄이고자 노력하고 있다. 이에 본 연구에서는 육계 가격 예측에 기존의 통계적 (뒷면에 계속)"}
{"patent_id": "10-2022-0138990", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 딥러닝 네트워크를 이용한 육계 시세 예측 모델에 관한 것이다."}
{"patent_id": "10-2022-0138990", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "2022년 8월 한국농수산식품유통공사 식품산업통계정보에 따르면, 국내 가공 닭고기 시장 규모는 2020년 3,100억 원으로 2017년 대비 76% 증가하였으며, 냉장 닭고기는 2017년 대비 3배 이상 확대되는 등 시장 성장 속도가 매 우 가파르다. 업계는 2022년 전체 시장 규모가 4,000억원을 돌파할 것으로 전망하고 있다. 반면, 총 시장점유율이 합이 44.5%에 달하는 4개 주요 닭고기 생산 업체들의 매출액 대비 영업이익률은 계속 낮 아지는 추세이다. 이러한 현상은 닭고기의 유통단계 간 가격전달의 비대칭성에 기인한다. 닭고기 산지가격→도매가격 간 가격 전 이는 대칭적이지만, 도매가격→소매가격의 가격 전이는 양(+)의 비대칭정이 존재하여 소매가격이 도매가격의 하 락보다 상승에 더 민감하게 반응한다[1]. 가격전달의 비대칭성으로 인해 닭고기 가격 변동에 따르는 경제적 부담이 국내 유통업체를 제외한 닭고기 생산 업체와 소비자에게 집중되는 것이다. 또한 지구 온난화와 2022년 2월 시작된 우크라이나 전쟁 등 복합적인 사유로 국제 사료 곡물가격이 지속적으로 인상되고 있어 국내 닭고기 생산 업체의 경제적 부담이 가중되고 있다. 선행기술문헌 비특허문헌 (비특허문헌 0001) [1] 박문수, 황선웅, 서상택, “축산물 시장의 가격전달채널 분석 및 가격안정화 방안-육계 및 계란 새장을 중심으로”한국농촌경제연구원, pp.43-52, Dec, 2012 (비특허문헌 0002) [2] Sooram Kang, Wanyun Cho, Myunghwan Na, “Price Forecasting using Online Article Crawling Technique and LSTM Model”2021 (비특허문헌 0003) [3] “LSTM Networks”Oct, 10, 2022, https://colah.github.io/posts/2015-08- Understanding- LSTMs/ (비특허문헌 0004) [4] “correlation coefficient”Oct, 10, 2022, https://en.wikipedia.org/wiki/Pearson_correlation_coefficient (비특허문헌 0005) [5] Jiin Lee, Jeongseok Song, “Empirical Study on Prediction of the Art Price using Multivariate Long Short Term Memory Recurrent Neural Network Deep Learning Model”Jun, 2021 (비특허문헌 0006) [6] Gihun Joo, Chihyun Park, Hyeonseung Im, “Evaluation of Machine LearningOptimizers”Sep, 2020 (비특허문헌 0007) [7] Sungho Shin, Mikyoung Lee, Sa-kwang Song, “Prediction Model for Agricultural Products Price with LSTM Network”Nov, 2018 (비특허문헌 0008) [8] Jaehyun Park, Dong-Gun Lee, Yeong-Seok Seo, “the effect of LSTM hyperparameters tuning on Cryptocurrency Price Prediction”May, 2021 (비특허문헌 0009) [9] Woo-Ram KIM, “study on LSTM-based Demand Prediction Model to Improve the Accuracy of Demand for Green Coffee Beans”Graduate School of Soongsil University, Jun, 2021"}
{"patent_id": "10-2022-0138990", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "이러한 상황과 주 제품이 “신선 냉장 육계”임을 고려하면, 현재 닭고기 생산 업체의 주요 경쟁력은 시장 가격 이 변동성에 대응하여 적정 재고량을 관리하여 원가를 낮추고 영업이익률을 높이는 것에 있다고 볼 수 있다. 따 라서 본 발명에서는 닭고기 생산 업체가 적정 재고량 산정 등 전사적인 의사결정에 활용할 수 있는, 딥러닝을 활용한 가격 예측 모델을 제안하고자 한다."}
{"patent_id": "10-2022-0138990", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "주식이나 채권과 같은 금융자산, 농산물 가격 예측에 관한 선행 연구들에서 인공지능을 활용한 연구가 활발히 이루어지고 있고 그 성능 또한 입증 받아오고 있지만, 인공지능을 활용한 육계 가격 예측 연구는 전무한 실정이 다. 본 발명에서는 농산물 가격 예측 분야 선행 연구들을 분석하여 비선형 시계열 데이터의 예측에 높은 성과를 보 이는 LSTM(Long Short-Term Memory)을 선정하였다."}
{"patent_id": "10-2022-0138990", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "개발된 다변수 LSTM 모델은 학습데이터와 분리된 10%의 테스트 데이터를 통해 검증 결과, 약 94.0%의 정확도를 보였다. 본 연구 결과는 기업의 활용성을 고려한 중장기 육계 가격 예측 모델의 개발에도 활용되어 기업의 재고 량 및 판매전략 의사결정을 지원하는 효율적인 도구로 활용될 수 있을 것으로 기대된다."}
{"patent_id": "10-2022-0138990", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "<연구 설계> 본 발명의 논문 연구는 순환신경망(RNN: Recurrent Neural Network)의 한 종류인 LSTM을 활용하여 미래의 육계 가격을 예측하고자 한다. 기존의 RNN 모델은 시계열 데이터에서 시간적으로 멀리 떨어진 장기 의존 관계를 학습하기 어려운 기울기 소실 (Gradient Vanishing) 문제가 발생하는데, LSTM은 이를 극복하기 위해 메모리 셀(cell)을 추가하여 개선한 모델 로서, 시계열 데이터의 예측에 높은 성과를 보이는 학습 모델이다.LSTM은 메모리 셀 내부의 forget gate, input gate, output gate를 통해 이전 시점의 hidden state와 현재 시 점의 hidden state를 연산하는데, 이 연산은 현재 정보와 과거 정보를 얼마나 반영할 것인지를 결정하여 정보가 선택적으로 흘러갈 수 있게 한다[2]. 도 1은 RNN과 LSTM의 cell 구조 비교를 나타낸다[3]. LSTM의 작동 단계는 [표 1]과 같다."}
{"patent_id": "10-2022-0138990", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "본 연구에서는 육계 시세 예측 모델의 개발을 위해 육계 시세의 형성과 관련된 다양한 시계열 데이터를 수집 및 분석하였다. 대한양계협회, 육계협회, 기상청, 국가가축방역통합시스템, 축산물안전관리시스템, 통계청 등에서 공개되는 데 이터를 수집하여 연구하였고, 닭 사육과 직접 관련된 데이터의 경우 공공데이터로 개방된 정보의 종류가 매우 적어 국내 닭고기 업체의 생산공정 데이터를 활용하였다. 예측하려는 종속변수로는 대한양계협회에 공시되는 “중(1.4kg~1.6kg미만)급 육용실용계 시세”를 선정하였다. 해당 시세가 닭고기 생산 업체들이 거래처별 판매가를 결정하는데 참고하는 기준 정보이기 때문이다. 수집된 모든 데이터는 동일한 시간적 단위로 융합하였으며, 결측치를 제거, 치환하는 등의 전처리 과정을 거쳤 다. 데이터 분석 단계에서는 시계열 데이터를 시각화 분석 및 상관분석 등의 통계적 분석 기법을 통하여 융합데이터 셋에서 모델 input 데이터를 선정하였다. 융합데이터 셋에서 선정한 input 데이터를 정규화(Normalization) 및 LSTM 입력 형태의 3차원 배열로 변환하여 학습 데이터를 준비하였으며, Sequential 모델을 활용하여 모델을 개발하였다. 도 2는 본 연구의 전체적인 프로세스를 나타낸다. <예측 모델링> 1. 데이터수집 본 발명의 연구는 시계열 데이터 분석에 적합한 LSTM 네트워크를 활용하여 육계 시세를 예측하고자 한다. 따라 서 입력 변수에 연(year), 월(month), 주차(week) 정보를 포함하였고, 사용된 모든 데이터는 연/월/주차 순서를 기준으로 한 순차 데이터를 사용하였다. 또한 육계 시세의 형성과 관련된 다양한 시계열 데이터를 수집하여 다변수 LSTM 예측 모델에 input 변수로 활용 하기 위하여, 닭고기 생산공정 데이터뿐만 아니라 관련 외부 공공데이터를 수집하였다. 수집 데이터 목록은 아래 표2와 같다."}
{"patent_id": "10-2022-0138990", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "2. 데이터 전처리 및 융합 수집된 데이터는 결측치 대체/제거 등 전처리 과정과 각각의 데이터들이 서로 다른 시간 단위를 가지고 있어 이 를 하나의 시간 단위로 맞추는 정제 과정을 거쳤다. 한 계절이나 한 달은 너무 많은 기간과 정보를 가져 학습 단위로 적합하지 않다는 점, 일(day)단위 예측은 모델 의 활용성이 낮다는 점을 고려하여, 목표하는 가격 예측의 시간 단위를 ‘주(week)’로 결정하였다. 따라서 input 변수로 활용될 수집 데이터 또한 동일하게 주단위로 정제하였다. 구축된 데이터의 시간적 범위는 2014년부터 2022년 3월까지이며, 총 270개 속성, 428개 인스턴스를 가진 융합 데이터셋을 도출하였다. 3. 모델 입력 변수 선정 구축된 융합 데이터셋 총 270개 속성 중 모델 imput 데이터를 선정하기 위하여 상관분석 등의 통계적 분석과 시 각화 분석을 수행하였다. 상관분석은 예측하려는 종속변수인 ‘육계 시세’와 다른 변수들 간의 피어슨 상관 계수(Pearson Correlation Coefficient)를 사용하였다. 피어슨 상관 계수는 코시-슈바르츠 부등식에 의해 +1과 -1 사이의 값을 가지며, +1은 완벽한 양의 선형 상관관 계, 0은 선형 상관관계 없음, -1은 완벽한 음의 선형 상관관계를 의미한다[4]. x와 y사이의 피어슨 상관 계수를 구하는 식[4]은 아래와 같다."}
{"patent_id": "10-2022-0138990", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "피어슨 상관 계수의 절댓값이 상위에 랭크되며, 그래프-시각화 분석에서 육계 시세와의 연관 정도가 유의미하다 고 판단되는 변수들을 중심으로 input data를 조합하여, 조합된 input data 버전에 따라 모델 성능(RMSE, MAP E)를 비교하는 방식으로 입력 변수를 선정하였다. 선정된 input 데이터 속성은 총 37개이다. 4. 예측모델 개발 본 발명의 연구에서는 Python 기반 환경에 Tensorflow와 Keras 라이브러리를 활용하여 연구를 진행하였다. 예측 모델 개발을 위한 방법론은 크게 학습 데이터셋 구축을 위한 데이터변환, 모델링, 하이퍼파라미터 최적화 순으로 수행하였다. 우선, input data의 각 변수 별로 단위가 달라 학습에 미치는 중요도가 달라지는 문제를 방지하기 위하여, Min Max Scaling(최솟값은 0, 최댓값은 1로, 모든 데이터가 [0, 1] 범위 안에 들어가도록 조절하는 기법)으로 정규 화를 진행하였다. 총 37개 속성, 428개 인스턴스를 가진 input data set을 정LSTM 입력 형태의 3차원 배열로 변환 시에, 예측을 위해 바라보는 과거 데이터의 시간적 범위를 의미하는 window size는 6주/8주/10주/12주/16주/20주/24주를 적용 하여 모델 성능을 비교 연구하였다. 좋은 예측 모델을 구하기 위해서는 데이터의 특성에 맞게 하이퍼파라마터들을 적절히 최적화하는 것이 중요하다. 검토하여야 할 주요 하이퍼파라미터로는 에포크(epochs), 드롭아웃(dropout), 옵티마이저 (optimizer), 배치 사이즈(batch size) 등이 있다. 에포크(epochs)는 학습의 반복 횟수를 의미하며, 데이터의 특성과 모델의 구성에 따라 적절한 에포크 수치는 달 라진다. 에포크 수치가 최적화 수치보다 작은 경우에는 모델 학습이 충분히 이루어지지 않아 성능이 저하되는 문제가 있고, 최적화 수치보다 큰 경우에는 과적합이 발생하는 문제가 있다. 본 연구에서는 실험을 통해 4000~6000 사이의 값을 최적화된 값으로 판단하였다. 드롭아웃(Dropout)은 일부의 뉴런을 확률적으로 생략시킴으로써 과적합을 방지하기 위해 사용된다[4]. 본 연구 에서는 0/0.05/0.1를 적용하여 실험하였다. 옵티마이저(Optimizer)와 활성화 함수(Activation Function)는 LSTM을 활용한 시계열 데이터 예측과 관련한 선 행 연구에서 높은 성능을 보인 Adam Optimizer를 사용하였다[5][6][7][8][9]. 딥러닝에서 학습 데이터 크기의 결정은, mini-batch 방식을 활용하였다. mini-batch 방식은 전체 데이터를 학습 에 활용하되, 한 번의 과정 내에서 전체 데이터를 랜덤하게 서브 데이터셋으로 나누어 여러 번 학습한다. 이 방 식은 한 번의 학습에 모든 데이터를 활용하는 full batch 방식보다 모집단을 대표할 수 있다는 장점이 있다[7]. 본 연구에서는 mini-batch size로 6/8/10/12/14/16/18/20/22/24를 적용하여 모델 성능을 비교 연구하였다. 도 3은 인공신경망 구조이다. 연구를 통해 최종 선정된 육계 가격 예측 모델의 구조는 도 3과 같다. 연구 결과 에포크(epochs)=6000, 드롭아웃(dropout)=0.0, 옵티마이저(optimizer)='Adam', 배치 사이즈(batch size)=16, 학습률(learning_rate)=0.001, 활성화함수(activation)=’’ 일 때 모델 성능이 가장 좋은 것으로 나타났다. 도 4는 epoch에 따른 loss 변화 그래프이다. 에포크(epochs)에 따른 손실(loss)을 그래프로 그려보면, 도 4와 같이 학습이 진행 될수록 손실은 대체적으로 낮아지는 것을 알 수 있다. 손실(loss)은 MSE로 측정하였다. MSE(Mean Squared Error)는 실제 값과 예측 값의 차이를 제곱해 평균한 것으로 머신러닝에서 Cost Function(손실함수 혹은 비용함수)으로 주로 쓰인다. 5. 검증 LSTM 입력 형식의 3차원 배열로 변환한 데이터셋은 총 418(window size가 10일 때)개 이며, 모델 평가를 위해 10%에 해당하는 42개 데이터 세트는 학습데이터와 분리하여 검증용 데이터(Test data)로 준비하였다. 검증용 데이터(Test data) 42개 세트별로 각각 RMSE와 MAPE를 산출하였으며, 42개의 값을 평균한 RMSE와 MAPE를 비교 및 검증 기준으로 삼아, 개별 Test set에 의한 모델 평가 지표에 편향이 생기는 문제를 보완하였다. 도 5는 모델 검증 절차이다. RMSE(Root Mean Square Error)는 실제 값과 모델이 예측한 값의 차이를 다룰 때 흔히 사용하는 측도이다."}
{"patent_id": "10-2022-0138990", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 5, "content": "MAPE(Mean Absolute Percentage Error)는 실제 값과 예측 값 사이의 차이(절댓값)가 실제 값에서 차지하는 상 대적인 비율을 산출하며. 오차의 정도를 백분율 값으로 나타내기 때문에 모델의 성능을 직관적으로 나타내는 평 가 지표로 사용된다."}
{"patent_id": "10-2022-0138990", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 6, "content": "검증 기준에 따라 최종 선택한 모델의 RMSE는 137.584, MAPE는 5.939이며, 예측 정확도 94.061%의 결과를 보였 다."}
{"patent_id": "10-2022-0138990", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "item": 7, "content": "도 6은 모델 예측값과 실제값 비교 그래프이다. <결론> 본 발명의 연구에서는 국내 닭고기 생산 업체를 대상으로 다변수 LSTM 기반의 육계 가격 예측 모델을 제안하였 다. 기업 측면에서 판매 가격 예측은 적정 재고량 관리 및 판매 계획 수립 등 전사적 측면에서 매우 중요한 요소이 다. 특히 닭고기의 경우 재고관리가 되지 않으면 신선 냉장육을 냉동육으로 전환하면서 판매가가 하락하여 영업 손실이 발생하게 된다. 따라서 가격 예측에 기존의 통계적 접근 방식을 벗어나 인공지능 기술을 도입한 과학적 예측 모델을 적용할 필요가 있다.이에 본 연구에서 제안한 다변수 LSTM 기반의 육계 가격 예측 모델은 기업이 거래유형별 판매가를 산정하는데 기준 단가가 되는 양계협회 시세의 가격을 예측하도록 설계되었으며, 예측 정확도 94.061%의 결과를 보였다. 한계점으로는 최근 사료 곡물 가격이 급격하게 상승하는 등 독립변수들과 종속변수의 관계가 과거에 존재하지 않는 패턴을 보임에 따라 예측에 어려움이 있다는 것이다. 이를 극복하고 예측 모델의 정확도를 향상하기 위해 서는 LSTM을 적용하기 위한 input 데이터가 추가적으로 확보될 필요가 있으며, 데이터가 누적될수록 다양한 패 턴이 학습되어 예측력이 높아질 것으로 기대된다."}
{"patent_id": "10-2022-0138990", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 RNN과 LSTM의 cell 구조 비교를 나타낸다[3]. 도 2는 본 발명과 관련된 연구의 전체적인 프로세스를 나타낸다. 도 3은 인공신경망 구조이다. 도 4는 epoch에 따른 loss 변화 그래프이다. 도 5는 모델 검증 절차이다. 도 6은 모델 예측값과 실제값 비교 그래프이다."}
