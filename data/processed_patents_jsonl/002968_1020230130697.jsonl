{"patent_id": "10-2023-0130697", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2025-0046795", "출원번호": "10-2023-0130697", "발명의 명칭": "양전자 방출 단층촬영 영상에서 세포의 이동 경로를 추적하는 전자장치 및 그 추적 방법", "출원인": "가톨릭대학교 산학협력단", "발명자": "성원모"}}
{"patent_id": "10-2023-0130697", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "전자장치에 의해 수행되는 양전자 방출 단층촬영(Positron Emission Tomography, PET) 영상에서 세포의 이동 경로를 추적하는 방법에 있어서,(a) 감마선이 검출될 때의 PET 검출기의 좌표 및 타임스탬프를 포함하는 PET 정보를 수신하는 단계;(b) 상기 좌표들 및 세포의 추정된 위치들에 기초하여 경로 결정 행렬에 관한 손실함수를 설정하는 단계;(c) 역전파(backpropagation)를 이용하여 상기 손실함수의 그래디언트(gradient)를 계산하는 단계;(d) 상기 계산된 그래디언트를 이용하여 상기 경로 결정 행렬을 업데이트하는 단계; (e) 상기 (c) 단계 및 상기 (d) 단계를 반복하여 상기 손실함수를 최소화하는 제1경로 결정 행렬을 식별하는 단계;(f) 상기 제1경로 결정 행렬을 이용하여 세포의 이동 경로를 식별하는 단계;를 포함하는 방법."}
{"patent_id": "10-2023-0130697", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 (b) 단계는,상기 타임스탬프에서의 세포의 추정된 위치를 상기 경로 결정 행렬 및 3차원 입방 스플라인 함수로 나타내는 단계;를 포함하는 방법."}
{"patent_id": "10-2023-0130697", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제2항에 있어서,상기 (b) 단계는,상기 3차원 입방 스플라인 함수를 행렬로 변환하는 단계;를 포함하는 방법."}
{"patent_id": "10-2023-0130697", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제3항에 있어서,상기 행렬(Bnj)은,로 나타내고, bn-1,3 (τj)는 3차원 입방 스플라인 함수, τj 는 이벤트(j)의 타임 스탬프, K는 이벤트(j)의 발생횟수, N은 하나의 스플라인 간격에서 평균 감지 횟수인 것을 특징으로 하는 방법."}
{"patent_id": "10-2023-0130697", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제2항에 있어서,상기 (b) 단계는,상기 좌표들을 이은 직선들 및 상기 세포의 추정된 위치들 간의 평균 제곱 거리의 상한값을 설정하는 단계를 포함하는 방법."}
{"patent_id": "10-2023-0130697", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "공개특허 10-2025-0046795-3-제5항에 있어서,상기 손실함수(J(A))는,이고, 상기 손실함수(J(A))의 K는 이벤트(j)의 발생 횟수, Dj는 상기 좌표들을 이은 직선들 및 상기 세포의 추정된 위치들 간의 거리, dmax는 평균 제곱 거리의 상한값, λ는 하이퍼파라미터, N은 하나의 스플라인 간격에서평균 감지 횟수, A는 경로 결정 행렬인 것을 특징으로 하는 방법."}
{"patent_id": "10-2023-0130697", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "양전자 방출 단층촬영(Positron Emission Tomography, PET) 영상에서 세포의 이동 경로를 추적하는 전자장치에있어서,(a) 감마선이 검출될 때의 PET 검출기의 좌표 및 타임스탬프를 포함하는 PET 정보를 수신하고,(b) 상기 좌표들 및 세포의 추정된 위치들에 기초하여 경로 결정 행렬에 관한 손실함수를 설정하고,(c) 역전파(backpropagation)를 이용하여 상기 손실함수의 그래디언트(gradient)를 계산하고,(d) 상기 계산된 그래디언트를 이용하여 상기 경로 결정 행렬을 업데이트하고,(e) 상기 (c) 동작 및 상기 (d) 동작을 반복하여 상기 손실함수를 최소화하는 제1경로 결정 행렬을 식별하고,(f) 상기 제1경로 결정 행렬을 이용하여 세포의 이동 경로를 식별하는 프로세서를 포함하는 전자장치."}
{"patent_id": "10-2023-0130697", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제7항에 있어서,상기 프로세서는,상기 타임스탬프에서의 세포의 추정된 위치를 상기 경로 결정 행렬 및 3차원 입방 스플라인 함수로 나타내는 전자장치."}
{"patent_id": "10-2023-0130697", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제8항에 있어서,상기 프로세서는,상기 3차원 입방 스플라인 함수를 행렬로 변환하는 전자장치."}
{"patent_id": "10-2023-0130697", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제9항에 있어서,상기 행렬(Bnj)은,로 나타내고, bn-1,3 (τj)는 3차원 입방 스플라인 함수, τj 는 이벤트(j)의 타임 스탬프, K는 이벤트(j)의 발생횟수, N은 하나의 스플라인 간격에서 평균 감지 횟수인 것을 특징으로 하는 전자장치."}
{"patent_id": "10-2023-0130697", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "제8항에 있어서,공개특허 10-2025-0046795-4-상기 프로세서는,상기 좌표들을 이은 직선들 및 상기 세포의 추정된 위치들 간의 평균 제곱 거리의 상한값을 설정하는 전자장치."}
{"patent_id": "10-2023-0130697", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제11항에 있어서,상기 손실함수(J(A))는,이고, 상기 손실함수(J(A))의 K는 이벤트(j)의 발생 횟수, Dj는 상기 좌표들을 이은 직선들 및 상기 세포의 추정된 위치들 간의 거리, dmax는 평균 제곱 거리의 상한값, λ는 하이퍼파라미터, N은 하나의 스플라인 간격에서평균 감지 횟수, A는 경로 결정 행렬인 것을 특징으로 하는 전자장치."}
{"patent_id": "10-2023-0130697", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명의 일 실시예에 따른 전자장치에 의해 수행되는 양전자 방출 단층촬영(Positron Emission Tomography, PET) 영상에서 세포의 이동 경로를 추적하는 방법에 있어서, (a) 감마선이 검출될 때의 PET 검출기의 좌표 및 타 임스탬프를 포함하는 PET 정보를 수신하는 단계; (b) 상기 좌표들 및 세포의 추정된 위치들에 기초하여 경로 결 정 행렬에 관한 손실함수를 설정하는 단계; (c) 역전파(backpropagation)를 이용하여 상기 손실함수의 그래디언 트(gradient)를 계산하는 단계; (d) 상기 계산된 그래디언트를 이용하여 상기 경로 결정 행렬을 업데이트하는 단 계; (e) 상기 (c) 단계 및 상기 (d) 단계를 반복하여 상기 손실함수를 최소화하는 제1경로 결정 행렬을 식별하는 단계; (f) 상기 제1경로 결정 행렬을 이용하여 세포의 이동 경로를 식별하는 단계;를 포함할 수 있다."}
{"patent_id": "10-2023-0130697", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 양전자 방출 단층촬영 영상에서 세포의 이동 경로를 추적하는 전자장치 및 그 추적 방법에 관한 것이다."}
{"patent_id": "10-2023-0130697", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "분자 이미징 알고리즘과 도구의 발전으로 복잡한 생물학적 시스템 내의 분자 역학에 대한 통찰력이 깊어졌다. 이러한 혁신 중 하나는 양전자 방출 단층촬영(Positron Emission Tomography, PET)을 통해 생체 내 단일 세포 의 궤적을 추적하도록 설계된 알고리즘인 Cell GPS이다. Cell GPS는 PET 스캔으로 캡쳐한 방사성 표지 세포의 데이터를 활용하여 높은 정확도로 세포의 이동 경로를 재 구성하는 알고리즘이다. 중요한 것은 Cell GPS가 생체 내 테스트를 거쳐 낮은 방사능 하에서 세포 활동에 손상 을 주지 않으면서 경로 추적에 충분한 능력을 입증했다는 것이다. Cell GPS를 통해 생체 내에서 방사성 표지된 암세포를 추적하면 암 전이에 대한 이해가 깊어질 수 있다. 또한, 환자에게 주입된 면역세포와 줄기세포를 추적 함으로써 의료진은 보다 높은 정확도로 치료 효과를 예측할 수 있다. 상당한 잠재력에도 불구하고 Cell GPS 알고리즘의 계산 속도는 여전히 중요한 병목 현상으로 남아 있다. Cell GPS의 정확도를 향상시키기 위해서는 다양한 방사능, 세포 이동, PET 환경과 같은 각 조건에 맞는 하이퍼파라미 터를 최적화할 필요가 있다. 최적의 하이퍼파라미터를 찾으면 알고리즘의 정확도가 향상되므로 하이퍼파라미터 튜닝은 모델 설정에서 중요한 프로세스이다. 그러나, 하이퍼파라미터 튜닝과정에서 수백 개의 데이터를 분석해야 하는 경우가 많으며 이는 시간이 많이 소요 되며 한계로 작용한다. 따라서, Cell GPS 알고리즘의 연산 속도를 보다 빠르게 하는 방안이 필요한 실정이다."}
{"patent_id": "10-2023-0130697", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명의 목적은 보다 빠른 연산 속도로 양전자 방출 단층촬영 영상에서 세포의 이동 경로를 추적하는 전자장 치 및 그 추적 방법을 제공하는 것이다. 본 발명의 목적은 보다 정확하게 양전자 방출 단층촬영 영상에서 세포의 이동 경로를 추적하는 전자장치 및 그 추적 방법을 제공하는 것이다."}
{"patent_id": "10-2023-0130697", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명의 일 실시예에 따른 전자장치에 의해 수행되는 양전자 방출 단층촬영(Positron Emission Tomography, PET) 영상에서 세포의 이동 경로를 추적하는 방법에 있어서, (a) 감마선이 검출될 때의 PET 검출기의 좌표 및 타임스탬프를 포함하는 PET 정보를 수신하는 단계; (b) 상기 좌표들 및 세포의 추정된 위치들에 기초하여 경로 결정 행렬에 관한 손실함수를 설정하는 단계; (c) 역전파(backpropagation)를 이용하여 상기 손실함수의 그래디 언트(gradient)를 계산하는 단계; (d) 상기 계산된 그래디언트를 이용하여 상기 경로 결정 행렬을 업데이트하는 단계; (e) 상기 (c) 단계 및 상기 (d) 단계를 반복하여 상기 손실함수를 최소화하는 제1경로 결정 행렬을 식별 하는 단계; (f) 상기 제1경로 결정 행렬을 이용하여 세포의 이동 경로를 식별하는 단계;를 포함할 수 있다. 상기 (b) 단계는, 상기 타임스탬프에서의 세포의 추정된 위치를 상기 경로 결정 행렬 및 3차원 입방 스플라인 함수로 나타내는 단계;를 포함할 수 있다. 상기 (b) 단계는, 상기 3차원 입방 스플라인 함수를 행렬로 변환하는 단계;를 포함할 수 있다. 상기 행렬(Bnj)은, 로 나타내고, bn-1,3 (τj)는 3차원 입방 스플라 인 함수, τj 는 이벤트(j)의 타임 스탬프, K는 이벤트(j)의 발생 횟수, N은 하나의 스플라인 간격에서 평균 감 지 횟수인 것을 특징으로 한다. 상기 (b) 단계는, 상기 좌표들을 이은 직선들 및 상기 세포의 추정된 위치들 간의 평균 제곱 거리의 상한값을 설정하는 단계를 포함할 수 있다. 상기 손실함수(J(A))는, 이고, 상기 손실함수(J(A))의 K는 이벤트(j)의 발생 횟수, Dj는 상기 좌표들을 이은 직선들 및 상기 세포의 추정된 위치들 간의 거리, dmax는 평균 제곱 거리의 상한값, λ는 하이퍼파라미터, N은 하나의 스플라인 간격에서 평균 감지 횟수, A는 경로 결정 행렬인 것을 특징으로 한다. 본 발명의 일 실시예에 따른 양전자 방출 단층촬영(Positron Emission Tomography, PET) 영상에서 세포의 이동 경로를 추적하는 전자장치에 있어서, (a) 감마선이 검출될 때의 PET 검출기의 좌표 및 타임스탬프를 포함하는 PET 정보를 수신하고, (b) 상기 좌표들 및 세포의 추정된 위치들에 기초하여 경로 결정 행렬에 관한 손실함수를 설정하고, (c) 역전파(backpropagation)를 이용하여 상기 손실함수의 그래디언트(gradient)를 계산하고, (d) 상 기 계산된 그래디언트를 이용하여 상기 경로 결정 행렬을 업데이트하고, (e) 상기 (c) 단계 및 상기 (d) 단계를 반복하여 상기 손실함수를 최소화하는 제1경로 결정 행렬을 식별하고, (f) 상기 제1경로 결정 행렬을 이용하여 세포의 이동 경로를 식별하는 프로세서를 포함할 수 있다. 상기 프로세서는, 상기 타임스탬프에서의 세포의 추정된 위치를 상기 경로 결정 행렬 및 3차원 입방 스플라인 함수로 나타낼 수 있다. 상기 프로세서는, 상기 3차원 입방 스플라인 함수를 행렬로 변환할 수 있다. 상기 프로세서는, 상기 좌표들을 이은 직선들 및 상기 세포의 추정된 위치들 간의 평균 제곱 거리의 상한값을 설정할 수 있다."}
{"patent_id": "10-2023-0130697", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명의 일 실시예에 따르면, 세포의 이동 경로를 추적하는 속도가 아주 빨라짐에 따라, 하이퍼파라미터 조정 에 필요한 시간이 줄어들 수 있으며 알고리즘을 정교하게 조정할 수 있다. 본 발명의 일 실시예에 따르면, 경로 추적의 정확도를 잃지 않으면서 계산 속도를 크게 향상시킬 수 있다. 본 발명의 일 실시예에 따르면, 더 빠른 알고리즘을 사용하여 대량의 데이터를 용이하게 분석할 수 있다."}
{"patent_id": "10-2023-0130697", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하, 본 발명에 따른 바람직한 실시 형태를 첨부된 도면을 참조하여 상세하게 설명한다. 첨부된 도면과 함께 이하에 개시될 상세한 설명은 본 발명의 예시적인 실시형태를 설명하고자 하는 것이며, 본 발명이 실시될 수 있 는 유일한 실시형태를 나타내고자 하는 것이 아니다. 도면에서 본 발명을 명확하게 설명하기 위해서 설명과 관 계없는 부분은 생략할 수 있고, 명세서 전체를 통하여 동일 또는 유사한 구성 요소에 대해서는 동일한 참조 부 호를 사용할 수 있다. 본 발명의 일 실시예에 따른 양전자 방출 단층촬영(이하, PET라고도 한다.) 영상에서 세포의 이동 경로를 추적 하는 방법은 그 연산 속도를 높이는 데에 목적이 있다. Cell GPS 알고리즘의 연산 속도가 증가하는 경우, 하이 퍼파라미터 조정에 필요한 시간이 줄어들 수 있으며 잠재적으로 알고리즘의 정교한 조정 가능성이 열릴 수 있다. 또한, 의료진은 더 빠른 알고리즘을 통해 대량의 데이터를 보다 용이하게 분석할 수 있다. 본 발명에서는 Cell GPS의 그래디언트 계산을 최적화하기 위해 역전파(backpropagation)를 사용하는 새로운 접 근 방식을 소개한다. 역전파(backpropagation)는 딥러닝 영역에서 일반적으로 사용되는 알고리즘으로, 오류 그래디언트(error gradient)를 효율적으로 계산하고 그 안의 매개변수를 업데이트하여 모델 예측 값과 실제 실측 값 간의 손실을 줄여 신경망을 효과적으로 훈련할 수 있다. 이 기능을 기반으로 Cell GPS에 역전파를 적용하여 그래디언트 계산 단계를 최적화함으로써 계산 속도를 최적화한다. 본 발명의 일 실시예에 따른 PET 영상에서 세포의 이동 경로를 추적하는 방법은 전자장치에 의해 수행될 수 있다. 전자장치는 컴퓨터, 서버, 스마트 폰, 태블릿 PC, 스마트 패드, 노트북 등으로 구현될 수 있다. 이하, 도면들을 참조하여 본 발명의 일 실시예에 따른 전자장치의 구성 및 동작에 대해 구체적으로 설명한다. 도 1은 본 발명의 일 실시예에 따른 전자장치의 구성을 도시한 블럭도이다. 본 발명의 일 실시예에 따른 전자장치는 입력부, 통신부, 표시부, 저장부 및 프로세 서를 포함한다. 입력부는 전자장치의 사용자 입력에 대응하여 입력데이터를 발생시킨다. 예를 들어, 사용자 입력은 전자장치의 동작을 시작하게 하는 사용자 입력, 손실함수를 설정하는 사용자 입력, Cell GPS 알고리즘의 하이퍼파라미터를 조정하는 사용자 입력, PET 검출기 좌표들을 이은 직선들과 세포의 추정된 위치들 간의 평균 제곱 거리의 상한값을 설정하는 사용자 입력 등일 수 있으며, 이 외에도 세포의 이동 경로 추적을 위해 필요한 사용자 입력인 경우 제한하지 않고 적용 가능하다. 입력부는 적어도 하나의 입력수단을 포함한다. 입력부는 키보드(key board), 키패드(key pad), 돔 스 위치(dome switch), 터치패널(touch panel), 터치 키(touch key), 마우스(mouse), 메뉴 버튼(menu button) 등 을 포함할 수 있다. 통신부는 PET 정보, 세포 이동 경로 등을 송수신하기 위해 PET 장비, 서버 등 외부장치와의 통신을 수행한 다. 이를 위해, 통신부는 5G(5th generation communication), LTE-A(long term evolution-advanced), LTE(long term evolution), Wi-Fi(wireless fidelity), Bluetooth 등의 무선 통신, 혹은 LAN(local area network), WAN(Wide Area Network), 전력선 통신 등의 유선 통신을 수행할 수 있다.표시부는 전자장치의 동작에 따른 표시 데이터를 표시한다. 표시부는 PET 영상을 표시하는 화면, 추적 과정이나 추적 결과(세포의 추적된 이동 경로 등)를 표시하는 화면, 사용자 입력을 수신하는 화면 등을 표시할 수 있다. 표시부는 액정 디스플레이(LCD; liquid crystal display), 발광 다이오드(LED; light emitting diode) 디 스플레이, 유기 발광 다이오드(OLED; organic LED) 디스플레이, 마이크로 전자기계 시스템(MEMS; micro electro mechanical systems) 디스플레이 및 전자 종이(electronic paper) 디스플레이를 포함한다. 표시부 는 입력부와 결합되어 터치 스크린(touch screen)으로 구현될 수 있다. 저장부는 전자장치의 동작 프로그램들을 저장한다. 저장부는 전원의 제공 유무와 무관하게 데이 터(정보)를 보존할 수 있는 비휘발성 속성의 스토리지(storage)와, 프로세서에 의해 처리되기 위한 데이터 가 로딩되며 전원이 제공되지 않으면 데이터를 보존할 수 없는 휘발성 속성의 메모리(memory)를 포함한다. 스토 리지에는 플래시메모리(flash-memory), HDD(hard-disc drive), SSD(solid-state drive) ROM(Read Only Memory) 등이 있으며, 메모리에는 버퍼(buffer), 램(RAM; Random Access Memory) 등이 있다. 저장부는 PET 정보, 추적 과정에서 필요한 알고리즘, 소스 코드 등을 저장할 수 있다. 저장부는 손실 함수 설정, 그래디언트 계산, 경로 결정 행렬 업데이트, 경로 결정 행렬 식별, 세포의 이동 경로 식별 등을 수 행하는 과정에서 필요한 연산 프로그램 등을 저장할 수 있다. 프로세서는 프로그램 등 소프트웨어를 실행하여 전자장치의 적어도 하나의 다른 구성요소(예: 하드웨 어 또는 소프트웨어 구성요소)를 제어할 수 있고, 다양한 데이터 처리 또는 연산을 수행할 수 있다. 본 발명의 일 실시예에 따른 프로세서는 (a) 감마선이 검출될 때의 PET 검출기의 좌표 및 타임스탬프를 포 함하는 PET 정보를 수신하고, (b) 상기 좌표들 및 세포의 추정된 위치들에 기초하여 경로 결정 행렬에 관한 손 실함수를 설정하고, (c) 역전파(backpropagation)를 이용하여 상기 손실함수의 그래디언트(gradient)를 계산하 고, (d) 상기 계산된 그래디언트를 이용하여 상기 경로 결정 행렬을 업데이트하고, (e) 상기 (c) 동작 및 상기 (d) 동작을 반복하여 상기 손실함수를 최소화하는 제1경로 결정 행렬을 식별하고, (f) 상기 제1경로 결정 행렬 을 이용하여 세포의 이동 경로를 식별할 수 있다. 한편, 프로세서는 상기 동작들을 수행하기 위한 데이터 분석, 처리, 및 결과 정보 생성 중 적어도 일부를 규칙 기반 또는 인공지능(Artificial Intelligence) 알고리즘으로서 기계학습, 신경망 네트워크(neural network), 또는 딥러닝 알고리즘 중 적어도 하나를 이용하여 수행할 수 있다. 신경망 네트워크의 예로는, CNN (Convolutional Neural Network), DNN (Deep Neural Network), RNN (Recurrent Neural Network), Vision Transformer과 같은 모델을 포함할 수 있다. 도 2는 본 발명의 일 실시예에 따른 양전자 방출 단층촬영 영상에서 세포의 이동 경로를 추적하는 방법을 도시 한 도면이다. 추적 방법은 감마선이 검출될 때의 PET 검출기의 좌표 및 타임스탬프를 포함하는 PET 정보를 수신하는 단계 (S10)를 포함할 수 있다. 양전자 방출 단층촬영은 양전자를 방출하는 방사성 동위원소를 결합한 의약품을 체내에 주입한 후 양전자 방출 단층 촬영기를 이용하여 이를 추적하여 체내 분포를 알아보는 방법이다. 체내에 투여된 동위원소는 체내에서 1 개의 양전자를 방출하며 붕괴한다. 방출된 양전자는 근처의 전자와 쌍소멸하면서 서로 정반대 방향으로 진행하 는 두 개의 감마선을 생성한다. PET 장비는 인체의 주위를 둘러싸도록 배열된 다수의 감마선 검출기(PET 검출기)와 2개의 광자신호의 동시성을 판별하는 회로로 구성될 수 있다. PET 검출기 중 두 개가 동시에 감마선 을 감지하면, 그 두 검출기를 잇는 직선 위에서 쌍소멸이 일어났다는 것을 알 수 있다. 즉, LoR(Line of Response)이라고 알려진 광자 쌍의 각 우연 이벤트가 개별적으로 저장되고, 이러한 LoR 각각에 대해 광자 쌍 감지와 관련된 두 검출기의 좌표와 감마선이 검출된 시각이 타임스탬프로 기록된다. 프로세서는 PET 검출기의 좌표 및 타임스탬프를 포함하는 PET 정보를 수신할 수 있다. 프로세서는 PET 장비로부터 PET 정보를 수신할 수 있다. PET 정보는 PET 목록 모드 데이터(PET list mode data) 형식을 사 용하여 수집될 수 있다. 프로세서는 입자 시뮬레이션 소프트웨어를 이용하여 세포의 이동 경로를 시뮬레이 션하고 실측 이동 경로를 통해 목록 모드 데이터를 생성할 수 있다. 입자 시뮬레이션 소프트웨어는 예를 들어 TOPAS일 수 있다. 추적 방법은 좌표들 및 세포의 추정된 위치들에 기초하여 경로 결정 행렬에 관한 손실함수를 설정하는 단계 (S20)를 포함할 수 있다. Cell GPS 알고리즘의 목적은 PET 정보로부터 살아있는 유기체의 단일 방사성 표지 세포의 궤적을 추정하는 것으 로, LoR, 즉 PET 검출기 좌표들을 이은 직선들과 세포의 추정된 위치들 간의 거리 제곱 합이 가장 작은 경로를 찾는 것을 목표로 한다. 세포(점 소스)의 이동 경로는 3차원 입방 스플라인으로 표시할 수 있다. 구체적으로, 이동 경로(r(t))는 스플라 인 bn-1,3(t)과 계수 A·n = (anx, any, anz)T 의 선형 조합으로 구성된다. 이동 경로(r(t))는 다음 수학식 1과 같이 나타낼 수 있다. 수학식 1"}
{"patent_id": "10-2023-0130697", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "이때, 선형회귀의 경우 직선이 기울기와 절편으로 결정되듯이, 3차원 입방 스플라인으로 재건된 세포의 이동 경 로는 경로를 결정하는 변수들의 행렬인 A에 의해서 결정된다. A는 경로 결정 행렬이라고도 하며, 최적의 이동 경 로를 찾는 것은 최적의 행렬 A를 찾는 것과 동치이다. 다음 수학식 2는 좌표들(Pj) 및 세포의 추정된 위치들(Mj=r(τj)) 간의 유클리드 거리(Dj)를 나타낸다. 수학식 2"}
{"patent_id": "10-2023-0130697", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "좌표(Pj)는 이벤트 j일때의 검출기 중 하나의 위치로 정의되며, 선(line)의 단위 길이 방향은 vj로 표시된다. 이 벤트 j의 타임스탬프는 τj로 표시된다. 타임스탬프 τj에서의 세포의 추정된 위치 Mj(=r(τj))는 상기 수학식 1 에 나타난 바와 같이 경로 결정 행렬 및 3차원 입방 스플라인 함수로 나타낼 수 있다. 수학식 3은 제한된 평균 제곱 거리에 대한 손실함수 I(A)를 나타낸다. 수학식 3"}
{"patent_id": "10-2023-0130697", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "앞서 서술한 바와 같이, PET 검출기 좌표들을 이은 직선들과 세포의 추정된 위치들 간의 거리 제곱 합만 최소화 한다면 정규방정식을 통해 계산할 수 있지만, PET 측정 시 발생하는 잡음으로 인해 재건된 경로의 정확도가 떨 어질 수 있다. 따라서, 거리 제곱 합을 최소화하되, PET 검출기 좌표들을 이은 직선들과 세포의 추정된 위치들 간의 평균 제곱 거리의 상한값(dmax)을 설정할 수 있다. 이를 통해, 잡음을 배제하고, 실제로 필요한 데이터를 이용해 경로를 재건할 수 있다. 또한, 해당 함수는 극소가 여러 군데에서 존재할 수 있기 때문에 정규방정식을 통해 경로를 구할 수 없다. 따라 서, 하이퍼파라미터 λ와 R(A)를 곱한 항을 손실함수에 추가함으로써 알고리즘을 원하는 솔루션으로 안내할 수있다. 이는 다음 수학식 4 및 수학식 5로 나타낼 수 있다. 수학식 4"}
{"patent_id": "10-2023-0130697", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 5, "content": "R(A)는 A의 연속 열 간의 평균 제곱 차이이다. 수학식 5"}
{"patent_id": "10-2023-0130697", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 6, "content": "최종적으로, 본 발명의 일 실시예에 따른 손실함수(목적 함수라고도 한다.)는 수학식 5에 따른 J(A)이다. 프로 세서는 경로 결정 행렬 및 3차원 입방 스플라인 함수를 이용하여 타임스탬프에서의 세포의 위치를 추정할 수 있다. 프로세서는 PET 검출기의 좌표들 및 세포의 추정된 위치들에 기초하여 경로 결정 행렬에 관한 손 실함수를 설정할 수 있다. 이때, J(A)를 최소화하는 최적의 경로 결정 행렬(A)을 찾으면, 최적의 세포 이동 경 로를 찾을 수 있다. 추적 방법은 역전파(backpropagation)를 이용하여 손실함수의 그래디언트(gradient)를 계산하는 단계(S30)를 포 함할 수 있다. 기존의 Cell GPS 알고리즘은 손실함수를 수치적으로 미분해 손실함수를 최적화 하는데 사용되는 그래디언트를 계산하였으나, 이는 상대적으로 속도가 느리다. 종래 알고리즘은 약간 다른 두 지점에서 함수를 평가하고 해당 지점을 연결하는 선의 기울기를 계산하여 근사치를 계산하는 바, A에 기울기를 계산하는 요소가 많을 때 계산 양이 매우 많아질 수 있다. 예를 들어, A에 3N개의 요소가 있는 경우 그래디언트를 계산하려면 최소 3N+1번의 손실함수 평가가 필요하다. 본 발명에서는 역전파를 적용해 그래디언트 계산 속도를 향상시킬 수 있다. 역전파는 손실함수를 미분하기 위해 합성함수의 미분법(chain rule)을 사용해서 빠르게 그래디언트를 계산할 수 있다. 그러기 위해서는 손실함수가 미분가능한 간단한 연산의 합성으로 표현되어야 한다. 구체적으로, 거리제곱합을 계산할 때 필요한, 각 타임스탬프에서의 세포의 추정된 위치를 행렬곱 연산을 통해 계산함으로써, 역전파를 적용할 수 있도록 손실함수를 변형시킬 수 있다. 앞서 서술한 바와 같이, 타임스탬프에서의 세포의 추정된 위치는 경로 결정 행렬 및 3차원 입방 스플라인 함수 로 나타낼 수 있다. 따라서, 3차원 입방 스플라인 함수를 행렬로 변환할 수 있으면, 각 타임스탬프에서의 세포 의 추정된 위치는 행렬곱 연산을 통해 계산할 수 있다. 3차원 입방 스플라인 함수를 NxK 행렬로 나타내는 식은 다음 수학식 6과 같다. 수학식 6"}
{"patent_id": "10-2023-0130697", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 7, "content": "따라서, 세포의 이동 경로를 행렬 A와 B의 곱으로 표현함으로써 역전파 알고리즘을 적용하여 손실함수의 그래디 언트를 계산할 수 있다. 이렇게 하면 손실함수 평가 횟수가 기존 3N + 1 회에서 단 1회로 줄어드는 바, 계산 효 율성이 크게 향상될 수 있다. 추적 방법은 계산된 그래디언트를 이용하여 경로 결정 행렬을 업데이트하는 단계(S40)를 포함할 수 있다. 프로세서는 현재 경로 결정 행렬과 계산된 그래디언트를 이용하여 경로 결정 행렬을 업데이트할 수 있다. 이는 곧 세포의 이동 경로를 업데이트할 수 있다는 것을 의미한다. 이때, 업데이트는 경사하강법을 이용할 수 있으나, 어느 하나에 한정되는 것은 아니다. 추적 방법은 S30 및 S40을 반복하여 손실함수를 최소화하는 제1경로 결정 행렬을 식별하는 단계(S50)를 포함할 수 있다. 프로세서는 Cell GPS 알고리즘이 수렴할 때까지 그래디언트 계산 및 경로 결정 행렬의 업데이트 를 계속할 수 있으며, 알고리즘이 수렴할 때의 제1경로 결정 행렬을 식별할 수 있다. 추적 방법은 제1경로 결정 행렬을 이용하여 세포의 이동 경로를 식별하는 단계(S60)를 포함할 수 있다. 세포의 이동 경로는 경로 결정 행렬에 의해 결정되는 바, 프로세서는 제1경로 결정 행렬을 이용하여 세포의 이동 경로를 식별할 수 있다. 본 발명에서는 역전파를 활용하기 위해 야코비 행렬(Jacobian matrix) 옵션을 사용할 수 있으며, 최적화를 위한 보다 효율적인 그래디언트 계산이 가능하다. 또한, 본 발명에서는 Cell GPS 알고리즘의 정밀도를 향상시키기 위 해 서로 다른 2개 이상의 상한값(dmax)을 사용하는 2단계 수렴 프로세스를 통해 결과를 도출할 수 있다. 본 발명의 일 실시예에 따르면, 경로 추적의 정확도를 잃지 않으면서 계산 속도를 크게 향상시킬 수 있다. 도 3은 본 발명의 일 실시예에 따른 양전자 방출 단층촬영 영상에서 세포의 이동 경로를 추적하는 방법을 도시 한 도면이다. 도 3의 내용 중 도 2와 중복되는 내용은 도 2와 관련하여 설명한 내용을 차용한다. 본 발명의 일 실시예에 따른 Cell GPS 알고리즘은 먼저 PET 정보(PET 목록 모드 데이터)를 입력하여(Input: PET list mode data), 세포의 이동 경로에 관한 3차원 입방 스플라인 함수를 초기 설정한다(Initialize Spline). 세포의 이동 경로에 관한 손실함수 상에서 그래디언트를 계산하여 이동 경로에 관한 함수를 최적화한다 (Calculate Gradient 및 Optimize Spline). Cell GPS 알고리즘이 수렴하는지 확인하여, 수렴하지 않는 경우 그래디언트 계산 및 함수 최적화 과정을 반복한 다(Converged). 수렴하는 경우, 최적화된 세포의 이동 경로를 출력한다(Output: Cell Trajactory). 도 4는 종래 실제 데이터, 종래 알고리즘을 이용한 세포 이동 경로 및 본 발명의 일 실시예에 따른 세포 이동 경로를 도시한 도면이다. 종래 알고리즘과 본 발명의 일 실시예에 따른 알고리즘의 정확도는 감지된 시간 범위에서 동일한 간격(예: 0.05 초)의 시점에 대해 실측 궤적(gt(θi))과 재구성된 궤적(r(θi))의 RMS(제곱 평균 제곱근) 거리를 계산하여 평가 할 수 있다. 이는 다음 수학식 7과 같다. 수학식 7"}
{"patent_id": "10-2023-0130697", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 8, "content": "Q는 시점의 개수이고, θi는 동일한 간격 시점의 i번째 시점이며, 실측 궤적(gt(θi))과 재구성된 궤적(r(θi)) 에 해당한다. 도 4는 종래 알고리즘과 본 발명의 일 실시예에 따른 알고리즘, 두 가지 알고리즘을 사용하여 PET 정보를 이용 하여 재구성된 세포 이동 경로의 예시이다. 세포 이동 경로는 (a)에서 시간의 함수로 표시되고 (b)에서는 3차원 으로 표시된다. 도 4를 참조하면 두 알고리즘 간 정확도에는 눈에 띄는 차이가 없음을 알 수 있다. 재구성 시간의 경우, 본 발명에 따른 역전파 접근법이 계산 속도를 크게 향상시켰음을 알 수 있다. 종래 알고리 즘은 8.44초 만에 궤적 재구성을 달성했지만, 현재 알고리즘은 0.139초에 불과해 재구성 시간이 60.7배 단축되 었다. 이하, 다양한 하이퍼파라미터 설정이 계산 속도에 어떤 영향을 미치는지 확인한다. 도 5a 내지 도5d는 종래 알고리즘 및 본 발명의 알고리즘을 이용할 때의 재구성(reconstruction) 시간 및 정확 도를 비교한 도면이다. 도 5a 및 도 5c는 하이퍼파라미터를 조정하여 재구성 시간 및 정확도를 측정한 그래프이다. 도 5a 및 도 5c에서 y축은 로그 눈금으로 표시된다. 도 5a의 왼쪽 그래프는, 10에서 100까지 하나의 스플라인 간격(d)에서 평균 감지 횟수를 10씩 증가시켜 재구성 시간을 측정한 그래프이다. 하이퍼파라미터는 λ = 0.0044, dmax1 = 2.8cm, dmax2 = 0.6cm로 설정되었다. 도 5a의 왼쪽 그래프를 통해 하나의 스플라인 간격이 감소하면 두 알고리즘의 재구성 시간이 증가함을 알 수 있 다. 도 5a의 오른쪽 그래프는, 0.001부터 0.01까지 0.001씩 λ를 조정하여 재구성 시간을 측정한 그래프이다. 하이 퍼파라미터는 하나의 스플라인 간격에서 평균 감지 횟수를 36으로 설정하고 dmax1 = 2.8cm, dmax2 = 0.6cm로 설정 했다. 도 5a의 오른쪽 그래프를 통해 λ가 증가함에 따라 두 알고리즘의 재구성 시간이 감소함을 알 수 있다. 다만 재 구성 시간은 하이퍼파라미터를 조정한 만큼 변하지 않았다. λ가 증가함에 따라 종래 알고리즘에서는 평균 재구 성 시간이 9.96초에서 6.35초로 변했고, 현재 알고리즘에서는 0.12초에서 0.07초로 변했다 도 5c의 왼쪽 그래프는, 10에서 100까지 하나의 스플라인 간격에서 평균 감지 횟수를 10씩 증가시켜 정확도를 측정한 그래프이다. 하이퍼파라미터는 λ = 0.0044, dmax1 = 2.8cm, dmax2 = 0.6cm로 설정되었다. 도 5c의 오른쪽 그래프는, 0.001부터 0.01까지 0.001씩 λ를 조정하여 정확도를 측정한 그래프이다. 하이퍼파라 미터는 하나의 스플라인 간격에서 평균 감지 횟수를 36으로 설정하고 dmax1 = 2.8cm, dmax2 = 0.6cm로 설정했다. 도 5b 및 도 5d는 실험 조건을 조정하여 재구성 시간 및 정확도를 측정한 그래프이다. 도 5b 및 도 5d의 하이퍼파라미터는 하나의 스플라인 간격에서 평균 감지 횟수를 36, λ = 0.0044, dmax1 = 2.8cm, dmax2 = 0.6cm로 설정했다. 도 5b의 왼쪽 그래프는, 6분에서 14분까지 2분 단위로 감지 시간을 조정하여 재구성 시간을 측정한 그래프이고, 도 5b 의 오른쪽 그래프는, 50Bq에서 200Bq까지 25Bq씩 방사능을 증가시켜 재구성 시간을 측정한 그래프이다. 도 5d의 왼쪽 그래프는, 6분에서 14분까지 2분 단위로 감지 시간을 조정하여 정확도를 측정한 그래프이고, 도 5d 의 오른쪽 그래프는, 50Bq에서 200Bq까지 25Bq씩 방사능을 증가시켜 정확도를 측정한 그래프이다. 도 6a 내지 도 6d는 하이퍼 파라미터 변경에 따른 종래 알고리즘 및 본 발명의 알고리즘을 이용할 때의 재구성 시간 차이, 재구성 시간 비율 및 수렴에 대한 반복 횟수를 비교한 그래프를 도시한다. 도 6a는 하나의 스플라인 간격의 평균 감지 횟수는 10에서 100까지 10씩 증가하고, 하이퍼파라미터는 λ = 0.0044, dmax1 = 2.8cm, dmax2 = 0.6cm로 설정되었다. 도 6b는 λ를 0.001에서 0.01까지 0.001씩 변경하였고, 하이퍼파라미터는 하나의 스플라인 간격에서 평균 감지 횟수를 36으로 설정하고 dmax1 = 2.8cm, dmax2 = 0.6cm로 설정했다. 10분 동안 100 Bq의 방사능 수준을 갖는 세포의 시뮬레이션된 궤적 100개가 포함된 데이터 세트가 도 6a와 도 6b 모두에 사용되었다. 도 6c는 시뮬레이션의 감지 시간은 6분에서 14분까지 2분 단위로 변경되었고, 시뮬레이션된 세포의 방사능은 100Bq이다. 도 6d는 시뮬레이션에서 셀의 방사능은 25 Bq 씩 25 Bq에서 200 Bq까지 다양했다. 시뮬레이션의 감지 시간은 10 분이다. 하이퍼파라미터는 도 6c와 도 6d 모두에 대해 하나의 스플라인 간격에서 평균 감지 수를 36으로 설정하고 λ = 0.0044, dmax1 = 2.8cm, dmax2 = 0.6cm로 설정했다.부호의 설명 100: 전자장치 110: 입력부 120: 통신부 130: 표시부 140: 저장부 150: 프로세서"}
{"patent_id": "10-2023-0130697", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 일 실시예에 따른 전자장치의 구성을 도시한 블럭도이다. 도 2는 본 발명의 일 실시예에 따른 양전자 방출 단층촬영 영상에서 세포의 이동 경로를 추적하는 방법을 도시 한 도면이다.도 3은 본 발명의 일 실시예에 따른 양전자 방출 단층촬영 영상에서 세포의 이동 경로를 추적하는 방법을 도시 한 도면이다. 도 4는 종래 실제 데이터, 종래 알고리즘을 이용한 세포 이동 경로 및 본 발명의 일 실시예에 따른 세포 이동 경로를 도시한 도면이다. 도 5a 내지 도5d는 종래 알고리즘 및 본 발명의 알고리즘을 이용할 때의 재구성(reconstruction) 시간 및 정확 도를 비교한 도면이다. 도 6a 내지 도 6d는 하이퍼파라미터 변경에 따른 종래 알고리즘 및 본 발명의 알고리즘을 이용할 때의 재구성 시간 차이, 재구성 시간 비율 및 수렴에 대한 반복 횟수를 비교한 그래프를 도시한다."}
