{"patent_id": "10-2023-0089809", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2025-0009777", "출원번호": "10-2023-0089809", "발명의 명칭": "이미지에서 세포핵을 분할하는 방법 및 장치", "출원인": "경북대학교 산학협력단", "발명자": "정순기"}}
{"patent_id": "10-2023-0089809", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "영상 처리 장치가 현미경 이미지를 입력 받는 단계; 상기 영상 처리 장치가 상기 현미경 이미지를 분할 모델에 입력하는 단계; 및 상기 영상 처리 장치가 상기 분할 모델의 출력값을 기반으로 상기 현미경 이미지에서 세포핵을 분할(segmentation)하는 단계; 를 포함하되, 상기 분할 모델은 상기 현미경 이미지에서 특징을 추출하는 특징 추출기(Feature Extractor), 상기 특징 추출기가 추출한 특징간의 상관관계를 분석하는 트랜스포머 블록(Transformer Blocks) 및 상기 상관관계가 분석된 특징을 기반으로 세포핵이 분할된 현미경 이미지를 재구축하는 디코더(Decoder)를 포함하는, 현미경 이미지에서세포핵을 분할하는 방법."}
{"patent_id": "10-2023-0089809", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 현미경 이미지는 조직 병리학 이미지를 포함하는, 현미경 이미지에서 세포핵을 분할하는 방법."}
{"patent_id": "10-2023-0089809", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1항에 있어서,상기 현미경 이미지에서 세포핵을 분할하는 것은 상기 현미경 이미지의 각 픽셀을 세포핵 또는 세포핵이 아닌배경으로 이진 분류(Binary Classfication)하는 것인, 현미경 이미지에서 세포핵을 분할하는 방법."}
{"patent_id": "10-2023-0089809", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제1항에 있어서,상기 특징 추출기는 컨볼루션(Convolution) 연산을 통해 상기 현미경 이미지에서 특징을 추출하는, 현미경 이미지에서 세포핵을 분할하는 방법."}
{"patent_id": "10-2023-0089809", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제1항에 있어서,상기 트랜스포머 블록은 외부 어텐션 모듈(External Attention Module) 및 토큰 선택 모듈(Token SelectorModule)을 포함하는, 현미경 이미지에서 세포핵을 분할하는 방법."}
{"patent_id": "10-2023-0089809", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제5항에 있어서,상기 외부 어텐션 모듈은 입력되는 샘플이 공통적으로 공유하는 키 메모리(Key Memory) 값 및 값 메모리(ValueMemory) 값을 기반으로 어텐션(Attention)연산을 수행하는, 현미경 이미지에서 세포핵을 분할하는 방법."}
{"patent_id": "10-2023-0089809", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제5항에 있어서, 상기 토큰 선택 모듈은 어탠션 맵을 이용해 불필요한 토큰을 제거하여 토큰 선택성을 향상시키는, 현미경 이미지에서 세포핵을 분할하는 방법."}
{"patent_id": "10-2023-0089809", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "공개특허 10-2025-0009777-3-현미경 이미지를 입력 받는 입력장치; 상기 현미경 이미지를 분할 모델에 입력하고, 상기 분할 모델의 출력값을 기반으로 상기 현미경 이미지에서 세포핵을 분할(segmentation)하는 연산장치; 및 상기 현미경 이미지 및 상기 분할 모델을 저장하는 저장장치;를 포함하되, 상기 분할 모델은 상기 현미경 이미지에서 특징을 추출하는 특징 추출기(Feature Extractor), 상기 특징 추출기가 추출한 특징간의 상관관계를 분석하는 트랜스포머 블록(Transformer Blocks) 및 상기 상관관계가 분석된 특징을 기반으로 세포핵이 분할된 현미경 이미지를 재구축하는 디코더(Decoder)를 포함하는, 현미경 이미지에서세포핵을 분할하는 장치."}
{"patent_id": "10-2023-0089809", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제8항에 있어서,상기 현미경 이미지는 조직 병리학 이미지를 포함하는, 현미경 이미지에서 세포핵을 분할하는 장치."}
{"patent_id": "10-2023-0089809", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제8항에 있어서,상기 현미경 이미지에서 세포핵을 분할하는 것은 상기 현미경 이미지의 각 픽셀을 세포핵 또는 세포핵이 아닌배경으로 이진 분류(Binary Classfication)하는 것인, 현미경 이미지에서 세포핵을 분할하는 장치."}
{"patent_id": "10-2023-0089809", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "제8항에 있어서,상기 특징 추출기는 컨볼루션(Convolution) 연산을 통해 상기 현미경 이미지에서 특징을 추출하는, 현미경 이미지에서 세포핵을 분할하는 장치."}
{"patent_id": "10-2023-0089809", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제8항에 있어서,상기 트랜스포머 블록은 외부 어텐션 모듈(External Attention Module) 및 토큰 선택 모듈(Token SelectorModule)을 포함하는, 현미경 이미지에서 세포핵을 분할하는 장치."}
{"patent_id": "10-2023-0089809", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "제12항에 있어서,상기 외부 어텐션 모듈은 입력되는 샘플이 공통적으로 공유하는 키 메모리(Key Memory) 값 및 값 메모리(ValueMemory) 값을 기반으로 어텐션(Attention)연산을 수행하는, 현미경 이미지에서 세포핵을 분할하는 장치."}
{"patent_id": "10-2023-0089809", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_14", "content": "제12항에 있어서, 상기 토큰 선택 모듈은 어탠션 맵을 이용해 불필요한 토큰을 제거하여 토큰 선택성을 향상시키는, 현미경 이미지에서 세포핵을 분할하는 장치."}
{"patent_id": "10-2023-0089809", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_15", "content": "제1항 내지 7항 중 어느 하나의 항에 기재된 현미경 이미지에서 세포핵을 분할하는 방법을 실행하기 위한 프로그램을 기록한 컴퓨터로 읽을 수 있는 기록매체."}
{"patent_id": "10-2023-0089809", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "이미지에서 세포핵을 분할하는 방법은 영상 처리 장치가 현미경 이미지를 입력 받는 단계; 상기 영상 처리 장치 가 상기 현미경 이미지를 분할 모델에 입력하는 단계; 및 상기 영상 처리 장치가 상기 분할 모델의 출력값을 기 반으로 상기 현미경 이미지에서 세포핵을 분할(segmentation)하는 단계; 를 포함한다. 분할 모델은 현미경 이미지에서 특징을 추출하는 특징 추출기(Feature Extractor), 특징 추출기가 추출한 특징간 의 상관관계를 분석하는 트랜스포머 블록(Transformer Blocks) 및 상관관계가 분석된 특징을 기반으로 세포핵이 분할된 현미경 이미지를 재구축하는 디코더(Decoder)를 포함할 수 있다."}
{"patent_id": "10-2023-0089809", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "이하 설명하는 기술은 이미지에서 세포핵을 분할하는 방법에 대한 것이다."}
{"patent_id": "10-2023-0089809", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "최근 인공지능 기술이 발달하기 시작하면서 인공지능 기술을 이용해 이미지를 분석하는 기술들이 개발되고 있다. 예를 들어 이미지를 분류(Classify)하거나 이미지에 설명을 기재하는 기술들이 있다. 또는 이미지에서 특 정 객체를 분할(segmentation)하거나 특정 객체를 탐지(detection) 하는 기술들도 개발되고 있다. 인공지능을 이용해 이미지를 분석하는 기술은 의료영상을 처리하는 분야에도 적용되고 있다. 예를 들어 인공지 능은 의료영상을 기반으로 병을 진단하는 의사의 판단을 돕거나, 의료영상에 나타난 병변의 위치, 크기등을 알 려주는 방식등으로 활용되고 있다. 선행기술문헌 특허문헌 (특허문헌 0001) 미국 등록특허공고 10,628,658 B2"}
{"patent_id": "10-2023-0089809", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "이미지에서 핵을 분할하는 것은 다양한 분석에 이용될 수 있다. 예를 들어 세포의 개수를 세는 것(Cell counting), 셀 타입을 분류하는 것 및 셀의 형태를 파악하는 것등에 활용될 수 있다. 병리학자가 이미지에서 핵을 수동으로 분할하는 것은 많은 시간과 노력이 필요하다. 또한 병리학자가 핵을 수동 으로 분할하는 과정에서 에러가 생길 수도 있다. 이에 종래 이미지에서 핵을 분할하는 방법들이 있었다. 이러한 종래 방법은 임계값(Thresholding)을 기준으로 핵을 분할하곤 하였다. 하지만 종래 기술은 파라미터를 조절할 필요가 있거나, 전혀 다른 실험조건에서 측정된 이미지에서 적용될 때 그 신뢰성에 문제가 생기는 경우가 많았 다. 이하 설명하는 기술은 인공지능 기반의 모델을 이용함으로써 이미지에서 핵을 분할하는 방법을 개시하고자 한다."}
{"patent_id": "10-2023-0089809", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "전술한 과제를 해결하기 위해 이하 설명하는 기술은 이미지에서 세포핵을 분할하는 방법을 개시한다. 이미지에서 세포핵을 분할하는 방법은 영상 처리 장치가 현미경 이미지를 입력 받는 단계; 상기 영상 처리 장치 가 상기 현미경 이미지를 분할 모델에 입력하는 단계; 및 상기 영상 처리 장치가 상기 분할 모델의 출력값을 기 반으로 상기 현미경 이미지에서 세포핵을 분할(segmentation)하는 단계; 를 포함한다. 분할 모델은 현미경 이미지에서 특징을 추출하는 특징 추출기(Feature Extractor), 특징 추출기가 추출한 특징 간의 상관관계를 분석하는 트랜스포머 블록(Transformer Blocks) 및 상관관계가 분석된 특징을 기반으로 세포핵 이 분할된 현미경 이미지를 재구축하는 디코더(Decoder)를 포함할 수 있다."}
{"patent_id": "10-2023-0089809", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "이하 설명하는 기술을 이용하면 이미지 내에서 핵을 분할할 수 있다. 이를 통해 현재 세포의 개수, 세포의 종류 등을 파악할 수 있다. 더 나아가 환자의 건강 상태에 대해서도 판단할 수 있다. 이하 설명하는 기술을 이용하면 이질적인 핵 크기와 모양, 셀포 밀도, 배경 조명, 현미경 배율 및 양식에 걸쳐 일반화를 잘할 수 있다."}
{"patent_id": "10-2023-0089809", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하 설명하는 기술은 다양한 변경을 가할 수 있고 여러 가지 실시예를 가질 수 있다. 명세서의 도면에 이하 설 명하는 기술의 특정 실시 형태가 기재될 수 있다. 그러나, 이는 이하 설명하는 기술의 설명을 위한 것이며 이하 설명하는 기술을 특정한 실시 형태에 대해 한정하려는 것이 아니다. 따라서 이하 설명하는 기술의 사상 및 기술 범위에 포함되는 모든 변경 물, 균등 물 내지 대체 물이 이하 설명하는 기술에 포함하는 것으로 이해되어야 한 다. 다양한 구성요소들을 설명하기 위해서 제1, 제2, A, B 등의 용어가 사용될 수 있다. 하지만 상기 용어는 단지 하나의 구성요소를 다른 구성요소들과 구별하기 위해서 사용될 뿐, 상기 용어로 해당 구성요소들을 한정하려고 하는 것이 아니다. 예를 들어, 이하 설명하는 기술의 권리 범위를 벗어나지 않으면서 제1 구성요소는 제2 구성 요소로 명명될 수 있고, 유사하게 제2 구성요소도 제1 구성요소로 명명될 수 있다. “및/또는” 이라는 용어는 복수의 관련된 기재된 항목들의 조합 또는 복수의 관련된 기재된 항목들 중의 어느 항목을 포함한다. 이하 사용되는 용어에서 단수의 표현은 문맥상 명백하게 다르게 해석되지 않는 한 복수의 표현을 포함하는 것으 로 이해되어야 하고, \"포함한다\" 등의 용어는 기재된 특징, 개수, 단계, 동작, 구성요소, 부분품 또는 이들을 조합한 것이 존재함을 의미하는 것이지, 하나 또는 그 이상의 다른 특징들이나 개수, 단계 동작 구성요소, 부분 품 또는 이들을 조합한 것들의 존재 또는 부가 가능성을 배제하지 않는 것으로 이해되어야 한다. 도면에 대한 상세한 설명을 하기에 앞서, 본 명세서에서의 구성부들에 대한 구분은 각 구성부가 담당하는 주기 능 별로 구분한 것에 불과함을 명확히 하고자 한다. 즉, 이하에서 설명할 2개 이상의 구성부가 하나의 구성부로 합쳐지거나 또는 하나의 구성부가 보다 세분화된 기능별로 2개 이상으로 분화되어 구비될 수도 있다. 그리고 이 하에서 설명할 구성 부 각각은 자신이 담당하는 주기능 이외에도 다른 구성부가 담당하는 기능 중 일부 또는 전 부의 기능을 추가적으로 수행할 수도 있으며, 구성부 각각이 담당하는 주기능 중 일부 기능이 다른 구성부에 의 해 전담되어 수행될 수도 있음은 물론이다. 또, 방법 또는 동작 방법을 수행함에 있어서, 상기 방법을 이루는 각 과정들은 문맥상 명백하게 특정 순서를 기 재하지 않은 이상 명기된 순서와 다르게 일어날 수 있다. 즉, 각 과정들은 명기된 순서와 동일하게 일어날 수도 있고 실질적으로 동시에 수행될 수도 있으며 반대의 순서대로 수행될 수도 있다. 이하 영상 처리 장치가 현미경 이미지에서 세포핵을 분할하는 전체적인 과정에 대해 설명한다. 도1은 영상 처리 장치가 현미경 이미지에서 세포핵을 분할하는 전체적인 과정을 보여준다. 영상 처리 장치는 현미경 이미지를 입력 받을 수 있다. 영상 처리 장치는 현미경 이미지를 분할 모델 에 입력 할 수 있다. 영상 처리 장치는 분할 모델의 출력값을 기반으로 현미경 이미지에서 세포핵을 분할 할 수 있다. 분할 모델은 현미경 이미지에서 특징을 추출하는 특징 추출기(Feature Extractor), 특징 추출기가 추출한 특징 간의 상관관계를 분석하는 트랜스포머 블록(Transformer Blocks) 및 상관관계가 분석된 특징을 기반으로 세포핵 이 분할된 현미경 이미지를 재구축하는 디코더(Decoder)를 포함할 수 있다. 이하 현미경 이미지에서 세포핵을 분할하는 방법을 구체적으로 설명한다. 도2는 영상 처리 장치가 현미경 이미지에서 세포핵을 분할하는 방법의 실시예 중 하나의 순서도이다. 영상 처리 장치는 현미경 이미지를 입력 받을 수 있다. 현미경 이미지는 현미경을 통해 세포(Cell), 조직(Tissue) 및 장기(Organ)를 촬영한 이미지를 포함할 수 있다. 즉 현미경 이미지는 조직 병리학 이미지를 포함할 수 있다. 현미경 이미지는 세포의 핵이 촬영된 이미지를 포함할 수 있다. 즉 현미경 이미지는 세포의 핵과 세포의 핵이 아닌 배경이 촬영된 이미지를 포함할 수 있다. 현미경 이미지는 특정 해상도를 가지는 이미지를 포함할 수 있다. 예를 들어 현미경 이미지는 256 x 256 해상도 를 가지는 이미지를 포함할 수 있다. 현미경 이미지는 원본이미지를 여러 개의 패치(pacth)로 분할한 이미지 패치를 포함할 수 있다. 예를 들어 현미 경 이미지는 1024 x 1024 해상도를 가지는 원본 이미지를 16개의 256 x 256 해상도를 가지는 이미지 패치로 나 눈 것을 포함할 수 있다. 영상 처리 장치는 현미경 이미지를 분할 모델에 입력할 수 있다. 분할 모델은 학습 데이터를 기반으로 현미경 이미지에서 세포핵을 분할하도록 학습된 모델일 수 있다. 일 실시 예로 분할 모델은 기계학습(Machine Learning) 기반의 모델일 수 있다. 구체적으로 분할 모델은 인공신경망 (Artificial neural network)에 기반한 모델일 수 있다. 분할 모델은 특징을 추출하는 특징 추출기(Feature Extractor), 추출된 특징간의 상관관계를 분석하는 트랜스포 머 블록(Transformer Blocks) 및 상관관계가 분석된 특징을 기반으로 세포핵이 분할된 이미지를 재구축하는 디 코더(Decoder)를 포함할 수 있다. 분할 모델에 대한 구체적인 설명은 후술하도록 한다. 영상 처리 장치는 분할 모델의 출력값을 기반으로 현미경 이미지에서 세포핵을 분할할 수 있다. 일 실시예로 영상 처리 장치는 현미경 이미지의 각 픽셀을 세포핵 또는 세포핵이 아닌 배경으로 이진 분류 (binary classification) 할 수 있다. 일 실시예로 영상 처리 장치는 현미경 이미지의 픽셀 중 세포핵에 속하는 픽셀과 세포핵이 아닌 배경에 속하는 픽셀의 색상을 다르게 표시할 수 있다. 이하 분할 모델에 대하여 구체적으로 설명한다. 도3은 분할 모델의 실시예 중 하나를 보여준다. 분할 모델은 CNN-Transformer 기반의 모델일 수 있다. 분할 모델은 이미지에서 특징(Feature)을 추출하는 특징 추출기(Feature Extractor), 추출된 특징간의 상관관계 를 분석하는 트랜스포머 블록(Transformer Blocks), 상관관계가 분석된 특징을 기반으로 세포핵이 분할된 이미 지를 재구축하는 디코더(Decoder)를 포함할 수 있다. 더 나아가 분할 모델은 특징 추출기와 디코더를 연결하는 스킵 커넥션(Skip Connection)을 포함할 수 있다. 특징 추출기는 현미경 이미지에서 특징을 추출할 수 있다. 특징 추출기는 컨볼루션(Convoulution) 연산을 통해 현미경 이미지에서 특징을 추출할 수 있다. 즉 특징 추출기는 CNN(Convoultion Neural Network)기반의 추출기 일 수 있다. 특징 추출기는 복수개의 단계로 구성될 수 있다. 일 실시예로 특징 추출기는 3개의 단계로 구성될 수 있다. 각 단계는 2개의 컨볼루션 레이어(Convolution Layer)와 1개의 맥스풀링 레이어(Maxpooling Layer), 1개의 배치 정규화 레이어(Batch Normalization Layer) 및 ReLU활성화 함수로 구성될 수 있다. 즉 특징 추출기는 전체적으 로 6개의 컨볼루션 레이어를 포함할 수 있다. 맥스 풀링 레이어는 다운 샘플링할 때 이용된다. 트랜스포머 블록은 어텐션(Attention) 연산을 하는 블록일 수 있다. 어텐션 연산은 입력 데이터간의 상관관계를 계산하여 입력 데이터의 특정부분을 강조하는 연산 중에 하나이다. 트랜스포머 블록은 복수개 있을 수 있다. 일 실시예로 트랜스포머 블록은 12개가 있을 수 있다. 트랜스포머 블록은 외부 어텐션 모듈(External Attention Module) 및 토큰 선택 모듈(Token Selector Module) 을 포함할 수 있다. 도4는 외부 어텐션 모듈의 실시예 중 하나이다. 외부 어텐션 모듈은 입력 받은 특징 중에서 일부를 강조하는 모듈일 수 있다. 외부 어텐션 모듈은 종전 트랜스포머에서 사용되던 Multi-Head Attention 과는 다른 방식으로 어텐션 연산을 수 행한다. 구체적으로 외부 어텐션 모듈은 2개의 파라미터를 이용한다. 첫번째는 키 메모리(Key Memory, Mk)에 대 한 것이다. 두번째는 값 메모리(Value Memory, Mv)에 대한 것이다. 입력되는 모든 샘플은 키 메모리와 값 메모 리을 공통적으로 공유한다. 키 메모리와 값 메모리는 입력 이미지의 픽셀과 외부 메모리 유닛사이의 어텐션 연 산을 할 때 이용된다. 이를 통해 외부 어텐션 모듈은 종전 Multi-Head Attention 과는 달리 적은 계산비용 및 매개변수를 통해 어텐션 연산을 수행할 수 있다. 외부 어텐션 모듈은 입력되는 각 샘플에 선형 변환(Linear Transformer)을 취한 뒤, 키 메모리(Mk) 값을 곱하고, SoftMAX와 정규화 레이어를 통과 시킨 뒤, 마지막으로 값 메모리(Mv) 값을 곱한다. 수학식1은 어텐션을 연산을 할 때 이용되는 식이다. 수학식 1"}
{"patent_id": "10-2023-0089809", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "수학식1에서 F는 외부 어텐션 모듈에 입력되는 특징을 의미한다. 수학식1에서 Mk은 키 메모리 유닛을 의미한다. 수학식1에서 ai,j는 입력 특징 F에서 i번째 픽셀과 키 메모리Mk의 j번째의 행(row)간의 유사도, 즉 어탠션 값을 의미한다. 외부 어텐션 모듈은 수학식1에서 계산한 값에 값 메모리를 곱한 값을 출력한다. 즉 외부 어텐션 모듈이 출력하 는 값(Fout)은 수학식2와 같이 표현될 수 있다. 수학식 2"}
{"patent_id": "10-2023-0089809", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "수학식2에서 A는 수학식1에서 계산된 값을 의미한다. 수학식2에서 Mv는 값 메모리 값을 의미한다. 도5는 토큰 선택 모듈의 실시예 중 하나이다. 토큰 선택 모듈은 토큰의 다양성을 향상시킨다. 구체적으로 토큰 선택 모듈은 어텐션 맵(Attention Map)을 이용 해 불필요한 토큰을 제거함으로써 토큰의 다양성을 향상시킨다. 토큰 선택 모듈은 토큰 선택성을 향상시킬 수 있다. 토큰 선택 모듈은 선형 확장(Linear Expansion), 그룹 컨볼루션(GroupConv) 및 선형 감소(Linear Reduction)을 수행할 수 있다. 선형 확장은 생성된 어텐션 맵을 확장 시킨다. 구체적으로 외부 어텐션 모듈이 생성한 어텐션 맵( )을 선형 투영( )을 하여 어텐션 맵을 확장시킨다( ). 즉 어텐션 맵( )은 확장된 어텐션 맵이 될 수 있다.( ), 이때 H는 확장되기 전 어텐션 해드의 숫자를 의미하며, H'는 확장이된 후 증가된 어탠션 맵의 개수를 의미한다. 이러한 연산은 어텐션 맵의 헤드수를 증가 시키면서도 해드 당 임 베딩된 차원의 수를 희생하지 아니한다. 이러한 선형 확장 과정을 거침으로써 어탠션 맵의 다양성을 증가시킬 수 있다. 그룹 컨볼루션은 확장된 어텐션 맵의 해드별(head-wise)로 가중치 w을 통해 컨볼루션 연산을 수행한다.( ) 이는 토큰간의 지역 연결성(local connectivity)을 계산하기 위하여 이용된다. 컨볼루션 연산 후 중요하지 않는 일부 값을 삭제 함으로써 토큰 선택성을 향상시킬 수 있다. 이는 Relu함수를 적용함으로써 이루어질 수 있다. 이에 응축(Aggregation)을 위해 토큰 선택성(Token selectivity)을 향상시킬 수 있다. 이후 선형 감소(Token Reduction)을 통해 차원을 감소시킨다. 토큰 선택 모듈은 입력 된 어텐션 맵의 헤드와 동 일한 개수만큼의 헤드의 어텐션 맵을 출력할 수 있다. 디코더는 상관관계가 분석된 특징을 기반으로 세포핵이 분할된 이미지를 재구축할 수 있다. 디코더는 입력 이미 지와 동일한 해상도를 가지는 이미지를 구축할 수 있다. 인코더와 디코더는 스킵 컨넥션(Skip Connection)으로 연결되어 있을 수 있다. 이에 인코더의 각 단계에서 추출 된 정보는 스킵 컨넥션을 통해 디코더로 전달될 수 있다. 이를 통해 인코더에서 손실된 기능을 공유하고 더 풍 부한 정보를 얻을 수 있다. 분할 모델은 손실함수의 값이 최소가 되도록 학습될 수 있다. 수학식3은 분할 모델을 학습할 때 이용한 손실함수 중 하나이다. 수학식 3"}
{"patent_id": "10-2023-0089809", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "수학식3의 Lseq는 분할모델이 학습할 떄 이용되는 손실함수를 의미한다. 수학식3의 λ1 및 λ2는 가중치 파라미 터를 의미한다. 수학식3의 Lbce는 이진 크로스 엔트로피 손실(binary cross entropy loss)에 대한 것이다. 수학 식3의 Ldsc는 다이스 유사성 손실(Dice similarity loss)에 대한 것이다. 수학식3에서 t는 타겟 마스크(target mask)에 대한 것이다. 수학식3에서 p는 예측 마스크(predicted mask)에 대한 것이다. 이하 연구원이 전술한 예측 모델을 구축하고, 구축한 예측 모델의 성능을 평가한 실험결과에 대해 살펴 본다. 연구원은 실험을 위하여 2018 Data Science Bowl 로부터 획득한 데이터 셋을 이용하였다 도6은 2018 Data Science Bowl 에서 랜덤으로 선택한 이미지를 보여준다. 해당 데이터셋은 핵이 어노테이션 된(annotated) 670개의 현미경 이미지를 포함한다. 해당 데이터셋은 배양된 세포의 형광이미지 및 염색된 조직에서의 흑백 현미경 이미지 타입으로 구성되어 있다. 해당 데이터 셋에 포함 된 이미지들은 셀의 크기, 형상, 밀집도, 배경의 형태, 현미경의 확대 배수등이 서로 다르다. 해당 데이터에 셋에 포함된 이미지는 다양한 사이즈를 가진다. 이에 연구원은 이를 하나의 사이즈로 정규화하는 작업을 진행하였다. 구체적으로 이미지 중에서 복수개의 패치로 나뉘지 않는 경우, 비어 있는 공간에 패딩 (Padding)을 진행하였다. 도7은 정규화한 실시예 중 하나이다. 도7(a)는 데이터셋의 이미지 중 하나를 보여준다. 해당 이미지는 520 x 696 사이즈를 가진다. 이에 256 x 256 픽셀을 가지는 이미지 패치로 정확하게 분류하기 힘들다. 도7(b)는 패딩을 한 결과를 보여준다. 패딩 전 비어 있는 공간은 이미지가 있는 공간을 그대로 반영하여 채워졌 다. 이에 이미지는 256 x 256 픽셀을 가지는 이미지 패치 9개로 정확하게 분할될 수 있다. 연구원은 데이터셋에 포함된 데이터의 80%는 학습 데이터로, 10%는 검증 데이터로 나머지 10%는 테스트 데이터 로 이용하였다. 연구원은 데이터 증강을 통해 데이터셋을 증강하였다. 연구원은 Intel i7-8th 3.1Ghz CPU및 NVDIA RTX 2080 Super(8GB Vram)GPU 장비를 이용하였다. 모델의 최적화는 Adam optimzizer을 이용하였으며 학습률은 0.001 이고 배치사이즈는 8이다. 학습수는 300이다. 도8은 모델의 성능을 평가한 실험 결과이다. 총 4개의 모델의 성능을 비교평가 하였다. 첫번째는 TransUNEt모델로 “Transunet: Transformers make strong encoders for medical image segmentation”논문에서 제시된 모델이다. 기본적인 TransUNet모델은 Multi-Head attention(MHA)을 수행한다. 두번째는 TransUNet모델에 외부 어텐션 모듈(External Attention, EA)을 추가한 것이다. 세번째는 TransUNet모델에 외부 어텐션 모듈(EA) 및 토큰 선택 모듈(Token Selector, TS)을 추가한 것 이다. 네번째는 TransUNEt모델에 특징 추출기(Feature Extractor, FE), 외부 어텐션 모듈(EA) 및 토큰 선택 모 듈(TS) 추가한 것이다. 외부 어텐션 모듈(EA)을 이용하면 DSC와 IoU가 증가하는 것을 확인할 수 있다. 구체적으로 DSC는 85.79%에서 92.59%로 증가하였으며, IoU는 79.33%에서 87.34%로 증가하였다. 또한 외부 어텐션 모듈(EA)을 적용하면 파라미터의 개수가 크게 감소하는 것을 확인할 수 있다. 대략적으로 약 2.5억개의 파라미터에서 6천개의 파라미터로 감소하였다 또한 외부 어텐션 모듈(EA)과 특징 추출기(FE)를 동시 에 적용한 경우에도 파리미터의 개수가 크게 감소하는 것을 확인할 수 있다. 대략적으로 2.5억개의 파라미터에 서 1천개의 파라미터로 감소하는 것을 확인할 수 있다. 도9는 성능을 평가한 실험결과이다. 총 17개의 모델의 성능을 평가하였다. 전술한 현미경 이미지에서 세포핵 분할방법에 이용되는 분할 모델은 TransUNet-Lite(Ours)이다. TransUNet-Lite(Ours)을 제외한 모델은 서로 다른 형의 이미지를 가지는 현미경 이 미지를 어떻게 처리할 것인지를 반영하지 않는 모델이다. TransUNet-Lite(Ours)모델은 93.08%의 DSC와 87.95%의 IoU값을 가지는 것을 확인할 수 있다. 이것은 비교대상 인 모델들과 비교할 때 가장 큰 값을 가진다. 따라서 TransUNet-Lite(Ours) 분할 모델이 종래 이용된 모델보다 성능이 높다는 것을 확인할 수 있다. 도10은 현미경 이미지에서 세포핵을 분리한 결과를 보여준다. 구체적으로 입력 된 이미지에서 세포핵을 분리한 결과(Predicted mask)를 정답값(Target Label)과 비교한 결과이다. 현미경 이미지에서 세포핵이되는 부분은 빨간색으로 표시하였다. 현미경 이미지에서 세포핵이 아닌 배경이 되는 영역은 파란색으로 표시하였다. 실험결과를 살펴 보면 현미경 이미지에서 세포핵으로 예측한 부분과 실제 세포핵이 있는 영역은 사앙부분 일치 하는 것을 확인할 수 있다. 특히 세포핵의 크기가 클수록 더 잘 예측하는 것을 확인할 수 있다. 이하 영상 처리 장치에 대해 설명한다. 도11은 영상 처리 장치의 실시예 중 하나의 구성이다. 영상 처리 장치는 도1에서 설명한 영상 처리 장치에 해당할 수 있다. 영상 처리 장치는 전술한 이미지에서 세포핵을 분할하는 방법을 실행하는 장치일 수 있다. 영상 처리 장치는 물리적으로 다양한 형태로 구현될 수 있다. 예를 들어 영상 처리 장치는 PC, 노트 북, 스마트기기, 서버 또는 데이터처리 전용 칩셋 등의 형태를 가질 수 있다. 영상 처리 장치는 입력장치, 저장장치, 연산장치, 출력장치, 인터페이스 장치 및 통신장치를 포함할 수 있다. 입력장치는 일정한 명령 또는 데이터를 입력 받는 인터페이스 장치(키보드, 마우스, 터치스크린 등)를 포 함할 수도 있다. 입력장치는 별도의 저장장치(USB, CD, 하드디스크 등)를 통하여 정보를 입력 받는 구성을 포함할 수도 있다. 입력장치는 입력 받는 데이터를 별도의 측정장치를 통하여 입력 받거나, 별도의 DB를 통하여 입력 받을 수도 있다. 입력장치는 유선 또는 무선 통신을 통해 데이터를 입력 받을 수 있다. 입력장치는 전술한 이미지에서 세포핵을 분할하는 방법을 수행하는데 필요한 정보 및 모델을 입력 받을 수 있다. 입력장치는 현미경 이미지를 입력 받을 수 있다. 입력장치는 분할 모델을 입력 받을 수 있다. 저장장치는 입력장치를 통해 입력 받은 정보를 저장할 수 있다. 저장장치는 연산장치가 연 산하는 과정에서 생성되는 정보를 저장할 수 있다. 즉 저장장치는 메모리를 포함할 수 있다. 저장장치 는 연산장치가 계산한 결과를 저장할 수 있다. 저장장치는 전술한 전술한 이미지에서 세포핵을 분할하는 방법을 수행하는데 필요한 정보 및 모델을 저장 할 수 있다. 저장장치는 현미경 이미지를 저장할 수 있다. 저장장치는 분할 모델을 저장할 수 있다. 연산장치는 데이터를 처리하고, 일정한 연산을 처리하는 프로세서, AP, 프로그램이 임베디드된 칩과 같은 장치일 수 있다. 연산장치는 영상 처리 장치를 제어하는 제어신호를 생성할 수 있다. 연산장치는 전술한 이미지에서 세포핵을 분할하는 방법을 수행하는데 필요한 연산을 수행할 수 있다. 연산 장치는 현미경 이미지를 분할 모델에 입력할 수 있다. 연산장치는 분할 모델의 출력값을 기반으로 현 미경 이미지에서 세포핵을 분할할 수 있다. 출력장치는 일정한 정보를 출력하는 장치가 될 수도 있다. 출력장치는 데이터 과정에 필요한 인터페 이스, 입력된 데이터, 분석결과 등을 출력할 수도 있다. 출력장치는 디스플레이, 문서를 출력하는 장치, 등과 같이 물리적으로 다양한 형태로 구현될 수도 있다. 인터페이스 장치는 외부로부터 일정한 명령 및 데이터를 입력 받는 장치일 수 있다. 인터페이스 장치(35 0)는 물리적으로 연결된 입력 장치 또는 외부 저장장치로부터 전술한 이미지에서 세포핵을 분할하는 방법을 수 행하는데 필요한 정보 및 모델을 입력 받을 수 있다. 인터페이스 장치는 영상 처리 장치를 제어하기 위한 제어신호를 입력 받을 수 있다. 인터페이스 장치 는 영상 처리 장치가 분석한 결과를 출력할 수 있다. 통신장치는 유선 또는 무선 네트워크를 통해 일정한 정보를 수신하고 전송하는 구성을 의미할 수 있다. 통 신장치는 영상 처리 장치를 제어하는데 필요한 제어 신호를 수신할 수 있다. 통신장치는 영상 처리 장치가 분석한 결과를 전송할 수 있다. 전술한 이미지에서 세포핵을 분할하는 방법은 컴퓨터에서 실행될 수 있는 실행가능한 알고리즘을 포함하는 프로 그램(또는 어플리케이션)으로 구현될 수 있다. 상기 프로그램은 일시적 또는 비일시적 판독 가능 매체(non-transitory computer readable medium)에 저장되어 제공될 수 있다. 비일시적 판독 가능 매체는 레지스터, 캐쉬, 메모리 등과 같이 짧은 순간 동안 데이터를 저장하는 매체가 아니 라 반영구적으로 데이터를 저장하며, 기기에 의해 판독(reading)이 가능한 매체를 의미한다. 구체적으로는, 상 술한 다양한 어플리케이션 또는 프로그램들은 CD, DVD, 하드 디스크, 블루레이 디스크, USB, 메모리카드, ROM (read-only memory), PROM (programmable read only memory), EPROM(Erasable PROM, EPROM) 또는 EEPROM(Electrically EPROM) 또는 플래시 메모리 등과 같은 비일시적 판독 가능 매체에 저장되어 제공될 수 있 다. 일시적 판독 가능 매체는 스태틱 램(Static RAM，SRAM), 다이내믹 램(Dynamic RAM，DRAM), 싱크로너스 디램 (Synchronous DRAM，SDRAM), 2배속 SDRAM(Double Data Rate SDRAM，DDR SDRAM), 증강형 SDRAM(Enhanced SDRAM ，ESDRAM), 동기화 DRAM(Synclink DRAM，SLDRAM) 및 직접 램버스 램(Direct Rambus RAM，DRRAM) 과 같은 다양 한 RAM을 의미한다. 본 실시예 및 본 명세서에 첨부된 도면은 전술한 기술에 포함되는 기술적 사상의 일부를 명확하게 나타내고 있 는 것에 불과하며, 전술한 기술의 명세서 및 도면에 포함된 기술적 사상의 범위 내에서 당업자가 용이하게 유추 할 수 있는 변형 예와 구체적인 실시예는 모두 전술한 기술의 권리범위에 포함되는 것이 자명하다고 할 것이다."}
{"patent_id": "10-2023-0089809", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도1은 영상 처리 장치가 현미경 이미지에서 세포핵을 분할하는 전체적인 과정을 보여준다. 도2는 영상 처리 장치가 현미경 이미지에서 세포핵을 분할하는 방법의 실시예 중 하나의 순서도이다. 도3은 분할 모델의 실시예 중 하나를 보여준다. 도4는 외부 어텐션 모듈의 실시예 중 하나이다. 도5는 토큰 선택 모듈의 실시예 중 하나이다. 도6은 2018 Data Science Bowl 에서 랜덤으로 선택한 이미지를 보여준다. 도7은 정규화한 실시예 중 하나이다. 도8은 모델의 성능을 평가한 실험 결과이다. 도9는 성능을 평가한 실험결과이다. 도10은 현미경 이미지에서 세포핵을 분리한 결과를 보여준다. 도11은 영상 처리 장치의 실시예 중 하나의 구성이다."}
