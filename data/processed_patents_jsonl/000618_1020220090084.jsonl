{"patent_id": "10-2022-0090084", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2024-0012738", "출원번호": "10-2022-0090084", "발명의 명칭": "인공지능 기술에 기반한 전립선암 조직의 세포 핵의 클러스터 분석 시스템 및 방법", "출원인": "인제대학교 산학협력단", "발명자": "최흥국"}}
{"patent_id": "10-2022-0090084", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "인공지능 기술에 기반하여 전립선암 조직의 세포 핵의 클러스터 분석 방법에 있어서,데이터 획득부가 복수개의 전립선암 WSI(whole slide image)를 획득하는 단계;이미지 전처리부가 상기 복수개의 전립선암 WSI(whole slide image)에 대해 스테인 정규화(stainnormalization) 및 스테인 디콘볼루션(and stain deconvolution)을 수행하는 단계;핵 분할부가 상기 WSI를 HSI (Hue-H, Saturation-S 및 Intensity-I) 색 공간으로 변환하고, S-채널 이미지에대해 콘트라스트 조정을 수행하고 글로벌 임계값 방법을 적용하여 암세포의 핵 분할을 수행하는 단계;클러스터 분석부가 상기 암세포의 핵에 대해 MST(traditional minimum spanning tree (MST) 알고리즘을 사용하여 인터-클러스터 및 인트라-클러스터 분석을 수행하는 단계;특징 추출 및 선택부가 인터-클러스터 및 인트라-클러스터 분석에 기반한 상기 암세포의 핵들의 조직학적 섹션(Histological Sections)에서 형태학적 및 거리 기반 특징(morphological and distancebased features)을 추출및 선택하는 단계; 및AI 분류부가 상기 선택된 특징들에 기초하여 AI-기반 분류를 수행하는 단계를 포함하는 것을 특징으로 하는 방법."}
{"patent_id": "10-2022-0090084", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "청구항 1에 있어서, 상기 AI-기반 분류를 수행하는 단계는상기 선택된 특징들을 스케일링하는 단계;상기 스케일링된 특징들을 트레이닝 데이터셋과 테스팅 데이터셋으로 나누는 단계;복수개의 AI 분류 모델을 상기 트레이닝 데이터셋과 테스팅 데이터셋을 이용하여 트레이닝 및 테스트하는 단계;상기 복수개의 복수개의 AI 분류 모델이 초기 예측을 수행하는 단계;상기 초기 예측들에 기반하여 메타 분류기를 트레이닝하고 테스트하는 단계;상기 메타 분류기가 최종 예측을 수행하는 단계를 포함하는 것을 특징으로 하는 방법."}
{"patent_id": "10-2022-0090084", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "청구항 1에 있어서,상기 인터-클러스터 및 인트라-클러스터 분석을 수행하는 단계는 입력 영상을 이용하여 인접 그리드 매트릭스를 생성하는 단계;상기 그리드 매트릭스의 행들과 열들에서 총 그리드 넘버(total grid numbers)를 산출하는 단계;모든 정점들의 최소 및 최대 가중치들을 포함하는 그래프를 상기 인접 매트릭스로부터 생성하는 단계;상기 그래프의 모든 정점들을 추적하기 위해 MST-set을 생성하는 단계;공개특허 10-2024-0012738-3-상기 그래프의 모든 정점들에 대한 최소 가중치를 찾는 단계를 포함하는 것을 특징으로 하는 방법."}
{"patent_id": "10-2022-0090084", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "청구항 1에 있어서,상기 형태학적 및 거리 기반 특징들은 면적과 거리를 기준으로 숫자로 추출되는 것을 특징으로 하는 방법."}
{"patent_id": "10-2022-0090084", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "청구항 1에 있어서,상기 형태학적 및 거리 기반 특징을 추출 및 선택하는 단계는 필터 방법 및 래퍼(wrapper) 방법의 조합을 사용하여 중요한 특징을 선택하는 단계를 포함하는 것을 특징으로 하는 방법."}
{"patent_id": "10-2022-0090084", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "인공지능 기술에 기반하여 전립선암 조직의 세포 핵의 클러스터 분석 시스템에 있어서,복수개의 전립선암 WSI(whole slide image)를 획득하는 데이터 획득부;상기 복수개의 전립선암 WSI(whole slide image)에 대해 스테인 정규화(stain normalization) 및 스테인 디콘볼루션(and stain deconvolution)을 수행하는 이미지 전처리부;상기 WSI를 HSI (Hue-H, Saturation-S 및 Intensity-I) 색 공간으로 변환하고, S-채널 이미지에 대해 콘트라스트 조정을 수행하고 글로벌 임계값 방법을 적용하여 암세포의 핵 분할을 수행하는 핵 분할부;상기 암세포의 핵에 대해 MST(traditional minimum spanning tree (MST) 알고리즘을 사용하여 인터-클러스터및 인트라-클러스터 분석을 수행하는 클러스터 분석부;인터-클러스터 및 인트라-클러스터 분석에 기반한 상기 암세포의 핵들의 조직학적 섹션(Histological Sections)에서 형태학적 및 거리 기반 특징(morphological and distance-based features)을 추출 및 선택하는 특징 추출 및 선택부; 및상기 선택된 특징들에 기초하여 AI-기반 분류를 수행하는 AI 분류부를 포함하는 것을 특징으로 하는 시스템."}
{"patent_id": "10-2022-0090084", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "청구항 6에 있어서, 상기 AI 분류부는상기 선택된 특징들을 스케일링하고,상기 스케일링된 특징들을 트레이닝 데이터셋과 테스팅 데이터셋으로 나누고,복수개의 AI 분류 모델을 상기 트레이닝 데이터셋과 테스팅 데이터셋을 이용하여 트레이닝 및 테스트하고,상기 복수개의 복수개의 AI 분류 모델을 통해 초기 예측을 수행하고,상기 초기 예측들에 기반하여 메타 분류기를 트레이닝하고 테스트하고,상기 메타 분류기를 통해 최종 예측을 수행하는 포함하는 것을 특징으로 하는 시스템."}
{"patent_id": "10-2022-0090084", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "공개특허 10-2024-0012738-4-청구항 6에 있어서,상기 클러스터 분석부는 입력 영상을 이용하여 인접 그리드 매트릭스를 생성하고,상기 그리드 매트릭스의 행들과 열들에서 총 그리드 넘버(total grid numbers)를 산출하며,모든 정점들의 최소 및 최대 가중치들을 포함하는 그래프를 상기 인접 매트릭스로부터 생성하고,상기 그래프의 모든 정점들을 추적하기 위해 MST-set을 생성하며,상기 그래프의 모든 정점들에 대한 최소 가중치를 찾는 것을 특징으로 하는 시스템."}
{"patent_id": "10-2022-0090084", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "청구항 6에 있어서,상기 형태학적 및 거리 기반 특징들은 면적과 거리를 기준으로 숫자로 추출되는 것을 특징으로 하는 시스템."}
{"patent_id": "10-2022-0090084", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "청구항 6에 있어서,상기 특징 추출 및 선택부는 필터 방법 및 래퍼(wrapper) 방법의 조합을 사용하여 중요한 특징을 선택하는 것을특징으로 하는 시스템."}
{"patent_id": "10-2022-0090084", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명에 따른 인공지능 기술에 기반하여 전립선암 조직의 세포 핵의 클러스터 분석 방법은 데이터 획득부가 복 수개의 전립선암 WSI(whole slide image)를 획득하는 단계; 이미지 전처리부가 상기 복수개의 전립선암 WSI(whole slide image)에 대해 스테인 정규화(stain normalization) 및 스테인 디콘볼루션(and stain (뒷면에 계속)"}
{"patent_id": "10-2022-0090084", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 인공지능 기술에 기반하여 전립선암 조직의 세포 핵의 클러스터 분석 시스템 및 방법에 관한 것이다."}
{"patent_id": "10-2022-0090084", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "자기공명(MR), 양전자방출단층촬영(PET), 현미경 생검에 의해 생성된 의료 이미지의 분석, 색 강화(color enhancement), 분할 및 분류에는 많은 기술이 사용된다. 컴퓨터는 이미지 획득, 저장, 프레젠테이션 및 통신에 사용될 수 있다. 임상, 생화학적, 병리학적 이미지는 전립선암을 진단하고 단계화하는 데 사용된다. 전립선암 진단은 전립선 MR과 현미경 생검 영상이 필요하다. 전통적인 암 진단은 주관적으로 행해진다. 예컨대, 병리학자 는 현미경으로 생검 샘플을 검사하여 전립선암을 진단한다. 전립선암의 조직구조, 조직색, 세포형태를 객관적으 로 묘사하는 것은 용이하지 않다. 최근의 의료 업계의 발전에도 불구하고, 전립선암은 남성들 사이에서 주요한 의학적 문제로 남아 있으며, 선천 적으로 양성 질환의 과잉 치료와 전이의 부적절한 치료와 관련이 있다. 전립선은 세 종류의 말단 분화된 상피세 포(내강, 기저, 신경내분비)를 가진 유사 계층화된 상피를 가지고 있다. 상피의 다른 세포로는 섬유아세포, 평 활근세포, 내피세포, 면역세포, 자율신경섬유 및 관련 신경절이 있다. 전립선 상피내 종양(prostatic intraepithelial neoplasia; PIN)은 국소적인 전립선암을 유발하고, 이어서 국소적인 침입을 특징으로 하는 선 암종, 마지막으로 전이 전립선암을 유발한다. 가장 일반적인 전립선암 등급 시스템은 글리슨 시스템으로 1974년 에 처음 도입된 이후 개선되었다. 그러나 관찰자들 간에 차이가 나는 문제가 있다. 또한 대부분의 생검 샘플은 음성이며, 암 조직의 조직 병리학 이미지가 평가된다. 전립선암 등급은 염색된 부분(section)의 구조적 변화를 기반으로 병리학자에 의해 수행되 었었다. 여기서는 암세포 조직의 조직병리학적 이미지를 평가한다. 전립선암 등급은 병리학자가 얼룩진 부분의 구조 변화를 기반으로 수행했었다.컴퓨터 기반 알고리즘은 세포핵의 클러스터 분석을 수행할 수 있으며, 사용 가능한 방법으로는 기존의 MST가 있 다. 그래프 이론에서 파생된 MST 클러스터 분석은 핵 분포를 탐구한다. 트리는 이진 관계를 나타내는 데 사용되 며, 연결된 구성 요소는 독립 클러스터를 나타내는 하위 트리를 구성한다. 암세포 이상 파악은 암 조기 발견을 위해 필수적이다. 오늘날 ML 및 딥 러닝(DL) 알고리즘은 의료 이미지 분석, 기능 분류 및 패턴 인식에 사용된다. ML 알고리즘은 일반적으로 정확하고, 빠르고, 사용자 정의가 가능하다. ML 반복은 필수적이며, 새로운 데이터를 수신하고 흡수 해야 한다. 지도 학습은 ML 트레이닝 및 테스트 중에 일반적으로 사용된다. 모델은 트레이닝 세트의 레이블링된 데이터를 사용하여 트레이닝되며, 이렇게 얻은 지식은 테스트 세트의 예기치 않은 레이블링된 데이터를 평가하 는 데 사용된다. 반면에, 비지도 학습은 다른 질병의 진단의 예측에 일반적으로 사용되지 않는데, 실제 환경에서는 필수적이며 언레이블링된 데이터셋을 사용하여 숨겨진 패턴을 발견할 수 있다. 따라서 비지도 학습은 신뢰할 수 있는 방법 이지만 계산적으로 복잡한 문제점을 가진다."}
{"patent_id": "10-2022-0090084", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은 전술한 문제를 해결하기 위해 안출된 것으로서, 본 발명은 인공지능 기술에 기반하여 전립선암 조직 의 세포 핵의 클러스터 분석 시스템 및 방법을 제공하는 것을 목적으로 한다."}
{"patent_id": "10-2022-0090084", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명에 따른 인공지능 기술에 기반하여 전립선암 조직의 세포 핵의 클러스터 분석 방법은 데이터 획득부가 복수개의 전립선암 WSI(whole slide image)를 획득하는 단계; 이미지 전처리부가 상기 복수개의 전립선암 WSI(whole slide image)에 대해 스테인 정규화(stain normalization) 및 스테인 디콘볼루션(and stain deconvolution)을 수행하는 단계; 핵 분할부가 상기 WSI를 HSI (Hue-H, Saturation-S 및 Intensity-I) 색 공간 으로 변환하고, S-채널 이미지에 대해 콘트라스트 조정을 수행하고 글로벌 임계값 방법을 적용하여 암세포의 핵 분할을 수행하는 단계; 클러스터 분석부가 상기 암세포의 핵에 대해 MST(traditional minimum spanning tree (MST) 알고리즘을 사용하여 인터-클러스터 및 인트라-클러스터 분석을 수행하는 단계; 특징 추출 및 선택부가 인터-클러스터 및 인트라-클러스터 분석에 기반한 상기 암세포의 핵들의 조직학적 섹션(Histological Section s)에서 형태학적 및 거리 기반 특징(morphological and distance-based features)을 추출 및 선택하는 단계; 및 AI 분류부가 상기 선택된 특징들에 기초하여 AI-기반 분류를 수행하는 단계를 포함한다. 본 발명에 따른 인공지능 기술에 기반하여 전립선암 조직의 세포 핵의 클러스터 분석 시스템은 복수개의 전립선 암 WSI(whole slide image)를 획득하는 데이터 획득부; 상기 복수개의 전립선암 WSI(whole slide image)에 대 해 스테인 정규화(stain normalization) 및 스테인 디콘볼루션(and stain deconvolution)을 수행하는 이미지 전처리부; 상기 WSI를 HSI (Hue-H, Saturation-S 및 Intensity-I) 색 공간으로 변환하고, S-채널 이미지에 대 해 콘트라스트 조정을 수행하고 글로벌 임계값 방법을 적용하여 암세포의 핵 분할을 수행하는 핵 분할부; 상기 암세포의 핵에 대해 MST(traditional minimum spanning tree (MST) 알고리즘을 사용하여 인터-클러스터 및 인 트라-클러스터 분석을 수행하는 클러스터 분석부; 인터-클러스터 및 인트라-클러스터 분석에 기반한 상기 암세 포의 핵들의 조직학적 섹션(Histological Sections)에서 형태학적 및 거리 기반 특징(morphological and distance-based features)을 추출 및 선택하는 특징 추출 및 선택부; 및 상기 선택된 특징들에 기초하여 AI-기 반 분류를 수행하는 AI 분류부를 포함한다."}
{"patent_id": "10-2022-0090084", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "바이오마커 식별은 전립선암(PCa)의 조직병리학적 섹션에서 등급 그룹을 구별하는 데 매우 중요하다. 세포 핵 클러스터를 평가하는 것은 병리학적 조사에 필수적이다. 본 발명은 세포 핵의 클러스터 분석을 위한 컴퓨터 기 반 방법을 제시하고 전립선암의 등급 그룹을 구별하기 위해 전통적인(즉, 비지도) 및 최신(즉, 지도 방법) 인공지능(AI) 기술을 수행했다. 본 발명은 전립선암 조직에서 두 개의 데이터 세트를 수집했으며, 조직병리학 샘플은 헤마톡실린 및 에오신 (H&E)으로 염색된 전체 슬라이드에서 얻었다. 본 발명은 색상 정규화, 세포 핵 분할, 특징 선택 및 분류에 대한 최신 접근 방식을 제안했다. 본 발명은 클러스터를 식별하고 세포 핵의 증식 및 커뮤니티 구조를 더 잘 포착하기 위해 전통적인 MST(최소 스 패닝 트리) 알고리즘을 사용했다. 즉, 본 발명은 K-medoids 클러스터링 및 스택 앙상블 머신 러닝(ML) 접근 방 식을 사용하여 전통적 및 현대적 AI 기반 분류를 수행함으로써, 전립선암 조직의 등급 예측을 정확하게 수행할 수 있다."}
{"patent_id": "10-2022-0090084", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하에서는 첨부한 도면을 참조하여 바람직한 본 발명의 일실시예에 대해서 상세히 설명한다. 다만, 실시형태를 설명함에 있어서, 관련된 공지 특징 혹은 구성에 대한 구체적인 설명이 본 발명의 요지를 불필요하게 흐릴 수 있다고 판단되는 경우 그에 대한 상세한 설명은 생략한다. 또한, 도면에서의 각 구성요소들의 크기는 설명을 위 하여 과장될 수 있으며, 실제로 적용되는 크기를 의미하는 것은 아니다. 도 1은 본 발명의 일 실시예에 따른 인공지능(AI) 기반 전립선암의 세포 핵의 클러스터 분석 시스템의 구성도이 다. 도 2는 본 발명의 일실시예에 따른 인공지능 기술에 기반하여 염색된 전립선암의 조직 섹션에서 세포 핵의 클러스터 분석 방법을 설명하기 위한 흐름도이다. 도 1 및 도 2를 참조하면, 인공지능(AI) 기반 전립선암의 세포 핵의 클러스터 분석 시스템은 데이터 획득 부, 이미지 전처리부, 핵 분할부, 클러스터 분석부, 특징 추출 및 선택부, 및 AI 분 류부을 포함한다. 먼저, 데이터 획득부는 전립선암의 전체 슬라이드 이미지(WSI)를 타일화한다(S110). 다시 말해, 데이터 획 득부가 전체 슬라이드 이미지로 이루어진 데이터를 수집하고, 상기 이미지의 전체 슬라이드 이미지(WSI)를 복수개의 타일들로 나눈다. 구체적으로, 데이터 획득부는 본 발명의 일 실시예에 따라 전립선암에 관련된 데이터셋을 획득할 수 있다. 예컨대, 데이터 획득부는 복수의 데이터셋들을 획득할 수 있다. 예컨대, 데이터 획득부는 데이터셋 1, 데이터셋 2 등을 획득할 수 있다. 예컨대, 데이터셋 1(3등급, 4등급 및 5등급 WSI(whole slide image))은 한국 연세대학교 세브란스 병원에서 수 집되었다. WSI(전체 슬라이드 이미지)는 BX-51 현미경(Olympus)에 부착된 C-3000 디지털 카메라(Olympus, Tokyo, Japan)에 장착된 0.3 NA 대물렌즈를 사용하여 40배 광학 배율로 컴퓨터로 스캔되었다. 조직 샘플은 4 μ m의 두께로 절단되었고, 이후, 섹션들은 탈파라핀화하고(deparaffinized) 재수화하고(rehydrated) H&E로 염색했다(각각 파란색과 빨간색으로 염색). 본 발명에 사용된 WSI는 80명의 환자로부터 획득하였다. 데이터셋 2(3등급, 4등급 및 5등급 WSI)는 https://www.kaggle.com/c/prostate-cancer-grade- assessment(2021년 3월 25일 접속)에서 획득가능하며, Kaggle 저장소에서 수집되었다. WSI는 Radboud University 의료 센터에서 분석 및 준비되었다. 모든 슬라이드는 3DHistech Panoramic Flash II 250 스캐너를 사용하여 20배 배율(픽셀 해상도 0.48μm)로 스캔했다. 모든 사례는 Radboud University Medical Center의 병 리학 성과에서 검색되었다. 본 발명에 사용된 WSI는 60명의 환자로부터 획득하였다. 본 발명에 따라 병리학-에노테이트된 슬라이드를 타일링하여 512×512 픽셀 크기의 총 900개의 헤마톡실린 및 에오신(H&E) 염색 패치 이미지를 생성했다. 또한, 획득한 샘플을 3가지 암 등급(300개의 등급3, 300개의 등급4, 300개의 등급5)으로 균등하게 나뉘어 졌다. 지도 분류를 위해 데이터셋은 트레인 세트(80%)와 테스트 세트(20 %)의 두 가지 하위 집합으로 나뉜다. 반면, 본 발명에 따라 비지도 분류를 전체 데이터셋을 사용하여 수행하였다. 데이터셋 1과 2의 조직병리학적 이 미지의 예는 도 3에 도시되어 있다. 도 3은 본 발명에 따른 전립선암의 등급별 조직 이미지들을 나타낸 도면이다. 도 3을 참조하면, (a) 내지 (c) 데이터셋 1을 나타내고, (d) 내지 (f)는 데이터셋 2를 나타낸다. 그런 다음, 이미지 전처리부는 복수개의 타일 이미지에 대해 이미지 전처리(Image Preprocessing)를 수행 한다. H&E 염색 이미지에서 색 항등성(color constancy)은 분할(segmentation)에 있어서 크리티컬한 문제이다. 따라서, 스테인 정규화(stain normalization)는 조직학적 섹션에서 색상 강도의 균형을 맞추기 위한 중요한 단 계이다. 이미지 전처리부는 전처리 단계로서 스테인 정규화 및 스테인 디콘볼루션 기술(stain normalization and stain deconvolution techniques)을 이용한다. 이미지 전처리부는 스테인 정규화를 수 행하기 위해 데이터셋의 이미지를 참조 이미지로 선택하여 데이터 세트의 원본 이미지와 색상 강도를 일치시킨 다. 따라서 소스 이미지와 참조 이미지를 모두 LAB 색 공간으로 변환하여 스테인 정규화 방법을 적용할 수 있다. 참조 이미지의 평균(mean)과 표준 편차(standard deviation)는 소스 이미지의 평균과 표준 편차로 맞춰진 다. 도 4는 본 발명에 따른 소스 이미지, 참조 이미지 및 정규화된 이미지를 도시한다. 도 4(a)는 비가공된 이미지 (Raw image), 도 4(b)는 참조 이미지, 도 4(c)는 정규화된 이미지(Normalized image)를 나타낸다. 이미지 전처리부는 소스 이미지 및 참조 이미지의 통계를 기반으로 각 이미지 채널을 정규화한다. 이미지 의 품질을 향상시키기 위해 스테인 정규화의 계산 프로세스는 다음 수학식 내지 와 같이 표현할 수 있다."}
{"patent_id": "10-2022-0090084", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": ", 및 는 채널 평균을 나타내고, , , 및 는 채널 표준편차, src는 소스 이미지, tar는 타겟 이미지, Normmap는 정규화된 LAB 이미지이며, RGB 색 공간으로 추가 변환된다. 반면에, 스테인 디콘볼루션은 RGB 컬러 이미지를 스테인 색 공간(즉, H&E)으로 변환하기 위해 적용되었다. 분리 된 스테인 이미지들의 예는 도 5에 도시되어 있다. 도 5는 본 발명에 따른 분리된 스테인 이미지들의 예를 도시한 도면이다. 도 5를 참조하면, 정규화된 이미지 IN의 모든 색 값들은 해당하는 광학 밀도(optical density: OD) 값으로 변환 되며 각 채널(빨간색, 녹색, 파란색)에 대한 OD 계산은 다음 수학식 와 같이 표현될 수 있다."}
{"patent_id": "10-2022-0090084", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "여기에서, IO는 배경 명시야(background brightfield)(즉, 이미지에 들어오는 빛의 강도)를 나타낸다. 스테인 매트릭스 가 스테인 정규화에 사용된 참조 이미지를 기반으로 Qupath 오 픈 소스 소프트웨어를 사용하여 추정된다. 여기서 MH는 헤마톡실린 스테인 매트릭스[0.587 0.754 0.294]이고 ME 는 에오신(Eosin) 스테인 매트릭스[0.136 0.833 0.536]이다. 정규화된 이미지는 RGB 채널에서 개별 얼룩의 농도 를 결정하기 위해 광학 밀도 공간으로 변환된다. 또한, 추정된 염색 벡터 채널을 재조합하여 염색된 이미지가 획득된다. 스테인 농도를 결정하고 스테인 벡터 채널을 재결합하기 위한 계산 과정은 다음 수학식 내지 과 같이 표현될 수 있다."}
{"patent_id": "10-2022-0090084", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "핵 분할부는 정규화된 이미지로부터 분리된 헤마톡실린-염색된 이미지를 HSI (즉, Hue-H, Saturation-S 및 Intensity-I) 색 공간으로 변환한다. 핵 분할부는 S-채널(8비트/픽셀)의 이미지를 세포핵(cell nucleus) 이 더 선명하기 때문에 분할 목적으로 선택한다. 핵 분할부는 S-채널(8비트/픽셀)의 이미지에 대해 배경에 서 불일치 강도(inconstancy intensity)를 제거하기 위해 콘트라스트 조정(즉, 콘트라스트 한도(limit)를 특정 한다)을 수행한다. 그런 다음, 핵 분할부는 채도 조정된 이미지에 글로벌 임계값 방법(global threshold method)을 적용하여 순수한 이진 이미지(1비트/픽셀)로 변환한다. 그럼 다음, 핵 분할부는 마커 제어형 워 터쉐드 알고리즘(marker controlled watershed algorithm)을 사용하여 중첩 핵(overlapping nuclei)을 분리한 다. 핵 분할부는 접촉하는 핵을 분리한 후 일부 인공물과 물체는 제거되었으며(노이즈로 간주됨) 형태학적 작업을 적용하여 주변 밝기를 제거하고 세포 핵의 막 경계를 매끄럽게 했다. 도 6은 암세포의 핵 분할을 위한 전체 과정을 나타낸 도면이다. 도 65를 참조하면, 도 6(a)는 스테인 디콘볼루 션을 수행한 후 추출된 헤마톡실린 채널을 나타내고, 도 6(b)는 (a)에서 변환된 HSI 색 공간을 나타내며, 도 6(c)는 (b)에서 추출한 포화 채널을 나타내고, 도 6(d)는 (c)에서 추출한 콘트라스트 조정된 이미지를 나타낸다. 도 6(e)는 (d)에 글로벌 임계값 방식을 적용한 후의 이진 이미지를 나타내며, 도 6(f)는 (e)에 워터쉐드 알고리즘을 적용한 후의 핵 분할(Nuclei segmentation)을 나타낸다. 도 5(f)의 핵 분할 이미지에 대해 워터쉐드 알고리즘을 적용하기 전후에 일부 작은 개체와 아티팩트(artifacts)가 제거되었다. 클러스터 분석부는 클러스터 간의 일관성없는(inconsistent) 에지를 식별하는 MST(traditional minimum spanning tree (MST) 알고리즘을 사용하여 클러스터 내 및 클러스터 간 분석을 수행한다. MST 알고리즘은 n차원 의 m개 점들을 연결하여 네트워크를 생성하는 그래프-기반 방법이다. 본 발명에서는 조직학적 섹션(histological section)에서 세포 핵의 클러스터 분석을 위해 MST를 사용한다. MST 에서 에지 가중치(edge weights)의 합은 다른 모든 스패닝 트리의 에지 가중치 합보다 작거나 같다. MST 하위 그래프는 전체 그래프의 모든 정점들을 사이클-프리(cycle-free) 방식으로 가로질러 도 7에 도시된 바와 같이, 포함된 모든 에지들의 가중치들의 최소 합을 산출한다. 도 7은 MST 클러스터 분석의 예들을 나타낸다. 도 7(a)를 참조하면, MST는 정점 좌표들 간의 최소 거리에 기반 한다. 도 7(a)에서 적색 점선들은 일치하지 않는 에지들의 제거를 나타낸다. 도 7(b)를 참조하면, 인트라-클러스터 MST는 도 7(a)로부터 9개의 가장 킨 에지들을 제거한 후 획득된다. 도 7(b)에서 적색 점선으로 된 원은 인 터-클러스터 및 인트라-클러스터 유사성(similarity)을 나타낸다. 도 7(c)를 참조하면, 인터-클러스터 MST가 도 7(b)로부터 획득된다. MST는 핵 클러스터를 유용하게 식별한다. 모든 핵을 연결하는 센트로이드(centroid)는 다양한 종류의 특징들을 추출하는 데 사용할 수 있는 그래프를 생성한다. \"정점(vertex)\"이라고 하는 세포핵의 각 중심점은 \"에지 (edge)\"라고 하는 선분을 통해 적어도 서로 연결되어 있다. 본 발명에서는 두 정점 사이의 길이를 측정하고 MST 그래프를 구성하기 위해 유클리드 최소 거리 알고리즘을 사용한다. 에지(거리)는 오름차순으로 정렬된다. 에지 는 모든 정점을 통과한다. 만약 에지가 이전에 연결되지 않은 정점 좌표를 연결하는 경우 해당 에지는 트리에 포함된다. 별도의 정점(핵)을 만들기 위해 10픽셀의 최대 거리/가중치 임계값을 사용한다. 더 긴 에지 거리는 일관성없는(inconsistent) 것으로 간주되어 도 7(a)와 같이 제거된다. K개의 정점이 있는 경우 완전한 트리에는 (K1) 개의 에지들이 있다. 도 6(b)에 도시된 바와 같이, 상기 그래프는 임계값보다 긴 링크를 절단하여 형성된 10개의 클러스터 그룹을 포함한다. 다음으로, 본 발명은 인터-클러스터 및 인트라-클러스터 분석을 수행한다. 본 발명은 서로 다른 클러스터들의 객체들 간의 거리와 동일한 클러스터의 객체들 간의 거리를 계산한다. 클러스터 분석에는 특정 알고리즘이 필요 하지 않다. 인터-클러스터 및 인트라-클러스터 유사성은 각각 도 7(b) 및 7(c)에 도시된 것과 같이 클러스터링 에 중요하다. 클러스터 분석은 조직학적 섹션에서 핵 패턴과 커뮤니티 구조를 식별하고, 데이터셋에서 유사한 그룹을 식별한다. 데이터는 유사성을 기반으로 클러스터링된다. 두 데이터 포인트 사이의 거리를 계산하는 데 사용되는 유클리드 거리 측정은 다음 수학식 내지 과 같이 표현할 수 있다."}
{"patent_id": "10-2022-0090084", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 5, "content": "상기 수학식 내지 에서 diste(x1, x2)는 유클리드 거리이고, x1 및 x2는 센트로이드 포인트를 나타내고, distinter(C1, C2) 및 distintra(C1)는 각각 인터-클러스터 및 인트라-클러스터 거리를 나타낸다. 도 8은 MST 구성(MST construction)의 흐름도를 나타낸다. 도 8을 참조하면, 클러스터 분석부는 입력 영상을 이용하여 인접 그리드 매트릭스를 생성한다(S210). 클러 스터 분석부는 그리드 매트릭스의 행들과 열들에서 총 그리드 넘버(total grid numbers)를 산출한다 (S220). 이어서, 클러스터 분석부는 모든 정점들의 최소 및 최대 가중치들을 포함해야 하는 그래프를 상기 인접 매트릭스로부터 생성한다(S230). 클러스터 분석부는 모든 정점들을 추적하기 위해 MST-set을 생성한다(S240). 이어서, 클러스터 분석부 는 입력 그래프의 모든 정점들에 대한 최소 가중치를 찾는다(S250). 클러스터 분석부는 상기 찾은 가 중치를 제1 정점에 할당한다(S260). 그런 다음, 클러스터 분석부는 MST-set이 모든 정점을 포함하지 않기 때문에, 최소 가중치를 갖는 MST-set 에 없는 정점 u를 선택하고, 상기 정점 u를 MST-set에 추가하고, 모든 인접 정점들에 대해 반복함으로써 u에 인 접한 모든 정점들의 최소 가중치들을 업데이트한다(S250, S260 및 S270). 이 때, 클러스터 분석부는 모든 인접한 정점 v에 대해, 에지 u-v의 가중치가 v의 이전 키 값보다 작다면 최소 가중치를 업데이트한다. 클러스터 분석부는 모든 정점 v에 대해 최소 가중치를 찾는다. 클러스터 분석부는 MST를 완료할 때까지 단계 S250, S260 및 S270를 반복한다. 특징 추출 및 선택부는 인터-클러스터 및 인트라-클러스터 분석에 기반한 상기 암세포의 핵들의 조직학적 섹션에서 형태학적 및 거리 기반 특징(morphological and distancebased features)을 추출한다. 특징 추출 및 선택부는 총 26개의 특징들을 추출할 수 있다. 이 때, 특징은 면적과 거리를 기준으로 숫자로 추출된다.상기 26개의 특징들은 총 인트라-클러스터 총 MST 거리, 전체 클러스터 내 핵에서 핵까지의 최대 거리, 인터-클 러스터 센트로이드간 총 거리, 인터-클러스터 총 MST 거리, 클러스터 수, 총 인트라-클러스터 최대 MST 거리, 평균 인트라-클러스터 핵에서 핵까지의 최소 거리, 평균 인트라-클러스터 핵에서 핵까지의 최대 거리, 평균 인 트라-클러스터 최대 MST 거리, 평균 클러스터 면적, 전체 인트라-클러스터 핵에서 핵까지의 총 거리, 총 인트라 -클러스터 최소 MST 거리, 전체 인트라-클러스터 핵에서 핵까지의 최소 거리, 인터-클러스터 최대 MST 거리, 평 균 인트라-클러스터 총 MST 거리, 평균 인트라-클러스터 최소 MST 거리, 총 클러스터 면적, 인터-클러스터 평균 MST 거리, 평균 인트라-클러스터 핵에서 핵까지의 평균 거리, 인터-클러스터 센트로이드간의 평균 거리, 클러스 터의 최소 면적, 평균 클러스터 내 핵에서 핵까지의 총 거리, 인터-클러스터 센트로이드간 최소 거리, 인터-클 러스터 센트로이드간 최대 거리, 클러스터의 최대 면적, 및 인터-클러스터 최소 MST 거리를 포함할 수 있다. 특징 추출 및 선택부는 각 특징의 중요성을 확인하는데, 이는 중요하지 않은 특징이 모델 성능을 감소시키 고 과적합으로 이어지기 때문이다. 관련 없는 특징을 제거하면 모델 복잡성이 줄어들고 해석이 더 쉬워진다. 또 한 모델을 더 빠르게 학습시키고 성능을 향상시킬 수 있다. 특징 추출 및 선택부는 필터(Chi-Square, ANOVA, Information Gain, Fisher Score)와 래퍼(wrapper)(재귀적 특징 제거, 순열 중요도, Boruta) 방법의 조 합을 사용하여 중요한 특징을 선택한다. 필터 방법은 통계 기법을 사용하여 각 입력 변수와 대상 변수 간의 관 계를 평가하는 반면 래퍼 방법은 기계 학습 알고리즘을 사용하여 주어진 데이터셋에 적합하도록 시도하고 최적 의 결과를 제공하는 특징 조합을 선택한다. AI 분류부는 선택된 특징들에 기초하여 AI-기반 분류를 수행한다. 이 때, AI 분류부는 AI-기반 분류 를 위해 최근 및 기존 AI 기술들을 사용할 수 있다. 예컨대, 지도 분류를 위해 k-NN, RF, GBM, XGBoost 및 LR과 같은 ML(Machine Learning) 알고리즘을 사용할 수 있다. 반면, 비지도 분류를 위해 기존 k-medoids 클러스터링 알고리즘을 사용할 수 있다. AI 분류부는 지도 학습의 각 모델에 5중 교차 검증(five-fold cross- validation)(CV)을 적용할 수 있다. AI 분류부는 5개의 서로 다른 기계 학습 알고리즘을 스택하여 지도 분류를 위한 앙상블 모델을 생성한다. AI 분류부는 베이스 및 메타 분류기를 각각 사용하여 초기 및 최종 예측의 두 단계로 AI 분류를 수행한다. 도 9는 본 발명의 일 실시예에 따른 지도 분류를 위한 앙상블 모델을 나타낸 도면이다. 도 9에는 머신 러닝-스택 기반 앙상블 분류 모델이 개시되어 있다. 데이터는 트레이닝 및 테스트 전에 스케일링 된다. 도 9에 도시된 바와 같이, AI 분류부는 데이터 스케링부, 트레이닝 데이터셋, 테스팅 데이터셋 , 복수의 분류 모델들(232, 234, 236 및 238)제1 분류 모델, 제2 분류 모델, 제3 분류 모델 및 제4 분류 모델, 및 메타 분류기(Meta-Classifier)를 포함한다. 데이터 스케링부는 추출되어 선택된 특징들을 스케일링한다. 즉, 데이터는 분류 전에 전체 데이터셋에 걸 쳐 표준화되었다. 각 특징은 크기와 표준화된 단위가 있다. 경우에 따라, 특징 스케일링(feature scaling)이 필 요할 수 있다. 본 발명에서는 다음 수학식 와 같은 표준 스칼라 스케일링에 표준 정규 분포를 사용했다."}
{"patent_id": "10-2022-0090084", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 6, "content": "상기 수학식 에서 x(i)는 특징 값이며, 는 평균 (μ) 값이고, 는 표준 편차 (σ) 값이 다. 데이터 스케링부는 스케일링된 특징들을 트레이닝 데이터셋 및 테스팅 데이터셋로 나눈다. AI 분류부는 트레이닝 데이터를 5개의 그룹으로 나누고 5번의 시도 후에 정확도를 기록할 수 있다. 이 접근 방식은 모델 성능을 평가하고 정확도를 높이고 오류를 줄이는 하이퍼파라미터를 식별하는 데 유용하다. 조직학 적 등급은 AI 기술의 성능을 비교하기 위해 이진 및 다중으로 분류되었다. 트레이닝 데이터셋의 특징들 및 테스팅 데이터셋의 특징들은 4개의 분류 모델들에 입력된다. 복수의 분류 모델들은 제1 분류 모델, 제2 분류 모델, 제3 분류 모델 및 제4 분류 모델를 포함할 수 있다. 제1 분류 모델은 k-NN 모델이고, 제2 분류 모델은 RF 모델이고, 제3 분류 모델은 GBM모델이고, 제4 분류 모델은 XGBoost 모델이다. 4개의 서로 다른 분류 모델은 트레이닝 데이터셋 및 테스팅 데이터셋에 기반하여 트레이닝되고 테스 트된다. 4개의 기본 분류기의 초기 예측은 모두 누적된다. 제1 분류 모델, 제2 분류 모델, 제3 분류 모델 및 제4 분류 모델의 초기 예측들은 모두 메타 분류기에 입력되어 메타 분류기를 트레 이닝하고 및 테스트하기 위한 특징들로 사용된다. 메타 분류기는 최종 예측을 수행한다. 메타 분류기는 기 본 분류 모델들에 의한 초기 예측들의 원활한 해석을 제공한다. 전술한 바와 같이, 본 발명의 실시예에 따라, 의미 있는 특징을 추출하고 AI 알고리즘을 사용하여 분류하기 위 해 정성적 및 정량적 분석이 수행되었다. 900개의 이미지에 전처리(preprocessing), 분할(segmentation), 클러 스터 분석, 특징 추출 및 분류를 수행했다. 데이터는 세 등급에 균등하게 분배되었다. 분석은 개별적이고 독립 적으로 수행될 수 있다. 최신 AI 기술을 사용하여 지도 분류를 수행하기 위해 데이터 세트를 8:2 비율에 따라 훈련 데이터셋과 테스트 데이터셋으로 나눴다. 한편, 기존 AI 기술을 사용하여 비지도 분류를 위해 전체 데이터 셋을 사용했다. 또한, 본 발명의 실시예에 따라, 앙상블 지도 모델을 테스트하고 모델 일반화 가능성을 결정하 기 위해 kmedoids 비지도 분류를 수행하면서 테스트 및 전체 데이터 세트를 5분할로 나눴다. 염색 정규화, 핵 분할, MST 기반 클러스터 분석, 특징 추출 및 AI 기반 분류를 위해 MATLAB과 Python 프로그래밍 언어를 사용했 습니다. 성능 메트릭스/통계 파라미터를 계산하는 데 사용되는 수학식은 다음과 같이 표현할 수 있다."}
{"patent_id": "10-2022-0090084", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 7, "content": "여기서, TP(True Positive)는 참양성(양성 샘플의 올바른 분류), TN(True Negative)은 참음성(음성 샘플의 올 바른 분류), FP(False Positive)는 위양성(양성 샘플의 잘못된 분류), FN(False Negative)는 위음성(음성 샘플 의 잘못된 샘플 분류)을 나타낸다. 본 발명은 클러스터를 식별하고 세포 핵의 증식 및 커뮤니티 구조를 더 잘 포착하기 위해 전통적인 MST(최소 스 패닝 트리) 알고리즘을 사용했다. 즉, 본 발명은 K-medoids 클러스터링 및 스택 앙상블 머신 러닝(ML) 접근 방 식을 사용하여 전통적 및 현대적 AI 기반 분류를 수행함으로써, 전립선암 조직의 등급 예측을 정확하게 수행할 수 있다. 전술한 바와 같은 본 발명의 상세한 설명에서는 구체적인 실시예에 관해 설명하였다. 그러나 본 발명의 범주에 서 벗어나지 않는 한도 내에서는 여러 가지 변형이 가능하다. 본 발명의 기술적 사상은 본 발명의 전술한 실시 예에 국한되어 정해져서는 안 되며, 청구범위뿐만 아니라 이 청구범위와 균등한 것들에 의해 정해져야 한다."}
{"patent_id": "10-2022-0090084", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 일 실시예에 따른 인공지능(AI) 기반 전립선암 조직의 세포 핵의 클러스터 분석 시스템의 구 성도이다. 도 2는 본 발명의 일실시예에 따른 인공지능(AI) 기반 전립선암 조직의 세포 핵의 클러스터 분석 방법을 설명하 기 위한 흐름도이다. 도 3은 본 발명에 따른 전립선암의 등급별 조직 이미지들을 나타낸 도면이다. 도 4는 본 발명에 따른 소스 이미지, 참조 이미지 및 정규화된 이미지를 도시한다. 도 5는 본 발명에 따른 분리된 스테인 이미지들의 예를 도시한 도면이다. 도 6은 암세포의 핵 분할을 위한 전체 과정을 나타낸 도면이다. 도 7은 MST 클러스터 분석의 예들을 나타낸다. 도 8은 MST 구성(MST construction)의 흐름도를 나타낸다. 도 9는 본 발명의 일 실시예에 따른 지도 분류를 위한 앙상블 모델을 나타낸 도면이다."}
