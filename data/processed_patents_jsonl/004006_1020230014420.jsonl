{"patent_id": "10-2023-0014420", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2024-0121582", "출원번호": "10-2023-0014420", "발명의 명칭": "라벨스무딩 기반 신뢰도 교정 장치 및 방법", "출원인": "연세대학교 산학협력단", "발명자": "함범섭"}}
{"patent_id": "10-2023-0014420", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "라벨스무딩 기반 신뢰도 교정기능을 제공하는 컴퓨팅 장치의 동작방법에 있어서,(a)분류 대상 이미지 데이터를 이미지 분류 모델에 입력하는 단계;(b)상기 이미지 분류 모델이 상기 이미지 데이터의 로짓 출력값과 예측 확률값을 도출하는 단계 및(c)상기 이미지 분류 모델이 이미지 분류 난이도에 기초한 라벨 스무딩 가중치 및 학습가능한 마진 파라미터 중적어도 하나를 이용하여 라벨 스무딩 손실함수를 도출하는 단계를 포함하는, 방법."}
{"patent_id": "10-2023-0014420", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제 1항에 있어서,상기 (c) 단계 중 상기 이미지 분류 모델이 이미지 분류 난이도에 기초한 라벨 스무딩 가중치를 이용하여 라벨스무딩 손실함수를 도출하는 단계는,상기 라벨 스무딩 가중치를 이미지 분류 난이도에 따라 적응적(adaptive)으로 설정하여 상기 라벨 스무딩 손실함수를 도출하는 단계를 포함하는,방법."}
{"patent_id": "10-2023-0014420", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제 2항에 있어서, 상기 라벨 스무딩 가중치를 이미지 분류 난이도에 따라 적응적(adaptive)으로 설정하는 단계는,상기 이미지 분류 난이도가 낮을수록 상기 라벨 스무딩 가중치를 높게 설정하고, 상기 이미지 분류 난이도가 높을수록 상기 라벨 스무딩 가중치를 낮게 설정하는 단계를 포함하는,방법."}
{"patent_id": "10-2023-0014420", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제 3항에 있어서,상기 이미지 분류 난이도가 높은 데이터는 이미지 데이터에 객체가 일부 나타나 있는 이미지, 뷰포인트가 객체의 일부 영역을 나타내는 이미지 및 이미지 분류 모델이 예측하기 어려운 이미지 중 적어도 하나의 이미지를 포함하는,방법."}
{"patent_id": "10-2023-0014420", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제 3항에 있어서,이미지 분류 난이도가 낮은 데이터는 이미지 데이터에 객체가 명확하게 나타나 있는 이미지, 객체가 중앙에 위치하는 이미지 및 이미지 분류 모델이 예측하기 쉬운 이미지 중 적어도 하나의 이미지를 포함하는,방법."}
{"patent_id": "10-2023-0014420", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제 1항에 있어서,공개특허 10-2024-0121582-3-상기 (c) 단계 중 상기 이미지 분류 모델이 이미지 분류 난이도에 기초한 라벨 스무딩 가중치를 이용하여 라벨스무딩 손실함수를 도출하는 단계는,상기 라벨 스무딩 가중치를 소프트맥스(softmax) 레이어에서 출력되는 상기 예측 확률값 중 최대값으로 결정하고, 결정된 라벨 스무딩 가중치를 이용하여 상기 라벨 스무딩 손실함수를 도출하는 단계를 포함하는,방법."}
{"patent_id": "10-2023-0014420", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제 1항에 있어서,상기 (c) 단계 중 상기 이미지 분류 모델이 학습가능한 마진 파라미터를 이용하여 라벨 스무딩 손실함수를 도출하는 단계는,'상기 로짓 출력값 및 상기 학습가능한 마진 파라미터의 차이값'과 크로스 엔트로피 손실함수의 합을 이용하여상기 라벨 스무딩 손실함수를 도출하는 단계를 포함하는,방법."}
{"patent_id": "10-2023-0014420", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제 1항에 있어서,상기 학습가능한 마진 파라미터는 가로 및 세로 크기가 '클래스 개수*클래스 개수'의 마진행렬로 구성되고,상기 이미지 분류 모델이 상기 학습가능한 마진 파라미터를 라벨 스무딩 손실함수를 이용하여 상기 신뢰도 교정이 수행될때마다 업데이트하는 단계를 더 포함하는,방법."}
{"patent_id": "10-2023-0014420", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제 1항에 있어서,상기 (c) 단계는, '수학식 2'를 이용하여 상기 라벨 스무딩 손실함수가 계산되고,상기 '수학식 2'는 : 크로스 엔트로피 손실값 : 라벨 스무딩 가중치: Logit 값 중 최대값, : Logit값 중 최대값을 제외한 모든 값들 (k=0 ~ 클래스 개수-1 , ), : 학습가능한 마진 파라미터(Learnable margin parameter)를 포함하는,방법."}
{"patent_id": "10-2023-0014420", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "라벨스무딩 기반 신뢰도 교정기능을 제공하는 컴퓨팅 장치에 있어서,메모리; 이미지 분류부; 및 상기 이미지 분류부의 동작을 제어하는 프로세서를 포함하고,공개특허 10-2024-0121582-4-상기 프로세서는(a)분류 대상 이미지 데이터를 이미지 분류 모델에 입력하고, (b)상기 이미지 분류 모델이 상기 이미지 데이터의 로짓 출력값과 예측 확률값을 도출하고, (c)상기 이미지 분류 모델이 이미지 분류 난이도에 기초한 라벨 스무딩 가중치 및 학습가능한 마진 파라미터 중 적어도 하나를 이용하여 라벨 스무딩 손실함수를 도출하는, 컴퓨팅 장치."}
{"patent_id": "10-2023-0014420", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "제 10항에 있어서,상기 프로세서는,상기 (c) 단계 중 상기 이미지 분류 모델이 이미지 분류 난이도에 기초한 라벨 스무딩 가중치를 이용하여 라벨스무딩 손실함수를 도출하는 경우,상기 라벨 스무딩 가중치를 이미지 분류 난이도에 따라 적응적(adaptive)으로 설정하는, 컴퓨팅 장치."}
{"patent_id": "10-2023-0014420", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제 11항에 있어서, 상기 프로세서는, 상기 라벨 스무딩 가중치를 이미지 분류 난이도에 따라 적응적(adaptive)으로 설정하는 경우,상기 이미지 분류 난이도가 낮을수록 상기 라벨 스무딩 가중치를 높게 설정하고, 상기 이미지 분류 난이도가 높을수록 상기 라벨 스무딩 가중치를 낮게 설정하는,컴퓨팅 장치."}
{"patent_id": "10-2023-0014420", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "제 12항에 있어서,상기 이미지 분류 난이도가 높은 데이터는 이미지 데이터에 객체가 일부 나타나 있는 이미지, 뷰포인트가 객체의 일부 영역을 나타내는 이미지 및 이미지 분류 모델이 예측하기 어려운 이미지 중 적어도 하나의 이미지를 포함하는,컴퓨팅 장치."}
{"patent_id": "10-2023-0014420", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_14", "content": "제 12항에 있어서,이미지 분류 난이도가 낮은 데이터는 이미지 데이터에 객체가 명확하게 나타나 있는 이미지, 객체가 중앙에 위치하는 이미지 및 이미지 분류 모델이 예측하기 쉬운 이미지 중 적어도 하나의 이미지를 포함하는,컴퓨팅 장치."}
{"patent_id": "10-2023-0014420", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_15", "content": "제 10항에 있어서,상기 프로세서는,상기 (c) 단계 중 상기 이미지 분류 모델이 이미지 분류 난이도에 기초한 라벨 스무딩 가중치를 이용하여 라벨스무딩 손실함수를 도출하는 경우,상기 라벨 스무딩 가중치를 소프트맥스(softmax) 레이어에서 출력되는 상기 예측 확률값 중 최대값으로 결정하공개특허 10-2024-0121582-5-는,컴퓨팅 장치."}
{"patent_id": "10-2023-0014420", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_16", "content": "제 10항에 있어서,상기 프로세서는,상기 (c) 단계 중 상기 이미지 분류 모델이 학습가능한 마진 파라미터를 이용하여 라벨 스무딩 손실함수를 도출하는 경우,'상기 로짓 출력값 및 상기 학습가능한 마진 파라미터의 차이값'과 크로스 엔트로피 손실함수의 합을 이용하여상기 라벨 스무딩 손실함수를 도출하는, 컴퓨팅 장치."}
{"patent_id": "10-2023-0014420", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_17", "content": "제 10항에 있어서,상기 학습가능한 마진 파라미터는 가로 및 세로 크기가 '클래스 개수*클래스 개수'의 마진행렬로 구성되고,상기 프로세서는, 상기 학습가능한 마진 파라미터를 라벨 스무딩 손실함수를 이용하여 상기 신뢰도 교정이 수행될때마다 업데이트하는, 컴퓨팅 장치."}
{"patent_id": "10-2023-0014420", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_18", "content": "제 10항에 있어서,상기 프로세서는상기 (c) 단계를 수행하는 경우, 수학식 2를 이용하여 상기 라벨 스무딩 손실함수를 계산하고,상기 수학식 2는 : 크로스 엔트로피 손실값 : 라벨 스무딩 가중치: Logit 값 중 최대값, : Logit값 중 최대값을 제외한 모든 값들 (k=0 ~ 클래스 개수-1 , ), : 학습가능한 마진 파라미터(Learnable margin parameter)를 포함하는,컴퓨팅 장치."}
{"patent_id": "10-2023-0014420", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명의 실시 예는 라벨스무딩 기반 신뢰도 교정기능을 제공하는 컴퓨팅 장치의 동작방법에 있어서, 분류 대상 이미지 데이터를 이미지 분류 모델에 입력하는 단계, 상기 이미지 분류 모델이 상기 이미지 데이터의 로짓 출력 값과 예측 확률값을 도출하는 단계 및 상기 이미지 분류 모델이 이미지 분류 난이도에 기초한 라벨 스무딩 가중 치 및 학습가능한 마진 파라미터 중 적어도 하나를 이용하여 라벨 스무딩 손실함수를 도출하는 단계를 포함하는 신뢰도 교정방법을 개시한다."}
{"patent_id": "10-2023-0014420", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 딥러닝 네트워크(Deep learning network)가 신뢰성 있는 최종 예측 확률값(신뢰도)을 갖도록하는 신 뢰도 교정(Confidence calibration)에 관한 것이다."}
{"patent_id": "10-2023-0014420", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "이미지 분류 모델에서 정확한 신뢰도값을 출력하는 것은 딥러닝 네트워크 학습에 있어서 중요하다. 예를 들어, 이미지를 입력했을 때 어떤 클래스에 대한 예측확률이 0.8로 출력된다면, 해당 이미지가 80%의 확률 로 해당 클래스일 것이라는 의미여야 한다. 이를 통해, 의사 결정시 모델의 예측값을 따를 것인지 아닌지를 결 정할 수 있다. 즉, 신뢰할 수 있는 이미지 분류 모델은 샘플들에 대한 예측 정확도(accuracy)와 신뢰도값(예측 확률, confidence)이 일치해야 한다. 하지만 최근의 딥러닝 모델은 실제 정확도보다 예측 확률이 큰 상태로 과잉확신(overconfident)하는 문제가 존 재하였다. 이와 같이 모델의 정확도와 예측 확률을 일치하도록 하는 기술이 신뢰도 교정기술이다. 이를 해결하 기 위해 종래의 신뢰도 교정 기술들은 모델 학습시 기존 크로스엔트로피(Cross-entropy) 손실함수와 함께 과잉 확신(over-confidence)문제를 완화하는 새로운 손실함수를 사용하였다. 또한, 라벨 스무딩(Label smoothing)은 딥러닝 모델의 과적합(overfitting)문제를 해결하고 일반화 (generalization)성능을 향상하기 위해 제안된 기술로, 그 자체가 모델의 과잉학신(over-confidence) 문제 해결 에도 효과가 있는 신뢰도 인지 학습 방법이다. 과잉학신(Over-confidence) 문제는 특정 레이블에 대한 예측 확 률 출력값이 실제 확률보다 커지는 문제로 출력값들의 분포가 델타(delta) 함수의 꼴을 가지게 된다. 라벨 스무딩은 예측 확률의 최대 출력값을 작게 하고, 다른 레이블에 대한 출력값을 똑같이 평활화 (regularization)함으로 과잉확신(overconfidence) 문제를 완화한다. 하지만, 모든 클래스에 대한 예측확률의 출력값을 비슷하게 만드는 것은 영상인식 모델이 궁극적으로 가져야 하는 분류(discriminative) 능력에는 부정 적 효과를 가져오는 문제가 여전히 존재하였다. 이를 해결하기 위해, 후속 방법은 예측확률의 출력값이 일정수준만큼 가까워지는 경우, 라벨 스무딩을 적용하지 않는 손실 함수를 제안하여 개선하였다. 즉, 손실함수를 도출할 때, 출력값 차이에 해당하는 로짓 디스턴스(logit distance)가 정해진 마진(margin) 이 하면 라벨 스무딩을 적용하지 않는다.(수학식 1 참조). 여기서 출력값 차이는 최대 출력값에 해당하는 클래스의 로짓(logit)값과 나머지 클래스에 대한 로짓(logit)값들의 차이로 계산 될 수 있다. 수학식 1"}
{"patent_id": "10-2023-0014420", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 2, "content": "LMbLS 는 종래기술의 손실함수, LCE는 크로스 엔트로피 오차(loss), 는 로짓 디스턴스(logit distance), m : 마진 상기 방법은 동일한 마진(m)을 모든 이미지에 적용하여 각각의 이미지가 비슷한 출력값 차이를 갖도록 한다. 이 는 이미지에 따른 고유한 특징을 반영하지 못하여 신뢰도(최대 예측확률 값) 조정의 목적을 완벽히 달성하지 못 하였다."}
{"patent_id": "10-2023-0014420", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명의 목적은 클래스의 특징을 고려하여 설정된 학습가능한 마진 파라미터를 이용하여 딥러닝 네트워크의 신뢰도를 교정하기 위함이다. 본 발명의 목적은 라벨 스무딩 시, 이미지의 분류 난이도에 따라 예측 확률값의 분포가 달라지는 특성을 반영하 여 딥러닝 네트워크의 신뢰도를 교정하기 위함이다."}
{"patent_id": "10-2023-0014420", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명의 실시 예에 따르면, 라벨스무딩 기반 신뢰도 교정기능을 제공하는 컴퓨팅 장치의 동작방법에 있어서, (a)분류 대상 이미지 데이터를 이미지 분류 모델에 입력하는 단계, (b)상기 이미지 분류 모델이 상기 이미지 데 이터의 로짓 출력값과 예측 확률값을 도출하는 단계 및 (c)상기 이미지 분류 모델이 이미지 분류 난이도에 기초 한 라벨 스무딩 가중치 및 학습가능한 마진 파라미터 중 적어도 하나를 이용하여 라벨 스무딩 손실함수를 도출 하는 단계를 포함할 수 있다. 또한, 상기 (c) 단계 중 상기 이미지 분류 모델이 이미지 분류 난이도에 기초한 라벨 스무딩 가중치를 이용하여 라벨 스무딩 손실함수를 도출하는 단계는, 상기 라벨 스무딩 가중치를 이미지 분류 난이도에 따라 적응적 (adaptive)으로 설정하여 상기 라벨 스무딩 손실함수를 도출하는 단계를 포함할 수 있다. 또한, 상기 라벨 스무딩 가중치를 이미지 분류 난이도에 따라 적응적(adaptive)으로 설정하는 단계는, 상기 이 미지 분류 난이도가 낮을수록 상기 라벨 스무딩 가중치를 높게 설정하고, 상기 이미지 분류 난이도가 높을수록 상기 라벨 스무딩 가중치를 낮게 설정하는 단계를 포함할 수 있다. 또한, 상기 이미지 분류 난이도가 높은 데이터는 이미지 데이터에 객체가 일부 나타나 있는 이미지, 뷰포인트가 객체의 일부 영역을 나타내는 이미지 및 이미지 분류 모델이 예측하기 어려운 이미지 중 적어도 하나의 이미지 를 포함할 수 있다. 또한, 이미지 분류 난이도가 낮은 데이터는 이미지 데이터에 객체가 명확하게 나타나 있는 이미지, 객체가 중앙 에 위치하는 이미지 및 이미지 분류 모델이 예측하기 쉬운 이미지 중 적어도 하나의 이미지를 포함할 수 있다. 상기 (c) 단계 중 상기 이미지 분류 모델이 이미지 분류 난이도에 기초한 라벨 스무딩 가중치를 이용하여 라벨 스무딩 손실함수를 도출하는 단계는, 상기 라벨 스무딩 가중치를 소프트맥스(softmax) 레이어에서 출력되는 상기 예측 확률값 중 최대값으로 결정하 고, 결정된 라벨 스무딩 가중치를 이용하여 상기 라벨 스무딩 손실함수를 도출하는 단계를 포함할 수 있다. 또한, 상기 (c) 단계 중 상기 이미지 분류 모델이 학습가능한 마진 파라미터를 이용하여 라벨 스무딩 손실함수 를 도출하는 단계는, '상기 로짓 출력값 및 상기 학습가능한 마진 파라미터의 차이값'과 크로스 엔트로피 손실 함수의 합을 이용하여 상기 라벨 스무딩 손실함수를 도출하는 단계를 포함할 수 있다. 또한, 상기 학습가능한 마진 파라미터는 가로 및 세로 크기가 '클래스 개수*클래스 개수'의 마진행렬로 구성되 고, 상기 이미지 분류 모델이 상기 학습가능한 마진 파라미터를 라벨 스무딩 손실함수를 이용하여 상기 신뢰도 교정이 수행될때마다 업데이트하는 단계를 더 포함하는, 방법을 포함할 수 있다."}
{"patent_id": "10-2023-0014420", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명의 목적은 클래스의 특징을 고려하여 설정된 학습가능한 마진 파라미터를 이용함으로써 정답 클래스에 대한 예측 확률값과 실제 정확도(correctness likelihood)를 동일한 수준으로 유지할 수 있다. 본 발명은 라벨 스무딩 시, 이미지의 분류 난이도에 따라 예측 확률값의 분포가 달라지는 특성을 반영함으로써 정답 클래스에 대한 예측 확률값과 실제 정확도(correctness likelihood)를 동일한 수준으로 유지할 수 있다."}
{"patent_id": "10-2023-0014420", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하 설명하는 기술은 다양한 변경을 가할 수 있고 여러 가지 실시예를 가질 수 있는 바, 특정 실시예들을 도면 에 예시하고 상세하게 설명하고자 한다. 그러나, 이는 이하 설명하는 기술을 특정한 실시 형태에 대해 한정하려 는 것이 아니며, 이하 설명하는 기술의 사상 및 기술 범위에 포함되는 모든 변경, 균등물 내지 대체물을 포함하는 것으로 이해되어야 한다. 명세서 전체에서, 어떤 부분이 다른 부분과 \"연결\"되어 있다고 할 때, 이는 \"직접적으로 연결\"되어 있는 경우뿐 아니라, 그 중간에 다른 소자를 사이에 두고 \"전기적으로 연결\"되어 있는 경우도 포함한다. 제1, 제2, A, B 등의 용어는 다양한 구성요소들을 설명하는데 사용될 수 있지만, 해당 구성요소들은 상기 용어 들에 의해 한정되지는 않으며, 단지 하나의 구성요소를 다른 구성요소로부터 구별하는 목적으로만 사용된다. 예 를 들어, 이하 설명하는 기술의 권리 범위를 벗어나지 않으면서 제1 구성요소는 제2 구성요소로 명명될 수 있고, 유사하게 제2 구성요소도 제1 구성요소로 명명될 수 있다. 및/또는 이라는 용어는 복수의 관련된 기재된 항목들의 조합 또는 복수의 관련된 기재된 항목들 중의 어느 항목을 포함한다. 본 명세서에서 사용되는 용어에서 단수의 표현은 문맥상 명백하게 다르게 해석되지 않는 한 복수의 표현을 포함 하는 것으로 이해되어야 하고, \"포함한다\" 등의 용어는 설명된 특징, 개수, 단계, 동작, 구성요소, 부분품 또는 이들을 조합한 것이 존재함을 의미하는 것이지, 하나 또는 그 이상의 다른 특징들이나 개수, 단계 동작 구성요 소, 부분품 또는 이들을 조합한 것들의 존재 또는 부가 가능성을 배제하지 않는 것으로 이해되어야 한다. 도면에 대한 상세한 설명을 하기에 앞서, 본 명세서에서의 구성부들에 대한 구분은 각 구성부가 담당하는 주기 능 별로 구분한 것에 불과함을 명확히 하고자 한다. 즉, 이하에서 설명할 2개 이상의 구성부가 하나의 구성부로 합쳐지거나 또는 하나의 구성부가 보다 세분화된 기능별로 2개 이상으로 분화되어 구비될 수도 있다. 그리고 이 하에서 설명할 구성부 각각은 자신이 담당하는 주기능 이외에도 다른 구성부가 담당하는 기능 중 일부 또는 전 부의 기능을 추가적으로 수행할 수도 있으며, 구성부 각각이 담당하는 주기능 중 일부 기능이 다른 구성부에 의 해 전담되어 수행될 수도 있음은 물론이다. 또, 방법 또는 동작 방법을 수행함에 있어서, 상기 방법을 이루는 각 과정들은 문맥상 명백하게 특정 순서를 기 재하지 않은 이상 명기된 순서와 다르게 일어날 수 있다. 즉, 각 과정들은 명기된 순서와 동일하게 일어날 수도 있고 실질적으로 동시에 수행될 수도 있으며 반대의 순서대로 수행될 수도 있다. 본 발명에서는 적응형 라벨스무딩 기술(Adaptive label smoothing)을 활용한 신뢰도 교정 컴퓨팅 장치를 개시한 다. 즉, 네트워크 학습 시 기존의 크로스 엔트로피(Cross Entropy) 손실 함수와 새로운 적응형 마진(margin)기 반 라벨스무딩 손실 함수를 사용한다. 본 기술은 딥러닝 네트워크의 라벨 스무딩 기반 신뢰도 교정 수행 시, 각 이미지의 특성을 고려하여 실제 확률 값을 라벨 스무딩 과정에 반영함으로써 해당 이미지의 클래스에 따라 유연하게 손실함수 및 마진을 적용함으로 써 더 효과적으로 신뢰도 교정을 진행할 수 있다. 구체적으로 라벨스무딩 손실 함수는 예측 확률 분포의 엔트로피(entropy)를 크게 하여 네트워크가 과적합 (overfitting)되어 지나친(overconfident) 예측을 하지 않도록 한다. 특히, 입력 개체(instance)와 클래스 (class)에 따라 유연하게 손실 함수를 적용하여 더 효과적으로 신뢰도를 교정할 수 있을 것이다. 이하 신뢰도 교정을 위한 컴퓨팅 장치가 딥러닝 네트워크의 신뢰도를 교정한다고 설명한다. 신뢰도 교정을 위한 컴퓨팅 장치는 입력된 데이터를 일정하게 처리하고 특정 모델이나 알고리즘에 따라 단지 건축물의 설계에 필요 한 연산을 수행하는 장치이다. 예컨대, 신뢰도 교정을 위한 컴퓨팅 장치는 PC, 네트워크상의 서버, 스마트기기, 설계 프로그램이 임베딩된 칩셋 등과 같은 형태로 구현될 수 있다. 먼저 본 발명의 실시 예에 따른 라벨 스무딩 기능을 제공하는 컴퓨팅 장치의 구성을 설명한다. 도 1은 본 발명의 일 실시예에 따른 라벨 스무딩 기반 신뢰도 교정기능을 제공하는 컴퓨팅 장치를 나타낸 다. 도 1에 도시된 라벨 스무딩 기반 신뢰도 교정기능을 제공하는 컴퓨팅 장치의 컴포넌트들은 예시적인 것이다. 도 1에 도시된 컴포넌트 중 일부만이 신뢰도 교정기능을 제공하는 컴퓨팅 장치를 구성할 수도 있으며, 도 1에 도시된 컴포넌트 이외에 추가적인 컴포넌트(들)가 상기 신뢰도 교정기능을 제공하는 컴퓨팅 장치에 포함될 수도 있다. 도 1에 도시된 바와 같이, 신뢰도 교정 기능을 제공하는 컴퓨팅 장치는 프로세서, 메모리, 통신 부 및 이미지 분류부를 포함할 수 있다. 통신부는 유무선 통신 기술을 이용하여 다른 전자장치나 서버 등의 외부 장치들과 데이터를 송수신할 수 있다. 예컨대, 통신부는 외부 장치들과 센서 정보, 사용자 입력, 학습 모델, 제어 신호 등을 송수신할 수있다. 메모리는 컴퓨팅 장치의 다양한 기능을 지원하는 데이터를 저장할 수 있다. 프로세서는 컴퓨팅 장치의 적어도 하나의 실행 가능한 동작을 결정할 수 있다. 그리고, 프로세서 는 컴퓨팅 장치의 구성 요소들을 제어하여 결정된 동작을 수행할 수 있다. 이를 위해, 프로세서는 메모리의 데이터를 요청, 검색, 수신 또는 활용할 수 있고, 상기 적어도 하나 의 실행 가능한 동작 중 예측되는 동작이나, 바람직한 것으로 판단되는 동작을 실행하도록 컴퓨팅 장치의 구성 요소들을 제어할 수 있다. 이미지 분류부는 데이터 분류부, 학습부, 신뢰도 교정부를 포함할 수 있다. 상기 이미지 분류부는 추후 설명토록 한다. 이때, 프로세서는 결정된 동작을 수행하기 위하여 외부 장치의 연계가 필요한 경우, 해당 외부 장치를 제 어하기 위한 제어 신호를 생성하고, 생성한 제어 신호를 해당 외부 장치에 전송할 수 있다. 프로세서는 메모리에 저장된 응용 프로그램을 구동하기 위하여, 컴퓨팅 장치의 구성 요소들 중 적어도 일부 또는 구성요소들의 조합을 제어할 수 있다. 본 발명의 일 실시예에 따른 컴퓨팅 장치는 무선 및/또는 유선을 통한 상호 연결을 통해 데이터를 전송할 수 있고, 그리고 수신할 수 있다. 본 개시의 컴퓨팅 장치는 전자 형태의 데이터를 연산할 수 있는 모든 종류의 컴퓨팅 장치를 포함할 수 있다. 예를 들어, TV, 프로젝터, 휴대폰, 스마트폰, 데스크탑 컴퓨터, 노트북, 디지털방송용 단말기, PDA(personal digital assistants), PMP(portable multimedia player), 네비게이션, 태블릿 PC, 웨어러블 장치, 셋톱박스 (STB), DMB 수신기, 라디오, 세탁기, 냉장고, 데스크탑 컴퓨터, 디지털 사이니지, 로봇, 차량 등과 같은, 고정 형 기기 또는 이동 가능한 기기 등으로 구현될 수 있다. 도 2는 본 발명의 일 실시 예에 따른 라벨 스무딩 기반 신뢰도 교정 동작의 흐름도를 나타낸다. 먼저 도 1을 참조하면, 이미지 분류부은 데이터 분류부, 학습부 및 신뢰도 교정부를 포함 할 수 있다. 이미지 분류부는 이미지 분류 모델인 인공지능 모델을 포함하며, 상기 이미지 분류 모델은 적어도 하나 이상의 레이어(layer)를 포함할 수 있다. 또한 이미지 분류 모델은 이미지 데이터가 입력되면 상기 이미지 데이터에 대 한 분류(classification)을 수행하는 분류 모델일 수 있다. 데이터 분류부는 입력된 이미지 데이터를 특정 클래스로 분류하는 모듈을 의미할 수 있다. 학습부는 미리 정해진 데이터셋 또는 훈련용 데이터를 이용하여 이미지 분류 모델에 이미지 데이터가 입력되면 해당 이미지 데이터에 대응하는 클래스가 출력되도록 영상인식 모델을 학습시킬 수 있다. 신뢰도 교정부는 종래의 신뢰도 교정기능 수행하며, 라벨 스무딩 기반 신뢰도 교정 수행 시, 각 이미지의 특성을 고려하여 실제 확률값을 라벨 스무딩 과정에 반영함으로써 해당 이미지의 클래스에 따라 유연하게 손실 함수 및 마진을 적용함으로써 신뢰도 교정을 수행할 수 있다. 상기 데이터 분류부, 학습부 및 신뢰도 교정부를 기초로 이미지 분류 모델이 동작할 수 있을 것이다. 한편, 상기 동작들은 프로세서를 통해 제어될 수 있을 것이다. 이하 구체적으로 설명한다. 본 발명의 실시 예에 따른 신뢰도 교정을 위한 컴퓨팅 장치는 이미지 분류 모델에 이미지 데이터를 입력할 수 있다(S201). 본 발명의 실시 예에 따른 영상인식 모델의 데이터 분류부은 입력된 이미지 데이터에 대한 로짓(logit)출 력값 및 예측 확률값을 생성할 수 있다(S203). 구체적으로 로짓 출력값은 입력된 이미지 데이터의 특징벡터를 의미하는 것으로, 입력된 이미지 데이터의 분류 대상인 클래스(class) 개수만큼 로짓 특징값(logit feature)이 존재할 수 있다. 예측 확률값은 상기 로짓 출력값을 소프트맥스 레이어(softmax layer)에 입력하여 획득한 분류 클래스에 대응하 는 확률값일 수 있다. 예측 확률값은 소프트맥스 레이어에 의하여 0~1 사이의 값으로 모두 정규화되고 출력 값 들의 총합은 항상 1 일 수 있다. 상기 예측 확률값 중 최대값을 신뢰도값(confidence)로 명명한다. 본 발명의 실시 예에 따르면, 신뢰도 교정부는 생성된 이미지 데이터에 대한 로짓(logit)출력값 및 예측 확률값을 도출하고, 이미지 분류 난이도에 기초한 가중치 및 학습가능한 마진 파라미터를 라벨 스무딩 적용함으 로써 이미지 분류 모델의 신뢰도 교정 동작을 수행할 수 있다(S205). 실시예에 따라, 상기 이미지 분류 모델이 이미지 분류 난이도에 기초한 라벨 스무딩 가중치 및 학습가능한 마진 파라미터 중 적어도 하나를 이용하여 라벨 스무딩 손실함수를 도출하는 것 또한 가능하다. 이후 이미지 분류 모델은 오차를 최소화하기 위해 딥러닝 모델의 파라미터를 업데이트 함으로써 학습될 수 있다 (S207). 이때, 상기 학습 가능한 마진 파라미터는 네트워크 손실 학습(S207)을 통하여 학습될 수 있다. 이후 이미지 분류 모델은 학습부를 이용하여 오차를 최소화하는 방향으로 학습되며, 학습횟수가 완료횟수 를 초과하는 경우(S209 - YES) 학습을 완료할 수 있다. 본 발명의 실시 예에 따른 컴퓨팅 장치는 검증 데이터에서의 검증 및 테스트 데이터에 대한 성능 평가를 통하여 신뢰도 교정 기능의 성능을 평가할 수 있다(S211). 이하, S205 및 S207 동작을 도 3 및 수학식 2을 통하여 구체적으로 설명한다. 도 3은 본 발명의 일 실시 예에 따른 인공지능 모델을 나타낸다. 도 3에 나타난 인공지능 모델은 앞서 설명한 바와 같은 이미지 분류 모델일 포함할 수 있다. 상기 이 미지 분류 모델은 이미지 데이터가 입력되면 이미지 데이터에 대응하는 이미지 분류 결과를 출력하는 모델일 수 있다. 본 발명의 실시 예에 따른 이미지 분류 모델은 이미지 데이터를 분류하기 위한 데이터 분류부, 신뢰 도 교정을 위한 신뢰도 교정부를 포함할 수 있다. 구체적으로 상기 신뢰도 교정부는 이미지 분류 모 델에 입력된 이미지 데이터의 특징벡터를 포함하는 로짓 출력값, 소프트맥스 레이어, 상기 소프트맥스 레 이어에서 출력된 확률값, 학습가능한 마진 파라미터와 입력된 이미지 데이터의 특성에 기초하여 가중 치가 적용된 손실함수를 이용하여 신뢰도 교정을 수행할 수 있다. 도 3을 참조하면, 영상인식 모델은 뉴럴 네트워크에서 출력된 로짓 출력값(Logit Value, )가 마지막 소프 트맥스(Softmax)층을 통과하여 나온 예측 확률값( )에 기반하여 일어난다. 이 때, 로짓 출력값(Logit Value)과 예측 확률값은 데이터셋(Dataset) 클래스 개수( )만큼 생성될 수 있다. 이미지 분류 모델은 예측확률값 중 가장 큰 확률값( )을 가지는 클래스로 이미지를 최종 예측한다. 이때, 최대확률값을 신뢰도(confidence)값으로 설정될 수 있다. '수학식 2'는 본 발명의 실시 예에 따른 이미지 분류 모델의 손실함수를 계산하는 수식이다. 수학식 2"}
{"patent_id": "10-2023-0014420", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": ": 크로스 엔트로피 손실값 : 라벨 스무딩 가중치(로짓 디스턴스(logit distance) 로스의 가중치) : 로짓(Logit) 출력값 중 최대값, : 로짓(Logit) 출력값 중 최대값을 제외한 모든 값들 (k=0 ~ 클래스 개수-1 , ), : 학습가능한 마진 파라미터(Learnable margin parameter) 상기 '수학식 2'를 참조하면 : 로짓(Logit)출력값 중 최대값과 : Logit값 중 최대값을 제외한 모든 값 들 (k=0 ~ 클래스 개수-1 , )의 차이를 구한 이후, 학습가능한 마진 파라미터를 빼줌으로써 로짓 디스턴스 (logit distance)를 도출할 수 있다. 상기 로짓 디스턴스에는 라벨 스무딩 가중치가 부여되며, 신뢰도 교정부는 학습가능한 마진 파라미터를 손 실함수(LOSS)에 적용함으로써 이미지 분류 모델의 신뢰도 교정 동작을 수행할 수 있다. 먼저 신뢰도 교정부는 생성된 이미지 데이터에 대한 로짓(logit)출력값 및 예측 확률값을 기초로 이미지 분류 난이도에 기초한 라벨 스무딩 가중치를 조정함으로써 이미지 분류 모델의 신뢰도 교정 동작을 수행할 수 있다(S205-1). 이때, 이미지 분류 난이도는 입력된 이미지 데이터의 특성을 고려하여 객체마다 다른 기준으로 설정될 수 있다. 도 4는 본 발명의 실시 예에 따른 이미지 분류 난이도에 기초하여 라벨 스무딩 가중치를 조정하는 구성을 나타 낸 도면이다. 도 4를 참조하면, 이미지 분류 난이도가 낮은 데이터(Easy Instance, 410)는 이미지 데이터에 객체가 명확하게 나타나 있는 경우, 객체가 중앙에 위치하는 경우 등 이미지 분류 모델이 예측하기 쉬운 이미지(image)에 해당하 며, 소프트맥스 출력값(softmax output)의 엔트로피(Entropy)가 작은 경우 (Delta Distribution)를 의미할 수 있다. 또한 이미지 분류 난이도가 높은 데이터(Hard Instance, 420)는 이미지 데이터에 객체가 일부 나타나 있는 경우, 뷰포인트가 객체의 일부 영역을 나타내는 경우 등, 이미지 분류 모델이 예측하기 어려운 이미지(image)에 해당하며, 소프트맥스 출력값(softmax output)의 엔트로피(Entropy)가 큰 경우(Uniform Distribution)를 의미 할 수 있다. 본 발명의 실시 예에 따른 이미지 분류 모델은 상기 라벨 스무딩 가중치를 이미지 분류 난이도에 따라 적응적 (adaptive)으로 설정할 수 있다. 구체적으로 상기 이미지 분류 난이도가 낮을수록 상기 라벨 스무딩 가중치를 높게 설정할 수 있다. 상기 이미지 분류 난이도가 높을수록 상기 라벨 스무딩 가중치를 미리 정해진 값보다 낮게 설정할 수 있다. 예를 들어, 상기 '수학식 2'의 라벨 스무딩 가중치 를 소프트맥스(softmax) 레이어에서 출력되는 예측 확률 (probability)값 중 최대값 로 설정할 수 있다. 이는, 이미지 분류 난이도가 낮을수록 이미지 분류 모델의 예측을 위한 최대 확률값(p)가 크므로 높은 가중치를 부여하여야 오버 컨피던스(overconfidence)문제를 효과적으로 완화할 수 있기 때문이다. 본 발명의 실시 예에 따른 신뢰도 교정부는 학습가능한 마진 파라미터를 손실함수에 적용함으로써 이미지 분류 모델의 신뢰도 교정 동작을 수행할 수 있다(S205-2). 도 3을 참조하면, 학습가능한 마진 파라미터(learnable parameter)는 가로 및 세로 크기가 '클래스 개수*클래스 개수'의 마진행렬(margin matrix, 335)로 구성될 수 있으며, 상기 마진행렬의 행과 열에는 비교 대상 클래스 각각에 대응하는 열과 행마다 마진 파라미터가 저장될 수 있다. 상기 '수학식 2'와 같이 : Logit 값 중 최대값과 : Logit값 중 최대값을 제외한 모든 값들 (k=0 ~ 클 래스 개수-1, )의 차이를 구한 이후, 학습가능한 마진 파라미터를 빼주고, 신뢰도 교정부는 학습가능 한 마진 파라미터를 손실함수(LOSS)에 적용함으로써 이미지 분류 모델의 신뢰도 교정 동작을 수행할 수 있다. 또한 학습가능한 마진 파라미터는 이미지 분류 모델의 손실함수가 학습됨에 따라 자동으로 업데이트 될 수 있을 것이다. 상기 실시예와 같이, 클래스 마다의 학습가능한 파라미터(Learnable Parameter)를 설정하여 마진(margin) 부분 을 대체 클래스 간의 다른 margin을 네트워크가 알아서 학습하게되므로 고정값을 가진 하이퍼파라미터 (Hyperparameter)에 따른 문제 해결할 수 있을 것이다. 구체적으로 상기 방법을 통해 정답 클래스가 i인 I가 클래스 k보다 j와 유사하고, l과는 유사도가 매우 작은 경 우, 과잉확신(over-confidence) 판단 시 이런 관계적 특징이 반영될 수 있다. 이는 종래의 클래스 i와 j, 클래 스 i와 k를 같은 margin (미리 정해진 hyperparameter)을 사용하여 overconfidence 판단하여 다른 image 과 에 대해서도 같은 기준과 margin으로 loss를 적용하던 기술에 비해 Overconfidence를 판단 할 때 과 의 차이를 고려한 margin을 사용함으로써 보다 이미지 특성이 반영된 정확도 높은 신뢰도 교정을 수행할 수 있 다. 본 개시의 기술 분야에서 통상의 지식을 가진 자는 여기에 개시된 실시예들과 관련하여 설명된 다양한 예시적인 논리 블록들, 모듈들, 프로세서들, 수단들, 회로들 및 알고리즘 단계들이 전자 하드웨어, (편의를 위해, 여기에 서 소프트웨어로 지칭되는) 다양한 형태들의 프로그램 또는 설계 코드 또는 이들 모두의 결합에 의해 구현될 수 있다는 것을 이해할 것이다. 전술한 본 발명은, 프로그램이 기록된 매체에 컴퓨터가 읽을 수 있는 코드로서 구현하는 것이 가능하다. 컴퓨터 가 읽을 수 있는 매체는, 컴퓨터 시스템에 의하여 읽혀질 수 있는 데이터가 저장되는 모든 종류의 기록장치를 포함한다. 컴퓨터가 읽을 수 있는 매체의 예로는, HDD(Hard Disk Drive), SSD(Solid State Disk), SDD(Silicon Disk Drive), ROM, RAM, CD-ROM, 자기 테이프, 플로피 디스크, 광 데이터 저장 장치 등이 있다."}
{"patent_id": "10-2023-0014420", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 일 실시 예에 따른 컴퓨팅 장치를 나타낸다. 도 2는 본 발명의 일 실시 예에 따른 라벨 스무딩 기반 신뢰도 교정 동작의 흐름도를 나타낸다. 도 3은 본 발명의 일 실시 예에 따른 인공지능 모델을 나타낸다. 도 4는 본 발명의 일 실시 예에 따른 가중치 부여 예시를 나타낸 것이다."}
