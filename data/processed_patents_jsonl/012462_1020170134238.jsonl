{"patent_id": "10-2017-0134238", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2019-0042384", "출원번호": "10-2017-0134238", "발명의 명칭": "딥러닝과 노이즈 제거 기술을 이용한 표면 결함 검출 장치 및 방법", "출원인": "한국생산기술연구원", "발명자": "윤종필"}}
{"patent_id": "10-2017-0134238", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "학습용 정상 제품 영상을 영상 복원부의 입출력으로 인가하여 정상 제품 영상을 출력하도록 결함 검출부를 기계학습시키는 단계;상기 기계 학습된 결함 검출부에 시험용 정상 제품 영상을 입력하여 시험용 복원(reconstruction) 영상을 생성하고, 상기 시험용 정상 제품 영상과 상기 시험용 복원 영상을 비교하여 복원 에러를 포함하는 복수의 시험용결함 영상을 생성하는 단계;상기 복수의 시험용 결함 영상에 기초하여 복원 에러 모델을 생성하는 단계;상기 기계 학습된 결함 검출부에 피검사제품 영상을 입력하고 상기 영상 복원부를 이용하여 피검사제품 복원 영상을 생성하는 단계;상기 피검사제품 영상과 상기 피검사제품 복원 영상을 비교하여 노이즈를 포함하는 피검사제품 결함 영상을 생성하는 단계; 및상기 노이즈를 포함하는 피검사제품 결함 영상과와 상기 복원 에러 모델을 비교하여 최종 결함 영상을 생성하는단계를 포함하는,기계 학습을 통한 결함 검출 방법."}
{"patent_id": "10-2017-0134238", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제 1 항에 있어서,상기 최종 결함 영상을 입력 받아, 피검사제품의 결함 부분을 이진화시키는 단계; 및상기 이진화된 노이즈가 제거된 결함 영상 중 기준 결함 크기 이상의 결함 부분을 표면 결함으로 판단하는 단계를 더 포함하는,기계 학습을 통한 결함 검출 방법."}
{"patent_id": "10-2017-0134238", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제 2 항에 있어서,상기 이진화시키는 단계는, 피검사제품의 결함 부분의 밝기에 대한 임계값에 기초하여 피검사제품의 결함 부분을 이진화시키는 단계를 포함하는,기계 학습을 통한 결함 검출 방법."}
{"patent_id": "10-2017-0134238", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제 1 항에 있어서,상기 복원 에러 모델은 상기 복수의 시험용 결함 영상을 평균하여 생성되는,기계 학습을 통한 결함 검출 방법."}
{"patent_id": "10-2017-0134238", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "공개특허 10-2019-0042384-3-제 1 항에 있어서,기상기 영상 복원부는 오토인코더(auto-encoder)를 포함하는,기계 학습을 통한 결함 검출 방법."}
{"patent_id": "10-2017-0134238", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제 5 항에 있어서,상기 기계 학습하는 단계는 오토인코더의 요소별 활성화 함수, 가중치 계수 및 바이어스 벡터를 산출하는 단계를 포함하는,기계 학습을 통한 결함 검출 방법"}
{"patent_id": "10-2017-0134238", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "프로세스 제어부;학습용 정상 제품 영상을 입력 영상 및 출력 영상으로 인가하여 기계 학습된 오토인코더를 포함하는 영상 복원부;상기 오토인코더의 입력 영상과 출력 영상의 차이를 구하는 차분 영상 생성부; 상기 차분 영상 생성부에서 생성한 출력 영상 및 복원 에러 모델을 입력 받아 최종 결함 영상을 생성하는 합성부를 포함하되,상기 프로세스 제어부는 검출 모드 제어부를 포함하며,상기 검출 모드 제어부는 하여금 상기 영상 복원부의 오토인코더의 입력 영상으로 피검사제품 영상을 입력받아피검사제품 복원 영상을 생성하도록 제어하며,상기 차분 영상 입력부는 상기 피검사제품 복원 영상과 상기 피검사제품 영상을 비교하여 노이즈를 포함하는 결함 영상을 생성하고,상기 합성부는 상기 노이즈를 포함하는 결함 영상을 상기 복원 에러 모델과 비교하여 최종 결함 영상을 생성하도록 구성되는, 결함 검출 장치."}
{"patent_id": "10-2017-0134238", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제 7항에 있어서,상기 오토인코더는 기계 학습을 통해 생성된 요소별 활성화 함수, 가중치 행렬 및 바이어스 벡터를 포함하는 인공신경망 회로인,결함 검출 장치."}
{"patent_id": "10-2017-0134238", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제7항에 있어서,감도 모듈 및 사이즈 필터를 포함하는 영상 조정부를 더 포함하되,상기 감도 모듈은 상기 합성부에서 생성된 최종 결함 영상을 임계값에 기초하여 이진화하며, 상기 사이즈 필터는 상기 이진화된 최종 결함 영상 중 기준 결함 크기 이상의 크기를 가지는 결함 부분만을 표면 결함으로서 판공개특허 10-2019-0042384-4-단하도록 구성되는,결함 검출 장치."}
{"patent_id": "10-2017-0134238", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제7항에 있어서,상기 프로세스 제어부는 학습모드 제어부 및 에러 모델 생성 모드 제어부를 더 포함하며,상기 학습모드 제어부는 상기 오토인코더로 하여금 상기 학습용 정상 제품 영상을 입력 영상 및 출력 영상으로인가하여 기계 학습하도록 제어하며,상기 에러 모델 생성 제어부는 시험용 정상 제품 영상을 상기 오토인코더의 입력 영상으로 인가하여 시험용 복원 영상을 생성하도록 제어하고, 상기 차분 영상 생성부로 하여금 상기 시험용 복원 영상과 상기 시험용 정상제품 영상의 차이를 구하여 노이즈를 포함하는 복수의 시험용 결함 영상을 생성하도록 제어하며, 상기 복원 에러 모델링부로 하여금 상기 복수의 시험용 결함 영상에 기초하여 상기 복원 에러 모델을 생성하도록 제어하는,결함 검출 장치."}
{"patent_id": "10-2017-0134238", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명의 실시예에 따른 기계 학습을 통한 결함 검출 방법은 학습용 정상 제품 영상을 영상 복원부의 입출력으 로 인가하여 정상 제품 영상을 출력하도록 결함 검출부를 기계 학습시키는 단계; 상기 기계 학습된 결함 검출부 에 시험용 정상 제품 영상을 입력하여 시험용 복원(reconstruction) 영상을 생성하고, 상기 시험용 정상 제품 영 (뒷면에 계속)"}
{"patent_id": "10-2017-0134238", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 딥러닝과 노이즈 제거 기술을 이용한 표면 결함 검출 장치 및 방법에 관한 것으로, 보다 구체적으로, 복원 에러 모델과 노이즈를 포함하는 결함 영상을 비교하여 노이즈를 제거한 결함 영상을 추출하는 기계 학습을 통한 결함 검출 방법 및 시스템에 관한 것이다."}
{"patent_id": "10-2017-0134238", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "최근 알파고와 이세돌 9단의 대결로 인공지능에 대한 관심이 크게 증가하였다. 특히 알파고의 핵심 기술로 알려 진 딥러닝에 대한 학계와 산업계의 연구가 폭발적으로 증가하였으며, 딥러닝은 기존에 알려진 인공신경망(ANN: Artificial Neural Network)의 문제점, 즉 베니싱 현상(vanishing problem), 오버피팅(overfitting) 등의 문제 를 정류 선형 유닛(ReLU, Rectified Linear Unit)의 개발과 드롭아웃(Drop-out)과 같은 알고리즘 개선으로 성 능을 향상시켰다. 또한 GPU(Graphic Processing Units)와 같은 하드웨어의 발전, 그리고 복잡한 구조를 학습시 킬 수 있는 빅데이터의 힘 덕분에 최근 여러 분야에 뛰어난 성능을 발휘하고 있다. 이러한 딥러닝 기술은 해외 많은 기업에 의해 빠르게 발전되고 있으며 얼굴인식, 음성인식, 자연어처리, 검색 서비스, 의료 등의 분야에 적 용되고 있다. 최근에는 기존에 육안으로 이루어지던 제품의 결함 검출을 딥러닝 기술이 적용된 머신 비전(Machine Vision)으 로 대체하려는 연구들이 속속 등장하고 있다. 이 경우, 머신 비전을 학습시키기 위하여 가장 문제가 되는 것은 빅데이터의 확보이다. 즉 결함 영상이 충분히 많이 있어야, 복잡한 딥 뉴럴 네트워크(Deep Neural Network)의 수많은 파라미터를 충분히 학습 시킬 수 있다. 그러나, 실제 산업체에서는 제품에 치명적인 결함의 발생 빈도는 매우 적다. 특히, 섬유나 일부 금속 제품 등의 일부 제품들은 실제 제품을 생산하는 생산 라인에서 결함 발생 확률이 매우 낮아 기계 학습을 위한 결함 영상을 충분히 확보하는 것이 매우 어려웠다. 하지만 이러한 치명 결함을 발견하지 못하면 대량 불량이 발생하고 나아 가서는 제조 라인의 고가의 장치들 마저 고장을 일으킨다. 또한, 결함을 포함하는 영상을 취득할 당시의 환경 예컨대, 조명, 습도 등의 주변 환경 상태가 조금만 차이가 나도 오검출이 발생할 수 있으며, 또한 제품의 위치 변동이 발생할 시에도 오검출이 발생할 수 있었다. 따라서, 결함 발생 수가 적지만 결함 발생 시 치명적인 손실을 입힐 수 있는 제조업에서 딥러닝 등의 기계 학습 을 활용하여 사람의 노고를 현저하게 줄이면서도 결함의 이상 부위의 위치와 크기를 정확히 판단할 수 있으며, 고속으로 검사를 수행할 수 있는 표면 결함 검사 장치가 요구되고 있었다."}
{"patent_id": "10-2017-0134238", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 2, "content": "발명의 내용"}
{"patent_id": "10-2017-0134238", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은 상술한 요구에 부응하기 위하여 안출된 것으로, 본 발명의 목적은 정상 제품의 영상으로 기계 학습 시킨 결함 검출 장치를 제공하고, 더 나아가 복원 에러 모델을 이용하여 기계 학습 과정에서 생성된 노이즈를 제공한 결함 영상을 제공하는 결함 검출 장치를 제공하는 것이다."}
{"patent_id": "10-2017-0134238", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "따라서, 본 발명의 일 실시예에 따른 기계 학습을 통한 결함 검출 방법은, 학습용 정상 제품 영상을 영상 복원 부의 입출력으로 인가하여 정상 제품 영상을 출력하도록 결함 검출부를 기계 학습시키는 단계; 상기 기계 학습 된 결함 검출부에 시험용 정상 제품 영상을 입력하여 시험용 복원(reconstruction) 영상을 생성하고, 상기 시험 용 정상 제품 영상과 상기 시험용 복원 영상을 비교하여 복원 에러를 포함하는 복수의 시험용 결함 영상을 생성 하는 단계; 상기 복수의 시험용 결함 영상에 기초하여 복원 에러 모델을 생성하는 단계; 상기 기계 학습된 결함 검출부에 피검사제품 영상을 입력하고 상기 영상 복원부를 이용하여 피검사제품 복원 영상을 생성하는 단계; 상 기 피검사제품 영상과 상기 피검사제품 복원 영상을 비교하여 노이즈를 포함하는 피검사제품 결함 영상을 생성 하는 단계; 및 상기 노이즈를 포함하는 피검사제품 결함 영상과와 상기 복원 에러 모델을 비교하여 최종 결함 영상을 생성하는 단계를 포함할 수 있다. 이 경우, 기계 학습을 통한 결함 검출 방법은, 상기 최종 결함 영상을 입력 받아, 피검사제품의 결함 부분을 이 진화시키는 단계; 및 상기 이진화된 노이즈가 제거된 결함 영상 중 기준 결함 크기 이상의 결함 부분을 표면 결 함으로 판단하는 단계를 더 포함할 수 있다. 또한, 상기 이진화시키는 단계는, 피검사제품의 결함 부분의 밝기에 대한 임계값에 기초하여 피검사제품의 결함 부분을 이진화시키는 단계를 포함할 수 있다. 또한, 상기 복원 에러 모델을 생성하는 단계는 상기 복수의 시험용 결함 영상을 평균하여 생성하는 단계를 포함 할 수 있다. 또한, 상기 영상 복원부는 오토인코더(auto-encoder)를 포함할 수 있다. 또한, 상기 기계 학습하는 단계는 오토인코더의 요소별 활성화 함수, 가중치 계수 및 바이어스 벡터를 산출하는 단계를 포함할 수 있다. 한편, 본 발명에 따른 결함 검출 장치는, 프로세스 제어부; 학습용 정상 제품 영상을 입력 영상 및 출력 영상으 로 인가하여 기계 학습된 오토인코더를 포함하는 영상 복원부; 상기 오토인코더의 입력 영상과 출력 영상의 차 이를 구하는 차분 영상 생성부; 상기 차분 영상 생성부에서 생성한 출력 영상 및 복원 에러 모델을 입력 받아 최종 결함 영상을 생성하는 합성부를 포함하되, 상기 프로세스 제어부는 검출 모드 제어부를 포함하며, 상기 검 출 모드 제어부는 하여금 상기 영상 복원부의 오토인코더의 입력 영상으로 피검사제품 영상을 입력받아 피검사 제품 복원 영상을 생성하도록 제어하며, 상기 차분 영상 입력부는 상기 피검사제품 복원 영상과 상기 피검사제 품 영상을 비교하여 노이즈를 포함하는 결함 영상을 생성하고, 상기 합성부는 상기 노이즈를 포함하는 결함 영 상을 상기 복원 에러 모델과 비교하여 최종 결함 영상을 생성하도록 구성될 수 있다. 이 경우, 상기 오토인코더는 기계 학습을 통해 생성된 요소별 활성화 함수, 가중치 행렬 및 바이어스 벡터를 포 함하는 인공신경망 회로일 수 있다. 또한, 상기 결함 검출 장치는, 감도 모듈 및 사이즈 필터를 포함하는 영상 조정부를 더 포함하되, 상기 감도 모 듈은 상기 합성부에서 생성된 최종 결함 영상을 임계값에 기초하여 이진화하며, 상기 사이즈 필터는 상기 이진 화된 최종 결함 영상 중 기준 결함 크기 이상의 크기를 가지는 결함 부분만을 표면 결함으로서 판단하도록 구성 될 수 있다. 또한, 상기 프로세스 제어부는 학습모드 제어부 및 에러 모델 생성 모드 제어부를 더 포함하며, 상기 학습모드 제어부는 상기 오토인코더로 하여금 상기 학습용 정상 제품 영상을 입력 영상 및 출력 영상으로 인가하여 기계 학습하도록 제어하며, 상기 에러 모델 생성 제어부는 시험용 정상 제품 영상을 상기 오토인코더의 입력 영상으 로 인가하여 시험용 복원 영상을 생성하도록 제어하고, 상기 차분 영상 생성부로 하여금 상기 시험용 복원 영상 과 상기 시험용 정상 제품 영상의 차이를 구하여 노이즈를 포함하는 복수의 시험용 결함 영상을 생성하도록 제 어하며, 상기 복원 에러 모델링부로 하여금 상기 복수의 시험용 결함 영상에 기초하여 상기 복원 에러 모델을 생성하도록 제어할 수 있다."}
{"patent_id": "10-2017-0134238", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "상술한 바와 같이 이루어진 본 발명에 따른 기계 학습을 통한 결함 검출 방법 및 시스템은 결함 검출부가 학습 용 정상 제품 영상에 기초하여 기계 학습을 수행함으로서 결함 발생량이 적어 결함 영상 확보가 힘든 경우에도 정상 제품의 영상만으로 복잡한 딥러닝 구조를 효과적으로 학습하여 결함을 검출할 수 있다. 또한, 본 발명의 표면 결함 검출 방법은 복원 에러 모델을 생성하여 결함 영상의 노이즈(복원 에러 및 결함 영 상 내 불균일한 배경 등)를 효과적으로 제거할 수 있다. 따라서, 결함의 위치와 크기를 정확히 판단할 수 있어, 불량 원인, 고장 진단에 핵심기술로 사용 할 수 있다. 또한, 기계 학습을 통한 결함 검출 방법 및 시스템은 표면 결함 검사 뿐 아니라, 비파괴 검사와 같은 진단 분야, Smart Factory 구현의 필수기술로, 생산 조업 조건에 따른 제품의 품질을 판정하고 이를 이용하여 생산 조건을 최적화 하는 기술 및 결함 발생 수가 적지만 한번 발생시 치명적인 손실을 입힐 수 있는 제조업에도 응 용될 수 있다. 물론 이러한 효과들에 의해 본 발명의 범위가 한정되는 것은 아니다."}
{"patent_id": "10-2017-0134238", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하, 첨부된 도면들을 참조하여 본 발명의 실시예를 상세히 설명하면 다음과 같다. 그러나 본 발명은 이하에서 개시되는 실시예에 한정되는 것이 아니라 서로 다른 다양한 형태로 구현될 수 있는 것으로, 이하의 실시예는 본 발명의 개시가 완전하도록 하며, 통상의 지식을 가진 자에게 발명의 범주를 완전하게 알려주기 위해 제공되는 것이다. 또한, 설명의 편의를 위하여 도면에서는 구성 요소들이 그 크기가 과장 또는 축소될 수 있다."}
{"patent_id": "10-2017-0134238", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "그러나, 이하의 실시예는 이 기술분야에서 통상적인 지식을 가진 자에게 본 발명이 충분히 이해되도록 제공되는 것으로서 여러 가지 다른 형태로 변형될 수 있으며, 본 발명의 범위가 다음에 기술되는 실시예에 한정되는 것은 아니다. 도 1 및 도 2를 참조하면, 기계 학습을 통한 결함 검출 시스템은 제품 검사 라인, 결함 검출부 및 결 함 출력부를 포함할 수 있다. 이 때, 제품 검사 라인은 조명 및 카메라를 포함하는 영상 취득부(10 1)를 포함할 수 있다. 영상 취득부는 예를 들어, 제품 표면의 결함 부분에서 빛의 경로가 변하여 카메라에 들어오는 빛의 양 변 화를 영상화하여, 결함 부위의 신호 대 잡음비(S/N ratio)를 높여 촬영한 원본 영상을 결함 검출부에 보낼 수 있다. 이 경우, 피검사대상, 예를 들어, 가공된 섬유, 철판, 금속 가공물 등 제조공정에서 표면에 결함 을 가질 수 있는 물체들이 컨베이어 벨트에 의해 고속으로 지나가는 로딩 시스템이 영상 취득부의 하 부에 배치될 수 있다. 한편, 결함 검출부는 제품 검사 라인에서 취득된 피검사대상에 대한 영상들로부터 결함을 자동으로 검출할 수 있으며, 프로세스 제어부, 영상 복원부, 차분 영상 생성부, 복원 에러 모델링부 , 합성부, 영상 조정부를 포함할 수 있다. 이 경우, 결함 검출부 및 결함 검출부의 구성요소들은 하드웨어 모듈, 소프트웨어 모듈 또는 하드웨어와 소프트웨어의 결합 등 다양한 형태로 구현될 수 있다. 결함 검출부의 구성들 중 하나인 프로세스 제어부는 학습모드 제어부, 에러 모델 생성 모드 제 어부, 검출 모드 제어부를 포함할 수 있다. 결함 검출부는 학습모드, 에러 모델 생성 모드, 검출 모드의 3 개의 모드로 동작할 수 있는데, 프로세스 제어부는 각각의 모드에서 영상 복원부, 차분 영상 생성부 및 복원 에러 모델링부의 동작 프로세스를 제어한다. 영상 복원부는 학습모드에서 오토인코더(Auto-encoder)를 이용하여 입출력으로 동일한 학습용 정상 제품 영상을 입력하여 기계 학습을 수행한 후, 검출 모드에서 영상 취득부로부터 피검사제품 영상을 입력 받아 피검사제품의 복원 영상을 생성할 수 있다. 이 때, 차분 영상 생성부는 영상 복원부의 입력 데이터와 복원 영상의 차를 구하여 복원 에러 모델링 부와 합성부에 제공한다. 복원 에러 모델링부는 에러 모델 생성 모드에서 차분 영상 생성부로부터 제공받은 입력 영상과 복원 영상의 차 영상을 이용하여 복원 에러 모델을 생성할 수 있다. 보다 구체적으로, 복원 에러 모델링부(14 0)는 에러 모델 생성 모드에서 시험용 정상 제품 영상에 기초하여 생성된 시험용 복원 영상 중의 복 원 에러 및 배경 노이즈를 평균하여 복원 에러 모델을 생성할 수 있다. 또한 검출 모드에서 합성부에 생성된 복원 에러 모델을 제공할 수 있다. 합성부는 검출 모드에서 복원 에러 모델과 피검사제품 영상에 기초하여 검출된 피검사제품 결함 영상 을 합성하여 최종 결함 영상을 생성한다. 영상 조정부는 감도 모듈 및 사이즈 필터를 포함한다. 이 때, 감도 모듈은 임계값 (threshold)을 기준으로 생성된 최종 결함 영상을 이진화하고, 사이즈 필터는 이진화된 최종 결함 영 상에서 특정 크기 이상의 결함을 표면 결함으로서 판단(검출)한다. 한편, 검출 출력부는 상술한 영상 조정부에서 출력된 표면 결함을 표시장치에 표시하거나, 데이터 베 이스에 저장한다. 상술한 바와 같은 본 발명의 구성에 기초하여 이하에서는 도 3 내지 도 7을 참조하여 학습모드, 검출 모드 및 복원 에러 모델 생성 모드에서의 각 구성요소의 동작들을 상세히 설명한다. 도 3을 참조하면, 기계 학습모드에서 영상 복원부는 학습용 정상 제품 영상(310, 320)에 기초하여 기계 학 습을 수행할 수 있다. 이 경우, 입력 영상으로 제공되는 학습용 정상 제품 영상과 출력 영상으로서 제공되 는 학습용 정상 제품 영상은 동일한 것이 바람직하다. 보다 구체적으로 영상 복원부는 오토인코더(125, Auto-encoder)를 포함한다. 오토인코더는 입력층과 출력층에 동일한 데이터를 적용하여 학습을 시키는 신경망 회로 중 특수한 회로이며, 내부의 층들이 대칭적으로 구성되어 있다. 도 9를 참조하면, 오토인코더는 인코더부와 디코더부를 포함하는데, 인코더부를 φ, 디코더부를 ψ라 하면, 다음과 같은 구조를 가진다."}
{"patent_id": "10-2017-0134238", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "이 경우, 입력 x를 에서 취하고, 입력x를 은닉층 z( )에 매핑시키는 경우에, 도 9 에서 은닉층 z는 다음과 같이 표현된다. 여기서, 연산부호 “ ”는 요소별(element-wise) 곱을 의미한다."}
{"patent_id": "10-2017-0134238", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "이 경우, σ는 요소별 활성화 함수(element-wise activation function)이고, W는 가중치 행렬이며, b는 바이어 스 벡터(bias vector)이다. 이 때 z는 코드(code), 또는 잠재변수(Latent variables)라 부르며, 입력보다 낮은 차원으로 표현되기 때문에 입력 x의 압축 표현형(Compressed representation)으로도 불린다. 한편, 복원 데이터를 x’라 하면, z는 아래와 같이 매핑된다."}
{"patent_id": "10-2017-0134238", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 5, "content": "이 경우, σ’W’, b’는 각각 요소별 활성화 함수, 가중치 행렬 및 바이어스 벡터로서 오토인코더의 설계 에 따라 σ, W, b와 달라질 수 있다. 오토인코더는 입력과 x와 복원 x’의 복원 에러가 최소화되도록 다음과 같이 학습된다."}
{"patent_id": "10-2017-0134238", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 6, "content": "즉, 오토인코더는 입출력이 동일한 형태를 가지도록 학습되면서, 입력되는 정상 제품 영상의 특징을 추출 할 수 있다. 그리고, 상술한 바와 같이 동일한 입출력 영상을 입력한 상태에서 학습모드 제어부는 요소별 활성화 함수, 가중치 행렬 및 바이어스 벡터들은 예를 들어 역전파(Back-propagation) 방식 등으로 연산하도록 오토인코더 를 제어한다. 상술한 기계 학습의 목표는 도 4에 나타낸 바와 같이 피검사제품 영상이 입력될 때, 정상 제품의 특징을 지니는 피검사제품 복원 영상을 출력하도록 복원하여 차를 구했을 경우에, 최종 결과로서 결함 영상만을 가지는 최종 결함 영상을 획득하는 것을 목표로 한다. 다만, 실제의 경우에는 오토인코더에서 발생하는 복원 에러 또는 배경에서 발생하는 배경 노이즈가 생길 수 있어서, 표면 결함을 영상을 통하여 검출할 경우에 검출에 심각한 에러를 발생시킬 수 있다. 보다 구체적으로, 영상은 제품 부분과 배경 부분으로 나눌 수 있다. 제품이 정상이라 할지라도 배경 부분은 제 품 영상을 획득할 때마다 차이가 발생한다. 예를 들어 콘베이어 벨트의 표면이 고르지 못하거나, 제품이 놓여진 평면의 특징에 따라 차이가 발생할 수 있다. 이러한 경우에는 오토인코더로 입력과 출력이 동일하게 학습 을 하더라도 제품 부분은 동일하게 복원이 되지만 배경 부분은 완벽히 없어지지 않고 영상마다 약간의 노이즈로 남는다. 이러한 배경부분을 제거하지 못하면 오검출이 발생할 수 있다. 따라서, 본 발명에서는 상술한 노이즈 및 복원 에러를 제거하기 위하여 복원 에러 모델 생성 모드를 수행한다. 도 5를 참조하면, 에러 모델 생성 모드 제어부는 시험용 정상 제품 영상을 입력으로 받은 후, 영상 복원부를 통과시켜 시험용 복원 영상을 획득한다. 그리고, 에러 모델 생성 모드 제어부는 차분 영상 생성부로 하여금 상술한 시험용 정상 제품 영상 과 시험용 복원 영상의 차를 구하여 복원 에러를 포함하는 복수의 시험용 결함 영상을 생성한다. 한편, 복원 에러 모델링부는 복원 에러를 포함하는 복수의 시험용 결함 영상들을 저장한 후, 복수의 복원 에러를 포함하는 시험용 결함 영상들의 평균 영상을 구하여 복원 에러 모델을 생성한다. 한편, 기계 학습이 충분히 진행되고, 복원 에러 모델이 생성되면, 검출 모드를 수행하여 피검사제품의 검 사를 진행한다. 이하에서는, 도 6 및 도 7을 참조하여 검출 모드에 대하여 설명한다. 도 6을 참조하면, 검출 모드 제어부는 영상 취득부로부터 피검사제품 영상을 입력 받아 영상 복 원부에 입력으로 제공한다. 입력된 피검사제품 영상은 기계 학습이 수행된 영상 복원부의 오토인코더에 의하여 복원되어 피 검사제품 복원 영상을 생성한다. 피검사제품 복원 영상 및 피검사제품 영상은 차분 영상 생성부에 입력되며, 복원 에러가 포함된 피검사제품 결함 영상을 생성한다. 이 경우, 복원 에러가 포함된 피검사제품 결함 영상 및 복원 에러 모델은 합성부로 입력되고, 합성부는 복원 에러가 포함된 결함 영상과 복원 에러 모델의 차 영상(differential image)를 구하여 최종 결함 영상(710, 도 7 참조)으로 영상 조정부에 입력하게 된다.영상 조정부의 감도 모듈는 최종 결함 영상 중, 미리 설정된 임계값 이상의 밝기를 가지는 결함 부분을 이진화하여 출력한다. 예컨대, 감도 모듈은 상술한 차 영상 중 임계값 이상의 밝기를 가지는 결함 부분을 ‘1’로, 임계값 이하의 밝기를 가지는 부분을 ‘0’으로 나타내도록 처리할 수 있다. 이 경우, 임계값 은 응용 분야/기술에 따라 또는 사용자의 설정에 따라 다양하게 설정될 수 있다. 또한 영상 조정부의 사이즈 필터는 이진화된 최종 결함 영상에서 기준 결함 크기 이상의 결함 부분만 을 표면 결함이라 판단(검출)할 수 있다. 이 때, 결함의 기준 사이즈는 사용자의 설정에 따라 다양하게 설정될 수 있다. 한편, 결함 출력부는 결함 검출부에서 검출된 표면 결함을 표시하거나 저장할 수 있다. 도 8은 본 발명의 실시예에 대한 기계 학습을 통한 결함 검출 방법에 대한 순서도이다. 도 8을 참조하면, 먼저, 복수의 학습용 정상 제품 영상을 오토인코더를 포함하는 영상 복원부의 입력층, 출력층으로 인가한 후, 결함 검출부를 기계 학습 시킬 수 있다. (단계 S800) 이 경우, 영상 복원 부의 오토인코더의 입/출력층에는 동일한 학습용 정상 제품 영상이 인가된다. 보다 상세하게, 영상 복원부는 오토인코더를 통하여 학습용 정상 제품 영상의 특징을 학습을 통 하여 추출하고 입/출력층에 인가된 차이가 최소화되도록 기계 학습 시킬 수 있다. 예컨대, 기계 학습된 계수들 은 요소별 활성화 함수, 가중치 행렬 및 바이어스 벡터가이 될 수 있다. 이 때, 학습모드 제어부는 모든 기계 학습된 계수들이 결정될 수 있도록 충분한 수의 학습용 정상 제품 영상 을 제공해야 한다. 기계 학습이 충분히 이루어진 경우, 복원 에러 모델링 획득 모드로 진입하여, 에러 모델 생성 모드 제어부(11 5)는 시험용 정상 제품 영상을 오토인코더에 입력하여 시험용 복원 영상을 생성할 수 있다. (단 계 S810) 한편, 차분 영상 생성부는 시험용 복원 영상과 시험용 정상 제품 영상을 비교하여 노이즈를 포 함하는 복수의 시험용 결함 영상들을 추출 및 저장할 수 있다. (단계 S820) 상기 노이즈는 복원 에러 및 배경 노이즈를 포함할 수 있다. 그 후, 복원 에러 모델링부는 복수의 시험용 결함 영상들에 기초하여 복원 에러 모델을 생성할 수 있다. (단계 S830) 이 경우, 복원 에러 모델은 복수의 시험용 결함 영상의 평균 영상 데이터가 될 수 있다. 한편, 기계 학습모드 및 복원 에러 모델링 획득 모드의 수행이 완료되면, 검출 모드 제어부가 피검사제품 영상을 영상 복원부의 입력으로서 제공한다. 이 때, 피검사제품 영상은 표면 결함 영상 데이터 를 포함할 수 있다. 그리고, 영상 복원부는 피검사제품 영상이 영상 복원부에 인가되면 피검사제품 복원 영상 을 생성할 수 있다. (단계 S840) 그 후, 차분 영상 생성부는 피검사제품 영상과 피검사제품 복원 영상을 비교하여 노이즈를 포함 하는 피검사제품 결함 영상를 생성할 수 있다. (단계 S850) 마지막으로, 노이즈를 포함하는 피검사제품 결함 영상와 복원 에러 모델을 비교하여 노이즈가 제거된 피검사제품 결함 영상를 최종 결함 영상으로 생성할 수 있다. (단계 S860) 추가적으로, 영상 조정부는 최종 결함 영상 중 임계값 보다 큰 밝기를 가지는 부분을 결함 부분으로 하는 이진화 변환을 수행한 후, 기준 결함 크기 이상의 크기를 가지는 결함 부분만을 표면 결함으로 판단한다. 그리 고, 결함 출력부는 인식된 표면 결함을 화면상에 표시하거나 데이터베이스에 저장한다. 따라서, 본 발명에 따르면, 결함 발생량이 적어, 결함 영상 확보가 힘들 경우에도 결함 검출부의 기계 학습을 통해 결함을 포함하지 않는 정상 제품 영상으로 결함 검출부를 학습하여 표면 결함을 검출할 수 있다. 종래 결함 검출 장치는 결함을 포함하는 제품의 영상을 다수 확보하여 검사 대상 제품과 비교한 후, 모양, 크기, 밝기 값, 위치 정보 등 결함의 특징들을 별도로 추출해야 했었다. 그러나, 특징 값을 추출하는 과정에서 사람의 노고가 상당히 투여되어야 하고, 특히, 결함 영상을 확보하기 위한 어려움이 상당히 컸다. 그러나, 본 발명에 따르면, 확보하기 용이한 정상 제품 영상만으로 학습이 가능하며, 배경의 불균일함이 존재하 는 경우에도 노이즈를 제거한 결함 영상을 출력할 수 있어, 불량 원인, 고장 진단에 핵심 기술로 사용 가능하다. 한편, 본 발명의 상세한 설명 및 첨부도면에서는 구체적인 실시예에 관해 설명하였으나, 본 발명은 개시된 실시 예에 한정되지 않고 본 발명이 속하는 기술 분야에서 통상의 지식을 가진 자에게 있어 본 발명의 기술적 사상을 벗어나지 않는 범위 내에서 여러가지 치환, 변형 및 변경이 가능하다. 따라서, 본 발명의 범위는 설명된 실시예 에 국한되어 정해져서는 안되며 후술하는 특허청구범위뿐만 아니라 이 특허청구범위와 균등한 것들을 포함하는 것으로 해석되어야 할 것이다."}
{"patent_id": "10-2017-0134238", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1 및 도 2는 본 발명의 실시예에 따른 기계 학습을 통한 결함 검출 시스템에 대한 블록도이다. 도 3 및 도 4는 본 발명의 실시예에 따른 정상 영상 복원부의 기계 학습모드를 설명하기 위한 블록도이다. 도 5는 본 발명의 실시예에 따른 복원 에러 획득을 설명하기 위한 블록도이다. 도 6은 본 발명의 실시예에 따른 검출 모드를 설명하기 위한 블록도이다. 도 7은 본 발명의 실시예에 따른 결함 검출 영상이다. 도 8은 본 발명의 실시예에 따른 기계 학습을 통한 결함 검출 방법 순서도이다. 도 9는 본 발명의 실시예에 따른 오토인코더를 설명하기 위한 도면이다."}
