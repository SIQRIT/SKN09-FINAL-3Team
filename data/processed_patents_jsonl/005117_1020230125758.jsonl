{"patent_id": "10-2023-0125758", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2025-0042539", "출원번호": "10-2023-0125758", "발명의 명칭": "인간-객체 관계 모델링 기반의 이상 탐지 방법", "출원인": "주식회사 큐버", "발명자": "고영준"}}
{"patent_id": "10-2023-0125758", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "영상 수신부(110)가 카메라 영상을 수신하는 제 1 단계; 객체 인식부(120)가 상기 카메라 영상에서 사람을 포함한 객체들을 인식하는 제 2 단계; 상기 객체 인식부(120)가 상기 카메라 영상의 하나의 프레임 이미지에서 복수의 사람 객체가 인식되는 경우에사람 간의 거리 정보를 산출하는 제 3 단계; 자세 인식부(130)가 상기 객체 인식부(120)가 인식한 사람 객체에 대해 신체 부위의 위치 및 연결 관계를 분석하여 자세(pose)를 인식하는 제 4 단계; 관계 추론부(140)가 상기 객체 정보 및 자세 정보를 이용하여 관계 그래프를 구성하고 그래프 분류 알고리즘에의해 상기 관계 그래프로부터 상기 객체 정보 및 자세 정보들 간의 관계성을 추론하는 제 5 단계; 시나리오 생성부(150)가 상기 카메라 영상 내의 객체 정보, 사람 간의 거리 정보, 자세 정보, 관계성 정보를 미리 학습된 제 1 거대 언어 모델(151)에 입력하여 상기 카메라 영상에서 해당 프레임 이미지 속의 상황을 설명하는 텍스트 문장인 상황설명 시나리오를 생성하는 제 6 단계; 이상 상황 인식부(160)가 상기 상황설명 시나리오를 미리 학습된 제 2 거대 언어 모델(161)에 입력하여 텍스트기반의 자연어 처리에 의해 객체들 간의 부적절한 연결 여부에 따라 정상 상황 또는 이상 상황을 구분하는 이진분류를 수행하는 제 7 단계; 를 포함하여 구성되는 인간-객체 관계 모델링 기반의 이상 탐지 방법."}
{"patent_id": "10-2023-0125758", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "청구항 1에 있어서, 상기 제 5 단계에서 관계 추론부(140)는 상기 객체 인식부(120)가 인식한 객체를 노드(node)로 설정하고 상기카메라 영상에서 프레임 진행에 따른 시간적 관계성을 엣지(edge)로 설정하여 관계 그래프를 구성하는 것을 특징으로 하는 인간-객체 관계 모델링 기반의 이상 탐지 방법."}
{"patent_id": "10-2023-0125758", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "청구항 1에 있어서, 상기 제 5 단계는, 상기 카메라 영상의 각 프레임 단위로 각 노드에서 동일 객체에 해당하는 노드 정보를 엣지로 연결하여 인트라구조 그래프를 구성하는 단계; 상기 카메라 영상에서 각 프레임 단위로 상이한 객체 사이를 엣지로 연결하여 인터 구조 그래프를 구성하는 단계; 상기 카메라 영상에서 동일 프레임 내에서 객체들 상호 간을 연결하여 객체 연결 그래프를 구성하는 단계; 상기 인트라 구조 그래프, 인터 구조 그래프, 객체 연결 그래프의 그래프 백터에 대해 그래프 합성곱 신경망 연산을 수행하여 그래프 구조를 식별하고 관계성을 탐색하는 단계; 상기 그래프 합성곱 신경망 연산에 의해 상기 인트라 구조 그래프, 인터 구조 그래프, 객체 연결 그래프로부터획득된 노드 특징 벡터를 풀링하여 특징 정보들 간의 관계성을 나타내는 관계 특징 벡터를 획득하는 단계; 공개특허 10-2025-0042539-3-를 포함하여 구성되는 것을 특징으로 하는 인간-객체 관계 모델링 기반의 이상 탐지 방법."}
{"patent_id": "10-2023-0125758", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "청구항 1에 있어서, 프롬프트 엔지니어링부(170)가 도메인 지식과 사용자 요구사항을 반영한 이상 상황에 대한 식별 지침과 텍스트분류 요령을 포함한 프롬프트를 상기 이상 상황 인식부(160)의 상기 제 2 거대 언어 모델(161)에 제공하는단계;를 더 포함하여 구성되는 것을 특징으로 하는 인간-객체 관계 모델링 기반의 이상 탐지 방법."}
{"patent_id": "10-2023-0125758", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "컴퓨터에 청구항 1 내지 4 중 어느 하나의 항에 따른 인간-객체 관계 모델링 기반의 이상 탐지 방법을 실행시키기 위하여 저장매체에 저장된 컴퓨터프로그램."}
{"patent_id": "10-2023-0125758", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 영상 인식에 의해 영상으로부터 객체를 인식하고 이들 간의 관계 정보를 획득하며 거대 언어 모델 (LLM)에 의해 영상 내의 상황을 설명하는 시나리오를 추론하고 이로부터 정상 상황인지 이상 상황인지를 분류해 내는 구성을 갖는 인간-객체 관계 모델링 기반의 이상 탐지 기술에 관한 것이다. 본 발명에 따르면 영상 인식 기 (뒷면에 계속)"}
{"patent_id": "10-2023-0125758", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 일반적으로 CCTV 관제영상 등에서 이상 상황을 탐지하여 위험을 예방하는 기술에 관한 것이다. 특히, 본 발명은 영상 인식에 의해 영상으로부터 객체를 인식하고 이들 간의 관계 정보를 획득하며 거대 언어 모델(LLM)에 의해 영상 내의 상황을 설명하는 시나리오를 추론하고 이로부터 정상 상황인지 이상 상황인지를 분 류해내는 구성을 갖는 인간-객체 관계 모델링 기반의 이상 탐지 기술에 관한 것이다."}
{"patent_id": "10-2023-0125758", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "사진이나 영상에 있는 사람의 사회적 관계와 사람과 사물 간의 관계를 파악하는 기능은 소셜 네트워크 검색 (social networks discovery), 주요 행위자 감지(key actors detection), 다중 사용자 추적(multi-person tracking), 집단적 행위 인식(group activity recognition) 등에 활용되고 있다. 이 기능은 상황을 분석 및 예 측하고 그 상황에 맞는 적절한 대응 조치를 추천하는 일에 유익하다. 또한, 공공장소에서의 위험 상황 예방을 위해 영상 인식 기술이 활용되고 있다. 이러한 기술의 궁극적인 목적은 CCTV 영상관제 시스템에 의해 감지된 객체와 인간의 동작과 관계를 인식하여 위험 상황을 식별하고 대응 조치를 취하는 것이다. 그러나 현재의 영상 인식 기술로는 객체와 사람의 관계까지는 파악하지 못하여 이상 징후의 탐 지 성능이 떨어지는 한계가 있다. 특정 사진이나 동영상에서 사회적 관계와 상호간의 행동을 이해하기 위해서는 이미지로부터 객체와 사람을 추출 하고 그들 간의 다양한 관계를 인식해야 한다. 기존에는 이미지 내의 객체들 간의 상호관계 분석에 합성곱 신경 망(Convolutional Neural Network, CNN)이나 순환신경망(Recurrent Neural Network, RNN) 등의 딥러닝 신경망 모델을 활용하였다. 그런데, CNN이나 RNN 등의 딥러닝 신경망 모델은 대량 데이터에 의한 머신러닝 학습이 이루어진 이후라야 유효 한 관계분석 성능을 낼 수 있는 문제점이 있다. 또한, 관계 분석 데이터는 특정 분야 및 데이터셋에 의존적이어 서 하나의 딥러닝 신경망 모델이 다양한 도메인에서 관계분석 성능을 나타내기가 곤란하다. 또한, 영상 데이터 를 통한 이상 상황을 탐지하기 위해서는 영상 기반의 행동 분석 기능이 필요한데, 딥러닝 신경망 모델은 여기에 부적합하다. 선행기술문헌 특허문헌 (특허문헌 0001) 대한민국 등록특허 10-2018348호 \"사용자 행동 분석 기반의 목표계정 탈취 감지 장치\" (특허문헌 0002) 대한민국 등록특허 10-1891887호 \"실시간 영상을 이용하여 위험 상황을 예측하기 위한 영상 처 리 방법, 장치 및 그를 이용하여 위험 상황을 예측하는 방법, 서버\" (특허문헌 0003) 대한민국 등록특허 10-1628938호 \"주거침입절도범죄 예측 시스템 및 방법\" (특허문헌 0004) 대한민국 공개특허 10-2023-0004421호 \"인공지능 기반의 이상행동 감지 시스템\" (특허문헌 0005) 대한민국 공개특허 10-2023-0038998호 \"이미지 분석을 이용한 이상행동 검출 방법 및 이를 위 한 전자 장치\" (특허문헌 0006) 대한민국 공개특허 10-2021-0062375호 \"심리상태 기반 이상행동 검출 장치 및 방법\""}
{"patent_id": "10-2023-0125758", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명의 목적은 일반적으로 CCTV 관제영상 등에서 이상 상황을 탐지하여 위험을 예방하는 기술을 제공하는 것 이다. 특히, 본 발명의 목적은 영상 인식에 의해 영상으로부터 객체를 인식하고 이들 간의 관계 정보를 획득하며 거대 언어 모델(LLM)에 의해 영상 내의 상황을 설명하는 시나리오를 추론하고 이로부터 정상 상황인지 이상 상황인지 를 분류해내는 구성을 갖는 인간-객체 관계 모델링 기반의 이상 탐지 기술을 제공하는 것이다. 본 발명의 해결 과제는 이 사항에 제한되지 않으며 본 명세서의 기재로부터 다른 해결 과제가 이해될 수 있다."}
{"patent_id": "10-2023-0125758", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "상기의 목적을 달성하기 위하여 본 발명에 따른 인간-객체 관계 모델링 기반의 이상 탐지 방법은, 영상 수신부 가 카메라 영상을 수신하는 제 1 단계; 객체 인식부가 카메라 영상에서 사람을 포함한 객체들을 인식 하는 제 2 단계; 객체 인식부가 카메라 영상의 하나의 프레임 이미지에서 복수의 사람 객체가 인식되는 경 우에 사람 간의 거리 정보를 산출하는 제 3 단계; 자세 인식부가 객체 인식부가 인식한 사람 객체에 대해 신체 부위의 위치 및 연결 관계를 분석하여 자세(pose)를 인식하는 제 4 단계; 관계 추론부가 객체 정보 및 자세 정보를 이용하여 관계 그래프를 구성하고 그래프 분류 알고리즘에 의해 관계 그래프로부터 객체 정보 및 자세 정보들 간의 관계성을 추론하는 제 5 단계; 시나리오 생성부가 카메라 영상 내의 객체 정보, 사람 간의 거리 정보, 자세 정보, 관계성 정보를 미리 학습된 제 1 거대 언어 모델에 입력하여 카메라 영 상에서 해당 프레임 이미지 속의 상황을 설명하는 텍스트 문장인 상황설명 시나리오를 생성하는 제 6 단계; 이 상 상황 인식부가 상황설명 시나리오를 미리 학습된 제 2 거대 언어 모델에 입력하여 텍스트 기반의 자연어 처리에 의해 객체들 간의 부적절한 연결 여부에 따라 정상 상황 또는 이상 상황을 구분하는 이진 분류를 수행하는 제 7 단계;를 포함하여 구성된다. 본 발명에서 제 5 단계에서 관계 추론부는 객체 인식부가 인식한 객체를 노드(node)로 설정하고 카메 라 영상에서 프레임 진행에 따른 시간적 관계성을 엣지(edge)로 설정하여 관계 그래프를 구성할 수 있다. 또한 본 발명에서 제 5 단계는, 카메라 영상의 각 프레임 단위로 각 노드에서 동일 객체에 해당하는 노드 정보 를 엣지로 연결하여 인트라 구조 그래프를 구성하는 단계; 카메라 영상에서 각 프레임 단위로 상이한 객체 사이 를 엣지로 연결하여 인터 구조 그래프를 구성하는 단계; 카메라 영상에서 동일 프레임 내에서 객체들 상호 간을 연결하여 객체 연결 그래프를 구성하는 단계; 인트라 구조 그래프, 인터 구조 그래프, 객체 연결 그래프의 그래 프 백터에 대해 그래프 합성곱 신경망 연산을 수행하여 그래프 구조를 식별하고 관계성을 탐색하는 단계; 그래 프 합성곱 신경망 연산에 의해 인트라 구조 그래프, 인터 구조 그래프, 객체 연결 그래프로부터 획득된 노드 특 징 벡터를 풀링하여 특징 정보들 간의 관계성을 나타내는 관계 특징 벡터를 획득하는 단계;를 포함하여 구성될 수 있다. 본 발명에 따른 인간-객체 관계 모델링 기반의 이상 탐지 방법은, 프롬프트 엔지니어링부가 도메인 지식과 사용자 요구사항을 반영한 이상 상황에 대한 식별 지침과 텍스트 분류 요령을 포함한 프롬프트를 이상 상황 인 식부의 제 2 거대 언어 모델에 제공하는 단계;를 더 포함하여 구성될 수 있다. 한편, 본 발명에 따른 컴퓨터프로그램은 컴퓨터에 이상과 같은 인간-객체 관계 모델링 기반의 이상 탐지 방법을 실행시키기 위하여 비휘발성 저장매체에 저장된 것이다."}
{"patent_id": "10-2023-0125758", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명에 따르면 영상 인식 기술과 거대 언어 모델(LLM)의 결합을 통해 이상 탐지 성능을 개선할 수 있는 장점 이 있다. 본 발명에서는 거대 언어 모델(LLM)의 파인튜닝을 통해 미리 학습된 기본 모델에 새로운 데이터를 추가하여 특 정 작업에 적합하도록 신경망 모델을 세부 조정하여 다양한 객체 및 사람들 간의 관계를 식별하고 그에 기초하 여 이상 상황을 도출한다. 종래의 이상 탐지 기술은 영상 분석에 의존하므로 연산 부담이 매우 높았다. 반면, 본 발명에 따르면 거대 언어 모델(LLM)을 활용하므로 이상 탐지를 위한 연산 부담을 낮출 수 있는 장점이 있다. 본 발명의 이상 탐지 기술을 CCTV 영상관제 시스템에 결합함으로써 공공장소에서의 위험 상황을 예방하여 사람 들의 일상의 안전을 보장할 수 있는 장점이 있다."}
{"patent_id": "10-2023-0125758", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하에서는 도면을 참조하여 본 발명을 상세하게 설명한다. 본 발명을 설명함에 있어서 종래기술과 중복되는 부분에 대해서는 자세한 설명을 생략할 수 있다. [도 1]은 본 발명에 따른 인간-객체 관계 모델링 기반의 이상 탐지 시스템의 전체 구성도이다. [도 1]을 참조하면, 본 발명에 따른 이상 탐지 시스템은 영상 수신부, 객체 인식부, 자세 인식부 , 관계 추론부, 시나리오 생성부, 이상 상황 인식부, 프롬프트 엔지니어링부, 이상 상황 알림부를 포함하여 구성된다. 영상 수신부는 외부로부터 카메라 영상을 수신한다. 예를 들어, CCTV 영상관제 시스템에서 다수의 CCTV 카 메라가 촬영한 영상을 제공받는다. 객체 인식부는 영상 인식 기술을 사용하여 카메라 영상에서 사람이나 물체를 포함한 여러 객체들을 인식하 고 사람들 간의 거리 정보를 추출한다. 자세 인식부는 사람 객체에 대해 신체 부위의 위치 및 연결 관계를 분석하여 자세(pose)를 인식한다. 관계 추론부는 객체 인식부와 자세 인식부에서 추출된 객체들 간의 관계성을 그래프 분류 알고 리즘에 의해 추론하여 예컨대 관계형 데이터를 구축한다. 시나리오 생성부는 객체 인식부, 자세 인식부, 관계 추론부에서 획득한 객체 정보, 사람 간의 거리 정보, 객체들 간의 관계성 정보를 거대 언어 모델(LLM)에 입력하여 카메라 영상 속의 상황을 설명하 는 텍스트 문장(이하, '상황설명 시나리오'라 함)을 생성한다. 이상 상황 인식부는 상황설명 시나리오를 거대 언어 모델(LLM)에 입력하여 이상 상황인지 아니면 정상 상 황인지 이진 분류를 수행한다. 프롬프트 엔지니어링부는 도메인 지식과 사용자 요구사항을 반영하여 이상 상황에 대한 식별 지침과 텍스 트 분류 요령을 포함한 프롬프트를 이상 상황 인식부로 제공한다. 이상 상황 알림부는 그 탐지된 이상 상황을 알림, 경고, 신고 등의 형태로 음성 또는 푸쉬 메시지에 의해 관리자나 외부 시스템으로 전달하며, 이를 통해 대응조치가 즉시 취해질 수 있도록 한다. 이상과 같이, 본 발명은 영상 인식에 의해 카메라 영상에서 객체와 사람을 인식 추출하고 거대 언어 모델(LLM) 을 통해서 카메라 영상 속의 행동 및 상황을 추론하여 이상 상황을 감지하는 구성이다. 행동 인식과 이상 상황 분석을 영상 분석에만 의존하지 않고 거대 언어 모델(LLM)을 활용하여 효과적으로 상황 분석 및 이상 탐지를 수 행한다. 영상 인식 기술을 통해 객체와 사람을 감지하고, 거대 언어 모델(LLM)을 활용하여 객체들이 형성하는 상황(맥락)을 추론한다. 즉, 영상 분석에 의해 객체와 인간을 인식한 후에, 그 인식 결과를 거대 언어 모델 (LLM)에 입력하여 상황에 대한 해석을 신경망 기반으로 추론해가는 구조이다. 본 발명에서는 신경망 모델의 유연한 구조를 지원하며 다양한 데이터에 효과적으로 적용 가능한 거대 언어 모델 (Large Language Model, LLM)을 활용한다. 거대 언어 모델(LLM)의 파인튜닝(fine-tuning)을 통해서 미리 학습 된 기본 모델에 새로운 데이터를 추가하여 특정 작업에 적합하도록 모델을 세부 조정하여 다양한 객체 및 사람 들 간의 관계를 분석하고 이해된 내용을 기반으로 이상 상황을 도출한다. [도 2]는 본 발명에 따른 인간-객체 관계 모델링 기반의 이상 탐지 방법의 전체 프로세스 순서도이다. 단계 (S110) : 영상 수신부는 카메라 영상을 수신한다. 예를 들어, CCTV 영상관제 시스템에서 CCTV 카메라 의 촬영 영상을 제공받는다. 단계 (S120, S130) : 객체 인식부는 카메라 영상에서 사람이나 물체 등의 객체들을 인식한다. 이때, 각각 의 객체에 대해 인스턴스를 구분하여 인식하는 것이 바람직하다. 예를 들어, 여성, 남성, 성인, 노인, 아이, 물 체 등의 인스턴스로 구분 인식한다. 객체 인식(object recognition)은 디지털 이미지에서 사람이나 물체를 감지 및 식별하는 기술로서, 주로 딥러닝 과 인공지능 기술을 활용하여 개발되며 신경망 구조를 사용하여 이미지의 다양한 특징을 학습하고 해석한다. 객 체 인식 기술의 핵심은 이미지 내의 패턴과 특징을 추출하고 이를 사전에 학습된 신경망 모델에 입력하여 객체 를 식별하는 것이다. 이를 위해 주로 합성곱 신경망(CNN), R-CNN(Region-based CNN), YOLO(You Only Look Once), SSD(Single Shot MultiBox Detector) 등의 신경망 모델이 사용되고 있다. 객체 인식부는 카메라 영상에서 다양한 객체를 탐지하고 다양한 인스턴스를 감지할 수 있도록 사전에 학습 되어 있다. 카메라 영상의 프레임 이미지는 전처리 작업을 통해 노이즈를 제거하고, 신경망 모델을 통해 각 프 레임 이미지에 나타나는 여러 인스턴스를 추론하고 그 정보를 저장한다. 이때, 하나의 프레임 이미지에서 복수의 사람 객체가 인식되는 경우에는 이상 탐지(anomaly detection)의 중요 한 정보로 사용될 수 있는 사람 간의 거리 정보를 추가로 획득한다. 이를 위해, 객체 인식부는 사람 객체 의 경계박스(bounding box)의 중심점을 구하여 이들 간의 거리(distance)를 구한다. 예를 들어, 하나의 프레임 이미지에서 두 명의 사람 객체가 감지되었다고 가정한다. 사람 1의 경계박스 좌표를 (x1, y1, w1, h1), 사람 2의 경계박스 좌표를 (x2, y2, w2, h2)라고 하고, 이들 경계박스의 중심점을 각각 c1, c2라고 한다. 이들 사람 객체의 거리 D를 [수학식 1]과 같이 구할 수 있다. 수학식 1"}
{"patent_id": "10-2023-0125758", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "단계 (S140) : 자세 인식부는 객체 인식부가 인식한 사람 객체에 대해 신체 부위의 위치 및 연결 관 계를 분석하여 자세를 인식한다. 즉, 각각의 사람이 어떠한 자세를 취하고 있는지(예: put up hands, raise up arm, falling down, … ) 키 포인트를 예측하여 자세에 대한 라벨을 추출한다. 일반적으로 자세 인식(pose recognition) 기술은 컴퓨터 비전과 인공지능 기술을 활용하여 구현된다. 사람 객체 의 자세를 식별하기 위해서는 신체 부위의 위치와 연결 관계를 분석한다. [도 3]은 본 발명에서 자세 인식의 예 시도이다. 일반적으로 자세 인식 과정은 키 포인트(key points) 검출, 키 포인트 연결, 자세 추론 등의 단계를 거쳐서 진행하는데, 일반적으로 OpenPose, PoseNet, MediaPipe 등을 활용하여 신체 정보에서 자세(pose) 인식을 수행한다. 자세 인식부는 객체 인식부가 인식해낸 사람 객체에 대한 경계박스 영역을 크롭(crop)하여 자세 추정 모델에 입력하도록 구성되는 것이 바람직하다. 원본 전체 이미지(프레임 이미지)를 사용하는 것보다 객체 인식 부가 인식해낸 사람 영역의 이미지를 잘라내어 자세 추정에 이용하는 것이 연산량 측면에서 효율적이다. 따라서, 자세 인식부는 객체 인식부가 인식해낸 사람 객체들의 경계박스 이미지들을 기반으로 여러 자세들을 추정한다. 이렇게 추정되는 자세 정보는 이상 탐지에 있어 사람의 행동에 대한 특징을 파악하기 위한 정보로 활용된다. 단계 (S150) : 관계 추론부는 객체 인식부와 자세 인식부에서 추출된 특징 정보(객체 정보, 자 세 정보)를 이용하여 그래프 데이터(이하, '관계 그래프'라 함)를 구성하고, 그래프 분류 알고리즘(예: Graph Convolutional Networks, Pyramid Graph Convolutional Networks)에 의해 관계 그래프로부터 특징 정보들(즉, 객체 정보와 자세 정보) 간의 관계성을 추론한다. [도 4]는 본 발명에서 관계 추론의 예시도이다. 객체 정보, 자세 정보, 이들 사이의 관계성 정보는 해당 프레임 이미지에 담긴 상황을 나타내는 특징이 된다. 관계 추론부에서 객체(사람), 사람 사이의 상호 작용, 맥락적 대상이 있는 장면은 사회적 행동에 대한 핵 심 단서를 기반으로 맥락적 대상의 관계성을 정의한다. 예를 들어 가족 모임, 직장 모임 등의 의미적 관계 (correlation)를 추론하는 것이다. 이를 위해 객체(사람, 사물)을 노드(node)로 설정하고, 카메라 영상에서 프 레임 진행에 따른 시간적 관계성을 엣지(edge)로 설정하여 그래프 데이터 구조를 구성하는데, 본 명세서에서는 이를 관계 그래프라고 부른다. [도 5]는 본 발명에서 관계 그래프의 생성 예시도이다. 본 발명에서는 세 가지 관계 그래프를 구성한다. 제 1 관계 그래프는 인트라(Intra) 구조의 그래프이다. 인트라 구조 그래프는 프레임 단위로 각 노드에서 동일 객체에 해당하는 노드 정보를 엣지로 연결하여 구성한다. 인트라 구조 그래프는 동일 객체의 경계박스로 크롭된 이미지 벡터 정보와 인접행렬(adjacent matrix)로 표현될 수 있다. 그래프 벡터 표현식은 [수학식 2]와 같다. 수학식 2"}
{"patent_id": "10-2023-0125758", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "제 2 관계 그래프는 인터(Inter) 구조의 그래프이다. 인터 구조 그래프는 객체들 간의 상호성에 초점을 두어 상 이한 객체 사이를 엣지로 연결한다. 인터 구조 그래프는 상이한 객체들 간의 상호적 변화와 유동적인 특징을 포 착한다. 그래프 벡터 표현식은 [수학식 3]과 같다. 수학식 3"}
{"patent_id": "10-2023-0125758", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "제 3 관계 그래프는 프레임에서 보여지는 객체간 연결의 그래프이다. 사물과 사람이 있을 때, 객체 연결 그래프 는 동일 프레임 내에서 객체들 상호 간을 연결하여 구성한다. 객체 연결 그래프는 객체들 간의 연관성 및 관계 를 포착하는 역할을 수행하는데, 동일 프레임 내에서 사물과 사람의 관계에 집중한다. 그래프 벡터 표현식은 [수학식 4]와 같다. 수학식 4"}
{"patent_id": "10-2023-0125758", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 5, "content": "[수학식 2] 내지 [수학식 4]에 나타낸 인트라 구조 그래프, 인터 구조 그래프, 객체 연결 그래프의 그래프 벡터 에 대해 그래프 합성곱 신경망(예: Pyramid Graph Convolutional Networks) 연산을 수행한다. 이는 그래프 구 조를 식별하고 관계성을 탐색하는 그래프 분류(graph classification) 문제를 처리한다. 그래프 합성곱 신경망 연산은 프레임 단위로 진행되는데, 다중스케일 수용 필드(multi-scale receptive fields) 구조를 통해 시간적 도메인(temporal domain)을 고려하여 그래프 컨볼루션 네트워크(Graph Convolution Network, GCN) 연산을 진행 한다. 그래프 컨볼루션 네트워크(GCN) 연산의 일 실시예는 [수학식 5]로 나타낼 수 있다. 수학식 5"}
{"patent_id": "10-2023-0125758", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 6, "content": "세 가지 관계 그래프에서 얻어진 그래프 벡터들은 GCN 연산을 거치면서 노드 특징 벡터를 추출하게 되고, 이들 3가지 노드 특징 벡터들은 풀링(pooling)을 통해 하나의 관계 특징 벡터로 표현된다. 관계 특징 벡터를 통해 최 종클래스 분류를 진행하여 입력 영상의 맥락적적 관계성을 추론한다. 단계 (S160) : 시나리오 생성부는 객체 인식부, 자세 인식부, 관계 추론부에서 획득한 카 메라 영상 내의 객체 정보, 사람 간의 거리 정보, 객체의 자세 정보, 관계성 정보를 미리 학습된 거대 언어 모 델(LLM)에 입력하여 카메라 영상에서 해당 프레임 이미지 속의 상황을 설명(contextual description)하는 텍스 트 문장(이하, '상황설명 시나리오'라 함)을 생성한다. [도 6]은 본 발명에서 시나리오 생성부의 동작 개 념도이다. 이를 위해, 시나리오 생성부는 객체 정보, 자세 정보, 사람 간의 거리 정보, 객체들 간의 관계성 정보를 텍스트 데이터로 변환하여 거대 언어 모델에 입력한다. 본 발명에서 거대 언어 모델은 비정형 텍스트 를 입력받아 확률적 계산에 의해 그 입력 텍스트와 관련성이 높은 서술형 텍스트 문장을 작성하여 출력한다. 예 를 들어, \"성인\", \"아이\", \"나이프\", \"성인과 아이의 거리\" 등의 텍스트가 입력되면, 거대 언어 모델은 이 들 입력 텍스트를 토큰으로 삼아 해당 토큰들이 나타내는 맥락을 서술형 문장, 예컨대 \"나이프를 들고 있는 성 인이 아이와 대치하고 있다.\"의 서술형 문장을 추론한다. 이를 위해, 특정 상황에 이루어질 수 있는 아이템(items)에 대한 학습 데이터와 그 단어들을 통해 문장으로 서 술하는 라벨 형태의 데이터셋으로 사전 학습된 거대 언어 모델을 준비하고, 특정 도메인(예: 혼잡한 길거 리)의 이상 상황을 고려하여 미리 준비된 텍스트 데이터셋을 이용하여 거대 언어 모델을 파인튜닝한다. 이 를 통해, 다양한 단어들을 조합하여 확률적 계산에 의해 시나리오를 추론하는 상황 설명 모델을 구성한다. 일반적으로 거대 언어 모델(LLM)은 신경망 언어 모델(Neural Network Language Model, NNLM)의 한 종류로서 대 량의 텍스트 데이터(예: 수십억 단어)로 훈련시켜 자연어 입력을 이해하고 자연어 문장을 생성하도록 머신러닝 학습이 이루어진 신경망 모델이다. 즉, 방대한 양의 자연언어를 처리해서 사람이 생성한 것과 구별할 수 없을 정도의 자연어 문장을 생성할 수 있는 인공지능 신경망이다. 거대 언어 모델(LLM)의 대표적인 예는 OPEN AI 사 에서 개발한 Chat GPT이다. Chat GPT-4는 1750억개의 파라미터를 활용하여 자연어를 처리한다. 본 발명에서 '파인튜닝(fine-tuning)'은 자연어 처리를 위해 범용적으로 미리 훈련되어 있는 거대 언어 모델 을 특정한 과제, 즉 CCTV 관제영상에서 이상 상황을 탐지하는 과제에 맞도록 머신러닝 학습을 추가 수행하 는 과정을 의미한다. 거대 언어 모델은 범용의 대규모 자연어 데이터셋에 의해 사전 훈련이 이루어진 상태 이다. 이러한 거대 언어 모델의 사전 학습된 파라미터를 초기값으로 설정하고, 해당 과제를 위해 특별히 마련된 새로운 데이터셋에 의해 추가로 머신러닝 학습을 진행한다. 단계 (S170) : 이상 상황 인식부는 시나리오 생성부가 생성한 상황설명 시나리오를 미리 학습된 거대 언어 모델(LLM)에 입력하여 정상 상황인지 아니면 이상 상황인지를 구분하는 이진 분류(binary classificatio n)를 수행한다. [도 7]은 본 발명에서 이상 상황 인식부의 동작 개념도이다. 거대 언어 모델이 수행 하는 이진 분류의 결과가 '이상 상황'으로 나오는 경우에 이상 상황이 탐지된 것이 된다. 이때, 이상 상황 인식 부가 사용하는 거대 언어 모델은 시나리오 생성부가 사용하는 거대 언어 모델(LLM)과는 별 개인 것으로 가정한다. 이상 상황 인식부의 거대 언어 모델은 카메라 영상 내의 객체들의 관계성 및 상황에 대한 맥락적 설 명을 담고 있는 상황설명 시나리오를 텍스트 기반으로 자연어 처리하며, 이를 통해 객체들(사물, 사람) 간의 부 적절한 연결을 파악하여 이상 상황(anomaly) 여부를 분류한다. 예를 들면, 어린 아이가 총이나 칼과 같은 무기 를 가지고 있거나 사람과 불(fire)이 함께 감지되는 상황이면 위험 상황이라는 분류 결과를 출력한다. 한편, 프롬프트 엔지니어링을 통해 이상 상황 인식부의 이상 분류 성능을 개선하는 구성이 바람직하다. 일 반적으로 프롬프트 엔지니어링(Prompt Engineering)은 인공지능 언어 모델을 사용할 때, 원하는 결과를 얻기 위 해 적절한 입력(프롬프트)을 설정하는 기술이다. 신경망 모델의 특성과 한계를 이해하고, 원하는 작업을 정확하 게 지시하는 프롬프트를 구성하여 신경망 모델의 출력을 조작하거나 개선한다. 프롬프트 엔지니어링이 적용된 거대 언어 모델에 의해 객체들 간의 관계성을 감지하고 객체들 간의 부적절한 관계가 연결되는 경우에는 이상 상황으로 분류한다. 이상 상황을 정의하기 위해 프롬프트 엔지니어링에 의해 도메인 지식과 사용자 요구사항을 반영하여 이상 상황 인식부가 정상 상황과 이상 상황을 구분하는 조건과 기준을 설정한다. [도 8]은 본 발명에서 이상 상황 식 별을 위한 프롬프트 엔지니어링의 일부 예시도이다. 프롬프트 엔지니어링부는 이상 상황에 대한 식별 지침 과 텍스트 분류 요령을 포함한 프롬프트를 이상 상황 인식부로 제공함으로써 거대 언어 모델이 상황 설명 시나리오의 문맥을 이해하는 특성을 극대화하고, 파인튜닝 된 학습 분포에 가까운 여러 텍스트 정보를 제 공함으로써 정상 상황과 이상 상황 분류의 정확도를 개선할 수 있다. 한편, 본 발명은 컴퓨터가 읽을 수 있는 비휘발성 기록매체에 컴퓨터가 읽을 수 있는 코드의 형태로 구현되는 것이 가능하다. 이러한 비휘발성 기록매체로는 다양한 형태의 스토리지 장치가 존재하는데 예컨대 하드디스크, SSD, CD-ROM, NAS, 자기테이프, 웹디스크, 클라우드 디스크 등이 있다. 또한, 본 발명은 하드웨어와 결합되어 특정의 절차를 실행시키기 위하여 매체에 저장된 컴퓨터프로그램의 형태로 구현될 수도 있다."}
{"patent_id": "10-2023-0125758", "section": "도면", "subsection": "도면설명", "item": 1, "content": "[도 1]은 본 발명에 따른 인간-객체 관계 모델링 기반의 이상 탐지 시스템의 전체 구성도. [도 2]는 본 발명에 따른 인간-객체 관계 모델링 기반의 이상 탐지 방법의 전체 프로세스 순서도. [도 3]은 본 발명에서 자세 인식의 예시도. [도 4]는 본 발명에서 관계 추론의 예시도. [도 5]는 본 발명에서 관계 그래프의 생성 예시도. [도 6]은 본 발명에서 시나리오 생성부의 동작 개념도. [도 7]은 본 발명에서 이상 상황 인식부의 동작 개념도. [도 8]은 본 발명에서 이상 상황 식별을 위한 프롬프트 엔지니어링의 일부 예시도."}
