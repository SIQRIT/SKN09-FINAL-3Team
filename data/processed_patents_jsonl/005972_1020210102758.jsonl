{"patent_id": "10-2021-0102758", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2023-0020856", "출원번호": "10-2021-0102758", "발명의 명칭": "신경망 파라미터의 양자화 방법 및 장치", "출원인": "주식회사 사피온코리아", "발명자": "이원재"}}
{"patent_id": "10-2021-0102758", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "배치 정규화 파라미터들을 포함하는 신경망의 파라미터 양자화를 위한, 컴퓨터 구현 방법에 있어서,제1 레이어에 연결된 제2 레이어 내 파라미터들을 획득하는 과정;상기 제1 레이어의 출력값들 또는 상기 파라미터들에 적용되는 배치 정규화 파라미터들 중 어느 하나를 기반으로, 상기 파라미터들 중 적어도 하나의 파라미터를 제거하는 과정; 및상기 제거 과정에서 생존한 파라미터들에 기초하여, 상기 제2 레이어 내 상기 파라미터들을 양자화하는 과정을 포함하는 방법."}
{"patent_id": "10-2021-0102758", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 적어도 하나의 파라미터를 제거하는 과정은,상기 제1 레이어의 출력 채널들 중 출력값들을 모두 제로 값으로 출력하는 채널을 식별하는 과정; 및상기 파라미터들 중 상기 식별된 채널을 통해 출력되는 출력값에 적용되는 적어도 하나의 파라미터를 제거하는과정을 포함하는 방법."}
{"patent_id": "10-2021-0102758", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1항에 있어서,상기 적어도 하나의 파라미터를 제거하는 과정은,상기 제1 레이어의 출력 채널들 중 논제로 출력값들의 개수가 기 설정된 개수보다 적은 채널을 식별하는 과정;및상기 파라미터들 중 상기 식별된 채널을 통해 출력되는 출력값들에 적용되는 적어도 하나의 파라미터를 제거하는 과정을 포함하는 방법."}
{"patent_id": "10-2021-0102758", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제1항에 있어서,상기 적어도 하나의 파라미터를 제거하는 과정은,상기 제1 레이어의 출력 채널들 중 기 설정된 값보다 작은 값을 가지는 출력값들의 개수가 기 설정된 개수보다적은 채널을 식별하는 과정; 및상기 파라미터들 중 상기 식별된 채널을 통해 출력되는 출력값들에 적용되는 적어도 하나의 파라미터를 제거하는 과정을 포함하는 방법."}
{"patent_id": "10-2021-0102758", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제1항에 있어서,상기 적어도 하나의 파라미터를 제거하는 과정은,공개특허 10-2023-0020856-3-상기 적어도 하나의 파라미터의 값을 제로 값으로 설정하는 과정을 포함하는 방법."}
{"patent_id": "10-2021-0102758", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제1항에 있어서,상기 적어도 하나의 파라미터를 제거하는 과정은,상기 배치 정규화 파라미터들 중 기 설정된 조건을 충족하는 배치 정규화 파라미터를 식별하는 과정;상기 파라미터들 중 상기 식별된 배치 정규화 파라미터에 적용되는 적어도 하나의 파라미터를 제거하는 과정을 포함하는 방법."}
{"patent_id": "10-2021-0102758", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제6항에 있어서,상기 배치 정규화 파라미터를 식별하는 과정은,상기 배치 정규화 파라미터들 중 기 설정된 값보다 큰 값을 가지는 배치 정규화 파라미터를 식별하는 과정을 포함하는 방법."}
{"patent_id": "10-2021-0102758", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "명령어들을 저장하는 메모리; 및적어도 하나의 프로세서를 포함하되,상기 적어도 하나의 프로세서는 상기 명령어들을 실행함으로써,제1 레이어에 연결된 제2 레이어 내 파라미터들을 획득하고,상기 제1 레이어의 출력값들 또는 상기 파라미터들에 적용되는 배치 정규화 파라미터들 중 어느 하나를 기반으로 상기 파라미터들 중 적어도 하나의 파라미터를 제거하고,상기 제거 과정에서 생존한 파라미터들에 기초하여, 상기 제2 레이어 내 상기 파라미터들을 양자화하는, 연산장치."}
{"patent_id": "10-2021-0102758", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제1항 내지 제7항 중 어느 한 항의 방법을 실행하기 위한 컴퓨터 프로그램을 기록한 컴퓨터로 판독 가능한 기록매체."}
{"patent_id": "10-2021-0102758", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "신경망 파라미터의 양자화 방법 및 장치를 개시한다. 본 발명의 일 측면에 의하면, 배치 정규화 파라미터들을 포함하는 신경망의 파라미터 양자화를 위한, 컴퓨터 구 현 방법에 있어서, 제1 레이어에 연결된 제2 레이어 내 파라미터들을 획득하는 과정; 상기 제1 레이어의 출력값 들 또는 상기 파라미터들에 적용되는 배치 정규화 파라미터들 중 어느 하나를 기반으로 상기 파라미터들 중 적어 도 하나의 파라미터를 제거하는 과정; 및 상기 제거 과정에서 생존한 파라미터들에 기초하여, 상기 제2 레이어 내 상기 파라미터들을 양자화하는 과정을 포함하는 방법을 제공한다."}
{"patent_id": "10-2021-0102758", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명의 실시예들은 신경망 파라미터의 양자화 방법 및 장치, 특히 액티베이션 또는 배치 정규화 파라미터에 기반하여 신경망의 파라미터 중 일부를 제거하고, 생존한 파라미터를 이용하여 양자화를 수행하는 방법 및 장치 에 관한 것이다."}
{"patent_id": "10-2021-0102758", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "이 부분에 기술된 내용은 단순히 본 발명에 대한 배경 정보를 제공할 뿐 종래기술을 구성하는 것은 아니다. 인공지능(Artificial Intelligent; AI) 기술이 발달함에 따라, AI를 활용한 서비스들이 다수 출시되고 있다. AI 를 활용한 서비스들을 제공하는 제공자는 AI 모델을 학습하고, 학습된 모델을 이용하여 서비스들을 제공한다. 이하에서는, AI 모델들 중 신경망을 기준으로 설명한다. 신경망을 이용하여 서비스에 필요한 태스크(task)를 수행하기 위해서는 처리해야 하는 연산량이 많으므로, 병렬 연산이 가능한 그래픽 처리 장치(Graphic Processing Unit; GPU)가 이용된다. 하지만, 그래픽 처리 장치는 신경망의 연산을 처리하는 데 효율적이지만, 전력 소모가 높고, 고가의 장치라는 단점이 있다. 구체적으로, 신경망 의 정확도를 높이기 위해, 그래픽 처리 장치는 32 비트 부동 소수점(32 bit Floating Point; FP32)를 이용한다. 이때, FP32를 이용한 연산은 전력 소모가 높기 때문에, 그래픽 처리 장치의 연산도 전력 소모가 높다. 이러한 그래픽 처리 장치의 단점을 보완하기 위한 장치로써, 하드웨어 가속기 또는 AI 가속기에 대한 연구가 활 발히 진행되고 있다. AI 가속기는 FP32 대신 8 비트 정수(8 bit integer; INT8)을 이용함으로써, 그래픽 처리 장치보다 전력 소모뿐만 아니라 계산 복잡도를 줄일 수 있다. 그래픽 처리 장치와 AI 가속기를 함께 이용하는 방안으로써, 그래픽 처리 장치가 신경망을 FP32 상에서 학습하 고, AI 가속기가 FP32 상에서 학습된 신경망을 INT8로 변환한 후 신경망을 추론에 이용하는 방안이 있다. 이로 써, 신경망의 정확도와 연산 속도를 모두 달성할 수 있다. 이때, FP32 표현 체계 상에서 학습된 신경망을 INT8 표현 체계로 변환하는 과정이 필요하다. 이처럼, 높은 정밀 도(precision)를 가지는 값들을 낮은 정밀도의 값들로 변환하는 과정을 양자화(quantization)라 한다. 학습 과 정에서 FP32 값으로 학습되는 파라미터들은 학습이 완료된 후 양자화를 통해 이산(discrete) 값들인 INT8 값으 로 맵핑되고, 신경망을 추론에 이용될 수 있다. 한편, 양자화는 신경망의 파라미터인 가중치에 적용되는 양자화와 레이어의 출력인 액티베이션에 적용되는 양자 화로 나뉠 수 있다. 구체적으로, FP32 상에서 학습이 완료된 신경망의 가중치들은 FP32 정밀도를 가진다. 신경망의 학습이 완료된 후 높은 정밀도를 가지는 가중치들은 낮은 정밀도 값으로 양자화된다. 이를 신경망의 가중치에 적용되는 양자화 라 한다. 반면, 양자화되지 가중치들은 FP32 정밀도를 가지므로, 양자화되지 않은 가중치들을 통해 계산되는 액티베이션 도 FP32 정밀도를 가진다. 따라서, 신경망의 연산이 INT8에서 수행되기 위해서는, 가중치들뿐만 아니라 액티베 이션들도 양자화되어야 한다. 이를 신경망의 액티베이션에 적용되는 양자화라 한다. 도 1은 신경망의 양자화를 설명하기 위해 예시한 도면이다. 도 1을 참조하면, 연산 장치는 데이터 및 가중치로부터 복수의 단계를 거쳐 캘리브레이션 테이 블과 양자화된 가중치를 생성한다. 복수의 단계는 도 5a에서 자세히 설명한다. 여기서, 캘리브레이션 테이블은 신경망에 포함된 레이어들의 액티베이션들을 양자화하는 데 필요한 정보로 써, 신경망에 포함된 각 레이어별로 액티베이션의 양자화 범위를 기록한 것을 의미한다. 구체적으로, 연산 장치는 액티베이션들을 모두 양자화하는 것이 아니라 소정의 범위에 따른 액티베이션들 을 양자화한다. 이때, 양자화 범위를 결정하는 것을 캘리브레이션(calibration)이라 하고, 양자화 범위를 기록 한 것을 캘리브레이션 테이블이라 한다. 양자화 범위는 가중치들의 양자화에도 적용된다. 한편, 양자화된 가중치는 연산 장치가 입력 받은 가중치의 분포를 분석하고, 가중치 분포에 기 초하여 가중치를 양자화한 것이다. 도 1에 도시된 바와 같이, 일반적으로 양자화된 가중치는 입력 받은 가중치의 분포에 기초하여 생성 된다. 이처럼 가중치의 분포에만 기반하여 양자화를 수행하는 경우, 양자화된 가중치는 양자화에 따 른 왜곡을 포함할 수 있다. 도 2는 가중치 분포에 기반한 양자화 결과를 예시한 도면이다. 도 2를 참조하면, 좌측 그래프에 양자화되지 않은 가중치들에 대한 가중치 분포가 도시되어 있다. 좌측 그 래프의 가중치 값은 높은 정밀도를 가진다. 양자화되기 전 가중치들은 대부분 0.0 값 부근에 분포한다. 하지만, 좌측 그래프와 같이, 가중치 분포에는 다른 가중치들보다 훨씬 큰 값을 가지는 가중치들도 존재할 수 있다. 연산 장치(미도시)는 좌측 그래프로 부터 최댓값 기반 양자화 또는 클리핑 기반 양자화를 수행할 수 있다. 우측 그래프들(210, 212)의 가중치들은 낮은 정밀도를 가진다. 우측 상단 그래프는 좌측 그래프로부터 최댓값 기반 양자화의 결과이다. 구체적으로, 연산 장치는 좌 측 그래프에서 가중치들 중 크기가 최대인 -10.0 값과 10.0 값을 기준으로 가중치들에 양자화를 수행한다. 양자화되기 전 최댓값 또는 최솟값에 위치한 가중치들은 낮은 정밀도 표현 범위의 최솟값 -127 또는 최댓값 127로 매핑된다. 반면, 양자화되기 전 0.0 값 부근에 위치한 가중치들은 모두 0으로 양자화된다. 우측 하단 그래프는 좌측 그래프로부터 클리핑 기반 양자화의 결과이다. 구체적으로, 연산 장치는 좌 측 그래프에서 가중치 분포에 기초하여 평균제곱오차를 구하고, 평균제곱오차에 기초하여 클리핑 경계값을 계산한다. 연산 장치는 클리핑 경계값을 기준으로 가중치들에 양자화를 수행한다. 양자화되기 전 클리핑 경계값 에 위치한 가중치들은 낮은 정밀도 표현 범위의 경계값에 매핑된다. 반면, 양자화되기 전 0.0 값 부근에 위치한 가중치들은 0 또는 0 근처의 값으로 매핑된다. 양자화되기 전 가중치의 최댓값과 최솟값에 따른 범위보다 클리 핑 경계값에 따른 범위가 좁으므로, 클리핑 기반 양자화에서는 가중치들이 모두 0으로 매핑되지는 않는다. 다시 말하면, 클리핑 기반으로 양자화된 가중치들이 최댓값 기반으로 양자화된 가중치들보다는 높은 해상도 (resolution)를 갖는다. 그럼에도 불구하고, 최댓값 기반 양자화 및 클리핑 기반 양자화를 통해 양자화된 가중치들은 대부분 0 값으로 매핑된다. 이는, 신경망의 정확도를 저하시키는 요인이 된다. 이처럼, 가중치들 중에 대부분의 값들과 괴리가 큰 이상치(outlier) 가중치가 있는 경우, 양자화 적용 시 신경망의 성능이 저하된다. 따라서, 신경망에 포함된 가중치들을 양자화함에 있어서, 이상치에 해당하는 가중치를 제거한 후 양자화를 수행 하는 방안에 대한 연구가 필요하다."}
{"patent_id": "10-2021-0102758", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명의 실시예들은, 신경망의 파라미터 분포가 아닌 레이어들의 출력들에 기초하여 양자화 전 일부 파라미터 들을 제거함으로써, 양자화된 파라미터의 값이 왜곡되는 것을 방지하고 양자화에 따른 신경망의 성능 저하를 감 소시키기 위한, 신경망 파라미터의 양자화 방법 및 장치를 제공하는 데 주된 목적이 있다. 본 발명의 다른 실시예들은, 신경망의 파라미터 분포가 배치 정규화 파라미터에 기초하여 양자화 전 일부 파라 미터들을 제거함으로써, 양자화된 파라미터의 값이 왜곡되는 것을 방지하고 양자화에 따른 신경망의 성능 저하 를 감소시키기 위한, 신경망 파라미터의 양자화 방법 및 장치를 제공하는 데 주된 목적이 있다."}
{"patent_id": "10-2021-0102758", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명의 일 측면에 의하면, 배치 정규화 파라미터들을 포함하는 신경망의 파라미터 양자화를 위한, 컴퓨터 구 현 방법에 있어서, 제1 레이어에 연결된 제2 레이어 내 파라미터들을 획득하는 과정; 상기 제1 레이어의 출력값 들 또는 상기 파라미터들에 적용되는 배치 정규화 파라미터들 중 어느 하나를 기반으로, 상기 파라미터들 중 적 어도 하나의 파라미터를 제거하는 과정; 및 상기 제거 과정에서 생존한 파라미터들에 기초하여, 상기 제2 레이 어 내 상기 파라미터들을 양자화하는 과정을 포함하는 방법을 제공한다. 본 실시예의 다른 측면에 의하면, 명령어들을 저장하는 메모리; 및 적어도 하나의 프로세서를 포함하되, 상기 적어도 하나의 프로세서는 상기 명령어들을 실행함으로써, 제1 레이어에 연결된 제2 레이어 내 파라미터들을 획 득하고, 상기 제1 레이어의 출력값들 또는 상기 파라미터들에 적용되는 배치 정규화 파라미터들 중 어느 하나를 기반으로 상기 파라미터들 중 적어도 하나의 파라미터를 제거하고, 상기 제거 과정에서 생존한 파라미터들에 기 초하여, 상기 제2 레이어 내 상기 파라미터들을 양자화하는, 연산 장치를 제공한다."}
{"patent_id": "10-2021-0102758", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "이상에서 설명한 바와 같이 본 발명의 일 실시예에 의하면, 신경망의 파라미터 분포가 아닌 레이어들의 출력들 에 기초하여 양자화 전 일부 파라미터들을 제거함으로써, 양자화된 파라미터의 값이 왜곡되는 것을 방지하고, 양자화에 따른 신경망의 성능 저하를 감소시킬 수 있다. 본 발명의 다른 실시예에 의하면, 신경망의 파라미터 분포가 배치 정규화 파라미터에 기초하여 양자화 전 일부 파라미터들을 제거함으로써, 양자화된 파라미터의 값이 왜곡되는 것을 방지하고 양자화에 따른 신경망의 성능 저하를 감소시킬 수 있다."}
{"patent_id": "10-2021-0102758", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하, 본 발명의 일부 실시예들을 예시적인 도면을 통해 상세하게 설명한다. 각 도면의 구성요소들에 참조부호 를 부가함에 있어서, 동일한 구성요소들에 대해서는 비록 다른 도면 상에 표시되더라도 가능한 한 동일한 부호 를 가지도록 하고 있음에 유의해야 한다. 또한, 본 발명을 설명함에 있어, 관련된 공지 구성 또는 기능에 대한 구체적인 설명이 본 발명의 요지를 흐릴 수 있다고 판단되는 경우에는 그 상세한 설명은 생략한다. 또한, 본 발명의 구성 요소를 설명하는 데 있어서, 제 1, 제 2, A, B, (a), (b) 등의 용어를 사용할 수 있다. 이러한 용어는 그 구성 요소를 다른 구성 요소와 구별하기 위한 것일 뿐, 그 용어에 의해 해당 구성 요소의 본 질이나 차례 또는 순서 등이 한정되지 않는다. 명세서 전체에서, 어떤 부분이 어떤 구성요소를 '포함', '구비' 한다고 할 때, 이는 특별히 반대되는 기재가 없는 한 다른 구성요소를 제외하는 것이 아니라 다른 구성요소를 더 포함할 수 있는 것을 의미한다. 또한, 명세서에 기재된 '~부', '모듈' 등의 용어는 적어도 하나의 기능이나 동작을 처리하는 단위를 의미하며, 이는 하드웨어나 소프트웨어 또는 하드웨어 및 소프트웨어의 결합으로 구현 될 수 있다. 이하에서, 신경망은 인공 뉴런(neuron)을 나타내는 노드들이 시냅스를 통해 연결된 구조를 가진다. 노드들은 시 냅스를 통해 수신된 신호를 처리할 수 있고, 처리된 신호를 다른 노드에 전송한다. 신경망은 텍스트, 오디오, 또는 비디오 등 다양한 도메인의 데이터들에 기초하여 학습될 수 있다. 또한 신경망 은 다양한 도메인의 데이터들에 기초하여 추론에 이용될 수 있다. 신경망은 복수의 레이어를 포함한다. 신경망은 입력 레이어, 히든 레이어 및 출력 레이어를 포함할 수 있다. 또 한, 신경망은 학습 과정에서 배치 정규화(batch normalization) 레이어를 더 포함할 수 있다. 배치 정규화 레이 어 내 배치 정규화 파라미터들은 레이어들에 포함된 파라미터들과 함께 학습되고, 학습이 완료된 후 고정된 값 을 가진다. 신경망에 포함된 다수의 레이어들 중 인접한 레이어들은 입출력을 수신하고 전송한다. 즉, 첫 번째 레이어의 출 력은 두 번째 레이어의 입력이 되고, 두 번째 레이어의 출력은 세 번째 레이어의 입력이 된다. 각 레이어는 적 어도 하나의 채널을 통해 입력과 출력을 주고 받는다. 채널은 뉴런 또는 노드와 혼용될 수 있다. 각 레이어는 입력에 연산을 수행하고, 연산 결과를 출력한다. 여기서, 레이어의 채널들 각각의 입력 및 출력은 입력 액티베이션(input activation) 및 출력 액티베이션 (output activation)이라고 지칭될 수 있다. 즉, 액티베이션은 한 채널의 출력임과 동시에, 다음 레이어에 포함 된 채널들의 입력에 해당할 수 있다. 한편, 본 개시에서 텐서(tensor)는 가중치, 바이어스 및 액티베이션 중 적 어도 하나를 포함한다. 본 개시에서 신경망은 AI 모델 중 하나의 예시에 해당한다. 신경망은 인공 신경망(artificial neural network), 심층 신경망(deep neural network), 합성곱 신경망(convolution neural network), 또는 순환 신경망(recurrent neural network) 등 다양한 신경망으로 구현될 수 있다. 본 발명의 일 실시예에 따른 신경망은 합성곱 신경망일 수 있다. 본 개시에서는, 신경망의 파라미터는 가중치, 바이어스 및 필터 파라미터 중 적어도 하나와 혼용될 수 있다. 또 한, 레이어의 출력 또는 출력값은 액티베이션과 혼용될 수 있다. 또한, 입력 또는 출력에 파라미터가 적용된다 는 것은 입력 또는 출력과 파라미터에 기초하여 연산이 수행되는 것을 의미한다. 도 3a 및 도 3b는 이상치를 포함하는 가중치 분포에 기반한 양자화를 설명하기 위해 예시한 도면이다. 도 3a를 참조하면, 입력, 제1 레이어, 복수의 채널, 복수의 출력, 제2 레이어 및 양자화된 제2 레이어가 도시되어 있다. 도 도시된 제1 레이어 및 제2 레이어는 신경망의 예시이므로, 신경망 은 다양한 레이어 구조 및 다양한 가중치들을 포함하도록 구성될 수 있다. 또한, 신경망은 다양한 채널들을 포 함할 수 있다. 신경망은 제1 레이어 및 제2 레이어를 포함하고, 제1 레이어 및 제2 레이어 각각은 복수의 가중치들을 포함할 수 있다. 도 3a에서 제1 레이어의 하나의 출력에 제2 레이어의 하나의 가중치가 적용되는 것으로 도시된 것은 연산 과정을 단순화한 것이다. 한편, 각 가중치들은 학습이 완료되어 고정된 값이다. 제1 레이어는 입력에 자신의 가중치들을 적용함으로써, 복수의 출력을 생성할 수 있다. 제1 레이어 는 생성한 출력들을 적어도 하나의 채널을 통해 출력한다. 제1 레이어는 4개의 채널을 가지므로, 4개 의 출력들을 생성하고 출력한다. 제1 출력은 제1 채널을 통해 출력되고, 제2 출력은 제2 채널을 통해 출력된다. 예를 들어, 신경망이 합성곱 신경망인 경우, 제1 레이어에는 가중치가 커널의 형태로 구현될 수 있고, 커 널의 수는 입력 채널의 수와 출력 채널의 수의 곱한 값이다. 제1 레이어의 커널들이 입력과 컨볼루션 연산되어 복수의 출력을 생성된다. 제1 레이어로부터 출력된 제1 출력, 제2 출력, 제3 출력 및 제4 출력은 제2 레이어 에 입력된다. 제2 레이어는 제1 출력, 제2 출력, 제3 출력 및 제4 출력에 자신의 가중치들을 적용 함으로써, 출력을 생성할 수 있다. 이때, 제2 레이어는 학습 과정에서 이상치에 해당하는 가중치를 포함하도록 학습되었을 수 있다. 이하에서, 이상치는 가중치들 중 신경망의 정확도를 저하시키는 가중치로써, 값이 크고 수가 적은 가중치들을 의미할 수 있다. 예를 들어, 도 3a에서 제2 레이어는 제1 가중치, 제2 가중치, 제3 가중치 및 제4 가중치를 포함한다. 제1 가중치는 0.06 값을 가지며, 제2 가중치는 0.01 값을 가지고, 제3 가중치는 10.0 값을 가지고, 제4 가중치는 0.004 값을 가진다. 여기서, 제1 가중치, 제2 가중치 및 제4 가중치는 0에 가까운 값을 가지지만, 제3 가중치는 나머지 가중치들에 비해 훨씬 큰 값을 가지므로, 제3 가중치가 이상치일 수 있다. 이때, 제2 레이어가 이상치를 포함함에도 불구하고, 양자화 장치(미도시)가 제2 레이어의 가중치 분 포에 기초하여 가중치들을 양자화하는 경우, 양자화된 제2 레이어의 가중치들은 왜곡될 수 있다. 구체적으로, 양자화 장치는 최댓값 기반 양자화 또는 클리핑 기반 양자화를 수행하여 양자화된 제2 레이어(33 0)를 생성할 수 있다. 이때, 소수로 표현되어 높은 정밀도를 가지는 제2 레이어의 가중치들은 양자화 후 낮은 정밀도를 가지는 INT8로 양자화된다. 양자화 전 상대적으로 큰 값을 가지는 제3 가중치는 양자화 후에도 큰 값을 가진다. 반면, 제1 가중치, 제2 가 중치 및 제4 가중치처럼 0에 가까운 값을 가지는 가중치들은 양자화를 통해 모두 0으로 매핑된다. 양자화 전에 는 서로 구별되는 가중치들이 양자화 후에 모두 동일한 값으로 매핑되어 구별되지 않게 된다. 이처럼, 양자화된 제2 레이어의 가중치들에 왜곡이 발생한 경우, 양자화된 제2 레이어를 포함하는 신경망의 정확도가 저하된다."}
{"patent_id": "10-2021-0102758", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "요약하면, 신경망이 이상치에 해당하는 파라미터를 포함함에도, 파라미터 분포에 기초하여 양자화를 수행하는 경우, 신경망의 정확도가 저하될 수 있다. 한편, 도 3b를 참조하면, 신경망은 배치 정규화 파라미터들을 이용하여 배치 정규화를 수행할 수 있다. 여기서, 배치 정규화는 학습 데이터를 포함하는 각 미니 배치(mini batch)의 각 채널별로 각각의 평균 및 각각 의 분산을 이용하여 레이어의 출력값들을 정규화하는 것이다. 신경망 내 각 레이어마다 입력의 데이터 분포가 달라, 배치 정규화는 입력의 데이터 분포를 조정하기 위한 것이다. 배치 정규화 이용 시, 신경망의 학습 속도가 증가한다.신경망은 학습 과정에서 배치 정규화 레이어를 포함하고, 배치 정규화 레이어는 배치 정규화 파라미터들을 포함 한다. 배치 정규화 파라미터는 평균(mean), 분산(variance), 스케일(scale) 및 시프트(shift) 중 적어도 하나를 포함한다. 배치 정규화 파라미터는 신경망의 학습 과정에서 다른 레이어에 포함된 파라미터들과 함께 학습된다. 배치 정규 화 파라미터는 수학식 1과 같이 다른 레이어의 파라미터들을 정규화하는 데 이용된다. 수학식 1"}
{"patent_id": "10-2021-0102758", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "수학식 1에서, 는 정규화된 출력값, x는 정규화되지 않은 출력값,α는 스케일, m은 이전 레이어의 출력값들의 평균, V는 이전 레이어의 출력값들의 분산, β는 시프트이다. 학습이 완료된 신경망은 학습된 배치 정규화 파라미터를 가진다. 즉, 학습이 완료된 신경망에 포함된 배치 정규 화 파라미터는 고정된 값을 가진다. 학습이 완료된 신경망은 입력되는 데이터에 대해 배치 정규화 파라미터를 적용함으로써, 이전 레이어의 출력을 정규화할 수 있다. 학습이 완료된 신경망에서 배치 정규화 파라미터들은 이전 레이어인 제1 레이어의 출력들에 직접 적 용될 수 있지만, 일반적으로 제2 레이어의 가중치들에 적용되는 형태로 구현된다. 배치 정규화 파라미터들 이 제2 레이어의 가중치들에 적용되는 것은 배치 정규화 파라미터들을 기반으로 제2 레이어 의 가중치가 조절되는 것을 의미한다. 구체적으로, 학습된 평균, 분산, 스케일 및 시프트 중 적어도 하나 는 y=ax+b의 형태로 제2 레이어의 가중치들을 조절하는 데 이용된다. 여기서, y는 조정된 가중치이고, x는 조정전 가중치이고, a는 계수, b는 오프셋(offset)이다. 제1 레이어의 출력들은 제2 레이어의 조정된 가중치들과 연산된다. 하지만, 어느 경우에도 신경망의 학습 과정에서 배치 정규화 파라미터가 이상치를 가지도록 학습될 수 있다. 구체적으로, 배치 정규화 파라미터들은 제1 계수, 제2 계수, 제3 계수 및 제4 계수를 포함한다. 제1 계수 는 0.6 값을 가지며, 제2 계수는 0.1 값을 가지며, 제3 계수는 100 값을 가지며, 제4 계수는 0.04 값을 가진다. 여기서, 제1 계수, 제2 계수 및 제4 계수는 작은 값을 가지지만, 제3 계수는 나머지 계수들에 비해 훨씬 큰 값 을 가진다. 제2 레이어에 포함된 가중치들은 이상치를 포함하는 배치 정규화 파라미터들에 기초하여 조정된다. 예를 들어, 제1 기존 가중치는 0.1 값을 가지지만, 조정 후 0.06 값을 가진다. 제3 기존 가중치는 0.1 값을 가 지지만, 조정 후 10.0 값을 가진다. 이처럼, 제2 레이어가 배치 정규화 파라미터들에 따라 조정되기 전에는 가중치 중 이상치를 포함하지 않더라도, 배치 정규화 파라미터들의 적용 후에는 이상치에 해당하는 가중치를 포함할 수 있다. 조정 후, 제2 레이어가 이상치를 포함함에도 불구하고, 양자화 장치가 제2 레이어의 가중치 분포에 기초하여 가중치들을 양자화하는 경우, 양자화된 제2 레이어의 가중치들은 왜곡될 수 있다. 이처럼, 양자화된 제2 레이어의 가중치들에 왜곡이 발생한 경우, 양자화된 제2 레이어를 포함하는 신 경망 또한 정확도가 저하된다. 도 3a 및 도 3b와 같이, 신경망이 이상치에 해당하는 파라미터 또는 배치 정규화 파라미터를 포함하도록 학습되 었음에도 불구하고, 양자화 장치가 이상치가 포함된 파라미터 분포에 기초하여 양자화를 수행하는 경우, 가중치 들의 왜곡이 발생한다. 배치 정규화 파라미터들이 이상치를 포함하도록 학습되는 원인은 제3 채널에 대응되는 제1 레이어의 가중치 값이 작게 학습되기 때문이다. 제1 레이어의 가중치 값이 작으면, 제3 채널을 통해 출력되는 제3 출력도 값이 작다. 제3 출력의 값을 정규화 또는 보상하기 위해, 배치 정규화 파라미터들 중 제 3 출력에 적용되는 제3 계수는 큰 값을 가지도록 학습된다. 이로 인해, 제3 계수에 의해 조정되는 제3 가중치도 큰 값을 가지게 되고, 양자화 과정에서 신경망의 정확도를 저하시키는 이상치가 된다. 본 발명의 일 실시예에 따른 양자화 방법은 신경망의 배치 정규화 파라미터에 이상치가 발생하는 상황을 고려하 여, 이전 레이어의 출력을 기반으로 이상치에 대응되는 파라미터를 검출하고, 파라미터를 제거함으로써, 양자화 의 왜곡을 줄일 수 있다. 도 4는 본 발명의 일 실시예에 따른 양자화를 설명하기 위해 예시한 도면이다. 본 발명의 일 실시예에 따른 양자화 장치(미도시)는 배치 정규화가 적용되는 신경망에서 이전 레이어의 출력값 들을 기반으로 현재 레이어의 파라미터들 중 이상치에 해당하는 파라미터를 판단하여 제거하고, 생존한 파라미 터들에 기초하여 전체 파라미터들을 양자화한다. 도 4를 참조하면, 제1 레이어와 제2 레이어는 배치 정규화 파라미터들을 사이에 두고 연결되어 있다. 제1 레이어는 입력에 가중치들을 적용하여 복수의 출력을 출력한다. 제2 레이어는 제1 레 이어로부터 출력되는 복수의 출력들을 입력 받는다. 본 발명의 일 실시예에 따른 양자화 장치는 양자화 하려는 제2 레이어의 가중치들을 획득한다. 여기서, 가 중치는 조정되지 않은 기존 가중치를 의미한다. 양자화 장치는 제1 레이어의 출력값들 또는 또는 상기 파라미터들에 적용되는 배치 정규화 파라미터들 중 어느 하나를 기반으로 제2 레이어에 포함된 가중치들 중 이상치에 해당하는 가중치를 판단하고 제거한다. 본 발명의 일 실시예에 의하면, 양자화 장치는 제1 레이어의 출력 채널들 중 출력값들을 모두 제로 값으로 출력하는 채널을 식별한다. 도 4에서 제1 레이어의 제3 채널을 통해 출력되는 제3 출력이 제로 값을 출력하므로, 양자화 장치는 제3 채널을 식별한다. 이후, 양자화 장치는 제2 레이어에 포함된 가중치들 중 식별된 제3 채널을 통해 출력되는 제3 출력에 연관된 가중치를 이상치로 판단한다. 제3 출력에 연관된 가중치란, 제3 출력에 적용되어 제2 레이어 의 출력을 생성하는 가중치를 의미한다. 도 4에서는, 제3 가중치가 이상치로 결정된다. 양자화 장치는 제3 가중치를 제거한다. 이때, 양자화 장치가 제3 가중치를 제거하는 것은 제3 가중치의 값을 제 로 값 또는 제로에 가까운 값으로 설정하는 것을 의미할 수 있다. 또는, 제3 가중치의 제거는 제3 가중치의 변 수를 삭제하는 것을 의미할 수 있다. 마지막으로, 양자화 장치는 제2 레이어에서 제거되지 않은 가중치들에 기초하여, 제2 레이어에 포함 된 가중치들을 양자화한다. 제2 레이어에 포함된 가중치들 중 이상치가 제거되었으므로, 양자화 장치가 제2 레이어의 가중치들에 최댓값 기반 양자화 또는 클리핑 기반 양자화를 적용하더라도, 가중치들의 왜곡을 감소시킬 수 있다. 즉, 양자 화 전 제2 레이어에서 서로 구별되는 가중치들이 양자화 후에도 대부분 서로 구별되는 값을 가진다. 나아가, 제3 채널을 통해 출력되는 제3 출력은 제로 값을 가지므로, 양자화 장치가 제3 가중치를 제거하더 라도 제2 레이어의 출력 및 이후의 연산에 아무런 영향을 미치지 않는다. 양자화 장치가 제3 가중치를 제 거하더라도 신경망의 정확도가 감소되지 않는다. 본 발명의 다른 실시예에 의하면, 양자화 장치는 제1 레이어의 출력 채널들 중 논제로 값들의 개수가 기 설정된 개수보다 적은 채널을 식별하고, 식별된 채널을 통해 출력되는 출력값들에 연관된 가중치를 이상치로 판 단할 수 있다. 예를 들어, 도 4에서 제3 출력에 포함된 출력값들 중 논제로 값들이 기 설정된 개수보다 적은 경우, 양자 화 장치는 제3 채널을 지정할 수 있다. 양자화 장치는 제3 채널을 통해 출력되는 제3 출력에 적용되는 제3 가중치를 이상치로 판단한다. 이후, 양자화 장치는 제3 가중치를 제거하고, 생존한 가중치들에 기초하여 제2 레 이어에 포함된 가중치들을 양자화한다. 제3 채널을 통해 출력되는 제3 출력의 값이 0에 가까우므로, 제3 가중치를 제거하더라도 신경망의 성능을 유지할 수 있다. 또한, 양자화 과정에서 가중치들의 왜곡을 감소시킬 수 있다. 본 발명의 다른 실시예에 의하면, 양자화 장치는 제1 레이어의 출력 채널들 중 기 설정된 값보다 작은 값 을 가지는 출력값들의 개수가 기 설정된 개수보다 적은 채널을 식별하고, 식별된 채널을 통해 출력되는 출력값 들에 연관된 가중치를 이상치로 판단할 수 있다.예를 들어, 제3 출력에 포함된 출력값들 중 기 설정된 값보다 작은 값을 가지는 출력값들이 기 설정된 개 수보다 적은 경우, 양자화 장치는 제3 채널을 지정할 수 있다. 양자화 장치는 제3 채널을 통해 출력되는 제3 출 력에 적용되는 제3 가중치를 이상치로 판단한다. 이후, 양자화 장치는 제3 가중치를 제거하고, 생존한 가 중치들에 기초하여 제2 레이어에 포함된 가중치들을 양자화한다. 여기서, 기 설정된 값 및 기 설정된 개수 는 임의로 결정될 수 있다. 본 발명의 다른 실시예에 의하면, 양자화 장치는 배치 정규화 파라미터들을 이용하여 제2 레이어에 포함된 가중치들 중 이상치를 선별할 수 있다. 여기서, 배치 정규화 파라미터들은 제2 레이어의 가중 치들에 적용됨으로써, 제2 레이어의 가중치들의 값을 조절한다. 구체적으로, 양자화 장치는 배치 정규화 파라미터들 중 기 설정된 조건을 충족하는 배치 정규화 파라미터 를 식별한다. 여기서, 기 설정된 조건은 기 설정된 값보다 큰 값을 가지는 것이다. 즉, 양자화 장치는 배치 정 규화 파라미터들 중 기 설정된 값보다 큰 값을 가지는 배치 정규화 파라미터를 식별할 수 있다. 예를 들어, 기 설정된 값이 10일 때, 양자화 장치는 값이 100인 제3 계수를 식별할 수 있다. 다음으로, 양자화 장치는 제2 레이어에 포함된 가중치들 중 식별된 배치 정규화 파라미터와 연관된 가중치 를 이상치로 판단한다. 식별된 배치 정규화 파라미터와 연관된 가중치 또는 식별된 배치 정규화 파라미터에 적 용되는 가중치란 식별된 배치 정규화 파라미터에 의해 조정될 가중치를 의미한다. 도 4에서는 제3 계수에 의해 조정되는 제3 가중치가 이상치로 결정된다. 양자화 장치는 제3 가중치를 제거하고, 제2 레이어에서 제거되지 않은 가중치들에 기초하여, 제2 레이어 에 포함된 가중치들을 양자화한다. 이 경우에도, 양자화 장치는 이상치에 해당하는 가중치를 제거함으로써, 양자화 과정에서 가중치들의 왜곡을 감소시킬 수 있고, 신경망의 정확도 감소를 방지할 수 있다. 도 5a 및 도 5b는 본 발명의 일 실시예에 따른 신경망의 양자화를 설명하기 위해 예시한 도면이다. 도 5a 및 도 5b를 참조하면, 본 발명의 일 실시예에 따른 연산 장치는 데이터 및 가중치로부터 복수의 단계를 거쳐 캘리브레이션 테이블과 양자화된 가중치를 생성한다. 여기서, 연산 장치는 본 발명의 일 실시예에 따른 양자화 장치를 포함한다. 구체적으로, 연산 장치는 데이터와 가중치를 불러온다. 캘리브레이션 테이블을 생성하기 위해, 연산 장치는 입력 받은 데이터를 신경망에 입력하기 위 한 데이터로 전처리한다(S500). 연산 장치는 데이터의 노이즈를 제거하거나 특징을 추출하여 더 유용한 데이터로 처리할 수 있다. 연산 장치는 전처리된 데이터와 가중치를 이용하여 추론을 수행한다(S502). 연산 장치는 추론을 통해 신경망의 태스크를 수행할 수 있다. 이후, 연산 장치는 추론의 결과를 분석한다(S504). 여기서, 추론의 결과는 추론 단계에서 생성된 액티베이션들을 분석한 것이다. 연산 장치는 추론의 결과에 따라 캘리브레이션 테이블을 생성한다(S506). 한편, 가중치를 양자화하기 위해, 연산 장치는 입력 받은 가중치로부터 가중치 분포를 분석한다 (S510). 도 5a를 참조하면, 연산 장치는 추론 과정(S502)에서 산출되는 액티베이션들을 분석한다(S512). 본 발명의 일 실시예에 의하면, 연산 장치는 배치 정규화가 적용되는 각 레이어에서 값이 0인 액티베이션 들을 출력하는 채널들을 식별하고, 식별된 채널들을 통해 출력되는 출력값에 적용되는 가중치를 제거한다. 본 발명의 다른 실시예에 의하면, 연산 장치는 배치 정규화가 적용되는 각 레이어에서 논제로 출력값의 개 수가 기 설정된 개수보다 적은 채널들을 식별하고, 식별된 채널들을 통해 출력되는 출력값에 적용되는 가중치를 제거한다. 도 5b를 참조하면, 본 발명의 다른 실시예에 따른 연산 장치는 배치 정규화 파라미터를 분석한다(S520). 연산 장치는 배치 정규화 파라미터들 중 기 설정된 조건을 충족하는 배치 정규화 파라미터를 식별하고, 배 치 정규화 파라미터에 의해 조정될 가중치를 제거한다. 도 5a 및 도 5b를 참조하면, 본 발명의 실시예들에 따라 일부 가중치의 값을 0으로 조정한 후, 연산 장치 는 생존한 가중치에 기초하여 최댓값 또는 평균제곱오차(Mean Square Error; MSE)를 계산한다(S514). 연산 장치는 가중치의 최댓값 또는 평균제곱오차로부터 양자화 범위를 결정하고, 양자화 범위에 따라 가중치를 클리핑 (clipping)한다(S514). 연산 장치는 클리핑을 수행한 후 가중치를 양자화한다(S516). 각 과정을 통해, 연산 장치는 캘리브레이션 테이블과 양자화된 가중치들을 생성한다. 여기서, 양자화된 가중치는 양자화되지 않은 가중치보다 낮은 정밀도를 가진다. 연산 장치는 캘리브레이션 테이블과 양자화된 가중치를 직접 이용할 수도 있고, AI 가속기에 전 송할 수도 있다. AI 가속기는 캘리브레이션 테이블과 양자화된 가중치를 이용하여 적은 전력으로도 성능 저하 없이 신경망의 연산을 수행할 수 있다. 도 6은 본 발명의 일 실시예에 따른 액티베이션에 기반한 양자화 결과를 예시한 도면이다. 도 6을 참조하면, 좌측 그래프에 양자화되지 않은 가중치들에 대한 가중치 분포가 도시되어 있다. 좌측 그 래프의 가중치 값은 높은 정밀도를 가진다. 양자화되기 전 가중치들은 대부분 0.0 값 부근에 분포한다. 하지만, 좌측 그래프와 같이, 가중치 분포에는 다른 가중치들보다 훨씬 큰 값을 가지는 가중치들도 존재할 수 있다. 이때, 본 발명의 일 실시예에 따른 연산 장치(미도시)는 좌측 그래프로부터 액티베이션 기반 양자화를 수행한다. 양자화에 의해, 우측 그래프(61 0)의 가중치들은 낮은 정밀도를 가진다. 우측 그래프는 좌측 그래프로부터 액티베이션 기반 양자화의 결과이다. 구체적으로, 연산 장치는 신 경망 내 레이어들 중 이전 레이어의 출력들에 기초하여 현재 레이어의 가중치들 중 적어도 하나를 제거하고, 생 존한 가중치들에 기초하여 현재 레이어의 가중치들을 양자화한다. 좌측 그래프에서 -10.0 값과 10.0 값은 액티베이션 기반 양자화 과정에서 이상치로 판단되어 제거된다. 좌측 그래프에서 이상치가 제거된 채 0.0 값 부근의 가중치들에 기초하여 가중치들이 양자화되므로, 좌측 그래프에서 0.0 값 부근의 가중치들이 우 측 그래프에서 모두 0으로 매핑되는 것이 아니라 0 및 0 부근의 값으로 매핑된다. 즉, 액티베이션 기반 양 자화에 따르면, 가중치들은 양자화 후 높은 해상도를 가진다. 도 7은 본 발명의 일 실시예에 따른 양자화를 위한 연산 장치의 구성도다. 도 7을 참조하면, 연산 장치는 시스템 메모리, 프로세서, 스토리지, 입출력 인터페이스 및 통신 인터페이스 중 일부 또는 전부를 포함할 수 있다. 시스템 메모리는 프로세서로 하여금 본 발명의 일 실시예에 따른 양자화 방법을 수행하도록 하는 프 로그램을 저장할 수 있다. 예를 들면, 프로그램은 프로세서에 의해서 실행 가능한(executable) 복수의 명 령어들을 포함할 수 있고, 복수의 명령어들이 프로세서에 의해서 실행됨으로써 인공 신경망의 양자화 범위 가 결정될 수 있다. 시스템 메모리는 휘발성 메모리 및 비휘발성 메모리 중 적어도 하나를 포함할 수 있다. 휘발성 메모리는 SRAM(Static Random Access Memory) 또는 DRAM(Dynamic Random Access Memory) 등을 포함하고, 비휘발성 메모 리는 플래시 메모리(flash memory) 등을 포함한다. 프로세서는 적어도 하나의 명령어들을 실행할 수 있는 적어도 하나의 코어를 포함할 수 있다. 프로세서 는 시스템 메모리에 저장된 명령어들을 실행할 수 있으며, 명령어들을 실행함으로써 인공 신경망의 양자화 범위를 결정하는 방법을 수행할 수 있다. 스토리지는 연산 장치에 공급되는 전력이 차단되더라도 저장된 데이터를 유지한다. 예를 들면, 스토리 지는 EEPROM(Electrically Erasable Programmable Read-Only Memory), 플래시 메모리(flash memory), PRAM(Phase Change Random Access Memory), RRAM(Resistance Random Access Memory), NFGM(Nano Floating Gate Memory) 등과 같은 비휘발성 메모리를 포함할 수도 있고, 자기 테이프, 광학 디스크, 자기 디스크와 같은 저장 매체를 포함할 수도 있다. 일부 실시예들에서, 스토리지는 연산 장치로부터 탈착 가능할 수도 있 다.본 발명의 일 실시예에 의하면, 스토리지는 복수의 레이어를 포함하는 신경망의 파라미터에 양자화를 수행 하는 프로그램을 저장할 수 있다. 스토리지에 저장된 프로그램은 프로세서에 의해서 실행되기 이전에 시스템 메모리로 로딩될 수 있다. 스토리지는 프로그램 언어로 작성된 파일을 저장할 수 있고, 파일 로부터 컴파일러 등에 의해서 생성된 프로그램은 시스템 메모리로 로딩될 수 있다. 스토리지는 프로세서에 의해서 처리될 데이터 및 프로세서에 의해서 처리된 데이터를 저장할 수 있다. 입출력 인터페이스는 키보드, 마우스 등과 같은 입력 장치를 포함할 수 있고, 디스플레이 장치, 프린터 등 과 같은 출력 장치를 포함할 수 있다. 사용자는 입출력 인터페이스를 통해 프로세서에 의한 프로그램의 실행을 트리거할 수도 있다. 또한, 사용자는 입출력 인터페이스를 통해 목표 포화 비율을 설정할 수 있다. 통신 인터페이스는 외부 네트워크에 대한 액세스를 제공한다. 예를 들면, 연산 장치는 통신 인터페이 스를 통해 다른 장치들과 통신할 수 있다. 한편, 연산 장치는 데스크탑 컴퓨터, 서버, AI 가속기 등과 같은 고정형(stationary) 컴퓨팅 장치뿐만 아니 라, 랩탑 컴퓨터, 스마트 폰 등과 같은 휴대용(mobile) 컴퓨팅 장치일 수도 있다. 연산 장치에 포함된 관측기와 제어기는 프로세서에 의해서 실행되는 복수의 명령어들의 집합으로서 프로시 저일 수 있고, 프로세서에 의해서 접근 가능한 메모리에 저장될 수 있다. 도 8은 본 발명의 일 실시예에 따른 양자화 방법을 설명하기 위해 예시한 순서도다. 본 발명의 일 실시예에 따른 양자화 방법은 배치 정규화가 적용된 신경망에 적용된다. 도 8을 참조하면, 본 발명의 일 실시예에 따른 양자화 장치는 제1 레이어에 연결된 제2 레이어 내 파라미터들을 획득한다(S800). 신경망 연산 시, 제2 레이어에 포함된 파라미터들은 배치 정규화 파라미터에 기초하여 조정되는 값들이다. 제2 레이어의 조정된 파라미터들이 제1 레이어의 출력들과 연산된다. 양자화 장치는 제1 레이어로부터 출력되는 제1 레이어의 출력값들 또는 제2 레이어 내 파라미터들에 적용되는 배치 정규화 파라미터들 중 어느 하나를 기반으로 파라미터들 중 적어도 하나의 파라미터를 제거한다(S802). 본 발명의 일 실시예에 의하면, 양자화 장치는 제1 레이어의 출력 채널들 중 출력값들을 모두 제로 값으로 출력 하는 채널을 식별하고, 제2 레이어의 파라미터들 중 상기 식별된 채널을 통해 출력되는 출력값에 적용되는 적어 도 하나의 파라미터를 제거한다. 본 발명의 다른 실시예에 의하면, 양자화 장치는 제1 레이어의 출력 채널들 중 논제로 출력값들의 개수가 기 설 정된 개수보다 적은 채널을 식별하고, 제2 레이어의 파라미터들 중 상기 식별된 채널을 통해 출력되는 출력값들 에 적용되는 적어도 하나의 파라미터를 제거한다. 본 발명의 다른 실시예에 의하면, 양자화 장치는 제1 레이어의 출력 채널들 중 기 설정된 값보다 작은 값을 가 지는 출력값들의 개수가 기 설정된 개수보다 적은 채널을 식별하고, 식별된 채널을 통해 출력되는 출력값들에 적용되는 적어도 하나의 파라미터를 제거한다. 본 발명의 다른 실시예에 의하면, 양자화 장치는 배치 정규화 파라미터들 중 기 설정된 조건을 충족하는 배치 정규화 파라미터를 식별하고, 제2 레이어의 파라미터들 중 상기 식별된 배치 정규화 파라미터와 연관된 적어도 하나의 파라미터를 제거한다. 여기서, 기 설정된 조건을 충족하는 파라미터를 식별하는 것은 양자화 장치가 배 치 정규화 파라미터들 중 기 설정된 값보다 큰 값을 가지는 배치 정규화 파라미터를 식별하는 것이다. 또한, 파 라미터의 제거란 파라미터 값을 제로 값으로 설정하는 것을 의미한다. 아니면, 파라미터의 제거는 파라미터의 변수를 삭제하는 것을 의미하거나 파라미터 값을 0에 가까운 값으로 설정하는 것을 의미할 수 있다. 이후, 양자화 장치는 제거 과정에서 생존한 파라미터들에 기초하여, 제2 레이어 내 파라미터들을 양자화한다 (S804). 양자화 장치는 최댓값 기반 양자화, 평균제곱오차 기반 양자화, 또는 클리핑 기반 양자화 등을 통해 제2 레이어 내 파라미터들을 양자화할 수 있다.도 8에서는 과정 S800 내지 과정 S804을 순차적으로 실행하는 것으로 기재하고 있으나, 이는 본 발명의 일 실시 예의 기술 사상을 예시적으로 설명한 것에 불과한 것이다. 다시 말해, 본 발명의 일 실시예가 속하는 기술 분야 에서 통상의 지식을 가진 자라면 본 발명의 일 실시예의 본질적인 특성에서 벗어나지 않는 범위에서 도 6에 기 재된 순서를 변경하여 실행하거나 과정 S800 내지 과정 S804 중 하나 이상의 과정을 병렬적으로 실행하는 것으 로 다양하게 수정 및 변형하여 적용 가능할 것이므로, 도 8은 시계열적인 순서로 한정되는 것은 아니다. 한편, 도 8에 도시된 과정들은 컴퓨터로 읽을 수 있는 기록매체에 컴퓨터가 읽을 수 있는 코드로서 구현하는 것 이 가능하다. 컴퓨터가 읽을 수 있는 기록매체는 컴퓨터 시스템에 의하여 읽혀질 수 있는 데이터가 저장되는 모 든 종류의 기록장치를 포함한다. 즉, 이러한 컴퓨터가 읽을 수 있는 기록매체는 ROM, RAM, CD-ROM, 자기 테이 프, 플로피디스크, 광 데이터 저장장치 등의 비일시적인(non-transitory) 매체를 포함한다. 또한 컴퓨터가 읽을 수 있는 기록매체는 네트워크로 연결된 컴퓨터 시스템에 분산되어 분산방식으로 컴퓨터가 읽을 수 있는 코드가 저장되고 실행될 수 있다. 이상의 설명은 본 실시예의 기술 사상을 예시적으로 설명한 것에 불과한 것으로서, 본 실시예가 속하는 기술 분 야에서 통상의 지식을 가진 자라면 본 실시예의 본질적인 특성에서 벗어나지 않는 범위에서 다양한 수정 및 변 형이 가능할 것이다. 따라서, 본 실시예들은 본 실시예의 기술 사상을 한정하기 위한 것이 아니라 설명하기 위 한 것이고, 이러한 실시예에 의하여 본 실시예의 기술 사상의 범위가 한정되는 것은 아니다. 본 실시예의 보호 범위는 아래의 청구범위에 의하여 해석되어야 하며, 그와 동등한 범위 내에 있는 모든 기술 사상은 본 실시예의 권리범위에 포함되는 것으로 해석되어야 할 것이다."}
{"patent_id": "10-2021-0102758", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 신경망의 양자화를 설명하기 위해 예시한 도면이다. 도 2는 가중치 분포에 기반한 양자화 결과를 예시한 도면이다. 도 3a 및 도 3b는 이상치를 포함하는 가중치 분포에 기반한 양자화를 설명하기 위해 예시한 도면이다. 도 4는 본 발명의 일 실시예에 따른 양자화를 설명하기 위해 예시한 도면이다. 도 5a 및 도 5b는 본 발명의 일 실시예에 따른 신경망의 양자화를 설명하기 위해 예시한 도면이다. 도 6은 본 발명의 일 실시예에 따른 액티베이션에 기반한 양자화 결과를 예시한 도면이다. 도 7은 본 발명의 일 실시예에 따른 양자화를 위한 연산 장치의 구성도다. 도 8은 본 발명의 일 실시예에 따른 양자화 방법을 설명하기 위해 예시한 순서도다."}
