{"patent_id": "10-2023-0091585", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2025-0011328", "출원번호": "10-2023-0091585", "발명의 명칭": "차등순서 학습 기반 딥러닝 모델 학습 방법 및 그 장치", "출원인": "고려대학교 산학협력단", "발명자": "곽진태"}}
{"patent_id": "10-2023-0091585", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "(a) 피감수 샘플과 감수 샘플을 트랜스포머 기반 암 유형 분류 모델의 특징 추출기에 적용하여 피감수 샘플 특징 벡터와 감수 샘플 특징 벡터를 각각 추출하는 단계;(b) 상기 피감수 샘플 특징 벡터를 상기 트랜스포머 기반 암 유형 분류 모델의 특징 추출기 후단에 위치된 범주분류기에 적용하여 암 유형 분류 결과를 출력하는 단계; 및(c) 상기 피감수 샘플 특징 벡터와 상기 감수 샘플 특징 벡터를 상기 트랜스포머 기반 암 유형 분류 모델의 특징 추출기 후단에 위치된 차등순서 분류기에 적용하여 차등 순서 레이블을 예측하는 단계; 및 (d) 상기 암 유형 분류 결과와 상기 예측된 차등 순서 레이블을 이용하여 상기 피감수 샘플이 상기 감수 샘플과의 차등 순서 관계가 유지되는 특징 공간에 매핑되도록 상기 특징 추출기, 상기 범주 분류기, 상기 차등순서 분류기의 파라미터를 갱신하는 단계를 포함하는 차등순서 학습 기반 딥러닝 모델 학습 방법."}
{"patent_id": "10-2023-0091585", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1 항에 있어서, 상기 (c) 단계는,상기 피감수 샘플 특징 벡터와 상기 감수 샘플 특징 벡터의 차분 특징 벡터를 생성하고, 상기 차분 특징 벡터를상기 차등순서 분류기에 적용하여 상기 피감수 샘플 레이블과 상기 감수 샘플 레이블간 차등 순서 레이블을 예측하되,상기 차등순서 분류기는 상기 차분 특징 벡터를 활용하여 차등 순서 레이블을 회귀(regression)을 통해 예측하는 것을 특징으로 하는 차등순서 학습 기반 딥러닝 모델 학습 방법."}
{"patent_id": "10-2023-0091585", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1 항에 있어서, 상기 암 유형 분류 결과는 암 유형 클래스 레이블이되, 상기 차등 순서 레이블은 상기 피감수 샘플의 암 유형 클래스 레이블과 상기 감수 샘플의 암 유형 클래스 레이블의 높고 낮음을 나타내는 부호와 상기 피감수 샘플의 암 유형 클래스 레이블과 상기 감수 샘플의 암 유형 클래스 레이블 간의 차이 정도에 대한 숫자로 표현되는 것을 특징으로 하는 차등순서 학습 기반 딥러닝 모델 학습방법."}
{"patent_id": "10-2023-0091585", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제1 항에 있어서, 상기 (d) 단계에서, 상기 암 유형 분류 결과와 상기 예측된 차등 순서 레이블을 이용하여 상기 피감수 샘플이 상기 감수 샘플과의차등 순서 관계가 유지되는 특징 공간에 매핑하기 위한 목적함수는 하기 수학식으로 계산되는 것을 특징으로 하는 차등순서 학습 기반 딥러닝 모델 학습 방법.공개특허 10-2025-0011328-3-여기서, 은 범주 분류기의 손실 함수로 크로스 엔트로피 손실 함수로 계산되며, 는 차등 순서분류기의 손실 함수를 나타내고, 는 범주 분류기의 손실 함수와 차등 순서 분류기의 손실 함수의 스케일 차이를 줄이기 위한 가중치임."}
{"patent_id": "10-2023-0091585", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제4 항에 있어서, 상기 차등 순서 분류기의 손실 함수는 음의 절대 로그-우도 손실 함수(negative absolute difference log-likelihood loss)로 계산하되, 상기 함수는 음의 절대 로그-우도 손실 함수는 하기 수학식을 이용하여 계산되는것을 특징으로 하는 차등순서 학습 기반 딥러닝 모델 학습 방법.여기서, 는 모든 가능한 입력 샘플 페어(pair)의 집합을 나타내고, 와 는 피감수 샘플 와감수 샘플 의 실제 차등 순서 레이블과 예측된 차등 순서 레이블을 나타내며, 이고, 임."}
{"patent_id": "10-2023-0091585", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제1 항에 있어서, 상기 피감수 샘플과 상기 감수 샘플은 다른 병리 영상이되,상기 감수 샘플은 레퍼런스 병리 영상인 것을 특징으로 하는 차등순서 학습 기반 딥러닝 모델 학습 방법."}
{"patent_id": "10-2023-0091585", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "피감수 샘플과 감수 샘플을 입력받아 적용하여 피감수 샘플 특징 벡터와 감수 샘플 특징 벡터를 각각 추출하는특징 추출기;상기 특징 추출 모듈 후단에 위치되며, 상기 피감수 샘플 특징 벡터를 입력받아 암 유형 분류 결과를 출력하는범주 분류기; 및상기 특징 추출 모듈 후단에 위치되며, 상기 피감수 샘플 특징 벡터와 상기 감수 샘플 특징 벡터를 입력받아 차등 순서 레이블을 예측하는 차등 순서 분류기를 포함하되, 상기 암 유형 분류 결과와 상기 예측된 차등 순서 레이블을 이용하여 상기 피감수 샘플이 상기 감수 샘플과의차등 순서 관계가 유지되는 특징 공간에 매핑되도록 상기 인코더, 상기 범주 분류기, 상기 차등순서 분류기의파라미터가 갱신되는 것을 특징으로 하는 차등순서 학습 기반 딥러닝 모델 학습 장치.공개특허 10-2025-0011328-4-청구항 8 제7 항에 있어서, 상기 차등순서 분류기는 상기 피감수 샘플 특징 벡터와 상기 감수 샘플 특징 벡터의 차분 특징 벡터를 입력받은후 회귀(regression)을 통해 차등 순서 레이블을 예측하는 것을 특징으로 하는 차등순서 학습 기반 딥러닝 모델학습 장치."}
{"patent_id": "10-2023-0091585", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "차등순서 학습 기반 딥러닝 모델 학습 방법 및 그 장치가 개시된다. 차등순서 학습 기반 딥러닝 모델 학습 방법 은 (a) 피감수 샘플과 감수 샘플을 트랜스포머 기반 암 유형 분류 모델의 특징 추출기에 적용하여 피감수 샘플 특징 벡터와 감수 샘플 특징 벡터를 각각 추출하는 단계; (b) 상기 피감수 샘플 특징 벡터를 상기 트랜스포머 기 (뒷면에 계속)"}
{"patent_id": "10-2023-0091585", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 차등순서 학습 기반 딥러닝 모델 학습 방법 및 그 장치에 관한 것이다."}
{"patent_id": "10-2023-0091585", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "암은 전 세계적으로 주요한 사망 원인 중 하나이다. 암이 의심되면 생검 또는 수술을 통해 조직 표본을 채취하 고, 염색한 후 현미경을 사용하여 병리학자가 평가한다. 의학 분야도 많은 기술적 발전이 있었지만 조직 표본에 대한 수동 조직학적 평가를 통해 진단이 수행되고 있다. 최근에는 인공지능 기술을 활용하여 암 유형을 분류하기 위한 연구가 진행되고 있으나, 종래 기술들은 암 유형 분류를 범주형 분류 문제로 해결하고 있다. 즉, 디지털 병리 이미지로부터 유형 분류에 적절한 특징 정보를 추 출하여 분류하는 기술이 존재하나 이는 다양한 암 유형의 암 이미지를 서로 독립적으로 취급하는데 그치고 있다."}
{"patent_id": "10-2023-0091585", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명은 차등순서 학습 기반 딥러닝 모델 학습 방법 및 그 장치를 제공하기 위한 것이다. 또한, 본 발명은 암 진행 정도에 따른 암 유형간의 관계성을 파악하여 딥러닝 모델을 학습시킴으로써 암 유형 분류 정확도를 높일 수 있는 차등순서 학습 기반 딥러닝 모델 학습 방법 및 그 장치를 제공하기 위한 것이다."}
{"patent_id": "10-2023-0091585", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명의 일 측면에 따르면, 차등순서 학습 기반 딥러닝 모델 학습 방법이 제공된다. 본 발명의 일 실시예에 따르면, (a) 피감수 샘플과 감수 샘플을 트랜스포머 기반 암 유형 분류 모델의 인코더에 적용하여 피감수 샘플 특징 벡터와 감수 샘플 특징 벡터를 각각 추출하는 단계; (b) 상기 피감수 샘플 특징 벡 터를 상기 트랜스포머 기반 암 유형 분류 모델의 인코더 후단에 위치된 범주 분류기에 적용하여 암 유형 분류 결과를 출력하는 단계; 및 (c) 상기 피감수 샘플 특징 벡터와 상기 감수 샘플 특징 벡터를 상기 트랜스포머 기 반 암 유형 분류 모델의 인코더 후단에 위치된 차등순서 분류기에 적용하여 차등 순서 레이블을 예측하는 단계; 및 (d) 상기 암 유형 분류 결과와 상기 예측된 차등 순서 레이블을 이용하여 상기 피감수 샘플이 상기 감수 샘 플과의 차등 순서 관계가 유지되는 특징 공간에 매핑되도록 상기 인코더, 상기 범주 분류기, 상기 차등순서 분 류기의 파라미터를 갱신하는 단계를 포함하는 차등순서 학습 기반 딥러닝 모델 학습 방법이 제공될 수 있다. 상기 (c) 단계는, 상기 피감수 샘플 특징 벡터와 상기 감수 샘플 특징 벡터의 차분 특징 벡터를 생성하고, 상기 차분 특징 벡터를 상기 차등순서 분류기에 적용하여 상기 피감수 샘플 레이블과 상기 감수 샘플 레이블간 차등 순서 레이블을 예측하되, 상기 차등순서 분류기는 상기 차분 특징 벡터를 활용하여 차등 순서 레이블을 회귀 (regression)을 통해 예측할 수 있다. 상기 암 유형 분류 결과는 암 유형 클래스 레이블이되, 상기 차등 순서 레이블은 상기 피감수 샘플의 암 유형 클래스 레이블과 상기 감수 샘플의 암 유형 클래스 레이블의 높고 낮음을 나타내는 부호와 상기 피감수 샘플의 암 유형 클래스 레이블과 상기 감수 샘플의 암 유형 클래스 레이블 간의 차이 정도에 대한 숫자로 표현될 수 있 다. 상기 (d) 단계에서, 상기 암 유형 분류 결과와 상기 예측된 차등 순서 레이블을 이용하여 상기 피감수 샘플이 상기 감수 샘플과의 차등 순서 관계가 유지되는 특징 공간에 매핑하기 위한 목적함수는 하기 수학식으로 계산하 되,"}
{"patent_id": "10-2023-0091585", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 2, "content": "여기서, 은 범주 분류기의 손실 함수로 크로스 엔트로피 손실 함수로 계산되며, 는 차등 순서 분류기의 손실 함수를 나타내고, 는 범주 분류기의 손실 함수와 차등 순서 분류기의 손실 함수의 스케일 차 이를 줄이기 위한 가중치이며, 상기 차등 순서 분류기의 손실 함수는 음의 절대 로그-우도 손실 함수(negative absolute difference log- likelihood loss)로 계산하되, 상기 함수는 음의 절대 로그-우도 손실 함수는 하기 수학식을 이용하여 계산하되,"}
{"patent_id": "10-2023-0091585", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 3, "content": "여기서, 는 모든 가능한 입력 샘플 페어(pair)의 집합을 나타내고, 와 는 피감수 샘플 와 감수 샘플 의 실제 차등 순서 레이블과 예측된 차등 순서 레이블을 나타내며, 이 고, 이다. 상기 피감수 샘플과 상기 감수 샘플은 다른 병리 영상이되, 상기 감수 샘플은 레퍼런스 병리 영상일 수 있다. 본 발명의 다른 측면에 따르면, 차등순서 학습 기반 딥러닝 모델 학습 장치가 제공된다. 본 발명의 일 실시예에 따르면, 피감수 샘플과 감수 샘플을 입력받아 적용하여 피감수 샘플 특징 벡터와 감수 샘플 특징 벡터를 각각 추출하는 특징 추출기; 상기 특징 추출 모듈 후단에 위치되며, 상기 피감수 샘플 특징 벡터를 입력받아 암 유형 분류 결과를 출력하는 범주 분류기; 및 상기 특징 추출 모듈 후단에 위치되며, 상기 피감수 샘플 특징 벡터와 상기 감수 샘플 특징 벡터를 입력받아 차등 순서 레이블을 예측하는 차등 순서 분류기 를 포함하되, 상기 암 유형 분류 결과와 상기 예측된 차등 순서 레이블을 이용하여 상기 피감수 샘플이 상기 감 수 샘플과의 차등 순서 관계가 유지되는 특징 공간에 매핑되도록 상기 인코더, 상기 범주 분류기, 상기 차등순 서 분류기의 파라미터가 갱신되는 것을 특징으로 하는 암 유형 분류를 위한 딥러닝 모델 학습 장치가 제공될 수 있다. 상기 차등순서 분류기는 상기 피감수 샘플 특징 벡터와 상기 감수 샘플 특징 벡터의 차분 특징 벡터를 입력받은 후 회귀(regression)을 통해 차등 순서 레이블을 예측할 수 있다."}
{"patent_id": "10-2023-0091585", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명의 일 실시예에 따른 차등순서 학습 기반 딥러닝 모델 학습 방법 및 그 장치를 제공함으로써, 암 진행 정도에 따른 암 유형간의 관계성을 파악하여 딥러닝 모델을 학습시킴으로써 암 유형 분류 정확도를 높일 수 있다."}
{"patent_id": "10-2023-0091585", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "본 명세서에서 사용되는 단수의 표현은 문맥상 명백하게 다르게 뜻하지 않는 한, 복수의 표현을 포함한다. 본 명세서에서, \"구성된다\" 또는 \"포함한다\" 등의 용어는 명세서상에 기재된 여러 구성 요소들, 또는 여러 단계들 을 반드시 모두 포함하는 것으로 해석되지 않아야 하며, 그 중 일부 구성 요소들 또는 일부 단계들은 포함되지 않을 수도 있고, 또는 추가적인 구성 요소 또는 단계들을 더 포함할 수 있는 것으로 해석되어야 한다. 또한, 명 세서에 기재된 \"...부\", \"모듈\" 등의 용어는 적어도 하나의 기능이나 동작을 처리하는 단위를 의미하며, 이는 하드웨어 또는 소프트웨어로 구현되거나 하드웨어와 소프트웨어의 결합으로 구현될 수 있다. 이하, 첨부된 도면들을 참조하여 본 발명의 실시예를 상세히 설명한다. 도 1은 본 발명의 일 실시예에 따른 암 유형 분류를 위한 차등순서 학습 기반 딥러닝 모델 학습 방법을 나타낸 순서도이고, 도 2는 본 발명의 일 실시예에 따른 트랜스포머 기반 암 유형 분류 모델의 내부 구조를 도시한 도 면이며, 도 3은 실제 차등 순서 레이블을 생성하는 방법을 나타낸 순서도이며, 도 4는 차등 순서 레이블 생성을 설명하기 위해 도시한 도면이고, 도 5 내지 도 7은 종래와 본 발명의 일 실시예에 따른 암 분류 결과를 비교한 도면이고, 도 8은 본 발명의 일 실시예에 따른 암 유형 분류를 위한 차등순서 학습 기반 딥러닝 모델 학습 방법 에 대한 의사 코드를 도시한 도면이다. 단계 110에서 딥러닝 모델 학습 장치는 피감수 샘플과 감수 샘플을 트랜스포머 기반 암 유형 분류 모델에 적용하여 피감수 샘플 특징 벡터와 감수 샘플 특징 벡터를 각각 추출한다. 트랜스포머 기반 암 유형 분류 모델은 도 2에 도시된 바와 같이, 특징 추출기( ), 범주 분류기 ( ) 및 차등 순서 분류기( )를 포함하여 구성된다. 예를 들어, N개의 트레이닝 데이터 세트를 라고 가정하기로 한다. 는 i번째 입 력 샘플(즉, 병리 영상)을 나타내고, 는 차등 순서를 정의한 실 제 클래스 레이블을 나타낸다. 또한, 는 레이블의 서수를 나타낸다. 즉, 와 같이 나타낼 수 있다.본 발명의 일 실시예에 따르면, 트랜스포머 기반 암 유형 분류 모델은 입력 샘플(즉, 피감수 샘플)을 입력 샘플 간의 차등 순서 관계가 유지되는 고차원 특징 공간( )에 매핑함으로써 정확하고 신뢰할 수 있는 암 분류를 수행하도록 학습될 수 있다. 이를 수학식으로 나타내면, 수학식 1과 같이 나타낼 수 있다. 수학식 1"}
{"patent_id": "10-2023-0091585", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "여기서, 는 손실 함수를 나타내고, 는 모델 의 학습 가능한 파라미터 세트를 나타낸다. 피감수 샘플로 지정된 입력 샘플( )이 입력되면, 딥러닝 모델 학습 장치는 피감수 샘플을 특징 추출기 ( )에 적용하여 피감수 샘플에 대한 특징 벡터( )를 추출할 수 있다. 또한, 딥러닝 모델 학습 장치는 감수 샘플로 지정된 입력 샘플 풀"}
{"patent_id": "10-2023-0091585", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "에서 피감수 샘플과 비교할 다른 샘플을 선택한 후 특징 추출기에 적용하여 선택된 감수 샘플 에 대한 특징 벡터 를 추출할 수 있다. 특징 추출기는 길이 인 일련의 토큰을 생성하는 를 임베딩하는 초기 고차원 특징맵을 획득하기 위해 ResNet 모델을 채택한다. 이어, 특징 추출기는 클래스 토큰 을 토큰 임베딩에 통합하여 를 생성한다. 로컬 정보를 추가하기 위해, i번째의 모 든 홀수 및 짝수 차원에 및 을 추가하는 sin-cos 위치 임베딩을 채택할 수 있다. 이다. E+1 토큰 임베딩 은 트랜스포머 인코더에 대한 입력으로 사용된다. 트랜스포머 인코더는 MHSA(Multi-Head Self-Attention) 레이어와 FF(Feed-forward) 레이어를 활용하여 수학식 4와 같이 출력 특징 벡터 f를 생성한다.수학식 2"}
{"patent_id": "10-2023-0091585", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "수학식 3"}
{"patent_id": "10-2023-0091585", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 5, "content": "수학식 4"}
{"patent_id": "10-2023-0091585", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 6, "content": "여기서, LN은 정규화 레이어를 나타내고, 은 L번째 블록에서 클래스 토큰 에 해당하는 출력 임베 딩을 나타내며, L은 트랜스포머 인코더 블록의 개수를 나타낸다. L은 12로 설정될 수 있다. MHSA는 수학식 5와 같이 복수의 SA(self-attention)을 병렬로 수행할 수 있다. 수학식 5"}
{"patent_id": "10-2023-0091585", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 7, "content": "수학식 6"}
{"patent_id": "10-2023-0091585", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 8, "content": "여기서, 는 쿼리, 키 및 값 벡터를 나타내고, M은 병렬 SA의 개수를 나타내고, 이다. FF는 세개의 선형 레이어로 구성되며, 처음 두개 뒤에는 ReLU 레이어가 위치된다. 단계 115에서 딥러닝 모델 학습 장치는 피감수 샘플 특징 벡터를 트랜스포머 기반 암 유형 분류 모델의 인 코더 후단에 위치된 범주 분류기에 적용하여 암 유형 분류 결과를 출력한다. 이해와 설명의 편의를 도모하기 위해 범주 분류기에 대해 간략하게 설명하기로 한다. 범주 분류기( )는 선형 레이어, LeakyReLU 레이어, 선형 레이어, LeakyReLU 레이어, 뉴런을 가지 는 선형 레이어로 구성되며, 소프트맥스 함수가 뒤 따른다. 따라서, 범주 분류기( )는 특징 추출기( )에서 추출된 특징 벡터( )가 제공되면, 와 같이 해당 입력 샘플이 클래스(c)에 포함될 확률을 생성할 수 있다. 다시 정리하면, 피감수 샘플 특징 벡터를 트랜스포머 기반 암 유형 분류 모델의 인코더 후단에 위치된 범주 분 류기에 적용함으로써, 범주 분류기는 해당 피감수 샘플 특징 벡터가 클래스에 포함될 확률을 생성하여 암 유형 분류 결과를 출력할 수 있다. 즉, 해당 피감수 샘플 특징 벡터에 상응하는 암 유형 클래스 레이블(예를 들어, 암 등급)을 암 유형 분류 결과로서 출력할 수 있다. 이어, 단계 120에서 딥러닝 모델 학습 장치는 피감수 샘플 특징 벡터와 상기 감수 샘플 특징 벡터를 트랜 스포머 기반 암 유형 분류 모델의 인코더 후단에 위치된 차등순서 분류기에 적용하여 차등 순서 레이블을 예측 한다. 본 발명의 일 실시예에 따르면, 차등 순서 레이블은 두 입력 샘플(즉, 피감수 샘플과 감수 샘플 사이의 클래스 레이블의 차이(등급)일 수 있다. 이에 대해 보다 상세히 설명하기로 한다. 예를 들어, 차등 순서는 암의 순서 관계일 수 있으며, 클래스 레이블은 정상, 저 위험, 중 위험, 고 위험일 수 있다. 이때, 차등 순서는 피감수 샘플과 레퍼런스 샘플(즉, 감수 샘플) 사이의 클래스 레이블의 차이로, 두 샘 플이 가지는 등급 차이일 수 있다. 클래스 레이블 와 를 가지는 두개의 입력 샘플 와 을 가정하여 설명하기로 한다. 두 입력 샘플 와 사이의 차등 순서 관계는 수학식 7과 같이 정의될 수 있다. 수학식 7"}
{"patent_id": "10-2023-0091585", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 9, "content": "여기서, 는 임계값을 나타내고, , 는 암 등급과 같은 클래스 라벨이 가 더 높음, 같음, 낮음을 각각 나타낸다. 암 등급 사이에는 순서 관계가 있기 때문에 두 입력 샘플 간의 순서 관계는 암 유형 분류에 유익할 수 있다. 암 유형 사이에는 일정한 관계성이 존재한다. 예를 들어, 더 높은 등급의 암 유형일수록 더 나쁜 질병 상태를 의미하고, 중간 등급의 암 영상은 낮은 등급의 암 영상 보다 더 위험하지만 높은 등급의 암 영상에 비해서는 상 대적으로 덜 위험하다. 즉, 높은 등급의 암과 낮은 등급의 암 사이의 차이는 중간 등급의 암과 낮은 등급의 암 차이보다 훨씬 큰 것으로 간주되어야 한다. 따라서, 본 발명의 일 실시예에서는 입력 샘플 간의 차이 정도를 통합하기 위해 수학식 8과 같이 범주 클래스 레이블을 사용하여 두 샘플 간의 차등 순서 관계를 정의하고 활용한다. 수학식 8"}
{"patent_id": "10-2023-0091585", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 10, "content": "여기서, 는 차등 순서 비교기를 나타내고, 와 는 피감수 샘플과 클래스 레이블을 나타내고,"}
{"patent_id": "10-2023-0091585", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 11, "content": "와 는 감수 샘플과 클래스 레이블을 나타낸다. 는 두 입력 샘플 와 의 실제 차등 순서 관 계이며, 이다. 의 범위는 부터 이다. 즉, 의 크기는 피감수 샘플이 감수 샘플과 얼마나 다른지를 나타낸다. 의 부호는 두 샘플간의 순서 관계 를 지정할 수 있다. 양수, 음수 및 제로 는 순서 학습에서 에 대응할 수 있다. 따라서, 순서 관계는 차등 관계로부터 추론될 수 있다. 도 3은 실제 차등 순서 레이블을 생성하는 방법을 나타낸 순서도이며, 도 4는 차등 순서 레이블 생성을 설명하 기 위해 도시한 도면이다. 차등 순서 레이블을 생성하기 위해, 딥러닝 모델 학습 장치는 두개의 입력 샘플 (피감수 샘플, 감수 샘플)을 각각 입력받을 수 있다. 딥러닝 모델 학습 장치는 두 입력 샘플(피감수 샘플 과 감수 샘플) 각각에 대한 병리 전문의로부터 얻어진 암 유형 클래스 레이블 정보를 활용하여 두 입력 샘플 간 의 차등 순서 관계(레이블)을 생성할 수 있다. 차등 순서 관계(레이블)은 도 4에 도시된 바와 같이, 두 입력 샘플간의 암 유형 클래스 레이블의 높고 낮음을 나타내는 부호(+,-)와 두 샘플의 암 유형 클래스 레이블의 차이의 정도를 나타내는 숫자로 표현될 수 있다. 딥러닝 모델 학습 장치는 피감수 샘플 특징 벡터 와 감수 샘플 특징 벡터 가 주어지면, 피감수 샘플 특징 벡터 에서 감수 샘플 특징 벡터 를 빼서 차분 특징 벡터 를 도출한다. 이어, 딥러닝 모델 학습 장치는 차분 특징 벡터 를 차등 순서 분류기( )에 적용하여 피감수 샘플 과 감수 샘플 사이의 차등 순서 관계를 예측한다. 차등 순서 분류기( )는 1개의 뉴런이 있는 단일 선형 레이어를 포함할 수 있다. 학습 중 입력 샘플 배치 및 해당 범주 레이블 이 함께 제공된다. 여기서, 는 배치의 크기이다. 피감수 입력 샘플 의 경우 의 다른 모든 샘플들은 한번에 하나씩 감수 샘플로 선택되어 차분 특징 벡터를 계산하는데 사용된다. 따라서, 입력 샘플간의 쌍별 차등 순서 관계를 활용하여 특징 벡터 공간의 차이 정도에 따라 샘플을 재정렬할 수 있는 트랜스포머 기반 암 유형 분류 모델을 학습하여 범주 분류를 개선할 수 있다. 단계 125에서 딥러닝 모델 학습 장치는 암 유형 분류 결과와 예측된 차등 순서 레이블을 이용하여 피감수 샘플이 감수 샘플과의 차등 순서 관계가 유지되는 특징 공간에 매핑되도록 상기 인코더, 상기 범주 분류기, 상기 차등순서 분류기의 파라미터를 갱신한다. 단계 110 내지 단계 125는 반복적으로 수행될 수 있다. 즉, 딥러닝 모델 학습 장치는 범주 분류기와 차등 순서 분류기의 손실 함수를 각각 도출한 후 이를 합한 최종 손실 함수가 최소가 되도록 인코더, 범주 분류기, 차등 순서 분류기의 파라미터를 갱신한다. 도 8에는 트 랜스포머 기반 암 유형 분류 모델을 학습 과정에 대한 의사 코드가 예시되어 있다. 트랜스포머 기반 암 유형 분류 모델을 학습하기 위한 목적 함수는 수학식 9와 같다. 수학식 9"}
{"patent_id": "10-2023-0091585", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 12, "content": "여기서, 와 는 각각 범주 분류기와 차등 순서 분류기의 손실 함수를 나타내며, 는 두 손실 함수의 스케일 크기 차이를 줄이기 위한 가중치를 나타낸다. 손실 함수의 학습을 위해 수학식 10과 같은 크로스 엔트로피 손실 함수 를 적용한다. 수학식 10"}
{"patent_id": "10-2023-0091585", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 13, "content": "여기서, 이면 이고, 그렇지 않은 경우 이다. 또한, 은 입력 샘플 이 클래스 레이블 C에 속할 확률을 나타낸다. 차등 손실 함수 은 수학식 11과 같이 negative absolute difference log-likelihood loss 를 적용한다. 수학식 11"}
{"patent_id": "10-2023-0091585", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 14, "content": "여기서, 는 모든 가능한 입력 페어의 집합을 나타내고, 와 는 입력 샘플 와 의 실제 차등 순서 레이블과 예측된 차등 순서 레이블을 나타낸다. 이고, 이다. 도 5 내지 도 7은 종래와 본 발명의 일 실시예에 따른 암 분류 결과를 비교한 도면이다. 도 5 내지 도 7에서 보 여지는 바와 같이, 본 발명의 일 실시예에 따른 차등 순서 학습을 고려한 트랜스포머 기반 암 유형 분류 모델이 종래보다 다양한 등급의 암 조직을 높은 정확도로 식별하고, 보이지 않는 데이터에 대해 잘 적응할 수 있음을 알 수 있다. 도 9는 본 발명의 일 실시예에 따른 암 유형 분류를 위한 차등순서 학습 기반 딥러닝 모델 학습 장치의 내부 구 성을 개략적으로 도시한 도면이다. 도 9를 참조하면, 본 발명의 일 실시예에 따른 암 유형 분류를 위한 딥러닝 모델 학습 장치는 트랜스포머 기반 암 유형 분류 모델, 학습부, 메모리 및 프로세서를 포함하여 구성된다. 트랜스포머 기반 암 유형 분류 모델은 도 2를 참조하여 설명한 바와 같이, 특징 추출기, 범주 분류기 , 차등 순서 분류기를 포함하여 구성된다. 특징 추출기는 피감수 샘플과 감수 샘플을 입력받아 적용하여 피감수 샘플 특징 벡터와 감수 샘플 특징 벡 터를 각각 추출할 수 있다. 범주 분류기는 특징 추출 모듈 후단에 위치되며, 피감수 샘플 특징 벡터를 입력받아 암 유형 분류 결과(암 유형 클래스 레이블)을 출력한다. 차등 순서 분류기는 특징 추출 모듈 후단에 위치되며, 피감수 샘플 특징 벡터와 상기 감수 샘플 특징 벡터 를 입력받아 차등 순서 레이블을 예측한다. 차등 순서 레이블은 피감수 샘플의 암 유형 클래스 레이블과 감수 샘플의 암 유형 클래스 레이블의 높고 낮음을 나타내는 부호와 피감수 샘플의 암 유형 클래스 레이블과 상기 감수 샘플의 암 유형 클래스 레이블 간의 차이 정도에 대한 숫자로 표현될 수 있다. 차등 순서 분류기는 피감수 샘플 특징 벡터와 상기 감수 샘플 특징 벡터의 차분 특징 벡터를 입력받은 후 회귀(regression)을 통해 차등 순서 레이블을 예측할 수 있다. 학습부는 트레이닝 데이터 세트를 이용하여 트랜스포머 기반 암 유형 분류 모델을 학습하기 위한 수 단이다. 즉, 학습부는 암 유형 분류 결과와 예측된 차등 순서 레이블을 이용하여 상기 피감수 샘플이 상기 감수 샘플과의 차등 순서 관계가 유지되는 특징 공간에 매핑되도록 트랜스포머 기반 암 유형 분류 모델를 학습시킬 수 있다. 이에 대해서는 전술한 바와 동일하므로 중복되는 설명은 생략하기로 한다. 메모리는 본 발명의 일 실시예에 따른 암 유형 분류를 위한 딥러닝 모델 학습 방법을 수행하기 위한 명령 어를 저장한다. 프로세서는 본 발명의 일 실시예에 따른 암 유형 분류를 위한 딥러닝 모델 학습 장치의 내부 구성 요 소들(예를 들어, 트랜스포머 기반 암 유형 분류 모델, 학습부, 메모리 등)을 제어하기 위한 수 단이다. 본 발명의 실시 예에 따른 장치 및 방법은 다양한 컴퓨터 수단을 통하여 수행될 수 있는 프로그램 명령 형태로 구현되어 컴퓨터 판독 가능 매체에 기록될 수 있다. 컴퓨터 판독 가능 매체는 프로그램 명령, 데이터 파일, 데 이터 구조 등을 단독으로 또는 조합하여 포함할 수 있다. 컴퓨터 판독 가능 매체에 기록되는 프로그램 명령은 본 발명을 위하여 특별히 설계되고 구성된 것들이거나 컴퓨터 소프트웨어 분야 통상의 기술자에게 공지되어 사 용 가능한 것일 수도 있다. 컴퓨터 판독 가능 기록 매체의 예에는 하드 디스크, 플로피 디스크 및 자기 테이프 와 같은 자기매체(magnetic media), CD-ROM, DVD와 같은 광기록 매체(optical media), 플롭티컬 디스크 (floptical disk)와 같은 자기-광 매체(magneto-optical media) 및 롬(ROM), 램(RAM), 플래시 메모리 등과 같 은 프로그램 명령을 저장하고 수행하도록 특별히 구성된 하드웨어 장치가 포함된다. 프로그램 명령의 예에는 컴 파일러에 의해 만들어지는 것과 같은 기계어 코드뿐만 아니라 인터프리터 등을 사용해서 컴퓨터에 의해서 실행 될 수 있는 고급 언어 코드를 포함한다. 상술한 하드웨어 장치는 본 발명의 동작을 수행하기 위해 하나 이상의 소프트웨어 모듈로서 작동하도록 구성될 수 있으며, 그 역도 마찬가지이다. 이제까지 본 발명에 대하여 그 실시 예들을 중심으로 살펴보았다. 본 발명이 속하는 기술 분야에서 통상의 지식 을 가진 자는 본 발명이 본 발명의 본질적인 특성에서 벗어나지 않는 범위에서 변형된 형태로 구현될 수 있음을 이해할 수 있을 것이다. 그러므로 개시된 실시 예들은 한정적인 관점이 아니라 설명적인 관점에서 고려되어야 한다. 본 발명의 범위는 전술한 설명이 아니라 특허청구범위에 나타나 있으며, 그와 동등한 범위 내에 있는 모 든 차이점은 본 발명에 포함된 것으로 해석되어야 할 것이다."}
{"patent_id": "10-2023-0091585", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 일 실시예에 따른 암 유형 분류를 위한 차등순서 학습 기반 딥러닝 모델 학습 방법을 나타낸 순서도. 도 2는 본 발명의 일 실시예에 따른 트랜스포머 기반 암 유형 분류 모델의 내부 구조를 도시한 도면. 도 3은 실제 차등 순서 레이블을 생성하는 방법을 나타낸 순서도. 도 4는 차등 순서 레이블 생성을 설명하기 위해 도시한 도면. 도 5 내지 도 7은 종래와 본 발명의 일 실시예에 따른 암 분류 결과를 비교한 도면. 도 8은 본 발명의 일 실시예에 따른 암 유형 분류를 위한 차등순서 학습 기반 딥러닝 모델 학습 방법에 대한 의 사 코드를 도시한 도면. 도 9는 본 발명의 일 실시예에 따른 암 유형 분류를 위한 차등순서 학습 기반 딥러닝 모델 학습 장치의 내부 구 성을 개략적으로 도시한 도면."}
