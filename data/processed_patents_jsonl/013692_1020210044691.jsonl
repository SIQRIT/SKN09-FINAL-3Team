{"patent_id": "10-2021-0044691", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2022-0138696", "출원번호": "10-2021-0044691", "발명의 명칭": "이미지 분류 방법 및 장치", "출원인": "서울대학교산학협력단", "발명자": "안가온"}}
{"patent_id": "10-2021-0044691", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "입력 이미지의 클래스를 식별하도록 훈련된 강건한 분류 모델에 기반한 이미지 분류 방법으로서,상기 분류 모델의 특정 레이어에서 출력된 입력 이미지에 대한 특징맵을 추출하는 단계;컨볼루션 레이어에서 상기 특징맵의 통계 정보를 이용하여 상기 특징맵의 스타일 정보를 추출하는 단계;정규화 레이어에서 상기 스타일 정보를 적용하여 상기 특징맵을 대상으로 정규화를 수행하는 단계; 및상기 정규화된 특징맵을 기반으로 상기 입력 이미지의 레이블을 예측하는 단계를 포함하되,상기 특징맵을 추출하는 단계 내지 상기 정규화를 수행하는 단계는 설정 횟수 이상 연속으로 수행되도록 구성되고,상기 정규화 레이어 및 상기 컨볼루션 레이어는 훈련 이미지를 상기 훈련 이미지의 레이블로 분류하도록 훈련된학습 모델의 레이어들로서, 상기 정규화 레이어는 상기 학습 모델의 학습 시 상기 훈련 이미지에 스타일을 전이하는 스타일 이미지의 특징맵 및 상기 훈련 이미지의 특징맵을 입력으로 하여 정규화를 수행하는 레이어인,이미지 분류 방법."}
{"patent_id": "10-2021-0044691", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제 1 항에 있어서,상기 분류 모델은,클래스를 식별하기 위한 제 1 이미지 및 상기 제 1 이미지의 제 1 레이블을 제 1 네트워크에 입력하는 단계;상기 제 1 이미지에 대한 스타일 전이 정규화를 위한 제 2 이미지를 제 2 네트워크에 입력하는 단계;상기 제 1 네트워크의 특정 레이어에서 출력된 상기 제 1 이미지에 대한 콘텐츠 특징맵을 추출하는 단계;상기 제 2 네트워크의 특정 레이어에서 출력된 상기 제 2 이미지에 대한 스타일 특징맵을 추출하여 상기 스타일특징맵의 통계 정보를 이용해 상기 스타일 특징맵의 스타일 정보를 추출하는 단계;상기 스타일 정보를 상기 제 1 네트워크에 적용하여 상기 제 1 이미지에 대한 상기 콘텐츠 특징맵을 대상으로정규화를 수행하는 단계; 및상기 정규화된 제 1 이미지를 기반으로 상기 입력된 제 1 이미지의 제 1 레이블을 예측하도록 학습하는 단계를포함하는 훈련 페이즈(phase)에 의해 훈련된,이미지 분류 방법."}
{"patent_id": "10-2021-0044691", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제 2 항에 있어서,상기 스타일 정보는 상기 스타일 특징맵의 평균 및 표준 편차를 포함하고,상기 정규화를 수행하는 단계는,상기 콘텐츠 특징맵을 정규화하는 단계; 및상기 정규화된 콘텐츠 특징맵에 상기 스타일 특징맵의 표준 편차를 곱하고, 상기 스타일 특징맵의 평균을 가산하는 단계를 포함하는,공개특허 10-2022-0138696-3-이미지 분류 방법."}
{"patent_id": "10-2021-0044691", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제 2 항에 있어서,상기 분류 모델은,상기 제 1 이미지의 제 1 레이블을 입력하는 단계 내지 상기 정규화를 수행하는 단계는 설정 횟수 이상 연속으로 수행되도록 구성되는,이미지 분류 방법."}
{"patent_id": "10-2021-0044691", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제 4 항에 있어서,상기 분류 모델은,설정 횟수 이상 연속으로 수행되는 경우, 상기 스타일 정보를 상기 제 2 네트워크에 적용하여 상기 제 2 이미지에 대한 상기 스타일 특징맵을 대상으로정규화를 수행하는 단계를 더 포함하는 훈련 페이즈에 의해 훈련되며,상기 정규화된 제 2 이미지가 상기 제 2 네트워크의 다음 레이어에 입력되도록 구성되는,이미지 분류 방법."}
{"patent_id": "10-2021-0044691", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제 2 항에 있어서,상기 제 1 네트워크 및 상기 제 2 네트워크의 중간 레이어들은, 동일한 구조 및 동일한 파라미터가 적용되도록 구성되는,이미지 분류 방법."}
{"patent_id": "10-2021-0044691", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제 2 항에 있어서,상기 분류 모델은,상기 제 1 네트워크 및 상기 제 2 네트워크가 각각 손실함수를 통해 최적화되도록 구성되는,이미지 분류 방법."}
{"patent_id": "10-2021-0044691", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제 2 항에 있어서,상기 분류 모델은,상기 제 1 이미지의 제 1 레이블 및 상기 제 2 이미지의 제 2 레이블에 대한 레이블 스무딩(label smoothing)을수행하는 단계를 더 포함하는 훈련 페이즈에 의해 훈련되고,공개특허 10-2022-0138696-4-상기 레이블 스무딩은 다음 수식에 의해 수행되며,여기서, y는 제 1 레이블, y'는 제 2 레이블, α는 하이퍼 파라미터(hyper parameter)인,이미지 분류 방법."}
{"patent_id": "10-2021-0044691", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "입력 이미지의 클래스를 식별하도록 훈련된 강건한 분류 모델에 기반한 이미지 분류 장치로서,메모리; 및상기 메모리와 연결되고, 상기 메모리에 포함된 컴퓨터 판독 가능한 명령들을 실행하도록 구성된 적어도 하나의프로세서를 포함하고,상기 적어도 하나의 프로세서는,입력 이미지의 클래스를 식별하도록 훈련된 강건한 분류 모델에 기반한 이미지 분류 방법으로서,상기 분류 모델의 특정 레이어에서 출력된 입력 이미지에 대한 특징맵을 추출하는 동작,컨볼루션 레이어에서 상기 특징맵의 통계 정보를 이용하여 상기 특징맵의 스타일 정보를 추출하는 동작,정규화 레이어에서 상기 스타일 정보를 적용하여 상기 특징맵을 대상으로 정규화를 수행하는 동작, 및상기 정규화된 특징맵을 기반으로 상기 입력 이미지의 레이블을 예측하는 동작을 수행하도록 구성되며,상기 특징맵을 추출하는 동작 내지 상기 정규화를 수행하는 동작은 설정 횟수 이상 연속으로 수행되도록 구성되고,상기 정규화 레이어 및 상기 컨볼루션 레이어는 훈련 이미지를 상기 훈련 이미지의 레이블로 분류하도록 훈련된학습 모델의 레이어들로서, 상기 정규화 레이어는 상기 학습 모델의 학습 시 상기 훈련 이미지에 스타일을 전이하는 스타일 이미지의 특징맵 및 상기 훈련 이미지의 특징맵을 입력으로 하여 정규화를 수행하는 레이어인,이미지 분류 장치."}
{"patent_id": "10-2021-0044691", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제 9 항에 있어서,상기 분류 모델은,클래스를 식별하기 위한 제 1 이미지 및 상기 제 1 이미지의 제 1 레이블을 제 1 네트워크에 입력하는 단계;상기 제 1 이미지에 대한 스타일 전이 정규화를 위한 제 2 이미지를 제 2 네트워크에 입력하는 단계;상기 제 1 네트워크의 특정 레이어에서 출력된 상기 제 1 이미지에 대한 콘텐츠 특징맵을 추출하는 단계;상기 제 2 네트워크의 특정 레이어에서 출력된 상기 제 2 이미지에 대한 스타일 특징맵을 추출하여 상기 스타일특징맵의 통계 정보를 이용해 상기 스타일 특징맵의 스타일 정보를 추출하는 단계;상기 스타일 정보를 상기 제 1 네트워크에 적용하여 상기 제 1 이미지에 대한 상기 콘텐츠 특징맵을 대상으로정규화를 수행하는 단계; 및상기 정규화된 제 1 이미지를 기반으로 상기 입력된 제 1 이미지의 제 1 레이블을 예측하도록 학습하는 단계를포함하는 훈련 페이즈(phase)에 의해 훈련된,이미지 분류 장치.공개특허 10-2022-0138696-5-청구항 11 제 10 항에 있어서,상기 스타일 정보는 상기 스타일 특징맵의 평균 및 표준 편차를 포함하고,상기 분류 모델의 상기 정규화를 수행하는 단계는,상기 콘텐츠 특징맵을 정규화하는 단계; 및상기 정규화된 콘텐츠 특징맵에 상기 스타일 특징맵의 표준 편차를 곱하고, 상기 스타일 특징맵의 평균을 가산하는 단계를 포함하는,이미지 분류 장치."}
{"patent_id": "10-2021-0044691", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제 10 항에 있어서,상기 분류 모델은,상기 제 1 이미지의 제 1 레이블을 입력하는 단계 내지 상기 정규화를 수행하는 단계는 설정 횟수 이상 연속으로 수행되도록 구성되는,이미지 분류 장치."}
{"patent_id": "10-2021-0044691", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "제 12 항에 있어서,상기 분류 모델은,설정 횟수 이상 연속으로 수행되는 경우, 상기 스타일 정보를 상기 제 2 네트워크에 적용하여 상기 제 2 이미지에 대한 상기 스타일 특징맵을 대상으로정규화를 수행하는 단계를 더 포함하는 훈련 페이즈에 의해 훈련되며,상기 정규화된 제 2 이미지가 상기 제 2 네트워크의 다음 레이어에 입력되도록 구성되는,이미지 분류 장치."}
{"patent_id": "10-2021-0044691", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_14", "content": "제 10 항에 있어서,상기 제 1 네트워크 및 상기 제 2 네트워크의 중간 레이어들은, 동일한 구조 및 동일한 파라미터가 적용되도록 구성되는,이미지 분류 장치."}
{"patent_id": "10-2021-0044691", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_15", "content": "제 10 항에 있어서,상기 분류 모델은,상기 제 1 네트워크 및 상기 제 2 네트워크가 각각 손실함수를 통해 최적화되도록 구성되는,공개특허 10-2022-0138696-6-이미지 분류 장치."}
{"patent_id": "10-2021-0044691", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_16", "content": "제 10 항에 있어서,상기 분류 모델은,상기 제 1 이미지의 제 1 레이블 및 상기 제 2 이미지의 제 2 레이블에 대한 레이블 스무딩(label smoothing)을수행하는 단계를 더 포함하는 훈련 페이즈에 의해 훈련되고,상기 레이블 스무딩은 다음 수식에 의해 수행되며,여기서, y는 제 1 레이블, y'는 제 2 레이블, α는 하이퍼 파라미터(hyper parameter)인,이미지 분류 장치."}
{"patent_id": "10-2021-0044691", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "이미지 분류 방법 및 장치가 개시된다. 본 개시의 일 실시 예에 따른 이미지 분류 방법은, 입력 이미지의 클래스 를 식별하도록 훈련된 강건한 분류 모델에 기반한 이미지 분류 방법으로서, 분류 모델의 특정 레이어에서 출력된 입력 이미지에 대한 특징맵을 추출하는 단계와, 컨볼루션 레이어에서 특징맵의 통계 정보를 이용하여 특징맵의 스타일 정보를 추출하는 단계와, 정규화 레이어에서 스타일 정보를 적용하여 특징맵을 대상으로 정규화를 수행하 는 단계와, 정규화된 특징맵을 기반으로 입력 이미지의 레이블을 예측하는 단계를 포함할 수 있다."}
{"patent_id": "10-2021-0044691", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 개시는 인공신경망 네트워크에 AdaIN(Adaptive Instance Normalization) 기법을 적용하여 강건한 인공신경 망 추론이 가능하도록 한 분류기를 제공하는 이미지 분류 방법 및 장치에 관한 것이다."}
{"patent_id": "10-2021-0044691", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "일반적으로 학습된 인공신경망은 사람에게는 느껴지지 않을 정도의 미세한 입력 값 변화에도 그에 따른 출력 값 이 크게 바뀔 수 있다. 이러한 민감함을 악용하여, 작은 입력 값 교란(adversarial perturbation)을 통해 출력 값을 완전히 바꿔 오작동을 일으키는 행위를 적대적 공격(adversarial attack), 이러한 오작동을 일으키는 입력 값을 적대적 예시(adversarial example)라고 한다. 적대적 공격에 대한 취약함은 인공지능 기술을 의료/자율주행 등 오작동에 대한 리스크가 큰 분야에 적용하는 데에 큰 난관이 된다. 예를 들어, 악의적인 사람이 교통표지판에 대해 적대적 공격을 할 경우, 자율주행 자동차 에서 표지판을 잘못 인식하여 교통사고가 발생할 수 있다. 이에, 선행기술 1에 개시된 강건성을 높이기 위해 가장 널리 쓰이는 방법인 PGD(projected gradient descent) 기반 적대적 훈련 기법은 데이터 확장 기법(data augmentation)의 하나로, 훈련 데이터로부터 적대적 예시를 생 성한 후 이에 대한 손실 함숫값이 0에 가까워지도록 신경망을 훈련한다. 구체적으로, 매 훈련 데이터에 대해 그 데이터의 주변에서 손실 함숫값이 높아지는 데이터를 PGD로 찾아, 해당 데이터에 대해 인공신경망을 학습한다. 이 방법은 현재까지 나온 강건성 향상 기법 중 가장 성능이 뛰어나다고 볼 수 있다. 하지만 PGD 기반 적대적 훈련 기법은 적대적 예시를 생성하는 과정에서 PGD 방식으로 적대적 예시를 최적화하는 과정을 거치기 때문에 훈련 시간이 상당히 많이 든다는 문제가 있다. 구체적으로 일반 인공 신경망 훈련 기법보 다 필요한 연산량이 보통 10배 이상이다. 또한, 입력 이미지의 도메인에서 특정 거리 안의 적대적 예시만을 찾 기 때문에 생성되는 적대적 예시가 제한적이라는 문제가 있다. 이에 반해 선행기술 2에서는 거리 안의 적대적 예시를 찾는 데서 벗어나 스타일 전이(style transfer)를 활용하 여 한 이미지의 형태에 다른 이미지의 스타일이 입혀진(이미지의 통계적 특성을 다른 이미지에 합성하는 것으로 볼 수 있음), 새로운 데이터 셋을 만든다. 그리고 생성된 데이터 셋을 통해 인공신경망을 훈련하여 인공신경망 의 스타일에 대한 의존도를 낮춰줄 수 있다(즉, 형태를 더 많이 보도록 해준다). 이 기법은 style transfer를 통해 강건성을 향상시키고자 하는 것이나, style transfer 된 이미지를 입력 이미지 도메인에서 미리 만들어 저 장해야 한다는 문제가 있다. 또한, 해당 기존 기법은 날씨 변화, 밝기 변화 등 일반적인 노이즈에 대해서는 강"}
{"patent_id": "10-2021-0044691", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 2, "content": "건성을 키워주지만, 적대적 공격에 대해서는 강건성을 키워주지 못 한다는 문제가 있다.전술한 배경기술은 발명자가 본 발명의 도출을 위해 보유하고 있었거나, 본 발명의 도출 과정에서 습득한 기술 정보로서, 반드시 본 발명의 출원 전에 일반 공중에게 공개된 공지기술이라 할 수는 없다. 선행기술문헌 비특허문헌 (비특허문헌 0001) 선행기술 1: Madry et al., Towards Deep Learning Models Resistant to Adversarial Attacks, ICLR 2018 (비특허문헌 0002) 선행기술 2: Geirhos et al., ImageNet-trained CNNs are Biased Towards Texture; Increasing Shape Bias Improves Accuracy and Robustness, ICLR 2019"}
{"patent_id": "10-2021-0044691", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 개시의 실시 예의 일 과제는, 한 이미지에 다른 이미지의 스타일(색감, 질감 등)을 입혀주는 AdaIN(Adaptive instance normalization) 기법을 인공신경망 이미지 분류기에 적용하여, 분류기의 적대적 공격에 대한 강건성 (adversarial robustness)을 향상시키고자 하는데 있다. 본 개시의 실시 예의 일 과제는, 의도적으로 학습 모델의 학습 시 추론(inference) 중간 과정에서 다른 이미지 의 스타일 정보를 기존 입력 이미지의 스타일 정보와 섞어, 분류기가 입력 이미지를 인식할 때 스타일 정보에 집중하지 않도록 하여, 이미지의 작은 노이즈에 취약한 문제를 해결하고자 하는데 있다. 본 개시의 실시 예의 일 과제는, 인공신경망 네트워크의 중간중간에 BN(batch normalization) 레이어 대신에 AdaIN 레이어를 삽입하여, 한 이미지의 분류 과정에서 다른 이미지의 스타일이 입히도록 함으로써, 스타일 전이 를 통해 원본 이미지의 형태 정보는 남기고 스타일 정보만을 수정하여 거리 척도에 의존할 필요가 없도록 하는 데 있다. 본 개시의 실시 예의 일 과제는, 입력 값의 도메인에서 적대적 예시를 찾는 것이 아니라, 분류기의 인식 과정 중간에서 두 이미지의 정보를 바로 섞어줌으로써, 강건성 향상을 위한 훈련 비용이 감소되도록 하는데 있다. 본 개시의 실시 예의 일 과제는, 인공신경망을 활용하는 모든 컴퓨터 비전 애플리케이션, 특히 오작동으로 인한 리스크가 큰 의료/자율주행 등의 분야에 적용하여 인공지능 기술의 안정성을 높이고자 하는데 있다. 본 개시의 실시 예의 일 과제는, 시각처리 기반 인공지능 기술에 유연하게 적용하고자 하는 것으로, 특히 자율 주행이나 의료 등 임의의 환경에서 정확한 판단을 요구하는 산업 분야에 안정성이 높은 인공지능 기술로써 사용 가능하도록 하는데 있다. 본 개시의 실시 예의 일 과제는, 음성 스피커, 이미지 인식 등 현재 실제 서비스에 적용되고 있는 인공신경망에 미세 조정(fine-tuning) 기법으로 활용될 수 있도록 하고, 이미지 인식 외에 이미지 분할, 탐지 등의 분야에도 적용 가능하도록 하는데 있다. 본 개시의 실시 예의 목적은 이상에서 언급한 과제에 한정되지 않으며, 언급되지 않은 본 발명의 다른 목적 및 장점들은 하기의 설명에 의해서 이해될 수 있고, 본 발명의 실시 예에 의해 보다 분명하게 이해될 것이다. 또한, 본 발명의 목적 및 장점들은 특허 청구 범위에 나타낸 수단 및 그 조합에 의해 실현될 수 있음을 알 수 있을 것이다."}
{"patent_id": "10-2021-0044691", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 개시의 일 실시 예에 따른 이미지 분류 방법은, 인공신경망 이미지 분류기에 AdaIN 기법을 적용하여 적대적 공격에 대해 강건한 인공신경망 추론이 가능하도록 하는 단계를 포함할 수 있다.구체적으로 본 개시의 일 실시 예에 따른 이미지 분류 방법은, 입력 이미지의 클래스를 식별하도록 훈련된 강건 한 분류 모델에 기반한 이미지 분류 방법으로서, 분류 모델의 특정 레이어에서 출력된 입력 이미지에 대한 특징 맵을 추출하는 단계와, 컨볼루션 레이어에서 특징맵의 통계 정보를 이용하여 특징맵의 스타일 정보를 추출하는 단계와, 정규화 레이어에서 스타일 정보를 적용하여 특징맵을 대상으로 정규화를 수행하는 단계와, 정규화된 특 징맵을 기반으로 입력 이미지의 레이블을 예측하는 단계를 포함할 수 있다. 본 개시의 일 실시 예에 따른 이미지 분류 방법을 통하여, 분류기 중간중간에 AdaIN 레이어를 삽입해 한 이미지 의 분류 과정에서 다른 이미지의 스타일이 입히도록 함으로써, 스타일 전이(style transfer)를 통해 적대적 공 격에 대한 강건성을 향상시킬 수 있다. 이 외에도, 본 발명의 구현하기 위한 다른 방법, 다른 시스템 및 상기 방법을 실행하기 위한 컴퓨터 프로그램이 저장된 컴퓨터로 판독 가능한 기록매체가 더 제공될 수 있다. 전술한 것 외의 다른 측면, 특징, 이점이 이하의 도면, 특허청구범위 및 발명의 상세한 설명으로부터 명확해질 것이다."}
{"patent_id": "10-2021-0044691", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 개시의 실시 예에 의하면, 인공신경망 분류기의 학습 과정에서 한 이미지의 형태 정보에 다른 이미지의 스타 일 정보를 입히면서 분류 학습을 진행하여, 인공신경망이 이미지의 스타일 정보에 과하게 의존하지 않도록 함으 로써, 적대적 공격에 대한 내성이 있는, 즉 강건한 인공지능의 구축이 가능하도록 하여 사용자 만족도 및 성능 을 향상시킬 수 있다. 또한, 적대적 예시를 따로 입력값 도메인에서 최적화하는 과정을 거치지 않고 인공신경망의 forward pass 과정 에서 AdaIN 레이어를 활용함으로써, 강건성 향상에 필요한 연산량을 감소시킬 수 있다. 또한, 거리가 적은 적대적 예시만을 찾기 때문에 공격의 다양성이 한정적인 기존 방법과 달리, 스타일 이미지를 인공신경망 forward pass 과정에서 중간중간에 투입함으로써, 스타일 이미지의 다양성에 따라 적대적 공격의 양 상도 다양해지도록 할 수 있다. 또한, 입력 값의 도메인에서 적대적 예시를 찾는 것이 아니라, 분류기의 인식 과정 중간에서 두 이미지의 정보 를 바로 섞어줌으로써, 강건성 향상을 위한 훈련 비용을 감소시킬 수 있으며, 기존 방식 대비 성능은 유지하면 서 비용을 감소시켜 강건한 AI 도입을 촉진시킬 수 있다. 또한, 의료, 보안 시스템 산업 등 인간의 생명과 직접 연관이 있는 산업 분야의 인공지능 제품에 적용하여 작동 안정성을 높일 수 있다. 또한, 무인택배 드론, 자율주행차와 같이 변덕스러운 외부 환경에도 잘 작동해야 하는 인공지능 제품들에 적용 하여 작동 안정성 및 제품 신뢰도를 높일 수 있다. 또한, 이미지 인식과 관련된 모든 인공지능 제품(즉, 인공신경망을 활용하는 모든 컴퓨터 비전 어플리케이션)에 적용되도록 함으로써, 기술의 사업적 완성도를 향상시킬 수 있다."}
{"patent_id": "10-2021-0044691", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 2, "content": "본 발명의 효과는 이상에서 언급된 것들에 한정되지 않으며, 언급되지 아니한 다른 효과들은 아래의 기재로부터 당업자에게 명확하게 이해될 수 있을 것이다."}
{"patent_id": "10-2021-0044691", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "본 발명의 이점 및 특징, 그리고 그것들을 달성하는 방법은 첨부되는 도면과 함께 상세하게 설명되는 실시 예들 을 참조하면 명확해질 것이다. 그러나 본 발명은 아래에서 제시되는 실시 예들로 한정되는 것이 아니라, 서로 다른 다양한 형태로 구현될 수 있고, 본 발명의 사상 및 기술 범위에 포함되는 모든 변환, 균등물 내지 대체물을 포함하는 것으로 이해되어야"}
{"patent_id": "10-2021-0044691", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "한다. 아래에 제시되는 실시 예들은 본 발명의 개시가 완전하도록 하며, 본 발명이 속하는 기술분야에서 통상의 지식을 가진 자에게 발명의 범주를 완전하게 알려주기 위해 제공되는 것이다. 본 발명을 설명함에 있어서 관련 된 공지 기술에 대한 구체적인 설명이 본 발명의 요지를 흐릴 수 있다고 판단되는 경우 그 상세한 설명을 생략 한다. 본 출원에서 사용한 용어는 단지 특정한 실시 예를 설명하기 위해 사용된 것으로, 본 발명을 한정하려는 의도가 아니다. 단수의 표현은 문맥상 명백하게 다르게 뜻하지 않는 한, 복수의 표현을 포함한다. 본 출원에서, \"포함 하다\" 또는 \"가지다\" 등의 용어는 명세서상에 기재된 특징, 숫자, 단계, 동작, 구성요소, 부품 또는 이들을 조 합한 것이 존재함을 지정하려는 것이지, 하나 또는 그 이상의 다른 특징들이나 숫자, 단계, 동작, 구성요소, 부 품 또는 이들을 조합한 것들의 존재 또는 부가 가능성을 미리 배제하지 않는 것으로 이해되어야 한다. 제1, 제2 등의 용어는 다양한 구성요소들을 설명하는데 사용될 수 있지만, 구성요소들은 상기 용어들에 의해 한정되어서 는 안 된다. 상기 용어들은 하나의 구성요소를 다른 구성요소로부터 구별하는 목적으로만 사용된다. 이하, 본 발명에 따른 실시 예들을 첨부된 도면을 참조하여 상세히 설명하기로 하며, 첨부 도면을 참조하여 설 명함에 있어, 동일하거나 대응하는 구성요소는 동일한 도면번호를 부여하고 이에 대한 중복되는 설명은 생략하 기로 한다. 도 1은 본 개시의 일 실시 예에 따른 이미지 분류 시스템의 개략적인 예시도이다. 도 1에 도시된 바와 같이, 이미지 분류 시스템은 이미지 분류 장치, 사용자 단말, 서버 및 네트워크를 포함할 수 있다. 본 실시 예에서, 이미지 분류 시스템은 인공신경망 이미지 분류기에 관한 것으로, 한 이미지에 다른 이미지 의 스타일(색감, 질감 등)을 입혀주는 Adaptive instance normalization(AdaIN) 기법을 인공신경망 이미지 분 류기에 적용하여, 분류기의 적대적 공격에 대한 강건성(adversarial robustness)을 향상시킬 수 있도록 하는 것 을 특징으로 한다. 학습된 인공신경망은 사람에게는 느껴지지 않을 정도의 미세한 입력값 변화에도 그에 따른 출력값이 크게 바뀔 수 있다. 이러한 민감함을 악용하여, 작은 입력값 교란(adversarial perturbation)을 통해 출력값을 완전히 바 꿔 오작동을 일으키는 행위를 적대적 공격(adversarial attack), 이러한 오작동을 일으키는 입력값을 적대적 예 시(adversarial example)라고 한다. 특히, 적대적 공격에 대한 취약함은 인공지능 기술을 의료/자율주행 등 오 작동에 대한 리스크가 큰 분야에 적용하는 데에 큰 난관이 된다. 예를 들어, 악의적인 사람이 교통표지판에 대 해 적대적 공격을 할 경우, 자율주행 자동차가 표지판을 잘못 인식하여 교통사고를 일으킬 수 있다. 이에, 본 실시 예에서는, 적대적 공격에 대한 내성이 있는, 즉 강건(robust)한 인공지능을 구축하고자 하는 것으로, 구체적으로, 인공신경망 분류기의 학습 과정에서 한 이미지의 형태 정보에 다른 이미지의 스타일 정보를 입히면서 분류 학습을 진행하여, 인공신경망이 이미지의 스타일 정보에 과하게 의존하지 않도록 함으로써, 적대 적 예시에 대한 강건성이 향상되도록 할 수 있다. 즉 인공신경망이 인간보다 이미지의 작은 노이즈에 취약한 이유는 인공신경망이 이미지의 스타일 정보에 과하게 의존하기 때문이다. 이에 따라 본 실시 예에서는, 분류기가 입력 이미지를 인식할 때 스타일 정보에 집중하지 않도록, 의도적으로 추론(inference) 중간 과정에서 다른 이미지의 스타일 정보를 기존 입력 이미지의 스타일 정보와 섞어주고자 한다. 이를 위해 본 실시 예에서는, 구체적으로 인공신경망 네트워크의 중간중간에 batch normalization 레이어 대신에 adaptive Instance normalization 레이어를 삽입하여, 한 이미지의 분류 과정에 서 중간 다른 이미지의 스타일이 입히도록 할 수 있다. 종래의 강건성 향상방식은 적합한 적대적 예시를 찾기 위해 거리 정보에 의존하지만, 본 실시 예에서는 스타일 전이(style transfer)를 통해 원본 이미지의 형태 정보는 남기고 스타일 정보만을 수정하기 때문에 거리 척도에 의존할 필요가 없다. 또한, 기존의 style transfer 방식의 경우 입력값의 도메인에서 적대적 예시를 찾지만, 본 실시 예의 경우 분류기의 인식 과정 중간에서 두 이미지의 정보를 바로 섞어주므로 강건성 향상을 위한 훈련 비 용이 상당히 적게 소요될 수 있다.따라서 본 실시 예의 이미지 분류 시스템은 인공신경망을 활용하는 모든 컴퓨터 비전 애플리케이션에 부담 없이 적용될 수 있으며, 특히 오작동으로 인한 리스크가 큰 의료/자율주행 등의 분야에서 인공지능 기술의 안정 성을 높이기 위해 중요하게 사용될 수 있다. 즉 예를 들어, 입력값에 자연환경 등의 요인으로 인해 노이즈가 끼면 인공신경망이 잘못된 출력값을 내보내는 경우가 존재하기 때문에, 본 실시 예의 이미지 분류 시스템을 통해 인간의 생명과 직결된 의료, 자율주행 등 의 분야에서 오작동을 줄일 수 있다. 또한 본 실시 예의 이미지 분류 시스템은 예를 들어, 의료, 보안 시스 템 산업 등 인간의 생명과 직접 연관이 있는 산업 분야의 인공지능 제품에 적용하여 작동 안정성을 높일 수 있 고, 무인택배 드론, 자율주행차와 같이 변덕스러운 외부 환경에도 잘 작동해야 하는 인공지능 제품들에 적용하 여 안정성을 높일 수 있으며, 이외에도 이미지 인식과 관련된 모든 인공지능 제품에 적용할 수 있다 한편, 본 실시 예에서는, 사용자들이 사용자 단말에서 구현되는 어플리케이션 또는 웹사이트에 접속하여, 이미지 분류를 위한 이미지를 입력하거나 분류 모델을 학습하는 등의 과정을 수행할 수 있다. 이러한 사용자 단 말은 이미지 분류 어플리케이션 또는 이미지 분류 웹사이트에 접속한 후 인증 과정을 통하여 이미지 분류 서비스를 제공받을 수 있다. 인증 과정은 회원가입 등 사용자 정보를 입력하는 인증, 사용자 단말에 대한 인증 등을 포함할 수 있으나, 이에 한정되지 않고 이미지 분류 장치 및/또는 서버에서 전송되는 링크에 접 속하는 것만으로 인증 과정이 수행될 수도 있다. 본 실시 예에서, 사용자 단말은 사용자가 조작하는 데스크 탑 컴퓨터, 스마트폰, 노트북, 태블릿 PC, 스마 트 TV, 휴대폰, PDA(personal digital assistant), 랩톱, 미디어 플레이어, 마이크로 서버, GPS(global positioning system) 장치, 전자책 단말기, 디지털방송용 단말기, 네비게이션, 키오스크, MP3 플레이어, 디지털 카메라, 가전기기 및 기타 모바일 또는 비모바일 컴퓨팅 장치일 수 있으나, 이에 제한되지 않는다. 또한, 사용 자 단말은 통신 기능 및 데이터 프로세싱 기능을 구비한 시계, 안경, 헤어 밴드 및 반지 등의 웨어러블 단 말기 일 수 있다. 사용자 단말은 상술한 내용에 제한되지 아니하며, 웹 브라우징이 가능한 단말기는 제한 없이 차용될 수 있다. 한편, 본 실시 예에서 이미지 분류 시스템은 이미지 분류 장치 및/또는 서버에 의해 구현될 수 있 다. 서버는 이미지 분류 장치가 포함되는 이미지 분류 시스템을 운용하기 위한 서버일 수 있다. 또한 서버는 각종 인공 지능 알고리즘을 적용하는데 필요한 빅데이터와, 이미지 분류 장치를 동작시키는 데이터를 제공하는 데이터베이스 서버일 수 있다. 그 밖에 서버는 이미지 분류 시스템이 구현될 수 있 도록 하는 웹 서버 또는 어플리케이션 서버, 그리고 딥러닝 등의 인공지능 프로세스를 수행하는 학습 서버 등을 포함할 수 있다. 본 실시 예에서, 서버는 상술하는 서버들을 포함하거나 이러한 서버들과 네트워킹 할 수 있다. 특히, 본 실시 예에서, 서버는 이미지 분류 장치로부터 이미지 분류를 위한 이미지와 스타일을 입혀 주기 위한 이미지를 수신하고, AdaIN 분류 알고리즘을 적용하여, 입력 이미지의 실제 레이블을 유추할 수 있다. 네트워크는 이미지 분류 시스템에서 이미지 분류 장치, 서버 및 사용자 단말을 연결하 는 역할을 수행할 수 있다. 이러한 네트워크는 예컨대 LANs(local area networks), WANs(Wide area networks), MANs(metropolitan area networks), ISDNs(integrated service digital networks) 등의 유선 네트 워크나, 무선 LANs, CDMA, 블루투스, 위성 통신 등의 무선 네트워크를 망라할 수 있으나, 본 발명의 범위가 이 에 한정되는 것은 아니다. 또한 네트워크는 근거리 통신 및/또는 원거리 통신을 이용하여 정보를 송수신할 수 있다. 여기서 근거리 통신은 블루투스(bluetooth), RFID(radio frequency identification), 적외선 통신 (IrDA, infrared data association), UWB(ultra-wideband), ZigBee, Wi-Fi(Wireless fidelity) 기술을 포함할 수 있고, 원거리 통신은 CDMA(code division multiple access), FDMA(frequency division multiple access), TDMA(time division multiple access), OFDMA(orthogonal frequency division multiple access), SC- FDMA(single carrier frequency division multiple access) 기술을 포함할 수 있다. 네트워크는 허브, 브리지, 라우터, 스위치 및 게이트웨이와 같은 네트워크 요소들의 연결을 포함할 수 있 다. 네트워크는 인터넷과 같은 공용 네트워크 및 안전한 기업 사설 네트워크와 같은 사설 네트워크를 비롯 한 하나 이상의 연결된 네트워크들, 예컨대 다중 네트워크 환경을 포함할 수 있다. 네트워크에의 액세스는 하나 이상의 유선 또는 무선 액세스 네트워크들을 통해 제공될 수 있다. 더 나아가 네트워크는 사물 등 분 산된 구성 요소들 간에 정보를 주고받아 처리하는 IoT(Internet of Things, 사물인터넷) 망 및/또는 5G 통신을지원할 수 있다. 한편, 도 2에 도시된 바와 같이, 이미지 분류 장치는 메모리, 통신부, 프로세서 및 사용자 인터페이스를 포함할 수 있다. 메모리는 이미지 분류 장치의 동작에 필요한 각종 정보들을 저장하고, 이미지 분류 장치를 동작 시킬 수 있는 제어 소프트웨어를 저장할 수 있는 것으로, 휘발성 또는 비휘발성 기록 매체를 포함할 수 있다. 메모리는 하나 이상의 프로세서와 연결되는 것으로, 프로세서에 의해 실행될 때, 프로세서(13 0)로 하여금 이미지 분류 장치를 제어하도록 야기하는(cause) 코드들을 저장할 수 있다. 여기서, 메모리는 자기 저장 매체(magnetic storage media) 또는 플래시 저장 매체(flash storage medi a)를 포함할 수 있으나, 본 발명의 범위가 이에 한정되는 것은 아니다. 이러한 메모리는 내장 메모리 및/ 또는 외장 메모리를 포함할 수 있으며, DRAM, SRAM, 또는 SDRAM 등과 같은 휘발성 메모리, OTPROM(one time programmable ROM), PROM, EPROM, EEPROM, mask ROM, flash ROM, NAND 플래시 메모리, 또는 NOR 플래시 메모리 등과 같은 비휘발성 메모리, SSD. CF(compact flash) 카드, SD 카드, Micro-SD 카드, Mini-SD 카드, Xd 카드, 또는 메모리 스틱(memory stick) 등과 같은 플래시 드라이브, 또는 HDD와 같은 저장 장치를 포함할 수 있다. 특히, 본 실시 예에서, 메모리에는 본 개시에 따른 신경망 모델, 신경망 모델을 이용하여 본 개시의 다양 할 실시 예를 구현할 수 있도록 구현된 모듈이 저장될 수 있다. 그리고, 메모리에는 본 개시에 따른 학습 을 수행하기 위한 알고리즘에 관련된 정보가 저장될 수 있다. 그 밖에도 본 개시의 목적을 달성하기 위한 범위 내에서 필요한 다양한 정보가 메모리에 저장될 수 있으며, 메모리에 저장된 정보는 서버 또는 외부 장치로부터 수신되거나 사용자에 의해 입력됨에 따라 갱신될 수도 있다. 통신부는 네트워크와 연동하여 외부 장치(서버를 포함) 간의 송수신 신호를 패킷 데이터 형태로 제공 하는 데 필요한 통신 인터페이스를 제공할 수 있다. 또한 통신부는 다른 네트워크 장치와 유무선 연결을 통해 제어 신호 또는 데이터 신호와 같은 신호를 송수신하기 위해 필요한 하드웨어 및 소프트웨어를 포함하는 장치일 수 있다. 이러한 통신부는 각종 사물 지능 통신(IoT(internet of things), IoE(internet of everything), IoST(internet of small things) 등)을 지원할 수 있으며, M2M(machine to machine) 통신, V2X(vehicle to everything communication) 통신, D2D(device to device) 통신 등을 지원할 수 있다. 즉, 프로세서는 통신부를 통해 연결된 외부 장치로부터 각종 데이터 또는 정보를 수신할 수 있으며, 외부 장치로 각종 데이터 또는 정보를 전송할 수도 있다. 그리고, 통신부는 WiFi 모듈, Bluetooth 모듈, 무선 통신 모듈, 및 NFC 모듈 중 적어도 하나를 포함할 수 있다. 사용자 인터페이스는 이미지 분류를 위해 이미지 분류 장치에 입력되는 이미지들이 수집되고, 이미지 분류를 위한 사용자 요청 및 명령들이 입력되는 입력 인터페이스를 포함할 수 있다. 이때 이미지들은 사용자에 의해 입력되거나 서버로부터 획득될 수 있다. 그리고 사용자 인터페이스는 이미지 분류 장치에서 수행된 결과가 출력되는 출력 인터페이스를 포함 할 수 있다. 예를 들어, 입력된 원본 이미지(또는 입력된 콘텐츠 이미지와 스타일 이미지)를 바탕으로 AdapIN 정규화를 수행하며 추론을 진행한 결과 등이 출력될 수 있다. 즉 사용자 인터페이스는 이미지 분류를 위한 사용자 요청 및 명령에 따른 결과를 출력할 수 있다. 이러한 사용자 인터페이스의 입력 인터페이스와 출력 인터페이스는 동일한 인터페이스에서 구현될 수 있다. 한편, 프로세서는 이미지 분류 장치의 전반적인 동작을 제어할 수 있다. 구체적으로, 프로세서 는 상술한 바와 같은 메모리를 포함하는 이미지 분류 장치의 구성과 연결되며, 상술한 바와 같은 메 모리에 저장된 적어도 하나의 명령을 실행하여 이미지 분류 장치의 동작을 전반적으로 제어할 수 있 다. 프로세서는 다양한 방식으로 구현될 수 있다. 예를 들어, 프로세서는 주문형 집적 회로(Application Specific Integrated Circuit, ASIC), 임베디드 프로세서, 마이크로 프로세서, 하드웨어 컨트롤 로직, 하드웨 어 유한 상태 기계(Hardware Finite State Machine, FSM), 디지털 신호 프로세서(Digital Signal Processor, DSP) 중 적어도 하나로 구현될 수 있다. 프로세서는 일종의 중앙처리장치로서 메모리에 탑재된 제어 소프트웨어를 구동하여 이미지 분류 장치 전체의 동작을 제어할 수 있다. 프로세서는 데이터를 처리할 수 있는 모든 종류의 장치를 포함할 수 있다. 여기서, '프로세서(processor)'는, 예를 들어 프로그램 내에 포함된 코드 또는 명령어로 표현된 기능을 수행하기 위해 물리적으로 구조화된 회로를 갖는, 하드웨어에 내장된 데이터 처리 장치를 의미할 수 있다. 이와 같이 하드웨어에 내장된 데이터 처리 장치의 일 예로써, 마이크로프로세서(microprocessor), 중앙처리장치 (central processing unit: CPU), 프로세서 코어(processor core), 멀티프로세서(multiprocessor), ASIC(application-specific integrated circuit), FPGA(field programmable gate array) 등의 처리 장치를 망 라할 수 있으나, 본 발명의 범위가 이에 한정되는 것은 아니다. 본 실시 예에서 프로세서는 이미지 분류 장치가 최적의 이미지 분류 결과를 출력하도록, 입력된 이미 지에 대하여 딥러닝(Deep Learning) 등 머신 러닝(machine learning)을 수행할 수 있고, 메모리는, 머신 러닝에 사용되는 데이터, 결과 데이터 등을 저장할 수 있다. 즉 본 실시 예에서, 프로세서는 딥러닝 기반 이미지 처리 기술을 활용한 이미지 분류를 수행하는 것으로, 분류하고자 하는 이미지의 레이블을 예측하도록 훈련된 이미지 처리 기반 학습 분류 모델을 로딩할 수 있다. 다 시 말해, 프로세서는 입력 이미지의 클래스를 식별하도록 훈련된 강건한 분류 모델을 로딩할 수 있다. 도 3 및 도 4는 본 개시의 일 실시 예에 따른 이미지 분류 장치를 설명하기 위한 예시도이다. 도 3 및 도 4를 참조하여, 본 실시 예의 강건한 분류 모델에 대해 설명하도록 한다. 도 3(a)는 Batch normalization layer를 활용하는 기존의 인공신경망 분류기의 작동 과정을 나타내며, 도 3 (b)는 본 실시 예의 AdaIN 정규화의 스타일 전이를 통한 강건한 인공신경망 분류기의 학습 과정, 도 3(c)는 본 실시 예의 AdaIN 정규화의 스타일 전이를 통한 강건한 인공신경망 분류기의 실제 사용(추론) 과정을 나타낸 것 이다. 도 3(a)에 도시된 바와 같이, 종래의 인공신경망 분류기는 이미지가 입력되면 특정 레이어들(Other Layers)을 거치면서 적용되는 가중치 영향을 받은 다음 BN(Batch Normalization) 레이어를 사용하여 정규화 과정을 거치도 록 배치하였다. 즉, 종래의 인공신경망 분류기는 입력 이미지를 피드 포워드(feed forward) 하는 과정 중간중간 에 BN 레이어를 배치하여 정규화를 수행하도록 하였다. 여기서 BN 레이어에서는 batch 단위 입력 값의 평균과 분산을 이용해 정규화를 진행할 수 있다. 반면, 본 실시 예에서는, 도 3(b)와 도 3(c)에 도시된 바와 같이, 종래의 인공신경망 분류기의 네트워크에서 BN 레이어를 사용하는 경우 하나의 스타일만 생성하게 되기 때문에, BN 레이어를 AdaIN 레이어로 변경하여 입력 이 미지를 피드 포워드 하는 과정 중간중간에 AdaIN 레이어를 통해 정규화를 수행할 수 있도록 할 수 있다. 보다 구체적으로 설명하면, 본 실시 예에서 강건성 향상이 되는 분류 모델의 네트워크 F의 구조는 수학식 1과 같이 정의될 수 있다. 수학식 1"}
{"patent_id": "10-2021-0044691", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "여기서, 와 는 정규화 레이어를 제외한, 본 실시 예의 분류 모델을 구성하는 모듈들(특정 레이어들, Our Layers)을 의미할 수 있으며, 로 파라미터화(parameterize) 되어 있을 수 있다. 이때 와 는 신경망 레 이어들에서 정규화 레이어를 제외한 모든 레이어들이 포함 가능할 수 있다. 예를 들어, convolutional layer, fully-connected layer 등의 레이어들이나 ReLU, maxpool 등 다양한 레이어들이 적용될 수 있다. 그리고 는 정규화 레이어를 의미할 수 있다. 즉, 본 실시 예에서, 는 AdaIN 정규화 레이어를 나타낼 수 있으며, 이전 레이어들로부터 두 가지 입력값을 받을 수 있다. 다시 말해, AdaIN 정규화 레이어는 정규화 될 입 력값과, 정규화를 위한 평균 및 표준편차, 또는 정규화를 위한 평균 및 표준편차를 추출하기 위한 입력값을 입 력받을 수 있다. 즉, AdaIN 정규화 레이어는 이전의 특정 레이어로부터 입력 이미지에 대한 특징맵(정규화 될 입력값)을 입력받을 수 있으며, 이전의 다른 특정 레이어로부터 상기 입력 이미지에 대한 특징맵을 정규화 하기 위한 평균 및 표준편차를 입력받을 수 있다. 이러한 AdaIN 정규화 레이어는 수학식 2와 같이 나타낼 수 있다. 수학식 2"}
{"patent_id": "10-2021-0044691", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "여기서 μ(·)는 입력값의 평균을 출력하는 함수를 의미할 수 있고, σ(·)는 입력값의 표준편차를 출력하는 함 수를 의미할 수 있다. 본 실시 예에서, AdaIN 정규화 레이어는 같은 형태(shape)를 가지는 두 개의 특징맵 (feature map) x와 y를 입력값으로 받을 수 있다. 여기서 x는 정규화의 대상이 되는 특징맵을 의미하며, 정규화 된 특징맵은 y에서 얻은 통계량을 활용해 스케일(scale) 및 바이어스(bias)가 입혀질 수 있다. 즉, 수학식 2를 살펴보면, 먼저 큰 괄호 부분에 나타난 바와 같이 x가 정규화 된 후, y에서 얻은 표준편차로 스케일되고, 평균 으로 바이어스가 입혀짐을 볼 수 있다. 본 실시 예에서는, 상술한 바와 같이, AdaIN 정규화 레이어는 이전의 특정 레이어로부터 입력 이미지(제 1 이미 지)에 대한 특징맵(정규화 될 입력값)을 입력받을 수 있으며, 이전의 다른 특정 레이어로부터 상기 입력 이미지 에 대한 특징맵을 정규화 하기 위하여, 임의의 다른 이미지(제 2 이미지)에 대한 평균 및 표준편차를 입력받을 수 있다. 즉 본 실시 예에서는, 입력 이미지 x(제 1 이미지)가 주어졌을 때 분류 모델 네트워크 F에 x를 피드 포워드 하 는 과정에서 임의의 다른 이미지 x'(제 2 이미지)의 스타일을 신경망에 계속 섞어주는 과정을 추가할 수 있다. 이는 입력 이미지 x가 주어졌을 때 F가 x의 형태 정보에 집중하도록 하고, 작은 노이즈에도 급변하기 쉬운 스타 일 정보에는 가중치를 덜 주기 위함이다. 이를 위해, 본 실시 예에서는, 우선 AdaIN 정규화 레이어의 첫 번째 입력값(정규화 될 입력값, 즉 제 1 이미지 의 콘텐츠 정보에 대한 특징맵)에는 그 전 레이어까지 x를 피드 포워드하면서 출력되는 중간값(특징맵)을 입력 할 수 있다. 그리고 두 번째 입력값(정규화에 쓰일 평균과 표준편차를 계산하기 위한 입력값, 즉 제 2 이미지의 스타일 정보에 대한 특징맵)에는 x'를 F에 피드 포워드 하는 과정에서 출력되는 중간값(특징맵)을 입력할 수 있 다. 상기의 과정을 수행하는 경우, AdaIN 정규화 레이어의 출력값은 x의 형태 정보에 x'의 스타일 정보가 더해 진 중간값이 될 수 있다. 즉 콘텐츠 정보에 대한 특징맵의 평균과 표준편차를 스타일 정보에 대한 특징맵에 align 할 수 있다. 그리고 본 실시 예에서는, 수학식 1을 참조하면, 분류 모델 네트워크 F의 특정 레이어들과 AdaIN 정규화 레이어 가 반복될 수 있음을 알 수 있으며, 상기의 과정을 AdaIN 정규화 레이어 마다 반복하여 나온 최종 결과물(예측 값)이 x의 레이블인 y와 비슷해지도록 학습할 수 있다. 다만 반복 여부 및 반복 횟수는 한정되는 것이 아니며, 네트워크 사용자가 주어진 태스크에 맞게 설정 가능할 수 있다. 상기의 과정은 수학식 3과 같이 나타낼 수 있다. 수학식 3"}
{"patent_id": "10-2021-0044691", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 5, "content": "여기서 D는 데이터셋을 의미하는 것으로, 입력 이미지(제 1 이미지) x, 입력 이미지의 레이블 y 및 임의의 다른 입력 이미지(제 2 이미지) x'를 포함할 수 있다. 그리고, 는 분류 손실 함수(classification loss)를 나타낼수 있다. 보다 구체적으로 살펴보면, x와 x'를 통해 얻어지는 (i-1)번째 특징맵을 각각 hi-1와 h'i-1라 하면, 여기서 i번째 특징맵 hi-1와 h'i-1를 얻는 과정은 다음과 같다. 우선, hi-1와 h'i-1을 각각 fi(도 3의 other layers)에 포워드 할 수 있다. 그 다음 h'i는 AdaIN 정규화 레이어에 x = fi(hi-1), y = fi(h'i-1)를 입력하여 얻을 수 있다. 그리고 h'i는 AdaIN 정규화 레이어에 x = fi(h'i-1), y = fi(h'i-1)를 입력하여 얻을 수 있다. 이로써 추론(inference) 과 정에서 x의 형태 정보에 x'의 스타일 정보가 섞여도 원래의 레이블 y를 잘 유추하도록 할 수 있다. 이는 본 실 시 예의 분류 모델이 이미지의 형태 정보에 집중하도록 유도하고, 강건성 향상에 도움을 줄 수 있다. 한편, 도 3(c)를 참조하면, 상기와 같이 학습된 분류 모델을 활용 및 적용할 때는 스타일 정보를 변형할 필요가 없으므로 임의의 다른 이미지를 입력하는 네트워크(과정)를 제외하고, 입력 이미지(원본 이미지) x를 바탕으로 AdaIN 정규화를 수행하며 추론(inference)을 진행할 수 있다. 이는 수학식 4와 같이 나타낼 수 있다. 수학식 4"}
{"patent_id": "10-2021-0044691", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "item": 6, "content": "도 4를 참조하면, 상술한 바와 같이 x는 입력 이미지, y는 입력 이미지에 해당하는 레이블, x'는 스타일을 입히 기 위한 임의의 다른 이미지를 나타낼 수 있다. 도 4(a)에 개시된 훈련(학습) 과정에서는 x에 대한 추론 (inference)을 진행할 때 분류 모델 네트워크 F 중간중간에 있는 AdaIN 정규화 레이어에서 x'의 스타일 정보를 입력할 수 있다. 그렇게 x의 형태 정보와 x'의 스타일 정보가 섞인 특징맵이 출력되었을 때, 최종적으로 분류 모델 네트워크 F가 x의 레이블인 y를 잘 예측하도록 학습할 수 있다. 이를 위해, 본 실시 예에서는 표준적인 분 류 손실 함수를 활용할 수 있으며, 적용 가능한 분류 손실 함수는 한정되지 않는다. 또한 도 4(b)에 개시된 테스트(활용 및 적용) 과정에서는, 학습된 분류 모델 네트워크 F를 기반으로 하여 추론 을 진행하되, 스타일 정보를 변형하지 않아도 되므로 AdaIN 정규화 레이어에 원본 이미지 x의 스타일 정보를 입 력할 수 있다. 그리고 분류 모델 네트워크 F에서 예측한 레이블 를 바탕으로 실제 레이블 y를 유추할 수 있 다. 상술한 본 실시 예의 분류 모델을 기반으로, 이미지 분류 장치에 대해 정리하면, 프로세서는 분류 모 델의 특정 레이어에서 출력된 입력 이미지에 대한 특징맵을 추출하고, 특징맵의 통계 정보를 이용하여 특징맵의 스타일 정보를 추출할 수 있다. 그리고 프로세서는 스타일 정보를 적용하여 특징맵을 대상으로 정규화를 수행하고, 정규화된 이미지를 기반으로 입력 이미지의 레이블을 예측할 수 있다. 여기서 특징맵을 추출하는 과 정 내지 정규화를 수행하는 과정은 도 3 및 도 4에 도시된 바와 같이, 설정 횟수 이상 연속으로 수행되도록 구 성될 수 있으나, 설정 횟수 이상 연속으로 수행되는지 여부 및 횟수는 한정되지 않고, 실시 예에 따라 달라질 수 있다. 이때 적용되는 본 실시 예의 분류 모델은, 클래스를 식별하기 위한 제 1 이미지(x) 및 제 1 이미지의 제 1 레이 블(y)을 제 1 네트워크에 입력하는 단계와, 제 1 이미지에 대한 스타일 전이 정규화(AdaIN)를 위한 제 2 이미지 (x')를 제 2 네트워크에 입력하는 단계와, 제 1 네트워크의 특정 레이어에서 출력된 제 1 이미지에 대한 콘텐츠 특징맵을 추출하는 단계와, 제 2 네트워크의 특정 레이어에서 출력된 제 2 이미지에 대한 스타일 특징맵을 추출 하여 스타일 특징맵의 통계 정보를 이용해 스타일 특징맵의 스타일 정보를 추출하는 단계와, 스타일 정보를 제 1 네트워크에 적용하여 제 1 이미지에 대한 콘텐츠 특징맵을 대상으로 정규화를 수행하는 단계와, 정규화된 제 1 이미지를 기반으로 입력된 제 1 이미지의 제 1 레이블을 예측하도록 학습하는 단계를 포함하는 훈련 페이즈 (phase)에 의해 훈련될 수 있다. 이때 분류 모델은, 제 1 레이블을 예측하도록 학습할 수 있으며, 다시 말해, 분류 모델의 AdaIN 정규화를 거친 추론 결과, 최종 출력되는 예측 이미지( )가 제 1 레이블(y)과 유사하도록 학습하는 것이다. 여기서, 스타일 정보는 스타일 특징맵의 평균 및 표준 편차를 포함할 수 있다. 또한 제 1 네트워크는 제 1 이미 지(x)가 추론되는 인공신경망 네트워크를 의미하고, 제 2 네트워크는 제 1 이미지(x)에 대한 스타일 전이 정규 화(AdaIN)를 위한 제 2 이미지(x')가 추론되는 인공신경망 네트워크를 의미할 수 있다. 그리고 분류 모델의 정규화를 수행하는 단계에서, 프로세서는 콘텐츠 특징맵을 정규화한 후, 정규화된 콘 텐츠 특징맵에 스타일 특징맵의 표준 편차를 곱하고, 스타일 특징맵의 평균을 가산할 수 있다. 또한, 본 실시 예의 분류 모델은 제 1 이미지의 제 1 레이블을 입력하는 단계 내지 정규화를 수행하는 단계는 설정 횟수 반복 수행되도록 구성될 수 있으며, 반복 여부 및 반복 횟수는 한정되지 않고 실시 예에 따라 달라질 수 있다. 또한 본 실시 예의 분류 모델은, 설정 횟수 반복 수행되는 경우, 스타일 정보를 제 2 네트워크에 적용하여 제 2 이미지에 대한 스타일 특징맵을 대상으로 정규화를 수행하는 단계를 더 포함하는 훈련 페이즈에 의해 훈련될 수 있으며, 이때 정규화된 제 2 이미지가 제 2 네트워크의 다음 레이어에 입력되도록 구성될 수 있다. 그리고 본 실시 예에서, 제 1 네트워크 및 제 2 네트워크는 동일한 구조 및 동일한 파라미터가 적용되도록 구성 될 수 있으며, 분류 모델은 제 1 네트워크 및 제 2 네트워크 각각 손실함수를 통해 최적화되도록 구성될 수 있 다. 한편 본 실시 예에서는, 인공 신경망의 훈련 과정에서 훈련 이미지들을 적절히 섞어줌으로써, 보다 강건하게 하 는 것을 특징으로 하는데, 이때 훈련 레이블들도 같이 섞어주면서 분류 성능 및 강건성을 더욱 더 향상시킬 수 있다. 즉, 본 실시 예는 이미지 두 장을 섞는 방식이라고 할 수 있으므로, 실시 예에 따라서, 훈련 레이블도 섞 어 줄 수 있는 것이다. 즉, 본 실시 예의 분류 모델은, 제 1 이미지의 제 1 레이블 및 제 2 이미지의 제 2 레이블에 대한 레이블 스무 딩(label smoothing)을 수행하는 단계를 더 포함하는 훈련 페이즈에 의해 훈련될 수 있다. 이때, 레이블 스무딩 은 다음 수학식 5에 의해 수행될 수 있다. 수학식 5"}
{"patent_id": "10-2021-0044691", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 7, "content": "여기서, y는 제 1 레이블, y'는 제 2 레이블, α는 하이퍼 파라미터(hyper parameter)를 의미할 수 있으며, α 의 값은 하이퍼파라미터로 설정에 따라 조절될 수 있다. 예를 들어, 제 1 이미지(x)와 제 2 이미지(x')의 one-hot 레이블이 각각 y와 y'인 경우 훈련 목표 레이블을 수 학식 5와 같이 설정할 수 있다. 이때 α의 값은 하이퍼파라미터로 설정에 따라 조절될 수 있다. 여기서, one- hot 레이블은 표현하고 싶은 인덱스에 1의 값을 부여하고, 다른 인덱스에는 0을 부여하는 일종의 표현 방식을 의미할 수 있다. 한편, 본 실시 예에서는, 이미지 분류기 강건성 연구에서 널리 쓰이는 CIFAR-10 데이터셋을 이용한 실험을 통해, 본 실시 예의 분류 모델의 실용성을 확인할 수 있다. 실험에서 설정된 데이터셋은 CIFAR-10이며, CIFAR- 10은 10 개의 자연 이미지 클래스(개, 고양이, 비행기, 트럭) 등으로 구성된 RGB 데이터셋이고, 각 이미지는 32x32 크기이다. 또한, 분류기는 WideResNet 34-10 인공신경망으로 설정되었으며, 훈련 방법은 SGD 최적화 (optimizer)로 200 epoch 동안 훈련하고, 모멘텀(momentum) 값은 0.1로 설정되었고, 학습 진도율(learning rate)은 0.1에서 시작하여 [100, 150] epoch에서 각각 1/10로 줄이도록 설정되었다. 표 1"}
{"patent_id": "10-2021-0044691", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 8, "content": "상기 표 1에서 각 행은 어떤 방어 기법이 쓰였는지 나타낸다. 'Natural'은 아무 방어 기법을 쓰지 않고 표준적 인 방식으로 학습한 경우를 뜻하며, 'Madry'는 강건성 연구 분야에서 널리 쓰이는 베이스라인으로 분류기를 강건하게 학습시킨 경우를 뜻한다. 'Ours'는 본 실시 예의 기법으로 강건하게 학습시킨 경우를 의미한다. 또한, 'clean'과 'PGD' 열은 각각 분류기에 테스트셋의 원본 이미지를 입력했을 때와 해당 원본 이미지에 PGD attack 을 가하여 생성한 적대적 예시를 입력했을 때의 분류 정확도를 나타낸다. 이때 분류 정확도는 테스트셋 데이터 10,000장 전체에 대하여 측정될 수 있다. 표 1에 개시된 바와 같이, 본 실시 예의 분류 모델은 기존의 Madry 방법 대비 clean 정확도(이미지가 공격받지 않았을 때의 정확도)가 8%p 향상되면서도, PGD 정확도(PGD attack으로 공격받았을 때의 정확도) 또한 약간 더 높은 성능을 보여준다. 두 번째로 본 실시 예의 분류 모델과 기존 기법의 훈련 소요시간 차이를 측정할 수 있으며, 각 기법의 훈련을 위해서 1개의 GPU(RTX 2080Ti)이 사용될 수 있다. 표 2"}
{"patent_id": "10-2021-0044691", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 9, "content": "표 2를 참조하면, 본 실시 예의 분류 모델의 경우, 학습 단계에서 한번 손실 함수 재기를 위해 두 개의 이미지 를 포워딩 해야 한다는 점 때문에 기본적인 학습 방법보다는 소요시간이 길다는 것을 볼 수 있다. 하지만 한번 손실 함수 재기를 위해 대략 7~10배의 포워딩을 해야 하는 Madry 기법의 경우 본 실시 예의 분류 모델보다 훈련 소요시간이 3~4배 정도 크다는 것을 확인할 수 있다. 결론적으로, 상기 표 1 및 표 2를 참조하면, 본 실시 예의 분류 모델이 기존 기법에 비해 공격받지 않은 이미지 에 대한 분류 성능은 훨씬 높고, 공격받은 이미지에 대한 분류 성능은 약간 우수함을 확인할 수 있으며, 그럼에 도 불구하고 학습에 걸리는 시간은 3~4배 정도 적음을 확인할 수 있다. 즉 본 실시 예의 분류 모델이 실용성이 있음을 확인할 수 있다. 도 5는 본 개시의 일 실시 예에 따른 이미지 분류 방법을 설명하기 위한 흐름도이다. 도 5를 참조하여, 이미지 분류를 위한 테스트 과정을 살펴보면, S10단계에서, 이미지 분류 장치는 분류 모 델의 특정 레이어에서 출력된 입력 이미지에 대한 특징맵을 추출한다. 여기서, 분류 모델은 클래스를 식별하기 위한 제 1 이미지 및 제 1 이미지의 제 1 레이블을 제 1 네트워크에 입 력하는 단계와, 제 1 이미지에 대한 스타일 전이 정규화를 위한 제 2 이미지를 제 2 네트워크에 입력하는 단계 와, 제 1 네트워크의 특정 레이어에서 출력된 제 1 이미지에 대한 콘텐츠 특징맵을 추출하는 단계와, 제 2 네트 워크의 특정 레이어에서 출력된 제 2 이미지에 대한 스타일 특징맵을 추출하여 스타일 특징맵의 통계 정보를 이 용해 스타일 특징맵의 스타일 정보를 추출하는 단계와, 스타일 정보를 제 1 네트워크에 적용하여 제 1 이미지에 대한 콘텐츠 특징맵을 대상으로 정규화를 수행하는 단계와, 정규화된 제 1 이미지를 기반으로 입력된 제 1 이미 지의 제 1 레이블을 예측하도록 학습하는 단계를 포함하는 훈련 페이즈(phase)에 의해 훈련된 학습 모델일 수 있다. 여기서, 스타일 정보는 스타일 특징맵의 평균 및 표준 편차를 포함할 수 있으며, 분류 모델의 정규화를 수행하 는 단계에서는, 콘텐츠 특징맵을 정규화하고 정규화된 콘텐츠 특징맵에 스타일 특징맵의 표준 편차를 곱하고, 스타일 특징맵의 평균을 가산할 수 있다. S20단계에서, 이미지 분류 장치는 컨볼루션 레이어에서 특징맵의 통계 정보를 이용하여 특징맵의 스타일 정보를 추출한다. 여기서, 스타일 정보는 특징맵의 평균 및 표준 편차를 포함할 수 있다. 그리고 S30단계에서, 이미지 분류 장치는 정규화 레이어에서 스타일 정보를 적용하여 특징맵을 대상으로 정규화를 수행하며, S40단계에서, 정규화된 특징맵을 기반으로 입력 이미지의 레이블을 예측한다. 이때 본 실시 예에서는, 특징맵을 추출하는 단계(S10) 내지 정규화를 수행하는 단계(S30)는 설정 횟수 이상 연 속으로 수행되도록 구성될 수 있다. 또한, 본 실시 예에서, 정규화 레이어 및 컨볼루션 레이어는 훈련 이미지를 훈련 이미지의 레이블로 분류하도록 훈련된 학습 모델의 레이어들로서, 정규화 레이어는 학습 모델의 학습 시 훈련 이미지에 스타일을 전이하는 스 타일 이미지의 특징맵 및 훈련 이미지의 특징맵을 입력으로 하여 정규화를 수행하는 레이어일 수 있다. 이상 설명된 본 발명에 따른 실시 예는 컴퓨터 상에서 다양한 구성요소를 통하여 실행될 수 있는 컴퓨터 프로그 램의 형태로 구현될 수 있으며, 이와 같은 컴퓨터 프로그램은 컴퓨터로 판독 가능한 매체에 기록될 수 있다. 이 때, 매체는 하드 디스크, 플로피 디스크 및 자기 테이프와 같은 자기 매체, CD-ROM 및 DVD와 같은 광기록 매체, 플롭티컬 디스크(floptical disk)와 같은 자기-광 매체(magneto-optical medium), 및 ROM, RAM, 플래시 메모리 등과 같은, 프로그램 명령어를 저장하고 실행하도록 특별히 구성된 하드웨어 장치를 포함할 수 있다. 한편, 상기 컴퓨터 프로그램은 본 발명을 위하여 특별히 설계되고 구성된 것이거나 컴퓨터 소프트웨어 분야의 당업자에게 공지되어 사용 가능한 것일 수 있다. 컴퓨터 프로그램의 예에는, 컴파일러에 의하여 만들어지는 것 과 같은 기계어 코드뿐만 아니라 인터프리터 등을 사용하여 컴퓨터에 의해서 실행될 수 있는 고급 언어 코드도 포함될 수 있다. 본 발명의 명세서(특히 특허청구범위에서)에서 \"상기\"의 용어 및 이와 유사한 지시 용어의 사용은 단수 및 복수 모두에 해당하는 것일 수 있다. 또한, 본 발명에서 범위(range)를 기재한 경우 상기 범위에 속하는 개별적인 값 을 적용한 발명을 포함하는 것으로서(이에 반하는 기재가 없다면), 발명의 상세한 설명에 상기 범위를 구성하는 각 개별적인 값을 기재한 것과 같다. 본 발명에 따른 방법을 구성하는 단계들에 대하여 명백하게 순서를 기재하거나 반하는 기재가 없다면, 상기 단 계들은 적당한 순서로 행해질 수 있다. 반드시 상기 단계들의 기재 순서에 따라 본 발명이 한정되는 것은 아니 다. 본 발명에서 모든 예들 또는 예시적인 용어(예들 들어, 등등)의 사용은 단순히 본 발명을 상세히 설명하기 위한 것으로서 특허청구범위에 의해 한정되지 않는 이상 상기 예들 또는 예시적인 용어로 인해 본 발명의 범위 가 한정되는 것은 아니다. 또한, 당업자는 다양한 수정, 조합 및 변경이 부가된 특허청구범위 또는 그 균등물의 범주 내에서 설계 조건 및 팩터에 따라 구성될 수 있음을 알 수 있다. 따라서, 본 발명의 사상은 상기 설명된 실시 예에 국한되어 정해져서는 아니 되며, 후술하는 특허청구범위뿐만 아니라 이 특허청구범위와 균등한 또는 이로부터 등가적으로 변경된 모든 범위는 본 발명의 사상의 범주에 속한 다고 할 것이다."}
{"patent_id": "10-2021-0044691", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 개시의 일 실시 예에 따른 이미지 분류 시스템의 개략적인 예시도이다. 도 2는 본 개시의 일 실시 예에 따른 이미지 분류 장치를 개략적으로 나타낸 블록도이다. 도 3 및 도 4는 본 개시의 일 실시 예에 따른 이미지 분류 장치를 설명하기 위한 예시도이다. 도 5는 본 개시의 일 실시 예에 따른 이미지 분류 방법을 설명하기 위한 흐름도이다."}
