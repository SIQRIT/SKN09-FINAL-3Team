{"patent_id": "10-2022-0059497", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2023-0159998", "출원번호": "10-2022-0059497", "발명의 명칭": "비전 트랜스포머 기반의 영상 특징 추출 장치 및 방법", "출원인": "한국전자통신연구원", "발명자": "이영완"}}
{"patent_id": "10-2022-0059497", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "데이터를 저장하는 메모리;상기 메모리를 제어하는 프로세서;를 포함하되, 상기 프로세서는, 입력 영상에 대해 다중 패치를 임베딩(embedding)하고, 상기 임베딩된 다중 패치에 대한 특징맵을 추출하고,상기 추출된 특징맵을 이용하여 신경망 기반의 트랜스포머 인코딩을 수행하고,상기 트랜스포머 인코딩을 통해 추출된 최종 특징맵을 통해 상기 입력 영상의 특징을 추출하되,상기 패치는 서로 다른 크기를 갖는, 비전 트랜스포머 기반 영상 특징 추출 장치."}
{"patent_id": "10-2022-0059497", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1 항에 있어서,상기 패치는 상기 서로 다른 크기로 병렬적으로 임베딩되는, 비전 트랜스포머 기반 영상 특징 추출 장치."}
{"patent_id": "10-2022-0059497", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1 항에 있어서,상기 트랜스포머 인코딩은 상기 특징맵에 대해 병렬적으로 수행되는, 비전 트랜스포머 기반 영상 특징 추출 장치."}
{"patent_id": "10-2022-0059497", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제1 항에 있어서,상기 패치는 서로 영역이 겹치도록 임베딩되는, 비전 트랜스포머 기반 영상 특징 추출 장치."}
{"patent_id": "10-2022-0059497", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제1 항에 있어서,상기 트랜스포머 인코딩은 상기 다중 패치 간의 상관관계를 구함으로써 수행되는, 비전 트랜스포머 기반 영상특징 추출 장치."}
{"patent_id": "10-2022-0059497", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제5 항에 있어서,상기 상관관계는 상기 다중 패치 간에 유사 영역 혹은 유사 카테고리를 포함하는지에 따라 정해지는, 비전 트랜스포머 기반 영상 특징 추출 장치.공개특허 10-2023-0159998-3-청구항 7 제6 항에 있어서,상기 상관관계는 상기 최종 특징맵을 추출하기 위해 상기 특징맵의 어텐션 맵(attention map)을 구하는데 이용되는, 비전 트랜스포머 기반 영상 특징 추출 장치."}
{"patent_id": "10-2022-0059497", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제7 항에 있어서,상기 상관관계는 키(key), 쿼리(query), 밸류(value)에 대한 임베딩을 통해 계산되는, 비전 트랜스포머 기반 영상 특징 추출 장치."}
{"patent_id": "10-2022-0059497", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제8 항에 있어서,상기 특징맵은 상기 밸류를 상기 어텐션 맵에 곱함으로써 추출되는, 비전 트랜스포머 기반 영상 특징 추출장치."}
{"patent_id": "10-2022-0059497", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제9 항에 있어서, 상기 최종 특징맵은 상기 특징맵에 대한 부가 연산(concatenation) 및 컨볼루션(convolution) 연산을 통해 상기특징맵 간의 상호 작용을 학습한 레이어를 기반으로 추출되는, 비전 트랜스포머 기반 영상 특징 추출 장치."}
{"patent_id": "10-2022-0059497", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "입력 영상에 대해 다중 패치를 임베딩(embedding)하는 단계; 상기 임베딩된 다중 패치에 대한 특징맵을 추출하는 단계; 상기 추출된 특징맵을 이용하여 신경망 기반의 트랜스포머 인코딩을 수행하는 단계; 상기 트랜스포머 인코딩을 통해 추출된 최종 특징맵을 통해 상기 입력 영상의 특징을 추출하는 단계;를 포함하되,상기 패치는 서로 다른 크기를 갖는, 비전 트랜스포머 기반 영상 특징 추출 방법."}
{"patent_id": "10-2022-0059497", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_12", "content": "제11 항에 있어서,상기 패치는 상기 서로 다른 크기로 병렬적으로 임베딩되는, 비전 트랜스포머 기반 영상 특징 추출 방법."}
{"patent_id": "10-2022-0059497", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_13", "content": "제11 항에 있어서,상기 트랜스포머 인코딩은 상기 특징맵에 대해 병렬적으로 수행되는, 비전 트랜스포머 기반 영상 특징 추출 방공개특허 10-2023-0159998-4-법."}
{"patent_id": "10-2022-0059497", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_14", "content": "제11 항에 있어서,상기 패치는 서로 영역이 겹치도록 임베딩되는, 비전 트랜스포머 기반 영상 특징 추출 방법."}
{"patent_id": "10-2022-0059497", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_15", "content": "제11 항에 있어서,상기 트랜스포머 인코딩은 상기 다중 패치 간의 상관관계를 구함으로써 수행되는, 비전 트랜스포머 기반 영상특징 추출 방법."}
{"patent_id": "10-2022-0059497", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_16", "content": "제15 항에 있어서,상기 상관관계는 상기 다중 패치 간에 유사 영역 혹은 유사 카테고리를 포함하는지에 따라 정해지는, 비전 트랜스포머 기반 영상 특징 추출 방법."}
{"patent_id": "10-2022-0059497", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_17", "content": "제16 항에 있어서,상기 상관관계는 상기 최종 특징맵을 추출하기 위해 상기 특징맵의 어텐션 맵(attention map)을 구하는데 이용되는, 비전 트랜스포머 기반 영상 특징 추출 방법."}
{"patent_id": "10-2022-0059497", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_18", "content": "제17 항에 있어서,상기 상관관계는 키(key), 쿼리(query), 밸류(value)에 대한 임베딩을 통해 계산되는, 비전 트랜스포머 기반 영상 특징 추출 방법."}
{"patent_id": "10-2022-0059497", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_19", "content": "제18 항에 있어서,상기 특징맵은 상기 밸류를 상기 어텐션 맵에 곱함으로써 추출되는, 비전 트랜스포머 기반 영상 특징 추출방법."}
{"patent_id": "10-2022-0059497", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_20", "content": "비전 트랜스포머 기반 영상 특징 추출을 위한 트랜스포머 인코딩 방법에 있어서,다중 패치로 임베딩된 특징맵을 기반으로 정규화(normalize)를 수행하는 단계;상기 다중 패치 간 상관관계를 계산하여 셀프 어텐션(self-attention) 연산을 수행하는 단계;상기 셀프 어텐션 연산에 의해 생성된 어텐션맵을 이용하여, 상기 상관관계를 기반으로 최종 특징맵을 생성하는공개특허 10-2023-0159998-5-단계;를 포함하되, 상기 패치는 서로 다른 크기를 갖고, 상기 상관관계는 키(key), 쿼리(query), 밸류(value) 임베딩을 기반으로 도출되는, 트랜스포머 인코딩 방법."}
{"patent_id": "10-2022-0059497", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 개시는 비전 트랜스포머 기반 영상 특징 추출 방법에 대한 것으로, 입력 이미지를 패치 단위로 임베딩 한 후 전역적 어텐션을 통한 시각적 특징을 추출하는 발명에 대한 것이다. 본 개시의 일 실시예에 따른 비전 트랜스포 머 기반 영상 특징 추출 장치는 데이터를 저장하는 메모리, 상기 메모리를 제어하는 프로세서를 포함하되, 상기 프로세서는, 입력 영상에 대해 다중 패치를 임베딩(embedding)하고, 상기 임베딩된 다중 패치에 대한 특징맵을 추출하고, 상기 추출된 특징맵을 이용하여 신경망 기반의 트랜스포머 인코딩을 수행하고, 상기 트랜스포머 인코 딩을 통해 추출된 최종 특징맵을 통해 상기 입력 영상의 특징을 추출하되, 상기 패치는 서로 다른 크기를 가질 수 있다."}
{"patent_id": "10-2022-0059497", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 개시는 인공지능을 이용한 다중 스케일 트랜스포머 기반의 영상 특징 추출 장치 및 방법에 대한 것으로, 입 력 이미지를 패치 단위로 임베딩 한 후 전역적 어텐션을 통한 시각적 특징을 추출하는 발명에 대한 것이다."}
{"patent_id": "10-2022-0059497", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "인공지능 기술이 최근 몇 년 사이 급부상하고 있다. 자율 주행 자동차의 인지/판단 시스템을 비롯한 교통, 언론, 물류, 안전, 환경 등 각종 분야에 인공지능 기술이 빠르게 접목되고 확산되면서 인간중시 가치 산업 및 지식정보 사회를 이끌어 갈 부가가치 창출의 새로운 원천으로 주목받고 있다. 특히, 인공 지능을 컴퓨터 비전 분야에 적용하여, 사람이 영상을 시각적으로 인식하는 방법과 유사하게 영상에 포함된 특징을 추출하고, 객체를 인식하고 분류하여 객체의 특징을 추출하는 기술이 제안되고 있다. 영상 특징 추출 기술은 디지털 영상 혹은 비디오 프레임으로부터 단일 객체(object/instance) 또는 복수의 객체들을 분류 (classification)하거나 영상 내 객체의 위치 정보(예를 들어, 바운딩 박스(bounding box))와 카테고리를 동시 에 찾아내는 객체 검출(detection) 혹은 영상 내 모든 픽셀의 카테고리를 분류하는 분할 (segmentation) 등 다 양한 시각 어플리케이션을 포함하는 개념이다. 이러한 영상 인식 기술에서 시각적 특징을 추출해내는 데 사용되 는 대표적인 네트워크 형태에는 컨볼루션 신경망 (Convolution Neural Networks)이 있으며, 최근에 전역적 어텐 션(attention) 기반의 비전 트랜스포머(Vision Transformer) 네트워크가 새롭게 제안된 바 있다."}
{"patent_id": "10-2022-0059497", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 개시의 목적은 신속하고 효율적인 비전 트랜스포머를 이용한 다중 스케일 기반의 영상 특징 추출 기술을 제 공하는 데 있다. 본 개시의 목적은 다양한 패치 크기를 지원하는 비전 트랜스포머 기반의 영상 특징을 추출하는 기술을 제공하는 데 있다. 본 개시의 목적은 서로 다른 크기의 패치에 대한 특징맵(feature map)을 이용하여 독립적으로 트랜스포머 인코 딩을 수행함으로써 영상 내 다양한 크기의 특징을 추출할 수 있는 기술을 제공하는 데 있다. 본 개시의 다른 목적 및 장점들은 하기의 설명에 의해서 이해될 수 있으며, 본 개시의 실시예에 의해 보다 분명 하게 알게 될 것이다. 또한, 본 개시의 목적 및 장점들은 특허청구범위에 나타낸 수단 및 그 조합에 의해 실현 될 수 있음을 쉽게 알 수 있을 것이다."}
{"patent_id": "10-2022-0059497", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 개시의 일 실시예에 따른 비전 트랜스포머 기반 영상 특징 추출 장치는 데이터를 저장하는 메모리, 상기 메 모리를 제어하는 프로세서를 포함하되, 상기 프로세서는, 입력 영상에 대해 다중 패치를 임베딩(embedding)하고, 상기 임베딩된 다중 패치에 대한 특징맵을 추출하고, 상기 추출된 특징맵을 이용하여 신경망 기반의 트랜스포머 인코딩을 수행하고, 상기 트랜스포머 인코딩을 통해 추출된 최종 특징맵을 통해 상기 입력 영상의 특징을 추출하되, 상기 패치는 서로 다른 크기를 가질 수 있다.한편, 상기 패치는 상기 서로 다른 크기로 병렬적으로 임베딩될 수 있다. 한편, 상기 트랜스포머 인코딩은 상기 특징맵에 대해 병렬적으로 수행될 수 있다. 한편, 상기 패치는 서로 영역이 겹치도록 임베딩될 수 있다. 한편, 상기 트랜스포머 인코딩은 상기 다중 패치 간의 상관관계를 구함으로써 수행될 수 있다. 한편, 상기 상관관계는 상기 다중 패치 간에 유사 영역 혹은 유사 카테고리를 포함하는지에 따라 정해질 수 있 다. 한편, 상기 상관관계는 상기 최종 특징맵을 추출하기 위해 상기 특징맵의 어텐션 맵(attention map)을 구하는데 이용될 수 있다. 한편, 상기 상관관계는 키(key), 쿼리(query), 밸류(value)에 대한 임베딩을 통해 계산될 수 있다. 한편, 상기 특징맵은 상기 밸류를 상기 어텐션 맵에 곱함으로써 추출될 수 있다. 한편, 상기 최종 특징맵은 상기 특징맵에 대한 부가 연산(concatenation) 및 컨볼루션(convolution) 연산을 통 해 상기 특징맵 간의 상호 작용을 학습한 레이어를 기반으로 추출될 수 있다. 본 개시의 일 실시예에 따른 비전 트랜스포머 기반 영상 특징 추출 방법은 입력 영상에 대해 다중 패치를 임베 딩(embedding)하는 단계, 상기 임베딩된 다중 패치에 대한 특징맵을 추출하는 단계, 상기 추출된 특징맵을 이용 하여 신경망 기반의 트랜스포머 인코딩을 수행하는 단계, 상기 트랜스포머 인코딩을 통해 추출된 최종 특징맵을 통해 상기 입력 영상의 특징을 추출하는 단계를 포함하되, 상기 패치는 서로 다른 크기를 가질 수 있다. 한편, 상기 패치는 상기 서로 다른 크기로 병렬적으로 임베딩될 수 있다. 한편, 상기 트랜스포머 인코딩은 상기 특징맵에 대해 병렬적으로 수행될 수 있다. 한편, 상기 패치는 서로 영역이 겹치도록 임베딩될 수 있다. 한편, 상기 트랜스포머 인코딩은 상기 다중 패치 간의 상관관계를 구함으로써 수행될 수 있다. 한편, 상기 상관관계는 상기 다중 패치 간에 유사 영역 혹은 유사 카테고리를 포함하는지에 따라 정해질 수 있 다. 한편, 상기 상관관계는 상기 최종 특징맵을 추출하기 위해 상기 특징맵의 어텐션 맵(attention map)을 구하는데 이용될 수 있다. 한편, 상기 상관관계는 키(key), 쿼리(query), 밸류(value)에 대한 임베딩을 통해 계산될 수 있다. 한편, 상기 특징맵은 상기 밸류를 상기 어텐션 맵에 곱함으로써 추출될 수 있다. 본 개시의 일 실시예에 따른 컴퓨터 판독 가능한 매체에 저장된 프로그램은 컴퓨터에서, 입력 영상에 대해 다중 패치를 임베딩(embedding)하는 단계, 상기 임베딩된 다중 패치에 대한 특징맵을 추출하는 단계, 상기 추출된 특 징맵을 이용하여 신경망 기반의 트랜스포머 인코딩을 수행하는 단계, 상기 트랜스포머 인코딩을 통해 추출된 최 종 특징맵을 통해 상기 입력 영상의 특징을 추출하는 단계를 수행하되, 상기 패치는 서로 다른 크기를 가질 수 있다. 본 개시의 일 실시예에 따른 비전 트랜스포머 기반 영상 특징 추출을 위한 트랜스포머 인코딩 방법은 다중 패치 로 임베딩된 특징맵을 기반으로 정규화(normalize)를 수행하는 단계, 상기 다중 패치 간 상관관계를 계산하여 셀프 어텐션(self-attention) 연산을 수행하는 단계, 상기 셀프 어텐션 연산에 의해 생성된 어텐션맵을 이용하 여, 상기 상관관계를 기반으로 최종 특징맵을 생성하는 단계를 포함하되, 상기 패치는 서로 다른 크기를 갖고, 상기 상관관계는 키(key), 쿼리(query), 밸류(value) 임베딩을 기반으로 도출될 수 있다."}
{"patent_id": "10-2022-0059497", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 개시의 일 실시예에 의하면, 인공 지능을 기반으로 신속하고 효율적인 영상 특징 추출을 수행할 수 있다. 본 개시의 일 실시예에 의하면, 비전 트랜스포머를 기반으로 신속하고 효율적인 영상 특징 추출을 수행할 수 있 다. 본 개시의 일 실시예에 의하면, 서로 다른 크기의 패치 임베딩을 통해 다양한 크기의 특징 정보를 필요로 하는 영상 내 객체 인식 및 분할을 수행할 수 있다. 본 개시의 일 실시예에 의하면, 서로 다른 크기의 패치에 대한 특징맵(feature map)을 이용하여 독립적으로 트 랜스포머 인코딩을 수행할 수 있다. 본 개시의 실시 예들에서 얻을 수 있는 효과는 이상에서 언급한 효과들로 제한되지 않으며, 언급하지 않은 또 다른 효과들은 이하의 본 개시의 실시 예들에 대한 기재로부터 본 개시의 기술 구성이 적용되는 기술 분야에서 통상의 지식을 가진 자에게 명확하게 도출되고 이해될 수 있다. 즉, 본 개시에서 서술하는 구성을 실시함에 따 른 의도하지 않은 효과들 역시 본 개시의 실시 예들로부터 당해 기술 분야의 통상의 지식을 가진 자에 의해 도 출될 수 있다."}
{"patent_id": "10-2022-0059497", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하에서는 첨부한 도면을 참고로 하여 본 개시의 실시 예에 대하여 본 개시가 속하는 기술 분야에서 통상의 지 식을 가진 자가 용이하게 실시할 수 있도록 상세히 설명한다. 그러나, 본 개시는 여러 가지 상이한 형태로 구현 될 수 있으며 여기에서 설명하는 실시 예에 한정되지 않는다. 본 개시의 실시 예를 설명함에 있어서 공지 구성 또는 기능에 대한 구체적인 설명이 본 개시의 요지를 흐릴 수 있다고 판단되는 경우에는 그에 대한 상세한 설명은 생략한다. 그리고, 도면에서 본 개시에 대한 설명과 관계없 는 부분은 생략하였으며, 유사한 부분에 대해서는 유사한 도면 부호를 붙였다. 본 개시에 있어서, 서로 구별되는 구성요소들은 각각의 특징을 명확하게 설명하기 위함이며, 구성요소들이 반드 시 분리되는 것을 의미하지는 않는다. 즉, 복수의 구성요소가 통합되어 하나의 하드웨어 또는 소프트웨어 단위 로 이루어질 수도 있고, 하나의 구성요소가 분산되어 복수의 하드웨어 또는 소프트웨어 단위로 이루어질 수도 있다. 따라서, 별도로 언급하지 않더라도 이와 같이 통합된 또는 분산된 실시 예도 본 개시의 범위에 포함된다. 본 개시에 있어서, 다양한 실시 예에서 설명하는 구성요소들이 반드시 필수적인 구성요소들을 의미하는 것은 아 니며, 일부는 선택적인 구성요소일 수 있다. 따라서, 일 실시 예에서 설명하는 구성요소들의 부분집합으로 구성 되는 실시 예도 본 개시의 범위에 포함된다. 또한, 다양한 실시 예에서 설명하는 구성요소들에 추가적으로 다른 구성요소를 포함하는 실시 예도 본 개시의 범위에 포함된다. 본 개시의 실시예를 설명함에 있어서, 인공 지능은 (인공)신경망, 모델, 네트워크 등을 포함할 수 있다. 본 개시의 실시예를 설명함에 있어서, 다중 패치(임베딩, embedding)는 복수 개의 패치 및/혹은 다양한 크기(스 케일, scale)의 패치(임베딩)를 포함할 수 있다. 본 개시의 실시예를 설명함에 있어서, 다중 스케일 임베딩은 다중 패치 (임베딩)와 혼용될 수 있다. 이하, 본 개시의 실시예를 도면을 참조하여 상세히 설명한다. 도 1은 본 개시의 일 실시예에 따른 다중 패치 임베딩 기반의 비전 트랜스포머 구성도이다. 보다 상세하게는, 본 개시의 비전 트랜스포머 기반 영상 특징 추출을 위해 이용될 수 있는 비전 트랜스포머의 예시적인 구성도이 다. 일 실시예로서, 다중 스케일 임베딩 기반의 비전 트랜스포머 네트워크는 입력 영상을 수신 받고, 다중 스 케일 패치 임베딩부, 다중 경로 트랜스포머 인코더 및 출력 레이어를 포함할 수 있다. 먼저, 입력 영상에는 비디오 (프레임), 이미지, 동영상 등이 포함될 수 있으며, 다중 스케일 패치 임베딩 부는 입력 영상에 대한 다중 패치 임베딩을 수행할 수 있다. 패치 임베딩부는 입력 영상을 하나 이상의 도형(예를 들어, 사각형)으로 분할하여, 하나 이상의 도형을 포함하는 패치로 영상을 분할할 수 있 다. 이에 따라 영상은 하나 이상의 패치를 포함할 수 있으며, 여기서 패치 간의 크기는 동일할 수도 있으나, 서 로 다를 수 있다. 즉, 패치의 크기는 일정한 크기로 제한되지 않을 수 있다. 또한, 패치 임베딩부는 패치 각각에 대해 특징맵(feature map)을 추출할 수 있다. 패치 임베딩에 대하여는 도 2 내지 도 3에서 더욱 상세히 설명할 것이다. 이후, 다중 경로 트랜스포머 인코더는 앞서 생성된 특징맵들을 입력으로 받아 각각 독립적으로 트랜스포머 인코딩(transformer encoding)을 수행한 후 생성된 다중 특징맵을 합쳐주는 작업을 수행할 수 있다. 생성된 다 중 특징맵을 합쳐주고, 다중 특징맵에 일정한 처리를 수행하므로써 최종 특징맵이 생성될 수 있다. 여기서 트랜 스포머 인코딩이란 인공지능 기반의 비전 트랜스포머(vision transformer) 네트워크 기반의 인코딩을 포함할 수 있다. 트랜스포머 인코더는 각 패치간 상관관계 및 상호작용을 학습함으로써 최종 특징맵을 생성할 수 있 다. 트랜스포머 인코딩에 대하여는, 도 4 및 도 5를 참조하여 더욱 상세하게 설명할 것이다. 이후, 출력 레이어는 생성된 최종 특징맵을 입력으로 받아 이를 이용하여 비전 트랜스포머 기반 영상 특징 추출을 수행할 수 있다. 영상 특징 추출에는, 영상 내 객체 인식이 포함될 수 있으며, 영상 내 객체 인식이란 객체의 크기, 특징, 이동 방식, 형태 등을 포함한 객체 정보를 추출하는 과정을 포함할 수 있다. 도 2는 본 개시의 일 실시예에 따른 다중 패치 임베딩 과정이며, 도 3은 본 개시의 일 실시예에 따른 다중 패치 임베딩 과정에서의 패치 중첩이다. 일 예로서, 도 3은 도 2의 다중 패치 임베딩 과정에 대한 것일 수 있으며, 하기에서는 이를 기반으로 설명하나 이는 설명의 명료함을 위한 것이고, 본 개시가 이에 한정되는 것은 아니다. 일 실시예로서, 도 2의 다중 패치 임베딩 과정은 도 1의 다중 스케일 패치 임베딩부가 수행할 수 있고, 하 기에서는 이를 기반으로 설명하나 이는 설명의 명료함을 위한 것이고, 본 개시가 이에 한정되는 것은 아니다. 일 실시예로서, 다중 패치 임베딩 과정에서는 입력 영상을 받아 서로 다른 크기의 패치 사이즈로 패치 임 베딩이 수행될 수 있다. 일 예로서, 각 패치는 중첩되는 방식으로 형성될 수도 있다. 도 2의 예에서도 제3 패치 임베딩 특징맵이 제2 패치 임베딩 특징맵과 일부 영역이 겹쳐지는 패치로부터 추출되도록 구현되었고, 제2 패치 임베딩 특징맵이 제1 패치 임베딩 특징맵과 일부 영역이 겹쳐지는 패치로부터 추출되도록 구현되었다. 이를, 입력 영상 형태로 보면 도 3에 도시된 바와 같을 수 있다. 일 예로서, 제1 패치 는 3x3 형태로, 제1 패치 임베딩 특징맵에 대응될 수 있으며, 제2 패치는 5x5 형태로, 제2 패치 특징맵에 대응될 수 있다. 또한, 제3 패치는 7x7 형태로, 제3 패치 특징맵에 대응될 수 있으며, 제3 패치는 제2 패치 영역을 포함하고, 제2 패치는 제1 패치를 포함할 수 있다. 다만, 반 드시 패치들의 영역이 중첩되어야하는 것은 아니다. 다만 패치를 중첩시킴으로써 보다 정확한 특징맵을 구현하 는 것도 가능하다. 일 예로서, 패치 임베딩은 병렬적으로 수행될 수 있다. 이에 의하면, 서로 다른 스케일의 패치로 동시다발적으 로 임베딩함으로써 같은 특징맵(201, 202, 203) 레벨에서 다양한 크기 시각적 정보를 동시에 추출할 수 있게 된 다. 각 특징맵(201, 202, 203)은 서로 다른 크기의 패치에 대한 것일 수 있다. 이렇게 병렬적으로 서로 다른 크 기의 패치로 임베딩된 특징맵들은 병렬적으로 다중 경로 트랜스포머 인코더(도 1, 103)의 입력이 될 수 있다. 도 4는 본 개시의 일 실시예에 따른 다중 경로 트랜스포머 인코더이며, 도 5는 본 개시의 일 실시예에 따른 트 랜스포머 인코더이다. 일 예로서, 도 4의 트랜스포머 인코더는 각각 도 5처럼 구성될 수 있다. 다중 경로 트랜스포머 인코더는 패치 임베딩 특징맵(201, 202, 203)과 전역-지역 특징 상호 작용 레이어 의 사이에 존재할 수 있으며, 패치 임베딩 특징맵의 개수만큼 존재할 수 있고, 각각의 트랜스포머 인코더 는 독립적이고 병렬적으로 구성될 수 있다. 일 예로서, 패치 임베딩 특징맵이 세 개이면 트랜스포머 인코더도 세 개가 존재할 수 있으나, 패치 임베딩 특징맵이 반드시 트랜스포머 인코더와 일 대 일로 대응 되어야하는 것 은 아니다. 다중 경로 트랜스포머 인코더는 다중 스케일 패치 임베딩을 통해 생성된 특징맵들을 입력으로 받을 수 있다. 일 예로서, 도 4의 다중 스케일 패치 임베딩 및 그에 따른 특징맵은 도 2 및 도 3으로 설명한 다중 패치 및 특징맵 을 포함한다. 트랜스포머 인코더를 이용하여, 생성된 각각의 특징맵에 대해 독립적으로 트랜스포머 인코딩을 수행함으로 써, 셀프 어텐션(self-attention) 작업을 수행하여 시각적 특징 정보를 추출할 수 있다. 구체적으로는, 패치 토큰으로 임베딩된 특징맵을 입력으로 받아서 정규화 레이어(Normalization)를 거칠 수 있다. 그 후에 다중헤드 어텐션(Multi-Head Attention) 블록을 통해 셀프 어텐션(self-attention) 연산이 수행 될 수 있는데, 셀프 어텐션 연산에는 입력된 패치 간의 상관관계를 구하는 과정이 포함되되, 상관관계는 키 (Key), 쿼리(Query), 밸류(Value) 임베딩 과정을 기반으로 유도될 수 있다. 예를 들어, 상관관계를 유도함에 있어서는 유사도가 높은 영역 및/혹은 카테고리를 포함하고 있는 패치들끼리는 높은 상관관계 값을 갖도록 계산되고, 반대로 아무런 관련 없는 패치들끼리는 낮은 상관관계 값을 갖도록 계산 될 수 있다. 유사도는 패치에 포함된 특징이나, 객체나 배경을 기반으로 계산될 수 있으며, 상관관계 값을 기반 으로 어텐션 맵(QK)을 구하게 될 수 있다. 앞서 구해진 어텐션 맵을 밸류(value) 값에 곱함으로써 어텐션이 반영된 특징맵을 추출할 수 있으며, 이를 다시 정규화 레이어에 통과시키고, 최종적으로 피드 포워드 레이어(feed forward network, FFN)에 통과 시켜 최종 특징맵을 얻을 수 있다. 정규화 레이어(501, 503)는 널리 알려진 정규화 기법을 수행할 수 있으며, 한 예로 특정되지 않는다. 한편, 서로 다른 크기의 패치로 임베딩된 특징맵으로 트랜스포머 인코더를 통해 셀프 어텐션을 수행하였기에 다 양한 크기의 패치에 대한 시각적 특징 정보들이 동시에, 병렬적으로 추출될 수 있다. 각각 추출된 특징맵들은 도 4의 전역-지역 특징 상호 작용 레이어의 입력으로 사용될 수 있는데, 전역-지 역 특징 상호 작용 레이어는 서로 다른 크기의 패치에 대해 어텐션(attention)된 특징맵들을 기반으로 추출된 시각적 특징 정보들을 이용하여 상호 작용 과정을 학습할 수 있는데, 다중 패치 기반 영상 특징 추출(예를 들어, 영상 객체 인식)을 위하여는 한 회라도 학습이 완료된 전역-지역 특징 상호 작용 레이어가 사용될 수 있 다. 구체적으로는, 전역-지역 특징 상호 작용 레이어와 트랜스포머 인코더, 및 도 1의 다중 스케일 패치 임베딩부는 인공지능 기반 학습에 이용될 수 있다. 전역-지역 특징 상호 작용 레이어가 상호 작용 과 정 학습 시, 서로 다른 패치 임베딩을 입력으로 하여 학습을 수행하되, 트랜스포머 인코더를 거쳐 나온 각각의 특징맵들을 채널(channel) 축으로 부가(concatenation) 연산을 수행한 후 이에 컨볼루션 연산(예를 들어, 1x1) 을 수행할 수 있다. 이로 인해, 서로 다른 스케일의 특징맵들끼리의 상호 작용을 학습하도록 할 수 있다. 전역- 지역 특징 상호 작용 레이어를 통과한 특징맵은 다시 다중 스케일 패치 임베딩 레이어의 입력으로 들어가고 다 시 반복적으로 다중 경로 트랜스포머 인코더에 들어가는 방식으로 학습이 수행될 수 있다. 도 6은 본 개시의 일 실시예에 따른 비전 트랜스포머 기반 영상 특징 추출 방법이다. 일 예로서, 도 6의 영상 특징 추출 방법은 다중 패치 기반 영상 객체 인식 등에 사용될 수 있다. 일 예로서, 비전 트랜스포머 기반 영상 특징 추출 방법은 도 1 내지 도 5를 참조하여 설명된 기술을 이용하여 수행될 수 있으며, 도 8의 비전 트랜스포머 기반 영상 특징 추출 장치 및 시스템에 의해 수행될 수 있다. 일 예로서, 비전 트랜스포머 기반 영상 특징 추출을 위해 입력 영상에 대해 다중 패치 임베딩(S601)을 수행할 수 있다. 다중 패치는 하나 이상의 패치 및/혹은 다양한 크기의 패치를 의미할 수 있으며, 각각의 패치는 병렬적으로 임베딩될 수 있다. 즉, 동시에 다수의 및/혹은 다양한 크기의 패치로 임베딩될 수 있으며, 서로 중첩되 도록 임베딩될 수도 있다. 즉, 한 패치가 다른 패치를 포함하는 방식으로 임베딩되는 것도 가능하다. 임베딩된 패치들은 패치 임베딩 특징맵을 생성하는데 사용될 수 있다. 이후, 임베딩된 다중 패치에 대한 특징맵을 추출(S602)할 수 있다. 특징맵 추출 과정 또한 각 패치에 대해 병렬 적으로 이루어질 수 있으며, 각 특징맵은 최종 특징맵을 사용하는 데 이용될 수 있으며, 하나로 합쳐질 수도 있다. 추출된 다중 패치에 대한 특징맵을 이용하여, 신경망 기반의 트랜스포머 인코딩(S603)을 수행할 수 있다. 여기 서 트랜스포머 인코딩은 각 특징맵에 대해 병렬적으로 수행될 수도 있으며, 복수 개의 패치 혹은 패치에 대한 특징맵 간의 상관관계를 구함으로써 수행될 수 있다. 일 예로서, 상관관계는 복수 개의 패치 간에 유사 영역 혹 은 유사 카테고리를 포함하는지에 따라 정해질 수 있으며, 유사도 평가는 패치 내 포함된 특징이나 객체의 특징 을 기반으로 계산될 수도 있다. 또한, 상관관계는 최종 특징맵을 추출하기 위해 특징맵의 어텐션 맵(attention map)을 구하는데 이용될 수도 있다. 일 예로서, 상관관계는 키(key), 쿼리(query), 밸류(value)에 대한 임베딩 을 통해 계산될 수 있으며, 특징맵은 밸류를 어텐션 맵에 곱함으로써 추출될 수 있다. 또한, 최종 특징맵은 특 징맵에 대한 부가 연산(concatenation) 및 컨볼루션(convolution) 연산을 통해 특징맵 간의 상호 작용을 학습한 레이어를 기반으로 추출될 수 있다. 여기서, 상호 작용을 학습한 레이어란 도 4의 전역-지역 특징 상호 작용 레 이어를 포함할 수 있으며, 학습 과정은 상기에서 설명한 바와 같다. 트랜스포머 인코딩에 대하여는 도 7에서 더 욱 상세히 설명된다. 이후, 트랜스포머 인코딩을 통해 추출된 최종 특징맵을 통해 상기 입력 영상의 특징을 추출(S604)할 수 있다. 최종 특징맵은 추출된 특징맵의 상관관계, 상호 작용 등을 기반으로 특징맵을 합침으로써 추출될 수도 있다. 여 기서 영상 특징 추출이란 영상 내 객체의 인식을 포함하며, 객체 인식이란 객체의 크기, 특징, 종류, 이동 방식 등을 분류하는 것을 모두 포함할 수 있다. 한편, 도 6은 본 개시의 일 실시예에 해당하므로, 일부 단계의 순서가 변경되거나, 일부 단계가 동시에 수행되 는 것도 가능하며, 다른 단계가 더 추가되거나 일부 단계가 삭제되는 것도 가능하다고 할 것이다. 도 7은 본 개시의 일 실시예에 따른 비전 트랜스포머 기반 영상 특징 추출을 위한 트랜스포머 인코딩 방법이다. 일 예로서, 도 7의 트랜스포머 인코딩 방법은 도 8의 비전 트랜스포머 기반 영상 특징 추출 장치 및 시스템에 의해 수행될 수 있으며, 상기에서 다른 도면을 참조하여 설명한 트랜스포머 인코더나 다중 경로 트랜스포머 인 코더에 해당할 수 있다. 일 예로서, 비전 트랜스포머 기반 영상 특징 추출을 위하여 영상이 다중 패치로 임베딩되어 수신되고, 해당 영 상에 대해 특징맵이 생성될 수 있다. 생성된 다중 패치 임베딩 특징 맵을 기반으로 정규화(S701)가 수행될 수 있는데, 이는 도 5의 정규화 레이어(501, 503)에 의해 수행될 수 있다. 정규화는 스케일이 큰 특징의 영향이 비 대해지는 것을 방지하기 위해 수행될 수 있다. 이후, 다중 패치 간 상관관계를 기반으로 셀프 어텐션 연산을 수행(S702)할 수 있다. 셀프 어텐션 연산은 상기 에서 설명한 바와 같이 도 5의 다중 헤드 어텐션(도 5, 502)에서 수행될 수 있으며, 이는 입력된 패치들끼리의 상관관계를 키(Key), 쿼리(Query), 밸류(Value) 임베딩을 통하여 계산하는 과정을 포함할 수 있다. 예를 들어, 유사한 영역 및/혹은 카테고리를 포함하고 있는 패치들끼리는 높은 상관관계 값을 갖도록 하며, 반대로 아무런 관련 없는 패치들끼리는 낮은 값을 취함으로써 어텐션맵(QK)을 구할 수 있다. 이후, 셀프 어텐션 연산으로 생성된 어텐션맵을 이용하여 최종 특징맵 생성(S703)할 수 있는데, 이 과정은 앞서 구해진 어텐션맵을 밸류값에 곱함으로써 어텐션이 반영된 특징맵을 추출하는 과정을 포함할 수 있다. 또한, 추 출된 어텐션이 반영된 특징맵을 다시 정규화 레이어와 피드포워드레이어(FFN)를 통과시켜 최종 특징맵을 얻을 수도 있다. 최종 특징맵은 상기에서 설명한 바와 같이 영상 특징 추출, 예를 들어, 영상 내 객체 인식을 위해 전역-지역 특징 상호 작용 레이어에 입력될 수도 있다. 한편, 도 7은 본 개시의 일 실시예에 해당하므로, 일부 단계의 순서가 변경되거나, 일부 단계가 동시에 수행되 는 것도 가능하며, 다른 단계가 더 추가되거나 일부 단계가 삭제되는 것도 가능하다고 할 것이다.도 8은 본 개시의 일 실시예에 따른 비전 트랜스포머 기반 영상 특징 추출 장치 및 시스템이다. 일 예로서, 도 8의 비전 트랜스포머 기반 영상 특징 추출 장치 및 시스템은 도 1 내지 도 5를 참조하여 설명된 기술 및 기능을 제공할 수 있으며, 도 6의 비전 트랜스포머 기반 영상 특징 추출 방법을 수행할 수 있다. 일 예로서, 비전 트랜스포머 기반 영상 특징 추출 장치는 데이터 및/혹은 명령어를 저장하는 메모리 및 프로세서를 포함할 수 있다. 프로세서는 메모리를 제어하되, 하나 이상의 프로세서로 이루어질 수 있다. 프로세서는 입력 영상에 대해 복수 개의 패치를 임베딩(embedding)하고, 임베딩된 하나 이상의 패치 에 대한 특징맵을 추출하고, 추출된 특징맵을 이용하여 신경망 기반의 트랜스포머 인코딩을 수행하고, 트랜스포 머 인코딩을 통해 추출된 최종 특징맵을 통해 입력 영상의 특징을 추출할 수 있다. 영상 특징 추출에는 영상 내 객체를 인식하는 과정이 포함될 수 있다. 이는, 상기에서 다른 도면을 참조하여 설명한 바와 같다. 다른 일 예로서, 도 8이 비전 트랜스포머 기반 영상 특징 추출 시스템인 경우에는 하나 이상의 비전 트랜 스포머 기반 영상 특징 추출 장치가 포함될 수 있고, 입력 영상을 수집하는 카메라나 도 1의 출력 레이어, 도 4의 전역-지역 특징 상호 작용 레이어 등을 별도로 포함할 수도 있다. 본 개시의 다양한 실시 예는 모든 가능한 조합을 나열한 것이 아니고 본 개시의 대표적인 양상을 설명하기 위한 것이며, 다양한 실시 예에서 설명하는 사항들은 독립적으로 적용되거나 또는 둘 이상의 조합으로 적용될 수도 있다. 또한, 본 개시의 다양한 실시예를 설명함에 있어서 동일한 용어를 이용하여 설명된 구성요소 및/혹은 단계는 동 일한 것을 나타낼 수 있다. 또한, 각 도면을 참조한 실시예에 대한 설명들은 서로 배치되는 명확한 설명이 없는 한 상호 보완적으로 적용될 수도 있다. 또한, 본 개시의 다양한 실시 예는 하드웨어, 펌웨어(firmware), 소프트웨어, 또는 그들의 결합 등에 의해 구현 될 수 있다. 또한, 하나의 소프트웨어가 아닌 하나 이상의 소프트웨어의 결합에 의해 구현될 수 있으며, 일 주 체가 모든 과정을 수행하지 않을 수 있다. 하드웨어에 의한 구현의 경우, 하나 또는 그 이상의 ASICs(Application Specific Integrated Circuits), DSPs(Digital Signal Processors), DSPDs(Digital Signal Processing Devices), PLDs(Programmable Logic Devices), FPGAs(Field Programmable Gate Arrays), 범용 프로세서(general processor), 컨트롤러, 마이크로 컨트롤러, 마이크로 프로세서 등에 의해 구현될 수 있다. 예를 들어, 상기 범용 프로세서를 포함한 다양한 형태 를 띨 수도 있다. 하나 혹은 그 이상의 결합으로 이루어진 하드웨어로 개시될 수도 있음은 자명하다. 본 개시의 범위는 다양한 실시 예의 방법에 따른 동작이 장치 또는 컴퓨터 상에서 실행되도록 하는 소프트웨어 또는 머신-실행 가능한 명령들(예를 들어, 운영체제, 애플리케이션, 펌웨어(firmware), 프로그램 등), 및 이러 한 소프트웨어 또는 명령 등이 저장되어 장치 또는 컴퓨터 상에서 실행 가능한 비-일시적 컴퓨터-판독가능 매체 (non-transitory computer-readable medium)를 포함한다. 일 실시예로서, 본 개시에 따른 비 일시적 컴퓨터 판독 가능한 매체에 저장된 컴퓨터 프로그램은, 컴퓨터에서, 입력 영상에 대해 다중 패치를 임베딩(embedding)하는 단계, 상기 임베딩된 다중 패치에 대한 특징맵을 추출하 는 단계, 상기 추출된 특징맵을 이용하여 신경망 기반의 트랜스포머 인코딩을 수행하는 단계, 상기 트랜스포머 인코딩을 통해 추출된 최종 특징맵을 통해 상기 입력 영상의 특징을 추출하는 단계를 수행하되, 상기 패치는 서 로 다른 크기를 가지도록 구현될 수 있다."}
{"patent_id": "10-2022-0059497", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "이상에서 설명한 본 개시는, 본 개시가 속하는 기술분야에서 통상의 지식을 가진 자에게 있어 본 개시의 기술적 사상을 벗어나지 않는 범위 내에서 여러 가지 치환, 변형 및 변경이 가능하므로, 본 개시의 범위는 전술한 실시 예 및 첨부된 도면에 의해 한정되는 것이 아니다."}
{"patent_id": "10-2022-0059497", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 개시의 일 실시예에 따른 다중 패치 임베딩 기반의 비전 트랜스포머 구성도이다. 도 2는 본 개시의 일 실시예에 따른 다중 패치 임베딩 과정이다. 도 3은 본 개시의 일 실시예에 따른 다중 패치 임베딩 과정에서의 패치 중첩이다. 도 4는 본 개시의 일 실시예에 따른 다중 경로 트랜스포머 인코더이다. 도 5는 본 개시의 일 실시예에 따른 트랜스포머 인코더이다. 도 6은 본 개시의 일 실시예에 따른 비전 트랜스포머 기반 영상 특징 추출 방법이다. 도 7은 본 개시의 일 실시예에 따른 비전 트랜스포머 기반 영상 특징 추출을 위한 트랜스포머 인코딩 방법이다. 도 8은 본 개시의 일 실시예에 따른 비전 트랜스포머 기반 영상 특징 추출 장치 및 시스템이다."}
