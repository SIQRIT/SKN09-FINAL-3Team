{"patent_id": "10-2024-0129124", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2025-0047165", "출원번호": "10-2024-0129124", "발명의 명칭": "복부 컴퓨터 단층 촬영 이미지를 이용한 소장 폐쇄를 분류하는 전자장치 및 방법", "출원인": "아주대학교산학협력단", "발명자": "신호정"}}
{"patent_id": "10-2024-0129124", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "복부 컴퓨터 단층 촬영(Computed Tomography, CT) 이미지를 이용한 소장 폐쇄를 분류하는 전자장치에 있어서, 복부 CT 이미지로부터 정상, 고위험 소장 폐쇄(High-Grade Small Bowel Obstruction, HGSBO) 및 저위험 소장폐쇄(Low-Grade Small Bowel Obstruction, LGSBO) 중 어느 하나로 분류하도록 학습된 딥러닝 모델에 대상체의복부 CT 이미지를 입력하여 분류 정보를 획득하는 프로세서를 포함하고,상기 딥러닝 모델은, 복부 CT 이미지로부터 CT 깊이 정보를 포함하는 특징 정보를 추출하는 특징 추출기;상기 특징 정보를 이용하여 복부 CT 이미지를 정상과 비정상 중 어느 하나로 분류하는 제1분류기; 및비정상인 경우, 상기 특징 정보를 이용하여 복부 CT 이미지를 고위험 소장 폐쇄와 저위험 소장 폐쇄 중 어느 하나로 분류하는 제2분류기로 구성되는 전자장치."}
{"patent_id": "10-2024-0129124", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제1항에 있어서,상기 프로세서는, 상기 특징 추출기를 통해 복부 CT 이미지의 수직 및 수평 공간에 대해 깊이 정보를 보존하는 풀링(pooling)을수행하여 상기 CT 깊이 정보를 포함하는 특징 정보를 획득하는 전자장치."}
{"patent_id": "10-2024-0129124", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제1항에 있어서,상기 프로세서는, 정상 복부 CT 이미지 및 비정상 복부 CT 이미지의 특징 정보를 이용하여 복부 CT 이미지를 정상과 비정상 중 어느 하나로 분류하도록 제1분류기를 학습시키는 전자장치."}
{"patent_id": "10-2024-0129124", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제1항에 있어서,상기 프로세서는, 비정상 복부 CT 이미지의 특징 정보 및 CT 깊이 정보를 이용하여 복부 CT 이미지를 고위험 소장 폐쇄와 저위험소장 폐쇄 중 어느 하나로 분류하도록 제2분류기를 학습시키는 전자장치."}
{"patent_id": "10-2024-0129124", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "전자장치에 의해 수행되는 복부 컴퓨터 단층 촬영(Computed Tomography, CT) 이미지를 이용한 소장 폐쇄를 분류하는 방법에 있어서, 복부 CT 이미지로부터 정상, 고위험 소장 폐쇄(High-Grade Small Bowel Obstruction, HGSBO) 및 저위험 소장폐쇄(Low-Grade Small Bowel Obstruction, LGSBO) 중 어느 하나로 분류하도록 학습된 딥러닝 모델에 대상체의복부 CT 이미지를 입력하여 분류 정보를 획득하는 단계를 포함하고,상기 딥러닝 모델은, 복부 CT 이미지로부터 CT 깊이 정보를 포함하는 특징 정보를 추출하는 특징 추출기;상기 특징 정보를 이용하여 복부 CT 이미지를 정상과 비정상 중 어느 하나로 분류하는 제1분류기; 및공개특허 10-2025-0047165-3-비정상인 경우, 상기 특징 정보를 이용하여 복부 CT 이미지를 고위험 소장 폐쇄와 저위험 소장 폐쇄 중 어느 하나로 분류하는 제2분류기로 구성되는 것을 특징으로 하는 방법."}
{"patent_id": "10-2024-0129124", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "제5항에 있어서,상기 분류 정보를 획득하는 단계는, 상기 특징 추출기를 통해 복부 CT 이미지의 수직 및 수평 공간에 대해 깊이 정보를 보존하는 풀링(pooling)을수행하여 상기 CT 깊이 정보를 포함하는 특징 정보를 획득하는 단계를 포함하는 방법."}
{"patent_id": "10-2024-0129124", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제5항에 있어서,정상 복부 CT 이미지 및 비정상 복부 CT 이미지의 특징 정보를 이용하여 복부 CT 이미지를 정상과 비정상 중 어느 하나로 분류하도록 제1분류기를 학습시키는 단계를 더 포함하는 방법."}
{"patent_id": "10-2024-0129124", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제5항에 있어서,비정상 복부 CT 이미지의 특징 정보 및 CT 깊이 정보를 이용하여 복부 CT 이미지를 고위험 소장 폐쇄와 저위험소장 폐쇄 중 어느 하나로 분류하도록 제2분류기를 학습시키는 단계를 더 포함하는 방법."}
{"patent_id": "10-2024-0129124", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명의 일 실시예에 따른 복부 컴퓨터 단층 촬영(Computed Tomography, CT) 이미지를 이용한 소장 폐쇄를 분 류하는 전자장치에 있어서, 복부 CT 이미지로부터 정상, 고위험 소장 폐쇄(High-Grade Small Bowel Obstruction, HGSBO) 및 저위험 소장 폐쇄(Low-Grade Small Bowel Obstruction, LGSBO) 중 어느 하나로 분류하 도록 학습된 딥러닝 모델에 대상체의 복부 CT 이미지를 입력하여 분류 정보를 획득하는 프로세서를 포함하고, 상 기 딥러닝 모델은, 복부 CT 이미지로부터 CT 깊이 정보를 포함하는 특징 정보를 추출하는 특징 추출기; 상기 특 징 정보를 이용하여 복부 CT 이미지를 정상과 비정상 중 어느 하나로 분류하는 제1분류기; 및 비정상인 경우, 상 기 특징 정보를 이용하여 복부 CT 이미지를 고위험 소장 폐쇄와 저위험 소장 폐쇄 중 어느 하나로 분류하는 제2 분류기로 구성될 수 있다."}
{"patent_id": "10-2024-0129124", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 복부 컴퓨터 단층 촬영 이미지를 이용한 소장 폐쇄를 분류하는 전자장치 및 방법에 관한 것이다."}
{"patent_id": "10-2024-0129124", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "급성 소장폐쇄(Acute Small Bowel Obstruction, ASBO)는 긴급 수술이 필요할 수 있는 흔한 급성 복부 질환 중 하나이다. 급성 소장 폐쇄는 수술이 지연되면 이환율과 사망률이 상당히 높은 것으로 알려져 있다. 급성 장 폐 쇄의 가장 흔한 원인은 수술 후 유착(70%)이며, 그 다음으로 암, 염증성 장 질환, 탈장으로 알려져 있다. 급성 소장폐쇄의 병태생리는 다양한 원인으로 인한 장폐쇄의 발병에서 시작하여 발효된 가스와 이동된 체액의 축적으 로 인해 폐쇄된 부위까지 장의 근위부 확장이 악화되는 것으로 진행된다. 장기간 장폐색과 팽창은 저혈량증과 장내 압력 증가로 이어져 장 허혈이나 괴사로 이어질 수 있다. 허혈과 장벽 확장은 장 장벽을 약화시켜 장 천공 위험을 증가시킨다. 이 위험은 임상적 악화와 치료 실패 기간에 따라 증가한다. 급성 소장폐쇄에 대한 치료 방안은 병태생리학적 진행에 따라 상당히 다르다. 장 경색이나 복막염이 의심되는 경우 응급 수술이 필수적이다. 또한 장 허혈이 악화되면 조기 수술이 필요하다. 그러나 약 70%의 경우 비수술적 관리(Non-Operative Management, NOM)가 가능하며, NOM을 시행한 환자의 약 20%는 결국 임상적 악화로 인해 수 술을 받게 된다. 최근 복부 컴퓨터 단층촬영(Computed Tomography, CT)이 NOM 치료 실패를 예측하는 데 중요한 역할을 하고 있으 며, 여러 논문에서 복부 CT를 사용하여 영상 소견과 모델링을 수행한다고 보고된 바 있다(Rondenet C, Millet I, Corno L, et al. CT diagnosis of closed loop bowel obstruction mechanism is not sufficient to indicate emergent surgery. EurRadiol 2020;30:1105-12. 등). 그러나 복부 CT가 급성 소장폐쇄의 수술적 치료 를 결정하는 데 중요한 역할을 함에도 불구하고 수술이 필요한 방사선학적 소견은 경험이 풍부한 방사선과 의사 만이 발견하며 관찰 간 편차가 비교적 높다. 최근 인공지능(AI)이 의료 영상의 다양한 작업에 널리 적용되고 있으며, 급성 소장폐쇄와 AI에 대한 대부분의 연구는 간단한 방사선 촬영을 사용하여 수행되고 있다. 더욱이 복부 CT를 사용한 AI 연구는 드물고 최근 연구는 AI 기반 접근 방식보다는 방사선과 의사의 해석에 의존하고 있는 실정이다. 논문에서 복부 CT에서 AI 사용을 보고하고 있지만 여전히 몇 가지 문제를 포함하고 있다. 예를 들어, Vanderbecq 등이 수행한 최근 연구는 CT로 급성 소장폐쇄의 전이 영역을 성공적으로 감지했지만 급성 소장폐쇄CT만 사용했고 정상 CT는 사용하지 않았다(Vanderbecq Q, Ardon R, De Reviers A, et al. Adhesion-related small bowel obstruction: deep learning for automatic transition-zone detection by CT. Insights Imaging 2022;13:13). 이 연구에서 제안하는 방법을 통해 CT에서 여러 급성 소장폐쇄 사례를 진단했지만 비정상 데이터 만 사용했기 때문에 정상 사례와 비정상 사례를 분류할 수 없는 한계점이 존재한다. 또한, 이전에는 AI가 정상 및 급성 소장폐쇄 X선 이미지를 구별할 수 있는지 확인하기 위한 파일럿 연구가 수행되었으나, 정상 및 비정상 데이터 간의 불균형이 상당했으며 비 CT 이미지를 사용하였다. 이와 같이, 응급 수술이 필요할 위험이 있는 환자를 진단하는 것은 종종 임상적으로 어려운 상황이다. 또한 닫 힌 루프 폐쇄(closed-loop obstructions) 또는 밴드 접착에 의한 소장 폐쇄와 같은 고위험 사례를 구별하는 것 은 방사선과 의사와 임상의에게 힘들고 어려운 작업이다."}
{"patent_id": "10-2024-0129124", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명의 목적은 급성 소장 폐쇄를 효과적으로 진단하고, 수술 위험이 있는 환자의 조기 진단 및 식별을 지원 할 수 있는 딥러닝 모델을 제공하는 것이다."}
{"patent_id": "10-2024-0129124", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "본 발명의 일 실시예에 따른 복부 컴퓨터 단층 촬영(Computed Tomography, CT) 이미지를 이용한 소장 폐쇄를 분 류하는 전자장치에 있어서, 복부 CT 이미지로부터 정상, 고위험 소장 폐쇄(High-Grade Small Bowel Obstruction, HGSBO) 및 저위험 소장 폐쇄(Low-Grade Small Bowel Obstruction, LGSBO) 중 어느 하나로 분류하 도록 학습된 딥러닝 모델에 대상체의 복부 CT 이미지를 입력하여 분류 정보를 획득하는 프로세서를 포함하고, 상기 딥러닝 모델은, 복부 CT 이미지로부터 CT 깊이 정보를 포함하는 특징 정보를 추출하는 특징 추출기; 상기 특징 정보를 이용하여 복부 CT 이미지를 정상과 비정상 중 어느 하나로 분류하는 제1분류기; 및 비정상인 경우, 상기 특징 정보를 이용하여 복부 CT 이미지를 고위험 소장 폐쇄와 저위험 소장 폐쇄 중 어느 하나로 분류하는 제2분류기로 구성될 수 있다. 상기 프로세서는, 상기 특징 추출기를 통해 복부 CT 이미지의 수직 및 수평 공간에 대해 깊이 정보를 보존하는 풀링(pooling)을 수행하여 상기 CT 깊이 정보를 포함하는 특징 정보를 획득할 수 있다. 상기 프로세서는, 정상 복부 CT 이미지 및 비정상 복부 CT 이미지의 특징 정보를 이용하여 복부 CT 이미지를 정 상과 비정상 중 어느 하나로 분류하도록 제1분류기를 학습시킬 수 있다. 상기 프로세서는, 비정상 복부 CT 이미지의 특징 정보 및 CT 깊이 정보를 이용하여 복부 CT 이미지를 고위험 소 장 폐쇄와 저위험 소장 폐쇄 중 어느 하나로 분류하도록 제2분류기를 학습시킬 수 있다. 본 발명의 일 실시예에 따른 전자장치에 의해 수행되는 복부 컴퓨터 단층 촬영(Computed Tomography, CT) 이미 지를 이용한 소장 폐쇄를 분류하는 방법에 있어서, 복부 CT 이미지로부터 정상, 고위험 소장 폐쇄(High-Grade Small Bowel Obstruction, HGSBO) 및 저위험 소장 폐쇄(Low-Grade Small Bowel Obstruction, LGSBO) 중 어느 하나로 분류하도록 학습된 딥러닝 모델에 대상체의 복부 CT 이미지를 입력하여 분류 정보를 획득하는 단계를 포 함하고, 상기 딥러닝 모델은, 복부 CT 이미지로부터 CT 깊이 정보를 포함하는 특징 정보를 추출하는 특징 추출 기; 상기 특징 정보를 이용하여 복부 CT 이미지를 정상과 비정상 중 어느 하나로 분류하는 제1분류기; 및 비정 상인 경우, 상기 특징 정보를 이용하여 복부 CT 이미지를 고위험 소장 폐쇄와 저위험 소장 폐쇄 중 어느 하나로 분류하는 제2분류기로 구성될 수 있다. 상기 분류 정보를 획득하는 단계는, 상기 특징 추출기를 통해 복부 CT 이미지의 수직 및 수평 공간에 대해 깊이 정보를 보존하는 풀링(pooling)을 수행하여 상기 CT 깊이 정보를 포함하는 특징 정보를 획득하는 단계를 포함할 수 있다. 상기 방법은, 정상 복부 CT 이미지 및 비정상 복부 CT 이미지의 특징 정보를 이용하여 복부 CT 이미지를 정상과 비정상 중 어느 하나로 분류하도록 제1분류기를 학습시키는 단계를 더 포함할 수 있다. 상기 방법은, 비정상 복부 CT 이미지의 특징 정보 및 CT 깊이 정보를 이용하여 복부 CT 이미지를 고위험 소장 폐쇄와 저위험 소장 폐쇄 중 어느 하나로 분류하도록 제2분류기를 학습시키는 단계를 더 포함할 수 있다."}
{"patent_id": "10-2024-0129124", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명의 일 실시예에 따르면, 복부 CT 이미지를 사용하여 급성 소장 폐쇄(ASBO)가 있는 고위험 환자를 감지하 는 데 도움이 되는 인공 지능 기반 딥러닝 모델을 구축할 수 있다. 본 발명의 일 실시예에 따르면, 심층 학습 분류기를 사용하여 복부 CT 이미지만으로 고위험 소장 폐쇄 환자를 효과적으로 검출할 수 있다. 본 발명의 인공지능 알고리즘을 기반으로 하는 이중 분기 구조와 깊이 유지 풀링을 갖춘 새로운 3D 분류기는 소 장 폐쇄가 있는 고위험 환자를 위한 신뢰할 수 있는 스크리닝 및 의사 결정 지원 도구가 될 수 있다."}
{"patent_id": "10-2024-0129124", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하, 본 발명에 따른 바람직한 실시 형태를 첨부된 도면을 참조하여 상세하게 설명한다. 첨부된 도면과 함께 이하에 개시될 상세한 설명은 본 발명의 예시적인 실시형태를 설명하고자 하는 것이며, 본 발명이 실시될 수 있 는 유일한 실시형태를 나타내고자 하는 것이 아니다. 도면에서 본 발명을 명확하게 설명하기 위해서 설명과 관 계없는 부분은 생략할 수 있고, 명세서 전체를 통하여 동일 또는 유사한 구성 요소에 대해서는 동일한 참조 부 호를 사용할 수 있다. 도 1은 본 발명의 일 실시예에 따른 전자장치의 동작 모습을 도시한 개략도이다. 본 발명의 일 실시예에 따른 전자장치는 복부 CT 이미지를 이용하여 정상, 고위험 소장 폐쇄(High- Grade Small Bowel Obstruction, HGSBO) 및 저위험 소장 폐쇄(Low-Grade Small Bowel Obstruction, LGSBO) 중 어느 하나에 해당하는지 분류하는 장치로, 컴퓨터, PLC(Programmable Logic Controller), 서버, 스마트 폰, 태 블릿 PC, 스마트 패드, 노트북 등으로 구현될 수 있다. 이하, 고위험 소장 폐쇄는 수술이 필요한 소장 폐쇄이고, 저위험 소장 폐쇄는 비수술적 관리가 가능한 소장 폐 쇄로 본다. 또한, 저위험 소장 폐쇄는 마비성 장폐색을 포함하는 것으로 본다. 복부 CT 이미지는 대상체의 복부를 컴퓨터 단층 촬영하여 획득된 3D 이미지로, 분할된 복수의 2D 이미지를 포함할 수 있다. 분류 정보는 복부 CT 이미지가 정상, 고위험 소장 폐쇄 및 저위험 소장 폐쇄 중 어느 하나에 해당하는 지 분류한 정보이다. 본 발명에서는 최적화된 3D-합성 신경망을 사용하여 고위험 소장 폐쇄를 예측하는 새로운 방안을 제안한다. 보다 구체적으로, 본 발명은 고위험 소장 폐쇄를 분류하기 위해 복부 CT 이미지의 깊이 정보를 유지하는 풀링과 2중으로 분기된 구조의 분류기를 제안한다. 이하, 도면들을 참조하여 본 발명의 일 실시예에 따른 전자장치의 구성 및 동작에 대해 구체적으로 설명한 다. 도 2는 본 발명의 일 실시예에 따른 전자장치의 구성을 도시한 블럭도이다. 본 발명의 일 실시예에 따른 전자장치는 입력부, 통신부, 표시부, 저장부 및 프로세 서를 포함한다. 입력부는 전자장치의 사용자 입력에 대응하여 입력데이터를 발생시킨다. 예를 들어, 사용자 입력은 전자장치를 구동하는 사용자 입력 등일 수 있으며, 이 외에도 복부 CT 이미지로부터 분류 정보를 획득하기 위해 필요한 사용자 입력인 경우 제한하지 않고 적용 가능하다. 입력부는 적어도 하나의 입력수단을 포함한다. 입력부는 키보드(key board), 키패드(key pad), 돔 스 위치(dome switch), 터치패널(touch panel), 터치 키(touch key), 마우스(mouse), 메뉴 버튼(menu button) 등 을 포함할 수 있다. 통신부는 복부 CT 이미지, 딥러닝 모델, 분류 정보 등을 송수신하기 위해 CT 장비, 의료 시스템 등 외부장 치와의 통신을 수행할 수 있다. 이를 위해, 통신부는 5G(5th generation communication), LTE-A(long term evolution-advanced), LTE(long term evolution), Wi-Fi(wireless fidelity), Bluetooth 등의 무선 통신, 혹은 LAN(local area network), WAN(Wide Area Network), 전력선 통신 등의 유선 통신을 수행할 수 있다. 표시부는 전자장치의 동작에 따른 표시 데이터를 표시한다. 표시부는, 예를 들어, 복부 CT 이미 지를 표시하는 화면, 분류 정보를 표시하는 화면, 사용자 입력을 수신하는 화면 등을 표시할 수 있다. 표시부는 액정 디스플레이(LCD; liquid crystal display), 발광 다이오드(LED; light emitting diode) 디 스플레이, 유기 발광 다이오드(OLED; organic LED) 디스플레이, 마이크로 전자기계 시스템(MEMS; micro electro mechanical systems) 디스플레이 및 전자 종이(electronic paper) 디스플레이를 포함한다. 표시부 는 입력부와 결합되어 터치 스크린(touch screen)으로 구현될 수 있다. 저장부는 전자장치의 동작 프로그램들을 저장한다. 저장부는 전원의 제공 유무와 무관하게 데이 터(정보)를 보존할 수 있는 비휘발성 속성의 스토리지(storage)와, 프로세서에 의해 처리되기 위한 데이터 가 로딩되며 전원이 제공되지 않으면 데이터를 보존할 수 없는 휘발성 속성의 메모리(memory)를 포함한다. 스토 리지에는 플래시메모리(flash-memory), HDD(hard-disc drive), SSD(solid-state drive) ROM(Read Only Memory) 등이 있으며, 메모리에는 버퍼(buffer), 램(RAM; Random Access Memory) 등이 있다. 저장부는 복부 CT 이미지, 딥러닝 모델, 분류 정보 등을 저장할 수 있으며, 분류 정보 획득, 특징 정보 추 출, 복부 CT 이미지를 정상과 비정상 중 어느 하나로 분류, 복부 CT 이미지를 고위험 소장 폐쇄와 저위험 소장 폐쇄 중 어느 하나로 분류 등을 수행하는 과정에서 필요한 연산 프로그램 등을 저장할 수 있다. 프로세서는 프로그램 등 소프트웨어를 실행하여 전자장치의 적어도 하나의 다른 구성요소(예: 하드웨 어 또는 소프트웨어 구성요소)를 제어할 수 있고, 다양한 데이터 처리 또는 연산을 수행할 수 있다. 본 발명의 일 실시예에 따른 프로세서는 복부 CT 이미지로부터 정상, 고위험 소장 폐쇄(High-Grade Small Bowel Obstruction, HGSBO) 및 저위험 소장 폐쇄(Low-Grade Small Bowel Obstruction, LGSBO) 중 어느 하나로 분류하도록 학습된 딥러닝 모델에 대상체의 복부 CT 이미지를 입력하여 분류 정보를 획득할 수 있다. 이때, 프로세서가 딥러닝 모델을 학습하거나, 기 학습되어 생성된 딥러닝 모델을 외부로부터 수신 및 저장 하여 이용할 수 있으며 어느 하나에 한정되는 것은 아니다. 한편, 프로세서는 상기 동작들을 수행하기 위한 데이터 분석, 처리, 및 결과 정보 생성 중 적어도 일부를 규칙 기반 또는 인공지능(Artificial Intelligence) 알고리즘으로서 기계학습, 신경망 네트워크(neural network), 또는 딥러닝 알고리즘 중 적어도 하나를 이용하여 수행할 수 있다. 신경망 네트워크의 예로는, CNN (Convolutional Neural Network), DNN (Deep Neural Network), RNN (Recurrent Neural Network)과 같은 모델 을 포함할 수 있다. 도 3은 본 발명의 일 실시예에 따른 딥러닝 모델의 구조를 도시한 도면이다. 도 3을 참고하면, 딥러닝 모델은, 복부 CT 이미지로부터 CT 깊이 정보를 포함하는 특징 정보를 추출하 는 특징 추출기, 특징 정보를 이용하여 복부 CT 이미지를 정상과 비정상 중 어느 하나로 분류하는 분 류기(이하, 제1분류기라 한다.), 비정상인 경우, 특징 정보를 이용하여 복부 CT 이미지를 고위험 소 장 폐쇄와 저위험 소장 폐쇄 중 어느 하나로 분류하는 분류기(이하, 제2분류기라 한다.)로 구성된다. 앞서 서술한 바와 같이, 프로세서가 딥러닝 모델을 학습하거나, 기 학습되어 생성된 딥러닝 모델 을 외부로부터 수신 및 저장하여 이용할 수 있다. 이하, 프로세서가 딥러닝 모델을 학습하는 과 정에 대해 설명한다. 먼저, 세 그룹, 정상 그룹, 고위험 소장 폐쇄 그룹, 저위험 소장 폐쇄 그룹에 해당하는 복부 CT 이미지를 마련한다. 복부 CT 이미지는 채널(C) Х수평(W) Х수직(H) Х깊이(D) 크기로 된 3D 이미지이다. 특징 추출기는 딥러닝 모델의 백본 네트워크로, 합성곱 레이어(Convolutional Layer)와 풀링 레이어 (Pooling layer)로 이루어져 합성곱과 풀링 과정을 반복하며 복부 CT 이미지의 특징 정보를 추출할 수 있다. 특징 추출기는, 예를 들어, ResNet, ResNext, WideResNet, DenseNet, EfficientNet 등일 수 있으며, 어느 하나에 한정되지 않는다. 이때, 프로세서는 특징 추출기를 통해 복부 CT 이미지의 깊이 정보를 유지한 특징 정보를 추출할 수 있다. 깊이 정보를 유지하는 이유는 다음과 같다. 대부분의 질병은 CT 이미지의 극히 작은 영역에 집중되어 있다. 따라서 작은 영역에서 정보를 캡처하려면 마지 막 풀링 레이어에서 가능한 한 많은 정보를 유지하는 것이 필수적이다. 그러나, 대부분의 딥러닝 모델은 데이터 양, 학습 속도 등 다양한 이유로 풀링 레이어에서 입력 데이터의 깊이 정보를 압축한다. 예를 들어, CХHХWХD 크기의 입력 이미지를 CХ1Х1Х1로 풀링하여 깊이 정보를 압축한다. 즉, 고위험 소장 폐쇄, 저위험 소장 폐쇄와 같은 병변은 3D 복부 CT 이미지의 특정 깊이에서만 나타날 수 있는 바, 깊이별로 특징을 학습할 수 있는 것이 중요하다. 따라서, 본 발명에서는 3D 복부 CT 이미지의 작은 영역에 있는 정보를 수집하기 위해 이러한 깊이 정보를 유지하는 방법을 제안한다. 이를 깊이 유지 풀링(Depth Retention Pooling, DRP)이라고도 한다. 프로세서는 특징 추출기를 통해 복부 CT 이미지의 수직 및 수평 공간에 대해 깊이 정보를 보존하는 풀링을 수행하여 CT 깊이 정보를 포함하는 특징 정보를 획득할 수 있다. CT 깊이 정보를 포함하는 특징 정보는 완전 연결층(Fully Connected Layer)을 통해 분류기로 전달될 수 있다. 한편, 고위험 소장 폐쇄와 저위험 소장 폐쇄인 경우의 복부 CT 이미지는 유사한 바, 본 발명에서는 보다 정확하 게 고위험 소장 폐쇄와 저위험 소장 폐쇄를 구별하기 위해, 분류기를 2중으로 사용한다. 이를 2중 분기 구조 (Dual-Branch Architecture, DBA) 라고도 한다. 먼저, 제1분류기는 기본 분류기로, 복부 CT 이미지를 정상과 비정상 중 어느 하나로 분류할 수 있다. 프로세서는 정상 복부 CT 이미지 및 비정상 복부 CT 이미지의 특징 정보를 이용하여 복부 CT 이미지를 정 상과 비정상 중 어느 하나로 분류하도록 제1분류기를 학습시킬 수 있다. 이때, 비정상 복부 CT 이미지는 고위험 소장 폐쇄인 경우의 복부 CT 이미지 및 저위험 소장 폐쇄인 경우의 복부 CT 이미지를 포함할 수 있다. 이때, 프로세서는 정상 복부 CT 이미지 및 비정상 복부 CT 이미지의 깊이 정보를 압축한 특징 정보를 이용 하여 복부 CT 이미지를 정상과 비정상 중 어느 하나로 분류하도록 제1분류기를 학습시킬 수 있다. 다른 실시예로, 프로세서는 정상 복부 CT 이미지 및 비정상 복부 CT 이미지의 CT 깊이 정보를 포함하는 특 징 정보를 이용하여 복부 CT 이미지를 정상과 비정상 중 어느 하나로 분류하도록 제1분류기를 학습시킬 수 있다. 제2분류기는 미세 분류기로, 복부 CT 이미지를 고위험 소장 폐쇄와 저위험 소장 폐쇄 중 어느 하나로 분류 할 수 있다. 앞서 서술한 바와 같이, 제2분류기는 고위험 소장 폐쇄와 저위험 소장 폐쇄를 구별하기 위해 복부 CT 이미지의 깊이 정보를 활용한다. 프로세서는 비정상 복부 CT 이미지의 CT 깊이 정보를 포함하는 특징 정보를 이용하여 복부 CT 이미지를 고 위험 소장 폐쇄와 저위험 소장 폐쇄 중 어느 하나로 분류하도록 제2분류기를 학습시킬 수 있다. 분류 정보는 제1분류기 및 제2분류기로부터 출력되는 정보로, 각 그룹별 확률을 포함할 수 있다. 다만, 이에 한정되지 않고, 확률에 기초한 결과값을 포함할 수 있다. 제1분류기가 다음 수학식 1을 사용하여 입력 이미지가 비정상이라고 예측하는 경우, 두 분류기의 확률을 사용할 수 있다. 수학식 1"}
{"patent_id": "10-2024-0129124", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "본 발명의 일 실시예에 따르면, 심층 학습 분류기를 사용하여 복부 CT 이미지만으로 고위험 소장 폐쇄 환자를 효과적으로 검출할 수 있다. 본 발명의 인공지능 알고리즘을 기반으로 하는 이중 분기 구조와 깊이 유지 풀링을 갖춘 새로운 3D 분류기는 소 장 폐쇄가 있는 고위험 환자를 위한 신뢰할 수 있는 스크리닝 및 의사 결정 지원 도구가 될 수 있다. 도 4는 본 발명의 일 실시예에 따른 전자장치의 동작 흐름도를 도시한 도면이다. 본 발명의 일 실시예에 따르면, 프로세서는 대상체의 복부 CT 이미지를 딥러닝 모델에 입력할 수 있다 (S10). 프로세서는 CT 장비나, 전자 건강 기록(Electronic Health Records, EHR)과 같은 의료 시스템으로부터 대 상체의 복부 CT 이미지를 수신할 수 있으며, 복부 CT 이미지를 획득하는 경로는 어느 하나에 한정되지 않는다. 딥러닝 모델은 앞서 도 3을 참고하여 설명한 딥러닝 모델과 동일하다. 프로세서는 딥러닝 모델의 특징 추출기를 통해 대상체의 복부 CT 이미지로부터 CT 깊이 정보를 포함하는 특징 정보를 추출할 수 있다(S20). 프로세서는 딥러닝 모델의 제1분류기를 통해 CT 깊이 정보를 포함하는 특징 정보를 이용하여 대상체의 복 부 CT 이미지를 정상과 비정상 중 어느 하나로 분류할 수 있다(S30). 대상체의 복부 CT 이미지가 비정상인 경우(S30의 No), 프로세서는 딥러닝 모델의 제2분류기를 통해 CT 깊 이 정보를 포함하는 특징 정보를 이용하여 복부 CT 이미지를 고위험 소장 폐쇄와 저위험 소장 폐쇄 중 어느 하 나로 분류할 수 있다(S40). 프로세서는 S30 및 S40을 통해 분류된 결과에 따른 분류 정보를 획득할 수 있다(S50). 예를 들어, 대상체의 복부 CT 이미지가 정상인 경우(S30의 Yes), 프로세서는 대상체가 정상임을 나타내는 분류 정보를 획득할 수 있다. 혹은 대상체의 복부 CT 이미지가 비정상(S30의 No)이고, 고위험 소장 폐쇄인 경우(S40의 Yes), 프로세서는 대상체가 고위험 소장 폐쇄임을 나타내는 분류 정보를 획득할 수 있다. 혹은 대상체의 복부 CT 이미지가 비정상(S30의 No)이고, 저위험 소장 폐쇄인 경우(S40의 No), 프로세서는 대상체가 저위험 소장 폐쇄임을 나타내는 분류 정보를 획득할 수 있다. 분류 정보는 다양한 형식으로 표현될 수 있으며, 어느 하나에 한정되지 않는다. 예를 들어, 제1분류기의 경우, 분류 정보는 정상, 고위험 소장 폐쇄, 저위험 소장 폐쇄에 대한 각 확률을 포함하거나, 세 확률 중 임계값을 초 과하는 어느 하나에 관한 정보나, 혹은 세 확률 중 가장 높은 확률을 가지는 어느 하나에 관한 정보를 포함할 수 있다. 이때, 고위험 소장 폐쇄 및 저위험 소장 폐쇄 중 어느 하나일 경우, 이들을 묶어 비정상으로 출력할 수도 있다. 제2분류기의 경우, 분류 정보는 고위험 소장 폐쇄, 저위험 소장 폐쇄에 대한 확률을 포함하거나, 두 확률 중 임 계값을 초과하는 어느 하나에 관한 정보나, 혹은 두 확률 중 더 높은 확률을 가지는 어느 하나에 관한 정보를 포함할 수 있다. 노인, 근육 감소증 또는 당뇨병 환자는 고위험 소장 폐쇄로 인한 진행성 장 허혈에 더 취약하여 급성 신손상 (Acute Kidney Injury, AKI), 심장 손상, 심혈관 사건 또는 사망과 같은 주요 이환을 일으킬 수 있으나, 본 발 명을 통해 고위험 소장 폐쇄 환자에 대해 초기 단계에서 적절하게 대응함으로써 이를 예방할 수 있다. 또한, 고위험 소장 폐쇄 환자에 대해 초기 단계에서 적절하게 수술하면 장 절제를 피할 수 있으며, 소장의 큰 부분을 절제하면 발생할 수 있는 단장 증후군도 예방할 수 있다. 도 5는 본 발명의 일 실시예에 따른 딥러닝 모델과 기존 딥러닝 모델의 Grad-CAM을 이용한 히트맵을 도시한 도 면이다. 기울기 가중 클래스 활성화 매핑(gradient-weighted class activation mapping, Grad-CAM)은 딥러닝 모델이 어 떤 근거로 분류 결정을 내렸는지 히트맵을 통해 나타낸다. 도 5는 여러 환자의 CT 이미지에 대한 기울기 가중 클래스 활성화 매핑을 이용한 히트맵으로, 첫 번째 행은 정 상이고, 두 번째와 세 번째 행은 각각 고위험 소장 폐쇄와 저위험 소장 폐쇄이다. A는 WideResNet을 백본 네트워크로 하는 순수 딥러닝 모델의 Grad-CAM이고, B는 WideResNet을 백본 네트워크로 하는 본 발명을 적용한 딥러닝 모델의 Grad-CAM이다. A의 히트맵들은 모든 클래스(행)에서 유사한 영역에서 활성화됨을 알 수 있다. 이는 모델이 각 개별 클래스를 정확하게 분류하지 못한다는 것을 나타낸다. B는 정상 클래스에서 히트맵은 주로 복부 중앙 하부에서 활동함을 나타낸다. 그러나 고위험 소장 폐쇄 클래스 의 경우 활동은 복부의 특정 영역에 집중된다. 저위험 소장 폐쇄의 경우 히트맵은 복부의 다양한 영역에서 광범 위한 활동을 보여준다. 이로서, 본 발명을 적용한 딥러닝 모델은 각 클래스를 다르게 구분한다는 것을 알 수 있 다. 본 발명의 일 실시예에 따른 3D CNN 딥러닝 모델을 통해 높은 정확도와 효율성으로 고위험 소장 폐쇄 환자를 감 지할 수 있다. [실시예] 다음 데이터 세트 정제 프로세스는 장폐색에 대한 응급 수술이 필요할 수 있는 고위험 그룹을 식별하기 위해 수 행되었다. 참가자는 1) 비수술 그룹(2000년 1월 1일에서 2021년 12월 31일 사이에 응급실을 방문하거나 장폐색 으로 병원에 입원한 환자), 2) 수술 그룹(같은 기간 동안 ASBO에 대한 접착 용해술을 받은 환자), 3) 정상 대상 자(2019년 건강 검진에서 복부 CT에서 비정상적인 소견이 없는 건강한 개인)의 세 그룹으로 구성되었다. 이때, 각 그룹에 대한 분류 성능을 높이기 위해 선별 기준(환자 나이, 의료진 소견 등)을 기초로 데이터 세트를 선별하거나, 그룹별 데이터 수의 균형을 맞추었다. 데이트 세트에 포함되는 선별 기준은 다음과 같다: 18세 이상, 장 폐쇄가 있는 CT 이미지 소견, 유착으로 인한 폐색 기전. 이 과정 이전에 2019년에 실시한 건강 검진에서 비정상적인 복부 CT 소견이 없는 정상인(n=1000)을 확인했다. 장폐색의 원인과 임상적 측면은 매우 다양하기 때문에 사례에 대한 자세한 검토가 필요했다. 비유착 기전, 다른 해부학적 위치 또는 악성, 복막염, 염증성 장 질환과 같은 병리적 상태로 인해 제외되었다. 또한, 가스트로그라 핀 사용과 1개월 이내에 수술 후 장폐색이 있는 사례는 제외되었다. 소장의 명백한 허혈 및 괴사도 제외되었다. 수술 및 비수술 그룹을 조사하여 고위험 장폐색 환자를 식별했다. 먼저 비수술 그룹에서 장폐색 관련 질환 분류 코드(ICD 코드와 유사)를 사용했다. 복부 CT 이미지를 사용할 수 없는 경우와 비접착성 급성 소장 폐쇄의 경우 를 제외했다. 고위험 소장 폐쇄의 경우 폐쇄 루프 소견, 접착성 밴드 또는 갑작스러운 내강 협착을 동반한 완전 또는 불완전 고등급 폐색 중 하나가 동반되었다. 저위험 소장 폐쇄의 경우 소장의 체액으로 가득 찬 팽창이 있 었고, 폐색 가능성이 낮거나 저등급 또는 부분적 폐색. 중 하나의 소견이 동반된 것으로 확인되었다. 수술 그룹에서 복부 수술을 받은 모든 환자는 병원에서 조사되었다. 사례는 접착성 SBO로 인한 접착 분해의 기 준에 따라 세분화되었다. 마지막으로 고등급 폐색 또는 졸림과 같은 수술 전 방사선 소견과 일치하는 접착 밴드 또는 닫힌 루프와 같은 고위험 수술 소견이 최종 코호트에 포함되었다. 최종적으로, 209개의 고위험 소장 폐쇄, 119개의 저위험 소장 폐쇄 및 250개의 정상 사례를 얻었고, 38,000개 이상의 CT 이미지가 사용되었다. 데이터 세트는 모델을 구축하기 위해 462개의 훈련 세트와 116개의 테스트 세 트로 나뉘었고, 5중 교차 검증이 수행되었다. 훈련 과정에서 50 에포크(epoch) 동안 코사인 어닐링 스케줄러(cosine annealing scheduler)를 사용하여 0.1의 학습률(learning rate), 5e-4 가중치 감소(weight decay), 0.01 학습률 감소(learning rate decay)를 갖는 확 률적 경사 하강 최적화기를 사용했다. 또한 플립, 감마, 노이즈, 모션, 바이어스 필드, 랜덤 아핀, 탄성 변형과 같은 경사 클리핑 및 효율적 데이터 증강 방법을 적용했다. 입력 이미지는 복셀 공간을 2로 리샘플링한 후 224 Х224Х112 픽셀로 자르고 패딩했다.분류 성능은 정확도, 민감도, 특이도 및 수신자 조작 특성 곡선 아래의 면적을 기준으로 평가되었다. 표 1은 제안된 네트워크가 정확도, 특이도, 민감도 및 AUROC 측면에서 좋은 성능을 보였음을 보여준다. 또한, 백본의 종류에 관계없이 본 발명을 적용한 딥러닝 모델은 항상 기본 딥러닝 모델보다 성능이 우수했다. 5중 교차 검증 후, 깊이 유지 풀링을 사용한 이중 분기 아키텍처를 사용하는 WideResNet 분류기는 모든 테스트 세트에서 정확도 72.6%, 수신자 조작 특성 아래의 면적 0.90, 민감도 72.6%, 특이도 86.3%, 양성 예측값 74.1%, 음성 예측값 86.6%를 달성했다. 표 1 Backbone Method 정확도 특이도 민감도 AUROC ResNet 기본 66.15 83.08 66.15 0.848 ± 0.05 본 발명 70.26 85.13 70.26 0.876 ± 0.02 ResNext 기본 68.46 84.23 68.46 0.874 ± 0.02 본 발명 66.41 83.21 66.41 0.883 ± 0.01 WideResNet 기본 65.13 82.56 65.13 0.861 ± 0.02 본 발명 72.56 86.28 72.56 0.896 ± 0.01 DenseNet 기본 75.12 83.83 62.81 0.868 ± 0.05 본 발명 72.68 83.28 63.41 0.873 ± 0.07 EfcientNet 기본 71.22 82.64 60.41 0.841 ± 0.04 본 발명 71.71 83.16 63.36 0.868 ± 0.03"}
{"patent_id": "10-2024-0129124", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 일 실시예에 따른 전자장치의 동작 모습을 도시한 개략도이다. 도 2는 본 발명의 일 실시예에 따른 전자장치의 구성을 도시한 블럭도이다. 도 3은 본 발명의 일 실시예에 따른 딥러닝 모델의 구조를 도시한 도면이다. 도 4는 본 발명의 일 실시예에 따른 전자장치의 동작 흐름도를 도시한 도면이다. 도 5는 본 발명의 일 실시예에 따른 딥러닝 모델과 기존 딥러닝 모델의 Grad-CAM을 이용한 히트맵을 도시한 도 면이다."}
