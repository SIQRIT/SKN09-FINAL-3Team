{"patent_id": "10-2023-0051256", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2024-0154833", "출원번호": "10-2023-0051256", "발명의 명칭": "시공간적 행동 그래프 기반의 이상 검출 장치", "출원인": "주식회사 큐버", "발명자": "박현용"}}
{"patent_id": "10-2023-0051256", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "카메라 영상에 관절 추론 알고리즘을 적용하여 이미지 프레임별로 스켈레톤 정보인 자세 랜드마크(poselandmarks)를 추출하는 스켈레톤 추출부(110); 상기 자세 랜드마크를 노드(nodes)로 설정하고 상기 자세 랜드마크들 간의 연결을 엣지(edges)로 설정하여 행동그래프(pose graph)를 생성하는 행동 그래프 생성부(120); 상기 행동 그래프에 포함된 상기 자세 랜드마크들의 시공간적 관계 및 변화를 그래프 합성곱 연산에 의해 분석하여 잠재 벡터(latent vector)를 추출하는 행동 그래프 분석부(130); 상기 추출된 잠재 벡터를 클러스터링하고 해당 클러스터가 정상행동에 대한 데이터 혼합 확률분포에서 정상 범위에 속할 확률에 의해 행동 이상 여부를 판단하는 행동 이상 검출부(140); 를 포함하여 구성되는 시공간적 행동 그래프 기반의 이상 검출 장치."}
{"patent_id": "10-2023-0051256", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "청구항 1에 있어서, 사용자 행동패턴 데이터 및 상기 행동 이동 검출부(140)의 행동 이상 판단에 대한 사용자 반응을 저장 관리하는행동패턴 데이터베이스(150);상기 행동패턴 데이터베이스(150)에 저장된 사용자 행동패턴 데이터와 사용자 반응을 통계 분석하여 상기 행동이상 검출부(140)의 이상 판단 임계치를 조정함으로써 상기 행동 이상 검출부(140)를 개인화시키는 이상검출 개인화부(160); 를 더 포함하여 구성되는 시공간적 행동 그래프 기반의 이상 검출 장치."}
{"patent_id": "10-2023-0051256", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "청구항 1 또는 2에 있어서, 상기 스켈레톤 추출부(110)는 카메라 영상의 각 이미지 프레임별로 3차원 공간에서 자세 랜드마크에 대한 x축,y축, z축의 실제좌표를 가리키는 좌표 벡터 형식으로 3차원의 특징 벡터(feature vector)를 추출하도록 구성되고, 상기 행동 그래프 생성부(120)는 이미지 프레임별로 상기 자세 랜드마크들을 나타내는 복수의 3차원 좌표 벡터들의 표현 형식을 상기 행동 그래프의 그래프 구조를 나타내는 다차원 행렬의 표현 형식으로 포맷을 전환하도록구성되는 것을 특징으로 하는 시공간적 행동 그래프 기반의 이상 검출 장치."}
{"patent_id": "10-2023-0051256", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "에 있어서, 상기 행동 그래프 분석부(130)는 상기 무향 그래프와 상기 유향 그래프를 인접행렬로 표현하고 ST-GCN 행동인식알고리즘을 적용하여 복수의 ST-GCN 모듈에서 특징을 얻은 후에 상기 ST-GCN 모듈에서 얻은 특징을 이용하여 잠재 벡터를 구성하도록 구성되는 것을 특징으로 하는 시공간적 행동 그래프 기반의 이상 검출 장치."}
{"patent_id": "10-2023-0051256", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "청구항 2에 있어서, 상기 이상검출 개인화부(160)는 상기 행동패턴 데이터베이스(150)를 참조하여 사용자 반응이 오류인 시점을 기준으로 일정 시간 범위를 해당 사용자의 표본공간으로 가정하고 상기 표본공간에서 얻어진 표본평균()과 표준편차(S)를 통해 해당 사용자의 모평균()을 추정하고, 상기 추정된 모평균()과 다른 사용자들의 평균 행동분포의 실제 평균(μ)과의 차이를 상기 행동 이상 검출부(140)의 이상 판단의 임계치에 대한 조정값(λ)으로 설정하여 임계치 갱신하도록 구성되는 것을 특징으로 하는 시공간적 행동 그래프 기반의 이상 검출 장치."}
{"patent_id": "10-2023-0051256", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "본 발명은 카메라 영상에서 추출한 사용자의 행동 그래프에 기초하여 사용자 행동을 시공간적으로 분석함으로써 행동 이상을 검출하고, 특정 사용자의 행동 패턴을 다른 사용자들의 행동 패턴과 대비하여 이상 판단 임계치를 특정 사용자에 개인화하는 기술에 관한 것이다. 본 발명에 따르면 행동 그래프 기반으로 행동의 시공간적 변화와 관계를 파악하여 이상을 검출하므로 대상의 모양, 카메라 각도, 배경 등의 노이즈를 배제하여 이상 검출의 정확 도를 높일 수 있고 웨어러블 기기나 센서를 부착해야 하는 번거로움을 해결하여 사용 편의성도 높은 장점이 있다. 또한, 본 발명에 따르면 앰비언트 컴퓨팅 환경에서 사용자 패턴을 재학습할 필요가 없기 때문에 컴퓨팅 부 담이 낮은 장점이 있다. 또한, 본 발명에 따르면 장애인이나 환자 등에 대해서도 개인화 알고리즘을 통해 동등 수준의 이상 검출 서비스를 제공할 수 있는 장점이 있다."}
{"patent_id": "10-2023-0051256", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 일반적으로 카메라 영상으로부터 사용자의 이상 상황을 검출하는 기술에 관한 것이다. 특히, 본 발명은 카메라 영상에서 추출한 사용자의 행동 그래프에 기초하여 사용자 행동을 시공간적으로 분석함 으로써 행동 이상을 검출하고, 특정 사용자의 행동 패턴을 다른 사용자들의 행동 패턴과 대비하여 이상 판단 임 계치를 특정 사용자에 개인화하는 기술에 관한 것이다."}
{"patent_id": "10-2023-0051256", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "일반적으로 센서, 이미지(영상), 관절 등의 데이터를 분석하여 사람의 행동을 인식하는 기술을 자세 추정(pose estimation)이라고 부른다. 자세 추정 기술은 컴퓨터 비전(computer vision)의 한 분야이며 스포츠, VR/AR, 게 임, 헬스케어, 자율주행 등 다양한 분야에서 활용되고 있다. 사람의 움직임을 컴퓨터가 인식하며, 이를 통해 각 각의 분야에서 다양한 서비스를 제공할 수 있게 해준다. 자세 추정 기술과 이상 검출(anomaly detection) 기술을 결합하여 서비스를 확장할 수 있다. 일반적으로 이상 검출 기술은 영상처리를 통해 자세나 행태를 인식하고 상황을 파악하는 기술이다. 이상 검출 기술은 스마트팩토 리, 스마트 로봇, 스마트 CCTV, 스마트폰 등 다양한 분야에 적용될 수 있는데, 예컨대 사람의 이상 행동을 탐지 함으로써 개인과 사회의 안전 위협(예: 범죄, 사고, 재난)에 대응할 수 있게 해줄 수 있다. 자세 추정 기술에 의해 획득한 사람의 동적인 행동 데이터를 이상 검출 기술에 의해 분석하여 유용한 서비스를 구현할 수 있다. 특히 앰비언트 컴퓨팅(ambient computing) 환경에서 스마트홈 플랫폼으로 확장하여 사용자의 실생활에서 위험상 황 인지나 자세 교정 등 스마트 헬스케어(smart healthcare) 측면에서 개인화된 서비스를 제공할 수 있다. 종래에 RGB 차원을 갖는 영상을 이용하여 이상을 검출하는 기술이 제시되었다. 그런데, 이 경우에는 대상의 모 양, 카메라 각도, 배경 등과 같은 다양한 외생변수에 이상 검출 결과가 영향 받는다. 사용자는 이상 검출 장치 를 인지하고 있지 않기 때문에 행동인식 처리에 적절하지 않은 이미지가 입력되는 경우가 많다. 배경으로부터 객체를 검출하여 대상의 행동을 인식하는 방법도 제시되었지만 여전히 객체 자체의 형상이나 카메라 각도가 이 상 검출에 있어 노이즈(noise)로서 작용된다. 또한, 웨어러블(wearable) 기기나 신체 부착형 센서를 통해 이상(예: 넘어짐, 충돌 등)을 검출하는 기술도 제시 되었다. 그런데, 이 방식에서는 사용자가 항상 장비를 착용해야 하기 때문에 앰비언트 컴퓨팅 및 스마트홈 환경 에 적용하기가 곤란하였다. 또한, 데이터의 시간에 따른 변화 혹은 패턴을 분석하여 이상 행동을 예측하는 기술도 제시되었다. 사람의 행동 데이터는 시퀀스(sequence) 데이터이므로 시계열 데이터를 처리할 수 있는 순환신경망(recurrent neural network) 기반의 인공지능 알고리즘을 통해 행동 패턴을 인식하는 것이 일반적이다. 그러나, 이러한 방식은 사 용자 행동 패턴의 시간적 변화를 모델링할 수는 있어도 해당 패턴들의 관계는 포착하기 어려운 단점을 가지고 있다. 한편, 사람의 행동에는 개인화된 패턴이 존재하기 때문에 기존의 공용화된 행동 패턴에 의한 이상 검출 알고리 즘은 오류 발생 확률이 높았다. 즉, False positive 오류(비정상행동을 정상행동으로 판단하는 오류)와 False negative 오류(정상행동을 비정상행동으로 판단하는 오류)가 자주 발생하였다. 선행기술문헌 특허문헌 (특허문헌 0001) 대한민국 공개특허 10-2023-0004421호 \"인공지능 기반의 이상행동 감지 시스템\" (특허문헌 0002) 대한민국 공개특허 10-2023-0038998호 \"이미지 분석을 이용한 이상행동 검출 방법 및 이를 위 한 전자 장치\" (특허문헌 0003) 대한민국 공개특허 10-2021-0062375호 \"심리상태 기반 이상행동 검출 장치 및 방법\""}
{"patent_id": "10-2023-0051256", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명의 목적은 일반적으로 카메라 영상으로부터 사용자의 이상 상황을 검출하는 기술을 제공하는 것이다. 특히, 본 발명의 목적은 카메라 영상에서 추출한 사용자의 행동 그래프에 기초하여 사용자 행동을 시공간적으로 분석함으로써 행동 이상을 검출하고, 특정 사용자의 행동 패턴을 다른 사용자들의 행동 패턴과 대비하여 이상 판단 임계치를 특정 사용자에 개인화하는 기술을 제공하는 것이다. 본 발명의 해결 과제는 이 사항에 제한되지 않으며 본 명세서의 기재로부터 다른 해결 과제가 이해될 수 있다."}
{"patent_id": "10-2023-0051256", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "상기의 목적을 달성하기 위하여 본 발명에 따른 시공간적 행동 그래프 기반의 이상 검출 장치는, 카메라 영상에 관절 추론 알고리즘을 적용하여 이미지 프레임별로 스켈레톤 정보인 자세 랜드마크(pose landmarks)를 추출하는 스켈레톤 추출부; 자세 랜드마크를 노드(nodes)로 설정하고 자세 랜드마크들 간의 연결을 엣지(edges)로 설정하여 행동 그래프(pose graph)를 생성하는 행동 그래프 생성부; 행동 그래프에 포함된 자세 랜드마크 들의 시공간적 관계 및 변화를 그래프 합성곱 연산에 의해 분석하여 잠재 벡터(latent vector)를 추출하는 행동 그래프 분석부; 그 추출된 잠재 벡터를 클러스터링하고 해당 클러스터가 정상행동에 대한 데이터 혼합 확 률분포에서 정상 범위에 속할 확률에 의해 행동 이상 여부를 판단하는 행동 이상 검출부;를 포함하여 구성 된다. 본 발명에 따른 시공간적 행동 그래프 기반의 이상 검출 장치는, 사용자 행동패턴 데이터 및 행동 이동 검출부 의 행동 이상 판단에 대한 사용자 반응을 저장 관리하는 행동패턴 데이터베이스; 행동패턴 데이터베 이스에 저장된 사용자 행동패턴 데이터와 사용자 반응을 통계 분석하여 행동 이상 검출부의 이상 판 단 임계치를 조정함으로써 행동 이상 검출부를 개인화시키는 이상검출 개인화부;를 더 포함하여 구성 될 수 있다. 이때, 스켈레톤 추출부는 카메라 영상의 각 이미지 프레임별로 3차원 공간에서 자세 랜드마크에 대한 x축, y축, z축의 실제좌표를 가리키는 좌표 벡터 형식으로 3차원의 특징 벡터를 추출하도록 구성된다. 이때, 행동 그 래프 생성부는 이미지 프레임별로 자세 랜드마크들을 나타내는 복수의 3차원 좌표 벡터들의 표현 형식을 행동 그래프의 그래프 구조를 나타내는 다차원 행렬의 표현 형식으로 포맷을 전환하도록 구성될 수 있다. 이때, 행동 그래프 생성부는 행동 그래프에서 동일 시간에서 자세 랜드마크들을 연결한 엣지는 자세 랜드 마크들의 공간적인 관계의 특징을 반영한 무향 그래프로 표현하고, 행동 그래프에서 시간 진행에 대하여 동일 자세 랜드마크를 연결한 엣지는 자세 랜드마크들의 시간적인 관계 속에서 공간적 특징을 반영한 유향 그래프로표현하도록 구성될 수 있다. 또한, 행동 그래프 분석부는 무향 그래프와 유향 그래프를 인접행렬로 표현하고 ST-GCN 행동인식 알고리즘 을 적용하여 복수의 ST-GCN 모듈에서 특징을 얻은 후에 ST-GCN 모듈에서 얻은 특징을 이용하여 잠재 벡터를 구 성하도록 구성될 수 있다. 또한, 이상검출 개인화부는 행동패턴 데이터베이스를 참조하여 사용자 반응이 오류인 시점을 기준으 로 일정 시간 범위를 해당 사용자의 표본공간으로 가정하고 표본공간에서 얻어진 표본평균()과 표준편차(S)를 통해 해당 사용자의 모평균()을 추정하고, 그 추정된 모평균()과 다른 사용자들의 평균 행동분포의 실제 평 균(μ)과의 차이를 행동 이상 검출부의 이상 판단의 임계치에 대한 조정값(λ)으로 설정하여 임계치 갱신 하도록 구성될 수 있다. 한편, 본 발명에 따른 컴퓨터프로그램은 컴퓨터에 이상과 같은 시공간적 행동 그래프 기반의 이상 검출 장치의 동작 프로세스를 실행시키기 위하여 비휘발성 저장매체에 저장된 것이다."}
{"patent_id": "10-2023-0051256", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명에 따르면 행동 그래프 기반으로 행동의 시공간적 변화와 관계를 파악하여 이상을 검출하므로 대상의 모 양, 카메라 각도, 배경 등의 노이즈를 배제하여 이상 검출의 정확도를 높일 수 있고 웨어러블 기기나 센서를 부 착해야 하는 번거로움을 해결하여 사용 편의성도 높은 장점이 있다. 또한, 본 발명에 따르면 앰비언트 컴퓨팅 환경에서 사용자 패턴을 재학습(retraining)할 필요가 없기 때문에 컴 퓨팅 부담이 낮은 장점이 있다. 또한, 본 발명에 따르면 장애인이나 환자 등에 대해서도 개인화 알고리즘을 통해 동등 수준의 이상 검출 서비스 를 제공할 수 있는 장점이 있다."}
{"patent_id": "10-2023-0051256", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "이하에서는 도면을 참조하여 본 발명을 상세하게 설명한다. 본 발명을 설명함에 있어서 종래기술과 중복되는 부분에 대해서는 자세한 설명을 생략할 수 있다. [도 1]은 본 발명에 따른 시공간적 행동 그래프 기반의 이상 검출 장치의 일 실시예 구성도를 나타낸다. 본 발명의 이상 검출 장치는 카메라 영상에서 사용자의 행동 데이터를 추출하고, 사용자 행동 패턴을 분석 하여 이상(anomaly) 발생을 검출한다. 그리고, 이상 검출(anomaly detection) 결과를 서비스 서버로 제공 하여 특정의 서비스가 구현되도록 한다. 본 발명의 이상 검출 장치는 앰비언트 컴퓨팅 환경에 양호하게 활 용될 수 있다. 이때, 카메라의 일 예로는 스마트 홈 디바이스에 장착된 카메라 모듈을 들 수 있다. 또한, 본 명세서에서는 사용자 행동 패턴으로 보행 자세 혹은 보행 움직임 패턴을 기준으로 설명한다. 즉, 평소 보행시에 보이던 것과 는 상이한 움직임 패턴, 예컨대 비틀거림, 절뚝거림, 다리를 저는 동작 등이 이상으로 검출된다. 본 발명에 따른 이상 검출 장치는 스켈레톤 추출부, 행동 그래프 생성부, 행동 그래프 분석부 , 행동 이상 검출부, 행동패턴 데이터베이스, 이상검출 개인화부를 포함하여 구성된다. [도 1]에는 이들 구성요소가 단독 장치에 구비된 것으로 도시되어 있으나, 이들 중에서 일부가 네트워크를 통해 원격지의 서버 또는 클라우드에 설치되는 것도 가능하다. 예를 들어, [도 2]의 실시예에서는 이상 검출 장치 의 외부에 개인화 서버가 마련되어 있고, 행동패턴 데이터베이스와 이상검출 개인화부는 개인화 서버에 설치되어 있다. 스켈레톤 추출부와 행동 그래프 생성부와 행동 그래프 분석부와 행동 이상 검출부에 의해 사용자 행동을 분석하여 이상을 검출할 수 있다. 또한, 이상검출 개인화부에 의해 특정 사용자의 행동 패 턴을 다른 사용자들의 행동 패턴과 대비함으로써 특정 사용자에 맞도록 행동 이상 검출부의 이상 판단 임 계치를 개인화한다. 이때, 행동패턴 데이터베이스는 사람들의 행동패턴 데이터를 저장 관리한다. 먼저, 스켈레톤 추출부는 카메라 영상에 관절 추론 알고리즘(예: brazepose)을 적용하여 이미지 프레임별 로 스켈레톤(skeleton) 정보인 자세 랜드마크(pose landmarks)를 추출한다. [도 3]은 본 발명에서 스켈레톤 추 출부가 카메라 영상으로부터 자세 랜드마크를 추출하는 개념도이다. 스켈레톤 추출부는 카메라 영상 을 구성하는 일련의 프레임 이미지로부터 사람의 얼굴, 손, 팔, 허벅지 등에 대응하는 관절 특징점을 추출한다. 이들 관절 특징점을 사람의 형상을 참조하여 연결하면 사람의 자세에 대응하므로 본 명세서에서는 자세 랜드마 크라고 부른다. 스켈레톤 추출부는 카메라 영상의 한 프레임당 이미지별로 스켈레톤 정보(자세 랜드마크 정보)를 나타내는 3차원의 특징 벡터(feature vector)를 추출한다. 특징 벡터는 3차원 공간에서 자세 랜드마크에 대한 x축, y축, z축의 실제좌표(real world coordinates)를 가리키는 좌표 벡터(coordinate vector) 형식으로 표현되는데, 엉 덩이 사이의 중심을 좌표의 원점으로 삼는다. 행동 그래프 생성부는 그 추출된 자세 랜드마크를 그래프 형식으로 표현하여 감시대상에 대한 행동 그래프 (pose graph)를 생성한다. 이때, 그 추출된 자세 랜드마크들을 노드(nodes)로 설정하고 자세 랜드마크들 간의 연결을 엣지(edges)로 설정한다. 이를 통해, 이미지 프레임별로 자세 랜드마크들을 나타내는 복수의 3차원 좌표 벡터들의 표현 형식은 그래프 구조(행동 그래프)를 나타내는 다차원 행렬의 표현 형식으로 포맷이 전환된다. 이 때, 행동 그래프에서 동일 시간에서 자세 랜드마크들을 연결한 엣지는 무향 그래프(undirected graph)로 표현하 고, 시간 진행에 대하여 동일 자세 랜드마크를 연결한 엣지는 유향 그래프(directed graph)로 표현한다. [도 4]와 [도 5]는 본 발명에서 행동 그래프 생성부가 자세 랜드마크로부터 행동 그래프를 생성하는 개념 도이다. 구체적으로, [도 4]는 자세 랜드마크에 대해 무향 그래프를 설정하는 개념도이고, [도 5]는 본 발명에 서 자세 랜드마크에 대해 유향 그래프를 설정하는 개념도이다. 무향 그래프는 동일 시간에서 자세 랜드마크들을 연결하므로 자세 랜드마크들의 공간적인 관계의 특징을 반영한다. 또한, 유향 그래프는 시간 진행에 따라 동일 감시대상의 동일 자세 랜드마크를 연결하므로 자세 랜드마크들의 시간적인 관계 속에서 공간적 특징을 반영한다. 행동 그래프 분석부는 행동 그래프에 포함된 자세 랜드마크들의 시공간적 관계 및 변화를 분석하여 잠재 벡터(latent vector)를 추출한다. [도 6]은 본 발명에서 행동 그래프 분석부가 행동 그래프를 분석하여 잠 재 벡터를 추출하는 개념을 나타낸다. 동일 시간에서 자세 랜드마크들(예: 관절들)을 연결하는 무향 그래프는 자세 랜드마크들의 공간적인(temporal) 관계의 특징을 나타내고, 시간 진행에 대하여 동일 자세 랜드마크(예: 관절 포인트)를 연결하는 유향 그래프는 시간적인 관계 속에서 공간적 특징을 나타낸다. 이들 무향 그래프와 유향 그래프는 인접행렬(adjacency matrix)로서 표현 가능하다. 인접행렬은 그래프에서 각 노드들 간의 연결 관계인 엣지의 존재 여부를 행렬로 표현한 것이다. 일반적으로 그래프에서 노드가 n개이면 인 접행렬은 각 노드번호를 행과 열로 하는 nxn 정사각행렬이다. 그래프 특징 벡터와 가중치 벡터와 함께 그래프 합성곱(Graph convolution) 연산(예: ST-GCN)을 통해 시공간적 관계를 설명하는 의미론적 특징 벡터로 변환될 수 있다. 본 명세서에서는 이 특징 벡터를 잠재 벡터(latent vector)라고 부른다. 일 실시예로, 행동 그래프 분석부는 ST-GCN(Spatial Temporal Graph Convolutional Network) 행동인식 알 고리즘에 의해 행동 패턴들의 시간적(temporal) 변화 및 공간적(temporal) 관계를 모델링하고 행동 그래프로부 터 잠재 벡터를 얻을 수 있다. [도 7]은 ST-GCN 행동인식 알고리즘의 개념도이다. 일반적으로 ST-GCN 행동인식 알고리즘에서는 입력 영상으로 부터 스켈레톤 정보를 추출하고 이를 그래프 형태로 만든 후에 스켈레톤 정보의 각각의 조인트(joint)를 노드로 만들고 이들 노드가 이어지는 부분(공간, 시간)을 엣지로 연결한다. 그리고 나서, 총 9개의 ST-GCN 모듈을 통해 특징(features)을 추출하고, softmax 함수를 이용하여 행동을 분류한다. 따라서, 본 발명에서는 행동 그래프의 무향 그래프와 유향 그래프를 인접행렬로 표현하고, 여기에 ST-GCN 행동 인식 알고리즘을 적용함으로써 9개의 ST-GCN 모듈에서 특징(features)을 얻는다. 그리고 나서, 9개의 ST-GCN 모 듈에서 얻은 특징을 이용하여 특징 벡터를 구성할 수 있는데, 본 명세서에서는 이를 잠재 벡터라고 부른다. 또한, 행동 그래프의 중요한 노드에 가중치를 부여하는 어텐션(attention) 메커니즘을 적용한 인접행렬을 추가 하여 관절의 시공간적 관계를 포착하는데 있어 중요한 요소를 분석할 수 있다. 이 과정을 통해 일반 사용자의 실시간 행동들은 입력 프레임마다 변화하는 그래프 특징 벡터로 표현되며, 관절의 시공간적 관계성 및 변동성을 표현한다. 행동 이상 검출부는 그 추출된 잠재 벡터를 클러스터링하고 해당 클러스터의 통계량을 기반으로 행동 이상 여부를 판단한다. 바람직한 일 실시예로서, 본 발명에서 사용한 클러스터링(예: Dirlchlet process mixture model) 방법론은 비모 수(non-parametric) 베이지안 모델(bayesian model)을 따르며 군집 수 k는 무한대의 범위를 가진다. 따라서 데 이터를 학습하면서 군집 k는 학습 데이터 내 정상행동의 범주 개수까지 무한히 설정되며, 결국 해당 클러스터 분포는 정상행동에 대한 데이터 혼합 확률분포(Mixture probability distribution)를 나타낸다. 일반 사용자의 실시간으로 입력되는 잠재 벡터들은 클러스터링 기법을 통해 k개의 군집들에 속할 확률(정상 범 위에 속할 확률)을 계산하며, 유추되는 k 군집에 속할 확률이 일정 임계치(threshold)를 넘지 못하는 경우 비정 상 행동(즉, 행동 이상)으로 간주된다. 이때, 입력값이 해당하는 k군집의 확률분포와 예측 확률분포와의 엔트로 피의 차이(예: KL-Divergence)값을 정상행동의 정도를 나타내는 점수, 즉 정상성 스코어(normality score)로 산 출한다. 수학식 1"}
{"patent_id": "10-2023-0051256", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "개념적으로는 해당 사용자에 대해 프레임마다 자세 랜드마크(관절 특징점)를 추출하고, 그래프 공간에 매핑하여 행동의 정상성(normality)을 판단한다. 행동 이상 검출부는 비정상 행동(예: 넘어짐, 장시간 기어다님, 평 소 걸음걸이와 상이한 패턴 등)이 카메라 영상에 포함되어 있는 경우에, 잠재 벡터의 클러스터가 평소의 정상 범위에 포함될 확률이 매우 낮게 산출됨에 따라 행동 이상이라고 판단하게 된다. 평소의 정상 범위는 해당 사용 자의 평소 걸음걸이로부터 축적된다. 행동 이상은 비정상 행동, 즉 anomaly 상황을 폭넓게 포함한다. 예를 들어 넘어짐, 장시간 기어다님, 평소 걸음걸이와 상이한 걸음 패턴 등을 포함할 수 있고 몸에 이상이 발생한 경우나 다친 경우를 포함할 수 있다. 행동패턴 데이터베이스는 사람들의 행동패턴 데이터(예: 행동 그래프, 잠재 벡터, 정상성 스코어 등)를 저 장 관리한다. 또한, 행동패턴 데이터베이스는 행동 이상 검출부가 행동 이상이라고 판단한 경우에 대 한 사용자 반응(예: 무응답, 맞게 판단하였다는 사용자 피드백, 잘못 판단하였다는 사용자 피드백)도 저장 관리 한다. 이상검출 개인화부는 행동패턴 데이터베이스에 저장된 사용자 행동패턴 데이터와 사용자 반응을 통계 분석하여 행동 이상 검출부의 이상 판단 임계치를 조정함으로써 행동 이상 검출부를 해당 사용자에 맞게 개인화시킨다. 개념적으로는 해당 사용자의 정상 및 비정상에 따른 행동 패턴 분포와 다양한 사용자의 행 동 분포와의 차이를 기반으로 행동 이상 검출부의 정상 또는 이상의 기준이 되는 임계치(threshold)를 조 정한다. 예를 들어, 걸음걸이는 개인별로 동작의 차이가 있으므로 일반인의 평균 걸음걸이와 특정 사용자의 걸음걸이 간 에는 형태적으로 차이가 있을 수 있다. 처음에는 행동 이상 검출부가 일반인의 평균 걸음걸이로 이상 여부 를 판단한다. 이상검출 개인화부는 일반인의 걸음걸이 대비하여 해당 사용자의 걸음걸이 패턴을 빠르게 추 정하고, 그 추정된 걸음걸이 패턴에 맞도록 행동 이상 검출부의 판단 기준을 조정해주는 것이다. [도 8]은 본 발명에서 이상검출 개인화부가 이상 검출 기준(임계치)을 개인화하는 개념도이다. [도 8]을 참조하면, 본 발명에서 이상검출 개인화부가 행동 이상 검출부를 개인화하는 과정은 2단계로 이루어 질 수 있다. 먼저, 이상검출 개인화부는 t-분포를 이용한 평균추정에 의해 임계치를 조정한다. 행동패턴 데이터베이스는 정상행동 여부 점수(정상성 스코어)를 저장 관리하는데, 이 정상성 스코어는 일 종의 확률분포를 이루는 것으로 가정할 수 있다. 행동패턴 데이터베이스에 저장되는 해당 사용자의 행동패 턴 데이터(사용자 행동패턴 데이터)를 토대로 다른 사용자들의 정상 행동패턴의 평균을 추정하고 실제 평균과의 차이를 통해 특정 사용자의 행동 이상 검출부의 임계치 조정값(λ)을 산정한다. 특정 사용자의 행동패턴에서 오류가 발생한 시점을 기준으로 일정 시간 범위를 해당 사용자의 표본공간으로 가 정한다. 이때, 표본공간이 정규분포를 따르도록 충분한 표본 크기(예: 30 이상)가 포함될 수 있게 시간 범위를 설정한다. 예를 들어, 행동패턴에서 오류가 발생한 시점을 기준으로 ±15 시간만큼의 시간 범위를 설정하면 표 본공간에는 31개의 표본이 포함된다. 평균 추정을 위하여, 행동패턴 데이터베이스에 저장된 다른 사용자들의 동일한 시점의 행동분포를 정규분 포를 따르는 모수공간으로 가정하고, 표본공간에서 얻어진 표본평균()과 표준편차(S)를 통해 모평균()을 추 정한다. 그리고, 특정 사용자의 행동패턴 데이터의 분포를 통해 추정된 모평균()과 다른 사용자들의 평균 행동 분포의 실제 평균(μ)과의 차이를 특정 사용자의 행동 이상 검출부가 이상 여부 판단에 사용하는 임계치의 조정값(λ)으로 설정한다. 수학식 2"}
{"patent_id": "10-2023-0051256", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "다음으로, 이상검출 개인화부는 조정값(λ)에 의해 행동 이상 검출부를 개인화한다. 위의 [수학식 2]에서 산출한 조정값(λ)이 갖는 의미는 해당 사용자에 대해 행동 이상 검출부가 높거나 낮 은 임계치를 적용함으로 인해 오류 상황(False positive 오류, False negative 오류)이 발생하고 있으므로, 해 당 상황이 정상 행동일 경우의 모수공간 분포를 추정하여 다른 사용자의 정상행동에 따른 실제 분포를 해당 사 용자의 추정분포에 근사시킨다는 것이다. 그에 따라, 해당 사용자를 위한 행동 이상 검출부의 기존 임계치(Τ)와 조정값(λ)의 연산을 통해 임계치 갱신을 진행한다. 이를 통해 해당 오류(False positive 오류, False negative 오류)를 범한 행동패턴은 동일한 오류를 범하지 않게 되며, 이를 본 발명에서는 행동 이상 검출부의 개인화라고 부른다. 수학식 3"}
{"patent_id": "10-2023-0051256", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 4, "content": "한편, 본 발명은 컴퓨터가 읽을 수 있는 비휘발성 기록매체에 컴퓨터가 읽을 수 있는 코드의 형태로 구현되는 것이 가능하다. 이러한 비휘발성 기록매체로는 다양한 형태의 스토리지 장치가 존재하는데 예컨대 하드디스크, SSD, CD-ROM, NAS, 자기테이프, 웹디스크, 클라우드 디스크 등이 있다. 또한, 본 발명은 하드웨어와 결합되어 특정의 절차를 실행시키기 위하여 매체에 저장된 컴퓨터프로그램의 형태로 구현될 수도 있다. 부호의 설명 100 : 이상 검출 장치 110 : 스켈레톤 추출부 120 : 행동 그래프 생성부 130 : 행동 그래프 분석부 140 : 행동 이상 검출부 150 : 행동패턴 데이터베이스 160 : 이상검출 개인화부 200 : 서비스 서버 300 : 개인화 서버"}
{"patent_id": "10-2023-0051256", "section": "도면", "subsection": "도면설명", "item": 1, "content": "[도 1]은 본 발명에 따른 이상 검출 장치의 일 실시예 구성도. [도 2]는 본 발명에 따른 이상 검출 장치의 다른 실시예 구성도. [도 3]은 본 발명에서 카메라 영상에서 자세 랜드마크를 추출하는 개념도. [도 4]는 본 발명에서 자세 랜드마크로부터 무향 그래프를 설정하는 개념도. [도 5]는 본 발명에서 자세 랜드마크로부터 유향 그래프를 설정하는 개념도. [도 6]은 본 발명에서 행동 그래프를 분석하여 이상을 검출하는 개념도. [도 7]은 ST-GCN 행동인식 알고리즘의 개념도. [도 8]은 본 발명에서 이상 검출 기준을 개인화하는 개념도."}
