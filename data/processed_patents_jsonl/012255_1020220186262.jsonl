{"patent_id": "10-2022-0186262", "section": "특허_기본정보", "subsection": "특허정보", "content": {"공개번호": "10-2024-0103777", "출원번호": "10-2022-0186262", "발명의 명칭": "MS Word 문서형 악성코드 분석 및 학습데이터 생성 방법 및 이를 수행하는 시스템", "출원인": "한국과학기술원", "발명자": "조호묵"}}
{"patent_id": "10-2022-0186262", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_1", "content": "분석 대상 파일을 구분하고 구분된 파일로부터 인자를 수집하는 파싱 모듈;상기 수집된 인자로부터 탐지 규칙에 따라 위협을 탐지하는 분석 모듈; 및상기 분석 모듈이 탐지한 위협 인자의 정보와 탐지 규칙을 학습데이터로 저장하는 저장 모듈을 포함하는,MS Word 문서형 악성코드 분석 및 학습데이터 생성 시스템."}
{"patent_id": "10-2022-0186262", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_2", "content": "제 1 항에 있어서,상기 파싱 모듈은,상기 분석 대상 파일인 MS Word 문서 파일의 형식을 구분하는 버전 검사부;상기 구분된 분석 대상 파일의 위험 인자 영역을 분류하고 추출 대상의 인자를 식별하는 파서부;상기 식별된 인자의 난독화 및 압축을 해제하는 압축 해제부; 및상기 난독화 및 압축이 해제된 인자를 텍스트 형식으로 저장하는 인자 수집부를 포함하는,MS Word 문서형 악성코드 분석 및 학습데이터 생성 시스템."}
{"patent_id": "10-2022-0186262", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_3", "content": "제 2항에 있어서, 상기 버전 검사부가 구분한 MS Word 문서 파일이 OOXML인 경우,상기 추출부는 매크로 스크립트가 추가된 경우 생성되는 vbaProject.bin을 식별하고,상기 압축 해제부는 바이너리 형태의 상기 vbaProject.bin을 Run-Length 기법으로 압축 해제하는,MS Word 문서형 악성코드 분석 및 학습데이터 생성 시스템."}
{"patent_id": "10-2022-0186262", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_4", "content": "제 1항에 있어서,상기 분석 모듈은, 상기 수집된 인자로부터 VBA 스크립트를 식별하여 탐지 규칙에 따라 위협을 탐지하는,MS Word 문서형 악성코드 분석 및 학습데이터 생성 시스템."}
{"patent_id": "10-2022-0186262", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_5", "content": "제 4항에 있어서,상기 식별된 VBA 스크립트는,AutoOpen, Document_Open, DocumentOpen, URLDownloadToFileA, Msxml2.XMLHTTP, Uer-Agent, Call, Shell,vbNormal, Wscript.shell, Run, Environ, Open, Write, Put, Output, Print 중 적어도 어느 하나를 포함하는,MS Word 문서형 악성코드 분석 및 학습데이터 생성 시스템."}
{"patent_id": "10-2022-0186262", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_6", "content": "공개특허 10-2024-0103777-3-분석 대상 파일을 구분하고 구분된 파일로부터 인자를 수집하는 단계;상기 수집된 인자로부터 탐지 규칙에 따라 위협을 탐지하는 단계; 및상기 탐지된 위협 인자의 정보와 탐지 규칙을 학습데이터로 저장하는 단계를 포함하는,MS Word 문서형 악성코드 분석 및 학습데이터 생성 방법."}
{"patent_id": "10-2022-0186262", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_7", "content": "제 6항에 있어서,상기 분석 대상 파일을 구분하고 구분된 파일로부터 인자를 수집하는 단계는,상기 분석 대상 파일인 MS Word 문서 파일의 형식을 구분하는 단계;상기 구분된 분석 대상 파일의 위험 인자 영역을 분류하고 추출 대상의 인자를 식별하는 단계;상기 식별된 인자의 난독화 및 압축을 해제하는 단계; 및상기 난독화 및 압축이 해제된 인자를 텍스트 형식으로 저장하는 단계를 포함하는,MS Word 문서형 악성코드 분석 및 학습데이터 생성 방법."}
{"patent_id": "10-2022-0186262", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_8", "content": "제 7항에 있어서,상기 구분된 MS Word 문서 파일의 형식이 OOXML인 경우,상기 구분된 분석 대상 파일의 위험 인자 영역을 식별하는 단계는 매크로 스크립트가 추가된 경우 생성되는vbaProject.bin을 식별하는 단계를 포함하고,상기 식별된 인자의 난독화 및 압축을 해제하는 단계는 바이너리 형태의 상기 vbaProject.bin을 Run-Length 기법으로 압축 해제하는 단계를 포함하는,MS Word 문서형 악성코드 분석 및 학습데이터 생성 방법."}
{"patent_id": "10-2022-0186262", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_9", "content": "제 6항에 있어서,상기 수집된 인자로부터 탐지 규칙에 따라 위협을 탐지하는 단계는,상기 수집된 인자로부터 VBA 스크립트를 식별하여 탐지 규칙에 따라 위협을 탐지하는 단계를 포함하는,MS Word 문서형 악성코드 분석 및 학습데이터 생성 방법."}
{"patent_id": "10-2022-0186262", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_10", "content": "제 9항에 있어서,상기 식별된 VBA 스크립트는,AutoOpen, Document_Open, DocumentOpen, URLDownloadToFileA, Msxml2.XMLHTTP, Uer-Agent, Call, Shell,vbNormal, Wscript.shell, Run, Environ, Open, Write, Put, Output, Print 중 적어도 어느 하나를 포함하는,MS Word 문서형 악성코드 분석 및 학습데이터 생성 방법."}
{"patent_id": "10-2022-0186262", "section": "청구범위", "subsection": "청구항", "claim_number": "청구항_11", "content": "컴퓨터를 이용하여 제 6항 내지 제 10항의 방법 중 어느 한 항의 방법을 실행시키기 위한 프로그램을 기록한 상기 컴퓨터로 판독 가능한 기록매체에 저장된 컴퓨터 프로그램."}
{"patent_id": "10-2022-0186262", "section": "발명의_설명", "subsection": "요약", "paragraph": 1, "content": "MS Word 문서형 악성코드 분석 및 학습데이터 생성 방법 및 이를 수행하는 시스템이 제공된다. MS Word 문서형 악성코드 분석 및 학습데이터 생성 시스템은 분석 대상 파일을 구분하고 구분된 파일로부터 인자를 수집하는 파 싱 모듈; 상기 수집된 인자로부터 탐지 규칙에 따라 위협을 탐지하는 분석 모듈; 및 상기 분석 모듈이 탐지한 위 협 인자의 정보와 탐지 규칙을 학습데이터로 저장하는 저장 모듈을 포함한다."}
{"patent_id": "10-2022-0186262", "section": "발명의_설명", "subsection": "기술분야", "paragraph": 1, "content": "본 발명은 MS Word 문서형 악성코드 분석 및 학습데이터 생성 방법 및 이를 수행하는 시스템에 관한 것으로, 구 체적으로 MS Word 문서 파일에 포함된 분리된 스크립트로부터 위협 인자를 식별 및 추출함으로써 삽입 및 은닉 된 악성 스크립트를 분석하고, 분석 결과로부터 탐지 모델 생성을 위한 학습데이터를 생성할 수 있는 방법 및 이를 수행하는 시스템에 관한 것이다."}
{"patent_id": "10-2022-0186262", "section": "발명의_설명", "subsection": "배경기술", "paragraph": 1, "content": "최근 증가하는 국내외 사이버 위협 발생 사례에 따르면 공격자들은 다양한 경로와 공격 방법을 통해 악성코드를 유포하고 있으며, 그 중 대표적인 것이 전자문서로 위장하여 이메일 또는 메신저 등의 경로를 통해 무작위적으 로 유포되는 사례이다. 사용자가 내려받은 문서형 파일을 열람 또는 편집하기 위해 프로그램을 이용하여 문서형 파일을 열면 실행과 동시에 사용 중인 PC는 악성코드에 감염된다. 이러한 문서형 파일에 내재된 악성코드는 기존의 악성코드와는 다르게 문서별로 포맷 및 구조가 상이하여 기존 의 실행파일 위주의 악성코드 탐지 방법과는 달리 문서의 식별 및 포맷 분석 과정이 필요하다. 또한 위협 인자 가 난독화되어 있거나, 원격 실행 코드 및 제로데이 취약점을 교묘히 이용하기 때문에 기존의 보안솔루션을 쉽 게 우회할 수 있고, 네트워크 기반에서 효율적인 실시간 분석 및 탐지에 한계가 발생한다. 대표적인 문서형 파일인 MS OFFICE Word 파일의 신속한 분석을 위해서는 선행적으로 문서의 구조를 분해하여 위 험 영역을 분리하고, 분리된 영역에서 위협 인자를 식별 및 추출해야 한다. 영역별로 식별된 위협 인자의 난독 화 방식이 제각기 다를 수 있으므로 탐지의 효율 및 정확성 향상을 위해 추출된 데이터의 복호화, 난독화 해제 과정이 필수적이다. 또한, 빠르게 발전하는 변종 악성코드의 생성 속도에 대응하기 위하여 기존의 정적 분석 및 동적 분석 방식에 더하여 인공지능(Artificial Intelligence: AI) 알고리즘을 활용하여 문서형 악성코드를 탐지하는 방식이 소개 되고 있다. 문서형 악성코드를 탐지하기 위한 효율적인 인공지능 모델을 만들기 위해서는, 문서형 악성코드로부 터 위협 인자를 수집하고 위협 인자의 탐지 규칙과 함께 학습데이터로 저장함으로써 다량의 데이터를 보유할 필 요성이 있다."}
{"patent_id": "10-2022-0186262", "section": "발명의_설명", "subsection": "해결하려는과제", "paragraph": 1, "content": "본 발명이 해결하고자 하는 기술적 과제는 제공된 MS Word 문서 파일로부터 악성코드의 존재를 식별할 수 있는 위협 인자의 추출 및 분석 결과로부터 문서형 악성코드 탐지 모델 생성을 위한 학습데이터를 생성할 수 있는 방 법 및 이를 수행하는 시스템에 관한 것이다. 본 발명의 기술적 과제들은 이상에서 언급한 기술적 과제로 제한되지 않으며, 언급되지 않은 또 다른 기술적 과 제들은 아래의 기재로부터 당업자에게 명확하게 이해될 수 있을 것이다."}
{"patent_id": "10-2022-0186262", "section": "발명의_설명", "subsection": "과제의해결수단", "paragraph": 1, "content": "상술한 기술적 과제를 해결하기 위한 본 발명의 실시예에 따른 문서형 악성코드 분석 및 학습데이터 생성 시스 템은, 분석 대상 파일을 구분하고 구분된 파일로부터 인자를 수집하는 파싱 모듈; 상기 수집된 인자로부터 탐지 규칙에 따라 위협을 탐지하는 분석 모듈; 및 상기 분석 모듈이 탐지한 위협 인자의 정보와 탐지 규칙을 학습데 이터로 저장하는 저장 모듈을 포함한다. 본 발명의 몇몇 실시예에서, 상기 파싱 모듈은, 상기 분석 대상 파일인 MS Word 문서 파일의 형식을 구분하는 버전 검사부; 상기 구분된 분석 대상 파일의 위험 인자 영역을 분류하고 추출 대상의 인자를 식별하는 파서부; 상기 식별된 인자의 난독화 및 압축을 해제하는 압축 해제부; 및 상기 난독화 및 압축이 해제된 인자를 텍스트 형식으로 저장하는 인자 수집부를 포함할 수 있다. 본 발명의 몇몇 실시예에서, 상기 버전 검사부가 구분한 MS Word 문서 파일이 OOXML인 경우, 상기 추출부는 매 크로 스크립트가 추가된 경우 생성되는 vbaProject.bin을 식별하고, 상기 압축 해제부는 바이너리 형태의 상기 vbaProject.bin을 Run-Length 기법으로 압축 해제할 수 있다. 본 발명의 몇몇 실시예에서, 상기 분석 모듈은, 상기 수집된 인자로부터 VBA 스크립트를 식별하여 탐지 규칙에 따라 위협을 탐지할 수 있다. 본 발명의 몇몇 실시예에서, 상기 식별된 VBA 스크립트는, AutoOpen, Document_Open, DocumentOpen, URLDownloadToFileA, Msxml2.XMLHTTP, Uer-Agent, Call, Shell, vbNormal, Wscript.shell, Run, Environ, Open, Write, Put, Output, Print 중 적어도 어느 하나를 포함할 수 있다. 상술한 기술적 과제를 해결하기 위한 본 발명의 실시예에 따른 MS Word 문서형 악성코드 분석 및 학습데이터 생 성 방법은, 분석 대상 파일을 구분하고 구분된 파일로부터 인자를 수집하는 단계; 상기 수집된 인자로부터 탐지 규칙에 따라 위협을 탐지하는 단계; 및 상기 탐지된 위협 인자의 정보와 탐지 규칙을 학습데이터로 저장하는 단 계를 포함한다. 본 발명의 몇몇 실시예에서, 상기 분석 대상 파일을 구분하고 구분된 파일로부터 인자를 수집하는 단계는, 상기 분석 대상 파일인 MS Word 문서 파일의 형식을 구분하는 단계; 상기 구분된 분석 대상 파일의 위험 인자 영역을 분류하고 추출 대상의 인자를 식별하는 단계; 상기 식별된 인자의 난독화 및 압축을 해제하는 단계; 및 상기 난 독화 및 압축이 해제된 인자를 텍스트 형식으로 저장하는 단계를 포함할 수 있다. 본 발명의 몇몇 실시예에서, 상기 구분된 MS Word 문서 파일의 형식이 OOXML인 경우, 상기 구분된 분석 대상 파 일의 위험 인자 영역을 식별하는 단계는 매크로 스크립트가 추가된 경우 생성되는 vbaProject.bin을 식별하는 단계를 포함하고, 상기 식별된 인자의 난독화 및 압축을 해제하는 단계는 바이너리 형태의 상기 vbaProject.bin 을 Run-Length 기법으로 압축 해제하는 단계를 포함할 수 있다. 본 발명의 몇몇 실시예에서, 상기 수집된 인자로부터 탐지 규칙에 따라 위협을 탐지하는 단계는, 상기 수집된 인자로부터 VBA 스크립트를 식별하여 탐지 규칙에 따라 위협을 탐지하는 단계를 포함할 수 있다. 기타 실시예들의 구체적인 사항들은 상세한 설명 및 도면들에 포함되어 있다."}
{"patent_id": "10-2022-0186262", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 1, "content": "본 발명의 실시예에 따른 본 발명의 실시예에 따른 MS Word 문서형 악성코드 분석 및 학습데이터 생성 시스템 및 방법은, MS Word 문서형 파일에 삽입되는 악성코드의 탐지 및 분석을 효율적으로 수행할 수 있다. 특히 MS 문서형 악성코드는 문서 파일 내에 삽입된 스크립트가 난독화 및 압축됨으로써 기존의 악성코드 탐지 방법에 의 해 정확한 탐지가 어려울 수 있는 바, 본 발명의 시스템 및 방법에 의해 효율적이면서 정확한 악성코드 탐지를 가능하게 하며, 또한 탐지된 데이터를 이용하여 학습데이터를 생성함으로서 추후 인공지능 모델에 의한 자동적 인 탐지 및 분석이 가능하도록 할 수 있다."}
{"patent_id": "10-2022-0186262", "section": "발명의_설명", "subsection": "발명의효과", "paragraph": 2, "content": "본 발명의 효과들은 이상에서 언급한 효과들로 제한되지 않으며, 언급되지 않은 또 다른 효과들은 청구범위의 기재로부터 당업자에게 명확하게 이해될 수 있을 것이다."}
{"patent_id": "10-2022-0186262", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 1, "content": "본 발명의 이점 및 특징, 그리고 그것들을 달성하는 방법은 첨부되는 도면과 함께 상세하게 후술되어 있는 실시 예들을 참조하면 명확해질 것이다. 그러나 본 발명은 이하에서 개시되는 실시예들에 한정되는 것이 아니라 서로 다른 다양한 형태로 구현될 것이며, 단지 본 실시예들은 본 발명의 개시가 완전하도록 하며, 본 발명이 속하는"}
{"patent_id": "10-2022-0186262", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 2, "content": "기술분야에서 통상의 지식을 가진 자에게 발명의 범주를 완전하게 알려주기 위해 제공되는 것이며, 본 발명은 청구항의 범주에 의해 정의될 뿐이다. 명세서 전체에 걸쳐 동일 참조 부호는 동일 구성 요소를 지칭한다. 하나의 구성 요소가 다른 구성 요소와 \"연결된(connected to)\" 또는 \"커플링된(coupled to)\" 이라고 지칭되는 것은, 다른 구성 요소와 직접 연결 또는 커플링된 경우 또는 중간에 다른 구성 요소를 개재한 경우를 모두 포함 한다. 반면, 하나의 구성 요소가 다른 구성 요소와 \"직접 연결된(directly connected to)\" 또는 \"직접 커플링된 (directly coupled to)\"으로 지칭되는 것은 중간에 다른 구성 요소를 개재하지 않은 것을 나타낸다. \"및/또는\" 은 언급된 아이템들의 각각 및 하나 이상의 모든 조합을 포함한다. 본 명세서에서 사용된 용어는 실시예들을 설명하기 위한 것이며 본 발명을 제한하고자 하는 것은 아니다. 본 명 세서에서, 단수형은 문구에서 특별히 언급하지 않는 한 복수형도 포함한다. 명세서에서 사용되는 \"포함한다 (comprises)\" 및/또는 \"포함하는(comprising)\"은 언급된 구성 요소, 단계, 동작 및/또는 소자는 하나 이상의 다 른 구성 요소, 단계, 동작 및/또는 소자의 존재 또는 추가를 배제하지 않는다. 비록 제1, 제2 등이 다양한 구성 요소들을 서술하기 위해서 사용되나, 이들 구성 요소들은 이들 용어에 의해 제 한되지 않음은 물론이다. 이들 용어들은 단지 하나의 구성 요소를 다른 구성 요소와 구별하기 위하여 사용하는 것이다. 따라서, 이하에서 언급되는 제1 구성 요소는 본 발명의 기술적 사상 내에서 제2 구성 요소 일 수도 있 음은 물론이다. 다른 정의가 없다면, 본 명세서에서 사용되는 모든 용어(기술 및 과학적 용어를 포함)는 본 발명이 속하는 기술 분야에서 통상의 지식을 가진 자에게 공통적으로 이해될 수 있는 의미로 사용될 수 있을 것이다. 또 일반적으로 사용되는 사전에 정의되어 있는 용어들은 명백하게 특별히 정의되어 있지 않는 한 이상적으로 또는 과도하게 해 석되지 않는다. 본 실시예에서 사용되는 '부' 또는 '모듈'이라는 용어는 소프트웨어 또는 FPGA또는 ASIC과 같은 하드웨어 구성 요소를 의미하며, '부' 또는 '모듈'은 어떤 역할들을 수행한다. 그러나 '부' 또는 '모듈'은 소프트웨어 또는 하 드웨어에 한정되는 의미는 아니다. '부' 또는 '모듈'은 어드레싱할 수 있는 저장 매체에 있도록 구성될 수도 있 고 하나 또는 그 이상의 프로세서들을 재생시키도록 구성될 수도 있다. 따라서, 일 예로서 '부' 또는 '모듈'은 소프트웨어 구성요소들, 객체지향 소프트웨어 구성요소과, 함수들, 서브루틴들, 프로그램 코드의 세그먼트들, 마이크로코드, 회로, 데이터, 데이터베이스, 데이터 구조들, 테이블들, 어레이들, 및 변수들을 포함할 수 있다. 구성요소들과 '부' 또는 '모듈'들 안에서 제공되는 기능은 더 작은 수의 구성요소들 및 '부' 또는 '모듈'들로 결합되거나 추가적인 구성요소들과 '부' 또는 '모듈'들로 더 분리될 수 있다. 도 1은 본 발명의 실시예에 따른 문서형 악성코드 분석 및 학습데이터 생성 시스템을 설명하기 위한 도면이다. 도 1을 참조하면, 본 발명의 실시예에 따른 MS Word 문서형 악성코드 분석 및 학습데이터 생성 시스템은 파싱 모듈, 분석 모듈 및 저장 모듈을 포함할 수 있다. 시스템은 본 발명의 실시예에서 설명하는 MS Word 문서형 악성코드 분석 및 학습데이터 생성 방법을 수행 하는 컴퓨팅 장치일 수 있으며, 예를 들어 개인용 컴퓨터(PC), 서버 컴퓨터, 워크 스테이션, 랩탑 컴퓨터 등의 다양한 컴퓨터 시스템을 포함할 수 있으나 위에서 서술한 장치에 제한되는 것은 아니다. 시스템은 메모리에 일시적 또는 비일시적으로 명령어들을 저장하고, 저장된 명령어들을 실행하는 하나 이 상의 프로세서를 포함할 수 있다. 또한 시스템은 상기 명령어들의 실행 결과 및 데이터를 저장하는 스토리 지 장치를 포함할 수 있다. 파싱 모듈은 분석 대상 파일을 구분하고, 구분된 파일로부터 인자를 수집할 수 있다. 파싱 모듈은 입 력된 파일이 MS Word 문서형 파일인지 여부를 판단하고, MS Word 문서형 파일인 경우 해당 파일이 OOXML(Open Office XML) 형식인지 OLE(Object Linking and Embedding) 형식인지 여부를 판단하여 구분된 형식에 따라 인자 의 추출을 수행할 수 있다. 파싱 모듈의 구체적인 구성과 관련하여 도 2를 이용하여 더욱 자세하게 설명한다. 도 2는 본 발명의 실시예에 따른 MS Word 문서형 악성코드 분석 및 학습데이터 생성 시스템에 포함된 파싱 모듈 의 구성을 설명하기 위한 도면이다.도 2를 참조하면, 파싱 모듈은 버전 검사부, 파서부, 압축 해제부, 및 인자 수집부를 포함할 수 있다. 버전 검사부는 입력된 분석 대상 파일을 구분할 수 있다. 즉, 버전 검사부는 분석 대상 파일이 MS Word 문서형 파일인지 판단할 수 있다. 또한 분석 대상 파일이 MS Word 문서형 파일인 경우, 해당 파일의 형식 을 구분할 수 있다. 구체적으로, 버전 검사부는 해당 파일이 OLE 형식을 갖는 파일인지, 또는 OOXML 형식 을 갖는 파일인지를 구분할 수 있다. 예를 들어 구버전의 MS Word에 의해 생성된 문서형 파일(예를 들어 확장자가 .doc인 파일)의 경우 OLE 형식을 가질 수 있으며, 신버전의 MS Word에 의해 생성된 문서형 파일(예를 들어 확장자가 .docx인 파일)의 경우 OOXML 형식을 가질 수 있다. 각각의 형식마다 위협 인자가 삽입될 수 있는 영역이 다를 수 있으므로 버전 검사부(11 1)에 의해 분석 대상 파일의 형식을 구분하고, 구분된 파일 정보를 이후의 위협 인자 추출 과정에 제공하는 것 이 필요할 수 있다. 파서부는 구분된 분석 대상 파일의 위협 인자 영역을 분류하고 추출 대상의 인자를 식별할 수 있다. 버전 검사부에 의해 분석 대상 파일이 OLE 형식으로 구분된 경우, 파서부는 크게 두 가지 경우에 따라 위 협 인자 영역을 분류할 수 있다. 첫째, 분석 대상 파일에 악의적인 실행 파일 또는 쉘 코드가 삽입되어 저장되는 경우이다. MS Word 문서형 파일 은 예를 들어 문서 내에 포함된 텍스트들의 글꼴 정보 및 문서 식별 정보를 포함하는 'DocumentSummaryInformation'의 미사용 영역 내에 악의적인 실행 파일이 은닉되어 저장될 수 있다. 또한 MS Word 문서형 파일은 문서 본문 내에 포함된 그림 형식(예를 들어 .png, .jpg 등)의 데이터가 바이너리 형태로 저장된 'Pictures' 영역을 포함하는데, 이 영역의 비할당된 영역에 쉘 코드 및 악성 실행 파일이 저장될 수 있 다. 따라서 파서부는 분석 대상 파일이 OLE 형식으로 구분된 경우 'DocumentSummaryInformation' 및 'Pictures' 영역과 같이 비할당된 영역에 악성 실행파일 또는 쉘 코드가 삽입될 수 있는 영역으로부터 인자를 추출할 수 있도록 해당 영역의 존재를 식별할 수 있다. 또 다른 경우는, 분석 대상 파일에 VBA(Visual Basic for Application) 매크로 스크립트가 삽입되는 경우로, 파서부는 분석 대상 파일에 VBA 매크로 스크립트가 삽입되었는지 확인할 수 있는 위협 인자 영역을 식별할 수 있다. 구체적으로, OLE 형식의 MS Word 문서형 파일은 VBA 매크로 스크립트가 삽입된 경우 _VBA_PROJECT 등 의 스트림이 내부에 생성될 수 있다. 파서부는 OLE 형식의 MS Word 문서형 파일의 내부에 _VBA_PROJECT 스 트림의 생성 여부를 식별할 수 있다. 한편, 파서부는 버전 검사부에 의해 분석 대상 파일이 OOXML 형식으로 구분된 경우, 파서부는 주로 분석 대상 파일에 VBA 매크로 스크립트가 삽입되었는지 여부를 확인할 수 있는 위협 인자 영역을 식별할 수 있다. 구체적으로, OOXML 형식의 MS Word 문서형 파일은 VBA 매크로 스크립트가 삽입된 경우 vbaProject.bin 형태의 바이너리 개체가 문서 내에 생성될 수 있다. 한편 OOXML 형식의 MS Word 문서형 파일은 ZIP 압축 파일의 형태로 전체 파일 및 디렉토리 구조가 저장되므로 파서부는 영역 식별을 위해 분석 대상 파일을 압축 해제 할 수 있다. 압축 해제부는 식별된 인자의 난독화 및 압축을 해제할 수 있다. 식별된 인자로부터 정상적인 행위를 수행 하는 스크립트와 악성 행위를 수행하는 스크립트를 구분하기 위해서는 스크립트 내의 함수의 사용을 명확히 확 인할 필요가 있다. 파서부에 의해 식별된 인자들은 바이너리 파일의 형태를 가지고 있어 그 자체로는 난독 화로 인해 함수의 기능을 파악하는 것이 불가능할 수 있다. 이와 같은 데이터를 도 3을 이용하여 더욱 자세하게 설명한다. 도 3a 내지 3c는 본 발명의 실시예에 따른 MS Word 문서형 악성코드 분석 및 학습데이터 생성 시스템에 포함된 압축 해제부에 의해 처리될 수 있는 데이터의 예시를 설명하기 위한 도면이다. 먼저 도 3a를 참조하면, 파서부에 의해 식별된 _VBA_PROJECT(OLE 형식의 경우) 또는 vbaProject.bin(OOXML)의 인자의 경우 바이너리 데이터의 형식을 가지고 있으며, 예를 들어 Run-Length 기법 등 으로 압축되어 있어 위협 인자가 포함되어 있는지 즉각적인 분석이 불가능한 경우에 해당할 수 있다. 압축 해제부는 바이너리 데이터를 예를 들어 Run-Length 기법에 의해 압축 해제 후 VBA 스크립트 형태의 텍스트 파일을 얻을 수 있다. 도 3b의 경우 정상적인 동작을 수행하는 VBA 매크로 스크립트의 예시이고, 도 3c의 경우 악성 행위를 수행하는 특정 함수, 예를 들어 자동 실행 함수(Document_Open), 프로시저 호출(Call), 특 정 파일 실행(ShellExecuteA), URL을 통한 파일 다운로드(URLDownloadToFileA) 등을 포함하는 VBA 매크로 스크 립트의 예시이다. 이와 같이 압축 해제부에 의해 난독화가 해제된 스크립트를 이용하여 악성 스크립트의 분석을 수행하는 경 우 통상적인 분석보다 정확한 분석 결과를 얻을 수 있다. 또한 압축 해제부는 분석 대상 파일이 OLE 형식이고, 파서부에 의해 식별된 인자가 'DocumentSummaryInformation' 및 'Pictures'와 같이 비할당된 영역에 악성 실행파일 또는 쉘 코드가 삽입될 수 있는 영역인 경우 해당 영역에 은닉된 실행파일을 식별하기 위한 난독화 및 압축 해제 과정을 수행할 수 있 다. 인자 수집부는 난독화 및 압축이 해제된 인자를 텍스트 형식으로 저장할 수 있다. 인자 수집부는 도 3b 및 3c와 같이 난독화 및 압축이 해제된 인자의 데이터를 이후 분석 모듈에 의한 분석 작업이 수행될 수 있도록 텍스트 형식으로 저장할 수 있다. 본 발명의 몇몇 실시예에서, 인자 수집부는 난독화 및 압축이 해제된 인자 가운데 악성 행위에 사용되는 VBA 스크립트 위협 인자만을 선택적으로 저장할 수 있다. 이와 관련하여 도 4를 이용하여 설명한다. 도 4는 MS Word 문서형 파일에 삽입되는 VBA 매크로 스크립트 가운데 악성 행위에 사용될 수 있는 스크립트의 분류를 설명하기 위한 도면이다. 도 4를 참조하면, 난독화 및 압축이 해제된 텍스트 형식의 VBA 스크립트 가운데, 문서 파일 실행 시 매크로를 자동 실행하는 스크립트, 드롭퍼 형식의 파일 다운로드 기능을 수행하는 스크립트, 특정 프로시저를 호출하는 스크립트, 실행 파일 또는 시스템 명령어 실행과 관련된 스크립트, 운영체제의 환경변수 값 반환과 관련된 스크 립트, 파일 입출력 기능 활성화와 관련된 스크립트 및 특정 파일에 데이터 쓰기 작업을 수행하는 스크립트의 경 우 악성 행위에 사용될 수 있는 스크립트에 해당한다. 인자 수집부는 난독화 및 압축이 해제된 텍스트 형식의 VBA 스크립트 가운데 도 4의 특정 스크립트가 포함 된 영역을 선택적으로 저장함으로써 이후 분석 모듈에 의한 분석 작업에 사용되도록 할 수 있다. 다시 도 1을 참조하면, 분석 모듈은 수집된 인자로부터 탐지 규칙에 따라 위협을 탐지할 수 있다. 구체적 으로, 분석 모듈은 파싱 모듈에 의해 텍스트 형태로 추출되어 저장된 인자와 관련된 데이터를 읽어들 이고, 탐지 규칙에 따라 위협을 탐지할 수 있다. 분석 모듈은 분석 대상인 코드 및 데이터들이 기존에 알려진 악성코드 패턴에 해당하는지 여부를 확인하는 방식으로 위협을 탐지할 수 있으나 본 발명이 이에 제한되는 것은 아니다. 더욱 구체적으로, 분석 모듈은 Yara-Rule과 같은 탐지 규칙을 이용하여 추출된 인자로부터 위협을 탐지할 수 있다. Yara-Rule의 경우 텍스트 형식에 포함된 스트링 뿐만 아니라 바이너리 형식으로부터 인자를 감지하는 것도 가능하나, 상술한 것과 같이 분석 모듈은 파싱 모듈에 의해 난독화 및 압축이 해제된 텍스트 형식의 파일로부터 위협 인자 분석을 수행함으로써 탐지율을 향상시킬 수 있다. 또한, 분석 모듈은 파싱 모듈에 의해 추출된 인자가 포함된 실행 파일, 예를 들어 exe 파일이 악의적 인 동작을 수행하는지 여부를 탐지 규칙을 이용하여 탐지할 수 있다. 저장 모듈은 분석 모듈이 탐지한 위협 인자의 정보와 탐지 규칙을 학습데이터로 저장할 수 있다. 예 를 들어 저장 모듈은 추출된 코드 및 분석 대상 파일에 포함된 데이터가 탐지 규칙에 의해 위협으로 탐지 된 경우, 위협 인자 정보, 즉 추출된 매크로 스크립트 또는 분석 대상 파일에 포함된 악성행위를 수행하는 실행 파일 등의 데이터와 이들의 탐지 결과를 학습 데이터로 저장할 수 있다. 특히 저장 모듈은 매크로 스크립 트, 악성 파일 등의 데이터에 대하여 해당 데이터를 탐지한 탐지 규칙, 해당 인자가 포함된 분석 대상 파일의 특징 등을 라벨링하여 학습데이터로 저장할 수 있다. 이와 같이 저장된 학습 데이터의 특징점을 이용하여 MS Word 문서형 파일에 포함된 악성 코드 탐지에 사용되기 위한 기계학습 모델이 생성될 수도 있다. 도 5는 본 발명의 실시예에 따른 MS Word 문서형 악성코드 분석 및 학습데이터 생성 방법을 설명하기 위한 순서 도이다. 도 5를 참조하면, 본 발명의 실시예에 따른 MS Word 문서형 악성코드 분석 및 학습데이터 생성 방법은 분석 대 상 파일을 구분하고 구분된 파일로부터 인자를 수집하는 단계(S110), 수집된 인자로부터 탐지 규칙에 따라 위협을 탐지하는 단계(S120) 및 탐지된 위협 인자의 정보와 탐지 규칙을 학습데이터로 저장하는 단계(S130)를 포함 한다. 상기 각 단계들은 본 발명의 실시예에 따른 MS Word 문서형 악성코드 분석 및 학습데이터 생성 시스템에 의하여 수행되는 것으로 이해될 수 있으며, 또는 메모리에 각각의 단계를 실행할 수 있는 명령어들을 일시적 또 는 비일시적으로 저장하고 저장된 명령어들을 실행하는 하나 이상의 프로세서를 포함하는 일반적인 컴퓨팅 장치 에 의해 수행되는 것으로도 이해될 수 있다. 먼저, 분석 대상 파일을 구분하고 구분된 파일로부터 인자를 수집하는 단계(S110)가 수행된다. 해당 단계는 입 력된 파일이 MS Word 문서형 파일인지 여부를 판단하고, MS Word 문서형 파일인 경우 해당 파일이 OOXML 또는 OLE 형식인지 여부에 따라 인자의 추출을 수행할 수 있다. 해당 단계와 관련하여 도 6을 이용하여 더욱 자세하 게 설명한다. 도 6은 본 발명의 실시예에 따른 MS Word 문서형 악성코드 분석 및 학습데이터 생성 방법에 포함된 인자 수집 단계를 설명하기 위한 순서도이다. 도 6을 참조하면, 인자 수집 단계(S110)는, 분석 대상 파일인 MS Word 문서 파일의 형식을 구분하는 단계 (S111), 구분된 분석 대상 파일의 위협 인자 영역을 분류하고 추출 대상의 인자를 식별하는 단계(S112), 식별된 인자의 난독화 및 압축을 해제하는 단계(S113) 및 난독화 및 압축이 해제된 인자를 텍스트 형식으로 저장하는 단계(S114)를 포함한다. MS Word 문서 파일의 형식을 구분하는 단계(S111)는 예를 들어 분석 대상 파일이 OLE 형식을 갖는 파일인지, 또 는 OOXML 형식을 갖는 파일인지 구분하는 것을 포함할 수 있다. 상술한 것과 같이 OLE 또는 OOXML 형식에 위협 인자의 형태 및 인자가 삽입될 수 있는 영역을 달리하므로 분석 대상 파일의 구분 정보를 이용하여 이후 추출 및 분석 단계에 사용할 수 있다. 이어서 구분된 분석 대상 파일의 위협 인자 영역을 분류하고 추출 대상의 인자를 식별하는 단계가 수행된다 (S112). MS Word 문서형 파일의 형식 구분 결과 OLE 형식인 경우, 해당 파일은 DocumentSummaryInformation의 미사용 영역 내에 악의적인 실행파일이 존재하거나, VBA 매크로 스크립트의 사용으로 인한 _VBA_PROJECT 등의 스트림의 존재 여부를 식별하는 단계가 수행될 수 있다. 또는 형식 구분 결과 OOXML 파일인 경우 vbaProject.bin 형태의 바이너리 객체가 문서 파일 내에 생성되어 있는 지 여부를 식별함으로써 인자 식별 단계가 수행될 수 있다. 이어서 식별된 인자의 난독화 및 압축을 해제하는 단계(S113)가 수행된다. 앞선 단계에서 식별된 바이너리 객체 들은 예를 들어 Run-Length 기법 등으로 압축되고 바이너리 형태로 난독화 됨으로써 악성 스크립트의 존재 여부 판단이 어려운 상태이므로, 본 단계를 통해 난독화 및 압축 해제가 수행됨으로써 텍스트 형태의 데이터가 생성 될 수 있다. 이어서 난독화 및 압축이 해제된 인자를 텍스트 형식으로 저장하는 단계(S114)가 수행된다. 본 발명의 몇몇 실 시예에서, 수집된 인자의 데이터를 포함하는 난독화 및 압축이 해제된 텍스트 파일 전체가 저장될 수도 있으아 이에 제한되는 것은 아니며, 미리 정해진 위협 인자의 함수와 관련된 텍스트 데이터가 선택적으로 저장될 수도 있다. 다시 도 5를 참조하면, 수집된 인자로부터 탐지 규칙에 따라 위협을 탐지하는 단계(S120)가 수행된다. 예를 들 어 Yara-Rule과 같은 탐지 규칙을 이용하여 추출된 인자로부터 위협이 탐지될 수 있다. 몇몇 실시예에서 추출된 인자가 MS Word 문서형 파일의 비할당 영역에 포함된 exe 파일 등의 실행 파일인 경우, 기존의 실행 파일로부터 악성코드를 탐지하기 위한 탐지 규칙을 사용하여 위협 탐지가 수행될 수 있다. 마지막으로 탐지된 위협 인자의 정보와 탐지 규칙을 학습데이터로 저장하는 단계(S130)가 수행된다. 구체적으로, 추출된 위협 인자 및 대상 문서 파일에 포함된 데이터가 탐지 규칙에 의해 위협으로 탐지된 경우, 위협 인자 정보, 즉 추출된 매크로 스크립트 또는 분석 대상 파일에 포함된 데이터, 해당 데이터를 탐지한 탐지 규칙, 해당 인자가 포함된 분석 대상 파일의 특징 등을 학습데이터로서 저장할 수 있다. 본 발명은 또한 컴퓨터로 읽을 수 있는 기록매체에 컴퓨터가 읽을 수 있는 코드로서 구현하는 것이 가능하다. 컴퓨터가 읽을 수 있는 기록매체는 컴퓨터 장치에 의하여 읽혀질 수 있는 데이터가 저장되는 모든 종류의 기록 장치를 포함한다. 컴퓨터가 읽을 수 있는 기록매체의 예로는 하드디스크, ROM, RAM, CD-ROM, 하드 디스크, 자기테이프, 플로피 디스크, 광 데이터 저장장치 등을 포함한다."}
{"patent_id": "10-2022-0186262", "section": "발명의_설명", "subsection": "발명을실시하기위한구체적인내용", "paragraph": 3, "content": "이상 첨부된 도면을 참조하여 본 발명의 실시예를 설명하였지만, 본 발명이 속하는 기술분야에서 통상의 지식을 가진 자는 본 발명이 그 기술적 사상이나 필수적인 특징을 변경하지 않고서 다른 구체적인 형태로 실시될 수 있 다는 것을 이해할 수 있을 것이다. 그러므로 이상에서 기술한 실시예들은 모든 면에서 예시적인 것이며 한정적 이 아닌 것으로 이해해야만 한다."}
{"patent_id": "10-2022-0186262", "section": "도면", "subsection": "도면설명", "item": 1, "content": "도 1은 본 발명의 실시예에 따른 MS Word 문서형 분석 및 학습데이터 생성 시스템을 설명하기 위한 도면이다. 도 2는 본 발명의 실시예에 따른 MS Word 문서형 악성코드 분석 및 학습데이터 생성 시스템에 포함된 파싱 모듈 의 구성을 설명하기 위한 도면이다. 도 3a 내지 3c는 본 발명의 실시예에 따른 MS Word 문서형 악성코드 분석 및 학습데이터 생성 시스템에 포함된 압축 해제부에 의해 처리될 수 있는 데이터의 예시를 설명하기 위한 도면이다. 도 4는 MS Word 문서형 파일에 삽입되는 VBA 매크로 스크립트 가운데 악성 행위에 사용될 수 있는 스크립트의 분류를 설명하기 위한 도면이다. 도 5는 본 발명의 실시예에 따른 MS Word 문서형 악성코드 분석 및 학습데이터 생성 방법을 설명하기 위한 순서 도이다. 도 6은 본 발명의 실시예에 따른 MS Word 문서형 악성코드 분석 및 학습데이터 생성 방법에 포함된 인자 수집 단계를 설명하기 위한 순서도이다."}
